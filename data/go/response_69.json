[{"tags": ["go", "ssh"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1462458684, "post_id": 37040099, "comment_id": 61653620, "body": "Is the <code>r</code> channel buffered? When you timeout there&#39;s no receiver to accept the result from <code>s.Run</code>. You may still need to actually kill the remote process; have you tried using <code>s.Signal</code> to kill it when it times out?"}, {"owner": {"reputation": 183, "user_id": 1883374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ZpKR.jpg?s=128&g=1", "display_name": "Mehrdad", "link": "https://stackoverflow.com/users/1883374/mehrdad"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462487899, "post_id": 37040099, "comment_id": 61669773, "body": "Yes I tried s.Signal(ssh.SIGKILL) but nothing happened! I have this issue for few of devices not all."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1462488076, "post_id": 37040099, "comment_id": 61669828, "body": "Again, is <code>r</code> buffered?"}, {"owner": {"reputation": 183, "user_id": 1883374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ZpKR.jpg?s=128&g=1", "display_name": "Mehrdad", "link": "https://stackoverflow.com/users/1883374/mehrdad"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462488394, "post_id": 37040099, "comment_id": 61669954, "body": "that&#39;s not buffered, I tried w/ buffed but same."}, {"owner": {"reputation": 183, "user_id": 1883374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ZpKR.jpg?s=128&g=1", "display_name": "Mehrdad", "link": "https://stackoverflow.com/users/1883374/mehrdad"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462488795, "post_id": 37040099, "comment_id": 61670096, "body": "I noticed the io.copy freezes at below blocks once i try to close session. <a href=\"https://github.com/golang/crypto/blob/master/ssh/session.go#L468-L492\" rel=\"nofollow noreferrer\">github.com/golang/crypto/blob/master/ssh/session.go#L468-L49&zwnj;&#8203;2</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1462488798, "post_id": 37040099, "comment_id": 61670100, "body": "It needs to be buffered or the goroutine can&#39;t return."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1462488855, "post_id": 37040099, "comment_id": 61670120, "body": "Don&#39;t close the session to abort, kill the process and Wait on it (Run is calling Wait for you)"}, {"owner": {"reputation": 183, "user_id": 1883374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ZpKR.jpg?s=128&g=1", "display_name": "Mehrdad", "link": "https://stackoverflow.com/users/1883374/mehrdad"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462492278, "post_id": 37040099, "comment_id": 61671005, "body": "can you explain me why we need buffered channel here?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462493767, "post_id": 37040099, "comment_id": 61671353, "body": "the goroutine can&#39;t return until the send on <code>r</code> completes. You can either buffer the channel and ignore the value, or receive again after the timeout."}, {"owner": {"reputation": 3547, "user_id": 546750, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5e663c9fc0ebe46af81b8a49d5e2aa91?s=128&d=identicon&r=PG", "display_name": "ahmy", "link": "https://stackoverflow.com/users/546750/ahmy"}, "edited": false, "score": 2, "creation_date": 1517429381, "post_id": 37040099, "comment_id": 84097250, "body": "I believe the process triggered by s.Run is not properly stoped, hence it cannot deallocate the resource. have you tried to send sigterm/sig kill to that process? <a href=\"https://godoc.org/golang.org/x/crypto/ssh#Session.Signal\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/crypto/ssh#Session.Signal</a>  and instead of Run, use Start and wait  like <a href=\"https://stackoverflow.com/questions/11886531/terminating-a-process-started-with-os-exec-in-golang\" title=\"terminating a process started with os exec in golang\">stackoverflow.com/questions/11886531/&hellip;</a>"}, {"owner": {"reputation": 7445, "user_id": 1174378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8e5416e29987d91116420dc387e7153?s=128&d=identicon&r=PG", "display_name": "Mihai Todor", "link": "https://stackoverflow.com/users/1174378/mihai-todor"}, "reply_to_user": {"reputation": 3547, "user_id": 546750, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5e663c9fc0ebe46af81b8a49d5e2aa91?s=128&d=identicon&r=PG", "display_name": "ahmy", "link": "https://stackoverflow.com/users/546750/ahmy"}, "edited": false, "score": 0, "creation_date": 1546562714, "post_id": 37040099, "comment_id": 94899762, "body": "@ahmy You should turn that into a full answer. Calling Start and then Wait is the way to go."}], "answers": [{"tags": [], "owner": {"reputation": 843, "user_id": 1816774, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6bee690bd3d6a8f900f7a8667f3211ce?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/1816774/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1581777448, "creation_date": 1581777448, "answer_id": 60239769, "question_id": 37040099, "link": "https://stackoverflow.com/questions/37040099/force-to-close-ssh-client-session/60239769#60239769", "title": "Force to close SSH client session", "body": "<p>Channel <code>r</code> blocks the Go routine from returning, as it is not being emptied. I've written an adapted version of your code and inserted a Wait group to demonstrate the problem:</p>\n\n<pre><code>func main() {\n    var wg sync.WaitGroup // This is only added for demonstration purposes\n    s := new(clientSession)\n\n    r := make(chan error)\n\n    go func(s *clientSession) {\n        wg.Add(1)\n        r &lt;- s.Run()\n        wg.Done() // Will only be called after s.Run() is able to return\n    }(s)\n\n    fmt.Println(\"Client has been opened\")\n\n    select {\n    case err := &lt;-r:\n        fmt.Println(err)\n    case &lt;-time.After(1 * time.Second):\n        s.Close()\n        fmt.Println(\"Timed out, closing\")\n    }\n\n    wg.Wait() // Waits until wg.Done() is called.\n\n    fmt.Println(\"Main finished successfully\")\n}\n</code></pre>\n\n<p>Go playground seems to terminate the program, so I've created a <a href=\"https://gist.github.com/muhlemmer/6afde02aeb195dae74e6e78365f18b03\" rel=\"nofollow noreferrer\">gist</a> with the complete run-able code. When we run <a href=\"https://gist.github.com/muhlemmer/6afde02aeb195dae74e6e78365f18b03#file-incorrect-go\" rel=\"nofollow noreferrer\"><code>incorrect.go</code></a>:</p>\n\n<pre><code>$ go run incorrect.go\nClient has been opened\nTimed out, closing\nfatal error: all goroutines are asleep - deadlock!\n....\n</code></pre>\n\n<p>That's because our code is deadlocked on the <code>wg.Wait()</code> line. This demonstrated that <code>wg.Done()</code> in the Go routine was never reached.</p>\n\n<p>As the comments point out, a buffered channel can help out here. But only if you don't care about the error anymore, after calling <code>s.Close()</code></p>\n\n<pre><code>r := make(chan error, 1)\n</code></pre>\n\n<p><a href=\"https://gist.github.com/muhlemmer/6afde02aeb195dae74e6e78365f18b03#file-buffered-go\" rel=\"nofollow noreferrer\"><code>buffered.go</code></a> runs correctly, but the error is lost:</p>\n\n<pre><code>$ go run buffered.go\nClient has been opened\nTimed out, closing\nMain finished successfully\n</code></pre>\n\n<p>Another option would be to drain the channel exactly 1 time:</p>\n\n<pre><code>select {\n    case err := &lt;-r:\n        fmt.Println(err)\n    case &lt;-time.After(1 * time.Second):\n        s.Close()\n        fmt.Println(\"Timed out, closing\")\n        fmt.Println(&lt;-r)\n    }\n</code></pre>\n\n<p>Or by wrapping <code>select</code> in a <code>for</code> loop (without buffered channel):</p>\n\n<pre><code>X:\n    for {\n        select {\n        case err := &lt;-r:\n            fmt.Println(err)\n            break X // because we are in main(). Normally `return err`\n        case &lt;-time.After(1 * time.Second):\n            s.Close()\n            fmt.Println(\"Timed out, closing\")\n        }\n    }\n</code></pre>\n\n<p>When we run <a href=\"https://gist.github.com/muhlemmer/6afde02aeb195dae74e6e78365f18b03#file-drain-go\" rel=\"nofollow noreferrer\"><code>drain.go</code></a> we see the error also printed:</p>\n\n<pre><code>$ go run incorrect.go\nClient has been opened\nTimed out, closing\nRun() closed\nMain finished successfully\n</code></pre>\n\n<p>In real world, one would be running multiple Go routines. So you will want to use some counters on the <code>for</code> loop or further utilize Wait group functionality.</p>\n"}], "owner": {"reputation": 183, "user_id": 1883374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ZpKR.jpg?s=128&g=1", "display_name": "Mehrdad", "link": "https://stackoverflow.com/users/1883374/mehrdad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1906, "favorite_count": 2, "answer_count": 1, "score": 10, "last_activity_date": 1581777448, "creation_date": 1462406366, "last_edit_date": 1498471158, "question_id": 37040099, "link": "https://stackoverflow.com/questions/37040099/force-to-close-ssh-client-session", "title": "Force to close SSH client session", "body": "<p>I've written a SSH client to connect to network devices and I set a timeout through \"select\" once the running command takes more than 25 seconds. I noticed a few of devices that they have another IOS it can not drop the SSH session w/ them through Close() method once the timeout has been triggered and it causes goroutinge leaking. I need to keep up the client and disconnect the session to be ready for next command. looks the goroutine doesn't terminate for ever at that time!  Do you guys have any idea?</p>\n\n<pre><code>    go func() {\n       r &lt;- s.Run(cmd)\n    }()\n\n    select {\n       case err := &lt;-r:\n         return err\n       case &lt;-time.After(time.Duration(timeout) * time.Second):\n         s.Close()\n         return fmt.Errorf(\"timeout after %d seconds\", timeout)\n    }\n</code></pre>\n\n<p>Through the heap profiling I saw the below:\n    2.77GB 99.44% 99.44%     2.77GB 99.44%  bytes.makeSlice</p>\n\n<pre><code>     0     0% 99.44%     2.77GB 99.44%  bytes.(*Buffer).ReadFrom\n\n     0     0% 99.44%     2.77GB 99.44%  golang.org/x/crypto/ssh.(*Session).start.func1\n\n     0     0% 99.44%     2.77GB 99.44%  golang.org/x/crypto/ssh.(*Session).stdout.func1\n\n     0     0% 99.44%     2.77GB 99.44%  io.Copy\n\n     0     0% 99.44%     2.77GB 99.44%  io.copyBuffer\n\n     0     0% 99.44%     2.78GB 99.93%  runtime.goexit\n</code></pre>\n\n<p>ROUTINE ======================== runtime.goexit in /usr/local/go/src/runtime/asm_amd64.s</p>\n\n<pre><code>     0     2.78GB (flat, cum) 99.93% of Total\n\n     .          .   1993:   RET\n\n     .          .   1994:\n\n     .          .   1995:// The top-most function running on a goroutine\n\n     .          .   1996:// returns to goexit+PCQuantum.\n\n     .          .   1997:TEXT runtime\u00b7goexit(SB),NOSPLIT,$0-0\n\n     .     2.78GB   1998:   BYTE    $0x90   // NOP\n\n     .          .   1999:   CALL    runtime\u00b7goexit1(SB) // does not return\n\n     .          .   2000:   // traceback from goexit1 must hit code range of goexit\n\n     .          .   2001:   BYTE    $0x90   // NOP\n\n     .          .   2002:\n\n\n     .          .   2003:TEXT runtime\u00b7prefetcht0(SB),NOSPLIT,$0-8\n</code></pre>\n"}, {"tags": ["pointers", "go", "struct", "null", "comparison"], "comments": [{"owner": {"reputation": 577, "user_id": 3166366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f1d95a67412bf888e5a2cdafd7fdc0?s=128&d=identicon&r=PG&f=1", "display_name": "abest", "link": "https://stackoverflow.com/users/3166366/abest"}, "edited": false, "score": 0, "creation_date": 1462408649, "post_id": 37040086, "comment_id": 61630476, "body": "Hey rebel... in your switch statement, you seem to be looking at two different values of <code>Foo</code> <b>f</b> and <b>m</b>, is that intentional or are you just looking for a general idiom for validation?"}, {"owner": {"reputation": 502, "user_id": 2606951, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f89836139e315463155a813e9bf21597?s=128&d=identicon&r=PG&f=1", "display_name": "rebelshrug", "link": "https://stackoverflow.com/users/2606951/rebelshrug"}, "reply_to_user": {"reputation": 577, "user_id": 3166366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f1d95a67412bf888e5a2cdafd7fdc0?s=128&d=identicon&r=PG&f=1", "display_name": "abest", "link": "https://stackoverflow.com/users/3166366/abest"}, "edited": false, "score": 0, "creation_date": 1462410451, "post_id": 37040086, "comment_id": 61630943, "body": "that&#39;s a typo - thanks for catching that! I&#39;m just looking for a general idiom for validation."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1462412297, "post_id": 37040086, "comment_id": 61631330, "body": "Can you elaborate on &#39;each nil check will have differing returns.&#39; ? Are you setting default values ?"}, {"owner": {"reputation": 502, "user_id": 2606951, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f89836139e315463155a813e9bf21597?s=128&d=identicon&r=PG&f=1", "display_name": "rebelshrug", "link": "https://stackoverflow.com/users/2606951/rebelshrug"}, "edited": false, "score": 0, "creation_date": 1462412908, "post_id": 37040086, "comment_id": 61631477, "body": "I updated the switch statement. Thanks for taking a look."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1462414496, "post_id": 37040086, "comment_id": 61631832, "body": "does JSON schema help? <a href=\"https://github.com/xeipuuv/gojsonschema\" rel=\"nofollow noreferrer\">github.com/xeipuuv/gojsonschema</a>"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1462426288, "post_id": 37040086, "comment_id": 61634911, "body": "@rebelshrug - These links should help you out. <a href=\"http://brandonokert.com/2016/04/18/Json-Management-Patterns-In-Go/\" rel=\"nofollow noreferrer\">Link1</a> &amp; <a href=\"https://godoc.org/gopkg.in/validator.v2#hdr-Builtin_validator_functions\" rel=\"nofollow noreferrer\">Link2</a>"}, {"owner": {"reputation": 502, "user_id": 2606951, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f89836139e315463155a813e9bf21597?s=128&d=identicon&r=PG&f=1", "display_name": "rebelshrug", "link": "https://stackoverflow.com/users/2606951/rebelshrug"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1462918614, "post_id": 37040086, "comment_id": 61837660, "body": "@JiangYD - JSON schema looks good, but I prefer to write it myself."}, {"owner": {"reputation": 502, "user_id": 2606951, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f89836139e315463155a813e9bf21597?s=128&d=identicon&r=PG&f=1", "display_name": "rebelshrug", "link": "https://stackoverflow.com/users/2606951/rebelshrug"}, "reply_to_user": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 1, "creation_date": 1462918623, "post_id": 37040086, "comment_id": 61837664, "body": "@JohnSPerayil - thanks for the links, they were very helpful."}], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 2606951, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f89836139e315463155a813e9bf21597?s=128&d=identicon&r=PG&f=1", "display_name": "rebelshrug", "link": "https://stackoverflow.com/users/2606951/rebelshrug"}, "edited": false, "score": 0, "creation_date": 1462918958, "post_id": 37045562, "comment_id": 61837766, "body": "Thanks for the help - the tip about Go <code>case</code>s saved me some heartache. I did go with the helper function route."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1518017048, "last_edit_date": 1518017048, "creation_date": 1462435669, "answer_id": 37045562, "question_id": 37040086, "link": "https://stackoverflow.com/questions/37040086/concise-nil-checks-for-struct-field-pointers/37045562#37045562", "title": "Concise nil checks for struct field pointers?", "body": "<p>A question to you: how less verbose you want to get? Because you want to do different things on different conditions (different fields being <code>nil</code>). Your code contains these different things and the different conditions. Beyond that what's \"redundant\" in your code are just the <code>switch</code> and <code>case</code> keywords. You want to leave them out? Because the rest is not \"redundant\", they are required.</p>\n\n<p>Also note that in Go <code>case</code>s do not fall through even without a <code>break</code> (unlike in other languages), so in your above example if <code>f.Baz</code> is <code>nil</code>, you will set it to <code>42</code> and <code>f.Qux</code> will not be checked (so no <code>error</code> will be returned), but if <code>f.Baz</code> is non-<code>nil</code> and <code>f.Qux</code> is <code>nil</code>, an <code>error</code> will be returned. I know it's just an example, but this is something to keep in mind. You should handle <code>error</code>s first if you use a <code>switch</code>! Or use <code>if</code> statements and then the error will be detected and returned regardless of the order of field checks.</p>\n\n<p>Your code with <code>switch</code> is clean and efficient. If you want to make it less verbose, readability (and performance) will suffer.</p>\n\n<p>You may use a helper function which checks if a pointer value is <code>nil</code>:</p>\n\n<pre><code>func n(i interface{}) bool {\n    v := reflect.ValueOf(i)\n    return v.Kind() == reflect.Ptr &amp;&amp; v.IsNil()\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>func check(f *Foo) error {\n    switch {\n    case n(f.Bar):\n        return errors.New(\"Missing 'bar'\")\n    case n(f.Qux):\n        return errors.New(\"Missing 'qux'\")\n    case n(f.Baz):\n        x := int64(42)\n        f.Baz = &amp;x\n    }\n    return nil\n}\n</code></pre>\n\n<p>Or using <code>if</code> statements:</p>\n\n<pre><code>func check2(f *Foo) error {\n    if n(f.Bar) {\n        return errors.New(\"Missing 'bar'\")\n    }\n    if n(f.Qux) {\n        return errors.New(\"Missing 'qux'\")\n    }\n    if n(f.Baz) {\n        x := int64(42)\n        f.Baz = &amp;x\n    }\n    return nil\n}\n</code></pre>\n\n<p>Try these on the <a href=\"https://play.golang.org/p/_pYbMyKz8I\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 502, "user_id": 2606951, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f89836139e315463155a813e9bf21597?s=128&d=identicon&r=PG&f=1", "display_name": "rebelshrug", "link": "https://stackoverflow.com/users/2606951/rebelshrug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 37045562, "answer_count": 1, "score": 1, "last_activity_date": 1518017048, "creation_date": 1462406316, "last_edit_date": 1462412801, "question_id": 37040086, "link": "https://stackoverflow.com/questions/37040086/concise-nil-checks-for-struct-field-pointers", "title": "Concise nil checks for struct field pointers?", "body": "<p>Say I have this struct:</p>\n\n<pre><code>type Foo struct {\n    Bar        *string          `json:\"bar\"`\n    Baz        *int64           `json:\"baz,omitempty\"`\n    Qux        *string          `json:\"qux\"`\n    Quux       string           `json:\"quux\"`\n}\n</code></pre>\n\n<p>After unmarshalling the json, I check for nil like so:</p>\n\n<pre><code>switch {\ncase f.Bar == nil:\n    return errors.New(\"Missing 'bar'\")\ncase f.Baz == nil:\n    f.Baz = 42\ncase f.Qux == nil:\n    return errors.New(\"Missing 'qux'\")\n}\n</code></pre>\n\n<p>(or through a series of <code>if</code> statements, etc...)</p>\n\n<p>I understand that I can put all the <code>nil</code> comparisons in one comma separated <code>case</code>, but each <code>nil</code> check will have differing returns.</p>\n\n<p>My question: is there a less verbose way of doing the nil checks?</p>\n"}, {"tags": ["go", "byte", "rune"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1462406048, "creation_date": 1462406048, "answer_id": 37040043, "question_id": 37039678, "link": "https://stackoverflow.com/questions/37039678/what-are-gos-rules-for-comparing-bytes-with-runes/37040043#37040043", "title": "What are Go&#39;s rules for comparing bytes with runes?", "body": "<p>Rune literal 'a' represents a rune constant. Constant may be untyped. In short declaration form <code>r := 'a'</code> rune constant <code>'a'</code> is implicitly converted in its default type which is <code>rune</code>. But you can explicitly convert it by assigning to typed variable.</p>\n\n<pre><code>var r byte = 'a'\n</code></pre>\n\n<p>See it works <a href=\"https://play.golang.org/p/lqMq8kQoE-\" rel=\"nofollow\">https://play.golang.org/p/lqMq8kQoE-</a></p>\n"}, {"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 6, "last_activity_date": 1462407631, "last_edit_date": 1462407631, "creation_date": 1462406087, "answer_id": 37040049, "question_id": 37039678, "link": "https://stackoverflow.com/questions/37039678/what-are-gos-rules-for-comparing-bytes-with-runes/37040049#37040049", "title": "What are Go&#39;s rules for comparing bytes with runes?", "body": "<p>This is an example of <a href=\"https://golang.org/ref/spec#Constants\" rel=\"noreferrer\">untyped constants</a>. From the docs:</p>\n\n<blockquote>\n  <p>Untyped boolean, numeric, and string constants may be used as operands wherever it is legal to use an operand of boolean, numeric, or string type, respectively. Except for shift operations, if the operands of a binary operation are different kinds of untyped constants, the operation and, for non-boolean operations, the result use the kind that appears later in this list: integer, rune, floating-point, complex.</p>\n</blockquote>\n\n<p>Since <code>'a'</code> is an untyped constant, the compiler will try to convert it to a type comparable with the other operand. In this case, it gets converted to a <code>byte</code>.</p>\n\n<p>You can see this not working when the rune constant does not fit into a single byte:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    const a = '\u20ac'\n    fmt.Println(\"a\"[0] == a) // constant 8364 overflows byte\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/lDN-SERUgN\" rel=\"noreferrer\">https://play.golang.org/p/lDN-SERUgN</a></p>\n"}], "owner": {"reputation": 1907, "user_id": 3161525, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6c4bdb240d87fd9fa82717d3cfbea305?s=128&d=identicon&r=PG&f=1", "display_name": "EMBLEM", "link": "https://stackoverflow.com/users/3161525/emblem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5169, "favorite_count": 2, "accepted_answer_id": 37040049, "answer_count": 2, "score": 7, "last_activity_date": 1462407631, "creation_date": 1462403756, "question_id": 37039678, "link": "https://stackoverflow.com/questions/37039678/what-are-gos-rules-for-comparing-bytes-with-runes", "title": "What are Go&#39;s rules for comparing bytes with runes?", "body": "<p>I've discovered the following peculiarity:</p>\n\n<pre><code>b := \"a\"[0]\nr := 'a'\nfmt.Println(b == r) // Does not compile, cannot compare byte and rune\nfmt.Println(\"a\"[0] == 'a') // Compiles and prints \"true\"\n</code></pre>\n\n<p>How does this work?</p>\n"}, {"tags": ["go", "gccgo"], "comments": [{"owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "edited": false, "score": 0, "creation_date": 1462426723, "post_id": 37039196, "comment_id": 61635087, "body": "Sounds like a bug in gccgo. Did you report it? <a href=\"https://github.com/golang/go/issues\" rel=\"nofollow noreferrer\">github.com/golang/go/issues</a>"}, {"owner": {"reputation": 235, "user_id": 4017439, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-v6-6SQOeGVI/AAAAAAAAAAI/AAAAAAAAABg/Scha2K5nzuM/photo.jpg?sz=128", "display_name": "Iskander Sharipov", "link": "https://stackoverflow.com/users/4017439/iskander-sharipov"}, "edited": false, "score": 0, "creation_date": 1515781510, "post_id": 37039196, "comment_id": 83446342, "body": "I found no existing issues for this. Created one, just in case: <a href=\"https://github.com/golang/go/issues/23433\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/23433</a>."}], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 2774002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ntpn9.gif?s=128&g=1", "display_name": "Ian Lance Taylor", "link": "https://stackoverflow.com/users/2774002/ian-lance-taylor"}, "is_accepted": false, "score": 2, "last_activity_date": 1515792652, "creation_date": 1515792652, "answer_id": 48234266, "question_id": 37039196, "link": "https://stackoverflow.com/questions/37039196/delete-element-from-slice-difference-gccgo-vs-gc/48234266#48234266", "title": "delete element from slice difference gccgo vs gc", "body": "<p>I believe that gccgo is correct here according to the language spec.  This is <a href=\"https://golang.org/issue/23188\" rel=\"nofollow noreferrer\">https://golang.org/issue/23188</a>.</p>\n"}], "owner": {"reputation": 101, "user_id": 5173765, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fae46355682a461a162f8d30ab3300ed?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/5173765/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1515792652, "creation_date": 1462401272, "question_id": 37039196, "link": "https://stackoverflow.com/questions/37039196/delete-element-from-slice-difference-gccgo-vs-gc", "title": "delete element from slice difference gccgo vs gc", "body": "<p>I found a really strange issue with GCCGO and I was wondering if someone could explain it. </p>\n\n<p>I'm trying to delete an element from a slice by index using the suggested slice tricks (<a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow\">https://github.com/golang/go/wiki/SliceTricks</a>). </p>\n\n<p>The following code (<a href=\"https://play.golang.org/p/f039m1h7Z1\" rel=\"nofollow\">https://play.golang.org/p/f039m1h7Z1</a>): </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    xs := []int{0,1,2,3,4}\n    i := 2\n    xs, xs[len(xs)-1] = append(xs[:i], xs[i+1:]...), 0\n    fmt.Println(xs)\n}\n</code></pre>\n\n<p>Works with the go compiler (go run), but when I try to compile it with     </p>\n\n<pre><code>gccgo -g -static-libgcc \n</code></pre>\n\n<p>I get a </p>\n\n<pre><code>panic: runtime error: index out of range \n</code></pre>\n\n<p>at the line:</p>\n\n<pre><code>    xs, xs[len(xs)-1] = append(xs[:i], xs[i+1:]...), 0\n</code></pre>\n\n<p>Why is this happening? </p>\n\n<p>Note: I'm writing <code>xs[len(xs)-1] = 0</code> because in my full use case, this is actually a slice of pointers to structs, so according to the slice tricks, I need to make the final pointer null in the old slice to prevent memory leaks. </p>\n"}, {"tags": ["json", "xml", "go", "struct", "output"], "comments": [{"owner": {"reputation": 137436, "user_id": 415448, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/P2vVZ.png?s=128&g=1", "display_name": "Michael Kay", "link": "https://stackoverflow.com/users/415448/michael-kay"}, "edited": false, "score": 0, "creation_date": 1462405337, "post_id": 37038752, "comment_id": 61629622, "body": "It would be much more interesting to see the specification than the code. Converting JSON to some kind of XML is trivial; the challenge is designing a conversion that is capable of handling edge cases (e.g. JSON containing characters that aren&#39;t valid in XML) without producing unusable results in &quot;ordinary&quot; cases."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1462399840, "creation_date": 1462399840, "answer_id": 37038939, "question_id": 37038752, "link": "https://stackoverflow.com/questions/37038752/converting-from-json-to-xml/37038939#37038939", "title": "Converting from JSON to XML", "body": "<p>This is the same process as going in the other direction. Define structs/objects to model the input (be it json in this case), create method to assign all the values from the struct modeling the input to the one you're using for output, then marshal the output to get a string. So to give a practice example using one of the more conceptually difficult fields from you type, having unmarshalled some json into an instance of <code>reportTypeJson</code> I can assign to <code>reportType</code> used to model xml like so;</p>\n\n<pre><code>report.StateName = jsonReport.CurrentObservation[\"display_location\"][\"state_name\"]\n</code></pre>\n\n<p>The biggest difference here is the struct representing your xml is flat (like it has Something>InnerSomething>InnerInnerSomething to represent it's nested values while the struct in golang has no nesting) where as with the json, your structures in golang tend to have the same amount of nesting (like having a map[string]map[string][string] meaning items are nested 3 levels inside of the main struct). You can observe this by the amount of indirection when you access fields, like in the example above, there is one level of indirection to access <code>CurrentObservation</code> but that is a map of maps, so then I index into it with the <code>display_location</code> key which yields a <code>map[string]string</code>, since I'm looking for the statename value, I have to index into that with <code>state_name</code> to access that value.</p>\n\n<p>Note that in an actual program, a number of checks would be required because these operations are unsafe. For example, if the json read did not contain a <code>display_location</code> object then <code>jsonReport.CurrentObservation[\"display_location\"]</code> would return <code>nil</code> and the attempt to access <code>[\"state_name\"</code> would result in a panic.</p>\n\n<p>Also, another side note, in your program I would recommend adding two functions, one called <code>NewJsonReport(report *reportType) *reportTypeJson, err</code> and one called <code>NewXmlReport(report *reportTypeJson) *reportType, err</code> in which you initialize/allocate the a new instance of the return type and return it as to avoid code duplication and make your programs <code>main</code> more readable. Doing this type of assignment in more than one location in a program is sloppy coding which will add a lot of maintenance cost and is likely to result in bugs down the line (like if something changes on one of the models or the input you have to fix every reference to it throughout the program rather than just updating the functions I mentioned above).</p>\n"}], "owner": {"reputation": 141, "user_id": 6100438, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/906a7ce7929a333335af52c0a5c2042d?s=128&d=identicon&r=PG&f=1", "display_name": "Becca Bohem", "link": "https://stackoverflow.com/users/6100438/becca-bohem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 538, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462399840, "creation_date": 1462398892, "last_edit_date": 1462399386, "question_id": 37038752, "link": "https://stackoverflow.com/questions/37038752/converting-from-json-to-xml", "title": "Converting from JSON to XML", "body": "<p>I have seen lots of posts on here about converting from XML to JSON, and I've recently wrote a program to do so, but I was also curious how you would go about converting from JSON to XML?</p>\n\n<p>Sample JSON:</p>\n\n<pre><code>\"version\":\"0.1\",\n  \"termsofService\":\"http://www.wunderground.com/weather/api/d/terms.html\",\n  \"features\": {\n  \"conditions\": 1\n  }\n    }\n  , \"current_observation\": {\n        \"image\": {\n        \"url\":\"http://icons.wxug.com/graphics/wu2/logo_130x80.png\",\n        \"title\":\"Weather Underground\",\n        \"link\":\"http://www.wunderground.com\"\n        },\n        \"display_location\": {\n        \"full\":\"Kearney, MO\",\n        \"city\":\"Kearney\",\n        \"state\":\"MO\",\n        \"state_name\":\"Missouri\",\n</code></pre>\n\n<p>I'm not sure if it'd be any use to you, but i'll post my JSON to XML program.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n    \"encoding/xml\"\n    \"net/http\"\n    \"log\"\n    \"io/ioutil\"\n    \"encoding/json\"\n)\n\ntype reportType struct{\n    Version xml.CharData        `xml:\"version\"`\n    TermsOfService xml.CharData `xml:\"termsofService\"\n    `\n    Features xml.CharData       `xml:\"features&gt;feature\"`\n    Full     string     `xml:\"current_observation&gt;display_location&gt;full\"`\n    StateName string        `xml:\"current_observation&gt;display_location&gt;state_name\"`\n    WindGust string     `xml:\"current_observation&gt;observation_location&gt;full\"`\n    Problem myErrorType     `xml:\"error\"`\n}\ntype myErrorType struct{\n    TypeOfError xml.CharData `xml:\"type\"`\n    Desciption xml.CharData `xml:\"description\"`\n}\ntype reportTypeJson struct{\n    Version        string  `json:\"version\"`;\n    TermsOfService string `json:\"termsofService\"`;\n    Features    map[string]string `json:\"features\"`;\n    CurrentObservation map[string]map[string]string `json:\"current_observation\"`\n\n}\nfunc main() {\n    fmt.Println(\"data is from WeatherUnderground.\")\n    fmt.Println(\"https://www.wunderground.com/\")\n    var state, city string\n    str1 := \"What is your state?\"\n    str2 := \"What is your city?\"\n    fmt.Println(str1)\n    fmt.Scanf(\"%s\", &amp;state)\n    fmt.Println(str2)\n    fmt.Scanf(\"%s\", &amp;city)\n    baseURL := \"http://api.wunderground.com/api/\";\n    apiKey := \"Nunna\"\n    var query string\n\n    //set up the query\n    query = baseURL+apiKey +\n    \"/conditions/q/\"+\n    url.QueryEscape(state)+ \"/\"+\n    url.QueryEscape(city)+ \".xml\"\n    fmt.Println(\"The escaped query: \"+query)\n\n    response, err := http.Get(query)\n    doErr(err, \"After the GET\")\n    var body []byte\n    body, err = ioutil.ReadAll(response.Body)\n    doErr(err, \"After Readall\")\n    fmt.Println(body);\n    fmt.Printf(\"The body: %s\\n\",body)\n\n    //Unmarshalling\n    var report reportType\n    xml.Unmarshal(body, &amp;report)\n    fmt.Printf(\"The Report: %s\\n\", report)\n    fmt.Printf(\"The description is [%s]\\n\",report.Problem.Desciption)\n\n    //Now marshal the data out in JSON\n    var data []byte\n    var output reportTypeJson\n    output.Version = string(report.Version);\n    output.TermsOfService = string(report.TermsOfService)\n\n    output.Features= map[string]string{\"feature\":string(report.Features)} // allocate a map, add the 'features' value to it and assign it to output.Features\n    output.CurrentObservation = map[string]map[string]string {\n        \"display_location\": map[string]string {\n            \"full\": report.Full,\n            \"state_name\": report.StateName,\n        },\"observation_location\":map[string]string {\"full\": report.WindGust},\n    }\n    data,err = json.MarshalIndent(output,\"\",\"      \")\n    doErr(err, \"From marshalIndent\")\n    fmt.Printf(\"JSON output nicely formatted: \\n%s\\n\",data)\n\n\n}\nfunc doErr( err error, message string){\n    if err != nil{\n        log.Panicf(\"ERROR: %s %s \\n\", message, err.Error())\n    }\n\n\n}\n//OUTPUT:\n//JSON output nicely formatted: \n//{\n//     \"version\": \"0.1\",\n//      \"termsofService\": \"http://www.wunderground.com/weather/api/d/terms.html\",\n//      \"features\": {\n//            \"feature\": \"conditions\"\n//      },\n//      \"current_observation\": {\n//            \"display_location\": {\n//                  \"full\": \"Kearney, MO\",\n//                  \"state_name\": \"Missouri\"\n//            },\n//            \"observation_location\": {\n//                  \"full\": \"HOMESTEAD HILLS, Kearney, Missouri\"\n//            }\n//      }\n//}\n</code></pre>\n"}, {"tags": ["go", "beego"], "answers": [{"comments": [{"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1462916373, "post_id": 37088112, "comment_id": 61836861, "body": "It seems strange that GOPATH is causing you problems. Also it is strange that you have different GOPATHs for different Go versions. I think that your setup might not comply with the expectations of the Go tool. When running your app, IntelliJ will print the GOPATH it&#39;s using as well as the GOROOT and you have control in the runner configuration over the current working directory. Might worth to check those. If you nwed any help, please ping me on Gitter. Thanks."}, {"owner": {"reputation": 8826, "user_id": 10245, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2909c1103b9ceba6c8933c85dc4f803?s=128&d=identicon&r=PG", "display_name": "Tim Abell", "link": "https://stackoverflow.com/users/10245/tim-abell"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1463002346, "post_id": 37088112, "comment_id": 61881930, "body": "wow, thanks. the whole gopath and expectations about src completely threw me starting out with go. I have most of my stuff in <code>~&#47;repo&#47;proj.git&#47;*</code> which also doesn&#39;t make go happy. gvm seems like a good idea, but maybe it isn&#39;t."}, {"owner": {"reputation": 8826, "user_id": 10245, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2909c1103b9ceba6c8933c85dc4f803?s=128&d=identicon&r=PG", "display_name": "Tim Abell", "link": "https://stackoverflow.com/users/10245/tim-abell"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1466294942, "post_id": 37088112, "comment_id": 63258492, "body": "the answer might be to use multiple gopaths - <a href=\"https://medium.com/@mnmtanish/using-multiple-gopaths-4b267dcca3f8\" rel=\"nofollow noreferrer\">medium.com/@mnmtanish/using-multiple-gopaths-4b267dcca3f8</a>"}], "tags": [], "owner": {"reputation": 8826, "user_id": 10245, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2909c1103b9ceba6c8933c85dc4f803?s=128&d=identicon&r=PG", "display_name": "Tim Abell", "link": "https://stackoverflow.com/users/10245/tim-abell"}, "is_accepted": true, "score": 1, "last_activity_date": 1466294497, "last_edit_date": 1466294497, "creation_date": 1462621563, "answer_id": 37088112, "question_id": 37038416, "link": "https://stackoverflow.com/questions/37038416/beego-not-finding-layout-tpl-file-with-bee-run/37088112#37088112", "title": "beego not finding layout tpl file with bee run", "body": "<p><code>GOPATH</code>. Again. Typical that I post a bounty and then promptly figure it out eh?</p>\n\n<p>IntelliJ keeps it's own copy of the <code>GOPATH</code> information in <code>.idea/*.iml</code></p>\n\n<pre><code>&lt;orderEntry type=\"library\" name=\"GOPATH &amp;lt;web&amp;gt;\" level=\"project\" /&gt;\n</code></pre>\n\n<p>I'm running <a href=\"https://github.com/moovweb/gvm\" rel=\"nofollow\">gvm</a> to manage go versions, and in order to have packages installed in the right place globally my go path is as follows:</p>\n\n<pre><code>$ echo $GOPATH\n/home/tim/.gvm/pkgsets/go1.4.3/global\n</code></pre>\n\n<p>This however means I'd have to move my src every time I switched go versions. To get round that I've used <code>gvm linkthis</code> to symlink my src into the gvm folder so that my source is in the GOPATH as go expects to find it. The downside of that is that I have to <code>cd</code> to <code>$GOPATH/src/project/</code> before hitting <code>bee run</code> and not just run it from the real location (which is what I'd done). Without that it finds the .go files but not the layout. I'm not 100% sure why but it makes some sense.</p>\n\n<p>It seems like a lot of yak shaving to make it all work so maybe I'm missing something?</p>\n"}], "owner": {"reputation": 8826, "user_id": 10245, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a2909c1103b9ceba6c8933c85dc4f803?s=128&d=identicon&r=PG", "display_name": "Tim Abell", "link": "https://stackoverflow.com/users/10245/tim-abell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 37088112, "answer_count": 1, "score": 4, "last_activity_date": 1466294497, "creation_date": 1462397535, "question_id": 37038416, "link": "https://stackoverflow.com/questions/37038416/beego-not-finding-layout-tpl-file-with-bee-run", "title": "beego not finding layout tpl file with bee run", "body": "<p>I've built a rudimentary layout based site in golang with <a href=\"http://beego.me/\" rel=\"nofollow\">beego</a>, I've split my page layout into a file called <code>views/_layout.tpl</code> and referenced it as below from a controller.</p>\n\n<pre><code>func (c *BuyerController) Get() {\n    ...\n    c.Layout = \"_layout.tpl\"\n    c.TplName = \"buyers.tpl\"\n}\n</code></pre>\n\n<p>The layout has in the middle of it the required line:</p>\n\n<pre><code>    {{.LayoutContent}}\n</code></pre>\n\n<p>The strange thing is that when I run the web server with IDEA/IntelliJ it renders just fine in the browser, but when I run it from the console with <code>bee run</code> all the html from the layout file is missing and just the contents of <code>buyers.tpl</code> is shown.</p>\n\n<p>I've run each build of the compiled app and it the same happens, the one built by IntelliJ works, and the one built by <code>bee run</code> doesn't.</p>\n\n<p>As far as I can see I've followed <a href=\"http://beego.me/docs/mvc/view/view.md#layout-design\" rel=\"nofollow\">http://beego.me/docs/mvc/view/view.md#layout-design</a></p>\n\n<p>Any ideas what I've done wrong, or any clues how to figure it out? Thanks.</p>\n"}, {"tags": ["cookies", "go", "cookiejar"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462397055, "post_id": 37037773, "comment_id": 61626608, "body": "Your <code>CookieJar</code> implementation looks good to me. Are you sure <code>client.PostForm</code> succeeded? You&#39;re ignoring the error there/not checking status code so I think it&#39;s safe to assume something outside of this code could have caused the failure like invalid credentials."}, {"owner": {"reputation": 2337, "user_id": 600061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bbac8bb4d3ffbceca42b09eb0729e63c?s=128&d=identicon&r=PG", "display_name": "Twisted1919", "link": "https://stackoverflow.com/users/600061/twisted1919"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462427551, "post_id": 37037773, "comment_id": 61635417, "body": "@evanmcdonnal - Yeah, the PostForm is fine, no error there."}], "answers": [{"tags": [], "owner": {"reputation": 2337, "user_id": 600061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bbac8bb4d3ffbceca42b09eb0729e63c?s=128&d=identicon&r=PG", "display_name": "Twisted1919", "link": "https://stackoverflow.com/users/600061/twisted1919"}, "is_accepted": true, "score": 3, "last_activity_date": 1462429605, "creation_date": 1462429605, "answer_id": 37043843, "question_id": 37037773, "link": "https://stackoverflow.com/questions/37037773/use-golang-to-login-to-private-site-and-pull-info/37043843#37043843", "title": "Use Golang to login to private site and pull info", "body": "<p>Ok, the issue is the cookie jar implementation, more specifically the SetCookies function, which right now is:</p>\n\n<pre><code>func (jar *Jar) SetCookies(u *url.URL, cookies []*http.Cookie) {\n    jar.Lock()\n    jar.cookies[u.Host] = cookies\n    jar.Unlock()\n}\n</code></pre>\n\n<p>And this is wrong because new cookies instead of being added to the existing ones they will simply be added as new discarding the old ones.</p>\n\n<p>It seems the right way to do this is:</p>\n\n<pre><code>func (jar *Jar) SetCookies(u *url.URL, cookies []*http.Cookie) {\n    jar.Lock()\n    if _, ok := jar.cookies[u.Host]; ok {\n        for _, c := range cookies {\n            jar.cookies[u.Host] = append(jar.cookies[u.Host], c)\n        }\n    } else {\n        jar.cookies[u.Host] = cookies\n    }\n    jar.Unlock()\n}\n</code></pre>\n"}], "owner": {"reputation": 2337, "user_id": 600061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bbac8bb4d3ffbceca42b09eb0729e63c?s=128&d=identicon&r=PG", "display_name": "Twisted1919", "link": "https://stackoverflow.com/users/600061/twisted1919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2574, "favorite_count": 0, "accepted_answer_id": 37043843, "answer_count": 1, "score": 2, "last_activity_date": 1462429605, "creation_date": 1462395069, "question_id": 37037773, "link": "https://stackoverflow.com/questions/37037773/use-golang-to-login-to-private-site-and-pull-info", "title": "Use Golang to login to private site and pull info", "body": "<p>I try to use golang to login in a private area of a website and pull some info, but i don't quite seem to get it right.\nI manage to fetch the login page to get the csrf token, then i post the csrf token together with the login info to the login page and i login just fine. If i stop at this point, i can see the page where i am redirected. However, any subsequent calls from this point on will redirect me back to login.</p>\n\n<p>The code</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/PuerkitoBio/goquery\"\n    \"io\"\n    _ \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"net/url\"\n    _ \"strings\"\n    \"sync\"\n)\n\ntype Jar struct {\n    sync.Mutex\n    cookies map[string][]*http.Cookie\n}\n\nfunc NewJar() *Jar {\n    jar := new(Jar)\n    jar.cookies = make(map[string][]*http.Cookie)\n    return jar\n}\n\nfunc (jar *Jar) SetCookies(u *url.URL, cookies []*http.Cookie) {\n    jar.Lock()\n    jar.cookies[u.Host] = cookies\n    jar.Unlock()\n}\n\nfunc (jar *Jar) Cookies(u *url.URL) []*http.Cookie {\n    return jar.cookies[u.Host]\n}\n\nfunc NewJarClient() *http.Client {\n    return &amp;http.Client{\n        Jar: NewJar(),\n    }\n}\n\nfunc fetch(w http.ResponseWriter, r *http.Request) {\n\n    // create the client\n    client := NewJarClient()\n\n    // get the csrf token\n    req, _ := http.NewRequest(\"GET\", \"http://www.domain.com/login\", nil)\n    resp, err := client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    doc, err := goquery.NewDocumentFromResponse(resp)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    csrfToken := \"\"\n    if val, ok := doc.Find(`head meta[name=\"csrf-token-value\"]`).Attr(\"content\"); ok {\n        csrfToken = val\n    }\n\n    // post on the login form.\n    resp, _ = client.PostForm(\"http://www.domain.com/login\", url.Values{\n        \"UserLogin[email]\":    {\"the email\"},\n        \"UserLogin[password]\": {\"the password\"},\n        \"csrf_token\":          {csrfToken},\n    })\n\n    doc, err = goquery.NewDocumentFromResponse(resp)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // if i stop here then i can see just fine the dashboard where i am redirected after login.\n    // but if i continue and request a 3rd page, then i get the login page again,\n    // sign that i lose the cookies and i am redirected back\n\n    // html, _ := doc.Html()\n    // io.WriteString(w, html)\n    // return\n\n    // from this point on, any request will give me the login page once again.\n    // i am not sure why since the cookies should be set and sent on all requests\n    req, _ = http.NewRequest(\"GET\", \"http://www.domain.com/dashboard\", nil)\n    resp, err = client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    doc, err = goquery.NewDocumentFromResponse(resp)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    html, _ := doc.Html()\n    io.WriteString(w, html)\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", fetch)\n    http.ListenAndServe(\"127.0.0.1:49721\", nil)\n}\n</code></pre>\n\n<p>Any idea what i am missing here ?</p>\n"}, {"tags": ["intellij-idea", "go"], "comments": [{"owner": {"reputation": 22031, "user_id": 13263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/938b7f6d039125f37271fd42104fbf37?s=128&d=identicon&r=PG", "display_name": "slf", "link": "https://stackoverflow.com/users/13263/slf"}, "edited": false, "score": 0, "creation_date": 1462394661, "post_id": 37037467, "comment_id": 61625421, "body": "I don&#39;t know about the plugin, but there ought to be a way to point the plugin at a shell script that checks for an environment variable or dot file instead of the raw golint"}], "answers": [{"comments": [{"owner": {"reputation": 1155, "user_id": 4641854, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ebe283afcbdb0e4a9d1f20e26e969de1?s=128&d=identicon&r=PG", "display_name": "jeromefroe", "link": "https://stackoverflow.com/users/4641854/jeromefroe"}, "edited": false, "score": 0, "creation_date": 1462403141, "post_id": 37038105, "comment_id": 61628948, "body": "Thanks! I was able to make this work by creating an External Tool like you suggested and then mapping it to a Keyboard Shortcut. Now I can control when <code>go fmt</code>, <code>golint</code>, <code>goimports</code>, etc. are run. I&#39;ll have to try it out to see how I like it versus it being automatic when I save. I&#39;m going to leave the answer open for now just to see if anyone has encountered the same problem with File Watchers and found a solution."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 2, "last_activity_date": 1462396309, "creation_date": 1462396309, "answer_id": 37038105, "question_id": 37037467, "link": "https://stackoverflow.com/questions/37037467/use-intellij-file-watcher-only-on-open-file/37038105#37038105", "title": "Use Intellij File Watcher only on Open File", "body": "<p>Instead of file watcher you can get <a href=\"https://www.jetbrains.com/help/idea/2016.1/external-tools.html?origin=old_help\" rel=\"nofollow\">External tools</a> configured to achieve almost the same functionality. The only difference is that this won't run on save but rather you'll have to trigger this manually. Or you could configure a macro to run them on save (but I don't have experience with macros + external tools so I'm not if this will work).</p>\n"}, {"comments": [{"owner": {"reputation": 1155, "user_id": 4641854, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ebe283afcbdb0e4a9d1f20e26e969de1?s=128&d=identicon&r=PG", "display_name": "jeromefroe", "link": "https://stackoverflow.com/users/4641854/jeromefroe"}, "edited": false, "score": 0, "creation_date": 1462453211, "post_id": 37041229, "comment_id": 61649794, "body": "I don&#39;t seem to have the <code>Open Files</code> option in the <code>Scope</code> drop-down menu under <code>Watcher Settings</code>. I&#39;m using the Community Edition though, do you know if it&#39;s only available in the payed version? I checked the docs but didn&#39;t see any distinctions made between the two. I posted a screenshot of what the drop down looks to me to <a href=\"https://s3.amazonaws.com/jeromefroe/Screen+Shot+2016-05-05+at+8.43.05+AM.png\" rel=\"nofollow noreferrer\">AWS S3</a> if that helps. Thanks!"}, {"owner": {"reputation": 1847, "user_id": 391464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1XdRz.png?s=128&g=1", "display_name": "yee", "link": "https://stackoverflow.com/users/391464/yee"}, "reply_to_user": {"reputation": 1155, "user_id": 4641854, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ebe283afcbdb0e4a9d1f20e26e969de1?s=128&d=identicon&r=PG", "display_name": "jeromefroe", "link": "https://stackoverflow.com/users/4641854/jeromefroe"}, "edited": false, "score": 0, "creation_date": 1462464454, "post_id": 37041229, "comment_id": 61657434, "body": "@JeromeFroelich I&#39;m using the latest version of IDEA Community 2016.1 with File Watcher plugin 145.28, have no idea why you doesn&#39;t have this option."}, {"owner": {"reputation": 1155, "user_id": 4641854, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ebe283afcbdb0e4a9d1f20e26e969de1?s=128&d=identicon&r=PG", "display_name": "jeromefroe", "link": "https://stackoverflow.com/users/4641854/jeromefroe"}, "edited": false, "score": 0, "creation_date": 1462469505, "post_id": 37041229, "comment_id": 61660380, "body": "that did! Thanks! I was using the 2015 edition, once I downloaded the 2016 edition the option appeared."}], "tags": [], "owner": {"reputation": 1847, "user_id": 391464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1XdRz.png?s=128&g=1", "display_name": "yee", "link": "https://stackoverflow.com/users/391464/yee"}, "is_accepted": true, "score": 4, "last_activity_date": 1462464503, "last_edit_date": 1462464503, "creation_date": 1462414618, "answer_id": 37041229, "question_id": 37037467, "link": "https://stackoverflow.com/questions/37037467/use-intellij-file-watcher-only-on-open-file/37041229#37041229", "title": "Use Intellij File Watcher only on Open File", "body": "<p>Open <code>Watcher setting</code> -> <code>Scope</code> , change it to <code>Open Files</code>\n<a href=\"https://i.stack.imgur.com/ouiAX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ouiAX.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you wanna more control over the plugin, you can have a look at the <a href=\"https://www.jetbrains.com/help/idea/2016.1/using-file-watchers.html\" rel=\"nofollow noreferrer\">official doc</a></p>\n"}], "owner": {"reputation": 1155, "user_id": 4641854, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ebe283afcbdb0e4a9d1f20e26e969de1?s=128&d=identicon&r=PG", "display_name": "jeromefroe", "link": "https://stackoverflow.com/users/4641854/jeromefroe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 1, "accepted_answer_id": 37041229, "answer_count": 2, "score": 1, "last_activity_date": 1462464503, "creation_date": 1462393855, "question_id": 37037467, "link": "https://stackoverflow.com/questions/37037467/use-intellij-file-watcher-only-on-open-file", "title": "Use Intellij File Watcher only on Open File", "body": "<p>I've been using the Intellij Golang plugin recently (it's great) but I've been running into an issue with the File Watchers I set up. My working directory is set to my <code>$GOPATH</code> directory and I would like to be able to run <code>golint</code> and <code>goimports</code> after I save a file I'm working on. The issue I have is if I use git to clone a repo the next time I open Intellij it runs both <code>golint</code> and <code>goimports</code> on all the newly imported files which can take a long time for large projects. Is there a way to set up File Watcher so it only watches a file that is currently open? I added a screenshot of my current settings below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/i4Jws.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i4Jws.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go", "google-bigquery"], "answers": [{"comments": [{"owner": {"reputation": 115571, "user_id": 5221944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iqXab.png?s=128&g=1", "display_name": "Mikhail Berlyant", "link": "https://stackoverflow.com/users/5221944/mikhail-berlyant"}, "reply_to_user": {"reputation": 509, "user_id": 5855483, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-DY7shgLgls8/AAAAAAAAAAI/AAAAAAAAABo/T2Z_XtPcG6c/photo.jpg?sz=128", "display_name": "Rui Yang", "link": "https://stackoverflow.com/users/5855483/rui-yang"}, "edited": false, "score": 0, "creation_date": 1462732233, "post_id": 37037208, "comment_id": 61748702, "body": "Great! If answer helped you to solve your problem - you can consider accepting it. You should also consider voting it up. See more at <a href=\"http://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a> and Upvote section in <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work#5235\" title=\"how does accepting an answer work%235235\">meta.stackexchange.com/questions/5234/&hellip;</a>"}], "tags": [], "owner": {"reputation": 115571, "user_id": 5221944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iqXab.png?s=128&g=1", "display_name": "Mikhail Berlyant", "link": "https://stackoverflow.com/users/5221944/mikhail-berlyant"}, "is_accepted": true, "score": 3, "last_activity_date": 1462392897, "creation_date": 1462392897, "answer_id": 37037208, "question_id": 37037096, "link": "https://stackoverflow.com/questions/37037096/golang-google-bigquery-v2-api-to-specify-the-destination-table/37037208#37037208", "title": "golang google-bigquery v2 api to specify the destination table", "body": "<p>See documentation here <a href=\"https://godoc.org/google.golang.org/api/bigquery/v2\" rel=\"nofollow\">package bigquery</a></p>\n\n<p>Below is simple example. Hope this will give you right direction  </p>\n\n<pre><code>import \"google.golang.org/api/bigquery/v2\"\n\nbigqueryService, err := bigquery.New(oauthHttpClient)\n\nif(err != nil) {\n    return \"ERROR\"\n}\n\nvar projectId = \"your-project\"\nvar datasetId = \"your-dataset\"\nvar tableId = \"your-table\"\nvar queryText = \"your-query\"\nvar writeDisposition = \"WRITE_TRUNCATE\"\n\njob := &amp;bigquery.Job{\n    Configuration: &amp;bigquery.JobConfiguration{\n        Query: &amp;bigquery.JobConfigurationQuery{\n            DestinationTable: &amp;bigquery.TableReference{\n                DatasetId: datasetId,\n                ProjectId: projectId,\n                TableId:   tableId,\n            },\n            Query:    queryText,\n            WriteDisposition: writeDisposition,\n        },\n    },\n}\n\ncall := bigqueryService.Jobs.Insert(projectId, job)\njob, err2 := call.Do()\nif err2 != nil {\n    return \"ERROR\"\n}\n\n//check job status\nvar jobid = job.JobReference.JobId\nbqjob, err3 := bigqueryService.Jobs.Get(projectId, jobid).Do()\nif(err3 != nil) {\n    return \"ERROR\"\n}\n</code></pre>\n"}], "owner": {"reputation": 509, "user_id": 5855483, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-DY7shgLgls8/AAAAAAAAAAI/AAAAAAAAABo/T2Z_XtPcG6c/photo.jpg?sz=128", "display_name": "Rui Yang", "link": "https://stackoverflow.com/users/5855483/rui-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 37037208, "answer_count": 1, "score": 3, "last_activity_date": 1462393239, "creation_date": 1462392531, "last_edit_date": 1462393239, "question_id": 37037096, "link": "https://stackoverflow.com/questions/37037096/golang-google-bigquery-v2-api-to-specify-the-destination-table", "title": "golang google-bigquery v2 api to specify the destination table", "body": "<p>I am trying to using the google bigquery v2 api to run a query job and store the query resultset into another bigquery table, I did not find any doc or example on how to do it in the go wrapper of the v2 api. I can see there is a way to specify the destination table in the raw REST api payload, but need to make it working in the go.</p>\n"}, {"tags": ["json", "xml", "go", "nested", "output"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 6100438, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/906a7ce7929a333335af52c0a5c2042d?s=128&d=identicon&r=PG&f=1", "display_name": "Becca Bohem", "link": "https://stackoverflow.com/users/6100438/becca-bohem"}, "edited": false, "score": 0, "creation_date": 1462394004, "post_id": 37037167, "comment_id": 61625107, "body": "Okay the map of maps was what I thought might work, but how would I go about creating it?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 141, "user_id": 6100438, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/906a7ce7929a333335af52c0a5c2042d?s=128&d=identicon&r=PG&f=1", "display_name": "Becca Bohem", "link": "https://stackoverflow.com/users/6100438/becca-bohem"}, "edited": false, "score": 0, "creation_date": 1462395580, "post_id": 37037167, "comment_id": 61625915, "body": "@BeccaBohem you can use composite literal syntax here too, it&#39;s just a bit more complicated as there&#39;s an additional level of nesting. Here&#39;s an example on play, I&#39;ll also edit with a snippet. <a href=\"https://play.golang.org/p/yO21iZMBfy\" rel=\"nofollow noreferrer\">play.golang.org/p/yO21iZMBfy</a>"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 2, "last_activity_date": 1462395664, "last_edit_date": 1462395664, "creation_date": 1462392758, "answer_id": 37037167, "question_id": 37036945, "link": "https://stackoverflow.com/questions/37036945/xml-into-json-multiple-nesting/37037167#37037167", "title": "XML into JSON Multiple Nesting", "body": "<p>You could use either structs or a map of maps. I'll give some examples of both, starting with the map of maps. The type would be declares as;</p>\n\n<pre><code>CurrentObservation map[string]map[string]string `json:\"current_observation\"`\n</code></pre>\n\n<p>In this case you have a map with strings as the keys and the value is another map that has string for both key and value. As a result when you marshal your json you will end up with something like;</p>\n\n<pre><code>\"current_observation\" {\n     \"image\": { // first level where the value is a map[string]string\n          \"title\":\"Weather Underground\" // inner map, string to string\n      }\n}\n</code></pre>\n\n<p>If say you wanted to just print the title, you would do;</p>\n\n<pre><code>fmt.Println(reportJson.CurrentObservation[\"image\"][\"title\"])\n</code></pre>\n\n<p>Since the data there looks fairly static you could also use structs instead. In which case you'd use something like this;</p>\n\n<pre><code>CurrentObservation CurrentObservation `json:\"current_observation\"`\n\ntype CurrentObservation struct {\n    Image Image `json:\"image\"`\n}\n\ntype Image struct {\n    Url string `json:\"url\"`\n    Title string `json:\"title\"`\n    Link string `json:\"link\"`\n}\n</code></pre>\n\n<p>Both options produce the same output though they could behave differently for different inputs. For example, if another version of <code>current_observation</code> were received as input that for example has another nested item in it call it... <code>previous_observation</code> then the map option would automatically unmarhsal this data as well where the struct options would exclude it since there would be no mapping to any object/type in Go.</p>\n\n<p>Personally I prefer the struct route when possible but it varies from case to case. For your application the map is likely better since you're not working with the input (it comes in as xml) and you just want to print it, you don't really have to deal with the details of <code>current_observation</code>, if it has 3 objects inside it, they'll all be output as expected, if it were 5 it would be the same. With the structs you have to explicitly define every single field which isn't really necessary if you're just transforming the input. The advantage of the struct is more for use later on where you have type safety although in this case, I would say they're still fairly equivalent because for example anytime you want to access something in image, like <code>CurrentObservation.Image.Title</code> you'll have to perform a check to ensure Image is not nil, like;</p>\n\n<pre><code>if CurrentObservation.Image != nil {\n    fmt.Println(CurrentObservation.Image.Title)\n}\n</code></pre>\n\n<p>With the map you basically have the same overhead, only you're checking for the existence of a key rather than checking if one of the inner structs is nil or not.</p>\n\n<p>EDIT: example of initializing the map of maps using composite literal syntax;</p>\n\n<pre><code>   reportJson.CurrentObservation := map[string]map[string]string {\n           \"display_location\": map[string]string {\n                \"full\": report.Full,\n                \"state_name\": report.StateName,\n            },\n    }\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 6100438, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/906a7ce7929a333335af52c0a5c2042d?s=128&d=identicon&r=PG&f=1", "display_name": "Becca Bohem", "link": "https://stackoverflow.com/users/6100438/becca-bohem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 1, "accepted_answer_id": 37037167, "answer_count": 1, "score": 1, "last_activity_date": 1462395961, "creation_date": 1462391929, "last_edit_date": 1462395961, "question_id": 37036945, "link": "https://stackoverflow.com/questions/37036945/xml-into-json-multiple-nesting", "title": "XML into JSON Multiple Nesting", "body": "<p>I'm attempting to write code to translate XML to JSON. The XML I'm trying to translate is as follows...</p>\n\n<p>(Just a snippet)</p>\n\n<pre><code>`&lt;version&gt;0.1&lt;/version&gt;\n    &lt;termsofService&gt;http://www.wunderground.com/weather/api/d/terms.html&lt;/termsofService&gt;\n    &lt;features&gt;\n        &lt;feature&gt;conditions&lt;/feature&gt;\n    &lt;/features&gt;\n  &lt;current_observation&gt;\n        &lt;image&gt;\n        &lt;url&gt;http://icons.wxug.com/graphics/wu2/logo_130x80.png&lt;/url&gt;\n        &lt;title&gt;Weather Underground&lt;/title&gt;\n        &lt;link&gt;http://www.wunderground.com&lt;/link&gt;\n        &lt;/image&gt;\n        &lt;display_location&gt;\n        &lt;full&gt;Kearney, MO&lt;/full&gt;\n        &lt;city&gt;Kearney&lt;/city&gt;\n        &lt;state&gt;MO&lt;/state&gt;\n        &lt;state_name&gt;Missouri&lt;/state_name&gt;`\n</code></pre>\n\n<p>Current Code:</p>\n\n<pre><code>`package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n    \"encoding/xml\"\n    \"net/http\"\n    \"log\"\n    \"io/ioutil\"\n    \"encoding/json\"\n)\n\ntype reportType struct{\n    Version xml.CharData        `xml:\"version\"`\n    TermsOfService xml.CharData `xml:\"termsofService\"\n    `\n    Features xml.CharData       `xml:\"features&gt;feature\"`\n    Full     xml.CharData       `xml:\"current_observation&gt;display_location&gt;full\"`\n    StateName xml.CharData      `xml:\"current_observation&gt;display_location&gt;state_name\"`\n    WindGust xml.CharData       `xml:\"current_observation&gt;observation_location&gt;full\"`\n    Problem myErrorType     `xml:\"error\"`\n}\ntype myErrorType struct{\n    TypeOfError xml.CharData `xml:\"type\"`\n    Desciption xml.CharData `xml:\"description\"`\n}\ntype reportTypeJson struct{\n    Version        string  `json:\"version\"`;\n    TermsOfService string `json:\"termsofService\"`;\n    Features    map[string]string `json:\"features\"`;\n    Full        map[string]string `json:\"display_location\"`;\n    WindGust map[string]string `json:\"observation_location\"`\n\n}\nfunc main() {\n    fmt.Println(\"data is from WeatherUnderground.\")\n    fmt.Println(\"https://www.wunderground.com/\")\n    var state, city string\n    str1 := \"What is your state?\"\n    str2 := \"What is your city?\"\n    fmt.Println(str1)\n    fmt.Scanf(\"%s\", &amp;state)\n    fmt.Println(str2)\n    fmt.Scanf(\"%s\", &amp;city)\n    baseURL := \"http://api.wunderground.com/api/\";\n    apiKey := \"3hunna\"\n    var query string\n\n    //set up the query\n    query = baseURL+apiKey +\n    \"/conditions/q/\"+\n    url.QueryEscape(state)+ \"/\"+\n    url.QueryEscape(city)+ \".xml\"\n    fmt.Println(\"The escaped query: \"+query)\n\n    response, err := http.Get(query)\n    doErr(err, \"After the GET\")\n    var body []byte\n    body, err = ioutil.ReadAll(response.Body)\n    doErr(err, \"After Readall\")\n    fmt.Println(body);\n    fmt.Printf(\"The body: %s\\n\",body)\n\n    //Unmarshalling\n    var report reportType\n    xml.Unmarshal(body, &amp;report)\n    fmt.Printf(\"The Report: %s\\n\", report)\n    fmt.Printf(\"The description is [%s]\\n\",report.Problem.Desciption)\n\n    //Now marshal the data out in JSON\n    var data []byte\n    var output reportTypeJson\n    output.Version = string(report.Version);\n    output.TermsOfService = string(report.TermsOfService)\n\n    output.Features= map[string]string{\"feature\":string(report.Features)} // allocate a map, add the 'features' value to it and assign it to output.Features\n    output.Full=map[string]string{\"full\":string(report.Full),\"state_name\":string(report.StateName)}\n    output.WindGust=map[string]string{\"full\":string(report.WindGust)}\n    data,err = json.MarshalIndent(output,\"\",\"      \")\n    doErr(err, \"From marshalIndent\")\n    fmt.Printf(\"JSON output nicely formatted: \\n%s\\n\",data)\n\n\n}\nfunc doErr( err error, message string){\n    if err != nil{\n        log.Panicf(\"ERROR: %s %s \\n\", message, err.Error())\n    }\n\n\n}\n</code></pre>\n\n<p>As you can see, I'm using maps to map one level nesting such as in the <code>features</code> case. But for in two level nesting cases such as <code>xml:\"current_observation&gt;display_location&gt;state_name\"</code>, I can't figure out how to create the very first level, in this case <code>current_observations</code>. Would there be a way to somehow create a map of maps of sorts? Any and all ideas are much appreciated because I am very confused at the moment, Thanks for your time!</p>\n\n<p>And the Output:</p>\n\n<pre><code>JSON output nicely formatted: \n{\n      \"version\": \"0.1\",\n      \"termsofService\": \"http://www.wunderground.com/weather/api/d/terms.html\",\n      \"features\": {\n            \"feature\": \"conditions\"\n      },\n      \"display_location\": {\n            \"full\": \"Kearney, MO\",\n            \"state_name\": \"Missouri\"\n      },\n      \"observation_location\": {\n            \"full\": \"Stonecrest, Kearney, Missouri\"\n      }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1462382183, "post_id": 37033542, "comment_id": 61618230, "body": "if, by mount, you mean nfs mount.  If it&#39;s a hard mount, it will hang forever (I believe).  soft mounts should error out."}, {"owner": {"reputation": 695, "user_id": 2649049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XInB9.jpg?s=128&g=1", "display_name": "CantrianBear", "link": "https://stackoverflow.com/users/2649049/cantrianbear"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1462382729, "post_id": 37033542, "comment_id": 61618560, "body": "@DavidBudworth: I&#39;m mounting to a local disk not NFS"}], "tags": [], "owner": {"reputation": 695, "user_id": 2649049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XInB9.jpg?s=128&g=1", "display_name": "CantrianBear", "link": "https://stackoverflow.com/users/2649049/cantrianbear"}, "is_accepted": false, "score": 6, "last_activity_date": 1462380900, "last_edit_date": 1462380900, "creation_date": 1462380153, "answer_id": 37033542, "question_id": 37033541, "link": "https://stackoverflow.com/questions/37033541/go-command-hangs-indefinitely/37033542#37033542", "title": "Go command hangs indefinitely", "body": "<p>It took me a bit to figure out what was going on and I thought I share the problem solution here, in case somebody else encounters the problem.</p>\n\n<p>As it appears in most cases, if <code>GOPATH</code> is set wrong, you'll likely get some kind of error message and the process ends. My problem was that <code>GOPATH</code> was set to a folder that should have been mounted at boot up. Not only was the path incorrect, but also the mounting of the drive failed. And exactly that was the problem. For some reason, when <code>GOPATH</code> points to an unmounted drive, you won't see an error message and the process hangs forever.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13814087, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PmoXnirHTq0/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclJSADnnXf4eRw4BwSE3FlxqpMFyQ/photo.jpg?sz=128", "display_name": "Amir Leshem", "link": "https://stackoverflow.com/users/13814087/amir-leshem"}, "is_accepted": false, "score": 1, "last_activity_date": 1610449749, "creation_date": 1610449749, "answer_id": 65682752, "question_id": 37033541, "link": "https://stackoverflow.com/questions/37033541/go-command-hangs-indefinitely/65682752#65682752", "title": "Go command hangs indefinitely", "body": "<p>A solution that worked for me :\nIf you are working with Visual Studio Code, remove the import section\nand press Ctrl+S, and let the imported files list get regenerated.</p>\n"}], "owner": {"reputation": 695, "user_id": 2649049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XInB9.jpg?s=128&g=1", "display_name": "CantrianBear", "link": "https://stackoverflow.com/users/2649049/cantrianbear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4567, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1610449749, "creation_date": 1462380153, "question_id": 37033541, "link": "https://stackoverflow.com/questions/37033541/go-command-hangs-indefinitely", "title": "Go command hangs indefinitely", "body": "<p>When running <code>go run ...</code>, <code>go get ...</code>, etc., the process hangs and never returns. If I add the <code>-x</code> option, I only see the build stage and nothing more.</p>\n\n<p>Since the last update to <code>go</code>, I've used it a bit and it worked fine. After a system restart, it suddenly stopped working.</p>\n"}, {"tags": ["go", "channel", "fifo"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462378881, "post_id": 37032559, "comment_id": 61616318, "body": "As you just said, this is how a channel works in Go. You can achieve this by using a channel... Sorry but absolutely terrible question."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1462380548, "post_id": 37032559, "comment_id": 61617356, "body": "@evanmcdonnal  The execution order for senders blocked on a full channel is unspecified.  It&#39;s not terrible to ask how to make this FIFO.  There&#39;s nothing in the spec that says that you can achieve this by using a channel... The issue with the question is that it asks to recommend a software package."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1462380773, "post_id": 37032559, "comment_id": 61617500, "body": "@KarrotKake no I think it&#39;s pretty clearly stated that items are read off the channel in the order they&#39;re sent which means first in first out."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462381860, "post_id": 37032559, "comment_id": 61618065, "body": "@evanmcdonnal The specification and memory model documents do not say anything about  the execution order of goroutines blocked on send."}, {"owner": {"reputation": 267, "user_id": 3142398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-IvPGTvqHRnQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oj_LM08CHikNlfbLewdR2yCc6P6g/mo/photo.jpg?sz=128", "display_name": "Amit Shani", "link": "https://stackoverflow.com/users/3142398/amit-shani"}, "edited": false, "score": 0, "creation_date": 1462425757, "post_id": 37032559, "comment_id": 61634709, "body": "I edited the question to be more clear. sorry for not being so from the begining"}], "answers": [{"comments": [{"owner": {"reputation": 267, "user_id": 3142398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-IvPGTvqHRnQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oj_LM08CHikNlfbLewdR2yCc6P6g/mo/photo.jpg?sz=128", "display_name": "Amit Shani", "link": "https://stackoverflow.com/users/3142398/amit-shani"}, "edited": false, "score": 0, "creation_date": 1462378943, "post_id": 37032858, "comment_id": 61616346, "body": "I meant in the case when there are multiple senders, there is no guarantee that the first blocked sender will be the first to be released. that&#39;s what I meant when I said &quot;buffered channels in GO are not FIFO when the channel is full&quot;. anyhow, I&#39;m looking for an implementation that Fifo&#39;s blocked senders."}, {"owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "reply_to_user": {"reputation": 267, "user_id": 3142398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-IvPGTvqHRnQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oj_LM08CHikNlfbLewdR2yCc6P6g/mo/photo.jpg?sz=128", "display_name": "Amit Shani", "link": "https://stackoverflow.com/users/3142398/amit-shani"}, "edited": false, "score": 2, "creation_date": 1462379557, "post_id": 37032858, "comment_id": 61616725, "body": "@user3142398 If you want this you must implement it yourself. I don&#39;t know of any package that does this. You could probably use a queue and condition variables with an incremented counter for sends, but it&#39;s probably not very efficient."}], "tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": false, "score": 13, "last_activity_date": 1462377918, "creation_date": 1462377918, "answer_id": 37032858, "question_id": 37032559, "link": "https://stackoverflow.com/questions/37032559/golang-fifo-buffered-channel/37032858#37032858", "title": "golang fifo buffered channel", "body": "<p>Buffered channels in Go are always FIFO. The specification clearly says:</p>\n\n<blockquote>\n  <p>Channels act as first-in-first-out queues.</p>\n</blockquote>\n\n<p>If the values coming out of the channel are not FIFO, then this is a bug in the channel implementation.</p>\n\n<p>The following code should always print 1, 2, 3, 4 in this correct order: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    ch := make(chan int, 3)\n    ch &lt;- 1\n    ch &lt;- 2\n    ch &lt;- 3\n\n    go func() {\n        ch &lt;- 4\n    }()\n\n    time.Sleep(time.Second)\n\n    for i := 0; i &lt; 4; i++ {\n        fmt.Println(&lt;-ch)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/cj0g-TAc4P\" rel=\"noreferrer\">Playground link</a></p>\n\n<p>Please note, that there is no guaruantee which value will be send first when there are multiple concurrent senders. If there are multiple waiting senders and someone removes one element from the channel buffer (or in the case of an unbuffered channel, tries to receive from the channel) the runtime will randomly choose one of the sending goroutines.</p>\n\n<p>Example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    ch := make(chan int, 2)\n    ch &lt;- 1\n\n    go func() {\n        ch &lt;- 2\n    }()\n\n    go func() {\n        ch &lt;- 3\n    }()\n\n    time.Sleep(time.Second)\n\n    for i := 0; i &lt; 3; i++ {\n        fmt.Println(&lt;-ch)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/07Q8F1S5rT\" rel=\"noreferrer\">Playground link</a></p>\n\n<p>If you run this code multiple times, you can see that the output will sometimes either be 1, 2, 3 or 1, 3, 2. (This doesn't work on the playground, as the output is cached)</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7690892, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yRBc9P0nw8s/AAAAAAAAAAI/AAAAAAAAAVQ/mWFeX923TDk/photo.jpg?sz=128", "display_name": "Low Eel", "link": "https://stackoverflow.com/users/7690892/low-eel"}, "is_accepted": false, "score": 2, "last_activity_date": 1576275131, "creation_date": 1576275131, "answer_id": 59330444, "question_id": 37032559, "link": "https://stackoverflow.com/questions/37032559/golang-fifo-buffered-channel/59330444#59330444", "title": "golang fifo buffered channel", "body": "<p>You could make use of Linked List.</p>\n\n<p>The container/list package (<a href=\"https://golang.org/pkg/container/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/container/</a>)  implements a doubly linked list which can be used as a queue. Perhaps, it also implements Heap which allows you to create queues with priority. Anyhow, the simplest way is Linked List IHMO:</p>\n\n<pre><code>queue := list.New()\n\nqueue.PushBack(\"Hello \") // Enqueue\nqueue.PushBack(\"world!\")\n\nfor queue.Len() &gt; 0 {\n    e := queue.Front() // First element\n    fmt.Print(e.Value)\n\n    queue.Remove(e) // Dequeue\n}\n</code></pre>\n"}], "owner": {"reputation": 267, "user_id": 3142398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-IvPGTvqHRnQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oj_LM08CHikNlfbLewdR2yCc6P6g/mo/photo.jpg?sz=128", "display_name": "Amit Shani", "link": "https://stackoverflow.com/users/3142398/amit-shani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6170, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1576275131, "creation_date": 1462377043, "last_edit_date": 1462425706, "question_id": 37032559, "link": "https://stackoverflow.com/questions/37032559/golang-fifo-buffered-channel", "title": "golang fifo buffered channel", "body": "<p>from my understanding: buffered channels in GO are not FIFO when the channel is full.<br>\nI need this behaviour in my application (FIFO behaviour).<br>\nHow can I achieve that behaviour? Is there any open source for that?<br>\nThanks in advance  </p>\n\n<p>EDIT:<br>\nsome people disliked the question so let me be more clear:<br>\nI meant that when a buffered channel is full and multiple senders are blocked<br>\nwhile trying to add items to the channel the order in which they'll be released<br>\nis not FIFO. You can also read this discussion: <a href=\"https://github.com/golang/go/issues/11506\" rel=\"noreferrer\">https://github.com/golang/go/issues/11506</a>  </p>\n\n<p>So yeah, I was looking for a third party library that implements that behaviour.<br>\nSorry for not being clear.</p>\n"}, {"tags": ["go", "slice", "unsafe"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1462371957, "post_id": 37029966, "comment_id": 61611276, "body": "Probably you&#39;d better minimize memory consumption by using int32 or even int16 than saving 2*8 byte by replacing a slice header with an unsafe.Pointer. For the slice-of-slice-of-slice case: Make one slice and do the index calculation yourself (see e.g. package image)."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1462372743, "post_id": 37029966, "comment_id": 61611942, "body": "Also keep in mind that int is 4 bytes on 32bit systems and 8 bytes on 64bit, so if you gonna use pointers, make sure you use a sized int. Also if performance of slices is really important, use Go from git (or wait for 1.7), there have been major performance improvements."}, {"owner": {"reputation": 63, "user_id": 2124597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2db8875e0b887c35984de3f28e172b?s=128&d=identicon&r=PG", "display_name": "Exel", "link": "https://stackoverflow.com/users/2124597/exel"}, "edited": false, "score": 0, "creation_date": 1462373010, "post_id": 37029966, "comment_id": 61612129, "body": "yep, all remarks are sensible, but in some cases they are ineligible. for example, if i have dynamic table of records, it would be not convenient to operate with solid slice using index calculations, deleting rows from solid slice would be very heavy. in this case, i think, slice of slices is most preferable approach."}, {"owner": {"reputation": 63, "user_id": 2124597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2db8875e0b887c35984de3f28e172b?s=128&d=identicon&r=PG", "display_name": "Exel", "link": "https://stackoverflow.com/users/2124597/exel"}, "edited": false, "score": 0, "creation_date": 1462373209, "post_id": 37029966, "comment_id": 61612291, "body": "sure, i should use []int32 and unsafe.Sizeof instead of direct value 8 (and Printf), but it is just example to illustrate the question"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462375242, "post_id": 37029966, "comment_id": 61613785, "body": "I don&#39;t see this defined in any way. While holding a pointer to a value allocated in a slice appears to prevent the GC of the array, it may not always be the case (for example if they implement collection for unreachable portions of slices). The unsafe.Pointer is only keeping a reference to the single int value, not the entire array."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1462382822, "post_id": 37029966, "comment_id": 61618612, "body": "The fact that the result of slice indexing is addressable, per the spec, <i>without</i> using <code>unsafe</code>, <i>might</i> argue that this is actually legit, or could be made so. If <code>getPoi</code> returned <code>&amp;a[0]</code> instead of an <code>unsafe.Pointer</code> I believe that <code>a</code> would be required to be kept alive."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 2124597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2db8875e0b887c35984de3f28e172b?s=128&d=identicon&r=PG", "display_name": "Exel", "link": "https://stackoverflow.com/users/2124597/exel"}, "edited": false, "score": 0, "creation_date": 1462442553, "post_id": 37034109, "comment_id": 61643233, "body": "btw, i think, array is a good option, becouse if compared to some kind of lists (allowing easy growth without reallocs), it gives best memory usage and scan performance. i think, it is very specific question, what kind of collection to use, depending on specific conditions."}, {"owner": {"reputation": 63, "user_id": 2124597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2db8875e0b887c35984de3f28e172b?s=128&d=identicon&r=PG", "display_name": "Exel", "link": "https://stackoverflow.com/users/2124597/exel"}, "edited": false, "score": 0, "creation_date": 1462442751, "post_id": 37034109, "comment_id": 61643351, "body": "also, this example will never be the basis of some real solution, ofcourse. i trying such extreme cases to better understand language behaviour and relations"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1462382083, "creation_date": 1462382083, "answer_id": 37034109, "question_id": 37029966, "link": "https://stackoverflow.com/questions/37029966/is-it-safe-to-hold-only-unsafe-pointer-on-the-first-element-of-slice-and-no-refs/37034109#37034109", "title": "Is it safe to hold only unsafe.Pointer on the first element of slice and no refs to that slice itself?", "body": "<p>It's possible, that by coincidence, this will work out for you but I would regard it as unsafe and unsupported. The problem is, if the slice grows beyond it's capacity and needs to be reallocated, what happens to your pointer? Really if you want to optimize performance, you should be using an array. On top of it's performance being inherently better and it's memory footprint being smaller, this operation would always be safe.</p>\n\n<p>Also, just generally speaking I see people doing all kinds of stupid things to try and improve performance when their design is inherently poor (like using dynamic arrays or linked lists for no reason). If you need the dynamic growth of a slice then an array isn't really an option (and using that pointer is also most likely unsafe) but in many cases developers just fail to size their collection appropriately out of idk, laziness? I assume your example is contrived but in such a scenario you have no reason to ever use a slice since your collections size is known at compile time. Even if it weren't, often times the size can be determined during runtime in advance of the allocation and people just fail to do it for the convenience of using abstracted dynamically sized collections.</p>\n"}], "owner": {"reputation": 63, "user_id": 2124597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2db8875e0b887c35984de3f28e172b?s=128&d=identicon&r=PG", "display_name": "Exel", "link": "https://stackoverflow.com/users/2124597/exel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462382083, "creation_date": 1462370255, "question_id": 37029966, "link": "https://stackoverflow.com/questions/37029966/is-it-safe-to-hold-only-unsafe-pointer-on-the-first-element-of-slice-and-no-refs", "title": "Is it safe to hold only unsafe.Pointer on the first element of slice and no refs to that slice itself?", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unsafe\"\n    \"runtime\"\n)\n\nfunc getPoi() unsafe.Pointer {\n    var a = []int{1, 2, 3}\n    return unsafe.Pointer(&amp;a[0])\n}\n\nfunc main() {\n    p := getPoi()\n    runtime.GC()\n    fmt.Println(\"Hello, playground %v\\n\", *(*int)(unsafe.Pointer(uintptr(p)+8)))\n}\n</code></pre>\n\n<p>output: 3</p>\n\n<p><a href=\"https://play.golang.org/p/-OQl7KeL9a\" rel=\"nofollow\">https://play.golang.org/p/-OQl7KeL9a</a></p>\n\n<p>Just examining abilities of unsafe pointers, trying to minimize memory overhead of slice structure (12 byte)</p>\n\n<p>I wonder if this example correct or not.\nAnd if not, what will go wrong exactly after such actions. if it's not correct, why the value is still available even after an explicit call to GC ?\nIs there any aproach to reach minimum overhead on storage like 'slice of slices', as it would be in C (just array of pointers to allocated arrays, when overhead on each row is sizeof(int*)).</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 0, "creation_date": 1462374619, "post_id": 37029952, "comment_id": 61613336, "body": "(disclaimer, I am a newbie to go). I haven&#39;t used Gorm, with github.com/jmoiron/sqlx I can do that using rows.MapScan( mymap ) where mymap is map[string]interface{}. I get dates as time.Time and integers as integers, chars with space padded strings, varchars as trimmed strings, binary data as hex encoded string etc."}, {"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "reply_to_user": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 0, "creation_date": 1462405205, "post_id": 37029952, "comment_id": 61629579, "body": "Let me check about it"}], "owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2807, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1571655763, "creation_date": 1462370220, "question_id": 37029952, "link": "https://stackoverflow.com/questions/37029952/golang-gorm-scan-to-map", "title": "Golang GORM scan to map", "body": "<p>I do some query on my GORM application and right now for scanning row from database is using struct. But the problem is come when I need to do some query that different each other, which I need to create another struct for each query I have.</p>\n\n<p>And actually I don't care about the data that I got from database, it just forwarded to client. So, for me making struct for each of it will be a lot of work. So I am thinking that if I can scan it to map[string]interface{} or []map[string]interface{}. So is it possible to do it on GORM?</p>\n\n<p>And I also thinking about another thing is when column converted to interface{} what about date? It will be converted to string? (and also for other type like int, long, array, etc)</p>\n"}, {"tags": ["go", "rpc"], "answers": [{"comments": [{"owner": {"reputation": 2446, "user_id": 5682933, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29d72b97ce20902d21488878741621f3?s=128&d=identicon&r=PG&f=1", "display_name": "Haoyuan Ge", "link": "https://stackoverflow.com/users/5682933/haoyuan-ge"}, "edited": false, "score": 0, "creation_date": 1462374827, "post_id": 37031086, "comment_id": 61613507, "body": "RPC is also a kind of http request?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 2446, "user_id": 5682933, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29d72b97ce20902d21488878741621f3?s=128&d=identicon&r=PG&f=1", "display_name": "Haoyuan Ge", "link": "https://stackoverflow.com/users/5682933/haoyuan-ge"}, "edited": false, "score": 0, "creation_date": 1462381686, "post_id": 37031086, "comment_id": 61617973, "body": "@haoyuan yes, it&#39;s served over http."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1462381784, "last_edit_date": 1462381784, "creation_date": 1462373057, "answer_id": 37031086, "question_id": 37029056, "link": "https://stackoverflow.com/questions/37029056/does-rpc-call-method-run-in-the-same-go-routine-as-the-server/37031086#37031086", "title": "Does rpc Call method run in the same go routine as the server?", "body": "<p>Each http request has its own goroutine, that's a property of the <code>http.Server</code> itself, and <code>net/rpc</code> builds on top of it.</p>\n\n<p>From the documentation of <a href=\"https://golang.org/pkg/net/http/#Serve\" rel=\"nofollow\"><code>http.Serve</code></a>:</p>\n\n<blockquote>\n  <p>Serve accepts incoming HTTP connections on the listener l, <strong>creating\n  a new service goroutine for each</strong>. The service goroutines read\n  requests and then call handler to reply to them. Handler is typically\n  nil, in which case the DefaultServeMux is used.</p>\n</blockquote>\n\n<p>And from <a href=\"https://golang.org/pkg/net/rpc/#HandleHTTP\" rel=\"nofollow\"><code>rpc.HandleHTTP</code></a>:</p>\n\n<blockquote>\n  <p><strong>HandleHTTP registers an HTTP handler for RPC messages to DefaultServer on DefaultRPCPath and a debugging handler on\n  DefaultDebugPath.</strong> It is still necessary to invoke http.Serve(),\n  typically in a go statement.</p>\n</blockquote>\n"}], "owner": {"reputation": 2446, "user_id": 5682933, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29d72b97ce20902d21488878741621f3?s=128&d=identicon&r=PG&f=1", "display_name": "Haoyuan Ge", "link": "https://stackoverflow.com/users/5682933/haoyuan-ge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 37031086, "answer_count": 1, "score": 0, "last_activity_date": 1462381784, "creation_date": 1462368032, "question_id": 37029056, "link": "https://stackoverflow.com/questions/37029056/does-rpc-call-method-run-in-the-same-go-routine-as-the-server", "title": "Does rpc Call method run in the same go routine as the server?", "body": "<p>My server:</p>\n\n<pre><code>func (t *Arith) Multiply(args *Args, reply *int) error {\n    *reply = args.A * args.B\n    return nil\n}\nfunc main() {\n    arith := new(Arith)\n    rpc.Register(arith)\n    rpc.HandleHTTP()\n    l, e := net.Listen(\"tcp\", \":1234\")\n    if e != nil {\n        log.Fatal(\"listen error:\", e)\n    }\n    go http.Serve(l, nil)\n}\n</code></pre>\n\n<p>Client:</p>\n\n<p><code>client.Call(\"Arith.Multiply\", args, &amp;reply)</code></p>\n\n<p>I think then <code>Multiply</code> run in another go routine? The <code>client.Call()</code> actually invokes <code>go server.SomeFun()</code>?</p>\n"}, {"tags": ["google-app-engine", "go", "projection", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1462374411, "post_id": 37027226, "comment_id": 61613185, "body": "This is a very useful page <a href=\"https://cloud.google.com/appengine/docs/go/datastore/projectionqueries#Go_Indexes_for_projections\" rel=\"nofollow noreferrer\">Projection Queries</a>. In particular: <i>Projection queries require all properties specified in the projection to be included in a Datastore index</i>.  Do you have such an index? (Projections return values from indexes rather than the entity itself)."}, {"owner": {"reputation": 63, "user_id": 6290542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8b430c552f5b187829d9f084769404?s=128&d=identicon&r=PG&f=1", "display_name": "csmallon", "link": "https://stackoverflow.com/users/6290542/csmallon"}, "reply_to_user": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1462377230, "post_id": 37027226, "comment_id": 61615250, "body": "Yes, although the google docs don&#39;t make it clear at all that the sdk will only generate new custom indexes if you run the appengine on a dev_server (goapp serve &lt;app&gt;) beforehand, then deploy with the updated index.yaml. But regardless, they are there.  As it happens, I figured out what the issue is - will post it when I get a chance :)"}], "answers": [{"comments": [{"owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1462485482, "post_id": 37055260, "comment_id": 61668868, "body": "I don&#39;t know if it&#39;s because you&#39;re using Go or projection queries, but I&#39;ve found datastore pretty good at hinting at required indexed. The Java runtime, for example, will throw a <code>DatastoreNeedIndexException</code> if your query requires an index which hasn&#39;t been defined."}], "tags": [], "owner": {"reputation": 63, "user_id": 6290542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8b430c552f5b187829d9f084769404?s=128&d=identicon&r=PG&f=1", "display_name": "csmallon", "link": "https://stackoverflow.com/users/6290542/csmallon"}, "is_accepted": false, "score": 1, "last_activity_date": 1462464497, "creation_date": 1462464497, "answer_id": 37055260, "question_id": 37027226, "link": "https://stackoverflow.com/questions/37027226/golang-datastore-projection-query-returning-empty-strings-from-a-populated-entit/37055260#37055260", "title": "golang datastore projection query returning empty strings from a populated entity", "body": "<p>Figured it out, turns out a number of issues were happening in the background:</p>\n\n<ul>\n<li>For whatever reason, indexes were not being updated, and the error message indicating this was not being piped to the Http response, hence the query was not running</li>\n<li>After clearing this, I didn't realise that the results I was pulling back included large numbers of events that had blank property values and lacking any kind of ordering, hence they were literally whatever happened to come back before the <code>.Limit(50)</code> was being reached ... in that case, the query was running, but I was interpreting the empty string returns as errors when in fact they were correct, just not from the part of the dataset I'd expected - adding Filters for <code>\"&lt;property&gt; &gt;\", \"\"</code> fixed it</li>\n</ul>\n\n<p>Datastore <em>sorely</em> needs better feedback measures than the ones it has. Compared to a lot of similar dbs I've worked with, it's needlessly minimal in it's feedback.</p>\n"}], "owner": {"reputation": 63, "user_id": 6290542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8b430c552f5b187829d9f084769404?s=128&d=identicon&r=PG&f=1", "display_name": "csmallon", "link": "https://stackoverflow.com/users/6290542/csmallon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1463163983, "creation_date": 1462363339, "last_edit_date": 1463163983, "question_id": 37027226, "link": "https://stackoverflow.com/questions/37027226/golang-datastore-projection-query-returning-empty-strings-from-a-populated-entit", "title": "golang datastore projection query returning empty strings from a populated entity", "body": "<p>I'm currently working on golang http-based handler running on Google App Engine. </p>\n\n<p>As part of this, I'm trying to pull back all the values I'm interested in via a Projection query looking at a number of fields in a given kind, with the intention of storing each entity load in a struct that mirrors the field types.</p>\n\n<p>This is my query:</p>\n\n<p><code>source := datastore.NewQuery(\"CacheEntry\").Project(\"Campaign\",  \"Creative\", \"Impressions\", \"Operator\", \"Publisher\", \"Slot\").Limit(50)</code></p>\n\n<p>Unfortunately, all I get back from this is empty strings (worse, returning empty strings does not throw an error of any kind so I've only just worked out that it's doing this).</p>\n\n<p>Google's documentation and error reporting is pretty bad when it comes to Datastore so it hasn't been much help. I can see the populated fields on my Datastore viewer in the Google Cloud Console - some fields are actually empty but I should be returning some data at least.</p>\n\n<p>I'm running it in a for loop with the appropriate pointers setup:</p>\n\n<pre><code>for t := source.Run(ctx); ; {\n    _, err := t.Next(&amp;x)\n\n    log.Println(count)\n    if err == datastore.Done {\n        log.Println(\"failed on Datastore:done, count \\n\")\n        log.Println(count)\n        break\n    }\n    if err != nil {\n        log.Println(\"failed on \\n\")\n        log.Println(count)\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        break\n    }\n    //  fmt.Fprint(w, x.Campaign)\n    if &amp;x != nil {\n\n        fmt.Fprintln(w, \"Strings:\\n\")\n        fmt.Fprintln(w, x.Operator)\n        if x.Operator == \"\" {\n            fmt.Fprintln(w, \"Campaign string is empty\")\n        }\n    }\n\n    count = count + 1\n</code></pre>\n\n<p>'X' being:</p>\n\n<pre><code>type Row struct {\nCampaign    string\nCreative    string\nImpressions int\nOperator    string\nPublisher   string\nSlot        string\n</code></pre>\n\n<p>}</p>\n\n<p>Any ideas where I'm going wrong?</p>\n"}, {"tags": ["git", "go", "commit"], "comments": [{"owner": {"reputation": 63488, "user_id": 729881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fdfaf0aad74fef442e2ffc9999ef9c1?s=128&d=identicon&r=PG", "display_name": "Edward Thomson", "link": "https://stackoverflow.com/users/729881/edward-thomson"}, "edited": false, "score": 0, "creation_date": 1462364239, "post_id": 37026399, "comment_id": 61604992, "body": "You&#39;re creating a tree from the index, but are you writing the index itself?"}, {"owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "reply_to_user": {"reputation": 63488, "user_id": 729881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fdfaf0aad74fef442e2ffc9999ef9c1?s=128&d=identicon&r=PG", "display_name": "Edward Thomson", "link": "https://stackoverflow.com/users/729881/edward-thomson"}, "edited": false, "score": 0, "creation_date": 1462372408, "post_id": 37026399, "comment_id": 61611654, "body": "Yes, that was it. index.Write() was missing. Now it works. You want to put that as an answer?"}, {"owner": {"reputation": 63488, "user_id": 729881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fdfaf0aad74fef442e2ffc9999ef9c1?s=128&d=identicon&r=PG", "display_name": "Edward Thomson", "link": "https://stackoverflow.com/users/729881/edward-thomson"}, "edited": false, "score": 0, "creation_date": 1462381832, "post_id": 37026399, "comment_id": 61618050, "body": "Sure - unfortunately, I&#39;m not very familiar with go, so please let me know if I&#39;m mistaken about something.  :)"}], "answers": [{"tags": [], "owner": {"reputation": 63488, "user_id": 729881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fdfaf0aad74fef442e2ffc9999ef9c1?s=128&d=identicon&r=PG", "display_name": "Edward Thomson", "link": "https://stackoverflow.com/users/729881/edward-thomson"}, "is_accepted": true, "score": 4, "last_activity_date": 1462381797, "creation_date": 1462381797, "answer_id": 37034028, "question_id": 37026399, "link": "https://stackoverflow.com/questions/37026399/git2go-after-createcommit-all-files-appear-like-being-added-for-deletion/37034028#37034028", "title": "Git2go: After CreateCommit() all files appear like being added for deletion", "body": "<p>You are opening the current repository's index:</p>\n\n<pre><code>index, err := repo.Index()\n</code></pre>\n\n<p>And you are mutating it, and creating a new tree that you subsequently create a commit from:</p>\n\n<pre><code>err = index.AddAll([]string{}, git.IndexAddDefault, nil)\ntreeId, err := index.WriteTreeTo(repo)\n</code></pre>\n\n<p>Unlike the <code>git add</code> command line, <code>AddAll</code> did not write the index back to disk.  This functionality allows you to use the index as a data structure without actually staging the changes immediately.  (Many libgit2 functions like merge and rebase use the index as a generic data structure that you can continue to modify or convert to a tree.)</p>\n\n<p>Thus, at this point, all the changes to the index remain in-memory.  You must explicitly write the index back to disk if you want to persist your changes:</p>\n\n<pre><code>index.Write()\n</code></pre>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 37034028, "answer_count": 1, "score": 1, "last_activity_date": 1462689410, "creation_date": 1462360986, "last_edit_date": 1462689410, "question_id": 37026399, "link": "https://stackoverflow.com/questions/37026399/git2go-after-createcommit-all-files-appear-like-being-added-for-deletion", "title": "Git2go: After CreateCommit() all files appear like being added for deletion", "body": "<p>With git2go I do a AddAll() and a CreateCommit() on a newly cloned directory. The Push() works fine and I get all commited files, when I clone the remote to a different place. But if I call <code>git status</code> in the first directory then I get: </p>\n\n<p>(sorry for the German, and I don't have the correct translation, it means the branch is at the same position as origin/master, <code>'gel\u00f6scht'</code> means <code>'deleted'</code> and <code>'Unbeobachtete dateien'</code> means <code>'unwatched files'</code>) </p>\n\n<pre><code>Auf Branch master\nIhr Branch ist auf dem selben Stand wie 'origin/master'.\nzum Commit vorgemerkte \u00c4nderungen:\n  (benutzen Sie \"git reset HEAD &lt;Datei&gt;...\" zum Entfernen aus der Staging-Area)\n\n    gel\u00f6scht:               .gitignore\n    gel\u00f6scht:               html/.gitignore\n    gel\u00f6scht:               images/.gitignore\n    gel\u00f6scht:               json/.gitignore\n    gel\u00f6scht:               pjs/.gitignore\n    gel\u00f6scht:               pjs/test37.pjs\n    gel\u00f6scht:               pjs/test37.png\n    gel\u00f6scht:               sounds/.gitignore\n\nUnbeobachtete Dateien:\n  (benutzen Sie \"git add &lt;Datei&gt;...\", um die \u00c4nderungen zum Commit vorzumerken)\n\n    .gitignore\n    html/\n    images/\n    json/\n    pjs/\n    sounds/\n</code></pre>\n\n<p>What I would expect is the following:</p>\n\n<blockquote>\n<pre><code>Nothing to commit. No files changed. (or similar)\n</code></pre>\n</blockquote>\n\n<p>My code:</p>\n\n<pre><code> // Add\nrepo, err := git.OpenRepository(dir)\nindex, err := repo.Index()\nerr = index.AddAll([]string{}, git.IndexAddDefault, nil)\ntreeId, err := index.WriteTreeTo(repo)\ntree, err := repo.LookupTree(treeId)\n\n// Commit\nsig := &amp;git.Signature{\n    Name:  userName,\n    Email: userName + \"@\" + beego.AppConfig.String(\"userdata::emailserver\"),\n    When:  time.Now(),\n}\ncommitId, err := repo.CreateCommit(\"HEAD\", sig, sig, message, tree)\n\n// Push\nremote, err := repo.LookupRemote(\"origin\")    \nerr = remote.Push([]string{\"refs/heads/master\"}, nil, sig, message)\n</code></pre>\n\n<p>(I took all error handling out, to make it shorter)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462357404, "post_id": 37024713, "comment_id": 61600060, "body": "What&#39;s wrong with using the bytes.Buffer? Why not use <code>cmd.Output</code> or <code>cmd.CombinedOutput</code>?"}, {"owner": {"reputation": 137, "user_id": 5582322, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/--PGm-3UrfZY/AAAAAAAAAAI/AAAAAAAAAC8/pF7VTJ2slws/photo.jpg?sz=128", "display_name": "Ohenepee Peps", "link": "https://stackoverflow.com/users/5582322/ohenepee-peps"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462358139, "post_id": 37024713, "comment_id": 61600604, "body": "With the <code>bytes.Buffer</code> the error is that I can&#39;t get anything out of <code>cmd.Stdout</code> since I&#39;ve already streamed all the data to <code>os.Stdout</code>. I can&#39;t use <code>cmd.Output</code> bcos I want to stream the output to the <code>os.Stdout</code>... in the case of a long-running application"}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 5582322, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/--PGm-3UrfZY/AAAAAAAAAAI/AAAAAAAAAC8/pF7VTJ2slws/photo.jpg?sz=128", "display_name": "Ohenepee Peps", "link": "https://stackoverflow.com/users/5582322/ohenepee-peps"}, "is_accepted": false, "score": 4, "last_activity_date": 1462358811, "creation_date": 1462358811, "answer_id": 37025523, "question_id": 37024713, "link": "https://stackoverflow.com/questions/37024713/how-to-get-full-stdout-from-exec-command/37025523#37025523", "title": "How to get full Stdout from exec.Command?", "body": "<p>This is EXACTLY the expected result... all that was needed was <code>io.MultiWriter</code>.</p>\n\n<pre><code>func main() {\n\n    cmd := exec.Command(\"ping\", \"google.com\")\n\n    var out bytes.Buffer\n    multi := io.MultiWriter(os.Stdout, &amp;out)\n    cmd.Stdout = multi\n\n    if err := cmd.Run(); err != nil {\n        log.Fatalln(err)\n    }\n\n    fmt.Printf(\"\\n*** FULL OUTPUT *** %s\\n\", out.String())\n\n}\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5582322, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/--PGm-3UrfZY/AAAAAAAAAAI/AAAAAAAAAC8/pF7VTJ2slws/photo.jpg?sz=128", "display_name": "Ohenepee Peps", "link": "https://stackoverflow.com/users/5582322/ohenepee-peps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 931, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1462358811, "creation_date": 1462356753, "question_id": 37024713, "link": "https://stackoverflow.com/questions/37024713/how-to-get-full-stdout-from-exec-command", "title": "How to get full Stdout from exec.Command?", "body": "<p>I have this code which I would also want to get the full output from <code>cmd.Stdout</code> when its done for text extraction, etc.</p>\n\n<pre><code>func main() {\n    cmd := exec.Command(\"readinggame\")\n    cmd.Stdout = os.Stdout\n    cmd.Run()\n}\n</code></pre>\n\n<p>I can't seem to find a way of getting the output either as <code>[]byte</code> or <code>string</code> when its done. BTW I don't want to be iterating over the output with <code>ReadLine</code> (or something similar) which happens to work well, I just want a full output at a go, something like </p>\n\n<pre><code>var out bytes.Buffer\ncmd.Stdout = &amp;out\nif err := cmd.Run(); err != nil {\n    log.Fatal(err)\n}\nfmt.Println(out.String())\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1462353335, "post_id": 37022633, "comment_id": 61597152, "body": "Please show a running example which demonstrates your problem."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6289666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae66af0481cfbf4fda70f6401b768480?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandr Butenko", "link": "https://stackoverflow.com/users/6289666/alexandr-butenko"}, "edited": false, "score": 0, "creation_date": 1462352137, "post_id": 37022844, "comment_id": 61596349, "body": "Oh wait, but this function working well. And *Points doesn&#39;t working, coz we using type as alias for slice.  Merge doesn&#39;t working, not Isset."}, {"owner": {"reputation": 70819, "user_id": 1624921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/keNmm.jpg?s=128&g=1", "display_name": "Games Brainiac", "link": "https://stackoverflow.com/users/1624921/games-brainiac"}, "reply_to_user": {"reputation": 3, "user_id": 6289666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae66af0481cfbf4fda70f6401b768480?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandr Butenko", "link": "https://stackoverflow.com/users/6289666/alexandr-butenko"}, "edited": false, "score": 0, "creation_date": 1462352598, "post_id": 37022844, "comment_id": 61596641, "body": "@AlexandrButenko see if the same change for Merge works now."}], "tags": [], "owner": {"reputation": 70819, "user_id": 1624921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/keNmm.jpg?s=128&g=1", "display_name": "Games Brainiac", "link": "https://stackoverflow.com/users/1624921/games-brainiac"}, "is_accepted": false, "score": 1, "last_activity_date": 1462351969, "creation_date": 1462351969, "answer_id": 37022844, "question_id": 37022633, "link": "https://stackoverflow.com/questions/37022633/how-to-pass-an-struct-array-to-my-struct-function/37022844#37022844", "title": "How to pass an struct array to my struct function", "body": "<p>This is because you need to say that <code>Points</code> is a reference to an instance of <code>Points</code>. You can do this by the following:</p>\n\n<pre><code>func (p *Points) Isset(ip Point) bool {\n     for _, i := range p {\n         if i.Hash == ip.Hash {\n             return true\n         }\n     }\n     return false\n}\n</code></pre>\n\n<p>Notice how we set <code>*Points</code> instead of <code>Points</code>. This tells go that we want to work with the instance of the <code>Points</code> struct that we have called the method from.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6289666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae66af0481cfbf4fda70f6401b768480?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandr Butenko", "link": "https://stackoverflow.com/users/6289666/alexandr-butenko"}, "edited": false, "score": 0, "creation_date": 1462353402, "post_id": 37023123, "comment_id": 61597222, "body": "Magic... Can&#39;t repeat on my laptop. Keep trying."}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "reply_to_user": {"reputation": 3, "user_id": 6289666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae66af0481cfbf4fda70f6401b768480?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandr Butenko", "link": "https://stackoverflow.com/users/6289666/alexandr-butenko"}, "edited": false, "score": 0, "creation_date": 1462353461, "post_id": 37023123, "comment_id": 61597270, "body": "When you say &quot;Can&#39;t repeat on my laptop&quot;, what does that mean?  Can you paste your entire code into a playground and link it in your question?"}, {"owner": {"reputation": 70819, "user_id": 1624921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/keNmm.jpg?s=128&g=1", "display_name": "Games Brainiac", "link": "https://stackoverflow.com/users/1624921/games-brainiac"}, "edited": false, "score": 0, "creation_date": 1462353499, "post_id": 37023123, "comment_id": 61597300, "body": "How would you create an append function for Points, where you can just do <code>Points.Append(Point)</code>?"}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "reply_to_user": {"reputation": 70819, "user_id": 1624921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/keNmm.jpg?s=128&g=1", "display_name": "Games Brainiac", "link": "https://stackoverflow.com/users/1624921/games-brainiac"}, "edited": false, "score": 0, "creation_date": 1462353586, "post_id": 37023123, "comment_id": 61597364, "body": "@GamesBrainiac You would certainly need a pointer receiver in that case since you would be modifying the receiver."}, {"owner": {"reputation": 3, "user_id": 6289666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae66af0481cfbf4fda70f6401b768480?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandr Butenko", "link": "https://stackoverflow.com/users/6289666/alexandr-butenko"}, "edited": false, "score": 0, "creation_date": 1462353714, "post_id": 37023123, "comment_id": 61597454, "body": "Oh my god... I&#39;am so sorry, but i just create a slice of points like <code>var res Points</code> in another function... And this one a cause, i guess. Now everything works perfect."}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 2, "last_activity_date": 1462353066, "last_edit_date": 1462353066, "creation_date": 1462352648, "answer_id": 37023123, "question_id": 37022633, "link": "https://stackoverflow.com/questions/37022633/how-to-pass-an-struct-array-to-my-struct-function/37023123#37023123", "title": "How to pass an struct array to my struct function", "body": "<p>I am not sure I understand, this is a play example showing both functions working as expected as far as I can tell.</p>\n\n<p><a href=\"https://play.golang.org/p/n5ch-Wqbil\" rel=\"nofollow\">https://play.golang.org/p/n5ch-Wqbil</a></p>\n\n<p>Perhaps you are running into some problem calling one function from the other (like calling Isset from Merge maybe?)  In that case @Games' answer will probably still apply. </p>\n\n<p><strong>EDIT</strong> this example show what I <strong>think</strong> you are probably trying to do.  <a href=\"https://play.golang.org/p/CNEt-poKdN\" rel=\"nofollow\">https://play.golang.org/p/CNEt-poKdN</a> and it seems to work just fine (though has N^2 time performance)</p>\n"}], "owner": {"reputation": 3, "user_id": 6289666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae66af0481cfbf4fda70f6401b768480?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandr Butenko", "link": "https://stackoverflow.com/users/6289666/alexandr-butenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 37023123, "answer_count": 2, "score": 0, "last_activity_date": 1462353066, "creation_date": 1462351413, "question_id": 37022633, "link": "https://stackoverflow.com/questions/37022633/how-to-pass-an-struct-array-to-my-struct-function", "title": "How to pass an struct array to my struct function", "body": "<p>So, i have my slice renamed for using in functions, which one connected to array (like a class methods).</p>\n\n<pre><code>type Points []Point\n\n\nfunc (p Points) Isset(ip Point) bool {\n     for _, i := range p {\n         if i.Hash == ip.Hash {\n             return true\n         }\n     }\n     return false\n}\n</code></pre>\n\n<p>But it's doesn't matter, coz in another function, which one tried to pass slice with type Points, i have some trouble...</p>\n\n<p>Here is example:</p>\n\n<pre><code>func (p Points) Merge(ip Points) {\n    fmt.Println(p)\n}\n</code></pre>\n\n<p>In first function - i can access to my <code>p</code> variable as array. In second - <code>p</code> - just empty array. But if i change type of passed variable - everything will be fine.</p>\n\n<p>What should i do... I need to specify me merge function. And this solution look's like awesome, but doesn't work. </p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1462349061, "post_id": 37021588, "comment_id": 61594400, "body": "Maybe you could show the actual request? Btw: Your <code>r.Header.Set(&quot;content-type&quot;, &quot;text&#47;html&quot;)</code> is nonsensical on the request; it probably should go on the response."}], "answers": [{"tags": [], "owner": {"reputation": 995, "user_id": 5081731, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0796ca4fc2f0ed598cb2e069ffd7d5ac?s=128&d=identicon&r=PG&f=1", "display_name": "aro_tech", "link": "https://stackoverflow.com/users/5081731/aro-tech"}, "is_accepted": true, "score": 1, "last_activity_date": 1462349650, "creation_date": 1462349650, "answer_id": 37022069, "question_id": 37021588, "link": "https://stackoverflow.com/questions/37021588/unable-to-read-post-form-value-in-golang-with-htprouter/37022069#37022069", "title": "Unable to read post form value in Golang with htprouter", "body": "<p>Thanks to Volker for pointing out an error.  When I commented out the line  <code>r.Header.Set(\"content-type\", \"text/html\")</code>, the problem was resolved.  Perhaps that was the issue, or perhaps there was some issue with the IDE (LiteIDE) caching an old version of the code.  In any case, I can now read the posted value.</p>\n"}], "owner": {"reputation": 995, "user_id": 5081731, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0796ca4fc2f0ed598cb2e069ffd7d5ac?s=128&d=identicon&r=PG&f=1", "display_name": "aro_tech", "link": "https://stackoverflow.com/users/5081731/aro-tech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "accepted_answer_id": 37022069, "answer_count": 1, "score": 0, "last_activity_date": 1462349650, "creation_date": 1462348141, "last_edit_date": 1495535633, "question_id": 37021588, "link": "https://stackoverflow.com/questions/37021588/unable-to-read-post-form-value-in-golang-with-htprouter", "title": "Unable to read post form value in Golang with htprouter", "body": "<p>I'm new to Golang and trying to get a basic http app running using the <em>httprouter</em> API.  I've hit a wall with reading posted form data, despite following the advice given <a href=\"https://stackoverflow.com/a/23284299/5081731\">in another StackOverflow question</a>.</p>\n\n<p>Here's my code (minus irrelevancies):</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"net/http\"\n    \"github.com/julienschmidt/httprouter\"\n)\n\n\nfunc main() {\n    r := httprouter.New()\n    r.POST(\"/sub\", func(w http.ResponseWriter, r *http.Request, _ httprouter.Params) {\n        r.Header.Set(\"content-type\", \"text/html\")\n        err := r.ParseForm()\n        if err != nil {\n            fmt.Fprintf(w, \"&lt;h1&gt;Error: %s&lt;/h1&gt;\\n\", err)\n        }\n        fmt.Fprintf(w, \"&lt;h1&gt;Submitted message!&lt;/h1&gt;\\n&lt;p&gt;-%s-&lt;/p&gt;\\n\", r.PostFormValue(\"msg\"))\n    })\n    http.ListenAndServe(\"localhost:3000\", r)\n}\n</code></pre>\n\n<p>In the output, where I should see <code>-hello-</code>, I just see <code>--</code>.  When I inspect the http request in Firefox, in the Form Data panel, I see <code>msg:\"hello\"</code>, so why is  <code>r.PostFormValue(\"msg\")</code> returning a blank string?</p>\n"}, {"tags": ["c++", "multithreading", "go"], "comments": [{"owner": {"reputation": 4622, "user_id": 996886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lSuAl.png?s=128&g=1", "display_name": "melak47", "link": "https://stackoverflow.com/users/996886/melak47"}, "edited": false, "score": 0, "creation_date": 1462347946, "post_id": 37021194, "comment_id": 61593683, "body": "I don&#39;t think you can wait on multiple condition variables in one thread using just standard facilities. Maybe you can invert the problem, and have the queues actively push into the &quot;master&quot; queue where they notify blocking threads now."}, {"owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "edited": false, "score": 2, "creation_date": 1462348595, "post_id": 37021194, "comment_id": 61594099, "body": "Go&#39;s select implementation is <a href=\"https://github.com/golang/go/blob/master/src/runtime/select.go\" rel=\"nofollow noreferrer\">here</a>, maybe it can give you ideas."}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1462349013, "post_id": 37021194, "comment_id": 61594364, "body": "<a href=\"https://github.com/tylertreat/chan\" rel=\"nofollow noreferrer\">github.com/tylertreat/chan</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": -2, "last_activity_date": 1462355027, "creation_date": 1462355027, "answer_id": 37024046, "question_id": 37021194, "link": "https://stackoverflow.com/questions/37021194/how-are-golang-select-statements-implemented/37024046#37024046", "title": "How are golang select statements implemented?", "body": "<p>Golang's <code>select</code> statement is inspired from the C <code>select</code> function (see the GNU libc <a href=\"https://www.gnu.org/software/libc/manual/html_node/Waiting-for-I_002fO.html\" rel=\"nofollow\">documentation</a>), that is used for waiting I/O on a set of file descriptors. If your queues communicate using a socket or a pipe, you may use it.</p>\n"}, {"tags": [], "owner": {"reputation": 15124, "user_id": 144969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a12d286134563e628089f733b946a00?s=128&d=identicon&r=PG", "display_name": "Dimitar Dimitrov", "link": "https://stackoverflow.com/users/144969/dimitar-dimitrov"}, "is_accepted": false, "score": 6, "last_activity_date": 1462446775, "creation_date": 1462446775, "answer_id": 37049143, "question_id": 37021194, "link": "https://stackoverflow.com/questions/37021194/how-are-golang-select-statements-implemented/37049143#37049143", "title": "How are golang select statements implemented?", "body": "<p>I wouldn't necessarily say that Go's <code>select</code> implementation is elegant, but I think it's beautiful in its own way and it's fairly optimized.</p>\n\n<ul>\n<li>it special-handles <code>select</code>s with a single non-default case</li>\n<li>it permutes the order in which cases are evaluated in order to avoid deterministic starvation</li>\n<li>it does an optimistic first pass over the cases looking for one that's already satisfied</li>\n<li>it enqueues on the internal sender/receiver queues of each channel using many internal, known only to the runtime mechanisms\n\n<ul>\n<li>it uses <code>sudog</code>s which are like lightweight goroutine references (there can be many <code>sudog</code>s for the same goroutine) that allow quick jumping into the goroutine stack</li>\n<li>it uses the scheduler's <code>gopark</code> mechanism to block itself which allows efficient unparking on signal</li>\n<li>when signalled and unparked, it immediately goes into the triggered case handler function by manipulating the <code>select</code> goroutine's program counter</li>\n</ul></li>\n</ul>\n\n<p>There's no single overarching groundbreaking idea in the implementation, but you would really appreciate how each step was carefully tinkered with so that it's fast, efficient and well integrated with concept of channels. Because of that, it's not very easy to reimplement Go's <code>select</code> statement in another language, unless you at least have the <code>chan</code> construct first.</p>\n\n<p>You can take a look at the reimplementations available in other languages, where the idea was redone with various degrees of similarity and effectiveness. If I had to reimplement <code>select</code> from scratch in another language, I would probably first try a single shared semaphore and, in case that didn't work, switch to a cruder, sleep-a-little-then-check-in-random-order strategy.</p>\n"}], "owner": {"reputation": 7535, "user_id": 956134, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95f88f7c5f4fac6d14156c0100bdbc4d?s=128&d=identicon&r=PG", "display_name": "math4tots", "link": "https://stackoverflow.com/users/956134/math4tots"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1290, "favorite_count": 5, "answer_count": 2, "score": 8, "last_activity_date": 1462446775, "creation_date": 1462346988, "last_edit_date": 1462347585, "question_id": 37021194, "link": "https://stackoverflow.com/questions/37021194/how-are-golang-select-statements-implemented", "title": "How are golang select statements implemented?", "body": "<p>In particular, I have some blocking queues in C++, and I want to wait until any one of them has some item I can pop.</p>\n\n<p>The only mechanism I can think of is to spawn a separate thread for each queue that pops from its input queue and feeds into a master queue that the original thread can wait on.</p>\n\n<p>It seems kind of resource heavy to spawn N new threads and then kill them all every time I want to pop from a group of queues.</p>\n\n<p>Does Golang implement some more elegant mechanism that I might be able to implement in my own C++ code?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 549, "user_id": 3040816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43fdb4f835d35ff0f78867a4d2007b4f?s=128&d=identicon&r=PG&f=1", "display_name": "smnpl", "link": "https://stackoverflow.com/users/3040816/smnpl"}, "edited": false, "score": 0, "creation_date": 1462343127, "post_id": 37019949, "comment_id": 61590994, "body": "Int64 as they are pretty big :)"}, {"owner": {"reputation": 13643, "user_id": 1315565, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QXtqX.jpg?s=128&g=1", "display_name": "ILikeTacos", "link": "https://stackoverflow.com/users/1315565/iliketacos"}, "edited": false, "score": 0, "creation_date": 1462344457, "post_id": 37019949, "comment_id": 61591706, "body": "this was the exact issue. I didn&#39;t realize I had strings instead of int64 in those fields! Thanks."}], "tags": [], "owner": {"reputation": 57310, "user_id": 111896, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/2e2264ff8ca9c08c1c297b210e359aa6?s=128&d=identicon&r=PG", "display_name": "ZelluX", "link": "https://stackoverflow.com/users/111896/zellux"}, "is_accepted": true, "score": 3, "last_activity_date": 1462342832, "creation_date": 1462342832, "answer_id": 37019949, "question_id": 37019827, "link": "https://stackoverflow.com/questions/37019827/in-go-what-is-json-unmarshall-maximum-depth/37019949#37019949", "title": "In go, What is json.Unmarshall Maximum Depth?", "body": "<p>I don't think there is a maximum depth on json.Unmarshal. </p>\n\n<p>In your code, <code>Seq</code> field in <code>Message</code> field is defined as string, so are <code>Id</code> fields in <code>Sender</code> and <code>Recipient</code>, while in json they are integers. That should be the culprit for the missing fields.</p>\n"}], "owner": {"reputation": 13643, "user_id": 1315565, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QXtqX.jpg?s=128&g=1", "display_name": "ILikeTacos", "link": "https://stackoverflow.com/users/1315565/iliketacos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "accepted_answer_id": 37019949, "answer_count": 1, "score": 0, "last_activity_date": 1462342832, "creation_date": 1462342391, "question_id": 37019827, "link": "https://stackoverflow.com/questions/37019827/in-go-what-is-json-unmarshall-maximum-depth", "title": "In go, What is json.Unmarshall Maximum Depth?", "body": "<p>I'm trying to parse JSON response that looks like this: </p>\n\n<pre><code>{\n    \"object\": \"page\",\n    \"entry\": [\n        {\n            \"id\": 185985174761277,\n            \"time\": 1462333588680,\n            \"messaging\": [\n                {\n                    \"sender\": {\n                        \"id\": 1053704801343033\n                    },\n                    \"recipient\": {\n                        \"id\": 185985174761277\n                    },\n                    \"timestamp\": 1462333588645,\n                    \"message\": {\n                        \"mid\": \"mid.1462333588639:d44f4374dfc510c351\",\n                        \"seq\": 1948,\n                        \"text\": \"Hello World!\"\n                    }\n                }\n            ]\n        }\n    ]\n}\n</code></pre>\n\n<p>I'm using <code>json.Unmarshal</code> and passing the following struct as the interface:</p>\n\n<pre><code>type Message struct {\n    Object string\n    Entry  []struct {\n        Id        int64\n        Time      int64\n        Messaging []struct {\n            Sender struct {\n                Id string\n            }\n            Recipient struct {\n                Id string\n            }\n            Timestamp int64\n            Message   struct {\n                Mid  string\n                Seq  string\n                Text string\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>However, <code>json.Unmarshal</code> does not match the JSON Response to any of the structs in <code>Messaging</code></p>\n\n<p>This function reproduces the issue exactly:</p>\n\n<pre><code>type Message struct {\n    Object string\n    Entry  []struct {\n        Id        int64\n        Time      int64\n        Messaging []struct {\n            Sender struct {\n                Id string\n            }\n            Recipient struct {\n                Id string\n            }\n            Timestamp int64\n            Message   struct {\n                Mid  string\n                Seq  string\n                Text string\n            }\n        }\n    }\n}\nfunc testStruct() {\n    jsonResponse := []byte(`{\n    \"object\": \"page\",\n    \"entry\": [\n        {\n            \"id\": 185985174761277,\n            \"time\": 1462333588680,\n            \"messaging\": [\n                {\n                    \"sender\": {\n                        \"id\": 1053704801343033\n                    },\n                    \"recipient\": {\n                        \"id\": 185985174761277\n                    },\n                    \"timestamp\": 1462333588645,\n                    \"message\": {\n                        \"mid\": \"mid.1462333588639:d44f4374dfc510c351\",\n                        \"seq\": 1948,\n                        \"text\": \"oijsdfoijsdfoij\"\n                    }\n                }\n            ]\n        }\n    ]\n}`)\n    var m Message\n    json.Unmarshal(jsonResponse, &amp;m)\n    fmt.Println(string(jsonResponse))\n    fmt.Printf(\"%+v\\n\", m)\n}\n</code></pre>\n\n<p>This is the output:</p>\n\n<pre><code>{Object:page Entry:[{Id:185985174761277 Time:1462333588680 Messaging:[{Sender:{Id:} Recipient:{Id:} Timestamp:0 Message:{Mid: Seq: Text:}}]}]}\n</code></pre>\n\n<p>and as you can see, all the fields inside the Message struct are not set. </p>\n\n<p>My question is, is there a maximum depth that json.Unmarshal can match? and if there is not, what am I doing wrong?</p>\n"}, {"tags": ["api", "go", "url-encoding"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1462340371, "post_id": 37018339, "comment_id": 61589791, "body": "<a href=\"https://play.golang.org/p/6C8yUPu34E\" rel=\"nofollow noreferrer\">play.golang.org/p/6C8yUPu34E</a> generate url string <code>B=b&amp;C=2&amp;D=d&amp;a=1</code> in my test project, so it seems your code should work."}, {"owner": {"reputation": 107, "user_id": 2827170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a38c65b780e8dbf9cc9d2920c89378e0?s=128&d=identicon&r=PG", "display_name": "pdago", "link": "https://stackoverflow.com/users/2827170/pdago"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1462396670, "post_id": 37018339, "comment_id": 61626428, "body": "Yes that is using my current code. I would prefer to have the structure embedded without the extra declared struct."}], "answers": [{"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 0, "last_activity_date": 1462413872, "creation_date": 1462413872, "answer_id": 37041132, "question_id": 37018339, "link": "https://stackoverflow.com/questions/37018339/golang-supersede-embedded-structure-for-url-encoding-parameters/37041132#37041132", "title": "Golang - Supersede Embedded Structure for URL Encoding Parameters", "body": "<p>Anonymous not mean embed, they are completely different two thing. Embedding means the fields of nested struct will present to outer struct. Anonymous just missing the struct name. you are expecting anonymous structs to be embedded, it is not a good idea.</p>\n\n<p>Anyhow, if you want encoding anonymous as embedded, change the code in <code>url-encoding</code> lib <a href=\"https://github.com/google/go-querystring/blob/master/query/encode.go\" rel=\"nofollow\">https://github.com/google/go-querystring/blob/master/query/encode.go</a></p>\n\n<pre><code>if /*sf.Anonymous &amp;&amp;*/ sv.Kind() == reflect.Struct {\n    // save embedded struct for later processing\n    embedded = append(embedded, sv)\n    continue\n}\n</code></pre>\n\n<p>please note <code>sf.Anonymous</code> not mean anonymous in real, it means embedded as the comment saying</p>\n\n<pre><code>type StructField struct {\n    ...\n    Index     []int     // index sequence for Type.FieldByIndex\n    Anonymous bool      // is an embedded field\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2827170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a38c65b780e8dbf9cc9d2920c89378e0?s=128&d=identicon&r=PG", "display_name": "pdago", "link": "https://stackoverflow.com/users/2827170/pdago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462413872, "creation_date": 1462335313, "question_id": 37018339, "link": "https://stackoverflow.com/questions/37018339/golang-supersede-embedded-structure-for-url-encoding-parameters", "title": "Golang - Supersede Embedded Structure for URL Encoding Parameters", "body": "<p>I have multiple structures with the same format as <code>MapParameters</code> that are passed to the <code>encodeParams</code> function. Unfortunately, using that function against these structures produces unwanted encoding including the embedded structure name. Is there anyway I can fix this using <code>reflect</code> without using a huge switch library of type assertions?</p>\n\n<pre><code>// Desired Encoding\n&amp;required_param=1\n\n// Current Encoding\n%5BRequired%5D&amp;required_param=1 \n\n// Desired\ntype MapParameters struct {\n  Required struct { ... }\n  Optional struct { ... }\n}\n\n// Current\ntype MapParameters struct {\n  MapRequired\n  MapOptional\n}\n\ntype MapRequired struct { ... }\ntype MapOptional struct { ... }\n\nfunc encodeParams(s string, opt interface{}) (string, error) {\n  v := reflect.ValueOf(opt)\n  if v.Kind() == reflect.Ptr &amp;&amp; v.IsNil() {\n    return s, nil\n  }\n\n  u, err := url.Parse(s)\n  if err != nil {\n    return s, err\n  }\n\n  // from github.com/google/go-querystring/query\n  qs, err := query.Values(opt)\n  if err != nil {\n    return s, err\n  }\n\n  u.RawQuery = u.RawQuery + qs.Encode()\n  return u.String(), nil\n}\n</code></pre>\n"}, {"tags": ["jquery", "json", "xml", "go", "output"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 6100438, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/906a7ce7929a333335af52c0a5c2042d?s=128&d=identicon&r=PG&f=1", "display_name": "Becca Bohem", "link": "https://stackoverflow.com/users/6100438/becca-bohem"}, "edited": false, "score": 0, "creation_date": 1462315436, "post_id": 37015480, "comment_id": 61583278, "body": "Mr. Mcdonnal, before I lose your attention, could you give me an example of how I would go about modifying the code to be able to accept what you have suggested? I have a final tomorrow and I&#39;m still trying to fully grasp the concept"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 141, "user_id": 6100438, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/906a7ce7929a333335af52c0a5c2042d?s=128&d=identicon&r=PG&f=1", "display_name": "Becca Bohem", "link": "https://stackoverflow.com/users/6100438/becca-bohem"}, "edited": false, "score": 0, "creation_date": 1462318011, "post_id": 37015480, "comment_id": 61583984, "body": "@BeccaBohem yeah for sure, I had to go to a meeting before I could inspect that part of the code. I&#39;ll edit right now with that part as well."}, {"owner": {"reputation": 141, "user_id": 6100438, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/906a7ce7929a333335af52c0a5c2042d?s=128&d=identicon&r=PG&f=1", "display_name": "Becca Bohem", "link": "https://stackoverflow.com/users/6100438/becca-bohem"}, "edited": false, "score": 0, "creation_date": 1462324481, "post_id": 37015480, "comment_id": 61585581, "body": "Thank you so much, my final grade thanks you as well!"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1462318305, "last_edit_date": 1462318305, "creation_date": 1462314655, "answer_id": 37015480, "question_id": 37015366, "link": "https://stackoverflow.com/questions/37015366/golang-nested-xml-to-json/37015480#37015480", "title": "GOLang: Nested XML to JSON", "body": "<p>You're not getting the desired output because the definition of your json struct is incorrect. You have;</p>\n\n<pre><code>type reportTypeJson struct{\n    Version        string  `json:\"version\"`;\n    TermsOfService string `json:\"termsofService\"`;\n    Features    string `json:\"features feature\" `;\n    Zip           string `json:\"current_observation &gt; display_location &gt; zip\"`;\n}\n</code></pre>\n\n<p>Which denotes features as a string but it's actually an object, either a <code>map[string]string</code> or it's own struct which would be defined as such;</p>\n\n<pre><code>type Features struct {\n     Feature string `json:\"feature\"`\n}\n</code></pre>\n\n<p>Given the fields name is plural, I would guess it's intended to be a collection so changing your struct to </p>\n\n<pre><code>type reportTypeJson struct{\n    Version        string  `json:\"version\"`;\n    TermsOfService string `json:\"termsofService\"`;\n    Features    map[string]string `json:\"features\"`;\n    Zip           string `json:\"current_observation &gt; display_location &gt; zip\"`;\n}\n</code></pre>\n\n<p>is probably what you're looking for. Of course, this means you'll have to modify some other code which assigns values from the xml struct to the json one or whatever but I think you can figure that out fine on your own :D</p>\n\n<p>EDIT: The section below is where you convert your xml type into a json type (ie allocate an instance of the reportTypeJson and assign values from the reportType to it so that you can call the json marshal on it to produce the output). Assuming you're using the definition of <code>reportTypeJson</code> from above which has <code>Features</code> as a <code>map[string]string</code> you just have to modify the one line where you set <code>output.Features</code>. In the sample below I do this inline with 'composite literal' syntax. This allows you to instantiate/allocate the collection while assigning values to it at the same time.</p>\n\n<pre><code>//Now marshal the data out in JSON\nvar data []byte\nvar output reportTypeJson\noutput.Version = string(report.Version);\noutput.TermsOfService = string(report.TermsOfService)\n\noutput.Features= map[string]string{\"features\":string(report.Features)} // allocate a map, add the 'features' value to it and assign it to output.Features\noutput.Zip=string(report.Zip)\ndata,err = json.MarshalIndent(output,\"\",\"      \")\ndoErr(err, \"From marshalIndent\")\nfmt.Printf(\"JSON output nicely formatted: \\n%s\\n\",data)\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 6100438, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/906a7ce7929a333335af52c0a5c2042d?s=128&d=identicon&r=PG&f=1", "display_name": "Becca Bohem", "link": "https://stackoverflow.com/users/6100438/becca-bohem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 37015480, "answer_count": 1, "score": 0, "last_activity_date": 1462318305, "creation_date": 1462313988, "question_id": 37015366, "link": "https://stackoverflow.com/questions/37015366/golang-nested-xml-to-json", "title": "GOLang: Nested XML to JSON", "body": "<p>Hello StackOverFLowers!!</p>\n\n<p>I'm trying to figure out how to given XML input, to convert it to JSON using GOlang. For example... </p>\n\n<p><code>&lt;version&gt;0.1&lt;/version&gt;\n    &lt;termsofService&gt;http://www.wunderground.com/weather/api/d/terms.html&lt;/termsofService&gt;\n    &lt;features&gt;\n        &lt;feature&gt;conditions&lt;/feature&gt;\n    &lt;/features&gt;</code></p>\n\n<p>Would be turned into </p>\n\n<p><code>\"version\": \"0.1\",\n    \"termsofService\": \"http://www.wunderground.com/weather/api/d/terms.html\",\n    \"features\": { \"feature\": \"conditions\" },</code></p>\n\n<p>I'm getting the <code>version</code> and <code>termsofservice</code> correctly, but I can't figure out how to return nested ones like <code>features</code>. Is it something i'll have to hardcode?</p>\n\n<p>CODE:</p>\n\n<pre><code>    type reportType struct{\n    Version xml.CharData        `xml:\"version\"`\n    TermsOfService xml.CharData `xml:\"termsofService\"\n    `\n    Features xml.CharData       `xml:\"features&gt;feature\"`\n    Zip      xml.CharData       `xml:\"current_observation&gt;display_location&gt;zip\"`\n    Problem myErrorType     `xml:\"error\"`\n}\ntype myErrorType struct{\n    TypeOfError xml.CharData `xml:\"type\"`\n    Desciption xml.CharData `xml:\"description\"`\n}\ntype reportTypeJson struct{\n    Version        string  `json:\"version\"`;\n    TermsOfService string `json:\"termsofService\"`;\n    Features    string `json:\"features feature\" `;\n    Zip           string `json:\"current_observation &gt; display_location &gt; zip\"`;\n}\nfunc main() {\n    fmt.Println(\"data is from WeatherUnderground.\")\n    fmt.Println(\"https://www.wunderground.com/\")\n    var state, city string\n    str1 := \"What is your state?\"\n    str2 := \"What is your city?\"\n    fmt.Println(str1)\n    fmt.Scanf(\"%s\", &amp;state)\n    fmt.Println(str2)\n    fmt.Scanf(\"%s\", &amp;city)\n    baseURL := \"http://api.wunderground.com/api/\";\n    apiKey := \"YouDontNeedToKnow\"\n    var query string\n\n    //set up the query\n    query = baseURL+apiKey +\n    \"/conditions/q/\"+\n    url.QueryEscape(state)+ \"/\"+\n    url.QueryEscape(city)+ \".xml\"\n    fmt.Println(\"The escaped query: \"+query)\n\n    response, err := http.Get(query)\n    doErr(err, \"After the GET\")\n    var body []byte\n    body, err = ioutil.ReadAll(response.Body)\n    doErr(err, \"After Readall\")\n    fmt.Println(body);\n    fmt.Printf(\"The body: %s\\n\",body)\n\n    //Unmarshalling\n    var report reportType\n    xml.Unmarshal(body, &amp;report)\n    fmt.Printf(\"The Report: %s\\n\", report)\n    fmt.Printf(\"The description is [%s]\\n\",report.Problem.Desciption)\n\n    //Now marshal the data out in JSON\n    var data []byte\n    var output reportTypeJson\n    output.Version = string(report.Version);\n    output.TermsOfService = string(report.TermsOfService)\n\n    output.Features= string(report.Features)\n    output.Zip=string(report.Zip)\n    data,err = json.MarshalIndent(output,\"\",\"      \")\n    doErr(err, \"From marshalIndent\")\n    fmt.Printf(\"JSON output nicely formatted: \\n%s\\n\",data)\n\n\n}\nfunc doErr( err error, message string){\n    if err != nil{\n        log.Panicf(\"ERROR: %s %s \\n\", message, err.Error())\n    }\n\n\n}\n</code></pre>\n\n<p>OUTPUT:</p>\n\n<p><code>\nJSON output nicely formatted: \n{\n      \"version\": \"0.1\",\n      \"termsofService\": \"http://www.wunderground.com/weather/api/d/terms.html\",\n      \"features \\u003e feature\": \"conditions\",\n      \"current_observation \\u003e display_location \\u003e zip\": \"64068\"\n}</code></p>\n\n<p>Thanks for your time!</p>\n"}, {"tags": ["go", "reverse-proxy"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462309947, "post_id": 37013682, "comment_id": 61581065, "body": "Unfortunately <code>ResponseWriter</code> is an interface and only exposes a getter for the <code>Header</code> collection so I don&#39;t think there is any simple way to do this. You could iterate the collection and set them all to &quot;null&quot; but that&#39;s a poor substitute for something like <code>w.Headers = nil</code>..."}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 4, "last_activity_date": 1462315754, "last_edit_date": 1462315754, "creation_date": 1462310894, "answer_id": 37014677, "question_id": 37013682, "link": "https://stackoverflow.com/questions/37013682/golang-can-i-remove-response-headers-coming-from-reverseproxy/37014677#37014677", "title": "Golang: Can I remove response headers coming from ReverseProxy?", "body": "<p>You can implement ReverseProxy.Transport</p>\n\n<pre><code>type MyTransport struct{\n    header http.Header\n}\nfunc (t MyTransport) RoundTrip(r *Request) (*Response, error){\n    resp, err := http.DefaultTransport.RoundTrip(r)\n    resp.Header = t.header\n    return resp, err\n}\nmytransport := MyTransport{\n//construct Header\n}\nproxy := httputil.ReverseProxy{Director: func(r *http.Request) {\n    r.Header = http.Header{} // Don't send client's request headers to Amazon.\n    r.URL = proxyURL\n    r.Host = proxyURL.Host\n  },\n  Transport: mytransport,\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18792, "user_id": 385548, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e8f290affc1d939cf9a4ad2c9e79592a?s=128&d=identicon&r=PG", "display_name": "Vojtech Vitek", "link": "https://stackoverflow.com/users/385548/vojtech-vitek"}, "is_accepted": false, "score": 3, "last_activity_date": 1490402093, "creation_date": 1490402093, "answer_id": 43011202, "question_id": 37013682, "link": "https://stackoverflow.com/questions/37013682/golang-can-i-remove-response-headers-coming-from-reverseproxy/43011202#43011202", "title": "Golang: Can I remove response headers coming from ReverseProxy?", "body": "<p>This was my solution to remove/replace all the http.ReverseProxy response headers:</p>\n\n<pre><code>type responseHeadersTransport http.Header\n\nfunc (t responseHeadersTransport) RoundTrip(r *http.Request) (*http.Response, error) {\n    resp, err := http.DefaultTransport.RoundTrip(r)\n    if err != nil {\n        return nil, err\n    }\n    resp.Header = http.Header(t)\n    return resp, nil\n}\n\n\nfunc ProxyFile(w http.ResponseWriter, r *http.Request) {\n    // ...\n\n    headers := http.Header{}\n    headers.Set(\"Content-Type\", file.ContentType)\n    headers.Set(\"Content-Length\", fmt.Sprintf(\"%d\", file.Filesize))\n    headers.Set(\"Content-Disposition\", fmt.Sprintf(\"inline; filename=\\\"%s\\\"\", file.Filename))\n\n    proxy := httputil.ReverseProxy{\n        Director: func(r *http.Request) { // Remove request headers.\n            r.Header = http.Header{}\n            r.URL = proxyURL\n            r.Host = proxyURL.Host\n        },\n        Transport: responseHeadersTransport(headers), // Replace response headers.\n    }\n    proxy.ServeHTTP(w, r)\n}\n</code></pre>\n"}], "owner": {"reputation": 18792, "user_id": 385548, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e8f290affc1d939cf9a4ad2c9e79592a?s=128&d=identicon&r=PG", "display_name": "Vojtech Vitek", "link": "https://stackoverflow.com/users/385548/vojtech-vitek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4073, "favorite_count": 0, "accepted_answer_id": 37014677, "answer_count": 2, "score": 4, "last_activity_date": 1490402093, "creation_date": 1462306989, "question_id": 37013682, "link": "https://stackoverflow.com/questions/37013682/golang-can-i-remove-response-headers-coming-from-reverseproxy", "title": "Golang: Can I remove response headers coming from ReverseProxy?", "body": "<p>I'm using httputil.ReverseProxy to proxy Amazon s3 files to my clients. I'd like to hide all headers coming from Amazon - is that possible without having to reimplement Reverse Proxy?</p>\n\n<pre><code>proxy := httputil.ReverseProxy{Director: func(r *http.Request) {\n    r.Header = http.Header{} // Don't send client's request headers to Amazon.\n    r.URL = proxyURL\n    r.Host = proxyURL.Host\n}}\nproxy.ServeHTTP(w, r) // How do I remove w.Headers ?\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2666, "user_id": 1421957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8e742c4a05e312502c828847c455ad?s=128&d=identicon&r=PG", "display_name": "Tico", "link": "https://stackoverflow.com/users/1421957/tico"}, "edited": false, "score": 0, "creation_date": 1462302135, "post_id": 37012158, "comment_id": 61576722, "body": "What&#39;s the message/warning from golint?"}, {"owner": {"reputation": 5205, "user_id": 118201, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3332136bbcc2736f3d2118dfd7d98a15?s=128&d=identicon&r=PG", "display_name": "eSniff", "link": "https://stackoverflow.com/users/118201/esniff"}, "edited": false, "score": 2, "creation_date": 1462302615, "post_id": 37012158, "comment_id": 61577025, "body": "I assume its because your calling an unexported struct from a different package <code>main</code> than the one it was defined in.  Basically it&#39;s saying remove the call or export the struct."}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1462304395, "creation_date": 1462304395, "answer_id": 37012987, "question_id": 37012158, "link": "https://stackoverflow.com/questions/37012158/unexported-struct-best-practice-golint-complains/37012987#37012987", "title": "unexported struct best practice? (golint complains)", "body": "<p>You <code>x := mypkg.New()</code> in main.main() even can't have any type. It should not even compile. It's unusable. Seems to me more meaningful would be something like</p>\n\n<pre><code>package mypkg\ntype (\n    // mystruct ...\n    mystruct struct {\n        S string\n    }\n)\ntype HaveS interface{ //which you can use but can't instantiate\n    GetS() string\n}\nfunc (strct *mystruct ) GetS() string {return strct.S}\n// New ..\nfunc New() HaveS {\n    return &amp;mystruct{S: \"test\"}\n}\n</code></pre>\n\n<p>then in main</p>\n\n<pre><code>var x mypkg.HaveS\nx = mypkg.New()\nfmt.Println(x.GetS())\n</code></pre>\n"}], "owner": {"reputation": 1488, "user_id": 850841, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b0153adb51781d92f65539e915578d82?s=128&d=identicon&r=PG", "display_name": "broersa", "link": "https://stackoverflow.com/users/850841/broersa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 1, "accepted_answer_id": 37012987, "answer_count": 1, "score": 0, "last_activity_date": 1462304395, "creation_date": 1462301449, "question_id": 37012158, "link": "https://stackoverflow.com/questions/37012158/unexported-struct-best-practice-golint-complains", "title": "unexported struct best practice? (golint complains)", "body": "<p>I have the following package :</p>\n\n<pre><code>package mypkg\n\ntype (\n    // mystruct ...\n    mystruct struct {\n        S string\n    }\n)\n\n// New ..\nfunc New() *mystruct {\n    return &amp;mystruct{S: \"test\"}\n}\n</code></pre>\n\n<p>I use it this way:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"test/mypkg\"\n)\n\nfunc main() {\n    x := mypkg.New()\n    fmt.Println(x.S)\n    // this fails intended\n    y := mypkg.mystruct{S: \"andre\"}\n    fmt.Println(y.S)\n}\n</code></pre>\n\n<p>Why is golint complaining about my unexported struct? My intension is to prevent calling the struct creation outside the constructor call.\nIs there another way to prevent instantiating without the New call?</p>\n"}, {"tags": ["inheritance", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 11214, "user_id": 366207, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a8f20cf31acead835f9eacc605210903?s=128&d=identicon&r=PG", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/366207/ahmad"}, "edited": false, "score": 0, "creation_date": 1462302385, "post_id": 37011922, "comment_id": 61576872, "body": "But the functionality I want is that within Put, I should also be able to access the &#39;child&#39; structs variables. They way your code is structured, I don&#39;t think that&#39;s possible."}], "tags": [], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1462300788, "creation_date": 1462300788, "answer_id": 37011922, "question_id": 37011799, "link": "https://stackoverflow.com/questions/37011799/how-to-pass-a-child-struct-into-a-function-accepting-parent-struct/37011922#37011922", "title": "How to pass a &#39;child&#39; struct into a function accepting &#39;parent&#39; struct?", "body": "<p>The easiest way to solve it is to satisfy the parameter's type: pass a <code>FSEntity</code>. If you need to only get <code>FSEntity</code> from a struct which is embedding it, then you can simply do <code>dataBlock.FSEntity</code>.</p>\n\n<pre><code>//Parent struct:\n\ntype FSEntity struct {\n    guid string\n}\n\n//Child struct:\n\ntype DataBlock struct {\n    FSEntity\n    data []byte\n}\n\nfunc main() {\n    myVar := DataBlock{}\n    myVar.guid = \"test\"\n    myVar.data = []byte(\"moar test\")\n    a(myVar.FSEntity)\n}\n\nfunc a(x FSEntity) {\n    fmt.Printf(\"%+v\\n\", x)\n}\n</code></pre>\n\n<p>(<a href=\"https://play.golang.org/p/UFhmuflmv0\" rel=\"nofollow\">Go playground</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 11214, "user_id": 366207, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a8f20cf31acead835f9eacc605210903?s=128&d=identicon&r=PG", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/366207/ahmad"}, "edited": false, "score": 0, "creation_date": 1462302516, "post_id": 37012004, "comment_id": 61576968, "body": "Thanks for the explanation. So there&#39;s no way I can use proper inheritance in Go at all ? Because the functionality I wanted was that inside <code>Put()</code>, I am able to access BOTH class&#39;s variables, and that won&#39;t be possible if I simply do <code>Put(dataBLock.FSEntity)</code>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 11214, "user_id": 366207, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a8f20cf31acead835f9eacc605210903?s=128&d=identicon&r=PG", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/366207/ahmad"}, "edited": false, "score": 1, "creation_date": 1462302659, "post_id": 37012004, "comment_id": 61577051, "body": "@Ahmad if you want to be able to access variables on both your structs, you&#39;ll have to update <code>Put</code>&#39;s definition so it&#39;s argument is of type <code>DataBlock</code>. There is no inheritance in Go. You have to think about the problem a bit differently. You&#39;re trying to leverage polymorphism when it doesn&#39;t exist as a concept in the language. If you want that type of dynamic behavior (like a collection that contains many types which are supposed to have some common behavior/fields/ect) then you abstract that behind an interface."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 10, "last_activity_date": 1462301048, "creation_date": 1462301048, "answer_id": 37012004, "question_id": 37011799, "link": "https://stackoverflow.com/questions/37011799/how-to-pass-a-child-struct-into-a-function-accepting-parent-struct/37012004#37012004", "title": "How to pass a &#39;child&#39; struct into a function accepting &#39;parent&#39; struct?", "body": "<p>I think the terminology you're using is causing you problems. In the put, you simply need to reference the inner struct like so; <code>Put(dataBLock.FSEntity)</code></p>\n\n<p>But to clarify, there is no parent/child relationship here. You're using a language feature called embedding and works like composition (ie one type is composed of others) only the things you embed have their fields/methods hoisted to the embedding scope. For that reason you can't pass in the type you're calling the 'child' because there is no polymorphic behavior here like when you inherit from a type, instead you're type is composed of that but you can access it's fields without the extra level of indirection. Since your method accepts the embedded type as an argument, you have to explicitly reference it to pass only that. The outer struct is in no way that type.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1462302089, "creation_date": 1462302089, "answer_id": 37012358, "question_id": 37011799, "link": "https://stackoverflow.com/questions/37011799/how-to-pass-a-child-struct-into-a-function-accepting-parent-struct/37012358#37012358", "title": "How to pass a &#39;child&#39; struct into a function accepting &#39;parent&#39; struct?", "body": "<p>It's not exactly inheritance and the idea is to define Put as method</p>\n\n<pre><code>func (entity FSEntity) Put() {....}\n</code></pre>\n\n<p>then after embedding</p>\n\n<pre><code>type DataBlock struct {\n    FSEntity\n    data []byte\n}\n</code></pre>\n\n<p>DataBlock can use this method</p>\n\n<pre><code>dataBLock.Put()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6740108, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/926342c1f6d2a38b4733867534bc0a6f?s=128&d=identicon&r=PG", "display_name": "Githin George", "link": "https://stackoverflow.com/users/6740108/githin-george"}, "is_accepted": false, "score": 0, "last_activity_date": 1471773127, "creation_date": 1471773127, "answer_id": 39062932, "question_id": 37011799, "link": "https://stackoverflow.com/questions/37011799/how-to-pass-a-child-struct-into-a-function-accepting-parent-struct/39062932#39062932", "title": "How to pass a &#39;child&#39; struct into a function accepting &#39;parent&#39; struct?", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Guider interface {\n    Guid() string\n}\ntype FSEntity struct {\n    guid string\n}\nfunc (e FSEntity) Guid() string {\n    return e.guid\n}\n\n//Child struct:\n\ntype DataBlock struct {\n    FSEntity\n    data []byte\n}\n\nfunc main() {\n    myVar := DataBlock{}\n    myVar.guid = \"test\"\n    myVar.data = []byte(\"moar test\")\n    Put(myVar)\n}\n\nfunc Put(x Guider) {\n    fmt.Printf(\"%+v\\n\", x)\n}\n</code></pre>\n\n<p>An interface will help you to accept the parent struct</p>\n"}], "owner": {"reputation": 11214, "user_id": 366207, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a8f20cf31acead835f9eacc605210903?s=128&d=identicon&r=PG", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/366207/ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2170, "favorite_count": 0, "accepted_answer_id": 37012004, "answer_count": 4, "score": 4, "last_activity_date": 1471773127, "creation_date": 1462300383, "question_id": 37011799, "link": "https://stackoverflow.com/questions/37011799/how-to-pass-a-child-struct-into-a-function-accepting-parent-struct", "title": "How to pass a &#39;child&#39; struct into a function accepting &#39;parent&#39; struct?", "body": "<p>I'm trying to use inheritance in Go, and although inheritance isn't 'technically' supported (as far as I know), you can get similar functionality by using anonymous fields.</p>\n\n<p>Here's how I'm defining 'inheritance' for across two structs:</p>\n\n<pre><code>//Parent struct:\n\ntype FSEntity struct {\n    guid GUIDNumber\n}\n\n//Child struct:\n\ntype DataBlock struct {\n    FSEntity\n    data []byte\n}\n</code></pre>\n\n<p>I now have a function defined as following, which is supposed to accept an instance of the parent struct <code>FSEntity</code>:</p>\n\n<pre><code>Put(entity FSEntity) {....}\n</code></pre>\n\n<p>But when I try passing an instance of <code>DataBlock</code> (which through inheritance is also <code>FSEntity</code>) into the <code>Put</code> function above like so:</p>\n\n<pre><code>guidNumber := GUIDNumber(1234)\nvalue := []byte(\"sample string\")\ndataBLock := DataBlock{FSEntity{guidNumber}, value}\n\nPut(dataBLock)\n</code></pre>\n\n<p>On the last line above, I get this error:</p>\n\n<pre><code>cannot use dataBLock (type DataBlock) as type FSEntity in argument to Put\n</code></pre>\n\n<p>How do I resolve this ?</p>\n"}, {"tags": ["ssl", "encryption", "go", "tcp"], "answers": [{"tags": [], "owner": {"reputation": 1017, "user_id": 2576956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/98TKO.jpg?s=128&g=1", "display_name": "bvpx", "link": "https://stackoverflow.com/users/2576956/bvpx"}, "is_accepted": false, "score": 0, "last_activity_date": 1462307282, "creation_date": 1462307282, "answer_id": 37013764, "question_id": 37011138, "link": "https://stackoverflow.com/questions/37011138/golang-tls-config-cipersuites-doesnt-restrict-client-auth/37013764#37013764", "title": "golang tls.Config CiperSuites doesn&#39;t restrict client auth", "body": "<p>turns out i forgot about my reverse proxy on apache.</p>\n\n<p>wireshark was looking on port 443 for https connections,</p>\n\n<p>but was filtering out the communication between apache and my server on the server's port</p>\n\n<p>i was able to successfully limit SSLCipherSuites on ssl.conf in apache's configuration and was able to analyze the traffic</p>\n\n<p>i'm assuming apache was passing on the data to my go program in the reverse proxy, which caused apache and go to negotiate a connection based on tls.Config, which i didn't see because that communication was on a different port on localhost (i was filtering wireshark based on port 443 on my IP address, not localhost, which is how apache and go are communicating)</p>\n"}], "owner": {"reputation": 1017, "user_id": 2576956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/98TKO.jpg?s=128&g=1", "display_name": "bvpx", "link": "https://stackoverflow.com/users/2576956/bvpx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462307282, "creation_date": 1462298211, "question_id": 37011138, "link": "https://stackoverflow.com/questions/37011138/golang-tls-config-cipersuites-doesnt-restrict-client-auth", "title": "golang tls.Config CiperSuites doesn&#39;t restrict client auth", "body": "<p>my tls.Config is set to not use ECDHE exchange so i can monitor my traffic in wireshark without having to get the client's keys.</p>\n\n<pre><code> config = &amp;tls.Config{\n     Certificates:             []tls.Certificate{cpair},\n     MinVersion:               tls.VersionTLS12,\n     PreferServerCipherSuites: true,\n     ClientAuth: tls.NoClientCert,\n     CipherSuites: []uint16{tls.TLS_RSA_WITH_AES_256_CBC_SHA,\n         tls.TLS_RSA_WITH_RC4_128_SHA,\n         tls.TLS_RSA_WITH_AES_128_CBC_SHA,\n     },\n }\n</code></pre>\n\n<p>however, when analyzing the traffic in wireshark, i still see the connection being made with a ECDHE ciper suiete:</p>\n\n<pre><code> 62 ssl_decrypt_pre_master_secret: session uses Diffie-Hellman key exchange \n (cipher suite 0xC014 TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA) \n and cannot be decrypted using a RSA private key file.\n</code></pre>\n"}, {"tags": ["go", "filesystems", "pipe", "bitwise-operators", "flags"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 3, "creation_date": 1462292876, "post_id": 37009406, "comment_id": 61571149, "body": "It does a bitwise OR: 0x2 | 0x400 = 0x402. So both flags get set in one integer value."}, {"owner": {"reputation": 511, "user_id": 402520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/caa9c447547d8560335a7bd1c3649072?s=128&d=identicon&r=PG", "display_name": "Ode", "link": "https://stackoverflow.com/users/402520/ode"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1462293060, "post_id": 37009406, "comment_id": 61571258, "body": "So am I to understand that if I want to append or create (if not exists) I would add <code>os.O_APPEND|os.O_CREATE</code> ?"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 1, "creation_date": 1462293589, "post_id": 37009406, "comment_id": 61571561, "body": "@OdeeOdum - The O_* arguments and their use with bitwise operators is not Go-specific, but appears in many systems (POSIX and otherwise).   May want to also see: <a href=\"http://linux.die.net/man/2/open\" rel=\"nofollow noreferrer\">linux.die.net/man/2/open</a>  which also contains some other expressions you may find useful (for example, how to &quot;turn off&quot; a mode) and also carry over from C to Go."}, {"owner": {"reputation": 511, "user_id": 402520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/caa9c447547d8560335a7bd1c3649072?s=128&d=identicon&r=PG", "display_name": "Ode", "link": "https://stackoverflow.com/users/402520/ode"}, "edited": false, "score": 0, "creation_date": 1462293751, "post_id": 37009406, "comment_id": 61571681, "body": "My understanding is that the O_* flags are OS specific more or less, stored in Go&#39;s syscall package that targets low-level OS operations, set by the GOARCH env var. <a href=\"https://golang.org/pkg/syscall/\" rel=\"nofollow noreferrer\">golang.org/pkg/syscall</a>"}, {"owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "edited": false, "score": 1, "creation_date": 1462293961, "post_id": 37009406, "comment_id": 61571798, "body": "@OdeeOdum, it will append if it does exist, and create it if it doesn&#39;t"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1462294305, "post_id": 37009406, "comment_id": 61572021, "body": "Re:  Update - It will append, and create if it doesn&#39;t exist.  If you /want/ an error if it exists, also add O_EXCL."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1462294530, "post_id": 37009406, "comment_id": 61572166, "body": "Recommended for the op: <a href=\"http://stackoverflow.com/questions/28432398/difference-between-some-operators-golang\">Difference between some operators \u201c|\u201d, \u201c^\u201d, \u201c&amp;\u201d, \u201c&amp;^\u201d. Golang</a>"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1462295929, "post_id": 37009406, "comment_id": 61573002, "body": "@OdeeOdum, no, O_* flags are platform-independent. At least those ones that OS package expects which is also platform-independent. On some platforms it will use O_* flags that are available by default. On Windows, for example, the flags have made up values to make OS package easier to write. Internally it will map them appropriately."}, {"owner": {"reputation": 511, "user_id": 402520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/caa9c447547d8560335a7bd1c3649072?s=128&d=identicon&r=PG", "display_name": "Ode", "link": "https://stackoverflow.com/users/402520/ode"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1462311732, "post_id": 37009406, "comment_id": 61581895, "body": "@creker thanks, yeah I discovered that reading the syscall documentation. Reference the link in my comment above."}], "answers": [{"tags": [], "owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "is_accepted": false, "score": 4, "last_activity_date": 1462294241, "last_edit_date": 1462294241, "creation_date": 1462293885, "answer_id": 37009794, "question_id": 37009406, "link": "https://stackoverflow.com/questions/37009406/what-is-the-purpose-of-the-pipe-character-in-gos-os-openfile-flag-argument/37009794#37009794", "title": "What is the purpose of the pipe character in Go&#39;s os.OpenFile flag argument?", "body": "<p>It is a bitwise, not a logical OR.</p>\n\n<p>If you write out the numbers in binary, and assign each a truth value 0/1, and apply the logical OR to each of the bits in place <code>i</code> between the arguments, and then reassemble the result into an integer by binary expansion - <strong>that's</strong> the <code>|</code> operator.</p>\n\n<p>It is often used in a way that is commonly described as a \"bitmask\" - you use a bitmask when you want a single int value to represent a (small) set of switches that could be turned on or off.   One bit per switch.   </p>\n\n<p>You should see in this context, <code>A | B</code> means \"all the switches in A that are on, as well as all the switches in B that are on\".   In your case, the switches define the exact behavior of the file open/creation function, as described by <a href=\"https://golang.org/pkg/os/#Open\" rel=\"nofollow\">the Go manual</a>. (And probably more in detail by the Unix manpage I linked above).</p>\n\n<p>In a bitmask, constants are typically defined that represent each switch - that's how those O_* constants are determined.   Each is an int with exactly one bit set and represents a particular switch.  (though, be careful, because sometimes they represent combinations of switches!).</p>\n\n<p>Also: </p>\n\n<pre><code> ^A  // All of the \"switches\" not currently on in A\n A&amp;^B // All of the \"switches\" on in A but not on in B\n A^B  // All of the \"switches\" on in exactly one of A or B\n</code></pre>\n\n<p>, etc.</p>\n\n<p>The operator <code>|</code> itself is described in the Go manual <a href=\"https://golang.org/ref/spec#Arithmetic_operators\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 511, "user_id": 402520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/caa9c447547d8560335a7bd1c3649072?s=128&d=identicon&r=PG", "display_name": "Ode", "link": "https://stackoverflow.com/users/402520/ode"}, "is_accepted": false, "score": 0, "last_activity_date": 1462377951, "creation_date": 1462377951, "answer_id": 37032870, "question_id": 37009406, "link": "https://stackoverflow.com/questions/37009406/what-is-the-purpose-of-the-pipe-character-in-gos-os-openfile-flag-argument/37032870#37032870", "title": "What is the purpose of the pipe character in Go&#39;s os.OpenFile flag argument?", "body": "<p>It is a bitwise OR operator. Its purpose being used here is to allow for multiple values to be passed as a bitmask. Thus you can combine flags to create a desired result such as using the <code>OpenFile()</code> function to create a file if it does not exist or append to it if it does.</p>\n\n<p><code>os.Openfile(\"foo.txt\", os.O_RDWR|os.O_CREATE|os.O_APPEND, 0660</code></p>\n\n<p>The constants being passed as arguments from the os package are assigned values from the syscall package. This package contains low-level operating system independent values.</p>\n\n<blockquote>\n  <p>Package syscall contains an interface to the low-level operating system primitives. The details vary depending on the underlying system, and by default, godoc will display the syscall documentation for the current system. If you want godoc to display syscall documentation for another system, set $GOOS and $GOARCH to the desired system. For example, if you want to view documentation for freebsd/arm on linux/amd64, set $GOOS to freebsd and $GOARCH to arm. The primary use of syscall is inside other packages that provide a more portable interface to the system, such as \"os\", \"time\" and \"net\".</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/pkg/syscall/\" rel=\"nofollow\">https://golang.org/pkg/syscall/</a></p>\n\n<p>As noted by @BadZen, a bitwise OR operator, in this case the '|' character, acts at the binary level changing any 0 values to 1's that are not already ones.</p>\n\n<blockquote>\n  <p>You should see in this context, A | B means \"all the switches in A that are on, as well as all the switches in B that are on\".</p>\n</blockquote>\n\n<p>By doing this as the function above displays, you are manipulating the behavior of the function to create a file (<code>os.O_CREATE</code>) with the given name of <code>foo.txt</code>or open the file for reading/writing (<code>os.O_RDWR</code>) and any value written to it will be appended (<code>os.O_APPEND</code>). Alternatively you could pass along <code>os.O_TRUNC</code> in order to truncate the file before writing.</p>\n\n<p>The bitwise OR operator allows you a powerful solution to combining different behaviors in order to get the result from the function that you are desiring. </p>\n"}], "owner": {"reputation": 511, "user_id": 402520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/caa9c447547d8560335a7bd1c3649072?s=128&d=identicon&r=PG", "display_name": "Ode", "link": "https://stackoverflow.com/users/402520/ode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1462469395, "creation_date": 1462292665, "last_edit_date": 1462469395, "question_id": 37009406, "link": "https://stackoverflow.com/questions/37009406/what-is-the-purpose-of-the-pipe-character-in-gos-os-openfile-flag-argument", "title": "What is the purpose of the pipe character in Go&#39;s os.OpenFile flag argument?", "body": "<p>When using the <code>OpenFile</code> function in Go's os package, what exactly is the purpose of the pipe character?</p>\n\n<p>Example:</p>\n\n<p><code>os.OpenFile(\"foo.txt\", os.O_RDWR|os.O_APPEND, 0660)</code></p>\n\n<p>Does it serve as a logical <code>OR</code>? If so, does Go choose the first one that is \"truthy\"?? Being that the constants those flags represent, at the heart of them are just integers written in hexadecimal, when compiled how does Go choose which flag to apply?</p>\n\n<p>After all, if the function call were to go by the largest number, <code>os.O_APPEND</code> would take precedence over all other flags passed in as seen below:</p>\n\n<pre><code>os.O_RDWR == syscall.O_RDWR == 0x2 == 2\nos.O_APPEND == syscall.O_APPEND == 0x400 == 1024\nos.O_CREATE == syscall.O_CREAT == 0x40 == 64\n</code></pre>\n\n<h3>UPDATE 1</h3>\n\n<p>To follow up on the comment below, if I have a bitwise operator calculation using <code>os.O_APPEND|os.O_CREATE</code> will that error if the file exists, or simply create/append as needed?</p>\n\n<h3>UPDATE 2</h3>\n\n<p>My question is two fold, one to understand the purpose of the bitwise operator, which I understand now is being used more as a bitmask operation; and two, how to use the <code>os.OpenFile()</code> function as a create or append operation. In my playing around I have found the following combination to work best:</p>\n\n<pre><code>file, _ := os.OpenFile(\"foo.txt\", os.O_RDWR|os.O_CREATE|os.O_APPEND, 0660)\nfile.WriteString(\"Hello World\\n\")\nfile.Sync()\n</code></pre>\n\n<p>Is this the correct way or is there a more succinct way to do this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 1, "creation_date": 1462288948, "post_id": 37008022, "comment_id": 61568682, "body": "Please 1st minimize your code, 2nd format it properly (some code is out of syntax highlighting)"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462312839, "post_id": 37008022, "comment_id": 61582363, "body": "Unless that reflect stuff is absolutely necessary I would get away from it as fast as possible. That being said, if this is supposed to work with arbitrary types, using reflect to find whatever fields are available, you need <code>GetField</code> to be recursive. This will never work as you have it because you&#39;re not addressing the fact that there could be infinite nesting. When you&#39;re working with a struct, and you encounter another struct inside it for example, you should be making a recursive call to <code>GetField</code> with the inner struct as it&#39;s arg."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462313042, "post_id": 37008022, "comment_id": 61582425, "body": "Your code is written in a static manner to deal with one level of nesting. The slice breaks it because it has two levels of nesting; outer-&gt;slice-&gt;structs but if it were struct-&gt;struct-&gt;struct you&#39;d be broken just the same. In order to make this really work you&#39;ll need to make a recursive call to <code>GetField</code> each time you encounter another level of nesting. It&#39;s the only way you can traverse some arbitrary struct completely."}], "owner": {"reputation": 101, "user_id": 3715287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db45a6abba7f0f282f97fdeff0a9d69?s=128&d=identicon&r=PG&f=1", "display_name": "user3715287", "link": "https://stackoverflow.com/users/3715287/user3715287"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462288904, "creation_date": 1462288614, "last_edit_date": 1462288904, "question_id": 37008022, "link": "https://stackoverflow.com/questions/37008022/access-struct-when-struct-is-in-an-slice", "title": "Access Struct when struct is in an Slice", "body": "<p>I need to generate a Form from the struct below. I need to have access to every field and type on the Doc to generate the Form. My problem is to access the struct fields when they are on an slice.</p>\n\n<p>This is the code</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n    \"time\"\n    \"reflect\"\n    \"strings\"\n    \"strconv\"\n\n)\ntype TestStruct struct {\n\n    Children22 struct {// I can acess this one ( see code) \n            ID   string\n            Name string\n        }\n    Children23 []struct { // this is not struct it is slice of sruct\n            ID1   string    // I would like to access this one\n            Name1 string\n        }\n    Nest struct {\n        Children []struct {  // I would like to get to this one too\n            ID2   string\n            Name2 string\n        }\n    }\n}\n\nfunc main() {\n\n    var t1 TestStruct\n    t1.InterfaceStruct = &amp;InterfaceStruct{}\n    main := reflect.ValueOf(&amp;t1)\n    err := GetField(main)\n            if err != nil {\n                fmt.Println(\"Error lev 1 = \", err)\n            }\n    }\n\nfunc GetField ( f reflect.Value ) error {\n\n    if f.Kind() != reflect.Ptr {\n        fmt.Println(\"Error not a pointer  \")  \n    }\n    val := f.Elem()\n    lenght := val.NumField()\n    for i := 0; i &lt; lenght; i++ {\n        typefield := val.Type().Field(i)\n        elementType := val.Type().Field(i).Type\n        type_filed := val.Type().Field(i).Type.String()\n        elemKind    := elementType.Kind()\n\n        fmt.Println(\"typefield.Name = \", typefield.Name) \n        fmt.Println(\"elementType    = \", elementType) \n        fmt.Println(\"what kind =\", elemKind )\n\n        if elemKind  ==  reflect.Slice{\n            fmt.Println(\"is a Slice\")\n            fmt.Println(\" Slice type =\", val.Field(i).Addr().Elem().Type() )\n            // what kind of slice \n            if strings.Contains(type_filed ,\"struct\") {\n\n                // I do not know how to address the struct inside the slice\n\n            }\n        }\n        if elemKind  == reflect.Struct {  // check first for time and URL are Struct\n            if type_filed != \"time.Time\" &amp;&amp; type_filed != \"url.URL\" {\n            fmt.Println(\"is a struct \")\n             //pass this to function recursive  as   reflect.Value\n            newSt := val.Field(i).Addr() // this works fine \n            err := GetField(newSt) // recall the func to get the struct\n                if err != nil {\n                    fmt.Println(\"Error = \", err)\n                }\n            }\n        }\n        if elemKind  ==  reflect.Map {\n            fmt.Println(\"is a Map\")\n        }\n\n    fmt.Println(\" \")\n\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": [".htaccess", "go", "openshift"], "comments": [{"owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 0, "creation_date": 1486836481, "post_id": 37007738, "comment_id": 71521796, "body": "Did you figure out how to redirect all traffic to https? That was your goal, right?"}, {"owner": {"reputation": 120, "user_id": 6155997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1719fd7c6ca6ca560a672210a1329010?s=128&d=identicon&r=PG&f=1", "display_name": "vendelin", "link": "https://stackoverflow.com/users/6155997/vendelin"}, "reply_to_user": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 0, "creation_date": 1492713974, "post_id": 37007738, "comment_id": 74108174, "body": "My goal was to handle subsubdomains. I didn&#39;t figure it out, so I changed to another service, where it works."}], "answers": [{"comments": [{"owner": {"reputation": 120, "user_id": 6155997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1719fd7c6ca6ca560a672210a1329010?s=128&d=identicon&r=PG&f=1", "display_name": "vendelin", "link": "https://stackoverflow.com/users/6155997/vendelin"}, "edited": false, "score": 0, "creation_date": 1462605469, "post_id": 37036289, "comment_id": 61715741, "body": "If you mean the the directory where <b>app-deployments</b> and <b>app-root</b> directories are, I can&#39;t write into that directly."}], "tags": [], "owner": {"reputation": 1118, "user_id": 3456632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0b27a1ed62f5e5c125f72768024d37?s=128&d=identicon&r=PG&f=1", "display_name": "edoput", "link": "https://stackoverflow.com/users/3456632/edoput"}, "is_accepted": false, "score": 0, "last_activity_date": 1462389697, "creation_date": 1462389697, "answer_id": 37036289, "question_id": 37007738, "link": "https://stackoverflow.com/questions/37007738/htaccess-file-location-for-openstack-with-go/37036289#37036289", "title": ".htaccess file location for OpenStack with Go", "body": "<p>I guess you are using the <a href=\"https://github.com/smarterclayton/openshift-go-cart\" rel=\"nofollow\">Go cartridge</a>; as far as I know it the <code>.htaccess</code> file should be on the web server gear. Your web server should run on the primary gear but without any other info it's hard to provide a meaningful answer.</p>\n"}], "owner": {"reputation": 120, "user_id": 6155997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1719fd7c6ca6ca560a672210a1329010?s=128&d=identicon&r=PG&f=1", "display_name": "vendelin", "link": "https://stackoverflow.com/users/6155997/vendelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462605126, "creation_date": 1462287844, "last_edit_date": 1462605126, "question_id": 37007738, "link": "https://stackoverflow.com/questions/37007738/htaccess-file-location-for-openstack-with-go", "title": ".htaccess file location for OpenStack with Go", "body": "<p>I'm using OpenShift, and I'd like to know where the .htaccess file should go with Go language (golang). I tried all locations with other languages, none of them worked.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Yes, I created a <strong>1 small gear</strong> application with Go language cartridge. Everything default, so it's <a href=\"https://hub.openshift.com/quickstarts/29-go-language\" rel=\"nofollow\"><strong><em>The Go Cartridge</em></strong></a></p>\n"}, {"tags": ["go", "floating-accuracy"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1462287988, "post_id": 37007494, "comment_id": 61567985, "body": "re 2 - it uses reflection. checkout the <code>reflect</code> package."}], "answers": [{"tags": [], "owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "is_accepted": true, "score": 9, "last_activity_date": 1462288059, "creation_date": 1462288059, "answer_id": 37007817, "question_id": 37007494, "link": "https://stackoverflow.com/questions/37007494/implementation-details-of-fmt-println-in-golang/37007817#37007817", "title": "Implementation details of fmt.Println in golang", "body": "<ol>\n<li><code>Println</code> determines whether the value implements the <code>Stringer</code> interface. If it does then it will call the <code>String()</code> to get formatted value. <code>big.Float</code> implements it for pointer receiver so you have to pass a reference. Otherwise <code>Println</code> will detect that it's a struct and print all of it's fields using reflection</li>\n<li>Go is open sourced. You can see for yourself <a href=\"https://golang.org/src/fmt/print.go?#L738\">https://golang.org/src/fmt/print.go?#L738</a> It uses type switches and reflection.</li>\n</ol>\n"}], "owner": {"reputation": 101, "user_id": 5623764, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/3f86dd02deab4f3e583862028aaf4177?s=128&d=identicon&r=PG&f=1", "display_name": "maryj", "link": "https://stackoverflow.com/users/5623764/maryj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 37007817, "answer_count": 1, "score": 3, "last_activity_date": 1570638589, "creation_date": 1462287215, "last_edit_date": 1570638589, "question_id": 37007494, "link": "https://stackoverflow.com/questions/37007494/implementation-details-of-fmt-println-in-golang", "title": "Implementation details of fmt.Println in golang", "body": "<p>Consider this code</p>\n\n<pre><code>import (\n  \"fmt\"\n  \"math/big\"\n)\n\nfunc main() {\n    var b1,b2,b3,bigSum big.Float\n\n    b1.SetFloat64(25.3)\n    b2.SetFloat64(76.2)\n    b1.SetFloat64(53.1)\n\n    bigSum.Add(&amp;b1, &amp;b2).Add(&amp;b3, &amp;bigSum)\n\n    fmt.Println(bigSum)   // {53 0 0 1 false [9317046909104082944] 8}\n    fmt.Println(&amp;bigSum)  // 129.3\n }\n</code></pre>\n\n<p>I have 2 questions</p>\n\n<ol>\n<li><p>Why I have to pass <code>bigSum</code> as <strong>reference</strong> (by using <code>&amp;</code>) to get the correct answer, otherwise we'll get back an object?</p></li>\n<li><p>How does <code>Println</code> work in Go? I mean how does it know which format it should apply for different types?</p></li>\n</ol>\n"}, {"tags": ["opengl", "go", "vbo"], "comments": [{"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 1, "creation_date": 1462278210, "post_id": 37003832, "comment_id": 61560520, "body": "I don&#39;t know anything about go, but <code>0x0</code> in stacktrace suggests you don&#39;t have this function on target machine. What&#39;s GL actual version on target machine? What is a minimum GL version you write your code for?"}, {"owner": {"reputation": 1127, "user_id": 1988755, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f88f2c6c883beb6ea20660080478c87?s=128&d=identicon&r=PG", "display_name": "Max Roncace", "link": "https://stackoverflow.com/users/1988755/max-roncace"}, "reply_to_user": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1462281317, "post_id": 37003832, "comment_id": 61562791, "body": "Ah, it was a subtle mistake. I was calling <code>glEnableVertexArrayAttrib</code> instead of <code>glEnableVertexAttribArray</code>. The latter is available since 2.1, the former only since 4.5. Still a bit odd that the Linux driver supports it while the Windows driver doesn&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 1127, "user_id": 1988755, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f88f2c6c883beb6ea20660080478c87?s=128&d=identicon&r=PG", "display_name": "Max Roncace", "link": "https://stackoverflow.com/users/1988755/max-roncace"}, "is_accepted": true, "score": 1, "last_activity_date": 1462281419, "creation_date": 1462281419, "answer_id": 37005267, "question_id": 37003832, "link": "https://stackoverflow.com/questions/37003832/segfault-generated-by-glenablevertexarrayattrib/37005267#37005267", "title": "Segfault generated by glEnableVertexArrayAttrib", "body": "<p>I made a subtle mistake in calling <code>glEnableVertexArrayAttrib</code>, only available since OpenGL 4.5, instead of <code>glEnableVertexAttribArray</code>, which is available since OpenGL 2.1. The former function allows attribute arrays to be toggled on a per-VAO basis, which isn't at all necessary in this context.</p>\n"}], "owner": {"reputation": 1127, "user_id": 1988755, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f88f2c6c883beb6ea20660080478c87?s=128&d=identicon&r=PG", "display_name": "Max Roncace", "link": "https://stackoverflow.com/users/1988755/max-roncace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 37005267, "answer_count": 1, "score": 1, "last_activity_date": 1462281419, "creation_date": 1462277611, "question_id": 37003832, "link": "https://stackoverflow.com/questions/37003832/segfault-generated-by-glenablevertexarrayattrib", "title": "Segfault generated by glEnableVertexArrayAttrib", "body": "<p>I'm writing a simple OpenGL program using <a href=\"https://github.com/go-gl/gl\" rel=\"nofollow\">go-gl</a>. While the program runs fine on most machines, it fails with a segfault when running under Windows on my laptop (it works on Linux though - this is what's odd about it). The culprit is my call to <code>glEnableVertexArrayAttrib</code>. I've attached the stack trace and relevant code below.</p>\n\n<p>Partial stack trace:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Exception 0xc0000005 0x8 0x0 0x0\nPC=0x0\nsignal arrived during external code execution\n\ngithub.com/go-gl/gl/v3.3-core/gl._Cfunc_glowEnableVertexArrayAttrib(0x0, 0x1)\n    github.com/go-gl/gl/v3.3-core/gl/_obj/_cgo_gotypes.go:4141 +0x41\ngithub.com/go-gl/gl/v3.3-core/gl.EnableVertexArrayAttrib(0x1)\n    C:/Users/mpron/go/src/github.com/go-gl/gl/v3.3-core/gl/package.go:5874 +0x3a\ngithub.com/caseif/cubic-go/graphics.prepareVbo(0x1, 0xc0820086e0, 0xc0820a7e70)\n    C:/Users/mpron/go/src/github.com/caseif/cubic-go/graphics/block_renderer.go:145 +0x108\n</code></pre>\n\n<p>Relevant code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>gl.GenVertexArrays(1, &amp;vaoHandle)\ngl.BindVertexArray(vaoHandle)\ngl.BindBuffer(gl.ARRAY_BUFFER, handle)\ngl.BufferData(gl.ARRAY_BUFFER, len(*vbo) * 4, gl.Ptr(*vbo), gl.STATIC_DRAW)\ngl.EnableVertexArrayAttrib(vaoHandle, positionAttrIndex) // line 145\ngl.VertexAttribPointer(positionAttrIndex, 3, gl.FLOAT, false, 12, nil)\n</code></pre>\n"}, {"tags": ["http", "go", "middleware"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462313557, "post_id": 37001804, "comment_id": 61582626, "body": "Are you sure you implemented the solution to that other question correctly? In your code above you&#39;re not passing <code>muxWithMiddlewares</code> to <code>ListenAndServe</code> so if you assigned a timeouthandler to it but did not pass it to <code>ListenAndServe</code> then I would not expect it to work, however, if you did I&#39;d be surprised to find it not working."}, {"owner": {"reputation": 138, "user_id": 582084, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/0e25fa0eef61eebda8f30a14f826315e?s=128&d=identicon&r=PG", "display_name": "vancouverwill", "link": "https://stackoverflow.com/users/582084/vancouverwill"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462350911, "post_id": 37001804, "comment_id": 61595602, "body": "@evanmcdonnal thanks for taking a look over. I have copied in the code I tried first based on the stackoverflow link, as stated it does work once but just not on subsequent slow queries."}], "owner": {"reputation": 138, "user_id": 582084, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/0e25fa0eef61eebda8f30a14f826315e?s=128&d=identicon&r=PG", "display_name": "vancouverwill", "link": "https://stackoverflow.com/users/582084/vancouverwill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 434, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462350767, "creation_date": 1462271624, "last_edit_date": 1495541263, "question_id": 37001804, "link": "https://stackoverflow.com/questions/37001804/how-to-use-timeouthandle-with-httprouter", "title": "How to use timeouthandle with httpRouter", "body": "<p>I am having some issues getting timeout to handle safely with   <a href=\"http://github.com/julienschmidt/httprouter\" rel=\"nofollow noreferrer\">github.com/julienschmidt/httprouter</a></p>\n\n<p>I have tried setting the timeout when I initialize the http Server. This does timeout but I get no response back to the user at all.</p>\n\n<pre><code>HTTP := &amp;http.Server{\n    Addr:    \":\" + port,\n    Handler: muxWithMiddlewares,\n    ReadTimeout:    1 * time.Second,\n    WriteTimeout:   1 * time.Second,\n    MaxHeaderBytes: 1 &lt;&lt; 20,\n}\nHTTP.ListenAndServe()\n</code></pre>\n\n<p>I have also tried the technique suggested in the below stackoverflow link which explains how to get a timeout working with gorilla mux. This works the very first time a user calls the API, shows a timeout but subsequent requests still funciton as normal. Any help would be much appreciated.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/19659600/how-to-use-gorilla-mux-with-http-timeouthandler\">How to use gorilla mux with http.TimeoutHandler</a></p>\n\n<p>EDIT: Here is the code I tried first with the solution from the other stackoverflow article. As stated above it works for the first request and shows timeout but each request there after, the request can take however long it needs. Note I was mimicking a slow response by inputting <code>time.Sleep(5*time.Second)</code> inside the <code>handlerA</code> and <code>handlerB</code> here. I would think <code>timeouthandler</code> would run If any query takes longer than the time limit but that doesn't appear to be the way I have it configured at the moment in either of the solutions shown here.</p>\n\n<pre><code>router := httprouter.New()\nrouter.GET(\"/xxx/\", handlerA)\nrouter.POST(\"/yyyy/\", handlerB)\nmuxWithMiddlewares := http.TimeoutHandler(router, time.Second*1, \"Timeout!\")\nerr := http.ListenAndServe(\":\"+port, muxWithMiddlewares)\n</code></pre>\n"}, {"tags": ["string", "go", "format", "printf"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 30, "last_activity_date": 1477901757, "last_edit_date": 1592644375, "creation_date": 1462271165, "answer_id": 37001642, "question_id": 37001449, "link": "https://stackoverflow.com/questions/37001449/replace-all-variables-in-sprintf-with-same-variable/37001642#37001642", "title": "Replace all variables in Sprintf with same variable", "body": "<p>It's possible, but the format string must be modified, you must use <a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\"><em>explicit argument indicies</em></a>:</p>\n<blockquote>\n<p>Explicit argument indexes:</p>\n<p>In Printf, Sprintf, and Fprintf, the default behavior is for each formatting verb to format successive arguments passed in the call. However, the notation [n] immediately before the verb indicates that the nth one-indexed argument is to be formatted instead. The same notation before a '*' for a width or precision selects the argument index holding the value. After processing a bracketed expression [n], subsequent verbs will use arguments n+1, n+2, etc. unless otherwise directed.</p>\n</blockquote>\n<p>Your example:</p>\n<pre><code>val := &quot;foo&quot;\ns := fmt.Sprintf(&quot;%[1]v in %[1]v is %[1]v&quot;, val)\nfmt.Println(s)\n</code></pre>\n<p>Output (try it on the <a href=\"https://play.golang.org/p/Ei3vDR6fpG\" rel=\"noreferrer\">Go Playground</a>):</p>\n<pre><code>foo in foo is foo\n</code></pre>\n<p>Of course the above example can simply be written in one line:</p>\n<pre><code>fmt.Printf(&quot;%[1]v in %[1]v is %[1]v&quot;, &quot;foo&quot;)\n</code></pre>\n<p>Also as a minor simplification, the first explicit argument index may be omitted as it defaults to <code>1</code>:</p>\n<pre><code>fmt.Printf(&quot;%v in %[1]v is %[1]v&quot;, &quot;foo&quot;)\n</code></pre>\n"}], "owner": {"reputation": 3465, "user_id": 232250, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/df589218079514d46c56905ca8c6aa0b?s=128&d=identicon&r=PG", "display_name": "\u211daphink", "link": "https://stackoverflow.com/users/232250/%e2%84%9daphink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3832, "favorite_count": 2, "accepted_answer_id": 37001642, "answer_count": 1, "score": 20, "last_activity_date": 1548453588, "creation_date": 1462270579, "last_edit_date": 1462271369, "question_id": 37001449, "link": "https://stackoverflow.com/questions/37001449/replace-all-variables-in-sprintf-with-same-variable", "title": "Replace all variables in Sprintf with same variable", "body": "<p>Is it possible using <code>fmt.Sprintf()</code> to replace all variables in the formatted string with the same value?</p>\n\n<p>Something like:</p>\n\n<pre><code>val := \"foo\"\ns := fmt.Sprintf(\"%v in %v is %v\", val)\n</code></pre>\n\n<p>which would return</p>\n\n<pre><code>\"foo in foo is foo\"\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 7731, "user_id": 1614378, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lOzxR.png?s=128&g=1", "display_name": "dieter", "link": "https://stackoverflow.com/users/1614378/dieter"}, "edited": false, "score": 1, "creation_date": 1462267981, "post_id": 37000417, "comment_id": 61553883, "body": "after rendering  all you can do is to &quot;refresh&quot; the page using ajax/js"}], "answers": [{"comments": [{"owner": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "edited": false, "score": 0, "creation_date": 1497636688, "post_id": 37000761, "comment_id": 76179020, "body": "Sorry, shouldn&#39;t that be <code>websocket.Message.Send(conn, &amp;msg)</code>? I can&#39;t see a <code>WriteMessage()</code> function there, just a <code>Write()</code> which is used to be compatible with the <code>io.Write()</code> interface?"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "edited": false, "score": 1, "creation_date": 1497652765, "post_id": 37000761, "comment_id": 76186081, "body": "Based on this <a href=\"https://github.com/golang/go/issues/18152\" rel=\"nofollow noreferrer\">issue</a> and <a href=\"https://github.com/golang/net/commit/97edce0b2e423f6a8debb459af47f4a3cb4ff954\" rel=\"nofollow noreferrer\">commit</a> using std websocket package isn&#39;t a best idea. [Gorilla websocket](github.com/gorilla/websocket) is more preferable."}, {"owner": {"reputation": 7731, "user_id": 1614378, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lOzxR.png?s=128&g=1", "display_name": "dieter", "link": "https://stackoverflow.com/users/1614378/dieter"}, "reply_to_user": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "edited": false, "score": 0, "creation_date": 1497690959, "post_id": 37000761, "comment_id": 76192938, "body": "@olegkovalov my example is gorilla websocket."}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "edited": false, "score": 0, "creation_date": 1497693077, "post_id": 37000761, "comment_id": 76193552, "body": "@dit [More Websockets in Go](golang.org/x/net/websocket) points to std package, that&#39;s why I&#39;ve mentioned about deprecation"}], "tags": [], "owner": {"reputation": 7731, "user_id": 1614378, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lOzxR.png?s=128&g=1", "display_name": "dieter", "link": "https://stackoverflow.com/users/1614378/dieter"}, "is_accepted": true, "score": 1, "last_activity_date": 1497644944, "last_edit_date": 1497644944, "creation_date": 1462268639, "answer_id": 37000761, "question_id": 37000417, "link": "https://stackoverflow.com/questions/37000417/it-is-possible-to-bind-a-golang-channel-into-a-template/37000761#37000761", "title": "It is possible to bind a golang channel into a template", "body": "<p>Use Websockets. Here are some examples:</p>\n\n<p>HTML/JavaScript:</p>\n\n<pre><code>&lt;script&gt;\n    var ws= new WebSocket(\"ws://yoursite.com\");\n    ws.onmessage = function (event) {\n        console.log(event.data);\n        // $('#your-element').html(event.data);\n    }\n&lt;/script&gt;\n</code></pre>\n\n<p>Go Websockets:</p>\n\n<pre><code>func websocketSenderHandler(conn *websocket.Conn){\n    for {\n        msg := &lt;- globalChannel\n        conn.WriteMessage(websocket.TextMessage, msg)\n    }\n}\n</code></pre>\n\n<p>More Websockets in Go: <a href=\"https://godoc.org/golang.org/x/net/websocket\" rel=\"nofollow noreferrer\">golang.org/x/net/websocket</a></p>\n\n<p>Other Example: <a href=\"https://github.com/golang-samples/websocket\" rel=\"nofollow noreferrer\">https://github.com/golang-samples/websocket</a></p>\n"}], "owner": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "accepted_answer_id": 37000761, "answer_count": 1, "score": 4, "last_activity_date": 1497646929, "creation_date": 1462267731, "last_edit_date": 1497646929, "question_id": 37000417, "link": "https://stackoverflow.com/questions/37000417/it-is-possible-to-bind-a-golang-channel-into-a-template", "title": "It is possible to bind a golang channel into a template", "body": "<p>I have the go templates (<code>upload.tmpl.html</code>) like this : </p>\n\n<pre><code>&lt;html&gt;\n&lt;body&gt;\n  &lt;div class=\"container\"&gt;\n    &lt;ul&gt;\n      &lt;li&gt;current fileName : {{ .fileName}} &lt;/li&gt;\n    &lt;/ul&gt; \n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>an handler <code>uploadHandler.go</code> with </p>\n\n<pre><code>func UploadHandler(c *gin.Context) {\n    file, header, err := c.Request.FormFile(\"file-upload\")\n    if err != nil {\n        log.Fatal(\"Erreur dans la r\u00e9cup\u00e9ration de fichier\")\n    }\n    //...\n    fileName := make(chan string)\n\n    go ReadCsvFile(bytes, fileName)\n    go func() {\n        for {\n            log.Info(&lt;-fileName)\n        }\n    }()\n\n    c.HTML(http.StatusOK, \"upload.tmpl.html\", gin.H{\n        \"fileName\":    &lt;-fileName,\n    })\n}\n</code></pre>\n\n<p>and the <code>ReadCsvFile()</code> method like that :</p>\n\n<pre><code>func ReadCsvFile(bytesCSV []byte, fileName chan string) {\n    r := bytes.NewReader(bytesCSV)\n    reader := csv.NewReader(r)\n    reader.Comma = ';'\n\n    records, err := reader.ReadAll()\n\n    if err != nil {\n        fmt.Println(\"Error:\", err)\n        return\n    }\n\n    db, _ := databaseApp.OpenDatabase()\n    defer db.Close()\n    for _, record := range records {\n        fileName &lt;- record[0]\n        product := &amp;em.Product{\n            Name:        record[0],\n            //...\n        }\n        db.Create(product)\n\n    }\n    fileName &lt;- \"done\"\n}\n</code></pre>\n\n<p>I try to display the current fileName of each line in the template, but it is possible to bind the channel into the template like this ? Because in this way the page does not load anymore.</p>\n"}, {"tags": ["javascript", "html", "mongodb", "go"], "comments": [{"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1462262968, "post_id": 36998730, "comment_id": 61550914, "body": "Where should the script get executed ? On the client (the player&#39;s browser/machine) or on the server ?"}, {"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 1, "creation_date": 1462263106, "post_id": 36998730, "comment_id": 61550988, "body": "If the uploaded code is javascript then it&#39;s not binary. Just execute it."}, {"owner": {"reputation": 226, "user_id": 2877566, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IxdDa.png?s=128&g=1", "display_name": "shane", "link": "https://stackoverflow.com/users/2877566/shane"}, "reply_to_user": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 0, "creation_date": 1462264515, "post_id": 36998730, "comment_id": 61551727, "body": "@slebetman they give me a file, and I store it for later"}, {"owner": {"reputation": 226, "user_id": 2877566, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IxdDa.png?s=128&g=1", "display_name": "shane", "link": "https://stackoverflow.com/users/2877566/shane"}, "reply_to_user": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1462264518, "post_id": 36998730, "comment_id": 61551728, "body": "@Elwinar I&#39;m honestly unsure where execution should happen. I&#39;m trying to mimic two independent clients asking from clientside, so I&#39;m inclined to think the code should run client-side"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1462266854, "post_id": 36998730, "comment_id": 61553126, "body": "Both approach would be valid, each with its own up and downsides. Running server-side would be more &quot;fair&quot; so the local connection of a player doesn&#39;t affect the performance of its bot. On the other hand, you risk overloading your server, and put yourself at risk by executing arbitrary code of unknown source on your server (sandboxing helps, but there is always a risk)."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1462266913, "post_id": 36998730, "comment_id": 61553176, "body": "I would advise running client-side. In which case, you can just have the bot be a Javascript object and run its <code>main</code> method."}], "answers": [{"tags": [], "owner": {"reputation": 1106, "user_id": 2520011, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3447f5abf5b5e6a5b3aba7a44e21a184?s=128&d=identicon&r=PG", "display_name": "overburn", "link": "https://stackoverflow.com/users/2520011/overburn"}, "is_accepted": false, "score": -1, "last_activity_date": 1462273507, "last_edit_date": 1462273507, "creation_date": 1462263564, "answer_id": 36999042, "question_id": 36998730, "link": "https://stackoverflow.com/questions/36998730/executing-binary-code/36999042#36999042", "title": "Executing Binary Code", "body": "<p>It should always be a good idea to sandbox any user submitted code, regardless if it's executed on the client or server.</p>\n"}], "owner": {"reputation": 226, "user_id": 2877566, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IxdDa.png?s=128&g=1", "display_name": "shane", "link": "https://stackoverflow.com/users/2877566/shane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 869, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1462273507, "creation_date": 1462262537, "last_edit_date": 1495540479, "question_id": 36998730, "link": "https://stackoverflow.com/questions/36998730/executing-binary-code", "title": "Executing Binary Code", "body": "<p>I'm designing a game and have a somewhat unique problem.    </p>\n\n<p>To play the game, players each write a simple javascript program that continually makes a request of my backend for the game state and then decides what to do and posts their move (also to my backend).</p>\n\n<p>I want to store the user scripts on my end though, so I've given them the option to upload their scripts with the standard HTML5 input type=\"file\". Then I use FileReader to read in the raw binary, and associate that binary input as a \"bot\" for the user in Mongo. (My backend is written in Go)</p>\n\n<p>Docs for FileReader:<br>\n<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/FileReader\" rel=\"nofollow noreferrer\">https://developer.mozilla.org/en-US/docs/Web/API/FileReader</a></p>\n\n<p>So far, I've found a resource for converting the binary back to ascii:<br>\n<a href=\"https://stackoverflow.com/questions/21354235/converting-binary-to-text-using-javascript\">Converting Binary to text using javascript</a>   </p>\n\n<p>I found a javascript interpreter that I can <em>allegedly</em> execute javascript from:\n<a href=\"https://github.com/jterrace/js.js\" rel=\"nofollow noreferrer\">https://github.com/jterrace/js.js</a>   </p>\n\n<p>In this situation, is there a better way to run the uploaded code, perhaps as an executable? Is a javascript sandbox solution like JSJS overkill?</p>\n"}, {"tags": ["go", "registry"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1462262144, "post_id": 36998532, "comment_id": 61550471, "body": "Are you sure you have a &quot;Default&quot; string value in your registry? I&#39;m afraid you don&#39;t have such a value. What is your windows version?"}, {"owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1462262291, "post_id": 36998532, "comment_id": 61550536, "body": "Yes actually any key has a Default String value in registry"}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1462262488, "post_id": 36998532, "comment_id": 61550651, "body": "And does it has a value set? The data is <code>(value not set)</code>. What kind of error or result did you received?"}, {"owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1462263018, "post_id": 36998532, "comment_id": 61550941, "body": "Yes I assigned 8 to Default  name and it returns &quot;The system cannot find the file specified.&quot;"}, {"owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1462263190, "post_id": 36998532, "comment_id": 61551038, "body": "Also I checked k.GetStringValue(&quot;(Default)&quot;) in other paths and it cannot return the value of default"}], "answers": [{"comments": [{"owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "edited": false, "score": 0, "creation_date": 1462267624, "post_id": 36999098, "comment_id": 61553628, "body": "It&#39;s not working! Please check it on your Windows machine. Thanks"}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 1, "last_activity_date": 1462263743, "creation_date": 1462263743, "answer_id": 36999098, "question_id": 36998532, "link": "https://stackoverflow.com/questions/36998532/how-to-return-a-default-value-from-windows-registry-with-golang/36999098#36999098", "title": "How to return a default value from windows/registry with golang", "body": "<p>I think the issue is that whilst regedit show the default value as <code>(Default)</code> (note the parentheses), actually you have to access without parentheses. </p>\n\n<pre><code>k, err := registry.OpenKey(registry.LOCAL_MACHINE, `SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion`, registry.QUERY_VALUE)\nif err != nil {\n    log.Fatal(err)\n}\ndefer k.Close()\n\ns, _, err := k.GetStringValue(\"Default\")\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Printf(\"Windows system root is %q\\n\", s)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "is_accepted": true, "score": 5, "last_activity_date": 1462384259, "last_edit_date": 1462384259, "creation_date": 1462268658, "answer_id": 37000766, "question_id": 36998532, "link": "https://stackoverflow.com/questions/36998532/how-to-return-a-default-value-from-windows-registry-with-golang/37000766#37000766", "title": "How to return a default value from windows/registry with golang", "body": "<p>I find it out!</p>\n\n<pre><code>k, err := registry.OpenKey(registry.LOCAL_MACHINE, `SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion`, registry.ALL_ACCESS)\ns, _, err := k.GetStringValue(\"\") // The blank one refers to (Default)\n</code></pre>\n"}], "owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1661, "favorite_count": 0, "accepted_answer_id": 37000766, "answer_count": 2, "score": 1, "last_activity_date": 1538578048, "creation_date": 1462261798, "last_edit_date": 1495621611, "question_id": 36998532, "link": "https://stackoverflow.com/questions/36998532/how-to-return-a-default-value-from-windows-registry-with-golang", "title": "How to return a default value from windows/registry with golang", "body": "<p>I just want to return a (Default) string value in Windows registry with Golang</p>\n\n<pre><code>k, err := registry.OpenKey(registry.LOCAL_MACHINE, `SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion`, registry.QUERY_VALUE)\nif err != nil {\n    log.Fatal(err)\n}\ndefer k.Close()\n\ns, _, err := k.GetStringValue(\"(Default)\") // It won't work\n// s, _, err := k.GetStringValue(\"SystemRoot\") // This is worked\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Printf(\"Windows system root is %q\\n\", s)\n</code></pre>\n\n<p>I run it in CMD admin mode but there was noting to see</p>\n"}, {"tags": ["go", "dns", "vpn"], "comments": [{"owner": {"reputation": 99, "user_id": 852329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bcadf15046a199c661894f9c35680b?s=128&d=identicon&r=PG", "display_name": "lafolle", "link": "https://stackoverflow.com/users/852329/lafolle"}, "edited": false, "score": 1, "creation_date": 1462271032, "post_id": 36997731, "comment_id": 61555936, "body": "This thread might be helpful to you: <a href=\"http://stackoverflow.com/questions/30043248/why-golang-lookup-function-cant-provide-a-server-parameter\" title=\"why golang lookup function cant provide a server parameter\">stackoverflow.com/questions/30043248/&hellip;</a>"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1462312038, "post_id": 36997731, "comment_id": 61582031, "body": "This seems like a bug, so you should file an <a href=\"https://github.com/golang/go/issues\" rel=\"nofollow noreferrer\">issue</a>, also try to compile go from git and see if the problem is fixed in it (there was some DNS work in git few days ago)."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1462898040, "post_id": 36997731, "comment_id": 61826646, "body": "OSX uses cgo by default <a href=\"https://golang.org/src/net/conf.go#L68\" rel=\"nofollow noreferrer\">golang.org/src/net/conf.go#L68</a>"}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1462898514, "post_id": 36997731, "comment_id": 61826907, "body": "This may be relevant: <a href=\"http://serverfault.com/questions/478534/how-is-dns-lookup-configured-for-osx-mountain-lion\" title=\"how is dns lookup configured for osx mountain lion\">serverfault.com/questions/478534/&hellip;</a>"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 1, "creation_date": 1492628538, "post_id": 36997731, "comment_id": 74062497, "body": "Please provide the output of <code>host -a scotty.infinidat.com</code> from the OSX command line while connected to the VPN, and while disconnected.  (Assuming the behaviour is different whether connected or not)"}], "answers": [{"tags": [], "owner": {"reputation": 2942, "user_id": 887427, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84abfab913d9a8d7c5f34bf9a241ae80?s=128&d=identicon&r=PG", "display_name": "robermorales", "link": "https://stackoverflow.com/users/887427/robermorales"}, "is_accepted": false, "score": 0, "last_activity_date": 1498640851, "creation_date": 1498640851, "answer_id": 44798194, "question_id": 36997731, "link": "https://stackoverflow.com/questions/36997731/app-doesnt-resolve-an-internal-dns-entry-when-connecting-via-cisco-ipsec/44798194#44798194", "title": "App doesn&#39;t resolve an internal DNS entry when connecting via Cisco IPSec", "body": "<p>Perhaps you can use a complete DNS library to first resolve the IP:</p>\n\n<pre><code> package main\n\n import (\n    \"log\"\n\n    \"github.com/miekg/dns\"\n )\n\n func main() {\n    c := dns.Client{}\n    m := dns.Msg{}\n    m.SetQuestion(\"scotty.infinidat.com.\", dns.TypeA)\n    r, t, err := c.Exchange(&amp;m, \"10.135.1.1:53\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Printf(\"Took %v\", t)\n    for _, ans := range r.Answer {\n        Arecord := ans.(*dns.A)\n        log.Printf(\"%s\", Arecord.A)\n    }\n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "is_accepted": false, "score": 0, "last_activity_date": 1501444047, "creation_date": 1501444047, "answer_id": 45404022, "question_id": 36997731, "link": "https://stackoverflow.com/questions/36997731/app-doesnt-resolve-an-internal-dns-entry-when-connecting-via-cisco-ipsec/45404022#45404022", "title": "App doesn&#39;t resolve an internal DNS entry when connecting via Cisco IPSec", "body": "<p>Probably you already did this but from my side when executing <code>dig scotty.infinidat.com</code> I got no records (matching your results):</p>\n\n<pre><code>$ dig scotty.infinidat.com\n\n; &lt;&lt;&gt;&gt; DiG 9.8.3-P1 &lt;&lt;&gt;&gt; scotty.infinidat.com\n;; global options: +cmd\n;; Got answer:\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NXDOMAIN, id: 53313\n;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 0\n\n;; QUESTION SECTION:\n;scotty.infinidat.com.          IN      A\n\n;; AUTHORITY SECTION:\ninfinidat.com.          155     IN      SOA     ns1.dnsimple.com. admin.dnsimple.com. 1438782431 86400 7200 604800 300\n\n;; Query time: 234 msec\n;; SERVER: 10.132.0.1#53(10.132.0.1)\n;; WHEN: Sun Jul 30 21:37:14 2017\n;; MSG SIZE  rcvd: 93\n</code></pre>\n\n<p>So if for <code>www.google.com</code> is working, probably high are the changes is something more related to your DNS/ZONE.</p>\n"}], "owner": {"reputation": 771, "user_id": 568233, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/jEUAq.jpg?s=128&g=1", "display_name": "reish", "link": "https://stackoverflow.com/users/568233/reish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 740, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1501444047, "creation_date": 1462258922, "last_edit_date": 1498471053, "question_id": 36997731, "link": "https://stackoverflow.com/questions/36997731/app-doesnt-resolve-an-internal-dns-entry-when-connecting-via-cisco-ipsec", "title": "App doesn&#39;t resolve an internal DNS entry when connecting via Cisco IPSec", "body": "<p>I use Cisco IPsec to connect to my workplace VPN. I connect using OS X's native Cisco IPSec client. We have an internal DNS server that holds records for internal sites, such as <code>scotty.infinidat.com</code>. Using curl to contact an internal site works as expected. Using the following Python code also works:</p>\n\n<pre><code>import requests\n\nresp = requests.get(\"http://www.google.com\")\nresp.raise_for_status()\n\nresp = requests.get(\"http://scotty.infinidat.com\")\nresp.raise_for_status()\n</code></pre>\n\n<p>However, trying to implement an equivalent in Go fails:</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc main() {\n    _, err := http.Get(\"http://google.com/\") // This works\n    if err != nil {\n        panic(fmt.Sprintf(\"Error contacting Google: %s\", err))\n    }\n\n    _, err = http.Get(\"http://scotty.infinidat.com/\") // This doesn't\n    if err != nil {\n        panic(fmt.Sprintf(\"Error contacting an internal site: %s\", err))\n    }\n}\n</code></pre>\n\n<p>Running the program above while connected to the VPN yields the following output:</p>\n\n<pre><code>panic: Error contacting internal site: Get http://scotty.infinidat.com/: dial tcp: lookup scotty.infinidat.com on 10.135.1.1:53: no such host\n\ngoroutine 1 [running]:\npanic(0x290ca0, 0xc82010a490)\n        /usr/local/Cellar/go/1.6.2/libexec/src/runtime/panic.go:481 +0x3e6\nmain.main()\n        /Users/roeyd/src/go/src/webtest/main.go:16 +0x2af\n</code></pre>\n\n<p>Where 10.135.1.1 is my local network's DNS server. To my understanding the pure Go DNS resolver isn't available on OS X. Forcing Go to use the cgo DNS resolver by setting <code>GODEBUG=netdns=cgo</code> doesn't make any difference.</p>\n"}, {"tags": ["php", "json", "data-structures", "go"], "answers": [{"comments": [{"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1462248371, "post_id": 36995414, "comment_id": 61544560, "body": "is there a better way? I have inner structs."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1462248403, "last_edit_date": 1462248403, "creation_date": 1462248300, "answer_id": 36995414, "question_id": 36995236, "link": "https://stackoverflow.com/questions/36995236/golang-constant-struct-key/36995414#36995414", "title": "Golang constant struct key", "body": "<p>Use a variable:</p>\n\n<pre><code>var key = \"secret\"\nif env == \"dev\" {\n   key = \"dev\"\n}\n</code></pre>\n\n<p>Use that variable when creating a map to serialize to JSON:</p>\n\n<pre><code>m := map[string]interface{}{key: \"value\"}\np, err := json.Marshal(m)\nif err != nil {\n   // handle error\n}\n// p contains the json value.\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/KrPUR750Kw\" rel=\"nofollow\">playground example</a></p>\n"}, {"comments": [{"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1462248650, "post_id": 36995422, "comment_id": 61544624, "body": "I was thinking of 2 and 3, but it seems a bit dirty. 1 wouldn&#39;t work because I have inner structs that has inner structs that also require changing of keys depending on environment. also, some of this is db result."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1462255589, "post_id": 36995422, "comment_id": 61546993, "body": "I agree that neither of 2 and 3 is particularly nice. However your requirement doesn&#39;t sound clean either. From my experience having different behavior in dev and prod is a receipt for disaster ;)"}, {"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1462255721, "post_id": 36995422, "comment_id": 61547063, "body": "Actually this is to obfuscate the json response. Like instead of a key that says &quot;user_info&quot;, it will be some random string on production. This is for a game api. And yes, the json is then encrypted."}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 0, "last_activity_date": 1462248367, "creation_date": 1462248367, "answer_id": 36995422, "question_id": 36995236, "link": "https://stackoverflow.com/questions/36995236/golang-constant-struct-key/36995422#36995422", "title": "Golang constant struct key", "body": "<p>The answer to this question depends on your actual use case. Here are 3 ways to achieve what you ask:</p>\n\n<ol>\n<li>Use <code>map[string]interface{}</code> instead of struct</li>\n<li>Use different struct types (as in the example from the question)</li>\n<li>Use a single struct type that contains fields for both \"dev\" and \"prod\" environments, use \"json:,omitempty\" and populate only necessary fields before marshalling to JSON.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1473060245, "last_edit_date": 1473060245, "creation_date": 1462253788, "answer_id": 36996374, "question_id": 36995236, "link": "https://stackoverflow.com/questions/36995236/golang-constant-struct-key/36996374#36996374", "title": "Golang constant struct key", "body": "<p>You may create a struct type holding the common part of your data structure, and you may create new types <em>embedding</em> this and only adding the deviating new field. So there is no code repetition of the common part of the data structure:</p>\n\n<pre><code>type Response struct {\n    F1 string\n    F2 int\n}\n\nfunc main() {\n    for _, env := range []string{\"dev\", \"prod\"} {\n        if env == \"dev\" {\n            type Resp struct {\n                Response\n                Key string\n            }\n            r := Resp{Response{\"f1dev\", 1}, \"value\"}\n            json.NewEncoder(os.Stdout).Encode(r)\n        } else {\n            type Resp struct {\n                Response\n                Secret string\n            }\n            r := Resp{Response{\"f1pro\", 2}, \"value\"}\n            json.NewEncoder(os.Stdout).Encode(r)\n        }\n    }\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/a0gwZQ5Wuv\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>{\"F1\":\"f1dev\",\"F2\":1,\"Key\":\"value\"}\n{\"F1\":\"f1pro\",\"F2\":2,\"Secret\":\"value\"}\n</code></pre>\n\n<p>Note that you may also use the same <code>Response</code> value if they are the same for the 2 use cases:</p>\n\n<pre><code>comResp := Response{\"f1value\", 1}\nif env == \"dev\" {\n    type Resp struct {\n        Response\n        Key string\n    }\n    r := Resp{comResp, \"value\"}\n    json.NewEncoder(os.Stdout).Encode(r)\n} else {\n    type Resp struct {\n        Response\n        Secret string\n    }\n    r := Resp{comResp, \"value\"}\n    json.NewEncoder(os.Stdout).Encode(r)\n}\n</code></pre>\n\n<p>You may shorten the code above by using anonymous struct and not creating a local variable (not necessarily more readable):</p>\n\n<pre><code>if env == \"dev\" {\n    json.NewEncoder(os.Stdout).Encode(struct {\n        Response\n        Key string\n    }{comResp, \"value\"})\n} else {\n    json.NewEncoder(os.Stdout).Encode(struct {\n        Response\n        Secret string\n    }{comResp, \"value\"})\n}\n</code></pre>\n"}], "owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1803, "favorite_count": 0, "accepted_answer_id": 36996374, "answer_count": 3, "score": 1, "last_activity_date": 1473060245, "creation_date": 1462247101, "question_id": 36995236, "link": "https://stackoverflow.com/questions/36995236/golang-constant-struct-key", "title": "Golang constant struct key", "body": "<p>In PHP we can do something like:</p>\n\n<pre><code>if ($env == \"dev\") \n  define(\"key\", \"key\")\nelse\n  define(\"key\", \"secret\")\n\n// json ouput\n//{ key : \"value\" } or { secret : \"value\" }\n</code></pre>\n\n<p>How do I properly translate above PHP approach to GO? </p>\n\n<p>I was thinking of something like:</p>\n\n<pre><code>if *env == \"dev\" {\n  type response struct {\n    key string\n    ...50 more keys that should also be different depending on env\n  }\n} else {\n    secret string\n    ...50 more keys...\n}\n</code></pre>\n\n<p>But I guess that is not only wrong but would also create a huge repeated code...</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1462241299, "post_id": 36994445, "comment_id": 61542850, "body": "And what&#39;s in your <code>main.go</code> at line <code>55</code>?"}, {"owner": {"reputation": 2214, "user_id": 566878, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ade286412540ec61fe0ff72f8ccdf0ee?s=128&d=identicon&r=PG", "display_name": "Ankush", "link": "https://stackoverflow.com/users/566878/ankush"}, "edited": false, "score": 0, "creation_date": 1462243361, "post_id": 36994445, "comment_id": 61543349, "body": "Does this help? <a href=\"https://github.com/golang/go/issues/7133\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/7133</a> If one uses a package identifier without specifying an item in the package, the error returned is &quot;use of package foo not in selector&quot; (<a href=\"http://play.golang.org/p/Q-KDAvp9mN\" rel=\"nofollow noreferrer\">play.golang.org/p/Q-KDAvp9mN</a>)"}, {"owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1462243697, "post_id": 36994445, "comment_id": 61543442, "body": "@icza line 55 is <code>myConfig = NewMyConfig(&amp;viper)</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1462243843, "post_id": 36994445, "comment_id": 61543469, "body": "@Blankman <code>&amp;viper</code> =&gt; <code>viper</code> is the name of the package. You probably wanted <code>myConfig = NewMyConfig(viper.New())</code>. Or if you named your variable <code>viper</code>, change that."}, {"owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1462244774, "post_id": 36994445, "comment_id": 61543706, "body": "@icza its wierd, I just imported the lib, and somehow I can use the variable <code>viper</code>.  But in the code it creates a <code>v</code> in the init ? <a href=\"https://github.com/spf13/viper/blob/master/viper.go#L42\" rel=\"nofollow noreferrer\">github.com/spf13/viper/blob/master/viper.go#L42</a>    I&#39;m confused not sure what to do."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1462244900, "post_id": 36994445, "comment_id": 61543744, "body": "@Blankman <code>viper</code> is the identifier you can use to refer to the package. That <code>v</code> is an unexported variable of the package, you can&#39;t refer to that. You may use the package name to refer to the exported identifiers of the package, e.g. <code>viper.New()</code> to call the exported <code>New()</code> function which returns a pointer to a new, initialized <code>viper.Viper</code> struct."}], "answers": [{"comments": [{"owner": {"reputation": 1407, "user_id": 313151, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/20a273b59e71d37fcfe276d923984cb8?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/313151/jason"}, "edited": false, "score": 9, "creation_date": 1550762401, "post_id": 36995058, "comment_id": 96397655, "body": "That is a mouth full to digest :P"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 35, "last_activity_date": 1462247040, "last_edit_date": 1462247040, "creation_date": 1462245775, "answer_id": 36995058, "question_id": 36994445, "link": "https://stackoverflow.com/questions/36994445/getting-a-use-of-package-without-selector-error/36995058#36995058", "title": "Getting a use of package without selector error", "body": "<p>When you <a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"noreferrer\">import</a> a package like</p>\n\n<pre><code>import \"github.com/spf13/viper\"\n</code></pre>\n\n<p>the package name (which is <code>viper</code> in this case) will be available to you as a new identifier. You may use this identifier to construct <a href=\"https://golang.org/ref/spec#Qualified_identifiers\" rel=\"noreferrer\">qualified identifiers</a> to refer to <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"noreferrer\">exported identifiers</a> of the package (identifiers that start wtih an uppercase letter).</p>\n\n<p>The package name itself cannot be used by itself. The line that gives you error:</p>\n\n<pre><code>myConfig = NewMyConfig(&amp;viper)\n</code></pre>\n\n<p>You used package name <code>viper</code> without specifying what exported identifier you want to refer to from the package.</p>\n\n<p>You want to use your <code>NewMyConfig()</code> function to obtain a pointer to a new value of your <code>MyConfig</code> struct. Your <code>NewMyConfig()</code> function expects a value of <code>*viper.Viper</code>. Since the <code>viper.Viper</code> struct contains unexported fields, you can just create it like <code>&amp;viper.Viper{}</code>, but the <code>viper</code> package exports a function <a href=\"https://godoc.org/github.com/spf13/viper#New\" rel=\"noreferrer\"><code>viper.New()</code></a> which can be used to obtain a pointer to a new, initialized <code>viper.Viper</code> value. You may use it like:</p>\n\n<pre><code>vp := viper.New()\nmyConfig = NewMyConfig(vp)\n</code></pre>\n\n<p>Note that the <code>viper</code> package declares an internal, global, unexported <code>viper.Viper</code> \"instance\". There are many exported <em>functions</em> that match <em>methods</em> of the <code>viper.Viper</code> type. These \"matching\" functions work on the global, unexported <code>viper.Viper</code> instance. So you may choose to use all the exported global functions of the <code>viper</code> package, or create your own <code>Viper</code> instance and then keep using its methods afterwards.</p>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61433, "favorite_count": 3, "accepted_answer_id": 36995058, "answer_count": 1, "score": 36, "last_activity_date": 1462247040, "creation_date": 1462241169, "question_id": 36994445, "link": "https://stackoverflow.com/questions/36994445/getting-a-use-of-package-without-selector-error", "title": "Getting a use of package without selector error", "body": "<p>I'm using this config library called <a href=\"https://github.com/spf13/viper\" rel=\"noreferrer\">Viper</a></p>\n\n<p>In my main I have this:</p>\n\n<pre><code>viper.SetConfigName(\"development\")\nviper.AddConfigPath(\"config/settings/\")\nerr := viper.ReadInConfig()\nif err != nil {\n    fmt.Println(\"viper config read error %v\", err)\n}\n</code></pre>\n\n<p>I then have a struct that takes a viper as parameter:</p>\n\n<pre><code>type MyConfig struct {\n  v *viper.Viper\n}\n</code></pre>\n\n<p>In my main I have a function that returns this MyConfig like:</p>\n\n<pre><code>func NewMyConfig(v *viper.Viper) *MyConfig {\n    return &amp;MyConfig{v: v}\n}\n</code></pre>\n\n<p>I am getting this error:</p>\n\n<pre><code>./main.go:55: use of package viper without selector\n</code></pre>\n\n<p>Not sure what I should be doing?</p>\n"}, {"tags": ["python", "go", "mergesort"], "comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1462259633, "post_id": 36992483, "comment_id": 61549092, "body": "Welcome to SO ... always check mark your chosen correct answer to reward the kind effort they have renderer"}], "answers": [{"comments": [{"owner": {"reputation": 2543, "user_id": 3527520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/284940a2227bc0245276e6022be418e3?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Fraser", "link": "https://stackoverflow.com/users/3527520/simon-fraser"}, "edited": false, "score": 1, "creation_date": 1462230799, "post_id": 36992577, "comment_id": 61540229, "body": "The Go program has an error whether or not it&#39;s called from Python, so this can&#39;t be the issue.  <code>command</code> is a list, in the Python script, and <code>call</code> does take a list argument without <code>shell=True</code>"}], "tags": [], "owner": {"reputation": 77, "user_id": 241286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/278f19d9045d3ecf2cfce36d79c025ab?s=128&d=identicon&r=PG", "display_name": "Gekitsuu", "link": "https://stackoverflow.com/users/241286/gekitsuu"}, "is_accepted": false, "score": -3, "last_activity_date": 1462227854, "creation_date": 1462227854, "answer_id": 36992577, "question_id": 36992483, "link": "https://stackoverflow.com/questions/36992483/getting-an-error-on-trying-to-execute-a-golang-program-from-a-python-script/36992577#36992577", "title": "Getting an error on trying to execute a golang program from a python script", "body": "<p>Try changing:</p>\n\n<pre><code>call(command)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>call(command, shell=True)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1457, "user_id": 6276241, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f64f62cb877130d0f4e0b036c2cdfd12?s=128&d=identicon&r=PG", "display_name": "jdecid", "link": "https://stackoverflow.com/users/6276241/jdecid"}, "edited": false, "score": 0, "creation_date": 1462256020, "post_id": 36993047, "comment_id": 61547207, "body": "Thanks a lot! Works perfectly! What a stupid error hahaha"}], "tags": [], "owner": {"reputation": 2543, "user_id": 3527520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/284940a2227bc0245276e6022be418e3?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Fraser", "link": "https://stackoverflow.com/users/3527520/simon-fraser"}, "is_accepted": true, "score": 4, "last_activity_date": 1462230748, "creation_date": 1462230748, "answer_id": 36993047, "question_id": 36992483, "link": "https://stackoverflow.com/questions/36992483/getting-an-error-on-trying-to-execute-a-golang-program-from-a-python-script/36993047#36993047", "title": "Getting an error on trying to execute a golang program from a python script", "body": "<p>The problem isn't in your Python, because the Go program gets the same error without being called from Python. In your <code>main</code> func, you are creating a slice called <code>v</code>, starting from argument position <code>1</code>, so excluding the name of the program:</p>\n\n<pre><code>for i := 1; i &lt; len(args); i++ {\n    f,_ := strconv.Atoi(os.Args[i])\n    v = append(v, f)\n}\n</code></pre>\n\n<p>But then you're giving <code>mergesort</code> the length of <code>args</code>, not the length of <code>v</code>, so it's an off-by-one error as it's been told <code>v</code> has 1 more element than it actually does. Down the line the program tries to access an element of <code>v</code> that's beyond the end of the slice:</p>\n\n<pre><code>mergesort(v, 0, len(args) - 1)\n</code></pre>\n\n<p>Try <code>mergesort(v, 0, len(v) - 1)</code> in your main function, instead.</p>\n"}], "owner": {"reputation": 1457, "user_id": 6276241, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f64f62cb877130d0f4e0b036c2cdfd12?s=128&d=identicon&r=PG", "display_name": "jdecid", "link": "https://stackoverflow.com/users/6276241/jdecid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 36993047, "answer_count": 2, "score": 0, "last_activity_date": 1550149913, "creation_date": 1462227361, "last_edit_date": 1550149913, "question_id": 36992483, "link": "https://stackoverflow.com/questions/36992483/getting-an-error-on-trying-to-execute-a-golang-program-from-a-python-script", "title": "Getting an error on trying to execute a golang program from a python script", "body": "<p>I'm programming a performance comparison between C++ and GoLang to get data to perform a statistical analysis and I created a Python script to take all data and execute by itself both programs. With C++ I have no problems and the execution works properly, but in go I get this error:</p>\n\n<pre><code>panic: runtime error: index out of range\n\ngoroutine 1 [running]:\nruntime.panic(0x44d600, 0x4b9897)\n    /usr/lib/go/src/pkg/runtime/panic.c:266 +0xb6\nmain.merge(0xc210047000, 0x9, 0x10, 0x8, 0x8, ...)\n    /windows/DATA/FIB/PE/B7_PLSpeed/nlogn.go:13 +0x22c\nmain.mergesort(0xc210047000, 0x9, 0x10, 0x8, 0x9)\n    /windows/DATA/FIB/PE/B7_PLSpeed/nlogn.go:43 +0xec\nmain.mergesort(0xc210047000, 0x9, 0x10, 0x5, 0x9)\n    /windows/DATA/FIB/PE/B7_PLSpeed/nlogn.go:42 +0xac\nmain.mergesort(0xc210047000, 0x9, 0x10, 0x0, 0x9)\n    /windows/DATA/FIB/PE/B7_PLSpeed/nlogn.go:42 +0xac\nmain.main()\n    /windows/DATA/FIB/PE/B7_PLSpeed/nlogn.go:54 +0x1c1\n</code></pre>\n\n<p>If someone can help me I'd be very pleased!\nI'll leave here my Python script and Go source code.</p>\n\n<p>Python:</p>\n\n<pre><code>import time\nimport random\nfrom subprocess import call\nfrom sys import argv\n\n\ndef usage():\n    print(\"Usage: \" + argv[0] + \" &lt;Binary1&gt; &lt;Binary2&gt; &lt;n elements&gt; &lt;#executions&gt;\")\n\nif __name__ == '__main__':\n    if len(argv) != 5:\n        usage()\n    else:\n        program1 = argv[1]\n        program2 = argv[2]\n        n = int(argv[3])\n        executions = int(argv[4])\n\n        for x in range(0, executions):\n            command = ['']\n            # 32-bit range vector(n) random generator\n            for y in range(0, n-1):\n                command.append(str(random.randint(-2147473648, 2147473647)))\n\n            if(random.choice((True, False))):\n                program1, program2 = program2, program1\n\n            # Program1\n            command[0] = './' + program1\n            pre = time.time()\n            call(command)\n            post = time.time()\n            f = open(program1 + ' - ' + str(n), 'a')\n            f.write(str(post-pre) + \"ms\\n\")\n            f.close\n\n            # Program2\n            command[0] = './' + program2\n            pre = time.time()\n            call(command)\n            post = time.time()\n            f = open(program2 + ' - ' + str(n), 'a')\n            f.write(str(post-pre) + \"ms\\n\")\n            f.close\n</code></pre>\n\n<p>Go:</p>\n\n<pre><code>package main\n\nimport \"strconv\"\nimport \"os\"\n\nfunc merge(v []int, e int, m int, d int) {\n    size := d-e+1\n    B := make([]int, size)\n    i := e\n    j := m + 1\n    k := 0\n    for i &lt;= m &amp;&amp; j &lt;= d {\n        if v[i] &lt;= v[j] {\n            B[k] = v[i]\n            k++\n            i++\n        } else {\n            B[k] = v[j]\n            k++\n            j++\n        }\n    }\n    for i &lt;= m {\n        B[k] = v[i]\n        k++\n        i++\n    }\n    for j &lt;= d {\n        B[k] = v[j]\n        k++\n        j++\n    }\n    for k := 0; k &lt;= d-e; k++ {\n        v[e+k] = B[k]\n    }\n}\n\nfunc mergesort(v []int, e int, d int) {\n    if e &lt; d {\n        m := (e+d)/2\n        mergesort(v, e, m)\n        mergesort(v, m+1, d)\n        merge(v, e, m, d)\n    }\n}\n\nfunc main() {\n    v := make([]int, 0)\n    args := os.Args\n    for i := 1; i &lt; len(args); i++ {\n        f,_ := strconv.Atoi(os.Args[i])\n        v = append(v, f)\n    }\n    mergesort(v, 0, len(args) - 1)\n}\n</code></pre>\n"}, {"tags": ["go", "printing", "slice"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462225330, "post_id": 36992084, "comment_id": 61538498, "body": "Is there a need for all this dynamic build up of the collection? Given your stated goal, to print those characters, your code is very complicated. You could just have them all instantiated as part of a collection rather than as individual consts and then print each item in that collection rather than doing all this <code>joinString</code> stuff. Really none of that is necessary to achieve the functionality you&#39;re talking about."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462225424, "post_id": 36992084, "comment_id": 61538528, "body": "Also, just one quick observation, after all the <code>joinStrings</code> stuff is done running you only have 5 items in the <code>stuff</code> array which is why you&#39;re missing output."}, {"owner": {"reputation": 259, "user_id": 6232007, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3241e0eedf4475d6e31b29497c1af8ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6232007/pete"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462225477, "post_id": 36992084, "comment_id": 61538552, "body": "1) if I just printed it, each ascii character would be below each other"}, {"owner": {"reputation": 259, "user_id": 6232007, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3241e0eedf4475d6e31b29497c1af8ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6232007/pete"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462225533, "post_id": 36992084, "comment_id": 61538581, "body": "2) You are right about the collection thing, If you want to suggest a better version go on ahead"}, {"owner": {"reputation": 259, "user_id": 6232007, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3241e0eedf4475d6e31b29497c1af8ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6232007/pete"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462225693, "post_id": 36992084, "comment_id": 61538644, "body": "How do I fix the <code>[][]string stuff</code>slice only being 5 items long?"}, {"owner": {"reputation": 259, "user_id": 6232007, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3241e0eedf4475d6e31b29497c1af8ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6232007/pete"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462225819, "post_id": 36992084, "comment_id": 61538689, "body": "Some of this code is thought of from <a href=\"http://stackoverflow.com/questions/36220839/print-multi-line-strings-on-same-line\" title=\"print multi line strings on same line\">stackoverflow.com/questions/36220839/&hellip;</a>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462225835, "post_id": 36992084, "comment_id": 61538693, "body": "Not sure yet, but I&#39;ll play around with the code a bit as time allows and maybe fix that up. I&#39;m pretty sure it&#39;s a bug in <code>joinStrings</code> but it&#39;s not obvious where the error occurs to me yet."}, {"owner": {"reputation": 259, "user_id": 6232007, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3241e0eedf4475d6e31b29497c1af8ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6232007/pete"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462225873, "post_id": 36992084, "comment_id": 61538705, "body": "Great! Thanks a bunch."}], "answers": [{"comments": [{"owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "edited": false, "score": 0, "creation_date": 1462229256, "post_id": 36992800, "comment_id": 61539722, "body": "Yup, wrong argument to LongestSlice, also, rather than subtracting and doing an <code>&lt;=</code>, simplify it and do <code>for lineNumber := 0; lineNumber &lt; LongestSlice(stuff); lineNumber++ {</code>"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1462229136, "creation_date": 1462229136, "answer_id": 36992800, "question_id": 36992084, "link": "https://stackoverflow.com/questions/36992084/bottom-line-trimmed-off-printing-string/36992800#36992800", "title": "Bottom line trimmed off printing string", "body": "<p>Just overingeneering in loop condition. Try</p>\n\n<pre><code>for lineNumber := 0; lineNumber &lt;= LongestSlice(stuff)-1; lineNumber++ {\n</code></pre>\n\n<p>in outer loop in func joinStrings. See it works <a href=\"https://play.golang.org/p/eR4JJtY4T1\" rel=\"nofollow\">https://play.golang.org/p/eR4JJtY4T1</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6282203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad9b01ab848437d6e48cf5de0d854ac?s=128&d=identicon&r=PG&f=1", "display_name": "nickswift", "link": "https://stackoverflow.com/users/6282203/nickswift"}, "is_accepted": false, "score": 1, "last_activity_date": 1462229297, "creation_date": 1462229297, "answer_id": 36992826, "question_id": 36992084, "link": "https://stackoverflow.com/questions/36992084/bottom-line-trimmed-off-printing-string/36992826#36992826", "title": "Bottom line trimmed off printing string", "body": "<p>Your solution seems overly complicated for what you're trying to accomplish. One simple way to do it is to take evanmcdonnal's advice and use a map to define how integers convert into their corresponding string constants, which looks something like this:</p>\n\n<pre><code>var integerToStr = map[int]string{\n  0: zero,\n  1: one,\n  2: two,\n  3: three,\n  4: four,\n  5: five,\n  6: six,\n  7: seven,\n  8: eight,\n  9: nine,\n}\n</code></pre>\n\n<p>...in which case you can convert an integer like this:</p>\n\n<pre><code>if str, present := integerToStr[i]; present {\n  // do something with the string\n} else {\n  // default to something else?\n}\n</code></pre>\n\n<p>If you don't like variables in the package scope, you could also use a switch statement to do the same thing inside of a function:</p>\n\n<pre><code>var glyph string\nswitch num {\n    case \"1\":\n        glyph = one\n    case \"2\":\n        glyph = two\n    case \"3\":\n        glyph = three\n    case \"4\":\n        glyph = four\n    case \"5\":\n        glyph = five\n    case \"6\":\n        glyph = six\n    case \"7\":\n        glyph = seven\n    case \"8\":\n        glyph = eight\n    case \"9\":\n        glyph = nine\n    case \"0\":\n        fallthrough\n    default:\n        glyph = zero\n    }\n</code></pre>\n\n<p>I also recommend coming up with a standard height for your letters and making that a constant along with the strings themselves. This allows you to join them horizontally rather easily by creating a fixed-length array, appending to each member of that array with the corresponding line of each string, then turning that into a slice and using \"strings.Join\" to do the work of joining the final string:</p>\n\n<pre><code>var out [glyphHeight]string\n\nfor _, glyph := range glyphs {\n    for i, line := range strings.Split(glyph, \"\\n\") {\n        out[i] += \" \" + line\n    }\n}\n\nreturn strings.Join(out[:numGlyphLines], \"\\n\")\n</code></pre>\n\n<p>Another slightly pedantic thing I think bears mentioning is that you're incorrectly referring to your strings as ASCII. Go actually uses UTF for its strings. It doesn't really matter in this example, but you should keep that in mind.</p>\n"}], "owner": {"reputation": 259, "user_id": 6232007, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3241e0eedf4475d6e31b29497c1af8ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6232007/pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 36992800, "answer_count": 2, "score": 0, "last_activity_date": 1462229297, "creation_date": 1462225056, "question_id": 36992084, "link": "https://stackoverflow.com/questions/36992084/bottom-line-trimmed-off-printing-string", "title": "Bottom line trimmed off printing string", "body": "<p>I have a program that prints a multiline string, and it cuts off the bottom.Output:</p>\n\n<pre><code>[   ]\n[\u2588\u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2557  \u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2588\u2588\u2588\u2588\u2557 ]\n[\u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2557 \u2588\u2588\u2551  \u2588\u2588\u2551 \u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2557 \u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2557]\n[ \u2588\u2588\u2588\u2588\u2588\u2554\u255d \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2551  \u2588\u2588\u2588\u2588\u2588\u2554\u255d  \u2588\u2588\u2588\u2588\u2588\u2554\u255d]\n[\u2588\u2588\u2554\u2550\u2550\u2550\u255d  \u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2551 \u2588\u2588\u2554\u2550\u2550\u2550\u255d   \u255a\u2550\u2550\u2550\u2588\u2588\u2557]\n</code></pre>\n\n<p>The Program used to generate it:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"strconv\"\n        \"strings\"\n)\n\nconst one = `\n \u2588\u2588\u2557\n\u2588\u2588\u2588\u2551\n\u255a\u2588\u2588\u2551\n \u2588\u2588\u2551\n \u2588\u2588\u2551\n \u255a\u2550\u255d\n`\nconst two = `\n\u2588\u2588\u2588\u2588\u2588\u2588\u2557 \n\u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2557\n \u2588\u2588\u2588\u2588\u2588\u2554\u255d\n\u2588\u2588\u2554\u2550\u2550\u2550\u255d \n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d    \n`\nconst three = `\n\u2588\u2588\u2588\u2588\u2588\u2588\u2557 \n\u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2557\n \u2588\u2588\u2588\u2588\u2588\u2554\u255d\n \u255a\u2550\u2550\u2550\u2588\u2588\u2557\n\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\n\u255a\u2550\u2550\u2550\u2550\u2550\u255d \n`\nconst four = `\n\u2588\u2588\u2557  \u2588\u2588\u2557\n\u2588\u2588\u2551  \u2588\u2588\u2551\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2551\n\u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2551\n     \u2588\u2588\u2551\n     \u255a\u2550\u255d\n`\nconst five = `\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n\u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2551\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n`\nconst six = `\n \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \n\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d \n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557 \n\u2588\u2588\u2554\u2550\u2550\u2550\u2588\u2588\u2557\n\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\n \u255a\u2550\u2550\u2550\u2550\u2550\u255d \n`\nconst seven = `\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n\u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2551\n    \u2588\u2588\u2554\u255d\n   \u2588\u2588\u2554\u255d \n   \u2588\u2588\u2551  \n   \u255a\u2550\u255d \n`\nconst eight = `\n \u2588\u2588\u2588\u2588\u2588\u2557 \n\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\n\u255a\u2588\u2588\u2588\u2588\u2588\u2554\u255d\n\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\n\u255a\u2588\u2588\u2588\u2588\u2588\u2554\u255d\n \u255a\u2550\u2550\u2550\u2550\u255d \n`\nconst nine = `\n \u2588\u2588\u2588\u2588\u2588\u2557 \n\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\n\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2551\n \u255a\u2550\u2550\u2550\u2588\u2588\u2551\n \u2588\u2588\u2588\u2588\u2588\u2554\u255d\n \u255a\u2550\u2550\u2550\u2550\u255d \n`\nconst zero = `\n \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \n\u2588\u2588\u2554\u2550\u2588\u2588\u2588\u2588\u2557\n\u2588\u2588\u2551\u2588\u2588\u2554\u2588\u2588\u2551\n\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2551\n\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\n \u255a\u2550\u2550\u2550\u2550\u2550\u255d \n`\n\nvar numbers = []string{zero, one, two, three, four, five, six, seven, eight, nine}\n\nfunc getAscii(number int) [][]string {\n        listOfNumbers := strings.Split(strconv.Itoa(number), \"\")\n        var ascii [][]string\n        for _, num := range listOfNumbers {\n                intnum, _ := strconv.Atoi(num)\n                ascii = append(ascii, strings.Split(numbers[intnum], \"\\n\"))\n        }\n        return ascii\n}\nfunc LongestSlice(slices [][]string) int {\n        var longest int = 0\n        for _, slice := range slices {\n                if len(slice) &gt; longest {\n                        longest = len(slice)\n                }\n        }\n        return longest\n}\n\nfunc joinStrings(stuff [][]string) [][]string {\n        var joined [][]string\n        for lineNumber := 0; lineNumber &lt;= LongestSlice(joined); lineNumber++ {\n                var Oneline []string\n                for _, item := range stuff {\n                        //err := item[lineNumber]\n                        //if err != nil {\n                        //      panic(err)\n                        //}\n                        Oneline = append(Oneline, item[lineNumber])\n\n                }\n                joined = append(joined, Oneline)\n        }\n        return joined\n}\nfunc main() {\n        stuff := joinStrings(getAscii(2423))\n        for _, line := range stuff {\n                fmt.Println(line)\n        }\n}\n</code></pre>\n\n<p>Why is this? I'm so confused on where to look.\n How can I fix this so it doesn't cut off the bottom? Sorry I included the entire program, I have no idea where the problem is.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 1, "last_activity_date": 1462225810, "creation_date": 1462225810, "answer_id": 36992228, "question_id": 36991947, "link": "https://stackoverflow.com/questions/36991947/get-single-result-from-multiple-context-function-call-without-intermediary-varia/36992228#36992228", "title": "Get single result from multiple-context function call without intermediary variable", "body": "<p>The only real way to do it is to create some utility \"bypass\" function, and since this is Go, you'll have to declare one per type. </p>\n\n<p>for example:</p>\n\n<pre><code>func noerrInt(i int, e err) int {\n   return i\n}\n</code></pre>\n\n<p>then you can do:</p>\n\n<pre><code>myArray := make([]int, noerrInt(strconv.Atoi(\"64\")))\n</code></pre>\n\n<p>But really, this pretty much sucks, AND ignores best practices.</p>\n"}], "owner": {"reputation": 321, "user_id": 369668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afb3c9b2472e781f9cf62c3b466d0527?s=128&d=identicon&r=PG&f=1", "display_name": "Giovanni Tirloni", "link": "https://stackoverflow.com/users/369668/giovanni-tirloni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1462237993, "answer_count": 1, "score": 1, "last_activity_date": 1462226356, "creation_date": 1462224347, "last_edit_date": 1462226356, "question_id": 36991947, "link": "https://stackoverflow.com/questions/36991947/get-single-result-from-multiple-context-function-call-without-intermediary-varia", "closed_reason": "Duplicate", "title": "Get single result from multiple-context function call without intermediary variable", "body": "<p>In <a href=\"http://golang.org\" rel=\"nofollow\">Go</a> I can use the <a href=\"https://golang.org/ref/spec#Blank_identifier\" rel=\"nofollow\">underscore</a> to ignore a return value from a function that returns multiple values. For instance:</p>\n\n<pre><code>res, _ := strconv.Atoi(\"64\")\n</code></pre>\n\n<p>Suppose I wanted to use the first value directly into another function call (while ignoring error checking best practices, in this example):</p>\n\n<pre><code>myArray := make([]int, strconv.Atoi(\"64\"))\n</code></pre>\n\n<p>The compiler will complain that I'm using a multiple-value function in a singe-value context:</p>\n\n<pre><code>./array-test.go:11: multiple-value strconv.Atoi() in single-value context\n</code></pre>\n\n<p>Is it possible to \"pick and choose\" from the return values in a single-line without resorting to <a href=\"http://ernestmicklei.com/2013/11/from-multiple-to-single-value-context-in-go/\" rel=\"nofollow\">auxiliary functions</a>?</p>\n"}, {"tags": ["performance", "scala", "optimization", "go", "playframework"], "comments": [{"owner": {"reputation": 11402, "user_id": 4600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CY4os.jpg?s=128&g=1", "display_name": "marcospereira", "link": "https://stackoverflow.com/users/4600/marcospereira"}, "edited": false, "score": 4, "creation_date": 1462225583, "post_id": 36990707, "comment_id": 61538599, "body": "That is because you are comparing a low level http library (go <code>net&#47;http</code>) to a high level framework (Play). The high level framework is doing way more things because it offers more utilities and then it is slower. A fair comparison would be between netty (the http &quot;library&quot; used by Play) with Go <code>net&#47;http</code>. I would also recommend to run the tests against play until you start to get consistent results (because of jit compilation at the jvm)."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 11402, "user_id": 4600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CY4os.jpg?s=128&g=1", "display_name": "marcospereira", "link": "https://stackoverflow.com/users/4600/marcospereira"}, "edited": false, "score": 3, "creation_date": 1462226770, "post_id": 36990707, "comment_id": 61539019, "body": "@marcospereira I would hardly call <code>net&#47;http</code> &#39;low level&#39;, it is a major abstraction. You can open a route with a single line of code and the incoming request is parsed and turned into a nice object where all the data is easy to access. I would call that pretty high level given the thing is actually receiving binary data that isn&#39;t even all one piece. To the OP; why don&#39;t you just not use Play? It sucks. That&#39;s my 2 cents. It&#39;s performance sucks because it is overly abstracted and I bet you won&#39;t use 80% of what it gives you while your performance will suffer 100% of the time."}, {"owner": {"reputation": 11402, "user_id": 4600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CY4os.jpg?s=128&g=1", "display_name": "marcospereira", "link": "https://stackoverflow.com/users/4600/marcospereira"}, "edited": false, "score": 2, "creation_date": 1462227186, "post_id": 36990707, "comment_id": 61539131, "body": "Low level compared to a full stack framework like play. This was what a meant."}, {"owner": {"reputation": 2072, "user_id": 3101819, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/75b7ccd31a5b43fdbbf2edbf7ac436df?s=128&d=identicon&r=PG&f=1", "display_name": "AME", "link": "https://stackoverflow.com/users/3101819/ame"}, "edited": false, "score": 0, "creation_date": 1462266725, "post_id": 36990707, "comment_id": 61553035, "body": "<a href=\"https://www.techempower.com/benchmarks/\" rel=\"nofollow noreferrer\">Bechmarks</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1259, "user_id": 1814775, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ea9a58ab403c34bc21cde3a006d2e6d8?s=128&d=identicon&r=PG", "display_name": "lloydmeta", "link": "https://stackoverflow.com/users/1814775/lloydmeta"}, "is_accepted": false, "score": 3, "last_activity_date": 1462293537, "creation_date": 1462293537, "answer_id": 37009694, "question_id": 36990707, "link": "https://stackoverflow.com/questions/36990707/scala-play-2-5-vs-golang-benchmark-and-optimizing-performance-in-play-framework/37009694#37009694", "title": "scala Play 2.5 vs golang benchmark, and optimizing performance in play framework", "body": "<p>As @marcospereira has said, Play is a relatively high-level framework that focuses on exploiting the much more advanced type-system in Scala to give you a lot of features and safety, which in turn helps you write code that is refactorable and scalable to your needs. Never the less, I've gotten great performance from it in production.</p>\n\n<p>Asides from suggesting that you try running your benchmark on Linux with <a href=\"https://www.playframework.com/documentation/2.5.x/SettingsNetty#Configuring-transport-socket\" rel=\"nofollow\">native socket transport</a>, I'll repeat what @marcospereira said, to run your benchmark a couple of times without stopping your Play server. The standard deviation in your Play benchmark results seems abnormally high (averages of 1 with a SD's of 2.2), which suggests that perhaps JIT hasn't fully finished optimising your code for you yet.</p>\n"}], "owner": {"reputation": 339, "user_id": 1018567, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/8780afc9f456c63d97d00230e23f1188?s=128&d=identicon&r=PG", "display_name": "Francis", "link": "https://stackoverflow.com/users/1018567/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4080, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1462293537, "creation_date": 1462219272, "last_edit_date": 1462221853, "question_id": 36990707, "link": "https://stackoverflow.com/questions/36990707/scala-play-2-5-vs-golang-benchmark-and-optimizing-performance-in-play-framework", "title": "scala Play 2.5 vs golang benchmark, and optimizing performance in play framework", "body": "<p>I'm benchmarking a simple hello world example in scala play framework 2.5 and in golang. Golang seems to be out performing play by a significant margin and I would like to know how I could optimize play framework to improve performance.\nI'm using the following to benchmark</p>\n\n<pre><code>ab -r -k -n 100000 -c 100 http://localhost:9000/\n</code></pre>\n\n<p>I'm running play 2.5 in prod mode using the default configuration everywhere in my project. Can someone help me with performance tuning the play server in order to get the most performance? I read up on the default-dispatcher thread pool, but I'm not sure what settings to use for my pc. Also are there any other areas I could check that would help with performance?</p>\n\n<p>here are my marchine specs</p>\n\n<pre><code>Intel(R) Xeon(R) W3670 @ 3.20GHz 3.19GHz, 12.0 GM RAM, running windows 7 64-bit\n</code></pre>\n\n<p>Please note that I'm using sbt (clean and stage) to run the server in place in prod mode and executing the bat file found at target/universal/stage/bin/. Here is the source code for play</p>\n\n<pre><code>package controllers\n\nimport play.api.mvc._\n\n\nclass Application extends Controller {\n\n\n  def index = Action {\n    Ok(\"Hello, world!\")\n  }\n\n}\n</code></pre>\n\n<p>here are the result from the ab benchmark</p>\n\n<pre><code>ab -r -k -n 100000 -c 100 http://localhost:9000/\nThis is ApacheBench, Version 2.3 &lt;$Revision: 1706008 $&gt;\nCopyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/\nLicensed to The Apache Software Foundation, http://www.apache.org/\n\nBenchmarking localhost (be patient)\nCompleted 10000 requests\nCompleted 20000 requests\nCompleted 30000 requests\nCompleted 40000 requests\nCompleted 50000 requests\nCompleted 60000 requests\nCompleted 70000 requests\nCompleted 80000 requests\nCompleted 90000 requests\nCompleted 100000 requests\nFinished 100000 requests\n\n\nServer Software:\nServer Hostname:        localhost\nServer Port:            9000\n\nDocument Path:          /\nDocument Length:        13 bytes\n\nConcurrency Level:      100\nTime taken for tests:   1.537 seconds\nComplete requests:      100000\nFailed requests:        0\nKeep-Alive requests:    100000\nTotal transferred:      15400000 bytes\nHTML transferred:       1300000 bytes\nRequests per second:    65061.81 [#/sec] (mean)\nTime per request:       1.537 [ms] (mean)\nTime per request:       0.015 [ms] (mean, across all concurrent requests)\nTransfer rate:          9784.69 [Kbytes/sec] received\n\nConnection Times (ms)\n              min  mean[+/-sd] median   max\nConnect:        0    0   0.0      0       1\nProcessing:     0    2   1.9      1      72\nWaiting:        0    2   1.9      1      72\nTotal:          0    2   1.9      1      72\n\nPercentage of the requests served within a certain time (ms)\n  50%      1\n  66%      2\n  75%      2\n  80%      2\n  90%      3\n  95%      3\n  98%      5\n  99%      8\n 100%     72 (longest request)\n</code></pre>\n\n<p>here is the source code for golang</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hello, world!\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>here are the result from ab benchmark for golang</p>\n\n<pre><code>ab -r -k -n 100000 -c 100 http://localhost:8080/\nThis is ApacheBench, Version 2.3 &lt;$Revision: 1706008 $&gt;\nCopyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/\nLicensed to The Apache Software Foundation, http://www.apache.org/\n\nBenchmarking localhost (be patient)\nCompleted 10000 requests\nCompleted 20000 requests\nCompleted 30000 requests\nCompleted 40000 requests\nCompleted 50000 requests\nCompleted 60000 requests\nCompleted 70000 requests\nCompleted 80000 requests\nCompleted 90000 requests\nCompleted 100000 requests\nFinished 100000 requests\n\n\nServer Software:\nServer Hostname:        localhost\nServer Port:            8080\n\nDocument Path:          /\nDocument Length:        13 bytes\n\nConcurrency Level:      100\nTime taken for tests:   0.914 seconds\nComplete requests:      100000\nFailed requests:        0\nKeep-Alive requests:    100000\nTotal transferred:      15400000 bytes\nHTML transferred:       1300000 bytes\nRequests per second:    109398.30 [#/sec] (mean)\nTime per request:       0.914 [ms] (mean)\nTime per request:       0.009 [ms] (mean, across all concurrent requests)\nTransfer rate:          16452.48 [Kbytes/sec] received\n\nConnection Times (ms)\n              min  mean[+/-sd] median   max\nConnect:        0    0   0.0      0       1\nProcessing:     0    1   1.5      1      52\nWaiting:        0    1   1.5      1      52\nTotal:          0    1   1.5      1      52\n\nPercentage of the requests served within a certain time (ms)\n  50%      1\n  66%      1\n  75%      1\n  80%      1\n  90%      1\n  95%      2\n  98%      5\n  99%      7\n 100%     52 (longest request) \n</code></pre>\n\n<p>Thanking you in advance\nFrancis</p>\n\n<p>UPDATE!</p>\n\n<p>the following results in improved performance, but I'm still interested in other ideas that could improve performance</p>\n\n<pre><code>package controllers\n\nimport play.api.mvc._\nimport scala.concurrent.Future\nimport play.api.libs.concurrent.Execution.Implicits.defaultContext\n\n\nclass Application extends Controller {\n\n\n  def index = Action.async {\n    Future.successful(Ok(\"Hello, world!\"))\n  }\n\n}\n</code></pre>\n\n<p>benchmark results</p>\n\n<pre><code>ab -r -k -n 100000 -c 100 http://localhost:9000/\nThis is ApacheBench, Version 2.3 &lt;$Revision: 1706008 $&gt;\nCopyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/\nLicensed to The Apache Software Foundation, http://www.apache.org/\n\nBenchmarking localhost (be patient)\nCompleted 10000 requests\nCompleted 20000 requests\nCompleted 30000 requests\nCompleted 40000 requests\nCompleted 50000 requests\nCompleted 60000 requests\nCompleted 70000 requests\nCompleted 80000 requests\nCompleted 90000 requests\nCompleted 100000 requests\nFinished 100000 requests\n\n\nServer Software:\nServer Hostname:        localhost\nServer Port:            9000\n\nDocument Path:          /\nDocument Length:        13 bytes\n\nConcurrency Level:      100\nTime taken for tests:   1.230 seconds\nComplete requests:      100000\nFailed requests:        0\nKeep-Alive requests:    100000\nTotal transferred:      15400000 bytes\nHTML transferred:       1300000 bytes\nRequests per second:    81292.68 [#/sec] (mean)\nTime per request:       1.230 [ms] (mean)\nTime per request:       0.012 [ms] (mean, across all concurrent requests)\nTransfer rate:          12225.66 [Kbytes/sec] received\n\nConnection Times (ms)\n              min  mean[+/-sd] median   max\nConnect:        0    0   0.0      0       1\nProcessing:     0    1   2.2      1     131\nWaiting:        0    1   2.2      1     131\nTotal:          0    1   2.2      1     131\n\nPercentage of the requests served within a certain time (ms)\n  50%      1\n  66%      1\n  75%      1\n  80%      2\n  90%      2\n  95%      3\n  98%      5\n  99%      7\n 100%    131 (longest request)\n</code></pre>\n"}, {"tags": ["go", "gorp"], "answers": [{"tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1462233519, "creation_date": 1462233519, "answer_id": 36993468, "question_id": 36990644, "link": "https://stackoverflow.com/questions/36990644/golang-gorp-insert-multiple-records/36993468#36993468", "title": "golang gorp insert multiple records", "body": "<p>It doesn't look like gorp has anything that gives a wrapper for either raw SQL or multi value inserts (which is always SQL dialect dependent).<br>\nAre you worried about speed or transactions?  If not, I would just do the inserts in a for loop.</p>\n"}, {"tags": [], "owner": {"reputation": 2081, "user_id": 2378213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f3639dc9bce37b77502008ab6ca6feb?s=128&d=identicon&r=PG", "display_name": "edufinn", "link": "https://stackoverflow.com/users/2378213/edufinn"}, "is_accepted": false, "score": 3, "last_activity_date": 1473270201, "creation_date": 1473270201, "answer_id": 39376237, "question_id": 36990644, "link": "https://stackoverflow.com/questions/36990644/golang-gorp-insert-multiple-records/39376237#39376237", "title": "golang gorp insert multiple records", "body": "<p>As I found out on some other resource the reason this doesn't work is that <code>interface{}</code> and <code>User{}</code> do not have the same layout in memory, therefore their slices aren't of compatible types. Suggested solution was to convert <code>[]User{}</code> into <code>[]interface{}</code> in for loop, like shown here: <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow\">https://golang.org/doc/faq#convert_slice_of_interface</a></p>\n\n<p>There is still on caveat: you need to use pointers for <code>DbMap.Insert()</code>function.</p>\n\n<p>Here's how I solved it:</p>\n\n<pre><code>s := make([]interface{}, len(users))\nfor i, v := range users {\n    s[i] = &amp;v\n}\nerr := dbMap.Insert(s...)\n</code></pre>\n\n<p><strong>Note</strong> that <code>&amp;v</code> is important, otherwise <code>Insert</code> will complain about non-pointers. </p>\n"}], "owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1268, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1473270201, "creation_date": 1462219019, "question_id": 36990644, "link": "https://stackoverflow.com/questions/36990644/golang-gorp-insert-multiple-records", "title": "golang gorp insert multiple records", "body": "<p>Using gorp how can one insert multiple records efficiently? i.e instead of inserting one at a time, is there a batch insert?</p>\n\n<p></p>\n\n<pre><code>var User struct {\n   Name string\n   Email string\n   Phone string\n}\nvar users []Users\nusers = buildUsers()\ndbMap.Insert(users...) //this fails compilation\n//I am forced to loop over users and insert one user at a time. Error Handling omitted for brevity\n</code></pre>\n\n<p>Is there a better mechanism with gorp? Driver is MySQL.</p>\n"}, {"tags": ["go", "locking"], "comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1462217008, "post_id": 36989974, "comment_id": 61534269, "body": "How do you create the channel? It has to be buffered for this code to work"}, {"owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "edited": false, "score": 0, "creation_date": 1462349975, "post_id": 36989974, "comment_id": 61594978, "body": "Your code waits for 10 seconds, but you say you intend for 200 ms. You did not state why your code does not work, could this be the reason ?"}], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462225021, "post_id": 36991595, "comment_id": 61538370, "body": "This is a better approach than what the OP&#39;s code attempts. It&#39;s easier to understand <i>and</i> performs better both."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 2, "creation_date": 1462226860, "post_id": 36991595, "comment_id": 61539043, "body": "Your code is wrong. The OP&#39;s lock function locks the mutex, starts the timer and returns. The timer will wait in the background and after 10 seconds will check whether the mutex is unlocked. Your lock function will block for 10 seconds or until the mutex is unlocked. That&#39;s not what the OP wants and your solution is worse regardles. You don&#39;t block for 10 seconds, you wait in the background."}], "tags": [], "owner": {"reputation": 166, "user_id": 5853709, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hkHXI.png?s=128&g=1", "display_name": "FS&#39;W&#230;hre", "link": "https://stackoverflow.com/users/5853709/fsw%c3%a6hre"}, "is_accepted": false, "score": 0, "last_activity_date": 1462222743, "creation_date": 1462222743, "answer_id": 36991595, "question_id": 36989974, "link": "https://stackoverflow.com/questions/36989974/golang-panic-after-mutex-locks-have-been-held-for-too-long/36991595#36991595", "title": "Golang: panic after mutex locks have been held for too long", "body": "<p>Your lock function waits for 10 seconds befor calling the f function which holds the select statement, a simpler way of achieving what you are trying to do might be this:</p>\n\n<pre><code>func (kv *App) lock(reason string) {\n    kv.mu.Lock()\n    select {\n    case &lt;- kv.lockChan:\n        //\n    case &lt;-time.After(time.Second * 10):\n        panic(\"PANIC: \" + reason)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "is_accepted": false, "score": 1, "last_activity_date": 1462349441, "creation_date": 1462349441, "answer_id": 37022009, "question_id": 36989974, "link": "https://stackoverflow.com/questions/36989974/golang-panic-after-mutex-locks-have-been-held-for-too-long/37022009#37022009", "title": "Golang: panic after mutex locks have been held for too long", "body": "<p>You need to use the return value of <code>time.AfterFunc</code>. Here is a working example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\ntype Foo struct {\n    m sync.Mutex\n    timer *time.Timer\n}\n\nfunc (f *Foo) lock() {\n    f.m.Lock()\n    f.timer = time.AfterFunc(3 * time.Second, func() {\n        panic(\"Too long!\")\n    })\n}\n\nfunc (f *Foo) unlock() {\n    f.timer.Stop()\n    f.m.Unlock()\n}\n\nfunc main() {\n    foo := &amp;Foo{\n        sync.Mutex{},\n        &amp;time.Timer{},\n    }\n\n    foo.lock()\n\n    // Uncomment this to see the difference\n    //time.Sleep(5 * time.Second)\n\n    foo.unlock()\n    fmt.Println(\"Success!\")\n}\n</code></pre>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/WVPp0_Iqlb\" rel=\"nofollow\">https://play.golang.org/p/WVPp0_Iqlb</a></p>\n"}, {"tags": [], "owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "is_accepted": false, "score": 0, "last_activity_date": 1462350144, "creation_date": 1462350144, "answer_id": 37022219, "question_id": 36989974, "link": "https://stackoverflow.com/questions/36989974/golang-panic-after-mutex-locks-have-been-held-for-too-long/37022219#37022219", "title": "Golang: panic after mutex locks have been held for too long", "body": "<p>You have said you want your code to panic if the lock has been hold for 200 ms, but you gave the timer 10 seconds to wait. This will simply wait for 10 seconds before panicing instead of 200. I have tried your code editing it the following way :</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"fmt\"\n    \"time\"\n)\n\n\ntype App struct {\n    mu sync.Mutex\n    lockChan chan bool\n}\n\nfunc (kv *App) lock(reason string) {\n    kv.mu.Lock()\n\n    f := func () {\n        fmt.Println(\"PANIC: ms passed\")\n        select {\n        case &lt;- kv.lockChan:\n        //\n        default:\n            panic(\"PANIC: \" + reason)\n        }\n    }\n    time.AfterFunc(time.Millisecond * 200, f)\n}\n\nfunc (kv *App) unlock(reason string) {\n    kv.lockChan &lt;- true\n    kv.mu.Unlock()\n}\n\nfunc NewApp() *App {\n    app := App{}\n    app.lockChan = make(chan bool)\n    return &amp;app\n}\n\nfunc main() {\n    app := NewApp()\n    app.lock(\"locking\")\n    time.Sleep(time.Millisecond * 300)\n\n}\n</code></pre>\n\n<p>Above code works just fine and panics. If you drop the duration in the main function to <code>200 * time.Millisecond</code>, it will not panic and just stop running.</p>\n"}], "owner": {"reputation": 8224, "user_id": 985383, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/anF0k.png?s=128&g=1", "display_name": "piggyback", "link": "https://stackoverflow.com/users/985383/piggyback"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1462350144, "creation_date": 1462216586, "question_id": 36989974, "link": "https://stackoverflow.com/questions/36989974/golang-panic-after-mutex-locks-have-been-held-for-too-long", "title": "Golang: panic after mutex locks have been held for too long", "body": "<p>I am trying to figure out what is that is making my program hanging, most of my locks shouldn't be held for more than 200 ms. (actually much less!)</p>\n\n<p>I want to create two new functions (<code>Lock()</code> and <code>Unlock()</code>) so that Lock will have a timer that will panic if Lock has been held for more than 200 ms.</p>\n\n<p>This is my current attempt, but it doesn't work, any hint?</p>\n\n<pre><code>type ShardKV struct {\n  lockChan chan bool\n}\n\nfunc (kv *App) lock(reason string) {\n    kv.mu.Lock()\n\n    f := func () {\n        fmt.Println(\"PANIC: ms passed\")\n        select {\n        case &lt;- kv.lockChan:\n            //\n        default:\n            panic(\"PANIC: \" + reason)\n        }\n  }\n    time.AfterFunc(time.Second * 10, f)\n}\n\nfunc (kv *App) unlock(reason string) {\n    kv.lockChan &lt;- true\n    kv.mu.Unlock()\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1462212920, "post_id": 36988681, "comment_id": 61532171, "body": "Does <a href=\"https://golang.org/pkg/time/#Time.Truncate\" rel=\"nofollow noreferrer\"><code>Time.Truncate</code></a> not do what you want?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462213233, "post_id": 36988681, "comment_id": 61532344, "body": "Truncate is another option, I think it&#39;s more of a pain to implement however because you have to create a <code>Duration</code> to represent the hours, minutes, seconds and nanoseconds."}, {"owner": {"reputation": 374, "user_id": 1671968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc874e00786aa7950b352fcb5ba600ab?s=128&d=identicon&r=PG", "display_name": "schimmy", "link": "https://stackoverflow.com/users/1671968/schimmy"}, "edited": false, "score": 2, "creation_date": 1502229538, "post_id": 36988681, "comment_id": 78116902, "body": "Time.Truncate only works if you want UTC, AFAICT"}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 62, "last_activity_date": 1462212706, "creation_date": 1462212706, "answer_id": 36988882, "question_id": 36988681, "link": "https://stackoverflow.com/questions/36988681/time-time-round-to-day/36988882#36988882", "title": "time.Time Round to Day", "body": "<p>The simple way to do this is to create new <code>Time</code> using the previous one and only assigning the year month and day. It would look like this;</p>\n\n<pre><code>rounded := time.Date(toRound.Year(), toRound.Month(), toRound.Day(), 0, 0, 0, 0, toRound.Location())\n</code></pre>\n\n<p>here's a play example; <a href=\"https://play.golang.org/p/jnFuZxruKm\" rel=\"noreferrer\">https://play.golang.org/p/jnFuZxruKm</a></p>\n"}, {"comments": [{"owner": {"reputation": 582, "user_id": 686994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c914fce9c8e2eaa6dfdde5f22106d74?s=128&d=identicon&r=PG", "display_name": "Guy", "link": "https://stackoverflow.com/users/686994/guy"}, "edited": false, "score": 59, "creation_date": 1478503963, "post_id": 38516536, "comment_id": 68164845, "body": "Note that truncate always truncates against UTC, so if your timezone is not UTC, the resulting time will not be 00:00 in that timezone."}, {"owner": {"reputation": 573, "user_id": 9100468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CmkMNlW2J6k/AAAAAAAAAAI/AAAAAAAAYbA/S66MIb_UIX0/photo.jpg?sz=128", "display_name": "Isaac Weingarten", "link": "https://stackoverflow.com/users/9100468/isaac-weingarten"}, "edited": false, "score": 0, "creation_date": 1599520724, "post_id": 38516536, "comment_id": 112793021, "body": "<code>t.Zone()</code> will return the difference to calculate <a href=\"https://play.golang.org/p/UIhTnurbayW\" rel=\"nofollow noreferrer\">play.golang.org/p/UIhTnurbayW</a>"}, {"owner": {"reputation": 301, "user_id": 1716606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23016d7a989fb470d851fe2a4e19b02a?s=128&d=identicon&r=PG", "display_name": "homiak", "link": "https://stackoverflow.com/users/1716606/homiak"}, "edited": false, "score": 0, "creation_date": 1604049868, "post_id": 38516536, "comment_id": 114234372, "body": "Do not use this one! The first comment is right - From Truncate() documentation -  // Truncate operates on the time as an absolute duration since the zero time; it does not operate on the presentation form of the time. Thus, <code>Truncate(Hour) may return a time with a non-zero minute, depending on the time&#39;s Location.</code>"}], "tags": [], "owner": {"reputation": 927, "user_id": 1174972, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c21f35146c9eedc7b990c367ec86dcdc?s=128&d=identicon&r=PG", "display_name": "shicky", "link": "https://stackoverflow.com/users/1174972/shicky"}, "is_accepted": false, "score": 28, "last_activity_date": 1469148542, "creation_date": 1469148542, "answer_id": 38516536, "question_id": 36988681, "link": "https://stackoverflow.com/questions/36988681/time-time-round-to-day/38516536#38516536", "title": "time.Time Round to Day", "body": "<p>You can simply use duration <code>24 * time.Hour</code> to truncate time.</p>\n\n<pre><code>t := time.Date(2015, 4, 2, 0, 15, 30, 918273645, time.UTC)\nd := 24 * time.Hour\nt.Truncate(d)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/BTz7wjLTWX\" rel=\"noreferrer\">https://play.golang.org/p/BTz7wjLTWX</a></p>\n"}, {"tags": [], "owner": {"reputation": 879, "user_id": 3778355, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/57af174c54dc32e59d8a528805e4a9db?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3778355/richard"}, "is_accepted": false, "score": 3, "last_activity_date": 1593495212, "creation_date": 1593495212, "answer_id": 62650878, "question_id": 36988681, "link": "https://stackoverflow.com/questions/36988681/time-time-round-to-day/62650878#62650878", "title": "time.Time Round to Day", "body": "<p>I believe the simplest is to create a new date as shown <a href=\"https://stackoverflow.com/a/36988882/3778355\">in this answer</a>.\nHowever, if you wanna use time.Truncate, there is two distinct cases.</p>\n<h1>If you are working in UTC:</h1>\n<pre class=\"lang-golang prettyprint-override\"><code>var testUtcTime = time.Date(2016, 4, 14, 21, 10, 27, 0, time.UTC)\n// outputs 2016-04-14T00:00:00Z\nfmt.Println(testUtcTime.Truncate(time.Hour * 24).Format(time.RFC3339)) \n</code></pre>\n<h1>If you are not, you need to convert back and forth to UTC</h1>\n<pre class=\"lang-golang prettyprint-override\"><code>var testTime = time.Date(2016, 4, 14, 21, 10, 27, 0, time.FixedZone(&quot;my zone&quot;, -7*3600))\n// this is wrong (outputs 2016-04-14T17:00:00-07:00)\nfmt.Println(testTime.Truncate(time.Hour * 24).Format(time.RFC3339)) \n// this is correct (outputs 2016-04-14T00:00:00-07:00)\nfmt.Println(testTime.Add(-7 * 3600 * time.Second).Truncate(time.Hour * 24).Add(7 * 3600 * time.Second).Format(time.RFC3339)) \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 573, "user_id": 9100468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CmkMNlW2J6k/AAAAAAAAAAI/AAAAAAAAYbA/S66MIb_UIX0/photo.jpg?sz=128", "display_name": "Isaac Weingarten", "link": "https://stackoverflow.com/users/9100468/isaac-weingarten"}, "is_accepted": false, "score": 1, "last_activity_date": 1618517283, "last_edit_date": 1618517283, "creation_date": 1599586359, "answer_id": 63798910, "question_id": 36988681, "link": "https://stackoverflow.com/questions/36988681/time-time-round-to-day/63798910#63798910", "title": "time.Time Round to Day", "body": "<p>in addition to sticky's answer to get the local <code>Truncate</code> do like this</p>\n<pre><code>t := time.Date(2015, 4, 2, 0, 15, 30, 918273645, time.Local)\u2028\nd := 24 * time.Hour\n\u2028fmt.Println(&quot;in UTC&quot;, t.Truncate(d))\u2028\n_, dif := t.Zone()\u2028\nfmt.Println(&quot;in Local&quot;, t.Truncate(24 * time.Hour).Add(time.Second * time.Duration(-dif)))\n</code></pre>\n"}], "owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39127, "favorite_count": 8, "accepted_answer_id": 36988882, "answer_count": 4, "score": 46, "last_activity_date": 1618517283, "creation_date": 1462212003, "last_edit_date": 1535007480, "question_id": 36988681, "link": "https://stackoverflow.com/questions/36988681/time-time-round-to-day", "title": "time.Time Round to Day", "body": "<p>I have a timestamp coming in, I wonder if there's a way to round it down to the start of a day in PST. For example, ts: <code>1305861602</code> corresponds to <code>2016-04-14, 21:10:27 -0700</code>, but I want to round it to a timestamp that maps to <code>2016-04-14 00:00:00 -0700</code>. I read through the time.Time doc but didn't find a way to do it.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462211447, "post_id": 36988441, "comment_id": 61531407, "body": "Is your app engine version 1.9.35 or greater? That&#39;s the release where Go was bumped to 1.6."}, {"owner": {"reputation": 1176, "user_id": 3091524, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-48ehLM2xfcE/AAAAAAAAAAI/AAAAAAAAGuw/iCxoJgfXqNA/photo.jpg?sz=128", "display_name": "Stefano", "link": "https://stackoverflow.com/users/3091524/stefano"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462211909, "post_id": 36988441, "comment_id": 61531651, "body": "I&#39;m using go version go1.6 (appengine-1.9.36) windows/amd64"}], "answers": [{"comments": [{"owner": {"reputation": 1176, "user_id": 3091524, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-48ehLM2xfcE/AAAAAAAAAAI/AAAAAAAAGuw/iCxoJgfXqNA/photo.jpg?sz=128", "display_name": "Stefano", "link": "https://stackoverflow.com/users/3091524/stefano"}, "edited": false, "score": 0, "creation_date": 1462627802, "post_id": 37011040, "comment_id": 61722180, "body": "~$ goapp version go version go1.4.2 (appengine-1.9.33) linux/amd64"}, {"owner": {"reputation": 21, "user_id": 6287194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y6h4g.jpg?s=128&g=1", "display_name": "Stuart Jansen", "link": "https://stackoverflow.com/users/6287194/stuart-jansen"}, "reply_to_user": {"reputation": 1176, "user_id": 3091524, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-48ehLM2xfcE/AAAAAAAAAAI/AAAAAAAAGuw/iCxoJgfXqNA/photo.jpg?sz=128", "display_name": "Stefano", "link": "https://stackoverflow.com/users/3091524/stefano"}, "edited": false, "score": 0, "creation_date": 1462749048, "post_id": 37011040, "comment_id": 61753622, "body": "This means you are not using the latest App Engine Go SDK. After installing the newer SDK, <code>goapp version</code> should show <code>go version go1.6 (appengine-1.9.36) linux&#47;amd64</code> and you&#39;ll be able to use Go 1.6 features."}, {"owner": {"reputation": 21, "user_id": 6287194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y6h4g.jpg?s=128&g=1", "display_name": "Stuart Jansen", "link": "https://stackoverflow.com/users/6287194/stuart-jansen"}, "reply_to_user": {"reputation": 1176, "user_id": 3091524, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-48ehLM2xfcE/AAAAAAAAAAI/AAAAAAAAGuw/iCxoJgfXqNA/photo.jpg?sz=128", "display_name": "Stefano", "link": "https://stackoverflow.com/users/3091524/stefano"}, "edited": false, "score": 1, "creation_date": 1463140719, "post_id": 37011040, "comment_id": 61949949, "body": "Ah, so you&#39;re using Cloud Shell. The App Engine SDK was updated, but Cloud Shell was not. If you want to use App Engine with Go 1.6, you&#39;re going to need to either install the SDK locally, or wait until Cloud Shell gets updated. <a href=\"https://cloud.google.com/shell/docs/features#language_support\" rel=\"nofollow noreferrer\">cloud.google.com/shell/docs/features#language_support</a>"}], "tags": [], "owner": {"reputation": 21, "user_id": 6287194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y6h4g.jpg?s=128&g=1", "display_name": "Stuart Jansen", "link": "https://stackoverflow.com/users/6287194/stuart-jansen"}, "is_accepted": false, "score": 2, "last_activity_date": 1462297899, "creation_date": 1462297899, "answer_id": 37011040, "question_id": 36988441, "link": "https://stackoverflow.com/questions/36988441/app-engine-runs-go-1-5-release-notes-says-1-6/37011040#37011040", "title": "App engine runs go 1.5, release notes says 1.6", "body": "<p>Instead of <code>go version</code> try <code>goapp version</code>. The App Engine SDK requires a wrapper script because it sets a custom <code>GOPATH</code>.</p>\n"}], "owner": {"reputation": 1176, "user_id": 3091524, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-48ehLM2xfcE/AAAAAAAAAAI/AAAAAAAAGuw/iCxoJgfXqNA/photo.jpg?sz=128", "display_name": "Stefano", "link": "https://stackoverflow.com/users/3091524/stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462297899, "creation_date": 1462211184, "question_id": 36988441, "link": "https://stackoverflow.com/questions/36988441/app-engine-runs-go-1-5-release-notes-says-1-6", "title": "App engine runs go 1.5, release notes says 1.6", "body": "<p>According to the <a href=\"https://cloud.google.com/appengine/docs/go/release-notes\" rel=\"nofollow\">release notes</a> app engine should be running go 1.6 but if I try to use <a href=\"https://github.com/kataras/iris\" rel=\"nofollow\">iris</a> it fails because it requires 1.6. \"go version\" from shell also returns 1.5!</p>\n\n<p>Am I missing something?</p>\n"}, {"tags": ["ruby-on-rails", "go", "memcached"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1462210529, "creation_date": 1462210529, "answer_id": 36988263, "question_id": 36987964, "link": "https://stackoverflow.com/questions/36987964/can-i-write-and-leverage-memecached-from-different-server-processes/36988263#36988263", "title": "Can I write and leverage memecached from different server processes?", "body": "<p>It's pretty common to have multiple encapsulated applications interact with a shared data store like memcached. This is fine to do in practice and which technology each of the apps is written in doesn't matter, just as long as they can access the store. In such an environment you may require some additional business logic to coordinate reads and writes which shouldn't be overlooked because it could become a lot of work.</p>\n"}], "owner": {"reputation": 3477, "user_id": 419751, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e6bd7a56424a5f8eb3d46037ba8be2f6?s=128&d=identicon&r=PG", "display_name": "Daniel D", "link": "https://stackoverflow.com/users/419751/daniel-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462210529, "creation_date": 1462209410, "question_id": 36987964, "link": "https://stackoverflow.com/questions/36987964/can-i-write-and-leverage-memecached-from-different-server-processes", "title": "Can I write and leverage memecached from different server processes?", "body": "<p>Say you have a rails app, and you're already using queueing (resque) to offload some slow/non-urgent processing on the server.  That queueing processing performs some functionality need for the rails app - and then saves information into a memecached store...  Everything is good.</p>\n\n<p>But is it possible to write a component triggered by queueing that runs a go application that, in turn, leverages the same underlying database as the rails app and writes to the same in-memory store?</p>\n\n<p>Is this common? Not so trivial?  The database schema would be familiar to both rails and go, and while the go app might have some duplication of business logic, it's pretty siloed.  Think of it as a way to gradually migrate some server functionality running in rails to running in go.  Is this done in practice?</p>\n"}, {"tags": ["google-app-engine", "go", "oauth-2.0", "openid", "federated-identity"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462209510, "post_id": 36987942, "comment_id": 61530363, "body": "Based on the error you&#39;re receiving I would guess everything worked and you simply did not pass valid creds to the server. If the request itself were bad I&#39;d expect a different error. Whatever credentials you&#39;re attempting to use for Federated Auth aren&#39;t accepted by the server. Verify what it&#39;s expecting and what gets sent."}, {"owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462209711, "post_id": 36987942, "comment_id": 61530468, "body": "Do you know where can I pass the credential to the federated login function?"}, {"owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462210220, "post_id": 36987942, "comment_id": 61530712, "body": "I went to GAE console and found that there was no federated login option: just Google User and App Domain options are available."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462210326, "post_id": 36987942, "comment_id": 61530781, "body": "So are you attempting to do OAuth with a users gmail/google creds? I would guess that&#39;s what is meant by Google User."}, {"owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462210564, "post_id": 36987942, "comment_id": 61530913, "body": "Yes, I am. Currently I am using user.LoginURL function but I want to switch to user.LoginURLFederated function to get the sub ID that is identical with the one from Google sign-in for Android which implements oauth2."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462210804, "post_id": 36987942, "comment_id": 61531061, "body": "Can you update your question with your imports and/or link to the packages docs? I&#39;ll need to take a look at them to help any further."}, {"owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1462211514, "post_id": 36987942, "comment_id": 61531444, "body": "Thank you so much. I just updated the question."}], "owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462211481, "creation_date": 1462209339, "last_edit_date": 1462211481, "question_id": 36987942, "link": "https://stackoverflow.com/questions/36987942/go-gae-using-loginurlfederated-function-returns-api-error-2-user-not-allowed", "title": "Go GAE Using LoginURLFederated function returns API error 2 (user: NOT_ALLOWED)", "body": "<p>I am trying to use LoginURLFederated for logging users in. My code is as follows:-</p>\n\n<pre><code>c := appengine.NewContext(r)\nu, _ := user.CurrentOAuth(c, \"\")\n\nif u == nil {\n\n    if loginUrl, err := user.LoginURLFederated(c, \"/webservice/uid-test\", \"gmail.com\"); err != nil {\n\n        http.Error(w, \"here1\"+err.Error(), http.StatusInternalServerError)\n        return\n    } else {\n\n        http.Redirect(w, r, loginUrl, http.StatusFound)\n        return\n    }\n\n}\n</code></pre>\n\n<p>I got this error</p>\n\n<pre><code>here1API error 2 (user: NOT_ALLOWED)\n</code></pre>\n\n<p>When I change from <em>LoginURLFederated</em> to <em>LoginURL</em> function, it worked fine. What did I miss? I tried to use <em>user.Current(c)</em> as well, however, I didn't work either.</p>\n\n<p>The reason I am doing this is because I am trying to verify the idToken that is being sent from an android app that uses google sign-in api for signing in. Google sign in api implements oauth2 standard and generate idToken for other app: in this case, my web app written in Go running on GAE, to use the idToken to verify the signed in user. More information about android google sign in is here <em><a href=\"https://developers.google.com/identity/sign-in/android/backend-auth#send-the-id-token-to-your-server\" rel=\"nofollow\">https://developers.google.com/identity/sign-in/android/backend-auth#send-the-id-token-to-your-server</a></em></p>\n\n<p>However, I didn't realize that Google ID that I received from calling <a href=\"https://cloud.google.com/appengine/docs/go/users/\" rel=\"nofollow\">user.LoginURL(c)</a> in Go web app on GAE was different from the sub value (ID) received from calling Google idToken endpoint here</p>\n\n<pre><code>https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=value\n</code></pre>\n\n<p>Then I realized that the IDs were generated by two different Google endpoints. I decided to use Google federated login function on the web app side to match the ID received from </p>\n\n<pre><code>https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=value\n</code></pre>\n\n<p>since federated login implements openid (oauth) but I am receiving an unknown error <strong>API error 2 (user: NOT_ALLOWED)</strong> </p>\n\n<p>Am I doing things right? Can federated login generate the identical id with the sub value (id) sent from google idToken endpoint?</p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "edited": false, "score": 0, "creation_date": 1462207666, "post_id": 36987423, "comment_id": 61529386, "body": "Yes and for get request body, pass in parameters a string for request FormValue or a pointer on request"}], "tags": [], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "is_accepted": false, "score": 1, "last_activity_date": 1462207419, "creation_date": 1462207419, "answer_id": 36987423, "question_id": 36987295, "link": "https://stackoverflow.com/questions/36987295/initializing-structures-dynamically/36987423#36987423", "title": "Initializing structures dynamically", "body": "<p>How about</p>\n\n<pre><code>func foo (s *SomeObject) {\n    s.sample = 123\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>func (s *SomeObject) foo() {\n    s.sample = 123\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1462208096, "creation_date": 1462208096, "answer_id": 36987608, "question_id": 36987295, "link": "https://stackoverflow.com/questions/36987295/initializing-structures-dynamically/36987608#36987608", "title": "Initializing structures dynamically", "body": "<p>If you're dealing with multiple types then you should make your method return an <code>interface{}</code>. For all of the applicable types, create a convenience method like; </p>\n\n<pre><code>func NewSomeObject(reqBody string) *SomeObject {\n     return &amp;SomeObject{sample:reqBody}\n}\n</code></pre>\n\n<p>Which takes a string and returns a new instance of the type with that field set to whatever was passed in. Your question is missing information about how you determine which type should be instantiated but assuming you have a few, you'll likely need an if/else or a switch in the method which receives the request body so to give a very vague example it would be something like;</p>\n\n<pre><code>func ProcessRequest(reqBody string) interface{} {\n      if someCondition {\n           return NewSomeObject(reqBody)\n      } else if otherCondition {\n           return NewSomeOtherObject(reqBody)\n      } // potentially several other statements like this\n      return nil // catch all, if no conditions match\n}\n</code></pre>\n"}], "owner": {"reputation": 1784, "user_id": 5479258, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9013d6bb5ccbdd8ef0cac115267fa2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user99999", "link": "https://stackoverflow.com/users/5479258/user99999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 36987608, "answer_count": 2, "score": 0, "last_activity_date": 1462214159, "creation_date": 1462206976, "last_edit_date": 1462214159, "question_id": 36987295, "link": "https://stackoverflow.com/questions/36987295/initializing-structures-dynamically", "title": "Initializing structures dynamically", "body": "<p>I have a couple of structures, like:</p>\n\n<pre><code>type SomeObject struct {\n   sample int\n}\n</code></pre>\n\n<p>I want to fill the <code>sample</code> variable based on what I get in the request body. To do this, I want to create a function, pass request body as a string to it, create an empty structure inside, fill the structure with data, return it, and replace chosen structure with this.</p>\n\n<p>How do I do this? What do I return from the function? Is there a way to do this?</p>\n"}, {"tags": ["pointers", "go", "dereference"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1462198806, "post_id": 36984376, "comment_id": 61524049, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/30744965/how-to-get-the-pointer-of-return-value-from-function-call\">How to get the pointer of return value from function call?</a> Also related: <a href=\"http://stackoverflow.com/questions/34197248/how-can-i-store-reference-to-the-result-of-an-operation-in-go\">How can I store reference to the result of an operation in Go</a>"}, {"owner": {"reputation": 688, "user_id": 4555439, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/480309134183db7bfce1c1bd6f95594b?s=128&d=identicon&r=PG&f=1", "display_name": "JustinHK", "link": "https://stackoverflow.com/users/4555439/justinhk"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1462203666, "post_id": 36984376, "comment_id": 61527115, "body": "I had assumed that I could do it a for a single-value function call, so I didn&#39;t even see that; I guess ultimately this means the question is moot."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1462198267, "creation_date": 1462198267, "answer_id": 36984548, "question_id": 36984376, "link": "https://stackoverflow.com/questions/36984376/dereferencing-the-first-return-value-in-go/36984548#36984548", "title": "Dereferencing the first return value in go", "body": "<p>You can't do that. The address operator <code>&amp;</code> cannot be applied on function calls. </p>\n\n<p><a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow\">Spec: Address operators:</a></p>\n\n<blockquote>\n  <p>For an operand <code>x</code> of type <code>T</code>, the address operation <code>&amp;x</code> generates a pointer of type <code>*T</code> to <code>x</code>. The operand must be <em>addressable</em>, that is, either a variable, pointer indirection, or slice indexing operation; or a field selector of an addressable struct operand; or an array indexing operation of an addressable array. As an exception to the addressability requirement, <code>x</code> may also be a (possibly parenthesized) <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow\">composite literal</a>. If the evaluation of <code>x</code> would cause a <a href=\"https://golang.org/ref/spec#Run_time_panics\" rel=\"nofollow\">run-time panic</a>, then the evaluation of <code>&amp;x</code> does too.</p>\n</blockquote>\n\n<p>What you should do is change your function to return a pointer in the first place, if it does matter.</p>\n"}], "owner": {"reputation": 688, "user_id": 4555439, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/480309134183db7bfce1c1bd6f95594b?s=128&d=identicon&r=PG&f=1", "display_name": "JustinHK", "link": "https://stackoverflow.com/users/4555439/justinhk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 36984548, "answer_count": 1, "score": 0, "last_activity_date": 1462198267, "creation_date": 1462197800, "question_id": 36984376, "link": "https://stackoverflow.com/questions/36984376/dereferencing-the-first-return-value-in-go", "title": "Dereferencing the first return value in go", "body": "<p>I have  Go function, and I want to dereference the first value to store in a pointer.</p>\n\n<p>E.g.: </p>\n\n<pre><code>func foo() (int64, error) {...}\nvar A *int64\nvar err error\nA, err = &amp;foo()\n</code></pre>\n\n<p>Is this possible, or do I have to copy the (in my case very large) return value?</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 1939, "user_id": 765836, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2dab7beb323d9bd98d61d8c1149c2529?s=128&d=identicon&r=PG", "display_name": "dusual", "link": "https://stackoverflow.com/users/765836/dusual"}, "edited": false, "score": 0, "creation_date": 1462195015, "post_id": 36983078, "comment_id": 61521682, "body": "what settings does your app run with? You say your db is running but how does your test know what db to connect to?"}, {"owner": {"reputation": 1425, "user_id": 2349141, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jbWDl.jpg?s=128&g=1", "display_name": "poorva", "link": "https://stackoverflow.com/users/2349141/poorva"}, "reply_to_user": {"reputation": 1939, "user_id": 765836, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2dab7beb323d9bd98d61d8c1149c2529?s=128&d=identicon&r=PG", "display_name": "dusual", "link": "https://stackoverflow.com/users/765836/dusual"}, "edited": false, "score": 0, "creation_date": 1462195726, "post_id": 36983078, "comment_id": 61522119, "body": "@dusual - Any specific setting you need ? Check the like beego.TestBeegoInit(&lt;path/to/config/file&gt;) in source"}], "answers": [{"comments": [{"owner": {"reputation": 1425, "user_id": 2349141, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jbWDl.jpg?s=128&g=1", "display_name": "poorva", "link": "https://stackoverflow.com/users/2349141/poorva"}, "edited": false, "score": 0, "creation_date": 1462340743, "post_id": 36990274, "comment_id": 61589933, "body": "Sorry , i forgot to mention that i have already tried this Does not help Please refer this <a href=\"http://stackoverflow.com/questions/27943563/how-to-make-api-test-files-with-beego\">link</a>"}], "tags": [], "owner": {"reputation": 1939, "user_id": 765836, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2dab7beb323d9bd98d61d8c1149c2529?s=128&d=identicon&r=PG", "display_name": "dusual", "link": "https://stackoverflow.com/users/765836/dusual"}, "is_accepted": false, "score": 1, "last_activity_date": 1462218838, "last_edit_date": 1462218838, "creation_date": 1462217637, "answer_id": 36990274, "question_id": 36983078, "link": "https://stackoverflow.com/questions/36983078/beego-endpoint-testing/36990274#36990274", "title": "Beego - Endpoint Testing", "body": "<p>You are initializing your app as </p>\n\n<pre><code>apppath, _ := filepath.Abs(filepath.Dir(filepath.Join(file, \"..\"+string(filepath.Separator))))\n    beego.TestBeegoInit(apppath)\n}\n</code></pre>\n\n<p>Where <code>file</code> is the caller file.</p>\n\n<p>TestBeegoInit is:</p>\n\n<pre><code>func TestBeegoInit(ap string) {\n    os.Setenv(\"BEEGO_RUNMODE\", \"test\")\n    appConfigPath = filepath.Join(ap, \"conf\", \"app.conf\")\n    os.Chdir(ap)\n    initBeforeHTTPRun()\n}\n</code></pre>\n\n<p>hence the location where your tests are looking for configuration is</p>\n\n<pre><code>&lt;this_file&gt;/../conf/app.conf\n</code></pre>\n\n<p>which basically is the default config file.</p>\n\n<p>Basically you are not able to connect to the database. Perhaps because you are unknowingly connecting to your default database for the tests too. I suspect this is not what you are trying to do.</p>\n"}, {"tags": [], "owner": {"reputation": 1425, "user_id": 2349141, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jbWDl.jpg?s=128&g=1", "display_name": "poorva", "link": "https://stackoverflow.com/users/2349141/poorva"}, "is_accepted": false, "score": 2, "last_activity_date": 1464336260, "creation_date": 1464336260, "answer_id": 37478096, "question_id": 36983078, "link": "https://stackoverflow.com/questions/36983078/beego-endpoint-testing/37478096#37478096", "title": "Beego - Endpoint Testing", "body": "<p>After much trying I came to know that beego initializes its variable called as <code>AppPath</code> in <strong>beego/conf.go</strong> like -</p>\n\n<pre><code>AppPath, _ = filepath.Abs(filepath.Dir(os.Args[0]))\n</code></pre>\n\n<p>when you run your tests you run them with <code>go test -v</code></p>\n\n<p>but as a result the <code>os.Args[0]</code> is the text executable which will be <strong>/tmp/path/to/test</strong> and not <strong>path/to/app/exe</strong></p>\n\n<p>hence as a result it does not find <strong>config/app.conf</strong> which is in your app path which has db connection details.\nResponsible line in <strong>beego/conf.go</strong> - </p>\n\n<pre><code>appConfigPath = filepath.Join(AppPath, \"conf\", \"app.conf\")\n</code></pre>\n\n<p>This all happens in beego's <code>init</code> function when you say </p>\n\n<pre><code>import (\n  \"github.com/astaxie/beego\"\n  _ \"path/to/routers\"\n)\n</code></pre>\n\n<p>Hack for this is -</p>\n\n<p>create a new package / file with init function which looks has -</p>\n\n<pre><code>package common\n\nimport (\n    \"os\"\n    \"strings\"\n)\n\nfunc init() {\n    cwd := os.Getenv(\"PWD\")\n    rootDir := strings.Split(cwd, \"tests/\")\n    os.Args[0] = rootDir[0] // path to you dir\n}\n</code></pre>\n\n<p>here you are changing <code>os.Args[0]</code> and assigning your directory path</p>\n\n<p>make sure you import it before beego so now import will look like </p>\n\n<pre><code>import (\n  _ \"path/to/common\"\n  \"github.com/astaxie/beego\"\n  _ \"path/to/routers\"\n)\n</code></pre>\n\n<p>And finally you connect to DB !</p>\n"}], "owner": {"reputation": 1425, "user_id": 2349141, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jbWDl.jpg?s=128&g=1", "display_name": "poorva", "link": "https://stackoverflow.com/users/2349141/poorva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1475, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1464336260, "creation_date": 1462193968, "last_edit_date": 1462340940, "question_id": 36983078, "link": "https://stackoverflow.com/questions/36983078/beego-endpoint-testing", "title": "Beego - Endpoint Testing", "body": "<p>I am testing http custom endpoint for beego</p>\n\n<pre><code>package test\n\nimport (\n    \"github.com/astaxie/beego\"\n    . \"github.com/smartystreets/goconvey/convey\"\n    _ \"golife-api-cons/routers\"\n    \"net/http\"\n    \"net/http/httptest\"\n    \"path/filepath\"\n    \"runtime\"\n    \"testing\"\n)\n\nfunc init() {\n    _, file, _, _ := runtime.Caller(1)\n    apppath, _ := filepath.Abs(filepath.Dir(filepath.Join(file, \"..\"+string(filepath.Separator))))\n    beego.TestBeegoInit(apppath)\n}\n\n// TestGet is a sample to run an endpoint test\nfunc TestGet(t *testing.T) {\n    r, _ := http.NewRequest(\"GET\", \"/my/endpoint/fetches/data\", nil)\n    w := httptest.NewRecorder()\n    beego.BeeApp.Handlers.ServeHTTP(w, r)\n\n    beego.Trace(\"testing\", \"TestGet\", \"Code[%d]\\n%s\", w.Code, w.Body.String())\n\n    Convey(\"Subject: Test Station Endpoint\\n\", t, func() {\n        Convey(\"Status Code Should Be 200\", func() {\n            So(w.Code, ShouldEqual, 200)\n        })\n        Convey(\"The Result Should Not Be Empty\", func() {\n            So(w.Body.Len(), ShouldBeGreaterThan, 0)\n        })\n    })\n}\n</code></pre>\n\n<p>When i run using <code>go test -v</code> , </p>\n\n<p>I get in response <code>dial tcp :0: getsockopt: connection refused</code></p>\n\n<p>I am using MariaDB running on my local, \nI have verified using <code>netstat -tulpn</code> that my database is running perfectly fine (I get a valid response if i use postman and my server is running)</p>\n\n<p>One weird observation , after inclusion of line <code>_ \"golife-api-cons/routers\"</code> i get this error even before test's are ran</p>\n\n<p>My test passes with response 200 OK , but without any data as i get in response the above mentioned error</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The default path by used by <code>TestBeegoInit</code> function used is <code>/path/to/my/project/test</code>\nwhich is not the desired path , so i tried giving the absolute path too , still i am not able to connect DB.</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462194099, "post_id": 36982871, "comment_id": 61521055, "body": "Thanks, what is the main loop looks like in this case? you mean send e to the workers in a round robin fashion?"}, {"owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462194951, "post_id": 36982871, "comment_id": 61521642, "body": "You don&#39;t need to do anything extra for round robin. When you call <code>addEvent(myEvent)</code> the first idle worker will grab the event. I&#39;ve expanded the answer with an example of a main thread."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462277392, "post_id": 36982871, "comment_id": 61559942, "body": "I&#39;d like to understand why make <code>ch</code> a buffered channel, what&#39;s the benefit compared to unbuffered channel?"}, {"owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462278809, "post_id": 36982871, "comment_id": 61560926, "body": "@fluter A buffered channel will protect your sending goroutine from accidentally blocking. If, occasionally, all your worker goroutines are busy and you call <code>addEvent()</code>, that call will block. A buffered channel will let you push events to it even when all workers are busy."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462279044, "post_id": 36982871, "comment_id": 61561099, "body": "According to the spec, it will block too when the channel is full, right? Although the chance is little in reality I guess."}, {"owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462279947, "post_id": 36982871, "comment_id": 61561783, "body": "Yes, if the buffer is full, it will block until a stop becomes available. You should pick a buffer size where the chance of blocking is very little."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462280016, "post_id": 36982871, "comment_id": 61561838, "body": "Make the channel bigger in capacity or add more workers, which is better?"}, {"owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1462280184, "post_id": 36982871, "comment_id": 61561982, "body": "If you are writing to the channel faster than you can read, <i>any</i> buffer will eventually fill up and block. You should always have enough workers to keep the channel empty. The buffer is only for the occasional, temporary situation where writes increase significantly."}], "tags": [], "owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "is_accepted": true, "score": 3, "last_activity_date": 1462194857, "last_edit_date": 1462194857, "creation_date": 1462193336, "answer_id": 36982871, "question_id": 36982347, "link": "https://stackoverflow.com/questions/36982347/deadlock-in-event-processing/36982871#36982871", "title": "Deadlock in event processing", "body": "<blockquote>\n  <p>this will cause the server to hang since the event handler itself is called in the context of the server's main loop</p>\n</blockquote>\n\n<p>The main loop should never block on calling <code>handleEvent</code> and the most common way to avoid that is to use a pool of worker goroutines. Here's a quick <strong>untested</strong> example:</p>\n\n<pre><code>type Worker struct {\n    id int\n    ch chan Event\n    quit chan bool\n}\n\nfunc (w *Worker) start {\n    for {\n        select {\n            case e := &lt;- w.ch:\n                fmt.Printf(\"Worker %d called\\n\", w.id)\n                //handle event\n                break;\n            case &lt;- w.quit:\n                return\n        }\n    }\n}\n\n\nch := make(chan Event, 100)\nquit := make(chan bool, 0)\n\n// Start workers\nfor i:=0; i&lt;10; i++{\n    worker := &amp;Worker{i,ch,quit}\n    go worker.start()\n}\n\n// \nfunc addEvent (e Event) {\n    ch &lt;- e\n}\n</code></pre>\n\n<p>and when you are done, just <code>close(quit)</code> to kill all workers.</p>\n\n<p><strong>EDIT</strong>: From the comments below:</p>\n\n<blockquote>\n  <p>what is the main loop looks like in this case?</p>\n</blockquote>\n\n<p>Depends. If you have a fixed number of events, you can use a <a href=\"https://golang.org/pkg/sync/#WaitGroup%20WaitGroup\" rel=\"nofollow\">WaitGroup</a>, like this:</p>\n\n<pre><code>type Worker struct {\n    id int\n    ch chan Event\n    quit chan bool\n    wg *sync.WaitGroup\n}\n\nfunc (w *Worker) start {\n    for {\n        select {\n            case e := &lt;- w.ch:\n                //handle event\n                wg.Done()\n\n                break;\n            case &lt;- w.quit:\n                return\n        }\n    }\n}\n\nfunc main() {\n    ch := make(chan Event, 100)\n    quit := make(chan bool, 0)\n\n    numberOfEvents := 100\n\n    wg := &amp;sync.WaitGroup{}\n    wg.Add(numberOfEvents)\n\n    // start workers\n    for i:=0; i&lt;10; i++{\n        worker := &amp;Worker{i,ch,quit,wg}\n        go worker.start()\n    }\n\n\n    wg.Wait() // Blocks until all events are handled\n}\n</code></pre>\n\n<p>If the number of events is not known beforehand, you can just block on the quit channel:</p>\n\n<pre><code>&lt;- quit\n</code></pre>\n\n<p>and once another goroutine closes the channel, your program will terminate as well.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1462211081, "creation_date": 1462211081, "answer_id": 36988417, "question_id": 36982347, "link": "https://stackoverflow.com/questions/36982347/deadlock-in-event-processing/36988417#36988417", "title": "Deadlock in event processing", "body": "<p>To make things more async you can either</p>\n\n<ul>\n<li><p>add capacity to event channel</p>\n\n<p><code>evtCh := make(chan Event, 10)</code></p></li>\n<li><p>call handleEvent(e) asynchronously</p>\n\n<p><code>go handleEvent(e)</code></p></li>\n<li><p>add event asynchronously in handlers</p>\n\n<p><code>go addEvent(e)</code></p></li>\n</ul>\n\n<p>Or if you want events to be handled in deterministic order you can  call <code>handleEvent(e)</code> in handlers directly instead of <code>addEvent(e)</code></p>\n"}], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 36982871, "answer_count": 2, "score": 4, "last_activity_date": 1462211081, "creation_date": 1462191736, "question_id": 36982347, "link": "https://stackoverflow.com/questions/36982347/deadlock-in-event-processing", "title": "Deadlock in event processing", "body": "<p>So I have a channel used for event processing, the main server goroutine select on this channel and call event handlers on each of the event received:</p>\n\n<pre><code>evtCh := make(chan Event)\n// server loop:\nfor !quit {\n    select {\n    case e := &lt;- evtCh:\n        handleEvent(e)\n        break\n    case quit := &lt;-quitCh:\n        //finish\n}\n\n// for send a new event to processing\nfunc addEvent(e Event) {\n    evtCh &lt;- e\n}\n</code></pre>\n\n<p><code>handleEvent</code> will call registered handlers on the event type. I have <code>func registerEventHandler(typ EventType, func(Event))</code> to handle the register. This program will supports user to write extensions, that means they can register their own handlers to handle events.</p>\n\n<p>Now the problem arise when in user's event handler, they might send new event to the server by calling <code>addEvent</code>, this will cause the server to hang since the event handler itself is called in the context of the server's main loop(in the for loop).</p>\n\n<p>How can I handle this situation elegantly? Is a queue modeled by slice a good idea?</p>\n"}, {"tags": ["go", "go-html-template"], "answers": [{"comments": [{"owner": {"reputation": 950, "user_id": 1856207, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/20eb68c1fa3c8e95b228f211491ba7c5?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#244;me", "link": "https://stackoverflow.com/users/1856207/j%c3%a9r%c3%b4me"}, "edited": false, "score": 0, "creation_date": 1462187115, "post_id": 36980336, "comment_id": 61516804, "body": "<code>http:&#47;&#47;myurl.com&#47;%28data%29&#47;aaa.jpg</code> can&#39;t be reach and responses 404 while <code>http:&#47;&#47;myurl.com&#47;(data)&#47;aaa.jpg</code> display the jpg file."}, {"owner": {"reputation": 950, "user_id": 1856207, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/20eb68c1fa3c8e95b228f211491ba7c5?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#244;me", "link": "https://stackoverflow.com/users/1856207/j%c3%a9r%c3%b4me"}, "edited": false, "score": 0, "creation_date": 1462190389, "post_id": 36980336, "comment_id": 61518698, "body": "Your test works, but you serve an image to <code>&#47;(data)&#47;aaa.jpg</code>. However I need to pass the entire URL (since it&#39;s from a CDN) to my template. And strangely <code>%28</code> and <code>%29</code> are not understand as <code>(</code> and <code>)</code>..."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 950, "user_id": 1856207, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/20eb68c1fa3c8e95b228f211491ba7c5?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#244;me", "link": "https://stackoverflow.com/users/1856207/j%c3%a9r%c3%b4me"}, "edited": false, "score": 0, "creation_date": 1462191897, "post_id": 36980336, "comment_id": 61519656, "body": "@J&#233;r&#244;me Note that the html page contains 2 images, and the 2nd has the  source attribute <code>src=&quot;http:&#47;&#47;localhost:8080&#47;%28data%29&#47;aaa.jpg&quot;</code> (that is, parenthesis are encoded), and this works too, the 2nd image is also displayed."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1462187980, "last_edit_date": 1462187980, "creation_date": 1462185191, "answer_id": 36980336, "question_id": 36980049, "link": "https://stackoverflow.com/questions/36980049/avoid-auto-escape-in-html-template/36980336#36980336", "title": "avoid auto escape in html template", "body": "<p>Using a value of <a href=\"https://golang.org/pkg/html/template/#URL\" rel=\"nofollow\"><code>template.URL</code></a> is perfectly enough.</p>\n\n<p>What you see is <strong>not</strong> HTML encoding of the given URL, what you see is the URL encoding of the opening and closing parenthesis in the <code>(data)</code> part. That is perfectly ok. <code>%28</code> is the encoding of <code>'('</code> (28 is the hexa code for the opening parenthesis character), and <code>%29</code> is the <code>')'</code> character.</p>\n\n<p>The url <code>http://myurl.com/(data)/aaa.jpg</code> and <code>http://myurl.com/%28data%29/aaa.jpg</code> are one and the same.</p>\n\n<p>The purpose of the URL encoding is so that URLs and values included in URLs (e.g. form parameters) can be safely transmitted.</p>\n\n<blockquote>\n  <p><strong>URL Encoding</strong></p>\n  \n  <p>URLs can only be sent over the Internet using the ASCII character-set.</p>\n  \n  <p>Since URLs often contain characters outside the ASCII set, the URL has to be converted into a valid ASCII format.</p>\n  \n  <p>URL encoding replaces unsafe ASCII characters with a \"%\" followed by two hexadecimal digits.\n  URLs cannot contain spaces. URL encoding normally replaces a space with a plus (+) sign or with %20.</p>\n</blockquote>\n\n<p>You can read more about URL encoding here: <a href=\"http://www.w3schools.com/tags/ref_urlencode.asp\" rel=\"nofollow\">HTML URL Encoding Reference</a>.</p>\n\n<p>Testing it:</p>\n\n<pre><code>func rh(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprint(w, `&lt;html&gt;&lt;body&gt;\n&lt;img src=\"http://localhost:8080/(data)/aaa.jpg\"&gt;\n&lt;img src=\"http://localhost:8080/%28data%29/aaa.jpg\"&gt;\n&lt;/body&gt;&lt;/htm&gt;`)\n}\n\nfunc imgh(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"aaa.jpg\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", rh)\n    http.HandleFunc(\"/(data)/aaa.jpg\", imgh)\n    panic(http.ListenAndServe(\"localhost:8080\", nil))\n}\n</code></pre>\n\n<p>Now direct your browser to <code>http://localhost:8080</code>. It will display 2 images.</p>\n"}], "owner": {"reputation": 950, "user_id": 1856207, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/20eb68c1fa3c8e95b228f211491ba7c5?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#244;me", "link": "https://stackoverflow.com/users/1856207/j%c3%a9r%c3%b4me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1247, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1462187980, "creation_date": 1462184201, "question_id": 36980049, "link": "https://stackoverflow.com/questions/36980049/avoid-auto-escape-in-html-template", "title": "avoid auto escape in html template", "body": "<p>Trying to render HTML template with an URL. The problem is that the URL contains () in it, and those characters are escaped.</p>\n\n<p>I tried to use <code>template.URL(\"http://myurl.com/(data)/aaa.jpg\")</code> and also <code>template.HTML(\"http://myurl.com/(data)/aaa.jpg\")</code> but it still escape brackets.</p>\n\n<p>I'm using <a href=\"https://github.com/gin-gonic/gin#html-rendering\" rel=\"nofollow\">gin gonic</a>.</p>\n\n<pre><code>router.GET(\"/test\", func(c *gin.Context) {\n    c.HTML(http.StatusOK, \"test.tmpl\", gin.H{\n        \"url\": template.URL(\"http://myurl.com/(data)/aaa.jpg\"),\n        // \"url\": template.HTML(\"http://myurl.com/(data)/aaa.jpg\"),\n})\n</code></pre>\n\n<p>Template file :</p>\n\n<pre><code>&lt;div&gt;\n  &lt;img src=\"{{.url}}\" /&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>final ouput :</p>\n\n<pre><code>&lt;div&gt;\n  &lt;img src=\"http://myurl.com/%28data%29/aaa.jpg\"/&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["php", "go", "hash", "passwords", "phpass"], "comments": [{"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1462179158, "post_id": 36978296, "comment_id": 61512077, "body": "If your hashing is backed by <code>bcrypt</code> then the resulting hash is expected to be different on each generation. This is by design. Consuming and validating different hashes generated by the same password should all work."}, {"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1462179899, "post_id": 36978296, "comment_id": 61512510, "body": "Thank for your answer ! What do you mean by &quot;consuming and validating&quot;? I&#39;m not sure to understand"}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1462184409, "post_id": 36978296, "comment_id": 61515191, "body": "I.e. using <a href=\"https://godoc.org/golang.org/x/crypto/bcrypt#CompareHashAndPassword\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/crypto/bcrypt#CompareHashAndPassword</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21225, "user_id": 575765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/877fab7e16fb4639a88aa48496b5e8cb?s=128&d=identicon&r=PG", "display_name": "martinstoeckli", "link": "https://stackoverflow.com/users/575765/martinstoeckli"}, "is_accepted": false, "score": 2, "last_activity_date": 1462188434, "last_edit_date": 1495540897, "creation_date": 1462188434, "answer_id": 36981326, "question_id": 36978296, "link": "https://stackoverflow.com/questions/36978296/golang-and-phpass-php-how-to-do/36981326#36981326", "title": "Golang and Phpass (Php) How to do?", "body": "<p>The different hashes are the result of salting, each password should get its own unique salt. This salt is then included together with other parameters in the resulting hash string, so a <a href=\"http://www.php.net/manual/en/function.password-verify.php\" rel=\"nofollow noreferrer\">password_verify()</a> function can extract it to verify an entered password.</p>\n\n<p>According to this <a href=\"https://stackoverflow.com/a/23259804/575765\">answer</a>, the Go language seems to implement the BCrypt algorithm. This would be the default of the phpass library, if the hashes where not generated with a very old PHP version. If your hashes start with the signature <code>$2y$...</code> chances are good that the BCrypt implementation is compatible with the hashes generated by PHP.</p>\n"}], "owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1462188434, "creation_date": 1462178350, "question_id": 36978296, "link": "https://stackoverflow.com/questions/36978296/golang-and-phpass-php-how-to-do", "title": "Golang and Phpass (Php) How to do?", "body": "<p>I'm working for a company and I have to remake their API to Golang from Php. The previous developer was using Phpass with Php, however, I need to use it with Golang.</p>\n\n<p>I searched about how to implement phpass in go but it doesn't seems to work as well as in php.</p>\n\n<p>I saw these github implementations:</p>\n\n<p><a href=\"https://github.com/superpan/gopass\" rel=\"nofollow\">gopass</a> \u2014 Implement phpass algorithm in go</p>\n\n<p><a href=\"https://github.com/apokalyptik/phpass\" rel=\"nofollow\">phpass</a> \u2014 A go implementation of the PHPass password ...</p>\n\n<p>Maybe it's weird, but does it works the same in Php? For me, each time I get a new hashed password for the same password/using. I also never did php, so I don't really know how to test this class/library (phpass)</p>\n\n<p>Thank for help !</p>\n"}, {"tags": ["authentication", "go", "oauth", "oauth-2.0", "multi-tenant"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 9, "last_activity_date": 1462171314, "last_edit_date": 1592644375, "creation_date": 1462165271, "answer_id": 36975274, "question_id": 36974902, "link": "https://stackoverflow.com/questions/36974902/use-cases-of-oauth2-0/36975274#36975274", "title": "Use cases of OAuth2.0", "body": "<p>First, as clearly indicated in <a href=\"http://oauth.net/articles/authentication/\" rel=\"noreferrer\">OAuth authentication</a></p>\n<blockquote>\n<p><strong>OAuth 2.0 is not an authentication protocol.</strong></p>\n<p>Authentication in the context of a user accessing an application tells an application who the current user is and whether or not they're present. A full authentication protocol will probably also tell you a number of attributes about this user, such as a unique identifier, an email address, and what to call them when the application says &quot;Good Morning&quot;.</p>\n<p>However, OAuth tells the application none of that.<br />\nOAuth says absolutely nothing about the user, nor does it say how the user proved their presence or even if they're still there.<br />\nAs far as an OAuth client is concerned, it asked for a token, got a token, and eventually used that token to access some API. It doesn't know anything about who authorized the application or if there was even a user there at all.</p>\n</blockquote>\n<p>There is a standard for user authentication using OAuth: OpenID Connect, compatible with OAuth2.</p>\n<blockquote>\n<p>The OpenID Connect ID Token is a signed <a href=\"https://tools.ietf.org/html/draft-ietf-oauth-json-web-token\" rel=\"noreferrer\">JSON Web Token (JWT)</a> that is given to the client application along side the regular OAuth access token.<br />\nThe ID Token contains a set of claims about the authentication session, including an identifier for the user (sub), the identifier for the identity provider who issued the token (iss), and the identifier of the client for which this token was created (aud).</p>\n</blockquote>\n<p>In Go, you can look at <a href=\"https://github.com/coreos/dex\" rel=\"noreferrer\"><strong><code>coreos/dex</code></strong></a>, an OpenID Connect Identity (OIDC) and OAuth 2.0 Provider with Pluggable Connector.</p>\n"}], "owner": {"reputation": 2973, "user_id": 1599825, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/TJpwJ.jpg?s=128&g=1", "display_name": "Robins Gupta", "link": "https://stackoverflow.com/users/1599825/robins-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 2, "accepted_answer_id": 36975274, "answer_count": 1, "score": 1, "last_activity_date": 1462171314, "creation_date": 1462162537, "last_edit_date": 1462162867, "question_id": 36974902, "link": "https://stackoverflow.com/questions/36974902/use-cases-of-oauth2-0", "title": "Use cases of OAuth2.0", "body": "<p>I am building a <code>muli-tenant saas(software as a service) architecture</code>. I have to build the <code>authentication system</code> for the system. </p>\n\n<p>From what I have studied, I think I need to the build the authentication system based on <code>OAuth2.0</code> and the bearer token with <code>JWT tokens</code>. </p>\n\n<p>After reading a lot about OAuth2.0 of how to build an OAuth2.0 server I still <code>didn't understand</code> the <code>full concept of OAuth</code> and also have confusion about whether I need it or not or I need some other Authentication system.</p>\n\n<p>What my system need is we will provide an <code>SDK</code> to all our customer and each client will have an <code>Application Id</code> and <code>a secret key</code> using the SDK client will connect to his application present in our system.</p>\n\n<p>The <code>application ID</code> will map the customer to his application present in our system and the <code>client secret key</code> will authenticate the client inside the application.Do I still need to build an authentication system based on OAuth2.0 or can I build my own authentication system based on our need?</p>\n\n<p><strong>What are the use cases of OAUTH2.0 and when we won't need it to implement?</strong></p>\n"}, {"tags": ["go", "bigdecimal", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 2, "creation_date": 1462175596, "post_id": 36977205, "comment_id": 61510278, "body": "Yes. It is because by default, string function uses  msg.Text(&#39;g&#39;, 10) So it look like that precision has been lost. When &quot;fmt.Println(&quot;go object:&quot;, msg.F1.Text(&#39;f&#39;, 6))&quot;, you can see that there&#39;s no lost. I too was about to post same thing but you beat me to it."}], "tags": [], "owner": {"reputation": 322, "user_id": 3581778, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/98948b56841bc5ded022c5c1f9288da2?s=128&d=identicon&r=PG", "display_name": "Manawasp", "link": "https://stackoverflow.com/users/3581778/manawasp"}, "is_accepted": true, "score": 4, "last_activity_date": 1462174256, "creation_date": 1462174256, "answer_id": 36977205, "question_id": 36974666, "link": "https://stackoverflow.com/questions/36974666/golang-math-big-unmarshal-lost-precision/36977205#36977205", "title": "Golang math/big Unmarshal Lost Precision", "body": "<p>The precision is not lost when you unmarshall. It's \"lost\" when you convert the Float to String to print it.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n    \"math/big\"\n)\n\ntype Msg struct {\n    F1  *big.Float `json:\"F1,string\"`\n}\n\nfunc main() {\n    jsonMsg := []byte(`{\"F1\": \"1000314.451234\"}`)\n    var msg Msg\n    json.Unmarshal(jsonMsg, &amp;msg)\n    fmt.Println(\"go object:\",msg.F1.String())\n    fmt.Printf(\"go object: %f\", msg.F1)\n}\n</code></pre>\n\n<p>The output of this test will be :</p>\n\n<pre><code>go object: 1000314.451\ngo object: 1000314.451234\n</code></pre>\n\n<p>So just depend how you print the data.\nGodoc <a href=\"https://golang.org/pkg/fmt/#hdr-Printing\" rel=\"nofollow\">fmt printing</a></p>\n"}], "owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "accepted_answer_id": 36977205, "answer_count": 1, "score": 2, "last_activity_date": 1462174256, "creation_date": 1462160468, "last_edit_date": 1462166668, "question_id": 36974666, "link": "https://stackoverflow.com/questions/36974666/golang-math-big-unmarshal-lost-precision", "title": "Golang math/big Unmarshal Lost Precision", "body": "<p>I have a struct like:</p>\n\n<pre><code>type Msg struct {\n    F1  *big.Float `json:\"F1,string\"`\n}\n</code></pre>\n\n<p>Then I got a message in <code>json</code> from a message queue and then I want to unmarshal that json message into my <code>Msg</code> struct:</p>\n\n<pre><code>// jsonMsg = {\"F1\": \"1000314.451234\"}\nvar msg Msg\njson.Unmarshal(jsonMsg, &amp;msg)\n</code></pre>\n\n<p>But I got:</p>\n\n<pre><code>fmt.Println(\"go object:\",msg.F1.String()) // 1000314.45, precision lost\n</code></pre>\n\n<p>So the precision is lost when my string <code>\"1000314.451234\"</code> is unmarshaled to a <code>Msg</code> object in golang. I wonder if this is bug? How can I get the full precision? Thanks.</p>\n"}, {"tags": ["go", "combinations", "permutation"], "comments": [{"owner": {"reputation": 7554, "user_id": 700471, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/ebb4cc58c1fce4f22abc59a1226ee8e2?s=128&d=identicon&r=PG", "display_name": "Matt Mc", "link": "https://stackoverflow.com/users/700471/matt-mc"}, "edited": false, "score": 2, "creation_date": 1462152647, "post_id": 36973663, "comment_id": 61503341, "body": "Trying to break a password?... <code>len(chars) &#47; blocks</code> is 2, not 5, based on the values you&#39;ve provided.  And where do you get the variable <code>r</code> from?  Does your code even compile?  I suggest you cut back the gradient and start with something simpler."}, {"owner": {"reputation": 15, "user_id": 5304724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4102e1ade040bb348f9b093f4e99db57?s=128&d=identicon&r=PG&f=1", "display_name": "Ross Chater", "link": "https://stackoverflow.com/users/5304724/ross-chater"}, "reply_to_user": {"reputation": 7554, "user_id": 700471, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/ebb4cc58c1fce4f22abc59a1226ee8e2?s=128&d=identicon&r=PG", "display_name": "Matt Mc", "link": "https://stackoverflow.com/users/700471/matt-mc"}, "edited": false, "score": 0, "creation_date": 1462190867, "post_id": 36973663, "comment_id": 61518987, "body": "This wasn&#39;t a full sample of the code, I was asking for alternatives..."}], "owner": {"reputation": 15, "user_id": 5304724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4102e1ade040bb348f9b093f4e99db57?s=128&d=identicon&r=PG&f=1", "display_name": "Ross Chater", "link": "https://stackoverflow.com/users/5304724/ross-chater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 538, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462369704, "creation_date": 1462150492, "question_id": 36973663, "link": "https://stackoverflow.com/questions/36973663/golang-for-loop-permutations", "title": "Golang for loop permutations", "body": "<p>I've been puzzling myself for around 5 hours now. I'm extremely new to Golang (2 day)...</p>\n\n<p>I'm looking for a for loop that will create all permutations of a given sized string, using specific characters. Not only that, but it needs to be split into specific chunk sizes.. I'll try and visually show you what I need..</p>\n\n<pre><code>chars          := \"abcdefghij\"\nstring_size    := 6\nblocks         := 5\nstart_position := 2\n</code></pre>\n\n<p>So the possibilities of this example would be 10 to the power of 6... so 1,000,000..</p>\n\n<p>What I need is for this e.g. 1,000,000 to be split into 5 blocks mentioned above, so 200,000 guesses per for loop.</p>\n\n<p>So specifying start position would lets say do something like</p>\n\n<pre><code>sections_usable := len(chars) / blocks\n// sections_usable == 5\n// this would then cherry pick 5 sections \nsections := make([]rune, blocks)\nbase_count := 0\nfor i := 0; i &lt; blocks * sections_usable; i = i + sections_usable  {  \n     sections[base_count] = rune(r[i])\n     base_count++\n}\nfor i, xi := range x {\n\n    if i == 0 {\n\n        // This is where its selecting the starting character\n        // From the sections \n        p[i] = sections[block_to_use]\n\n    } else {\n        p[i] = r[xi]\n    }\n\n}\n</code></pre>\n\n<p>Heres an example of what data I'd want returned\nusing</p>\n\n<pre><code>chars          := \"abcdefghij\"\nstring_size    := 6\nblocks         := 5\nstart_position := 2\n</code></pre>\n\n<p>So start position 0 would be \"a\", 1 would be \"c\", 2 would be \"e\"</p>\n\n<p>so using 0</p>\n\n<p>aaaaaa</p>\n\n<p>aaaaab</p>\n\n<p>aaaaac</p>\n\n<p>aaaaad</p>\n\n<p>....</p>\n\n<p>abbbbb</p>\n\n<p>abbbbc</p>\n\n<p>abbbbd</p>\n\n<p>....</p>\n\n<p>acdddd</p>\n\n<p>acddde</p>\n\n<p>acdddf</p>\n\n<p>NOW USING start position 2</p>\n\n<p>eaaaaa</p>\n\n<p>eaaaab</p>\n\n<p>eaaaac</p>\n\n<p>...</p>\n\n<p>And so on, but the permutations must stop before it starts the next block i.e</p>\n\n<p>ejjjjj</p>\n"}, {"tags": ["html", "go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1462145829, "post_id": 36973188, "comment_id": 61501899, "body": "you&#39;d need to use ajax, check jquery"}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 1, "creation_date": 1462184870, "post_id": 36973188, "comment_id": 61515468, "body": "ajax or websockets"}], "owner": {"reputation": 189, "user_id": 2128746, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lQXxz.jpg?s=128&g=1", "display_name": "Hasit Mistry", "link": "https://stackoverflow.com/users/2128746/hasit-mistry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 947, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462145704, "creation_date": 1462145704, "question_id": 36973188, "link": "https://stackoverflow.com/questions/36973188/update-html-page-without-reloading-in-golang", "title": "Update html page without reloading in golang", "body": "<p>I am writing my first server in golang. I have a login form that users will fill out and I want to show messages on the page without reloading.</p>\n\n<p>What I have until now:</p>\n\n<ol>\n<li>index.tmpl</li>\n</ol>\n\n<pre><code>&lt;form class=\"form-horizontal\" role=\"form\"  action=\"/auth/login\" method=\"POST\"&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;div class=\"col-sm-2\"&gt;\n      &lt;label for=\"inputEmail\" class=\"control-label\"&gt;Email&lt;/label&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;input type=\"email\" name=\"email\" class=\"form-control input-lg\" id=\"inputEmail\" placeholder=\"Email\"&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;div class=\"col-sm-2\"&gt;\n      &lt;label for=\"inputPassword\" class=\"control-label\"&gt;Password&lt;/label&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;input type=\"password\" name=\"password\" class=\"form-control input-lg\" id=\"inputPassword\" placeholder=\"Password\"&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;div class=\"col-sm-12\"&gt;\n      &lt;label for=\"message\" class=\"control-label text-danger\"&gt;{{ .message }}&lt;/label&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;div class=\"col-sm-offset-2 col-sm-10\"&gt;\n      &lt;button type=\"submit\" class=\"btn btn-default btn-lg\"&gt;Sign in&lt;/button&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Here, I have a placeholder for message where I want to print all my error messages.</p>\n\n<ol start=\"2\">\n<li>server.go</li>\n</ol>\n\n<pre><code>if _, ok := resp.Item[\"Email\"]; ok {\n                if *resp.Item[\"Email\"].S == form.Email &amp;&amp; *resp.Item[\"Password\"].S == form.Password {\n                    var bucketlist []string\n                    for _, dataset := range resp.Item[\"Datasets\"].SS {\n                        bucketlist = append(bucketlist, *dataset)\n                    }\n                    log.Info(\"User password and email match\")\n                    c.HTML(http.StatusOK, \"bucketlist.tmpl\", gin.H{\n                        \"bucketlist\": bucketlist,\n                    })\n                } else {\n                    log.Info(\"Failure authorizing user: Invalid login\")\n                    c.HTML(http.StatusUnauthorized, \"index.tmpl\", gin.H{\n                        \"message\": \"Invalid login information.\",\n                    })\n                }\n            } else {\n                log.Info(\"Failure authorizing user: Invalid login\")\n                c.HTML(http.StatusUnauthorized, \"index.tmpl\", gin.H{\n                    \"message\": \"Invalid login information.\",\n                })\n            }\n        }\n    } else {\n        log.Info(\"Failure authorizing user: No input provided\")\n        c.HTML(http.StatusUnauthorized, \"index.tmpl\", gin.H{\n            \"message\": \"Please fill the form with valid login information.\",\n        })\n    }\n</code></pre>\n\n<p>Here, I am handling errors and printing to {{ .message }} placeholder in index.tmpl. If I put in a wrong password, I want the webpage to update the placeholder without reloading the whole page. Is there a way to do that? If there is, a point in the right direction would be greatly appreciated.</p>\n"}, {"tags": ["mysql", "google-app-engine", "go", "google-cloud-platform", "google-cloud-sql"], "comments": [{"owner": {"reputation": 4643, "user_id": 350488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2f718cd7ee6515956717892c47cb93e?s=128&d=identicon&r=PG", "display_name": "Vadim", "link": "https://stackoverflow.com/users/350488/vadim"}, "edited": false, "score": 1, "creation_date": 1462221950, "post_id": 36972695, "comment_id": 61536952, "body": "Do you have a readonly@localhost user setup in MySQL?"}, {"owner": {"reputation": 3493, "user_id": 4270992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZTDS.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4270992/nick"}, "edited": false, "score": 0, "creation_date": 1463515643, "post_id": 36972695, "comment_id": 62095600, "body": "Any updates on the question of Vadim? It&#39;s a pretty basic sanity-check, but might just work."}, {"owner": {"reputation": 150, "user_id": 1156923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78fa539025c0b74c0b361ab8d07efc5b?s=128&d=identicon&r=PG", "display_name": "Sunlis", "link": "https://stackoverflow.com/users/1156923/sunlis"}, "edited": false, "score": 1, "creation_date": 1463647014, "post_id": 36972695, "comment_id": 62155719, "body": "Yes, sorry. I did verify that the read-only user was setup (and was even readonly@%). In the end, I set up a second generation instance and was able to connect to it without any issues."}, {"owner": {"reputation": 3493, "user_id": 4270992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZTDS.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4270992/nick"}, "edited": false, "score": 0, "creation_date": 1464118245, "post_id": 36972695, "comment_id": 62349886, "body": "You could self-answer that, I suppose. Glad to hear!"}], "owner": {"reputation": 150, "user_id": 1156923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78fa539025c0b74c0b361ab8d07efc5b?s=128&d=identicon&r=PG", "display_name": "Sunlis", "link": "https://stackoverflow.com/users/1156923/sunlis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462141607, "creation_date": 1462141607, "last_edit_date": 1592644375, "question_id": 36972695, "link": "https://stackoverflow.com/questions/36972695/connecting-to-cloudsql-from-app-engine", "title": "Connecting to CloudSQL from App Engine", "body": "<p>I have a Go app running on App Engine, and a first generation CloudSQL instance running. I can connect to the SQL server from dev using a TCP connection, specifying the SQL server's IP. But I cannot connect from the deployed instance, using the CloudSQL driver.</p>\n<p>Sample code</p>\n<pre><code>import (\n    &quot;database/sql&quot;\n    _ &quot;github.com/ziutek/mymysql/godrv&quot;\n    _ &quot;google.golang.org/appengine/cloudsql&quot;\n)\n\nif (dev) {\n    sql.Open(&quot;mymysql&quot;, &quot;tcp:1.2.3.4:3306*database/user/pass&quot;)\n} else {\n    sql.Open(&quot;mymysql&quot;, &quot;cloudsql:project-id:instance-name*database/user/pass&quot;)\n}\n</code></pre>\n<p>(Yes, I'm substituting <code>database</code>, <code>user</code>, <code>pass</code>, <code>project-id</code>, and <code>instance-name</code> for their correct values in my real code)</p>\n<p>When running locally (via <code>goapp serve</code>) I can connect and query the database - everything works great.\nHowever, when connecting from the deployed instance, I get the following error:</p>\n<blockquote>\n<p>Received #1045 error from MySQL server: &quot;Access denied for user 'readonly'@'localhost' (using password: YES)&quot;</p>\n</blockquote>\n<p>I have made sure that my App Engine instance is authorized (SQL &gt; Instance &gt; Access Control &gt; Authorization), and I'm using the same user in both cases.</p>\n<p>I've found something resembling my error message on the <a href=\"https://cloud.google.com/sql/docs/diagnose-issues\" rel=\"nofollow noreferrer\">Diagnosing Issues with Cloud SQL Instances</a> page, but the suggested solution is to connect with SSL if SSL is enabled (I have not enabled SSL for the server).</p>\n<blockquote>\n<p>If you get an error message like:</p>\n<pre><code>ERROR 1045 (28000): Access denied for user 'root'@'1.2.3.4' (using password: YES)\n</code></pre>\n<p>when you connect, verify that you are using the correct\npassword and that you are connecting over SSL if the instance requires\nit.</p>\n</blockquote>\n<p>Seeing as how this has given me so much trouble, I also tried connecting via IP address from the App Engine instance, but the socket connection is denied.</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "edited": false, "score": 0, "creation_date": 1462420770, "post_id": 36972513, "comment_id": 61633247, "body": "What if db is global variable and you initialize in main the way you have now. But instead of &quot;:=&quot; , you could use &quot;=&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1462157561, "post_id": 36973208, "comment_id": 61504244, "body": "Also read: <a href=\"https://robots.thoughtbot.com/interface-with-your-database-in-go\" rel=\"nofollow noreferrer\">robots.thoughtbot.com/interface-with-your-database-in-go</a> + <a href=\"http://www.alexedwards.net/blog/organising-database-access#using-an-interface\" rel=\"nofollow noreferrer\">alexedwards.net/blog/&hellip;</a> + <a href=\"https://medium.com/@benbjohnson/structuring-applications-in-go-3b04be4ff091#.gfybgb2n4\" rel=\"nofollow noreferrer\">medium.com/@benbjohnson/&hellip;</a>"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 0, "last_activity_date": 1462145901, "creation_date": 1462145901, "answer_id": 36973208, "question_id": 36972513, "link": "https://stackoverflow.com/questions/36972513/how-to-design-a-database-service-class/36973208#36973208", "title": "How to design a database service class", "body": "<p>Have the service have an internal field that takes a pointer to the db and use that.</p>\n\n<pre><code>type DBService struct {\n    db *sql.DB\n}\n\nfunc (dbs *DBService) GetUserKey(id int64) (key string, err error)\n    dbs.db.Query(\"SOMETHING\")\n    return\n}\n\nfunc NewService(db *sql.DB) *DBService { return &amp;DBService{db: db} }\n</code></pre>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462145901, "creation_date": 1462140397, "question_id": 36972513, "link": "https://stackoverflow.com/questions/36972513/how-to-design-a-database-service-class", "title": "How to design a database service class", "body": "<p>I want to create a class that takes a sql connection, and then I can write methods to return data from my database.</p>\n\n<pre><code>func main() {\n  db := dbConnect()\n  defer db.Close()\n\n  // pass the db to my dbservice.go somehow?\n}\n</code></pre>\n\n<p>Then in my handlers (for a web app) I want to be able to do:</p>\n\n<pre><code>var userKey, err := dbService.getUserKey(123)\n</code></pre>\n\n<p>Do I just create a file like dbservice.go  and then create structs that represent my return values, and then do:</p>\n\n<pre><code>func (mystruct *MyStruct) GetUserKey(id int64) (key string, err error) {\n   //\n}\n</code></pre>\n\n<p>Also, how do I pass the db to this in my main so it can use the database connection?</p>\n"}, {"tags": ["http", "redirect", "go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1462146137, "post_id": 36972078, "comment_id": 61501956, "body": "is there anything else in the handler writing to <code>w</code>?"}, {"owner": {"reputation": 25797, "user_id": 316357, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50e7e6ec58e101311283a40e60c33572?s=128&d=identicon&r=PG", "display_name": "Curious2learn", "link": "https://stackoverflow.com/users/316357/curious2learn"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1462156597, "post_id": 36972078, "comment_id": 61504082, "body": "There is nothing else writing to the handler. That was another question I had. Can I not write something before redirecting? Also, I noticed that if I submit the form using <code>action=url</code> then redirect works. However, if I submit it using Ajax post then it does not. Is there a way to use Redirect when the request comes from Ajax call? Thanks."}, {"owner": {"reputation": 322, "user_id": 3581778, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/98948b56841bc5ded022c5c1f9288da2?s=128&d=identicon&r=PG", "display_name": "Manawasp", "link": "https://stackoverflow.com/users/3581778/manawasp"}, "edited": false, "score": 1, "creation_date": 1462175068, "post_id": 36972078, "comment_id": 61510024, "body": "If an Ajax request receive a redirection it will not redirect the current page to the new one. The way to do it, here, it&#39;s to catch the http request in your javascript response and look at the http code sent (301 or 3xx about redirecting) then redirect to the url"}], "owner": {"reputation": 25797, "user_id": 316357, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50e7e6ec58e101311283a40e60c33572?s=128&d=identicon&r=PG", "display_name": "Curious2learn", "link": "https://stackoverflow.com/users/316357/curious2learn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1462137557, "creation_date": 1462137557, "question_id": 36972078, "link": "https://stackoverflow.com/questions/36972078/golang-http-redirect-fails-to-redirect-in-a-handler-than-handles-post-data", "title": "Golang - http.Redirect fails to redirect in a handler than handles post data", "body": "<p>I was thinking of doing the following for the authentication.</p>\n\n<p>(1) Client visits home,say <a href=\"http://localhost:3000\" rel=\"nofollow\">http://localhost:3000</a>\nThe client is shown a login form with username, password, gamecode. </p>\n\n<p>(2) When the client submits this form, I use javascript to post the data to \n<a href=\"http://localhost:3000/login\" rel=\"nofollow\">http://localhost:3000/login</a> that accepts POST requests. In my golang file the relevant route is defined as:</p>\n\n<pre><code>rtr := mux.NewRouter()\nrtr.HandleFunc(\"/login\", loginHandler).Methods(\"POST\")\n</code></pre>\n\n<p>(3) Now I want to check if the three, username, password and the gamecode are valid. I start with the gamecode, and I have no difficulty reading the value submitted and checking in against the list of valid gamecodes in the database. Now, if the gamecode is invalid, I want to redirect the user to another route. I am failing to do so. These are the relevant lines:</p>\n\n<pre><code>// I check if gamecode is valid. If it is invalid, gameCodeExists = 0\nif gameCodeExists == 0 {\n    // this message prints on the server as expected for an invalid code\n    fmt.Println(\"gamecode invalid...\")\n\n    // this redirect never occurs\n    http.Redirect(w, req, \"/loginfail\", 302)\n    return\n} else {\n    fmt.Println(\"Valid code\")\n}\n</code></pre>\n\n<p>Can someone please help me with what I am doing wrong, and how I can fix it?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "edited": false, "score": 0, "creation_date": 1462111419, "post_id": 36967461, "comment_id": 61490623, "body": "meaning if I change &quot;name&quot; to &quot;Name&quot; I can use  package main  import &quot;wwo&quot; //my Whatever Package Name  wwo.WwogcParams{&quot;q&quot;,&quot;delhi&quot;}"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1462113468, "post_id": 36967461, "comment_id": 61491277, "body": "exactly.   So, if you have type Foo struct { abc int }, Foo is visible but abc is not.  type Foo struct { Abc int }, now both are.   This is why you see in godocs (ie: <a href=\"https://golang.org/pkg/net/http/#ServeMux\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#ServeMux</a>) the &quot;contains filtered or unexported fields&quot;.  Click through the title and get to <a href=\"https://golang.org/src/net/http/server.go?s=53067:53192#L1780\" rel=\"nofollow noreferrer\">golang.org/src/net/http/server.go?s=53067:53192#L1780</a> where you see mu, m and hosts fields, all of which are unexported"}, {"owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "edited": false, "score": 0, "creation_date": 1462118780, "post_id": 36967461, "comment_id": 61493201, "body": "Thanks, i am currently trying this and will accept as soon as it work."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 1, "creation_date": 1462120286, "post_id": 36967461, "comment_id": 61493742, "body": "Also note: You need to prefix the use in main with the name of the package (e.g. mypack.Credentials). The package should be in a sub folder of the same name as the package, and you should import the package in the main file (by specifying the path from GOPATH)."}, {"owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "edited": false, "score": 0, "creation_date": 1462217579, "post_id": 36967461, "comment_id": 61534619, "body": "done and done... works awesome... published my first package worldweatheronline-go-client"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 2, "last_activity_date": 1462126356, "last_edit_date": 1462126356, "creation_date": 1462110888, "answer_id": 36967461, "question_id": 36967419, "link": "https://stackoverflow.com/questions/36967419/can-i-create-a-struct-inside-the-package-to-use-outside-in-main-program/36967461#36967461", "title": "Can i create a struct inside the package to use outside in main program", "body": "<p>Use uppercase names for the fields. Only uppercase names are visible outside the package.</p>\n\n<pre><code>package something\n\ntype Credentials struct {\n   Key string\n   ResponseType  string\n   Subscription string\n   Locale string\n}\n\ntype WwogcParams struct {\n    Name string\n    Value  string\n}\n</code></pre>\n\n<p>In main:</p>\n\n<pre><code>package main\n\nimport (\n     \"something\"\n)\n\nfunc main() {\n    param1 := something.WwogcParams {\"q\",\"Delhi\"}\n    wwogc := []something.WwogcParams {param1}\n    credentials := something.Credentials {\n        Key: \"keykeykle\", \n        ResponseType: \"json\",\n        Subscription: \"premium\", \n        Locale: \"EN\"\n    }\n}\n</code></pre>\n\n<p>See <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\">Exported identifiers</a></p>\n"}], "owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 0, "accepted_answer_id": 36967461, "answer_count": 1, "score": 2, "last_activity_date": 1462126356, "creation_date": 1462110619, "last_edit_date": 1462117753, "question_id": 36967419, "link": "https://stackoverflow.com/questions/36967419/can-i-create-a-struct-inside-the-package-to-use-outside-in-main-program", "title": "Can i create a struct inside the package to use outside in main program", "body": "<p>I was porting my npm nodule to go package and at one place i need to do this.</p>\n\n<pre><code>type Credentials struct {\n    key string\n    responseType  string\n    subscription string\n    locale string\n}\n\ntype WwogcParams struct {\n    name string\n    value  string\n}\nfunc main() {\n    param1 := WwogcParams{\"q\",\"Delhi\"}\n    wwogc := []WwogcParams{param1}\n\n    credentials := Credentials{key: \"keykeykle\",responseType: \"json\",subscription: \"premium\",locale: \"EN\"}\n....\n}\n</code></pre>\n\n<p>The main function here is basically what the user will have to write but what I was thinking if the user can use the struct I have defined inside the package in his main() function.</p>\n\n<p>Why I can't use the structure outside its package?</p>\n"}, {"tags": ["go", "microbenchmark", "caliper"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 2, "creation_date": 1462117835, "post_id": 36966947, "comment_id": 61492824, "body": "I&#39;m not sure if this is what you&#39;re looking for. Read the section &#39;A note on compiler optimisations&#39; from this <a href=\"http://dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 140, "user_id": 6272819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86da7c203efb3f6a777080b9bbe3e863?s=128&d=identicon&r=PG&f=1", "display_name": "Elsinor", "link": "https://stackoverflow.com/users/6272819/elsinor"}, "reply_to_user": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1462138674, "post_id": 36966947, "comment_id": 61500055, "body": "@JohnSPerayil, that&#39;s exactly what I&#39;m looking for! I just wonder whether it&#39;s exhaustive (I assume it isn&#39;t), and whether it&#39;s still valid (I&#39;m not sure)."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1462159845, "post_id": 36966947, "comment_id": 61504649, "body": "It&#39;s probably valid but not exhaustive."}], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 6272819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86da7c203efb3f6a777080b9bbe3e863?s=128&d=identicon&r=PG&f=1", "display_name": "Elsinor", "link": "https://stackoverflow.com/users/6272819/elsinor"}, "edited": false, "score": 0, "creation_date": 1462138444, "post_id": 36967939, "comment_id": 61499997, "body": "Thanks, that sounds encouraging, although the link that John S Perayil has provided on his comment to my answer shows that at least some optimizations need to be fended off manually for a <code>testing.B</code> benchmark. The link is more than 2 years old though, so things may have changed by now."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 2, "last_activity_date": 1462114044, "creation_date": 1462114044, "answer_id": 36967939, "question_id": 36966947, "link": "https://stackoverflow.com/questions/36966947/do-go-testing-b-benchmarks-prevent-unwanted-optimizations/36967939#36967939", "title": "Do Go testing.B benchmarks prevent unwanted optimizations?", "body": "<p>In Java, micro benchmarks are harder to do due to how the Hotspot compiler works.  If you simply just run the same code over and over, you will often find it gets faster which throws off your averages.   To compensate, Caliper has to do some warmup runs and other tricks to try to get a stable benchmark.</p>\n\n<p>In Go, things are statically compiled.  There is no runtime Hotspot like system.  It doesn't really have to do any tricks to get a good timing.  </p>\n\n<p>The testing.B functionality should have no impact on your code's performance, so you shouldn't have to do anything special.</p>\n"}, {"comments": [{"owner": {"reputation": 140, "user_id": 6272819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86da7c203efb3f6a777080b9bbe3e863?s=128&d=identicon&r=PG&f=1", "display_name": "Elsinor", "link": "https://stackoverflow.com/users/6272819/elsinor"}, "edited": false, "score": 0, "creation_date": 1462136665, "post_id": 36968286, "comment_id": 61499413, "body": "Thank you, that&#39;s a very nice write-up and I agree with practically all of it, but I don&#39;t think it answers my question :)"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "reply_to_user": {"reputation": 140, "user_id": 6272819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86da7c203efb3f6a777080b9bbe3e863?s=128&d=identicon&r=PG&f=1", "display_name": "Elsinor", "link": "https://stackoverflow.com/users/6272819/elsinor"}, "edited": false, "score": 0, "creation_date": 1462136963, "post_id": 36968286, "comment_id": 61499519, "body": "To distill down to the root question of how to best microbenchmark in Go, the answer is &quot;use real data in a test that matches your use case.&quot; If the only question is &quot;how to avoid Java-like hotspot optimization distortions,&quot; see David&#39;s answer (which is exactly right). There aren&#39;t any in Go, so there is no problem. John&#39;s link (and the links from there) is also excellent and probably is spot on for your question."}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": false, "score": 2, "last_activity_date": 1462115950, "creation_date": 1462115950, "answer_id": 36968286, "question_id": 36966947, "link": "https://stackoverflow.com/questions/36966947/do-go-testing-b-benchmarks-prevent-unwanted-optimizations/36968286#36968286", "title": "Do Go testing.B benchmarks prevent unwanted optimizations?", "body": "<p>@David Budworth gives a lot of good info, and I agree regarding Go vs Java, but there still are many things you have to consider in microbenchmarking. Most of them boil down to \"how closely does this match your use case?\" For example, different concurrency patterns perform very differently under contention. Do you expect multiple simultaneous writers to be common? Single writer, many readers? Many readers, rare writing? Single-access? Different producers/consumers accessing different parts of the map? A scheme that performs beautifully in your benchmark may be rubbish for other use cases.</p>\n\n<p>Similarly you may discover that your scheme is or isn't very dependent on locality of reference. Some approaches perform very differently if the same values are being read over and over again (because they stay in the on-CPU caches). This is very common in microbenchmarks, but may not be very indicative of your intended use case.</p>\n\n<p>This isn't to say microbenchmarks are useless, only that they are very often <em>almost</em> useless :D \u2026\u00a0at least for arriving at general conclusions. If you're building this for a particular project, just make sure that you're testing against realistic data and patterns that match your use case (and ideally just turn this into a real benchmark for your program, rather than a \"microbenchmark\" of the data structure). If you're building this for general use, you'll need to make sure you're benchmarking against a wide range of use cases before coming to too many conclusions on whether it is substantially better.</p>\n\n<p>And if it's just educational, awesome. Learning why a particular scheme works better or worse in various situations is great experience. Just don't push your findings past your evidence.</p>\n"}, {"comments": [{"owner": {"reputation": 2410, "user_id": 1574637, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b30da618a502d63ba0ae4736799ad0ef?s=128&d=identicon&r=PG", "display_name": "Corey Scott", "link": "https://stackoverflow.com/users/1574637/corey-scott"}, "edited": false, "score": 0, "creation_date": 1563923974, "post_id": 36975497, "comment_id": 100859573, "body": "While I cannot confirm for all cases (or find release notes to explain), the above example no longer performs as the specified.  The version without the side-effect is not optimized and both versions return the same value"}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": true, "score": 4, "last_activity_date": 1462166866, "creation_date": 1462166866, "answer_id": 36975497, "question_id": 36966947, "link": "https://stackoverflow.com/questions/36966947/do-go-testing-b-benchmarks-prevent-unwanted-optimizations/36975497#36975497", "title": "Do Go testing.B benchmarks prevent unwanted optimizations?", "body": "<p>Converting my comment to an answer.</p>\n\n<blockquote>\n  <p>To be completely accurate, any benchmark should be careful to avoid\n  compiler optimisations eliminating the function under test and\n  artificially lowering the run time of the benchmark.</p>\n</blockquote>\n\n<pre><code>var result int\n\nfunc BenchmarkFibComplete(b *testing.B) {\n        var r int\n        for n := 0; n &lt; b.N; n++ {\n                // always record the result of Fib to prevent\n                // the compiler eliminating the function call.\n                r = Fib(10)\n        }\n        // always store the result to a package level variable\n        // so the compiler cannot eliminate the Benchmark itself.\n        result = r\n}\n</code></pre>\n\n<p><a href=\"http://dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go\" rel=\"nofollow\">Source</a></p>\n\n<p>The following page can also be useful.</p>\n\n<p><a href=\"https://github.com/golang/go/wiki/CompilerOptimizations\" rel=\"nofollow\">Compiler And Runtime Optimizations</a></p>\n\n<p>Another interesting read is</p>\n\n<blockquote>\n  <p>One other interesting flag is -N, which will disable the optimisation\n  pass in the compiler.</p>\n</blockquote>\n\n<p><a href=\"http://dave.cheney.net/2012/10/07/notes-on-exploring-the-compiler-flags-in-the-go-compiler-suite\" rel=\"nofollow\">Source1</a> <a href=\"https://groups.google.com/d/msg/golang-nuts/rwpP0iF1AKE/icdUURZvh98J\" rel=\"nofollow\">Source2</a></p>\n\n<p>I'm not a 100% sure but the following should disable optimisations ? Someone with more experience needs to confirm it.</p>\n\n<pre><code>go test -gcflags=-N -bench=.\n</code></pre>\n"}], "owner": {"reputation": 140, "user_id": 6272819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86da7c203efb3f6a777080b9bbe3e863?s=128&d=identicon&r=PG&f=1", "display_name": "Elsinor", "link": "https://stackoverflow.com/users/6272819/elsinor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1124, "favorite_count": 1, "accepted_answer_id": 36975497, "answer_count": 3, "score": 4, "last_activity_date": 1462166866, "creation_date": 1462107572, "last_edit_date": 1462133761, "question_id": 36966947, "link": "https://stackoverflow.com/questions/36966947/do-go-testing-b-benchmarks-prevent-unwanted-optimizations", "title": "Do Go testing.B benchmarks prevent unwanted optimizations?", "body": "<p>I've recently started learning Go and I'm trying to implement a map that can be used concurrently by multiple groutines. I want to be able to compare my implementation to a simple <code>sync.Mutex</code>-protected map, or to something like this: <a href=\"https://github.com/streamrail/concurrent-map/blob/master/concurrent_map.go\" rel=\"nofollow\">https://github.com/streamrail/concurrent-map/blob/master/concurrent_map.go</a></p>\n\n<p>From using Google Caliper, I assume that a naive approach for benchmarking would allow many unwanted optimizations to trash the actual results. Are the benchmarks that use <code>testing.B</code> employing some of the techniques to avoid that (after all both Go and Caliper are Google projects)? If yes, are they known? If not, what's the best way to microbenchmark in Go?</p>\n"}, {"tags": ["heroku", "go", "redis"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1462107685, "post_id": 36966780, "comment_id": 61489524, "body": "the error sounds like the <code>redisCli.conn</code> object got closed at some point before <code>(&quot;GET&quot;, key)</code> succeeds"}, {"owner": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1462107904, "post_id": 36966780, "comment_id": 61489591, "body": "@Plato, Yes, I understand it, I commented code where I shut it, do you know can heroku close my object?"}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1462108603, "post_id": 36966780, "comment_id": 61489830, "body": "You could try passing in high timeouts to Dial: <a href=\"https://github.com/garyburd/redigo/blob/master/redis/conn.go#L128-L146\" rel=\"nofollow noreferrer\">github.com/garyburd/redigo/blob/master/redis/conn.go#L128-L1&zwnj;&#8203;46</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462113950, "post_id": 36966780, "comment_id": 61491441, "body": "Just use a Pool instead of individual connections. There&#39;s even an example of auth during connect in the documentation."}, {"owner": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1462116691, "post_id": 36966780, "comment_id": 61492402, "body": "@JimB, I tried it, it seems that heroku closes my connection, because when I deploy my server and first 10 minutes it works, after my request will fail, first log &quot;PANIC: EOF&quot;, 2nd try to do request will show log as described above"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462123793, "post_id": 36966780, "comment_id": 61494995, "body": "So first, don&#39;t use panic to handle errors. Then either handle the error and reconnect, try setting IdleTimeout on the Pool to something less than the server&#39;s settings in your environment."}, {"owner": {"user_type": "does_not_exist", "display_name": "user827329"}, "edited": false, "score": 0, "creation_date": 1462492968, "post_id": 36966780, "comment_id": 61671184, "body": "Is there some reason for re-inventing the wheel and not using something like redigo? <a href=\"https://github.com/garyburd/redigo\" rel=\"nofollow noreferrer\">github.com/garyburd/redigo</a>"}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1471533161, "post_id": 36966780, "comment_id": 65393973, "body": "FYI i do receive this &quot;use of closed network connection&quot; with redigo, which uses pools. i have max idle connections  set at 10"}], "owner": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2713, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1462107579, "creation_date": 1462106602, "last_edit_date": 1462107579, "question_id": 36966780, "link": "https://stackoverflow.com/questions/36966780/golang-server-write-tcp-use-of-closed-network-connection", "title": "Golang server &quot;write tcp ... use of closed network connection&quot;", "body": "<p>I am beginner at Go, I had wrote small server to testing and deploy it on heroku platform. I have /logout request, which almost works, but sometimes I see something like this:</p>\n\n<pre><code>PANIC: write tcp 172.17.110.94:36641-&gt;10.11.189.195:9951: use of closed network connection\n</code></pre>\n\n<p>I don't know why it happens, and why sometimes it works perfectly.\nMy steps:</p>\n\n<p>I send 1st <strong>POST</strong> request to <strong>/token-auth</strong> with body then generate token and send as response. <br>\nAt 2nd I do <strong>/logout GET</strong> request with that token, and set token to <strong>Redis store</strong></p>\n\n<p>Here is full code of my redil_cli.go</p>\n\n<pre><code>    package store\nimport (\n    \"github.com/garyburd/redigo/redis\"\n)\n\ntype RedisCli struct {\n    conn redis.Conn\n}\n\nvar instanceRedisCli *RedisCli = nil\n\nfunc Connect() (conn *RedisCli) {\n    if instanceRedisCli == nil {\n        instanceRedisCli = new(RedisCli)\n        var err error\n        //this is works!!!\n        instanceRedisCli.conn, err = redis.Dial(\"tcp\", \"lab.redistogo.com:9951\")\n\n        if err != nil {\n            panic(err)\n        }\n\n        if _, err := instanceRedisCli.conn.Do(\"AUTH\", \"password\"); err != nil {\n            //instanceRedisCli.conn.Close()\n            panic(err)\n        }\n\n\n    }\n\n\n    return instanceRedisCli\n}\n\nfunc (redisCli *RedisCli) SetValue(key, value string, expiration ...interface{}) error {\n    _, err := redisCli.conn.Do(\"SET\", key, value)\n\n    if err == nil &amp;&amp; expiration != nil {\n        redisCli.conn.Do(\"EXPIRE\", key, expiration[0])\n    }\n    return err\n}\n\nfunc (redisCli *RedisCli) GetValue(key string) (interface{}, error) {\n    data, err := redisCli.conn.Do(\"GET\", key)\n    if err != nil{\n        panic(err)\n    }\n    return data, err\n}\n</code></pre>\n\n<p>After that my function that checks Authorization header will panic while trying to do <code>GetValue(key string)</code> method</p>\n\n<pre><code>func (redisCli *RedisCli) GetValue(key string) (interface{}, error) {\n    data, err := redisCli.conn.Do(\"GET\", key)\n    if err != nil{\n        panic(err)\n    }\n    return data, err\n}\n</code></pre>\n\n<p>Can anyone point me, what I doing wrong?</p>\n"}, {"tags": ["regex", "xml", "string", "go", "escaping"], "comments": [{"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 1, "creation_date": 1462120779, "post_id": 36966035, "comment_id": 61493922, "body": "To get an unescaped string use backticks. Example: `mystring`"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5568226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e858c27da0d1bddb5a0b11d275a6d3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kalina", "link": "https://stackoverflow.com/users/5568226/kalina"}, "edited": false, "score": 0, "creation_date": 1462102828, "post_id": 36966144, "comment_id": 61488086, "body": "Thank you very much! I already parse my xml with a different package, but I suppose I can use this to find the imgs in the description tag of the xml (which is written in html)?"}, {"owner": {"reputation": 138, "user_id": 2876966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EbFI.jpg?s=128&g=1", "display_name": "kanpinar", "link": "https://stackoverflow.com/users/2876966/kanpinar"}, "reply_to_user": {"reputation": 43, "user_id": 5568226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e858c27da0d1bddb5a0b11d275a6d3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kalina", "link": "https://stackoverflow.com/users/5568226/kalina"}, "edited": false, "score": 0, "creation_date": 1462103315, "post_id": 36966144, "comment_id": 61488228, "body": "So, what is that package ?      <a href=\"http://regexstorm.net/tester\" rel=\"nofollow noreferrer\">regexstorm.net/tester</a>  my   pattern is :  &lt;img.+?src=[\\&quot;&#39;](.+?)[\\&quot;&#39;].*?&gt;       input is :  &lt;img src=&#39;img1single.jpg&#39;&gt; &lt;img src=&quot;img2double.jpg&quot;&gt;  .Groups[1].Value gives the image addresses???"}, {"owner": {"reputation": 43, "user_id": 5568226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e858c27da0d1bddb5a0b11d275a6d3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kalina", "link": "https://stackoverflow.com/users/5568226/kalina"}, "edited": false, "score": 1, "creation_date": 1462103910, "post_id": 36966144, "comment_id": 61488380, "body": "<code>data :=[]byte(string(contents))</code>    <code>reader := bytes.NewReader(data)</code>   \t\t<code>decoder := xml.NewDecoder(reader)</code>   \t\t<code>decoder.CharsetReader = charset.NewReader</code>   \t\t<code>err = decoder.Decode(&amp;dat)</code>  I decode it like this"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1462105949, "post_id": 36966144, "comment_id": 61488947, "body": "This answer is in the wrong language, the question is about Go not C#."}, {"owner": {"reputation": 138, "user_id": 2876966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EbFI.jpg?s=128&g=1", "display_name": "kanpinar", "link": "https://stackoverflow.com/users/2876966/kanpinar"}, "edited": false, "score": 0, "creation_date": 1462107969, "post_id": 36966144, "comment_id": 61489618, "body": "Ah so, sorry,Not worked with Go before but this seems work. tryed at  <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">tour.golang.org/welcome/1</a>  package main  import ( \t&quot;fmt&quot; \t&quot;regexp&quot; )  func main() {     var myString = <code>&lt;img src=&#39;img1single.jpg&#39;&gt;&lt;img src=&quot;img2double.jpg&quot;&gt;</code>     var myRegex = regexp.MustCompile(<code>&lt;img[^&gt;]+\\bsrc=[&quot;&#39;]([^&quot;&#39;]+)[&quot;&#39;]</code>) \tvar imgTags = myRegex.FindAllStringSubmatch(myString, -1)     out := make([]string, len(imgTags))     for i := range out {         fmt.Println(imgTags[i][1])     } }"}, {"owner": {"reputation": 138, "user_id": 2876966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EbFI.jpg?s=128&g=1", "display_name": "kanpinar", "link": "https://stackoverflow.com/users/2876966/kanpinar"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1462126317, "post_id": 36966144, "comment_id": 61495889, "body": "Oh. seemed so? Sorry. Thanks goes to @OneOfOne"}], "tags": [], "owner": {"reputation": 138, "user_id": 2876966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EbFI.jpg?s=128&g=1", "display_name": "kanpinar", "link": "https://stackoverflow.com/users/2876966/kanpinar"}, "is_accepted": false, "score": -2, "last_activity_date": 1462108125, "last_edit_date": 1462108125, "creation_date": 1462102224, "answer_id": 36966144, "question_id": 36966035, "link": "https://stackoverflow.com/questions/36966035/regexp-to-find-images-in-html-golang/36966144#36966144", "title": "Regexp to find images in html (golang)", "body": "<p>Ah so, sorry,Not worked with Go before but this seems work.\ntryed at </p>\n\n<pre><code>https://tour.golang.org/welcome/1\n</code></pre>\n\n<p>.</p>\n\n<pre><code>package main\n\nimport (\n     \"fmt\"\n     \"regexp\"\n)\n\nfunc main() {\n   var myString = `&lt;img src='img1single.jpg'&gt;&lt;img src=\"img2double.jpg\"&gt;`\n   var myRegex = regexp.MustCompile(`&lt;img[^&gt;]+\\bsrc=[\"']([^\"']+)[\"']`)\n   var imgTags = myRegex.FindAllStringSubmatch(myString, -1)\n   out := make([]string, len(imgTags))\n  for i := range out {\n    fmt.Println(imgTags[i][1])\n   }\n }\n</code></pre>\n\n<p>I suggest to use htmlagility to parse any dom/xml kind a.</p>\n\n<p>Read document by;</p>\n\n<pre><code>HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();\ndoc.LoadHtml(sourceHtml); \n</code></pre>\n\n<p>Parse by Xpath definition RegX fine but group ext. issues makes job complex </p>\n\n<pre><code>doc.DocumentNode.SelectSingleNode(XPath here)      \n</code></pre>\n\n<p>or</p>\n\n<pre><code>doc.DocumentNode.SelectNodes(\"//img\")  // this should give all img tags \n</code></pre>\n\n<p>like.</p>\n\n<p>i suggest this becouse it seems rss serves some html content ;)\nSo get xml, \nparse with XMLDoc get html content that you need \nthen get all images by this.\nFor open answer.</p>\n\n<p>after comment just need regex i think ;\nmy pattern is</p>\n\n<pre><code> &lt;img.+?src=[\\\"'](.+?)[\\\"'].*?&gt;\n</code></pre>\n\n<p>for input </p>\n\n<pre><code>&lt;img src='img1single.jpg'&gt;\n&lt;img src=\"img2double.jpg\"&gt;\n</code></pre>\n\n<p>and result seems fine \nin .net you must get by foreach via</p>\n\n<pre><code>.Groups[1].Value\n</code></pre>\n\n<p>regards.</p>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 5, "last_activity_date": 1462105861, "creation_date": 1462105861, "answer_id": 36966661, "question_id": 36966035, "link": "https://stackoverflow.com/questions/36966035/regexp-to-find-images-in-html-golang/36966661#36966661", "title": "Regexp to find images in html (golang)", "body": "<p>Using a proper html parser is always better for parsing html, however a cheap / hackish regex can also work fine, here's an example:</p>\n\n<pre><code>var imgRE = regexp.MustCompile(`&lt;img[^&gt;]+\\bsrc=[\"']([^\"']+)[\"']`)\n// if your img's are properly formed with doublequotes then use this, it's more efficient.\n// var imgRE = regexp.MustCompile(`&lt;img[^&gt;]+\\bsrc=\"([^\"]+)\"`)\nfunc findImages(htm string) []string {\n    imgs := imgRE.FindAllStringSubmatch(htm, -1)\n    out := make([]string, len(imgs))\n    for i := range out {\n        out[i] = imgs[i][1]\n    }\n    return out\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/u06qpFJc2S\" rel=\"noreferrer\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 43, "user_id": 5568226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e858c27da0d1bddb5a0b11d275a6d3d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kalina", "link": "https://stackoverflow.com/users/5568226/kalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2519, "favorite_count": 0, "accepted_answer_id": 36966661, "answer_count": 2, "score": 3, "last_activity_date": 1462108125, "creation_date": 1462101485, "question_id": 36966035, "link": "https://stackoverflow.com/questions/36966035/regexp-to-find-images-in-html-golang", "title": "Regexp to find images in html (golang)", "body": "<p>I'm parsing an xml rss feed from a couple of different sources and I want to find the images in the html.</p>\n\n<p>I did some research and I found a regex that I think might work</p>\n\n<pre><code>/&lt;img[^&gt;]+src=\"?([^\"\\s]+)\"?\\s*\\/&gt;/g\n</code></pre>\n\n<p>but I have trouble using it in go. It gives me errors because I don't know how to make it search with that expression.</p>\n\n<p>I tried using it as a string, it doesn't escape properly with single or with double quotes. I tried using it just like that, bare, and it gives me an error.</p>\n\n<p>Any ideas? </p>\n"}, {"tags": ["go", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 529, "user_id": 4325278, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0TpCM.jpg?s=128&g=1", "display_name": "GIRISH RAMNANI", "link": "https://stackoverflow.com/users/4325278/girish-ramnani"}, "edited": false, "score": 0, "creation_date": 1462205127, "post_id": 36982463, "comment_id": 61528028, "body": "The problem here is the fact that the error message gets passed in the template rendered , which happens due to the chaining nature of responseWriter  . what i mean to say that first the router redirects /add/ =&gt; /add which actually writes &quot;404 not found&quot; to the writer and then correct response is written. I hope you see the error here."}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "reply_to_user": {"reputation": 529, "user_id": 4325278, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0TpCM.jpg?s=128&g=1", "display_name": "GIRISH RAMNANI", "link": "https://stackoverflow.com/users/4325278/girish-ramnani"}, "edited": false, "score": 0, "creation_date": 1462205725, "post_id": 36982463, "comment_id": 61528329, "body": "@GIRISHRAMNANI I see your point. But regardless, assume the url is <code>&#47;employee&#47;add&#47;</code>. Now, <code>id = &quot;add&quot;</code>. It will run <code>c.HTML</code> inside that if statement. Then it will check <code>employees[&quot;add&quot;]</code> and since add isnt found, ok will be false. Then you are writing code in <code>c.String(http.StatusNotFound, &quot;404 not found&quot;, nil)</code> . Try changing that line to <code>c.String(http.StatusNotFound, fmt.Sprintf(&quot;%s not found&quot;, id), nil)</code>. The router isn&#39;t generating a default 404 message, your code is doing that."}, {"owner": {"reputation": 529, "user_id": 4325278, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0TpCM.jpg?s=128&g=1", "display_name": "GIRISH RAMNANI", "link": "https://stackoverflow.com/users/4325278/girish-ramnani"}, "edited": false, "score": 0, "creation_date": 1462207366, "post_id": 36982463, "comment_id": 61529235, "body": "I have resolved the issue using the extra return but the router should have cleanly redirected the url."}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "reply_to_user": {"reputation": 529, "user_id": 4325278, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0TpCM.jpg?s=128&g=1", "display_name": "GIRISH RAMNANI", "link": "https://stackoverflow.com/users/4325278/girish-ramnani"}, "edited": false, "score": 0, "creation_date": 1462208626, "post_id": 36982463, "comment_id": 61529906, "body": "@GIRISHRAMNANI Are you saying that it is calling the handler once, emitting html, redirecting, calling the handler again and then returning a 404 ? I think that is highly unlikely."}, {"owner": {"reputation": 529, "user_id": 4325278, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0TpCM.jpg?s=128&g=1", "display_name": "GIRISH RAMNANI", "link": "https://stackoverflow.com/users/4325278/girish-ramnani"}, "edited": false, "score": 0, "creation_date": 1462211301, "post_id": 36982463, "comment_id": 61531324, "body": "No ,its calling the handler twice. thats why the problem arises."}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "reply_to_user": {"reputation": 529, "user_id": 4325278, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0TpCM.jpg?s=128&g=1", "display_name": "GIRISH RAMNANI", "link": "https://stackoverflow.com/users/4325278/girish-ramnani"}, "edited": false, "score": 0, "creation_date": 1462211405, "post_id": 36982463, "comment_id": 61531382, "body": "Sorry for pestering. But could you add a log or a print statement in the handler and confirm that ? I still think that&#39;s highly unlikely ."}], "tags": [], "owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "is_accepted": false, "score": 0, "last_activity_date": 1462195097, "last_edit_date": 1462195097, "creation_date": 1462192073, "answer_id": 36982463, "question_id": 36964847, "link": "https://stackoverflow.com/questions/36964847/go-http-template-extra-data-leaking-in-the-template/36982463#36982463", "title": "go http template extra data leaking in the template", "body": "<p>As you said, this error can easily be resolved by adding a <code>return</code> at the end of <code>if id == \"add\"</code>. </p>\n\n<p><code>c.String</code> and <code>c.HTML</code> use the same <code>Context</code> <code>c</code>. Internally they are writing to the same socket ( you can think of it as a file pointer ). Hence, if you call <code>c.String</code> and then <code>c.HTML</code> or vice versa, it will append the outputs in the order called.</p>\n\n<p>Looking at your code, I'd assume you want to add an employee when you see <code>/employee/add</code> i.e. present a html page to do that. And <code>/employee/&lt;something-other-than-add-as-id&gt;</code> which will get that and display it - in this case html to edit the employee info.</p>\n\n<p>It makes sense here to add the return after the <code>if id == \"add\"</code> since the html generated for the two scenarios is different ( they are using different templates ). Adding a separate handler purely for <code>/employee/add/</code> is another option as well.</p>\n"}], "owner": {"reputation": 529, "user_id": 4325278, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0TpCM.jpg?s=128&g=1", "display_name": "GIRISH RAMNANI", "link": "https://stackoverflow.com/users/4325278/girish-ramnani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 485, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1462195097, "creation_date": 1462092895, "question_id": 36964847, "link": "https://stackoverflow.com/questions/36964847/go-http-template-extra-data-leaking-in-the-template", "title": "go http template extra data leaking in the template", "body": "<p>I am creating a simple crud webapp using <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\">gin</a> library.I have a route setup which checks for a param <code>id</code> and if its <code>add</code> a <code>admin-employee-add.html</code> should be rendered ,else return the employee with the id if exists When i am rendering a template\nof <code>admin-employee-add.html</code> the error message of <code>404 not found</code> gets leaked into it.\nHere is a snapshot <a href=\"https://i.stack.imgur.com/DivSx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DivSx.png\" alt=\"enter image description here\"></a></p>\n\n<p>admin-employee-add.html</p>\n\n<pre><code>{{template \"pageStart.html\" .}}\n&lt;form class=\"form-horizontal admin-employee\"&gt;\n  &lt;div class=\"row form-group\"&gt;\n    &lt;label for=\"employeeNumber\" class=\"col-lg-2 control-label text-right\"&gt;Employee #&lt;/label&gt;\n    &lt;div class=\"col-lg-4\"&gt;\n      &lt;span&gt;new&lt;/span&gt;\n    &lt;/div&gt;\n    &lt;label for=\"status\" class=\"col-lg-2 control-label text-right\"&gt;Status&lt;/label&gt;\n    &lt;div class=\"col-lg-4\"&gt;\n      &lt;span&gt;new&lt;/span&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"row form-group\"&gt;\n    &lt;label for=\"firstName\" class=\"col-lg-2 control-label text-right\"&gt;Name&lt;/label&gt;\n    &lt;div class=\"col-lg-2\"&gt;\n      &lt;input type=\"text\" id=\"firstName\" name=\"firstName\" class=\"form-control\"&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-lg-2\"&gt;\n      &lt;input type=\"text\" id=\"lastName\" name=\"lastName\" class=\"form-control\"&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"row form-group\"&gt;\n    &lt;label for=\"startDate\" class=\"col-lg-2 control-label text-right\"&gt;Start Date&lt;/label&gt;\n    &lt;div class=\"col-lg-2\"&gt;\n      &lt;input type=\"date\" id=\"startDate\" name=\"startDate\" class=\"form-control\"&gt;\n    &lt;/div&gt;\n    &lt;label for=\"pto\" class=\"control-label col-lg-2 col-lg-offset-2 text-right\"&gt;PTO&lt;/label&gt;\n    &lt;div class=\"col-lg-3\"&gt;\n      &lt;input type=\"number\" id=\"pto\" name=\"pto\" class=\"form-control\"&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-lg-1\"&gt;\n      days\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"row form-group\"&gt;\n    &lt;label for=\"position\" class=\"col-lg-2 control-label text-right\"&gt;Position&lt;/label&gt;\n    &lt;div class=\"col-lg-2\"&gt;\n      &lt;select name=\"position\" id=\"position\" class=\"form-control\"&gt;\n        &lt;option value=\"CEO\"&gt;CEO&lt;/option&gt;\n        &lt;option value=\"CTO\"&gt;CTO&lt;/option&gt;\n        &lt;option value=\"COO\"&gt;COO&lt;/option&gt;\n        &lt;option value=\"WorkerBee\"&gt;Worker Bee&lt;/option&gt;\n      &lt;/select&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"col-lg-3 col-lg-offset-8\"&gt;\n    &lt;button type=\"submit\" class=\"btn btn-lg admin-primary\"&gt;Create&lt;/button&gt;\n  &lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>the route which is creating an the error</p>\n\n<pre><code>r.GET(\"/employee/:id/\", func(c *gin.Context) {\n        id := c.Param(\"id\")\n        if id == \"add\" {\n            c.HTML(http.StatusOK, \"admin-employee-add.html\", nil)\n        }\n\n        employee, ok := employees[id]\n\n        if !ok {\n            c.String(http.StatusNotFound, \"404 not found\", nil)\n        } else {\n            c.HTML(http.StatusOK, \"admin-employee-edit.html\", map[string]interface{}{\n                \"Employee\": employee,\n            })\n        }\n\n    })\n</code></pre>\n\n<p>The error seems to occur because gin is trying to redirect <code>/add</code> -> <code>/add/</code> but i am already using the <code>/add/</code> route in the browser.</p>\n\n<p>the debug logs of gin</p>\n\n<pre><code>[GIN-debug] GET    /login                    --&gt; main.registerRoutes.func2 (3 handlers)\n[GIN-debug] GET    /employee/:id/            --&gt; main.registerRoutes.func3 (3 handlers)\n[GIN-debug] GET    /employee/:id/vacation    --&gt; main.registerRoutes.func4 (3 handlers)\n[GIN-debug] GET    /admin/                   --&gt; main.registerRoutes.func5 (4 handlers)\n[GIN-debug] Listening and serving HTTP on :3000\n[GIN-debug] [WARNING] Headers were already written. Wanted to override status code 200 with\n404\n[GIN] 2016/05/01 - 14:12:13 | 404 |    1.101426ms | 127.0.0.1 |   GET     /employee/add/\n</code></pre>\n\n<p>I tried changing the route to <code>/:id</code> then the error showed. </p>\n\n<pre><code>redirecting request 301: /employee/add/ --&gt; /employee/add\n[GIN-debug] [WARNING] Headers were already written. Wanted to override status code 200 with\n404\n</code></pre>\n\n<p>NOTE : This error can be easily resolved by adding a <code>return</code> at the end of  the <code>if id == \"add\"</code>. but this pattern makes the code look less dry. This seems to be more of a <code>httprouter</code> issue. </p>\n"}, {"tags": ["go", "gomobile"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1462107123, "post_id": 36963045, "comment_id": 61489340, "body": "We need a little bit more details to go on, also update gomobile and maybe try go tip."}, {"owner": {"reputation": 95, "user_id": 1094578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a240cc6d32408ef14f407db9c69be46d?s=128&d=identicon&r=PG", "display_name": "Roger Large", "link": "https://stackoverflow.com/users/1094578/roger-large"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1462132123, "post_id": 36963045, "comment_id": 61497903, "body": "tried updating everything, didn&#39;t help.... new to go, whats go tip.  Just Googled it all i get are tips for go lol"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1462133261, "post_id": 36963045, "comment_id": 61498280, "body": "Go tip as in go from git, sorry I should have cleared that out."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1462133332, "post_id": 36963045, "comment_id": 61498298, "body": "<a href=\"https://golang.org/doc/install/source\" rel=\"nofollow noreferrer\">golang.org/doc/install/source</a>"}, {"owner": {"reputation": 95, "user_id": 1094578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a240cc6d32408ef14f407db9c69be46d?s=128&d=identicon&r=PG", "display_name": "Roger Large", "link": "https://stackoverflow.com/users/1094578/roger-large"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1464208608, "post_id": 36963045, "comment_id": 62396281, "body": "It was an error in go1.6.2 that caused it i downgraded to 1.6 and everything was fixed.  Its reported."}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 1094578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a240cc6d32408ef14f407db9c69be46d?s=128&d=identicon&r=PG", "display_name": "Roger Large", "link": "https://stackoverflow.com/users/1094578/roger-large"}, "is_accepted": false, "score": 1, "last_activity_date": 1464208651, "creation_date": 1464208651, "answer_id": 37447171, "question_id": 36963045, "link": "https://stackoverflow.com/questions/36963045/gomobile-bind-hello-error/37447171#37447171", "title": "gomobile bind hello error", "body": "<p>It was an error in go1.6.2 that caused it i downgraded to 1.6 and everything was fixed. Its reported</p>\n"}], "owner": {"reputation": 95, "user_id": 1094578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a240cc6d32408ef14f407db9c69be46d?s=128&d=identicon&r=PG", "display_name": "Roger Large", "link": "https://stackoverflow.com/users/1094578/roger-large"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1464208651, "creation_date": 1462076788, "last_edit_date": 1462131363, "question_id": 36963045, "link": "https://stackoverflow.com/questions/36963045/gomobile-bind-hello-error", "title": "gomobile bind hello error", "body": "<p>Go 1.5 and 1.6 both new installs with gvm, I'm trying to create a android binding of the basic hello world example.</p>\n\n<p>Ubuntu 14.4 long support on a old 32bit laptop i use for trying new things. After getting gomobile and gomobile init everything works. can build and install.  The android sdk is new and properly set.  I just can't find anything about the error.</p>\n\n<p>gomobile bind hello</p>\n\n<blockquote>\n  <p>gomobile: loadExportData failed go install -p=2\n  -pkgdir=/home/mrlarge/.gvm/pkgsets/go1.6/global/pkg/gomobile/pkg_android_amd64\n  -tags=\"\" -gcflags=-shared -ldflags=-shared hello failed: exit status 2</p>\n</blockquote>\n\n<h1>hello</h1>\n\n<pre><code>/home/mrlarge/.gvm/gos/go1.6/pkg/tool/linux_386/link: -shared and -buildmode=pie are incompatible\n</code></pre>\n\n<p>P.s. Sorry the top part must of got deleted, Sleepy touchpad error i suppose..</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1462088449, "post_id": 36963008, "comment_id": 61484566, "body": "The gorm docs indicate that&#39;s the correct syntax for ignoring a field: <a href=\"http://jinzhu.me/gorm/models.html#model-definition\" rel=\"nofollow noreferrer\">jinzhu.me/gorm/models.html#model-definition</a> - are you seeing otherwise?"}, {"owner": {"reputation": 2297, "user_id": 661378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/853372c681dc96b95f42adcb88b0cb3f?s=128&d=identicon&r=PG", "display_name": "qwertmax", "link": "https://stackoverflow.com/users/661378/qwertmax"}, "edited": false, "score": 1, "creation_date": 1462100469, "post_id": 36963008, "comment_id": 61487411, "body": "try to replace it via,     PasswordC string <code>sql:&quot;-&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 2489268, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/75d8e17e9af686a2edd5eed66e95b9e2?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 Koniarski", "link": "https://stackoverflow.com/users/2489268/pawe%c5%82-koniarski"}, "edited": false, "score": 19, "creation_date": 1500560827, "post_id": 36974118, "comment_id": 77401525, "body": "This is no longer correct. The <a href=\"https://github.com/jinzhu/gorm/commit/465f8ea05b5638e508d29985eed6615402a9c2eb\" rel=\"nofollow noreferrer\">code</a> has been fixed."}, {"owner": {"reputation": 308, "user_id": 1998155, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/naOHo.jpg?s=128&g=1", "display_name": "NlaakALD", "link": "https://stackoverflow.com/users/1998155/nlaakald"}, "edited": false, "score": 1, "creation_date": 1533322207, "post_id": 36974118, "comment_id": 90320201, "body": "Confirmed. Pawe\u0142 Koniarski is correct, at least as of today gorm: &quot;-&quot; does not add field to database."}], "tags": [], "owner": {"reputation": 344, "user_id": 798145, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KorfT.png?s=128&g=1", "display_name": "bobisme", "link": "https://stackoverflow.com/users/798145/bobisme"}, "is_accepted": true, "score": 18, "last_activity_date": 1462154973, "creation_date": 1462154973, "answer_id": 36974118, "question_id": 36963008, "link": "https://stackoverflow.com/questions/36963008/gorm-not-ignoring-field-with-gorm/36974118#36974118", "title": "GORM Not ignoring field with `gorm:&quot;-&quot;`", "body": "<p>The <a href=\"http://jinzhu.me/gorm/models.html#model-definition\" rel=\"noreferrer\">docs</a> say <code>gorm:\"-\"</code>, but the <a href=\"https://github.com/jinzhu/gorm/blob/021d7b33143de37b743d1cf660974e9c8d3f80ea/model_struct.go#L160\" rel=\"noreferrer\">code</a> indicates <code>sql:\"-\"</code> is the correct syntax.</p>\n\n<p>My testing verifies this.</p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11985, "favorite_count": 0, "accepted_answer_id": 36974118, "answer_count": 1, "score": 10, "last_activity_date": 1462154973, "creation_date": 1462076533, "question_id": 36963008, "link": "https://stackoverflow.com/questions/36963008/gorm-not-ignoring-field-with-gorm", "title": "GORM Not ignoring field with `gorm:&quot;-&quot;`", "body": "<p>Using Jinzhu's GORM Package which is fantastic btw, I currently have this struct:</p>\n\n<pre><code>type User struct {\n    gorm.Model\n\n    // The Users username\n    Username string `gorm:\"size:255;unique;not null\"`\n\n    // The Users email address\n    Email string `gorm:\"size:255;unique;not null\"`\n\n    // The Users hashed password\n    Password string `gorm:\"size:255;not null\"`\n\n    // The Users password confirmation (only for forms)\n    PasswordC string `gorm:\"-\"`\n\n    // The Users FULL NAME (e.g. Burt Reynolds)\n    Fullname string `gorm:\"size:255; not null\"`\n\n    // The Users Karma level\n    Karma int\n\n    // Is the user banned?\n    Banned bool\n}\n</code></pre>\n\n<p>But I also use Gorilla's <code>Schema</code> package so any form values populate the struct, but I don't want the <code>PasswordC</code> to be saved into the database because it will be plain text as the normal <code>Password</code> field gets bcrypt'd so any information on how to make <code>GORM</code> not save the <code>PasswordC</code> field.</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "edited": false, "score": 0, "creation_date": 1462074713, "post_id": 36962807, "comment_id": 61482284, "body": "So the message is meant to be retrieved from a message queue (Kestrel). We just need to keep precise enough numbers so we used big.Float. In order to keep the precision in the message queue, should we use json&#39;s string or numeric type when writing to the queue in another upstream program?"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 8, "last_activity_date": 1462074120, "creation_date": 1462074120, "answer_id": 36962807, "question_id": 36962774, "link": "https://stackoverflow.com/questions/36962774/unmarshal-json-into-golang-type-big-float/36962807#36962807", "title": "Unmarshal JSON into Golang type Big.Float", "body": "<p>It appears to me (based on the docs) that it expects the json for <code>big.Float</code> to be passed in as strings.  This play proves that to work:</p>\n\n<p><a href=\"https://play.golang.org/p/7XKn2hhXRD\">https://play.golang.org/p/7XKn2hhXRD</a></p>\n\n<p>If you cannot control the json then you can implement your own unmarshaller as an alternative.</p>\n"}], "owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1236, "favorite_count": 0, "accepted_answer_id": 36962807, "answer_count": 1, "score": 4, "last_activity_date": 1462074120, "creation_date": 1462073720, "question_id": 36962774, "link": "https://stackoverflow.com/questions/36962774/unmarshal-json-into-golang-type-big-float", "title": "Unmarshal JSON into Golang type Big.Float", "body": "<p>I have a json message that needs to be unmarshaled to a struct which has some <code>big.Float</code> fields from the <code>math</code> package. The json field is of type numeric. It gives me <code>err = json: cannot unmarshal string into Go value of type *big.Float</code>.</p>\n\n<p>I wonder why it complains \"cannot unmarshal string\" since my json field is numeric type. And what do I need to do to unmarshal the json filed to a <code>*big.Float</code> field.</p>\n\n<p>Example:</p>\n\n<pre><code>type Msg struct {  \n      Usage0   *big.Float \n      Usage1   *big.Float \n      Usage2   *big.Float       \n}\n\n// jsonMsg = {'Usage0': 31241.4543, \"Usage1\": 54354325423.65, ...}\n\nerr := json.Unmarshal(jsonMsg, &amp;msg)\n</code></pre>\n"}, {"tags": ["javascript", "user-interface", "go", "desktop-application", "electron"], "answers": [{"comments": [{"owner": {"reputation": 658, "user_id": 4142484, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/963345fb832ab53c6059c6f57858d98b?s=128&d=identicon&r=PG&f=1", "display_name": "Ashkay", "link": "https://stackoverflow.com/users/4142484/ashkay"}, "edited": false, "score": 3, "creation_date": 1462123354, "post_id": 36961340, "comment_id": 61494836, "body": "I decided to use <a href=\"https://github.com/googollee/go-socket.io\" rel=\"nofollow noreferrer\">github.com/googollee/go-socket.io</a> for the backend, and normal socket.io on the frontend. Thanks!"}], "tags": [], "owner": {"reputation": 884, "user_id": 1254991, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4b5085b7a530a7c7882b77c3dc35b0f5?s=128&d=identicon&r=PG", "display_name": "felipecamposclarke", "link": "https://stackoverflow.com/users/1254991/felipecamposclarke"}, "is_accepted": true, "score": 12, "last_activity_date": 1462058953, "creation_date": 1462058953, "answer_id": 36961340, "question_id": 36961252, "link": "https://stackoverflow.com/questions/36961252/electron-ui-for-golang-program/36961340#36961340", "title": "Electron UI for Golang Program?", "body": "<p>The interaction of an application written in electron with its backend is exactly like a Web browser, therefore you have the same options (Web Api, Web Sockets, Ajax, etc.)</p>\n"}, {"tags": [], "owner": {"reputation": 12558, "user_id": 1259938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nlW0R.jpg?s=128&g=1", "display_name": "Vadim Macagon", "link": "https://stackoverflow.com/users/1259938/vadim-macagon"}, "is_accepted": false, "score": 13, "last_activity_date": 1462082970, "creation_date": 1462082970, "answer_id": 36963647, "question_id": 36961252, "link": "https://stackoverflow.com/questions/36961252/electron-ui-for-golang-program/36963647#36963647", "title": "Electron UI for Golang Program?", "body": "<p>You can execute your command line app from your Electron app via <a href=\"https://nodejs.org/docs/latest-v5.x/api/child_process.html#child_process_child_process_spawn_command_args_options\" rel=\"noreferrer\"><code>child_process.spawn</code></a> and communicate with it via <code>stdin</code>/<code>stdout</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4893, "user_id": 899227, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WHwW6.png?s=128&g=1", "display_name": "roeland", "link": "https://stackoverflow.com/users/899227/roeland"}, "edited": false, "score": 2, "creation_date": 1487337951, "post_id": 42123096, "comment_id": 71752627, "body": "Nice project, but I don&#39;t think it is a wrapper for Electron. The mac version uses WebKit. The windows version uses EdgeHTML."}, {"owner": {"reputation": 5093, "user_id": 302005, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eDmEQ.png?s=128&g=1", "display_name": "Pioz", "link": "https://stackoverflow.com/users/302005/pioz"}, "edited": false, "score": 0, "creation_date": 1496221132, "post_id": 42123096, "comment_id": 75567157, "body": "Murlock is not a Electron wrapper. It&#39;s simply a Go package to build UI with html and css. But it looks like a very interesting project!"}], "tags": [], "owner": {"reputation": 1039, "user_id": 1212212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a83aaf801b8ec28e4f1ba3b3806091?s=128&d=identicon&r=PG", "display_name": "user1212212", "link": "https://stackoverflow.com/users/1212212/user1212212"}, "is_accepted": false, "score": 3, "last_activity_date": 1486586142, "creation_date": 1486586142, "answer_id": 42123096, "question_id": 36961252, "link": "https://stackoverflow.com/questions/36961252/electron-ui-for-golang-program/42123096#42123096", "title": "Electron UI for Golang Program?", "body": "<p><a href=\"https://github.com/murlokswarm/app\" rel=\"nofollow noreferrer\">Murlock</a>\nIs an Electron wrapper for Golang to make it easy for this kind of app for Mac. They're working on Windows and looking for contributions for the other platforms. </p>\n"}, {"tags": [], "owner": {"reputation": 287, "user_id": 4270770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff66d6ac9684b8e70a1156ec4c778b3e?s=128&d=identicon&r=PG&f=1", "display_name": "Asticode", "link": "https://stackoverflow.com/users/4270770/asticode"}, "is_accepted": false, "score": 16, "last_activity_date": 1502611317, "last_edit_date": 1502611317, "creation_date": 1493457296, "answer_id": 43693842, "question_id": 36961252, "link": "https://stackoverflow.com/questions/36961252/electron-ui-for-golang-program/43693842#43693842", "title": "Electron UI for Golang Program?", "body": "<p>You can use <a href=\"https://github.com/asticode/go-astilectron\" rel=\"noreferrer\">go-astilectron</a> it allows you to build cross-platform GUI apps with GO and HTML/JS/CSS (powered by Electron) (<em>disclosure: I'm the author</em>)</p>\n"}, {"tags": [], "owner": {"reputation": 2023, "user_id": 247904, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O6InT.png?s=128&g=1", "display_name": "zserge", "link": "https://stackoverflow.com/users/247904/zserge"}, "is_accepted": false, "score": 3, "last_activity_date": 1508867536, "creation_date": 1508867536, "answer_id": 46917003, "question_id": 36961252, "link": "https://stackoverflow.com/questions/36961252/electron-ui-for-golang-program/46917003#46917003", "title": "Electron UI for Golang Program?", "body": "<p>Similarly to Murlock, may I dare to suggest <a href=\"https://github.com/zserge/webview\" rel=\"nofollow noreferrer\">Webview</a> library. It's a thin wrapper over Webkit and MSHTML that runs on Windows 7+, MacOS, Linux and OpenBSD.</p>\n\n<p>It is much smaller and easier than Electron. Also the resulting apps are smaller and less memory-hungry.</p>\n\n<p>You may have a look at <a href=\"https://github.com/zserge/webview/tree/master/examples/todo-go\" rel=\"nofollow noreferrer\">https://github.com/zserge/webview/tree/master/examples/todo-go</a> for a Todo app example that compiles into a small standalone binary.</p>\n"}, {"comments": [{"owner": {"reputation": 696, "user_id": 1057806, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4809ff51bb5a197f0185e5b9508df4bf?s=128&d=identicon&r=PG", "display_name": "Per Svensson", "link": "https://stackoverflow.com/users/1057806/per-svensson"}, "edited": false, "score": 0, "creation_date": 1589175676, "post_id": 58381264, "comment_id": 109177641, "body": "But worth mentioning... Ultralight has a very aggressive pricing model for anything above &quot;indie&quot; developers.  &quot;While muon itself is MIT licensed, Ultralight is not.&quot;"}], "tags": [], "owner": {"reputation": 2953, "user_id": 529829, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/VSpRQ.jpg?s=128&g=1", "display_name": "Dana Woodman", "link": "https://stackoverflow.com/users/529829/dana-woodman"}, "is_accepted": false, "score": 0, "last_activity_date": 1571073006, "creation_date": 1571073006, "answer_id": 58381264, "question_id": 36961252, "link": "https://stackoverflow.com/questions/36961252/electron-ui-for-golang-program/58381264#58381264", "title": "Electron UI for Golang Program?", "body": "<p>Checkout <a href=\"https://github.com/ImVexed/muon\" rel=\"nofollow noreferrer\">muon</a> which is best described by their readme:</p>\n\n<blockquote>\n  <p>Muon is a lightweight alternative to Electron written in Golang in about ~300 LoC, using Ultralight instead of Chromium. Ultralight is a cross-platform WebKit rewrite using the GPU to target embedded desktop applications that resulted in a fast, lightweight, and low-memory HTML UI solution that blends the power of Chromium with the small footprint of Native UI.</p>\n</blockquote>\n\n<p>I have not used it myself but it looks very promising!</p>\n"}], "owner": {"reputation": 658, "user_id": 4142484, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/963345fb832ab53c6059c6f57858d98b?s=128&d=identicon&r=PG&f=1", "display_name": "Ashkay", "link": "https://stackoverflow.com/users/4142484/ashkay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21883, "favorite_count": 14, "accepted_answer_id": 36961340, "answer_count": 6, "score": 26, "last_activity_date": 1571073006, "creation_date": 1462058047, "last_edit_date": 1503781921, "question_id": 36961252, "link": "https://stackoverflow.com/questions/36961252/electron-ui-for-golang-program", "title": "Electron UI for Golang Program?", "body": "<p>I'd like to make a GUI in Electron for a Desktop Application written in Go (currently it's a command line tool).</p>\n\n<p>What's the convention for communicating between the Electron and Go processes? </p>\n\n<p>Would simply using the Go binary as an API work? Some sort of websocket communication? </p>\n"}, {"tags": ["angularjs", "go", "oauth", "jwt"], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 2, "last_activity_date": 1462055458, "creation_date": 1462055458, "answer_id": 36960954, "question_id": 36959901, "link": "https://stackoverflow.com/questions/36959901/using-jwt-in-a-angular-golang-project/36960954#36960954", "title": "Using JWT in a Angular / Golang project", "body": "<p>A JWT is composed of 3 parts: the header (for \"metadata\" like the encryption algorithm used, etc), the claimes (which are the actual data stored in the token), and an HMAC (used to verify that the two parts above aren't tampered with).</p>\n\n<p>In your case, when you user login, you should receive the oauth token, their username, etc. You can then use the username to get the associated user level, and stow everything in the claims of your own JWT that you will send back to the user. In subsequent requests, you just have to check that the token is valid (don't forget to give them a short ttl), and then you are sure that the user doing the request is the one it <em>claims</em> it is (mnemotechnic pun intended).</p>\n"}], "owner": {"reputation": 1282, "user_id": 3648229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6b730f6984c01d9409a83abacb234580?s=128&d=identicon&r=PG", "display_name": "gempir", "link": "https://stackoverflow.com/users/3648229/gempir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462055458, "creation_date": 1462048126, "question_id": 36959901, "link": "https://stackoverflow.com/questions/36959901/using-jwt-in-a-angular-golang-project", "title": "Using JWT in a Angular / Golang project", "body": "<p>I am having issues figuring out how to use JWT correctly for my project.</p>\n\n<p>This is the situation:</p>\n\n<p>I have a website where people can login via a twitch which gives me an oauth token, their username and more stuff depending on what I request.\n(this is what the authentication process looks like <a href=\"https://github.com/justintv/Twitch-API/blob/master/authentication.md\" rel=\"nofollow\">https://github.com/justintv/Twitch-API/blob/master/authentication.md</a> )</p>\n\n<p>In my database I have a few usernames that have an access level. For example level 500 meaning they can see the admin dashboard on my website or they can send POST requests from angular to change data.</p>\n\n<p>My angular app has no access to the database obviously. I only want communication via an API provided by my go webserver.</p>\n\n<p>What I am wondering is how do I make sure that the user who is trying to send a secure POST or GET is actually the user he says he is and has permission to execute the command he is doing.</p>\n"}, {"tags": ["go", "graphicsmagick", "negroni"], "answers": [{"tags": [], "owner": {"reputation": 168, "user_id": 669912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0fe6cfbfa8d57c405afac45fd420dc1?s=128&d=identicon&r=PG", "display_name": "Toby Sullivan", "link": "https://stackoverflow.com/users/669912/toby-sullivan"}, "is_accepted": false, "score": 0, "last_activity_date": 1462047665, "creation_date": 1462047665, "answer_id": 36959839, "question_id": 36959651, "link": "https://stackoverflow.com/questions/36959651/how-can-i-build-golang-app-with-tags-using-gin/36959839#36959839", "title": "How can I build golang app with tags using gin?", "body": "<p>Not an ideal solution but it appears codegangsta/gin is abandoned so support for build tags simply won't be added. Instead, Github user omeid has compiled a patch and using his <a href=\"https://github.com/omeid/gin\" rel=\"nofollow\">fork of gin</a> will allow use of build tags.</p>\n\n<pre><code>go get github.com/omeid/gin\ngin -tags gm\n</code></pre>\n"}], "owner": {"reputation": 168, "user_id": 669912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0fe6cfbfa8d57c405afac45fd420dc1?s=128&d=identicon&r=PG", "display_name": "Toby Sullivan", "link": "https://stackoverflow.com/users/669912/toby-sullivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489569767, "creation_date": 1462046693, "last_edit_date": 1489569767, "question_id": 36959651, "link": "https://stackoverflow.com/questions/36959651/how-can-i-build-golang-app-with-tags-using-gin", "title": "How can I build golang app with tags using gin?", "body": "<p>A critical component of my golang app uses the ported <a href=\"https://github.com/rainycape/magick\" rel=\"nofollow\">GraphicsMagick library</a> which requires building the library with <code>-tags gm</code>. </p>\n\n<p>For example:</p>\n\n<p><code>go build -tags gm</code></p>\n\n<p>However, I'm building the web service based on the <a href=\"https://github.com/codegangsta/negroni\" rel=\"nofollow\">negroni framework</a> and running it with <a href=\"https://github.com/codegangsta/gin\" rel=\"nofollow\">gin</a> which allows me to run the app with the command <code>gin</code>. I cannot find any way of passing build tags to gin. Any suggestions?</p>\n"}, {"tags": ["shell", "parsing", "go", "quotes"], "answers": [{"tags": [], "owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "is_accepted": true, "score": 6, "last_activity_date": 1462049341, "creation_date": 1462049341, "answer_id": 36960092, "question_id": 36958515, "link": "https://stackoverflow.com/questions/36958515/pythons-shlex-split-alternative-for-go/36960092#36960092", "title": "python&#39;s shlex.split alternative for Go", "body": "<p>Nothing in the standard library, but Google did publish their own <a href=\"https://github.com/google/shlex\" rel=\"noreferrer\">shlex</a> library which has been forked and changed some in <a href=\"https://github.com/flynn-archive/go-shlex\" rel=\"noreferrer\">flynn-archive/go-shlex</a>.</p>\n\n<p>For example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/google/shlex\"\n)\n\nfunc main() {\n    input := \"abc ab\\\\ c  \\\"ab\\\\\\\"cd\\\" key=\\\"\\\\\\\"val\\\\\\\"\\\"\"\n    fmt.Println(\"Processing:\", input)\n    tokens, _ := shlex.Split(input)\n    fmt.Printf(\"%#v\\n\", tokens)\n    // []string{\"abc\", \"ab c\", \"ab\\\"cd\", \"key=\\\"val\\\"\"}\n}\n</code></pre>\n"}], "owner": {"reputation": 9790, "user_id": 544721, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/690b6f4d543b41e22e795a42ca67dfc2?s=128&d=identicon&r=PG", "display_name": "Grzegorz Wierzowiecki", "link": "https://stackoverflow.com/users/544721/grzegorz-wierzowiecki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 0, "accepted_answer_id": 36960092, "answer_count": 1, "score": 3, "last_activity_date": 1462049341, "creation_date": 1462040357, "question_id": 36958515, "link": "https://stackoverflow.com/questions/36958515/pythons-shlex-split-alternative-for-go", "title": "python&#39;s shlex.split alternative for Go", "body": "<p>Simple question - is there something like python's shlex.split that would allow me to simply parse/split/quote/escape shell-like quoted/backslashed strings ?</p>\n\n<p>Link to shlex docs:\n<a href=\"http://docs.python.org/3.4/library/shlex.html\" rel=\"nofollow\">http://docs.python.org/3.4/library/shlex.html</a></p>\n\n<p>Example of what shlex.split does:</p>\n\n<pre><code>&gt;&gt;&gt; import shlex\n&gt;&gt;&gt; shlex.split('abc ab\\\\ c  \"ab\\\\\"cd\" key=\"\\\\\"val\\\\\"\"')\n['abc', 'ab c', 'ab\"cd', 'key=\"val\"']\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 5492, "user_id": 6083675, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/D2CgS.png?s=128&g=1", "display_name": "Laurel", "link": "https://stackoverflow.com/users/6083675/laurel"}, "edited": false, "score": 0, "creation_date": 1462037870, "post_id": 36957525, "comment_id": 61473806, "body": "Can you make the JS one into a StackSnippet with sample input output?"}], "answers": [{"comments": [{"owner": {"reputation": 50646, "user_id": 99923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/211755e2897f699737d63f5e2ecf5b07?s=128&d=identicon&r=PG", "display_name": "Xeoncross", "link": "https://stackoverflow.com/users/99923/xeoncross"}, "edited": false, "score": 0, "creation_date": 1526675755, "post_id": 36958185, "comment_id": 87853317, "body": "Rather than a regular expression, why not simply <a href=\"https://play.golang.org/p/LMKcZqiOxWG\" rel=\"nofollow noreferrer\">remove the windows return</a>? <code>strNormalized := strings.Replace(str, &quot;\\r&quot;, &quot;&quot;, -1)</code>"}], "tags": [], "owner": {"reputation": 1809, "user_id": 638217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4685d20d4efcbbcf604c73be727f230f?s=128&d=identicon&r=PG", "display_name": "Andreas Koch", "link": "https://stackoverflow.com/users/638217/andreas-koch"}, "is_accepted": true, "score": 2, "last_activity_date": 1462038834, "last_edit_date": 1462038834, "creation_date": 1462038417, "answer_id": 36958185, "question_id": 36957525, "link": "https://stackoverflow.com/questions/36957525/golang-split-string-by-empty-newline/36958185#36958185", "title": "Golang split string by empty newline", "body": "<p>Your seperator RegEx does not match because you split a complete string and the beginning of that string is not white-space. So instead of <code>^\\s*\\n</code> you must use <code>\\n\\s*\\n</code>:</p>\n\n<pre><code>func splitByEmptyNewline(str string) []string {\n    strNormalized := regexp.\n        MustCompile(\"\\r\\n\").\n        ReplaceAllString(str, \"\\n\")\n\n    return regexp.\n        MustCompile(`\\n\\s*\\n`).\n        Split(strNormalized, -1)\n\n}\n</code></pre>\n\n<p>Here here is working example: <a href=\"https://play.golang.org/p/be6Mf3-XNP\" rel=\"nofollow\">https://play.golang.org/p/be6Mf3-XNP</a></p>\n"}], "owner": {"reputation": 6558, "user_id": 93222, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/1e206e741f51c787b0fd29550fab8d98?s=128&d=identicon&r=PG", "display_name": "Mickel", "link": "https://stackoverflow.com/users/93222/mickel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 0, "accepted_answer_id": 36958185, "answer_count": 1, "score": 1, "last_activity_date": 1462038834, "creation_date": 1462034575, "question_id": 36957525, "link": "https://stackoverflow.com/questions/36957525/golang-split-string-by-empty-newline", "title": "Golang split string by empty newline", "body": "<p>I have this JS function that I'm trying to translate to Go:</p>\n\n<pre><code>function splitByEmptyNewline(str) {\n  return str\n    .replace(/\\r\\n/g, '\\n')\n    .split(/^\\s*\\n/gm);\n}\n</code></pre>\n\n<p>Here's what I got so far:</p>\n\n<pre><code>func splitByEmptyNewline(str string) []string {\n    strNormalized := regexp.\n        MustCompile(\"\\r\\n\").\n        ReplaceAllString(str, \"\\n\")\n    return regexp.\n        MustCompile(\"^s*\\n\").\n        Split(strNormalized, -1)\n}\n</code></pre>\n\n<p>This does not return the same result as the JavaScript version. So I'm wondering what I've missed?</p>\n\n<p>I've tried using both double-quotes <strong>\"</strong> and backward single-quotes <strong>`</strong> for the regex.</p>\n"}, {"tags": ["go", "xml-parsing"], "answers": [{"comments": [{"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1462029740, "post_id": 36956614, "comment_id": 61470927, "body": "Thanks for the quick answer. The issue here is that I need to be able to unmarshal from either JSON or XML. In JSON, the format is <code>{&quot;fieldA&quot;: &quot;apple&quot;, &quot;fieldB&quot;: &quot;banana&quot;}</code>. Logically, the value belongs to the parent, not a child, so I don&#39;t have the freedom to introduce a wrapper."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1462030186, "post_id": 36956614, "comment_id": 61471091, "body": "@ScottDeerwester You didn&#39;t mention anything related to json in your question. If you want to handle both XML and JSON with one struct, then use the element content to hold the value, not its attribute."}, {"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1462030424, "post_id": 36956614, "comment_id": 61471165, "body": "I apologize, the reason for not mentioning JSON was brevity. I really don&#39;t have the freedom to change either the struct definition or the XML format. The latter is from <a href=\"http://hl7-fhir.github.io/\" rel=\"nofollow noreferrer\">the FHIR standard</a> and the former from <a href=\"https://github.com/intervention-engine/fhir\" rel=\"nofollow noreferrer\">the Go version of the standard</a>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1462030609, "post_id": 36956614, "comment_id": 61471242, "body": "If you can&#39;t change the XML neither the JSON, you can&#39;t do this with one struct unless you implement custom marshalling and unmarshalling."}, {"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1462030753, "post_id": 36956614, "comment_id": 61471298, "body": "I was afraid of that. I wonder if I could build a custom XML unmarshaller/marshaller  to recognize the &quot;value&quot; attribute for <i>everything</i>, instead of on an item-by-item basis?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1462033693, "post_id": 36956614, "comment_id": 61472269, "body": "@ScottDeerwester check my answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1462030555, "last_edit_date": 1462030555, "creation_date": 1462029444, "answer_id": 36956614, "question_id": 36956397, "link": "https://stackoverflow.com/questions/36956397/unmarshaling-tag-value-val-to-tag-string-in-go/36956614#36956614", "title": "Unmarshaling &lt;tag value=&quot;val&quot;/&gt; to Tag string in Go", "body": "<p>You can't use the form of <code>fieldA&gt;value</code> because elements of this \"path\" denote elements and <code>value</code> is not an element in your case.</p>\n\n<p>If you want to get a value out from an attribute of a child element, you can create a wrapper type for it.</p>\n\n<p>For example:</p>\n\n<pre><code>type Field struct {\n    Value string `xml:\"value,attr\"`\n}\n</code></pre>\n\n<p>Using this your <code>MyType</code> struct:</p>\n\n<pre><code>type MyType struct {\n    FieldA Field `xml:\"fieldA\"`\n    FieldB Field `xml:\"fieldB\"`\n    FieldC Field `xml:\"fieldC\"`\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>func main() {\n    mt := MyType{}\n    if err := xml.Unmarshal([]byte(src), &amp;mt); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%+v\\n\", mt)\n}\n\nconst src = `&lt;obj&gt;\n    &lt;fieldA value=\"apple\"/&gt;\n    &lt;fieldB value=\"banana\"/&gt;\n&lt;/obj&gt;`\n</code></pre>\n\n<p>Output (try it on the <kbd><a href=\"https://play.golang.org/p/Rmw-DW3aiV\" rel=\"nofollow\">Go Playground</a></kbd>):</p>\n\n<pre><code>{FieldA:{Value:apple} FieldB:{Value:banana} FieldC:{Value:}}\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>If you want to handle both XML and JSON with one struct, in the XML you should use the content of the element to hold the data (and not the <code>value</code> attribute), for example:</p>\n\n<pre><code>&lt;obj&gt;\n    &lt;fieldA&gt;apple&lt;/fieldA&gt;\n    &lt;fieldB&gt;banana&lt;/fieldB&gt;\n&lt;/obj&gt;\n</code></pre>\n\n<p>And the struct to model this:</p>\n\n<pre><code>type MyType struct {\n    FieldA string `xml:\"fieldA\"`\n    FieldB string `xml:\"fieldB\"`\n    FieldC string `xml:\"fieldC\"`\n}\n</code></pre>\n\n<p>This same struct can unmarshal from JSON:</p>\n\n<pre><code>const src2 = `{\"fieldA\": \"apple\", \"fieldB\": \"banana\"}`\n\nmt = MyType{}\nif err := json.Unmarshal([]byte(src2), &amp;mt); err != nil {\n    panic(err)\n}\nfmt.Printf(\"%+v\\n\", mt)\n</code></pre>\n\n<p>Output: the same:</p>\n\n<pre><code>{FieldA:apple FieldB:banana FieldC:}\n{FieldA:apple FieldB:banana FieldC:}\n</code></pre>\n\n<p>Try this variant (with JSON) on the <kbd><a href=\"https://play.golang.org/p/2GcFLdmEs_\" rel=\"nofollow\">Go Playground</a></kbd>.</p>\n"}, {"tags": [], "owner": {"reputation": 1809, "user_id": 638217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4685d20d4efcbbcf604c73be727f230f?s=128&d=identicon&r=PG", "display_name": "Andreas Koch", "link": "https://stackoverflow.com/users/638217/andreas-koch"}, "is_accepted": false, "score": 0, "last_activity_date": 1462029916, "creation_date": 1462029916, "answer_id": 36956695, "question_id": 36956397, "link": "https://stackoverflow.com/questions/36956397/unmarshaling-tag-value-val-to-tag-string-in-go/36956695#36956695", "title": "Unmarshaling &lt;tag value=&quot;val&quot;/&gt; to Tag string in Go", "body": "<p>You could do it by introducing a <code>Field</code> struct that has a Value member:</p>\n\n<pre><code>type MyType struct {\n    FieldA Field `xml:\"fieldA\"`\n    FieldB Field `xml:\"fieldB\"`\n    FIeldC Field `xml:\"fieldC\"`\n}\n\ntype Field struct {\n    Value string `xml:\"value,attr\"`\n}\n</code></pre>\n\n<p>This should do the trick. Here is full example:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"strings\"\n)\n\ntype MyType struct {\n    FieldA Field `xml:\"fieldA\"`\n    FieldB Field `xml:\"fieldB\"`\n    FieldC Field `xml:\"fieldC\"`\n}\n\ntype Field struct {\n    Value string `xml:\"value,attr\"`\n}\n\nfunc deserializeMyType(reader io.Reader) (MyType, error) {\n    myType := MyType{}\n    decoder := xml.NewDecoder(reader)\n    err := decoder.Decode(&amp;myType)\n    if err != nil {\n        return MyType{}, err\n    }\n\n    return myType, nil\n}\n\nfunc main() {\n    inputXML := `&lt;obj&gt;\n    &lt;fieldA value=\"apple\"/&gt;\n    &lt;fieldB value=\"banana\"/&gt;\n&lt;/obj&gt;`\n\n    xmlReader := strings.NewReader(inputXML)\n    myType, err := deserializeMyType(xmlReader)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"%s\", err.Error())\n        os.Exit(1)\n    }\n\n    fmt.Fprintf(os.Stdout, \"%#v\\n\", myType)\n}\n</code></pre>\n\n<p>The output for your sample XML would be this:</p>\n\n<pre><code>main.MyType{FieldA:main.Field{Value:\"apple\"}, FieldB:main.Field{Value:\"banana\"}, FieldC:main.Field{Value:\"\"}}\n</code></pre>\n\n<p>You can find other examples for derserializing XML attributes in the go sources at <a href=\"https://golang.org/src/encoding/xml/example_test.go\" rel=\"nofollow\">golang.org/src/encoding/xml/example_test.go</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 1, "creation_date": 1462033824, "post_id": 36957250, "comment_id": 61472319, "body": "This is a great compromise between changing only the <i>name</i> of the types of the struct elements, while still being able to handle the weirdness of the XML. I&#39;ll play with it further. Thanks!"}, {"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1462036228, "post_id": 36957250, "comment_id": 61473182, "body": "I&#39;ve implemented your solution in the actual code. The only wrinkle is that you can&#39;t return a Field value from a function requiring a string, but that&#39;s a minor problem. In the actual code, I&#39;m using StringField, BooleanField, etc. This is really an elegant solution, thank you."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1462036490, "post_id": 36957250, "comment_id": 61473276, "body": "@ScottDeerwester glad to help! and also yes you can, just convert it to a string: <code>func getStr(f Field) string { return string(f) }</code>. it is an alias for a string after all."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1462033873, "last_edit_date": 1462033873, "creation_date": 1462033032, "answer_id": 36957250, "question_id": 36956397, "link": "https://stackoverflow.com/questions/36956397/unmarshaling-tag-value-val-to-tag-string-in-go/36957250#36957250", "title": "Unmarshaling &lt;tag value=&quot;val&quot;/&gt; to Tag string in Go", "body": "<p>To support both XML and JSON, you will have to define a simple type and implement the <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshaler\" rel=\"nofollow\"><code>xml.Unmarshaler</code></a> and <a href=\"https://golang.org/pkg/encoding/xml/#Marshaler\" rel=\"nofollow\"><code>xml.Marshaler</code></a> interfaces on it, here's an example:</p>\n\n<pre><code>type Field string\n\nfunc (f Field) MarshalXML(e *xml.Encoder, start xml.StartElement) error {\n    v := struct {\n        Value string `xml:\"value,attr\"`\n    }{string(f)}\n    return e.EncodeElement(v, start)\n}\n\nfunc (f *Field) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    var v struct {\n        Value string `xml:\"value,attr\"`\n    }\n    err := d.DecodeElement(&amp;v, &amp;start)\n    *f = Field(v.Value)\n    return err\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/b7zm6I0DT0\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 36957250, "answer_count": 3, "score": 1, "last_activity_date": 1462033873, "creation_date": 1462028188, "last_edit_date": 1462029013, "question_id": 36956397, "link": "https://stackoverflow.com/questions/36956397/unmarshaling-tag-value-val-to-tag-string-in-go", "title": "Unmarshaling &lt;tag value=&quot;val&quot;/&gt; to Tag string in Go", "body": "<p>Say that I've got a Go struct defined as follows:</p>\n\n<pre><code>type MyType struct {\n    FieldA string\n    FieldB string\n    FIeldC string\n}\n</code></pre>\n\n<p>and XML that corresponds to it that looks like this:</p>\n\n<pre><code>&lt;obj&gt;\n    &lt;fieldA value=\"apple\"/&gt;\n    &lt;fieldB value=\"banana\"/&gt;\n&lt;/obj&gt;\n</code></pre>\n\n<p>where FieldA and FieldB are mandatory, and FieldC is optional. How do I specify the struct tags so as to get the field's value from the \"value\" attribute? This:</p>\n\n<pre><code>FieldA string `xml:\"fieldA&gt;value,attr\"`\nFieldB string `xml:\"fieldB&gt;value,attr\"`\nFieldC string `xml:\"fieldC&gt;value,attr,omitempty\"`\n</code></pre>\n\n<p>generates \"xml: fieldA>value chain not valid with attr flag\" and this:</p>\n\n<pre><code>FieldA string `xml:\"fieldA\"`\nFieldB string `xml:\"fieldB\"`\nFieldC string `xml:\"fieldC,omitempty\"`\n</code></pre>\n\n<p>doesn't generate an error, but doesn't find the values of the fields.</p>\n"}, {"tags": ["go", "linker", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462068682, "post_id": 36954362, "comment_id": 61481403, "body": "Where are you getting these &quot;prepared <code>.o</code> files&quot; to build into a static library? See <a href=\"https://github.com/golang/go/issues/11058\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/11058</a> for the details of the Windows issue."}, {"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462078914, "post_id": 36954362, "comment_id": 61482943, "body": "@JimB the .o files are coming from the Go itself when it calls cgo. You can run an example code with <code>-x</code> argument so it will show you everything it is doing under the hood and then you can break that flow down to manual execution by calling <code>go tool [tool] [arguments]</code> and calling <code>gcc [arguments]</code> because this is what Go with CGo code does."}, {"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462078986, "post_id": 36954362, "comment_id": 61482963, "body": "@JimB Also if you look at the issue you linked it is still open, means it was not resolved. However as I write in my own answer I had to build latest master branch of Go code to be able to compile everything successfully."}], "answers": [{"tags": [], "owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "is_accepted": false, "score": 0, "last_activity_date": 1462078566, "creation_date": 1462078566, "answer_id": 36963205, "question_id": 36954362, "link": "https://stackoverflow.com/questions/36954362/go-code-building-linker-error-can-i-link-manually/36963205#36963205", "title": "Go code building linker error. Can I link manually?", "body": "<p>Looks like gcc on windows is unable to automatically discover necessary shared libraries. The problem was caused by GCC and not by Go.</p>\n\n<p>Although for compiling Go I had to use self-compiled master tip as current release (1.6.2) does not support shared/static libraries on windows/amd64.</p>\n\n<p>Manually feeding gcc with each shared library (ntdll, winmm etc) in default location (C:\\Windows\\SysWOW64) has fixed the problem.</p>\n"}], "owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462078566, "creation_date": 1462016022, "last_edit_date": 1462016087, "question_id": 36954362, "link": "https://stackoverflow.com/questions/36954362/go-code-building-linker-error-can-i-link-manually", "title": "Go code building linker error. Can I link manually?", "body": "<p>I am building Go code that uses CGo heavily and this code <strong>must</strong> be compiled into a shared or static library (static is highly preferred). (<a href=\"https://github.com/akamensky/cgo-example\" rel=\"nofollow\">code for reference</a>)</p>\n\n<p>It all works just fine on Linux and Mac, but on Windows it fails on linker stage either saying that all 4 modes (c-shared, shared, c-archive, archive) are not available or if invoke <code>go tool link -shared</code> manually complains about missing windows specific instructions.</p>\n\n<p>My understanding is that all I need to build usable <em>lib.a</em> is to compile everything I will use into object files (*.o) and then put it through <code>ar</code> to produce usable static library.</p>\n\n<p>Now the question is whether I can completely skip Go's linker and based on prepared <code>.o</code> files create <code>.a</code> manually?</p>\n\n<p>How would I go about doing that if that is even possible?</p>\n"}, {"tags": ["reflection", "go"], "answers": [{"tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 5, "last_activity_date": 1462011786, "creation_date": 1462011786, "answer_id": 36953687, "question_id": 36953337, "link": "https://stackoverflow.com/questions/36953337/string-method-of-reflect-value-does-not-work-as-expected/36953687#36953687", "title": "String method of reflect.Value does not work as expected", "body": "<p>The <a href=\"https://golang.org/pkg/reflect/#Value.String\">documentation for Value.String</a> explains the behavior:</p>\n\n<blockquote>\n  <p>Unlike the other getters, it does not panic if v's Kind is not String.\n  Instead, it returns a string of the form \"&lt;T value>\" where T is v's\n  type.</p>\n</blockquote>\n\n<p>String is just an implementation of the fmt.Stringer interface.</p>\n\n<p>If you want the value itself, you can use the <a href=\"https://golang.org/pkg/reflect/#Value.Interface\">Interface function</a> on reflect.Value and then do a type assertion to get the string. Example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc dump(args *[]interface{}) {\n    value := reflect.ValueOf(*args).Index(0)\n    str := value.Interface().(string)\n    fmt.Println(str)\n    if str != \"okok\" {\n        fmt.Println(\"miss\")\n    }\n}\n\nfunc main() {\n    var args []interface{}\n    args = append(args, \"okok\")\n    dump(&amp;args)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/vVlD5H26iD\">Playground link</a></p>\n"}], "owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 36953687, "answer_count": 1, "score": 1, "last_activity_date": 1462011786, "creation_date": 1462009819, "question_id": 36953337, "link": "https://stackoverflow.com/questions/36953337/string-method-of-reflect-value-does-not-work-as-expected", "title": "String method of reflect.Value does not work as expected", "body": "<p>I'm trying to retrieve the string value from a reflect.Value,</p>\n\n<p>I expect <code>value.String()</code> to be <code>okok</code> but I got <code>&lt;interface {} Value&gt;</code> instead.</p>\n\n<p>Did I miss something?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc dump(args *[]interface{}) {\n    value := reflect.ValueOf(*args).Index(0)\n    fmt.Println(value.String())\n    if value.String() != \"okok\" {\n        fmt.Println(\"miss\")\n    }\n}\n\nfunc main () {\n    var args []interface{}\n    args = append(args, \"okok\")\n    dump(&amp;args)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1462018980, "post_id": 36952177, "comment_id": 61467420, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/ms686219(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms686219(v=vs.85).aspx</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1462026487, "post_id": 36952177, "comment_id": 61469763, "body": "@oneofone : Thanks, it works."}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1462026617, "creation_date": 1462026617, "answer_id": 36956109, "question_id": 36952177, "link": "https://stackoverflow.com/questions/36952177/how-to-change-application-priority-programmatically-in-golang-for-windows/36956109#36956109", "title": "How to change Application Priority Programmatically in Golang for windows?", "body": "<p>The equivalent for windows is <a href=\"https://msdn.microsoft.com/en-us/library/ms686219(v=vs.85).aspx\" rel=\"nofollow\"><code>SetPriorityClass</code></a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "accepted_answer_id": 36956109, "answer_count": 1, "score": 0, "last_activity_date": 1462026617, "creation_date": 1462001772, "question_id": 36952177, "link": "https://stackoverflow.com/questions/36952177/how-to-change-application-priority-programmatically-in-golang-for-windows", "title": "How to change Application Priority Programmatically in Golang for windows?", "body": "<p>I have CPU intensive task and I want system and user programs have higher priority so my Golang application run only when the system is idle, or better using free CPU cores.</p>\n\n<p>Like syscall.Setpriority(which int, who int, prio int) (err error)<br>\nBut this just works on Linux not windows.<br>\nThanks in Advance</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 157, "user_id": 5797797, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e4219600a63c627e5a24ea188802cf2?s=128&d=identicon&r=PG&f=1", "display_name": "J.soo", "link": "https://stackoverflow.com/users/5797797/j-soo"}, "edited": false, "score": 0, "creation_date": 1462277728, "post_id": 36954943, "comment_id": 61560177, "body": "@J.soo if my answer helped, you can select it by clicking the checkmark :)"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 0, "last_activity_date": 1462019266, "creation_date": 1462019266, "answer_id": 36954943, "question_id": 36951986, "link": "https://stackoverflow.com/questions/36951986/how-to-get-json-strings-in-a-structure-from-json-docs-using-by-unmarshal-in-gola/36954943#36954943", "title": "How to get json strings in a structure from json docs using by Unmarshal in golang", "body": "<p>You need to use <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow\"><code>json.RawMessage</code></a> instead of <code>[]string</code>, example:</p>\n\n<pre><code>type ClassRoom struct {\n    Student struct {\n        Name string\n        Address json.RawMessage `json:\"address\"` //here, Want to get json string\n        Age     int             `json:\"age\"`\n    } `json:\"student\"`\n    ClassCode int `json:\"code\"`\n}\n\nfunc main() {\n    jsonDocs := `[{\"student\":{\"name\":\"jss\",\"address\":{\"City\":\"Seoul\",\"Zip\":54},\"Age\":28},\"ClassCode\":1234}]`\n    var node []ClassRoom\n\n    json.Unmarshal([]byte(jsonDocs), &amp;node)\n    fmt.Printf(\"%s\\n\", node[0].Student.Address)\n\n    var addr struct {\n        City string\n        Zip  int\n    }\n    json.Unmarshal(node[0].Student.Address, &amp;addr)\n    fmt.Printf(\"%+v\", addr)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/dppU5Y-7Bw\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 157, "user_id": 5797797, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e4219600a63c627e5a24ea188802cf2?s=128&d=identicon&r=PG&f=1", "display_name": "J.soo", "link": "https://stackoverflow.com/users/5797797/j-soo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462188646, "creation_date": 1462000534, "last_edit_date": 1462188646, "question_id": 36951986, "link": "https://stackoverflow.com/questions/36951986/how-to-get-json-strings-in-a-structure-from-json-docs-using-by-unmarshal-in-gola", "title": "How to get json strings in a structure from json docs using by Unmarshal in golang", "body": "<p>The sample code</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype ClassRoom struct {\n    Student struct {\n        Name string\n        /*\n           Address struct {\n               City string\n               Zip  int\n           } `json:\"address\"`\n        */\n        Address []string `json:\"address\"` //here, Want to get json string\n        Age     int      `json:\"age\"`\n    } `json:\"student\"`\n    ClassCode int `json:\"code\"`\n}\n\nfunc main() {\n    jsonDocs := `[\n    {\"student\":{\"name\":\"jss\",\"address\":{\"City\":\"Seoul\",\"Zip\":54},\"Age\":28},\"ClassCode\":1234}]`\n\n    var node []ClassRoom\n\n    json.Unmarshal([]byte(jsonDocs), &amp;node)\n    fmt.Println(node)\n}\n</code></pre>\n\n<p>I want Address variable of json string type (like <code>{\"City\":\"Seoul\"....}</code>). </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1809, "user_id": 638217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4685d20d4efcbbcf604c73be727f230f?s=128&d=identicon&r=PG", "display_name": "Andreas Koch", "link": "https://stackoverflow.com/users/638217/andreas-koch"}, "is_accepted": false, "score": 2, "last_activity_date": 1462028022, "creation_date": 1462028022, "answer_id": 36956369, "question_id": 36951855, "link": "https://stackoverflow.com/questions/36951855/is-it-possible-to-reload-html-templates-after-app-is-started/36956369#36956369", "title": "Is it possible to reload html templates after app is started?", "body": "<p>Yes, it is possible to reload (html or text) templates at runtime.</p>\n\n<p>As long as the folder that you are reading the templates from is accessible by the application you can simply repeat the template parsing.</p>\n\n<p>You could do something like this:</p>\n\n<pre><code>var templates = template.New(\"Template\")\n\nfunc folderChanged(folder string) bool {\n    // todo: implement filesystem watcher here\n    return true\n}\n\nfunc ReloadTemplates(templateFolder string) {\n\n    newTemplates, err := LoadTemplates(templateFolder)\n    if err != nil {\n        log.Println(\"Unable to load templates: %s\", err)\n        return\n    }\n\n    // override existing templates variable\n    templates = newTemplates\n}\n\nfunc LoadTemplates(folder string) (*template.Template, error) {\n    template := template.New(\"Template\")\n\n    walkError := filepath.Walk(folder, func(path string, info os.FileInfo, err error) error {\n        if strings.HasSuffix(path, \".html\") {\n            _, parseError := template.ParseFiles(path)\n            if parseError != nil {\n                return parseError\n            }\n\n        }\n\n        return nil\n\n    })\n\n    return template, walkError\n}\n\nfunc Render(w http.ResponseWriter, tmplName string, data interface{}) {\n    templateFolder := \"view\"\n    if folderChanged(templateFolder) {\n        ReloadTemplates(templateFolder)\n    }\n\n    if err := templates.ExecuteTemplate(w, tmplName, data); err != nil {\n        log.Println(err)\n    }\n\n}\n</code></pre>\n\n<p>If you are using a relative path like the <code>./view</code>-folder from your example it will only work if the directory from which you are executing the application has such a sub-folder. If that is not the case I would suggest using a path relative to the users' home directory or something like that.</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 6571532, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5Frbw.jpg?s=128&g=1", "display_name": "benjaminben", "link": "https://stackoverflow.com/users/6571532/benjaminben"}, "edited": false, "score": 0, "creation_date": 1484853372, "post_id": 36956654, "comment_id": 70692115, "body": "resolved my issue, no longer have to restart my app between template edits - thank you!"}], "tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": false, "score": 9, "last_activity_date": 1462032691, "last_edit_date": 1462032691, "creation_date": 1462029698, "answer_id": 36956654, "question_id": 36951855, "link": "https://stackoverflow.com/questions/36951855/is-it-possible-to-reload-html-templates-after-app-is-started/36956654#36956654", "title": "Is it possible to reload html templates after app is started?", "body": "<p>It is completly OK to reload your templates on every request when developing / in debug mode.</p>\n\n<p>You can define an interface and two \"template executors\" like so</p>\n\n<pre><code>type TemplateExecutor interface{\n    ExecuteTemplate(wr io.Writer, name string, data interface{}) error\n}\n\ntype DebugTemplateExecutor struct  {\n    Glob string\n}\n\nfunc (e DebugTemplateExecutor) ExecuteTemplate(wr io.Writer, name string, data interface{}) error {\n    t := template.Must(template.ParseGlob(e.Glob))\n    return t.ExecuteTemplate(wr, name, data)\n}\n\ntype ReleaseTemplateExecutor struct  {\n    Template *template.Template\n}\n\nfunc (e ReleaseTemplateExecutor) ExecuteTemplate(wr io.Writer, name string, data interface{}) error {\n    return e.Template.ExecuteTemplate(wr, name, data)\n}\n</code></pre>\n\n<p>that wrap template.Execute(). Pick which one you want at runtime e.g.</p>\n\n<pre><code>const templateGlob = \"templates/*.html\"\nconst debug = true\n\nvar executor TemplateExecutor\n\nfunc main() {\n    if debug {\n        executor = DebugTemplateExecutor{templateGlob}\n\n    } else {\n        executor = ReleaseTemplateExecutor{\n            template.Must(template.ParseGlob(templateGlob)),\n        }\n    }\n\n    http.HandleFunc(\"/test\", func(w http.ResponseWriter, r *http.Request) {\n        executor.ExecuteTemplate(w, \"test.html\", nil)\n    })\n\n    http.ListenAndServe(\":3000\", nil)\n}\n</code></pre>\n\n<p>If you need hot reload in production, i'd suggest watching the directory for changes instead of compiling it on every request.</p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2748, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1462032691, "creation_date": 1461999685, "question_id": 36951855, "link": "https://stackoverflow.com/questions/36951855/is-it-possible-to-reload-html-templates-after-app-is-started", "title": "Is it possible to reload html templates after app is started?", "body": "<p>Right now I currently parse all the templates into a variable like so:</p>\n\n<pre><code>var templates = template.New(\"Template\")\n\nfunc LoadTemplates() {\n    filepath.Walk(\"view/\", func(path string, info os.FileInfo, err error) error {\n        if strings.HasSuffix(path, \".html\") {\n            templates.ParseFiles(path)\n        }\n        return nil\n    })\n}\n\nfunc Render(w http.ResponseWriter, tmplName string, data interface{}) {\n    if err := templates.ExecuteTemplate(w, tmplName, data); err != nil {\n        log.Println(err)\n    }\n}\n</code></pre>\n\n<p>So if I make any changes, I need to restart the entire app. Is there any way I can make it so that the changes are reflected when they're made</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 2, "creation_date": 1461987610, "post_id": 36950395, "comment_id": 61459248, "body": "The declared type of a variable can&#39;t depend on runtime values. You don&#39;t say what problem you&#39;re trying to solve, but <a href=\"https://godoc.org/image#Image\" rel=\"nofollow noreferrer\">godoc.org/image#Image</a> is probably relevant -- even if you can&#39;t use Image directly, its source code may be useful."}, {"owner": {"reputation": 1585, "user_id": 853038, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a9773c9d75baea0919e4412aeb4c89f8?s=128&d=identicon&r=PG", "display_name": "Enze Chi", "link": "https://stackoverflow.com/users/853038/enze-chi"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1462145827, "post_id": 36950395, "comment_id": 61501898, "body": "@PaulHankin I have a quick look at the image package, it looks like only support 8 bits (uint8) pixel data. Don&#39;t have solution to support 10 bits."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1461988162, "creation_date": 1461988162, "answer_id": 36950478, "question_id": 36950395, "link": "https://stackoverflow.com/questions/36950395/is-it-possible-to-define-a-variable-which-type-is-depends-on-input-in-golang/36950478#36950478", "title": "Is it possible to define a variable which type is depends on input in Golang", "body": "<p>one way is:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc virtualVar(bitDepth int) interface{} {\n    var v interface{}\n    switch bitDepth {\n    case 8:\n        y := []byte{1, 2}\n        v = y\n    case 16:\n        y := []uint16{12345, 11000}\n        v = y\n    }\n    return v\n}\n\nfunc main() {\n    a := virtualVar(8)\n    b := virtualVar(16)\n    fmt.Println(a) //[1 2]\n    fmt.Println(b) //[12345 11000]\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2371452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4aa3a4ea6f7ffca525652cc678af90c?s=128&d=identicon&r=PG", "display_name": "Hedesec", "link": "https://stackoverflow.com/users/2371452/hedesec"}, "is_accepted": false, "score": 1, "last_activity_date": 1462816230, "last_edit_date": 1462816230, "creation_date": 1462127801, "answer_id": 36970439, "question_id": 36950395, "link": "https://stackoverflow.com/questions/36950395/is-it-possible-to-define-a-variable-which-type-is-depends-on-input-in-golang/36970439#36970439", "title": "Is it possible to define a variable which type is depends on input in Golang", "body": "<p>Because there are no generics in go, you will still have to do type assertions if you use an empty interface i.e. <code>interface{}</code>.</p>\n\n<p>The best option is to define an interface that provides all of the functionality you need, and implement it for all the datatypes you need to wrap. </p>\n\n<pre><code>package main\n\ntype SliceWrapper interface {\n    Slice(start, end int) SliceWrapper\n    Index(index int) int\n}\n\nfunc NewSlice(bitDepth int) SliceWrapper {\n    switch bitDepth {\n    case 8:\n        return make(Uint8Wrapper)\n    case 16:\n        return make(Uint16Wrapper)\n    }\n}\n\ntype Uint8Wrapper []uint8\n\nfunc (u Uint8Wrapper) Slice(s, e int) SliceWrapper {\n    return u[s:e]\n}\n\nfunc (u Uint8Wrapper) Index(i int) int {\n    return u[i]\n}\n\ntype Uint16Wrapper []uint16\n\nfunc (u Uint16Wrapper) Slice(s, e int) SliceWrapper {\n    return u[s:e]\n}\n\nfunc (u Uint16Wrapper) Index(i int) int {\n    return u[i]\n}\n</code></pre>\n\n<p>You will need more functionality than that I am sure, but it is way cleaner than throwing <code>interface{}</code> around everywhere.</p>\n"}], "owner": {"reputation": 1585, "user_id": 853038, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a9773c9d75baea0919e4412aeb4c89f8?s=128&d=identicon&r=PG", "display_name": "Enze Chi", "link": "https://stackoverflow.com/users/853038/enze-chi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1462816230, "creation_date": 1461987154, "question_id": 36950395, "link": "https://stackoverflow.com/questions/36950395/is-it-possible-to-define-a-variable-which-type-is-depends-on-input-in-golang", "title": "Is it possible to define a variable which type is depends on input in Golang", "body": "<p>Learning <code>Go</code> and try to write an App which take bit depth as input, when <code>bitDepth == 8</code>, define a varable as <code>var y []byte</code>, When <code>bitDepth == 10</code>, define a variable <code>var y []uint16</code></p>\n\n<p>What's the right way to do it in Go?</p>\n"}, {"tags": ["go", "casting"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1461977967, "post_id": 36949528, "comment_id": 61457636, "body": "No. Types in Go are invariant. Possible duplicate: <a href=\"http://stackoverflow.com/questions/12753805/type-converting-slices-of-interfaces-in-go\" title=\"type converting slices of interfaces in go\">stackoverflow.com/questions/12753805/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "is_accepted": false, "score": 0, "last_activity_date": 1461982765, "creation_date": 1461982765, "answer_id": 36949986, "question_id": 36949528, "link": "https://stackoverflow.com/questions/36949528/coercing-map-types-in-go/36949986#36949986", "title": "Coercing map types in Go", "body": "<p>Try using <code>interface{}</code> and <code>switch</code> type checking:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype IDMap map[string]bool\ntype ObjectMap map[string]interface{}\ntype Map interface {\n    Intersect(interface{}) Map\n}\n\nfunc main() {\n    im1 := IDMap{\"a\": true, \"b\": false, \"c\": true, \"e\": false}\n    other1 := IDMap{\"b\": true, \"d\": false, \"e\": true}\n    other2 := ObjectMap{\"b\": false, \"x\": 1, \"y\": 3.4, \"z\": \"hello\"}\n    other3 := map[string]interface{}{\"m\": 5.4, \"n\": false, \"o\": \"world\", \"b\": \"foo\", \"a\": \"bar\"}\n\n    overlap1 := im1.Intersect(other1)\n    check(overlap1)\n\n    overlap2 := im1.Intersect(other2)\n    check(overlap2)\n\n    overlap3 := im1.Intersect(other3)\n    check(overlap3)\n\n\n    im2 := ObjectMap{\"a\": \"hello\", \"b\": 4.5, \"c\": 10, \"e\": []string{\"what?\"}}\n    other4 := IDMap{\"b\": true, \"d\": false, \"e\": true}\n    other5 := ObjectMap{\"b\": false, \"x\": 1, \"y\": 3.4, \"z\": \"hello\"}\n    other6 := map[string]interface{}{\"m\": 5.4, \"n\": false, \"o\": \"world\", \"b\": \"foo\", \"a\": \"bar\"}\n\n    overlap4 := im2.Intersect(other4)\n    check(overlap4)\n\n    overlap5 := im2.Intersect(other5)\n    check(overlap5)\n\n    overlap6 := im2.Intersect(other6)\n    check(overlap6)\n\n}\n\nfunc check(m Map) {\n    fmt.Println(m)\n}\n\nfunc (im IDMap) Intersect(other interface{}) Map {\n    result := IDMap{}\n\n    switch o := other.(type) {\n    case IDMap:\n        for k := range im {\n            if _, ok := o[k]; ok {\n                result[k] = true\n            }\n        }\n    case ObjectMap:\n        for k := range im {\n            if _, ok := o[k]; ok {\n                result[k] = true\n            }\n        }\n    case map[string]interface{}:\n        for k := range im {\n            if _, ok := o[k]; ok {\n                result[k] = true\n            }\n        }\n    }\n\n    return result\n}\n\nfunc (om ObjectMap) Intersect(other interface{}) Map {\n    result := ObjectMap{}\n\n    switch o := other.(type) {\n    case IDMap:\n        for k := range om {\n            if _, ok := o[k]; ok {\n                result[k] = om[k]\n            }\n        }\n    case ObjectMap:\n        for k := range om {\n            if _, ok := o[k]; ok {\n                result[k] = om[k]\n            }\n        }\n    case map[string]interface{}:\n        for k := range om {\n            if _, ok := o[k]; ok {\n                result[k] = om[k]\n            }\n        }\n    }\n\n    return result\n}\n</code></pre>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461982765, "creation_date": 1461977345, "question_id": 36949528, "link": "https://stackoverflow.com/questions/36949528/coercing-map-types-in-go", "title": "Coercing map types in Go", "body": "<p>Is type coercion of maps possible in Go? What I'd like to do is something like:</p>\n\n<pre><code>type IDMap map[string]bool\ntype ObjectMap map[string]Object\n</code></pre>\n\n<p>and then write functions which take arguments of type <code>map[string]interface{}</code> so that I can handle either of these base types as an argument, like this:</p>\n\n<pre><code>func (im IDMap) Intersect(other map[string]interface{}) {\n    result = make(IDMap, 0)\n    for k := range im {\n        if _, ok := other[k]; ok {\n            result[k] = true\n        }\n    }\n    return result\n}\n\nfunc (om ObjectMap) Intersect(other map[string]interface{}) {\n    result = make(ObjectMap, 0)\n    for k := range om {\n        if _, ok := other[k]; ok {\n            result[k] = om[k]\n        }\n    }\n    return result\n}\n</code></pre>\n\n<p>allowing me to call the Intersect method of either type with an object of either type. When I try, I get a type error message. Is something like this possible?</p>\n"}, {"tags": ["for-loop", "dictionary", "go", "parallel-processing", "range"], "comments": [{"owner": {"reputation": 21557, "user_id": 1122270, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1ab0e19086582d27abe75b0635f57f43?s=128&d=identicon&r=PG", "display_name": "cnst", "link": "https://stackoverflow.com/users/1122270/cnst"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461976384, "post_id": 36949303, "comment_id": 61457290, "body": "@OneOfOne, it&#39;s related, but not a duplicate; the solution from the prior answer appears to be inferior in speed compared to a uniprocessor approach; I&#39;d like to know if there&#39;s a proper way to manually split up a map to perhaps get some better results."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461976682, "post_id": 36949303, "comment_id": 61457355, "body": "not all algorithms work good in parallel, look at the other answer, finish the go tutorial and use some very common sense and you will figure it out."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461976704, "post_id": 36949303, "comment_id": 61457362, "body": "Also read <a href=\"http://stackoverflow.com/questions/14298523/why-does-adding-concurrency-slow-down-this-golang-code\" title=\"why does adding concurrency slow down this golang code\">stackoverflow.com/questions/14298523/&hellip;</a>"}, {"owner": {"reputation": 21557, "user_id": 1122270, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1ab0e19086582d27abe75b0635f57f43?s=128&d=identicon&r=PG", "display_name": "cnst", "link": "https://stackoverflow.com/users/1122270/cnst"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461977001, "post_id": 36949303, "comment_id": 61457435, "body": "@OneOfOne, but I&#39;m not using <code>rand.Float()</code>, and, even if I did, how is a question about splitting up a map related to <code>rand.Float()</code>?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461977162, "post_id": 36949303, "comment_id": 61457467, "body": "edit the question, post the code you have, and why it&#39;s not working and then it will be a valid question and I&#39;ll reopen it."}, {"owner": {"reputation": 21557, "user_id": 1122270, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1ab0e19086582d27abe75b0635f57f43?s=128&d=identicon&r=PG", "display_name": "cnst", "link": "https://stackoverflow.com/users/1122270/cnst"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461977425, "post_id": 36949303, "comment_id": 61457529, "body": "@OneOfOne, the code I have is <code>range m</code>, it returns the whole range, but I only need 1/nth of the range.  It&#39;s all already in the question."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461977637, "post_id": 36949303, "comment_id": 61457570, "body": "Again, please post a fully working example. <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "owner": {"reputation": 21557, "user_id": 1122270, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1ab0e19086582d27abe75b0635f57f43?s=128&d=identicon&r=PG", "display_name": "cnst", "link": "https://stackoverflow.com/users/1122270/cnst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "closed_date": 1461976008, "answer_count": 0, "score": 0, "last_activity_date": 1461975164, "creation_date": 1461975164, "last_edit_date": 1495540360, "question_id": 36949303, "link": "https://stackoverflow.com/questions/36949303/how-do-i-split-up-a-range-of-a-map-for-parallel-processing-in-go", "closed_reason": "Duplicate", "title": "How do I split up a range of a map (for parallel processing) in Go?", "body": "<p>According to <a href=\"https://golang.org/doc/effective_go.html#parallel\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#parallel</a>, in order to do parallel processing in Go, you have to manually <a href=\"https://stackoverflow.com/questions/36949211/is-there-a-simple-parallel-for-in-golang-like-openmp\">split up the workload between the CPUs</a>, where each CPU will run a whole and independent loop over some portion of the input.</p>\n\n<p>Well, that's certainly not that complicated when your original and \"complete\" loop is <code>for i := 0; i &lt; n; i++</code>, but what if you're doing a <code>range</code> over a <code>map</code>?</p>\n\n<p>How do I split up <code>range</code> over a <code>map</code> into a <code>runtime.NumCPU()</code> number of distinct ranges?</p>\n"}, {"tags": ["c", "go", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 21557, "user_id": 1122270, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1ab0e19086582d27abe75b0635f57f43?s=128&d=identicon&r=PG", "display_name": "cnst", "link": "https://stackoverflow.com/users/1122270/cnst"}, "edited": false, "score": 0, "creation_date": 1470241744, "post_id": 36949211, "comment_id": 64871907, "body": "@Amd, superficial edits (as well as introducing spelling mistakes) are against ToS"}], "answers": [{"comments": [{"owner": {"reputation": 21557, "user_id": 1122270, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1ab0e19086582d27abe75b0635f57f43?s=128&d=identicon&r=PG", "display_name": "cnst", "link": "https://stackoverflow.com/users/1122270/cnst"}, "edited": false, "score": 0, "creation_date": 1461976269, "post_id": 36949290, "comment_id": 61457260, "body": "looks good, however, i&#39;ve tried it, and it doesn&#39;t seem to offer any performance increase, my for loop over about 2k elements actually runs 39 seconds and still uses only 12.5% of CPU (according to top), whereas a non-go-routine version completes in 29 seconds."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 21557, "user_id": 1122270, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1ab0e19086582d27abe75b0635f57f43?s=128&d=identicon&r=PG", "display_name": "cnst", "link": "https://stackoverflow.com/users/1122270/cnst"}, "edited": false, "score": 1, "creation_date": 1461976764, "post_id": 36949290, "comment_id": 61457379, "body": "@cnst <a href=\"http://stackoverflow.com/questions/14298523/why-does-adding-concurrency-slow-down-this-golang-code\" title=\"why does adding concurrency slow down this golang code\">stackoverflow.com/questions/14298523/&hellip;</a>"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1462136455, "post_id": 36949290, "comment_id": 61499355, "body": "Note also that this example code, above, is creating goroutines. Please understand that goroutines are not like native operating system threads, they are an abstraction above them. The runtime time-slices the goroutines across cpu cores, avoiding you from doing that explicitly. In many cases, having an excess number of goroutines w.r.t the number of cores is a good thing (indeed there is theoretical work to support this [Valiant and others])."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 6, "last_activity_date": 1605533483, "last_edit_date": 1605533483, "creation_date": 1461975072, "answer_id": 36949290, "question_id": 36949211, "link": "https://stackoverflow.com/questions/36949211/is-there-a-simple-parallel-for-in-golang-like-openmp/36949290#36949290", "title": "Is there a simple `parallel for` in golang like OpenMP?", "body": "<p>Effective Go is outdated about that, Go automatically sets GOMAXPROCS to the number of processors (you can still manually set it to force the number you want).</p>\n<p>Here's a very simple example for parallel processing of a slice:</p>\n<pre><code>data := make([]float64, SZ)\nvar wg sync.WaitGroup\nfor i := range data {\n    wg.Add(1)\n    go func(v *float64) {\n        // note that using rand is a bad example because global rand uses a mutex\n        *v = rand.Float64()\n        wg.Done()\n    }(&amp;data[i])\n}\nwg.Wait()\n</code></pre>\n<p><a href=\"https://play.golang.org/p/ftWkAhCf9k\" rel=\"nofollow noreferrer\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 21557, "user_id": 1122270, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1ab0e19086582d27abe75b0635f57f43?s=128&d=identicon&r=PG", "display_name": "cnst", "link": "https://stackoverflow.com/users/1122270/cnst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2629, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1605533483, "creation_date": 1461974331, "last_edit_date": 1470241543, "question_id": 36949211, "link": "https://stackoverflow.com/questions/36949211/is-there-a-simple-parallel-for-in-golang-like-openmp", "title": "Is there a simple `parallel for` in golang like OpenMP?", "body": "<p>I'm trying to optimise a puzzle with parallel processing, for better performance.</p>\n\n<p>Ideally, in C99 w/ OpenMP, I should be able to do that with the help of a <code>#pragma omp parallel for</code> prior to a <code>for</code> loop in question, and then it should be up to the system to distribute the load between the CPUs.</p>\n\n<p>The official documentation for Go at <a href=\"https://golang.org/doc/effective_go.html#parallel\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#parallel</a>, however, seems to suggest that for parallel processing I must, (0), manually get the number of cores from the runtime environment, (1), loop over said cores, (2), effectively code up a distinct for loop for each core, (3), loop over the cores once again to make sure all the stuff got processed.</p>\n\n<p>Am I missing something?  For the simplest case, is OpenMP with the ancient C superior to the brand new Go that's touted as C's best replacement?  For a more complicated example, how exactly do you split up a <code>range</code> between the CPUs?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 784, "user_id": 2553000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98cee193ab6bce4934efae04ea1d7725?s=128&d=identicon&r=PG", "display_name": "seoyoochan", "link": "https://stackoverflow.com/users/2553000/seoyoochan"}, "edited": false, "score": 0, "creation_date": 1461976595, "post_id": 36949187, "comment_id": 61457341, "body": "I am quite not following because I am a noob in Go. so there&#39;s no easier way to install the package? As a Rubyist, I really love installing gems from RubyGems.org. If so, is my custom <code>pkgset</code> where I pull the source code and install it?"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 784, "user_id": 2553000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98cee193ab6bce4934efae04ea1d7725?s=128&d=identicon&r=PG", "display_name": "seoyoochan", "link": "https://stackoverflow.com/users/2553000/seoyoochan"}, "edited": false, "score": 0, "creation_date": 1461976966, "post_id": 36949187, "comment_id": 61457426, "body": "install package is so easy in golang, just <code>go install</code> is enough. but if you install package which come from <code>go get</code>, you won&#39;t automatically go to the package location. it&#39;s natural I think, you cannot install package without go to the location first."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 784, "user_id": 2553000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98cee193ab6bce4934efae04ea1d7725?s=128&d=identicon&r=PG", "display_name": "seoyoochan", "link": "https://stackoverflow.com/users/2553000/seoyoochan"}, "edited": false, "score": 0, "creation_date": 1461977014, "post_id": 36949187, "comment_id": 61457438, "body": "<code>go get</code> will download package into <code>$GOPATH&#47;src</code> folder. check on <code>$GOPATH</code> location. if you are using gvm, it&#39;ll saved to you <code>$pkgset&#47;src</code>"}, {"owner": {"reputation": 784, "user_id": 2553000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98cee193ab6bce4934efae04ea1d7725?s=128&d=identicon&r=PG", "display_name": "seoyoochan", "link": "https://stackoverflow.com/users/2553000/seoyoochan"}, "edited": false, "score": 0, "creation_date": 1461978742, "post_id": 36949187, "comment_id": 61457785, "body": "I made up my mind to ditch gvm for now. gvm has too many issues to introduce in my workflow. :/ Thanks anyway!"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 0, "last_activity_date": 1461975681, "last_edit_date": 1461975681, "creation_date": 1461974134, "answer_id": 36949187, "question_id": 36948693, "link": "https://stackoverflow.com/questions/36948693/how-to-install-a-package-with-gvmgo-version-manager-go-get-failed/36949187#36949187", "title": "how to install a package with gvm(Go Version Manager)? go get failed", "body": "<p>when you <code>go get</code> some package, if it has buildable source, the <code>go install</code> commang will automatically run inside the package directory, so you don't need to <code>go install gocode</code>. just type <code>gocode</code> to check.</p>\n\n<p>If you want to install it manually, you have to go to the directory first</p>\n\n<pre><code>cd $GOPATH/src/github.com/nsf/gocode\ngo install\n</code></pre>\n\n<p>Also you cannot perform <code>go list</code> outside package directory</p>\n\n<pre><code>cd $GOPATH/src/github.com/nsf/gocode\ngo list\n</code></pre>\n"}], "owner": {"reputation": 784, "user_id": 2553000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98cee193ab6bce4934efae04ea1d7725?s=128&d=identicon&r=PG", "display_name": "seoyoochan", "link": "https://stackoverflow.com/users/2553000/seoyoochan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1011, "favorite_count": 0, "accepted_answer_id": 36949187, "answer_count": 1, "score": 0, "last_activity_date": 1461975681, "creation_date": 1461970509, "question_id": 36948693, "link": "https://stackoverflow.com/questions/36948693/how-to-install-a-package-with-gvmgo-version-manager-go-get-failed", "title": "how to install a package with gvm(Go Version Manager)? go get failed", "body": "<p>I successfully installed <code>go1.6.2</code> with <code>gvm</code> and used <code>global</code> pkgset.<br>\nI am trying to install <code>gocode</code> package with gvm, but <code>go get</code> not working.<br>\nI guess gvm is not really stable yet?  </p>\n\n<pre><code>\u279c  ~ gvm use 1.6.2\nNow using version go1.6.2\n\u279c  ~ gvm pkgset use global\nNow using version go1.6.2@global\n\u279c  ~  go get -u github.com/nsf/gocode\n\u279c  ~ go list\ncan't load package: package .: no buildable Go source files in /Users/seoyoochan\n\n\u279c  ~ go install gocode\ncan't load package: package gocode: cannot find package \"gocode\" in any of:\n    /Users/seoyoochan/.gvm/gos/go1.6.2/src/gocode (from $GOROOT)\n    /Users/seoyoochan/.gvm/pkgsets/go1.6.2/global/src/gocode (from $GOPATH)\n    /Users/seoyoochan/.gvm/pkgsets/go1.6.2/global/src/gocode\n</code></pre>\n"}, {"tags": ["memory", "go"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 4, "last_activity_date": 1461965526, "last_edit_date": 1461965526, "creation_date": 1461962016, "answer_id": 36946994, "question_id": 36946861, "link": "https://stackoverflow.com/questions/36946861/how-do-allocations-work-and-how-do-you-prevent-them/36946994#36946994", "title": "How do allocations work and how do you prevent them?", "body": "<p>I personally don't like their use of language as it sounds like something a marketer would say... All they mean to say is that no allocations will occur in that code because a buffer has been allocated in advance for use there.</p>\n\n<p>So to be clear, they mean 'in this limited scope no allocations will occur'. How do you achieve this? By allocating a sufficiently large buffer in advance of that and then leveraging it in the scope.</p>\n\n<p>The intent of packages author(s) is to speed up request handling by allocating up front at the cost of using more memory (or having a more constant hold on memory at least, in theory the buffer could be the same size as what would need to be allocated).</p>\n\n<p>If you're curious about the implementation details take a look in files like byte_buffer.go and args.go and you'll find that there is a pool of buffer objects allocated in advance so that your handler code doesn't have to do an allocation for the response body ect. Instead you obtain a buffer from the pool (already allocated) and write the response data to it and then when you're done it's released back into the pool for reuse. In the standard scenario you'd instead allocate space for the response body and after the response is returned that object would leave scope and the memory would be freed. As I mentioned in the paragraph above, moving all of this upfront means when your service starts up it will obtain and hold a larger amount of memory than a similar service which used net/http since it will instead obtain and release memory on an as needed basis.</p>\n"}], "owner": {"reputation": 183, "user_id": 3470707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d4d7e34655b755f8fc53978e56358e2?s=128&d=identicon&r=PG&f=1", "display_name": "user3470707", "link": "https://stackoverflow.com/users/3470707/user3470707"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 36946994, "answer_count": 1, "score": 4, "last_activity_date": 1461965526, "creation_date": 1461961396, "question_id": 36946861, "link": "https://stackoverflow.com/questions/36946861/how-do-allocations-work-and-how-do-you-prevent-them", "title": "How do allocations work and how do you prevent them?", "body": "<p>The go test tool has a profiler which can tell you the amount of allocations you did inside the code.\nHowever, seeing libraries such as this one:\n<a href=\"https://github.com/valyala/fasthttp\" rel=\"nofollow\">https://github.com/valyala/fasthttp</a>\nstating \"Zero memory allocations in hot paths\"... what does that mean? and how do you achieve this in Go?</p>\n"}, {"tags": ["google-app-engine", "go", "dns", "subdomain"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4409478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdd41bb20de720d983f707ba10f50be?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Chopra", "link": "https://stackoverflow.com/users/4409478/sahil-chopra"}, "edited": false, "score": 0, "creation_date": 1461965267, "post_id": 36947528, "comment_id": 61454003, "body": "Do I have to add any type of forwarding on the GoDaddy DNS registrar side of things (other than the CNAME entry)? Do you have any examples of shareable, working gae custom domain code?"}], "tags": [], "owner": {"reputation": 351, "user_id": 2929314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f165547be245b64b1a5bedb2b7a2edcb?s=128&d=identicon&r=PG&f=1", "display_name": "mgbelisle", "link": "https://stackoverflow.com/users/2929314/mgbelisle"}, "is_accepted": false, "score": 0, "last_activity_date": 1461964402, "creation_date": 1461964402, "answer_id": 36947528, "question_id": 36944573, "link": "https://stackoverflow.com/questions/36944573/google-app-engine-custom-domain-routing-in-go/36947528#36947528", "title": "Google App Engine Custom Domain - Routing in Go", "body": "<p>I have done custom domains on appengine/go before, and there is nothing else you should have to do. I would try removing this line, though,</p>\n\n<pre><code>    r.Schemes(\"http\")\n</code></pre>\n\n<p>in case it is something https related.</p>\n"}], "owner": {"reputation": 11, "user_id": 4409478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdd41bb20de720d983f707ba10f50be?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Chopra", "link": "https://stackoverflow.com/users/4409478/sahil-chopra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1471290838, "creation_date": 1461952110, "last_edit_date": 1471290838, "question_id": 36944573, "link": "https://stackoverflow.com/questions/36944573/google-app-engine-custom-domain-routing-in-go", "title": "Google App Engine Custom Domain - Routing in Go", "body": "<p>I've been utilizing the url provided to me by the google-app-engine, i.e. \"projectname-id.appspot.com\" for my project. I had previously purchased a custom domain from GoDaddy, and I followed the steps at the following link to verify ownership of the domain name within the Google Cloud Platform, add the domain to my Google App Engine Project, and update my DNS settings in GoDaddy to point to the listed CNAME/server combination. <a href=\"https://cloud.google.com/appengine/docs/go/console/using-custom-domains-and-ssl\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/console/using-custom-domains-and-ssl</a></p>\n\n<p>When I visit my custom domain, a website page is served, but it's always a 404. The \"projectname-id.appspot.com\" url still works correctly, and when I look at the log statements in the Google App Engine, it receives the request from both my custom domain and the appspot domain - which seems to suggest the domain dns was updated properly. See image below, where the 404 is from the custom domain and the 200 is from the appspot url:</p>\n\n<p><a href=\"http://i.stack.imgur.com/1W0cI.png\" rel=\"nofollow\">Google App Engine Logs</a></p>\n\n<p>Is there anything else I have to do? The backend is written in Go, and we're using the Mux Router. Do I need to modifiy my app.yaml file or edit my routes somehow? Any suggestions would be greatly appreciated.</p>\n\n<p>Here I've included some code snippets I use to initialize my server:</p>\n\n<p>App.yaml</p>\n\n<pre><code>    version: alpha-001\n    runtime: go\n    api_version: go1\n\n    handlers:\n    - url: /.*\n      script: _go_app\n\n    env_variables:\n      PRODUCTION: 'TRUE'\n      DATASTORE_DATASET: 'app-id'\n      DATASTORE_HOST: 'http://localhost:8043'\n      DATASTORE_EMULATOR_HOST: 'localhost:8043'\n      DATASTORE_PROJECT_ID: 'app-id'\n      GOOGLE_APPLICATION_CREDENTIALS: './app-string.json'\n</code></pre>\n\n<p>Initializing the WebConsole (Server):</p>\n\n<pre><code>    func init() {\n        // Web Server for API Endpoints\n        flag.Parse()\n\n        var server *web_console.WebConsole\n        if prod := os.Getenv(\"PRODUCTION\"); prod == \"FALSE\" {\n           server = web_console.NewWebConsole(false)\n        } else {\n           server = web_console.NewWebConsole(true)\n        }\n\n        server.Run()\n      }\n</code></pre>\n\n<p>WebConsole.go</p>\n\n<pre><code>type WebConsole struct {\n    prod   bool\n    Mux    *mux.Router\n    DbMap  *gorp.DbMap\n    Client *datastore.Client\n}\n\nfunc NewWebConsole(prod bool) *WebConsole {\n    return &amp;WebConsole{\n        prod: prod,\n    }\n}\n\nfunc (w *WebConsole) Run() {\n    w.dbInit()\n    w.routesInit()\n}\n\nfunc (w *WebConsole) dbInit() {\n    // Configure SQL connection\n    // Code removed for privacy reasons\n}\n\nfunc (w *WebConsole) routesInit() {\n    // Configure routes with Mux\n    w.Mux = mux.NewRouter()\n    api.AddCertChallengeApis(w.Mux)\n\n    // The path \"/\" matches everything not matched by some other path.\n    // Checkout: http://stackoverflow.com/questions/26581231/google-cloud-go-handler-without-router-gorilla-mux\n    //      for more details\n    http.Handle(\"/\", w.Mux)\n\n}\n</code></pre>\n\n<p>Api Package File for Routing</p>\n\n<pre><code>package api\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"google.golang.org/appengine\"\n    \"google.golang.org/appengine/log\"\n    \"net/http\"\n    \"strings\"\n)\n\nfunc AddCertChallengeApis(r *mux.Router) {\n    r.Schemes(\"http\")\n    r.HandleFunc(\"/\", defaultHandler())\n}\n\nfunc defaultHandler() http.HandlerFunc {\n    return func(rw http.ResponseWriter, req *http.Request) {\n        // Construct new app engine context\n        c := appengine.NewContext(req)\n\n        log.Infof(c, \"App ID: %v\", appengine.AppID(c))\n\n        rw.Header().Set(\"Content-Type\", \"text/plain\")\n        rw.Write([]byte(\"hi, welcome to my website yo\"))\n        log.Infof(c, \"Hit the website\")\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "exec", "cat"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1461951032, "post_id": 36943861, "comment_id": 61447239, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20195296/golang-append-an-item-to-a-slice\">Golang append an item to a slice</a>"}, {"owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "edited": false, "score": 0, "creation_date": 1461952702, "post_id": 36943861, "comment_id": 61448121, "body": "sort will also not solve the problem actually. May be you are lucky that some of the elements are moved ahead of the underlying array of the slice(because of sort) and hence the files get processed. The slice passed to the go routine will be having the same length, start-position in the underlying array etc. irrespective of of what is appended to it from some other functions."}, {"owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "edited": false, "score": 0, "creation_date": 1461953430, "post_id": 36943861, "comment_id": 61448469, "body": "Here is an example demonstrating the behavior of slices <a href=\"https://play.golang.org/p/kZGovImZDm\" rel=\"nofollow noreferrer\">play.golang.org/p/kZGovImZDm</a> .... May be you should pass the new file paths through a channel to the goroutine."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1462789657, "post_id": 36943861, "comment_id": 61768087, "body": "Im not saying that its not the same as referenced question but I dont see it. I fully create and assign all elements to the slice within the same function - the slice is assigned completely before being passed to exec within goroutine. I cannot see where this is being copied - Could someone please clarify"}], "answers": [{"tags": [], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "is_accepted": true, "score": 0, "last_activity_date": 1462794984, "creation_date": 1462794984, "answer_id": 37115216, "question_id": 36943861, "link": "https://stackoverflow.com/questions/36943861/golang-why-is-string-slice-element-not-included-in-exec-cat-unless-i-sort-it/37115216#37115216", "title": "Golang - why is string slice element not included in exec cat unless I sort it", "body": "<p><strong>UPDATE AND CLOSE</strong>\nPlease close question - the issue was unrelated to the use of a string slice. Turns out that I was reading from the final output file before bufio-writer had been flushed (at end of function before defer flush kicked in on function return)</p>\n\n<p>I think the sorting was just re-arranging the problem so I didnt notice it persisted or possibly giving some time for the buffer to flush. Either way sorted now with a manual call to flush.</p>\n\n<p>Thanks for all help provided</p>\n"}], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "accepted_answer_id": 37115216, "answer_count": 1, "score": 1, "last_activity_date": 1462794984, "creation_date": 1461949292, "last_edit_date": 1495541757, "question_id": 36943861, "link": "https://stackoverflow.com/questions/36943861/golang-why-is-string-slice-element-not-included-in-exec-cat-unless-i-sort-it", "title": "Golang - why is string slice element not included in exec cat unless I sort it", "body": "<p>I have a slightly funky issue in golang. Essentially I have a slice of strings which represent file paths. I then run a cat against those filepaths to combine the files before sorting, deduping, etc.</p>\n\n<p>here is the section of code (where 'applicableReductions' is the string slice):</p>\n\n<pre><code>    applicableReductions := []string{}\n\n    for _, fqFromListName := range fqFromListNames {\n         filePath := GetFilePath()\n         //BROKE CODE GOES HERE\n    }\n    applicableReductions = append(applicableReductions, filePath)\n\n    fileOut, err := os.Create(toListWriteTmpFilePath)\n    if err != nil {\n        return err\n    }\n    cat := exec.Command(\"cat\", applicableReductions...)\n    catStdOut, err := cat.StdoutPipe()\n    if err != nil {\n        return err\n    }\n    go func(cat *exec.Cmd) error {\n        if err := cat.Start(); err != nil {\n            return fmt.Errorf(\"File reduction error (cat) : %s\", err)\n        }\n        return nil\n    }(cat)\n\n    // Init Writer &amp; write file\n    writer := bufio.NewWriter(fileOut)\n    defer writer.Flush()\n\n    _, err = io.Copy(writer, catStdOut)\n    if err != nil {\n        return err\n    }\n\n    if err = cat.Wait(); err != nil {\n        return err\n    }\n\n    fDiff.StandardiseData(fileOut, toListUpdateFolderPath, list.Name)\n</code></pre>\n\n<p>The above works fine. The problem comes when I try to append a new ele to the array. I have a seperate function which creates a new file from db content which is then added to the applicableReductions slice.</p>\n\n<pre><code>func RetrieveDomainsFromDB(collection *Collection, listName, outputPath string) error {\n    domains, err := domainReviews.GetDomainsForList(listName)\n    if err != nil {\n        return err\n    }\n\n    if len(domains) &lt; 1 {\n        return ErrNoDomainReviewsForList\n    }\n\n    fh, err := os.OpenFile(outputPath, os.O_RDWR, 0774)\n    if err != nil {\n        fh, err = os.Create(outputPath)\n        if err != nil {\n            return err\n        }\n    }\n    defer fh.Close()\n    _, err = fh.WriteString(strings.Join(domains, \"\\n\"))\n    if err != nil {\n        return err\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>If I call the above function and append the filePath to the applicableReduction slice, it is in there but doesnt get called by cat.</p>\n\n<p>To clarify, when I put the following where it says BROKE CODE GOES HERE:</p>\n\n<pre><code>    if dbSource {\n        err = r.RetrieveDomainsFromDB(collection, ToListName, filePath)\n        if err != nil {\n                return err\n                continue\n            }\n      }\n</code></pre>\n\n<p>The filepath can be seen when doing <code>fmt.Println(applicableReductions)</code> but the content of the files contents are not seen in the cat output file.</p>\n\n<p>I thought perhaps a delay in the file being written so i tried adding a time.wait, tis didnt help. However the solution I found was to sort the slice, e.g this code above the call to exec cat solves the problem but I dont know why:</p>\n\n<pre><code>sort.Strings(applicableReductions)\n</code></pre>\n\n<p>I have confirmed all files present on both successful and unsucessful runs the only difference is without the sort, the content of the final appended file is missing</p>\n\n<p>An explanation from a go-pro out there would be very much appreciated, let me know if you need more info, debug - happy to oblige to understand</p>\n\n<p><strong>UPDATE</strong>\nIt has been suggested that this is the same issue as here: <a href=\"https://stackoverflow.com/questions/20195296/golang-append-an-item-to-a-slice\">Golang append an item to a slice</a>, I think I understand the issue there and I'm not saying this isnt the same but I cannot see the same thing happenning - the slice in question is not touched from outside the main function (e.g. no editing of the slice in RetrieveDomainsFromDB function), I create the slice before a loop, append to it within a loop and then use it after the loop - Ive added an example at the top to show how the slice is built - please could someone clarify where this slice is being copied if this is the case</p>\n"}, {"tags": ["javascript", "jquery", "ajax", "http", "go"], "comments": [{"owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "edited": false, "score": 1, "creation_date": 1461948620, "post_id": 36943446, "comment_id": 61446070, "body": "Your datatype for your ajax call is jsonp?  Are you intending to do that?"}, {"owner": {"reputation": 6538, "user_id": 2275797, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lg0K6.jpg?s=128&g=1", "display_name": "briosheje", "link": "https://stackoverflow.com/users/2275797/briosheje"}, "edited": false, "score": 1, "creation_date": 1461948623, "post_id": 36943446, "comment_id": 61446072, "body": "Is there any particular reason you&#39;re using <code>jsonp</code> instead of <code>json</code> as datatype? jsonp expects a callback to be fired and, as far as I can see, neither your client nor your server sides are ready to handle that. Perhaps you just need to perform a regular post request using <b>json</b> as datatype instead or are you trying to avoid cross-domain issues?"}, {"owner": {"reputation": 6538, "user_id": 2275797, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lg0K6.jpg?s=128&g=1", "display_name": "briosheje", "link": "https://stackoverflow.com/users/2275797/briosheje"}, "edited": false, "score": 0, "creation_date": 1461949110, "post_id": 36943446, "comment_id": 61446321, "body": "Perhaps you should check this:<a href=\"http://stackoverflow.com/questions/17036365/how-should-a-jsonp-response-be-formed-in-go-using-http-responsewriter\" title=\"how should a jsonp response be formed in go using http responsewriter\">stackoverflow.com/questions/17036365/&hellip;</a>"}, {"owner": {"reputation": 226, "user_id": 2877566, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IxdDa.png?s=128&g=1", "display_name": "shane", "link": "https://stackoverflow.com/users/2877566/shane"}, "edited": false, "score": 0, "creation_date": 1461951263, "post_id": 36943446, "comment_id": 61447353, "body": "The reason I use jsonp is because of CORS. I get &#39;.. response to preflight request doesn&#39;t pass access control check: No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource. Origin REMOTE_IP ...&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 169, "user_id": 4842399, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-67B4-u_5H98/AAAAAAAAAAI/AAAAAAAADgE/Tv_dSiQy62w/photo.jpg?sz=128", "display_name": "ravichandra reddy", "link": "https://stackoverflow.com/users/4842399/ravichandra-reddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1461954012, "creation_date": 1461954012, "answer_id": 36945091, "question_id": 36943446, "link": "https://stackoverflow.com/questions/36943446/jquery-ajax-wont-return-the-data-parse-error-but-postman-succeeds/36945091#36945091", "title": "Jquery Ajax won&#39;t return the data (parse error), but Postman succeeds", "body": "<p>First check whether your server can handle JSONP requests by using following tests.</p>\n\n<pre><code>http://REMOTE_IP:8000/users?callback=myFunction\n</code></pre>\n\n<p>The response instead of this (it will look like this if it doesn't support JSONP):</p>\n\n<pre><code>{ \"thing\": \"value\" .... }\n</code></pre>\n\n<p>Should look like this (again, if it supports JSONP):</p>\n\n<pre><code>myFunction({ \"thing\": \"value\" .... });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 226, "user_id": 2877566, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IxdDa.png?s=128&g=1", "display_name": "shane", "link": "https://stackoverflow.com/users/2877566/shane"}, "is_accepted": true, "score": 0, "last_activity_date": 1470849466, "creation_date": 1470849466, "answer_id": 38879757, "question_id": 36943446, "link": "https://stackoverflow.com/questions/36943446/jquery-ajax-wont-return-the-data-parse-error-but-postman-succeeds/38879757#38879757", "title": "Jquery Ajax won&#39;t return the data (parse error), but Postman succeeds", "body": "<h2># Answer</h2>\n\n<p>I found a nice go library that handles the cross-origin problems I was having, meaning I didn't have to rely on jsonp. Here's the revised go code:</p>\n\n<h3>Using the CORS Handler</h3>\n\n<pre><code>handler := cors.Default().Handler(r)\nerr := http.ListenAndServe(port, handler)\n\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<h3>Revised handler</h3>\n\n<pre><code>func GetUsersRoute(w http.ResponseWriter, r *http.Request) {\n    var queryResult []models.User\n\n    queryErr := Config.Users.Find(bson.M{}).All(&amp;queryResult)\n    resultsJSON, jsonErr := json.Marshal(queryResult)\n\n    handleQueryAndJsonErrors(w, queryErr, jsonErr)\n\n    w.Header().Set(\"Content-Type\", \"application/json; charset=UTF-8\")\n    w.WriteHeader(http.StatusOK)\n    w.Write(resultsJSON)\n}\n</code></pre>\n\n<h3>Calling from the frontend</h3>\n\n<pre><code>var extension = 'users/',\n    requestPath = serverAddress + extension;\n\n$.ajax({\n    url: requestPath,\n    type: 'GET',\n    dataType: 'json',\n    contentType: 'application/json',\n    success: successCall,\n    error: failCall\n});\n</code></pre>\n"}], "owner": {"reputation": 226, "user_id": 2877566, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IxdDa.png?s=128&g=1", "display_name": "shane", "link": "https://stackoverflow.com/users/2877566/shane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1001, "favorite_count": 0, "accepted_answer_id": 38879757, "answer_count": 2, "score": 1, "last_activity_date": 1470849466, "creation_date": 1461947739, "last_edit_date": 1592644375, "question_id": 36943446, "link": "https://stackoverflow.com/questions/36943446/jquery-ajax-wont-return-the-data-parse-error-but-postman-succeeds", "title": "Jquery Ajax won&#39;t return the data (parse error), but Postman succeeds", "body": "<p>I've been using Postman to test my REST API (written in Go). Now is the moment of truth, connecting to the front end and I've hit a hiccup. I'm using jQuery.ajax to send a GET to my server, which should then send me back the response.</p>\n<p><strong>Note</strong>: Going to postman and sending a GET request to <code>http://REMOTE_IP:8000/users/</code> returns the information I'm looking for, an array of User objects (JSON). It confuses me that it would work for Postman, but not jQuery.</p>\n<h1>jQuery Get</h1>\n<pre><code>$.ajax({\n    url: &quot;http://REMOTE_IP:8000/users/&quot;,\n    type: &quot;GET&quot;,\n    dataType: 'jsonp',\n    contentType: 'application/json',\n    success: function(data) {\n        console.log(data);\n    },\n    error: function(jqXHR, status, err) {\n        console.log(jqXHR);\n        console.log(status);\n        console.log(err);\n    }\n});\n</code></pre>\n<h1>Go Backend</h1>\n<pre><code>func GetUsersRoute(w http.ResponseWriter, r *http.Request) {\n    var queryResult []models.User\n\n    queryErr := Config.Users.Find(bson.M{}).All(&amp;queryResult)\n    resultsJSON, jsonErr := json.Marshal(queryResult)\n\n    handleQueryAndJsonErrors(w, queryErr, jsonErr)\n\n    // added these for cors, not sure they do anything helpful\n    w.Header().Set(&quot;Content-Type&quot;, &quot;application/json; charset=UTF-8&quot;)\n    w.Header().Set(&quot;Access-Control-Request-Headers&quot;, &quot;*&quot;)\n\n    w.WriteHeader(http.StatusOK)\n    w.Write(resultsJSON)\n}\n</code></pre>\n<p>I also have a logger attached to my go backend, and here are the request method and request URI that are printed out when I make the request:</p>\n<pre><code>GET /users?callback=jQuery223019655483671137586_1461946990647&amp;_=1461946990648\n</code></pre>\n<p>Here are some articles I found useful:<br />\n<a href=\"https://stackoverflow.com/questions/10120904/the-data-which-jquery-ajax-function-return-could-not-be-parse-to-json\">The data which jquery $.ajax function return could not be parse to json</a></p>\n<p><a href=\"https://github.com/codegangsta/martini-contrib/blob/master/cors/cors.go\" rel=\"nofollow noreferrer\">https://github.com/codegangsta/martini-contrib/blob/master/cors/cors.go</a></p>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Access-Control-Allow-Methods\" rel=\"nofollow noreferrer\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Access-Control-Allow-Methods</a></p>\n<p>Here are the errors returned with jQuery's err callback:\n<a href=\"https://i.stack.imgur.com/TsoXg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TsoXg.png\" alt=\"enter image description here\" /></a></p>\n<p>What could be going wrong?</p>\n"}, {"tags": ["http", "go", "cors", "fetch"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1461946283, "post_id": 36942583, "comment_id": 61444805, "body": "As @OneOfOne said in an answer, you can&#39;t do that.  Your JS code will have to issue the redirect, and only if it is embedded JS on the same site. Else, you&#39;ll get a CORS error."}], "answers": [{"comments": [{"owner": {"reputation": 186, "user_id": 4021293, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/be50cb780c45f41f9fa40b6736d1ca44?s=128&d=identicon&r=PG&f=1", "display_name": "goda", "link": "https://stackoverflow.com/users/4021293/goda"}, "edited": false, "score": 1, "creation_date": 1461947126, "post_id": 36942882, "comment_id": 61445274, "body": "Thank you! I initially handled redirects in the server because that was how I initially learned oauth2. I thought the server was to handle the key exchanges AND the redirects. But with a javascript front end, i can just fetch the url myself. So I just used window.location with the parsed URL."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1461945737, "creation_date": 1461945737, "answer_id": 36942882, "question_id": 36942583, "link": "https://stackoverflow.com/questions/36942583/golang-redirect-from-js-call-cors-error/36942882#36942882", "title": "Golang Redirect from JS call CORS error", "body": "<p>You can't do that, you will have to actually redirect the browser (open it in a pop window or something).</p>\n"}], "owner": {"reputation": 186, "user_id": 4021293, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/be50cb780c45f41f9fa40b6736d1ca44?s=128&d=identicon&r=PG&f=1", "display_name": "goda", "link": "https://stackoverflow.com/users/4021293/goda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 36942882, "answer_count": 1, "score": 1, "last_activity_date": 1510003416, "creation_date": 1461944747, "last_edit_date": 1510003416, "question_id": 36942583, "link": "https://stackoverflow.com/questions/36942583/golang-redirect-from-js-call-cors-error", "title": "Golang Redirect from JS call CORS error", "body": "<p>My golang function does not redirect anywhere when called by a javascript fetch function. This is an extension of my previous question which was too broad. <a href=\"https://stackoverflow.com/questions/36924580/facebook-oauth-cors-error?noredirect=1#comment61411314_36924580\">Facebook Oauth CORS error</a></p>\n\n<p>This is my javascript fetch function calling the golang api.</p>\n\n<pre><code>let config = {\n  method: 'GET',\n}\n\nfetch(\"http://localhost:7001/testFunction\", config).then(response =&gt; {\n  ...\n</code></pre>\n\n<p>This is my golang function trying to redirect afterwards</p>\n\n<pre><code>func testfunc(w http.ResponseWriter, r *http.Request) {\n    http.Redirect(w,r,\"https://www.facebook.com/dialog/oauth?..\", 302)\n    http.Redirect(w, r, \"http://localhost:7001/\", 302)\n    http.Redirect(w, r, \"http://google.com/\", 302)\n}\n</code></pre>\n\n<p>The outcome is supposed to be that the page redirects to a page outside the domain, but I consistently get this error on network.</p>\n\n<pre><code>Fetch API cannot load http://google.com. No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'null' is therefore not allowed access. If an opaque response serves your needs, set the request's mode to 'no-cors' to fetch the resource with CORS disabled.\n</code></pre>\n\n<p>I cannot use no-cors mode because I need to redirect to that page or even retrieve a json back.</p>\n\n<p>I made sure the golang server headers were correct and allowed the javascript origin (localhost:3000). And I made sure that the oauth api on facebook allowed the golang server domain (localhost:7001). Yet the redirects are always blocked when accessing domains outside of the localhost domain scope.</p>\n"}, {"tags": ["go", "network-programming", "udp", "timeout"], "answers": [{"comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 1, "creation_date": 1461946553, "post_id": 36942286, "comment_id": 61444954, "body": "I use <code>case &lt;- time.After(...)</code> all the time.  Highly second that approach as feedback I&#39;ve gotten from other devs like the simple pattern."}], "tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 4, "last_activity_date": 1461943850, "creation_date": 1461943850, "answer_id": 36942286, "question_id": 36942072, "link": "https://stackoverflow.com/questions/36942072/golang-why-doesnt-this-timeout-scheme-work/36942286#36942286", "title": "Golang why doesn&#39;t this timeout scheme work?", "body": "<p>You are using a switch for your channels, but you need a select. The switch doesn't know anything about channels and instead just tries to evaluate the expression in the case statements before the select. Your current code is equivalent to this:</p>\n\n<pre><code>func (c *uConnection) send(nr uint32) {\n    //transmitt message\n    c.outChan &lt;- c.buffer[nr].msg\n    timeout := make(chan bool, 1)\n    go func() {\n        timeoutTimer := time.After(c.retransTime)\n        &lt;-timeoutTimer\n        timeout &lt;- true\n    }()\n    tmp1 := &lt;-c.buffer[nr].signaler // this will block\n    tmp2 := &lt;-timeout\n    switch {\n    case tmp1 :\n        fmt.Printf(\"Ack confirmed: %v\\n\", nr)\n    case tmp2 :\n        fmt.Println(\"-----------timeout-----------\\n\")\n        //resending\n        c.send(nr)\n    }\n}\n</code></pre>\n\n<p>Your code should look like this (using select instead of switch):</p>\n\n<pre><code>func (c *uConnection) send(nr uint32) {\n    //transmitt message\n    c.outChan &lt;- c.buffer[nr].msg\n    timeout := make(chan bool, 1)\n    go func() {\n        timeoutTimer := time.After(c.retransTime)\n        &lt;-timeoutTimer\n        timeout &lt;- true\n    }()\n    select {\n    case &lt;-c.buffer[nr].signaler:\n        fmt.Printf(\"Ack confirmed: %v\\n\", nr)\n    case &lt;-timeout:\n        fmt.Println(\"-----------timeout-----------\\n\")\n        //resending\n        c.send(nr)\n    }\n}\n</code></pre>\n\n<p>Also your timeout goroutine is unnecessary. Instead of calling time.After, waiting on the channel and then sending into your own timeout channel you could directly wait on time.After. Example:</p>\n\n<pre><code>func (c *uConnection) send(nr uint32) {\n    //transmitt message\n    c.outChan &lt;- c.buffer[nr].msg\n    select {\n    case &lt;-c.buffer[nr].signaler:\n        fmt.Printf(\"Ack confirmed: %v\\n\", nr)\n    case &lt;-time.After(c.retransTime):\n        fmt.Println(\"-----------timeout-----------\\n\")\n        //resending\n        c.send(nr)\n    }\n}\n</code></pre>\n\n<p>This is faster, more clear and uses less memory.</p>\n"}], "owner": {"reputation": 166, "user_id": 5853709, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hkHXI.png?s=128&g=1", "display_name": "FS&#39;W&#230;hre", "link": "https://stackoverflow.com/users/5853709/fsw%c3%a6hre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 36942286, "answer_count": 1, "score": 2, "last_activity_date": 1461943850, "creation_date": 1461943231, "question_id": 36942072, "link": "https://stackoverflow.com/questions/36942072/golang-why-doesnt-this-timeout-scheme-work", "title": "Golang why doesn&#39;t this timeout scheme work?", "body": "<p>So i have this code block for sending a message. The message which gets passed to c.outChan is transmitted and if an ack is recieved in return, a \"true\" will be passed through the c.buffer[nr].signaler channel. This seems to work fine, but if the message is dropped ( no ack recieved ), instead of reaching the timeout print, it just stoppes, and i don't know why. Here is the code:</p>\n\n<pre><code>func (c *uConnection) send(nr uint32) {\n    //transmitt message\n    c.outChan &lt;- c.buffer[nr].msg\n    timeout := make(chan bool, 1)\n    go func() {\n        timeoutTimer := time.After(c.retransTime)\n        &lt;-timeoutTimer\n        timeout &lt;- true\n    }()\n    switch {\n    case &lt;-c.buffer[nr].signaler:\n        fmt.Printf(\"Ack confirmed: %v\\n\", nr)\n    case &lt;-timeout:\n        fmt.Println(\"-----------timeout-----------\\n\")\n        //resending\n        c.send(nr)\n    }\n}\n</code></pre>\n\n<p>What am i doing wrong?</p>\n"}, {"tags": ["go", "xml-parsing", "hl7-fhir"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461938463, "post_id": 36939874, "comment_id": 61439673, "body": "I think writing a custom unmarshaler is pretty much the only way for it."}, {"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461938867, "post_id": 36939874, "comment_id": 61439926, "body": "This is part of other XML whose definition is 10&#39;s of 1,000&#39;s of lines. Do I have to write an unmarshaler myself for the whole thing?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461938986, "post_id": 36939874, "comment_id": 61440021, "body": "No, just for the property struct."}, {"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461939162, "post_id": 36939874, "comment_id": 61440126, "body": "Ah, I see. If I add an Unmarshal method to the struct, it&#39;ll be called automagically by xml.Decoder.DecodeElement?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1461939272, "post_id": 36939874, "comment_id": 61440208, "body": "Yep, but keep in mind that you will have to also assign the Code member. If you figure it out, you should post the code as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461945940, "post_id": 36941496, "comment_id": 61444618, "body": "Thanks for sharing! a minor nitpick, <code>xml:&quot;code&gt;value,attr&quot;</code> isn&#39;t needed anymore so it can be safely removed.&#39;"}, {"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461946007, "post_id": 36941496, "comment_id": 61444651, "body": "I didn&#39;t realize that! I&#39;ll fix it."}], "tags": [], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "is_accepted": true, "score": 5, "last_activity_date": 1461946042, "last_edit_date": 1461946042, "creation_date": 1461941651, "answer_id": 36941496, "question_id": 36939874, "link": "https://stackoverflow.com/questions/36939874/tricky-go-xml-unmarshal-case/36941496#36941496", "title": "Tricky Go xml.Unmarshal() case", "body": "<p>Thanks to the pointer from OneOfOne, here's an implementation that works well with the standard XML unmarshaler:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\ntype Property struct {\n    Code  string `xml:\"code\"`\n    Value interface{}\n}\n\nconst xmldata = `&lt;properties&gt;\n  &lt;property&gt;\n&lt;code value=\"a\"/&gt;\n&lt;valueBoolean value=\"true\"/&gt;\n  &lt;/property&gt;\n  &lt;property&gt;\n&lt;code value=\"b\"/&gt;\n&lt;valueString value=\"apple\"/&gt;\n  &lt;/property&gt;\n  &lt;property&gt;\n&lt;code value=\"c\"/&gt;\n&lt;valueDecimal value=\"3.14159\"/&gt;\n  &lt;/property&gt;\n&lt;/properties&gt;\n`\n\nfunc (p *Property) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    if start.Name.Local != \"property\" {\n        return fmt.Errorf(\"Invalid start tag for Property\")\n    }\n\n    for {\n        tok, err := d.Token()\n\n        if tok == nil {\n            break\n        }\n\n        if err != nil {\n            return err\n        }\n\n        switch se := tok.(type) {\n        case xml.StartElement:\n            var value string\n            var valueAssigned bool\n\n            for _, attr := range se.Attr {\n                if attr.Name.Local == \"value\" {\n                    value = attr.Value\n                    valueAssigned = true\n                } else {\n                    return fmt.Errorf(\"Invalid attribute %s\", attr.Name.Local)\n                }\n            }\n\n            if !valueAssigned {\n                return fmt.Errorf(\"Valid attribute missing\")\n            }\n\n            switch se.Name.Local {\n            case \"code\":\n                p.Code = value\n            case \"valueBoolean\":\n                if value == \"true\" {\n                    p.Value = true\n                } else if value == \"false\" {\n                    p.Value = false\n                } else {\n                    return fmt.Errorf(\"Invalid string %s for Boolean value\", value)\n                }\n            case \"valueString\", \"valueCode\", \"valueUri\":\n                p.Value = value\n            case \"valueInteger\":\n                if ival, err := strconv.ParseInt(value, 10, 32); err != nil {\n                    return err\n                } else {\n                    p.Value = ival\n                }\n            case \"valueDecimal\":\n                if dval, err := strconv.ParseFloat(value, 64); err != nil {\n                    return err\n                } else {\n                    p.Value = dval\n                }\n            default:\n                return fmt.Errorf(\"Invalid tag %s for property\", se.Name.Local)\n            }\n        }\n    }\n\n    return nil\n}\n\nfunc main() {\n    r := strings.NewReader(xmldata)\n\n    type Properties struct {\n        List []Property `xml:\"property\"`\n    }\n\n    var properties Properties\n\n    d := xml.NewDecoder(r)\n\n    if err := d.Decode(&amp;properties); err != nil {\n        fmt.Println(err.Error())\n    }\n\n    for _, p := range properties.List {\n        switch p.Value.(type) {\n        case bool:\n            if p.Value.(bool) {\n                fmt.Println(p.Code, \"is true\")\n            } else {\n                fmt.Println(p.Code, \"is false\")\n            }\n        default:\n            fmt.Println(p.Code, \"=\", p.Value)\n        }\n    }\n}\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>a is true\nb = apple\nc = 3.14159\n</code></pre>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1464, "favorite_count": 1, "accepted_answer_id": 36941496, "answer_count": 1, "score": 5, "last_activity_date": 1461946042, "creation_date": 1461937113, "question_id": 36939874, "link": "https://stackoverflow.com/questions/36939874/tricky-go-xml-unmarshal-case", "title": "Tricky Go xml.Unmarshal() case", "body": "<p>I'm trying to unmarshal XML like this in Go:</p>\n\n<pre><code>&lt;property&gt;\n  &lt;code value=\"abc\"/&gt;\n  &lt;valueBoolean value=\"true\"/&gt;\n&lt;/property&gt;\n</code></pre>\n\n<p>or this</p>\n\n<pre><code>&lt;property&gt;\n  &lt;code value=\"abc\"/&gt;\n  &lt;valueString value=\"apple\"/&gt;\n&lt;/property&gt;\n</code></pre>\n\n<p>or this</p>\n\n<pre><code>&lt;property&gt;\n  &lt;code value=\"abc\"/&gt;\n  &lt;valueDecimal value=\"3.14159\"/&gt;\n&lt;/property&gt;\n</code></pre>\n\n<p>etc., into this:</p>\n\n<pre><code>type Property struct {\n    Code  string      `xml:\"code&gt;value,attr\"`\n    Value interface{}\n}\n</code></pre>\n\n<p>where the tag (<code>valueBoolean</code>, <code>valueString</code>, etc.) tells me what the type of the value attribute is. The XML that I'm trying to parse is part of <a href=\"http://hl7-fhir.github.io/\" rel=\"noreferrer\">an international standard</a>, so I don't have any control over its definition. It wouldn't be hard to implement parsing these things, something like:</p>\n\n<pre><code>var value string\nfor a := range se.Attr {\n    if a.Name.Local == \"value\" {\n        value = a.Value\n    } else {\n        // Invalid attribute\n    }\n}\nswitch se.Name.Local {\ncase \"code\":\ncase \"valueBoolean\":\n    property.Value = value == \"true\"\ncase \"valueString\":\n    property.Value = value\ncase \"valueInteger\":\n    property.Value, err = strconv.ParseInteger(value)\ncase \"valueDecimal\":\n    property.Value, err = strconv.ParseFloat(value)\n...\n}\n</code></pre>\n\n<p>but I can't figure out how to tell the XML package to find it, and these things are buried in other XML that I'd really rather use <code>xml.Unmarshal</code> to handle. Alternately, I could redefine the type as:</p>\n\n<pre><code>type Property struct {\n    Code         string `xml:\"code&gt;value,attr\"`\n    ValueBoolean bool   `xml:\"valueBoolean&gt;value,attr\"`\n    ValueString  string `xml:\"valueString&gt;value,attr\"`\n    ValueInteger int    `xml:\"valueInteger&gt;value,attr\"`\n    ValueDecimal float  `xml:\"valueDecimal&gt;value,attr\"`\n}\n</code></pre>\n\n<p>but that's pretty inefficient, particularly given that I'll have a large number of instances of these things, and this leaves me no way to derive the type without adding another attribute to indicate the type. </p>\n\n<p>Can I somehow tie this into the normal XML unmarshalling method, just handling the tricky part by hand, or do I need to write the whole unmarshaller for this type from scratch?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1461935071, "post_id": 36938823, "comment_id": 61437195, "body": "Just curious.. why don&#39;t you want to define a struct? Being a &quot;hassle&quot; doesn&#39;t seem like a good enough reason. Of course there are work arounds, but my suggestion would be to use a struct here, or to use a regexp + FindStringSubmatch."}, {"owner": {"reputation": 11591, "user_id": 769083, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Knu6Z.jpg?s=128&g=1", "display_name": "mnsr", "link": "https://stackoverflow.com/users/769083/mnsr"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1461936742, "post_id": 36938823, "comment_id": 61438425, "body": "@william.taylor.09 well, lets say i have a huge xml file, and i only want this one specific value that could be buried deep in a bunch of elements. Creating a struct is a pure annoyance. I just need a quick search to get to find the one matching attribute with minimal code"}], "answers": [{"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": false, "score": 0, "last_activity_date": 1461935506, "creation_date": 1461935506, "answer_id": 36939298, "question_id": 36938823, "link": "https://stackoverflow.com/questions/36938823/find-the-value-of-a-single-attribute-or-element/36939298#36939298", "title": "Find the value of a single attribute or element", "body": "<p>I don't know if it's less hassle but you could dig the value out \"manually\" doing something like:</p>\n\n<pre><code>scanner := bufio.NewScanner(reader)\nfor scanner.Scan() {\n   scannedText := scanner.Text()\n   i := strings.Index(scannedText, `id=\"`) + len(`id=\"`)\n   j := strings.Index(scannedText[i:], `\"`) + i\n   id, _ := strconv.Atoi(scannedText[i:j])\n}\n</code></pre>\n\n<p>I didn't test this snipped but have used this pattern.</p>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 0, "last_activity_date": 1461936494, "last_edit_date": 1461936494, "creation_date": 1461936185, "answer_id": 36939534, "question_id": 36938823, "link": "https://stackoverflow.com/questions/36938823/find-the-value-of-a-single-attribute-or-element/36939534#36939534", "title": "Find the value of a single attribute or element", "body": "<p>While using struct is the proper way, you can use regexp to match it:</p>\n\n<pre><code>var idRe = regexp.MustCompile(`&lt;something[^&gt;]+?id=\"([^\"]+)\"[^&gt;]+`)\n\nfunc FindIDs(in string) []string {\n    vals := idRe.FindAllStringSubmatch(in, -1)\n    out := make([]string, len(vals))\n    for i, v := range vals {\n        out[i] = v[1]\n    }\n    return out\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/iK7M6eXlzY\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}, {"comments": [{"owner": {"reputation": 11591, "user_id": 769083, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Knu6Z.jpg?s=128&g=1", "display_name": "mnsr", "link": "https://stackoverflow.com/users/769083/mnsr"}, "edited": false, "score": 0, "creation_date": 1461970955, "post_id": 36940454, "comment_id": 61456005, "body": "Thank you sir. I was hoping there would be an even simpler form with a struct, like type Result struct { Id string <code>xml:&quot;something&gt;id&quot;</code> } But i suppose this will do"}], "tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": true, "score": 1, "last_activity_date": 1461938772, "creation_date": 1461938772, "answer_id": 36940454, "question_id": 36938823, "link": "https://stackoverflow.com/questions/36938823/find-the-value-of-a-single-attribute-or-element/36940454#36940454", "title": "Find the value of a single attribute or element", "body": "<p>Regular expressions of scanner are not the perfect solution, because in complicated xml can happen, that you it won't find good id. It also does not solve problem with chars like &amp;amp; .. Only solution is Unmarshal, although, you don't have to describe a structure of elements, that don't bother you.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\nfunc main() {\n    type Something struct {\n        Id string `xml:\"id,attr\"`\n    }\n    type Result struct {\n        //XMLName xml.Name `xml:\"test\"`\n        Something    Something   `xml:\"something\"`\n    }\n    var v Result\n\n    data := `\n&lt;test&gt;\n   &lt;something id=\"123\"/&gt;\n   &lt;tag_that_i_ignore id=\"aaa\" attr=\"???\"/&gt;\n&lt;/test&gt;\n    `\n    err := xml.Unmarshal([]byte(data), &amp;v)\n    if err != nil {\n        fmt.Printf(\"error: %v\", err)\n        return\n    }\n    fmt.Printf(\"Result: %#v\\n\\n\", v)\n}\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/x5eFvdhpTW\" rel=\"nofollow\">https://play.golang.org/p/x5eFvdhpTW</a></p>\n"}], "owner": {"reputation": 11591, "user_id": 769083, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Knu6Z.jpg?s=128&g=1", "display_name": "mnsr", "link": "https://stackoverflow.com/users/769083/mnsr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 36940454, "answer_count": 3, "score": 0, "last_activity_date": 1461938772, "creation_date": 1461934208, "question_id": 36938823, "link": "https://stackoverflow.com/questions/36938823/find-the-value-of-a-single-attribute-or-element", "title": "Find the value of a single attribute or element", "body": "<p>Lets say i have an xml:</p>\n\n<pre><code>&lt;test&gt;\n    &lt;something id=\"\" /&gt;\n&lt;/test&gt;\n</code></pre>\n\n<p>How do i get the value of id without the hassle of creating a struct? Is that possible? If not, is there a short hand to find the value of id? </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 909136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd965d939ab170c5e5c14ca539402506?s=128&d=identicon&r=PG", "display_name": "thedotwriter", "link": "https://stackoverflow.com/users/909136/thedotwriter"}, "edited": false, "score": 0, "creation_date": 1461933876, "post_id": 36938623, "comment_id": 61436392, "body": "Well, that was blazing fast! It finally make sense, Thanks!"}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1461934896, "post_id": 36938623, "comment_id": 61437074, "body": "I&#39;ll tack on you have to be extra careful with scoping when using loops inside functions and using :=. Take for example: <a href=\"https://play.golang.org/p/KGTcJ2xm00\" rel=\"nofollow noreferrer\">play.golang.org/p/KGTcJ2xm00</a>. It&#39;s the exact same loop both times, except the second defines err ahead of time so we don&#39;t have to use := in the loop to define err."}], "tags": [], "owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "is_accepted": true, "score": 3, "last_activity_date": 1461935153, "last_edit_date": 1461935153, "creation_date": 1461933640, "answer_id": 36938623, "question_id": 36938575, "link": "https://stackoverflow.com/questions/36938575/why-redefining-a-variable-does-not-always-trigger-an-error/36938623#36938623", "title": "Why redefining a variable does not always trigger an error?", "body": "<p><a href=\"https://golang.org/doc/effective_go.html#redeclaration\" rel=\"nofollow\">As described in Effective Go</a>, the <code>:=</code> operator, when the left part is a list of names, declares the ones which aren't already declared. An error is only raised when all are already declared.</p>\n\n<p>This is especially convenient in this typical case:</p>\n\n<pre><code>a, err := someCall()\nif (err) ...\nb, err := someOtherCall()\nif (err) ...\n</code></pre>\n\n<p>In the documentation terms:</p>\n\n<blockquote>\n  <p>In a := declaration a variable v may appear even if it has already\n  been declared, provided:</p>\n  \n  <ul>\n  <li>this declaration is in the same scope as the existing declaration of v\n  (if v is already declared in an outer scope, the declaration will\n  create a new variable \u00a7),</li>\n  <li>the corresponding value in the\n  initialization is assignable to v, and</li>\n  <li>there is at least one other\n  variable in the declaration that is being declared anew.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 125, "user_id": 909136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd965d939ab170c5e5c14ca539402506?s=128&d=identicon&r=PG", "display_name": "thedotwriter", "link": "https://stackoverflow.com/users/909136/thedotwriter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 36938623, "answer_count": 1, "score": 1, "last_activity_date": 1461935153, "creation_date": 1461933539, "last_edit_date": 1461933663, "question_id": 36938575, "link": "https://stackoverflow.com/questions/36938575/why-redefining-a-variable-does-not-always-trigger-an-error", "title": "Why redefining a variable does not always trigger an error?", "body": "<p>I'm quite new to Go and I've stumble upon the following problem a few times already. I don't understand what's the underlying rule that allows (or not) the redefining of one variable with the help of <code>:=</code>. </p>\n\n<p>Can you please explain to me why <code>test := func3()</code> does trigger an error in the first script but works fine in the second script?</p>\n\n<p>The only thing that changes between both scripts is the position of the line that calls <code>func3()</code>.</p>\n\n<p>Thanks!</p>\n\n<h1>1st script</h1>\n\n<p><a href=\"https://play.golang.org/p/vvCI7nxHZL\" rel=\"nofollow\">https://play.golang.org/p/vvCI7nxHZL</a></p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n)\n\nfunc func1() (string, string) {\n  return \"\", \"\"\n}\n\nfunc func2() (string, string) {\n  return \"\", \"\"\n}\n\nfunc func3() string {\n  return \"\"\n}\n\nfunc main() {\n  test, test2 := func1()\n  test, test3 := func2()\n  test := func3()\n\n  fmt.Println(test, test2, test3)\n}\n</code></pre>\n\n<h1>2nd script</h1>\n\n<p><a href=\"https://play.golang.org/p/BTTYCGEJ4E\" rel=\"nofollow\">https://play.golang.org/p/BTTYCGEJ4E</a></p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n)\n\nfunc func1() (string, string) {\n  return \"\", \"\"\n}\n\nfunc func2() (string, string) {\n  return \"\", \"\"\n}\n\nfunc func3() string {\n  return \"\"\n}\n\nfunc main() {\n  test := func3()\n  test, test2 := func1()\n  test, test3 := func2()\n\n  fmt.Println(test, test2, test3)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "edited": false, "score": 0, "creation_date": 1582818214, "post_id": 36940619, "comment_id": 106915521, "body": "doesn&#39;t help if you use <code>TestSuite</code>"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 2, "last_activity_date": 1461939217, "creation_date": 1461939217, "answer_id": 36940619, "question_id": 36938520, "link": "https://stackoverflow.com/questions/36938520/use-go-test-to-list-all-tests-case/36940619#36940619", "title": "Use &quot;go test&quot; to list all tests case", "body": "<p>There's no saved metadata, grepping is the only way pretty much.</p>\n\n<p>If you have <a href=\"http://beyondgrep.com/\" rel=\"nofollow\">ack</a>, you can easily use something like this:</p>\n\n<pre><code>\u279c ack 'func Test[^(]+'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3931, "user_id": 2244081, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2a084ed5223858de201a3ebaf53c4fa8?s=128&d=identicon&r=PG", "display_name": "Ignacio Vergara Kausel", "link": "https://stackoverflow.com/users/2244081/ignacio-vergara-kausel"}, "is_accepted": true, "score": 12, "last_activity_date": 1497863198, "creation_date": 1497863198, "answer_id": 44626375, "question_id": 36938520, "link": "https://stackoverflow.com/questions/36938520/use-go-test-to-list-all-tests-case/44626375#44626375", "title": "Use &quot;go test&quot; to list all tests case", "body": "<p>Just saw <a href=\"https://tip.golang.org/doc/go1.9#go-test-list\" rel=\"noreferrer\">this</a> in the Go1.9 release notes (draft) and I think could be what you are looking for</p>\n\n<blockquote>\n  <p>The go test command accepts a new -list flag, which takes a regular\n  expression as an argument and prints to stdout the name of any tests,\n  benchmarks, or examples that match it, without running them.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 6206493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec46fdf9d57cde84b75a444a5617c90?s=128&d=identicon&r=PG&f=1", "display_name": "gastrodon", "link": "https://stackoverflow.com/users/6206493/gastrodon"}, "is_accepted": false, "score": 1, "last_activity_date": 1595893266, "creation_date": 1595893266, "answer_id": 63125108, "question_id": 36938520, "link": "https://stackoverflow.com/questions/36938520/use-go-test-to-list-all-tests-case/63125108#63125108", "title": "Use &quot;go test&quot; to list all tests case", "body": "<p>If you do not use <code>ack</code> as another answer mentions, you may simply <code>grep -r &quot;func Test&quot; . | wc -l</code>. This works because</p>\n<ul>\n<li>grep for substring <code>func Test</code>, which should include every test func (it also includes <code>TestMain</code>)</li>\n<li>flag <code>-r</code> tells grep to look in subdirectories recursively</li>\n<li><code>wc -l</code> will count the number of lines piped into it, which should be the number of test cases</li>\n</ul>\n"}], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4082, "favorite_count": 2, "accepted_answer_id": 44626375, "answer_count": 3, "score": 6, "last_activity_date": 1595893266, "creation_date": 1461933383, "question_id": 36938520, "link": "https://stackoverflow.com/questions/36938520/use-go-test-to-list-all-tests-case", "title": "Use &quot;go test&quot; to list all tests case", "body": "<p>With <code>go test -v pattern</code> I can select and only run the tests that matches a pattern, but is there any way that I can list all test cases without run them. There is this case that the project just handed over to me has a lot of test case and I need to select some tests to run. I know greping the sources <code>xxx_test.go</code> is a way but is there more elegant way? I mean, each test has its meta data stored in some where, right? as the tests are required to be in a specific signature(<code>func TestXXX(*testing.T)</code>). This meta data can be used to do this kind of work.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 1, "last_activity_date": 1461929641, "last_edit_date": 1461929641, "creation_date": 1461929213, "answer_id": 36937156, "question_id": 36937076, "link": "https://stackoverflow.com/questions/36937076/undefined-function-declared-in-another-package/36937156#36937156", "title": "undefined: function (declared in another package)", "body": "<p>In Go the symbols (including function names) starting with lower case letters are not exported and so are not visible to other packages.</p>\n\n<p>Rename the function to <code>UtilsDoSomething</code>.</p>\n\n<p>If you strongly oppose exporting this function and you are using Go 1.5 or later, you can make your function visible to only your project by placing <code>utils</code> directory inside <code>internal</code> directory.</p>\n\n<p><a href=\"https://docs.google.com/document/d/1e8kOo3r51b2BWtTs_1uADIA5djfXhPT36s6eHVRIvaU/edit\" rel=\"nofollow\">Specification of internal packages</a>  </p>\n"}, {"comments": [{"owner": {"reputation": 3293, "user_id": 5120292, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2d26cfd2bc52de7902b76cb433685f96?s=128&d=identicon&r=PG&f=1", "display_name": "Xys", "link": "https://stackoverflow.com/users/5120292/xys"}, "edited": false, "score": 0, "creation_date": 1461932644, "post_id": 36937158, "comment_id": 61435610, "body": "Thank you for your answer !"}], "tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": true, "score": 9, "last_activity_date": 1461929221, "creation_date": 1461929221, "answer_id": 36937158, "question_id": 36937076, "link": "https://stackoverflow.com/questions/36937076/undefined-function-declared-in-another-package/36937158#36937158", "title": "undefined: function (declared in another package)", "body": "<p>You forgot the package prefix in <code>main.go</code> and your function is not <a href=\"https://golang.org/ref/spec#Exported_identifiers\">exported</a>, meaning it is not accessible from other packages. To export an identifier, use a capital letter at the beginning of the name:</p>\n\n<pre><code>utils.UtilsDoSomething()\n</code></pre>\n\n<p>Once you have the <code>utils</code> prefix you can also drop the <code>Utils</code> in the name:</p>\n\n<pre><code>utils.DoSomething()\n</code></pre>\n\n<p>If you want to import everything from the <code>utils</code> package into the namespace of your main application do:</p>\n\n<pre><code>import . \"cvs/user/project/utils\"\n</code></pre>\n\n<p>After that you can use <code>DoSomething</code> directly.</p>\n"}, {"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 1, "last_activity_date": 1461929322, "creation_date": 1461929322, "answer_id": 36937194, "question_id": 36937076, "link": "https://stackoverflow.com/questions/36937076/undefined-function-declared-in-another-package/36937194#36937194", "title": "undefined: function (declared in another package)", "body": "<p>When you are referencing a function from a package you need to reference it using the <code>package name.Function name</code> (with capital case).</p>\n\n<p>In your case use it as:</p>\n\n<p><code>utils.UtilsDoSomething()</code>.</p>\n"}], "owner": {"reputation": 3293, "user_id": 5120292, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2d26cfd2bc52de7902b76cb433685f96?s=128&d=identicon&r=PG&f=1", "display_name": "Xys", "link": "https://stackoverflow.com/users/5120292/xys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3422, "favorite_count": 0, "accepted_answer_id": 36937158, "answer_count": 3, "score": 4, "last_activity_date": 1461929641, "creation_date": 1461928971, "question_id": 36937076, "link": "https://stackoverflow.com/questions/36937076/undefined-function-declared-in-another-package", "title": "undefined: function (declared in another package)", "body": "<p>my project organisation looks like this :</p>\n\n<ul>\n<li>GOPATH\n\n<ul>\n<li>src\n\n<ul>\n<li>cvs/user/project\n\n<ul>\n<li>main.go</li>\n<li>utils\n\n<ul>\n<li>utils.go</li>\n</ul></li>\n</ul></li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>main.go looks like this :</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"cvs/user/project/utils\"\n)\n\nfunc main() {\n   ...\n   utilsDoSomething()\n   ...\n}\n</code></pre>\n\n<p>and utils.go :</p>\n\n<pre><code>package utils\n\nimport (\n  \"fmt\"\n)   \n\nfunc utilsDoSomething() {\n    ...\n}\n</code></pre>\n\n<p>The compiler tells me that :</p>\n\n<pre><code>main.go imported and not used: \"cvs/user/project/utils\"\n\nmain.go undefined: utilsDoSomething\n</code></pre>\n\n<p>I don't know what I'm doing wrong. Any idea would be helpful, thank you in advance !</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "edited": false, "score": 0, "creation_date": 1461923514, "post_id": 36935089, "comment_id": 61429462, "body": "Are you creating multiple connections, or passing one around?"}, {"owner": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "edited": false, "score": 0, "creation_date": 1461923813, "post_id": 36935089, "comment_id": 61429686, "body": "Did you use postgres ? if yes, check your <code>server.properties</code> file, and update the <code>MaxConnections</code> propertie"}, {"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "reply_to_user": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "edited": false, "score": 0, "creation_date": 1461924033, "post_id": 36935089, "comment_id": 61429829, "body": "@matt.s : I use the default one, just from the GORM documentation."}, {"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "reply_to_user": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "edited": false, "score": 0, "creation_date": 1461924040, "post_id": 36935089, "comment_id": 61429839, "body": "@sbouaked : yes, it is. And what I need to check?"}, {"owner": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "edited": false, "score": 0, "creation_date": 1461924308, "post_id": 36935089, "comment_id": 61430024, "body": "on ubuntu open /etc/postgresql/9.1/main/postgresql.conf an upgrade the &#39;MaxConnections&#39; propertie.  <a href=\"http://stackoverflow.com/questions/30778015/how-to-increase-the-max-connections-in-postgres\" title=\"how to increase the max connections in postgres\">stackoverflow.com/questions/30778015/&hellip;</a>"}, {"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "reply_to_user": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "edited": false, "score": 0, "creation_date": 1461933120, "post_id": 36935089, "comment_id": 61435917, "body": "@sbouaked : I am not sure if it related to the postgres server. The app is in develop by me and only me access it. Its not make sense if the problem is the postgres server since only me access it. There is something on the go-gorm it self."}], "answers": [{"comments": [{"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1461971570, "post_id": 36939646, "comment_id": 61456170, "body": "Don&#39;t you think this should be done automatically by GORM?"}, {"owner": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "reply_to_user": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1462180515, "post_id": 36939646, "comment_id": 61512850, "body": "Are you not using Postgresql at all? I&#39;d imagine this should be done by GORM (but couldn&#39;t say for sure)."}, {"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1462192532, "post_id": 36939646, "comment_id": 61520041, "body": "I am using Postgresql. Right now I defer a DB.close every open new connection on GORM."}, {"owner": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "reply_to_user": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1462199968, "post_id": 36939646, "comment_id": 61524753, "body": "That sounds like your problem. I&#39;d open 1 connection, and make GORM <i>refer</i> to it on each instance. A DB connection should only ever be made once and not like you are using it"}, {"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 2, "creation_date": 1462231626, "post_id": 36939646, "comment_id": 61540437, "body": "So, I should call db, err := gorm.Open(&quot;postgres&quot;, &quot;user=gorm dbname=gorm&quot;) once? And use single db to my entire application? Is that safe on multi thread application?"}, {"owner": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "reply_to_user": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1462266255, "post_id": 36939646, "comment_id": 61552764, "body": "Yes you definitely should and it should handle all of that out of the box"}, {"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 1, "creation_date": 1462266397, "post_id": 36939646, "comment_id": 61552839, "body": "Already change it to single DB connection, and so far so good. I think you can update your answer above, and i will accept your answer. Thanks a lot"}], "tags": [], "owner": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "is_accepted": true, "score": 1, "last_activity_date": 1462269303, "last_edit_date": 1462269303, "creation_date": 1461936477, "answer_id": 36939646, "question_id": 36935089, "link": "https://stackoverflow.com/questions/36935089/gorm-pq-too-many-connections/36939646#36939646", "title": "GORM pq too many connections", "body": "<p>The error message you are getting is a PostgreSQL error and not GORM. It is caused as you are opening the database connection more than once.</p>\n\n<pre><code>db, err := gorm.Open(\"postgres\", \"user=gorm dbname=gorm\")\n</code></pre>\n\n<p>Should be initiated once and referred to after that.</p>\n"}, {"tags": [], "owner": {"reputation": 68, "user_id": 10114750, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g2LJW3hcb9c/AAAAAAAAAAI/AAAAAAAAAhs/-K6dxblRlNQ/photo.jpg?sz=128", "display_name": "Ravishankar S R", "link": "https://stackoverflow.com/users/10114750/ravishankar-s-r"}, "is_accepted": false, "score": -1, "last_activity_date": 1565012433, "last_edit_date": 1565012433, "creation_date": 1565011813, "answer_id": 57359660, "question_id": 36935089, "link": "https://stackoverflow.com/questions/36935089/gorm-pq-too-many-connections/57359660#57359660", "title": "GORM pq too many connections", "body": "<pre><code>sync.Once.Do(func() {\n    instance, err := gorm.Open(\"postgres\",\n        \"root:password@\"+\n            \"tcp(localhost:3306)/rav\"+\n            \"?charset=utf8&amp;parseTime=True\")\n    if err != nil {\n        log.Println(\"Connection Failed to Open\")\n        return\n    }\n    log.Println(\"Connection Established here\")\n    instance.DB().SetMaxIdleConns(10)\n    instance.LogMode(true)\n})\n</code></pre>\n\n<h3>You can restrict the connection to singleton function so the connection happens once even though it gets called multiple times.</h3>\n"}], "owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4282, "favorite_count": 0, "accepted_answer_id": 36939646, "answer_count": 2, "score": 0, "last_activity_date": 1565097956, "creation_date": 1461923436, "last_edit_date": 1565097956, "question_id": 36935089, "link": "https://stackoverflow.com/questions/36935089/gorm-pq-too-many-connections", "title": "GORM pq too many connections", "body": "<p>I am using GORM with my project, everything is good until I got an error that said:</p>\n\n<pre><code>pq: sorry, too many clients already\n</code></pre>\n\n<p>I just use the default configuration. The error happened after I did a lot of test requests on my application. </p>\n\n<p>And the error is gone after I restart my application. So, I am thinking that the GORM connection is not released after I'm done with the query. I don't check it very deep enough on GORM code, I just ask here maybe someone has already experience about it?</p>\n"}]