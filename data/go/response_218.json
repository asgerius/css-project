[{"tags": ["http", "go", "io", "handler"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1552516361, "post_id": 55152070, "comment_id": 97044749, "body": "It is common practice  to ignore the error."}, {"owner": {"reputation": 375, "user_id": 7586020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7579bdcac485b4049acfbd184604219?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7586020/steve"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1552517137, "post_id": 55152070, "comment_id": 97044977, "body": "@ThunderCat I am aware. My question was how to handle this error if i dont want to ignore"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 6, "creation_date": 1552518380, "post_id": 55152070, "comment_id": 97045344, "body": "You can log it, return an http server error, or ignore it. What&#39;s &quot;best&quot; is up to you."}, {"owner": {"reputation": 5182, "user_id": 1366533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cqijr.png?s=128&g=1", "display_name": "johlo", "link": "https://stackoverflow.com/users/1366533/johlo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1552521095, "post_id": 55152070, "comment_id": 97046041, "body": "@JimB I think the question is whether it is possible to retry the <code>Write()</code> call if it errors out (e.g. with a temporary network error)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5182, "user_id": 1366533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cqijr.png?s=128&g=1", "display_name": "johlo", "link": "https://stackoverflow.com/users/1366533/johlo"}, "edited": false, "score": 1, "creation_date": 1552521715, "post_id": 55152070, "comment_id": 97046203, "body": "@johlo: there&#39;s unlikely to be temporary errors at that point. There&#39;s typically a lot of layers buffering the caller from actual network connection. You&#39;re more likely to see things like <code>ErrContentLength</code>, <code>ErrBodyNotAllowed</code>, <code>ErrHijacked</code>, etc."}, {"owner": {"reputation": 375, "user_id": 7586020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7579bdcac485b4049acfbd184604219?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7586020/steve"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1552523064, "post_id": 55152070, "comment_id": 97046544, "body": "@JimB in typical case where write fails, would client receive 200 with partial data? In typical case, would it even be possible to return 5xx?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1552524251, "post_id": 55152070, "comment_id": 97046832, "body": "Good point, trying to return a server error probably isn\u2019t feasible in most cases, or worth the effort even when it is."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1552532812, "post_id": 55152070, "comment_id": 97048769, "body": "The best you can do is log the error.  Errors at the network layer are usually because data cannot be sent to the peer.  There&#39;s no recovery from that.  The errors indicating a programmer error (ErrHijacked, ErrContentLength, ...) require a code fix."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1552573876, "post_id": 55152070, "comment_id": 97069404, "body": "&quot;would it even be possible to return 5xx&quot; no. Once <code>Write</code> has been called, it is too late to issue new status or headers using <code>WriteHeader</code>, due to the nature of HTTP."}], "answers": [{"tags": [], "owner": {"reputation": 2842, "user_id": 648741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/47813cc59b0edb414b88601f1defe02a?s=128&d=identicon&r=PG", "display_name": "jochen", "link": "https://stackoverflow.com/users/648741/jochen"}, "is_accepted": false, "score": 1, "last_activity_date": 1561657736, "creation_date": 1561657736, "answer_id": 56796310, "question_id": 55152070, "link": "https://stackoverflow.com/questions/55152070/best-way-to-handle-error-from-write-call-in-go-http-handler/56796310#56796310", "title": "Best way to handle error from Write call in Go http handler", "body": "<p>At this point you will only see two types of errors:</p>\n\n<ul>\n<li><p>network errors, (<em>e.g.</em> if the client goes away while you are trying to send data), or</p></li>\n<li><p>errors caused by bugs in your server (<em>e.g.</em> if you manually set <code>Content-Length</code> and then try to write more data than you claimed, you will get <code>ErrContentLength</code>).</p></li>\n</ul>\n\n<p>You can look at the implementation of the <code>response</code> class in <a href=\"https://golang.org/src/net/http/server.go\" rel=\"nofollow noreferrer\">net/http/server.go</a>, to get an idea of errors you may see from the default <code>ResponseWriter</code>.\nHow to handle these errors?</p>\n\n<ul>\n<li><p>For errors like <code>ErrContentLength</code>, which indicate bugs in the server, it seems reasonable to log these, because the error messages may help to fix the server.</p></li>\n<li><p>To me it would seem reasonable to simply ignore network errors, but of course these could also be logged, if needed.</p></li>\n<li><p>One of the first things <code>Write()</code> does, is to make sure the headers are sent.  Thus, by the time you see an error code returned by <code>Write()</code>, it will be too late to attempt to change the HTTP status code.  Given this, it seems not worth trying (and probably is impossible) to notify the client that something went wrong.</p></li>\n</ul>\n"}], "owner": {"reputation": 375, "user_id": 7586020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7579bdcac485b4049acfbd184604219?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7586020/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1561657736, "creation_date": 1552515859, "last_edit_date": 1552517175, "question_id": 55152070, "link": "https://stackoverflow.com/questions/55152070/best-way-to-handle-error-from-write-call-in-go-http-handler", "title": "Best way to handle error from Write call in Go http handler", "body": "<p>What is best way to handle <code>Write</code> error in http handler.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func hello(w http.ResponseWriter, r *http.Request) {\n  n, err := w.Write([]byte(\"hi\"))\n  // how should we handle this error?\n}\n</code></pre>\n\n<p>I suppose I can take n and try to Write again with remainder of bytes.</p>\n"}, {"tags": ["go", "grpc"], "comments": [{"owner": {"reputation": 4530, "user_id": 2361497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce788c4eb1189394cfe46a6e40a4dd11?s=128&d=identicon&r=PG", "display_name": "Vitaly Isaev", "link": "https://stackoverflow.com/users/2361497/vitaly-isaev"}, "edited": false, "score": 0, "creation_date": 1553252782, "post_id": 55151425, "comment_id": 97324852, "body": "This use case looks very strange. Could you please provide a little more information about why you need it?"}, {"owner": {"reputation": 53, "user_id": 10651854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a317565cd0dff9e149e448c0b8a424?s=128&d=identicon&r=PG&f=1", "display_name": "Bugsy", "link": "https://stackoverflow.com/users/10651854/bugsy"}, "reply_to_user": {"reputation": 4530, "user_id": 2361497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce788c4eb1189394cfe46a6e40a4dd11?s=128&d=identicon&r=PG", "display_name": "Vitaly Isaev", "link": "https://stackoverflow.com/users/2361497/vitaly-isaev"}, "edited": false, "score": 0, "creation_date": 1553343573, "post_id": 55151425, "comment_id": 97354415, "body": "What&#39;s strange about switching namespace. In case you can&#39;t start your application in the correct namespace, you will have to switch in order to access the server. In case you need to access servers running in different namespaces, you can&#39;t solve the problem by starting the application in one of these namespaces. The example just illustrates the problem."}, {"owner": {"reputation": 4530, "user_id": 2361497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce788c4eb1189394cfe46a6e40a4dd11?s=128&d=identicon&r=PG", "display_name": "Vitaly Isaev", "link": "https://stackoverflow.com/users/2361497/vitaly-isaev"}, "edited": false, "score": 0, "creation_date": 1553409447, "post_id": 55151425, "comment_id": 97369215, "body": "1. What is a reason you don&#39;t know the appropriate network namespace at the application startup? 2. Accessing servers in different namespace looks strange as well. From my point of view, for the remote access servers must be distinguished via endpoints (<code>host:port</code>). Remote client should not know about sever&#39;s machine local network settings. So the use case is still not clear."}, {"owner": {"reputation": 53, "user_id": 10651854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a317565cd0dff9e149e448c0b8a424?s=128&d=identicon&r=PG&f=1", "display_name": "Bugsy", "link": "https://stackoverflow.com/users/10651854/bugsy"}, "reply_to_user": {"reputation": 4530, "user_id": 2361497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce788c4eb1189394cfe46a6e40a4dd11?s=128&d=identicon&r=PG", "display_name": "Vitaly Isaev", "link": "https://stackoverflow.com/users/2361497/vitaly-isaev"}, "edited": false, "score": 0, "creation_date": 1553461408, "post_id": 55151425, "comment_id": 97382845, "body": "1. Who said I don&#39;t know the network namespaces at startup? I know all three of them (including default network namespace). 2. Not sure I understand what you mean, but I think it is more important to focus on the GRPC problem rather than the use case. However, there&#39;s nothing strange with separating different types of network traffic on different networks (for instance OAM, backhaul, fronthaul). I don&#39;t think it&#39;s strange to isolate those networks using network namespaces."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10651854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a317565cd0dff9e149e448c0b8a424?s=128&d=identicon&r=PG&f=1", "display_name": "Bugsy", "link": "https://stackoverflow.com/users/10651854/bugsy"}, "edited": false, "score": 1, "creation_date": 1574917941, "post_id": 59061020, "comment_id": 104400666, "body": "Yes, a custom dialer was the solution. I gave up on stack overflow and asked the GRPC developers instead, since they understood the usecase and showed interest in finding a solution."}], "tags": [], "owner": {"reputation": 26, "user_id": 7172517, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9le723ePmXg/AAAAAAAAAAI/AAAAAAAAIZI/e6miO6Q808E/photo.jpg?sz=128", "display_name": "tcfw", "link": "https://stackoverflow.com/users/7172517/tcfw"}, "is_accepted": true, "score": 1, "last_activity_date": 1574811961, "creation_date": 1574811961, "answer_id": 59061020, "question_id": 55151425, "link": "https://stackoverflow.com/questions/55151425/are-there-any-known-limitations-when-running-grpc-after-setting-a-network-namesp/59061020#59061020", "title": "Are there any known limitations when running GRPC after setting a network namespace in Golang?", "body": "<p>I had the exact same problem where the netns kept switching back to the original namespace on every new goroutine regardless of locking OS threads or not. </p>\n\n<p>I found that as long as the server is started in the correct netns (I gave up trying to do this programmatically and just spawned the server proc via <code>exec.Command</code>), you just have to set a custom dialer for the GRPC client to restore the goroutine during the connection to the right netns:</p>\n\n<pre><code>dialOpts = append(dialOpts, grpc.WithDialer(func(addr string, timeout time.Duration) (net.Conn, error) {\n        netns.Set(newns)\n        return net.DialTimeout(\"tcp\", addr, timeout)\n    }))\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10651854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a317565cd0dff9e149e448c0b8a424?s=128&d=identicon&r=PG&f=1", "display_name": "Bugsy", "link": "https://stackoverflow.com/users/10651854/bugsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 59061020, "answer_count": 1, "score": 1, "last_activity_date": 1574811961, "creation_date": 1552512186, "last_edit_date": 1552560129, "question_id": 55151425, "link": "https://stackoverflow.com/questions/55151425/are-there-any-known-limitations-when-running-grpc-after-setting-a-network-namesp", "title": "Are there any known limitations when running GRPC after setting a network namespace in Golang?", "body": "<p>I'm experiencing a problem to communicate between GRPC client and server after switching network namespace in my Golang project. To zoom in on this issue, I modified the  GRPC example program Hello World accordingly with the same problem as a result. Are there any known limitations when using GRPC after switching namespace in a golang application?</p>\n\n<p>I have read  about issues related to switching namespace in Golang, but I guess it depends on the GRPC behaviour if this could lead to a problem or not.</p>\n\n<ol>\n<li><p>Does the GRPC client spawn any additional goroutines? Such a goroutine would not necessarily execute in the same namespace as the original goroutine locked the thread due to the namespace switch.</p></li>\n<li><p>I assume that the GRPC server spawns goroutines for each client, but does it create a socket in the original goroutine before a new is spawned? This question is also related to that the spawned goroutines doesn't have to execute in the same namespace as where grpc.Serve() was called (namespace switch requires runtime.LockOSThread()).  </p></li>\n</ol>\n\n<p>Communication works in case server and client are started in matching namespaces (ip netns exec...), but fails in case namespace switch is performed internally in the client. Communication also works when namespace switch is performed internally in the server, so the problem should be in the client.</p>\n\n<p>greeter_client/main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"runtime\"\n    \"syscall\"\n    \"time\"\n\n    pb \"grpctest/helloworld/helloworld\"\n\n    \"github.com/vishvananda/netns\"\n    \"golang.org/x/net/context\"\n    \"google.golang.org/grpc\"\n)\n\nconst (\n    defaultName    = \"world\"\n    defaultAddress = \"localhost:50051\"\n    nsEnv          = \"NAMESPACE\"\n    addressEnv     = \"ADDRESS\"\n    blockEnv       = \"DIALBLOCK\"\n)\n\nfunc main() {\n    fmt.Printf(\"* Client thread id before runtime.LockOSThread(): %d\\n\", syscall.Gettid())\n    runtime.LockOSThread()\n    defer runtime.UnlockOSThread()\n    fmt.Printf(\"* Client thread id after runtime.LockOSThread(): %d\\n\", syscall.Gettid())\n\n    var dialOpts []grpc.DialOption\n    dialOpts = append(dialOpts, grpc.WithInsecure())\n    _, ok := os.LookupEnv(blockEnv)\n    if ok == true {\n        dialOpts = append(dialOpts, grpc.WithBlock())\n        fmt.Printf(\"* Dial in blocked mode\\n\")\n    } else {\n        fmt.Printf(\"* Dial in unblocked mode\\n\")\n    }\n\n    address, ok := os.LookupEnv(addressEnv)\n    if ok == false {\n        address = defaultAddress\n    }\n\n    fmt.Printf(\"* Talk to server at %s\\n\", address)\n\n    var origns netns.NsHandle\n    namespace, ok := os.LookupEnv(nsEnv)\n    if ok {\n        fmt.Printf(\"* Switch namespace to %s\\n\", namespace)\n        origns, err := netns.Get()\n        if err != nil {\n            log.Fatal(\"failed to get current namespace\")\n        }\n\n        defer origns.Close()\n        newns, err := netns.GetFromName(namespace)\n        if err != nil {\n            log.Fatalf(\"failed to get new namespace: %s\", namespace)\n        }\n\n        err = netns.Set(newns)\n        if err != nil {\n            log.Fatalf(\"failed to set new namespace: %s\", namespace)\n        }\n\n        defer newns.Close()\n    }\n\n    fmt.Printf(\"* Client thread id before grpc.Dial(): %d\\n\", syscall.Gettid())\n    // Set up a connection to the server.\n    conn, err := grpc.Dial(address, dialOpts...)\n    if err != nil {\n        log.Fatalf(\"did not connect: %v\", err)\n    }\n    defer conn.Close()\n    fmt.Printf(\"* Client thread id before pb.NewGreeterClient(): %d\\n\", syscall.Gettid())\n    c := pb.NewGreeterClient(conn)\n    fmt.Printf(\"* Client thread id after pb.NewGreeterClient(): %d\\n\", syscall.Gettid())\n\n    // Contact the server and print out its response.\n    name := defaultName\n    if len(os.Args) &gt; 1 {\n        name = os.Args[1]\n    }\n\n    r, err := c.SayHello(context.Background(), &amp;pb.HelloRequest{Name: name})\n    if err != nil {\n        fmt.Printf(\"could not greet: %v\", err)\n        select {}\n        log.Fatalf(\"could not greet: %v\", err)\n    }\n    fmt.Printf(\"* Client thread id after c.SayHello(): %d\\n\", syscall.Gettid())\n\n    log.Printf(\"Greeting: %s\", r.Message)\n    time.Sleep(5 * time.Second)\n\n    if namespace != \"\" {\n        netns.Set(origns)\n    }\n\n    fmt.Printf(\"* Client thread id at exit: %d\\n\", syscall.Gettid())\n}\n</code></pre>\n\n<p>greeter_server/main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"os\"\n    \"runtime\"\n    \"syscall\"\n\n    pb \"grpctest/helloworld/helloworld\"\n\n    \"github.com/vishvananda/netns\"\n    \"golang.org/x/net/context\"\n    \"google.golang.org/grpc\"\n    \"google.golang.org/grpc/reflection\"\n)\n\nconst (\n    port  = \":50051\"\n    nsEnv = \"NAMESPACE\"\n)\n\n// server is used to implement helloworld.GreeterServer.\ntype server struct{}\n\n// SayHello implements helloworld.GreeterServer\nfunc (s *server) SayHello(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) {\n    fmt.Printf(\"* RPC call server thread id: %d\\n\", syscall.Gettid())\n    return &amp;pb.HelloReply{Message: \"Hello \" + in.Name}, nil\n}\n\nfunc main() {\n    runtime.LockOSThread()\n    defer runtime.UnlockOSThread()\n    var origns netns.NsHandle\n\n    namespace := os.Getenv(nsEnv)\n    if namespace != \"\" {\n        fmt.Printf(\"* Switch namespace to %s\\n\", namespace)\n        origns, err := netns.Get()\n        if err != nil {\n            log.Fatal(\"failed to get current namespace\")\n        }\n\n        defer origns.Close()\n        newns, err := netns.GetFromName(namespace)\n        if err != nil {\n            log.Fatalf(\"failed to get new namespace: %s\", namespace)\n        }\n\n        err = netns.Set(newns)\n        if err != nil {\n            log.Fatalf(\"failed to set new namespace: %s\", namespace)\n        }\n\n        defer newns.Close()\n    }\n\n    fmt.Printf(\"* Main server thread id: %d\\n\", syscall.Gettid())\n    lis, err := net.Listen(\"tcp\", port)\n    if err != nil {\n        log.Fatalf(\"failed to listen: %v\", err)\n    }\n    s := grpc.NewServer()\n    pb.RegisterGreeterServer(s, &amp;server{})\n    // Register reflection service on gRPC server.\n    reflection.Register(s)\n\n    if err := s.Serve(lis); err != nil {\n        log.Fatalf(\"failed to serve: %v\", err)\n    }\n\n    if namespace != \"\" {\n        netns.Set(origns)\n    }\n\n    fmt.Printf(\"* Main server exits (thread id: %d)\\n\", syscall.Gettid())\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "gcloud", "google-cloud-build"], "comments": [{"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 1, "creation_date": 1552513727, "post_id": 55151388, "comment_id": 97043800, "body": "I assume you&#39;re <code>gcloud app deploy</code>&#39;ing from the <code>.&#47;web</code> directory which then doesn&#39;t include copying the <code>.&#47;folder</code> directory along with it. I suspect it works locally but doesn&#39;t remotely because the <code>.&#47;folder</code> directory is not there. I&#39;m learning <code>go mod</code> but I think you likely want to reference <code>.&#47;folder</code> using it&#39;s full path, e.g. <code>github.com&#47;jon&#47;folder</code> rather than the relative reference, treat these as distinct (separately managed|versioned) packages and have these pulled when not found."}, {"owner": {"reputation": 4657, "user_id": 4086590, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/yngmk.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/4086590/jon"}, "reply_to_user": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1552514205, "post_id": 55151388, "comment_id": 97043999, "body": "ah makes sense. hmn, the repository is private, so it seems like gcloud would have issues downloading it in that case? i&#39;m unfamiliar with how the builder works, but is there a way to force include folders?"}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1552525987, "post_id": 55151388, "comment_id": 97047265, "body": "I think the way to solve this is to make <code>.&#47;folder1</code> a subdirectory of <code>.&#47;web</code>. Revise your <code>import</code>s in <code>web&#47;main.go</code> to be <code>web&#47;folder1&#47;feature1</code>. Remove the <code>go.mod</code> files except from <code>.&#47;web</code> and call the module <code>web</code>. I just tried this structure for you and am able to build and run locally and deploy to App Engine standard."}, {"owner": {"reputation": 1484, "user_id": 6003934, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4cke01Q4sh8/AAAAAAAAAAI/AAAAAAAAARQ/-ZrFPVUGL4s/photo.jpg?sz=128", "display_name": "Juancki", "link": "https://stackoverflow.com/users/6003934/juancki"}, "edited": false, "score": 0, "creation_date": 1601643194, "post_id": 55151388, "comment_id": 113477093, "body": "@Jon Please put the <code>EDIT</code> as an answer mark it as correct, it takes some to find the answer if its there in the question."}], "owner": {"reputation": 4657, "user_id": 4086590, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/yngmk.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/4086590/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 896, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1552518632, "creation_date": 1552512059, "last_edit_date": 1552518632, "question_id": 55151388, "link": "https://stackoverflow.com/questions/55151388/deploying-relative-path-go-modules-in-app-engine", "title": "deploying relative path go modules in app engine", "body": "<p>my project's folder structure looks like this</p>\n\n<pre><code>/folder1\n  /feature1\n     feature1.go //package feature1\n     go.mod\n  /feature2\n     feature2.go //package feature2\n     go.mod\n/web\n  app.yaml\n  cloudbuild.yaml\n  main.go //package main (starts app)\n  go.mod\n</code></pre>\n\n<p>this is inside my <code>/web/go.mod</code> </p>\n\n<pre><code>module mypackage\n\nrequire(\n  //3rd party packages\n  feature1 v0.0.0\n  feature2 v0.0.0\n)\n\nreplace(\n  feature1 =&gt; ../folder1/feature1\n  feature2 =&gt; ../folder1/feature2\n)\n</code></pre>\n\n<p>if i run <code>GO111MODULE=on go build</code> this compiles fine and i can run my project.</p>\n\n<p>however, if i do a <code>gcloud app deploy</code></p>\n\n<p>i get the following errors:</p>\n\n<pre><code>go: parsing ../folder1/feature1/go.mod: open /tmp/staging614917184/folder1/feature1/go.mod: no such file or directory\n\ngo: parsing ../folder1/feature2/go.mod: open /tmp/staging614917184/folder1/feature2/go.mod: no such file or directory\n</code></pre>\n\n<p>these files definitely do exist in my project (otherwise the local go build would not have worked).</p>\n\n<p>here is the relevant snippet of my app.yaml</p>\n\n<pre><code>runtime: go111\nenv: standard\n</code></pre>\n\n<p>before i switched to using go.mod, the app deployed fine via the gcloud cli.</p>\n\n<p>however, i need to be able to specify a specific version for some of the packages i'm using, so i want to switch to using go modules.</p>\n\n<p>with the above change, the gcloud builder works ok for the initial build step, but then fails on the app deploy step (gcloud app deploy)</p>\n\n<p>does app engine not support relative paths in a go.mod? if so, is it possible to make this folder structure work?</p>\n\n<p>EDIT:</p>\n\n<p>this ended up being the key <a href=\"https://stackoverflow.com/questions/53663603/how-to-authenticate-a-private-go-module-using-go-1-11-and-google-app-engine-stan\">How to authenticate a private Go Module using go 1.11 and Google App Engine Standard</a></p>\n\n<p>since in app engine deploys the root folder structure was not uploaded, a fix is to copy over the parent folders inside your subfolder where you house your app.yaml. then you point to that new subfolder in your go.mod using the replace syntax.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1552511777, "post_id": 55151311, "comment_id": 97042963, "body": "What is unclear in the documentation you get from <code>go help run</code>, <code>go help build</code> and <code>go help install</code>?"}, {"owner": {"reputation": 191, "user_id": 8398189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d37abcdaec57a9964ad1ad12fe9999a?s=128&d=identicon&r=PG", "display_name": "Igor Tulmentyev", "link": "https://stackoverflow.com/users/8398189/igor-tulmentyev"}, "edited": false, "score": 3, "creation_date": 1552514889, "post_id": 55151311, "comment_id": 97044231, "body": "You can read the explanation of your question here <a href=\"https://stackoverflow.com/q/28881706/8398189\">stackoverflow.com/q/28881706/8398189</a>"}], "answers": [{"comments": [{"owner": {"reputation": 18578, "user_id": 4031815, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a945fa2f0e9ecbcf3f670e0865fa7169?s=128&d=identicon&r=PG&f=1", "display_name": "CommonSenseCode", "link": "https://stackoverflow.com/users/4031815/commonsensecode"}, "edited": false, "score": 0, "creation_date": 1552543538, "post_id": 55151924, "comment_id": 97051414, "body": "so go install and then ./main ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 18578, "user_id": 4031815, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a945fa2f0e9ecbcf3f670e0865fa7169?s=128&d=identicon&r=PG&f=1", "display_name": "CommonSenseCode", "link": "https://stackoverflow.com/users/4031815/commonsensecode"}, "edited": false, "score": 1, "creation_date": 1552569513, "post_id": 55151924, "comment_id": 97066097, "body": "@CommonSenseCode, <code>go install</code> isn&#39;t likely to create <code>.&#47;main</code>. Pay close attention to what each command does. Now with modules and GOCACHE, there&#39;s very little difference between <code>build</code> and <code>install</code> aside from the final build artifact."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552574553, "post_id": 55151924, "comment_id": 97069912, "body": "<code>go install</code> isn&#39;t about dependencies, it builds and puts the binary at <code>$GOPATH&#47;bin</code>. <code>go install &amp;&amp; go build</code> is unnecessary - it just produces two binaries at two different paths. And using <code>go run</code> in a dev environment is a very strange choice - I would only ever use <code>go run</code> locally, and generally not even then."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552574639, "post_id": 55151924, "comment_id": 97069979, "body": "If you want a step to install dependencies, that would be <code>go get</code>."}, {"owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1552578644, "post_id": 55151924, "comment_id": 97072914, "body": "@JimB <code>go install</code> isn&#39;t likely to create <code>.&#47;main</code>, <code>go install</code> creates <code>.&#47;bin&#47;main</code> in $GOPATH."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552578841, "post_id": 55151924, "comment_id": 97073070, "body": "For prod it&#39;s probably best to <code>go build</code> elsewhere and just upload the binary somewhere and run it. There&#39;s no reason you should need to install the Go toolchain or run <code>go install</code> in production."}, {"owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552578952, "post_id": 55151924, "comment_id": 97073164, "body": "@Adrian I&#39;d written <code>go install &amp;&amp; go build</code> just to have <code>main</code> ring on the place to run <code>.&#47;main</code>, but yes, you&#39;re right it&#39;s redundant, so I&#39;ve updated my answer. Regarding DEV env - my mistake I meant exactly local environment. Thank you!"}], "tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": true, "score": 2, "last_activity_date": 1552579289, "last_edit_date": 1552579289, "creation_date": 1552514983, "answer_id": 55151924, "question_id": 55151311, "link": "https://stackoverflow.com/questions/55151311/should-i-run-server-with-go-run-or-main-and-what-is-the-difference/55151924#55151924", "title": "Should I run server with go run . or ./main and what is the difference?", "body": "<p>From official documentation (<code>go1.11</code>):</p>\n\n<p><code>go run</code> - compiles and runs the named main Go package.</p>\n\n<p><code>go build</code> - compiles the packages named by the import paths,\nalong with their dependencies, but it does not install the results.</p>\n\n<p><code>go install</code> - compiles and installs the packages named by the import paths.</p>\n\n<p><strong>It means:</strong></p>\n\n<p>Usually for LOCAL environment it's ok to use <code>go run</code>,\n<br>but for PROD environment it's better to build your app with <code>go build</code> and run <code>./main</code>,\n<br>but in case you need Go toolchain you must use <code>go install</code> because it installs packages and dependencies  and run <code>./bin/main</code> (it may make sense in dev/stage environment).</p>\n"}], "owner": {"reputation": 18578, "user_id": 4031815, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a945fa2f0e9ecbcf3f670e0865fa7169?s=128&d=identicon&r=PG&f=1", "display_name": "CommonSenseCode", "link": "https://stackoverflow.com/users/4031815/commonsensecode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 55151924, "answer_count": 1, "score": -1, "last_activity_date": 1552579289, "creation_date": 1552511648, "last_edit_date": 1552552532, "question_id": 55151311, "link": "https://stackoverflow.com/questions/55151311/should-i-run-server-with-go-run-or-main-and-what-is-the-difference", "title": "Should I run server with go run . or ./main and what is the difference?", "body": "<p>I have a go server which I normally run like this:</p>\n\n<p><code>go build . &amp;&amp; ./main</code></p>\n\n<p>But online I see many examples using go run . which is better to use and what is the difference?</p>\n"}, {"tags": ["xml", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552574748, "post_id": 55151281, "comment_id": 97070057, "body": "Your request type includes <code>XMLName</code> specifying the tag name is <code>Request</code>. If that&#39;s not what you want, remove it."}, {"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552575768, "post_id": 55151281, "comment_id": 97070796, "body": "@Adrian I am aware of this and I have also mentioned it in the post. The question starts with precisely the opposite of what you suggested. Please read the question again!"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552576089, "post_id": 55151281, "comment_id": 97071040, "body": "I did, but you accepted an answer that modifies the <code>Request</code> type by adding a new method to it, so keeping <code>Request</code> unchanged doesn&#39;t seem to be a hard requirement."}, {"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552577522, "post_id": 55151281, "comment_id": 97072133, "body": "@Adrian yes, it modifies the <code>Request</code> but only in the case if the name is <code>RequestMessage</code>. As mentioned at the beginning of my question, I want to be able to handle both cases. Receiving requests with the name <code>Request</code> or <code>RequestMessage</code>. Are you aware of a better way to do that?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552577734, "post_id": 55151281, "comment_id": 97072272, "body": "You can handle both cases either way. You don&#39;t need the <code>XMLName</code> for the single <code>Request</code> use case: <a href=\"https://play.golang.org/p/D1P1bVDADe7\" rel=\"nofollow noreferrer\">play.golang.org/p/D1P1bVDADe7</a>"}, {"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552578331, "post_id": 55151281, "comment_id": 97072696, "body": "This would work for <code>xml.Unmarshal</code> but not for <code>xml.Marshal</code> because the namespace would be missing."}, {"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552638269, "post_id": 55151281, "comment_id": 97094556, "body": "@Adrian anything to add other than voting down the question?"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1552512375, "creation_date": 1552512375, "answer_id": 55151466, "question_id": 55151281, "link": "https://stackoverflow.com/questions/55151281/xml-unmarshalling-attribute-differently-in-case-of-arrays-in-golang/55151466#55151466", "title": "XML Unmarshalling attribute differently in case of arrays in Golang", "body": "<p>You can implement the <code>Unmarshaler</code> interface to overwrite the element's local name before passing the element on to the decoder for the actual unmarshaling.</p>\n\n<pre><code>func (r *Request) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    if start.Name.Local == \"RequestMessage\" {\n        start.Name.Local = \"Request\" // overwrite\n    }\n    type tmp Request // avoid infinite recursive calls to Request.UnmarshalXML\n    return d.DecodeElement((*tmp)(r), &amp;start) // unmarshal\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/0a_gpgkywwf\" rel=\"nofollow noreferrer\">https://play.golang.org/p/0a_gpgkywwf</a></p>\n"}], "owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 55151466, "answer_count": 1, "score": -1, "last_activity_date": 1552512375, "creation_date": 1552511499, "last_edit_date": 1592644375, "question_id": 55151281, "link": "https://stackoverflow.com/questions/55151281/xml-unmarshalling-attribute-differently-in-case-of-arrays-in-golang", "title": "XML Unmarshalling attribute differently in case of arrays in Golang", "body": "<p>I have a web service where I expect to receive two different requests; one is called <code>Request</code> containing just one <code>Request</code> and the other is called <code>RequestBulk</code> which contains an array of <code>Request</code>s. Both mapped to Golang structs as follows:</p>\n<pre><code>type RequestBulk struct {\n    XMLName  xml.Name  `xml:&quot;https://item.com RequestBulk&quot;`\n    Message  string    `xml:&quot;Message&quot;`\n    Request  []Request `xml:&quot;Request,omitempty&quot;`\n}\n\ntype Request struct {\n    XMLName xml.Name `xml:&quot;https://item.com Request&quot;`\n    Text    string   `xml:&quot;text&quot;`\n}\n</code></pre>\n<p>Unmarshalling the following XMLs works as expected:</p>\n<pre><code>&lt;Request xmlns=&quot;https://item.com&quot;&gt;\n  &lt;text&gt;Some request text&lt;/text&gt;\n&lt;/Request&gt;\n</code></pre>\n<pre><code>&lt;RequestBulk xmlns=&quot;https://item.com&quot;&gt;\n  &lt;Message&gt;Some Text&lt;/Message&gt;\n  &lt;Request xmlns=&quot;https://item.com&quot;&gt;\n    &lt;text&gt;Some request text&lt;/text&gt;\n  &lt;/Request&gt;\n  &lt;Request xmlns=&quot;https://item.com&quot;&gt;\n    &lt;text&gt;Some other request text&lt;/text&gt;\n  &lt;/Request&gt;\n&lt;/RequestBulk&gt;\n</code></pre>\n<h3>The Problem</h3>\n<p>In <code>RequestBulk</code>, if I change</p>\n<pre><code>Request []Request `xml:&quot;Request,omitempty&quot;`\n</code></pre>\n<p>to</p>\n<pre><code>RequestMessage []Request `xml:&quot;RequestMessage,omitempty&quot;`\n</code></pre>\n<p>and change the XML to:</p>\n<pre><code>&lt;RequestBulk xmlns=&quot;https://item.com&quot;&gt;\n  &lt;Message&gt;Some Text&lt;/Message&gt;\n  &lt;RequestMessage xmlns=&quot;https://item.com&quot;&gt;\n    &lt;text&gt;Some request text&lt;/text&gt;\n  &lt;/RequestMessage&gt;\n  &lt;RequestMessage xmlns=&quot;https://item.com&quot;&gt;\n    &lt;text&gt;Some other request text&lt;/text&gt;\n  &lt;/RequestMessage&gt;\n&lt;/RequestBulk&gt;\n</code></pre>\n<p>I get the following error:</p>\n<blockquote>\n<p>expected element type &lt;Request&gt; but have &lt;RequestMessage&gt;</p>\n</blockquote>\n<p>Obviously because of the <code>XMLName xml.Name `xml:&quot;https://item.com Request&quot;`</code></p>\n<h3>The Question</h3>\n<p>How do I keep the <code>Request</code> struct unchanged and still accept messages of type <code>RequestBulk</code> with a different name for the struct <code>Request</code>, namely, <code>RequestMessage</code>?</p>\n<p>In other words; How do I use the same struct with different namespaces?</p>\n<hr />\n<p>Run it on <a href=\"https://play.golang.org/p/WjFSnp7byo_c\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1552511301, "post_id": 55151117, "comment_id": 97042771, "body": "How does <code>select * ...</code> from a table with 6 columns scan into 3 fields without error?"}, {"owner": {"reputation": 4679, "user_id": 749854, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/541a5cb4925d352cac921c21e9213aa4?s=128&d=identicon&r=PG", "display_name": "nvcnvn", "link": "https://stackoverflow.com/users/749854/nvcnvn"}, "edited": false, "score": 0, "creation_date": 1552524188, "post_id": 55151117, "comment_id": 97046812, "body": "<a href=\"http://gorm.io/docs/has_many.html\" rel=\"nofollow noreferrer\">gorm.io/docs/has_many.html</a> if you can use 3rd lib, you can keep your struct pretty much the same."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552533789, "post_id": 55151117, "comment_id": 97048963, "body": "@mkopriva hello! You are right. SQL query must be <code>select * ORGANIZATION_ID, ORGANIZATION_NAME, ORGANIZATION_RANG from ORG</code>. The current code with return me 5 record and in final response I have array with 5 object which is not what I want. How would you implement nesting as in my case?"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 4679, "user_id": 749854, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/541a5cb4925d352cac921c21e9213aa4?s=128&d=identicon&r=PG", "display_name": "nvcnvn", "link": "https://stackoverflow.com/users/749854/nvcnvn"}, "edited": false, "score": 0, "creation_date": 1552535163, "post_id": 55151117, "comment_id": 97049303, "body": "@nvcnvn hello! How exactly this ORM could help me? Can you show a practical example for my case?"}], "answers": [{"comments": [{"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552623810, "post_id": 55173321, "comment_id": 97089693, "body": "Hello! Thank you. In fact I need to show response only with top level organizations with nersed children. There must be array with only <code>Google</code> and <code>Calico</code> objects. Every object has childer. Do you understand me? What I need to change in your code for this task? Do you have any ideas?"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552636049, "post_id": 55173321, "comment_id": 97093545, "body": "It seems like your code works only for constant nesting level (rang). Can you add some children to <code>Nest</code> object just for the test? In my case nesting level (rang) is not constant. Objects that have children are duplicated in the main array. For example if you will add some childen to <code>Nest</code> object, you will notice that this object in duplicated in the main array. Do you have any ideas about that?"}, {"owner": {"reputation": 258, "user_id": 2969272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95bc136055ef3028847d419f129f409d?s=128&d=identicon&r=PG", "display_name": "antham", "link": "https://stackoverflow.com/users/2969272/antham"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552639184, "post_id": 55173321, "comment_id": 97094962, "body": "If you want to know if it works for several level of children, the answer is yes, try and you will see. Here it&#39;s a simple answer based on what I understood from what you&#39;ve dumped so you have to adapt this script to fit exactly your need."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552647556, "post_id": 55173321, "comment_id": 97099928, "body": "Can you check my post again please? I add information about result of your last code. Unfortunatly it don&#39;t work correctly."}, {"owner": {"reputation": 258, "user_id": 2969272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95bc136055ef3028847d419f129f409d?s=128&d=identicon&r=PG", "display_name": "antham", "link": "https://stackoverflow.com/users/2969272/antham"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552651253, "post_id": 55173321, "comment_id": 97102160, "body": "So what is supposed to do ?"}, {"owner": {"reputation": 258, "user_id": 2969272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95bc136055ef3028847d419f129f409d?s=128&d=identicon&r=PG", "display_name": "antham", "link": "https://stackoverflow.com/users/2969272/antham"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552652099, "post_id": 55173321, "comment_id": 97102632, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/190089/discussion-between-antham-and-nurzhan-nogerbek\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 258, "user_id": 2969272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95bc136055ef3028847d419f129f409d?s=128&d=identicon&r=PG", "display_name": "antham", "link": "https://stackoverflow.com/users/2969272/antham"}, "is_accepted": true, "score": 1, "last_activity_date": 1552761555, "last_edit_date": 1552761555, "creation_date": 1552604792, "answer_id": 55173321, "question_id": 55151117, "link": "https://stackoverflow.com/questions/55151117/how-to-combine-related-data/55173321#55173321", "title": "How to combine related data", "body": "<p>If I understand properly what you want to do, here you have an unoptimized example, it's done with sqlite but it will work the same with postgres : </p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"sort\"\n\n    _ \"github.com/mattn/go-sqlite3\"\n)\n\ntype Organization struct {\n    ID       int             `json:\"organization_id\"`\n    Name     string          `json:\"organization_name\"`\n    Rang     int             `json:\"organization_rang\"`\n    Children []*Organization `json:\"children\"`\n}\n\nfunc main() {\n    db, err := sql.Open(\"sqlite3\", \"./database\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer db.Close()\n\n    rows, err := db.Query(\"select ORGANIZATION_ID,ORGANIZATION_NAME,ORGANIZATION_RANG,PARENT_ORGANIZATION_ID from ORG\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer rows.Close()\n\n    orgs := map[int]*Organization{}\n\n    for rows.Next() {\n        organization := &amp;Organization{}\n        var parentID sql.NullInt64\n\n        if err = rows.Scan(&amp;organization.ID, &amp;organization.Name, &amp;organization.Rang, &amp;parentID); err != nil {\n            log.Fatal(err)\n        }\n\n        if parentID.Valid {\n            if parentOrg, ok := orgs[int(parentID.Int64)]; ok {\n                parentOrg.Children = append(parentOrg.Children, organization)\n            } else {\n                orgs[int(parentID.Int64)] = &amp;Organization{ID: int(parentID.Int64)}\n                orgs[int(parentID.Int64)].Children = append(orgs[int(parentID.Int64)].Children, organization)\n            }\n        }\n\n        if _, ok := orgs[organization.ID]; ok {\n            orgs[organization.ID].Name = organization.Name\n            orgs[organization.ID].Rang = organization.Rang\n            continue\n        }\n\n        orgs[organization.ID] = organization\n    }\n\n    IDs := []int{}\n    for k := range orgs {\n        IDs = append(IDs, k)\n    }\n    sort.Ints(IDs)\n\n    organizations := []Organization{}\n    for _, ID := range IDs {\n        if len(orgs[ID].Children) &gt; 0 &amp;&amp; orgs[ID].Rang == 1 {\n            organizations = append(organizations, *orgs[ID])\n        }\n    }\n\n    content, err := json.MarshalIndent(organizations, \"\", \"  \")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(string(content))\n}\n</code></pre>\n\n<p>I get this :</p>\n\n<pre><code>[\n  {\n    \"organization_id\": 1,\n    \"organization_name\": \"Google\",\n    \"organization_rang\": 1,\n    \"children\": [\n      {\n        \"organization_id\": 2,\n        \"organization_name\": \"Nest\",\n        \"organization_rang\": 2,\n        \"children\": null\n      },\n      {\n        \"organization_id\": 3,\n        \"organization_name\": \"Verily\",\n        \"organization_rang\": 2,\n        \"children\": null\n      }\n    ]\n  },\n  {\n    \"organization_id\": 4,\n    \"organization_name\": \"Calico\",\n    \"organization_rang\": 1,\n    \"children\": [\n      {\n        \"organization_id\": 5,\n        \"organization_name\": \"ATAP\",\n        \"organization_rang\": 2,\n        \"children\": null\n      }\n    ]\n  }\n]\n</code></pre>\n"}], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 55173321, "answer_count": 1, "score": -1, "last_activity_date": 1552761555, "creation_date": 1552510861, "last_edit_date": 1552643458, "question_id": 55151117, "link": "https://stackoverflow.com/questions/55151117/how-to-combine-related-data", "title": "How to combine related data", "body": "<p>I need some theoretical/practical help in code organization.</p>\n\n<p>I have such table in <code>PostgreSQL</code> database. The table shows the relationship between organizations.</p>\n\n<pre><code>| ORGANIZATION_ID | ORGANIZATION_NAME | PARENT_ORGANIZATION_ID | ORGANIZATION_RANG | TREE_ORGANIZATION_ID | TREE_ORGANIZATION_ NAME |\n|-----------------|-------------------|------------------------|-------------------|----------------------|-------------------------|\n| 1               | Google            |                        | 1                 | \\1                   | \\Google                 |\n| 2               | Nest              | 1                      | 2                 | \\1\\2                 | \\Google\\Nest            |\n| 3               | Verily            | 1                      | 2                 | \\1\\3                 | \\Google\\Verily          |\n| 4               | Calico            |                        | 1                 | \\4                   | \\Calico                 |\n| 5               | ATAP              | 4                      | 2                 | \\4\\5                 | \\Calico\\ATAP            |\n</code></pre>\n\n<p>In my Go application I create <code>struct</code> for this table then make SQL query.</p>\n\n<pre><code>type Organization struct {\n    ID int `json:\"organization_id\"`\n    Name string `json:\"organization_name\"`\n    Rang int `json:\"organization_rang\"`\n    Children []Organization `json:\"children\"`\n}\n\nvar GetOrganizations = func(responseWriter http.ResponseWriter, request *http.Request) {\n    rows,err := db.Query(\"select * from ORG\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    defer rows.Close()\n\n    var organizations []Organization\n\n    for rows.Next() {\n        var organization Organization\n\n        err = rows.Scan(&amp;organization.ID, &amp;organization.Name, &amp;organization.Rang)\n        if err != nil {\n            fmt.Println(err)\n            return\n        }\n\n        organizations = append(organizations, organization)\n    }\n\n    utils.Response(responseWriter, http.StatusOK, organizations)\n}\n</code></pre>\n\n<p>I need to make such response. What would you advise to reorganize in my current code?</p>\n\n<pre><code>[\n    {\n        \"organization_id\": 1,\n        \"organization_name\": \"Google\",\n        \"organization_rang\": 1,\n        \"children\": [\n            {\n                \"organization_id\": 2,\n                \"organization_name\": \"Nest\",\n                \"organization_rang\": 2,\n                \"children\": null\n            },\n            {\n                \"organization_id\": 3,\n                \"organization_name\": \"Verily\",\n                \"organization_rang\": 2,\n                \"children\": null\n            }\n        ]\n    },\n    {\n        \"organization_id\": 4,\n        \"organization_name\": \"Calico\",\n        \"organization_rang\": 1,\n        \"children\": [\n            {\n                \"organization_id\": 2,\n                \"organization_name\": \"Nest\",\n                \"organization_rang\": 2,\n                \"children\": null\n            }\n        ]\n    }\n]\n</code></pre>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>@antham for example I add new record called <code>Telsa</code>. As you can see it's parent is <code>Nest</code> object.</p>\n\n<pre><code>| ORGANIZATION_ID | ORGANIZATION_NAME | PARENT_ORGANIZATION_ID | ORGANIZATION_RANG | TREE_ORGANIZATION_ID | TREE_ORGANIZATION_ NAME |\n|-----------------|-------------------|------------------------|-------------------|----------------------|-------------------------|\n| 1               | Google            |                        | 1                 | \\1                   | \\Google                 |\n| 2               | Nest              | 1                      | 2                 | \\1\\2                 | \\Google\\Nest            |\n| 3               | Verily            | 1                      | 2                 | \\1\\3                 | \\Google\\Verily          |\n| 4               | Calico            |                        | 1                 | \\4                   | \\Calico                 |\n| 5               | ATAP              | 4                      | 2                 | \\4\\5                 | \\Calico\\ATAP            |\n| 6               | Tesla             | 2                      | 3                 | \\1\\2\\6               | \\Google\\Nest\\Tesla      |\n</code></pre>\n\n<p>Result of your code:</p>\n\n<pre><code>[\n    {\n        \"organization_id\": 1,\n        \"organization_name\": \"Google\",\n        \"organization_rang\": 1,\n        \"children\": [\n            {\n                \"organization_id\": 3,\n                \"organization_name\": \"Verily\",\n                \"organization_rang\": 2,\n                \"children\": null\n            },\n            {\n                \"organization_id\": 2,\n                \"organization_name\": \"Nest\",\n                \"organization_rang\": 2,\n                \"children\": [\n                    {\n                        \"organization_id\": 6,\n                        \"organization_name\": \"Tesla\",\n                        \"organization_rang\": 3,\n                        \"children\": null\n                    }\n                ]\n            }\n        ]\n    },\n    {\n        \"organization_id\": 2,\n        \"organization_name\": \"Nest\",\n        \"organization_rang\": 2,\n        \"children\": [\n            {\n                \"organization_id\": 6,\n                \"organization_name\": \"Tesla\",\n                \"organization_rang\": 3,\n                \"children\": null\n            }\n        ]\n    },\n    {\n        \"organization_id\": 4,\n        \"organization_name\": \"Calico\",\n        \"organization_rang\": 1,\n        \"children\": [\n            {\n                \"organization_id\": 5,\n                \"organization_name\": \"ATAP\",\n                \"organization_rang\": 2,\n                \"children\": null\n            }\n        ]\n    }\n]\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552506875, "post_id": 55150064, "comment_id": 97040743, "body": "I assume you are getting data in from a SQL source? And the table data in question has a null value, and you ware asking why the null, does not appear as a <code>go</code> <code>nil</code> value? Is that a correct assessment of you question?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552507068, "post_id": 55150064, "comment_id": 97040829, "body": "and if it&#39;s an SQL - please post the DB driver. MySQL, SQLite etc? There may be driver options that need to be enabled to support NULL values during a RowScan."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552507130, "post_id": 55150064, "comment_id": 97040856, "body": "@colminator hello! Yes, you are right. For example I notice that <code>*int</code> return me <code>null</code>.  Why <code>*string</code> return me just <code>&quot;&quot;</code> instead of <code>null</code>. In fact in database colomn has null value. Can I change this default behavior?"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552507774, "post_id": 55150064, "comment_id": 97041142, "body": "@colminator I use <code>Oracle</code> database. I use <a href=\"https://github.com/go-goracle/goracle\" rel=\"nofollow noreferrer\">goracle</a> package to work with database."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552508230, "post_id": 55150064, "comment_id": 97041362, "body": "it does not appear that is is possible then - see my updated answer."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552508531, "post_id": 55150064, "comment_id": 97041513, "body": "Thank you for the information. That&#39;s sad. Is it really impossible somehow intercept the value and check it at the <code>Scan</code> function level?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552508763, "post_id": 55150064, "comment_id": 97041616, "body": "The driver could do it - but looks like the <code>goracle</code> authors deemed it too confusing. Sorry!"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552509332, "post_id": 55150064, "comment_id": 97041861, "body": "Well, thank you for your help! Can I ask you one more question?! What you mean by <code>... driver could do it ...</code>? I am little bit confused."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 2, "creation_date": 1552509448, "post_id": 55150064, "comment_id": 97041913, "body": "@colminator note that this has nothing to do with <code>goracle</code>, as you&#39;ve already pointed out in your answer by quoting the documentation, this is an issue with oracle proper, not the driver. If oracle internally changes an empty string to NULL there&#39;s little the authors of the driver can do. Also <a href=\"https://stackoverflow.com/a/13278879/965900\">stackoverflow.com/a/13278879/965900</a>"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552509476, "post_id": 55150064, "comment_id": 97041924, "body": "goracle is an open source driver. It can be changed. This feature could be added. You&#39;d just have to convince the authors - or fork and do it yourself!"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552509688, "post_id": 55150064, "comment_id": 97042017, "body": "I have no experience with Oracle DB&#39;s - but I have to assume very much <i>CAN</i> support NULLs in their tables. Up to drivers/clients if they choose to support these."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1552510180, "post_id": 55150064, "comment_id": 97042230, "body": "@colminator nobody said anything about oracle db not supporting NULLs."}], "answers": [{"comments": [{"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552507361, "post_id": 55150156, "comment_id": 97040955, "body": "Hello! Thank you for information. For example I notice that <code>*int</code> return me <code>null</code>. In the same time <code>*string</code> return me just <code>&quot;&quot; </code>instead of <code>null</code>. In fact in database colomn has <code>null</code> value. Is it possible to change this default behavior?"}], "tags": [], "owner": {"reputation": 55, "user_id": 10254900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b441a4de509d630efee8103a4e7118?s=128&d=identicon&r=PG&f=1", "display_name": "Yu-s-uF", "link": "https://stackoverflow.com/users/10254900/yu-s-uf"}, "is_accepted": false, "score": 2, "last_activity_date": 1552506614, "creation_date": 1552506614, "answer_id": 55150156, "question_id": 55150064, "link": "https://stackoverflow.com/questions/55150064/how-return-null-value-to-empty-string-field/55150156#55150156", "title": "How return null value to empty string field", "body": "<p>In the Go language specification <code>nil</code> is not a valid value for type <code>string</code>. the default, zero value is <code>\"\"</code>.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/36001477/why-cant-a-string-be-nil-in-go/36006313\">The top answer for this question goes into more detail.</a></p>\n"}, {"comments": [{"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552507916, "post_id": 55150370, "comment_id": 97041212, "body": "Hello! Thank you for your answer. In my case I use <code>Oracle</code> database. I use <a href=\"https://github.com/go-goracle/goracle\" rel=\"nofollow noreferrer\">goracle</a> package to work with database. Do you have any other ideas now?"}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 1, "last_activity_date": 1552508014, "last_edit_date": 1592644375, "creation_date": 1552507621, "answer_id": 55150370, "question_id": 55150064, "link": "https://stackoverflow.com/questions/55150064/how-return-null-value-to-empty-string-field/55150370#55150370", "title": "How return null value to empty string field", "body": "<p><strong>Edit:</strong></p>\n<p>What you want to do is not possible according to the <a href=\"https://github.com/go-goracle/goracle#sqlnullstring\" rel=\"nofollow noreferrer\">oracle go driver docs</a>:</p>\n<blockquote>\n<p>sql.NullString</p>\n<p>sql.NullString is not supported: Oracle DB does not\ndifferentiate between an empty string (&quot;&quot;) and a NULL</p>\n</blockquote>\n<p><strong>Original Answer:</strong></p>\n<p>Need more details on the SQL database type you are connecting to. I know the go SQLite3 pkg - <code>github.com/mattn/go-sqlite3</code> - supports setting <code>nil</code> for values of type <code>*string</code>.</p>\n<p>Check the details of the driver you are using to connect to the database. For instance with MySQL, getting SQL date fields into go's native <code>time.Time</code> struct type is not set by default - it must be <a href=\"https://github.com/go-sql-driver/mysql#parsetime\" rel=\"nofollow noreferrer\">turned on at the driver level</a>.</p>\n"}], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2852, "favorite_count": 0, "accepted_answer_id": 55150370, "answer_count": 2, "score": 0, "last_activity_date": 1582120825, "creation_date": 1552506190, "last_edit_date": 1582120825, "question_id": 55150064, "link": "https://stackoverflow.com/questions/55150064/how-return-null-value-to-empty-string-field", "title": "How return null value to empty string field", "body": "<p>I have such <code>struct</code> in Golang application:</p>\n\n<pre><code>type Employee struct {\n    ID int `json:\"employee_id\"`\n    Email *string `json:\"employee_email\"`\n    LastName *string `json:\"employee_last_name\"`\n    FirstName *string `json:\"employee_first_name\"`\n    Sex *string `json:\"employee_sex\"`\n}\n</code></pre>\n\n<p>Some string fields of this struct can be empty. If I use <code>*string</code> application return me <code>\"\"</code>. If use <code>sql.NullString</code> it return me for example such result:</p>\n\n<pre><code>\"employee_last_name\": {\n    String: \"\",\n    Valid: true\n}\n</code></pre>\n\n<p>I want to show <code>null</code> is string field is empty.</p>\n\n<p>In <a href=\"https://golang.org/src/database/sql/sql.go?s=5290:5340#L194\" rel=\"nofollow noreferrer\">documentation</a> I found such code:</p>\n\n<pre><code>type NullString struct {\n    String string\n    Valid  bool\n}\n\nfunc (ns *NullString) Scan(value interface{}) error {\n    if value == nil {\n        ns.String, ns.Valid = \"\", false\n        return nil\n    }\n    ns.Valid = true\n    return convertAssign(&amp;ns.String, value)\n}\n\nfunc (ns NullString) Value() (driver.Value, error) {\n    if !ns.Valid {\n        return nil, nil\n    }\n    return ns.String, nil\n}\n</code></pre>\n\n<p>As I understand this code could help me to solve my problem, right?! What I need to import in my application to use <code>convertAssign</code> function?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "edited": false, "score": 3, "creation_date": 1552503476, "post_id": 55149264, "comment_id": 97039129, "body": "Why do you need to use <code>fmt.Printf</code>? You can use <code>fmt.Fprintf</code> to write to a file, <code>log.Printf</code> to write through the global logger, <code>log.SetPrefix</code> to put a prefix on the global logger, and <code>log.New</code> to make a non-global logger (this last is what I personally would recommend for any non-trivial project). While you <i>can</i> overwrite global vars in other packages, I personally think that should be a last-resort solution."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1552503183, "last_edit_date": 1592644375, "creation_date": 1552503183, "answer_id": 55149333, "question_id": 55149264, "link": "https://stackoverflow.com/questions/55149264/how-to-log-fmt-printf-in-custom-file/55149333#55149333", "title": "How to log fmt.Printf in custom file", "body": "<p><a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"noreferrer\"><code>fmt.Printf()</code></a> documents that it writes to the standard output:</p>\n<blockquote>\n<p>Printf formats according to a format specifier and <strong>writes to standard output</strong>.</p>\n</blockquote>\n<p>So there is no <code>fmt.SetOutput()</code> to redirect that to your file.</p>\n<p>But note that the standard output is a <a href=\"https://golang.org/pkg/os/#pkg-variables\" rel=\"noreferrer\">variable in the <code>os</code></a> package:</p>\n<blockquote>\n<p>Stdin, Stdout, and Stderr are open Files pointing to the standard input, standard output, and standard error file descriptors.</p>\n<p>Note that the Go runtime writes to standard error for panics and crashes; closing Stderr may cause those messages to go elsewhere, perhaps to a file opened later.</p>\n<pre><code>var (\n        Stdin  = NewFile(uintptr(syscall.Stdin), &quot;/dev/stdin&quot;)\n        Stdout = NewFile(uintptr(syscall.Stdout), &quot;/dev/stdout&quot;)\n        Stderr = NewFile(uintptr(syscall.Stderr), &quot;/dev/stderr&quot;)\n)\n</code></pre>\n</blockquote>\n<p>And you are allowed to set your own <a href=\"https://golang.org/pkg/os/#File\" rel=\"noreferrer\"><code>os.File</code></a> to <code>os.Stdout</code>. Although it's not a good idea to use the same <code>os.File</code> for a logger and to also set it to <code>os.Stdout</code>, access to its <code>File.Write()</code> method would not be synchronized between the <code>fmt</code> package and the logger.</p>\n<p>Best would be to use a <a href=\"https://golang.org/pkg/log/#Logger\" rel=\"noreferrer\"><code>log.Logger</code></a> everywhere (whose output you properly set, so log messages would properly be serialized).</p>\n"}], "owner": {"reputation": 18578, "user_id": 4031815, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a945fa2f0e9ecbcf3f670e0865fa7169?s=128&d=identicon&r=PG&f=1", "display_name": "CommonSenseCode", "link": "https://stackoverflow.com/users/4031815/commonsensecode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1709, "favorite_count": 0, "accepted_answer_id": 55149333, "answer_count": 1, "score": 2, "last_activity_date": 1588321822, "creation_date": 1552502882, "last_edit_date": 1588321822, "question_id": 55149264, "link": "https://stackoverflow.com/questions/55149264/how-to-log-fmt-printf-in-custom-file", "title": "How to log fmt.Printf in custom file", "body": "<p>I have this function which I use to log:</p>\n\n<pre><code>func formattedLog(prefix, m string, color int) {\n    fmt.Printf(\"\\033[%dm%s\", color, DateTimeFormat)\n    fmt.Printf(\"\u25b6 %s: %s\\033[%dm\\n\", prefix, m, int(Black))\n}\n</code></pre>\n\n<p>I want to save my log output in some file:</p>\n\n<pre><code>f, err := os.OpenFile(\"../../../go-logs.txt\", os.O_WRONLY|os.O_CREATE|os.O_APPEND, 0666)\nif err != nil {\n    log.Fatal(\"error opening logs file\", err)\n}\ndefer f.Close()\n//set output of logs to f\nlog.SetOutput(f)\nlog.Println(\"This is a test log entry\") // &lt;====This logs in file\n</code></pre>\n\n<p>but when I call my function, which uses fmt.Printf it doesn't log in the file <code>go-logs.txt</code>:</p>\n\n<pre><code>formattedErr(\"ERR\", msg, err.Error(), int(Red))\n</code></pre>\n\n<p>is there anyway to setoutput also for fmt.Printf</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1552492963, "post_id": 55146237, "comment_id": 97033173, "body": "See possible duplicate: <a href=\"https://stackoverflow.com/questions/39804861/what-is-a-concise-way-to-create-a-2d-slice-in-go/39806983#39806983\">What is a concise way to create a 2D slice in Go?</a>"}, {"owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1552493511, "post_id": 55146237, "comment_id": 97033543, "body": "@icza thanks for your answer. But in that case the slice is not din&#225;mic. It&#39;s fixed to &quot;dx&quot; value."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1552493614, "post_id": 55146237, "comment_id": 97033611, "body": "<code>dx</code> is a variable, not a constant. Isn&#39;t that &quot;dynamic&quot;? Whatever value <code>dx</code> holds, that will be the row length (&quot;horizontal&quot; size). Your example in the question seems a lot more &quot;static&quot; with <code>5</code> and <code>10</code>."}, {"owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1552493695, "post_id": 55146237, "comment_id": 97033662, "body": "@icza yes. But it&#39;s being set somehwere. I don&#39;t want a variable determining that value other than the flow of the code. As in my case. And in the right answer which was given. Thanks anyway!!"}], "answers": [{"comments": [{"owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "edited": false, "score": 0, "creation_date": 1552493452, "post_id": 55146413, "comment_id": 97033511, "body": "Thanks so much. This is exactly what I needed. What a dumb mistake."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "edited": false, "score": 0, "creation_date": 1552493738, "post_id": 55146413, "comment_id": 97033697, "body": "actually relooking at the error - it&#39;s non-obvious. <code>go</code> says <code>tmp</code> is of type <code>[]string</code> which is the <i>correct</i> type to append with. I think the error should expand that you at using <code>tmp...</code> - which reduces it to a variadic."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 3, "last_activity_date": 1552494130, "last_edit_date": 1552494130, "creation_date": 1552493318, "answer_id": 55146413, "question_id": 55146237, "link": "https://stackoverflow.com/questions/55146237/two-dimensional-matrix-dynamically/55146413#55146413", "title": "Two dimensional matrix dynamically", "body": "<p>The compiler error is actually misleading - it should quote you are using <code>tmp...</code> which is of a variadic of strings - instead it quotes <code>tmp</code> which is of the correct type <code>[]string</code> which one could use to append to <code>cnt</code>:</p>\n\n<blockquote>\n  <p>main.go:14:15:cannot use tmp (type []string) as type [][]string in append</p>\n</blockquote>\n\n<p>Anyway, using <code>tmp...</code>, <em>go</em> is turning <code>tmp</code> from a []string into individual string parameters. Effectively:</p>\n\n<pre><code>cnt = append(cnt, tmp[0], tmp[1], tmp[2], tmp[3], tmp[4])\n</code></pre>\n\n<p>And go can't append <code>string</code> to a <code>[][]string</code> type.</p>\n\n<p>Change the line to:</p>\n\n<pre><code>cnt = append(cnt, tmp)\n</code></pre>\n"}], "owner": {"reputation": 3680, "user_id": 7723882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6aUwy.png?s=128&g=1", "display_name": "Matias Barrios", "link": "https://stackoverflow.com/users/7723882/matias-barrios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 55146413, "answer_count": 1, "score": 2, "last_activity_date": 1556982458, "creation_date": 1552492811, "last_edit_date": 1556982458, "question_id": 55146237, "link": "https://stackoverflow.com/questions/55146237/two-dimensional-matrix-dynamically", "title": "Two dimensional matrix dynamically", "body": "<p>I have this code, which is giving me errors:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n        var cnt = make([][]string,0,10)\n        for i := 0; i &lt; 5; i++ {\n             var tmp = make([]string,0,8)\n             for c := 0 ; c &lt; 5 ; c++ {\n                 tmp = append(tmp,\"Matias\")\n              }\n              cnt= append(cnt,tmp...)\n         }\n    fmt.Println(cnt)\n}\n</code></pre>\n\n<p>It's giving me an error. Basically what I need is to have the slice to be as din\u00e1mic as possible. I don't know what the final length will be in any of the two dimensions.</p>\n"}, {"tags": ["visual-studio", "go"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1552486679, "post_id": 55143546, "comment_id": 97028527, "body": "so if i understand you properly you have verbose testing active but you do not want verbose output?"}, {"owner": {"reputation": 183, "user_id": 6386564, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d493d95f9b377f1b7c9031baf671dccc?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Zhang", "link": "https://stackoverflow.com/users/6386564/ian-zhang"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 1, "creation_date": 1552490068, "post_id": 55143546, "comment_id": 97031101, "body": "@Pizzalord I want the results show up, not the path to the code"}], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 1, "last_activity_date": 1552491863, "last_edit_date": 1552491863, "creation_date": 1552487550, "answer_id": 55144380, "question_id": 55143546, "link": "https://stackoverflow.com/questions/55143546/how-to-omit-gopath-for-visual-code-go-plugin/55144380#55144380", "title": "How to omit GOPATH for visual code GO plugin", "body": "<p>It is not possible to strip of  GOPATH from the output. Test output will always use the <code>absolute</code> path</p>\n"}], "owner": {"reputation": 183, "user_id": 6386564, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d493d95f9b377f1b7c9031baf671dccc?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Zhang", "link": "https://stackoverflow.com/users/6386564/ian-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 55144380, "answer_count": 1, "score": 1, "last_activity_date": 1552491863, "creation_date": 1552485121, "question_id": 55143546, "link": "https://stackoverflow.com/questions/55143546/how-to-omit-gopath-for-visual-code-go-plugin", "title": "How to omit GOPATH for visual code GO plugin", "body": "<p>I'm using the visual code and GO plugin.</p>\n\n<p>I configured the verbose option for go test <code>\"go.testFlags\": [\"-v\"]</code>.</p>\n\n<p>In this case, when I run the test unit, from the output window, I'm seeing the full path of the test unit.</p>\n\n<pre><code>--- PASS: TestConstantBinary (0.00s)\n    /Users/ian.w/Documents/learngo/src/learnGO/tests/constant_test.go:27: true false false\n\n</code></pre>\n\n<p>Is that possible to omit the GOPATH from the above,</p>\n\n<p><code>GOPATH=/Users/ian.w/Documents/learngo</code></p>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["oracle", "go", "goracle"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552483802, "post_id": 55142997, "comment_id": 97026409, "body": "Read the error message. Your panic happens at line 18 of organizations.go. That line tries to call <code>database.OracleDB.Query</code>. Apparently <code>database.OracleDB</code> is not defined."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552484016, "post_id": 55142997, "comment_id": 97026556, "body": "Well, as I said that the problem happens when I try to make sql query. Line 18 is  this part of code: <code>database.OracleDB.Query</code>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552484185, "post_id": 55142997, "comment_id": 97026702, "body": "So you know where the problem is happening. So what is your question?"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552484401, "post_id": 55142997, "comment_id": 97026857, "body": "Why you think that it is not defined? In <code>organizations.go</code> file you can notice that in top side I import <code>&quot;project&#47;database&quot;</code> package. Inside database folder I have <code>Oracle.go</code> file. In the same time <code>GoLand</code> IDEA which I use don&#39;t raise any warning inside <code>organizations.go</code> file. For thats why I am confused."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552484610, "post_id": 55142997, "comment_id": 97027005, "body": "Because that&#39;s what the error message says."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1552484671, "post_id": 55142997, "comment_id": 97027046, "body": "Change <code>OracleDB, err := sql.Open(&quot;goracle&quot;, databaseURL)</code> to <code>OracleDB, err = sql.Open(&quot;goracle&quot;, databaseURL)</code>, and search for &quot;go shadowing variables&quot;. To explain, your global OracleDB is never set because you use <code>:=</code> in the local scope to &quot;assign&quot; it, but <code>:=</code> declares and initializes a new variable named OracleDB that shadows the global one."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552484800, "post_id": 55142997, "comment_id": 97027139, "body": "@mkopriva thank you very much! That&#39;s the reason of the problem. I&#39;ll be careful next time. Can you post your answer? I will mark it as correct."}], "answers": [{"tags": [], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "is_accepted": true, "score": 1, "last_activity_date": 1552496284, "creation_date": 1552496284, "answer_id": 55147412, "question_id": 55142997, "link": "https://stackoverflow.com/questions/55142997/sql-queries-to-oracle-database-from-go-application-raise-error/55147412#55147412", "title": "SQL queries to Oracle database from Go application raise error?", "body": "<p>The solution which adviced @mkopriva:</p>\n\n<blockquote>\n  <p>Change <code>OracleDB, err := sql.Open(\"goracle\", databaseURL)</code> to\n  <code>OracleDB, err = sql.Open(\"goracle\", databaseURL)</code>, and search for \"go\n  shadowing variables\". To explain, your global OracleDB is never set\n  because you use := in the local scope to \"assign\" it, but <code>:=</code> declares\n  and initializes a new variable named OracleDB that shadows the global\n  one.</p>\n</blockquote>\n"}], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 55147412, "answer_count": 1, "score": 0, "last_activity_date": 1552496284, "creation_date": 1552483547, "last_edit_date": 1552484602, "question_id": 55142997, "link": "https://stackoverflow.com/questions/55142997/sql-queries-to-oracle-database-from-go-application-raise-error", "title": "SQL queries to Oracle database from Go application raise error?", "body": "<p>I use next <a href=\"https://blogs.oracle.com/developers/how-to-connect-a-go-program-to-oracle-database-using-goracle\" rel=\"nofollow noreferrer\">article</a> to connect <strong>Golang</strong> application with remote <strong>Oracle</strong> database. Application successfully connected to database with the help of library <a href=\"https://godoc.org/gopkg.in/go-goracle/goracle.v2\" rel=\"nofollow noreferrer\">goracle</a>. I also ping it successfully. Application raise error when I make sql query. Where is mistake?</p>\n\n<p>I notice that if remove all code from controller file (organizations.go) to connection file (Oracle.go) it works. How exactly I need to refactor?</p>\n\n<p><strong>ERROR</strong>:</p>\n\n<pre><code>2019/03/13 18:15:47 http: panic serving [::1]:28363: runtime error: invalid memory address or nil pointer dereference\ngoroutine 54 [running]:\nnet/http.(*conn).serve.func1(0xc0000dee60)\n    C:/Go/src/net/http/server.go:1746 +0xd7\npanic(0x874bc0, 0x7ff060)\n    C:/Go/src/runtime/panic.go:513 +0x1c7\ndatabase/sql.(*DB).conn(0x0, 0x95d140, 0xc0000120a8, 0x1, 0x0, 0xc0000dec60, 0xc00037d950)\n    C:/Go/src/database/sql/sql.go:1081 +0x41\ndatabase/sql.(*DB).query(0x0, 0x95d140, 0xc0000120a8, 0x8fde32, 0x65, 0x0, 0x0, 0x0, 0x6b2801, 0x8, ...)\n    C:/Go/src/database/sql/sql.go:1514 +0x6d\ndatabase/sql.(*DB).QueryContext(0x0, 0x95d140, 0xc0000120a8, 0x8fde32, 0x65, 0x0, 0x0, 0x0, 0x30, 0x30, ...)\n    C:/Go/src/database/sql/sql.go:1496 +0xda\ndatabase/sql.(*DB).Query(0x0, 0x8fde32, 0x65, 0x0, 0x0, 0x0, 0x78, 0x80, 0xc000446100)\n    C:/Go/src/database/sql/sql.go:1510 +0x89\nquestionnaire/controllers.glob..func11(0x95cd80, 0xc000448000, 0xc00016e400)\n    C:/Users/NNogerbek/go/src/questionnaire/controllers/organizations.go:18 +0x6f\nnet/http.HandlerFunc.ServeHTTP(0x9031f8, 0x95cd80, 0xc000448000, 0xc00016e400)\n    C:/Go/src/net/http/server.go:1964 +0x4b\ngithub.com/gorilla/mux.(*Router).ServeHTTP(0xc0003da300, 0x95cd80, 0xc000448000, 0xc000444000)\n    C:/Users/NNogerbek/go/src/github.com/gorilla/mux/mux.go:212 +0xd7\ngithub.com/gorilla/handlers.(*cors).ServeHTTP(0xc0000d8900, 0x95cd80, 0xc000448000, 0xc000444000)\n    C:/Users/NNogerbek/go/src/github.com/gorilla/handlers/cors.go:54 +0xa95\nnet/http.serverHandler.ServeHTTP(0xc000054b60, 0x95cd80, 0xc000448000, 0xc000444000)\n    C:/Go/src/net/http/server.go:2741 +0xb2\nnet/http.(*conn).serve(0xc0000dee60, 0x95d100, 0xc000178000)\n    C:/Go/src/net/http/server.go:1847 +0x64d\ncreated by net/http.(*Server).Serve\n    C:/Go/src/net/http/server.go:2851 +0x2fc\n</code></pre>\n\n<p><strong>structure</strong>:</p>\n\n<pre><code>- database\n    Oracle.go\n- routes\n    routes.go\n- controllers\n    organizations.go\nmain.go\n</code></pre>\n\n<p><strong>main.go</strong>:</p>\n\n<pre><code>import (\n    \"github.com/gorilla/handlers\"\n    \"github.com/gorilla/mux\"\n    \"github.com/joho/godotenv\"\n    \"log\"\n    \"net/http\"\n    \"project/database\"\n    \"project/routes\"\n    \"project/utils\"\n)\n\nfunc main()  {\n    err := godotenv.Load(\".env\")\n    if err != nil {\n        panic(err)\n    }\n\n    database.ConnectOracle()\n    defer database.DisconnectOracle()\n\n    router := mux.NewRouter()\n\n    headers := handlers.AllowedHeaders([]string{\"X-Requested-With\", \"Content-Type\", \"Authorization\"})\n    methods := handlers.AllowedMethods([]string{\"GET\", \"POST\", \"PATCH\", \"PUT\", \"DELETE\", \"OPTIONS\"})\n    origins := handlers.AllowedOrigins([]string{\"*\"})\n\n    router.StrictSlash(true)\n\n    routes.Handle(router)\n\n    port := utils.CheckEnvironmentVariable(\"APPLICATION_PORT\")\n\n    log.Printf(\"RESTful web service is running on %s port.\", port)\n\n    log.Fatal(http.ListenAndServe(\":\" + port, handlers.CORS(headers, methods, origins)(router)))\n}\n</code></pre>\n\n<p><strong>Oracle.go</strong>:</p>\n\n<pre><code>package database\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"github.com/joho/godotenv\"\n    _ \"gopkg.in/goracle.v2\"\n    \"log\"\n    \"questionnaire/utils\"\n)\n\nvar OracleDB *sql.DB\n\nfunc ConnectOracle() {\n    err := godotenv.Load(\".env\")\n    if err != nil {\n        log.Println(err)\n        panic(err)\n    }\n\n    databaseUser := utils.CheckEnvironmentVariable(\"ORACLE_USER\")\n    databasePassword := utils.CheckEnvironmentVariable(\"ORACLE_PASSWORD\")\n    databaseHost := utils.CheckEnvironmentVariable(\"ORACLE_HOST\")\n    databasePort := utils.CheckEnvironmentVariable(\"ORACLE_PORT\")\n    databaseName := utils.CheckEnvironmentVariable(\"ORACLE_DATABASE_NAME\")\n\n    databaseURL:= fmt.Sprintf(\"%s/%s@%s:%s/%s\", databaseUser, databasePassword, databaseHost, databasePort, databaseName)\n\n    OracleDB, err := sql.Open(\"goracle\", databaseURL)\n    if err != nil {\n        log.Println(err)\n        panic(err)\n    }\n\n    err = OracleDB.Ping()\n    if err != nil {\n        log.Println(err)\n        panic(err)\n    }\n\n    log.Println(\"RESTful web service successfully connected to remote ORACLE database with the help of \\\"database/sql\\\" package.\")\n}\n\nfunc DisconnectOracle() error {\n    return OracleDB.Close()\n}\n</code></pre>\n\n<p><strong>routes.go:</strong></p>\n\n<pre><code>package routes\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"project/controllers\"\n)\n\nfunc Handle(router *mux.Router) {\n    router.HandleFunc(\"/api/organizations\", controllers.GetOrganizations).Methods(\"GET\")\n}\n</code></pre>\n\n<p><strong>organizations.go</strong>:</p>\n\n<pre><code>package controllers\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"project/database\"\n    \"project/utils\"\n)\n\ntype Organisation struct {\n    OrganizationID int `json:\"organization_id\"`\n    ParentOrganizationID int `json:\"parent_organization_id\"`\n    OrganizationName string `json:\"organization_name\"`\n    OrganizationRang int `json:\"organization_name\"`\n}\n\nvar GetOrganizations = func(responseWriter http.ResponseWriter, request *http.Request) {\n    rows, err := database.OracleDB.Query(\"SELECT ORGANIZATION_ID, PARENT_ORGANIZATION_ID, ORGANIZATION_NAME, ORGANIZATION_RANG FROM ORG_STR\")\n    if err != nil {\n        log.Println(err)\n        utils.ResponseWithError(responseWriter, http.StatusInternalServerError, err.Error())\n        return\n    }\n    defer rows.Close()\n\n    var organizations []Organisation\n\n    for rows.Next() {\n        var organization Organisation\n\n        if err := rows.Scan(&amp;organization.OrganizationID, &amp;organization.ParentOrganizationID, &amp;organization.OrganizationName, &amp;organization.OrganizationRang); err != nil {\n            log.Println(err)\n            utils.ResponseWithError(responseWriter, http.StatusInternalServerError, err.Error())\n            return\n        }\n\n        organizations = append(organizations, organization)\n    }\n\n    utils.Response(responseWriter, http.StatusOK, organizations)\n}\n</code></pre>\n"}, {"tags": ["go", "delay", "server-sent-events"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1552485886, "post_id": 55142562, "comment_id": 97027915, "body": "The code you posted does not explain any delay, but this is not how SSE is used (or should be used). You return from the handler once sending back the first message. Usually SSE handlers have a loop to keep sending back updates to the client. Also the way you receive from the <code>Log</code> channel is dangerous, if multiple clients connect to the SSE endpoint, they will race who get the message, and you don&#39;t handle context cancellation."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1552485893, "post_id": 55142562, "comment_id": 97027921, "body": "And if there is no client listening, you will leak goroutines with <code>go UpdateLogMessage(&quot;Example&quot;)</code>, as that won&#39;t be able to send on the channel and thus hang forever. Check out this example: <a href=\"https://stackoverflow.com/questions/48267616/why-is-golang-http-responsewriter-execution-being-delayed/48270817#48270817\">Why is Golang http.ResponseWriter execution being delayed?</a>"}, {"owner": {"reputation": 21, "user_id": 9481930, "user_type": "registered", "profile_image": "https://graph.facebook.com/1864503013583303/picture?type=large", "display_name": "Dzionys", "link": "https://stackoverflow.com/users/9481930/dzionys"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1552567432, "post_id": 55142562, "comment_id": 97064555, "body": "Thanks! Delay probably happened because with every message I returned from handler as you said. I now changed that by adding loop so it should work fine, but since I use upload form when I start to upload file HTTP connection closes and I get 0 messages during uploading. I probably need to use Ajax for file upload to make it work properly."}], "owner": {"reputation": 21, "user_id": 9481930, "user_type": "registered", "profile_image": "https://graph.facebook.com/1864503013583303/picture?type=large", "display_name": "Dzionys", "link": "https://stackoverflow.com/users/9481930/dzionys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 561, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552483330, "creation_date": 1552482208, "last_edit_date": 1552483330, "question_id": 55142562, "link": "https://stackoverflow.com/questions/55142562/sse-delay-in-golang", "title": "SSE delay in golang", "body": "<p>I'm trying to make console using sse that shows client what server is doing. Currently it does what I want except it has a delay (about 2sec). I added http.Flusher but is seems to do absolutely nothing. I call UpdateLogMessage using goroutines: <code>go UpdateLogMessage(\"Example\")</code></p>\n\n<p>SSE:</p>\n\n<pre><code>type Upl struct {\n    log string\n}\n\nvar Log chan *Upl\n\nfunc DashboardHandler(w http.ResponseWriter, r *http.Request) {\n    f, ok := w.(http.Flusher)\n    if !ok {\n        fmt.Println(\"Streaming unsuported\")\n    }\n\n    w.Header().Set(\"Content-Type\", \"text/event-stream\")\n    w.Header().Set(\"Cache-Control\", \"no-cache\")\n    w.Header().Set(\"Connection\", \"keep-alive\")\n\n    msg := &lt;-Log\n    fmt.Fprintf(w, \"data: %v\\n\\n\", msg.log)\n    f.Flush()\n}\n\n//Updates log message with curent time and message content\nfunc UpdateLogMessage(msg string) {\n    curentTime := time.Now().Format(\"15:04:05\")\n    ul := fmt.Sprintf(\"&lt;%v&gt; %v\", curentTime, msg)\n    up := &amp;Upl{\n        log: ul,\n    }\n    Log &lt;- up\n}\n\nfunc MakeChan() {\n    Log = make(chan *Upl)\n}\n</code></pre>\n\n<p>Javascript:</p>\n\n<pre><code>function onLoaded(){\n    var source = new EventSource(\"sse/dashboard\")\n    var logg = \"\";\n    var currentmsg = \"\";\n\n    source.onmessage = function (event){\n        var dashboard = event.data;\n        //If message changed print it to console\n        if (dashboard != currentmsg){\n            console.log(\"OnMessage called:\");\n            console.dir(event);\n            currentmsg = dashboard;\n            logg += currentmsg + \"&lt;br/&gt;\";\n            console.log(logg);\n            document.getElementById(\"console\").innerHTML = logg;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1552481959, "post_id": 55142370, "comment_id": 97025152, "body": "Some things in Go are literally <i>unaddressable</i>: You simply cannot take their address because the language spec <i>forbids</i> it."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1552482068, "post_id": 55142370, "comment_id": 97025219, "body": "This: <code>(*sp4)[1:]</code> is a slice expression, it results in a slice value. This value may not have a memory address as it is not in a variable, it may just live in processor registers until you store it in a variable. To give the compiler the freedom to store it wherever it sees best, the spec does not allow taking its address."}], "owner": {"reputation": 719, "user_id": 6159371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IkhNG.jpg?s=128&g=1", "display_name": "pingze", "link": "https://stackoverflow.com/users/6159371/pingze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "closed_date": 1552482010, "answer_count": 0, "score": 0, "last_activity_date": 1552481615, "creation_date": 1552481538, "last_edit_date": 1552481615, "question_id": 55142370, "link": "https://stackoverflow.com/questions/55142370/how-to-explain-this-strange-phenomenon-about-pointer-of-slice-in-golang", "closed_reason": "Duplicate", "title": "How to explain this strange phenomenon about pointer of slice in Golang?", "body": "<p>In the code below:</p>\n\n<pre><code>s4 := []int{0, 1, 2, 3, 4, 5}\nsp4 := &amp;s4\nsp5 := &amp;((*sp4)[1:])\n</code></pre>\n\n<p>I want to get the pointer a slice of <code>s4[1:]</code> as s5, but this cause an error:</p>\n\n<pre><code>cannot take the address of (*sp4)[1:]\n</code></pre>\n\n<p>But if I write like this:</p>\n\n<pre><code>s4 := []int{0, 1, 2, 3, 4, 5}\nsp4 := &amp;s4\ns5 := (*sp4)[1:]\nsp5 := &amp;s5\n</code></pre>\n\n<p>It works!</p>\n\n<p>I have made some tests, and found that when I change *sp5, s4 change as while. That's what I just need.</p>\n\n<p>But <strong>why</strong> cannot I write <code>sp5 := &amp;((*sp4)[1:])</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1552480570, "post_id": 55141964, "comment_id": 97024262, "body": "you can create method on the types, these methods cn have the same name. but if country and city are the excat same struct then why make 2 structs?"}, {"owner": {"reputation": 694, "user_id": 8627962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4f-Yq3BvCaA/AAAAAAAAAAI/AAAAAAAAARM/NeJoNAwQHT0/photo.jpg?sz=128", "display_name": "Siva Guru", "link": "https://stackoverflow.com/users/8627962/siva-guru"}, "edited": false, "score": 0, "creation_date": 1552480691, "post_id": 55141964, "comment_id": 97024346, "body": "you could try to make the function take type of []interface{}"}, {"owner": {"reputation": 121, "user_id": 5409568, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/835303813251321/picture?type=large", "display_name": "Clowning", "link": "https://stackoverflow.com/users/5409568/clowning"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1552481002, "post_id": 55141964, "comment_id": 97024537, "body": "@Pizzalord Each struct is linked with Gorm and sometimes they are some additional fields ! What do you mean by create method on the types?"}, {"owner": {"reputation": 121, "user_id": 5409568, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/835303813251321/picture?type=large", "display_name": "Clowning", "link": "https://stackoverflow.com/users/5409568/clowning"}, "reply_to_user": {"reputation": 694, "user_id": 8627962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4f-Yq3BvCaA/AAAAAAAAAAI/AAAAAAAAARM/NeJoNAwQHT0/photo.jpg?sz=128", "display_name": "Siva Guru", "link": "https://stackoverflow.com/users/8627962/siva-guru"}, "edited": false, "score": 0, "creation_date": 1552481013, "post_id": 55141964, "comment_id": 97024548, "body": "@SivaGuru I tried by isn&#39;t working for array -&gt; Cannot use &#39;offer.Countries&#39; (type []Country) as type []interface{}"}, {"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1552481218, "post_id": 55141964, "comment_id": 97024680, "body": "@Clowning you could do func x(array interface{}) instead of x(array []interface{}), since you are sending 1 interface which is an array"}, {"owner": {"reputation": 121, "user_id": 5409568, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/835303813251321/picture?type=large", "display_name": "Clowning", "link": "https://stackoverflow.com/users/5409568/clowning"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1552481315, "post_id": 55141964, "comment_id": 97024739, "body": "@Pizzalord You right! Thanks! But how can I transform it to an array again ?"}, {"owner": {"reputation": 694, "user_id": 8627962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4f-Yq3BvCaA/AAAAAAAAAAI/AAAAAAAAARM/NeJoNAwQHT0/photo.jpg?sz=128", "display_name": "Siva Guru", "link": "https://stackoverflow.com/users/8627962/siva-guru"}, "edited": false, "score": 0, "creation_date": 1552481371, "post_id": 55141964, "comment_id": 97024775, "body": "for the function you could use &quot;func modify(a interface{})&quot; and inside the function x , ok := a.([]Country)"}], "answers": [{"tags": [], "owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "is_accepted": false, "score": 1, "last_activity_date": 1552482351, "creation_date": 1552482351, "answer_id": 55142605, "question_id": 55141964, "link": "https://stackoverflow.com/questions/55141964/how-to-pass-mutiple-type-array-in-single-func/55142605#55142605", "title": "How to pass mutiple type array in single func", "body": "<p>i already posted this in the comments but you can do this</p>\n\n<pre><code>func myfunc(in interface{}) {\n    switch in.(type) {\n    case []Country:\n        // country logic here\n    case []City:\n        // city logic here\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 3, "last_activity_date": 1552488031, "creation_date": 1552488031, "answer_id": 55144562, "question_id": 55141964, "link": "https://stackoverflow.com/questions/55141964/how-to-pass-mutiple-type-array-in-single-func/55144562#55144562", "title": "How to pass mutiple type array in single func", "body": "<p>It looks like you're trying to recreate class inheritance in Go. Go does not have class inheritance on purpose. Do not try to recreate it. I believe you're thinking \"Country is a Base.\" That's not correct. Country <em>embeds</em> a Base. That's not the same thing. This matters for how you name things. In this case, it seems that \"Base\" is really \"location metadata\", so we'll call it that.</p>\n\n<pre><code>type LocationMeta struct {\n    id   string\n    name string\n    code string\n}\n</code></pre>\n\n<p>And you want an interface to work with for all kinds of locations.</p>\n\n<pre><code>type Location interface {\n    Id() string\n    Name() string\n    Code() string\n}\n</code></pre>\n\n<p>We can conform LocationMeta to Location, though this is possibly a little strange (is the metadata <em>really</em> a Location?). But it works.</p>\n\n<pre><code>func (b LocationMeta) Id() string {\n    return b.id\n}\n\nfunc (b LocationMeta) Name() string {\n    return b.name\n}\n\nfunc (b LocationMeta) Code() string {\n    return b.code\n}\n</code></pre>\n\n<p>And we can embed LocationMeta in a City:</p>\n\n<pre><code>type City struct {\n    LocationMeta\n}\n</code></pre>\n\n<p>And for free, City now conforms to Location.</p>\n\n<p>That said, usually you don't bother with this kind of embedding for such a small thing with no logic of its own. That's really overkill; I was just demonstrating it because you seem to be using it. Normally, you'd just conform each type itself:</p>\n\n<pre><code>type Country struct {\n    id   string\n    name string\n    code string\n}\n\nfunc (c Country) Id() string {\n    return c.id\n}\n\nfunc (c Country) Name() string {\n    return c.name\n}\n\nfunc (c Country) Code() string {\n    return c.code\n}\n</code></pre>\n\n<p>The great thing about Go is that it doesn't care how you conform to the interface. City and Country both conform to Location, in completely different ways, and that's totally fine.</p>\n\n<p>So you can then create a city:</p>\n\n<pre><code>boston := City{LocationMeta{id: \"bos\", name: \"Boston\", code: \"bos\"}}\n</code></pre>\n\n<p>See how weird this is? We have to create a LocationMeta because of the embedded object. It can be worth it sometimes (and is incredibly powerful), but I would probably have done both City and Country the Country way (with no LocationMeta):</p>\n\n<pre><code>us := Country{id: \"us\", name: \"USA\", code: \"us\"}\n</code></pre>\n\n<p>But still, they're both Locations, so we can put them in a slice:</p>\n\n<pre><code>locations := []Location{boston, us}\n</code></pre>\n\n<p>And pass them to things:</p>\n\n<pre><code>func printLocations(locations []Location) {\n    fmt.Println(locations)\n}\n\nprintLocations(locations)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/x9TUKAOjItr\" rel=\"nofollow noreferrer\">Playground of this code</a></p>\n\n<p><a href=\"https://play.golang.org/p/i7G7nG4pyPH\" rel=\"nofollow noreferrer\">Playground using embedding for everything</a></p>\n\n<p><a href=\"https://play.golang.org/p/8ZRe4GG5Kd2\" rel=\"nofollow noreferrer\">Playground of more typical approach with just structs</a></p>\n"}], "owner": {"reputation": 121, "user_id": 5409568, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/835303813251321/picture?type=large", "display_name": "Clowning", "link": "https://stackoverflow.com/users/5409568/clowning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 55144562, "answer_count": 2, "score": -3, "last_activity_date": 1552488031, "creation_date": 1552480195, "last_edit_date": 1552481035, "question_id": 55141964, "link": "https://stackoverflow.com/questions/55141964/how-to-pass-mutiple-type-array-in-single-func", "title": "How to pass mutiple type array in single func", "body": "<p>I have multiple structs</p>\n\n<pre><code>type Base struct {\n    Id string\n    Name string\n    Code string\n}\n</code></pre>\n\n<pre><code>type Country struct {\n    Base\n    ...\n}\n</code></pre>\n\n<pre><code>type City struct {\n    Base\n    ...\n}\n</code></pre>\n\n<p>And I need to make a function that takes an array of City or Country. Currently, I have one func for each type which is doing the same thing and I guess that isn't the best/good way to do it!</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1552479397, "post_id": 55141402, "comment_id": 97023476, "body": "Have you considered <code>for q := f(); q != &quot;exit&quot;; q = f() {</code>? <a href=\"https://play.golang.com/p/N8uerScb1kg\" rel=\"nofollow noreferrer\">example</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 6, "creation_date": 1552479684, "post_id": 55141402, "comment_id": 97023674, "body": "You have waaay too much code in your question. If &quot;Only the first three lines are important&quot;, please include only the first three lines. In general, post a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable example</a>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1552480113, "post_id": 55141402, "comment_id": 97023963, "body": "You seem to be aware that the init statement of a for loop is executed just once and this is your problem. So what is the actual question?"}, {"owner": {"reputation": 49, "user_id": 9266322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6b3bd0b12ee7328c9f03bae351895?s=128&d=identicon&r=PG&f=1", "display_name": "VCM", "link": "https://stackoverflow.com/users/9266322/vcm"}, "edited": false, "score": 0, "creation_date": 1552481598, "post_id": 55141402, "comment_id": 97024917, "body": "Thanks, mkopriva, didnt considered that! Yes, you are right, Flimzy, I will clean a bit the post to make it more legible to anyone who has the same problem. I was looking for a more clear implementation of what I wanted to do, Volker. Thanks you all for the fast responses"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552484088, "post_id": 55141402, "comment_id": 97026620, "body": "That&#39;s pretty much the definition of &quot;init statement&quot;. It <i>initializes</i> the loop. If it ran more than once, that would be extremely misleading."}], "answers": [{"tags": [], "owner": {"reputation": 2119, "user_id": 3447910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2HdtL.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/3447910/greg"}, "is_accepted": true, "score": 0, "last_activity_date": 1552480793, "last_edit_date": 1552480793, "creation_date": 1552480446, "answer_id": 55142070, "question_id": 55141402, "link": "https://stackoverflow.com/questions/55141402/only-entering-function-once-in-for-init-statement/55142070#55142070", "title": "Only entering function once in for init statement", "body": "<p>You need to add a post statement to your loop that will be called on each iteration.</p>\n\n<pre><code>var query string\nfor query = ReadQuery(); query != \"exit\\n\"; query = ReadQuery() {\n    // loop body\n}\n</code></pre>\n\n<p>The <a href=\"https://tour.golang.org/flowcontrol/1\" rel=\"nofollow noreferrer\">Go Tour</a> has a good explanation of this functionality.</p>\n"}], "owner": {"reputation": 49, "user_id": 9266322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b6b3bd0b12ee7328c9f03bae351895?s=128&d=identicon&r=PG&f=1", "display_name": "VCM", "link": "https://stackoverflow.com/users/9266322/vcm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 55142070, "answer_count": 1, "score": -2, "last_activity_date": 1552482610, "creation_date": 1552478354, "last_edit_date": 1552482610, "question_id": 55141402, "link": "https://stackoverflow.com/questions/55141402/only-entering-function-once-in-for-init-statement", "title": "Only entering function once in for init statement", "body": "<p>I am starting programming with Go and I am trying to create a program that makes queries to a DB and return the data. I have achieved this but I have encounter some problems and questions during this.</p>\n\n<p>Firstly, I tried to create a for with a condition to tell the program when I want to stop making queries, but the Init Statement of the for looks that only is evaluated once -and I am never asked again to enter input via terminal- (I have read here that is because his value is hold and then it doesnt execute the function again: <a href=\"https://stackoverflow.com/questions/39262903/golang-switch-statement-only-calls-function-once\">Golang switch statement only calls function once</a> ):</p>\n\n<p><strong>Edited</strong></p>\n\n<pre><code>func main() {\n    var query string\n    for query = ReadQuery(); query != \"exit\\n\"; {\n        rows, err := db.Query(query)\n        //Printing results and other operations\n    }\n    fmt.Println(\"Exiting\")\n}\n\nfunc ReadQuery() string {\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter query in a single line, with no newline. 'exit' to terminate execution: \\n\")\n    query, _ :=reader.ReadString('\\n')\n    reader.Reset(os.Stdin)\n    return query\n}\n</code></pre>\n\n<p>...so I have done this fix that looks to me a bit dirty:</p>\n\n<pre><code>func main() {\n    var query string\n    for {\n        query = ReadQuery()\n        if query == \"exit\\n\" {\n            fmt.Println(\"Exiting\")\n            break\n        }\n        //Printing results and other operations\n    }\n}\n\nfunc ReadQuery() string {\n   reader := bufio.NewReader(os.Stdin)\n   fmt.Print(\"Enter query in a single line, with no newline. 'exit' to terminate execution: \\n\")\n   query, _ :=reader.ReadString('\\n')\n   reader.Reset(os.Stdin)\n   return query\n}\n</code></pre>\n\n<p>So the question is if there is another way to do this using for statements and  avoid more lines to my code. Lot of thanks</p>\n"}, {"tags": ["go", "protocol-buffers", "grpc"], "comments": [{"owner": {"reputation": 602, "user_id": 6863654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VaBUN.png?s=128&g=1", "display_name": "beiping96", "link": "https://stackoverflow.com/users/6863654/beiping96"}, "edited": false, "score": 0, "creation_date": 1552985954, "post_id": 55140587, "comment_id": 97207105, "body": "I saw that two user structs have the same json tag, have you try to use json.Marshal and json.Unmarshal to convert two user structs?"}, {"owner": {"reputation": 4055, "user_id": 2598037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWCTo.jpg?s=128&g=1", "display_name": "Carl Mastrangelo", "link": "https://stackoverflow.com/users/2598037/carl-mastrangelo"}, "edited": false, "score": 0, "creation_date": 1553026134, "post_id": 55140587, "comment_id": 97231119, "body": "Were you planning on copying the Proto to the Struct by some other means than field by field?  That&#39;s probably the fastest and safest way to do so.   Protobuf states on it&#39;s site that it is not a general purpose data structure, and recommends you convert it to your domain specific representations."}], "answers": [{"comments": [{"owner": {"reputation": 4423, "user_id": 6215637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GKVsX.jpg?s=128&g=1", "display_name": "Ridham Tarpara", "link": "https://stackoverflow.com/users/6215637/ridham-tarpara"}, "edited": false, "score": 0, "creation_date": 1552482758, "post_id": 55140897, "comment_id": 97025685, "body": "Problem is I am getting nil; from the database so I have to write if-else ladder for every optional variable."}, {"owner": {"reputation": 444, "user_id": 7918749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r9BIg.jpg?s=128&g=1", "display_name": "Black_Dreams", "link": "https://stackoverflow.com/users/7918749/black-dreams"}, "reply_to_user": {"reputation": 4423, "user_id": 6215637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GKVsX.jpg?s=128&g=1", "display_name": "Ridham Tarpara", "link": "https://stackoverflow.com/users/6215637/ridham-tarpara"}, "edited": false, "score": 0, "creation_date": 1552484115, "post_id": 55140897, "comment_id": 97026644, "body": "You have to check the manually if your field is nullable or not.  There is no such a solution for this you have to deal with this as per   <a href=\"https://stackoverflow.com/questions/21227924/handling-null-values-in-protobuffers\" title=\"handling null values in protobuffers\">stackoverflow.com/questions/21227924/&hellip;</a>."}], "tags": [], "owner": {"reputation": 444, "user_id": 7918749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r9BIg.jpg?s=128&g=1", "display_name": "Black_Dreams", "link": "https://stackoverflow.com/users/7918749/black-dreams"}, "is_accepted": false, "score": 1, "last_activity_date": 1552476685, "creation_date": 1552476685, "answer_id": 55140897, "question_id": 55140587, "link": "https://stackoverflow.com/questions/55140587/null-value-issue-in-models-in-grpc-go/55140897#55140897", "title": "null value issue in models in grpc-go", "body": "<p>You cannot set the null value instead of you you can use </p>\n\n<pre><code>oneof Examples {\n    Example1 example1 = 1;\n    Example2 example2 = 2;\n}\n</code></pre>\n\n<p>when you use oneof you have to set only one value either you can set example1 or example2 you cannot use both at same time. This will resolve your issue as compared to setting the nil value.</p>\n\n<p>Approach 2:</p>\n\n<p>And by default gRPC have all the variable has initial value ex: string: \"\"</p>\n\n<p>One thing you can also do don't set nil value check with the condition if your value is nil then set nothing.</p>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 5218121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b308136b453109457c54443dbc9fab7d?s=128&d=identicon&r=PG&f=1", "display_name": "big pigeon", "link": "https://stackoverflow.com/users/5218121/big-pigeon"}, "is_accepted": false, "score": 1, "last_activity_date": 1552901613, "creation_date": 1552901613, "answer_id": 55218264, "question_id": 55140587, "link": "https://stackoverflow.com/questions/55140587/null-value-issue-in-models-in-grpc-go/55218264#55218264", "title": "null value issue in models in grpc-go", "body": "<p>grpc not recommended to use point field, If you insist on use pointers</p>\n\n<p>the one way is use reflect to convert it</p>\n\n<pre><code>func ToGrpcData(in, out interface{}) error {\n    inVal := reflect.ValueOf(in)\n    if inVal.Kind() == reflect.Ptr {\n        inVal = inVal.Elem()\n    }\n    inTyp := inVal.Type()\n\n    outVal := reflect.ValueOf(out)\n    if outVal.Kind() != reflect.Ptr {\n        return errors.New(\"out data must be point value\")\n    }\n\n    outVal = outVal.Elem()\n    outTyp := outVal.Type()\n\n    strWrapperType := reflect.TypeOf(wrappers.StringValue{})\n    // range all 'in' fields\n    for i := 0; i &lt; inVal.NumField(); i++ {\n        fTyp := inTyp.Field(i)\n        fVal := inVal.Field(i)\n        if fTyp.Type.Kind() == reflect.Ptr {\n            switch fTyp.Type.Elem().Kind() {\n            case reflect.String: // only implement string in this test\n                oFTyp, ok := outTyp.FieldByName(fTyp.Name)\n                if ok == false {\n                    return errors.New(\"not match field in out value\")\n                }\n                if oFTyp.Type.Elem() != strWrapperType {\n                    return errors.New(\"not match field in out value\")\n                }\n                if fVal.IsNil() == false {\n                    outVal.FieldByName(fTyp.Name).Set(\n                        reflect.ValueOf(&amp;wrappers.StringValue{\n                            Value: fVal.Elem().String(),\n                        }),\n                    )\n                }\n            }\n        } else {\n            outVal.FieldByName(fTyp.Name).Set(fVal)\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<p>usage</p>\n\n<pre><code>type User struct {\n    Name  string\n    Value *string\n}\ntype ServerUser struct {\n    Name  string\n    Value *wrappers.StringValue\n}\nusValue := \"123\"\nu1 := User{\n    Name:  \"tom\",\n    Value: &amp;usValue,\n}\nu2 := ServerUser{}\nerr := ToGrpcData(&amp;u1, &amp;u2)\n// error process ...\nfmt.Println(u2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 11229359, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yeurEmm_1Sk/AAAAAAAAAAI/AAAAAAAAGyU/zsZXiYva3Vw/photo.jpg?sz=128", "display_name": "Patrick Cromer", "link": "https://stackoverflow.com/users/11229359/patrick-cromer"}, "is_accepted": false, "score": 2, "last_activity_date": 1553058050, "creation_date": 1553058050, "answer_id": 55253839, "question_id": 55140587, "link": "https://stackoverflow.com/questions/55140587/null-value-issue-in-models-in-grpc-go/55253839#55253839", "title": "null value issue in models in grpc-go", "body": "<p>As another answer above noted, if the protocol buffer message has fields that can be nil it is on you to check for them. There isn't much you can do about this, unless there's a utility package out there that does it.</p>\n\n<p>If you want defaults above and beyond the defaults protocol buffers generates, you'll have to do exactly what you noted and check for nil.</p>\n\n<p>I do have some questions though:</p>\n\n<ul>\n<li>Why use pointers for the \"optional\" fields in first User struct? If you used plain-old string they would be populated with the empty string on construction and untouched by the json unmarshal call if the field is missing. Same for the time fields. In this case the default value for string (the empty string) should be an invalid middle name, and the default value for time (0001-01-01 00:00:00 +0000 UTC) is an invalid timestamp (probably?). Getting rid of the pointers allows you to use the defaults.</li>\n<li>For the timestamp in the proto struct you could still use string and check for the empty string. Or you could use google.protobuf.Timestamp and use ptypes to handle the conversions to/from the non-proto struct. See <a href=\"https://godoc.org/github.com/golang/protobuf/ptypes#TimestampProto\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/golang/protobuf/ptypes#TimestampProto</a>. You'll have to check for nil in this case.</li>\n</ul>\n"}], "owner": {"reputation": 4423, "user_id": 6215637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GKVsX.jpg?s=128&g=1", "display_name": "Ridham Tarpara", "link": "https://stackoverflow.com/users/6215637/ridham-tarpara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3741, "favorite_count": 2, "answer_count": 3, "score": 4, "last_activity_date": 1553058050, "creation_date": 1552475688, "last_edit_date": 1552558982, "question_id": 55140587, "link": "https://stackoverflow.com/questions/55140587/null-value-issue-in-models-in-grpc-go", "title": "null value issue in models in grpc-go", "body": "<p>I have two servers</p>\n\n<ol>\n<li><strong>User Server</strong>: handle all the user CRUD operation</li>\n<li><p><strong>Product Server</strong>: Handle Product CRUD operation and fetch user info from the user server via gRPC call</p>\n\n<pre><code>type User struct {\n    ID string `json:\"id\"`\n    FirstName      string     `json:\"firstName\"`\n    MiddleName     *string    `json:\"middleName,omitempty\"`\n    LastName       string     `json:\"lastName\"`\n    Email          string     `json:\"email\"`\n    Disabled       bool       `json:\"disabled\"`\n    LastSignedInAt *time.Time `json:\"lastSignedInAt,omitempty\"`\n    Bio            *string    `json:\"bio,omitempty\"`\n    BirthDate      *time.Time `json:\"birthDate,omitempty\"`\n}\n</code></pre>\n\n<p>Here some fields are optionals and as I am using cockroachDB(extended postgreSQL), I kept them as a pointer so it's easy in scaning variable form query result.</p></li>\n</ol>\n\n<p>And here is my proto file:</p>\n\n<pre><code>message User {\n    int64 id = 1;\n    string firstName = 2;\n    string lastName = 3;\n    string email = 5;\n    bool disabled = 6;\n    string lastSignedInAt = 8;\n    string bio = 9;\n    string birthdate = 10;\n    string profession = 14;\n}\n</code></pre>\n\n<p>Now generated model from above proto file is like this:\"</p>\n\n<pre><code>type User struct {\n    Id                   int64                 `protobuf:\"varint,1,opt,name=id,proto3\" json:\"id,omitempty\"`\n    FirstName            string                `protobuf:\"bytes,2,opt,name=firstName,proto3\" json:\"firstName,omitempty\"`\n    LastName             string                `protobuf:\"bytes,3,opt,name=lastName,proto3\" json:\"lastName,omitempty\"`\n    Email                string                `protobuf:\"bytes,4,opt,name=email,json=email,proto3\" json:\"email,omitempty\"`\n    Disabled             bool                  `protobuf:\"varint,6,opt,name=disabled,proto3\" json:\"disabled,omitempty\"`\n    LastSignedInAt       string                `protobuf:\"bytes,8,opt,name=lastSignedInAt,proto3\" json:\"lastSignedInAt,omitempty\"`\n    Bio                  string                `protobuf:\"bytes,9,opt,name=bio,proto3\" json:\"bio,omitempty\"`\n    Birthdate            string                `protobuf:\"bytes,10,opt,name=birthdate,proto3\" json:\"birthdate,omitempty\"`\n}\n</code></pre>\n\n<p>Now the problem is as I am using a pointer for the optional field it will store null in case of no value but on the opposite site gRPC won't understand the null value and throw the error.</p>\n\n<p>I have tried <code>google.protobuf.StringValue</code> value as a grpc type like this</p>\n\n<pre><code>google.protobuf.StringValue lastSignedInAt = 8;\n</code></pre>\n\n<p>This works but the problem is  I have to write condition for each field in the handler:</p>\n\n<pre><code>if lastSignedInAt != nil {\n    user.LastSignedInAt = &amp;wrappers.StringValue{Value:*lastSignedInAt}\n}\n</code></pre>\n\n<p>What is the best way to tackle this issue? Should I change the database model or any changes in the gRPC model?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1552472854, "post_id": 55139423, "comment_id": 97019436, "body": "And where do you check the file? The name <code>&#47;upload</code> is <b>absolute</b>, it denotes a file in your <b>root directory</b>, its being <code>upload</code>; it will not be created in the current directory nor in an <code>upload</code> subfolder!"}, {"owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1552473921, "post_id": 55139423, "comment_id": 97020123, "body": "Okay I understand now. Thanks Sir Icza"}], "answers": [{"tags": [], "owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "is_accepted": true, "score": 0, "last_activity_date": 1552484206, "creation_date": 1552484206, "answer_id": 55143208, "question_id": 55139423, "link": "https://stackoverflow.com/questions/55139423/file-not-uploaded-to-directory-using-go/55143208#55143208", "title": "File not uploaded to directory using go", "body": "<p>Below is how I get my files uploaded to server. \n<a href=\"https://tutorialedge.net/golang/go-file-upload-tutorial/\" rel=\"nofollow noreferrer\">Source</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc uploadFile(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"File Upload Endpoint Hit\")\n\n    // Parse our multipart form, 10 &lt;&lt; 20 specifies a maximum\n    // upload of 10 MB files.\n    r.ParseMultipartForm(10 &lt;&lt; 20)\n    // FormFile returns the first file for the given key `myFile`\n    // it also returns the FileHeader so we can get the Filename,\n    // the Header and the size of the file\n    file, handler, err := r.FormFile(\"myFile\")\n    if err != nil {\n        fmt.Println(\"Error Retrieving the File\")\n        fmt.Println(err)\n        return\n    }\n    defer file.Close()\n    fmt.Printf(\"Uploaded File: %+v\\n\", handler.Filename)\n    fmt.Printf(\"File Size: %+v\\n\", handler.Size)\n    fmt.Printf(\"MIME Header: %+v\\n\", handler.Header)\n\n    // Create a temporary file within our temp-images directory that follows\n    // a particular naming pattern\n    tempFile, err := ioutil.TempFile(\"temp-images\", \"upload-*.png\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer tempFile.Close()\n\n    // read all of the contents of our uploaded file into a\n    // byte array\n    fileBytes, err := ioutil.ReadAll(file)\n    if err != nil {\n        fmt.Println(err)\n    }\n    // write this byte array to our temporary file\n    tempFile.Write(fileBytes)\n    // return that we have successfully uploaded our file!\n    fmt.Fprintf(w, \"Successfully Uploaded File\\n\")\n}\n\nfunc setupRoutes() {\n    http.HandleFunc(\"/upload\", uploadFile)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc main() {\n    fmt.Println(\"Hello World\")\n    setupRoutes()\n}\n</code></pre>\n"}], "owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 55143208, "answer_count": 1, "score": -1, "last_activity_date": 1552484206, "creation_date": 1552472322, "question_id": 55139423, "link": "https://stackoverflow.com/questions/55139423/file-not-uploaded-to-directory-using-go", "title": "File not uploaded to directory using go", "body": "<p>Am trying to upload files to a directory using go code below.\n<a href=\"https://www.socketloop.com/tutorials/golang-upload-file\" rel=\"nofollow noreferrer\">source</a></p>\n\n<p>The Issue am having is that when I run the code, it prints <strong>files successfully uploaded</strong> \nbut when I get to the directory, <strong>No file is uploaded there</strong>. Any solution will be appreciated. Thanks</p>\n\n<pre><code>package main\n\n import (\n    \"fmt\"\n    \"io\"\n    \"net/http\"\n    \"os\"\n )\n\n func uploadHandler(w http.ResponseWriter, r *http.Request) {\n\n    // the FormFile function takes in the POST input id file\n    file, header, err := r.FormFile(\"file\")\n\n    if err != nil {\n        fmt.Fprintln(w, err)\n        return\n    }\n\n    defer file.Close()\n\n    out, err := os.Create(\"/upload\")\n    if err != nil {\n        fmt.Fprintf(w, \"Unable to create the file for writing. Check your write access privilege\")\n        return\n    }\n\n    defer out.Close()\n\n    // write the content from POST to the file\n    _, err = io.Copy(out, file)\n    if err != nil {\n        fmt.Fprintln(w, err)\n    }\n\n    fmt.Fprintf(w, \"File uploaded successfully : \")\n    fmt.Fprintf(w, header.Filename)\n }\n\n func main() {\n    http.HandleFunc(\"/\", uploadHandler)\n    http.ListenAndServe(\":8080\", nil)\n }\n</code></pre>\n"}, {"tags": ["go", "plugins", "vector-processing"], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 3, "last_activity_date": 1552474988, "creation_date": 1552474988, "answer_id": 55140355, "question_id": 55138943, "link": "https://stackoverflow.com/questions/55138943/can-vpp-plugins-be-implemented-using-go/55140355#55140355", "title": "Can VPP plugins be implemented using Go?", "body": "<p>I have no idea what \"VPP\" is but nonetheless the answer is: \"maybe\"; here's why:</p>\n\n<ul>\n<li><p>Go code is able to interface with C libraries via its facility known as <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\"><code>cgo</code></a>.</p>\n\n<p><code>cgo</code> is a multiple-faceted thing: it allows you to \"export\" certain Go functions in a certain way so that they can be called from the C side, and it allows you to call functions from the C side. It also allows you to write bits of inline C code to provide glue for the C side, when necessary.</p></li>\n<li><p>Since some time Go building toolset (at least its \"reference\" implementation) provides for compiling Go code into a static or dynamic library with C-compatible API.</p>\n\n<p>See <a href=\"https://golang.org/cmd/go/#hdr-Build_modes\" rel=\"nofollow noreferrer\">this</a>.</p></li>\n</ul>\n\n<p>With these things in mind, in theory, it should be possible to do what you're after.\nNote some possible obstacles:</p>\n\n<ul>\n<li><p>Most of the time, if a \"platform\" allows you to write a \"plugin\" in C, it presupposes your plugin will make extensive use of the platform's own API.</p>\n\n<p>This usually means your plugin is supposed to include certain header files provided by the platform.</p></li>\n<li><p>The platform might also require your plugin to link against some platform-provided library (usually shared), or libraries.</p></li>\n</ul>\n\n<p><code>cgo</code> can do all of the above, but you will need to scrutinize the API provided by the platform and maybe write Go helpers to make its usage more natural for the Go code.</p>\n\n<p>Building/linking issues (usually the locations of the header files and the libs) may also be a thing to solve.</p>\n"}], "owner": {"reputation": 752, "user_id": 1833563, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/heZDc.jpg?s=128&g=1", "display_name": "omer", "link": "https://stackoverflow.com/users/1833563/omer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 55140355, "answer_count": 1, "score": 1, "last_activity_date": 1552474988, "creation_date": 1552470989, "last_edit_date": 1552471104, "question_id": 55138943, "link": "https://stackoverflow.com/questions/55138943/can-vpp-plugins-be-implemented-using-go", "title": "Can VPP plugins be implemented using Go?", "body": "<p>VPP provides the I/S for developing custom plugins that can be hooked into a graph of nodes. I've only seen examples for such plugins written in the C language, and was wondering whether other language, Go for instance, can also be used to write such plugins.</p>\n"}, {"tags": ["database", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552471949, "post_id": 55138009, "comment_id": 97018863, "body": "How does <code>readmineIssues</code> relate to <code>readmineIssue</code>?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552472059, "post_id": 55138009, "comment_id": 97018928, "body": "It&#39;s not possible to range over a struct type identifier. ie. If <code>type Issues struct{...</code> then <code>range Issues</code> will not compile. Neither will <code>database.Find(&amp;Issues)</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552472419, "post_id": 55138009, "comment_id": 97019150, "body": "I&#39;d recommend you consider offloading filtering to the db. That ought to be much more efficient, assuming you have the proper indexes in place, then loading all of the issue records into your app and doing the filtering there."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8114635, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d48aRHhAq0I/AAAAAAAAAAI/AAAAAAAAAWQ/ykC1NiR1jYw/photo.jpg?sz=128", "display_name": "S&#233;bastien Tolron", "link": "https://stackoverflow.com/users/8114635/s%c3%a9bastien-tolron"}, "edited": false, "score": 0, "creation_date": 1552472515, "post_id": 55139301, "comment_id": 97019220, "body": "Indeed , Issues is an array."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1552472601, "last_edit_date": 1552472601, "creation_date": 1552472027, "answer_id": 55139301, "question_id": 55138009, "link": "https://stackoverflow.com/questions/55138009/search-in-struct-array/55139301#55139301", "title": "Search in struct array", "body": "<p>A for loop is the right way to go. Assuming the code you pasted <em>actually works</em>, you can merge those into a single for loop, the way you have it written.</p>\n\n<pre><code>database.Find(&amp;Issues)\nredmineIssue := []string{}\ngitlabissues := []string{}\nfor _, issue := range Issues {\n    redmineIssue = append(redmineIssue, issue.RedmineIssue)\n    gitlabissues = append(gitlabissues, issue.GitlabIssue)\n}\n</code></pre>\n\n<p>But this assumes that <code>Issues</code> is an array. Which doesn't match the rest of your question. According to your stated definition of <code>Issues</code>, the code you posted won't even compile, though. So I don't know if this code will work for you, either.</p>\n\n<p>You can provide another micro-optimization by pre-allocating the arrays:</p>\n\n<pre><code>database.Find(&amp;Issues)\nredmineIssue := make([]string{}, 0, len(Issues))\ngitlabissues := make([]string{}, 0, len(Issues))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8114635, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d48aRHhAq0I/AAAAAAAAAAI/AAAAAAAAAWQ/ykC1NiR1jYw/photo.jpg?sz=128", "display_name": "S&#233;bastien Tolron", "link": "https://stackoverflow.com/users/8114635/s%c3%a9bastien-tolron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1552472780, "creation_date": 1552468141, "last_edit_date": 1552472333, "question_id": 55138009, "link": "https://stackoverflow.com/questions/55138009/search-in-struct-array", "title": "Search in struct array", "body": "<p>I have a struct defined like this :</p>\n\n<pre><code>type Issues struct {\n    RedmineIssue string\n    GitlabIssue string\n}\n</code></pre>\n\n<p>Then I get the list from the DB</p>\n\n<pre><code>    database.Find(&amp;Issues)\n</code></pre>\n\n<p>Then I have another array</p>\n\n<pre><code>   redmineIssues []redmine.Issue\n</code></pre>\n\n<p>Is there any way to search issues in my array Issues  that are also in the array redmineIssues base on field RedmineIssue ( string ) ?</p>\n\n<hr>\n\n<p>Today here is what I'm doing</p>\n\n<pre><code>    database.Find(&amp;Issues)\n    redmineIssue := []string{}\n    for _, issueRedmine := range Issues {\n        redmineIssue = append(redmineIssue, issueRedmine.RedmineIssue)\n    }\n\n    gitlabissues := []string{}\n    for _, issueGitlab := range Issues {\n        gitlabissues = append(gitlabissues, issueGitlab.GitlabIssue)\n    }\n</code></pre>\n\n<p>Then I can compare with another array I have </p>\n\n<pre><code>for _, issueR := range IssueFromRedmineWS {\n    inArray, _ := in_array(issueR.Id, redmineIssue)\n    if !inArray {\n        // The issue is not in the DB\n    }\n}\n</code></pre>\n\n<p>Any idea on how to optimize this and to make it cleaner?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "is_accepted": true, "score": 12, "last_activity_date": 1552457112, "last_edit_date": 1552457112, "creation_date": 1552456808, "answer_id": 55135355, "question_id": 55135239, "link": "https://stackoverflow.com/questions/55135239/how-can-i-sleep-with-responsive-context-cancelation/55135355#55135355", "title": "How can I sleep with responsive context cancelation?", "body": "<p>You can use <code>select</code> to acheive this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"context\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    ctx, cancel := context.WithCancel(context.Background())\n    defer cancel()\n    go func(){\n        t := time.Now()\n        select{\n        case &lt;-ctx.Done(): //context cancelled\n        case &lt;-time.After(2 * time.Second): //timeout\n        }\n        fmt.Printf(\"here after: %v\\n\", time.Since(t))\n    }()\n\n    cancel() //cancel manually, comment out to see timeout kick in\n    time.Sleep(3 * time.Second)\n    fmt.Println(\"done\")\n\n}\n</code></pre>\n\n<p>Here is the <a href=\"https://play.golang.org/p/PkXbjNxnRuz\" rel=\"noreferrer\">Go-playground link</a></p>\n"}, {"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1552472755, "post_id": 55139047, "comment_id": 97019371, "body": "WithCancel followed by WithTimeout is redundant. WithTimeout returns a cancel function as well, which you ignore. That causes a resource leak. Cancel <i>must</i> be called."}, {"owner": {"reputation": 110, "user_id": 3508426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513ec8e6762ef0e4e8833b7e2b320f20?s=128&d=identicon&r=PG&f=1", "display_name": "Sebasti&#225;n Rodriguez", "link": "https://stackoverflow.com/users/3508426/sebasti%c3%a1n-rodriguez"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1552474798, "post_id": 55139047, "comment_id": 97020647, "body": "I think I didn&#39;t know that <code>context.WithTimeout()</code> returns a cancel function... But any way this code is pretty simpliffied; in <a href=\"https://github.com/skryde/yac/blob/master/main.go\" rel=\"nofollow noreferrer\">my code</a> I needed to create a WthCancel context in the main goroutine that could cancel multiples <code>context.WithTimeout</code> in other goroutines (I&#39;m making a task runner, like a super simpliffied Cron that run tasks every <code>n</code> minutes)."}], "tags": [], "owner": {"reputation": 110, "user_id": 3508426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513ec8e6762ef0e4e8833b7e2b320f20?s=128&d=identicon&r=PG&f=1", "display_name": "Sebasti&#225;n Rodriguez", "link": "https://stackoverflow.com/users/3508426/sebasti%c3%a1n-rodriguez"}, "is_accepted": false, "score": 0, "last_activity_date": 1552471258, "creation_date": 1552471258, "answer_id": 55139047, "question_id": 55135239, "link": "https://stackoverflow.com/questions/55135239/how-can-i-sleep-with-responsive-context-cancelation/55139047#55139047", "title": "How can I sleep with responsive context cancelation?", "body": "<p>I managed to do something similar by combining a CancelContext with a TimeoutContext...</p>\n\n<p>Here is the sample code:</p>\n\n<pre><code>cancelCtx, cancel := context.WithCancel(context.Background())\ndefer cancel()\n// The program \"sleeps\" for 5 seconds.\ntimeoutCtx, _ := context.WithTimeout(cancelCtx, 5*time.Second)\nselect {\ncase &lt;-timeoutCtx.Done():\n    if cancelCtx.Err() != nil {\n        log.Printf(\"Context cancelled\")\n    }\n}\n</code></pre>\n\n<p>In <a href=\"https://github.com/skryde/yac/blob/master/main.go\" rel=\"nofollow noreferrer\">this repo</a> you can find the complete usage of the above code. Sorry for my short answer, I didn't turned on the computer yet, and is not that easy to answer from the phone...</p>\n"}, {"tags": [], "owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "is_accepted": false, "score": 3, "last_activity_date": 1591732032, "last_edit_date": 1591732032, "creation_date": 1591721402, "answer_id": 62287775, "question_id": 55135239, "link": "https://stackoverflow.com/questions/55135239/how-can-i-sleep-with-responsive-context-cancelation/62287775#62287775", "title": "How can I sleep with responsive context cancelation?", "body": "<p>Here is a <code>sleepContext</code> function that you can use instead of <code>time.Sleep</code>:</p>\n\n<pre><code>func sleepContext(ctx context.Context, delay time.Duration) {\n    select {\n    case &lt;-ctx.Done():\n    case &lt;-time.After(delay):\n    }\n}\n</code></pre>\n\n<p>And some sample usage (<a href=\"https://play.golang.org/p/OLBrjeKKqUC7\" rel=\"nofollow noreferrer\">full runnable code on the Go Playground</a>):</p>\n\n<pre><code>func main() {\n    ctx := context.Background()\n\n    fmt.Println(time.Now())\n    sleepContext(ctx, 1*time.Second)\n    fmt.Println(time.Now())\n\n    ctxTimeout, cancel := context.WithTimeout(ctx, 500*time.Millisecond)\n    sleepContext(ctxTimeout, 1*time.Second)\n    cancel()\n    fmt.Println(time.Now())\n}\n</code></pre>\n"}], "owner": {"reputation": 9097, "user_id": 132978, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5af2930e39246c8339fa7ad8e394e96e?s=128&d=identicon&r=PG", "display_name": "Aseem Kishore", "link": "https://stackoverflow.com/users/132978/aseem-kishore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1806, "favorite_count": 0, "accepted_answer_id": 55135355, "answer_count": 3, "score": 6, "last_activity_date": 1591732032, "creation_date": 1552456291, "question_id": 55135239, "link": "https://stackoverflow.com/questions/55135239/how-can-i-sleep-with-responsive-context-cancelation", "title": "How can I sleep with responsive context cancelation?", "body": "<p>In Go, I want to <code>time.Sleep</code> for some time (e.g. waiting between retries), but want to return quickly if the context gets canceled (not just from a deadline, but also manually).</p>\n\n<p>What is the right or best way to do that? Thanks!</p>\n"}, {"tags": ["go", "riff"], "comments": [{"owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 0, "creation_date": 1552457554, "post_id": 55135171, "comment_id": 97011464, "body": "Where is the URL?"}, {"owner": {"reputation": 3, "user_id": 5039208, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207419704198605/picture?type=large", "display_name": "Yanuar Putra", "link": "https://stackoverflow.com/users/5039208/yanuar-putra"}, "reply_to_user": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 0, "creation_date": 1552462310, "post_id": 55135171, "comment_id": 97013462, "body": "@devdotlog Sorry for that, edited with the URL. Thanks!"}, {"owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 0, "creation_date": 1552466945, "post_id": 55135171, "comment_id": 97015664, "body": "I&#39;m success. just URL := &quot;<a href=\"https://www.sony.com/is/image/gwtprod/0abe7672ff4c6cb4a0a4d4cc143fd05b?fmt=png-alpha\" rel=\"nofollow noreferrer\">sony.com/is/image/gwtprod/&hellip;</a>&quot;, filename = &quot;test.png&quot;."}, {"owner": {"reputation": 3, "user_id": 5039208, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207419704198605/picture?type=large", "display_name": "Yanuar Putra", "link": "https://stackoverflow.com/users/5039208/yanuar-putra"}, "reply_to_user": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 0, "creation_date": 1552469405, "post_id": 55135171, "comment_id": 97017161, "body": "Yeah, i can download that perfectly with golang, but the main problem is when i used the downloaded image with golang, it can not be processed by x/image/webp package, and responded with &quot;missing RIFF chunk header&quot;, maybe i will add more code to process the image"}], "answers": [{"tags": [], "owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "is_accepted": true, "score": 0, "last_activity_date": 1552490628, "creation_date": 1552490628, "answer_id": 55145477, "question_id": 55135171, "link": "https://stackoverflow.com/questions/55135171/how-to-write-riff-chunk-header-when-store-image-from-url/55145477#55145477", "title": "How to write RIFF chunk header when store image from url?", "body": "<p>download file is not webp type. it's png.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"image\"\n    \"io\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n\n    _ \"image/png\"\n)\n\nfunc main() {\n    response, e := http.Get(\"https://www.sony.com/is/image/gwtprod/0abe7672ff4c6cb4a0a4d4cc143fd05b?fmt=png-alpha\")\n    if e != nil {\n        log.Fatal(e)\n    }\n    defer response.Body.Close()\n\n    file, err := os.Create(\"dump\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer file.Close()\n\n    _, err = io.Copy(file, response.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"Success!\")\n\n    imageFile, err := os.Open(\"dump\")\n    if err != nil {\n        panic(err)\n    }\n\n    m, name, err := image.Decode(imageFile)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(\"image type is \", name, m.Bounds())\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5039208, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207419704198605/picture?type=large", "display_name": "Yanuar Putra", "link": "https://stackoverflow.com/users/5039208/yanuar-putra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 55145477, "answer_count": 1, "score": 0, "last_activity_date": 1552490628, "creation_date": 1552455988, "last_edit_date": 1552469543, "question_id": 55135171, "link": "https://stackoverflow.com/questions/55135171/how-to-write-riff-chunk-header-when-store-image-from-url", "title": "How to write RIFF chunk header when store image from url?", "body": "<p>I just tried to download webp image from url, but I found something different when I try to process the stored image. </p>\n\n<p>If I download the image from the browser, it can be decoded using <code>x/image/webp</code> package, but if I store the image using <code>http.Get()</code> then create a new file then <code>io.Copy()</code> the image, it says: </p>\n\n<blockquote>\n  <p>\"missing RIFF chunk header\"</p>\n</blockquote>\n\n<p>I assume that I need to write some RIFF chunk header when I store it using golang code.</p>\n\n<pre><code>func main(){\n    response, e := http.Get(URL)\n    if e != nil {\n        log.Fatal(e)\n    }\n    defer response.Body.Close()\n\n    //open a file for writing\n    file, err := os.Create('tv.webp')\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer file.Close()\n\n    // Use io.Copy to just dump the response body to the file. This supports huge files\n    _, err = io.Copy(file, response.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"Success!\")\n\n    imgData, err := os.Open(\"tv.webp\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    log.Printf(\"%+v\", imgData)\n    image, err := webp.Decode(imgData)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(image.Bounds())\n}\n</code></pre>\n\n<p>Here is the URL <a href=\"https://www.sony.com/is/image/gwtprod/0abe7672ff4c6cb4a0a4d4cc143fd05b?fmt=png-alpha\" rel=\"nofollow noreferrer\">IMG URL</a></p>\n"}, {"tags": ["angular", "go"], "comments": [{"owner": {"reputation": 1663, "user_id": 1958480, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/03cf8097a46ba2b0f9889fb4a6ffe31e?s=128&d=identicon&r=PG&f=1", "display_name": "jcuypers", "link": "https://stackoverflow.com/users/1958480/jcuypers"}, "edited": false, "score": 0, "creation_date": 1552458607, "post_id": 55134767, "comment_id": 97011860, "body": "Please check the preflight section.  possible duplicate of <a href=\"https://stackoverflow.com/questions/43871637/no-access-control-allow-origin-header-is-present-on-the-requested-resource-whe\" title=\"no access control allow origin header is present on the requested resource whe\">stackoverflow.com/questions/43871637/&hellip;</a>"}, {"owner": {"reputation": 1663, "user_id": 1958480, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/03cf8097a46ba2b0f9889fb4a6ffe31e?s=128&d=identicon&r=PG&f=1", "display_name": "jcuypers", "link": "https://stackoverflow.com/users/1958480/jcuypers"}, "edited": false, "score": 0, "creation_date": 1552458988, "post_id": 55134767, "comment_id": 97012005, "body": "remove <code>&#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;         , &#39;Access-Control-Allow-Headers&#39;: &#39;access-control-allow-origin, access-control-allow-headers&#39;</code> from the client, they should only be used on server."}, {"owner": {"reputation": 130, "user_id": 9957796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kLdV6.jpg?s=128&g=1", "display_name": "Joe Alvini", "link": "https://stackoverflow.com/users/9957796/joe-alvini"}, "reply_to_user": {"reputation": 1663, "user_id": 1958480, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/03cf8097a46ba2b0f9889fb4a6ffe31e?s=128&d=identicon&r=PG&f=1", "display_name": "jcuypers", "link": "https://stackoverflow.com/users/1958480/jcuypers"}, "edited": false, "score": 0, "creation_date": 1552487776, "post_id": 55134767, "comment_id": 97029406, "body": "@jcuypers Ok so I have taken that out and only left application/json as the content type but now while I do not get a cors error and I do see that the payload is getting sent in the browsers network tab it still shows that the data is nil when trying to request it in Go. What do I have to do to get the data in go?"}, {"owner": {"reputation": 1663, "user_id": 1958480, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/03cf8097a46ba2b0f9889fb4a6ffe31e?s=128&d=identicon&r=PG&f=1", "display_name": "jcuypers", "link": "https://stackoverflow.com/users/1958480/jcuypers"}, "edited": false, "score": 0, "creation_date": 1552488082, "post_id": 55134767, "comment_id": 97029630, "body": "sorry i&#39;m not a <code>Go</code> guy.  but isn&#39;t this: <code>if (*req).Method == &quot;POST&quot; {         return     }</code> weird?  you use post to send the data and then you just exit the function with nothing (while after that you still try to print)?  Try to put the print statements inside of the if statement"}], "answers": [{"comments": [{"owner": {"reputation": 130, "user_id": 9957796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kLdV6.jpg?s=128&g=1", "display_name": "Joe Alvini", "link": "https://stackoverflow.com/users/9957796/joe-alvini"}, "edited": false, "score": 0, "creation_date": 1552500625, "post_id": 55144645, "comment_id": 97037607, "body": "I get the following response when I change it  map[Content-Length:[35] Origin:[<a href=\"http://localhost:4200]\" rel=\"nofollow noreferrer\">localhost:4200]</a> Referer:[<a href=\"http://localhost:4200/login?returnUrl=%2Fdashboard]\" rel=\"nofollow noreferrer\">localhost:4200/login?returnUrl=%2Fdashboard]</a> Accept-Encoding:[gzip, deflate, br] Connection:[keep-alive] Accept:[application/json, text/plain, <i>/</i>] User-Agent:[Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.3 Safari/537.36] Content-Type:[application/json] &lt;nil&gt; &amp;{0xc420066040 [] {[] 0 {&lt;nil&gt; false [] &lt;nil&gt; false 0 &lt;nil&gt; 0} {&lt;nil&gt; false [] &lt;nil&gt; false 0 &lt;nil&gt; 0} { } &lt;nil&gt; false false} 0 0 {&lt;nil&gt; false [] &lt;nil&gt; false 0 &lt;nil&gt; 0} &lt;nil&gt; 0 []}"}, {"owner": {"reputation": 130, "user_id": 9957796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kLdV6.jpg?s=128&g=1", "display_name": "Joe Alvini", "link": "https://stackoverflow.com/users/9957796/joe-alvini"}, "edited": false, "score": 0, "creation_date": 1552500747, "post_id": 55144645, "comment_id": 97037666, "body": "But it seems to be posting because on the frontend it shows   Payload:  {username: &quot;Joe&quot;, password: &quot;Joe&quot;} password: &quot;Joe&quot; username: &quot;Joe&quot;"}, {"owner": {"reputation": 1663, "user_id": 1958480, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/03cf8097a46ba2b0f9889fb4a6ffe31e?s=128&d=identicon&r=PG&f=1", "display_name": "jcuypers", "link": "https://stackoverflow.com/users/1958480/jcuypers"}, "reply_to_user": {"reputation": 130, "user_id": 9957796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kLdV6.jpg?s=128&g=1", "display_name": "Joe Alvini", "link": "https://stackoverflow.com/users/9957796/joe-alvini"}, "edited": false, "score": 0, "creation_date": 1552501364, "post_id": 55144645, "comment_id": 97037994, "body": "what you call valid json is just an object according to me: valid json should look like this : <code>{ \t&quot;username&quot;: &quot;Joe&quot;, \t&quot;password&quot;: &quot;Joe&quot; }</code>. make sure your post request has JSON.stringify(data)"}], "tags": [], "owner": {"reputation": 1663, "user_id": 1958480, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/03cf8097a46ba2b0f9889fb4a6ffe31e?s=128&d=identicon&r=PG&f=1", "display_name": "jcuypers", "link": "https://stackoverflow.com/users/1958480/jcuypers"}, "is_accepted": false, "score": 0, "last_activity_date": 1552501640, "last_edit_date": 1552501640, "creation_date": 1552488249, "answer_id": 55144645, "question_id": 55134767, "link": "https://stackoverflow.com/questions/55134767/submit-angular-form-to-go-api-keeps-posting-nil/55144645#55144645", "title": "Submit Angular form to Go API keeps posting Nil", "body": "<p>make changes like so: </p>\n\n<pre><code>func indexHandler(w http.ResponseWriter, req *http.Request) {\n    setupResponse(&amp;w, req)\n    if (*req).Method == \"POST\" {\n          fmt.Println(req.Header)\n\n          fmt.Println(req.ParseForm())\n          fmt.Println(json.NewDecoder(req.Body))\n    }\n}\n</code></pre>\n\n<p><strong>Angular client side</strong></p>\n\n<pre><code>login(username: string, password: string) {\n\n    const httpOptions = {\n      headers: new HttpHeaders({ 'Content-Type': 'application/json charset=utf-8'})\n    };\n   return this.http.post(`${environment.APIEndpoint}/signin`, `{\"username\":username, \"password\":password}`, httpOptions).pipe(map(user =&gt; {\n        // login successful if there's a jwt token in the response\n        if (user &amp;&amp; user) {\n          // store user details and jwt token in local storage to keep user logged in between page refreshes\n          localStorage.setItem('currentUser', JSON.stringify(user));\n        }\n\n        return user;\n      }));\n  }\n</code></pre>\n"}], "owner": {"reputation": 130, "user_id": 9957796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kLdV6.jpg?s=128&g=1", "display_name": "Joe Alvini", "link": "https://stackoverflow.com/users/9957796/joe-alvini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1552501640, "creation_date": 1552453707, "last_edit_date": 1552464118, "question_id": 55134767, "link": "https://stackoverflow.com/questions/55134767/submit-angular-form-to-go-api-keeps-posting-nil", "title": "Submit Angular form to Go API keeps posting Nil", "body": "<p>I am trying to post from my angular frontend to my Go API and no matter what I do it keeps posting nil to the Go API. When I test if the variables are making it to the Angular subscriber it shows that they are but for some reason it will not post to this simple Go endpoint</p>\n\n<p>Here is my code any help would be very greatly appreciated:</p>\n\n<p>GO API</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"github.com/dgrijalva/jwt-go\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n\n    http.HandleFunc(\"/signin\", indexHandler)\n    http.HandleFunc(\"/welcome\", Welcome)\n    http.HandleFunc(\"/refresh\", Refresh)\n\n    // start the server on port 8000\n    log.Fatal(http.ListenAndServe(\":8001\", nil))\n}\n\nfunc setupResponse(w *http.ResponseWriter, req *http.Request) {\n    (*w).Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n    (*w).Header().Set(\"Access-Control-Allow-Methods\", \"POST, GET, OPTIONS, PUT, DELETE\")\n    (*w).Header().Set(\"Access-Control-Allow-Headers\", \"Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization\")\n}\n\nfunc indexHandler(w http.ResponseWriter, req *http.Request) {\n    setupResponse(&amp;w, req)\n    if (*req).Method == \"POST\" {\n        return\n    }\n    fmt.Println(req.Header)\n\n    fmt.Println(req.ParseForm())\n    fmt.Println(json.NewDecoder(req.Body))\n\n}\n</code></pre>\n\n<p>Angular Subscriber</p>\n\n<pre><code> login(username: string, password: string) {\n\n    const httpOptions = {\n      headers: new HttpHeaders({ 'Content-Type': 'application/json charset=utf-8'\n        , 'Access-Control-Allow-Origin': '*'\n        , 'Access-Control-Allow-Headers': 'access-control-allow-origin, access-control-allow-headers'})\n    };\n   return this.http.post(`${environment.APIEndpoint}/signin`, {username, password}, httpOptions).pipe(map(user =&gt; {\n        // login successful if there's a jwt token in the response\n        if (user &amp;&amp; user) {\n          // store user details and jwt token in local storage to keep user logged in between page refreshes\n          localStorage.setItem('currentUser', JSON.stringify(user));\n        }\n\n        return user;\n      }));\n  }\n</code></pre>\n\n<p>This is my Output in Go</p>\n\n<blockquote>\n  <p>map[User-Agent:[Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Mobile Safari/537.36] Access-Control-Request-Headers:[access-control-allow-headers,access-control-allow-origin,content-type] Referer:[<a href=\"http://localhost:4200/login?returnUrl=%2Fdashboard]\" rel=\"nofollow noreferrer\">http://localhost:4200/login?returnUrl=%2Fdashboard]</a> Accept-Language:[en-US,en;q=0.9] Connection:[keep-alive] Accept:[<em>/</em>] Accept-Encoding:[gzip, deflate, br] Access-Control-Request-Method:[POST] Origin:[<a href=\"http://localhost:4200]]\" rel=\"nofollow noreferrer\">http://localhost:4200]]</a>\n  \n  &amp;{{} [] {[] 0 { false []  false 0  0} { false []  false 0  0} { }  false false} 0 0 { false []  false 0  0}  0 []}</p>\n</blockquote>\n\n<p>And I am then getting a CORS error in Angular which is:</p>\n\n<blockquote>\n  <p>Access to XMLHttpRequest at '<a href=\"http://localhost:8001/signin\" rel=\"nofollow noreferrer\">http://localhost:8001/signin</a>' from origin '<a href=\"http://localhost:4200\" rel=\"nofollow noreferrer\">http://localhost:4200</a>' has been blocked by CORS policy: Request header field access-control-allow-origin is not allowed by Access-Control-Allow-Headers in preflight response.</p>\n</blockquote>\n\n<p>I would be very grateful if anyone can help me. I am new to both Go and Angular and am still learning how to get them to interact with each other.</p>\n"}, {"tags": ["go", "merge", "yaml", "patch"], "comments": [{"owner": {"reputation": 50175, "user_id": 1307905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a38a4f5f180194ac457cdc057f1be6e3?s=128&d=identicon&r=PG", "display_name": "Anthon", "link": "https://stackoverflow.com/users/1307905/anthon"}, "edited": false, "score": 0, "creation_date": 1552461295, "post_id": 55134454, "comment_id": 97012991, "body": "This can much easier be done with JSON, as it is a much simpler format than YAML (which has tags, anchor/alias, comments that need to be preserved). The only YAML library that can do that that I know of is my <code>ruamel.yaml</code>, but that is in Python. Would that be OK for such a pre-process step?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 1, "creation_date": 1552461445, "post_id": 55134454, "comment_id": 97013061, "body": "Did you tried to reverse how you are merging the files? I mean <code>mergo.Merge(&amp;envc, defc)</code>? I think that this way mergo should preserve already declared values in you eg. <code>stage.yml</code> and just fill up with this existing in <code>default.yml</code>"}, {"owner": {"reputation": 319, "user_id": 408626, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/cb32442d4187bf5619163ea73e853002?s=128&d=identicon&r=PG", "display_name": "kodeninja", "link": "https://stackoverflow.com/users/408626/kodeninja"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1552497193, "post_id": 55134454, "comment_id": 97035768, "body": "@ttomalak reversing didn&#39;t help either, with or without override."}], "owner": {"reputation": 319, "user_id": 408626, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/cb32442d4187bf5619163ea73e853002?s=128&d=identicon&r=PG", "display_name": "kodeninja", "link": "https://stackoverflow.com/users/408626/kodeninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 565, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1612546335, "creation_date": 1552451565, "question_id": 55134454, "link": "https://stackoverflow.com/questions/55134454/simulating-patch-like-merging-in-go-structs-read-from-yaml-files", "title": "Simulating patch-like merging in go structs read from yaml files", "body": "<p>Given the yamls like below:</p>\n\n<p><strong>default.yaml</strong>:</p>\n\n<pre><code>services:\n  A:\n    host: \"google.com\"\n    path: \"search\"\n    scheme: \"https\"\n  B:\n    host: \"bing.com\"\n    path: \"find\"\nlogging:\n  level: WARN\n</code></pre>\n\n<p><strong>staging.yaml</strong>:</p>\n\n<pre><code>services:\n  A:\n    path: \"search2\"\n</code></pre>\n\n<p>I want this merged yaml:</p>\n\n<pre><code>services:\n  A:\n    host: \"google.com\"\n    path: \"search2\"\n    scheme: \"https\"\n  B:\n    host: \"bing.com\"\n    path: \"find\"\nlogging:\n  level: WARN\n</code></pre>\n\n<p>Is there a way to achieve this kind of merge/patch behavior in go? I'm playing around with <code>mergo</code>, but currently, it converts <code>services[\"A\"].host</code> and <code>services[\"A\"].scheme</code> to <code>nil</code> or <code>\"\"</code> in the merged object representation depending on whether the corresponding struct field is a value or pointer.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"io/ioutil\"\n    \"path\"\n\n    \"github.com/imdario/mergo\"\n    \"gopkg.in/yaml.v2\"\n)\n\ntype Logging struct {\n    Level *string `json:\"level,omitempty\" yaml:\"level,omitempty\"`\n}\n\ntype Service struct {\n    Host     *string `json:\"host,omitempty\" yaml:\"host,omitempty\"`\n    Path     *string `json:\"path,omitempty\" yaml:\"path,omitempty\"`\n    Scheme   *string `json:\"scheme,omitempty\" yaml:\"scheme,omitempty\"`\n    Schedule *string `json:\"schedule,omitempty\" yaml:\"schedule,omitempty\"`\n    Count    *int    `json:\"count,omitempty\" yaml:\"count,omitempty\"`\n}\n\ntype Config struct {\n    Services map[string]Service `json:\"services,omitempty\" yaml:\"services,omitempty\"`\n    Logging  *Logging           `json:\"logging,omitempty\" yaml:\"logging,omitempty\"`\n}\n\n// error handling omitted for brevity\nfunc main() {\n    var defc Config\n    yamlFile, _ := ioutil.ReadFile(\"default.yaml\"))\n    _ = yaml.Unmarshal(yamlFile, &amp;defc)\n\n    var envc Config\n    yamlFile, _ = ioutil.ReadFile(\"staging.yaml\"))\n    _ = yaml.Unmarshal(yamlFile, &amp;envc)\n\n    _ = mergo.Merge(&amp;defc, envc, mergo.WithOverride)\n}\n</code></pre>\n\n<p>The motivation is to maintain env-specific yaml files that contain various configuration. I want to keep a base yaml (<code>default.yaml</code>) that defines all the configuration, and then for each environment (dev/staging/prod...) define only the <em>delta</em> in those yamls to keep things DRY.</p>\n\n<p>To give an equivalent from js/node, this is roughly what I'm looking for: <a href=\"https://runkit.com/embed/j9xi2bu00a74\" rel=\"nofollow noreferrer\">https://runkit.com/embed/j9xi2bu00a74</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552485322, "post_id": 55133779, "comment_id": 97027540, "body": "The error seems pretty clear, you&#39;ve got an extra <code>range</code> here: <code>range $i, $pp := range $people</code>. Looks like you may be conflating the template range syntax with the Go range syntax and putting <code>range</code> on both sides of the assignment."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1552447236, "creation_date": 1552447236, "answer_id": 55133837, "question_id": 55133779, "link": "https://stackoverflow.com/questions/55133779/how-do-i-range-a-slice-thats-contained-inside-a-slice-of-structs-in-a-template/55133837#55133837", "title": "How do I range a slice that&#39;s contained inside a slice of structs in a template?", "body": "<p>Use this syntax for range:</p>\n\n<pre><code>  {{range $i, $pp := $people}}\n    {{$children := $pp.Children}}\n    Name: {{$pp.Name}}\n    Children:\n      {{range $j, $c := $children}}\n      Child {{$j}}: {{$c}}\n      {{end}}                   \n  {{end}}\n</code></pre>\n\n<p>Also, <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">export</a> the struct fields so the fields can be used by the template.  Use those exported names in the template.</p>\n\n<p><a href=\"https://play.golang.org/p/8W7XMSmfUMa\" rel=\"nofollow noreferrer\">Run it in the playground</a></p>\n"}], "owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "accepted_answer_id": 55133837, "answer_count": 1, "score": 0, "last_activity_date": 1552447236, "creation_date": 1552446749, "question_id": 55133779, "link": "https://stackoverflow.com/questions/55133779/how-do-i-range-a-slice-thats-contained-inside-a-slice-of-structs-in-a-template", "title": "How do I range a slice that&#39;s contained inside a slice of structs in a template?", "body": "<p>I am trying to range over a couple of nested slices inside a template but get an error:</p>\n\n<pre><code>panic: template: abc:3: unexpected &lt;range&gt; in range\n\ngoroutine 1 [running]:\ntext/template.Must(...)\n    /usr/local/go/src/text/template/helper.go:23\nmain.main()\n    /tmp/sandbox748332064/main.go:38 +0x560\n</code></pre>\n\n<p>I've tried searching the docs but can't seem to figure out a workaround to being able to execute the code, even though is seems really simple.</p>\n\n<p>My code:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"text/template\"\n)\n\ntype Person struct {\n    name     string\n    children []string\n}\n\nfunc main() {\n    p := []*Person{\n      {\n        name:     \"Susy\",\n        children: []string{\"Bob\", \"Herman\", \"Sherman\"},\n      },\n      {\n        name:     \"Norman\",\n        children: []string{\"Rachel\", \"Ross\", \"Chandler\"},\n      },\n    }\n\n    str := `\n      {{$people := .}}\n      {{range $i, $pp := range $people}}\n        {{$children := $pp.children}}\n        Name: {{$pp.name}}\n        Children:\n          {{range $j, $c := $children}}\n          Child {{$j}}: {{$c}}\n          {{end}}                   \n      {{end}}\n    `\n\n    t := template.Must(template.New(\"abc\").Parse(str))\n    err := t.Execute(os.Stdout, p)\n    if err != nil {\n      log.Println(err)\n    }\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/5JXZmwPAllC\" rel=\"nofollow noreferrer\">my playground</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 0, "creation_date": 1552449584, "post_id": 55133713, "comment_id": 97009194, "body": "You want the Task Runner(<a href=\"https://github.com/oxequa/realize\" rel=\"nofollow noreferrer\">github.com/oxequa/realize</a>)."}, {"owner": {"reputation": 887, "user_id": 3789634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pPNmf.jpg?s=128&g=1", "display_name": "srimaln91", "link": "https://stackoverflow.com/users/3789634/srimaln91"}, "edited": false, "score": 0, "creation_date": 1552455732, "post_id": 55133713, "comment_id": 97010818, "body": "On which operating system?"}, {"owner": {"reputation": 512, "user_id": 3782382, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0e0f24876474e579ce70cbbdd45e9571?s=128&d=identicon&r=PG&f=1", "display_name": "asyndrige", "link": "https://stackoverflow.com/users/3782382/asyndrige"}, "edited": false, "score": 0, "creation_date": 1552464435, "post_id": 55133713, "comment_id": 97014383, "body": "Maybe you should dig about graceful restart servers and libs such as <a href=\"https://github.com/facebookgo/grace\" rel=\"nofollow noreferrer\">github.com/facebookgo/grace</a> ."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1552465313, "post_id": 55133713, "comment_id": 97014788, "body": "it is unclear if you are looking for a server side process manager (systemd/supervidor etc), a development desk tool (realize/gaper) or to write your own watcher system. Post the whole code at least, and the command to start you process."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1552484246, "post_id": 55133713, "comment_id": 97026742, "body": "Seems like some other piece of code is stopping the server."}], "answers": [{"tags": [], "owner": {"reputation": 887, "user_id": 3789634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pPNmf.jpg?s=128&g=1", "display_name": "srimaln91", "link": "https://stackoverflow.com/users/3789634/srimaln91"}, "is_accepted": false, "score": 2, "last_activity_date": 1552456132, "creation_date": 1552456132, "answer_id": 55135201, "question_id": 55133713, "link": "https://stackoverflow.com/questions/55133713/how-to-auto-restart-go-web-server-if-it-is-stopped/55135201#55135201", "title": "How to auto restart go web server if it is stopped", "body": "<p>You need a process control system. That allows you to run and control a number of processes. </p>\n\n<p>Ex: Systemd, Supervisord </p>\n\n<p>Supervisord is a good option.</p>\n\n<p>Read the documentation on <a href=\"http://supervisord.org/\" rel=\"nofollow noreferrer\">http://supervisord.org/</a></p>\n"}], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1552464135, "creation_date": 1552446254, "last_edit_date": 1552464135, "question_id": 55133713, "link": "https://stackoverflow.com/questions/55133713/how-to-auto-restart-go-web-server-if-it-is-stopped", "title": "How to auto restart go web server if it is stopped", "body": "<p>I tried to apply a mechanism that allow the go web server to be automatically restarted when it's stopped.</p>\n\n<p>The way I do it, by putting the <code>server.ListenAndServe()</code> inside an infinite loop. Since the <code>.ListenAndServe()</code> is blocking, I felt it's ok to do that. Here are the full code:</p>\n\n<pre><code>func main() {\n    // ...\n\n    isStarted := false\n    for true {\n        if isStarted {\n            fmt.Println(\"===================================== RESTARTING WEB SERVER\")\n        }\n\n        log.Println(server.ListenAndServe())\n        isStarted = true\n\n        time.Sleep(1 * time.Second)\n    }\n}\n</code></pre>\n\n<p>When I run the app, what happen is quite different than what I expected. The web server won't start. </p>\n\n<p>Am I doing it wrong? or is there any better and correct way? Thank you in advance</p>\n\n<pre><code>===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:03 http: Server closed\n===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:04 http: Server closed\n===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:05 http: Server closed\n===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:06 http: Server closed\n===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:07 http: Server closed\n===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:08 http: Server closed\n===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:09 http: Server closed\n===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:10 http: Server closed\n===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:11 http: Server closed\n===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:12 http: Server closed\n===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:13 http: Server closed\n===================================== RESTARTING WEB SERVER\n2019/03/13 10:01:14 http: Server closed\n</code></pre>\n"}, {"tags": ["go", "project"], "comments": [{"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 5, "creation_date": 1552435542, "post_id": 55132462, "comment_id": 97006361, "body": "What exactly do you mean by &quot;size&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10443186"}, "reply_to_user": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1552436423, "post_id": 55132462, "comment_id": 97006606, "body": "I mean the size in bytes."}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 4, "creation_date": 1552436482, "post_id": 55132462, "comment_id": 97006619, "body": "The size <i>of what</i>? Of the source files? Of the resulting executable?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552492039, "post_id": 55132462, "comment_id": 97032448, "body": "@Faminha102 thinking about this Q some more:  focusing on pkg sizes (based on their library file-size) does not give the full picture. I&#39;ve update the answer to demonstrate."}], "answers": [{"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 5, "last_activity_date": 1552492199, "last_edit_date": 1552492199, "creation_date": 1552438551, "answer_id": 55132813, "question_id": 55132462, "link": "https://stackoverflow.com/questions/55132462/how-do-i-check-the-size-of-a-golang-project/55132813#55132813", "title": "How do I check the size of a Golang project?", "body": "<p>You can see how big the library binaries are by looking in the <code>$GOPATH/pkg</code> directory (if <code>$GOPATH</code> is not exported <code>go</code> defaults to <code>$HOME/go</code>).</p>\n\n<p>So to check the size of some of the <code>gorilla</code> http pkgs. Install them first:</p>\n\n<pre><code>$ go get -u github.com/gorilla/mux\n$ go get -u github.com/gorilla/securecookie\n$ go get -u github.com/gorilla/sessions\n</code></pre>\n\n<p>The KB binary sizes on my 64-bit MacOS (<code>darwin_amd64</code>):</p>\n\n<pre><code>$ cd $GOPATH/pkg/darwin_amd64/github.com/gorilla/\n$ du -k *\n\n284 mux.a\n128 securecookie.a\n128 sessions.a\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Library (package) size is one thing, but how much space that takes up in your executable after the link stage can vary wildly. This is because packages have their own dependencies and with that comes extra <em>baggage</em>, but that baggage may be shared by other packages you import.</p>\n\n<p>An example demonstrates this best:</p>\n\n<p><strong>empty.go:</strong></p>\n\n<pre><code>package main\n\nfunc main() {}\n</code></pre>\n\n<p><strong>http.go:</strong></p>\n\n<pre><code>package main\n\nimport \"net/http\"\n\nvar _ = http.Serve\n\nfunc main() {}\n</code></pre>\n\n<p><strong>mux.go:</strong></p>\n\n<pre><code>package main\n\nimport \"github.com/gorilla/mux\"\n\nvar _ = mux.NewRouter\n\nfunc main() {}\n</code></pre>\n\n<p>All 3 programs are functionally identical - executing zero user code - but their dependencies differ. The resulting binary sizes in <code>KB</code>:</p>\n\n<pre><code>$ du -k *\n\n1028    empty\n5812    http\n5832    mux\n</code></pre>\n\n<p>What does this tell us? The core go pkg <code>net/http</code> adds significant size to our executable. The <code>mux</code> pkg is not large by itself, but it has an import dependency on  <code>net/http</code> pkg - hence the significant file size for it too. Yet the delta between <code>mux</code> and <code>http</code> is only <code>20KB</code>, whereas the listed file size of the mux.a library is <code>284KB</code>. So we can't simply add the library pkg sizes to determine their true footprint.</p>\n\n<p><em>Conclusion:</em>\nThe go linker will strip out a lot of baggage from individual libraries during the build process, but in order to get a true sense of how much extra <em>weight</em> importing certain packages, one has to look at all of the pkg's <strong>sub-dependencies</strong> as well.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10443186"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 0, "accepted_answer_id": 55132813, "answer_count": 1, "score": 0, "last_activity_date": 1552492199, "creation_date": 1552435453, "last_edit_date": 1552438618, "question_id": 55132462, "link": "https://stackoverflow.com/questions/55132462/how-do-i-check-the-size-of-a-golang-project", "title": "How do I check the size of a Golang project?", "body": "<p>Is there an easy way to check the size of a Golang project? It's not an executable, it's a package that I'm importing in my own project.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1552423887, "post_id": 55130411, "comment_id": 97002477, "body": "<a href=\"https://play.golang.com/p/xxCm2kIcprB\" rel=\"nofollow noreferrer\">play.golang.com/p/xxCm2kIcprB</a>"}, {"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "edited": false, "score": 0, "creation_date": 1552423929, "post_id": 55130411, "comment_id": 97002499, "body": "Maybe less fast than manually writing your own parser for your specific use case and going byte-by-byte, but probably faster than using the standard library: check out <a href=\"https://github.com/tidwall/gjson\" rel=\"nofollow noreferrer\">github.com/tidwall/gjson</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1552423933, "post_id": 55130411, "comment_id": 97002504, "body": "You should provide the <i>&quot;generic runtime&quot;</i> error together with the temporary struct and the unmarshaling code if you seek help."}, {"owner": {"reputation": 53, "user_id": 6063876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e98603a48817d329801df78c8fc74a54?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6063876/chris"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552425123, "post_id": 55130411, "comment_id": 97002965, "body": "@mkopriva Thank you! I think my problem when I tried to implement this myself was I was trying to unmarshal twice because I was expecting to have to deal with the raw JSON list then a list of JSONRawMessage types."}], "owner": {"reputation": 53, "user_id": 6063876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e98603a48817d329801df78c8fc74a54?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6063876/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552423674, "creation_date": 1552423674, "question_id": 55130411, "link": "https://stackoverflow.com/questions/55130411/unmarshal-single-item-json-list-to-single-nested-struct", "title": "Unmarshal single-item JSON list to single nested struct", "body": "<p>I have JSON coming from a graph database and it only returns lists. Here is an example query and response:</p>\n\n<pre><code>{\n  Course(func: eq(XID, \"1\")) {\n    Name\n      Holes : Hole {\n        Number\n        Tee {\n          Color\n          Basket @facets(distance) {\n            Designation \n          }\n        }\n    }\n  }\n}\n</code></pre>\n\n<p>This query looks up by ID so it can only return one result but the nature of the database backend means it will always return a list like so:</p>\n\n<pre><code>{\n  \"Course\": [\n    {\n      \"Name\": \"NAD\",\n      \"Holes\": [\n        {\n          \"Number\": 1,\n          \"Tee\": [\n            {\n              \"Color\": \"Blue\",\n              \"Basket\": [\n                {\n                  \"Designation\": \"A\",\n                  \"Basket|distance\": \"70\"\n                }\n              ]\n            },\n            {\n              \"Color\": \"Red\",\n              \"Basket\": [\n                {\n                  \"Designation\": \"A\",\n                  \"Basket|distance\": \"69\"\n                }\n              ]\n            }\n          ]\n        },\n        {\n          \"Number\": 2,\n          \"Tee\": [\n            {\n              \"Color\": \"Blue\",\n              \"Basket\": [\n                {\n                  \"Designation\": \"A\",\n                  \"Basket|distance\": \"79\"\n                },\n                {\n                  \"Designation\": \"B\",\n                  \"Basket|distance\": \"89\"\n                }\n              ]\n            },\n            {\n              \"Color\": \"Red\",\n              \"Basket\": [\n                {\n                  \"Designation\": \"A\",\n                  \"Basket|distance\": \"79\"\n                },\n                {\n                  \"Designation\": \"B\",\n                  \"Basket|distance\": \"95\"\n                }\n              ]\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>I want to unmarshal that single Course to a struct:</p>\n\n<pre><code>type Course struct {\n    Name  string `json:\"Name\"`\n    Holes []struct {\n        Number int `json:\"Number\"`\n        Tee    []struct {\n            Color  string `json:\"Color\"`\n            Basket []struct {\n                Designation    string `json:\"Designation\"`\n                BasketDistance string `json:\"Basket|distance\"`\n            } `json:\"Basket\"`\n        } `json:\"Tee\"`\n    } `json:\"Holes\"`\n}\n</code></pre>\n\n<p>I tried making a temporary struct that is just a list of courses to pull out the correct JSON by index but I get a really generic runtime error that the object can't be unmarshaled to that type.</p>\n\n<p>I believe it would be relatively easy to convert it to a <code>[]map[string]interface{}</code> then unmarshal to a Course from there by specifying the JSONRawMessage type but doesn't that suffer a performance penalty? What's the most performant way to solve this problem?</p>\n"}, {"tags": ["javascript", "html", "google-chrome", "go", "gopherjs"], "answers": [{"comments": [{"owner": {"reputation": 454, "user_id": 4009625, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/xoJgU.jpg?s=128&g=1", "display_name": "Plastic Soul", "link": "https://stackoverflow.com/users/4009625/plastic-soul"}, "edited": false, "score": 0, "creation_date": 1552419931, "post_id": 55129443, "comment_id": 97000671, "body": "Thanks for replying! I tried that change and the error still persisted. Additionally, the error doesn&#39;t happen right away -- I have to make some clicks in the app (which are handled by <code>..&#47;go&#47;go.js</code>) before the CSP violation occurs."}], "tags": [], "owner": {"reputation": 208, "user_id": 11006698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4UeBk.jpg?s=128&g=1", "display_name": "Loc Mai", "link": "https://stackoverflow.com/users/11006698/loc-mai"}, "is_accepted": false, "score": 0, "last_activity_date": 1552419373, "creation_date": 1552419373, "answer_id": 55129443, "question_id": 55129255, "link": "https://stackoverflow.com/questions/55129255/mysterious-csp-violation/55129443#55129443", "title": "Mysterious CSP violation", "body": "<p><code>&lt;script src=\"https://apis.google.com/js/api.js\"&gt;&lt;/script&gt;</code> this is the cause.\nIn your <code>manifest.json</code>, try adding this:</p>\n\n<pre><code>\"content_security_policy\": \"script-src 'self' 'unsafe-eval' https://apis.google.com; object-src 'self'\",\n</code></pre>\n"}], "owner": {"reputation": 454, "user_id": 4009625, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/xoJgU.jpg?s=128&g=1", "display_name": "Plastic Soul", "link": "https://stackoverflow.com/users/4009625/plastic-soul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552421687, "creation_date": 1552418620, "last_edit_date": 1552421687, "question_id": 55129255, "link": "https://stackoverflow.com/questions/55129255/mysterious-csp-violation", "title": "Mysterious CSP violation", "body": "<p>I am building a chrome extension. When I test it locally, I can take some actions that cause a CSP violation:</p>\n\n<pre><code>Refused to run the JavaScript URL because it violates the following Content Security Policy directive: \"script-src https://apis.google.com 'self'\". Either the 'unsafe-inline' keyword, a hash ('sha256-...'), or a nonce ('nonce-...') is required to enable inline execution.\n</code></pre>\n\n<p>However, my code does not have any inline javascript! The error console points to the first line of my HTML, namely <code>&lt;!DOCTYPE html&gt;</code>, as the culprit:</p>\n\n<pre><code>Stack Trace\nhtml/popup.html:1 (anonymous function)\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;meta name=\"viewport\" content=\"width=600, height=600, initial-scale=1.0\"&gt;\n  &lt;link rel=\"stylesheet\" href=\"../css/bootstrap-3.3.7-dist/css/bootstrap.min.css\"&gt;\n  &lt;link rel=\"stylesheet\" href=\"../css/font-awesome-4.7.0/css/font-awesome.min.css\"&gt;\n  &lt;script src=\"https://apis.google.com/js/api.js\"&gt;&lt;/script&gt;\n  &lt;script src=\"../go/go.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body style=\"width: 500px; height: 600px\"&gt;\n  &lt;div&gt; ...\n</code></pre>\n\n<p>There are no other <code>&lt;script&gt;</code> tags in the document. The <code>go.js</code> file is compiled from golang using <a href=\"https://github.com/gopherjs/gopherjs\" rel=\"nofollow noreferrer\">gopherjs</a>.</p>\n\n<p>What is going on? How do I figure out what is causing this CSP violation?</p>\n"}, {"tags": ["mongodb", "go", "driver"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552411872, "post_id": 55127143, "comment_id": 96996533, "body": "If you copy &amp; paste the same credentials into <code>mongo -u -p</code> it works? &quot;Authentication failed&quot; is pretty hard to argue with as errors go."}, {"owner": {"reputation": 2895, "user_id": 1092767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd8a0d23131c8bfa875a52034bbefef?s=128&d=identicon&r=PG", "display_name": "Adam Harrison", "link": "https://stackoverflow.com/users/1092767/adam-harrison"}, "edited": false, "score": 0, "creation_date": 1552412615, "post_id": 55127143, "comment_id": 96996962, "body": "Try reaching out to mLab&#39;s support team (support@mlab.com). They can help troubleshoot these types of issues."}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1552413162, "post_id": 55127143, "comment_id": 96997271, "body": "Did you try to specify auth mechanis? Url like that <code>mongodb:&#47;&#47;&lt;Standard&gt;:&lt;Password&gt;@ds127101.mlab.com:27101&#47;stor&zwnj;&#8203;yfactory?authMechani&zwnj;&#8203;sm=SCRAM-SHA-1</code>. Also which version of mongo driver are you using?"}, {"owner": {"reputation": 346, "user_id": 10006645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3d4f64e6f346eb97ed2e9df4de0b63e?s=128&d=identicon&r=PG", "display_name": "Tobi696", "link": "https://stackoverflow.com/users/10006645/tobi696"}, "edited": false, "score": 0, "creation_date": 1552415101, "post_id": 55127143, "comment_id": 96998295, "body": "I now deleted my mlab account and then signed up for a new one. It seems like they are redirecting all their users to mongo cloud now. However, I now use a slightly different URI, but it works! Thanks for your effort!"}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 1, "creation_date": 1553131655, "post_id": 55127143, "comment_id": 97276071, "body": "Glad you have it working now @Tobi696. For background information, mLab is now part of MongoDB. See <a href=\"https://blog.mlab.com/2018/10/mlab-is-becoming-a-part-of-mongodb-inc/\" rel=\"nofollow noreferrer\">blog.mlab.com/2018/10/mlab-is-becoming-a-part-of-mongodb-inc</a>"}], "answers": [{"comments": [{"owner": {"reputation": 346, "user_id": 8168016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8cc4f26dcf2d178fd7b81fa7958e48?s=128&d=identicon&r=PG&f=1", "display_name": "Veeresh P", "link": "https://stackoverflow.com/users/8168016/veeresh-p"}, "edited": false, "score": 0, "creation_date": 1614858269, "post_id": 60371447, "comment_id": 117516421, "body": "I tried same way . Its working fine in terminal. But in my code still getting same error which is mentioned above."}], "tags": [], "owner": {"reputation": 1460, "user_id": 2423398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BEn8C.jpg?s=128&g=1", "display_name": "Adrian Oprea", "link": "https://stackoverflow.com/users/2423398/adrian-oprea"}, "is_accepted": true, "score": 2, "last_activity_date": 1582530353, "creation_date": 1582530353, "answer_id": 60371447, "question_id": 55127143, "link": "https://stackoverflow.com/questions/55127143/how-to-connect-to-a-mlab-mongodb-database-in-golang/60371447#60371447", "title": "How to connect to a mlab mongodb database in go(lang)?", "body": "<p>Kind of late to the game, but the documentation has all the answers.</p>\n\n<p><a href=\"https://pkg.go.dev/go.mongodb.org/mongo-driver/mongo?tab=doc#example-Connect-SCRAM\" rel=\"nofollow noreferrer\">https://pkg.go.dev/go.mongodb.org/mongo-driver/mongo?tab=doc#example-Connect-SCRAM</a></p>\n\n<p>Basically, you shouldn't pass your username and password into the connection URI but rather set them as options (see full example below)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Configure a Client with SCRAM authentication (https://docs.mongodb.com/manual/core/security-scram/).\n// The default authentication database for SCRAM is \"admin\". This can be configured via the\n// authSource query parameter in the URI or the AuthSource field in the options.Credential struct.\n// SCRAM is the default auth mechanism so specifying a mechanism is not required.\n\n// To configure auth via URI instead of a Credential, use\n// \"mongodb://user:password@localhost:27017\".\ncredential := options.Credential{\n    Username: \"user\",\n    Password: \"password\",\n}\nclientOpts := options.Client().ApplyURI(\"mongodb://localhost:27017\").SetAuth(credential)\nclient, err := mongo.Connect(context.TODO(), clientOpts)\nif err != nil {\n    log.Fatal(err)\n}\n_ = client\n</code></pre>\n\n<p>I've had so many \"issues\" with this driver, and they were all fixable after I decided to really look at the docs.</p>\n\n<p>Happy hacking!</p>\n"}], "owner": {"reputation": 346, "user_id": 10006645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3d4f64e6f346eb97ed2e9df4de0b63e?s=128&d=identicon&r=PG", "display_name": "Tobi696", "link": "https://stackoverflow.com/users/10006645/tobi696"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2433, "favorite_count": 0, "accepted_answer_id": 60371447, "answer_count": 1, "score": 3, "last_activity_date": 1582530353, "creation_date": 1552410700, "question_id": 55127143, "link": "https://stackoverflow.com/questions/55127143/how-to-connect-to-a-mlab-mongodb-database-in-golang", "title": "How to connect to a mlab mongodb database in go(lang)?", "body": "<p>I have a mlab MongoDB database called storyfactory.\nThis database has a collection called test, which has a user called Standard with a Password.\n<br><br>\nI'm trying to connect to the database with this <a href=\"https://github.com/mongodb/mongo-go-driver\" rel=\"nofollow noreferrer\">Driver</a>.<br>\nThis is the code:<br></p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"log\"\n    \"time\"\n\n    \"go.mongodb.org/mongo-driver/bson\"\n    \"go.mongodb.org/mongo-driver/mongo\"\n    \"go.mongodb.org/mongo-driver/mongo/options\"\n)\n\nfunc main() {\n    ctx, _ := context.WithTimeout(context.Background(), 10*time.Second)\n    client, err := mongo.Connect(ctx, options.Client().ApplyURI(\"mongodb://&lt;Standard&gt;:&lt;Password&gt;@ds127101.mlab.com:27101/storyfactory\"))\n    if err != nil {\n        log.Fatal(err)\n    }\n    collection := client.Database(\"storyfactory\").Collection(\"test\")\n    ctx, _ = context.WithTimeout(context.Background(), 5*time.Second)\n    res, err := collection.InsertOne(ctx, bson.M{\"name\": \"pi\", \"value\": 3.14159})\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(res.InsertedID)\n}\n</code></pre>\n\n<p><br>\nIf I try to run this code, I get following output:\n<br></p>\n\n<pre><code>2019/03/12 18:09:04 auth error: sasl conversation error: unable to authenticate using mechanism \"SCRAM-SHA-1\": (AuthenticationFailed) Authentication failed.\nexit status 1\n</code></pre>\n\n<p>I'm 100% sure that the Password is correct.\n<br>\nThanks for your help!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552405420, "post_id": 55125501, "comment_id": 96992497, "body": "Can you show what you&#39;ve tried to achieve this?"}, {"owner": {"reputation": 49, "user_id": 10902456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ada65b0e620d80482863a71d48da40?s=128&d=identicon&r=PG&f=1", "display_name": "shtb2708", "link": "https://stackoverflow.com/users/10902456/shtb2708"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552405873, "post_id": 55125501, "comment_id": 96992830, "body": "@Adrian <code>if filepath.Ext(path) == &quot;.go&quot; {     return nil }</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1552405965, "post_id": 55125501, "comment_id": 96992883, "body": "@shtb2708  That excludes .go files.  The question says that you want .json files only.  Please clarify what you are after."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552405970, "post_id": 55125501, "comment_id": 96992886, "body": "That filters out the <code>go</code> files, but what have you done to try the sorting you&#39;re asking about? Have you made any attempt or done any research that you can show?"}, {"owner": {"reputation": 49, "user_id": 10902456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ada65b0e620d80482863a71d48da40?s=128&d=identicon&r=PG&f=1", "display_name": "shtb2708", "link": "https://stackoverflow.com/users/10902456/shtb2708"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1552406089, "post_id": 55125501, "comment_id": 96992975, "body": "@ThunderCat yes that exclude go file, I thought if I exclude go file I can just display the .json file"}, {"owner": {"reputation": 49, "user_id": 10902456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ada65b0e620d80482863a71d48da40?s=128&d=identicon&r=PG&f=1", "display_name": "shtb2708", "link": "https://stackoverflow.com/users/10902456/shtb2708"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552406167, "post_id": 55125501, "comment_id": 96993044, "body": "@Adrian I gave the code I tried to  achieve. My way of thinking, it was if I exclude the .go files from my folder, I can just display the .json files...."}, {"owner": {"reputation": 49, "user_id": 10902456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ada65b0e620d80482863a71d48da40?s=128&d=identicon&r=PG&f=1", "display_name": "shtb2708", "link": "https://stackoverflow.com/users/10902456/shtb2708"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1552406740, "post_id": 55125501, "comment_id": 96993450, "body": "@ThunderCat my intent is to display exclusively the .json on the terminal, and I tried to display exclusively the different .json files on the terminal by excluding the other files"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1552407113, "post_id": 55125501, "comment_id": 96993681, "body": "Use <code>filepath.Ext(path) == &quot;.json&quot;</code> to determine that a file has the .json extension."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1552410453, "post_id": 55125501, "comment_id": 96995714, "body": "That has nothing to do with sorting though - your question mentions sorting several times. Can you clarify? Are you trying to sort or just filter?"}, {"owner": {"reputation": 49, "user_id": 10902456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ada65b0e620d80482863a71d48da40?s=128&d=identicon&r=PG&f=1", "display_name": "shtb2708", "link": "https://stackoverflow.com/users/10902456/shtb2708"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552410714, "post_id": 55125501, "comment_id": 96995870, "body": "you right the exact word is filter @Adrian"}], "answers": [{"tags": [], "owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "is_accepted": false, "score": 1, "last_activity_date": 1552408028, "last_edit_date": 1552408028, "creation_date": 1552406664, "answer_id": 55125943, "question_id": 55125501, "link": "https://stackoverflow.com/questions/55125501/how-to-sort-file-names-with-go-programming-language/55125943#55125943", "title": "How to sort file names with Go Programming Language?", "body": "<p><a href=\"https://golang.org/pkg/io/ioutil/#ReadDir\" rel=\"nofollow noreferrer\">https://golang.org/pkg/io/ioutil/#ReadDir</a> </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n)\n\nfunc main() {\n    files, err := ioutil.ReadDir(\".\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for _, file := range files {\n        fmt.Println(file.Name())\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 10902456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ada65b0e620d80482863a71d48da40?s=128&d=identicon&r=PG&f=1", "display_name": "shtb2708", "link": "https://stackoverflow.com/users/10902456/shtb2708"}, "edited": false, "score": 0, "creation_date": 1552412159, "post_id": 55127326, "comment_id": 96996691, "body": "Thank you for your help"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1552412905, "post_id": 55127326, "comment_id": 96997136, "body": "Handle all legal cases, for example, &quot;.JSON&quot;,  &quot;.json&quot;, and so on. Replace <code>filepath.Ext(file.Name())</code> with <code>strings.ToLower(filepath.Ext(file.Name()))</code>. <a href=\"https://play.golang.org/p/7phdmYH0Rms\" rel=\"nofollow noreferrer\">play.golang.org/p/7phdmYH0Rms</a>"}], "tags": [], "owner": {"reputation": 36, "user_id": 11192750, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d05dc0c81cd03117cc417e116161a331?s=128&d=identicon&r=PG", "display_name": "Morton Salt", "link": "https://stackoverflow.com/users/11192750/morton-salt"}, "is_accepted": true, "score": 2, "last_activity_date": 1552411301, "creation_date": 1552411301, "answer_id": 55127326, "question_id": 55125501, "link": "https://stackoverflow.com/questions/55125501/how-to-sort-file-names-with-go-programming-language/55127326#55127326", "title": "How to sort file names with Go Programming Language?", "body": "<p>Based on comments, it appears that the question is \"How to print files where the file has a .json extension\".   Here's the code:</p>\n\n<pre><code>if os.Args[1] == \"display-json-name\" {\n    //reads the directory name and returns a list of directory entries\n    dirname := \".\"\n\n    f, err := os.Open(dirname)\n    if err != nil {\n        log.Fatal(err)\n    }\n    files, err := f.Readdir(-1)\n    f.Close()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for _, file := range files {\n        if filepath.Ext(file.Name()) == \".json\" {\n            fmt.Println(file.Name())\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 10902456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ada65b0e620d80482863a71d48da40?s=128&d=identicon&r=PG&f=1", "display_name": "shtb2708", "link": "https://stackoverflow.com/users/10902456/shtb2708"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 55127326, "answer_count": 2, "score": -3, "last_activity_date": 1552424103, "creation_date": 1552405342, "last_edit_date": 1552424103, "question_id": 55125501, "link": "https://stackoverflow.com/questions/55125501/how-to-sort-file-names-with-go-programming-language", "title": "How to sort file names with Go Programming Language?", "body": "<p>In my Go project, I need to sort the <code>.json</code> files and to display their name on the terminal when I'm running this command on the terminal <code>go run main.go</code>.</p>\n\n<p>I coded a program which displays all the files in the folder, but I need to sort the <code>.json</code> file. </p>\n\n<p>My code is the following : </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"bytes\"\n    \"io\"\n)\n\nfunc main() {\n\n    if os.Args[1] == \"display-json-name\" {\n        //reads the directory name and returns a list of directory entries\n        dirname := \".\" \n\n        f, err := os.Open(dirname)\n        if err != nil {\n            log.Fatal(err)\n        }\n        files, err := f.Readdir(-1)\n        f.Close()\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        for _, file := range files {\n            fmt.Println(file.Name())\n        }\n    }\n</code></pre>\n\n<p>How can we sort just the different <code>.json</code> files?</p>\n\n<p>And the hierarchy of my project is : \n<a href=\"https://i.stack.imgur.com/ZgjKM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZgjKM.png\" alt=\"enter image description here\"></a> </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 5, "creation_date": 1552400474, "post_id": 55123375, "comment_id": 96988940, "body": "Have you taken the <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">Tour of Go</a>?"}, {"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "edited": false, "score": 0, "creation_date": 1552416663, "post_id": 55123375, "comment_id": 96999063, "body": "Please remain &quot;new to OOP&quot; as you continue to learn Go. :)"}], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": false, "score": 2, "last_activity_date": 1552401156, "last_edit_date": 1552401156, "creation_date": 1552400286, "answer_id": 55123687, "question_id": 55123375, "link": "https://stackoverflow.com/questions/55123375/setting-struct-fields-from-function/55123687#55123687", "title": "Setting struct fields from function", "body": "<p>Here, the error is thrown because <code>Calculations()</code> returns multiple values but you are trying to assign it to a single variable.</p>\n\n<p>You need to change the <code>player.Calculations()</code> method invocation from</p>\n\n<pre><code>    calcs := player.Calculations()\n</code></pre>\n\n<p>to</p>\n\n<pre><code>firstname, lastname, batting_average, slugging_percentage, OBP := player.Calculations()\n</code></pre>\n\n<p>Having said that I would recommend you to read more about golang may be <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">here</a>. You need to re-write the code in view of go best practises</p>\n"}], "owner": {"reputation": 39, "user_id": 10863848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716fe55d4119511b62597bc3cbfa84ef?s=128&d=identicon&r=PG&f=1", "display_name": "learningunix717", "link": "https://stackoverflow.com/users/10863848/learningunix717"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1552401295, "creation_date": 1552399393, "last_edit_date": 1552401295, "question_id": 55123375, "link": "https://stackoverflow.com/questions/55123375/setting-struct-fields-from-function", "title": "Setting struct fields from function", "body": "<p>I'm sure there is a better way to do this, and I understand it's simple but I am new to go so bear with me.  I am trying to set the fields of a struct (<code>playersObject</code>) from two functions (<code>setCalculations</code> and <code>Calculations</code>), more specifically, I am passing in values of two arrays (<code>playerData</code> and <code>playerData2</code> from main to those functions, performing calculations in those functions, and want to return the values so that they can be set within the struct.</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"os\"\n    \"log\"\n    \"strings\"\n    \"bufio\"\n    \"strconv\"\n)\n\ntype playersObject struct {\n\n        firstname, lastname string\n        batting_average, slugging_percentage, OBP, teamaverage float64\n    }\n\n\nfunc strToFloat(playerData []string, playerData2 []float64) []float64 {\n\n        for _, i := range playerData[2:] {\n            j, err := strconv.ParseFloat(i, 64)\n            if err != nil {\n                panic(err)\n            }\n            playerData2 = append(playerData2, j)\n        }\n        return playerData2\n}\n\nfunc (player *playersObject) setCalculations (playerData []string, playerData2 []float64)  {\n\n    player.firstname = playerData[1]\n    player.lastname = playerData[0]\n    player.batting_average = (playerData2[2] + playerData2[3] + playerData2[4] + playerData2[5]) / (playerData2[1])\n    player.slugging_percentage = ((playerData2[2]) + (playerData2[3]*2) + (playerData2[4]*3) + (playerData2[5]*4) )/(playerData2[1])\n    player.OBP = (( playerData2[2] + playerData2[3] + playerData2[4] + playerData2[5] +playerData2[6] +playerData2[7])/ (playerData2[0]))\n\n}\n\nfunc (player *playersObject) Calculations () (string, string, float64, float64, float64, ) {\n\n    return player.firstname, player.lastname, player.batting_average, player.slugging_percentage, player.OBP\n}\n\n\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter file name: \")\n    fileName, err := reader.ReadString('\\n')\n        if err != nil {\n            log.Fatalf(\"failed opening file: %s\", err)\n        }\n    fileName = strings.TrimSuffix(fileName, \"\\n\")\n\n    //fmt.Printf(\"%q\\n\", fileName)\n    file, err := os.Open(fileName)\n       scanner := bufio.NewScanner(file)\n       scanner.Split(bufio.ScanLines)\n       var fileOfPlayers []string\n\n       for scanner.Scan() {\n           fileOfPlayers = append(fileOfPlayers, scanner.Text())\n       }\n\n       file.Close()\n\n\n      // var total_Average_sum float64 = 0\n       var countofplayers float64 = 0\n       //var total_average float64 = 0\n       for _, player := range fileOfPlayers {\n        countofplayers ++\n        playerData := strings.Split(player, \" \")\n        var playerData2 = []float64{}\n        playerData2 = strToFloat(playerData, playerData2)\n\n        player := playersObject{}\n        player.setCalculations(playerData, playerData2)\n\n        calcs := player.Calculations()\n\n        fmt.Println(firstname, lastname, batting_average, slugging_percentage, OBP)\n\n    }\n}\n</code></pre>\n\n<p>I recieve the errors <code>multiple-value player.Calculations() in single-value contextand</code>  <code>undefined: firstname, lastname, batting_average, slugging_percentage, OBP</code></p>\n\n<p>I know this is very incorrect but again I am new to go and OOP. If this can be done in any simpler way I am open to it and appreciate all help and tips.  Thank you </p>\n"}, {"tags": ["performance", "go", "server", "grpc"], "comments": [{"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1552403360, "post_id": 55123018, "comment_id": 96991082, "body": "If you use netperf to test the local network, which are the results?"}, {"owner": {"reputation": 53, "user_id": 11103927, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--aXzQswAI38/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO3cDgvt5m1FNh0YbZadFCfxIFSyA/mo/photo.jpg?sz=128", "display_name": "TheFunny Sunny", "link": "https://stackoverflow.com/users/11103927/thefunny-sunny"}, "reply_to_user": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1552404051, "post_id": 55123018, "comment_id": 96991520, "body": "Netperf? haven&#39;t heard about that. I will check tomorrow asap and let You know"}, {"owner": {"reputation": 1720, "user_id": 6205738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a08adf9353636c19dc5a4e45df11d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Saty", "link": "https://stackoverflow.com/users/6205738/saty"}, "edited": false, "score": 0, "creation_date": 1552411484, "post_id": 55123018, "comment_id": 96996304, "body": "How exactly are you testing on the ethernet? I am just asking out of curiosity as I don&#39;t know how it is done. Although I can&#39;t see anything obviously wrong on your Go code."}, {"owner": {"reputation": 53, "user_id": 11103927, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--aXzQswAI38/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO3cDgvt5m1FNh0YbZadFCfxIFSyA/mo/photo.jpg?sz=128", "display_name": "TheFunny Sunny", "link": "https://stackoverflow.com/users/11103927/thefunny-sunny"}, "edited": false, "score": 0, "creation_date": 1552420177, "post_id": 55123018, "comment_id": 97000793, "body": "I have a grpc client that sends hello packets to server. I am timing each packet sent to the server, just a casual &quot;timer on, send and receive, timer off&quot;. For all other servers it works well but on GO server it is a total crap. Like it is not casching the client but it it like he connects as a new client every time or something"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 11103927, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--aXzQswAI38/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO3cDgvt5m1FNh0YbZadFCfxIFSyA/mo/photo.jpg?sz=128", "display_name": "TheFunny Sunny", "link": "https://stackoverflow.com/users/11103927/thefunny-sunny"}, "edited": false, "score": 0, "creation_date": 1552544862, "post_id": 55148913, "comment_id": 97051899, "body": "Will do. Thbk You for your answer!"}], "tags": [], "owner": {"reputation": 36, "user_id": 3477206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d434863359909b34ef9e202eb318395f?s=128&d=identicon&r=PG&f=1", "display_name": "lyuxuan", "link": "https://stackoverflow.com/users/3477206/lyuxuan"}, "is_accepted": false, "score": 0, "last_activity_date": 1552501604, "creation_date": 1552501604, "answer_id": 55148913, "question_id": 55123018, "link": "https://stackoverflow.com/questions/55123018/grpc-server-long-response-times-over-ethernet/55148913#55148913", "title": "gRPC server long response times over ethernet", "body": "<p>According to the benchmark <a href=\"https://performance-dot-grpc-testing.appspot.com/explore?dashboard=5652536396611584\" rel=\"nofollow noreferrer\">here</a>, Go and C++ shouldn't have such big difference (over ethernet). Could you please file an issue in the grpc-go repo, <a href=\"https://github.com/grpc/grpc-go/issues/new\" rel=\"nofollow noreferrer\">https://github.com/grpc/grpc-go/issues/new</a>? And it will be very helpful if you can provide more context about how client side works. Thanks!</p>\n"}], "owner": {"reputation": 53, "user_id": 11103927, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--aXzQswAI38/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO3cDgvt5m1FNh0YbZadFCfxIFSyA/mo/photo.jpg?sz=128", "display_name": "TheFunny Sunny", "link": "https://stackoverflow.com/users/11103927/thefunny-sunny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 499, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552501604, "creation_date": 1552398370, "last_edit_date": 1552398727, "question_id": 55123018, "link": "https://stackoverflow.com/questions/55123018/grpc-server-long-response-times-over-ethernet", "title": "gRPC server long response times over ethernet", "body": "<p>I was testing client-server connection with gRPC client written in C# and a bunch of servers (written in c++, C#, rust and go). As I was testing it locally everything went okay (average GO response around 0.12ms) but when I test it over local network it gets really slow, like REALLY slow. Average time goes to 40ms per request! \nTo be clear: I am using a simple HelloWorld proto with simplest connection possible. Other servers get about 1ms per request but Go - around 40ms. </p>\n\n<p>My Go server code: </p>\n\n<pre><code> package main\n\nimport (\n    \"context\"\n    pb \"descriptions\"\n    \"log\"\n    \"net\"\n\n    \"google.golang.org/grpc\"\n)\n\ntype server struct{}\n\n// SayHello implements helloworld.GreeterServer\nfunc (s *server) SayHello(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) {\n    //log.Printf(\"Received: %v\", in.Name)\n    return &amp;pb.HelloReply{Message: \"\"}, nil\n}\n\nfunc main() {\n    //  lis, err := net.Listen(\"tcp\", port)\n    lis, err := net.Listen(\"tcp\", \"0.0.0.0:50051\")\n    if err != nil {\n        log.Fatalf(\"failed to listen: %v\", err)\n    }\n    s := grpc.NewServer()\n    log.Printf(\"Server listening on: \" + lis.Addr().String())\n    pb.RegisterGreeterServer(s, &amp;server{})\n    if err := s.Serve(lis); err != nil {\n        log.Fatalf(\"failed to serve: %v\", err)\n    }\n}\n</code></pre>\n\n<p>I do not suspect that it is client side issiue because it works well with other servers. Have anyone had the same issiue with golang? Please let me know! \nI was also thinking if that might be like HTTP 1.1 issue but gRPC supports HTTP2 so I suspect it is already used when running this code. </p>\n"}, {"tags": ["go", "jwt"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1552398661, "post_id": 55121893, "comment_id": 96987654, "body": "<code>if v, ok := data.(*User); ok</code> - have you verified that data is of type *User? If it&#39;s not, you are returning an empty claims struct."}, {"owner": {"reputation": 73, "user_id": 10499507, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RmfCiR0CUIQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWZIqTg5NqPeMy65f-oXcF6UZF12A/mo/photo.jpg?sz=128", "display_name": "Zeng Vincent", "link": "https://stackoverflow.com/users/10499507/zeng-vincent"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1552480236, "post_id": 55121893, "comment_id": 97024056, "body": "@Gavin yes, i verified the data and confirmed it has data"}], "answers": [{"tags": [], "owner": {"reputation": 334, "user_id": 1865744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec25979c96608c94cdd67b4c5f2b87d?s=128&d=identicon&r=PG", "display_name": "Trong Dinh", "link": "https://stackoverflow.com/users/1865744/trong-dinh"}, "is_accepted": false, "score": 1, "last_activity_date": 1554695747, "creation_date": 1554695747, "answer_id": 55566031, "question_id": 55121893, "link": "https://stackoverflow.com/questions/55121893/fail-to-get-extra-info-from-login-response-in-gin-jwt/55566031#55566031", "title": "fail to get extra info. from login response in gin-jwt", "body": "<p>You cannot get extractClaims from login endpoint 'cause there is no token on Authorization header. The cheat way is set a new variable to context from Authenticator func.</p>\n"}], "owner": {"reputation": 73, "user_id": 10499507, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RmfCiR0CUIQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWZIqTg5NqPeMy65f-oXcF6UZF12A/mo/photo.jpg?sz=128", "display_name": "Zeng Vincent", "link": "https://stackoverflow.com/users/10499507/zeng-vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554695747, "creation_date": 1552394954, "question_id": 55121893, "link": "https://stackoverflow.com/questions/55121893/fail-to-get-extra-info-from-login-response-in-gin-jwt", "title": "fail to get extra info. from login response in gin-jwt", "body": "<p>i tried to apply the gin-jwt to backend(gin) of my react app, wanna get the user id and role info. for RBAC. i can login and get the token accordingly, but when i tried to get role info from LoginResponse function, the userid and role field is blank.</p>\n\n<p>i want to know the flow of login, why it doesnt work ?</p>\n\n<p>PayloadFunc:</p>\n\n<pre><code>authMiddleware, err := jwt.New(&amp;jwt.GinJWTMiddleware{\n    Realm:       \"test zone\",\n    Key:         []byte(\"mysecretkey\"),\n    Timeout:     time.Hour,\n    MaxRefresh:  time.Hour,\n    IdentityKey: identityKey,\n\n    PayloadFunc: func(data interface{}) jwt.MapClaims {\n        if v, ok := data.(*User); ok {\n            return jwt.MapClaims{\n                identityKey: v.UserName,\n                role: v.Role,\n                email: v.Email,\n            }\n        }\n        return jwt.MapClaims{}\n    },\n</code></pre>\n\n<p>Authenticator:</p>\n\n<pre><code>Authenticator: func(c *gin.Context) (interface{}, error) {\n        var loginVals Login\n        if err := c.BindJSON(&amp;loginVals); err != nil {\n            return \"\", jwt.ErrMissingLoginValues\n        }\n        plainpass := loginVals.Password\n        session, err := mgo.Dial(SERVER)\n        ce(err)\n        colQuerier := bson.M{\"username\": loginVals.Username}\n        err = session.DB(DATABASE).C(\"asys_users\").Find(colQuerier).One(&amp;loginVals)\n        ce(err)\n        defer session.Close()\n        if CheckPasswordHash(plainpass, loginVals.Password) {\n            return &amp;User{\n                UserName:  loginVals.Username,\n                Role:  loginVals.Role,\n                Email: loginVals.Email,\n            }, nil\n        }\n\n        return nil, jwt.ErrFailedAuthentication\n    },\n</code></pre>\n\n<p>LoginResponse:</p>\n\n<pre><code>LoginResponse: func(c *gin.Context, code int, token string, expire time.Time) {\n        claims := jwt.ExtractClaims(c)\n        fmt.Println(claims) . // only map[], nothing\n        c.JSON(http.StatusOK, gin.H{\n            \"code\":   http.StatusOK,\n            \"token\":  token,\n            \"expire\": expire.Format(time.RFC3339),\n            \"userid\": claims[\"id\"], // this field is null\n            \"role\": claims[\"role\"],  // this field is null  \n            \"email\": claims[\"email\"],  // this field is null\n        })\n    },\n</code></pre>\n"}, {"tags": ["json", "go", "decode"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1552398323, "last_edit_date": 1552398323, "creation_date": 1552393814, "answer_id": 55121520, "question_id": 55121300, "link": "https://stackoverflow.com/questions/55121300/handling-different-types-when-unmarshalling-a-json/55121520#55121520", "title": "Handling different types when unmarshalling a json", "body": "<p>Unmarshal it into a value of <code>interface{}</code> type, and use a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a> or <a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"nofollow noreferrer\">type switch</a> to inspect the type of value it ends up. Note that by default JSON arrays are unmarshaled into a value of type <code>[]interface{}</code>, so you have to check for that to detect the error response.</p>\n\n<p>For example:</p>\n\n<pre><code>type Response struct {\n    Message interface{} `json:\"message\"`\n}\n\nfunc main() {\n    inputs := []string{\n        `{\"message\":\"Message\"}`,\n        `{\"message\":[\"ERROR_CODE\"]}`,\n    }\n\n    for _, input := range inputs {\n        var r Response\n        if err := json.Unmarshal([]byte(input), &amp;r); err != nil {\n            panic(err)\n        }\n        switch x := r.Message.(type) {\n        case string:\n            fmt.Println(\"Success, message:\", x)\n        case []interface{}:\n            fmt.Println(\"Error, code:\", x)\n        default:\n            fmt.Println(\"Something else:\", x)\n        }\n    }\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/akMKKo79_7R\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Success, message: Message\nError, code: [ERROR_CODE]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5147, "user_id": 334761, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZXRM5.jpg?s=128&g=1", "display_name": "Stefan Majewsky", "link": "https://stackoverflow.com/users/334761/stefan-majewsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1552394162, "creation_date": 1552394162, "answer_id": 55121644, "question_id": 55121300, "link": "https://stackoverflow.com/questions/55121300/handling-different-types-when-unmarshalling-a-json/55121644#55121644", "title": "Handling different types when unmarshalling a json", "body": "<p>You can use a custom type that implements <code>json.Unmarshaller</code> and tries to decode each possible input format in turn:</p>\n\n<pre><code>type Message struct {\n    Text string\n    Codes []int\n}\n\nfunc (m *Message) UnmarshalJSON(input []byte) error {\n    var text string\n    err := json.Unmarshal(input, &amp;text)\n    if err == nil {\n        m.Text = text\n        m.Codes = nil\n        return nil\n    }\n\n    var codes []int\n    err := json.Unmarshal(input, &amp;codes)\n    if err == nil {\n        m.Text = nil\n        m.Codes = codes\n        return nil\n    }\n\n    return err\n}\n</code></pre>\n\n<p>I prefer this approach over unmarshalling into <code>interface{}</code> and type-asserting later because all the type checks are encapsulated in the unmarshalling step.</p>\n\n<p>For a real-world example, check out my <code>type veryFlexibleUint64</code>: <a href=\"https://github.com/sapcc/limes/blob/fb212143c5f5b3e9272994872fcc7b758ae47646/pkg/plugins/client_ironic.go\" rel=\"nofollow noreferrer\">https://github.com/sapcc/limes/blob/fb212143c5f5b3e9272994872fcc7b758ae47646/pkg/plugins/client_ironic.go</a></p>\n"}, {"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": false, "score": 1, "last_activity_date": 1552398979, "last_edit_date": 1552398979, "creation_date": 1552398537, "answer_id": 55123072, "question_id": 55121300, "link": "https://stackoverflow.com/questions/55121300/handling-different-types-when-unmarshalling-a-json/55123072#55123072", "title": "Handling different types when unmarshalling a json", "body": "<p>I would suggest creating a different type for <strong>Message</strong> and making that implement <code>json.Unmarshaller</code></p>\n\n<p>here is how the code would be </p>\n\n<pre><code>type message struct {\n    Text  string\n    Codes []string //or int , assuming array of string as it was not mentioned in the question\n}\n\nfunc (m *message) UnmarshalJSON(input []byte) error {\n    if len(input) == 0 {\n        return nil\n    }\n    switch input[0] {\n    case '\"':\n        m.Text = strings.Trim(string(input), `\"`)\n        return nil\n    case '[':\n        return json.Unmarshal(input, &amp;m.Codes)\n    default:\n    return fmt.Errorf(`invalid character %q looking for \" or [`, input[0])\n\n    }\n}\n\ntype Error struct {\n    Message message `json:\"message\"`\n}\n</code></pre>\n\n<p>You may find full code with test <a href=\"https://play.golang.com/p/RMjSVVsYgeF\" rel=\"nofollow noreferrer\">here</a> </p>\n"}], "owner": {"reputation": 543, "user_id": 2526070, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9c144ba38a87cf2ce8493c71eee66518?s=128&d=identicon&r=PG", "display_name": "Lucas Beier", "link": "https://stackoverflow.com/users/2526070/lucas-beier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "closed_date": 1552401122, "accepted_answer_id": 55121520, "answer_count": 3, "score": 2, "last_activity_date": 1552398979, "creation_date": 1552393165, "last_edit_date": 1552398809, "question_id": 55121300, "link": "https://stackoverflow.com/questions/55121300/handling-different-types-when-unmarshalling-a-json", "closed_reason": "Duplicate", "title": "Handling different types when unmarshalling a json", "body": "<p>I'm consuming an endpoint (which I don't own and I cannot fix) and this endpoint returns JSON.</p>\n\n<p>The problem is this JSON can come in different formats:</p>\n\n<p>Format 1:</p>\n\n<pre><code>{\n  \"message\": \"Message\"\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>{\n  \"message\": [\"ERROR_CODE\"]\n}\n</code></pre>\n\n<p>Depending on what happened.</p>\n\n<p>I'd like to have one struct to hold this response so later I can check if the <code>message</code> is a string or array, and properly follow a flow.</p>\n\n<p>Is it possible to do it in Go? The first approach I thought was to have two structs and try to decode to the one with <code>string</code>, and if an error happens, try to decode to the one with <code>array</code>.</p>\n\n<p>Is there a more elegant approach?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 478, "user_id": 3491376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lh2OC.png?s=128&g=1", "display_name": "Deadooshka", "link": "https://stackoverflow.com/users/3491376/deadooshka"}, "edited": false, "score": 1, "creation_date": 1552385715, "post_id": 55118559, "comment_id": 96979455, "body": "you can trace the behavior with browser tool, like f12 or ctrl+shift+I"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1552386643, "post_id": 55118559, "comment_id": 96980060, "body": "Delete the session cookie in logout, e.g. w.Header.Set(&quot;Set-Cookie&quot;, &quot;cookie-name=; Max-Age=-1&quot;). Make sure to use the appropriate paths and domains."}], "answers": [{"tags": [], "owner": {"reputation": 1219, "user_id": 3864339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aQ1gO.jpg?s=128&g=1", "display_name": "Juan Cespedes", "link": "https://stackoverflow.com/users/3864339/juan-cespedes"}, "is_accepted": true, "score": 1, "last_activity_date": 1552389807, "creation_date": 1552389807, "answer_id": 55120312, "question_id": 55118559, "link": "https://stackoverflow.com/questions/55118559/how-to-stop-session-from-caching-authenticated-users-data-after-logout/55120312#55120312", "title": "How to stop session from caching authenticated users data after logout", "body": "<p>I am afraid there is no way to \"fix\" your code without using JavaScript and changing the \"secret\" page before leaving it.</p>\n\n<p>The problem is not in Go, or in <code>gorilla/sessions</code>, or even in HTTP: it is in the way the web browsers perform caching: at least in Firefox and Chrome, when going \"back\" and \"forward\" the browsers just display the cached page from disk, ignoring completely the headers.</p>\n\n<p>Oh, and BTW: to try to force the browsers to stop caching a page, you should add those lines to the \"secret\" handler, and not to the \"logout\" one.</p>\n"}], "owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 55120312, "answer_count": 1, "score": 1, "last_activity_date": 1552389807, "creation_date": 1552384436, "last_edit_date": 1552384980, "question_id": 55118559, "link": "https://stackoverflow.com/questions/55118559/how-to-stop-session-from-caching-authenticated-users-data-after-logout", "title": "How to stop session from caching authenticated users data after logout", "body": "<p>This code was leverage \n<a href=\"https://gowebexamples.com/sessions/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>The code below was used to create users session in Go. The session is working fine.</p>\n\n<p>The issue am having is that after \nuser logout, if I click on browser back button. I can then still see the details of the logout user.</p>\n\n<p>I have leverage stackoverflow solution here but no luck</p>\n\n<p><a href=\"https://stackoverflow.com/questions/35086688/golang-gorilla-sessions-cache-prevents-logout-functionality\">stackoverflow link</a></p>\n\n<p>I have also added the following code to logout handler</p>\n\n<pre><code>w.Header().Set(\"Cache-Control\", \"no-cache, private, max-age=0\")\nw.Header().Set(\"Pragma\", \"no-cache\")\nw.Header().Set(\"X-Accel-Expires\", \"0\")\n</code></pre>\n\n<p>here is the code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n   \"github.com/gorilla/sessions\"\n)\n\nvar (\n    // key must be 16, 24 or 32 bytes long (AES-128, AES-192 or AES-256)\n    key = []byte(\"super-secret-key\")\n    store = sessions.NewCookieStore(key)\n)\n\nfunc secret(w http.ResponseWriter, r *http.Request) {\n    session, _ := store.Get(r, \"cookie-name\")\n\n    // Check if user is authenticated\n    if auth, ok := session.Values[\"authenticated\"].(bool); !ok || !auth {\n        http.Error(w, \"Forbidden\", http.StatusForbidden)\n        return\n    }\n\n    // Print secret message\n    fmt.Fprintln(w, \"The cake is a lie!\")\n        fmt.Fprintln(w, session.Values[\"foo\"])\n}\n\nfunc login(w http.ResponseWriter, r *http.Request) {\n    session, _ := store.Get(r, \"cookie-name\")\n\n    // Authentication goes here\n\n    // Set user as authenticated\n  session.Values[\"authenticated\"] = true\n  session.Values[\"foo\"] = \"bar\"\n  session.Values[42] = 43\n    session.Save(r, w)\n\nfmt.Fprintln(w, session.Values[\"authenticated\"])\nfmt.Fprintln(w, session.Values[\"foo\"])\nfmt.Fprintln(w, session.Values[\"2\"])\n}\n\nfunc logout(w http.ResponseWriter, r *http.Request) {\n    session, _ := store.Get(r, \"cookie-name\")\n\n    // Revoke users authentication\n    session.Values[\"authenticated\"] = false\n        session.Values[\"foo\"] = \"\"\n        session.Values[42] = \"\"\n    session.Save(r, w)\n\n// prevent caching\nw.Header().Set(\"Cache-Control\", \"no-cache, private, max-age=0\")\nw.Header().Set(\"Pragma\", \"no-cache\")\nw.Header().Set(\"X-Accel-Expires\", \"0\")\n\n\n}\n\nfunc main() {\n    http.HandleFunc(\"/secret\", secret)\n    http.HandleFunc(\"/login\", login)\n    http.HandleFunc(\"/logout\", logout)\n\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 12147, "user_id": 4378400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wsSe.jpg?s=128&g=1", "display_name": "Yury Fedorov", "link": "https://stackoverflow.com/users/4378400/yury-fedorov"}, "edited": false, "score": 0, "creation_date": 1552378200, "post_id": 55115843, "comment_id": 96974994, "body": "How do you run your app (not <code>realize start</code>)? Anyway, maybe try to use <code>go install</code> instead of <code>go build</code>, and then just use the built binary directly."}, {"owner": {"reputation": 1935, "user_id": 5625207, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/djay8.jpg?s=128&g=1", "display_name": "Rajesh Yogeshwar", "link": "https://stackoverflow.com/users/5625207/rajesh-yogeshwar"}, "reply_to_user": {"reputation": 12147, "user_id": 4378400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wsSe.jpg?s=128&g=1", "display_name": "Yury Fedorov", "link": "https://stackoverflow.com/users/4378400/yury-fedorov"}, "edited": false, "score": 0, "creation_date": 1552382128, "post_id": 55115843, "comment_id": 96977182, "body": "@YuryFedorov I tried install, but the error persists. As for running the app, I am running a simple server and listening on port 8080"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 1, "creation_date": 1552384746, "post_id": 55115843, "comment_id": 96978837, "body": "@RajeshYogeshwar Is this <code>Install</code> error from <code>entrypoint.sh</code> file? Could you show its content? <code>ARG</code> value in Dockerfile is only set/available on build, after that it is removed, you probably should set <code>environment</code> value"}, {"owner": {"reputation": 1935, "user_id": 5625207, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/djay8.jpg?s=128&g=1", "display_name": "Rajesh Yogeshwar", "link": "https://stackoverflow.com/users/5625207/rajesh-yogeshwar"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1552385379, "post_id": 55115843, "comment_id": 96979225, "body": "@ttomalak I realised it few minutes back and have set GO111MODULE as environment module. As for entrypoint.sh there isn&#39;t anything in it as of now."}, {"owner": {"reputation": 1935, "user_id": 5625207, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/djay8.jpg?s=128&g=1", "display_name": "Rajesh Yogeshwar", "link": "https://stackoverflow.com/users/5625207/rajesh-yogeshwar"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1552385872, "post_id": 55115843, "comment_id": 96979568, "body": "@ttomalak that was precisely the issue. Because the ARG in my Dockerfile only set the variable during build stage, go build or go mod download command would not work. As per your suggestion and my realisation I updated it and it has worked. Thanks a lot for pointing it out."}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1552393897, "post_id": 55115843, "comment_id": 96984457, "body": "@Rajesh Yogeshwar should I put it as answer to your question then?"}, {"owner": {"reputation": 1935, "user_id": 5625207, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/djay8.jpg?s=128&g=1", "display_name": "Rajesh Yogeshwar", "link": "https://stackoverflow.com/users/5625207/rajesh-yogeshwar"}, "edited": false, "score": 0, "creation_date": 1552394194, "post_id": 55115843, "comment_id": 96984627, "body": "Sorry mate, your answer was partially correct. The problem still persisted as my app directory was within GOPATH and the GO111MODULE was getting set to auto even after passing it as environment variable. It worked for me because I had manually executed export GO111MODULE within the container. I am still trying to solve this question. You were partially correct though and hence an upvote to your comment."}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1552396303, "post_id": 55115843, "comment_id": 96985987, "body": "Did you changed your <code>ARG GO111MODULE=on</code> to <code>ENV  GO111MODULE=on</code> and rebuilded image(Dockerfile)?"}, {"owner": {"reputation": 1935, "user_id": 5625207, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/djay8.jpg?s=128&g=1", "display_name": "Rajesh Yogeshwar", "link": "https://stackoverflow.com/users/5625207/rajesh-yogeshwar"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1552396781, "post_id": 55115843, "comment_id": 96986334, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/189882/discussion-between-rajesh-yogeshwar-and-ttomalak\">continue this discussion in chat</a>."}], "owner": {"reputation": 1935, "user_id": 5625207, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/djay8.jpg?s=128&g=1", "display_name": "Rajesh Yogeshwar", "link": "https://stackoverflow.com/users/5625207/rajesh-yogeshwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1090, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1552389749, "creation_date": 1552374373, "last_edit_date": 1552375294, "question_id": 55115843, "link": "https://stackoverflow.com/questions/55115843/cannot-find-package-error-when-using-go-modules-inside-docker-containers", "title": "Cannot find package error when using go modules inside docker containers", "body": "<p>Given I have some experience working with docker containers I decided to use docker containers to have a go environment and learn. Below is my dockerfile for go web app.</p>\n\n<pre><code>FROM golang:1.12.0-alpine3.9 as base\n\nARG GO111MODULE=on\n\nRUN apk update &amp;&amp; apk add make bash git\n\nCOPY ./app /go/src/app\nWORKDIR /go/src/app\nRUN go build\n\nCOPY ./compose/local/golang/entrypoint.sh /entrypoint.sh\nRUN chmod +x /entrypoint.sh\n\nRUN go get github.com/oxequa/realize\n\nENTRYPOINT [ \"/entrypoint.sh\" ]\nCMD [\"realize\", \"start\"]\n</code></pre>\n\n<p>My go.mod file</p>\n\n<pre><code>module github.com/rajeshyogeshwar/demoapp\n\ngo 1.12\n\nrequire (\n    github.com/Sirupsen/logrus v1.0.6\n    github.com/joho/godotenv v1.3.0\n    github.com/julienschmidt/httprouter v1.2.0\n    github.com/lib/pq v1.0.0\n    github.com/spf13/cobra v0.0.3\n    github.com/spf13/viper v1.2.0\n)\n</code></pre>\n\n<p>and finally my project folder structure</p>\n\n<p><a href=\"https://i.stack.imgur.com/RKJOT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RKJOT.png\" alt=\"enter image description here\"></a></p>\n\n<p>As we can see I am trying to use httprouter module and it has been defined in my go.mod file. But I keep getting following error.</p>\n\n<pre><code>app_1        | [06:46:56][APP] : Install \napp_1        |  main.go:8:2: cannot find package \"github.com/julienschmidt/httprouter\" in any of:\napp_1        |  /usr/local/go/src/github.com/julienschmidt/httprouter (from $GOROOT)\napp_1        |  /go/src/github.com/julienschmidt/httprouter (from $GOPATH)\n</code></pre>\n\n<p>So if anyone can point out the obvious mistake it would be great.</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1552364981, "post_id": 55114112, "comment_id": 96970330, "body": "Assign the return value from <code>strToInt </code> to <code>employeeDataInt</code>.  Otherwise, the updated slice is ignored."}, {"owner": {"reputation": 39, "user_id": 10863848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716fe55d4119511b62597bc3cbfa84ef?s=128&d=identicon&r=PG&f=1", "display_name": "learningunix717", "link": "https://stackoverflow.com/users/10863848/learningunix717"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1552365102, "post_id": 55114112, "comment_id": 96970365, "body": "do you mean instead of just having <code>int[]</code> as my return, have <code>employeeDataInt int[]</code>? cause i tried that earlier and it gave me <code>missing function body</code> and <code>syntax error: unexpected [ after top level declaration</code> errors @ThunderCat"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1552372099, "post_id": 55114112, "comment_id": 96972357, "body": "The function returns a value, but the calling function ignores it.  Fix with <code>employeeDataInt = strToInt(employeeDataString, employeeDataInt)</code>.  Also, update the question with an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.   The variable <code>playerData2</code> is not declared or set in the program."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1552397845, "post_id": 55115799, "comment_id": 96987115, "body": "Re-read the post - <code>strToInt</code> is correctly using the return value of <code>append</code>. The problem is that where it is called is discarding the return value of <code>strToInt</code>."}, {"owner": {"reputation": 22034, "user_id": 21699, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1c27bc77c7d5d9506958e3f9164341b7?s=128&d=identicon&r=PG", "display_name": "Tigraine", "link": "https://stackoverflow.com/users/21699/tigraine"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552471921, "post_id": 55115799, "comment_id": 97018846, "body": "I know :) But it&#39;s essentially the same issue (and append was meant as a example). <code>[]int</code> is a slice that is passed by reference, doesn&#39;t matter it&#39;s passed to <code>append</code> or <code>strToInt</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552483742, "post_id": 55115799, "comment_id": 97026377, "body": "There is no pass by reference in Go."}, {"owner": {"reputation": 22034, "user_id": 21699, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1c27bc77c7d5d9506958e3f9164341b7?s=128&d=identicon&r=PG", "display_name": "Tigraine", "link": "https://stackoverflow.com/users/21699/tigraine"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552564641, "post_id": 55115799, "comment_id": 97062790, "body": "It&#39;s just so explicit in the language that you wouldn&#39;t consider it a traditional pass by reference: Pointers :)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552568039, "post_id": 55115799, "comment_id": 97064959, "body": "But the issue is because it is <i>not</i> passed by pointer <i>or</i> by reference. It&#39;s passed by value. They share the same underlying array, until the underlying array is changed by <code>append</code>."}], "tags": [], "owner": {"reputation": 22034, "user_id": 21699, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1c27bc77c7d5d9506958e3f9164341b7?s=128&d=identicon&r=PG", "display_name": "Tigraine", "link": "https://stackoverflow.com/users/21699/tigraine"}, "is_accepted": false, "score": 2, "last_activity_date": 1552374169, "creation_date": 1552374169, "answer_id": 55115799, "question_id": 55114112, "link": "https://stackoverflow.com/questions/55114112/passing-int-to-function-but-function-returning-empty-array/55115799#55115799", "title": "passing int[] to function but function returning empty array", "body": "<p>You aren't taking the value of the array and thus the Slice you passed into the function might or might not be updated correctly.</p>\n\n<pre><code>strToInt(employeeDataString, employeeDataInt)\n// should be\nemployeeDataInt = strToInt(employeeDataString, employeeDataInt)\n</code></pre>\n\n<p>And while at it, you are never assigning <code>playerData2</code>. So <code>fmt.Println(playerData2)</code> will always be <code>[]</code>.</p>\n\n<p>But aside from that there are some subtle issues with your usage of Arrays/Slices here:</p>\n\n<p>First the difference between <a href=\"https://www.godesignpatterns.com/2014/05/arrays-vs-slices.html\" rel=\"nofollow noreferrer\"><code>Slices</code> and <code>Arrays</code></a>:</p>\n\n<p>Go does not allow you to directly work with Arrays.\nUnless they have a fixed length (<code>[3]int{}</code> or <code>[]int{1,2,3]</code>) you aren't actually looking at an array but at a <code>Slice</code> (<code>[]int</code>). </p>\n\n<p>The slice is just a pointer to an array (along with it's capacity and some other info) and it essentially allows Go to safely muck around with arrays because you never grow an existing array (the size of an array is fixed at initialization). So you can never append to an array. </p>\n\n<p>What Go does to give you the illusion of appending to an array is having a larger than required underlying array, and the <code>Slice</code> controls the access to that array. So if the underlying array has a capacity of 5 and you already stored 3 items in it you can do 2 <code>append</code> operations without having to allocate a new array and copy the existing array elements to the new memory location.</p>\n\n<p>So when you are passing a <code>[]int</code> you are actually passing an array pointer (by value) around.</p>\n\n<p>This leads to the next gotcha in your code: The use of <code>append</code>.\nAs mentioned above, <code>append</code> takes a Slice, looks at the underlying array and how much space is actually left and then adds to it <em>or</em> allocates a new array. If a new array is allocated <code>append</code> returns a <em>new</em> slice that points to the new array.</p>\n\n<p>So calling:</p>\n\n<pre><code>foo := []{1,2,3}\nappend(foo, 4)\nappend(foo, 5)\nappend(foo, 6)\nfmt.Print(foo) \n// =&gt; might return 1,2,3,4,5\n</code></pre>\n\n<p>You always have to take the return value of <code>append</code> otherwise you risk still referencing the \"old\" slice that didn't get the new items appended.</p>\n\n<p>So the correct way to grow a Slice, or work with Slices in general is to keep in mind that: <a href=\"https://stackoverflow.com/questions/39993688/are-golang-slices-pass-by-value\">Slices are passed by value</a>, so always keep updating your variables with the return values of Slice modifying functions.</p>\n"}, {"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1552398160, "creation_date": 1552398160, "answer_id": 55122950, "question_id": 55114112, "link": "https://stackoverflow.com/questions/55114112/passing-int-to-function-but-function-returning-empty-array/55122950#55122950", "title": "passing int[] to function but function returning empty array", "body": "<p>There are a few issues in your code:</p>\n\n<ul>\n<li>You're discarding the return value of <code>strToInt</code>.</li>\n<li>You're trying to utilize <code>employeeDataInt</code> in <code>main</code> but it is undefined there (which should be causing a compile error, not a runtime issue).</li>\n<li>You're declaring <code>employeeDataString</code> twice, in two different scopes in <code>main</code> (inside and outside the <code>for</code> loop), with two different types (<code>[]string</code> and <code>[]int</code>). The outer-scoped variable is unused, so should also be causing a compile error.</li>\n<li>You're printing <code>playerData2</code> which is never defined or used - again, this should be causing a compiler error, not incorrect behavior.</li>\n</ul>\n\n<p>Given there were compile errors in the code, either some crucial code was missing from your post, or you did not notice/mention the compile errors.</p>\n\n<p>The correct code within main would be:</p>\n\n<pre><code>var employeeDataInt []int  // Seems like you just have the wrong variable name here\nfor _, employee := range employeeLine {\n    employeeDataString := strings.Split(employee, \" \")\n\n    // You're missing the assignment here\n    employeeDataInt = strToInt(employeeDataString, employeeDataInt)\n    fmt.Println(employeeDataInt) // This was referencing the wrong variable\n\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10863848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716fe55d4119511b62597bc3cbfa84ef?s=128&d=identicon&r=PG&f=1", "display_name": "learningunix717", "link": "https://stackoverflow.com/users/10863848/learningunix717"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1552398160, "creation_date": 1552364450, "last_edit_date": 1552373842, "question_id": 55114112, "link": "https://stackoverflow.com/questions/55114112/passing-int-to-function-but-function-returning-empty-array", "title": "passing int[] to function but function returning empty array", "body": "<p>I am passing in a string array and an empty integer array into a function. The point of the function is to convert each element of the string array to an integer and store that into the integer array. When I print the integer array from within the function itself, everything is fine. However, when I try to print the integer array outside of the function, it prints an empty array.</p>\n\n<p><code>employeeDataInt</code> is the integer array, and <code>employeeDataString</code> is the string array.</p>\n\n<p>I apologize if this is a dumb question but I am new to go. Thanks</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc strToInt(employeeDataString []string, emplyoeeDataInt []int) []int {\n    for _, i := range employeeDataString[2:] {\n        j, err := strconv.Atoi(i)\n        if err != nil {\n            panic(err)\n        }\n        employeeDataInt = append(employeeDataInt, j)\n        fmt.Println(employeeDataInt) //this prints out the appropriate array\n\n    }\n    return employeeDataInt\n}\n\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter file name: \")\n    fileName, err := reader.ReadString('\\n')\n    if err != nil {\n        log.Fatalf(\"failed opening file: %s\", err)\n    }\n    fileName = strings.TrimSuffix(fileName, \"\\n\")\n\n    file, err := os.Open(fileName)\n    scanner := bufio.NewScanner(file)\n    scanner.Split(bufio.ScanLines)\n    var employeeLine []string\n\n    for scanner.Scan() {\n        employeeLine = append(employeeLine, scanner.Text())\n    }\n\n    file.Close()\n    var employeeDataString = []int{}\n    for _, employee := range employeeLine {\n        employeeDataString := strings.Split(employee, \" \")\n\n        strToInt(employeeDataString, employeeDataInt)\n        fmt.Println(playerData2) //this is outputting just `[]`\n\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "configuration"], "answers": [{"comments": [{"owner": {"reputation": 1701, "user_id": 1319282, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9f8b2deea85ffdbf33a3029d67e11ff?s=128&d=identicon&r=PG", "display_name": "Ardeus", "link": "https://stackoverflow.com/users/1319282/ardeus"}, "edited": false, "score": 0, "creation_date": 1552375339, "post_id": 55115097, "comment_id": 96973657, "body": "so is it not recommended? stick with static file?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1701, "user_id": 1319282, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9f8b2deea85ffdbf33a3029d67e11ff?s=128&d=identicon&r=PG", "display_name": "Ardeus", "link": "https://stackoverflow.com/users/1319282/ardeus"}, "edited": false, "score": 0, "creation_date": 1552376697, "post_id": 55115097, "comment_id": 96974262, "body": "@Ardeus Both have their role: static file for static data, source code for dynamic runtime values (like <code>time.Now()</code>... which can makes sense only at runtime)"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1552370811, "creation_date": 1552370811, "answer_id": 55115097, "question_id": 55114082, "link": "https://stackoverflow.com/questions/55114082/config-file-type-usage/55115097#55115097", "title": "Config file type usage", "body": "<blockquote>\n  <p>What if I decide to use .go file instead </p>\n</blockquote>\n\n<p>Then it is no longer a config file (static content), but a source file, which needs to be compiled and part of your exe (runtime content).</p>\n\n<p>It then could be part of an <a href=\"https://medium.com/golangspec/init-functions-in-go-eac191b3860a\" rel=\"nofollow noreferrer\"><code>init()</code> function</a> for instance.<br>\nOr part of a <a href=\"https://stackoverflow.com/a/27388866/6309\"><code>config</code> package source</a>, in charge of loading your config as well as initializing the variables in your question.</p>\n"}], "owner": {"reputation": 1701, "user_id": 1319282, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9f8b2deea85ffdbf33a3029d67e11ff?s=128&d=identicon&r=PG", "display_name": "Ardeus", "link": "https://stackoverflow.com/users/1319282/ardeus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "accepted_answer_id": 55115097, "answer_count": 1, "score": 2, "last_activity_date": 1552560697, "creation_date": 1552364236, "last_edit_date": 1552560697, "question_id": 55114082, "link": "https://stackoverflow.com/questions/55114082/config-file-type-usage", "title": "Config file type usage", "body": "<p>Usually I saw config file in many examples out there are in .env or .json file.</p>\n\n<p>What if I decide to use .go file instead , is it uncommon, how it should be done?</p>\n\n<p>I was thinking since .env file is static, if I want to put config like this</p>\n\n<pre><code>var currentDate = time.Now()\nvar currentDateFormat = currentDate.Format(\"2006-01-02\")\nvar logPath = dir + \"/log/\" + currentDateFormat + \".log\"\n</code></pre>\n\n<p>It can't be done in .env file so should I just keep the above config within function somewhere and stick with .env file?</p>\n"}, {"tags": ["opencv", "go"], "answers": [{"comments": [{"owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "edited": false, "score": 0, "creation_date": 1552374582, "post_id": 55113356, "comment_id": 96973320, "body": "Actually algorithm I am trying to use is not part of that module. That is why I am wrapping C++ code in C which I am trying to use in Go."}, {"owner": {"reputation": 1574, "user_id": 10911905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/464f9d95f48b6f1d2ab156181e59c05a?s=128&d=identicon&r=PG&f=1", "display_name": "Nuzhny", "link": "https://stackoverflow.com/users/10911905/nuzhny"}, "reply_to_user": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "edited": false, "score": 0, "creation_date": 1552378322, "post_id": 55113356, "comment_id": 96975056, "body": "Undefined reference error says then linker needs a object with implementation: *.o or *.obj, *.a or *.lib. Implementation of this function is here: <a href=\"https://github.com/opencv/opencv_contrib/blob/6389627d8a9377c0bac0441b69493e52210079fd/modules/optflow/src/tvl1flow.cpp\" rel=\"nofollow noreferrer\">github.com/opencv/opencv_contrib/blob/&hellip;</a> . And do you need link opencv_optflow library."}, {"owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "edited": false, "score": 0, "creation_date": 1552409753, "post_id": 55113356, "comment_id": 96995300, "body": "Well if I have everything in my /usr/local/include directory I do not understand how it cannot find it? Since I ran a test program which uses opencv_video and it works. Not sure whats going on now."}], "tags": [], "owner": {"reputation": 1574, "user_id": 10911905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/464f9d95f48b6f1d2ab156181e59c05a?s=128&d=identicon&r=PG&f=1", "display_name": "Nuzhny", "link": "https://stackoverflow.com/users/10911905/nuzhny"}, "is_accepted": false, "score": 1, "last_activity_date": 1552358704, "creation_date": 1552358704, "answer_id": 55113356, "question_id": 55111936, "link": "https://stackoverflow.com/questions/55111936/undefined-reference-to-cvoptflowcreateoptflow-dualtvl1/55113356#55113356", "title": "Undefined reference to &quot;cv::optflow::createOptFlow_DualTVL1()&quot;", "body": "<p>This optical flow imported from contrib module.\nYou need advanced import ( <a href=\"https://github.com/hybridgroup/gocv/tree/master/contrib\" rel=\"nofollow noreferrer\">https://github.com/hybridgroup/gocv/tree/master/contrib</a> ):  \"gocv.io/x/gocv/contrib\"</p>\n"}], "owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552358704, "creation_date": 1552347157, "last_edit_date": 1552347248, "question_id": 55111936, "link": "https://stackoverflow.com/questions/55111936/undefined-reference-to-cvoptflowcreateoptflow-dualtvl1", "title": "Undefined reference to &quot;cv::optflow::createOptFlow_DualTVL1()&quot;", "body": "<p>I have successfully installed <code>gocv</code> package from <a href=\"https://github.com/hybridgroup/gocv\" rel=\"nofollow noreferrer\">https://github.com/hybridgroup/gocv</a> and I am trying to run C++ code which I wrapped in C library inside my Go project. But there seems to be the problem when I try to call <code>cv::optflow::createOptFlow_DualTVL1()</code> method. I get undefined reference error. I dont know why, since in <code>optflow.hpp</code> file there is a method called <code>createOptFlow_DualTVL1()</code></p>\n\n<p>Here is my <code>main.go</code> file:</p>\n\n<pre><code>package main\n\n/*\n#cgo LDFLAGS: -L/usr/local/lib -lopencv_core -lopencv_video -lopencv_videoio -lopencv_highgui -lopencv_tracking -lopencv_optflow\n#include \"dense_flow.h\"\n*/\nimport (\n       \"C\"\n       \"gocv.io/x/gocv\"\n)\n\nfunc main(){\n\n}\n</code></pre>\n\n<p><strong>NOTE:</strong> <code>dense_flow.h</code> is where I have declared my <code>CalculateT4VL1()</code> function which calls to <code>createOptFlow_DualTVL1()</code> inside <code>dense_flow.cpp</code> file.</p>\n\n<p>Operating System and version: Ubuntu 18.04</p>\n\n<p>OpenCV version used: 4.0.0</p>\n\n<p>GoCV version used: 0.18</p>\n\n<p>Go version: 1.12</p>\n"}, {"tags": ["angular", "go", "nginx", "cors", "microservices"], "comments": [{"owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 1, "creation_date": 1552344749, "post_id": 55111117, "comment_id": 96965806, "body": "What&#39;s the actual request that gets 405? You left that line out (<code>POST &#47;anteroom HTTP&#47;1.1</code>?)"}, {"owner": {"reputation": 525, "user_id": 1291530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/syHq5.png?s=128&g=1", "display_name": "nusantara", "link": "https://stackoverflow.com/users/1291530/nusantara"}, "reply_to_user": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1552374264, "post_id": 55111117, "comment_id": 96973197, "body": "Thanks for the reminder, @kichik. I&#39;ve added it where I talk about the request and response headers."}, {"owner": {"reputation": 61150, "user_id": 441757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/921df025d1d7c99fad4553ac83bd8bdf?s=128&d=identicon&r=PG", "display_name": "sideshowbarker", "link": "https://stackoverflow.com/users/441757/sideshowbarker"}, "edited": false, "score": 1, "creation_date": 1552379111, "post_id": 55111117, "comment_id": 96975467, "body": "The details in the question indicate the 405 error response in fact doesn\u2019t include the Access-Control-Allow-Origin response header. Regardless, even if it did include the Access-Control-Allow-Origin, it\u2019d still be a 405 error. So it seems like the actual problem you need to solve is to figure out what\u2019s causing the 405 error and fix it."}, {"owner": {"reputation": 525, "user_id": 1291530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/syHq5.png?s=128&g=1", "display_name": "nusantara", "link": "https://stackoverflow.com/users/1291530/nusantara"}, "reply_to_user": {"reputation": 61150, "user_id": 441757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/921df025d1d7c99fad4553ac83bd8bdf?s=128&d=identicon&r=PG", "display_name": "sideshowbarker", "link": "https://stackoverflow.com/users/441757/sideshowbarker"}, "edited": false, "score": 0, "creation_date": 1552404905, "post_id": 55111117, "comment_id": 96992133, "body": "@sideshowbarker Yes, thanks for pointing it out. I thought the 405 was related or caused by the lack of the header. But it&#39;s not. I&#39;ve updated the question."}], "answers": [{"tags": [], "owner": {"reputation": 525, "user_id": 1291530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/syHq5.png?s=128&g=1", "display_name": "nusantara", "link": "https://stackoverflow.com/users/1291530/nusantara"}, "is_accepted": false, "score": 0, "last_activity_date": 1552406293, "creation_date": 1552406293, "answer_id": 55125817, "question_id": 55111117, "link": "https://stackoverflow.com/questions/55111117/405-method-not-allowed-and-cors-header-access-control-allow-origin-missing-a/55125817#55125817", "title": "405 Method Not Allowed and &quot;CORS header \u2018Access-Control-Allow-Origin\u2019 missing&quot; although tcpdump says it&#39;s being sent out", "body": "<p>Primarily, the problem is due to this line for Gorilla mux in <code>main()</code> in the Golang code:</p>\n\n<p><code>router.HandleFunc(\"/anteroom\", anteroom).Methods(\"POST, OPTIONS\")</code></p>\n\n<p>Notice the methods in the back: <code>(\"POST, OPTIONS\")</code>. This is wrong. It should be <code>(\"POST\", \"OPTIONS\")</code>. They must be quoted separately.</p>\n\n<p>This is different from when we set the methods in the function for the page with net/http: <code>res.Header().Set(\"Access-Control-Allow-Methods\", \"POST, OPTIONS\")</code>. Here, they are quoted together.</p>\n\n<p>I think there may have been diverse issues but it's been such a tiring journey I remember only this last one now.</p>\n"}], "owner": {"reputation": 525, "user_id": 1291530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/syHq5.png?s=128&g=1", "display_name": "nusantara", "link": "https://stackoverflow.com/users/1291530/nusantara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2598, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572451127, "creation_date": 1552342016, "last_edit_date": 1552405908, "question_id": 55111117, "link": "https://stackoverflow.com/questions/55111117/405-method-not-allowed-and-cors-header-access-control-allow-origin-missing-a", "title": "405 Method Not Allowed and &quot;CORS header \u2018Access-Control-Allow-Origin\u2019 missing&quot; although tcpdump says it&#39;s being sent out", "body": "<p>This question follows this <a href=\"https://stackoverflow.com/questions/55031745/cors-request-did-not-succeed-despite-enabling-it-for-nginx-angular-http-serve\">one</a> so some of the text is the same.</p>\n\n<p>The error message on Firefox console when the front end tries to POST JSON data to the back end upon submitting a form.:</p>\n\n<p>\"Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at <a href=\"https://backend_domain/anteroom\" rel=\"nofollow noreferrer\">https://backend_domain/anteroom</a>. (Reason: <strong>CORS header \u2018Access-Control-Allow-Origin\u2019 missing</strong>).\"</p>\n\n<p>I'm running the Golang back end with a systemd unit and serving it at localhost:12345. Nginx listens at port 80 and passes requests down to it:</p>\n\n<pre><code>listen 80;\nserver_name backend_domain;\n\nlocation / {\n    include proxy_params;\n    proxy_pass http://localhost:12345/;\n}\n</code></pre>\n\n<p>I'm running the Angular front end as a build (built with <code>--prod</code> flag) using PM2 with angular-http-server serving it at port 8080. Same as the back end, Nginx does its thing from port 80:</p>\n\n<pre><code>listen 80;\nserver_name frontend_domain;\n\nlocation / {\n    include proxy_params;\n    proxy_pass http://localhost:8080/;\n}\n</code></pre>\n\n<p>The versions I'm working with: Ubuntu 16.04, PM2 3.3.1, Angular CLI 7.3.4, angular-http-server 1.8.1.</p>\n\n<p>Firefox's network tab in developer's tools reveals the POST request headers:</p>\n\n<pre><code>Host: backend_domain\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:65.0) Gecko/20100101 Firefox/65.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: frontend_domain/\nContent-Type: text/plain\nContent-Length: 111\nOrigin: frontend_domain\nDNT: 1\nConnection: keep-alive\n</code></pre>\n\n<p>And the response headers:</p>\n\n<pre><code>HTTP/1.1 405 Method Not Allowed\nServer: nginx/1.10.3 (Ubuntu)\nDate: Mon, 11 Mar 2019 21:08:24 GMT\nContent-Length: 0\nConnection: keep-alive\nStrict-Transport-Security: max-age=31536000; includeSubDomains\n</code></pre>\n\n<p>The actual request that's supposed to go to the back end when I hit the submit button is:</p>\n\n<pre><code>if (val.issues &amp;&amp; val.age &amp;&amp; val.gender) {\n      this.profile = JSON.stringify({\n        age: val.age,\n        gender: val.gender,\n        issues: val.issues\n      });\n\n      return this.http\n        .post(environment.anteroomPOSTURL, this.profile, {\n          observe: \"response\"\n        })\n</code></pre>\n\n<p>Firefox shows this to successfully trigger, with the JSON showing under the Params tab in Network in dev tools.</p>\n\n<p>This response suggests to me that somehow, Nginx is not passing requests down to the back end at port 12345. Otherwise, it would retrieve and pass the headers from the back end shown below in my Golang code back to the front end, right?</p>\n\n<p>I've read that CORS is a server-side issue. So, I've tried enabling it wherever I've a server, that is, in the back end, Nginx, and angular-http-server.</p>\n\n<p>It's enabled in my Golang code:</p>\n\n<pre><code>func anteroom(res http.ResponseWriter, req *http.Request) {\n    res.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n    res.Header().Set(\"Access-Control-Allow-Methods\", \"POST, OPTIONS\")\n    res.Header().Set(\"Access-Control-Allow-Headers\", \"Content-Type\")\n    res.Header().Set(\"Content-Type\", \"application/json\")\n...\n}\n\nfunc main() {\n    ...\n    # Using Gorilla mux router.\n    router := mux.NewRouter()\n    router.HandleFunc(\"/anteroom\", anteroom).Methods(\"POST, OPTIONS\")\n}\n</code></pre>\n\n<p>This successfully enables CORS in development, where serving Golang is just opening its built binary and Angular is served with <code>ng serve</code>.</p>\n\n<p>The above isn't enough in production. So, I've tried enabling it with angular-http-server. Note the <code>--cors</code> flag at the end:</p>\n\n<pre><code>pm2 start $(which angular-http-server) --name app -- --path /PATH/TO/DIST -p 8080 --cors\n</code></pre>\n\n<p>I've also tried enabling it in both the back and front end Nginx files (adapted from <a href=\"https://enable-cors.org/server_nginx.html\" rel=\"nofollow noreferrer\">here</a>):</p>\n\n<pre><code>location / {\nproxy_pass http://localhost:8080; # or 12345 if it's the back end conf\nif ($request_method = 'OPTIONS') {\n        add_header 'Access-Control-Allow-Origin' '*';\n        add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';\n        add_header 'Access-Control-Allow-Headers' 'Content-Type';\n        add_header 'Content-Type' 'application/json';\n        return 204;\n     }\n\n     if ($request_method = 'POST') {\n        add_header 'Access-Control-Allow-Origin' '*';\n        add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';\n        add_header 'Access-Control-Allow-Headers' 'Content-Type';\n        add_header 'Content-Type' 'application/json';\n     }\n\n     if ($request_method = 'GET') {\n        add_header 'Access-Control-Allow-Origin' '*';\n        add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';\n        add_header 'Access-Control-Allow-Headers' 'Content-Type';\n     }\n}\n}\n</code></pre>\n\n<p>Oddly, no matter if the headers are in either Nginx files or not, <code>tcpdump -vvvs 1024 -l -A src host backend_domain | grep 'Access-Control-Allow-Origin:'</code> produces this:</p>\n\n<pre><code>        Access-Control-Allow-Origin: *\nAccess-Control-Allow-Origin: *\n        Access-Control-Allow-Origin: *\nAccess-Control-Allow-Origin: *\n        Access-Control-Allow-Origin: *\nAccess-Control-Allow-Origin: *\n        Access-Control-Allow-Origin: *\nAccess-Control-Allow-Origin: *\n        Access-Control-Allow-Origin: *\nAccess-Control-Allow-Origin: *\n        Access-Control-Allow-Origin: *\nAccess-Control-Allow-Origin: *\n</code></pre>\n\n<p>No idea why it repeats 12 times but, anyway, the back end sends the above the moment the front end loads (which means Nginx does successfully pass requests down to port 12345, right?). It doesn't send them when I click the submit button to submit the form. I don't know if this is correct behaviour or if it indicates that something is wrong.</p>\n\n<p>What am I missing?</p>\n\n<p><em>Update 12 Mar 19, 7.30pm:</em></p>\n\n<p>As seen above and pointed out by sideshowbarker in the comments, there's a \"405 Method Not Allowed\" response. I thought at first that this was linked to the CORS issue and also with Nginx. To verify it, I stopped Nginx, and opened my firewall at port 12345 so that I could POST to the Golang back end directly.</p>\n\n<p>To avoid any complication by the same-origin policy, I used cURL  to POST from another machine: <code>curl -v -X POST -H 'Content-Type: application/json' -d '{\"age\":\"l\",\"gender\":\"l\",\"issues\":\"l\"}' http://droplet_IP:12345/anteroom</code></p>\n\n<p>I got the exact same response: \"HTTP/1.1 405 Method Not Allowed\".</p>\n\n<p>At this point, my best guess is that the Golang back end isn't allowing POST even though it's explicitly allowed in the code, as seen above. I'm at a loss as to why.</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 1, "user_id": 11187465, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qgj3W7zX7Xk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfSGlptRmleRG3IkDhZvFqTQYqITw/mo/photo.jpg?sz=128", "display_name": "Jordan", "link": "https://stackoverflow.com/users/11187465/jordan"}, "edited": false, "score": 0, "creation_date": 1552416839, "post_id": 55110970, "comment_id": 96999160, "body": "Update: I found a setting <code>ssl-cipher=DHE-RSA-AES256-SHA</code> that seems to be the culprit. I have opened an issue with the package maintainer on <a href=\"https://github.com/go-sql-driver/mysql/issues/935\" rel=\"nofollow noreferrer\">GitHub</a>. Further research pointed me to this <a href=\"https://github.com/golang/go/issues/9894\" rel=\"nofollow noreferrer\">go/tls issue</a>. Anyone know if Go is still missing support for this encryption?"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1552441647, "post_id": 55110970, "comment_id": 97007638, "body": "Unlikely to ever be implemented in Go because DHE is slow, has compatibility issues over 1024 bits and is getting removed in browsers. Suggest choosing a different cipher (if that&#39;s the problem)."}], "owner": {"reputation": 1, "user_id": 11187465, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qgj3W7zX7Xk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfSGlptRmleRG3IkDhZvFqTQYqITw/mo/photo.jpg?sz=128", "display_name": "Jordan", "link": "https://stackoverflow.com/users/11187465/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 859, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552341090, "creation_date": 1552341090, "question_id": 55110970, "link": "https://stackoverflow.com/questions/55110970/go-mysql-with-ssl-unexpected-eof", "title": "Go MySQL with SSL - unexpected EOF", "body": "<p>I'm using the <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow noreferrer\">Go MySQL driver</a> as part of a project. Recently, there was a need to enable SSL on the MySQL database I am connecting to. I have two servers that are configured with <code>TLSv1.1</code>. On one server, I am able connect successfully, but on the other I am getting <code>unexpected EOF</code> from the library.</p>\n\n<p>I tried setting <code>MaxIdleConnections</code> to 0 as described in <a href=\"https://stackoverflow.com/questions/39980902/golang-mysql-error-packets-go33-unexpected-eof\">Golang MySQL error - packets.go:33: unexpected EOF</a>, but no luck. Prior to enabling SSL, connections to the server were working. There are other apps not written in Go that are able to connect successfully using the same credentials.</p>\n\n<p>When my app runs, the ping command fails immediately. The MySQL server logs are saying <code>bad handshake</code>. Is there something off with my connection code below, or is there a database setting that could be refusing to connect with <code>skip-verify</code>?</p>\n\n<pre><code>import (\n    \"database/sql\"\n    \"io/ioutil\"\n    \"strings\"\n    \"text/template\"\n\n    log \"github.com/sirupsen/logrus\"\n    // Import runtime for MySQL\n    mysql \"github.com/go-sql-driver/mysql\"\n)\n\ntype DatabaseConnection struct {\n    Hostname string\n    Port     int\n    Database string\n    Username string\n    Password string\n}\n\nfunc CreateSSLConnection(db *DatabaseConnection) (*sql.DB, error) {\n    templateString := `{{.Username}}:{{.Password}}@{{.Hostname}}:{{.Port}}/{{.Database}}?tls=skip-verify`\n\n    conn, err := connectToDatabase(\"mysql\", templateString, db)\n\n    // error: \"unexpected EOF\"\n    err = conn.Ping()\n    return conn, err\n}\n\nfunc connectToDatabase(databaseType string, connectionTemplateString string, db *DatabaseConnection) (*sql.DB, error) {\n    connectionTemplate := template.Must(template.New(\"connectionString\").Parse(connectionTemplateString))\n    builder := strings.Builder{}\n\n    err := connectionTemplate.Execute(&amp;builder, db)\n    if err != nil {\n        log.WithFields(log.Fields{\n            \"template\": connectionTemplateString,\n            \"error\":    err,\n        }).Error(\"Failed to create connection string\")\n        return nil, err\n    }\n\n    return sql.Open(databaseType, builder.String())\n}\n</code></pre>\n"}, {"tags": ["string", "go", "time"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 3, "creation_date": 1552339867, "post_id": 55110362, "comment_id": 96964206, "body": "wait, what is the right date? what kind of format is this?"}, {"owner": {"reputation": 3740, "user_id": 1246282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e2c2f18588f9771a7db500e90a6eb44?s=128&d=identicon&r=PG", "display_name": "chrsblck", "link": "https://stackoverflow.com/users/1246282/chrsblck"}, "edited": false, "score": 2, "creation_date": 1552340839, "post_id": 55110362, "comment_id": 96964535, "body": "See <a href=\"https://stackoverflow.com/a/15952652/1246282\">stackoverflow.com/a/15952652/1246282</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1552377548, "last_edit_date": 1552377548, "creation_date": 1552342846, "answer_id": 55111281, "question_id": 55110362, "link": "https://stackoverflow.com/questions/55110362/converting-a-json-format-timestamp-to-golangs-time-time/55111281#55111281", "title": "Converting a json format timestamp to golangs time.Time", "body": "<p>That time format seems to be the elapsed milliseconds since epoch and a signed 4-digit zone offset (hour and min).</p>\n\n<p>Easiest would be to use <a href=\"https://golang.org/pkg/fmt/#Sscanf\" rel=\"nofollow noreferrer\"><code>fmt.Sscanf()</code></a> to parse it, something like this:</p>\n\n<pre><code>_, err = fmt.Sscanf(s, \"/Date(%d+%02d%02d)/\", &amp;ms, &amp;zoneHour, &amp;zoneMin)\n</code></pre>\n\n<p>Of course if the zone offset is negative, the format will not match. That can be handled by a second attempt of parsing, <code>+</code> replaced by a <code>-</code> in the format string.</p>\n\n<p>Once you have the <code>ms</code>, multiply it by a million to get nanoseconds, so you can pass that to <a href=\"https://golang.org/pkg/time/#Unix\" rel=\"nofollow noreferrer\"><code>time.Unix()</code></a> (it is valid to pass a nanoseconds value outside of the <code>[0, 999999999]</code> range).</p>\n\n<p>Last you can use <a href=\"https://golang.org/pkg/time/#FixedZone\" rel=\"nofollow noreferrer\"><code>time.FixedZone()</code></a> to obtain a zone corresponding to the zone offset in the input, and then use <a href=\"https://golang.org/pkg/time/#Time.In\" rel=\"nofollow noreferrer\"><code>Time.In()</code></a> to \"switch over\" to this zone.</p>\n\n<p><sup>Note that the milliseconds since epoch is zone-independent (it is given in UTC zone). Switching over to the source's zone offset is only required so that when you print the time (or you access its \"fields\" like year, month, day), you will see the intended date and time, as that would be different in another zone. For example the instance you have, it designates the date <code>1980-01-01</code> and 0 time in the day. Without the <code>+0530</code> zone, that would be a different day, it would be <code>1979-12-31 18:30:00 +0000 UTC</code>.</sup></p>\n\n<p>Here's an example doing it:</p>\n\n<pre><code>func parse(s string) (t time.Time, err error) {\n    var ms int64\n    var zhour, zmin int\n\n    if _, err = fmt.Sscanf(s, \"/Date(%d+%02d%02d)/\", &amp;ms, &amp;zhour, &amp;zmin); err != nil {\n        if _, err = fmt.Sscanf(s, \"/Date(%d-%02d%02d)/\", &amp;ms, &amp;zhour, &amp;zmin); err != nil {\n            return time.Time{}, fmt.Errorf(\"Failed to parse: %v\", err)\n        }\n        zhour = -zhour\n        zmin = -zmin\n    }\n\n    t = time.Unix(0, ms*1000000)\n    t = t.In(time.FixedZone(\"\", zhour*3600+zmin*60))\n    return\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>fmt.Println(parse(\"/Date(315513000000+0530)/\"))\nfmt.Println(parse(\"/Date(315513000000-0530)/\"))\nfmt.Println(parse(\"invalid\"))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/QTMa4nEKGt-\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>1980-01-01 00:00:00 +0530 +0530 &lt;nil&gt;\n1979-12-31 13:00:00 -0530 -0530 &lt;nil&gt;\n0001-01-01 00:00:00 +0000 UTC Failed to parse: input does not match format\n</code></pre>\n"}], "owner": {"reputation": 4986, "user_id": 4763988, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/99abed3bcb05d0b736fa03034ba5aadd?s=128&d=identicon&r=PG&f=1", "display_name": "Kannaj", "link": "https://stackoverflow.com/users/4763988/kannaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 55111281, "answer_count": 1, "score": 0, "last_activity_date": 1552377548, "creation_date": 1552338137, "last_edit_date": 1552346749, "question_id": 55110362, "link": "https://stackoverflow.com/questions/55110362/converting-a-json-format-timestamp-to-golangs-time-time", "title": "Converting a json format timestamp to golangs time.Time", "body": "<p>I have a datetime string in json with the below format</p>\n\n<pre><code> /Date(315513000000+0530)/ \n</code></pre>\n\n<p>I would like to convert this into golangs <code>time.Time</code> format. I tried passing this string to the below function</p>\n\n<pre><code>func parseDateField(dateInput string) (int64, error) {\n    startIdx := strings.Index(dateInput, \"(\")\n    if startIdx == -1 {\n        return 0, errors.New(\"Error parsing quote Date. '(' symbol not found\")\n    }\n\n    endIdx := strings.Index(dateInput, \"+\")\n    if endIdx == -1 {\n    return 0, errors.New(\"Error parsing quote Date. '+' symbol not found\")\n     }\n    dateStr := dateInput[startIdx+1 : endIdx]\n    date, err := strconv.ParseInt(dateStr, 10, 64)\n    if err != nil {\n        fmt.Printf(\" err : \\n %+v \\n\", err)\n        return 0, err\n     }\n     tm := time.Unix(date, 0)\n     fmt.Printf(\"\\n time  : \\n %+v \\n\", tm)\n     dateAsEpoch := int64(date / 1000)\n     fmt.Printf(\"\\n dateAsEpoch  : \\n %+v \\n\", dateAsEpoch)\n     return dateAsEpoch, nil\n}\n</code></pre>\n\n<p>I'm getting the below outputs</p>\n\n<pre><code> time  : \n 11968-03-18 01:30:00 +0530 IST \n\n\n dateAsEpoch  : \n 315513000 \n</code></pre>\n\n<p>I'm guessing the parsing isnt done right - what am i doing wrong?</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9011212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8fc0cc7d77d75537e255846360e6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "nindustries", "link": "https://stackoverflow.com/users/9011212/nindustries"}, "edited": false, "score": 0, "creation_date": 1552375999, "post_id": 55110573, "comment_id": 96973999, "body": "That&#39;s really a shame, even if I need to manually map it. Not even for the COUNT(*) ?"}, {"owner": {"reputation": 855, "user_id": 8459497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Rz7r.png?s=128&g=1", "display_name": "zeynel", "link": "https://stackoverflow.com/users/8459497/zeynel"}, "reply_to_user": {"reputation": 23, "user_id": 9011212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8fc0cc7d77d75537e255846360e6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "nindustries", "link": "https://stackoverflow.com/users/9011212/nindustries"}, "edited": false, "score": 0, "creation_date": 1552378729, "post_id": 55110573, "comment_id": 96975267, "body": "What do you mean by <code>Not even for the COUNT(*)</code> ? How would you optimize <code>count</code> even if you write raw sql?"}, {"owner": {"reputation": 23, "user_id": 9011212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8fc0cc7d77d75537e255846360e6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "nindustries", "link": "https://stackoverflow.com/users/9011212/nindustries"}, "edited": false, "score": 0, "creation_date": 1552379537, "post_id": 55110573, "comment_id": 96975674, "body": "I mean not having to issue a separate query to calculate a <code>COUNT(*) OVER()</code>"}], "tags": [], "owner": {"reputation": 855, "user_id": 8459497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Rz7r.png?s=128&g=1", "display_name": "zeynel", "link": "https://stackoverflow.com/users/8459497/zeynel"}, "is_accepted": false, "score": 0, "last_activity_date": 1552339184, "creation_date": 1552339184, "answer_id": 55110573, "question_id": 55109392, "link": "https://stackoverflow.com/questions/55109392/how-to-merge-queries/55110573#55110573", "title": "How to merge queries", "body": "<p>GORM does not support database level <code>JOIN</code> on <code>Preload</code>. You have two choices: </p>\n\n<ul>\n<li>either use <code>Preload</code> and live with the fact that it executes an extra query to fetch related data (which should not be a problem unless you have a heavy load on your server)</li>\n<li>or you can write your own <a href=\"http://gorm.io/docs/sql_builder.html\" rel=\"nofollow noreferrer\">Raw Sql</a> query using <code>JOIN</code> and handle everything in one query, then map the data to a struct.</li>\n</ul>\n"}], "owner": {"reputation": 23, "user_id": 9011212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8fc0cc7d77d75537e255846360e6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "nindustries", "link": "https://stackoverflow.com/users/9011212/nindustries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1552339184, "creation_date": 1552334035, "last_edit_date": 1552334125, "question_id": 55109392, "link": "https://stackoverflow.com/questions/55109392/how-to-merge-queries", "title": "How to merge queries", "body": "<p>I am writing a page where a list of Blog posts are rendered, with pagination. I am using GORM with Go 1.12.\nEach blogpost has an author called User, and that user could contain some additional employee info if necessary. (e.g. intro, function title, ...)</p>\n\n<p>My models:</p>\n\n<pre><code>type EmployeeInfo struct {\n    UserID    uint   `gorm:\"not null;unique\"`\n    Title     string `gorm:\"not null\"`\n    Intro     string `gorm:\"\"`\n}\n\ntype User struct {\n    gorm.Model\n\n    Username  string    `gorm:\"unique;not null\"`\n    Password  string    `gorm:\"unique;not null\"`\n\n    FirstName string    `gorm:\"not null\"`\n    LastName  string    `gorm:\"not null\"`\n\n    Company   Company   `gorm:\"not null\"`\n\n    Role      string    `gorm:\"not null;default:user\"`\n}\n\ntype BlogPost struct {\n    gorm.Model\n\n    Title     string    `gorm:\"not null\"`\n    Slug      string    `gorm:\"unique;not null;index\"`\n    Intro     string    `gorm:\"not null\"`\n    Text      string    `gorm:\"not null\"`\n    Category  string    `gorm:\"not null\"`\n    PictureUrl string   `gorm:\"not null\"`\n    Author    User      `gorm:\"not null\"`\n    AuthorID  uint      `gorm:\"not null\"`\n}\n</code></pre>\n\n<p>My code currenty looks like this:</p>\n\n<pre><code>func (hh *BlogIndexHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    // set desired language\n    language.SetLanguage(r)\n\n    // set title\n    hh.data.Title = fmt.Sprintf(\n        \"%s - %s\",\n        language.Translate(\"blog\", nil, false),\n        language.Translate(\"product\", nil, false),\n    )\n\n    // get current page\n    hh.data.Page = 0\n    if intPage, err := strconv.Atoi(r.URL.Query().Get(pageQueryName)); err != nil &amp;&amp; intPage &gt;= 0 {\n        hh.data.Page = intPage\n    }\n\n    // get max page number\n    hh.data.MaxPage = 1\n    var totalPosts int\n    if err := hh.database.Model(&amp;models.BlogPost{}).Count(&amp;totalPosts).Error; err != nil {\n        totalPosts = 1\n    } else {\n        hh.data.MaxPage = roundUp(float64(totalPosts / PostsPerPage))\n    }\n\n    // if page &gt; maxPage, set it right\n    if hh.data.Page &gt; hh.data.MaxPage {\n        hh.data.Page = hh.data.MaxPage\n    }\n\n    // fetch blog posts\n    if err := hh.database.\n        Preload(\"Author\").\n        Order(\"created_at DESC\").\n        Offset(PostsPerPage * hh.data.Page).\n        Limit(PostsPerPage).\n        Find(&amp;hh.data.Posts).\n        Error; err != nil {\n\n        log.Errorf(appengine.NewContext(r), \"could not get posts: %v\", err)\n    }\n\n    // set cacheable\n    system.SetCacheable(w, system.CacheTime1Day)\n\n    // send webpage\n    hh.template.Render(\"blog/index\", w, hh.data)\n}\n</code></pre>\n\n<p>However, a request fires 3 different queries:</p>\n\n<pre><code>[2019-03-11 19:51:52]  [29.55ms]  SELECT count(*) FROM \"blog_posts\"  WHERE \"blog_posts\".\"deleted_at\" IS NULL\n[0 rows affected or returned ]\n\n[2019-03-11 19:51:52]  [27.50ms]  SELECT * FROM \"blog_posts\"  WHERE \"blog_posts\".\"deleted_at\" IS NULL ORDER BY created_at DESC LIMIT 9 OFFSET 0\n[1 rows affected or returned ]\n\n[2019-03-11 19:51:52]  [49.86ms]  SELECT * FROM \"users\"  WHERE \"users\".\"deleted_at\" IS NULL AND ((\"id\" IN ('58')))\n</code></pre>\n\n<p>Is there a way to merge these with GORM?\nI'd like to optimize these, like I would with a manual query.</p>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552327782, "post_id": 55107908, "comment_id": 96958832, "body": "What do you mean &quot;it only works when the team doesn&#39;t exist&quot;?  What happens when it does exist? What exactly is the observed behavior?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1552327804, "post_id": 55107908, "comment_id": 96958848, "body": "You probably need to use <code>*TeamRow</code> rather than <code>TeamRow</code>."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1552327957, "post_id": 55107908, "comment_id": 96958918, "body": "Use *TeamRow as suggested in previous comment or assign the value back to the map.  See <a href=\"https://stackoverflow.com/questions/32751537/why-do-i-get-a-cannot-assign-error-when-setting-value-to-a-struct-as-a-value-i\">Why do I get a \u201ccannot assign\u201d error when setting value to a struct as a value in a map?</a>, <a href=\"https://stackoverflow.com/questions/17438253/access-struct-in-map-without-copying\">Access Struct in Map (without copying)</a>, ..."}, {"owner": {"reputation": 1, "user_id": 11186729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38cdde6708d9182131bd3653b778bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/11186729/tim"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552328583, "post_id": 55107908, "comment_id": 96959172, "body": "@Flimzy The values don&#39;t get updated is what is observed.  The object keeps the same property values it was assigned when it was first created."}, {"owner": {"reputation": 1, "user_id": 11186729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38cdde6708d9182131bd3653b778bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/11186729/tim"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1552329469, "post_id": 55107908, "comment_id": 96959566, "body": "@ThunderCat Thank you for the link, that made a lot of sense."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11186729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38cdde6708d9182131bd3653b778bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/11186729/tim"}, "edited": false, "score": 0, "creation_date": 1552329490, "post_id": 55107962, "comment_id": 96959575, "body": "Thank you for this!"}], "tags": [], "owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "is_accepted": true, "score": 0, "last_activity_date": 1552327955, "creation_date": 1552327955, "answer_id": 55107962, "question_id": 55107908, "link": "https://stackoverflow.com/questions/55107908/how-to-update-a-struct-property-in-a-map/55107962#55107962", "title": "How to update a struct property in a map", "body": "<p>You have a map of <code>string</code> to the value of <code>TeamRow</code> so when you get the <code>val</code> out of the map it returns the value of the team, not a pointer to the team.  If you make the map a string to the pointer of <code>TeamRow</code> then when you get the val out it will point to the memory that is stored in the map so values will persist beyond the scope of your <code>AddLoss</code> function.  To do this simply add a <code>*</code> to the map declaration - <code>teamMap map[string]*TeamRow</code> though when you populate it you will then also need to store pointers in the map.</p>\n"}], "owner": {"reputation": 1, "user_id": 11186729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38cdde6708d9182131bd3653b778bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/11186729/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "closed_date": 1552329070, "accepted_answer_id": 55107962, "answer_count": 1, "score": -2, "last_activity_date": 1552327955, "creation_date": 1552327705, "question_id": 55107908, "link": "https://stackoverflow.com/questions/55107908/how-to-update-a-struct-property-in-a-map", "closed_reason": "Duplicate", "title": "How to update a struct property in a map", "body": "<p>Currently trying to learn Go.</p>\n\n<p>I have the following function, but it only works when the team doesn't exist in the map already and it creates a new record in the map.  It will not update the values if the team already has a struct in the map.</p>\n\n<pre><code>func AddLoss(teamMap map[string]TeamRow, teamName string) {\n    if val, ok := teamMap[teamName]; ok {\n        val.Wins++\n        val.GamesPlayed++\n    } else {\n        newTeamRow := TeamRow{Losses: 1}\n\n        teamMap[teamName] = newTeamRow\n    }\n}\n</code></pre>\n\n<p>I have updated the function to just replace the existing record with a brand new struct with the values I want, but that seems odd that I can't update the values in a map.</p>\n\n<p>Can someone explain this to me, or point me in the right direction?</p>\n"}, {"tags": ["oracle", "docker", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552326307, "post_id": 55107459, "comment_id": 96958159, "body": "Try the <code>-insecure</code> flag for that import. <a href=\"https://golang.org/cmd/go/#hdr-Download_and_install_packages_and_dependencies\" rel=\"nofollow noreferrer\">more info</a>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552326523, "post_id": 55107459, "comment_id": 96958264, "body": "Also read up on <a href=\"https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies\" rel=\"nofollow noreferrer\">go build</a>, specifically the section on the <code>-o</code> flag. I believe you&#39;re using it wrong."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552326664, "post_id": 55107459, "comment_id": 96958349, "body": "@mkopriva you mean use <code>go get -insecure gopkg.in&#47;goracle.v2</code>? I tried it. Unfortunatly the result was the same. What exatly in <code>go build</code> command is wrong for your opinion?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1552327100, "post_id": 55107459, "comment_id": 96958545, "body": "Why are you using <code>&#47;bin</code> as the output file? I&#39;ve commented on your previous question that that can&#39;t possibly be a good choice. Just look at the error output, the docker container is using <code>&#47;bin&#47;sh</code> to run the commands in the dockerfile. If you overwrite that folder with your binary, what do you expect to happen?"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552327646, "post_id": 55107459, "comment_id": 96958769, "body": "I shall take full account of your last comment. I will change it to <code>RUN go build -o &quot;app&quot;</code>. It steal unclear to me with <code>gopkg.in</code>. Do you have any ideas about that?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552328159, "post_id": 55107459, "comment_id": 96959005, "body": "When you use the <code>-insecure</code> flag, are you getting the same exact error? Is it still saying <code>... proxyconnect tcp: tls: first record does not look like a TLS handshake</code>?"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552328327, "post_id": 55107459, "comment_id": 96959082, "body": "Yes, you are right. I add <code>-insecure</code> flag as you adviced. Finally I used this: <code>go get -insecure gopkg.in&#47;goracle.v2</code>. The error message was the same."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552328817, "post_id": 55107459, "comment_id": 96959277, "body": "If <code>-insecure</code> doesn&#39;t work then I don&#39;t know how else to fix that. However you could work around the issue by vendoring your dependencies. There are multiple 3rd party solutions for how to do this, and there&#39;s also Go&#39;s own module system that should work."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552359840, "post_id": 55107459, "comment_id": 96969285, "body": "Do you know any other packages which I can use to connect Golang application to Oracle database?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552367511, "post_id": 55107459, "comment_id": 96970986, "body": "I&#39;m afraid not, I&#39;ve never used oracle."}, {"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "edited": false, "score": 0, "creation_date": 1552418659, "post_id": 55107459, "comment_id": 97000077, "body": "For generic troubleshooting with building docker images, I like to use commands like <code>docker run --rm -it golang:1.12 &#47;bin&#47;sh</code>. Unfortunately when I do that and immediately <code>go get -v gopkg.in&#47;goracle.v2</code>, I don&#39;t observe any errors. You could try running the same commands on your own machine, though, in case that yields some more information (I don&#39;t want to assume it&#39;s an obscure DNS thing, but it might be an obscure DNS thing)."}], "answers": [{"tags": [], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "is_accepted": true, "score": 0, "last_activity_date": 1552497528, "creation_date": 1552497528, "answer_id": 55147787, "question_id": 55107459, "link": "https://stackoverflow.com/questions/55107459/is-it-possible-to-install-gopkg-in-packages-in-docker/55147787#55147787", "title": "Is it possible to install gopkg.in packages in Docker?", "body": "<p>In my case the <code>CentOS</code> server where was located <code>Docker</code> has proxy. For thats why I couldn't download the <code>gopkg.in/goracle.v2</code> package.</p>\n\n<p><strong>SOLUTION</strong>:</p>\n\n<p>1) Create <code>vender</code> folder inside your project.</p>\n\n<p>2) Remove source code of <code>gopkg.in/goracle.v2</code> package which you has in <code>go/src</code> folder to <code>vender</code> folder.</p>\n\n<p>3) Run you Dockerfile.</p>\n\n<p>In my case this instruction removed problem with importing of <code>gopkg.in/goracle.v2</code> \n package.</p>\n\n<p>I hope this post will helpful for somebody!</p>\n"}], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 55147787, "answer_count": 1, "score": 0, "last_activity_date": 1552497528, "creation_date": 1552325880, "question_id": 55107459, "link": "https://stackoverflow.com/questions/55107459/is-it-possible-to-install-gopkg-in-packages-in-docker", "title": "Is it possible to install gopkg.in packages in Docker?", "body": "<p>I am trying to run golang application which use <a href=\"https://github.com/go-goracle/goracle\" rel=\"nofollow noreferrer\">goracle</a> library with such Dockerfile:</p>\n\n<pre><code>FROM golang:1.12\n\nRUN go get github.com/gorilla/mux &amp;&amp; \\\n  go get github.com/gorilla/handlers &amp;&amp; \\\n  go get github.com/lib/pq &amp;&amp; \\\n  go get github.com/joho/godotenv &amp;&amp; \\\n  go get github.com/jinzhu/gorm &amp;&amp; \\\n  go get gopkg.in/goracle.v2\n\nADD ./ /go/src/application\n\nWORKDIR /go/src/application\n\nRUN go build -o /bin application\n\nENV PORT=8000\n\nCMD [\"/bin\"]\n</code></pre>\n\n<p>Unfortunatly it raise error when I try to create image:</p>\n\n<pre><code>package gopkg.in/goracle.v2: unrecognized import path \"gopkg.in/goracle.v2\" (https fetch: Get https://gopkg.in/goracle.v2?go-get=1: proxyconnect tcp: tls: first record does not look like a TLS handshake)\nThe command '/bin/sh -c go get github.com/gorilla/mux &amp;&amp;   go get github.com/gorilla/handlers &amp;&amp;   go get github.com/lib/pq &amp;&amp;   go get github.com/joho/godotenv &amp;&amp;   go get github.com/jinzhu/gorm &amp;&amp;   go get gopkg.in/goracle.v2' returned a non-zero code: 1\n</code></pre>\n\n<p>Why I can't install goracle library in Docker? How to fix this problem?</p>\n"}, {"tags": ["multithreading", "go"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1552321871, "post_id": 55106348, "comment_id": 96955720, "body": "are you sure it is recovered properly? the output states: RECOVERY Failed"}, {"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1552321914, "post_id": 55106348, "comment_id": 96955742, "body": "That&#39;s just my log prints in the code. Let me modify that"}, {"owner": {"reputation": 961, "user_id": 1775688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2f0b.png?s=128&g=1", "display_name": "Jota Santos", "link": "https://stackoverflow.com/users/1775688/jota-santos"}, "edited": false, "score": 0, "creation_date": 1552323106, "post_id": 55106348, "comment_id": 96956436, "body": "@user2883071 Hi! I think that is because when you panic inside a function it will leave that function. The <code>recover()</code> don&#39;t prevent your function from crashing. It recover the &quot;thing&quot; used to be panicked, in your case the string &quot;TEST&quot;. That is why it <code>r != nil</code>.  Here you can find more information about it <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">blog.golang.org/defer-panic-and-recover</a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1552323139, "post_id": 55106348, "comment_id": 96956451, "body": "You don&#39;t &quot;return&quot; a worker to the pool, because this pattern doesn&#39;t remove them from the pool. They just consume values and operate on them. If you want your worker to continue &quot;working&quot;, don&#39;t have it return."}, {"owner": {"reputation": 961, "user_id": 1775688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2f0b.png?s=128&g=1", "display_name": "Jota Santos", "link": "https://stackoverflow.com/users/1775688/jota-santos"}, "edited": false, "score": 1, "creation_date": 1552323151, "post_id": 55106348, "comment_id": 96956467, "body": "@user2883071 another thing, <code>defer</code> is executed when the execution exits the function. So <code>defer</code> inside of a loop is a bad smell."}, {"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "reply_to_user": {"reputation": 961, "user_id": 1775688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2f0b.png?s=128&g=1", "display_name": "Jota Santos", "link": "https://stackoverflow.com/users/1775688/jota-santos"}, "edited": false, "score": 0, "creation_date": 1552324568, "post_id": 55106348, "comment_id": 96957254, "body": "@JamilloSantos @jimB so if shouldn&#39;t return, and I shouldn&#39;t panic, how do I ensure the worker keeps working (on other inputs from the channel) if it encounters an error for the current input? (I tried taking out the <code>panics</code> and instead push something to the channel and have a blank <code>return</code>, but that kills the worker too)"}, {"owner": {"reputation": 2267, "user_id": 2639647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc746964582ffff4760c1e7493c13189?s=128&d=identicon&r=PG", "display_name": "Travis Hegner", "link": "https://stackoverflow.com/users/2639647/travis-hegner"}, "edited": false, "score": 1, "creation_date": 1552325391, "post_id": 55106348, "comment_id": 96957713, "body": "You could have an <code>errors</code> channel passed into the worker functions, and if they encounter an error, send it down the channel and then <code>continue</code>. Or, if you don&#39;t care about the error, simply <code>continue</code> to skip that <code>job</code>."}, {"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 0, "creation_date": 1552326061, "post_id": 55106348, "comment_id": 96958030, "body": "if I add a <code>continue</code> in my <code>if err != nil</code> instead of a panic, will it pass by the error only, or escape from the function itself (and work on the other jobs in the queue. I guess my question is what level of escape does continue provide? (error <code>if</code> statement level or function level) - Testing it right now"}, {"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "reply_to_user": {"reputation": 2267, "user_id": 2639647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc746964582ffff4760c1e7493c13189?s=128&d=identicon&r=PG", "display_name": "Travis Hegner", "link": "https://stackoverflow.com/users/2639647/travis-hegner"}, "edited": false, "score": 0, "creation_date": 1552326534, "post_id": 55106348, "comment_id": 96958271, "body": "@TravisHegner It seems like the continue passes the job and moves to the next (from my limited testing). This seems to be a good enough fix, Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 2267, "user_id": 2639647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc746964582ffff4760c1e7493c13189?s=128&d=identicon&r=PG", "display_name": "Travis Hegner", "link": "https://stackoverflow.com/users/2639647/travis-hegner"}, "is_accepted": true, "score": 2, "last_activity_date": 1552326766, "creation_date": 1552326766, "answer_id": 55107675, "question_id": 55106348, "link": "https://stackoverflow.com/questions/55106348/how-do-i-return-a-worker-back-to-the-worker-pool-in-go/55107675#55107675", "title": "How do I return a worker back to the worker pool in Go", "body": "<p>If you care about the errors, you could have an <code>errors</code> channel passed into the worker functions, and if they encounter an <code>error</code>, send it down the channel and then <code>continue</code>. The main loop could process those errors.</p>\n\n<p>Or, if you don't care about the error, simply <code>continue</code> to skip that job.</p>\n\n<p>The <a href=\"https://golang.org/ref/spec#Continue_statements\" rel=\"nofollow noreferrer\"><code>continue</code></a> statement basically stops processing that iteration of the loop, and <em>continues</em> with the next.</p>\n"}], "owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 55107675, "answer_count": 1, "score": -1, "last_activity_date": 1552326766, "creation_date": 1552321765, "last_edit_date": 1552321977, "question_id": 55106348, "link": "https://stackoverflow.com/questions/55106348/how-do-i-return-a-worker-back-to-the-worker-pool-in-go", "title": "How do I return a worker back to the worker pool in Go", "body": "<p>I am implementing a worker pool which can take jobs from a channel. After it kept timing out, I realised that when a panic occurs within a worker fcn, even though I have implemented a recovery mechanism, the worker still does not return to the pool again. </p>\n\n<p>In the golang playground, I was able to replicate the issue:</p>\n\n<p><a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">Worker Pool Reference</a></p>\n\n<p>Modified code for play ground:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\nimport \"log\"\n\nfunc recovery(id int, results chan&lt;- int) {\n    if r := recover(); r != nil {\n        log.Print(\"IN RECOVERY FUNC - Failed worker: \",id)  \n        results &lt;- 0\n    }\n}\n\nfunc worker(id int, jobs &lt;-chan int, results chan&lt;- int) {\n    for j := range jobs {\n    defer recovery(id, results)\n    if id == 1 {\n        panic(\"TEST\")\n    }\n        fmt.Println(\"worker\", id, \"started job\", j)\n        time.Sleep(time.Second)\n        fmt.Println(\"worker\", id, \"finished job\", j)\n        results &lt;- j * 2\n    }\n}\n\nfunc main() {\n    jobs := make(chan int, 100)\n    results := make(chan int, 100)\n    for w := 1; w &lt;= 3; w++ {\n        go worker(w, jobs, results)\n    }\n    for j := 1; j &lt;= 10; j++ {\n        jobs &lt;- j\n    }\n    close(jobs)\n    for a := 1; a &lt;= 10; a++ {\n        &lt;-results\n    }\n}\n</code></pre>\n\n<p>For testing, I have implemented a panic when worker 1 is used. When run, the func panics as expected, and goes into recovery as expected (does not push a value into the channel either), however worker 1 never seems to come back.</p>\n\n<p>Output without panic:</p>\n\n<pre><code>worker 3 started job 1\nworker 1 started job 2\nworker 2 started job 3\nworker 1 finished job 2\nworker 1 started job 4\nworker 3 finished job 1\nworker 3 started job 5\nworker 2 finished job 3\nworker 2 started job 6\nworker 3 finished job 5\nworker 3 started job 7\nworker 1 finished job 4\nworker 1 started job 8\nworker 2 finished job 6\nworker 2 started job 9\nworker 1 finished job 8\nworker 1 started job 10\nworker 3 finished job 7\nworker 2 finished job 9\nworker 1 finished job 10\n</code></pre>\n\n<p>Output with panic:</p>\n\n<pre><code>worker 3 started job 1\n2009/11/10 23:00:00 RECOVERY Failed worker: 1\nworker 2 started job 3\nworker 2 finished job 3\nworker 2 started job 4\nworker 3 finished job 1\nworker 3 started job 5\nworker 3 finished job 5\nworker 3 started job 6\nworker 2 finished job 4\nworker 2 started job 7\nworker 2 finished job 7\nworker 2 started job 8\nworker 3 finished job 6\nworker 3 started job 9\nworker 3 finished job 9\nworker 3 started job 10\nworker 2 finished job 8\nworker 3 finished job 10\n</code></pre>\n\n<p>How do I return worker 1 back to the pool after recovery (or in the recovery process)</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 94, "user_id": 9571565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50a4fc82ff8eec7a1c9b35aacc046d2c?s=128&d=identicon&r=PG&f=1", "display_name": "shans", "link": "https://stackoverflow.com/users/9571565/shans"}, "edited": false, "score": 2, "creation_date": 1552323636, "post_id": 55106186, "comment_id": 96956757, "body": "Your copy command should be COPY /etc/passwd /etc/passwd, not COPY /etc_passwd /etc/passwd"}], "answers": [{"tags": [], "owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "is_accepted": true, "score": 14, "last_activity_date": 1552323976, "last_edit_date": 1552323976, "creation_date": 1552323638, "answer_id": 55106860, "question_id": 55106186, "link": "https://stackoverflow.com/questions/55106186/no-such-file-or-directory-with-docker-scratch-image/55106860#55106860", "title": "&quot;no such file or directory&quot; with docker scratch image", "body": "<p>Turn off CGO since that can result in dynamic links to libc/libmusl.</p>\n\n<pre><code>RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build \\\n    -ldflags=\"-w -s\" -o $PROJ_BIN_PATH ./cmd/...\n</code></pre>\n\n<p>The no such file or directory error with a binary indicates either you did not call your binary by the right name, or that your binary is dynamically linked to a library that does not exist.</p>\n\n<p>You can check for dynamic links with <code>ldd</code>, e.g.:</p>\n\n<pre><code>docker build --target=0 -t your_go_image .\ndocker run -it --rm your_go_image ldd /$PROJ_NAME\n</code></pre>\n\n<p>Here's an example with one of my own projects:</p>\n\n<pre><code>$ go build -o test .\n\n$ ldd test\n        linux-vdso.so.1 (0x00007ffd2ebd8000)\n        libpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f2dda9ed000)\n        libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f2dda64e000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007f2ddac0a000)\n\n$ CGO_ENABLED=0 go build -o test .                                                                                                     \n\n$ ldd test\n        not a dynamic executable\n</code></pre>\n"}], "owner": {"reputation": 3247, "user_id": 625521, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f75ea35d0ffa8468c61f1fb2347a8000?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/625521/jonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2241, "favorite_count": 1, "accepted_answer_id": 55106860, "answer_count": 1, "score": 8, "last_activity_date": 1552323976, "creation_date": 1552321172, "last_edit_date": 1552321928, "question_id": 55106186, "link": "https://stackoverflow.com/questions/55106186/no-such-file-or-directory-with-docker-scratch-image", "title": "&quot;no such file or directory&quot; with docker scratch image", "body": "<p>Getting an error:</p>\n\n<p><code>standard_init_linux.go:207: exec user process caused \"no such file or directory\"</code></p>\n\n<p>this error disappear when using <code>alpine</code> image.</p>\n\n<p>this is my Dockerfile:</p>\n\n<pre><code>ARG PROJ_NS=gitlab.com/jonas.jasas\nARG PROJ_NAME=httprelay\nARG PROJ_BIN_PATH=/$PROJ_NAME\n\n################################################################################\nFROM golang:alpine\nRUN apk update &amp;&amp; apk add --no-cache git\n\nARG PROJ_NS\nARG PROJ_NAME\nARG PROJ_BIN_PATH\n\nRUN go get -d $PROJ_NS/$PROJ_NAME/...\nWORKDIR $GOPATH/src/$PROJ_NS/$PROJ_NAME\nRUN go get -d ./cmd/...\nRUN GOOS=linux GOARCH=amd64 go build -ldflags=\"-w -s\" -o $PROJ_BIN_PATH ./cmd/...\n\nRUN echo \"nobody:x:65534:65534:Nobody:/:\" &gt; /etc_passwd\n\n################################################################################\n#FROM alpine\nFROM scratch\n\nARG PROJ_BIN_PATH\n\nCOPY --from=0 /etc_passwd /etc/passwd\nCOPY --from=0 $PROJ_BIN_PATH /entrypoint\n\nUSER nobody\n\nEXPOSE 8800\nENTRYPOINT [\"/entrypoint\"]\n</code></pre>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-sql"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1552331904, "post_id": 55106146, "comment_id": 96960678, "body": "<a href=\"https://cloud.google.com/go/getting-started/using-cloud-sql\" rel=\"nofollow noreferrer\">cloud.google.com/go/getting-started/using-cloud-sql</a>"}], "answers": [{"tags": [], "owner": {"reputation": 324, "user_id": 5863179, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-guT2ENL47Lc/AAAAAAAAAAI/AAAAAAAADV8/UJ0eQGEz1tQ/photo.jpg?sz=128", "display_name": "Anthony Metzidis", "link": "https://stackoverflow.com/users/5863179/anthony-metzidis"}, "is_accepted": false, "score": 1, "last_activity_date": 1552333858, "creation_date": 1552333858, "answer_id": 55109342, "question_id": 55106146, "link": "https://stackoverflow.com/questions/55106146/golang-sdk-for-google-cloud-sql/55109342#55109342", "title": "GoLang SDK for Google cloud SQL", "body": "<p><a href=\"https://godoc.org/google.golang.org/api/sqladmin/v1beta4\" rel=\"nofollow noreferrer\">Here is the complete api</a>-- it's beta but fairly complete</p>\n\n<pre><code>\ntype AclEntry\nfunc (s *AclEntry) MarshalJSON() ([]byte, error)\ntype ApiWarning\nfunc (s *ApiWarning) MarshalJSON() ([]byte, error)\ntype BackupConfiguration\nfunc (s *BackupConfiguration) MarshalJSON() ([]byte, error)\ntype BackupRun\nfunc (s *BackupRun) MarshalJSON() ([]byte, error)\ntype BackupRunsDeleteCall\nfunc (c *BackupRunsDeleteCall) Context(ctx context.Context) *BackupRunsDeleteCall\nfunc (c *BackupRunsDeleteCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *BackupRunsDeleteCall) Fields(s ...googleapi.Field) *BackupRunsDeleteCall\nfunc (c *BackupRunsDeleteCall) Header() http.Header\ntype BackupRunsGetCall\nfunc (c *BackupRunsGetCall) Context(ctx context.Context) *BackupRunsGetCall\nfunc (c *BackupRunsGetCall) Do(opts ...googleapi.CallOption) (*BackupRun, error)\nfunc (c *BackupRunsGetCall) Fields(s ...googleapi.Field) *BackupRunsGetCall\nfunc (c *BackupRunsGetCall) Header() http.Header\nfunc (c *BackupRunsGetCall) IfNoneMatch(entityTag string) *BackupRunsGetCall\ntype BackupRunsInsertCall\nfunc (c *BackupRunsInsertCall) Context(ctx context.Context) *BackupRunsInsertCall\nfunc (c *BackupRunsInsertCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *BackupRunsInsertCall) Fields(s ...googleapi.Field) *BackupRunsInsertCall\nfunc (c *BackupRunsInsertCall) Header() http.Header\ntype BackupRunsListCall\nfunc (c *BackupRunsListCall) Context(ctx context.Context) *BackupRunsListCall\nfunc (c *BackupRunsListCall) Do(opts ...googleapi.CallOption) (*BackupRunsListResponse, error)\nfunc (c *BackupRunsListCall) Fields(s ...googleapi.Field) *BackupRunsListCall\nfunc (c *BackupRunsListCall) Header() http.Header\nfunc (c *BackupRunsListCall) IfNoneMatch(entityTag string) *BackupRunsListCall\nfunc (c *BackupRunsListCall) MaxResults(maxResults int64) *BackupRunsListCall\nfunc (c *BackupRunsListCall) PageToken(pageToken string) *BackupRunsListCall\nfunc (c *BackupRunsListCall) Pages(ctx context.Context, f func(*BackupRunsListResponse) error) error\ntype BackupRunsListResponse\nfunc (s *BackupRunsListResponse) MarshalJSON() ([]byte, error)\ntype BackupRunsService\nfunc NewBackupRunsService(s *Service) *BackupRunsService\nfunc (r *BackupRunsService) Delete(project string, instance string, id int64) *BackupRunsDeleteCall\nfunc (r *BackupRunsService) Get(project string, instance string, id int64) *BackupRunsGetCall\nfunc (r *BackupRunsService) Insert(project string, instance string, backuprun *BackupRun) *BackupRunsInsertCall\nfunc (r *BackupRunsService) List(project string, instance string) *BackupRunsListCall\ntype BinLogCoordinates\nfunc (s *BinLogCoordinates) MarshalJSON() ([]byte, error)\ntype CloneContext\nfunc (s *CloneContext) MarshalJSON() ([]byte, error)\ntype Database\nfunc (s *Database) MarshalJSON() ([]byte, error)\ntype DatabaseFlags\nfunc (s *DatabaseFlags) MarshalJSON() ([]byte, error)\ntype DatabaseInstance\nfunc (s *DatabaseInstance) MarshalJSON() ([]byte, error)\ntype DatabaseInstanceFailoverReplica\nfunc (s *DatabaseInstanceFailoverReplica) MarshalJSON() ([]byte, error)\ntype DatabasesDeleteCall\nfunc (c *DatabasesDeleteCall) Context(ctx context.Context) *DatabasesDeleteCall\nfunc (c *DatabasesDeleteCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *DatabasesDeleteCall) Fields(s ...googleapi.Field) *DatabasesDeleteCall\nfunc (c *DatabasesDeleteCall) Header() http.Header\ntype DatabasesGetCall\nfunc (c *DatabasesGetCall) Context(ctx context.Context) *DatabasesGetCall\nfunc (c *DatabasesGetCall) Do(opts ...googleapi.CallOption) (*Database, error)\nfunc (c *DatabasesGetCall) Fields(s ...googleapi.Field) *DatabasesGetCall\nfunc (c *DatabasesGetCall) Header() http.Header\nfunc (c *DatabasesGetCall) IfNoneMatch(entityTag string) *DatabasesGetCall\ntype DatabasesInsertCall\nfunc (c *DatabasesInsertCall) Context(ctx context.Context) *DatabasesInsertCall\nfunc (c *DatabasesInsertCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *DatabasesInsertCall) Fields(s ...googleapi.Field) *DatabasesInsertCall\nfunc (c *DatabasesInsertCall) Header() http.Header\ntype DatabasesListCall\nfunc (c *DatabasesListCall) Context(ctx context.Context) *DatabasesListCall\nfunc (c *DatabasesListCall) Do(opts ...googleapi.CallOption) (*DatabasesListResponse, error)\nfunc (c *DatabasesListCall) Fields(s ...googleapi.Field) *DatabasesListCall\nfunc (c *DatabasesListCall) Header() http.Header\nfunc (c *DatabasesListCall) IfNoneMatch(entityTag string) *DatabasesListCall\ntype DatabasesListResponse\nfunc (s *DatabasesListResponse) MarshalJSON() ([]byte, error)\ntype DatabasesPatchCall\nfunc (c *DatabasesPatchCall) Context(ctx context.Context) *DatabasesPatchCall\nfunc (c *DatabasesPatchCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *DatabasesPatchCall) Fields(s ...googleapi.Field) *DatabasesPatchCall\nfunc (c *DatabasesPatchCall) Header() http.Header\ntype DatabasesService\nfunc NewDatabasesService(s *Service) *DatabasesService\nfunc (r *DatabasesService) Delete(project string, instance string, database string) *DatabasesDeleteCall\nfunc (r *DatabasesService) Get(project string, instance string, database string) *DatabasesGetCall\nfunc (r *DatabasesService) Insert(project string, instance string, database *Database) *DatabasesInsertCall\nfunc (r *DatabasesService) List(project string, instance string) *DatabasesListCall\nfunc (r *DatabasesService) Patch(project string, instance string, database string, database2 *Database) *DatabasesPatchCall\nfunc (r *DatabasesService) Update(project string, instance string, database string, database2 *Database) *DatabasesUpdateCall\ntype DatabasesUpdateCall\nfunc (c *DatabasesUpdateCall) Context(ctx context.Context) *DatabasesUpdateCall\nfunc (c *DatabasesUpdateCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *DatabasesUpdateCall) Fields(s ...googleapi.Field) *DatabasesUpdateCall\nfunc (c *DatabasesUpdateCall) Header() http.Header\ntype DemoteMasterConfiguration\nfunc (s *DemoteMasterConfiguration) MarshalJSON() ([]byte, error)\ntype DemoteMasterContext\nfunc (s *DemoteMasterContext) MarshalJSON() ([]byte, error)\ntype DemoteMasterMySqlReplicaConfiguration\nfunc (s *DemoteMasterMySqlReplicaConfiguration) MarshalJSON() ([]byte, error)\ntype ExportContext\nfunc (s *ExportContext) MarshalJSON() ([]byte, error)\ntype ExportContextCsvExportOptions\nfunc (s *ExportContextCsvExportOptions) MarshalJSON() ([]byte, error)\ntype ExportContextSqlExportOptions\nfunc (s *ExportContextSqlExportOptions) MarshalJSON() ([]byte, error)\ntype ExportContextSqlExportOptionsMysqlExportOptions\nfunc (s *ExportContextSqlExportOptionsMysqlExportOptions) MarshalJSON() ([]byte, error)\ntype FailoverContext\nfunc (s *FailoverContext) MarshalJSON() ([]byte, error)\ntype Flag\nfunc (s *Flag) MarshalJSON() ([]byte, error)\ntype FlagsListCall\nfunc (c *FlagsListCall) Context(ctx context.Context) *FlagsListCall\nfunc (c *FlagsListCall) DatabaseVersion(databaseVersion string) *FlagsListCall\nfunc (c *FlagsListCall) Do(opts ...googleapi.CallOption) (*FlagsListResponse, error)\nfunc (c *FlagsListCall) Fields(s ...googleapi.Field) *FlagsListCall\nfunc (c *FlagsListCall) Header() http.Header\nfunc (c *FlagsListCall) IfNoneMatch(entityTag string) *FlagsListCall\ntype FlagsListResponse\nfunc (s *FlagsListResponse) MarshalJSON() ([]byte, error)\ntype FlagsService\nfunc NewFlagsService(s *Service) *FlagsService\nfunc (r *FlagsService) List() *FlagsListCall\ntype ImportContext\nfunc (s *ImportContext) MarshalJSON() ([]byte, error)\ntype ImportContextCsvImportOptions\nfunc (s *ImportContextCsvImportOptions) MarshalJSON() ([]byte, error)\ntype InstancesAddServerCaCall\nfunc (c *InstancesAddServerCaCall) Context(ctx context.Context) *InstancesAddServerCaCall\nfunc (c *InstancesAddServerCaCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesAddServerCaCall) Fields(s ...googleapi.Field) *InstancesAddServerCaCall\nfunc (c *InstancesAddServerCaCall) Header() http.Header\ntype InstancesCloneCall\nfunc (c *InstancesCloneCall) Context(ctx context.Context) *InstancesCloneCall\nfunc (c *InstancesCloneCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesCloneCall) Fields(s ...googleapi.Field) *InstancesCloneCall\nfunc (c *InstancesCloneCall) Header() http.Header\ntype InstancesCloneRequest\nfunc (s *InstancesCloneRequest) MarshalJSON() ([]byte, error)\ntype InstancesDeleteCall\nfunc (c *InstancesDeleteCall) Context(ctx context.Context) *InstancesDeleteCall\nfunc (c *InstancesDeleteCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesDeleteCall) Fields(s ...googleapi.Field) *InstancesDeleteCall\nfunc (c *InstancesDeleteCall) Header() http.Header\ntype InstancesDemoteMasterCall\nfunc (c *InstancesDemoteMasterCall) Context(ctx context.Context) *InstancesDemoteMasterCall\nfunc (c *InstancesDemoteMasterCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesDemoteMasterCall) Fields(s ...googleapi.Field) *InstancesDemoteMasterCall\nfunc (c *InstancesDemoteMasterCall) Header() http.Header\ntype InstancesDemoteMasterRequest\nfunc (s *InstancesDemoteMasterRequest) MarshalJSON() ([]byte, error)\ntype InstancesExportCall\nfunc (c *InstancesExportCall) Context(ctx context.Context) *InstancesExportCall\nfunc (c *InstancesExportCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesExportCall) Fields(s ...googleapi.Field) *InstancesExportCall\nfunc (c *InstancesExportCall) Header() http.Header\ntype InstancesExportRequest\nfunc (s *InstancesExportRequest) MarshalJSON() ([]byte, error)\ntype InstancesFailoverCall\nfunc (c *InstancesFailoverCall) Context(ctx context.Context) *InstancesFailoverCall\nfunc (c *InstancesFailoverCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesFailoverCall) Fields(s ...googleapi.Field) *InstancesFailoverCall\nfunc (c *InstancesFailoverCall) Header() http.Header\ntype InstancesFailoverRequest\nfunc (s *InstancesFailoverRequest) MarshalJSON() ([]byte, error)\ntype InstancesGetCall\nfunc (c *InstancesGetCall) Context(ctx context.Context) *InstancesGetCall\nfunc (c *InstancesGetCall) Do(opts ...googleapi.CallOption) (*DatabaseInstance, error)\nfunc (c *InstancesGetCall) Fields(s ...googleapi.Field) *InstancesGetCall\nfunc (c *InstancesGetCall) Header() http.Header\nfunc (c *InstancesGetCall) IfNoneMatch(entityTag string) *InstancesGetCall\ntype InstancesImportCall\nfunc (c *InstancesImportCall) Context(ctx context.Context) *InstancesImportCall\nfunc (c *InstancesImportCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesImportCall) Fields(s ...googleapi.Field) *InstancesImportCall\nfunc (c *InstancesImportCall) Header() http.Header\ntype InstancesImportRequest\nfunc (s *InstancesImportRequest) MarshalJSON() ([]byte, error)\ntype InstancesInsertCall\nfunc (c *InstancesInsertCall) Context(ctx context.Context) *InstancesInsertCall\nfunc (c *InstancesInsertCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesInsertCall) Fields(s ...googleapi.Field) *InstancesInsertCall\nfunc (c *InstancesInsertCall) Header() http.Header\ntype InstancesListCall\nfunc (c *InstancesListCall) Context(ctx context.Context) *InstancesListCall\nfunc (c *InstancesListCall) Do(opts ...googleapi.CallOption) (*InstancesListResponse, error)\nfunc (c *InstancesListCall) Fields(s ...googleapi.Field) *InstancesListCall\nfunc (c *InstancesListCall) Filter(filter string) *InstancesListCall\nfunc (c *InstancesListCall) Header() http.Header\nfunc (c *InstancesListCall) IfNoneMatch(entityTag string) *InstancesListCall\nfunc (c *InstancesListCall) MaxResults(maxResults int64) *InstancesListCall\nfunc (c *InstancesListCall) PageToken(pageToken string) *InstancesListCall\nfunc (c *InstancesListCall) Pages(ctx context.Context, f func(*InstancesListResponse) error) error\ntype InstancesListResponse\nfunc (s *InstancesListResponse) MarshalJSON() ([]byte, error)\ntype InstancesListServerCasCall\nfunc (c *InstancesListServerCasCall) Context(ctx context.Context) *InstancesListServerCasCall\nfunc (c *InstancesListServerCasCall) Do(opts ...googleapi.CallOption) (*InstancesListServerCasResponse, error)\nfunc (c *InstancesListServerCasCall) Fields(s ...googleapi.Field) *InstancesListServerCasCall\nfunc (c *InstancesListServerCasCall) Header() http.Header\nfunc (c *InstancesListServerCasCall) IfNoneMatch(entityTag string) *InstancesListServerCasCall\ntype InstancesListServerCasResponse\nfunc (s *InstancesListServerCasResponse) MarshalJSON() ([]byte, error)\ntype InstancesPatchCall\nfunc (c *InstancesPatchCall) Context(ctx context.Context) *InstancesPatchCall\nfunc (c *InstancesPatchCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesPatchCall) Fields(s ...googleapi.Field) *InstancesPatchCall\nfunc (c *InstancesPatchCall) Header() http.Header\ntype InstancesPromoteReplicaCall\nfunc (c *InstancesPromoteReplicaCall) Context(ctx context.Context) *InstancesPromoteReplicaCall\nfunc (c *InstancesPromoteReplicaCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesPromoteReplicaCall) Fields(s ...googleapi.Field) *InstancesPromoteReplicaCall\nfunc (c *InstancesPromoteReplicaCall) Header() http.Header\ntype InstancesResetSslConfigCall\nfunc (c *InstancesResetSslConfigCall) Context(ctx context.Context) *InstancesResetSslConfigCall\nfunc (c *InstancesResetSslConfigCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesResetSslConfigCall) Fields(s ...googleapi.Field) *InstancesResetSslConfigCall\nfunc (c *InstancesResetSslConfigCall) Header() http.Header\ntype InstancesRestartCall\nfunc (c *InstancesRestartCall) Context(ctx context.Context) *InstancesRestartCall\nfunc (c *InstancesRestartCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesRestartCall) Fields(s ...googleapi.Field) *InstancesRestartCall\nfunc (c *InstancesRestartCall) Header() http.Header\ntype InstancesRestoreBackupCall\nfunc (c *InstancesRestoreBackupCall) Context(ctx context.Context) *InstancesRestoreBackupCall\nfunc (c *InstancesRestoreBackupCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesRestoreBackupCall) Fields(s ...googleapi.Field) *InstancesRestoreBackupCall\nfunc (c *InstancesRestoreBackupCall) Header() http.Header\ntype InstancesRestoreBackupRequest\nfunc (s *InstancesRestoreBackupRequest) MarshalJSON() ([]byte, error)\ntype InstancesRotateServerCaCall\nfunc (c *InstancesRotateServerCaCall) Context(ctx context.Context) *InstancesRotateServerCaCall\nfunc (c *InstancesRotateServerCaCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesRotateServerCaCall) Fields(s ...googleapi.Field) *InstancesRotateServerCaCall\nfunc (c *InstancesRotateServerCaCall) Header() http.Header\ntype InstancesRotateServerCaRequest\nfunc (s *InstancesRotateServerCaRequest) MarshalJSON() ([]byte, error)\ntype InstancesService\nfunc NewInstancesService(s *Service) *InstancesService\nfunc (r *InstancesService) AddServerCa(project string, instance string) *InstancesAddServerCaCall\nfunc (r *InstancesService) Clone(project string, instance string, instancesclonerequest *InstancesCloneRequest) *InstancesCloneCall\nfunc (r *InstancesService) Delete(project string, instance string) *InstancesDeleteCall\nfunc (r *InstancesService) DemoteMaster(project string, instance string, instancesdemotemasterrequest *InstancesDemoteMasterRequest) *InstancesDemoteMasterCall\nfunc (r *InstancesService) Export(project string, instance string, instancesexportrequest *InstancesExportRequest) *InstancesExportCall\nfunc (r *InstancesService) Failover(project string, instance string, instancesfailoverrequest *InstancesFailoverRequest) *InstancesFailoverCall\nfunc (r *InstancesService) Get(project string, instance string) *InstancesGetCall\nfunc (r *InstancesService) Import(project string, instance string, instancesimportrequest *InstancesImportRequest) *InstancesImportCall\nfunc (r *InstancesService) Insert(project string, databaseinstance *DatabaseInstance) *InstancesInsertCall\nfunc (r *InstancesService) List(project string) *InstancesListCall\nfunc (r *InstancesService) ListServerCas(project string, instance string) *InstancesListServerCasCall\nfunc (r *InstancesService) Patch(project string, instance string, databaseinstance *DatabaseInstance) *InstancesPatchCall\nfunc (r *InstancesService) PromoteReplica(project string, instance string) *InstancesPromoteReplicaCall\nfunc (r *InstancesService) ResetSslConfig(project string, instance string) *InstancesResetSslConfigCall\nfunc (r *InstancesService) Restart(project string, instance string) *InstancesRestartCall\nfunc (r *InstancesService) RestoreBackup(project string, instance string, instancesrestorebackuprequest *InstancesRestoreBackupRequest) *InstancesRestoreBackupCall\nfunc (r *InstancesService) RotateServerCa(project string, instance string, instancesrotateservercarequest *InstancesRotateServerCaRequest) *InstancesRotateServerCaCall\nfunc (r *InstancesService) StartReplica(project string, instance string) *InstancesStartReplicaCall\nfunc (r *InstancesService) StopReplica(project string, instance string) *InstancesStopReplicaCall\nfunc (r *InstancesService) TruncateLog(project string, instance string, instancestruncatelogrequest *InstancesTruncateLogRequest) *InstancesTruncateLogCall\nfunc (r *InstancesService) Update(project string, instance string, databaseinstance *DatabaseInstance) *InstancesUpdateCall\ntype InstancesStartReplicaCall\nfunc (c *InstancesStartReplicaCall) Context(ctx context.Context) *InstancesStartReplicaCall\nfunc (c *InstancesStartReplicaCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesStartReplicaCall) Fields(s ...googleapi.Field) *InstancesStartReplicaCall\nfunc (c *InstancesStartReplicaCall) Header() http.Header\ntype InstancesStopReplicaCall\nfunc (c *InstancesStopReplicaCall) Context(ctx context.Context) *InstancesStopReplicaCall\nfunc (c *InstancesStopReplicaCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesStopReplicaCall) Fields(s ...googleapi.Field) *InstancesStopReplicaCall\nfunc (c *InstancesStopReplicaCall) Header() http.Header\ntype InstancesTruncateLogCall\nfunc (c *InstancesTruncateLogCall) Context(ctx context.Context) *InstancesTruncateLogCall\nfunc (c *InstancesTruncateLogCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesTruncateLogCall) Fields(s ...googleapi.Field) *InstancesTruncateLogCall\nfunc (c *InstancesTruncateLogCall) Header() http.Header\ntype InstancesTruncateLogRequest\nfunc (s *InstancesTruncateLogRequest) MarshalJSON() ([]byte, error)\ntype InstancesUpdateCall\nfunc (c *InstancesUpdateCall) Context(ctx context.Context) *InstancesUpdateCall\nfunc (c *InstancesUpdateCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *InstancesUpdateCall) Fields(s ...googleapi.Field) *InstancesUpdateCall\nfunc (c *InstancesUpdateCall) Header() http.Header\ntype IpConfiguration\nfunc (s *IpConfiguration) MarshalJSON() ([]byte, error)\ntype IpMapping\nfunc (s *IpMapping) MarshalJSON() ([]byte, error)\ntype LocationPreference\nfunc (s *LocationPreference) MarshalJSON() ([]byte, error)\ntype MaintenanceWindow\nfunc (s *MaintenanceWindow) MarshalJSON() ([]byte, error)\ntype MySqlReplicaConfiguration\nfunc (s *MySqlReplicaConfiguration) MarshalJSON() ([]byte, error)\ntype OnPremisesConfiguration\nfunc (s *OnPremisesConfiguration) MarshalJSON() ([]byte, error)\ntype Operation\nfunc (s *Operation) MarshalJSON() ([]byte, error)\ntype OperationError\nfunc (s *OperationError) MarshalJSON() ([]byte, error)\ntype OperationErrors\nfunc (s *OperationErrors) MarshalJSON() ([]byte, error)\ntype OperationsGetCall\nfunc (c *OperationsGetCall) Context(ctx context.Context) *OperationsGetCall\nfunc (c *OperationsGetCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *OperationsGetCall) Fields(s ...googleapi.Field) *OperationsGetCall\nfunc (c *OperationsGetCall) Header() http.Header\nfunc (c *OperationsGetCall) IfNoneMatch(entityTag string) *OperationsGetCall\ntype OperationsListCall\nfunc (c *OperationsListCall) Context(ctx context.Context) *OperationsListCall\nfunc (c *OperationsListCall) Do(opts ...googleapi.CallOption) (*OperationsListResponse, error)\nfunc (c *OperationsListCall) Fields(s ...googleapi.Field) *OperationsListCall\nfunc (c *OperationsListCall) Header() http.Header\nfunc (c *OperationsListCall) IfNoneMatch(entityTag string) *OperationsListCall\nfunc (c *OperationsListCall) MaxResults(maxResults int64) *OperationsListCall\nfunc (c *OperationsListCall) PageToken(pageToken string) *OperationsListCall\nfunc (c *OperationsListCall) Pages(ctx context.Context, f func(*OperationsListResponse) error) error\ntype OperationsListResponse\nfunc (s *OperationsListResponse) MarshalJSON() ([]byte, error)\ntype OperationsService\nfunc NewOperationsService(s *Service) *OperationsService\nfunc (r *OperationsService) Get(project string, operation string) *OperationsGetCall\nfunc (r *OperationsService) List(project string, instance string) *OperationsListCall\ntype ReplicaConfiguration\nfunc (s *ReplicaConfiguration) MarshalJSON() ([]byte, error)\ntype RestoreBackupContext\nfunc (s *RestoreBackupContext) MarshalJSON() ([]byte, error)\ntype RotateServerCaContext\nfunc (s *RotateServerCaContext) MarshalJSON() ([]byte, error)\ntype Service\nfunc New(client *http.Client) (*Service, error)\ntype Settings\nfunc (s *Settings) MarshalJSON() ([]byte, error)\ntype SslCert\nfunc (s *SslCert) MarshalJSON() ([]byte, error)\ntype SslCertDetail\nfunc (s *SslCertDetail) MarshalJSON() ([]byte, error)\ntype SslCertsCreateEphemeralCall\nfunc (c *SslCertsCreateEphemeralCall) Context(ctx context.Context) *SslCertsCreateEphemeralCall\nfunc (c *SslCertsCreateEphemeralCall) Do(opts ...googleapi.CallOption) (*SslCert, error)\nfunc (c *SslCertsCreateEphemeralCall) Fields(s ...googleapi.Field) *SslCertsCreateEphemeralCall\nfunc (c *SslCertsCreateEphemeralCall) Header() http.Header\ntype SslCertsCreateEphemeralRequest\nfunc (s *SslCertsCreateEphemeralRequest) MarshalJSON() ([]byte, error)\ntype SslCertsDeleteCall\nfunc (c *SslCertsDeleteCall) Context(ctx context.Context) *SslCertsDeleteCall\nfunc (c *SslCertsDeleteCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *SslCertsDeleteCall) Fields(s ...googleapi.Field) *SslCertsDeleteCall\nfunc (c *SslCertsDeleteCall) Header() http.Header\ntype SslCertsGetCall\nfunc (c *SslCertsGetCall) Context(ctx context.Context) *SslCertsGetCall\nfunc (c *SslCertsGetCall) Do(opts ...googleapi.CallOption) (*SslCert, error)\nfunc (c *SslCertsGetCall) Fields(s ...googleapi.Field) *SslCertsGetCall\nfunc (c *SslCertsGetCall) Header() http.Header\nfunc (c *SslCertsGetCall) IfNoneMatch(entityTag string) *SslCertsGetCall\ntype SslCertsInsertCall\nfunc (c *SslCertsInsertCall) Context(ctx context.Context) *SslCertsInsertCall\nfunc (c *SslCertsInsertCall) Do(opts ...googleapi.CallOption) (*SslCertsInsertResponse, error)\nfunc (c *SslCertsInsertCall) Fields(s ...googleapi.Field) *SslCertsInsertCall\nfunc (c *SslCertsInsertCall) Header() http.Header\ntype SslCertsInsertRequest\nfunc (s *SslCertsInsertRequest) MarshalJSON() ([]byte, error)\ntype SslCertsInsertResponse\nfunc (s *SslCertsInsertResponse) MarshalJSON() ([]byte, error)\ntype SslCertsListCall\nfunc (c *SslCertsListCall) Context(ctx context.Context) *SslCertsListCall\nfunc (c *SslCertsListCall) Do(opts ...googleapi.CallOption) (*SslCertsListResponse, error)\nfunc (c *SslCertsListCall) Fields(s ...googleapi.Field) *SslCertsListCall\nfunc (c *SslCertsListCall) Header() http.Header\nfunc (c *SslCertsListCall) IfNoneMatch(entityTag string) *SslCertsListCall\ntype SslCertsListResponse\nfunc (s *SslCertsListResponse) MarshalJSON() ([]byte, error)\ntype SslCertsService\nfunc NewSslCertsService(s *Service) *SslCertsService\nfunc (r *SslCertsService) CreateEphemeral(project string, instance string, sslcertscreateephemeralrequest *SslCertsCreateEphemeralRequest) *SslCertsCreateEphemeralCall\nfunc (r *SslCertsService) Delete(project string, instance string, sha1Fingerprint string) *SslCertsDeleteCall\nfunc (r *SslCertsService) Get(project string, instance string, sha1Fingerprint string) *SslCertsGetCall\nfunc (r *SslCertsService) Insert(project string, instance string, sslcertsinsertrequest *SslCertsInsertRequest) *SslCertsInsertCall\nfunc (r *SslCertsService) List(project string, instance string) *SslCertsListCall\ntype Tier\nfunc (s *Tier) MarshalJSON() ([]byte, error)\ntype TiersListCall\nfunc (c *TiersListCall) Context(ctx context.Context) *TiersListCall\nfunc (c *TiersListCall) Do(opts ...googleapi.CallOption) (*TiersListResponse, error)\nfunc (c *TiersListCall) Fields(s ...googleapi.Field) *TiersListCall\nfunc (c *TiersListCall) Header() http.Header\nfunc (c *TiersListCall) IfNoneMatch(entityTag string) *TiersListCall\ntype TiersListResponse\nfunc (s *TiersListResponse) MarshalJSON() ([]byte, error)\ntype TiersService\nfunc NewTiersService(s *Service) *TiersService\nfunc (r *TiersService) List(project string) *TiersListCall\ntype TruncateLogContext\nfunc (s *TruncateLogContext) MarshalJSON() ([]byte, error)\ntype User\nfunc (s *User) MarshalJSON() ([]byte, error)\ntype UsersDeleteCall\nfunc (c *UsersDeleteCall) Context(ctx context.Context) *UsersDeleteCall\nfunc (c *UsersDeleteCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *UsersDeleteCall) Fields(s ...googleapi.Field) *UsersDeleteCall\nfunc (c *UsersDeleteCall) Header() http.Header\ntype UsersInsertCall\nfunc (c *UsersInsertCall) Context(ctx context.Context) *UsersInsertCall\nfunc (c *UsersInsertCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *UsersInsertCall) Fields(s ...googleapi.Field) *UsersInsertCall\nfunc (c *UsersInsertCall) Header() http.Header\ntype UsersListCall\nfunc (c *UsersListCall) Context(ctx context.Context) *UsersListCall\nfunc (c *UsersListCall) Do(opts ...googleapi.CallOption) (*UsersListResponse, error)\nfunc (c *UsersListCall) Fields(s ...googleapi.Field) *UsersListCall\nfunc (c *UsersListCall) Header() http.Header\nfunc (c *UsersListCall) IfNoneMatch(entityTag string) *UsersListCall\ntype UsersListResponse\nfunc (s *UsersListResponse) MarshalJSON() ([]byte, error)\ntype UsersService\nfunc NewUsersService(s *Service) *UsersService\nfunc (r *UsersService) Delete(project string, instance string, host string, name string) *UsersDeleteCall\nfunc (r *UsersService) Insert(project string, instance string, user *User) *UsersInsertCall\nfunc (r *UsersService) List(project string, instance string) *UsersListCall\nfunc (r *UsersService) Update(project string, instance string, name string, user *User) *UsersUpdateCall\ntype UsersUpdateCall\nfunc (c *UsersUpdateCall) Context(ctx context.Context) *UsersUpdateCall\nfunc (c *UsersUpdateCall) Do(opts ...googleapi.CallOption) (*Operation, error)\nfunc (c *UsersUpdateCall) Fields(s ...googleapi.Field) *UsersUpdateCall\nfunc (c *UsersUpdateCall) Header() http.Header\nfunc (c *UsersUpdateCall) Host(host string) *UsersUpdateCall\n</code></pre>\n"}], "owner": {"reputation": 608, "user_id": 4823789, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/16701fdace0347de7dbf1c356d295e76?s=128&d=identicon&r=PG&f=1", "display_name": "ND003", "link": "https://stackoverflow.com/users/4823789/nd003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552333858, "creation_date": 1552321010, "question_id": 55106146, "link": "https://stackoverflow.com/questions/55106146/golang-sdk-for-google-cloud-sql", "title": "GoLang SDK for Google cloud SQL", "body": "<p>Is the GoLang client library for Google Cloud SQL fully functional? How to get started? I can only find listing database instances example:</p>\n\n<p><a href=\"https://cloud.google.com/sql/docs/postgres/admin-api/libraries\" rel=\"nofollow noreferrer\">https://cloud.google.com/sql/docs/postgres/admin-api/libraries</a></p>\n"}, {"tags": ["go", "go-templates", "go-html-template", "anonymous-struct"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1552320524, "post_id": 55105838, "comment_id": 96954911, "body": "No it&#39;s not possible."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1552320791, "post_id": 55105838, "comment_id": 96955106, "body": "Templates do not execute arbitrary Go code. They execute the template syntax, which is clearly documented in the template package. No syntax other than what is presented in the documentation is allowed."}, {"owner": {"reputation": 189, "user_id": 11139683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad9fdf6151cd46c17790b74f245abef?s=128&d=identicon&r=PG&f=1", "display_name": "mori", "link": "https://stackoverflow.com/users/11139683/mori"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552324087, "post_id": 55105838, "comment_id": 96956998, "body": "@Adrian if it&#39;s that clearly documented, why not share a quote or link to the specific section?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1552327133, "post_id": 55105838, "comment_id": 96958556, "body": "There is no quote or specific section. The template syntax is clearly defined here: <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\">golang.org/pkg/text/template</a> but, for obvious reasons, it does not enumerate everything it <i>doesn&#39;t</i> do. It describes everything it <i>does</i> do, and what you&#39;re trying to do in your question is not among those things."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 11139683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad9fdf6151cd46c17790b74f245abef?s=128&d=identicon&r=PG&f=1", "display_name": "mori", "link": "https://stackoverflow.com/users/11139683/mori"}, "edited": false, "score": 0, "creation_date": 1552383480, "post_id": 55116341, "comment_id": 96977979, "body": "Thanks for the detailed answer!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1552377226, "last_edit_date": 1552377226, "creation_date": 1552376476, "answer_id": 55116341, "question_id": 55105838, "link": "https://stackoverflow.com/questions/55105838/anonymous-struct-as-pipeline-in-template/55116341#55116341", "title": "Anonymous struct as pipeline in template", "body": "<p>As noted by others, it's not possible. Templates are parsed at runtime, without the help of the Go compiler. So allowing arbitrary Go syntax would not be feasible (although note that it wouldn't be impossible, as the standard lib contains all the tools to parse Go source text, see packages \"prefixed\" with <a href=\"https://golang.org/pkg/go/\" rel=\"nofollow noreferrer\"><code>go/</code></a> in the standard lib). By design philosophy, complex logic should be outside of templates.</p>\n\n<p>Back to your example:</p>\n\n<pre><code>struct{Foo1, Foo2 string}{\"Bar1\", \"Bar2\"}\n</code></pre>\n\n<p>This is a struct <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">composite literal</a> and it is not supported in templates, neither when invoking another template nor at other places.</p>\n\n<p>Invoking another template with a custom \"argument\" has the following syntax (quoting from <a href=\"https://golang.org/pkg/text/template/#hdr-Actions\" rel=\"nofollow noreferrer\"><code>text/template</code>: Actions</a>):</p>\n\n<pre><code>{{template \"name\" pipeline}}\n    The template with the specified name is executed with dot set\n    to the value of the pipeline.\n</code></pre>\n\n<p><strong>TL;DR;</strong> A pipeline may be a constant, an expression denoting a field or method of some value (where the method will be called and its return value will be used), it may be a call to some \"template-builtin\" function or a custom registered function, or a value in a map.</p>\n\n<p>Where <a href=\"https://golang.org/pkg/text/template/#hdr-Pipelines\" rel=\"nofollow noreferrer\">Pipeline</a> is:</p>\n\n<blockquote>\n  <p>A pipeline is a possibly chained sequence of \"commands\". A command is a simple value (argument) or a function or method call, possibly with multiple arguments:</p>\n\n<pre><code>Argument\n  The result is the value of evaluating the argument.\n.Method [Argument...]\n  The method can be alone or the last element of a chain but,\n  unlike methods in the middle of a chain, it can take arguments.\n  The result is the value of calling the method with the\n  arguments:\n      dot.Method(Argument1, etc.)\nfunctionName [Argument...]\n  The result is the value of calling the function associated\n  with the name:\n      function(Argument1, etc.)\n  Functions and function names are described below.\n</code></pre>\n</blockquote>\n\n<p>And an <a href=\"https://golang.org/pkg/text/template/#hdr-Arguments\" rel=\"nofollow noreferrer\">Argument</a> is:</p>\n\n<blockquote>\n  <p>An argument is a simple value, denoted by one of the following.</p>\n\n<pre><code>- A boolean, string, character, integer, floating-point, imaginary\n  or complex constant in Go syntax. These behave like Go's untyped\n  constants. Note that, as in Go, whether a large integer constant\n  overflows when assigned or passed to a function can depend on whether\n  the host machine's ints are 32 or 64 bits.\n- The keyword nil, representing an untyped Go nil.\n- The character '.' (period):\n  .\n  The result is the value of dot.\n- A variable name, which is a (possibly empty) alphanumeric string\n  preceded by a dollar sign, such as\n  $piOver2\n  or\n  $\n  The result is the value of the variable.\n  Variables are described below.\n- The name of a field of the data, which must be a struct, preceded\n  by a period, such as\n  .Field\n  The result is the value of the field. Field invocations may be\n  chained:\n    .Field1.Field2\n  Fields can also be evaluated on variables, including chaining:\n    $x.Field1.Field2\n- The name of a key of the data, which must be a map, preceded\n  by a period, such as\n  .Key\n  The result is the map element value indexed by the key.\n  Key invocations may be chained and combined with fields to any\n  depth:\n    .Field1.Key1.Field2.Key2\n  Although the key must be an alphanumeric identifier, unlike with\n  field names they do not need to start with an upper case letter.\n  Keys can also be evaluated on variables, including chaining:\n    $x.key1.key2\n- The name of a niladic method of the data, preceded by a period,\n  such as\n  .Method\n  The result is the value of invoking the method with dot as the\n  receiver, dot.Method(). Such a method must have one return value (of\n  any type) or two return values, the second of which is an error.\n  If it has two and the returned error is non-nil, execution terminates\n  and an error is returned to the caller as the value of Execute.\n  Method invocations may be chained and combined with fields and keys\n  to any depth:\n    .Field1.Key1.Method1.Field2.Key2.Method2\n  Methods can also be evaluated on variables, including chaining:\n    $x.Method1.Field\n- The name of a niladic function, such as\n  fun\n  The result is the value of invoking the function, fun(). The return\n  types and values behave as in methods. Functions and function\n  names are described below.\n- A parenthesized instance of one the above, for grouping. The result\n  may be accessed by a field or map key invocation.\n  print (.F1 arg1) (.F2 arg2)\n  (.StructValuedMethod \"arg\").Field\n</code></pre>\n</blockquote>\n\n<p>The proper solution would be to register a custom function that constructs the value you want to pass to the template invocation, as you can see in this related / possible duplicate: <a href=\"https://stackoverflow.com/questions/49473199/golang-pass-multiple-values-from-template-to-template/49475057#49475057\">Golang pass multiple values from template to template?</a></p>\n\n<p>Another, half solution could be to use the builtin <code>print</code> or <code>printf</code> functions to concatenate the values you want to pass, but that would require to split in the other template.</p>\n"}], "owner": {"reputation": 189, "user_id": 11139683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad9fdf6151cd46c17790b74f245abef?s=128&d=identicon&r=PG&f=1", "display_name": "mori", "link": "https://stackoverflow.com/users/11139683/mori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 55116341, "answer_count": 1, "score": 0, "last_activity_date": 1552377226, "creation_date": 1552320043, "last_edit_date": 1552376821, "question_id": 55105838, "link": "https://stackoverflow.com/questions/55105838/anonymous-struct-as-pipeline-in-template", "title": "Anonymous struct as pipeline in template", "body": "<p>Is there a way to do the following in a <code>html/template</code>?</p>\n\n<pre><code>{{template \"mytemplate\" struct{Foo1, Foo2 string}{\"Bar1\", \"Bar2\"}}}\n</code></pre>\n\n<p>I mean actually <em>in</em> the template, like above. Not via a function registered in <code>FuncMap</code> which returns the struct.</p>\n\n<p>I tried it, but <code>Parse</code> panics, <a href=\"https://play.golang.org/p/OSbfFOLEMdC\" rel=\"nofollow noreferrer\">see Playground</a>. Maybe I just got the syntax wrong?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 10550, "user_id": 633094, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8FbW8.jpg?s=128&g=1", "display_name": "munk", "link": "https://stackoverflow.com/users/633094/munk"}, "edited": false, "score": 0, "creation_date": 1552320350, "post_id": 55105717, "comment_id": 96954798, "body": "It looks like you&#39;re after a group-by type operation. This link is python, but I think it explains the approach <a href=\"http://jakevdp.github.io/blog/2017/03/22/group-by-from-scratch/\" rel=\"nofollow noreferrer\">jakevdp.github.io/blog/2017/03/22/group-by-from-scratch</a> You might also find some insight here (not quite a duplicate question, yours is more general) <a href=\"https://stackoverflow.com/questions/39987023/golang-group-and-sum-slice-of-structs\" title=\"golang group and sum slice of structs\">stackoverflow.com/questions/39987023/&hellip;</a>"}, {"owner": {"reputation": 961, "user_id": 1775688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2f0b.png?s=128&g=1", "display_name": "Jota Santos", "link": "https://stackoverflow.com/users/1775688/jota-santos"}, "edited": false, "score": 0, "creation_date": 1552323530, "post_id": 55105717, "comment_id": 96956695, "body": "Hi, using the <code>encoding&#47;json</code> library you will be able to accomplish that. If you implement a <code>json.Unmarshaler</code> interface you are able to produce whatever result in <code>[]byte</code>. <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#Unmarshaler</a>"}, {"owner": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "edited": false, "score": 0, "creation_date": 1552346130, "post_id": 55105717, "comment_id": 96966123, "body": "@JamiloSantos. I\u2019m not asking how to simply unmarshal a json to a struct."}, {"owner": {"reputation": 1377, "user_id": 3011280, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mkyAT.jpg?s=128&g=1", "display_name": "Oshan Wisumperuma", "link": "https://stackoverflow.com/users/3011280/oshan-wisumperuma"}, "edited": false, "score": 0, "creation_date": 1557333209, "post_id": 55105717, "comment_id": 98732184, "body": "<a href=\"https://blog.gopheracademy.com/advent-2016/advanced-encoding-decoding/\" rel=\"nofollow noreferrer\">blog.gopheracademy.com/advent-2016/advanced-encoding-decodin&zwnj;&#8203;g</a>"}], "owner": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1552319718, "creation_date": 1552319718, "question_id": 55105717, "link": "https://stackoverflow.com/questions/55105717/convert-flat-data-to-nested-json-with-go", "title": "Convert flat data to nested JSON with Go", "body": "<p>I'm trying to find an efficient way to convert flat data from a DB table into a nested JSON in Go.<br/></p>\n\n<p>This is my code to load my dataset into a slice of structs:</p>\n\n<p><a href=\"https://play.golang.org/p/_80nASVgds-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_80nASVgds-</a></p>\n\n<p>Which will produce the following json:</p>\n\n<pre><code>[{\n    \"Globe\": \"World\",\n    \"Hemisphere\": \"Northern\",\n    \"Country\": \"USA\"\n}, {\n    \"Globe\": \"World\",\n    \"Hemisphere\": \"Southern\",\n    \"Country\": \"Australia\"\n}, {\n    \"Globe\": \"World\",\n    \"Hemisphere\": \"Southern\",\n    \"Country\": \"Brazil\"\n}, {\n    \"Globe\": \"World\",\n    \"Hemisphere\": \"Southern\",\n    \"Country\": \"South Africa\"\n}, {\n    \"Globe\": \"World\",\n    \"Hemisphere\": \"Northern\",\n    \"Country\": \"Spain\"\n}]\n</code></pre>\n\n<p>I'd like to be able to be able to encode the same dataset into something like: <br/><br/></p>\n\n<pre><code>type Globe struct {\n    Name       string\n    Hemisphere []Hemisphere\n}\n\ntype Hemisphere struct {\n    Name    string\n    Country []Country\n}\n\ntype Country struct {\n    Name string\n}\n</code></pre>\n\n<p>So I could marshal Globe and get the same dataset in a nested form as such:<br/></p>\n\n<p><a href=\"https://play.golang.org/p/r9OlCw_EwSA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/r9OlCw_EwSA</a></p>\n\n<pre><code>{\n    \"Name\": \"World\",\n    \"Hemisphere\": [{\n        \"Name\": \"Northern\",\n        \"Country\": [{\n            \"Name\": \"USA\"\n        }, {\n            \"Name\": \"Spain\"\n        }]\n    }, {\n        \"Name\": \"Southern\",\n        \"Country\": [{\n            \"Name\": \"Australia\"\n        }, {\n            \"Name\": \"South Africa\"\n        }, {\n            \"Name\": \"Brazil\"\n        }]\n    }]\n}\n</code></pre>\n\n<p>Is there any effective way of doing this other than looping through the dataset constantly and checking if a given property has already been added into the struct? My dataset is not ordered which makes it even more difficult to control the additions through loops.</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1552320929, "post_id": 55105509, "comment_id": 96955196, "body": "&quot;Wouldn&#39;t be good practice for libraries to provide interfaces&quot; - not if they&#39;re not needed. In Go, interface implementation is implicit, so interfaces are typically defined where they&#39;re consumed, not where they&#39;re implemented."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 1, "creation_date": 1552326750, "post_id": 55105509, "comment_id": 96958383, "body": "Maybe this article is interesting for you: <a href=\"https://www.ardanlabs.com/blog/2016/10/avoid-interface-pollution.html\" rel=\"nofollow noreferrer\">ardanlabs.com/blog/2016/10/avoid-interface-pollution.html</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1552335504, "post_id": 55105509, "comment_id": 96962286, "body": "You can also simply use a function variable which tests can change, see <a href=\"https://stackoverflow.com/questions/40615641/testing-os-exit-scenarios-in-go-with-coverage-information-coveralls-io-goverall/40801733#40801733\">Testing os.Exit scenarios in Go with coverage information (coveralls.io/Goveralls)</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1552372342, "post_id": 55105509, "comment_id": 96972438, "body": "Mocking is often a bad idea for tests. Fakes and Stubs are typically much &quot;better&quot; in the sense of &quot;the discriminatory power of the test increases&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": false, "score": 3, "last_activity_date": 1552321391, "last_edit_date": 1552321391, "creation_date": 1552319768, "answer_id": 55105735, "question_id": 55105509, "link": "https://stackoverflow.com/questions/55105509/golang-interfaces-mocking/55105735#55105735", "title": "Golang interfaces &amp; mocking", "body": "<p>IMO this is a super common solution and strikes a good balance between maintainability and testability.</p>\n\n<p>The way I think of this is that your code is programming to an interface, and there just happens to be two implementations:</p>\n\n<ul>\n<li>\"prod\" version ie the library that you're testing </li>\n<li>test version, a stub that implements the interface</li>\n</ul>\n\n<p>With this approach, a stub can only verify up to your service and its dependencies boundary along the contract of the interface, it assures very little or nothing about your components collaboration/integration with the library that's being stubbed.  In my experiences this approach works awesome and is my personal preference.  I have found it to be important though to have 1 or 2 higher level tests making sure that your component can successfully initialize and interact with the \"prod\" version of the library.</p>\n\n<hr>\n\n<p>Plug:</p>\n\n<p>I've written about this exact issue <a href=\"https://medium.com/dm03514-tech-blog/you-are-going-to-need-it-using-interfaces-and-dependency-injection-to-future-proof-your-designs-2cf6f58db192\" rel=\"nofollow noreferrer\">https://medium.com/dm03514-tech-blog/you-are-going-to-need-it-using-interfaces-and-dependency-injection-to-future-proof-your-designs-2cf6f58db192</a></p>\n"}, {"tags": [], "owner": {"reputation": 845, "user_id": 1493422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f4386def0cbdc13e6f49fc81ddbfb3?s=128&d=identicon&r=PG", "display_name": "Keith Ripley", "link": "https://stackoverflow.com/users/1493422/keith-ripley"}, "is_accepted": true, "score": 6, "last_activity_date": 1552444028, "creation_date": 1552444028, "answer_id": 55133441, "question_id": 55105509, "link": "https://stackoverflow.com/questions/55105509/golang-interfaces-mocking/55133441#55133441", "title": "Golang interfaces &amp; mocking", "body": "<p>You're doing the right thing here, and this was a conscious decision on the part of the language designers.</p>\n\n<p>The Go philosophy is that your code should \"own\" those interfaces, not the library. In languages like C# and Java, libraries define their interfaces up front, without really knowing what the consumer actually needs. (Maybe they include too many methods, or too few.) In Go, because the consumer effectively \"owns\" the interfaces, you're empowered to specify which methods actually need to be present in a minimal interface, and changes in your program requirements mean that you can also change the interface.</p>\n\n<p>Now in this particular case it might seem strange to create an adapter in front of a function for testability, but consider the alternative: if <code>session.Get()</code> were a method of an interface or struct, instead of a function, it would force all library consumers to instantiate a dummy object in order to call the method. Not everyone is going to fake it out---it's easier for them to say that the consumers who want to (like you) are empowered to write adapters, and those that don't can blissfully ignore them.</p>\n"}], "owner": {"reputation": 2315, "user_id": 704916, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/28ab1b239a5e81ff9714dcb8b1c006a5?s=128&d=identicon&r=PG", "display_name": "ianaz", "link": "https://stackoverflow.com/users/704916/ianaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6287, "favorite_count": 2, "accepted_answer_id": 55133441, "answer_count": 2, "score": 11, "last_activity_date": 1552444028, "creation_date": 1552318896, "question_id": 55105509, "link": "https://stackoverflow.com/questions/55105509/golang-interfaces-mocking", "title": "Golang interfaces &amp; mocking", "body": "<p>I'm having hard times writing unit tests in Go due to external libraries which don't expose an interface (therefore not mockable) but only pure functions. Even big ones like <a href=\"https://godoc.org/cloud.google.com/go/redis/apiv1#CloudRedisClient\" rel=\"noreferrer\">Google don't</a>, so I'm wondering whether my approach is good enough.\nWouldn't be good practice for libraries to provide <code>interface</code>s instead of packages with only functions in order to let the user mock them? </p>\n\n<p>The solution I came up with until now is wrap these packages with an interface's implementation but that seem like too much work. </p>\n\n<p>I come with an example. My function could look like this</p>\n\n<pre><code>func AnyFunction() error {\n    sess := session.Get(\"blabla\")\n    // logic in here...\n}\n</code></pre>\n\n<p>where session is an imported package that returns a <code>struct</code>. I can't mock the package <code>session</code>.\nFor this case I'm going to write a <code>SessionInterface</code> with an implementation, which internally calls session.</p>\n\n<p>Ex:</p>\n\n<pre><code>type SessionInterface interface {\n    Get(s string) Session\n}\n\ntype mySessionImpl struct {}\nfunc (me *mySessionImpl) Get(s string) Session {\n  return session.Get(s)\n}\n</code></pre>\n\n<p>For my tests now I can mock the SessionInterface and inject that one into my code</p>\n"}, {"tags": ["go", "goland"], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 3, "last_activity_date": 1552368069, "creation_date": 1552368069, "answer_id": 55114635, "question_id": 55105366, "link": "https://stackoverflow.com/questions/55105366/how-do-i-force-goland-to-run-tests-every-time/55114635#55114635", "title": "How do I force Goland to run tests every time?", "body": "<p>This is related to the Go 1.10+ caching support for tests. You can <a href=\"https://golang.org/doc/go1.10#test\" rel=\"nofollow noreferrer\">read more about it here</a>.</p>\n\n<p>If you wish to disable the caching support in Go, you should run the test command with <code>-count=1</code> flag. To do the same via GoLand, go to <code>Run | Edit Configurations... | Go Test | &lt;name of your test configuration&gt; | Go tool arguments</code> and add <code>-count=1</code> as a parameter there, then run the configuration again.</p>\n\n<p>If you want to disable this for all future generated Run Configurations, then follow the same steps as above but go to <code>Edit Configurations... | Default | Go Test</code> instead.</p>\n"}], "owner": {"reputation": 55, "user_id": 8934630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3M6NI.jpg?s=128&g=1", "display_name": "K. Haskins", "link": "https://stackoverflow.com/users/8934630/k-haskins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "accepted_answer_id": 55114635, "answer_count": 1, "score": 3, "last_activity_date": 1552368091, "creation_date": 1552318383, "last_edit_date": 1552368091, "question_id": 55105366, "link": "https://stackoverflow.com/questions/55105366/how-do-i-force-goland-to-run-tests-every-time", "title": "How do I force Goland to run tests every time?", "body": "<p>If no code changes have been made since the last time a test suite was run in Goland 2018.3, and the last test run completed successfully, Goland simply spits out the last set of results instead of actually executing the code. I need to be able to run the tests on demand as part of a demo without having to make and revert a minor code change each time to get it to cooperate. Using Testify for asserts, not sure if that's relevant to the issue I'm seeing.</p>\n"}, {"tags": ["go", "relative-path"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1552318602, "post_id": 55105299, "comment_id": 96953620, "body": "Do you have this problem only in your test files? I&#39;m asking because they aren&#39;t included in the final build. So after you build and deploy your app, there will be no <code>code_test.go</code> to exec a func in <code>app&#47;conf</code>..."}, {"owner": {"reputation": 51, "user_id": 1434940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zKo0e.jpg?s=128&g=1", "display_name": "Supreme Barbarian", "link": "https://stackoverflow.com/users/1434940/supreme-barbarian"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552319217, "post_id": 55105299, "comment_id": 96954042, "body": "@mkopriva no sorry I was unclear, the functions are called from the actual imlementation files (<code>code.go</code> in the above example) but the functions would be invoked from the actual <code>main</code> package as well, i.e. not only in testing."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1552319528, "post_id": 55105299, "comment_id": 96954237, "body": "Then you could instruct your users to install the config files in a known location, whether absolute, or relative to the binary is a decision for you to make. Alternatively you could instruct your users to provide the location of the configs, either as a cli arg, or an env var, or both."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552319632, "post_id": 55105299, "comment_id": 96954310, "body": "... a 3rd alternative would be to &quot;embed&quot; the configs into the final binary. This is not supported out of the box by the go command but there are 3rd party libraries that can do that for you."}, {"owner": {"reputation": 51, "user_id": 1434940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zKo0e.jpg?s=128&g=1", "display_name": "Supreme Barbarian", "link": "https://stackoverflow.com/users/1434940/supreme-barbarian"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552319829, "post_id": 55105299, "comment_id": 96954431, "body": "Yeah thanks, I was thinking about such a solution; e.g. instructing users to define some enviromental variable or the like, but I was wondering if there&#39;s a better and conventional solution that is a little more &quot;native&quot; to Go."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 1434940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zKo0e.jpg?s=128&g=1", "display_name": "Supreme Barbarian", "link": "https://stackoverflow.com/users/1434940/supreme-barbarian"}, "edited": false, "score": 0, "creation_date": 1552322619, "post_id": 55106210, "comment_id": 96956176, "body": "Thanks Adrian, <b>very good answer</b>. I was looking for a way to base my tests on the config dynamically, rather than explicitly testing against static config values in the tests because much of the config will remain constant anyway. But I guess the motive behind this was convenience more than anything else."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 51, "user_id": 1434940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zKo0e.jpg?s=128&g=1", "display_name": "Supreme Barbarian", "link": "https://stackoverflow.com/users/1434940/supreme-barbarian"}, "edited": false, "score": 0, "creation_date": 1552322697, "post_id": 55106210, "comment_id": 96956216, "body": "There&#39;s no reason you can&#39;t define a struct literal and re-use it in multiple tests (even across multiple packages), for convenience."}, {"owner": {"reputation": 51, "user_id": 1434940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zKo0e.jpg?s=128&g=1", "display_name": "Supreme Barbarian", "link": "https://stackoverflow.com/users/1434940/supreme-barbarian"}, "edited": false, "score": 0, "creation_date": 1552326346, "post_id": 55106210, "comment_id": 96958181, "body": "Some <b>behavioral tests</b> rely on highly personalized ICC profiles that is part of the config and are adapted for the system running the tests. Thus, these profiles can&#39;t be hard coded, lest the test suite becomes extremely flaky. So while I think I&#39;ve found a way to model parts of the system to your suggestions, I have a hard time seeing how I could avoid a dynamic configuration during testing of those components."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 51, "user_id": 1434940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zKo0e.jpg?s=128&g=1", "display_name": "Supreme Barbarian", "link": "https://stackoverflow.com/users/1434940/supreme-barbarian"}, "edited": false, "score": 0, "creation_date": 1552327020, "post_id": 55106210, "comment_id": 96958502, "body": "Without knowing more, all I could suggest is to refactor your code to be less environment-specific (i.e. so that tests don&#39;t need to rely on the profile of the system on which it is running). Unit tests should be 100% reproducible on any system with no system-specific changes."}, {"owner": {"reputation": 51, "user_id": 1434940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zKo0e.jpg?s=128&g=1", "display_name": "Supreme Barbarian", "link": "https://stackoverflow.com/users/1434940/supreme-barbarian"}, "edited": false, "score": 0, "creation_date": 1552327366, "post_id": 55106210, "comment_id": 96958663, "body": "Okay, thanks for your help anyway. Those components perform image recognition on-screen and are in need of some basic testing, but those tests aren&#39;t and will never be proper unit tests."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1552321246, "creation_date": 1552321246, "answer_id": 55106210, "question_id": 55105299, "link": "https://stackoverflow.com/questions/55105299/problem-with-resolving-relative-paths-in-non-main-package/55106210#55106210", "title": "Problem with resolving relative paths in non-main package", "body": "<p>Relying on a config file path within your source is not only an issue in unit tests, but it will also be an issue in production. Typically, code would do something like this:</p>\n\n<ul>\n<li>The config handler accepts an <code>io.Reader</code> which it will read configuration from.</li>\n<li><code>main</code> will open a file (whose path might be hard-coded, passed by command line, passed by env var, etc) and pass it to the config handler for reading.</li>\n<li>Unit tests of the config handler will instead hard-code a config (or multiple configs, to test different scenarios) into something like <code>bytes.Buffer</code> and pass that to the config handler to read instead.</li>\n<li>Unit tests of anything other than the code which reads the config file (so, anything that <em>uses</em> the configuration but does not <em>manipulate</em> it), would generate the <code>Config</code> struct in code rather than reading it from a real <em>or</em> fake file, as part of the test harness. For example, <code>myConf := config.Config{SomeProp: \"foo\", OtherProp: true}</code> and then pass that to the function under test.</li>\n</ul>\n"}], "owner": {"reputation": 51, "user_id": 1434940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zKo0e.jpg?s=128&g=1", "display_name": "Supreme Barbarian", "link": "https://stackoverflow.com/users/1434940/supreme-barbarian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 55106210, "answer_count": 1, "score": -3, "last_activity_date": 1552321246, "creation_date": 1552318196, "last_edit_date": 1552319969, "question_id": 55105299, "link": "https://stackoverflow.com/questions/55105299/problem-with-resolving-relative-paths-in-non-main-package", "title": "Problem with resolving relative paths in non-main package", "body": "<p>I'm having trouble resolving relative file paths in my Go application. For this app I decided to make a package that offers a uniform interface to the different configuration files. The <code>conf</code> package contains the relevant data files, so this is basically the file tree:</p>\n\n<pre><code>app/conf\n    + config.go\n    + config.json\n    + ...\napp/code\n    + code.go\n    + code_test.go\n</code></pre>\n\n<p>Problem is, when the tests defined in <code>app/code/code_test.go</code> calls a function in the <code>app/conf</code> package, which in turn tries to open <code>app/conf/config.json</code>, the relative path is messed up since the working directory is at <code>app/code</code>.</p>\n\n<ul>\n<li><p>I've looked at other SO answers that mentions the <code>path/filepath</code> package and especially the <code>filepath.Abs</code> <a href=\"https://golang.org/pkg/path/filepath/#Abs\" rel=\"nofollow noreferrer\">function</a> for turning relative paths to absolute paths. However, this won't solve my problem since the absolute path will be based on the <em>wrong working directory.</em></p></li>\n<li><p>Some solution with <em>\"absolute paths\"</em> based on GOPATH would probably suffice, but I imagine the GOPATH would have little meaning when the code is built and exported.</p></li>\n<li><p>Simply porting all configuration files to hard coded Go structs is not viable either as they're used cross-language.</p></li>\n</ul>\n"}, {"tags": ["go", "file-upload", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 6, "last_activity_date": 1552314863, "creation_date": 1552314863, "answer_id": 55104223, "question_id": 55103925, "link": "https://stackoverflow.com/questions/55103925/does-the-file-need-to-be-closed/55104223#55104223", "title": "Does the file need to be closed?", "body": "<p>If the <code>file</code> returned implements <code>io.Closer</code> (i.e., if it has a <code>Close</code> method), assume you are responsible for closing it unless the documentation explicitly states otherwise.</p>\n"}], "owner": {"reputation": 11, "user_id": 10758815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LVm9NWmugZ0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-guTjO__wNIRi7XCYF1Q0QkHnM9Og/mo/photo.jpg?sz=128", "display_name": "\u5f20\u6d77\u5b81", "link": "https://stackoverflow.com/users/10758815/%e5%bc%a0%e6%b5%b7%e5%ae%81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1597434428, "creation_date": 1552313916, "last_edit_date": 1597434428, "question_id": 55103925, "link": "https://stackoverflow.com/questions/55103925/does-the-file-need-to-be-closed", "title": "Does the file need to be closed?", "body": "<p>Using golang gin, I read file data using:</p>\n<pre><code>file, fileHeader, err:=ctx.Request.FormFile(&quot;blabla...&quot;)\n</code></pre>\n<p>Do I need to write this?</p>\n<pre><code>defer file.Close()\n</code></pre>\n<p>I jump to the source code, it says:</p>\n<pre><code>// Open opens and returns the FileHeader's associated File.\nfunc (fh *FileHeader) Open() (File, error) {\n        if b := fh.content; b != nil {\n                r := io.NewSectionReader(bytes.NewReader(b), 0, int64(len(b)))\n                fmt.Printf(&quot;TODDLINE:152\\n&quot;)\n                fmt.Printf(&quot;TODDLINE:154:fmpfile:%#v\\n&quot;, fh.tmpfile)\n                fmt.Printf(&quot;TODDLINE:154:Filename:%#v\\n&quot;, fh.Filename)\n                return sectionReadCloser{r}, nil\n        }\n        fmt.Printf(&quot;TODDLINE:155\\n&quot;)\n        return os.Open(fh.tmpfile)\n}\n</code></pre>\n<p>If it uses os.Open, I guess I must close the file, but if it retuns the sectionReadCloser{r}, the Close function shows like this:</p>\n<pre><code>func (rc sectionReadCloser) Close() error {\n        return nil\n}\n</code></pre>\n<p>The close function of seciontReadCloser doesn't do anything.\nAnd I find that it does return the sectionReadCloser{r}.\nI guess I should close the file, but I still want to know when it will return the os.Open. I will keep going to read the source code and try to understand it. It would be nice if someone gives me some advice.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 961, "user_id": 1775688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2f0b.png?s=128&g=1", "display_name": "Jota Santos", "link": "https://stackoverflow.com/users/1775688/jota-santos"}, "edited": false, "score": 1, "creation_date": 1552314134, "post_id": 55103707, "comment_id": 96950713, "body": "Have you seen your last example does not print out the list of the <code>int</code>s you add to the channel? That is because you close the channel before running the loop. Then, you will get the all go routines are asleep DEADlock again. That is because there is no goroutines running ad ch will never be changed again."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552314923, "post_id": 55103707, "comment_id": 96951231, "body": "As a general rule, go-routines that write to a channel should be the one to close the channel. Closing while not coordinating with other go-routines, will guarantee a panic when they write to a closed channel."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552315025, "post_id": 55103707, "comment_id": 96951295, "body": "@colminator this is not the case with multiple writers, because each writer does not know if <i>all</i> writers are finished. Hence the use of <code>WaitGroup</code> and closing the channel from outside the writers."}, {"owner": {"reputation": 64, "user_id": 1475609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46041caea212d17c73cb594e13dcc6c?s=128&d=identicon&r=PG", "display_name": "BhanuReddy", "link": "https://stackoverflow.com/users/1475609/bhanureddy"}, "reply_to_user": {"reputation": 961, "user_id": 1775688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2f0b.png?s=128&g=1", "display_name": "Jota Santos", "link": "https://stackoverflow.com/users/1775688/jota-santos"}, "edited": false, "score": 0, "creation_date": 1552315865, "post_id": 55103707, "comment_id": 96951863, "body": "@JamilloSantos yes you are right I have updated the code correctly now"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552317089, "post_id": 55103707, "comment_id": 96952632, "body": "@Adrian this Q has gone through several code edits - the version I saw had a main go-routine closing a channel and uncoordinated with the completion of other go-routines.I think we&#39;re on the same page - even with multi-writers the <i>manager</i> of the writers should close the channel - and not the main (reader) go-routine"}], "answers": [{"comments": [{"owner": {"reputation": 961, "user_id": 1775688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2f0b.png?s=128&g=1", "display_name": "Jota Santos", "link": "https://stackoverflow.com/users/1775688/jota-santos"}, "edited": false, "score": 0, "creation_date": 1552314108, "post_id": 55103945, "comment_id": 96950699, "body": "That is one option but I would not go that way."}, {"owner": {"reputation": 2267, "user_id": 2639647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc746964582ffff4760c1e7493c13189?s=128&d=identicon&r=PG", "display_name": "Travis Hegner", "link": "https://stackoverflow.com/users/2639647/travis-hegner"}, "reply_to_user": {"reputation": 961, "user_id": 1775688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2f0b.png?s=128&g=1", "display_name": "Jota Santos", "link": "https://stackoverflow.com/users/1775688/jota-santos"}, "edited": false, "score": 0, "creation_date": 1552314664, "post_id": 55103945, "comment_id": 96951044, "body": "I agree, it&#39;s not ideal, hence the word &quot;workaround&quot; with the caveat about best practice. See the update."}, {"owner": {"reputation": 2267, "user_id": 2639647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc746964582ffff4760c1e7493c13189?s=128&d=identicon&r=PG", "display_name": "Travis Hegner", "link": "https://stackoverflow.com/users/2639647/travis-hegner"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552315230, "post_id": 55103945, "comment_id": 96951434, "body": "@Adrian, I agree with you that the first is not the proper solution to the problem, I was simply illustrating <i>why</i> the OP was getting a deadlock."}, {"owner": {"reputation": 64, "user_id": 1475609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46041caea212d17c73cb594e13dcc6c?s=128&d=identicon&r=PG", "display_name": "BhanuReddy", "link": "https://stackoverflow.com/users/1475609/bhanureddy"}, "edited": false, "score": 0, "creation_date": 1552317675, "post_id": 55103945, "comment_id": 96953015, "body": "@TravisHegner I have tried out your solution and it is working fine and I have accepted your answer. I just wanted to check whether my understanding is correct, when we are creating a separate go routine(lets routine X) for wait group wait and close channel this separate routine is waiting instead of main routine hence main routine will start receiving values sent to the channel from multiple routines created in first for loop, once all go routines are completed and x routine will start resuming and closes channel which will stop range from reading channel."}, {"owner": {"reputation": 2267, "user_id": 2639647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc746964582ffff4760c1e7493c13189?s=128&d=identicon&r=PG", "display_name": "Travis Hegner", "link": "https://stackoverflow.com/users/2639647/travis-hegner"}, "reply_to_user": {"reputation": 64, "user_id": 1475609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46041caea212d17c73cb594e13dcc6c?s=128&d=identicon&r=PG", "display_name": "BhanuReddy", "link": "https://stackoverflow.com/users/1475609/bhanureddy"}, "edited": false, "score": 1, "creation_date": 1552318321, "post_id": 55103945, "comment_id": 96953456, "body": "@BhanuReddy yes, that is correct. The sending go routines can only continue because the main routine is able to read the values off of the channel simultaneously, and the channel must remain open until the sending routines are finished. A buffered channel could increase throughput and reduce context switching in a real world scenario."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1552341860, "post_id": 55103945, "comment_id": 96964891, "body": "<code>By default a chan only _holds_ 1 item</code>; no, by default a channel is unbuffered, and <i>holds</i> nothing."}, {"owner": {"reputation": 2267, "user_id": 2639647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc746964582ffff4760c1e7493c13189?s=128&d=identicon&r=PG", "display_name": "Travis Hegner", "link": "https://stackoverflow.com/users/2639647/travis-hegner"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1552345494, "post_id": 55103945, "comment_id": 96965993, "body": "@JimB that is more technically correct, indeed. I will update."}], "tags": [], "owner": {"reputation": 2267, "user_id": 2639647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc746964582ffff4760c1e7493c13189?s=128&d=identicon&r=PG", "display_name": "Travis Hegner", "link": "https://stackoverflow.com/users/2639647/travis-hegner"}, "is_accepted": true, "score": 1, "last_activity_date": 1552345650, "last_edit_date": 1552345650, "creation_date": 1552313992, "answer_id": 55103945, "question_id": 55103707, "link": "https://stackoverflow.com/questions/55103707/writing-data-into-same-chanel-from-different-go-routines-is-working-fine-without/55103945#55103945", "title": "Writing data into same chanel from different go routines is working fine without wait group", "body": "<p>By default a <code>chan</code> <em>holds</em> no items, so all go routines are blocked on sending, until something reads from it. They never actually reach the <code>wg.Done()</code> statement.</p>\n\n<p>A solution would be to close the channel in it's own go routine. Wrap your <code>wg.Wait()</code> and <code>close(ch)</code> lines like this:</p>\n\n<pre><code>go func() {\n    wg.Wait() //wait for all go routines to complete\n    close(ch) // closing channel after completion of wait fo go routines\n}()\n</code></pre>\n\n<p>Then you can range over the channel, which will only close after all of the sending go routines have finished (and implicitly all values have been received).</p>\n"}, {"tags": [], "owner": {"reputation": 961, "user_id": 1775688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2f0b.png?s=128&g=1", "display_name": "Jota Santos", "link": "https://stackoverflow.com/users/1775688/jota-santos"}, "is_accepted": false, "score": 2, "last_activity_date": 1552316926, "creation_date": 1552316926, "answer_id": 55104902, "question_id": 55103707, "link": "https://stackoverflow.com/questions/55103707/writing-data-into-same-chanel-from-different-go-routines-is-working-fine-without/55104902#55104902", "title": "Writing data into same chanel from different go routines is working fine without wait group", "body": "<p>I think your original code has some problems.</p>\n\n<ol>\n<li>You are closing the channel before reading from it.</li>\n<li>You are not getting the advantage of using 10 goroutines because of your channel is 1 \"sized\". So one goroutine is producing one result per once.</li>\n</ol>\n\n<p>My solution would be to spawn a new goroutine to monitor if the 10 goroutines finished its jobs. There you will use your <code>WaitGroup</code>.</p>\n\n<p>Then the code would be like:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\n\nfunc main() {\n    ch := make(chan int, 10)\n\n    for i := 0; i &lt; 10; i++ { // creates 10 go routines and adds to waitgroup\n        wg.Add(1)\n        go func() {\n            for j := 0; j &lt; 10; j++ {\n                ch &lt;- j\n            }\n            wg.Done() // indication of go routine is done to main routine\n        }()\n    }\n\n    go func(){\n        wg.Wait()\n        close(ch)\n    }()\n\n    fmt.Println(runtime.NumGoroutine())\n    for v := range ch { // range can be used since channel is closed\n        fmt.Println(v)\n    }\n    fmt.Println(\"About to exit program ...\")\n}\n</code></pre>\n"}], "owner": {"reputation": 64, "user_id": 1475609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46041caea212d17c73cb594e13dcc6c?s=128&d=identicon&r=PG", "display_name": "BhanuReddy", "link": "https://stackoverflow.com/users/1475609/bhanureddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 55103945, "answer_count": 2, "score": -2, "last_activity_date": 1552345650, "creation_date": 1552313264, "last_edit_date": 1552315950, "question_id": 55103707, "link": "https://stackoverflow.com/questions/55103707/writing-data-into-same-chanel-from-different-go-routines-is-working-fine-without", "title": "Writing data into same chanel from different go routines is working fine without wait group", "body": "<p>When writing data into same channel using multiple go routines with waitgroup after waiting wg.Wait() getting exception saying all go routines are asleep  or deedlock. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\n\nfunc CreateMultipleRoutines() {\n    ch := make(chan int)\n\n    for i := 0; i &lt; 10; i++ { // creates 10 go routines and adds to waitgroup\n        wg.Add(1)\n        go func() {\n            for j := 0; j &lt; 10; j++ {\n                ch &lt;- j\n            }\n            wg.Done() // indication of go routine is done to main routine\n        }()\n    }\n\n    fmt.Println(runtime.NumGoroutine())\n    wg.Wait()           //wait for all go routines to complete\n    close(ch)           // closing channel after completion of wait fo go routines\n    for v := range ch { // range can be used since channel is closed\n        fmt.Println(v)\n    }\n    fmt.Println(\"About to exit program ...\")\n}\n</code></pre>\n\n<p>When tried to implement this without waitgroup I am able to read data from channel by looping exact number of times  data pushed to channel but i cant range since there will be panic when we close channel. here is the example code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc main() {\n    ch := make(chan int)\n\n\n    for i := 0; i &lt; 10; i++ { // creates 10 go routines and adds to waitgroup\n        go func(i int) {\n            for j := 0; j &lt; 10; j++ {\n                ch &lt;- j * i\n            }\n        }(i)\n    }\n\n    fmt.Println(runtime.NumGoroutine())\n\n    for v := 0; v &lt; 100; v++ {\n        fmt.Println(&lt;-ch)\n    }\n    fmt.Println(\"About to exit program ...\")\n}\n</code></pre>\n\n<p>I want to understand why waitgroup in wait state is still waiting even though all go routines are signalled Done() which inturn makes number of go routines to zero</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1552312304, "post_id": 55103204, "comment_id": 96949529, "body": "Don&#39;t use relative imports."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1552312335, "post_id": 55103204, "comment_id": 96949547, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/38517593/relative-imports-in-go\">Relative imports in Go</a>"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552313092, "post_id": 55103204, "comment_id": 96950057, "body": "@Flimzy hello! Why you think this post is duplicate? It is different question ;("}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552313698, "post_id": 55103204, "comment_id": 96950451, "body": "This line: <code>RUN go build -o &#47;bin questionnaire</code> doesn&#39;t seem like a good idea to me, most if not all linuxes have a folder called <code>bin</code> at the root of the filesystem. That folder contains a bunch of binaries that are probably required for the machine to run as expected. By overwriting that folder with your app&#39;s binary, you are setting yourself up for some headaches, I think... I haven&#39;t tried it so I can&#39;t say for sure... either way I would recommend you rename your binary to something that doesn&#39;t conflict with existing files/folders or..."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1552313702, "post_id": 55103204, "comment_id": 96950453, "body": "... keep the name but move it into a subfolder where that name is not yet taken."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552313968, "post_id": 55103204, "comment_id": 96950622, "body": "@NurzhanNogerbek: Because the problem you&#39;re having is explained in that question."}], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1552317603, "post_id": 55104987, "comment_id": 96952962, "body": "<i>&quot;It looks lik database, routes, and utils are files in the same folder as your main.go.&quot;</i> They are not files, they are folders. And they are also valid packages since, as OP stated in the first paragraph, the app works fine on their local machine. If those were files the app would not be able to compile with those imports."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 1, "creation_date": 1552319357, "post_id": 55104987, "comment_id": 96954121, "body": "mkopriva is right! <code>database</code>, <code>routes</code>, and <code>utils</code> are folders (packages). Inside them I have different <code>.go</code> files. As I can see you use multi-stage builds. In fact I use <code>Docker version 17.03.2-ce, build f5ec1e2</code>. Multi-stage builds is not aviable in that version."}, {"owner": {"reputation": 494, "user_id": 6392978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7NNr.jpg?s=128&g=1", "display_name": "Opnauticus", "link": "https://stackoverflow.com/users/6392978/opnauticus"}, "edited": false, "score": 0, "creation_date": 1552319923, "post_id": 55104987, "comment_id": 96954493, "body": "My mistake! I definitely misread that.  I&#39;ve updated my response accordingly.  The folder and package structure of your app looks fine - I suspect the questionnaire package just wasn&#39;t being added to the <code>GOPATH</code> within the docker image."}, {"owner": {"reputation": 494, "user_id": 6392978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7NNr.jpg?s=128&g=1", "display_name": "Opnauticus", "link": "https://stackoverflow.com/users/6392978/opnauticus"}, "edited": false, "score": 0, "creation_date": 1552320366, "post_id": 55104987, "comment_id": 96954809, "body": "As for the multi-stage build, you can ignore it if your version doesn&#39;t support it - I think making sure the files are added to the $GOPATH should resolve your issue."}], "tags": [], "owner": {"reputation": 494, "user_id": 6392978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7NNr.jpg?s=128&g=1", "display_name": "Opnauticus", "link": "https://stackoverflow.com/users/6392978/opnauticus"}, "is_accepted": true, "score": 5, "last_activity_date": 1552319867, "last_edit_date": 1552319867, "creation_date": 1552317198, "answer_id": 55104987, "question_id": 55103204, "link": "https://stackoverflow.com/questions/55103204/how-correctly-to-run-golang-application-in-docker/55104987#55104987", "title": "How correctly to run golang application in docker?", "body": "<p>The imports in your <code>main.go</code> file specify:</p>\n\n<p><code>\"questionnaire/database\"\n  \"questionnaire/routes\"\n  \"questionnaire/utils\"</code></p>\n\n<p>This means the go compiler is looking for those packages in <code>$GOPATH/questionnaire</code> and <code>$GOROOT/questionnaire</code>. You have to make sure those are copied into the correct place inside the docker image you are building. </p>\n\n<p>The default $GOPATH inside that <code>golang:1.12</code> image is <code>/go</code>. Make sure your questionnaire package is correctly placed in the <code>/go/src</code> directory inside the docker image.</p>\n\n<p>As for the Dockerfile:\nA common strategy when building / deploying Docker images for go apps is to use a builder pattern (see example Dockerfile below). The gist of it is to create a multi-stage Dockerfile, where the first stage builds the go executable, and the second stage runs it. This means you can isolate all of your dependencies in the first stage, and end up with a very small overall image at the end.</p>\n\n<p>It might look something like this:</p>\n\n<pre><code>FROM golang:1.11-alpine AS builder\n\n########\n# Prep\n########\n\n# add the source\nCOPY . /go/src/questionnaire\nWORKDIR /go/src/questionnaire/\n\n########\n# Build Go Wrapper\n########\n\n# Install go dependencies\nRUN go get github.com/gorilla/mux &amp;&amp; \\\n  go get github.com/gorilla/handlers &amp;&amp; \\\n  go get github.com/lib/pq &amp;&amp; \\\n  go get github.com/joho/godotenv &amp;&amp; \\\n  go get github.com/jinzhu/gorm &amp;&amp; \\\n  go get github.com/go-goracle/goracle\n\n#build the go app\nRUN GOOS=linux GOARCH=amd64 go build -o ./questionnaire ./main.go\n\n########\n# Package into runtime image\n########\nFROM alpine\n\n# copy the executable from the builder image\nCOPY --from=builder /go/src/questionnaire .\n\nENTRYPOINT [\"/questionnaire\"]\n\nEXPOSE 8080\n</code></pre>\n\n<p>Hope this helps!</p>\n\n<p>(edited to reflect the comments below)</p>\n"}], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1802, "favorite_count": 1, "accepted_answer_id": 55104987, "answer_count": 1, "score": 3, "last_activity_date": 1596729474, "creation_date": 1552311812, "last_edit_date": 1552312833, "question_id": 55103204, "link": "https://stackoverflow.com/questions/55103204/how-correctly-to-run-golang-application-in-docker", "title": "How correctly to run golang application in docker?", "body": "<p>I developed Golang application in Windows 10. In my local machine it works fine. I remove source code to remote CentOS server which has Docker. Right now I am trying to run this application in Docker.</p>\n\n<p>I created <strong>Dockerfile</strong> in the same folder where located <strong>main.go</strong> file.</p>\n\n<pre><code>- questionnaire\n    - database\n    - routes\n    - utils\n    - models\n    - controllers\n      main.go\n      Dockerfile\n</code></pre>\n\n<p><strong>Dockerfile</strong> looks like this:</p>\n\n<pre><code>FROM golang:1.12\n\nRUN go get github.com/gorilla/mux &amp;&amp; \\\n  go get github.com/gorilla/handlers &amp;&amp; \\\n  go get github.com/lib/pq &amp;&amp; \\\n  go get github.com/joho/godotenv &amp;&amp; \\\n  go get github.com/jinzhu/gorm &amp;&amp; \\\n  go get github.com/go-goracle/goracle\n\nCOPY / ./\n\nEXPOSE 8000\n\nCMD [\"go\", \"run\", \"main.go\"]\n</code></pre>\n\n<p>My <strong>main.go</strong> file looks pretty simple:</p>\n\n<pre><code>package main\n\nimport (\n  \"github.com/gorilla/handlers\"\n  \"github.com/gorilla/mux\"\n  \"github.com/joho/godotenv\"\n  \"log\"\n  \"net/http\"\n  \"questionnaire/database\"\n  \"questionnaire/routes\"\n  \"questionnaire/utils\"\n)\n\nfunc main()  {\n  err := godotenv.Load(\".env\")\n  if err != nil {\n    panic(err)\n  }\n\n  database.ConnectOracle()\n  defer database.DisconnectOracle()\n\n  router := mux.NewRouter()\n\n  headers := handlers.AllowedHeaders([]string{\"X-Requested-With\", \"Content-Type\", \"Authorization\"})\n  methods := handlers.AllowedMethods([]string{\"GET\", \"POST\", \"PATCH\", \"PUT\", \"DELETE\", \"OPTIONS\"})\n  origins := handlers.AllowedOrigins([]string{\"*\"})\n\n  router.StrictSlash(true)\n\n  routes.Handle(router)\n\n  port := utils.CheckEnvironmentVariable(\"APPLICATION_PORT\")\n\n  log.Printf(\"RESTful web service is running on %s port.\", port)\n\n  log.Fatal(http.ListenAndServe(\":\" + port, handlers.CORS(headers, methods, origins)(router)))\n}\n</code></pre>\n\n<p>I successfully created Docker Image but I have error when created Docker Container:</p>\n\n<pre><code>main.go:9:2: cannot find package \"questionnaire/database\" in any of:\n        /usr/local/go/src/questionnaire/database (from $GOROOT)\n        /go/src/questionnaire/database (from $GOPATH)\nmain.go:10:2: cannot find package \"questionnaire/routes\" in any of:\n        /usr/local/go/src/questionnaire/routes (from $GOROOT)\n        /go/src/questionnaire/routes (from $GOPATH)\nmain.go:11:2: cannot find package \"questionnaire/utils\" in any of:\n        /usr/local/go/src/questionnaire/utils (from $GOROOT)\n        /go/src/questionnaire/utils (from $GOPATH)\n</code></pre>\n\n<p>Can anyone say how to fix this problem?</p>\n\n<p>I also tried to build binary of golang application inside Docker by next Dockerfile but error message was the same <code>RUN go build</code> command:</p>\n\n<pre><code>FROM golang:1.12\n\nRUN go get github.com/gorilla/mux &amp;&amp; \\\n  go get github.com/gorilla/handlers &amp;&amp; \\\n  go get github.com/lib/pq &amp;&amp; \\\n  go get github.com/joho/godotenv &amp;&amp; \\\n  go get github.com/jinzhu/gorm &amp;&amp; \\\n  go get gopkg.in/goracle.v2\n\nADD . /go/src/questionnaire\n\nWORKDIR /go/src/questionnaire\n\nRUN go build -o /bin questionnaire\n\nENV PORT=8000\n\nCMD [\"/bin\"]\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1552310655, "post_id": 55102754, "comment_id": 96948389, "body": "Duplicate. string(ch) does <b>NOT</b> do what you think it does. Take the Tour of Go once more. To print a character: Use the <code>%c</code> verb in fmt.Printf (instead of %s) and do not try to typeconvert to string."}], "answers": [{"comments": [{"owner": {"reputation": 232, "user_id": 3262732, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03da751b1d70ab51a4d995e2ded4627d?s=128&d=identicon&r=PG&f=1", "display_name": "user3262732", "link": "https://stackoverflow.com/users/3262732/user3262732"}, "edited": false, "score": 1, "creation_date": 1552314444, "post_id": 55103305, "comment_id": 96950903, "body": "thank you @Eli Bendersky. this example help me a lot to understand this concept"}], "tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 1, "last_activity_date": 1552312109, "creation_date": 1552312109, "answer_id": 55103305, "question_id": 55102754, "link": "https://stackoverflow.com/questions/55102754/accept-a-character-from-console-and-display-its-next-character/55103305#55103305", "title": "Accept a character from console and display its next character", "body": "<p>\"Characters\" in Go are called <em>runes</em>, and <code>rune</code> is an alias for <code>int32</code>. You need two changes:</p>\n\n<ol>\n<li>Scan with the proper verb (your <code>Scan</code> actually fails - check for errors!)</li>\n<li>Print with the proper verb</li>\n</ol>\n\n<p>Here's an extended example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n)\n\nfunc main() {\n\n    var ch rune\n    fmt.Printf(\"Enter Char : \")\n    _, err := fmt.Scanf(\"%c\", &amp;ch)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Printf(\"ch = %x\\n\", ch)\n    ch++\n    fmt.Printf(\"ch+1 = %x\\n\", ch)\n    fmt.Printf(\"Next char is %c\\n\", ch)\n}\n</code></pre>\n\n<p>Sample session:</p>\n\n<pre><code>Enter Char : a\nch = 61\nch+1 = 62\nNext char is b\n</code></pre>\n\n<p>Make sure to read <a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">this official Go blog post</a> to better understand how runes and strings interact.</p>\n"}], "owner": {"reputation": 232, "user_id": 3262732, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03da751b1d70ab51a4d995e2ded4627d?s=128&d=identicon&r=PG&f=1", "display_name": "user3262732", "link": "https://stackoverflow.com/users/3262732/user3262732"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 55103305, "answer_count": 1, "score": -1, "last_activity_date": 1552312109, "creation_date": 1552310372, "last_edit_date": 1552311067, "question_id": 55102754, "link": "https://stackoverflow.com/questions/55102754/accept-a-character-from-console-and-display-its-next-character", "title": "Accept a character from console and display its next character", "body": "<p>I want to write a program that accepts a character from console and display its next character.</p>\n\n<p>This is what I tried:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    var ch int32\n    fmt.Printf(\"Enter Char : \")\n    fmt.Scan(&amp;ch)\n\n    ch++\n\n    fmt.Printf(\"Next Char is %s \", string(ch))\n\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "ttl"], "answers": [{"comments": [{"owner": {"reputation": 54, "user_id": 5160709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04e4915d6883ac81b66bec7baeb1b86?s=128&d=identicon&r=PG&f=1", "display_name": "nihar kawli", "link": "https://stackoverflow.com/users/5160709/nihar-kawli"}, "reply_to_user": {"reputation": 35, "user_id": 10413349, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vYHxy75x-Jk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUtMN9Il1XU8NJzj2hxzdEOeQkfEg/mo/photo.jpg?sz=128", "display_name": "Eugene Roasted", "link": "https://stackoverflow.com/users/10413349/eugene-roasted"}, "edited": false, "score": 0, "creation_date": 1552325638, "post_id": 55103777, "comment_id": 96957837, "body": "Yes, you can use it. The create index part should be done once in the Init() or main method. If the requirement is to delete the record after the ExpirationDate, you can set the value of ttl as 0 and when inserting the record, set the expiration date accordingly. Once the clock time reaches the expirationDate value, the record will be removed."}, {"owner": {"reputation": 129, "user_id": 6800325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/anqdl.jpg?s=128&g=1", "display_name": "Abid", "link": "https://stackoverflow.com/users/6800325/abid"}, "edited": false, "score": 0, "creation_date": 1611050104, "post_id": 55103777, "comment_id": 116318650, "body": "This method didn&#39;t work."}], "tags": [], "owner": {"reputation": 54, "user_id": 5160709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04e4915d6883ac81b66bec7baeb1b86?s=128&d=identicon&r=PG&f=1", "display_name": "nihar kawli", "link": "https://stackoverflow.com/users/5160709/nihar-kawli"}, "is_accepted": true, "score": 2, "last_activity_date": 1552313503, "creation_date": 1552313503, "answer_id": 55103777, "question_id": 55102752, "link": "https://stackoverflow.com/questions/55102752/setting-ttl-for-expire-data-from-collection/55103777#55103777", "title": "Setting TTL for expire data from collection", "body": "<p>You need to create an ttl index on the field which needs to be removed after n seconds.</p>\n\n<p>In the below code snippet, have created an expirationTime field on which ttl can be set. After 60 seconds from the expirationTime set in the record, the record will be removed.</p>\n\n<p>Following is the code to create a TTL index:</p>\n\n<pre><code>var ttl *int32\n    *ttl = 60\n    keys := bsonx.Doc{{Key: \"expirationTime\", Value: bsonx.Int32(int32(1))}}\n    idx := mongo.IndexModel{Keys: keys, Options: &amp;options.IndexOptions{ExpireAfterSeconds: ttl}}\n    _, err := collection.Indexes().CreateOne(context.Background(), idx)\n    if err != nil {\n        fmt.Println(\"Error occurred while creating index\", err)\n    } else {\n        fmt.Println(\"Index creation success\")\n    }\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10413349, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vYHxy75x-Jk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUtMN9Il1XU8NJzj2hxzdEOeQkfEg/mo/photo.jpg?sz=128", "display_name": "Eugene Roasted", "link": "https://stackoverflow.com/users/10413349/eugene-roasted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 55103777, "answer_count": 1, "score": 1, "last_activity_date": 1552313503, "creation_date": 1552310369, "question_id": 55102752, "link": "https://stackoverflow.com/questions/55102752/setting-ttl-for-expire-data-from-collection", "title": "Setting TTL for expire data from collection", "body": "<p>Is there a correct way to configure data self-deletion by key using the <a href=\"http://go.mongodb.org/mongo-driver\" rel=\"nofollow noreferrer\">official mongo driver</a>? The only method that I found in the Mongo-driver module is <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo#IndexOptionsBuilder.ExpireAfterSeconds\" rel=\"nofollow noreferrer\">ExpireAfterSeconds</a>, but I'm not sure how to use it correctly.\nHere's the <a href=\"https://github.com/AlfredMulder/shelve\" rel=\"nofollow noreferrer\">repository</a> with what is ready at the moment.</p>\n"}, {"tags": ["go", "concurrency", "redis", "transactions"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1552326598, "post_id": 55102652, "comment_id": 96958307, "body": "Use the <a href=\"https://godoc.org/github.com/go-redis/redis#example-Client-TxPipeline\" rel=\"nofollow noreferrer\">transaction</a> feature."}], "answers": [{"comments": [{"owner": {"reputation": 1830, "user_id": 3173442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51671cb0443774778a70911715aa92e5?s=128&d=identicon&r=PG", "display_name": "Kayvan Mazaheri", "link": "https://stackoverflow.com/users/3173442/kayvan-mazaheri"}, "edited": false, "score": 0, "creation_date": 1552310853, "post_id": 55102717, "comment_id": 96948512, "body": "thanks but what if I needed to implement a different set of actions which don&#39;t have an atomic equivalent command?"}], "tags": [], "owner": {"reputation": 36561, "user_id": 2395796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8786484468219bcf403bbdce5eb37c8d?s=128&d=identicon&r=PG", "display_name": "Kevin Christopher Henry", "link": "https://stackoverflow.com/users/2395796/kevin-christopher-henry"}, "is_accepted": false, "score": 1, "last_activity_date": 1552311385, "last_edit_date": 1552311385, "creation_date": 1552310214, "answer_id": 55102717, "question_id": 55102652, "link": "https://stackoverflow.com/questions/55102652/atomic-and-concurrent-safe-redis-transactions-in-golang/55102717#55102717", "title": "Atomic and Concurrent Safe Redis Transactions in Golang", "body": "<p>You can accomplish this by using the single Redis command <a href=\"https://redis.io/commands/getset\" rel=\"nofollow noreferrer\"><code>GETSET</code></a>, which will be atomic:</p>\n\n<pre><code>GETSET KEY 0\n</code></pre>\n\n<p>More broadly, there's nothing Go-specific about ensuring atomicity in Redis. You just use the same Redis transaction facilities (via the Go Redis client) that you're familiar with.</p>\n"}], "owner": {"reputation": 1830, "user_id": 3173442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51671cb0443774778a70911715aa92e5?s=128&d=identicon&r=PG", "display_name": "Kayvan Mazaheri", "link": "https://stackoverflow.com/users/3173442/kayvan-mazaheri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552311385, "creation_date": 1552310007, "last_edit_date": 1552311002, "question_id": 55102652, "link": "https://stackoverflow.com/questions/55102652/atomic-and-concurrent-safe-redis-transactions-in-golang", "title": "Atomic and Concurrent Safe Redis Transactions in Golang", "body": "<p>I'm trying to implement the following logic in my go program:</p>\n\n<pre><code>def action:\n 1. GET the value of KEY from Redis\n 2. SET the value of KEY to 0\n</code></pre>\n\n<p>I'm using <a href=\"http://%22github.com/go-redis/redis%22\" rel=\"nofollow noreferrer\"><code>go-redis</code></a> module to interact with my Redis instance.</p>\n\n<p>I'm familiar with Redis transactions but I couldn't seem to find a decent document or example on how to implement the desired set of actions in a concurrent-safe and atomic manner in Golang.</p>\n\n<p><strong>Question</strong>: How can I implement the defined <code>action</code> and be sure no other Redis operation will take place between steps 1 and 2 even if I access my Redis instance from different go routines?</p>\n"}, {"tags": ["go", "request", "connection", "timeout"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1552302811, "post_id": 55100361, "comment_id": 96944078, "body": "Given these limitations it seems you have to implement the same timeout in the client and reconnect after the timeout occurs. You should expect network connections to fail <i>anyway</i> so this should be a worthwhile feature even without the issue you describe."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1552307060, "post_id": 55100361, "comment_id": 96946323, "body": "While detecting a closed connection and reconnecting is a good idea in general, if the server is the one sending the long response, and the server is behind the load balancer, then it should be up to the server to keep the connection alive."}], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 1781494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fw1u3.png?s=128&g=1", "display_name": "GreNodge", "link": "https://stackoverflow.com/users/1781494/grenodge"}, "edited": false, "score": 0, "creation_date": 1552314851, "post_id": 55104118, "comment_id": 96951173, "body": "Thank you for our point. All you said is correct. The only thing: In my case I could only change the client. Neither the server nor the LB."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 535, "user_id": 1781494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fw1u3.png?s=128&g=1", "display_name": "GreNodge", "link": "https://stackoverflow.com/users/1781494/grenodge"}, "edited": false, "score": 0, "creation_date": 1552314924, "post_id": 55104118, "comment_id": 96951232, "body": "There is nothing the client can do to keep the load balancer from timing out the server."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1552314510, "creation_date": 1552314510, "answer_id": 55104118, "question_id": 55100361, "link": "https://stackoverflow.com/questions/55100361/how-to-deal-with-long-running-server-responses-and-load-balancer-that-treats-thi/55104118#55104118", "title": "How to deal with long running server responses and Load Balancer that treats this as stalled connection", "body": "<p>15 minutes is an incredibly long quiet period for basic HTTP - possibly better-suited to WebSockets. Short of a protocol change, you <em>should</em> be able to adjust the timeout period on the load balancer (hard to say since you didn't specify what the LB is) to better suit your use case, though not all load balancers will allow timeouts as high as 15 minutes. If you can't change the protocol <em>and</em> can't turn the timeout up high enough, you would have to send keepalive messages from the server every so often (just short of the timeout period, so maybe 55s with your current config, or a little less than the highest timeout period you're able to set on the LB). This would have to be something the client knew to discard, like <code>{\"type\": \"keepalive\"}</code> - something easily identifiable on the client side as a \"fake\" message for keepalive purposes.</p>\n"}], "owner": {"reputation": 535, "user_id": 1781494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fw1u3.png?s=128&g=1", "display_name": "GreNodge", "link": "https://stackoverflow.com/users/1781494/grenodge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552314510, "creation_date": 1552302115, "last_edit_date": 1552302997, "question_id": 55100361, "link": "https://stackoverflow.com/questions/55100361/how-to-deal-with-long-running-server-responses-and-load-balancer-that-treats-thi", "title": "How to deal with long running server responses and Load Balancer that treats this as stalled connection", "body": "<p>Case/Assumption:</p>\n\n<ol>\n<li>There is a server that is written by someone else.</li>\n<li>This server has an endpoint <code>GET /api/watch</code>.</li>\n<li>This endpoint is plain HTTP/1.1</li>\n<li>This endpoint will write events like\n\n<pre><code>{type:\"foo\", message:\"bar\"}\n</code></pre>\n\nto the response stream once they appear (one event per line and then a flush).</li>\n<li>Sometimes this server writes events every second to the output, sometimes every 15 minutes.</li>\n<li>Between my client and this server there is a third-party Load Balancer which assumes a connection as staling if there is no action on the connection for more than 60 seconds and drops the connection without closing it.</li>\n<li>The client is written in simple Golang and simply makes a GET request to this endpoint.</li>\n<li>Once the connection is marked by the LB as staled the client (the same happens to <code>curl</code>, too) is not notified that the connection was dropped by the LB and is still waiting for stuff to receive in the response of the GET request.</li>\n</ol>\n\n<p>So: What are my possibilities to deal with this situation?</p>\n\n<p>What is not possible:</p>\n\n<ol>\n<li>Modify the server.</li>\n<li>Use another server.</li>\n<li>Use something else than this endpoint and how it is written. </li>\n<li>Modify the Load Balancer.</li>\n<li>Use another LB.</li>\n<li>Leave the LB out of the connection.</li>\n</ol>\n"}, {"tags": ["pdf", "go"], "comments": [{"owner": {"reputation": 1592, "user_id": 618951, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b867e8993ce4bf8205315e4a2e45e418?s=128&d=identicon&r=PG", "display_name": "RisingSun", "link": "https://stackoverflow.com/users/618951/risingsun"}, "edited": false, "score": 0, "creation_date": 1552510769, "post_id": 55100071, "comment_id": 97042530, "body": "please include your error message as it is hard to understand what you are trying to say. Error messages are usually very straightforward. If it is erroring because it expects strings but getting bytes then all you have to do is cast it to string like <code>string(yourbytes)</code>"}, {"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1552559167, "post_id": 55100071, "comment_id": 97059292, "body": "Please add more examples to your question, <code>ioutil.ReadFile</code> doesn&#39;t render the html in the pdf..."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1552560023, "post_id": 55100071, "comment_id": 97059834, "body": "I think the solution is very simple. But some important informations are missing. If you render it on the server you could just use the pdf API by calling the rendered html from the server with <code>page := NewPage(&quot;https:&#47;&#47;url&#47;to&#47;your&#47;page&#47;?rid=12342&quot;)</code> or why is this not possible? How do you handle the template? Show where you parse and execute it. Why you read a file? Is that the template or the rendered html?"}, {"owner": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1552564331, "post_id": 55100071, "comment_id": 97062571, "body": "@apxp thats is something I could do. I was trying to use the function without adding it to my router."}, {"owner": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "edited": false, "score": 0, "creation_date": 1552564385, "post_id": 55100071, "comment_id": 97062607, "body": "There are no errors, as its the wrong type. I have updated my question with some more information"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1552587891, "post_id": 55100071, "comment_id": 97078494, "body": "You know that the method <code>DataTest()</code> returns just an error interface at <code>bytes.NewReader(c.DataTest(data))</code>? So the <code>NewReader()</code> call can not work."}], "answers": [{"comments": [{"owner": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "edited": false, "score": 0, "creation_date": 1552609410, "post_id": 55164926, "comment_id": 97086676, "body": "I am not sure what your data var is doing? In my DataTest (1st version) I returned a rendered html page (by Echo) with also includes a map of data sent into the template to add to the content. What I have done so far is to just render a string html (update DataTest). While on the PDF plugins github page, there is a way to render a open file, what is not what I want. I need it to be rendered, e.g. content added into the template and that template passed back to me as a string / slice of bytes"}, {"owner": {"reputation": 1947, "user_id": 6022937, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Wm7nH.png?s=128&g=1", "display_name": "Nestor Sokil", "link": "https://stackoverflow.com/users/6022937/nestor-sokil"}, "reply_to_user": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "edited": false, "score": 0, "creation_date": 1552639964, "post_id": 55164926, "comment_id": 97095370, "body": "@C0ol_Cod3r data is the parameters for your template. Please see <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">golang.org/pkg/html/template</a>"}], "tags": [], "owner": {"reputation": 1947, "user_id": 6022937, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Wm7nH.png?s=128&g=1", "display_name": "Nestor Sokil", "link": "https://stackoverflow.com/users/6022937/nestor-sokil"}, "is_accepted": false, "score": 0, "last_activity_date": 1552573318, "creation_date": 1552573318, "answer_id": 55164926, "question_id": 55100071, "link": "https://stackoverflow.com/questions/55100071/how-to-use-rendered-template-in-creating-a-pdf/55164926#55164926", "title": "How to use rendered template in creating a pdf", "body": "<p>So from what I understand you want to:</p>\n\n<ol>\n<li>Render HTML from template</li>\n<li>Convert HTML to PDF</li>\n<li>Send it as an HTTP response? This part is unclear from your question, but it doesn't matter really.</li>\n</ol>\n\n<p>So, the reason Echo returns <code>error</code> is because it actually not only does the template rendering, but also sending a response to client. If you want to do something else in-between, you can't use that method from echo.</p>\n\n<p>Luckily, echo doesn't do anything magical there. You can just use the standard template package with the same result.</p>\n\n<pre><code>func GetHtml(filename string, data interface{}) (string, error) {\n    filedata, err := ioutil.ReadFile(filename)\n    if err != nil {\n        return \"\", err\n    }\n\n    asString := string(filedata)\n    t, err := template.New(\"any-name\").Parse(asString)\n    if err != nil {\n        return \"\", err\n    }\n\n    var buffer bytes.Buffer\n    err = t.Execute(&amp;buffer, data)\n    if err != nil {\n        return \"\", err\n    }\n\n    return buffer.String(), nil\n}\n</code></pre>\n\n<p>There you have your function that returns a <code>string</code>. You can use <code>buffer.Bytes()</code> to have a byte array if that's preferrable. </p>\n\n<p>After this you can do whatever you need to, like convert to PDF and write it back to clients using <code>echoCtx.Response().Writer()</code>.</p>\n\n<p>Hope that helps, but in future try asking more precise questions, then you are more likely to receive an accurate response.</p>\n"}, {"comments": [{"owner": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "edited": false, "score": 0, "creation_date": 1553249253, "post_id": 55233738, "comment_id": 97322731, "body": "This looks good. I give this a good when I can, I am just using a string for now. But your setting this up to use a URL, which would make the function accessible by anyone with that route. That is something I dont want. I am looking for a function that does not go though a router and can be called within another function. Therefore i am not sure if the middleware would work? Has I think that would only work for route functions?"}, {"owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "reply_to_user": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "edited": false, "score": 0, "creation_date": 1553269581, "post_id": 55233738, "comment_id": 97335007, "body": "If you want to apply middleware to only one API, you can do it as an example. I updated the example."}], "tags": [], "owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "is_accepted": false, "score": 1, "last_activity_date": 1553269632, "last_edit_date": 1553269632, "creation_date": 1552970280, "answer_id": 55233738, "question_id": 55100071, "link": "https://stackoverflow.com/questions/55100071/how-to-use-rendered-template-in-creating-a-pdf/55233738#55233738", "title": "How to use rendered template in creating a pdf", "body": "<p>if you want rendered html, use echo' custom middleware. I hope it helps you.</p>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"bytes\"\n    \"errors\"\n    \"fmt\"\n    \"html/template\"\n    \"io\"\n    \"net\"\n\n    \"net/http\"\n\n    \"github.com/labstack/echo\"\n)\n\ntype TemplateRegistry struct {\n    templates map[string]*template.Template\n}\n\nfunc (t *TemplateRegistry) Render(w io.Writer, name string, data interface{}, c echo.Context) error {\n    tmpl, ok := t.templates[name]\n    if !ok {\n        err := errors.New(\"Template not found -&gt; \" + name)\n        return err\n    }\n    return tmpl.ExecuteTemplate(w, \"base.html\", data)\n}\n\nfunc main() {\n    e := echo.New()\n\n    templates := make(map[string]*template.Template)\n    templates[\"about.html\"] = template.Must(template.ParseFiles(\"view/about.html\", \"view/base.html\"))\n    e.Renderer = &amp;TemplateRegistry{\n        templates: templates,\n    }\n\n    // add custom middleware\n    // e.Use(PdfMiddleware)\n\n    // only AboutHandler for Pdf\n    e.GET(\"/about\", PdfMiddleware(AboutHandler))\n\n    // Start the Echo server\n    e.Logger.Fatal(e.Start(\":8080\"))\n}\n\n// custom middleware\nfunc PdfMiddleware(next echo.HandlerFunc) echo.HandlerFunc {\n    return func(c echo.Context) (err error) {\n        resBody := new(bytes.Buffer)\n        mw := io.MultiWriter(c.Response().Writer, resBody)\n        writer := &amp;bodyDumpResponseWriter{Writer: mw, ResponseWriter: c.Response().Writer}\n        c.Response().Writer = writer\n\n        if err = next(c); err != nil {\n            c.Error(err)\n        }\n\n        // or use resBody.Bytes()\n        fmt.Println(resBody.String())\n        return\n    }\n}\n\ntype bodyDumpResponseWriter struct {\n    io.Writer\n    http.ResponseWriter\n}\n\nfunc (w *bodyDumpResponseWriter) WriteHeader(code int) {\n    w.ResponseWriter.WriteHeader(code)\n}\n\nfunc (w *bodyDumpResponseWriter) Write(b []byte) (int, error) {\n    return w.Writer.Write(b)\n}\n\nfunc (w *bodyDumpResponseWriter) Flush() {\n    w.ResponseWriter.(http.Flusher).Flush()\n}\n\nfunc (w *bodyDumpResponseWriter) Hijack() (net.Conn, *bufio.ReadWriter, error) {\n    return w.ResponseWriter.(http.Hijacker).Hijack()\n}\n\nfunc AboutHandler(c echo.Context) error {\n    return c.Render(http.StatusOK, \"about.html\", map[string]interface{}{\n        \"name\": \"About\",\n        \"msg\":  \"All about Boatswain!\",\n    })\n}\n</code></pre>\n\n<p><strong>view/about.html</strong></p>\n\n<pre><code>{{define \"title\"}}\n  Boatswain Blog | {{index . \"name\"}}\n{{end}}\n\n{{define \"body\"}}\n  &lt;h1&gt;{{index . \"msg\"}}&lt;/h1&gt;\n  &lt;h2&gt;This is the about page.&lt;/h2&gt;\n{{end}}\n</code></pre>\n\n<p><strong>view/base.html</strong></p>\n\n<pre><code>{{define \"base.html\"}}\n&lt;!DOCTYPE html&gt;\n  &lt;html&gt;\n    &lt;head&gt;\n      &lt;title&gt;{{template \"title\" .}}&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n      {{template \"body\" .}}\n    &lt;/body&gt;\n  &lt;/html&gt;\n{{end}}\n</code></pre>\n"}], "owner": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1294, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1553269632, "creation_date": 1552301159, "last_edit_date": 1552564660, "question_id": 55100071, "link": "https://stackoverflow.com/questions/55100071/how-to-use-rendered-template-in-creating-a-pdf", "title": "How to use rendered template in creating a pdf", "body": "<p>Ok so I am Go Lang with the Echo framework, to try and build pdf which will load data from a database source - that bit will come later.</p>\n\n<p>So this is how I am rendering my <code>pdf html</code> layout,</p>\n\n<pre><code>func (c *Controller) DataTest(ec echo.Context) error {\n  return ec.Render(http.StatusOK, \"pdf.html\", map[string]interface{}{\n    \"name\": \"TEST\",\n    \"msg\":  \"Hello, XXXX!\",\n  })\n}\n</code></pre>\n\n<p>The above function works fine, and renders the html (I built a temp path to the function). Now I want to use that function as my html template to build my pdf's.</p>\n\n<p>So I am using <code>wkhtmltopdf</code> and the lib <code>\"github.com/SebastiaanKlippert/go-wkhtmltopdf\"</code></p>\n\n<p>This is how I would render the html in the pdf,</p>\n\n<pre><code>html, err := ioutil.ReadFile(\"./assets/pdf.html\")\n\nif err != nil {\n    return err\n}\n</code></pre>\n\n<p>But I need to be able to update the template so that is why I am trying to render the page and take that into the pdf.</p>\n\n<p>However, the Echo framework returns an error type and not of type bytes or strings and I am not sure how to update it so my rendered content is returned as bytes?</p>\n\n<p>Thanks,</p>\n\n<p>UPDATE</p>\n\n<pre><code>page := wkhtmltopdf.NewPageReader(bytes.NewReader(c.DataTest(data)))\n</code></pre>\n\n<p>This is how I am currently doing, the data is just a html string which is then turned into a slice of bytes for the <code>NewReader</code>. </p>\n\n<p>This works fine, but I wanted to turn the <code>DataTest</code> function into a fully rendered html page by Echo. The problem with that is that when you return a rendered page, it is returned as an error type. </p>\n\n<p>So I was trying to work out a why of updating it, so I could return the data as an html string, which would then be put in as a slice of bytes. </p>\n"}, {"tags": ["go", "proxy", "gonum"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552296402, "post_id": 55098644, "comment_id": 96940444, "body": "You&#39;ll need to find some way around the firewall, then. Contact your admin, or set up some sort of covert tunnel, or use sneakernet (download on another network, and transfer using a USB stick or similar). This really isn&#39;t a programming question."}, {"owner": {"reputation": 6504, "user_id": 1591992, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/145ef738364c736add113829ed84ec84?s=128&d=identicon&r=PG", "display_name": "Wilbert", "link": "https://stackoverflow.com/users/1591992/wilbert"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552298363, "post_id": 55098644, "comment_id": 96941530, "body": "@Flimzy The same solution that would work with sneakernet would work with github. The question is about the dependency automation that golang does. It&#39;s a question that is probably relevant to some degree to everyone who&#39;s coding in go behind a corporate proxy."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552298591, "post_id": 55098644, "comment_id": 96941658, "body": "There is no way to automate this, really. The best you can do is manual copying into your vendor folder--or mange your automated vendoring on a machine with full network connectivity."}, {"owner": {"reputation": 6504, "user_id": 1591992, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/145ef738364c736add113829ed84ec84?s=128&d=identicon&r=PG", "display_name": "Wilbert", "link": "https://stackoverflow.com/users/1591992/wilbert"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552298835, "post_id": 55098644, "comment_id": 96941805, "body": "@Flimzy vendor folder is dep, but gonum uses go.mod (as far as I understand?)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1552298948, "post_id": 55098644, "comment_id": 96941876, "body": "I concur with Flimzy: this is not a programming question but rather an infrastructure question. As to <code>go.mod</code>, Go modules do support <code>vendor</code> directory, too. Also, as a pessimistic fallback, <code>go.mod</code> is just a text file with package URIs and versions after all, so, while painstaking, a manual process of bringing in all the required stuff is possible, done by hand."}, {"owner": {"reputation": 6504, "user_id": 1591992, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/145ef738364c736add113829ed84ec84?s=128&d=identicon&r=PG", "display_name": "Wilbert", "link": "https://stackoverflow.com/users/1591992/wilbert"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1552299103, "post_id": 55098644, "comment_id": 96941966, "body": "@kostix  Which stackexchange site should I ask then? It seems to me this is closely linked to actual golang mechanisms more than unix or linux infrastructure."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1552299315, "post_id": 55098644, "comment_id": 96942089, "body": "@Wilbert, unfortunately, no: there is simply nothing in the <code>go</code> tooling which supports what you&#39;re after for (basically, URL rewriting). So you basically have two routes, as discussed in the comments: manual tinkering (with vendoring or go modules (maybe through the use of a dedicated Go module proxy, which do exist)) or working around the administrative stupidity (and there we transgress into the domains of networking or workplace issues)."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552300018, "post_id": 55098644, "comment_id": 96942509, "body": "&quot;Which stackexchange site should I ask then?&quot; As far as I know, there isn&#39;t one. Just because something isn&#39;t on-topic here doesn&#39;t mean it&#39;s automatically on-topic somewhere else."}, {"owner": {"reputation": 6698, "user_id": 1758853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdbacfa38ad2771753630807afda86a8?s=128&d=identicon&r=PG", "display_name": "Jonathan Muller", "link": "https://stackoverflow.com/users/1758853/jonathan-muller"}, "edited": false, "score": 1, "creation_date": 1552302818, "post_id": 55098644, "comment_id": 96944081, "body": "I don&#39;t think it is off-topic. Go modules doc have some instructions to handle this, see the doc: <a href=\"https://github.com/golang/go/wiki/Modules#are-there-always-on-module-repositories-and-enterprise-proxies\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/&hellip;</a>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 6698, "user_id": 1758853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdbacfa38ad2771753630807afda86a8?s=128&d=identicon&r=PG", "display_name": "Jonathan Muller", "link": "https://stackoverflow.com/users/1758853/jonathan-muller"}, "edited": false, "score": 0, "creation_date": 1552310481, "post_id": 55098644, "comment_id": 96948279, "body": "@JonathanMuller, thanks! I&#39;m happy to be corrected on this."}], "answers": [{"tags": [], "owner": {"reputation": 6698, "user_id": 1758853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdbacfa38ad2771753630807afda86a8?s=128&d=identicon&r=PG", "display_name": "Jonathan Muller", "link": "https://stackoverflow.com/users/1758853/jonathan-muller"}, "is_accepted": false, "score": 2, "last_activity_date": 1552302908, "last_edit_date": 1552302908, "creation_date": 1552302324, "answer_id": 55100436, "question_id": 55098644, "link": "https://stackoverflow.com/questions/55098644/how-to-use-golangs-go-mod-dependency-management-behind-proxy/55100436#55100436", "title": "How to use Golang&#39;s go mod dependency management behind proxy?", "body": "<p>It is possible with go modules. Once you downloaded the gonum sources on your computer, you can tell go to use your local copy instead of the remote one using the <code>replace</code> instruction in your go.mod</p>\n\n<p>Syntax is </p>\n\n<pre><code>module example.com/me/hello\n\nrequire (\n  example.com/me/goodbye v0.0.0\n)\n\nreplace example.com/me/goodbye =&gt; ../goodbye\n</code></pre>\n\n<p><a href=\"https://github.com/golang/go/wiki/Modules#can-i-work-entirely-outside-of-vcs-on-my-local-filesystem\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/Modules#can-i-work-entirely-outside-of-vcs-on-my-local-filesystem</a></p>\n\n<p>It is also possible to setup a proxy outside of your corporate network if the  solution given above is not adapted to your team: <a href=\"https://github.com/golang/go/wiki/Modules#are-there-always-on-module-repositories-and-enterprise-proxies\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/Modules#are-there-always-on-module-repositories-and-enterprise-proxies</a></p>\n"}], "owner": {"reputation": 6504, "user_id": 1591992, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/145ef738364c736add113829ed84ec84?s=128&d=identicon&r=PG", "display_name": "Wilbert", "link": "https://stackoverflow.com/users/1591992/wilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 1, "closed_date": 1552310432, "answer_count": 1, "score": 1, "last_activity_date": 1552928959, "creation_date": 1552296196, "last_edit_date": 1552928959, "question_id": 55098644, "link": "https://stackoverflow.com/questions/55098644/how-to-use-golangs-go-mod-dependency-management-behind-proxy", "closed_reason": "Not suitable for this site", "title": "How to use Golang&#39;s go mod dependency management behind proxy?", "body": "<p>I am trying to set up a project with a gonum dependency and ran into the problem that we have a corporate proxy that blocks many destinations in the internet. </p>\n\n<p>github.com is available over https. \ngonum.org is not. </p>\n\n<p>The gonum repository is hosted on github. Gonum.org forwards to it in some way, as the repo that is checked out in gonum.org/v1/gonum is just a github clone. Using the go mod tooling by default will fetch all code, which fails since the github urls are aliased to gonum.org which the proxy will block.</p>\n\n<p>Is there a way to download gonum via github and use symlinks/copying around to still be able to use it? </p>\n"}, {"tags": ["go", "compiler-errors", "linker-errors", "gccgo"], "comments": [{"owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 0, "creation_date": 1552295441, "post_id": 55098223, "comment_id": 96939912, "body": "What is your GOOS, GOARCH value?"}, {"owner": {"reputation": 1003, "user_id": 3149564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e90af391a073b6b952e8c0f60dfd4cfe?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/3149564/victor"}, "reply_to_user": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 0, "creation_date": 1552295582, "post_id": 55098223, "comment_id": 96939982, "body": "@devdotlog   GOARCH=&quot;amd64&quot;    GOOS=&quot;linux&quot;"}, {"owner": {"reputation": 159, "user_id": 3573024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d560ff0aeb4ce52219a166547fdb09?s=128&d=identicon&r=PG&f=1", "display_name": "mgagnon", "link": "https://stackoverflow.com/users/3573024/mgagnon"}, "edited": false, "score": 1, "creation_date": 1552304441, "post_id": 55098223, "comment_id": 96944983, "body": "It may be permission problems. from your <code>go env</code> output, it\u2019s using GOCACHE and GOROOT directory for the root user while your prompt suggest your are running as <code>victor</code> user. Also, a useful information is that you seems to running from a chroot jail. It would help to know more about your setup in order to help you, it doesn\u2019t looks like a standard go installation."}, {"owner": {"reputation": 1003, "user_id": 3149564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e90af391a073b6b952e8c0f60dfd4cfe?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/3149564/victor"}, "reply_to_user": {"reputation": 159, "user_id": 3573024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d560ff0aeb4ce52219a166547fdb09?s=128&d=identicon&r=PG&f=1", "display_name": "mgagnon", "link": "https://stackoverflow.com/users/3573024/mgagnon"}, "edited": false, "score": 0, "creation_date": 1552307256, "post_id": 55098223, "comment_id": 96946424, "body": "@mgagnon  It is actually running in a <code>schroot</code> jail. The victor&#39;s <code>$HOME</code> is <code>&#47;root</code> in the jail, which is <code>~&#47;root</code> physically. This directory can be written freely by any users."}, {"owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 1, "creation_date": 1552317694, "post_id": 55098223, "comment_id": 96953027, "body": "Do you used gccgo intead of go. example is.... gccgo -c helloworld.go and gccgo -o helloworld helloworld.o"}, {"owner": {"reputation": 1003, "user_id": 3149564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e90af391a073b6b952e8c0f60dfd4cfe?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/3149564/victor"}, "reply_to_user": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 0, "creation_date": 1552318408, "post_id": 55098223, "comment_id": 96953526, "body": "@devdotlog  Wow. I&#39;ve just tried it, and it succeeded. But why?"}, {"owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 0, "creation_date": 1552319169, "post_id": 55098223, "comment_id": 96954014, "body": "golang has two compiler gc, gccgo. gc is default. but your golang used gccgo now. <a href=\"https://stackoverflow.com/questions/25811445/what-are-the-primary-differences-between-gc-and-gccgo\" title=\"what are the primary differences between gc and gccgo\">stackoverflow.com/questions/25811445/&hellip;</a>."}, {"owner": {"reputation": 1003, "user_id": 3149564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e90af391a073b6b952e8c0f60dfd4cfe?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/3149564/victor"}, "reply_to_user": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 0, "creation_date": 1552320896, "post_id": 55098223, "comment_id": 96955169, "body": "@devdotlog But the <code>gc</code> command doesn&#39;t even exist here. Do you mean <code>go</code> will always invoke <code>gc</code> even if it doesn&#39;t exist? If so, then it is a bug of gcc."}], "owner": {"reputation": 1003, "user_id": 3149564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e90af391a073b6b952e8c0f60dfd4cfe?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/3149564/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552297118, "creation_date": 1552294605, "last_edit_date": 1552297118, "question_id": 55098223, "link": "https://stackoverflow.com/questions/55098223/why-does-gccgo-report-such-a-strange-error-message", "title": "Why does gccgo report such a strange error message?", "body": "<p>It is just a simple \"Hello World\" program, with the source code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello, World\")\n}\n</code></pre>\n\n<p>I compiled it, with</p>\n\n<blockquote>\n  <p>go version go1.10.3 gccgo (GCC) 8.3.0 linux/amd64</p>\n</blockquote>\n\n<p>and it reported the following error messages:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[victor@chroot-64:~/go]$ go build helloworld.go \n# command-line-arguments\n/tmp/go-build724467564/b001/_buildid.s: Assembler messages:\n/tmp/go-build724467564/b001/_buildid.s:1: Warning: entity size for SHF_MERGE not specified\n/tmp/go-build724467564/b001/_buildid.s:1: Warning: group name for SHF_GROUP not specified\nas: $WORK/b001/_buildid.o: warning: sh_link not set for section `.go.buildid'\n# command-line-arguments\nBFD: $WORK/b001/_buildid.o: warning: sh_link not set for section `.go.buildid'\n# command-line-arguments\n/usr/bin/ld: $WORK/b001/_pkg_.a(_buildid.o): warning: sh_link not set for section `.go.buildid'\n/usr/bin/ld: unable to place orphaned sharable section .go.buildid (/tmp/go-build724467564/b001/_pkg_.a(_buildid.o))\ncollect2: error: ld returned 1 exit status\n[victor@chroot-64:~/go]$\n</code></pre>\n\n<p>The <code>go env</code> command prints</p>\n\n<pre><code>[victor@chroot-64:~/go]$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOCACHE=\"/root/.cache/go-build\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/root/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/local/libexec/gcc/x86_64-pc-linux-gnu/8.3.0\"\nGCCGO=\"/usr/local/bin/gccgo8\"\nCC=\"gcc8\"\nCXX=\"g++8\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build455330439=/tmp/go-build -gno-record-gcc-switches -funwind-tables\"\n</code></pre>\n"}, {"tags": ["go", "math"], "comments": [{"owner": {"reputation": 2052, "user_id": 5841297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e504d8fcbf8a9f2babac46fa5d281d7c?s=128&d=identicon&r=PG&f=1", "display_name": "Maruthi Adithya", "link": "https://stackoverflow.com/users/5841297/maruthi-adithya"}, "edited": false, "score": 0, "creation_date": 1552290275, "post_id": 55097007, "comment_id": 96937656, "body": "What have you tried so far?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552290370, "post_id": 55097007, "comment_id": 96937698, "body": "What have you tried? Include your code. What problems did you encounter, or where are you trying to improve performance?"}, {"owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552298054, "post_id": 55097007, "comment_id": 96941355, "body": "@Flimzy I just elaborated my question and check it out now."}, {"owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "reply_to_user": {"reputation": 19091, "user_id": 6246044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMZMd.jpg?s=128&g=1", "display_name": "Rory Daulton", "link": "https://stackoverflow.com/users/6246044/rory-daulton"}, "edited": false, "score": 0, "creation_date": 1552298128, "post_id": 55097007, "comment_id": 96941398, "body": "@RoryDaulton I am not get strucked during coding but my intension is to find better and efficient methods"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552298139, "post_id": 55097007, "comment_id": 96941411, "body": "That&#39;s a step in the right direction. What, specifically, are you hoping to improve? Why do you believe it performs poorly?"}, {"owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "edited": false, "score": 0, "creation_date": 1552298351, "post_id": 55097007, "comment_id": 96941523, "body": "@filmzy I got this problem during one of a coding competition and they asked to solve it using less number of loops. I hope you guys understand.In my code u guys can see so many nested loops and I think it is not a good practice. So I need better suggestions from the community side"}, {"owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "reply_to_user": {"reputation": 2052, "user_id": 5841297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e504d8fcbf8a9f2babac46fa5d281d7c?s=128&d=identicon&r=PG&f=1", "display_name": "Maruthi Adithya", "link": "https://stackoverflow.com/users/5841297/maruthi-adithya"}, "edited": false, "score": 0, "creation_date": 1552298527, "post_id": 55097007, "comment_id": 96941616, "body": "@MaruthiAdithya please check the code and playground link I provided."}, {"owner": {"reputation": 2052, "user_id": 5841297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e504d8fcbf8a9f2babac46fa5d281d7c?s=128&d=identicon&r=PG&f=1", "display_name": "Maruthi Adithya", "link": "https://stackoverflow.com/users/5841297/maruthi-adithya"}, "edited": false, "score": 0, "creation_date": 1552299380, "post_id": 55097007, "comment_id": 96942134, "body": "@ASHWINRAJEEV <a href=\"https://math.stackexchange.com/questions/8611/number-of-common-divisors-between-two-given-numbers\" title=\"number of common divisors between two given numbers\">math.stackexchange.com/questions/8611/&hellip;</a>"}, {"owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "reply_to_user": {"reputation": 19091, "user_id": 6246044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMZMd.jpg?s=128&g=1", "display_name": "Rory Daulton", "link": "https://stackoverflow.com/users/6246044/rory-daulton"}, "edited": false, "score": 0, "creation_date": 1552300229, "post_id": 55097007, "comment_id": 96942620, "body": "@RoryDaulton numbers can be in the range (-9,223,372,036,854,775,808 to +9,223,372,036,854,775,807). Please check my code I use int64."}, {"owner": {"reputation": 19091, "user_id": 6246044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMZMd.jpg?s=128&g=1", "display_name": "Rory Daulton", "link": "https://stackoverflow.com/users/6246044/rory-daulton"}, "edited": false, "score": 0, "creation_date": 1552302996, "post_id": 55097007, "comment_id": 96944162, "body": "I see that those are the <i>possible</i> numbers. But if you want to program for efficiency, you need to know the range of <i>expected</i> numbers--i.e. the numbers for which you want your program to be efficient. One algorithm works well for small numbers, another for intermediate numbers (around 32 bits), another for large (around 64 bits). The latter requires very sophisticated mathematics."}, {"owner": {"reputation": 19091, "user_id": 6246044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMZMd.jpg?s=128&g=1", "display_name": "Rory Daulton", "link": "https://stackoverflow.com/users/6246044/rory-daulton"}, "edited": false, "score": 0, "creation_date": 1552320538, "post_id": 55097007, "comment_id": 96954918, "body": "One last question from me. Your title and your description ask only to find the number of common factors. But your example input shows much more: a list of the factors of each number and a list of the common factors. What exactly do you want?"}, {"owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "reply_to_user": {"reputation": 19091, "user_id": 6246044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMZMd.jpg?s=128&g=1", "display_name": "Rory Daulton", "link": "https://stackoverflow.com/users/6246044/rory-daulton"}, "edited": false, "score": 0, "creation_date": 1552392831, "post_id": 55097007, "comment_id": 96983861, "body": "@RoryDaulton please encourage questioning and don&#39;t think like a pro. My question is simple to understand and you can implement it using whatever method you know it is a field for knowledge sharing right."}], "answers": [{"comments": [{"owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "edited": false, "score": 0, "creation_date": 1552395833, "post_id": 55118401, "comment_id": 96985688, "body": "Good code recursion method is nice. Can you please add a go playground link also"}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 1, "last_activity_date": 1552383965, "creation_date": 1552383965, "answer_id": 55118401, "question_id": 55097007, "link": "https://stackoverflow.com/questions/55097007/most-efficient-method-of-finding-the-number-of-common-factors-of-two-numbers/55118401#55118401", "title": "Most efficient method of finding the number of common factors of two numbers", "body": "<p>Answer 1, with no loops just recursion</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n)\n\nfunc factors(n int, t int, res *[]int) *[]int {\n    if t != 0 {\n        if (n/t)*t == n {\n            temp := append(*res, t)\n            res = &amp;temp\n        }\n        res = factors(n, t-1, res)\n    }\n    return res\n}\n\nfunc cf(l1 []int, l2 []int, res *[]int) *[]int {\n    if len(l1) &gt; 0 &amp;&amp; len(l2) &gt; 0 {\n        v1 := l1[0]\n        v2 := l2[0]\n        if v1 == v2 {\n            temp := append(*res, v1)\n            res = &amp;temp\n            l2 = l2[1:]\n        }\n        if v2 &gt; v1 {\n            l2 = l2[1:]\n        } else {\n            l1 = l1[1:]\n        }\n        res = cf(l1, l2, res)\n    }\n    return res\n}\n\nfunc main() {\n    n, err := strconv.Atoi(os.Args[1])\n    n2, err := strconv.Atoi(os.Args[2])\n    if err != nil {\n        fmt.Println(\"give a number\")\n        panic(err)\n    }\n    factorlist1 := factors(n, n, &amp;[]int{})\n    factorlist2 := factors(n2, n2, &amp;[]int{})\n    fmt.Printf(\"factors of %d %v\\n\", n, factorlist1)\n    fmt.Printf(\"factors of %d %v\\n\", n2, factorlist2)\n    common := cf(*factorlist1, *factorlist2, &amp;[]int{})\n    fmt.Printf(\"number of common factors = %d\\n\", len(*common))\n\n}\n</code></pre>\n\n<p>However, this blows up with larger numbers such as 42512703</p>\n\n<p>replacing the func that do the work with iterative versions can cope with bigger numbers</p>\n\n<pre><code>func factors(n int) []int {\n        res := []int{}\n        for t := n; t &gt; 0; t-- {\n                if (n/t)*t == n {\n                        res = append(res, t)\n                }\n        }\n        return res\n}\n\nfunc cf(l1 []int, l2 []int) []int {\n        res := []int{}\n        for len(l1) &gt; 0 &amp;&amp; len(l2) &gt; 0 {\n                v1 := l1[0]\n                v2 := l2[0]\n                if v1 == v2 {\n                        res = append(res, v1)\n                        l2 = l2[1:]\n                }\n                if v2 &gt; v1 {\n                        l2 = l2[1:]\n                } else {\n                        l1 = l1[1:]\n                }\n        }\n        return res\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14951212, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GivNb13Sgym5QqEmLyxgGTCwNwHwIKZk_T9b12euA=k-s128", "display_name": "ichsanputr", "link": "https://stackoverflow.com/users/14951212/ichsanputr"}, "is_accepted": false, "score": 0, "last_activity_date": 1609930955, "last_edit_date": 1609930955, "creation_date": 1609930627, "answer_id": 65594489, "question_id": 55097007, "link": "https://stackoverflow.com/questions/55097007/most-efficient-method-of-finding-the-number-of-common-factors-of-two-numbers/65594489#65594489", "title": "Most efficient method of finding the number of common factors of two numbers", "body": "<p>func Divisors(n int)int{</p>\n<pre><code>prev := []int{}\n\nfor i := n;i &gt; 0;i--{\n    prev = append(prev,i)\n}\n\nvar res int\n\nfor j := prev[0];j &gt; 0;j--{\n    if n % j == 0 {\n        res++\n    }\n}\n\nreturn res\n</code></pre>\n<p>}</p>\n"}], "owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 55118401, "answer_count": 2, "score": -7, "last_activity_date": 1609930955, "creation_date": 1552289308, "last_edit_date": 1552298113, "question_id": 55097007, "link": "https://stackoverflow.com/questions/55097007/most-efficient-method-of-finding-the-number-of-common-factors-of-two-numbers", "title": "Most efficient method of finding the number of common factors of two numbers", "body": "<p><strong>I have two numbers for example the numbers are 12 and 16.</strong></p>\n\n<blockquote>\n  <p>factors of 12 are 1, 2, 3, 4, 6, 12</p>\n  \n  <p>factors of 16 are 1, 2, 4, 8, 16</p>\n  \n  <p>common factors of these two numbers are 1, 2 and 4.</p>\n</blockquote>\n\n<p>So the number of common factors are 3. I need to build a Go program for finding the number common factors of two numbers. But the program should be efficient and with minimum number of loops or without loops.\nI will provide my code and you can also contribute and suggest with another best methods.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar (\n    fs    []int64\n    fd    []int64\n    count int\n)\n\nfunc main() {\n    commonFactor(16, 12)\n    commonFactor(5, 10)\n}\n\nfunc commonFactor(num ...int64) {\n    count = 0\n    if num[0] &lt; 1 || num[1] &lt; 1 {\n        fmt.Println(\"\\nFactors not computed\")\n        return\n    }\n    for _, val := range num {\n        fs = make([]int64, 1)\n        fmt.Printf(\"\\nFactors of %d: \", val)\n        fs[0] = 1\n        apf := func(p int64, e int) {\n            n := len(fs)\n            for i, pp := 0, p; i &lt; e; i, pp = i+1, pp*p {\n                for j := 0; j &lt; n; j++ {\n                    fs = append(fs, fs[j]*pp)\n                }\n            }\n        }\n        e := 0\n        for ; val&amp;1 == 0; e++ {\n            val &gt;&gt;= 1\n        }\n        apf(2, e)\n        for d := int64(3); val &gt; 1; d += 2 {\n            if d*d &gt; val {\n                d = val\n            }\n            for e = 0; val%d == 0; e++ {\n                val /= d\n            }\n            if e &gt; 0 {\n                apf(d, e)\n            }\n        }\n        if fd == nil {\n            fd = fs\n        }\n        fmt.Println(fs)\n    }\n    for _, i := range fs {\n        for _, j := range fd {\n            if i == j {\n                count++\n            }\n        }\n    }\n    fmt.Println(\"Number of common factors =\", count)\n}\n</code></pre>\n\n<p>Output is :</p>\n\n<blockquote>\n  <p>Factors of 16: [1 2 4 8 16] Factors of 12: [1 2 4 3 6 12]</p>\n  \n  <p>Number of common factors = 3</p>\n  \n  <p>Factors of 5: [1 5] Factors of 10: [1 2 5 10]</p>\n  \n  <p>Number of common factors = 2</p>\n</blockquote>\n\n<p><a href=\"https://play.golang.org/p/7k7m1aG8ZE0\" rel=\"nofollow noreferrer\">Goplayground</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2679, "user_id": 3005034, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/t4Snl.jpg?s=128&g=1", "display_name": "rgareth", "link": "https://stackoverflow.com/users/3005034/rgareth"}, "edited": false, "score": 1, "creation_date": 1552294406, "post_id": 55097980, "comment_id": 96939381, "body": "Nobody said this code would be committed directly. Finding and updating the files that would change is a perfectly good first step. Your downvote and non-answer here is exactly what they are describing here: <a href=\"https://stackoverflow.blog/2018/04/26/stack-overflow-isnt-very-welcoming-its-time-for-that-to-change/\">stackoverflow.blog/2018/04/26/&hellip;</a>"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": -3, "last_activity_date": 1552293527, "creation_date": 1552293527, "answer_id": 55097980, "question_id": 55096868, "link": "https://stackoverflow.com/questions/55096868/update-go-module-import-references-after-major-dependency-update/55097980#55097980", "title": "Update go module import references after major dependency update", "body": "<p>As a new major version indicates breaking compatibility you will have to fix your code manually anyway: Updating the import path in case of a new major version is your least concern to automate. </p>\n"}, {"tags": [], "owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "is_accepted": false, "score": 1, "last_activity_date": 1552680626, "last_edit_date": 1552680626, "creation_date": 1552680067, "answer_id": 55189901, "question_id": 55096868, "link": "https://stackoverflow.com/questions/55096868/update-go-module-import-references-after-major-dependency-update/55189901#55189901", "title": "Update go module import references after major dependency update", "body": "<p>A good automated solution is <a href=\"https://github.com/marwan-at-work/mod\" rel=\"nofollow noreferrer\">https://github.com/marwan-at-work/mod</a>, which can automatically add, remove, or change the required <code>/vN</code> in your <code>*.go</code> code and your <code>go.mod</code>.</p>\n\n<p>Using your example, it should be able to update your code from using <code>github.com/google/go-github/v20</code> to instead use <code>github.com/google/go-github/v24</code>.</p>\n\n<p>From the repository:</p>\n\n<blockquote>\n  <p>Motivation</p>\n  \n  <p>There are two good use cases to do this:</p>\n  \n  <ol>\n  <li><p>If you own a library and you want to introduce a breaking change, then you have to go around all your Go files and sub-pacakges and\n  update the import paths to include v2, v3, etc. This tool just does it\n  automatically with one command.</p></li>\n  <li><p>If you own a library that is already tagged v2 or above but is incompatible with Semantic Import Versioning, then this tool can solve\n  the problem for you with one command as well. Introduce a go.mod file\n  with the correct import path, and just run mod upgrade once or mod\n  -t=X upgrade (where x is the latest tag major) to update the import paths of your go files to match whatever tag you're at.</p></li>\n  </ol>\n</blockquote>\n\n<p>In addition to those two use cases, this utility also relatively recently added support for automatically upgrading clients to use a different major version of a module by changing the <code>/vN</code> in the client's <code>*.go</code> code and the client's <code>go.mod</code>.  </p>\n\n<p>In other words, this utility can be used if you are the author of a module going from <code>v2</code> to <code>v3</code>, and it can also be used if you are the consumer of a module going from <code>v2</code> to <code>v3</code>.</p>\n\n<p>It uses packages such as <code>golang.org/x/tools/go/ast/astutil</code> to manipulate the AST of <code>*.go</code> source in order to update import paths, and hence should not be susceptible to the types of concerns you expressed about using <code>sed</code>.</p>\n"}], "owner": {"reputation": 2679, "user_id": 3005034, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/t4Snl.jpg?s=128&g=1", "display_name": "rgareth", "link": "https://stackoverflow.com/users/3005034/rgareth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1076, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1552680626, "creation_date": 1552288763, "last_edit_date": 1552295199, "question_id": 55096868, "link": "https://stackoverflow.com/questions/55096868/update-go-module-import-references-after-major-dependency-update", "title": "Update go module import references after major dependency update", "body": "<p>Scenario: I need to update a third party Go Module to a new major version across a repository.</p>\n\n<p>Example: <code>github.com/google/go-github/v20</code> to <code>github.com/google/go-github/v24</code></p>\n\n<p>After updating <code>go.mod</code> and <code>go.sum</code>, how can I programmatically update all <code>import</code> statements within the repository to match?</p>\n\n<p>Here is a simple approach that is not fool-proof:</p>\n\n<p><code>find *.go -type f -print0 | xargs -0 sed -i '' 's/\"github.com\\/google\\/go-github\\/v20/\"github.com\\/google\\/go-github\\/v24/g'</code></p>\n\n<p>This would catch all string instances and not just within <code>import</code> (although that is not necessarily a bad thing). But I worry in cases where the update may be from <code>github.com/abc/def</code> to <code>github.com/abc/dev/v2</code> because there may also be a module named <code>github.com/abc/def-core</code>, for example.</p>\n\n<p>Please note that this question is not intending to also capture the \"you may have breaking changes and need to update your code\" yada yada - that's a separate topic and not asked about here.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4179, "user_id": 1293013, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9oztA.jpg?s=128&g=1", "display_name": "r\u0251\u02d0d\u0292\u0251", "link": "https://stackoverflow.com/users/1293013/r%c9%91%cb%90d%ca%92%c9%91"}, "edited": false, "score": 0, "creation_date": 1552286691, "post_id": 55096443, "comment_id": 96936297, "body": "<a href=\"https://medium.com/@ivan.corrales.solera/migrating-to-go-mod-in-just-3-steps-6b6a07a04640\" rel=\"nofollow noreferrer\">medium.com/@ivan.corrales.solera/&hellip;</a>"}, {"owner": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "edited": false, "score": 1, "creation_date": 1552286818, "post_id": 55096443, "comment_id": 96936345, "body": "Note that the import path changes as well for upgrades of the major version. It should be now <code>CODEPATH&#47;v2</code>"}, {"owner": {"reputation": 1948, "user_id": 1924657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gumlg.jpg?s=128&g=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/1924657/bryce"}, "reply_to_user": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "edited": false, "score": 0, "creation_date": 1552286931, "post_id": 55096443, "comment_id": 96936380, "body": "@Henry I tried to add /v2 but with the <code>go get</code> command the go.mod seems to change to v2.0.0"}], "answers": [{"tags": [], "owner": {"reputation": 1948, "user_id": 1924657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gumlg.jpg?s=128&g=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/1924657/bryce"}, "is_accepted": false, "score": 1, "last_activity_date": 1552388383, "last_edit_date": 1552388383, "creation_date": 1552387949, "answer_id": 55119729, "question_id": 55096443, "link": "https://stackoverflow.com/questions/55096443/how-to-upgrade-go-mod-to-v2-or-higher-version/55119729#55119729", "title": "how to upgrade go mod to v2 or higher version?", "body": "<p>I tried myself and it worked.</p>\n\n<ol>\n<li>Add <code>/v2</code> to your go.mod's module line <code>module github.com/mnhkahn/aaa/v2</code>;</li>\n<li>If you import submodule, import like this <code>import \"github.com/mnhkahn/aaa/v2/config\"</code>;</li>\n<li>Create a tag with name v2.0.0;</li>\n<li><code>go get github.com/mnhkahn/aaa/v2</code>;</li>\n<li><code>go mod tidy</code>;</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "is_accepted": false, "score": 1, "last_activity_date": 1552681020, "creation_date": 1552681020, "answer_id": 55190084, "question_id": 55096443, "link": "https://stackoverflow.com/questions/55096443/how-to-upgrade-go-mod-to-v2-or-higher-version/55190084#55190084", "title": "how to upgrade go mod to v2 or higher version?", "body": "<p>The <a href=\"https://stackoverflow.com/a/55119729/11210494\">answer</a> from Bryce looks good if you are doing this manually.</p>\n\n<p>If you are interested in an automated approach (for example, perhaps you have many files you would need to visit), a good automated solution is <a href=\"https://github.com/marwan-at-work/mod\" rel=\"nofollow noreferrer\">https://github.com/marwan-at-work/mod</a>, which can automatically add, remove, or change the required <code>/vN</code> in your <code>*.go</code> code and your <code>go.mod</code>. See <a href=\"https://stackoverflow.com/a/55189901/11210494\">this answer</a> for more details.</p>\n"}], "owner": {"reputation": 1948, "user_id": 1924657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gumlg.jpg?s=128&g=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/1924657/bryce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1552681020, "creation_date": 1552286485, "last_edit_date": 1552287152, "question_id": 55096443, "link": "https://stackoverflow.com/questions/55096443/how-to-upgrade-go-mod-to-v2-or-higher-version", "title": "how to upgrade go mod to v2 or higher version?", "body": "<p>My go package version is v1.0.7 and now I want to upgrade it to v2.0.0. I create a new tag with it bug when I use <code>go get CODEPATH</code> it still use version v1.0.7. The go.mod should like <code>require CODEPATH v2.0.0+incompatible</code> but I want to know what command will do this?</p>\n\n<p>The document <a href=\"https://github.com/golang/go/wiki/Modules#releasing-modules-v2-or-higher\" rel=\"nofollow noreferrer\">Modules</a> says that add /v2 to module path but didn't tell how to upgrade client's go.mod.</p>\n"}, {"tags": ["docker", "go", "docker-compose"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552290411, "post_id": 55095544, "comment_id": 96937719, "body": "Don&#39;t post screen shots of text. Instead, copy and paste the text directly into the question."}], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1552283002, "post_id": 55095770, "comment_id": 96935184, "body": "Same idea in <a href=\"https://www.callicoder.com/docker-compose-multi-container-orchestration-golang/\" rel=\"nofollow noreferrer\">callicoder.com/&hellip;</a>"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552283545, "post_id": 55095770, "comment_id": 96935323, "body": "Hello! Thank you for links. Let me try to explain what I am doing right now. I created this application in Windows 10. When I try to create <code>go.mod</code> file in <code>Windows 10</code> I see such error: <code>go: modules disabled inside GOPATH&#47;src by GO111MODULE=auto; see &#39;go help modules&#39;</code>. It seems like I need to make this command in CentOS server, right?!"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 1, "creation_date": 1552283643, "post_id": 55095770, "comment_id": 96935352, "body": "@NurzhanNogerbek Yes, or you can compile directly in Windows 10, but with cross-compilation (<a href=\"https://stackoverflow.com/a/50912419/6309\">stackoverflow.com/a/50912419/6309</a>). And you can check out <a href=\"https://www.reddit.com/r/golang/comments/alrnuk/receiving_the_following_error_go_modules_disabled/\" rel=\"nofollow noreferrer\">reddit.com/r/golang/comments/alrnuk/&hellip;</a>"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552286703, "post_id": 55095770, "comment_id": 96936303, "body": "I am confused. Am I to understand that in <code>Dockerfile</code> I need to install all third-party libraries? For example <code>RUN go get github.com&#47;gorilla&#47;mux</code> instead of <code>RUN go get github.com&#47;cespare&#47;reflex</code>? As I know <code>go get</code> command need git, right? Do I need to install <code>git</code> in <code>Dockerfile</code>?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552288314, "post_id": 55095770, "comment_id": 96936856, "body": "@NurzhanNogerbek If you are building a project with <code>go.mod</code> in it (after a <code>go mod init</code>), you don&#39;t need to go get anything: a go build will go get the dependencies for you."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552288378, "post_id": 55095770, "comment_id": 96936870, "body": "@NurzhanNogerbek The Dockerfile in the answer is just an example where the programmer had to get the source of his/her project first, then build it. In your case, it is not needed, since your sources are already local."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552288401, "post_id": 55095770, "comment_id": 96936878, "body": "I also tried to compile the binary file with the help of next command: <code>$Env:GOOS = &quot;linux&quot;; $Env:GOARCH = &quot;amd64&quot;; go build</code>. It raise error. Can you check my post again please?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552288519, "post_id": 55095770, "comment_id": 96936910, "body": "@NurzhanNogerbek Yes,  I saw your edit and I am researching it. But you are starting to cram a lot of questions in this page ;)"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552288828, "post_id": 55095770, "comment_id": 96937017, "body": "In production server I don&#39;t have <code>golang</code>. For thats why I can&#39;t use <code>go.mod</code> file. I think the best way is to create binary file in my local windows machine. Send it to production server and configurate Dockerfile. What do you think about that?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552289277, "post_id": 55095770, "comment_id": 96937205, "body": "@NurzhanNogerbek Yes, in your local Windows machine, you have Docker, so you can make an image with the right tools in it to compile your program directly in Linux container. From Windows."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1552288685, "last_edit_date": 1552288685, "creation_date": 1552282794, "answer_id": 55095770, "question_id": 55095544, "link": "https://stackoverflow.com/questions/55095544/how-correctly-set-up-third-party-libraries-of-golang-application-with-the-help-o/55095770#55095770", "title": "How correctly set up third-party libraries of golang application with the help of docker compose?", "body": "<blockquote>\n  <p>Is it possible to create go.mod file on Windows 10?</p>\n</blockquote>\n\n<p>Yes, as long as you have a <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">Go 1.11/1.12</a> </p>\n\n<p>But to use it with a docker-compose, you can follow \"<a href=\"https://threedots.tech/post/go-docker-dev-environment-with-go-modules-and-live-code-reloading/\" rel=\"nofollow noreferrer\">Go Docker dev environment with Go Modules and live code reloading</a>\" from Mi\u0142osz Sm\u00f3\u0142ka</p>\n\n<p>He uses one Dockerfile for compilation:</p>\n\n<pre><code>FROM golang:1.11.2-stretch\nRUN go get github.com/cespare/reflex\nCOPY reflex.conf /\nENTRYPOINT [\"reflex\", \"-c\", \"/reflex.conf\"]\n</code></pre>\n\n<p>Then a docker-compose for execution, mounting the compiled executable, *and the <a href=\"https://stackoverflow.com/q/52126923/6309\">Go module cache</a>:</p>\n\n<pre><code>version: '3'\nservices:\n  publisher:\n    build: .\n    volumes:\n      - ./publisher:/app\n      - $GOPATH/pkg/mod/cache:/go/pkg/mod/cache\n    working_dir: /app\n    env_file:\n      - .env\n    ports:\n      - 5000:5000\n</code></pre>\n\n<hr>\n\n<p>Regarding the cross-compilation issue with <a href=\"https://github.com/go-goracle/goracle\" rel=\"nofollow noreferrer\"><code>go-goracle/goracle</code></a>, <a href=\"https://github.com/go-goracle/goracle/issues/59\" rel=\"nofollow noreferrer\">issue 59</a> details:</p>\n\n<blockquote>\n  <p>goracle needs CGO to compile in the Oracle OCI libs.<br>\n  So either a cross-compiling C toolchain is required (and special env vars set\n  accordingly), or a native env (that's easier, IMHO).</p>\n</blockquote>\n\n<p>Meaning: don't try to cross-compile it from Windows, do it in a Dockerfile using directly the right OS (through a Linux VM, which is the case with <a href=\"https://docs.docker.com/machine/get-started/\" rel=\"nofollow noreferrer\">Windows 10 HyperV environment</a>).</p>\n"}], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 1, "accepted_answer_id": 55095770, "answer_count": 1, "score": 0, "last_activity_date": 1552290398, "creation_date": 1552281057, "last_edit_date": 1552290398, "question_id": 55095544, "link": "https://stackoverflow.com/questions/55095544/how-correctly-set-up-third-party-libraries-of-golang-application-with-the-help-o", "title": "How correctly set up third-party libraries of golang application with the help of docker compose?", "body": "<p>I am trying to deploy my <strong>Golang</strong> application with the help of docker compose.</p>\n\n<p>In CentOS server the hierarchy of folders:</p>\n\n<pre><code>docker_app\n - src\n   - app\n     - docker-compose.yml\n     - main.go\n</code></pre>\n\n<p>This Golang application use several third-party libraries:</p>\n\n<ul>\n<li><p>Gorilla Mux;</p></li>\n<li><p>Gorilla Handlers;</p></li>\n<li><p>pq;</p></li>\n<li><p>godotenv;</p></li>\n<li><p>GORM;</p></li>\n<li><p>goracle.</p></li>\n</ul>\n\n<p><strong>docker-compose.yml</strong>:</p>\n\n<pre><code>version: '2'\n\nservices:\n  app:\n    image: golang:1.11-alpine\n    volumes:\n      - .:/go/src/app\n    working_dir: /go/src/app\n    command: go run main.go\n</code></pre>\n\n<p>When I try to run <code>docker-compose up</code> project it raise error:</p>\n\n<pre><code>Attaching to app_app_1\napp_1  | main.go:4:2: cannot find package \"github.com/gorilla/handlers\" in any of:\napp_1  |      /usr/local/go/src/github.com/gorilla/handlers (from $GOROOT)\napp_1  |      /go/src/github.com/gorilla/handlers (from $GOPATH)\n</code></pre>\n\n<p>As you can see I need to set up third-party libraries. How to make it correctly? Also how to set up the name of the future docker image and contaiener with the help of docker compose?</p>\n\n<p>Is it possible to create <code>go.mod</code> file on <code>Windows 10</code>?</p>\n\n<p>When I run <code>$Env:GOOS = \"linux\"; $Env:GOARCH = \"amd64\"; go build</code> command in Powershell it raise error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NfH5c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NfH5c.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["multithreading", "go", "asynchronous", "server"], "comments": [{"owner": {"reputation": 481, "user_id": 8835085, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1TS2rfl2G1U/AAAAAAAAAAI/AAAAAAAAAXA/zHjV-k_7vqE/photo.jpg?sz=128", "display_name": "Kognise", "link": "https://stackoverflow.com/users/8835085/kognise"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1552280227, "post_id": 55095420, "comment_id": 96934611, "body": "@mh-cbon If the user closes the tab before the task is finished what will happen? I understand the concept of goroutines (I hope). Also, link is broken"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1552281370, "post_id": 55095420, "comment_id": 96934847, "body": "When you start a goroutine, it continues until the goroutine function returns, no matter how long it takes (assuming the process doesn&#39;t exit for some reason). The section in the Tour of Go about goroutines is here: <a href=\"https://tour.golang.org/concurrency/1\" rel=\"nofollow noreferrer\">tour.golang.org/concurrency/1</a>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1552284335, "post_id": 55095420, "comment_id": 96935547, "body": "<code>If the user closes the tab before the task is finished what will happen?</code> for as long you start the job in background (goroutine) and respond immediately, nothing. if you were to stop the process when the tab close (ie tcp conn as mentionned in the answer) that would not be a non blocking process anymore, and in http specifically that would we be long polling technique, which is different from what you described."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1552290475, "post_id": 55095420, "comment_id": 96937739, "body": "Goroutines are perfect for this. The only question is how to handle the HTTP request while the task happens in the background. There are many ways to do this."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552314659, "post_id": 55095420, "comment_id": 96951041, "body": "Your HTTP server itself is running in a goroutine and likely running as long as your process is. Goroutines run as long as they need to, I&#39;m not sure where you go the impression they were &quot;meant for short running async code&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1552284166, "creation_date": 1552284166, "answer_id": 55096028, "question_id": 55095420, "link": "https://stackoverflow.com/questions/55095420/long-running-tasks-in-a-web-server/55096028#55096028", "title": "Long running tasks in a web server", "body": "<p>No: a goroutine can last as long as you want (and the main program): you only need to know, as <a href=\"https://stackoverflow.com/a/9544599/6309\">mentioned here</a>, when to terminate said goroutine.</p>\n\n<p>In your case, you would have to detect your connection has been terminated by the user, as in \"<a href=\"https://stackoverflow.com/q/50187876/6309\">Close the goroutine reading from a TCP connection without closing connection</a>\".</p>\n"}], "owner": {"reputation": 481, "user_id": 8835085, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1TS2rfl2G1U/AAAAAAAAAAI/AAAAAAAAAXA/zHjV-k_7vqE/photo.jpg?sz=128", "display_name": "Kognise", "link": "https://stackoverflow.com/users/8835085/kognise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 1, "accepted_answer_id": 55096028, "answer_count": 1, "score": 0, "last_activity_date": 1552290453, "creation_date": 1552280035, "last_edit_date": 1552290453, "question_id": 55095420, "link": "https://stackoverflow.com/questions/55095420/long-running-tasks-in-a-web-server", "title": "Long running tasks in a web server", "body": "<p>I'm using <code>fasthttp</code> to make an HTTP server in Go. When the user visits a certain route, say <code>/foo</code> I want to start a very long running task (think 10m+), but respond to the request immediately. This long running task should continue running in the background until it exits even if the function returns or the user terminates the connection.</p>\n\n<p>What is the best way to do that in Go?</p>\n\n<p>As far as I can tell Goroutines are probably not the right thing because they're meant for short running async code, or am I wrong about that?</p>\n"}, {"tags": ["go", "module"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1552282079, "post_id": 55095295, "comment_id": 96934984, "body": "What the content of <code>go.mod</code> file?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1552307595, "post_id": 55095295, "comment_id": 96946616, "body": "Always use the full import path, relative paths are not supported."}, {"owner": {"reputation": 1, "user_id": 5841615, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c9C7h7-3MZo/AAAAAAAAAAI/AAAAAAAAAD4/SY3U_jB_K7k/photo.jpg?sz=128", "display_name": "zenos", "link": "https://stackoverflow.com/users/5841615/zenos"}, "edited": false, "score": 0, "creation_date": 1553505817, "post_id": 55095295, "comment_id": 97394275, "body": "I have solved this problem. In go 1.12, import a package of relative path should import &quot;demo_project/demo&quot;, but before 1.12, import &quot;./demo&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1552291754, "post_id": 55096828, "comment_id": 96938244, "body": "Can you add some explanation to your answer? How does it solve the question?"}, {"owner": {"reputation": 833, "user_id": 4456192, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/JQgPi.png?s=128&g=1", "display_name": "debug", "link": "https://stackoverflow.com/users/4456192/debug"}, "reply_to_user": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1552293475, "post_id": 55096828, "comment_id": 96938943, "body": "<a href=\"https://golang.org/doc/code.html#GOPATH,To\" rel=\"nofollow noreferrer\">golang.org/doc/code.html#GOPATH,To</a> learn more about the GOPATH environment variable, see &#39;go help gopath&#39; in your console."}, {"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1552293916, "post_id": 55096828, "comment_id": 96939152, "body": "Please add all explanation to your answer, not to the comment section. And please don&#39;t use links only - keep in mind that others should be able to learn from your answer"}, {"owner": {"reputation": 833, "user_id": 4456192, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/JQgPi.png?s=128&g=1", "display_name": "debug", "link": "https://stackoverflow.com/users/4456192/debug"}, "edited": false, "score": 0, "creation_date": 1552293999, "post_id": 55096828, "comment_id": 96939198, "body": "Please see the error demo, and everything is clear."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1552307557, "post_id": 55096828, "comment_id": 96946593, "body": "@debug: the question is asking about modules, which doesn&#39;t use GOPATH"}], "tags": [], "owner": {"reputation": 833, "user_id": 4456192, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/JQgPi.png?s=128&g=1", "display_name": "debug", "link": "https://stackoverflow.com/users/4456192/debug"}, "is_accepted": false, "score": -3, "last_activity_date": 1552294282, "last_edit_date": 1552294282, "creation_date": 1552288580, "answer_id": 55096828, "question_id": 55095295, "link": "https://stackoverflow.com/questions/55095295/golang-1-12-import-relative-directory-module/55096828#55096828", "title": "golang 1.12 import relative directory module", "body": "<ul>\n<li><p><strong>GO</strong> wants to import the package from $GOPATH env at first. If <strong>go</strong> can't find the package, an error is raised.</p></li>\n<li><p>Add our project directory into <strong>$GOPATH</strong> env. </p></li>\n</ul>\n\n<hr>\n\n<pre><code>debug@ulab:/tmp/test$ go run main.go\nmain.go:3:8: cannot find package \"mylib\" in any of:\n    /home/debug/.golang/go/src/mylib (from $GOROOT)\n    /home/debug/.golang/gopath/src/mylib (from $GOPATH)\n</code></pre>\n\n<hr>\n\n<pre><code>$ tree\n.\n\u251c\u2500\u2500 main.go\n\u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 hello\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 hello.go\n\u2514\u2500\u2500 start.sh\n\n2 directories, 3 files\n</code></pre>\n\n<hr>\n\n<pre><code>$ cat start.sh\n#!/bin/sh\n\nGOPATH=\"$(pwd):$(go env GOPATH)\"\n\ngo run main.go\n</code></pre>\n\n<hr>\n\n<pre><code>$ ./start.sh\nWelcome to golang\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5841615, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c9C7h7-3MZo/AAAAAAAAAAI/AAAAAAAAAD4/SY3U_jB_K7k/photo.jpg?sz=128", "display_name": "zenos", "link": "https://stackoverflow.com/users/5841615/zenos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1552294282, "creation_date": 1552279055, "question_id": 55095295, "link": "https://stackoverflow.com/questions/55095295/golang-1-12-import-relative-directory-module", "title": "golang 1.12 import relative directory module", "body": "<p>go 1.12 how to import a relative path module.\ne.g</p>\n\n<pre><code>demo_project\n   - main.go\n   -- demo\n      - demo.go\n\n\ndemo.go:\npakcage demo\n...\n</code></pre>\n\n<p>I have try to import \"./demo\" in main.go,but it's report a error message:\ncannot find module for path _/home/xxx/mywork/go_project/grpc_demo/demo\nhow to import demo in main.go</p>\n"}, {"tags": ["go", "websocket"], "comments": [{"owner": {"reputation": 135, "user_id": 4208321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/743ad69fd421838322645c1b0820b370?s=128&d=identicon&r=PG&f=1", "display_name": "satinder", "link": "https://stackoverflow.com/users/4208321/satinder"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1552350110, "post_id": 55094133, "comment_id": 96967130, "body": "Thanks, will try to understand this example&#39;s code and use it to fix mine. will update question if stuck again."}, {"owner": {"reputation": 135, "user_id": 4208321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/743ad69fd421838322645c1b0820b370?s=128&d=identicon&r=PG&f=1", "display_name": "satinder", "link": "https://stackoverflow.com/users/4208321/satinder"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1552362934, "post_id": 55094133, "comment_id": 96969904, "body": "came across this video, which also explains the same concept: <a href=\"https://www.youtube.com/watch?v=cNxfgXrHeAg\" rel=\"nofollow noreferrer\">youtube.com/watch?v=cNxfgXrHeAg</a>  I did not had thought of using own type struct as channel type. gonna play with that code. :-)"}, {"owner": {"reputation": 135, "user_id": 4208321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/743ad69fd421838322645c1b0820b370?s=128&d=identicon&r=PG&f=1", "display_name": "satinder", "link": "https://stackoverflow.com/users/4208321/satinder"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553466246, "post_id": 55094133, "comment_id": 97384053, "body": "Hi @CeriseLim&#243;n, updated the question. Can you please help with it?"}, {"owner": {"reputation": 135, "user_id": 4208321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/743ad69fd421838322645c1b0820b370?s=128&d=identicon&r=PG&f=1", "display_name": "satinder", "link": "https://stackoverflow.com/users/4208321/satinder"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553470235, "post_id": 55094133, "comment_id": 97384883, "body": "&gt;The call to upgrader.Upgrader from that method fails because the connection is already in use for the HTTP response. &gt;  yes, so how I can send a socket message as I&#39;m trying to do from <code>&#47;</code> to <code>&#47;room</code> ?"}, {"owner": {"reputation": 135, "user_id": 4208321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/743ad69fd421838322645c1b0820b370?s=128&d=identicon&r=PG&f=1", "display_name": "satinder", "link": "https://stackoverflow.com/users/4208321/satinder"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553742599, "post_id": 55094133, "comment_id": 97500625, "body": ":( sad that I couldn&#39;t convey what I&#39;m trying to do with the code examples. I have a code which uses a package webtty. I used it&#39;s code to run a console only application to run in a web page. With WebTTY, I&#39;m quiting the WebTTY session and that prints a log output in console log, which I wish to broadcast to the websocket. This is my practice code I was trying to solve: bit.ly/2CGwQAh"}, {"owner": {"reputation": 135, "user_id": 4208321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/743ad69fd421838322645c1b0820b370?s=128&d=identicon&r=PG&f=1", "display_name": "satinder", "link": "https://stackoverflow.com/users/4208321/satinder"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553742608, "post_id": 55094133, "comment_id": 97500627, "body": "So, in similar way I showed in this example in question, I just used the for loop to simulate that print log from some other Handle which I want to broadcast to the websocket, and still couldn&#39;t my head around how exactly I do it. Really apprecicate your help so far mate. It at least encouraged me to read and learn more things around the concept where I&#39;m still stuck."}, {"owner": {"reputation": 135, "user_id": 4208321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/743ad69fd421838322645c1b0820b370?s=128&d=identicon&r=PG&f=1", "display_name": "satinder", "link": "https://stackoverflow.com/users/4208321/satinder"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553770079, "post_id": 55094133, "comment_id": 97511568, "body": "thanks for replies Cerise. Yes, adding upgrade code to <code>&#47;</code> doesn&#39;t make sense as you explained. Separating HTTP from WebSocket, makes sense. So, I looked at the gorilla docs and examples again. May be I should try to make a backend connection to websocket like a command line client connection, using <code>Dialer</code>, which also is coded in example <code>echo</code>. github.com/gorilla/websocket/blob/master/examples/echo/clien&zwnj;&#8203;t.go#L32 Will try this code. Is that what you mean by separating?"}, {"owner": {"reputation": 135, "user_id": 4208321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/743ad69fd421838322645c1b0820b370?s=128&d=identicon&r=PG&f=1", "display_name": "satinder", "link": "https://stackoverflow.com/users/4208321/satinder"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553958412, "post_id": 55094133, "comment_id": 97583153, "body": "@CeriseLim&#243;n Solved it mate! added my answer. Please take a look and let me know if I need to fix it due to some expected error or inefficiency. Many thanks for all your help!"}], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 4208321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/743ad69fd421838322645c1b0820b370?s=128&d=identicon&r=PG&f=1", "display_name": "satinder", "link": "https://stackoverflow.com/users/4208321/satinder"}, "is_accepted": false, "score": 0, "last_activity_date": 1553958264, "creation_date": 1553958264, "answer_id": 55432716, "question_id": 55094133, "link": "https://stackoverflow.com/questions/55094133/how-to-send-some-event-update-from-http-handler-to-a-websocket-handler/55432716#55432716", "title": "How to send some event update from http Handler to a WebSocket Handler", "body": "<p>Think I solved it. At least it is doing what I imagined the code to do what I wanted it to do, even in case it might not be correct way of doing things. Correct way of doing things or efficient way of doing this exact thing, I think many of you can probably correct me and help me to do so, I hope so, so please comment and correct me if you think it's wrong or inefficient.</p>\n\n<p>This is how I solved it:</p>\n\n<p>I looked at the <code>echo</code> example (<a href=\"https://github.com/gorilla/websocket/blob/master/examples/echo/client.go\" rel=\"nofollow noreferrer\">https://github.com/gorilla/websocket/blob/master/examples/echo/client.go</a>) of gorilla's websocket examples, and just took the basic bit of code from <code>clients.go</code> file, which is makes a connection to websocket as a client.</p>\n\n<p>My end goal was send the event update from another http Handle to the websocket, so for that I was simulating the print log example of some string in console output.</p>\n\n<p>This is the change I did in the <code>main.go</code> file of my Mat Ryer chat example code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// ServeHTTP handles the HTTP request.\nfunc (t *templateHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    t.once.Do(func() {\n        t.templ = template.Must(template.ParseFiles(filepath.Join(\"templates\", t.filename)))\n    })\n    fmt.Println(r.Host)\n    t.templ.Execute(w, r)\n\n    // Creating the URL scheme to use with websocket Dialer\n    // to connnect to ws://localhost:8080/room\n    u := url.URL{Scheme: \"ws\", Host: \"localhost:8080\", Path: \"/room\"}\n    log.Printf(\"connecting to %s\", u.String())\n\n    // Initiate the websocket connection from the go code **as a client** to connect to the chat room\n    c, _, err := websocket.DefaultDialer.Dial(u.String(), nil)\n    if err != nil {\n        log.Fatal(\"dial:\", err)\n    }\n\n    go func() {\n        for i := 0; i &lt; 10; i++ {\n            time.Sleep(time.Duration(rand.Intn(8e3)) * time.Millisecond)\n            // Just printing the log of the same message in command line. Might better to ignore it.\n            // log.Println(\"Sending automatic hello from root ServeHTTP handle to web page!\")\n\n            // Write the Message as Text message to the web socket connection\n            // which will show up in the chat box\n            err := c.WriteMessage(websocket.TextMessage, []byte(\"Sending automatic hello from root ServeHTTP handle to web page!\"))\n            if err != nil {\n                log.Println(\"write:\", err)\n                return\n            }\n        }\n    }()\n}\n</code></pre>\n\n<p>Running this code after building the binary prints the following example output in console:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>GoldenBook:mychat02 satinder$ ./chat \n2019/03/31 03:44:27 Starting web server on :8080\nlocalhost:8080\n2019/03/31 03:44:31 connecting to ws://localhost:8080/room\nNew client joined\nNew client joined\n2019/03/31 03:44:33 Sending automatic hello from root ServeHTTP handle to web page!\nMessage received: Sending automatic hello from root ServeHTTP handle to web page!\n-- sent to client\n-- sent to client\n2019/03/31 03:44:36 Sending automatic hello from root ServeHTTP handle to web page!\nMessage received: Sending automatic hello from root ServeHTTP handle to web page!\n-- sent to client\n-- sent to client\n2019/03/31 03:44:43 Sending automatic hello from root ServeHTTP handle to web page!\nMessage received: Sending automatic hello from root ServeHTTP handle to web page!\n-- sent to client\n-- sent to client\n2019/03/31 03:44:45 Sending automatic hello from root ServeHTTP handle to web page!\nMessage received: Sending automatic hello from root ServeHTTP handle to web page!\n-- sent to client\n-- sent to client\n2019/03/31 03:44:45 Sending automatic hello from root ServeHTTP handle to web page!\nMessage received: Sending automatic hello from root ServeHTTP handle to web page!\n-- sent to client\n-- sent to client\nMessage received: HELLO\n-- sent to client\n-- sent to client\n2019/03/31 03:44:48 Sending automatic hello from root ServeHTTP handle to web page!\nMessage received: Sending automatic hello from root ServeHTTP handle to web page!\n-- sent to client\n-- sent to client\n2019/03/31 03:44:48 Sending automatic hello from root ServeHTTP handle to web page!\nMessage received: Sending automatic hello from root ServeHTTP handle to web page!\n-- sent to client\n-- sent to client\n2019/03/31 03:44:49 Sending automatic hello from root ServeHTTP handle to web page!\nMessage received: Sending automatic hello from root ServeHTTP handle to web page!\n-- sent to client\n-- sent to client\n2019/03/31 03:44:52 Sending automatic hello from root ServeHTTP handle to web page!\nMessage received: Sending automatic hello from root ServeHTTP handle to web page!\n-- sent to client\n-- sent to client\n^C\n</code></pre>\n\n<p>And following is the output which shows in the web page at <a href=\"http://localhost:8080/\" rel=\"nofollow noreferrer\">http://localhost:8080/</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ghVt6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ghVt6.png\" alt=\"chat window screenshot\"></a></p>\n\n<p>Here's the full code update:\n<a href=\"https://github.com/satindergrewal/golang-practice/tree/master/chat-examples/mychat02\" rel=\"nofollow noreferrer\">https://github.com/satindergrewal/golang-practice/tree/master/chat-examples/mychat02</a></p>\n\n<p>Since this is the example code, which I wanted to solve for my actual application, which is a WebTTY based app, I'll be able to send the WebTTY session end event update from some other http Handle to websocket using this code bit.</p>\n\n<p>I can still use some help from go masters online.</p>\n\n<p>Do I need to add the channel close to this Dialer somewhere? I guess I do, but would appreciate if someone can fix any errors or expected inefficiencies in it.</p>\n\n<p>Thanks a lot to @cerise-lim\u00f3n who helped me so far. :-)</p>\n"}], "owner": {"reputation": 135, "user_id": 4208321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/743ad69fd421838322645c1b0820b370?s=128&d=identicon&r=PG&f=1", "display_name": "satinder", "link": "https://stackoverflow.com/users/4208321/satinder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1150, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553958264, "creation_date": 1552267874, "last_edit_date": 1553467452, "question_id": 55094133, "link": "https://stackoverflow.com/questions/55094133/how-to-send-some-event-update-from-http-handler-to-a-websocket-handler", "title": "How to send some event update from http Handler to a WebSocket Handler", "body": "<p>I'm very new to Go language and trying to wrap my head around channels. To clear my understanding I have watched video tutorials, read some books, but I'm still feeling confused when comes to practical coding and use of channels in web app coded in Go.</p>\n\n<p>What I'm trying to do is to have 2 URLS:</p>\n\n<ol>\n<li>The usual normal GET or POST URL which displays or gets value and\nprocess it. In the back-end does some processing and I wish that\nprocessing output to be sent out in a websocket update to the same\nURL, so that no window refresh/reload is required.</li>\n<li>A Gorilla package based websockets URL.</li>\n</ol>\n\n<p>Following is the so far test code I tried, which is still a stripped down version of the mess of code I made trying to make a solution:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>//file main.go\npackage main\n\nimport (\n    \"io\"\n    \"net/http\"\n    \"fmt\"\n    \"math/rand\"\n    \"log\"\n    \"time\"\n    \"github.com/gorilla/websocket\"\n)\n\n\nfunc logging(f http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        log.Println(r.URL.Path)\n        if r.URL.Path == `/ws` {\n            log.Println(\"WebSocket is accessed from ws://localhost:8080/ws\")\n        }\n        f(w, r)\n    }\n}\n\ntype hotcat int\n\nfunc (c hotcat) ServeHTTP(res http.ResponseWriter, req *http.Request) {\n    io.WriteString(res, \"cat cat cat\")\n\n    //Some code here who's output I want to pass to websockets url ws://localhost:8080/ws\n    n := timeConsumingWork(4)\n    fmt.Println(\"Random Number Print from cat: \", n)\n    //Example the value of n I need to pass to ws://localhost:8080/ws, how can I do it?\n\n    // Some other example test code just giving some random output from hotcat http handler\n    // Would like to pass it's output to ws://localhost:8080/ws to print in websocckets output in browser\n    go func(){\n        out := make(chan string)\n        go func(){\n            for i := 0; ; i++ {\n                out &lt;- `foo said something`\n                time.Sleep(time.Duration(rand.Intn(2e3)) * time.Millisecond)\n            }\n            //out &lt;- `foo said something`\n        }()\n        printer(out)\n    }()\n}\n\nvar upgrader = websocket.Upgrader{\n    ReadBufferSize:  1024,\n    WriteBufferSize: 1024,\n    CheckOrigin: func(r *http.Request) bool {\n        return true\n    },\n}\n\n// Execute this in browser console to initiate websococket connection and to send ws.send() commands etc.\n/*\nvar ws = new WebSocket(\"ws://localhost:8080/ws\")\nws.addEventListener(\"message\", function(e) {console.log(e);});\nws.onmessage = function (event) {\n    console.log(event.data);\n}\n\nws.send(\"foo\")\nws.send(JSON.stringify({username: \"Sat\"}))\n\nws.readyState\nws.CLOSED\nws.OPEN\nws.close()\n*/\nfunc ws(w http.ResponseWriter, r *http.Request) {\n    socket, err := upgrader.Upgrade(w, r, nil)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    for {\n        msgType, msg, err := socket.ReadMessage()\n        if err != nil {\n            fmt.Println(err)\n            return\n        }\n        fmt.Println(string(msg))\n        if err = socket.WriteMessage(msgType, msg); err != nil {\n            fmt.Println(err)\n        }\n    }\n}\n\nfunc main() {\n    var c hotcat\n\n    http.Handle(\"/cat\", c)\n    http.HandleFunc(\"/ws\", logging(ws))\n\n    http.ListenAndServe(\":8080\", nil)\n}\n\n\nfunc timeConsumingWork(n int) int {\n    time.Sleep(time.Microsecond * time.Duration(rand.Intn(500)))\n    return n + rand.Intn(1000)\n}\n\n\nfunc printer(in &lt;-chan string) {\n    //log.Println(&lt;-in)\n    go func() {\n        for {\n            log.Println(&lt;-in)\n        }\n    }()\n}\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code># command shell output\n$ go run main.go \n\nRandom Number Print from cat:  891\n2019/03/11 14:15:32 foo said something\n2019/03/11 14:15:33 /ws\n2019/03/11 14:15:33 WebSocket is accessed from ws://localhost:8080/ws\nfoo\n2019/03/11 14:15:34 foo said something\n2019/03/11 14:15:34 foo said something\n2019/03/11 14:15:34 foo said something\n2019/03/11 14:15:36 foo said something\n2019/03/11 14:15:36 foo said something\n^Csignal: interrupt\n$ \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/YtZVO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YtZVO.png\" alt=\"websocket command input from browser\"></a></p>\n\n<p>I want to display the random output string \"2019/03/11 14:15:34 foo said something\" like outputs in websocket output in browser.</p>\n\n<p>I'd really appreciate some direction or help.</p>\n\n<p>I think the comments in the code, terminal output, and browser screenshot for this question should clear what I'm trying to do, but if this question is still unclear, please let me know, I'll try expanding on it more.</p>\n\n<p>Thanks &amp; Regards,</p>\n\n<p>Satinder</p>\n\n<p><strong>Update 1:</strong></p>\n\n<p>I read, tried the Mat Ryer example of chat application: <a href=\"https://github.com/matryer/goblueprints/tree/master/chapter1/chat\" rel=\"nofollow noreferrer\">https://github.com/matryer/goblueprints/tree/master/chapter1/chat</a></p>\n\n<p>Here's may code copy: <a href=\"https://github.com/satindergrewal/golang-practice/tree/master/chat-examples/mychat02\" rel=\"nofollow noreferrer\">https://github.com/satindergrewal/golang-practice/tree/master/chat-examples/mychat02</a></p>\n\n<p>From the example I understand that if I have a web socket handle I can have the messages channeled from that websocket http handle to other connected web clients. But I'm still confused how I can send a message from a non-websocket http handle to a websocket handle route/address.</p>\n\n<p>I know I can not just use this code for <code>/</code>'s <code>ServeHTTP</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// ServeHTTP handles the HTTP request.\nfunc (t *templateHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    t.once.Do(func() {\n        t.templ = template.Must(template.ParseFiles(filepath.Join(\"templates\", t.filename)))\n    })\n    fmt.Println(r.Host)\n    t.templ.Execute(w, r)\n    var room *room\n    socket, _ := upgrader.Upgrade(w, r, nil)\n    client := &amp;client{\n        socket: socket,\n        send:   make(chan []byte, messageBufferSize),\n        room:   room,\n    }\n    room.join &lt;- client\n    go func() {\n        for i := 0; i &lt; 10; i++ {\n            time.Sleep(time.Duration(rand.Intn(8e3)) * time.Millisecond)\n            client.socket.WriteMessage(websocket.TextMessage, []byte(\"Hello from / ServeHTTP Handle\"))\n            //fmt.Println(\"Sending automatic hello from root ServeHTTP handle to web page!\")\n        }\n    }()\n}\n</code></pre>\n\n<p>It already gives me the following error:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>localhost:8080\n2019/03/25 11:19:18 http: superfluous response.WriteHeader call from github.com/gorilla/websocket.(*Upgrader).returnError (server.go:81)\n2019/03/25 11:19:18 http: panic serving [::1]:52691: runtime error: invalid memory address or nil pointer dereference\ngoroutine 39 [running]:\nnet/http.(*conn).serve.func1(0xc00013e140)\n        /usr/local/Cellar/go/1.12.1/libexec/src/net/http/server.go:1769 +0x139\npanic(0x13a3e00, 0x172dc20)\n        /usr/local/Cellar/go/1.12.1/libexec/src/runtime/panic.go:522 +0x1b5\nmain.(*templateHandler).ServeHTTP(0xc00008ef60, 0x14954a0, 0xc0001dc380, 0xc000214200)\n        /Users/satinder/go/src/golang-practice/chat-examples/mychat02/main.go:40 +0x209\nnet/http.(*ServeMux).ServeHTTP(0x173cfa0, 0x14954a0, 0xc0001dc380, 0xc000214200)\n        /usr/local/Cellar/go/1.12.1/libexec/src/net/http/server.go:2375 +0x1d6\nnet/http.serverHandler.ServeHTTP(0xc000130000, 0x14954a0, 0xc0001dc380, 0xc000214200)\n        /usr/local/Cellar/go/1.12.1/libexec/src/net/http/server.go:2774 +0xa8\nnet/http.(*conn).serve(0xc00013e140, 0x1495ba0, 0xc0000a0380)\n        /usr/local/Cellar/go/1.12.1/libexec/src/net/http/server.go:1878 +0x851\ncreated by net/http.(*Server).Serve\n        /usr/local/Cellar/go/1.12.1/libexec/src/net/http/server.go:2884 +0x2f4\n\n</code></pre>\n\n<p><strong>Update 2:</strong> Tried different, after re-reading the first reply from comments again.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// ServeHTTP handles the HTTP request.\nfunc (t *templateHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    t.once.Do(func() {\n        t.templ = template.Must(template.ParseFiles(filepath.Join(\"templates\", t.filename)))\n    })\n    fmt.Println(r.Host)\n    t.templ.Execute(w, r)\n\n    room := newRoom()\n    go func() {\n        for i := 0; i &lt; 10; i++ {\n            time.Sleep(time.Duration(rand.Intn(8e3)) * time.Millisecond)\n            room.forward &lt;- []byte(\"Hello from / ServeHTTP Handle\")\n            //client.socket.WriteMessage(websocket.TextMessage, []byte(\"Hello from / ServeHTTP Handle\"))\n            fmt.Println(\"Sending automatic hello from root ServeHTTP handle to web page!\")\n        }\n    }()\n}\n</code></pre>\n\n<p>Now it doesn't give error, but I don't see the console showing the second client added which I was expecting that <code>/</code> added via command line.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>GoldenBook:mychat02 satinder$ go build -o chat \nGoldenBook:mychat02 satinder$ ./chat \n2019/03/25 11:37:49 Starting web server on :8080\nlocalhost:8080\nNew client joined\n^C\n</code></pre>\n\n<p>Tried again with previous and new code mix and this is the result:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// ServeHTTP handles the HTTP request.\nfunc (t *templateHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    t.once.Do(func() {\n        t.templ = template.Must(template.ParseFiles(filepath.Join(\"templates\", t.filename)))\n    })\n    fmt.Println(r.Host)\n    t.templ.Execute(w, r)\n\n    room := newRoom()\n    socket, _ := upgrader.Upgrade(w, r, nil)\n    client := &amp;client{\n        socket: socket,\n        send:   make(chan []byte, messageBufferSize),\n        room:   room,\n    }\n    room.join &lt;- client\n    go func() {\n        for i := 0; i &lt; 10; i++ {\n            time.Sleep(time.Duration(rand.Intn(8e3)) * time.Millisecond)\n            room.forward &lt;- []byte(\"Hello from / ServeHTTP Handle\")\n            //client.socket.WriteMessage(websocket.TextMessage, []byte(\"Hello from / ServeHTTP Handle\"))\n            //fmt.Println(\"Sending automatic hello from root ServeHTTP handle to web page!\")\n        }\n    }()\n}\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>GoldenBook:mychat02 satinder$ go build -o chat \nGoldenBook:mychat02 satinder$ ./chat \n2019/03/25 11:40:44 Starting web server on :8080\nlocalhost:8080\n2019/03/25 11:40:50 http: superfluous response.WriteHeader call from github.com/gorilla/websocket.(*Upgrader).returnError (server.go:81)\n^C\n</code></pre>\n\n<p>Still feeling confused... </p>\n\n<p>Can someone please give me a solution to this? Would really really appreciate your help.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Satinder</p>\n"}, {"tags": ["go", "google-cloud-dataflow", "apache-beam"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 10907445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37ae7842168f820d588d3784f8a23f5?s=128&d=identicon&r=PG&f=1", "display_name": "mdtp", "link": "https://stackoverflow.com/users/10907445/mdtp"}, "edited": false, "score": 0, "creation_date": 1552350690, "post_id": 55108455, "comment_id": 96967276, "body": "Hey Pablo, thanks for the answer. I edited the question according to your suggestion however it still has the same problem. This solved only fusion between first and second steps. Third step is still not working parallel."}, {"owner": {"reputation": 7955, "user_id": 1255356, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/LSG5g.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1255356/pablo"}, "reply_to_user": {"reputation": 121, "user_id": 10907445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37ae7842168f820d588d3784f8a23f5?s=128&d=identicon&r=PG&f=1", "display_name": "mdtp", "link": "https://stackoverflow.com/users/10907445/mdtp"}, "edited": false, "score": 0, "creation_date": 1552406210, "post_id": 55108455, "comment_id": 96993069, "body": "That&#39;s odd. And you&#39;ve added more than a few keys? With more keys, Beam should be able to split and analyze in parallel.."}, {"owner": {"reputation": 121, "user_id": 10907445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37ae7842168f820d588d3784f8a23f5?s=128&d=identicon&r=PG&f=1", "display_name": "mdtp", "link": "https://stackoverflow.com/users/10907445/mdtp"}, "edited": false, "score": 0, "creation_date": 1552406957, "post_id": 55108455, "comment_id": 96993593, "body": "Exactly I added random keys. You can see it in the questions part. I added an Edit version of the question. I&#39;m using <code>AddRandomKey</code> function which creates distinct keys. I started the pipeline with 20 workers, then suddenly autoscaler dropped them into 5 workers."}, {"owner": {"reputation": 121, "user_id": 10907445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37ae7842168f820d588d3784f8a23f5?s=128&d=identicon&r=PG&f=1", "display_name": "mdtp", "link": "https://stackoverflow.com/users/10907445/mdtp"}, "edited": false, "score": 0, "creation_date": 1552431748, "post_id": 55108455, "comment_id": 97005402, "body": "I&#39;m giving the latest update about the implementation result. Tried the implementation in the Edit part with 200,000 lines of data in a file and found out that each step is running in parallel. However, each step waits for completion of execution of the previous step and starts working in parallel after previous step is completed. Each step itself is running in parallel but only one step is running at a time within the pipeline. Pipeline is still not fully parallel."}], "tags": [], "owner": {"reputation": 7955, "user_id": 1255356, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/LSG5g.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1255356/pablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1552330073, "creation_date": 1552330073, "answer_id": 55108455, "question_id": 55093978, "link": "https://stackoverflow.com/questions/55093978/parallelism-problem-on-cloud-dataflow-using-go-sdk/55108455#55108455", "title": "Parallelism Problem on Cloud Dataflow using Go SDK", "body": "<p>Many advanced runners of MapReduce-type pipelines fuse stages that can be run in memory together. Apache Beam and Dataflow are no exception.</p>\n\n<p>What's happening here is that the three steps of your pipeline are fused, and happening in the same machine. Furthermore, the Go SDK does not currently support splitting the <code>Read</code> transform, unfortunately.</p>\n\n<p>To achieve parallelism in the third transform, you can <em>break</em> the fusion between <code>Read</code> and <code>ProcessLines</code>. You can do that adding a random key to your lines, and a <code>GroupByKey</code> transform.</p>\n\n<p>In Python, it would be:</p>\n\n<pre><code>(p | beam.ReadFromText(...)\n   | CountLines()\n   | beam.Map(lambda x: (random.randint(0, 1000), x))\n   | beam.GroupByKey()\n   | beam.FlatMap(lambda k, v: v)  # Discard the key, and return the values\n   | ProcessLines())\n</code></pre>\n\n<p>This would allow you to parallelize <code>ProcessLines</code>.</p>\n"}], "owner": {"reputation": 121, "user_id": 10907445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37ae7842168f820d588d3784f8a23f5?s=128&d=identicon&r=PG&f=1", "display_name": "mdtp", "link": "https://stackoverflow.com/users/10907445/mdtp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 392, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1552350820, "creation_date": 1552266122, "last_edit_date": 1552350820, "question_id": 55093978, "link": "https://stackoverflow.com/questions/55093978/parallelism-problem-on-cloud-dataflow-using-go-sdk", "title": "Parallelism Problem on Cloud Dataflow using Go SDK", "body": "<p>I have Apache Beam code implementation on Go SDK as described below. The pipeline has 3 steps. One is <code>textio.Read</code>, other one is <code>CountLines</code> and the last step is <code>ProcessLines</code>. <code>ProcessLines</code> step takes around 10 seconds time. I just added a Sleep function for the sake of brevity.</p>\n\n<p>I am calling the pipeline with 20 workers. When I run the pipeline, my expectation was 20 workers would run in parallel and <code>textio.Read</code> read 20 lines from the file and <code>ProcessLines</code> would do 20 parallel executions in 10 seconds. However, the pipeline did not work like that. It's currently working in a way that <code>textio.Read</code> reads one line from the file, pushes the data to the next step and waits until <code>ProcessLines</code> step completes its 10 seconds work. There is no parallelism and there is only one line string from the file throughout the pipeline. Could you please clarify me what I'm doing wrong for parallelism? How should I update the code to achieve parallelism as described above?</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"flag\"\n    \"time\"\n\n    \"github.com/apache/beam/sdks/go/pkg/beam\"\n    \"github.com/apache/beam/sdks/go/pkg/beam/io/textio\"\n    \"github.com/apache/beam/sdks/go/pkg/beam/log\"\n    \"github.com/apache/beam/sdks/go/pkg/beam/x/beamx\"\n)\n\n// metrics to be monitored\nvar (\n    input         = flag.String(\"input\", \"\", \"Input file (required).\")\n    numberOfLines = beam.NewCounter(\"extract\", \"numberOfLines\")\n    lineLen       = beam.NewDistribution(\"extract\", \"lineLenDistro\")\n)\n\nfunc countLines(ctx context.Context, line string) string {\n    lineLen.Update(ctx, int64(len(line)))\n    numberOfLines.Inc(ctx, 1)\n\n    return line\n}\n\nfunc processLines(ctx context.Context, line string) {\n    time.Sleep(10 * time.Second)\n}\n\nfunc CountLines(s beam.Scope, lines beam.PCollection) beam.PCollection \n{\n    s = s.Scope(\"Count Lines\")\n\n    return beam.ParDo(s, countLines, lines)\n}\n\nfunc ProcessLines(s beam.Scope, lines beam.PCollection) {\n    s = s.Scope(\"Process Lines\")\n\n    beam.ParDo0(s, processLines, lines)\n}\n\nfunc main() {\n    // If beamx or Go flags are used, flags must be parsed first.\n    flag.Parse()\n    // beam.Init() is an initialization hook that must be called on startup. On\n    // distributed runners, it is used to intercept control.\n    beam.Init()\n\n    // Input validation is done as usual. Note that it must be after Init().\n    if *input == \"\" {\n        log.Fatal(context.Background(), \"No input file provided\")\n    }\n\n    p := beam.NewPipeline()\n    s := p.Root()\n\n    l := textio.Read(s, *input)\n    lines := CountLines(s, l)\n    ProcessLines(s, lines)\n\n    // Concept #1: The beamx.Run convenience wrapper allows a number of\n    // pre-defined runners to be used via the --runner flag.\n    if err := beamx.Run(context.Background(), p); err != nil {\n        log.Fatalf(context.Background(), \"Failed to execute job: %v\", err.Error())\n    }\n}\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>After I got the answer about the problem might be caused by fusion, I changed the related part of the code but it did not work again.</p>\n\n<p>Now the first and second step is working in parallel, however the third step <code>ProcessLines</code> is not working in parallel. I only made the following changes. Can anyone tell me what the problem is?</p>\n\n<pre><code>func AddRandomKey(s beam.Scope, col beam.PCollection) beam.PCollection {\n    return beam.ParDo(s, addRandomKeyFn, col)\n}\n\nfunc addRandomKeyFn(elm beam.T) (int, beam.T) {\n    return rand.Int(), elm\n}\n\nfunc countLines(ctx context.Context, _ int, lines func(*string) bool, emit func(string)) {\n    var line string\n    for lines(&amp;line) {\n        lineLen.Update(ctx, int64(len(line)))\n        numberOfLines.Inc(ctx, 1)\n        emit(line)\n    }\n}\nfunc processLines(ctx context.Context, _ int, lines func(*string) bool) {\n    var line string\n    for lines(&amp;line) {\n        time.Sleep(10 * time.Second)\n        numberOfLinesProcess.Inc(ctx, 1)\n    }\n}\n\nfunc CountLines(s beam.Scope, lines beam.PCollection) beam.PCollection {\n    s = s.Scope(\"Count Lines\")\n    keyed := AddRandomKey(s, lines)\n    grouped := beam.GroupByKey(s, keyed)\n\n    return beam.ParDo(s, countLines, grouped)\n}\n\nfunc ProcessLines(s beam.Scope, lines beam.PCollection) {\n    s = s.Scope(\"Process Lines\")\n    keyed := AddRandomKey(s, lines)\n    grouped := beam.GroupByKey(s, keyed)\n\n    beam.ParDo0(s, processLines, grouped)\n}\n</code></pre>\n"}, {"tags": ["go", "time"], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1552314767, "post_id": 55093788, "comment_id": 96951123, "body": "The last line seems wrong - <code>inTimeSpan</code> returns <code>true</code> if <code>check</code> is before <code>start</code> (and therefore <i>not</i> between <code>start</code> and <code>end</code>)."}, {"owner": {"reputation": 3934, "user_id": 916440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3f3495133a7d9411b0b4c04189ecf91?s=128&d=identicon&r=PG", "display_name": "Kamil Dziedzic", "link": "https://stackoverflow.com/users/916440/kamil-dziedzic"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552391328, "post_id": 55093788, "comment_id": 96982975, "body": "@Adrian No, that&#39;s correct and intentional (unless I misunderstood OP). You have range from 23:00 to 05:00 but there is no date involved. That&#39;s the original issue with the code. OP assume 04:00 is between 23:00-05:00 which is correct but time package understands 23:00 as today, and 05:00 as today (instead of next day). If time.Parse would use date you would be correct but then there wouldn&#39;t be a problem with comparing times in the first place."}, {"owner": {"reputation": 3934, "user_id": 916440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3f3495133a7d9411b0b4c04189ecf91?s=128&d=identicon&r=PG", "display_name": "Kamil Dziedzic", "link": "https://stackoverflow.com/users/916440/kamil-dziedzic"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552392132, "post_id": 55093788, "comment_id": 96983472, "body": "But to be honest you can achieve the same with just string comparision instead of time package."}, {"owner": {"reputation": 399, "user_id": 3450077, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/648595373/picture?type=large", "display_name": "Francesco", "link": "https://stackoverflow.com/users/3450077/francesco"}, "edited": false, "score": 2, "creation_date": 1552472350, "post_id": 55093788, "comment_id": 97019118, "body": "It is actually not correct, I did realized but forgot to write it. The examples results should have been  true, true, false, true, false, false. Anyhow your solution was accepted because it basically helped me solving my problem. Thanks a lot. I also see my original thanks reply is not there \u2026. sorry"}], "tags": [], "owner": {"reputation": 3934, "user_id": 916440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3f3495133a7d9411b0b4c04189ecf91?s=128&d=identicon&r=PG", "display_name": "Kamil Dziedzic", "link": "https://stackoverflow.com/users/916440/kamil-dziedzic"}, "is_accepted": false, "score": 5, "last_activity_date": 1579201734, "last_edit_date": 1579201734, "creation_date": 1552264058, "answer_id": 55093788, "question_id": 55093676, "link": "https://stackoverflow.com/questions/55093676/checking-if-current-time-is-in-a-given-interval-golang/55093788#55093788", "title": "Checking if current time is in a given interval, GOLANG", "body": "<p>EDIT: It was wrong initially, sorry about that. Fixed version, and also the range now is inclusive. Check also <a href=\"https://stackoverflow.com/questions/55093676/checking-if-current-time-is-in-a-given-interval-golang/58960752#58960752\">Mickael V. answer</a> as adding time make sense too.</p>\n\n<pre><code>func inTimeSpan(start, end, check time.Time) bool {\n    if start.Before(end) {\n        return !check.Before(start) &amp;&amp; !check.After(end)\n    }\n    if start.Equal(end) {\n        return check.Equal(start)\n    }\n    return !start.After(check) || !end.Before(check)\n}\n</code></pre>\n\n<p>Check it on playground <a href=\"https://play.golang.org/p/CGWqY2AQ-Th\" rel=\"nofollow noreferrer\">https://play.golang.org/p/CGWqY2AQ-Th</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc inTimeSpan(start, end, check time.Time) bool {\n    if start.Before(end) {\n        return !check.Before(start) &amp;&amp; !check.After(end)\n    }\n    if start.Equal(end) {\n        return check.Equal(start)\n    }\n    return !start.After(check) || !end.Before(check)\n}\n\nfunc main() {\n    test := []struct {\n        start string\n        end   string\n        check string\n    }{\n        {\"23:00\", \"05:00\", \"04:00\"},\n        {\"23:00\", \"05:00\", \"23:30\"},\n        {\"23:00\", \"05:00\", \"20:00\"},\n        {\"10:00\", \"21:00\", \"11:00\"},\n        {\"10:00\", \"21:00\", \"22:00\"},\n        {\"10:00\", \"21:00\", \"03:00\"},\n        // Additional checks.\n        {\"22:00\", \"02:00\", \"00:00\"},\n        {\"10:00\", \"21:00\", \"10:00\"},\n        {\"10:00\", \"21:00\", \"21:00\"},\n        {\"23:00\", \"05:00\", \"06:00\"},\n        {\"23:00\", \"05:00\", \"23:00\"},\n        {\"23:00\", \"05:00\", \"05:00\"},\n        {\"10:00\", \"21:00\", \"10:00\"},\n        {\"10:00\", \"21:00\", \"21:00\"},\n        {\"10:00\", \"10:00\", \"09:00\"},\n        {\"10:00\", \"10:00\", \"11:00\"},\n        {\"10:00\", \"10:00\", \"10:00\"},\n    }\n    newLayout := \"15:04\"\n    for _, t := range test {\n        check, _ := time.Parse(newLayout, t.check)\n        start, _ := time.Parse(newLayout, t.start)\n        end, _ := time.Parse(newLayout, t.end)\n        fmt.Println(t.start+\"-\"+t.end, t.check, inTimeSpan(start, end, check))\n    }\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>23:00-05:00 04:00 true\n23:00-05:00 23:30 true\n23:00-05:00 20:00 false\n10:00-21:00 11:00 true\n10:00-21:00 22:00 false\n10:00-21:00 03:00 false\n22:00-02:00 00:00 true\n10:00-21:00 10:00 true\n10:00-21:00 21:00 true\n23:00-05:00 06:00 false\n23:00-05:00 23:00 true\n23:00-05:00 05:00 true\n10:00-21:00 10:00 true\n10:00-21:00 21:00 true\n10:00-10:00 09:00 false\n10:00-10:00 11:00 false\n10:00-10:00 10:00 true\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3934, "user_id": 916440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3f3495133a7d9411b0b4c04189ecf91?s=128&d=identicon&r=PG", "display_name": "Kamil Dziedzic", "link": "https://stackoverflow.com/users/916440/kamil-dziedzic"}, "edited": false, "score": 0, "creation_date": 1552391293, "post_id": 55093817, "comment_id": 96982956, "body": "20:37 is not between 23:00-05:00, should be false (as long as I understand OP question)."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1552264673, "last_edit_date": 1552264673, "creation_date": 1552264326, "answer_id": 55093817, "question_id": 55093676, "link": "https://stackoverflow.com/questions/55093676/checking-if-current-time-is-in-a-given-interval-golang/55093817#55093817", "title": "Checking if current time is in a given interval, GOLANG", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc inTimeSpan(start, end, check time.Time) bool {\n    start, end = start.UTC(), end.UTC()\n    if start.After(end) {\n        start, end = end, start\n    }\n    check = check.UTC()\n    return !check.Before(start) &amp;&amp; !check.After(end)\n}\n\nfunc main() {\n    now := time.Now()\n    newLayout := \"15:04\"\n    ns, _ := time.Parse(newLayout, strconv.Itoa(now.Hour())+\":\"+strconv.Itoa(now.Minute()))\n    srt, _ := time.Parse(newLayout, \"23:00\")\n    end, _ := time.Parse(newLayout, \"05:00\")\n\n    fmt.Println(srt, end)\n    fmt.Println(ns)\n    fmt.Println(\"1 : \", inTimeSpan(srt, end, ns))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0000-01-01 23:00:00 +0000 UTC 0000-01-01 05:00:00 +0000 UTC\n0000-01-01 20:37:00 +0000 UTC\n1 :  true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 939, "user_id": 860246, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c0fcb6dc464f7419223fd6062b0e794b?s=128&d=identicon&r=PG", "display_name": "Mickael V.", "link": "https://stackoverflow.com/users/860246/mickael-v"}, "is_accepted": false, "score": 1, "last_activity_date": 1574273136, "creation_date": 1574273136, "answer_id": 58960752, "question_id": 55093676, "link": "https://stackoverflow.com/questions/55093676/checking-if-current-time-is-in-a-given-interval-golang/58960752#58960752", "title": "Checking if current time is in a given interval, GOLANG", "body": "<p>Building on <a href=\"https://stackoverflow.com/a/55093788/860246\">Kamil's answer</a>, which is ultimately wrong as its own tests show, here is a solution that makes use only of Go's time interface.\nThe trick, knowing that Go will make <code>Before</code> and <code>After</code> comparison using time AND date, is to just push the end time to the next day if its time component is \"smaller\" than the start one. Then the time to check needs to be done the same if it's before the start time.</p>\n\n<p>I took the same test cases and added some significant ones like midnight.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc inTimeSpan(start, end, check time.Time) bool {\n    _end := end\n    _check := check\n    if end.Before(start) {\n        _end = end.Add(24 * time.Hour)\n        if check.Before(start) {\n            _check = check.Add(24 * time.Hour)\n        }\n    }\n    return _check.After(start) &amp;&amp; _check.Before(_end)\n}\n\nfunc main() {\n    test := []struct {\n        start string\n        end   string\n        check string\n    }{\n        {\"23:00\", \"05:00\", \"04:00\"},\n        {\"23:00\", \"05:00\", \"23:30\"},\n        {\"23:00\", \"05:00\", \"20:00\"},\n        {\"10:00\", \"21:00\", \"11:00\"},\n        {\"10:00\", \"21:00\", \"22:00\"},\n        {\"10:00\", \"21:00\", \"03:00\"},\n        {\"22:00\", \"02:00\", \"00:00\"},\n        {\"10:00\", \"21:00\", \"10:00\"},\n        {\"10:00\", \"21:00\", \"21:00\"},\n    }\n    newLayout := \"15:04\"\n    for _, t := range test {\n        check, _ := time.Parse(newLayout, t.check)\n        start, _ := time.Parse(newLayout, t.start)\n        end, _ := time.Parse(newLayout, t.end)\n        fmt.Println(t.start+\"-\"+t.end, t.check, inTimeSpan(start, end, check))\n    }\n}\n</code></pre>\n\n<p>Output :</p>\n\n<pre><code>23:00-05:00 04:00 true\n23:00-05:00 23:30 true\n23:00-05:00 20:00 false\n10:00-21:00 11:00 true\n10:00-21:00 22:00 false\n10:00-21:00 03:00 false\n22:00-02:00 00:00 true\n10:00-21:00 10:00 false\n10:00-21:00 21:00 false\n</code></pre>\n\n<p>You will notice on the two last cases that the check is not inclusive for the start time, nor the end time. If you need to change that behavior, you can remediate this by changing the function a little :</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func inTimeSpanEx(start, end, check time.Time, includeStart, includeEnd bool) bool {\n    _start := start\n    _end := end\n    _check := check\n    if end.Before(start) {\n        _end = end.Add(24 * time.Hour)\n        if check.Before(start) {\n            _check = check.Add(24 * time.Hour)\n        }\n    }\n\n    if includeStart {\n    _start = _start.Add(-1 * time.Nanosecond)\n    }\n    if includeEnd {\n    _end = _end.Add(1 * time.Nanosecond)\n    }\n\n    return _check.After(_start) &amp;&amp; _check.Before(_end)\n}\n</code></pre>\n\n<p>Extract of the output when calling with <code>true</code> for inclusion of start and end :</p>\n\n<pre><code>10:00-21:00 10:00 true\n10:00-21:00 21:00 true\n</code></pre>\n\n<p>Complete playground here : <a href=\"https://play.golang.org/p/8ig34gmHl71\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8ig34gmHl71</a></p>\n"}, {"tags": [], "owner": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "is_accepted": true, "score": 0, "last_activity_date": 1574912926, "last_edit_date": 1574912926, "creation_date": 1574908484, "answer_id": 59080984, "question_id": 55093676, "link": "https://stackoverflow.com/questions/55093676/checking-if-current-time-is-in-a-given-interval-golang/59080984#59080984", "title": "Checking if current time is in a given interval, GOLANG", "body": "<p>Here is a clean solution which is immune from time zone issues. In my context, I run a function in a concurrent timer thread and it calls this function every 5 minutes to check the time against the given range.</p>\n\n<p>Note that you should use whole minutes only for this to work. While I haven't tested it, I think the <code>time.Kitchen</code> layout will strip seconds during the time conversions. There is no need to specify seconds as the selector will take every time in the range except the exact end time.</p>\n\n<p>There is no accounting for midnight but I didn't need that functionality. If you wanted that you could test </p>\n\n<pre><code>if end.Before(start) {\n\nif timeNow.After(start) {\n   return false \n}\n\nif timeNow.After(end) {\n   return true\n}\nreturn false\n} else {\n\n....\n}\n</code></pre>\n\n<p>Here is my function as it is.</p>\n\n<pre><code>func stringToTime(str string) time.Time {\n    tm, err := time.Parse(time.Kitchen, str)\n    if err != nil {\n        fmt.Println(\"Failed to decode time:\", err)\n    }\n    fmt.Println(\"Time decoded:\", tm)\n    return tm\n}\n\nfunc isInTimeRange() bool {\n\n    startTimeString := \"06:00AM\"  // \"01:00PM\"\n\n    endTimeString := \"06:05AM\"\n\n    t := time.Now()\n\n    zone, offset := t.Zone()\n\n    fmt.Println(t.Format(time.Kitchen), \"Zone:\", zone, \"Offset UTC:\", offset)\n\n    timeNowString := t.Format(time.Kitchen)\n\n    fmt.Println(\"String Time Now: \", timeNowString)\n\n    timeNow := stringToTime(timeNowString)\n\n    start := stringToTime(startTimeString)\n\n    end := stringToTime(endTimeString)\n\n    fmt.Println(\"Local Time Now: \", timeNow)\n\n    if timeNow.Before(start) {\n        return false\n    }\n\n    if timeNow.Before(end) {\n        return true\n    }\n\n    return false\n}\n</code></pre>\n\n<p>Output</p>\n\n<blockquote>\n  <p>What's the time, Mr Wolf?</p>\n  \n  <p>10:58AM Zone: ACST Offset UTC: 34200</p>\n  \n  <p>String Time Now:  10:58AM</p>\n  \n  <p>Time decoded: 0000-01-01 10:58:00 +0000 UTC</p>\n  \n  <p>Time decoded: 0000-01-01 11:00:00 +0000 UTC</p>\n  \n  <p>Time decoded: 0000-01-01 11:05:00 +0000 UTC</p>\n  \n  <p>Local Time Now:  0000-01-01 10:58:00 +0000 UTC</p>\n  \n  <p>What's the time, Mr Wolf?</p>\n  \n  <p>11:03AM Zone: ACST Offset UTC: 34200</p>\n  \n  <p>String Time Now:  11:03AM</p>\n  \n  <p>Time decoded: 0000-01-01 11:03:00 +0000 UTC</p>\n  \n  <p>Time decoded: 0000-01-01 11:00:00 +0000 UTC</p>\n  \n  <p>Time decoded: 0000-01-01 11:05:00 +0000 UTC</p>\n  \n  <p>Local Time Now:  0000-01-01 11:03:00 +0000 UTC</p>\n  \n  <p>Time to eat you!</p>\n</blockquote>\n"}], "owner": {"reputation": 399, "user_id": 3450077, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/648595373/picture?type=large", "display_name": "Francesco", "link": "https://stackoverflow.com/users/3450077/francesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6277, "favorite_count": 3, "accepted_answer_id": 59080984, "answer_count": 4, "score": 5, "last_activity_date": 1579201734, "creation_date": 1552262763, "last_edit_date": 1552263366, "question_id": 55093676, "link": "https://stackoverflow.com/questions/55093676/checking-if-current-time-is-in-a-given-interval-golang", "title": "Checking if current time is in a given interval, GOLANG", "body": "<p>I am trying to find a way to check if the current time is in a given interval, where start and end are given (eventually) by a user.</p>\n\n<p>I have been trying by using the After and Before from the Time package after making sure all times are in UTC, but clearly I am doing something wrong.</p>\n\n<p>The code looks similar to this example:</p>\n\n<pre><code>func inTimeSpan(start, end, check time.Time) bool {\n    return check.After(start) &amp;&amp; check.Before(end)\n}\n\nfunc main() {\n\n    now := time.Now()\n    newLayout := \"15:04\"\n    ns, _ := time.Parse(newLayout, strconv.Itoa(now.Hour())+\":\"+strconv.Itoa(now.Minute()))\n    srt, _ := time.Parse(newLayout, \"23:00\")\n    end, _ := time.Parse(newLayout, \"05:00\")\n\n    fmt.Println(\"1 : \", inTimeSpan(srt, end, ns))\n}\n</code></pre>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1552266092, "post_id": 55093636, "comment_id": 96932208, "body": "I don&#39;t see a call to insertByKey following a call to put. Update the code to show the sequence of function calls that you are asking about, what happens and what you expect."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1552284756, "post_id": 55093636, "comment_id": 96935671, "body": "Please shorten your code."}], "owner": {"reputation": 211, "user_id": 7613665, "user_type": "registered", "accept_rate": 35, "profile_image": "https://graph.facebook.com/1204199846363491/picture?type=large", "display_name": "Sander Helles&#248;", "link": "https://stackoverflow.com/users/7613665/sander-helles%c3%b8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552262335, "creation_date": 1552262335, "question_id": 55093636, "link": "https://stackoverflow.com/questions/55093636/unable-to-update-value-of-pointer-inside-method", "title": "Unable to update value of pointer inside method", "body": "<p>I'm implementing an AVLTreeMap in Go but having some problems with values passed in as pointers. I'm attempting to update the value of a node pointer but its value won't persist after the function. </p>\n\n<p>In the function <strong>func (tree *AVLTreeMap) put(key int, value string)</strong>. I am able to modify the root node of the tree and can print it in the main. However, when I pass that same root to the function <strong>func (node *Node) insertByKey(key int, value string)</strong> right after, the value won't update and only the value from put() persists. </p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n    \"io\"\n)\n\n/* NODE */\ntype Node struct {\n    key     int\n    value   string\n    left    *Node\n    right   *Node\n    height  int\n}\n\n\n/* TREE */\ntype AVLTreeMap struct {\n    root *Node\n}\n\nfunc (tree *AVLTreeMap) get(key int) string {\n    value := tree.root.lookupByKey(key)\n    if value == \"\" {\n        return \"Not Found\"\n    }\n\n    return value\n}\n\nfunc (node *Node) inOrder() {\n    fmt.Println(node)\n    if (node != nil) {\n        fmt.Println(node.key)\n\n        node.left.inOrder()\n        node.inOrder()\n        node.right.inOrder()\n    }\n}\n\nfunc (node *Node) lookupByKey(key int) string {\n\n    if (node == nil) {                  // check for nullptr\n        return \"\"\n\n    } else if (node.key == key) {       // key matching\n        return node.value\n\n    } else if (key &lt; node.left.key) {   // recur left\n        return node.left.lookupByKey(key)\n\n    } else if (key &gt; node.right.key) {  // recur right\n        return node.right.lookupByKey(key)\n    } \n\n    return \"\"\n}\n\nfunc (node *Node) insertByKey(key int, value string)  {\n\n    if (node == nil) {                  // check for nullptr\n        node = &amp;Node{ key: key, value: value,}\n\n    } else if (key &lt; node.key) {   // recur left\n        node.left.insertByKey(key, value)\n\n    } else if (key &gt; node.key) {  // recur right\n        node.right.insertByKey(key, value)\n    }\n}\n\nfunc (tree *AVLTreeMap) put(key int, value string) {\n    //fmt.Println(tree.root)\n    tree.root = &amp;Node{ key: 1, value: \"2\",}\n    tree.root.insertByKey(key, value)\n}\n\nfunc (tree *AVLTreeMap) remove(key int) {\n    return\n}\n\nfunc (tree *AVLTreeMap) levelOrder() {\n    return\n}\n\nfunc (tree *AVLTreeMap) rotateLeft(curr *Node) *Node {\n    return curr\n}\n\nfunc (tree *AVLTreeMap) rotateRight(curr *Node) *Node {\n    return curr\n}\n\nfunc (tree *AVLTreeMap) getHeight(curr *Node) int {\n    return 1\n}\n\nfunc (tree *AVLTreeMap) getBalance(curr *Node) int {\n    return 1\n}\n\n/* UTILS */\nfunc checkError(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc strToInt(val string) int {\n    if val, err := strconv.Atoi(val); err == nil {\n        return val   \n    }\n\n    return 0\n}\n\nfunc readLine(reader *bufio.Reader) string {\n    str, _, err := reader.ReadLine()\n    if err == io.EOF {\n        return \"\"\n    }\n\n    return strings.TrimRight(string(str), \"\\r\\n\")\n}\n\nfunc getCommand(command string, tree *AVLTreeMap) {\n\n    vals := strings.Split(command, \" \")\n    var (\n        key int\n        val string\n    )\n\n    if len(vals) == 1 {         // level order\n        tree.levelOrder()\n\n    } else if len(vals) == 3 {  // put\n        key, val = strToInt(vals[1]), vals[2]\n        tree.put(key, val)\n\n    } else if len(vals) == 2 {  // get\n        //key = strToInt(vals[1])\n        //fmt.Println(tree.get(key)) \n    }\n}\n\nfunc main() {\n    reader := bufio.NewReaderSize(os.Stdin, 16 * 1024 * 1024)\n\n    // get num commands\n    numCommands := strToInt(readLine(reader))\n    fmt.Println(numCommands)\n\n    // initialize new TreeMap\n    tree := AVLTreeMap{}\n    //tree.root = &amp;Node{ key: 1, value: \"z\", }\n\n    for {\n        val := readLine(reader)\n        if val == \"\" {\n            break;\n        } else {\n\n            // run commands on tree\n            getCommand(val, &amp;tree)\n        }\n    }\n    fmt.Println(tree.root)\n    //tree.root.inOrder()\n}\n</code></pre>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1552261307, "post_id": 55093115, "comment_id": 96931369, "body": "That&#39;s an... unusual way of implementing a worker pool. Why not the &quot;standard&quot; way: a task queue which is a [buffered] channel and several worker goroutines?"}, {"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552261654, "post_id": 55093115, "comment_id": 96931446, "body": "I tried that way but I was not able to do it, could you provide an example?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552261822, "post_id": 55093115, "comment_id": 96931477, "body": "Yeah, I&#39;m trying to find a good blog post on the topic I read a while back."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1552262185, "post_id": 55093115, "comment_id": 96931549, "body": "Ah, here it is, check it out: <a href=\"http://marcio.io/2015/07/handling-1-million-requests-per-minute-with-golang/\" rel=\"nofollow noreferrer\">marcio.io/2015/07/&hellip;</a>. The author does get carried away with channels, it seems, but there are some good tips in the comments too."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1552262770, "post_id": 55093115, "comment_id": 96931662, "body": "<a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">gobyexample.com/worker-pools</a>"}, {"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1552262780, "post_id": 55093115, "comment_id": 96931663, "body": "you are right, it&#39;s a great article, thanks !"}], "answers": [{"comments": [{"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "edited": false, "score": 0, "creation_date": 1553378003, "post_id": 55123568, "comment_id": 97364335, "body": "I was looking something like that but it turns out I had a wrong approach and I ended up doing a <a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">worker pool</a>"}], "tags": [], "owner": {"reputation": 1219, "user_id": 3864339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aQ1gO.jpg?s=128&g=1", "display_name": "Juan Cespedes", "link": "https://stackoverflow.com/users/3864339/juan-cespedes"}, "is_accepted": false, "score": 1, "last_activity_date": 1552399955, "creation_date": 1552399955, "answer_id": 55123568, "question_id": 55093115, "link": "https://stackoverflow.com/questions/55093115/select-from-slice-of-channelssending-to-a-free-channel/55123568#55123568", "title": "Select from slice of channels(sending to a free channel)?", "body": "<p>You can use <a href=\"https://golang.org/pkg/reflect/#Select\" rel=\"nofollow noreferrer\">reflect.Select</a>, creating a slice of <code>SelectCase</code> structs with <code>Dir=SelectSend</code>, like this:</p>\n\n<pre><code>max:=7\nvar channels []chan item\nfor i:=0;i&lt;max;i++{\n    channel=make(chan item)\n    channels=append(channels,channel)\n}\nfor _, me := range items {\n    cases := make([]reflect.SelectCase, max)\n    for j := 0; j &lt; max; j++ {\n        cases[j] = reflect.SelectCase{\n            Dir: reflect.SelectSend,\n            Chan: reflect.ValueOf(channels[j]),\n            Send: reflect.ValueOf(me)\n        }\n    }\n    reflect.Select(cases)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "is_accepted": true, "score": 0, "last_activity_date": 1553396588, "last_edit_date": 1553396588, "creation_date": 1553378631, "answer_id": 55318814, "question_id": 55093115, "link": "https://stackoverflow.com/questions/55093115/select-from-slice-of-channelssending-to-a-free-channel/55318814#55318814", "title": "Select from slice of channels(sending to a free channel)?", "body": "<p>I had a wrong approach and the answer was easy with \n<a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">worker pools</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type item struct {\n    me []byte\n}\n\nfunc worker(canalFiles &lt;-chan item, wg *sync.WaitGroup) {\n    for file := range canalFiles {\n        file.save()\n        wg.Done()\n    }\n}\nfunc main() {\n    var wg sync.WaitGroup\n    items := getItems()\n    wg.Add(len(items))\n    canalFiles := make(chan item)\n    for i := 0; i &lt; 8; i++ {\n        go worker(canalFiles, &amp;wg)\n    }\n    for _, file := range items {\n        canalFiles &lt;- file\n    }\n    fmt.Printf(\"waiting.....\")\n    wg.Wait()\n}\n\n\n</code></pre>\n"}], "owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 55318814, "answer_count": 2, "score": 1, "last_activity_date": 1553396588, "creation_date": 1552257614, "question_id": 55093115, "link": "https://stackoverflow.com/questions/55093115/select-from-slice-of-channelssending-to-a-free-channel", "title": "Select from slice of channels(sending to a free channel)?", "body": "<p>I'm making multiples http request:</p>\n\n<pre><code>    type item struct{\n       me []byte\n    }\n    items := getItems()\n    for _, me := range items {\n          me.save()\n    }\n</code></pre>\n\n<p>In order to do it efficiently I'm doing it with go rutines, my first approach was to make it like a pool of go rutines: </p>\n\n<pre><code>    items := getItems()\n    var wg sync.WaitGroup\n    wg.Add(len(items))\n    for _, me := range items {\n        go func(me item) {\n            me.save()\n            wg.Done()\n        }(me)\n    }\n    wg.Wait()\n</code></pre>\n\n<p>But they all try to make http request at the same time and some of them fail because of my bandwidth can't handle them all.\nSo I try channels along with <code>select</code> instead :</p>\n\n<pre><code>    channel1 := make(chan item)\n    channel2 := make(chan item)\n    channel3 := make(chan item)\n    var wg sync.WaitGroup\n    items := getItems()\n    wg.Add(len(items))\n    go func() {\n        for me := range channel1 {\n            me.save()\n            wg.Done()\n        }\n    }()\n    go func() {\n        for me := range channel2 {\n            me.save()\n            wg.Done()\n        }\n    }()\n    go func() {\n        for me := range channel3 {\n            me.save()\n            wg.Done()\n        }\n    }()\n    for _, me := range items {\n        select {\n        case channel1 &lt;- me:\n        case channel2 &lt;- me:\n        case channel3 &lt;- me:\n        }\n    }\n</code></pre>\n\n<p>But adding more go rutines to find the max go rutines my bandwidht can handle, my code gets larger and larger, and I try to do this:</p>\n\n<pre><code>    max:=7\n    var channels []chan item\n    for i:=0;i&lt;max;i++{\n        channel=make(chan item)\n        channels=append(channels,channel)\n    }\n    for _, me := range items {\n        select {\n            //???????????????\n        }\n    }\n</code></pre>\n\n<p>but I'm not prety sure how to do it as the last approach</p>\n\n<p>Also take in mind that  \"Select from slice of channels\" was a question already asked, but their answers were only when <code>select</code> is listening which channel arrive first, in my case I want <code>Select</code>  to send any free channel, so it's different</p>\n"}, {"tags": ["go", "hugo"], "answers": [{"tags": [], "owner": {"reputation": 4763, "user_id": 473923, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/VCdUV.jpg?s=128&g=1", "display_name": "David Cruwys", "link": "https://stackoverflow.com/users/473923/david-cruwys"}, "is_accepted": false, "score": 0, "last_activity_date": 1552263392, "creation_date": 1552263392, "answer_id": 55093734, "question_id": 55093093, "link": "https://stackoverflow.com/questions/55093093/unexpected-in-operand/55093734#55093734", "title": "unexpected &quot;=&quot; in operand", "body": "<p>I found that my version of go was old and it needed updating to 1.11</p>\n\n<p>I followed the instructions found here</p>\n\n<p><a href=\"https://medium.com/@RidhamTarpara/install-go-1-11-on-ubuntu-18-04-16-04-lts-8c098c503c5f\" rel=\"nofollow noreferrer\">install-go-1-11-on-ubuntu</a></p>\n\n<p>I had one slight variation, I used Go1.12 instead of 1.11</p>\n\n<pre><code># From the docs\nsudo tar -xvf go1.11.linux-amd64.tar.gz\n\n# This is the latest version when I updated\nsudo tar -xvf go1.12.linux-amd64.tar.gz\n</code></pre>\n\n<p>I also had to update my version of hugo.</p>\n\n<p>Any time I did the following</p>\n\n<pre><code>sudo apt-get install hugo\n</code></pre>\n\n<p>I ended up with version 40</p>\n\n<p>I followed the instructions here to go to <a href=\"https://computingforgeeks.com/how-to-install-hugo-on-ubuntu-18-04-lts/\" rel=\"nofollow noreferrer\">version 53</a>  of GO</p>\n"}], "owner": {"reputation": 4763, "user_id": 473923, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/VCdUV.jpg?s=128&g=1", "display_name": "David Cruwys", "link": "https://stackoverflow.com/users/473923/david-cruwys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1218, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1552291186, "creation_date": 1552257345, "last_edit_date": 1552291186, "question_id": 55093093, "link": "https://stackoverflow.com/questions/55093093/unexpected-in-operand", "title": "unexpected &quot;=&quot; in operand", "body": "<p>I am getting this error in a Hugo theme and have modified the code to use a simple example from the Hugo documentation and still get an error.</p>\n\n<blockquote>\n  <p>unexpected \"=\" in operand</p>\n</blockquote>\n\n<p>Hugo Version</p>\n\n<blockquote>\n  <p>Hugo Static Site Generator v0.40.1 linux/amd64 BuildDate: 2018-04-25T17:16:11Z</p>\n</blockquote>\n\n<p>Go Version</p>\n\n<blockquote>\n  <p>go version go1.12 linux/amd64</p>\n</blockquote>\n\n<p>I have copied this code directly from the <a href=\"https://gohugo.io/functions/append/\" rel=\"nofollow noreferrer\">GoHugo - Append</a> example.</p>\n\n<p>Error</p>\n\n<pre><code>ERROR 2019/03/11 09:24:53 theme/partials/work.html : template: theme/partials/work.html:3: unexpected \"=\" in operand\n</code></pre>\n\n<p>Simplified Template</p>\n\n<pre><code>{{ partial \"global-header.html\" . }}\n\n{{ $s := slice \"a\" \"b\" \"c\" }}\n{{ $s = $s | append \"d\" \"e\" }}\n\n&lt;h1&gt;David&lt;/h1&gt;\n</code></pre>\n\n<p>I originally got the error in the <a href=\"https://themes.gohugo.io//theme/airspace-hugo/\" rel=\"nofollow noreferrer\">Hugo AirSpace</a> template at line 13 of the work.html partial.</p>\n\n<p>Sample Line</p>\n\n<pre><code>{{ $categories = $categories | append .category }}\n</code></pre>\n\n<p>Full Template</p>\n\n<pre><code>{{ partial \"global-header.html\" . }}\n\n&lt;!-- Portfolio Start --&gt;\n&lt;section id=\"portfolio-work\"&gt;\n    &lt;div class=\"container\"&gt;\n        &lt;div class=\"row\"&gt;\n          &lt;div class=\"col-md-12\"&gt;\n            &lt;div class=\"block\"&gt;\n              &lt;div class=\"portfolio-menu\"&gt;\n                &lt;ul&gt;\n                  {{ $categories := slice }}\n                  {{ range .Site.Data.work.portfolio }}\n                    {{ $categories = $categories | append .category }}\n                  {{ end }}\n                    &lt;li class=\"filter\" data-filter=\"all\"&gt;Everything&lt;/li&gt;\n                  {{ range ( $categories | uniq ) }}\n                    &lt;li class=\"filter\" data-filter=\".{{ . }}\"&gt;{{ . }}&lt;/li&gt;\n                  {{ end }}\n                &lt;/ul&gt;\n              &lt;/div&gt;\n              &lt;div class=\"portfolio-contant\"&gt;\n                &lt;ul id=\"portfolio-contant-active\"&gt;\n                  {{ range .Site.Data.work.portfolio }}\n                    &lt;li class=\"mix {{ .category }}\"&gt;\n                      &lt;a class=\"venobox\" href=\"{{ $.Site.BaseURL }}{{ .image }}\"&gt;\n                        &lt;img class=\"img-responsive\" src=\"{{ $.Site.BaseURL }}{{ .image }}\" /&gt;\n                        &lt;div class=\"overly\"&gt;\n                          &lt;div class=\"position-center\"&gt;\n                            &lt;i class=\"fa fa-search fz-20\"&gt;&lt;/i&gt;\n                            &lt;h2&gt;{{ .name }}&lt;/h2&gt;\n                            &lt;p&gt;{{ .description }}&lt;/p&gt;\n                          &lt;/div&gt;\n                      &lt;/a&gt;\n                  &lt;/li&gt;\n                  {{ end }}\n                &lt;/ul&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/section&gt;\n\n&lt;!-- Clients Logo Section Start --&gt;\n&lt;section id=\"clients-logo-section\"&gt;\n  &lt;div class=\"container\"&gt;\n    &lt;div class=\"row\"&gt;\n      &lt;div class=\"col-md-12\"&gt;\n        &lt;div class=\"block\"&gt;\n          &lt;div id=\"clients-logo\" class=\"owl-carousel\"&gt;\n            {{ range .Site.Data.work.clients }}\n            &lt;div class=\"clients-logo-img\"&gt;\n              &lt;a href=\"{{ .url }}\"&gt;&lt;img src=\"{{ $.Site.BaseURL }}{{ .image }}\" alt=\"Features\"&gt;&lt;/a&gt;\n            &lt;/div&gt;\n            {{ end }}\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/section&gt;\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "edited": false, "score": 0, "creation_date": 1552299784, "post_id": 55093180, "comment_id": 96942376, "body": "Thanks Sir Nicolas Barbosa"}, {"owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "edited": false, "score": 0, "creation_date": 1552316332, "post_id": 55093180, "comment_id": 96952171, "body": "Hi Sir Nicolas. Please I have similar issue on this post. Please I need your help. Thanks.   <a href=\"https://stackoverflow.com/questions/55104623/how-to-properly-display-a-json-sub-array-within-the-main-array\" title=\"how to properly display a json sub array within the main array\">stackoverflow.com/questions/55104623/&hellip;</a>"}], "tags": [], "owner": {"reputation": 46, "user_id": 9525074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMqW2.jpg?s=128&g=1", "display_name": "Nicolas Barbosa", "link": "https://stackoverflow.com/users/9525074/nicolas-barbosa"}, "is_accepted": true, "score": 3, "last_activity_date": 1552258100, "creation_date": 1552258100, "answer_id": 55093180, "question_id": 55092882, "link": "https://stackoverflow.com/questions/55092882/how-to-properly-display-all-records-as-arrays-via-json/55093180#55093180", "title": "How to properly display all records as arrays via JSON", "body": "<p>Add <strong>PostLikeCount</strong> and <strong>PostUnlikeCount</strong> to <strong>Post</strong> struct:</p>\n\n<pre><code>type Post struct {\n    Id              int\n    Title           string\n    Content         string\n    PostLikeCount   int\n    PostUnlikeCount int\n}\n</code></pre>\n\n<p>After query \"SELECT COUNT(*) as postlikeCount FROM postData ...\":</p>\n\n<pre><code>post.PostLikeCount = postlikeCount\n</code></pre>\n\n<p>After query \"SELECT COUNT(*) as postunlikeCount FROM postData ...\":</p>\n\n<pre><code>post.PostUnlikeCount = postunlikeCount\n</code></pre>\n"}], "owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 55093180, "answer_count": 1, "score": 0, "last_activity_date": 1576329258, "creation_date": 1552255540, "last_edit_date": 1576329258, "question_id": 55092882, "link": "https://stackoverflow.com/questions/55092882/how-to-properly-display-all-records-as-arrays-via-json", "title": "How to properly display all records as arrays via JSON", "body": "<p>I have been learning golang and coding this.</p>\n\n<p>The <strong>golang</strong> code below display two post records from database in an array via json. At the moment this is the json response am getting when I run the code and is okay for now.</p>\n\n<pre><code>[\n{\"id\":\"1\",\n\"title\":\"Post Title 1 \",\n\"content\":\"post content 1.\"\n},\n\n{\"id\":\"2\",\n\"title\":\"post Title 2 \",\n\"content\":\"post content 2 \"\n}\n]\n</code></pre>\n\n<p>At the moment, <strong>postlikeCount</strong> and <strong>postunlikeCount</strong> are not fetched in the array because they reside in another table.</p>\n\n<p>If everything works fine, am supposed to get an array like this which contains everything like the sample below.</p>\n\n<pre><code>[\n{\"id\":\"1\",\n\"title\":\"Post Title 1 \",\n\"content\":\"post content 1.\",\n\"postlikeCount\":\"2\",\n\"postunlikeCount\":\"1\"},\n\n{\"id\":\"2\",\n\"title\":\"post Title 2 \",\n\"content\":\"post content 2 \",\n\"postlikeCount\":\"4\",\n\"postunlikeCount\":\"0\"}\n]\n</code></pre>\n\n<p>Now to get <strong>postlikeCount</strong> and <strong>postunlikeCount</strong>, I have implemented two sect of codings below which I passed within post <code>for rows.next() functions</code>.</p>\n\n<pre><code>// get postlikeCount based on userid and postid\nvar userid =5\nvar  postlikeCount int\nerr := db.QueryRow(\"SELECT COUNT(*) as postlikeCount FROM postData WHERE postid=? and userid=?\", postid,userid).Scan(&amp;postlikeCount)\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf(\"Number of postlikeCount rows are %s\\n\",  postlikeCount)\n\n\n// get postunlikeCount  based on userid and postid\n\nvar  postunlikeCount int\nerr1 := db.QueryRow(\"SELECT COUNT(*) as postunlikeCount FROM postData WHERE postid=? and userid=?\", postid,userid).Scan(&amp;postunlikeCount)\nif err1 != nil {\n    log.Fatal(err1)\n}\n\nfmt.Printf(\"Number of postunlikeCount rows are %s\\n\",  postunlikeCount)\n</code></pre>\n\n<p>The above two code works fine as I can Print their respective post like and unlike counts.</p>\n\n<p><strong>Here is my issue:</strong></p>\n\n<p>When I tried to pass and append the <strong>postlikeCount</strong> and <strong>postunlikeCount</strong> parameters so that I can print them in json as per this line of code</p>\n\n<pre><code>posts = append(posts, post, postlikeCount,postunlikeCount)\n</code></pre>\n\n<p>It displays error </p>\n\n<pre><code>cannot postlikeCount (type int) as type post in append\ncannot use postunlikeCount (type int) as type post in append\n</code></pre>\n\n<p>Does this error has to do with Struct function? I need to pass <strong>postlikeCount and postunlikeCount</strong> as part of json as can be seen the complete array result above.</p>\n\n<p><strong>Here is the full working code so far:</strong></p>\n\n<pre><code>package main\n\nimport \"database/sql\"\nimport _ \"github.com/go-sql-driver/mysql\"\n\nimport \"net/http\"\nimport \"fmt\"\nimport \"encoding/json\"\nimport \"log\"\n\nvar db *sql.DB\nvar err error\n\ntype Post struct {\nId  int\nTitle string\nContent string  \n\n}\n\n\n\nfunc getRecordPage1(res http.ResponseWriter, req *http.Request) {\n\n    if req.Method != \"POST\" {\n        http.ServeFile(res, req, \"getjsonRecord.html\")\n        return\n    }\n\n\nvar (\npost  Post\nposts []Post\n)\n\nrows, err := db.Query(\"SELECT id,title,content FROM posts\")\nif err != nil {\n            http.Error(res, \"display error, unable to select records in json\", 500)\n            return\n        }\n\nfor rows.Next() {\n\nvar postid =post.Id\nvar title = post.Title\nvar content = post.Content\n\nfmt.Printf(\"%s is now %d\\n\", postid, title, content)\n\n\n// get postlikeCount based on userid and postid\nvar userid =5\nvar  postlikeCount int\nerr := db.QueryRow(\"SELECT COUNT(*) as postlikeCount FROM postData WHERE postid=? and userid=?\", postid,userid).Scan(&amp;postlikeCount)\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf(\"Number of postlikeCount rows are %s\\n\",  postlikeCount)\n\n\n// get postunlikeCount  based on userid and postid\n\nvar  postunlikeCount int\nerr1 := db.QueryRow(\"SELECT COUNT(*) as postunlikeCount FROM postData WHERE postid=? and userid=?\", postid,userid).Scan(&amp;postunlikeCount)\nif err1 != nil {\n    log.Fatal(err1)\n}\n\nfmt.Printf(\"Number of postunlikeCount rows are %s\\n\",  postunlikeCount)\n\n\n\n\n\nrows.Scan(&amp;post.Id, &amp;post.Title, &amp;post.Content)\nposts = append(posts, post)\n\n//like of code comment which causes issues\n//posts = append(posts, post,postlikeCount,postunlikeCount)\n}\ndefer rows.Close()\n\n\njsonResponse, jsonError := json.Marshal(posts)\nif jsonError != nil {\nfmt.Println(jsonError)\n}\n\nif jsonResponse == nil {\nfmt.Println(jsonError)\n} else {\nres.Header().Set(\"Content-Type\", \"application/json\")\nres.Write(jsonResponse)\n fmt.Println(\"Json results displayed successfully\")\n}\n\n\n\n}\n\n\n\nfunc homePage(res http.ResponseWriter, req *http.Request) {\n    http.ServeFile(res, req, \"index.html\")\n}\n\nfunc main() {\n    db, err = sql.Open(\"mysql\", \"root:@/golang44\")\n    if err != nil {\n        panic(err.Error())\n    }\n    defer db.Close()\n\n    err = db.Ping()\n    if err != nil {\n        panic(err.Error())\n    }\n\n    http.HandleFunc(\"/getjsonRecord\", getRecordPage1)\n    http.HandleFunc(\"/\", homePage)\n        fmt.Println(\"Listening on 127.0.0.1:8088\")\n    http.ListenAndServe(\":8088\", nil)\n}\n</code></pre>\n"}, {"tags": ["go", "synchronization", "marshalling"], "comments": [{"owner": {"reputation": 101, "user_id": 7863957, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JGfPxlSXnQ0/AAAAAAAAAAI/AAAAAAAADPI/tTmCu9SArI4/photo.jpg?sz=128", "display_name": "Sergey Khomenko", "link": "https://stackoverflow.com/users/7863957/sergey-khomenko"}, "edited": false, "score": 0, "creation_date": 1552254261, "post_id": 55092552, "comment_id": 96929894, "body": "I have checked it now via debugging tools. <code>cs.Products</code> seems to be empty before marshalling, but why? And how can i fix it?"}, {"owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "edited": false, "score": 2, "creation_date": 1552255670, "post_id": 55092552, "comment_id": 96930216, "body": "you need to call pool.Add() before calling <code>go cs.GetProducts</code> not inside GetProducts. Also localPool never seems to have Add or Done called on it, so its doing nothing."}, {"owner": {"reputation": 101, "user_id": 7863957, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JGfPxlSXnQ0/AAAAAAAAAAI/AAAAAAAADPI/tTmCu9SArI4/photo.jpg?sz=128", "display_name": "Sergey Khomenko", "link": "https://stackoverflow.com/users/7863957/sergey-khomenko"}, "reply_to_user": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "edited": false, "score": 0, "creation_date": 1552258817, "post_id": 55092552, "comment_id": 96930898, "body": "@superfell I have removed part of method"}, {"owner": {"reputation": 101, "user_id": 7863957, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JGfPxlSXnQ0/AAAAAAAAAAI/AAAAAAAADPI/tTmCu9SArI4/photo.jpg?sz=128", "display_name": "Sergey Khomenko", "link": "https://stackoverflow.com/users/7863957/sergey-khomenko"}, "reply_to_user": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "edited": false, "score": 0, "creation_date": 1552258868, "post_id": 55092552, "comment_id": 96930912, "body": "@superfell thanks for idea, I will try"}, {"owner": {"reputation": 101, "user_id": 7863957, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JGfPxlSXnQ0/AAAAAAAAAAI/AAAAAAAADPI/tTmCu9SArI4/photo.jpg?sz=128", "display_name": "Sergey Khomenko", "link": "https://stackoverflow.com/users/7863957/sergey-khomenko"}, "reply_to_user": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "edited": false, "score": 0, "creation_date": 1552259281, "post_id": 55092552, "comment_id": 96931004, "body": "@superfell Yes, it&#39;s working. Thanks. But why I can&#39;t use <code>wg.Add</code> even if I pass it through by pointer? Could you explain?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552315230, "post_id": 55092552, "comment_id": 96951433, "body": "You have a race condition on <code>s.Products = append(s.Products, product)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7863957, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JGfPxlSXnQ0/AAAAAAAAAAI/AAAAAAAADPI/tTmCu9SArI4/photo.jpg?sz=128", "display_name": "Sergey Khomenko", "link": "https://stackoverflow.com/users/7863957/sergey-khomenko"}, "edited": false, "score": 0, "creation_date": 1552259345, "post_id": 55092873, "comment_id": 96931014, "body": "Thanks for the answer. Using <code>wg.Add</code> before routine is solved this problem"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1552278164, "post_id": 55092873, "comment_id": 96934219, "body": "@Adam Straughan there is a race condition in the code you have provided as a solution."}, {"owner": {"reputation": 2696, "user_id": 14019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e4654adc0a8cf62d437e014fd9f8435?s=128&d=identicon&r=PG", "display_name": "Adam Straughan", "link": "https://stackoverflow.com/users/14019/adam-straughan"}, "edited": false, "score": 0, "creation_date": 1552289308, "post_id": 55092873, "comment_id": 96937215, "body": "Yes, there is. I would use channels rather than sharing state across the goroutines. If I have time I&#39;ll update the post"}, {"owner": {"reputation": 2696, "user_id": 14019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e4654adc0a8cf62d437e014fd9f8435?s=128&d=identicon&r=PG", "display_name": "Adam Straughan", "link": "https://stackoverflow.com/users/14019/adam-straughan"}, "edited": false, "score": 1, "creation_date": 1552290268, "post_id": 55092873, "comment_id": 96937654, "body": "removed race condition . Probably,. I&#39;ve not it tested properly, I&#39;m on a train and a bit busy :-)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552315311, "post_id": 55092873, "comment_id": 96951480, "body": "The <code>Wait</code>/<code>Add</code>/<code>close</code>/<code>Wait</code> is unnecessary. You can just <code>Wait</code> and then <code>close</code>."}, {"owner": {"reputation": 2696, "user_id": 14019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e4654adc0a8cf62d437e014fd9f8435?s=128&d=identicon&r=PG", "display_name": "Adam Straughan", "link": "https://stackoverflow.com/users/14019/adam-straughan"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552316021, "post_id": 55092873, "comment_id": 96951986, "body": "@Adrian If you just wait and close, there is no guarantee that <code>s.Products = append(s.Products, p)</code> is executed before the program terminates. I suspect there is a neater way to do this though, feel free to submit a better version, I&#39;d be interested (that sounds sarcastic, it&#39;s not meant to be :-) )"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552316182, "post_id": 55092873, "comment_id": 96952085, "body": "Nevermind, I misread the code. You should be doing the <code>Wait</code> and <code>close</code> in a goroutine, and the reads directly in <code>GetProducts</code>, instead of the other way around. This avoids the messy extra <code>Add</code>/<code>Wait</code> at the end."}], "tags": [], "owner": {"reputation": 2696, "user_id": 14019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e4654adc0a8cf62d437e014fd9f8435?s=128&d=identicon&r=PG", "display_name": "Adam Straughan", "link": "https://stackoverflow.com/users/14019/adam-straughan"}, "is_accepted": true, "score": 3, "last_activity_date": 1552293298, "last_edit_date": 1552293298, "creation_date": 1552255497, "answer_id": 55092873, "question_id": 55092552, "link": "https://stackoverflow.com/questions/55092552/json-marshal-set-null/55092873#55092873", "title": "json.Marshal set null", "body": "<p>The abstractions used here don't seem consistent for me. I'd just make the basic call to GetProducts a blocking call, then just use the wait group for when you need them. Once you simplify then you can see that there is no sync action happening where the data is written. (in getPage) so you do end up with nil</p>\n\n<p><em>Race condition fixed</em></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"sync\"\n)\n\ntype CategoryScrapper struct {\n    Name     string        `json:\"name\"`\n    Link     string        `json:\"link\"`\n    Products []ProductData `json:\"products\"`\n}\n\ntype ProductData struct {\n    Name        string `json:\"name\"`\n    Link        string `json:\"link\"`\n    Thumbnail   string `json:\"thumbnail\"`\n    OriginPrice string `json:\"OriginPrice\"`\n    Excerpt     string `json:\"Excerpt\"`\n}\n\nfunc (*CategoryScrapper) getMaxPageNum() int {\n    return 1\n}\nfunc main() {\n    cs := CategoryScrapper{\n        Name: \"Name\",\n        Link: \"/link\",\n    }\n\n    cs.GetProducts()\n\n    res, err := json.Marshal(cs)\n    if err != nil {\n        fmt.Printf(\"ERROR: %v\", err)\n    }\n\n    fmt.Println(string(res))\n}\n\nfunc (s *CategoryScrapper) GetProducts() {\n    maxPageNum := s.getMaxPageNum()\n    var wg sync.WaitGroup\n    ch := make(chan ProductData)\n    go func() {\n        for p := range ch {\n            s.Products = append(s.Products, p)\n        }\n        wg.Done()\n    }()\n\n    for i := 1; i &lt;= maxPageNum; i++ {\n        wg.Add(1)\n        go func(i int) {\n            defer wg.Done()\n            ch &lt;- s.getPage(i)\n        }(i)\n    }\n\n    wg.Wait()\n    // make sure we close the chan reader go routine\n    wg.Add(1)\n    close(ch)\n    wg.Wait()\n}\n\nfunc (s *CategoryScrapper) getPage(page int) ProductData {\n    return ProductData{\n        Name:        \"Name\",\n        Link:        \"Link\",\n        Thumbnail:   \"Thumb\",\n        OriginPrice: \"1111\",\n        Excerpt:     \"Excerpt\",\n    }\n}\n</code></pre>\n\n<p>A few stylistic points:\nFor your <code>Products</code> slice you don't need to initialise it to a zero length size, nil is find to append to.\nI removed a number package prefixes like <code>Product</code> it helps people answer if you can get you example to run in play.golang.org easily</p>\n\n<p>Hope this helps. It is only obvious when you've done it a few times, and even then, not always :-)</p>\n"}], "owner": {"reputation": 101, "user_id": 7863957, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JGfPxlSXnQ0/AAAAAAAAAAI/AAAAAAAADPI/tTmCu9SArI4/photo.jpg?sz=128", "display_name": "Sergey Khomenko", "link": "https://stackoverflow.com/users/7863957/sergey-khomenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 55092873, "answer_count": 1, "score": -1, "last_activity_date": 1552293298, "creation_date": 1552253072, "last_edit_date": 1552253424, "question_id": 55092552, "link": "https://stackoverflow.com/questions/55092552/json-marshal-set-null", "title": "json.Marshal set null", "body": "<p>I am new in Go. I'm trying to do scraper for the data from one my website, to be able to use it inside the Go app.</p>\n\n<p>I using goroutines and sync.WaitGroup for waiting for results, but I have a problem. If I use goroutines and try to use json.Marshal for my dataset, I have empty array inside the structure, that is filling inside the goroutines.</p>\n\n<p>If I am filling my structure without routines, I have everything  working well.</p>\n\n<p>Here are my structures:</p>\n\n<pre><code>type CategoryScrapper struct {\n    Name        string                `json:\"name\"`\n    Link        string                `json:\"link\"`\n    Products []Product.ProductData `json:\"products\"`\n}\n\ntype ProductData struct {\n    Name        string `json:\"name\"`\n    Link        string `json:\"link\"`\n    Thumbnail   string `json:\"thumbnail\"`\n    OriginPrice string `json:\"OriginPrice\"`\n    Excerpt     string `json:\"Excerpt\"`\n}\n</code></pre>\n\n<p>Here is a part of my app</p>\n\n<pre><code>func main() {\n    cs := Category.CategoryScrapper{\n        Name: \"Name\",\n        Link: \"/link\",\n    }\n\n    wg := new(sync.WaitGroup)\n    go cs.GetProducts(wg)\n    wg.Wait()\n\n    res, _ := json.Marshal(cs)\n\n    fmt.Println(string(res))\n}\n\nfunc (s *CategoryScrapper) GetProducts(pool *sync.WaitGroup) {\n    pool.Add(1)\n    defer pool.Done()\n\n    maxPageNum := s.getMaxPageNum()\n    localPool := new(sync.WaitGroup)\n\n    s.Products = make([]Product.ProductData, 0)\n\n    for i := 1; i &lt;= maxPageNum; i++ {\n        go s.getPage(i, localPool)\n    }\n\n    localPool.Wait()\n}\n\nfunc (s *CategoryScrapper) getPage(page int, waitingPool *sync.WaitGroup) {\n    product := Product.ProductData{\n        Name: \"Name\",\n        Link: \"Link\",\n        Thumbnail: \"Thumb\",\n        OriginPrice: \"1111\",\n        Excerpt: \"Excerpt\",\n    }\n\n    s.Products = append(s.Products, product)\n}\n</code></pre>\n"}, {"tags": ["windows", "go", "service", "process"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552250906, "post_id": 55092139, "comment_id": 96929082, "body": "what type of &quot;server&quot; are you planning to run? Will it be a web-server? http could be used to more cleanly initiate a targeted shutdown."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552251100, "post_id": 55092139, "comment_id": 96929144, "body": "sending a signal requires hunting down the PID of the running process, which is not always a precise task."}, {"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1552252829, "post_id": 55092139, "comment_id": 96929560, "body": "See the answer, the service wrapper should not know what kind of service the server exposes (I might reuse it in the future)"}, {"owner": {"reputation": 775, "user_id": 3521438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192614fc42615856a3e903da98de9c9c?s=128&d=identicon&r=PG&f=1", "display_name": "gloriphobia", "link": "https://stackoverflow.com/users/3521438/gloriphobia"}, "edited": false, "score": 0, "creation_date": 1593797945, "post_id": 55092139, "comment_id": 110914452, "body": "I&#39;m having the same problem! I&#39;m trying to do a graceful shutdown when windows initiates shutdown or the user logs out, but I can&#39;t seem to capture the signal with <code>signal.Notify</code>. So it&#39;s just closing it instantly. The documentation mentions Windows and says that it gets converted into a sigterm, but that doesn&#39;t appear to be happening.... <a href=\"https://godoc.org/os/signal#hdr-Windows\" rel=\"nofollow noreferrer\">godoc.org/os/signal#hdr-Windows</a>"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "reply_to_user": {"reputation": 775, "user_id": 3521438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192614fc42615856a3e903da98de9c9c?s=128&d=identicon&r=PG&f=1", "display_name": "gloriphobia", "link": "https://stackoverflow.com/users/3521438/gloriphobia"}, "edited": false, "score": 0, "creation_date": 1593943299, "post_id": 55092139, "comment_id": 110947827, "body": "@gloriphobia - there are tons of ways to write clean code on Windows, but not necessarily with the same concepts as for other OSes. What is your process? A console app, a Windowed app, a Windows service? You don&#39;t terminate a process &quot;gracefully&quot; if that process is not aware you want to terminate it. For example, Windows services (what you seem to call &quot;headless&quot;) are expected to answer stop requests from API, or Windows UI, or shutdown. Not sure go or its associated wrappers are aware of that. Also CTRL+C (only for GUI-console app with) is not graceful if app doesn&#39;t handle it gracefully."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 1, "creation_date": 1593945578, "post_id": 55092139, "comment_id": 110948437, "body": "There seems to be an official example of a go Windows service with stop command being properly handled: <a href=\"https://godoc.org/golang.org/x/sys/windows/svc\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/sys/windows/svc</a> and also this: <a href=\"https://github.com/kardianos/service\" rel=\"nofollow noreferrer\">github.com/kardianos/service</a>"}, {"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1594033545, "post_id": 55092139, "comment_id": 110974791, "body": "You&#39;re talking about windows services, that&#39;s a different context. Here it&#39;s closer to a console use case, especially when debugging the program in the IDE."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 1, "creation_date": 1594034690, "post_id": 55092139, "comment_id": 110975354, "body": "@JohnWhite - It&#39;s you who said &quot;a server application in Go, and using a wrapper to run it as a Windows service&quot;, not me. That doesn&#39;t change the fact CTRL-C is not the solution anyway."}, {"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1594054004, "post_id": 55092139, "comment_id": 110985706, "body": "Apologies, the explanation isn&#39;t clear indeed. The windows service <i>starts</i> another program, it doesn&#39;t have the server code inside. It&#39;s a launcher, so that&#39;s why it needs to gracefully stop a process."}, {"owner": {"reputation": 61, "user_id": 6420072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2636ed2bdfe323ff03a362bd002b80e?s=128&d=identicon&r=PG&f=1", "display_name": "Kax", "link": "https://stackoverflow.com/users/6420072/kax"}, "edited": false, "score": 0, "creation_date": 1594063337, "post_id": 55092139, "comment_id": 110989904, "body": "@JohnWhite The issue you&#39;re experiencing should&#39;ve been solved in go 1.14 <a href=\"https://github.com/golang/go/pull/33311\" rel=\"nofollow noreferrer\">github.com/golang/go/pull/33311</a>"}], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1552252774, "post_id": 55092419, "comment_id": 96929546, "body": "Unfortunately it&#39;s even more messy, as I would need to first authenticate and then issue the shutdown command. Keeping the pid is cleaner and simpler. Plus it would make it necessary to know the listening address from the service wrapper, breaking encapsulation (it shouldn&#39;t even know it&#39;s a web server)"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1552253149, "post_id": 55092419, "comment_id": 96929623, "body": "with a web-services - you can access this remotely without needing remote-shell access. If you are deploying this on multiple architectures - a web-service would be your cleanest interface. Even if your underlying server is not a http service, you could employ the above technique to listen for shutdown events."}, {"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1552253993, "post_id": 55092419, "comment_id": 96929822, "body": "The use case would break for any application that isn&#39;t a web server. As I have another (non web server) program that needs to run as a service (and shutdown gracefully with the OS), this isn&#39;t a viable option, rather a quick hack to make it work temporarily."}, {"owner": {"reputation": 642, "user_id": 3932734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiRyl.png?s=128&g=1", "display_name": "Justin Tamblyn", "link": "https://stackoverflow.com/users/3932734/justin-tamblyn"}, "reply_to_user": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1593960212, "post_id": 55092419, "comment_id": 110952863, "body": "@JohnWhite I&#39;ve dug through a ton of how Windows handles services etc. I don&#39;t think this is supported in Go right now. I hate to be that guy but I think you might have to break the box - go with a creative solution. By that I mean, you could look at running it in Linux Hyper-v VM with Docker installed. Doing so would mean that the Go app would get the the OS signal and Hyper-v would signal the VM on shutdown."}, {"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1594033359, "post_id": 55092419, "comment_id": 110974698, "body": "My answer here solved the problem. Yeah it&#39;s odd, but it works perfectly, apparently go listens to the ctrl+c and turns it into a signal."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 0, "last_activity_date": 1552251946, "creation_date": 1552251946, "answer_id": 55092419, "question_id": 55092139, "link": "https://stackoverflow.com/questions/55092139/gracefully-terminate-a-process-on-windows/55092419#55092419", "title": "Gracefully terminate a process on Windows", "body": "<p>If you are running some form of web-services, may be better to use the web-service itself to initiate a shutdown, as tracking PIDS for signals can get messy.</p>\n\n<p>To stop a http web-service, simply add a route like this:</p>\n\n<pre><code>http.HandleFunc(\"/shutdown\",\n        func(w http.ResponseWriter, r *http.Request) {\n            // stops server - may want to add admin credentials check here!\n            srv.Shutdown(context.Background())\n        })\n</code></pre>\n\n<p>Playground <a href=\"https://play.golang.org/p/457poBXQlTT\" rel=\"nofollow noreferrer\">source-code</a> example.</p>\n\n<pre><code>2019/03/10 16:58:15 Listening on: :8080\n\n$ curl 'localhost:8080/shutdown'\n\n2019/03/10 17:04:17 Listening on: :8080\n2019/03/10 17:04:19 exited cleanly\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1552255707, "post_id": 55092801, "comment_id": 96930224, "body": "How the problem is handled internally is kind of off topic, the problem is how to actually code the signal handling, the documentation doesn&#39;t mention a clear way to do this."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1552260143, "post_id": 55092801, "comment_id": 96931157, "body": "@JohnWhite updated answer to include a working example of registering signal monitoring &amp; context.Context integration."}, {"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 1, "creation_date": 1552266348, "post_id": 55092801, "comment_id": 96932243, "body": "Thanks, this is appreciated. Though you&#39;re right, a big part of the original issue is how to trigger it under windows, which is why after struggling for some hours I posted it there. Hope somebody posts a solution for it. The golang library doesn&#39;t implement signals for windows. Maybe <code>taskkill</code> without flags does it? I&#39;ll do some tests."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1552267550, "post_id": 55092801, "comment_id": 96932402, "body": "I created <code>windows golang</code> program to send signals to pids and can confirm <code>os.Interrupt</code> (-2) is <i>not support</i> - issued at runtime. <code>os.Kill</code> (-9) is supported but as we can see terminates the process without handlers being called."}, {"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 1, "creation_date": 1552302904, "post_id": 55092801, "comment_id": 96944117, "body": "This is exactly why I created this question. Apparently go has no mechanism for receiving the signal from the OS."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 1, "last_activity_date": 1552264910, "last_edit_date": 1552264910, "creation_date": 1552254930, "answer_id": 55092801, "question_id": 55092139, "link": "https://stackoverflow.com/questions/55092139/gracefully-terminate-a-process-on-windows/55092801#55092801", "title": "Gracefully terminate a process on Windows", "body": "<p>The <code>go</code> way to initiate canceling a task/service, is to use the <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">context.Context</a> package.</p>\n\n<p>So if you want a signal handler to trigger the closing of a task's <code>context.Context</code>:</p>\n\n<pre><code>func registerSigHandler() context.Context {\n        sigCh := make(chan os.Signal, 1)\n        signal.Notify(sigCh, syscall.SIGINT, syscall.SIGTERM)\n\n        rootCtx := context.Background()\n        taskCtx, cancelFn := context.WithCancel(rootCtx)\n\n        go func() {\n                sig := &lt;-sigCh\n                log.Println(\"received signal:\", sig)\n\n                // let sub-task know to wrap up: cancel taskCtx\n                cancelFn()\n        }()\n\n        return taskCtx\n}\n</code></pre>\n\n<p>and then pass the returned <code>taskCtx</code> on to your worker task for it to listen on.</p>\n\n<pre><code>select {\n    case &lt;-taskCtx.Done():\n        // context was canceled\n    default: // poll - rather than block in this example\n}\n</code></pre>\n\n<p>Playground <a href=\"https://play.golang.org/p/V81mxNDgpOD\" rel=\"nofollow noreferrer\">source-code</a>.</p>\n\n<p>Output:</p>\n\n<pre><code>2019/03/10 19:18:51 Worker PID: 33186\n2019/03/10 19:18:51 Will terminate on these signals: interrupt terminated\n2019/03/10 19:18:51 2019-03-10 19:18:51.018962 -0400 EDT m=+0.001727305\n2019/03/10 19:18:52 2019-03-10 19:18:52.022782 -0400 EDT m=+1.005517010\n2019/03/10 19:18:53 2019-03-10 19:18:53.019925 -0400 EDT m=+2.002630457\n\n$ kill -INT 33186\n\n2019/03/10 19:18:53 received signal: interrupt\n2019/03/10 19:18:53 task context terminated reason: context canceled\n2019/03/10 19:18:53 wrapping up task...\n2019/03/10 19:18:53 workerTask() exited cleanly\n2019/03/10 19:18:53 main exited cleanly\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I tested this on <code>Windows 10</code> and the clean-up is triggered when a Ctrl-C is issued from the same console.\nNot sure how to send signals externally on Windows - which may be the OP's original issue. Using say <code>killtask /F /PID 33186</code> would indeed kill the process without any signal handler being triggered.</p>\n"}, {"tags": [], "owner": {"reputation": 730, "user_id": 6161244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/990831a04db3b7c4a8ac83e67e00817d?s=128&d=identicon&r=PG", "display_name": "Constantin Konstantinidis", "link": "https://stackoverflow.com/users/6161244/constantin-konstantinidis"}, "is_accepted": false, "score": 2, "last_activity_date": 1593877568, "creation_date": 1593877568, "answer_id": 62731152, "question_id": 55092139, "link": "https://stackoverflow.com/questions/55092139/gracefully-terminate-a-process-on-windows/62731152#62731152", "title": "Gracefully terminate a process on Windows", "body": "<p>Signaling is implemented on Windows but Unix signals are unavailable.\nThere is an <a href=\"https://github.com/golang/go/blob/master/src/os/signal/signal_windows_test.go\" rel=\"nofollow noreferrer\">example</a> in the signal package of golang for Windows to send a Ctrl-Break. It is refactored for interactive use <a href=\"https://github.com/iWdGo/sigint-windows\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1593943666, "post_id": 62733194, "comment_id": 110947936, "body": "CTRL+C is only valid for console process and is not particularly graceful to the app if app doesn&#39;t handle it. It can also be handled so it does nothing : <a href=\"https://docs.microsoft.com/en-us/windows/console/ctrl-c-and-ctrl-break-signals\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/console/&hellip;</a>"}], "tags": [], "owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "is_accepted": false, "score": 1, "last_activity_date": 1594033400, "last_edit_date": 1594033400, "creation_date": 1593888874, "answer_id": 62733194, "question_id": 55092139, "link": "https://stackoverflow.com/questions/55092139/gracefully-terminate-a-process-on-windows/62733194#62733194", "title": "Gracefully terminate a process on Windows", "body": "<p>So, after a while, I just wanted to share how I solved it. It's ugly, but the only real way I found. Windows golang programs do listen to a CTRL+C, which is not a signal or anything like it, but it does trigger a graceful shutdown in the go program using the same signal UNIX has.</p>\n<p>Here's the relevant code:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>// Create shutdown channel\nexitChan := make(chan int)\ninterruptChan := make(chan os.Signal, 1)\nsignal.Notify(interruptChan, os.Interrupt)\nselect {\ncase exitCode := &lt;-exitChan:\n    os.Exit(exitCode)\ncase &lt;-interruptChan:\n    // This works in Windows if ctrl-c is invoked. It sucks though\n    svr.Stop()\n    os.Exit(-1)\n}\n</code></pre>\n<p>To trigger the CTRL+C given the process, I use a small program called windows-kill.exe</p>\n<pre class=\"lang-golang prettyprint-override\"><code>// Windows is &quot;special&quot; and we need to use a library for killing processes gracefully\n// Unfortunately setting up the C++ library with go is a hassle, so we resort to a CLI tool\nex, _ := os.Executable()\ncmdPath := filepath.Join(filepath.Dir(ex), &quot;windows-kill.exe&quot;)\ncmd := exec.CommandContext(context.Background(), cmdPath, &quot;-SIGINT&quot;, strconv.Itoa(l.proc.Pid))\n\nerr := cmd.Start()\nif err != nil {\n    panic(err)\n}\n</code></pre>\n<p>Here's the repo of the library and tool: <a href=\"https://github.com/alirdn/windows-kill\" rel=\"nofollow noreferrer\">https://github.com/alirdn/windows-kill</a></p>\n"}, {"tags": [], "owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "is_accepted": false, "score": 1, "last_activity_date": 1594916099, "last_edit_date": 1594916099, "creation_date": 1594033991, "answer_id": 62754842, "question_id": 55092139, "link": "https://stackoverflow.com/questions/55092139/gracefully-terminate-a-process-on-windows/62754842#62754842", "title": "Gracefully terminate a process on Windows", "body": "<p>The idea of using *nix constructs and functions to Windows is generally bad and prone to weird tricks that may or may not work.</p>\n<p>The proper way to cleanup on shutdown a GUI application is the handling of <a href=\"https://docs.microsoft.com/en-us/windows/win32/shutdown/wm-queryendsession\" rel=\"nofollow noreferrer\">WM_QUERYENDSESSION</a> and <a href=\"https://docs.microsoft.com/en-us/windows/win32/shutdown/wm-endsession\" rel=\"nofollow noreferrer\">WM_ENDSESSION</a>.\nAlso, you have flexibility on generic shut-down mechanism, check <a href=\"https://docs.microsoft.com/en-us/windows/win32/shutdown/shutting-down\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>The proper way to get notified if you are a service is the service handler of your console application (SERVICE_STOPPED). For more, see <a href=\"https://docs.microsoft.com/en-us/windows/win32/services/writing-a-servicemain-function\" rel=\"nofollow noreferrer\">Writing a ServiceMain</a>.</p>\n"}], "owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2227, "favorite_count": 1, "answer_count": 5, "score": 13, "last_activity_date": 1594916099, "creation_date": 1552250109, "last_edit_date": 1552302930, "question_id": 55092139, "link": "https://stackoverflow.com/questions/55092139/gracefully-terminate-a-process-on-windows", "title": "Gracefully terminate a process on Windows", "body": "<p>I'm writing a server application in Go, and using a wrapper to run it as a Windows service.</p>\n\n<p>There's a need to gracefully shut down the server (to close resources and connections properly), and in UNIX it would be handled through the SIGTERM signal. No big deal.</p>\n\n<p>Though on Windows things seem very different. I see on <a href=\"https://docs.microsoft.com/en-us/previous-versions/ms811896(v=msdn.10)#ucmgch09_topic3\" rel=\"noreferrer\">this guide</a> that signals actually exist on windows (?), and the SIGTERM is defined, though other pages indicate <a href=\"https://stackoverflow.com/questions/45309984/signal-other-than-sigkill-not-terminating-process-on-windows\">they don't</a>, or to use other mechanisms like WM_CLOSE.</p>\n\n<p>What is the preferable way to tell a headless process to gracefully terminate? How should it be implemented in Go?</p>\n\n<p>The server is designed to be multiplatform, so the most standard way of doing it is preferable.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1552249294, "post_id": 55091964, "comment_id": 96928660, "body": "&quot;I don&#39;t understand why I can&#39;t do it this way&quot; --- because it&#39;s incorrect syntax."}], "answers": [{"comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1552250191, "post_id": 55092085, "comment_id": 96928866, "body": "@SergioTulentsev - updated to include the more <code>go</code> way"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1552250480, "post_id": 55092085, "comment_id": 96928959, "body": "@oNion BTW anonymous struct definitions are very handy in some cases, for test-tables and also one-time <a href=\"https://talks.golang.org/2012/10things.slide#2\" rel=\"nofollow noreferrer\">template uses</a>"}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 3, "last_activity_date": 1552250131, "last_edit_date": 1552250131, "creation_date": 1552249843, "answer_id": 55092085, "question_id": 55091964, "link": "https://stackoverflow.com/questions/55091964/is-there-an-easier-way-to-append-a-slice-of-structs/55092085#55092085", "title": "Is there an easier way to append a slice of structs?", "body": "<p>You created an anonymous struct in your slice, so you need to repeat the schema when adding elements:</p>\n\n<pre><code>// works - but a bit tedious...\nsteps = append(steps,\n        struct {\n            i int\n            j int\n        }{1, 1},\n        struct {\n            i int\n            j int\n        }{1, 2},\n)\n</code></pre>\n\n<p>or define the sub-type:</p>\n\n<pre><code>type step struct {\n    i int\n    j int\n}\ntype steps []step\n\nsteps = append(steps, step{3, 4}, step{5, 6})\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Xw42P7IlONf\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 95, "user_id": 8452022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14c1b7521ea0e4b3e1ad1c6024fbd3e?s=128&d=identicon&r=PG&f=1", "display_name": "oNion", "link": "https://stackoverflow.com/users/8452022/onion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 55092085, "answer_count": 1, "score": 0, "last_activity_date": 1552252508, "creation_date": 1552248943, "last_edit_date": 1552252508, "question_id": 55091964, "link": "https://stackoverflow.com/questions/55091964/is-there-an-easier-way-to-append-a-slice-of-structs", "title": "Is there an easier way to append a slice of structs?", "body": "<p>The following code works, but I want to find a simpler way to do it\n</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype steps []struct {\n    i int\n    j int\n}\n\nfunc main() {\n    steps := steps{}\n    type step struct{ i, j int }\n    steps = append(steps, step{1, 1}, step{1, 2})\n    fmt.Println(steps)\n}\n</code></pre>\n\n<p>Specifically, I don't want to define a new type just so I can append it to a slice. For example, I want to do it like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\ntype steps []struct {\n    i int\n    j int\n}\n\nfunc main() {\n    steps := steps{}\n    steps = append(steps, {1, 1}, {1, 2}) // syntax error\n    fmt.Println(steps)\n}\n</code></pre>\n\n<p>But I'll get a \"syntax error: unexpected {, expecting expression\"</p>\n\n<p>I don't understand why I can't do it this way, the data structure is correct.</p>\n"}, {"tags": ["sql", "go"], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 3, "last_activity_date": 1552248585, "creation_date": 1552248585, "answer_id": 55091912, "question_id": 55091671, "link": "https://stackoverflow.com/questions/55091671/how-to-avoid-using-for-next-method-in-getting-a-row-count/55091912#55091912", "title": "How to avoid using for next method in getting a row count", "body": "<p>Generally, if you know you are getting one row, use <a href=\"https://golang.org/pkg/database/sql/#DB.QueryRow\" rel=\"nofollow noreferrer\">DB.QueryRow</a>\nIt allows you to chain the query and scan together, so your example would look like:</p>\n\n<pre><code>var  postCount int\nerr := db.QueryRow(\"SELECT COUNT(*) as postCount FROM postData WHERE postid=1\").Scan(&amp;postCount)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 55091912, "answer_count": 1, "score": -2, "last_activity_date": 1552248585, "creation_date": 1552247087, "last_edit_date": 1552247714, "question_id": 55091671, "link": "https://stackoverflow.com/questions/55091671/how-to-avoid-using-for-next-method-in-getting-a-row-count", "title": "How to avoid using for next method in getting a row count", "body": "<p>In php, I can print rowcount where postid matches with the code below without passing the result in a while loop.</p>\n\n<pre><code>$status_query = \"SELECT count(*) as postCount FROM postData WHERE postid=1\";\n$status_result = mysqli_query($con,$status_query);\n$status_row = mysqli_fetch_array($status_result);\n$postCount = $status_row['postCount'];\necho $postCount;\n</code></pre>\n\n<p>Now am re-writing the code to <strong>golang</strong> for the same row count. I leverage Stackoverflow solution found here.\n<a href=\"http://%20https://stackoverflow.com/questions/49400284/count-number-of-rows-in-golang\" rel=\"nofollow noreferrer\">source link</a></p>\n\n<p>With that Stackoverflow solution link above, the golang code below is working great as I can get the row count.</p>\n\n<pre><code>rows1, err := db.Query(\"SELECT COUNT(*) as postCount FROM postData WHERE postid=1\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer rows1.Close()\nvar  postCount int\n\nfor rows1.Next() {   \n    if err := rows1.Scan(&amp; postCount); err != nil {\n        log.Fatal(err)\n    }\n}\n\nfmt.Printf(\"Number of rows are %s\\n\",  postCount)\n</code></pre>\n\n<p><strong>Here is what I want modify:</strong></p>\n\n<p>The above code passed the row count result within</p>\n\n<pre><code>for rows1. Next(){\n// result here.\n}\n</code></pre>\n\n<p>M<strong>y question is:</strong></p>\n\n<p>Please how do I avoid this <code>for rows.next()</code> function and just get my result straight since am retrieving the row count based on postid.\nIn php code above, I can get the result straight without passing it in a while loop.</p>\n\n<p>In <strong>golang</strong> am thinking of something like the code below</p>\n\n<pre><code>rows1, err := db.Query(\"SELECT COUNT(*) as postCount FROM postData WHERE postid=1\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer rows1.Close()\nvar status_row = rows1.Next() \n\nvar postCount =rows1.Scan(&amp; postCount)\nfmt.Printf(\"Number of rows are %s\\n\",  postCount)\n</code></pre>\n\n<p>Does anyone has a better way of getting this rowcount to display straight without passing the result within for <code>rows1.Next()</code> method</p>\n\n<p><strong>Here is the overall working code before I seek modification in the coding illustrations above.</strong></p>\n\n<pre><code>package main\n\nimport \"database/sql\"\nimport _ \"github.com/go-sql-driver/mysql\"\n\nimport \"net/http\"\nimport \"fmt\"\nimport \"log\"\n\nvar db *sql.DB\nvar err error\n\n\nfunc getRecordPage1(res http.ResponseWriter, req *http.Request) {\n\n    if req.Method != \"POST\" {\n        http.ServeFile(res, req, \"getjsonRecord.html\")\n        return\n    }\n\n//The commented section below is the code I want to modify to avoid use of for rows.next function....\n/*\nrows1, err := db.Query(\"SELECT COUNT(*) as postCount FROM like_unlike WHERE postid=1\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer rows1.Close()\nvar  postCount int\n\nfor rows1.Next() {   \n    if err := rows1.Scan(&amp; postCount); err != nil {\n        log.Fatal(err)\n    }\n}\n\nfmt.Printf(\"Number of rows are %s\\n\",  postCount)\n\n}\n*/\n\n\nfunc homePage(res http.ResponseWriter, req *http.Request) {\n    http.ServeFile(res, req, \"index.html\")\n}\n\nfunc main() {\n    db, err = sql.Open(\"mysql\", \"root:@/golang44\")\n    if err != nil {\n        panic(err.Error())\n    }\n    defer db.Close()\n\n    err = db.Ping()\n    if err != nil {\n        panic(err.Error())\n    }\n\n    http.HandleFunc(\"/getjsonRecord\", getRecordPage1)\n    http.HandleFunc(\"/\", homePage)\n        fmt.Println(\"Listening on 127.0.0.1:8088\")\n    http.ListenAndServe(\":8088\", nil)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552244471, "post_id": 55091185, "comment_id": 96927125, "body": "I don&#39;t understand. The minimum of what?"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 1, "creation_date": 1552245072, "post_id": 55091185, "comment_id": 96927315, "body": "There is something important missing here.Your struct has ONE bodyTemp. So you want to get the mimimum of ONE value? That is your question like you described it here."}, {"owner": {"reputation": 4322, "user_id": 162414, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7fd5d3b2926236f63384ba2ca7f1eb0?s=128&d=identicon&r=PG", "display_name": "Gabriel A. Zorrilla", "link": "https://stackoverflow.com/users/162414/gabriel-a-zorrilla"}, "edited": false, "score": 0, "creation_date": 1552245420, "post_id": 55091185, "comment_id": 96927426, "body": "Sorry guys, my bad. Corrected the question."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1552245641, "post_id": 55091185, "comment_id": 96927507, "body": "You have to do some minimal amount of programming here."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552245670, "post_id": 55091185, "comment_id": 96927519, "body": "What you&#39;re trying could be accomplished with reflection, but please don&#39;t do that. It&#39;s slow, and incredibly difficult to read. The right approach is one method per field."}, {"owner": {"reputation": 4322, "user_id": 162414, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7fd5d3b2926236f63384ba2ca7f1eb0?s=128&d=identicon&r=PG", "display_name": "Gabriel A. Zorrilla", "link": "https://stackoverflow.com/users/162414/gabriel-a-zorrilla"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552246957, "post_id": 55091185, "comment_id": 96927942, "body": "@Flimzy got it, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 8398189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d37abcdaec57a9964ad1ad12fe9999a?s=128&d=identicon&r=PG", "display_name": "Igor Tulmentyev", "link": "https://stackoverflow.com/users/8398189/igor-tulmentyev"}, "is_accepted": false, "score": 0, "last_activity_date": 1552258032, "last_edit_date": 1552258032, "creation_date": 1552257703, "answer_id": 55093131, "question_id": 55091185, "link": "https://stackoverflow.com/questions/55091185/function-that-returns-the-min-value-of-a-slice-based-on-structs-field/55093131#55093131", "title": "Function that returns the min value of a slice based on struct&#39;s field?", "body": "<p>As it has been already written in the comments, you can do it using reflection, but there is no need to do that due to performance decrease. </p>\n\n<p><strong>Option 1</strong></p>\n\n<p>As for a quick solution, I suggest you to implement a patients slice wrapper that is responsible to keep and find the data you need by criteria specified (for each field its own method). This is also not about a performance, because in your case you need to search a minimum value that has O(N) complexity (you need to iterate all the items in the slice).</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n)\n\nvar (\n    ErrPatientsContainerIsEmpty = errors.New(\"patients container is empty\")\n)\n\ntype Patient struct{\n    patientID int\n    age int\n    bodyTemp int\n    numberVaccines int\n    recordID int\n}\n\ntype PatientsContainer struct {\n    patients []Patient\n}\n\nfunc NewPatientsContainer() *PatientsContainer {\n    patients := make([]Patient, 0)\n    return &amp; PatientsContainer{\n        patients: patients,\n    }\n}\n\nfunc (pc *PatientsContainer) Add(p Patient) {\n    pc.patients = append(pc.patients, p)\n}\n\nfunc (pc *PatientsContainer) WithMinTemp() (*Patient, error) {\n    if len(pc.patients) == 0 {\n        return nil, ErrPatientsContainerIsEmpty\n    }\n\n    patientWithMinTemp := &amp;pc.patients[0]\n\n    // O(N) complexity!\n    for i, p := range pc.patients {\n        if p.bodyTemp &lt; patientWithMinTemp.bodyTemp {\n            patientWithMinTemp = &amp;pc.patients[i]\n        }\n    }\n\n    return patientWithMinTemp, nil\n}\n\nfunc main() {\n    // some patients data for testing\n    patients := []Patient{\n        {\n            recordID: 1,\n            bodyTemp: 37,\n        },\n        {\n            recordID: 2,\n            bodyTemp: 36,\n        },\n            {\n            recordID: 3,\n            bodyTemp: 38,\n        },  \n    }\n\n    pc := NewPatientsContainer()\n\n    // Add to container\n    for _, p := range patients {\n        pc.Add(p)\n    }\n\n    patientWithMinTemp, err := pc.WithMinTemp()\n    if err != nil {\n        // handle an error\n        panic(err)\n    }\n\n    fmt.Println(patientWithMinTemp.recordID)\n}\n</code></pre>\n\n<p><strong>Option 2</strong></p>\n\n<p>If we are talking about an application with a big dataset (not 50 patients), the correct way is to introduce to the application a storage that supports indexes.</p>\n"}], "owner": {"reputation": 4322, "user_id": 162414, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7fd5d3b2926236f63384ba2ca7f1eb0?s=128&d=identicon&r=PG", "display_name": "Gabriel A. Zorrilla", "link": "https://stackoverflow.com/users/162414/gabriel-a-zorrilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1552258032, "creation_date": 1552244041, "last_edit_date": 1552245358, "question_id": 55091185, "link": "https://stackoverflow.com/questions/55091185/function-that-returns-the-min-value-of-a-slice-based-on-structs-field", "title": "Function that returns the min value of a slice based on struct&#39;s field?", "body": "<p>I've got a Go struct such as:</p>\n\n<pre><code>type patient struct{\n    patientID int\n    age int\n    bodyTemp int\n    numberVaccines int\n    recordID int\n}\n</code></pre>\n\n<p>How can I write a function that returns the min value in a slice of <code>patient</code> by selecting the field I'm interested in? </p>\n\n<p>I'd call it like:</p>\n\n<pre><code>someSlice := []patient{patient{...},...,...}\nfmt.Printf(\"Patient lowest temp: %v\", someSlice.GetMin(bodyTemp)\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552243353, "post_id": 55091006, "comment_id": 96926780, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39415827/golang-http-check-if-responsewriter-has-been-written\">Golang HTTP Check If ResponseWriter Has Been Written</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1552243697, "post_id": 55091006, "comment_id": 96926868, "body": "No, there is no way to remove data from a responsewriter. But that doesn&#39;t seem to be what you&#39;re asking for anyway."}, {"owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "edited": false, "score": 0, "creation_date": 1552244443, "post_id": 55091006, "comment_id": 96927117, "body": "Where is <code>newMockClient</code> defined? Can you include the source for it?"}, {"owner": {"reputation": 659, "user_id": 6845084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253b377ee6c971f363de927136d30117?s=128&d=identicon&r=PG", "display_name": "Palash Nigam", "link": "https://stackoverflow.com/users/6845084/palash-nigam"}, "reply_to_user": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "edited": false, "score": 1, "creation_date": 1552245562, "post_id": 55091006, "comment_id": 96927474, "body": "@HenryWoody the function just takes the test server url and returns an elasticsearch client pointing to that. I have updated the code."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1552315984, "post_id": 55091006, "comment_id": 96951958, "body": "Seems like you&#39;re reusing the <code>Request</code> object for multiple test requests. They are not safe to reuse."}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 8398189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d37abcdaec57a9964ad1ad12fe9999a?s=128&d=identicon&r=PG", "display_name": "Igor Tulmentyev", "link": "https://stackoverflow.com/users/8398189/igor-tulmentyev"}, "is_accepted": false, "score": 3, "last_activity_date": 1552244490, "creation_date": 1552244490, "answer_id": 55091263, "question_id": 55091006, "link": "https://stackoverflow.com/questions/55091006/is-there-a-way-to-erase-data-in-the-response-writer/55091263#55091263", "title": "Is there a way to erase data in the response writer?", "body": "<p>I don't think what you are doing is the correct way to test your functionality. You need to separate your test to test-cases for checking different behaviours like that:</p>\n\n<pre><code>func Test_DeleteIndex(t *testing.T) {\n    t.Run(\"Should be ok with correct setup\", func(t *testing.T) {\n        setup := &amp;ServerSetup{\n            Method:   \"DELETE\",\n            Path:     \"/test\",\n            Response: `{\"acknowledged\": true}`,\n        }\n        ctx := context.Background()\n        ts := buildTestServer(t, []*ServerSetup{setup})\n        defer ts.Close()\n        es, _ := newMockClient(ts.URL)\n        err := es.deleteIndex(ctx, \"test\")\n        require.NoError(t, err)\n    })\n\n    t.Run(\"Shouldn't be ok with wrong setup\", func(t *testing.T) {\n        setup := &amp;ServerSetup{\n            Method:   \"DELETE\",\n            Path:     \"/test\",\n            Response: `{\"acknowledged\": false}`,\n        }\n        ctx := context.Background()\n        ts := buildTestServer(t, []*ServerSetup{setup})\n        defer ts.Close()\n        es, _ := newMockClient(ts.URL)\n        err := es.deleteIndex(ctx, \"test\")\n        require.Error(t, err)\n    })\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "is_accepted": false, "score": 2, "last_activity_date": 1552246329, "last_edit_date": 1552246329, "creation_date": 1552245549, "answer_id": 55091425, "question_id": 55091006, "link": "https://stackoverflow.com/questions/55091006/is-there-a-way-to-erase-data-in-the-response-writer/55091425#55091425", "title": "Is there a way to erase data in the response writer?", "body": "<p>The issue here is that for each request that the test server gets, the handler loops over all the <code>ServerSetup</code> structs checking for matches based on method and path, but does not break out of the loop upon finding a match.</p>\n\n<p>So in your second test case, since you pass two setup structs with the same <code>Method</code> and <code>Path</code>, two setup cases will match an incoming request for <code>DELETE /test</code>, and the program will try to call <code>WriteHeader</code> on the <code>ResponseWriter</code> twice.</p>\n\n<p>There are two ways I can think of to resolve this issue:</p>\n\n<p><strong>Option 1</strong></p>\n\n<p>If you want to have the server respond differently to successive calls of the same method and path combination, you can add an attribute to check if the <code>ServerSetup</code> instance has been used already, and avoid any setup structs that have already been used.</p>\n\n<p>For example:</p>\n\n<pre><code>type ServerSetup struct {\n    Method, Path, Body, Response    string\n    HTTPStatus                      int\n    HasBeenCalled                   bool\n}\n\nfunc buildTestServer(t *testing.T, setups []*ServerSetup) *httptest.Server {\n    handlerFunc := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        requestBytes, _ := ioutil.ReadAll(r.Body)\n        requestBody := string(requestBytes)\n\n        matched := false\n        for _, setup := range setups {\n            if setup.HasBeenCalled {\n                continue // skip those that have already been called\n            }\n            if r.Method == setup.Method &amp;&amp; r.URL.EscapedPath() == setup.Path {\n                setup.HasBeenCalled = true\n                matched = true\n                if setup.HTTPStatus == 0 {\n                    w.WriteHeader(http.StatusOK)\n                } else {\n                    w.WriteHeader(setup.HTTPStatus)\n                }\n                _, err := w.Write([]byte(setup.Response))\n                if err != nil {\n                    t.Fatalf(\"Unable to write test server response: %v\", err)\n                }\n            }\n            if matched {\n                break // stop checking for matches if already found match\n            }\n        }\n\n        if !matched {\n            t.Fatalf(\"No requests matched setup. Got method %s, Path %s, body %s\", r.Method, r.URL.EscapedPath(), requestBody)\n        }\n    })\n\n    return httptest.NewServer(handlerFunc)\n}\n</code></pre>\n\n<p><strong>Option 2</strong></p>\n\n<p>A slightly simpler way to resolve this issue would be to create separate test servers for each of these two cases, one for each <code>setup</code> struct, since they involve different results from the same method-path combination. More cleanly, you could separate these into two separate tests.</p>\n\n<p>So you would end up with:</p>\n\n<pre><code>func TestDeleteIndex_Success(t *testing.T) {\n    setup := &amp;ServerSetup{\n        Method:   \"DELETE\",\n        Path:     \"/test\",\n        Response: `{\"acknowledged\": true}`,\n    }\n\n    ctx := context.Background()\n\n    ts := buildTestServer(t, []*ServerSetup{setup})\n    defer ts.Close()\n\n    es, _ := newMockClient(ts.URL)\n\n    err := es.deleteIndex(ctx, \"test\")\n    if err != nil {\n        t.Fatalf(\"Index creation failed with error: %v\\n\", err)\n    }\n}\n\nfunc TestDeleteIndex_Error(t *testing.T) {\n    errSetup := &amp;ServerSetup{\n        Method:   \"DELETE\",\n        Path:     \"/test\",\n        Response: `{\"acknowledged\": false}`,\n    }\n\n    ctx := context.Background()\n\n    ts := buildTestServer(t, []*ServerSetup{errSetup})\n    defer ts.Close()\n\n    es, _ := newMockClient(ts.URL)\n\n    err := es.deleteIndex(ctx, \"test\")\n    if err == nil {\n        t.Fatal(\"Expected error but not found\")\n    }\n}\n</code></pre>\n\n<p>You should also in the future avoid passing multiple <code>ServerSetup</code> structs with the same method-path combo in the future to avoid this error.</p>\n"}], "owner": {"reputation": 659, "user_id": 6845084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253b377ee6c971f363de927136d30117?s=128&d=identicon&r=PG", "display_name": "Palash Nigam", "link": "https://stackoverflow.com/users/6845084/palash-nigam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552246329, "creation_date": 1552242840, "last_edit_date": 1552245520, "question_id": 55091006, "link": "https://stackoverflow.com/questions/55091006/is-there-a-way-to-erase-data-in-the-response-writer", "title": "Is there a way to erase data in the response writer?", "body": "<p>I am writing test for an elasticsearch middleware, where I am using a function to build test servers in which I pass a slice of configuration structs for each tests and in a handler function they are iterated upon and the expected response is written to the response writer. This is my function.</p>\n\n<pre><code>func newMockClient(url string) (*elasticsearch, error) {\n    client, err := elastic.NewSimpleClient(elastic.SetURL(url))\n    if err != nil {\n        return nil, fmt.Errorf(\"error while initializing elastic client: %v\", err)\n    }\n    es := &amp;elasticsearch{\n        url:    url,\n        client: client,\n    }\n    return es, nil\n}\n\ntype ServerSetup struct {\n    Method, Path, Body, Response string\n    HTTPStatus                   int\n}\n\nfunc buildTestServer(t *testing.T, setups []*ServerSetup) *httptest.Server {\n    handlerFunc := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        requestBytes, _ := ioutil.ReadAll(r.Body)\n        requestBody := string(requestBytes)\n\n        matched := false\n        for _, setup := range setups {\n            if r.Method == setup.Method &amp;&amp; r.URL.EscapedPath() == setup.Path {\n                matched = true\n                if setup.HTTPStatus == 0 {\n                    w.WriteHeader(http.StatusOK)\n                } else {\n                    w.WriteHeader(setup.HTTPStatus)\n                }\n                _, err := w.Write([]byte(setup.Response))\n                if err != nil {\n                    t.Fatalf(\"Unable to write test server response: %v\", err)\n                }\n            }\n        }\n\n        if !matched {\n            t.Fatalf(\"No requests matched setup. Got method %s, Path %s, body %s\", r.Method, r.URL.EscapedPath(), requestBody)\n        }\n    })\n\n    return httptest.NewServer(handlerFunc)\n}\n\n</code></pre>\n\n<p>It is copied from <code>github.com/github/vulcanizer</code>. When I run a single test using this, it works fine. For e.g. this test</p>\n\n<pre><code>func TestCreateIndex(t *testing.T) {\n    setup := &amp;ServerSetup{\n        Method:   \"PUT\",\n        Path:     \"/test\",\n        Response: `{\"acknowledged\": true, \"shards_acknowledged\": true, \"index\": \"test\"}`,\n    }\n\n    ts := buildTestServer(t, []*ServerSetup{setup})\n\n    es, _ := newMockClient(ts.URL)\n\n    err := es.createIndex(context.Background(), \"test\", nil)\n    if err != nil {\n        t.Fatalf(\"Index creation failed with error: %v\\n\", err)\n    }\n\n}\n</code></pre>\n\n<p>But when I try to check different behaviours in a single test like this one I get an error <code>http: multiple response.WriteHeader calls</code></p>\n\n<pre><code>func TestDeleteIndex(t *testing.T) {\n    setup := &amp;ServerSetup{\n        Method:   \"DELETE\",\n        Path:     \"/test\",\n        Response: `{\"acknowledged\": true}`,\n    }\n\n    errSetup := &amp;ServerSetup{\n        Method:   \"DELETE\",\n        Path:     \"/test\",\n        Response: `{\"acknowledged\": false}`,\n    }\n\n    ctx := context.Background()\n\n    ts := buildTestServer(t, []*ServerSetup{setup, errSetup})\n    defer ts.Close()\n\n    es, _ := newMockClient(ts.URL)\n\n    err := es.deleteIndex(ctx, \"test\")\n    if err != nil {\n        t.Fatalf(\"Index creation failed with error: %v\\n\", err)\n    }\n\n    err = es.deleteIndex(ctx, \"test\")\n    if err == nil {\n        t.Fatal(\"Expected error but not found\")\n    }\n}\n\n</code></pre>\n\n<p>I am guessing that it is because of the fact that when I run deleteIndex for the second time it pings the server again but the response writer has already been written to so it can't write anything else to it.</p>\n\n<p>Is there anyway I can have a check at the beginning of my handler func like </p>\n\n<pre><code>handlerFunc := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    if w != nil{\n        // clear data in response writer\n    }\n\n// .........\n\n\n\n}\n</code></pre>\n"}, {"tags": ["go", "webserver"], "answers": [{"comments": [{"owner": {"reputation": 1787, "user_id": 2802042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135c4e4a042800383e9ea34de27171aa?s=128&d=identicon&r=PG", "display_name": "DrMorteza", "link": "https://stackoverflow.com/users/2802042/drmorteza"}, "edited": false, "score": 0, "creation_date": 1552238858, "post_id": 55090291, "comment_id": 96925439, "body": "Thanks a lot. Can I use shared hosting&#39;s <code>IP address or DNS</code> instead of <code>Url</code>?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1787, "user_id": 2802042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135c4e4a042800383e9ea34de27171aa?s=128&d=identicon&r=PG", "display_name": "DrMorteza", "link": "https://stackoverflow.com/users/2802042/drmorteza"}, "edited": false, "score": 0, "creation_date": 1552239806, "post_id": 55090291, "comment_id": 96925713, "body": "I don&#39;t know what you mean by &quot;or DNS&quot;. The method obviously requires a parsed URL, but you can use an IP address in a URL."}, {"owner": {"reputation": 1787, "user_id": 2802042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135c4e4a042800383e9ea34de27171aa?s=128&d=identicon&r=PG", "display_name": "DrMorteza", "link": "https://stackoverflow.com/users/2802042/drmorteza"}, "edited": false, "score": 0, "creation_date": 1552242282, "post_id": 55090291, "comment_id": 96926492, "body": "Sorry. I wrote wrong. It didn&#39;t work. Can you give a little time for chatting? PLZ"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 3, "last_activity_date": 1552238104, "creation_date": 1552238104, "answer_id": 55090291, "question_id": 55090039, "link": "https://stackoverflow.com/questions/55090039/how-to-put-sub-directory-sub-domain-in-another-server-or-shared-hosting/55090291#55090291", "title": "How to put sub-directory/sub-domain in another server (or shared hosting)", "body": "<p>You need to handle the endpoints served by another server/process as a reverse proxy. The standard library gives you <a href=\"https://golang.org/pkg/net/http/httputil/#ReverseProxy\" rel=\"nofollow noreferrer\">httputil.ReverseProxy</a>, which acts as a standard <code>http.Handler</code>, to make this very easy.</p>\n\n<p>Try something like this:</p>\n\n<pre><code>target, err := url.Parse(\"http://blog.example.com/\")\nif err != nil {\n    panic(err)\n}\nproxy := httputil.NewSingleHostReverseProxy(target)\n\nmux.Handle(\"/blog\", proxy)\n</code></pre>\n"}], "owner": {"reputation": 1787, "user_id": 2802042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135c4e4a042800383e9ea34de27171aa?s=128&d=identicon&r=PG", "display_name": "DrMorteza", "link": "https://stackoverflow.com/users/2802042/drmorteza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1552238104, "creation_date": 1552236509, "last_edit_date": 1552237873, "question_id": 55090039, "link": "https://stackoverflow.com/questions/55090039/how-to-put-sub-directory-sub-domain-in-another-server-or-shared-hosting", "title": "How to put sub-directory/sub-domain in another server (or shared hosting)", "body": "<p>I have a Go server-side program hosted on an Ubuntu 18.04 server. I want to handle <code>example.com</code> with Go, then <code>example.com/blog</code> or <code>blog.example.com</code> with PHP in shared hosting. \nI prefer to do this with Go itself, not with another web server (ex: Nginx),\nHow can I do this?</p>\n"}, {"tags": ["go", "channel", "goroutine", "httpserver", "go-gin"], "comments": [{"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1552230765, "post_id": 55088810, "comment_id": 96922890, "body": "What does <code>starts</code> mean?? :P once it is listening and accepting on a socket?  Once it is listening?"}], "answers": [{"tags": [], "owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "is_accepted": false, "score": -1, "last_activity_date": 1552233846, "creation_date": 1552233846, "answer_id": 55089600, "question_id": 55088810, "link": "https://stackoverflow.com/questions/55088810/wait-for-gin-http-server-to-start/55089600#55089600", "title": "Wait for gin HTTP server to start", "body": "<p>gin.New().Run() is blocking API. gin server is not returned until exit.</p>\n\n<pre><code>func startHTTPRouter(routerChannel chan bool) {\n    router := gin.New()\n    router.Run(\"&lt;port&gt;\")\n    routerChannel &lt;- true  // Is this gonna work ? Because Run() again launches a go routine for Serve()\n}\n</code></pre>\n\n<p>Below is gin'Run() API. <a href=\"https://github.com/gin-gonic/gin/blob/master/gin.go\" rel=\"nofollow noreferrer\">https://github.com/gin-gonic/gin/blob/master/gin.go</a></p>\n\n<pre><code>// Run attaches the router to a http.Server and starts listening and serving HTTP requests.\n// It is a shortcut for http.ListenAndServe(addr, router)\n// Note: this method will block the calling goroutine indefinitely unless an error happens.\nfunc (engine *Engine) Run(addr ...string) (err error) {\n    defer func() { debugPrintError(err) }()\n\n    address := resolveAddress(addr)\n    debugPrint(\"Listening and serving HTTP on %s\\n\", address)\n    err = http.ListenAndServe(address, engine)\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 5178, "user_id": 632074, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Y7z2q.jpg?s=128&g=1", "display_name": "Reuben", "link": "https://stackoverflow.com/users/632074/reuben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 842, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1597431381, "creation_date": 1552228901, "last_edit_date": 1597431381, "question_id": 55088810, "link": "https://stackoverflow.com/questions/55088810/wait-for-gin-http-server-to-start", "title": "Wait for gin HTTP server to start", "body": "<p>We are using gin to expose some REST APIs in production. Now I have to do some stuff once the HTTP server starts.</p>\n\n<p>I am not very familiar with channels, but given below code is what I'm trying to do. Once the <code>startHTPPRouter()</code> starts the HTTP service, I want to send a signal to <code>main()</code>. Based on that signal I want to do some other stuffs.</p>\n\n<p>Please let me know what wrong I'm doing in the given below code.</p>\n\n<pre><code>func startHTTPRouter(routerChannel chan bool){\n    router := gin.New()\n    // Many REST API routes definitions\n    router.Run(\"&lt;port&gt;\")\n    routerChannel &lt;- true  // Is this gonna work ? Because Run() again launches a go routine for Serve()\n}\n\nfunc main() {\n    routerChannel := make(chan bool)\n    defer close(routerChannel)\n    go startHTTPRouter(routerChannel )\n    for {\n        select {\n        case &lt;-routerChannel:\n            doStuff()  // Only when the REST APIs are available.\n            time.Sleep(time.Second * 5)\n        default:\n            log.Info(\"Waiting for router channel...\")\n            time.Sleep(time.Second * 5)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["http", "go", "channel"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1552226935, "post_id": 55088325, "comment_id": 96921825, "body": "Of course. You can write to a channel from any function. Why would you think this is different?"}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1552227012, "post_id": 55088349, "comment_id": 96921843, "body": "Shadow variables.  &#39;go vet&#39; can help you catch these. See <a href=\"https://golang.org/cmd/vet/#hdr-Shadowed_variables\" rel=\"nofollow noreferrer\">here</a>."}], "tags": [], "owner": {"reputation": 421, "user_id": 5279759, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/de3fd7e849f1161ad666e44f6a001c84?s=128&d=identicon&r=PG&f=1", "display_name": "Fominykh Maxim", "link": "https://stackoverflow.com/users/5279759/fominykh-maxim"}, "is_accepted": false, "score": 0, "last_activity_date": 1552225772, "creation_date": 1552225772, "answer_id": 55088349, "question_id": 55088325, "link": "https://stackoverflow.com/questions/55088325/is-it-possible-to-write-to-a-channel-from-http-handle-function/55088349#55088349", "title": "Is it possible to write to a channel from http Handle function?", "body": "<p>Got it, the error was in channel initialization, I should not write <code>channel1:=make(chan int)</code>, instead used <code>channel1=make(chan int)</code>, everything worked!</p>\n"}, {"tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": false, "score": 1, "last_activity_date": 1552231186, "last_edit_date": 1552231186, "creation_date": 1552227113, "answer_id": 55088531, "question_id": 55088325, "link": "https://stackoverflow.com/questions/55088325/is-it-possible-to-write-to-a-channel-from-http-handle-function/55088531#55088531", "title": "Is it possible to write to a channel from http Handle function?", "body": "<p>Yes it is possible.  One thing to consider is the lifecycle of the data that your sending on the channel.  Currently the channel is unbuffered so that a send:</p>\n\n<p><code>channel1 &lt;- 1</code></p>\n\n<p>Requires a receive:</p>\n\n<p><code>case &lt;-channel1:</code></p>\n\n<p>Which means that the writes will queue up and block until they are ready to be handled.  The problem with this is that as soon as the receive occurs the HTTP handler will complete, with a 200 suggesting to the client that the operation was <code>OK</code> and successful.  The issue is that the other go routine with the receive may not be complete since it executes concurrently to the handler goroutine.  The ownership of the data has been transferred to another goroutine.  So what happens if the other goroutine errors but the client thinks that the operation has completed successfully?</p>\n\n<p>This becomes more apparent if the channel is buffered, where the http handler goroutine sends immediately and then returns.  There's a wide range of solutions to this problem but if not addressed it could lead to subtle data loss and logical errors.</p>\n"}], "owner": {"reputation": 421, "user_id": 5279759, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/de3fd7e849f1161ad666e44f6a001c84?s=128&d=identicon&r=PG&f=1", "display_name": "Fominykh Maxim", "link": "https://stackoverflow.com/users/5279759/fominykh-maxim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1552231186, "creation_date": 1552225645, "last_edit_date": 1552226919, "question_id": 55088325, "link": "https://stackoverflow.com/questions/55088325/is-it-possible-to-write-to-a-channel-from-http-handle-function", "title": "Is it possible to write to a channel from http Handle function?", "body": "<p>I want to pass the value to the channel when there is a http request occurred, I got this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"net/http\"\n    \"time\"\n)\n\nvar channel1 chan int\n\nfunc main() {\n    channel1 := make(chan int)\n    go func() {\n        select {\n        case &lt;-channel1:\n            fmt.Println(\"Channel1\")\n        case &lt;-time.After(time.Second * 100):\n            fmt.Println(\"Timeout\")\n        }\n    }()\n\n    http.HandleFunc(\"/\", handleMain)\n    http.ListenAndServe(\"localhost:8080\", nil)\n}\n\nfunc handleMain(w http.ResponseWriter, r *http.Request) {\n    channel1 &lt;- 1\n    io.WriteString(w, \"Hello from a HandleFunc!\")\n}\n</code></pre>\n\n<p>This freezes on channel1 &lt;-1 when I do my request to \"/\", why is so, and how can I achieve what I want?</p>\n"}, {"tags": ["go", "runtime", "execution", "goroutine"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1552217565, "post_id": 55087111, "comment_id": 96919349, "body": "4 is not a meaningful sample size. You should run such a test thousands of times to get a meaningful result."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552217591, "post_id": 55087111, "comment_id": 96919356, "body": "As for why the difference: Any number of reasons. Something could be running in the background, that just happened to require the CPU, or disk, or other shared resource, at the time of the slow run."}], "answers": [{"tags": [], "owner": {"reputation": 12147, "user_id": 4378400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wsSe.jpg?s=128&g=1", "display_name": "Yury Fedorov", "link": "https://stackoverflow.com/users/4378400/yury-fedorov"}, "is_accepted": true, "score": 0, "last_activity_date": 1552218114, "creation_date": 1552218114, "answer_id": 55087289, "question_id": 55087111, "link": "https://stackoverflow.com/questions/55087111/why-does-the-execution-time-of-goroutines-differ-significantly/55087289#55087289", "title": "Why does the execution time of Goroutines differ significantly?", "body": "<blockquote>\n  <p>Why does it sometimes differ so significantly?</p>\n</blockquote>\n\n<p>Execution time will always be unpredictable to some point, as mentioned in comments to your questions (CPU, disk load, memory, etc.)</p>\n\n<blockquote>\n  <p>Is there any way to avoid it?</p>\n</blockquote>\n\n<p>There is a way to make your measurements more useful. Go has a built-in benchmark tool (here is a <a href=\"https://dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go\" rel=\"nofollow noreferrer\">guide</a> on how to use it properly). This tool runs your code just enough times to determine a somewhat deterministic execution time.</p>\n\n<p>In addition to showing average execution time for your code, it can also show useful memory information. </p>\n"}], "owner": {"reputation": 21, "user_id": 11234510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49c4a09e8f957604a94320b411dc76a7?s=128&d=identicon&r=PG&f=1", "display_name": "Dominik", "link": "https://stackoverflow.com/users/11234510/dominik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 55087289, "answer_count": 1, "score": -3, "last_activity_date": 1552218114, "creation_date": 1552216623, "question_id": 55087111, "link": "https://stackoverflow.com/questions/55087111/why-does-the-execution-time-of-goroutines-differ-significantly", "title": "Why does the execution time of Goroutines differ significantly?", "body": "<p>I'm just measuring the execution time of a set of goroutines. That means:</p>\n\n<p>I start measuring, then start 20 goroutines and stop measuring as soon as they finish. I repeat that process like 4 times and then compare the 4 exection times.</p>\n\n<p>Sometimes, these execution times differ significantly:</p>\n\n<p>1st run of the 20 goroutines: 1.2 ms<br />\n2nd run of the 20 goroutines: 1.9 ms<br />\n3rd run of the 20 goroutines: 1.4 ms<br />\n4th run of the 20 goroutines: 17.0 ms!</p>\n\n<p>Why does it sometimes differ so significantly? Is there any way to avoid it?</p>\n"}, {"tags": ["go", "visual-studio-code"], "answers": [{"tags": [], "owner": {"reputation": 1215, "user_id": 5872672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DdyYO.png?s=128&g=1", "display_name": "Dan_", "link": "https://stackoverflow.com/users/5872672/dan"}, "is_accepted": true, "score": 2, "last_activity_date": 1552217701, "creation_date": 1552217701, "answer_id": 55087236, "question_id": 55087036, "link": "https://stackoverflow.com/questions/55087036/autocompleting-parentheses-in-visual-studio-code-for-go/55087236#55087236", "title": "Autocompleting parentheses in Visual Studio Code for Go", "body": "<p>In your VSCode settings (JSON) add the following line;</p>\n\n<p><code>\"go.useCodeSnippetsOnFunctionSuggest\": true</code></p>\n\n<p>Or if you are viewing your preferences/settings as the UI version, search for <code>useCodeSnippetsOnFunctionSuggest</code> and set it to true. This will</p>\n\n<ul>\n<li>Add parentheses to the tailing end of function names.</li>\n<li>Complete function suggestions with parameter signatures, including the variable types.</li>\n</ul>\n\n<hr>\n\n<p>There is also the setting of <code>go.useCodeSnippetsOnFunctionSuggestWithoutType</code> which does the same, but omits the variable types.</p>\n\n<hr>\n\n<p>You need the Visual Studio Code (Microsoft maintained) Go extension installed <a href=\"https://marketplace.visualstudio.com/items?itemName=ms-vscode.Go\" rel=\"nofollow noreferrer\">which can be found here.</a></p>\n"}], "owner": {"reputation": 2016, "user_id": 5829191, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/rwxZQ.jpg?s=128&g=1", "display_name": "rozerro", "link": "https://stackoverflow.com/users/5829191/rozerro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 761, "favorite_count": 0, "accepted_answer_id": 55087236, "answer_count": 1, "score": 3, "last_activity_date": 1552217701, "creation_date": 1552216026, "last_edit_date": 1552217054, "question_id": 55087036, "link": "https://stackoverflow.com/questions/55087036/autocompleting-parentheses-in-visual-studio-code-for-go", "title": "Autocompleting parentheses in Visual Studio Code for Go", "body": "<p>While using of Visual Studio Code I've noticed that when I write function from autocomlete it never autocomlete with parentheses. For example: </p>\n\n<pre><code>fmt. //now select a function Print(a ...interface{}) from autocomplete\n\nfmt.Print //why the  parenthesehas have not been inserted automaticaly?\n</code></pre>\n\n<p>Is it always so in VS code or it is somehow related to the golang setting for VS code? Is there a way how to fix that?</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda", "domain-driven-design", "microservices"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11179064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3a41796d7ce747bd10cd90a0cc6fb4?s=128&d=identicon&r=PG&f=1", "display_name": "John Markwell", "link": "https://stackoverflow.com/users/11179064/john-markwell"}, "edited": false, "score": 0, "creation_date": 1552247191, "post_id": 55088051, "comment_id": 96928003, "body": "Thanks for answering. But in this case the execution ARN would be returned as it triggers the StartExecution action. But as I mentioned I need to return the id of the created order and its total price. Is there any other way to do this in a single API call?"}, {"owner": {"reputation": 2714, "user_id": 6427978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c67eae46ed2e82dc1dd3bbe59928b4e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt D", "link": "https://stackoverflow.com/users/6427978/matt-d"}, "reply_to_user": {"reputation": 45, "user_id": 11179064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3a41796d7ce747bd10cd90a0cc6fb4?s=128&d=identicon&r=PG&f=1", "display_name": "John Markwell", "link": "https://stackoverflow.com/users/11179064/john-markwell"}, "edited": false, "score": 0, "creation_date": 1552250197, "post_id": 55088051, "comment_id": 96928870, "body": "I think you are talking about an asynchronous request. It is best practice with this kind of architecture to make the request to return a reference ID, then make subsequent requests to check status progress. Better still, build an event driven framework, and maybe a web socket connection, now also achievable with API Gateway."}], "tags": [], "owner": {"reputation": 2714, "user_id": 6427978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c67eae46ed2e82dc1dd3bbe59928b4e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt D", "link": "https://stackoverflow.com/users/6427978/matt-d"}, "is_accepted": true, "score": 1, "last_activity_date": 1552223732, "creation_date": 1552223732, "answer_id": 55088051, "question_id": 55087016, "link": "https://stackoverflow.com/questions/55087016/organize-invoking-lambda-functions/55088051#55088051", "title": "Organize invoking lambda functions", "body": "<p>This is exactly what Step Functions was created for. You can invoke a Step Functions state machine from <a href=\"https://docs.aws.amazon.com/step-functions/latest/dg/tutorial-api-gateway.html\" rel=\"nofollow noreferrer\">API Gateway</a>, as you would a Lambda.</p>\n\n<p>With Step functions you can:</p>\n\n<ul>\n<li>Invoke the state machine with parameters</li>\n<li>Orchestrate the order that Lambda functions are invoked</li>\n<li>Use the state to store inputs and outputs from each lambda</li>\n<li>Have decision points to take different paths based on the output of a previous function</li>\n</ul>\n\n<p>See the <a href=\"https://docs.aws.amazon.com/step-functions/latest/dg/getting-started.html\" rel=\"nofollow noreferrer\">AWS Step Functions Getting Started Guide</a> for a good introduction to the service.</p>\n"}], "owner": {"reputation": 45, "user_id": 11179064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3a41796d7ce747bd10cd90a0cc6fb4?s=128&d=identicon&r=PG&f=1", "display_name": "John Markwell", "link": "https://stackoverflow.com/users/11179064/john-markwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 1, "accepted_answer_id": 55088051, "answer_count": 1, "score": 3, "last_activity_date": 1552248379, "creation_date": 1552215929, "last_edit_date": 1552248379, "question_id": 55087016, "link": "https://stackoverflow.com/questions/55087016/organize-invoking-lambda-functions", "title": "Organize invoking lambda functions", "body": "<p>I've got the order microservice that's written as go AWS lambda function.</p>\n\n<p>The main function named order-service bound to API Gateway. It receives several parameters like <code>user_id:int, product_ids:array</code> of int, creates an order with artifacts and returns serialized order with order_id and total price.\nThis function invokes a function named order-item which creates an order-item and returns them in parallel(per product). These functions invoke product and user functions to retrieve information about user and products by their ids. \nThen, the order function invokes another lambda called fee-function which takes just total price and user id and gives back fee price. Of course, it calls some other function like user function and so on. Basically, this is a simple example of how the service works in general. Any function calls some others like user-discount, state taxes etc.</p>\n\n<p>The questions are:</p>\n\n<ol>\n<li>Is it good that order function invokes fee function through Amazon, but it can just import fee handler package and run it inside itself?(However, fee function may be called from outside so it must be deployed as a separate function as well)</li>\n<li>Is it good that each function receives just user id and loads the user invoking user function? Perhaps, better to preload it and pass it through everywhere? Something else?</li>\n<li>Is it good that one function calls other functions and they call some others and so on? is there any better approach in my situation? Use SNS, Step function, dependency injections/aws layers.</li>\n</ol>\n\n<p>The main reason why I asked is to withstand thousands of RPM and not pay a lot.</p>\n\n<p>Thanks for helping. I appreciate this. </p>\n"}, {"tags": ["go", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 1823, "user_id": 7644371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-K8-GVAQWClY/AAAAAAAAAAI/AAAAAAAAAKY/44LvrIzzJVw/photo.jpg?sz=128", "display_name": "Jim Morrison", "link": "https://stackoverflow.com/users/7644371/jim-morrison"}, "is_accepted": false, "score": 0, "last_activity_date": 1552355697, "creation_date": 1552355697, "answer_id": 55112961, "question_id": 55086374, "link": "https://stackoverflow.com/questions/55086374/google-could-datastore-hierarchy-tree-filtering-child-with-go/55112961#55112961", "title": "Google Could Datastore Hierarchy Tree Filtering Child with Go", "body": "<p>I'm not completely sure what you are doing.  However, it sounds like you should be encoding the name of the parent in the parent's key.  That way you can display part of the hierarchy you need without fetching the parent entities.  E.g. a full child key may look like \"(Country, USA), (Region, MidWest), (State, Michigan)\".</p>\n\n<p>If that doesn't work, I think you should follow your initial idea of putting the parent keys to fetch in a set, then fetching all the parents at once.</p>\n"}], "owner": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552355697, "creation_date": 1552210948, "question_id": 55086374, "link": "https://stackoverflow.com/questions/55086374/google-could-datastore-hierarchy-tree-filtering-child-with-go", "title": "Google Could Datastore Hierarchy Tree Filtering Child with Go", "body": "<p>I have a slight feeling I'm missing the obvious but can't seem to figure this one out.\nI'm migrating an API from a traditional MySQL data model to Cloud Datastore and having trouble recursively building the hierarchy tree when filtering a child entity using the <a href=\"https://godoc.org/cloud.google.com/go/datastore\" rel=\"nofollow noreferrer\">Go Library</a>.<br/><br/>\nMy model looks like this:\n<br/><br/></p>\n\n<pre><code>    type Country struct {\n        Key *datastore.Key `datastore:\"__key__\"`\n        Id int\n        Name string\n        Region []Region\n    }\n\n    type Region struct {\n        Key *datastore.Key `datastore:\"__key__\"`\n        Id int\n        Name string\n        State []State\n    }\n\n    type State struct {\n        Key *datastore.Key `datastore:\"__key__\"`\n        Id int\n        Name string\n    }\n</code></pre>\n\n<p>I'm <strong>NOT</strong> using nested entities in datastore like the representation above. In datastore I have 3 different entities storing each with its respective Ancestor key as such:</p>\n\n<blockquote>\n  <p>Entity Country: Parent = nil <br/> Entity Region: Parent =\n  Country<br/> Entity State: Parent = Region<br/></p>\n</blockquote>\n\n<p>I'd like to query for a given list of states and build the correct representation of the entire hierarchy within the structs. I could possible achieve this retrieving all the States entities that satisfy my criteria first: \n\n<pre><code>    var state []*State\n\n    query := datastore.NewQuery(\"State\").Filter(\"Name=\", params[i])\n\n    if _, err = client.GetAll(ctx, query, &amp;state); err != nil {\n        return nil, err\n    }\n</code></pre>\n\n<p>and then iterate over state to look for the region each state belongs to:</p>\n\n<pre><code>    var region Region\n\n    if err := client.Get(ctx, state[i].Key.Parent, &amp;region); err != nil {\n        return nil, err\n    }\n</code></pre>\n\n<p>The problem with this solution is that more than one state returned can belong to the same region and if I get the parent region for each state, I'll ultimately end up with a slice of regions that will likely have repeated regions in it with a single state each.<br/></p>\n\n<p>I know I could solve this through my code sorting and checking if a region has already been added and then just append the state onto it. However, this solution seem to be a very cumbersome way to solve this problem and I'm wondering if I have another alternatives.<br/></p>\n\n<p>Just as a side note, this model is just a simplified representation of the real one. The real model has 9 levels in the hierarchy and users can search as far as the lowest level and the respective tree needs to be represented in the final JSON.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "is_accepted": true, "score": 3, "last_activity_date": 1552206832, "creation_date": 1552206832, "answer_id": 55085874, "question_id": 55085769, "link": "https://stackoverflow.com/questions/55085769/unmarshal-promoted-fields-into-struct/55085874#55085874", "title": "Unmarshal promoted fields into struct", "body": "<p>That's because the variable <code>dog</code> is nil. Try to initialize it to point to an empty <code>Dog</code>. Or make it a <code>Dog</code> instead of a pointer to <code>Dog</code> and pass in the address to <code>Unmarshal</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 404, "user_id": 4527807, "user_type": "registered", "profile_image": "https://graph.facebook.com/1566276889/picture?type=large", "display_name": "Teddy Hartanto", "link": "https://stackoverflow.com/users/4527807/teddy-hartanto"}, "is_accepted": false, "score": 3, "last_activity_date": 1552214835, "creation_date": 1552214835, "answer_id": 55086887, "question_id": 55085769, "link": "https://stackoverflow.com/questions/55085769/unmarshal-promoted-fields-into-struct/55086887#55086887", "title": "Unmarshal promoted fields into struct", "body": "<p>First of all, to get the concepts straight -- there's no inheritance in Golang. Golang prefers composition over inheritance. What you're doing with <code>Animal</code> and <code>Dog</code> there is called <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">embedding</a> in Go.</p>\n\n<p>Secondly, the correct way to use <code>json.Unmarshal</code> is to pass a pointer as the second argument. So, to fix your code:</p>\n\n<pre><code>func main() {\n    var dog Dog\n\n    err := json.Unmarshal([]byte(`{\n        \"name\": \"Loki\",\n        \"color\": \"Brown\"\n    }`), &amp;dog)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>If you're familiar with C, think of <code>json.Unmarshal</code> as something similar to <code>scanf</code>. The caller pass an address to <code>scanf</code> so that <code>scanf</code> can \"fill in the value\" to the memory location represented by the pointer.</p>\n"}], "owner": {"reputation": 1152, "user_id": 1603399, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/95QCa.jpg?s=128&g=1", "display_name": "dimiguel", "link": "https://stackoverflow.com/users/1603399/dimiguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 55085874, "answer_count": 2, "score": 1, "last_activity_date": 1552214835, "creation_date": 1552205916, "last_edit_date": 1552206440, "question_id": 55085769, "link": "https://stackoverflow.com/questions/55085769/unmarshal-promoted-fields-into-struct", "title": "Unmarshal promoted fields into struct", "body": "<p>I have two structs. One inherits from the other.</p>\n\n<pre><code>type Animal struct {\n    Name string `json:\"name\"`\n}\n\ntype Dog struct {\n    Animal\n    Color string `json:\"color\"`\n}\n</code></pre>\n\n<p>When I go to <code>Unmarshal</code> to <code>Dog</code> by passing in:</p>\n\n<pre><code>{\n  \"name\": \"Loki\",\n  \"color\": \"Brown\"\n}\n</code></pre>\n\n<p>I'm getting an <code>*encoding/json.InvalidUnmarshalError</code>. <code>2019/03/10 00:22:35 json: Unmarshal(nil *main.Dog)</code> </p>\n\n<p>Why is that?</p>\n\n<p>Here's the unmarshal code:</p>\n\n<pre><code>func main() {\n    var dog *Dog\n\n    err := json.Unmarshal([]byte(`{\n        \"name\": \"Loki\",\n        \"color\": \"Brown\"\n    }`), dog)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "edited": false, "score": 2, "creation_date": 1552200989, "post_id": 55085230, "comment_id": 96915706, "body": "Yes, the empty temp.go file is indeed the problem. Put at least the package line into it."}, {"owner": {"reputation": 95, "user_id": 8452022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14c1b7521ea0e4b3e1ad1c6024fbd3e?s=128&d=identicon&r=PG&f=1", "display_name": "oNion", "link": "https://stackoverflow.com/users/8452022/onion"}, "reply_to_user": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "edited": false, "score": 0, "creation_date": 1552201506, "post_id": 55085230, "comment_id": 96915796, "body": "@Henry Thank you, I put package main into the empty temp.go file, and it worked. Is there a way to let godoc ignore GOPATH? I just want go builtin packages doc"}, {"owner": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "edited": false, "score": 0, "creation_date": 1552201705, "post_id": 55085230, "comment_id": 96915834, "body": "You could set GOPATH to some empty directory for the godoc invocation."}, {"owner": {"reputation": 95, "user_id": 8452022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14c1b7521ea0e4b3e1ad1c6024fbd3e?s=128&d=identicon&r=PG&f=1", "display_name": "oNion", "link": "https://stackoverflow.com/users/8452022/onion"}, "reply_to_user": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "edited": false, "score": 0, "creation_date": 1552202880, "post_id": 55085230, "comment_id": 96916076, "body": "@Henry How to do that? godoc only have -goroot argument, no -gopath"}, {"owner": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "edited": false, "score": 1, "creation_date": 1552203720, "post_id": 55085230, "comment_id": 96916266, "body": "if you are on linux you could do <code>GOPATH=something godoc</code>."}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 8452022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14c1b7521ea0e4b3e1ad1c6024fbd3e?s=128&d=identicon&r=PG&f=1", "display_name": "oNion", "link": "https://stackoverflow.com/users/8452022/onion"}, "is_accepted": false, "score": 0, "last_activity_date": 1552203006, "last_edit_date": 1552203006, "creation_date": 1552202478, "answer_id": 55085403, "question_id": 55085230, "link": "https://stackoverflow.com/questions/55085230/problem-using-godoc-to-start-a-local-doc-server/55085403#55085403", "title": "Problem using godoc to start a local doc server", "body": "<p>Put at least the package line into temp.go file or remove that file fix the problem. It seems any file directly under $GOPATH/src/ contain syntax error will cause problem</p>\n"}], "owner": {"reputation": 95, "user_id": 8452022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14c1b7521ea0e4b3e1ad1c6024fbd3e?s=128&d=identicon&r=PG&f=1", "display_name": "oNion", "link": "https://stackoverflow.com/users/8452022/onion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552203006, "creation_date": 1552200764, "question_id": 55085230, "link": "https://stackoverflow.com/questions/55085230/problem-using-godoc-to-start-a-local-doc-server", "title": "Problem using godoc to start a local doc server", "body": "<p>godoc won't return packages list</p>\n\n<p>Build version go1.11.5.</p>\n\n<p>go env:\n</p>\n\n<pre><code>set GOARCH=amd64\nset GOBIN=\nset GOCACHE=C:\\Users\\dell\\AppData\\Local\\go-build\nset GOEXE=.exe\nset GOFLAGS=\nset GOHOSTARCH=amd64\nset GOHOSTOS=windows\nset GOOS=windows\nset GOPATH=E:\\Go work\nset GOPROXY=\nset GORACE=\nset GOROOT=C:\\Go\nset GOTMPDIR=\nset GOTOOLDIR=C:\\Go\\pkg\\tool\\windows_amd64\nset GCCGO=gccgo\nset CC=gcc\nset CXX=g++\nset CGO_ENABLED=1\nset GOMOD=\nset CGO_CFLAGS=-g -O2\nset CGO_CPPFLAGS=\nset CGO_CXXFLAGS=-g -O2\nset CGO_FFLAGS=-g -O2\nset CGO_LDFLAGS=-g -O2\nset PKG_CONFIG=pkg-config\nset GOGCCFLAGS=-m64 -mthreads -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=C:\\Users\\dell\\AppData\\Local\\Temp\\go-build908876718=/tmp/go-build -gno-record-gcc-switches\n</code></pre>\n\n<p>Currently learning go, checking go packages docs a lot, so I am trying to start a local go docments server using godoc. the command I am using is:\n</p>\n\n<pre><code>godoc -http=:54321\n</code></pre>\n\n<p>The server started without problem, but when I click the \"Packages\" button on top of the page or visit localhost:54321 it gave me this:\n</p>\n\n<pre><code>\\src\\temp.go:1:1: expected 'package', found 'EOF'\n</code></pre>\n\n<p>instead of packages list like the online doc.\nBut if I visit <a href=\"http://localhost:54321/pkg/io/\" rel=\"nofollow noreferrer\">http://localhost:54321/pkg/io/</a> or any other packages directly it works fine.</p>\n\n<p>I have an empty temp.go file under my e:\\go work\\src, so I am pretty sure that's where the error coming from.</p>\n\n<p>What I want is godoc return package list when I visit <a href=\"http://localhost:54321/pkg/\" rel=\"nofollow noreferrer\">http://localhost:54321/pkg/</a>, just like visit the online doc <a href=\"https://golang.org/pkg/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/</a></p>\n"}, {"tags": ["go", "cookies", "browser", "oauth"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1552210365, "post_id": 55085141, "comment_id": 96917622, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6761415/how-to-set-a-cookie-for-another-domain\">How to set a cookie for another domain</a>"}, {"owner": {"reputation": 3895, "user_id": 4040931, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/705151302/picture?type=large", "display_name": "David Alsh", "link": "https://stackoverflow.com/users/4040931/david-alsh"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552215023, "post_id": 55085141, "comment_id": 96918741, "body": "If it&#39;s not possible to set the cookie on the second domain, how would you solve the above issue?"}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1552236296, "creation_date": 1552236296, "answer_id": 55090008, "question_id": 55085141, "link": "https://stackoverflow.com/questions/55085141/can-i-specify-and-set-http-only-cookie-for-another-domain/55090008#55090008", "title": "Can I specify and set http-only cookie for another domain?", "body": "<p>Well, it depends. In general, no, you cannot set cookies for a different domain.</p>\n\n<p>But you can set cookies for all subdomains of a domain you \"control\" (read RFC 6265 and publicsuffix.org for details) by setting the Domain attribute of a cookie.</p>\n"}], "owner": {"reputation": 3895, "user_id": 4040931, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/705151302/picture?type=large", "display_name": "David Alsh", "link": "https://stackoverflow.com/users/4040931/david-alsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1552236296, "creation_date": 1552199952, "question_id": 55085141, "link": "https://stackoverflow.com/questions/55085141/can-i-specify-and-set-http-only-cookie-for-another-domain", "title": "Can I specify and set http-only cookie for another domain?", "body": "<p>Say I have a service that has two domains</p>\n\n<pre><code>app.myapp.com\napi.myapp.com\n</code></pre>\n\n<p>My app does the whole OAuth/OpenID flow.</p>\n\n<pre><code>app.myapp.com/oauth\napp.myapp.com/oauth/callback\n</code></pre>\n\n<p>In the <code>/callback</code> I set the <code>accessToken</code> as an http-only cookie on the current domain (<code>app.myapp.com</code>).</p>\n\n<p>I have an assortment of microservices that live on <code>api.myapp.com</code>, all of which require an <code>accessToken</code> to work. </p>\n\n<p>In the <code>/callback</code> stage of the OAuth flow, can I specify the other domain in my http-only cookie?</p>\n\n<p>I am using Go + Gin</p>\n\n<pre><code>c.SetCookie(\n    \"accessToken\", \n    accessToken, \n    3600, \n    \"/\", \n    \"\", \n    false, \n    true,\n)\n</code></pre>\n"}, {"tags": ["go", "time"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1552203603, "post_id": 55085131, "comment_id": 96916239, "body": "If I had to make a guess, when you specify _, the allocated array gets destroyed before exiting the function because of compiler analysis, and that&#39;s the extra time."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1552203651, "post_id": 55085131, "comment_id": 96916253, "body": "How about this: allocate both arrays and pass them to the function before measuring, and see how long it takes? Or do the replacement in-place?"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1552205822, "creation_date": 1552205822, "answer_id": 55085757, "question_id": 55085131, "link": "https://stackoverflow.com/questions/55085131/timing-in-golang-with-and-without-blank-identifier/55085757#55085757", "title": "Timing in Golang with and without blank identifier", "body": "<p>If you want the same results, do the same thing! Obviously, allocations are not going to be free! Don't comment out an allocation!</p>\n\n<p>For example,</p>\n\n<p>Output:</p>\n\n<pre><code>time taken:  77.726729ms 9\ntime taken:  78.213242ms 0\n</code></pre>\n\n<p><code>main.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"math/rand\"\n    \"testing\"\n    \"time\"\n)\n\n// A random array of integers\nfunc randomArray(max int, len int) []int {\n    a := make([]int, len)\n    for i := 0; i &lt;= len-1; i++ {\n        a[i] = rand.Intn(max)\n    }\n    return a\n}\n\n// Taking square root of each element in array\nfunc sqrt_array(arr []int) []float64 {\n    var len_arr = len(arr)\n    a := make([]float64, len_arr)\n    for i, v := range arr {\n        a[i] = math.Sqrt(float64(v))\n    }\n    return a\n}\n\nfunc main1() {\n\n    arr := randomArray(100, 10e6)\n    sqrt := make([]float64, len(arr))\n    start := time.Now()\n    sqrt = sqrt_array(arr)\n    end := time.Now()\n\n    fmt.Println(\"time taken: \", end.Sub(start), sqrt[0])\n}\n\nfunc main2() {\n\n    arr := randomArray(100, 10e6)\n    // sqrt := make([]float64, len(arr))\n    sqrt := make([]float64, len(arr))\n    start := time.Now()\n    _ = sqrt_array(arr)\n    end := time.Now()\n\n    fmt.Println(\"time taken: \", end.Sub(start), sqrt[0])\n}\n\nfunc main() {\n    main1()\n    main2()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 7235925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683f965b8d1f7f6690550e30d76b5a77?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/7235925/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1552214243, "creation_date": 1552214243, "answer_id": 55086796, "question_id": 55085131, "link": "https://stackoverflow.com/questions/55085131/timing-in-golang-with-and-without-blank-identifier/55086796#55086796", "title": "Timing in Golang with and without blank identifier", "body": "<p>@Not_a_Golfer that's an interesting idea thanks! I replaced sqrt_array with </p>\n\n<pre><code>func sqrt_array(arr [] int) [] float64 {\n    var len_arr = len(arr)\n    a := make([]float64, len_arr)\n    s := time.Now()\n    for i, v := range arr {\n    a[i] = math.Sqrt(float64(v))\n    }\n    e := time.Now()\n    fmt.Println(\"time taken: \", e.Sub(s))\n    return a\n}\n</code></pre>\n\n<p>and found that the first main() I used give: </p>\n\n<p>time taken: 30.455811ms<br>\ntime taken: 36.419998ms 9 </p>\n\n<p>while the second gives </p>\n\n<p>time taken: 30.916246ms<br>\ntime taken: 90.815387ms</p>\n\n<p>I think this shows that the computation time of the two approaches is more or less the same (30ms). There may indeed be some time-cost (60ms or so) of deleting the array in the second option. Although that is weird since it should be just deleting a pointer</p>\n"}], "owner": {"reputation": 49, "user_id": 7235925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683f965b8d1f7f6690550e30d76b5a77?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/7235925/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 1, "answer_count": 2, "score": -2, "last_activity_date": 1552214243, "creation_date": 1552199899, "question_id": 55085131, "link": "https://stackoverflow.com/questions/55085131/timing-in-golang-with-and-without-blank-identifier", "title": "Timing in Golang with and without blank identifier", "body": "<p>I am playing around with some elementary timing in Go and have a question. I want to time Golang in taking the square root of each element of an array but I get two somewhat different answers whether or not I keep the output. Here is the my first version:</p>\n\n<pre><code>package main\n\nimport (\"fmt\"\n        \"time\" \n        \"math\"\n        \"math/rand\"\n)\n\n// A random array of integers \nfunc randomArray(max int ,len int) []int {\n    a := make([]int, len)\n    for i := 0; i &lt;= len-1; i++ {\n        a[i] = rand.Intn(max)\n    }\n    return a\n}\n\n// Taking square root of each element in array\nfunc sqrt_array(arr [] int) [] float64 {\n    var len_arr = len(arr)\n    a := make([]float64, len_arr)\n    for i, v := range arr {\n    a[i] = math.Sqrt(float64(v))\n    }\n    return a\n}\n\n\nfunc main() {\n\n    arr := randomArray(100, 10e6)\n    sqrt := make([]float64, len(arr))\n    start := time.Now()\n    sqrt = sqrt_array(arr)\n    end := time.Now()\n\n    fmt.Println(\"time taken: \", end.Sub(start), sqrt[0])\n}\n</code></pre>\n\n<p>gives on average around 36ms:</p>\n\n<pre><code>time taken:  36.542019ms 9\n</code></pre>\n\n<p>Now when I replace the output \"sqrt\" with the blank identifier, I get something much slower. Specifically, I replace main() with</p>\n\n<pre><code>func main() {\n\n    arr := randomArray(100, 10e6)\n    // sqrt := make([]float64, len(arr))\n    start := time.Now()\n    _ = sqrt_array(arr)\n    end := time.Now()\n\n    fmt.Println(\"time taken: \", end.Sub(start))\n}\n</code></pre>\n\n<p>and get on average something like 92ms</p>\n\n<pre><code>time taken:  92.121481ms\n</code></pre>\n\n<p>Would someone be able to explain what is happening? I feel that if I understood I might learn something about Go. </p>\n\n<p>Incidentally I find that the same computation in Python was around 20ms if broadcasted and several hundred ms if in a loop.</p>\n"}, {"tags": ["docker", "go", "dockerfile", "google-cloud-build"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2477841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eff4e44803795b4a59b1c7ed29e7067d?s=128&d=identicon&r=PG", "display_name": "ajbrowe", "link": "https://stackoverflow.com/users/2477841/ajbrowe"}, "is_accepted": false, "score": 1, "last_activity_date": 1552206419, "creation_date": 1552206419, "answer_id": 55085821, "question_id": 55084520, "link": "https://stackoverflow.com/questions/55084520/google-cloud-build-docker-build-arg-from-file/55085821#55085821", "title": "Google Cloud Build Docker build-arg from file", "body": "<p>The .ssh directory needs to have the right permissions</p>\n\n<pre><code>RUN mkdir -m 700 -p ~/.ssh &amp;&amp;  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 1991376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lnzj7.jpg?s=128&g=1", "display_name": "ryanhos", "link": "https://stackoverflow.com/users/1991376/ryanhos"}, "is_accepted": true, "score": 0, "last_activity_date": 1553806933, "creation_date": 1553806933, "answer_id": 55406800, "question_id": 55084520, "link": "https://stackoverflow.com/questions/55084520/google-cloud-build-docker-build-arg-from-file/55406800#55406800", "title": "Google Cloud Build Docker build-arg from file", "body": "<p>The <a href=\"https://github.com/GoogleCloudPlatform/cloud-builders/blob/master/docker/Dockerfile-18.09.0#L19\" rel=\"nofollow noreferrer\">GCloud Docker Builder</a> is using the Exec form of <a href=\"https://docs.docker.com/engine/reference/builder/#entrypoint\" rel=\"nofollow noreferrer\">ENTRYPOINT</a>.  Your arguments from the cloudbuild.yaml are not being passed to a shell, thus your <code>cat</code> will not be executed.</p>\n\n<p>Why not direct KMS to write the <code>id_rsa</code> directly to the <code>/workspace</code> and do away with the <code>ssh</code> volume altogether?</p>\n\n<pre><code>- name: 'gcr.io/cloud-builders/gcloud'\n  args:\n  - kms\n  - decrypt\n  - --ciphertext-file=A.enc\n  - --plaintext-file=/workspace/id_rsa\n  - --location=global\n  - --keyring=keyringxxx\n  - --key=keyxxx\n- name: 'gcr.io/cloud-builders/docker'\n  args: [\n    'build', '.',\n    '-t', 'gcr.io/$PROJECT_ID/xxx:latest'\n  ]\n</code></pre>\n\n<p>And the Dockerfile becomes:</p>\n\n<pre><code>FROM golang:1.11 AS builder\n\nRUN mkdir -p ~/.ssh\nCOPY id_rsa ~/.ssh/\nRUN ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts &amp;&amp; \\\n    chmod -R 0600 ~/.ssh/ &amp;&amp; \\\n    git config --global url.ssh://git@github.com:.insteadOf https://github.com\n</code></pre>\n\n<p>Don't forget to mount that <code>.gitconfig</code> into the additional build steps.  I just make it part of my CI build script, rather than requiring the extra <code>volume</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 7293972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zOQz8.jpg?s=128&g=1", "display_name": "Wang Yang", "link": "https://stackoverflow.com/users/7293972/wang-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1309, "favorite_count": 0, "accepted_answer_id": 55406800, "answer_count": 2, "score": 0, "last_activity_date": 1553806933, "creation_date": 1552193401, "last_edit_date": 1552198505, "question_id": 55084520, "link": "https://stackoverflow.com/questions/55084520/google-cloud-build-docker-build-arg-from-file", "title": "Google Cloud Build Docker build-arg from file", "body": "<p>I have a problem when I use Google Cloud Build. I can't pass the key into docker by cloudbuild.yaml</p>\n\n<p>Google buildfile.yaml:</p>\n\n<pre><code>- name: 'gcr.io/cloud-builders/gcloud'\n  args:\n  - kms\n  - decrypt\n  - --ciphertext-file=A.enc\n  - --plaintext-file=/root/.ssh/id_rsa\n  - --location=global\n  - --keyring=keyringxxx\n  - --key=keyxxx\n  volumes:\n  - name: 'ssh'\n    path: /root/.ssh\n- name: 'gcr.io/cloud-builders/docker'\n  args: [\n    'build', '.',\n    '-t', 'gcr.io/$PROJECT_ID/xxx:latest',\n    '--build-arg', 'READ_KEY=`cat /root/.ssh/id_rsa`'\n  ]\n  volumes:\n  - name: 'ssh'\n</code></pre>\n\n<p>Dockerfile:</p>\n\n<pre><code>FROM golang:1.11 AS builder\n\nARG READ_KEY\nRUN mkdir -p ~/.ssh &amp;&amp;  \\\n    echo \"$READ_KEY\" &gt; ~/.ssh/id_rsa &amp;&amp; \\\n    chmod 0600 ~/.ssh/id_rsa &amp;&amp; \\\n    ssh-keyscan github.com &gt;&gt; /root/.ssh/known_hosts &amp;&amp; \\\n    git config --global url.ssh://git@github.com/XXXX.insteadOf https://github.com/XXXX\n\n......\n</code></pre>\n\n<p>The above code failed. <code>cat</code> does not work.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 6892582, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wWXpJnaodf8/AAAAAAAAAAI/AAAAAAAAASo/iUT9ySE-cgg/photo.jpg?sz=128", "display_name": "Denis Sedchenko", "link": "https://stackoverflow.com/users/6892582/denis-sedchenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1552191577, "creation_date": 1552191577, "answer_id": 55084397, "question_id": 55084214, "link": "https://stackoverflow.com/questions/55084214/process-doesnt-die-after-cmd-process-kill-call/55084397#55084397", "title": "Process doesn&#39;t die after cmd.Process.Kill() call", "body": "<p>The issue was that the main process <code>sh</code> was killed but child process <code>sleep</code> was still alive.</p>\n\n<p>The solution was to assign process group to the main process and kill a whole process group.</p>\n\n<pre><code>// assign process group\ncmd.SysProcAttr = &amp;syscall.SysProcAttr{Setpgid: true}\n\n// Kill pg\nsyscall.Kill(-cmd.Process.Pid, syscall.SIGKILL)\n</code></pre>\n\n<p>Solution was found <a href=\"https://medium.com/@felixge/killing-a-child-process-and-all-of-its-children-in-go-54079af94773\" rel=\"nofollow noreferrer\">here</a> </p>\n"}], "owner": {"reputation": 147, "user_id": 6892582, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wWXpJnaodf8/AAAAAAAAAAI/AAAAAAAAASo/iUT9ySE-cgg/photo.jpg?sz=128", "display_name": "Denis Sedchenko", "link": "https://stackoverflow.com/users/6892582/denis-sedchenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55084397, "answer_count": 1, "score": 2, "last_activity_date": 1552210413, "creation_date": 1552189184, "last_edit_date": 1552210413, "question_id": 55084214, "link": "https://stackoverflow.com/questions/55084214/process-doesnt-die-after-cmd-process-kill-call", "title": "Process doesn&#39;t die after cmd.Process.Kill() call", "body": "<p>I've a program that tracks file change and should restart a specified process on file change.</p>\n\n<p>I use <code>cmd.Process.Kill()</code> to kill previous process but it keeps alive after <code>Kill()</code> called.</p>\n\n<p>Some piece of code related to process start from project:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// ShellPlugin allows to run shell commands in task runner \ntype ShellPlugin struct {\n    scope  *scope.Scope\n    params Params\n    log    logging.Logger\n    done chan bool\n}\n\n// Call calls a plugin\nfunc (p *ShellPlugin) Call(tx *job.RunContext, r plugins.JobRunner) (err error) {\n    defer close(p.done)\n\n    // process: /bin/sh -c ping google.com\n    cmd, err := p.params.createProcess(p.scope)\n    if err != nil {\n        return fmt.Errorf(\"failed to create process to execute command '%s': %s\", p.params.Command, err)\n    }\n\n    p.log.Debug(\"command: '%s'\", p.params.Command)\n    p.log.Debug(`starting process \"%s\"...`, strings.Join(cmd.Args, \" \"))\n\n    if err = cmd.Start(); err != nil {\n        return fmt.Errorf(`failed to execute command \"%s\": %s`, strings.Join(cmd.Args, \" \"), err)\n    }\n\n    go func() {\n        select {\n        case &lt;- p.done:\n            p.log.Debug(\"received stop signal\")\n            if err := cmd.Process.Kill(); err != nil {\n                p.log.Warn(\"kill: %s\", err.Error())\n            }\n            p.log.Debug(\"Killed\")\n        }\n    }()\n\n    if err := cmd.Wait(); err != nil {\n        return formatExitError(err)\n    }\n\n    p.log.Debug(\"done\")\n    return nil\n}\n\n// Cancel called when task should be canceled\nfunc (p *ShellPlugin) Cancel(ctx *job.RunContext) error {\n    p.done &lt;- true\n    return nil\n}\n</code></pre>\n\n<p><code>Call()</code> starts job and <code>Cancel()</code> cancel it.\nBoth called in separate goroutine.</p>\n\n<p>Full source code is <a href=\"https://github.com/x1unix/gilbert/blob/feat/async/plugins/builtin/shell/plugin.go\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": ["java", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552210484, "post_id": 55082715, "comment_id": 96917654, "body": "Go doesn&#39;t have classes, so it&#39;s impossible to initializes them."}], "answers": [{"tags": [], "owner": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "is_accepted": false, "score": 1, "last_activity_date": 1552171619, "creation_date": 1552171619, "answer_id": 55082732, "question_id": 55082715, "link": "https://stackoverflow.com/questions/55082715/initialize-a-new-class-in-golang-convert-java-to-golang/55082732#55082732", "title": "Initialize a new class in Golang (Convert Java to Golang)", "body": "<p>Golang doesn't support overloaded method names.</p>\n\n<p>You simply have to call (one of) the methods something different.</p>\n"}, {"tags": [], "owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "is_accepted": true, "score": 0, "last_activity_date": 1552414858, "last_edit_date": 1552414858, "creation_date": 1552172485, "answer_id": 55082822, "question_id": 55082715, "link": "https://stackoverflow.com/questions/55082715/initialize-a-new-class-in-golang-convert-java-to-golang/55082822#55082822", "title": "Initialize a new class in Golang (Convert Java to Golang)", "body": "<p>There are a couple of issues in this code, but the first, and the one you point out, is that the <code>NewPath</code> function is defined twice here and Go throws an error because of this. Go does not support method overloading, so the simplest way to solve this would be to rename your second function to something else.</p>\n\n<p>The next error you'll get is <code>cannot use op.path (type []Cell) as type Cell in append</code>, which happens in the line <code>p.path = append(p.path, op.path)</code> in the second <code>NewPath</code> function. This happens because you are trying to place <code>op.path</code> (type <code>[]Cell</code>) into <code>p.path</code> (type <code>[]Cell</code>), so since <code>op.path</code> is not of type <code>Cell</code> it cannot be appended to <code>p.path</code>. Note that <code>append</code> is not the same as concatenate, instead it takes all arguments from the second onward and places them inside the first argument. To fix this you can unpack <code>op.path</code> into <code>append</code> using the <code>...</code> operator. This will make each element of <code>op.path</code> an individual argument to <code>append</code>, and each will be placed inside of <code>p.path</code>.</p>\n\n<p>Here is a refactored version of your code:</p>\n\n<pre><code>func NewPath() (p *Path) { // no changes\n    p = new(Path)\n    p.path = []Cell{}\n    p.count = 0\n    p.name = \"P\" + strconv.Itoa(1+p.count)\n    return\n}\n\nfunc NewPathFromOriginal(op Path) (p *Path) { // renamed\n    p = new(Path)\n    p.path = []Cell{}\n    p.count = 0\n    p.name = op.name\n    p.path = append(p.path, op.path...) // note the '...'\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10935444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efc621f50dadeed81835bd52f88ebc44?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Mulin", "link": "https://stackoverflow.com/users/10935444/jack-mulin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 1, "accepted_answer_id": 55082822, "answer_count": 2, "score": -3, "last_activity_date": 1570991203, "creation_date": 1552171513, "last_edit_date": 1570991203, "question_id": 55082715, "link": "https://stackoverflow.com/questions/55082715/initialize-a-new-class-in-golang-convert-java-to-golang", "title": "Initialize a new class in Golang (Convert Java to Golang)", "body": "<p>I am trying to convert this java to golang and now I have this bug. I don't know why this bug is showing up.</p>\n\n<p>here is the java code:</p>\n\n<pre><code>ArrayList&lt;Cell&gt; path; // path does not repeat first cell\nString name;\nstatic int count = 0;\n\npublic Path() {\n  this.path = new ArrayList&lt;&gt;();\n  this.name = \"P\" + (++this.count);\n}\n\npublic Path(Path op) {\n  this.path = new ArrayList&lt;&gt;();\n  this.name = op.name;\n  path.addAll((op.path));\n}\n</code></pre>\n\n<p>Here is what i wrote </p>\n\n<pre><code>type Path struct {\n    name  string\n    count int\n    path  []Cell\n}\n\nfunc NewPath() (p *Path) {\n    p = new(Path)\n    p.path = []Cell{}\n    p.count = 0\n    p.name = \"P\" + strconv.Itoa(1+p.count)\n    return\n}\n\nfunc NewPath(op Path) (p *Path) {\n    p = new(Path)\n    p.path = []Cell{}\n    p.count = 0\n    p.name = op.name\n    p.path = append(p.path, op.path)\n    return\n}\n</code></pre>\n\n<p>The go system said I am wrong in term of redeclaring NewPath, with the error:</p>\n\n<pre><code>prog.go:21:6: NewPath redeclared in this block\n</code></pre>\n\n<p>How can I debug it? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "edited": false, "score": 0, "creation_date": 1552172248, "post_id": 55082534, "comment_id": 96911185, "body": "Do I need something like coding below.                        //Set Content-Type header so that clients will know how to read response \tw.Header().Set(&quot;Content-Type&quot;,&quot;application/json&quot;) \tw.WriteHeader(http.StatusOK) \t//Write json response back to response  w.Write(jsonresult_send)"}, {"owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "edited": false, "score": 0, "creation_date": 1552172543, "post_id": 55082534, "comment_id": 96911251, "body": "In my browser console, I need to be seing something like an array or object of the json response. so that I can finally use it with my front end code  [{&quot;message&quot;: &quot;User successfully Registered&quot;}]  or  {&quot;message&quot;: &quot;User successfully Registered&quot;}"}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 9188829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-q2tubbLJcw0/AAAAAAAAAAI/AAAAAAAAAA0/6bnebo7rvJs/photo.jpg?sz=128", "display_name": "&#205;caro Lima", "link": "https://stackoverflow.com/users/9188829/%c3%8dcaro-lima"}, "is_accepted": true, "score": 0, "last_activity_date": 1552179278, "creation_date": 1552179278, "answer_id": 55083488, "question_id": 55082534, "link": "https://stackoverflow.com/questions/55082534/how-to-properly-get-message-in-json-after-form-submision-using-golang-or-go/55083488#55083488", "title": "How to properly get message in json after form submision using golang or go", "body": "<p>If I understood correctly, what you need is this:</p>\n\n<pre><code>func GetPeople(w http.ResponseWriter, r *http.Request) {\n    json.NewEncoder(w).Encode(people)\n}\n</code></pre>\n\n<p>In your case, you could solve it in two ways:</p>\n\n<ol>\n<li>With a struct</li>\n</ol>\n\n<pre><code>type Info struct {\n    Message string `json:\"message\"`\n}\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    ... Some processing here ...\n\n    info := Info{Message: \"User Registered successfully\"}\n    json.NewEncoder(w).Encode(info)\n}\n</code></pre>\n\n<ol start=\"2\">\n<li>With a map</li>\n</ol>\n\n<pre><code>func MyHandler(w http.ResponseWriter, r *http.Request) {\n    ... Some processing here ...\n\n    info := map[string]string{\"message\": \"User Registered successfully\"}\n    json.NewEncoder(w).Encode(info)\n}\n</code></pre>\n\n<p>If anyone can test to look for some syntax error I appreciate it.</p>\n"}], "owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 55083488, "answer_count": 1, "score": 0, "last_activity_date": 1552179278, "creation_date": 1552170004, "question_id": 55082534, "link": "https://stackoverflow.com/questions/55082534/how-to-properly-get-message-in-json-after-form-submision-using-golang-or-go", "title": "How to properly get message in json after form submision using golang or go", "body": "<p>How to properly get message in json after form submision using golang. Am just trying golang today for the first time.</p>\n\n<p><strong>Here is what am trying to achieve with golang:</strong></p>\n\n<p>In php for instance I can echo/print a json message after user submmitted a form and can then access it from the front end</p>\n\n<p>Eg.</p>\n\n<pre><code>  if($everything == 'ok'){\n $messages = [\n      'message' =&gt; 'User Registered successfully'\n    ];\n   echo json_encode($messages);\nexit();\n  }\n</code></pre>\n\n<p>Please How do I do this with golang.</p>\n\n<p>The code below works fine by inserting records to database. Upon a successful insert, it display a success message in the code below and everything is working fine.</p>\n\n<pre><code>res.Write([]byte(\"User Registered successfully!\" +username))\n</code></pre>\n\n<p><strong>Here is my qusetion:</strong>\nHow do I get json response of the successful message so that I can access it from my front end just like in php code above.</p>\n\n<p>I have tried</p>\n\n<pre><code>messageJson := `{\"message\": \"User Registered successfully\"}`\njsonresult_send := json.Marshal(messageJson)\n\nreturn jsonresult_send\n</code></pre>\n\n<p>But it displays error <strong>too many argument to return</strong></p>\n\n<pre><code>Here is the entire code\n\n\n\npackage main\n\nimport \"database/sql\"\nimport _ \"github.com/go-sql-driver/mysql\"\n\nimport \"net/http\"\nimport \"fmt\"\nimport \"encoding/json\"\n\nvar db *sql.DB\nvar err error\n\n\n\ntype MessageInfo struct {\n  Message string\n}\n\n\n\nfunc signupPage(res http.ResponseWriter, req *http.Request) {\n    if req.Method != \"POST\" {\n        http.ServeFile(res, req, \"signupjson.html\")\n        return\n    }\n\n\n\n        username := req.FormValue(\"username\")\n    password := req.FormValue(\"password\")\n\n\n\n    var user string\n         err := db.QueryRow(\"SELECT username FROM users WHERE username=?\", username).Scan(&amp;user)\n\n\n    switch {\n    case err == sql.ErrNoRows:\n        _, err = db.Exec(\"INSERT INTO users(username, password) VALUES(?, ?)\", username, password)\n        if err != nil {\n            http.Error(res, \"insert error, unable to create your account.\", 500)\n            return\n        }\n\nres.Write([]byte(\"User Registered successfully!\" +username))\n\n// get json response message\n\nmessageJson := `{\"message\": \"User Registered successfully\"}`\njsonresult_send := json.Marshal(messageJson)\n\nreturn jsonresult_send\n\n        return\n    default:\n        http.Redirect(res, req, \"/\", 301)\n    }\n}\n\n\n\nfunc homePage(res http.ResponseWriter, req *http.Request) {\n    http.ServeFile(res, req, \"index.html\")\n}\n\nfunc main() {\n    db, err = sql.Open(\"mysql\", \"root:@/golang44\")\n    if err != nil {\n        panic(err.Error())\n    }\n    defer db.Close()\n\n    err = db.Ping()\n    if err != nil {\n        panic(err.Error())\n    }\n\n    http.HandleFunc(\"/signupjson\", signupPage)\n    http.HandleFunc(\"/\", homePage)\n        fmt.Println(\"Listening on 127.0.0.1:8088\")\n    http.ListenAndServe(\":8088\", nil)\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "go", "cgo"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1552170193, "post_id": 55082336, "comment_id": 96910791, "body": "I&#39;m not seeing anything there about <code>opencv_test.cpp</code> being compiled, or the result being linked to your golang program.  I&#39;m not sure how this is supposed to work on the golang side, but that&#39;s what appears to be missing."}, {"owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552170393, "post_id": 55082336, "comment_id": 96910823, "body": "You are right. Any idea why that is happening? I am new to GoLang."}], "owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 1, "closed_date": 1552185688, "answer_count": 0, "score": 1, "last_activity_date": 1570107871, "creation_date": 1552168324, "last_edit_date": 1570107871, "question_id": 55082336, "link": "https://stackoverflow.com/questions/55082336/running-opencv-4-0-0-c-function", "closed_reason": "Duplicate", "title": "Running OpenCV-4.0.0 C++ function", "body": "<p>I have created a C API which exposes the functionality of C++ code. Here is the code for <code>opencv_test.h</code>:</p>\n\n<pre><code>#ifdef __cplusplus\n#define EXTERNC extern \"C\"\n#else\n#define EXTERNC\n#endif\n\nEXTERNC void OpenVideo(char *filename);\n\n#undef EXTERNC\n</code></pre>\n\n<p>Code for <code>opencv_test.cpp</code>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;unistd.h&gt;\n#include \"opencv_test.h\"\n#include \"opencv2/opencv.hpp\"\n\nusing namespace std;\nusing namespace cv;\n\n\nvoid OpenVideo(char *filename){\n    VideoCapture cap(filename);\n    Mat Uframe;\n    int frameCount = 0;\n\n    if(!cap.isOpened()){\n        cout&lt;&lt;\"Cannot open video file!\";\n        return;\n    }\n\n    namedWindow(\"Video\");\n    while(++frameCount){\n\n        bool success = cap.read(Uframe);\n\n        if(!success){\n            cout&lt;&lt;frameCount&lt;&lt;\" frames read\";\n            break;      \n        }\n\n        imshow(\"Video\", Uframe);\n        waitKey(1);\n\n    }\n\n}\n</code></pre>\n\n<p>And finally, for <code>opencvTest.go</code>:</p>\n\n<pre><code>package main\n\n/*\n#cgo LDFLAGS: -L/usr/local/lib -lopencv_core -lopencv_video -lopencv_videoio -lopencv_highgui\n#include &lt;stdlib.h&gt;\n#include \"opencv_test.h\"\n*/\nimport \"C\"\n\nfunc main(){\n\n    theFilename := \"DR\u017dAVNI POSAO [HQ] - Ep.323 Dan \u017eena (07.03.2014.).avi\"\n    C.OpenVideo(C.CString(theFilename))\n}\n</code></pre>\n\n<p>And the error I am getting is the following:</p>\n\n<hr>\n\n<blockquote>\n  <p>command-line-arguments /tmp/go-build823465636/b001/_x002.o: In\n  function \"_cgo_dcf5d601f507_Cfunc_OpenVideo\":\n  /tmp/go-build/cgo-gcc-prolog:48: undefined reference to `OpenVideo'\n  collect2: error: ld returned 1 exit status</p>\n</blockquote>\n\n<hr>\n\n<p>Now I am not sure if I have to run any kind of special commands or something, I have read that just by importing <strong>\"C\"</strong> pseudo-package, my <code>.go</code> file will be build with <code>cgo</code>. So, if I have included my custom-made <code>.h</code> file, and the project is built using <code>cgo</code>, how come I get <em>undefined reference to a function</em> error?</p>\n\n<p>EDIT:</p>\n\n<p>Here is the whole output when running <code>go build -x opencvTest.go</code> command:</p>\n\n<blockquote>\n  <p>WORK=/tmp/go-build568047770</p>\n  \n  <p>mkdir -p $WORK/b001/</p>\n  \n  <p>cd /home/stefan/Desktop/GoLang</p>\n  \n  <p>CGO_LDFLAGS='\"-L/usr/local/lib\" \"-lopencv_core\" \"-lopencv_video\"\n  \"-lopencv_videoio\" \"-lopencv_highgui\" \"-L/usr/local/lib\"\n  \"-lopencv_core\" \"-lopencv_video\" \"-lopencv_videoio\"\n  \"-lopencv_highgui\"' /usr/local/go/pkg/tool/linux_amd64/cgo -objdir\n  $WORK/b001/ -importpath command-line-arguments -- -I/usr/local/include\n  -I $WORK/b001/ -g -O2 ./opencvTest.go</p>\n  \n  <p>cd $WORK</p>\n  \n  <p>gcc -fno-caret-diagnostics -c -x c - || true</p>\n  \n  <p>gcc -Qunused-arguments -c -x c - || true</p>\n  \n  <p>gcc -fdebug-prefix-map=a=b -c -x c - || true</p>\n  \n  <p>gcc -gno-record-gcc-switches -c -x c - || true</p>\n  \n  <p>cd $WORK/b001</p>\n  \n  <p>TERM='dumb' gcc -I /home/stefan/Desktop/GoLang -fPIC -m64 -pthread\n  -fmessage-length=0 -fdebug-prefix-map=$WORK/b001=/tmp/go-build -gno-record-gcc-switches </p>\n  \n  <p>-I/usr/local/include -I ./ -g -O2 -o ./_x001.o -c _cgo_export.c TERM='dumb' gcc -I /home/stefan/Desktop/GoLang -fPIC -m64 -pthread\n  -fmessage-length=0 -fdebug-prefix-map=$WORK/b001=/tmp/go-build -gno-record-gcc-switches </p>\n  \n  <p>-I/usr/local/include -I ./ -g -O2 -o ./_x002.o -c opencvTest.cgo2.c TERM='dumb' gcc -I /home/stefan/Desktop/GoLang -fPIC -m64 -pthread\n  -fmessage-length=0 -fdebug-prefix-map=$WORK/b001=/tmp/go-build -gno-record-gcc-switches </p>\n  \n  <p>-I/usr/local/include -I ./ -g -O2 -o ./_cgo_main.o -c _cgo_main.c cd /home/stefan/Desktop/GoLang TERM='dumb' gcc -I . -fPIC -m64 -pthread\n  -fmessage-length=0 -fdebug-prefix-map=$WORK/b001=/tmp/go-build -gno-record-gcc-switches -o $WORK/b001/<em>cgo</em>.o  $WORK/b001/_cgo_main.o $WORK/b001/_x001.o $WORK/b001/_x002.o -L/usr/local/lib -lopencv_core\n  -lopencv_video -lopencv_videoio -lopencv_highgui -L/usr/local/lib -lopencv_core -lopencv_video -lopencv_videoio -lopencv_highgui</p>\n  \n  <p>command-line-arguments /tmp/go-build568047770/b001/_x002.o: In\n  function <code>_cgo_dcf5d601f507_Cfunc_OpenVideo':\n  /tmp/go-build/cgo-gcc-prolog:48: undefined reference to</code>OpenVideo'\n  collect2: error: ld returned 1 exit status</p>\n</blockquote>\n"}, {"tags": ["oracle", "go"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1552156333, "post_id": 55080447, "comment_id": 96907166, "body": "<a href=\"https://blogs.oracle.com/developers/how-to-connect-a-go-program-to-oracle-database-using-goracle\" rel=\"nofollow noreferrer\">blogs.oracle.com/developers/&hellip;</a>  and encoding/json"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552159070, "post_id": 55080447, "comment_id": 96907916, "body": "Requests like this for libraries, tools, or other resources are off-topic."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1552222587, "post_id": 55080447, "comment_id": 96920672, "body": "@Vorsprung hello! I don&#39;t know why you give me this link. The question wasn&#39;t about how to connect golang application to oracle database. Can you check my post again please?! I add some code."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552222672, "post_id": 55080447, "comment_id": 96920690, "body": "@Flimzy can you check my post again please? I add some code. Do you have any ideas how I can check of organization has any child?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552222961, "post_id": 55080447, "comment_id": 96920767, "body": "Your question has not fundamentally changed. &quot;What methods or packages do you use to parse such data quickly and efficiently?&quot; is off-topic."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552223293, "post_id": 55080447, "comment_id": 96920853, "body": "@Flimzy I removed that sentence from the post. My question is how to know if organization has childs or not?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552226863, "post_id": 55080447, "comment_id": 96921801, "body": "I have removed my close vote."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1552226886, "post_id": 55080447, "comment_id": 96921809, "body": "I have edited your question to change the incorrect &quot;childs&quot; to &quot;children&quot;, but I didn&#39;t modify that in your code, since that&#39;s machine-read. You might consider correcting that in your code, though. :)"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1552236167, "post_id": 55080447, "comment_id": 96924611, "body": "Query the table twice.  On the first query build a Map lookup such that if a parent is filled in the id is appended to a list that is indexed by the parent id.  Then query again and use the Map to generate the child output"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1552242180, "post_id": 55080447, "comment_id": 96926466, "body": "@Vorsprung there must be some infinite loop cuz level depth not set, right?! Could you show me your idea with example please?"}, {"owner": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "edited": false, "score": 0, "creation_date": 1552260107, "post_id": 55080447, "comment_id": 96931152, "body": "Don&#39;t have experience with Oracle but this is working on the json-object provided: <a href=\"https://play.golang.org/p/cMW-r0V3nKA\" rel=\"nofollow noreferrer\">play.golang.org/p/cMW-r0V3nKA</a>"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "edited": false, "score": 0, "creation_date": 1552273807, "post_id": 55080447, "comment_id": 96933427, "body": "@ABri hello! I believe you can use any other database which is comfortable for you. Unfortunately the main problem in my case to create json-object from database data. Do you have any ideas how to make it in my case? Can you check my post?! I add code which I use right now."}, {"owner": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "edited": false, "score": 0, "creation_date": 1552372655, "post_id": 55080447, "comment_id": 96972549, "body": "@Nurzhan Nogerbek: Did you had a look at the playground code. If the db-response is like in your above example, it should work."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "edited": false, "score": 0, "creation_date": 1552373156, "post_id": 55080447, "comment_id": 96972749, "body": "@ABri yes, I check it. My database response is not JSON. Database return data which I need to convert to JSON. You can notice from my code that I make sql query and then start to parse result like <code>for rows.Next() {***}</code>. So what I need to put from your code in that loop?!"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "reply_to_user": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "edited": false, "score": 0, "creation_date": 1552374231, "post_id": 55080447, "comment_id": 96973186, "body": "@ABri but the question is not about Oracle. The same structure <code>rows.Next() {***}</code> you need to set if use any other database. You are right, somehow I need create <code>[]byte</code>. The question is how? :)"}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552374889, "post_id": 55080447, "comment_id": 96973451, "body": "The problem is that they wouldn&#39;t be nested as in your example."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552375143, "post_id": 55080447, "comment_id": 96973573, "body": "Every record would be as separate object in array."}, {"owner": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "reply_to_user": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1552375196, "post_id": 55080447, "comment_id": 96973595, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/189859/discussion-between-abri-and-nurzhan-nogerbek\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "is_accepted": true, "score": 0, "last_activity_date": 1552832083, "creation_date": 1552832083, "answer_id": 55207999, "question_id": 55080447, "link": "https://stackoverflow.com/questions/55080447/how-to-parse-hierarchy-data/55207999#55207999", "title": "How to parse hierarchy data", "body": "<p>Finally, I found solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"sort\"\n\n    _ \"github.com/mattn/go-sqlite3\"\n)\n\ntype Organization struct {\n    ID       int             `json:\"organization_id\"`\n    Name     string          `json:\"organization_name\"`\n    Rang     int             `json:\"organization_rang\"`\n    Children []*Organization `json:\"children\"`\n}\n\nfunc main() {\n    db, err := sql.Open(\"sqlite3\", \"./database\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer db.Close()\n\n    rows, err := db.Query(\"select ORGANIZATION_ID,ORGANIZATION_NAME,ORGANIZATION_RANG,PARENT_ORGANIZATION_ID from ORG\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer rows.Close()\n\n    orgs := map[int]*Organization{}\n\n    for rows.Next() {\n        organization := &amp;Organization{}\n        var parentID sql.NullInt64\n\n        if err = rows.Scan(&amp;organization.ID, &amp;organization.Name, &amp;organization.Rang, &amp;parentID); err != nil {\n            log.Fatal(err)\n        }\n\n        if parentID.Valid {\n            if parentOrg, ok := orgs[int(parentID.Int64)]; ok {\n                parentOrg.Children = append(parentOrg.Children, organization)\n            } else {\n                orgs[int(parentID.Int64)] = &amp;Organization{ID: int(parentID.Int64)}\n                orgs[int(parentID.Int64)].Children = append(orgs[int(parentID.Int64)].Children, organization)\n            }\n        }\n\n        if _, ok := orgs[organization.ID]; ok {\n            orgs[organization.ID].Name = organization.Name\n            orgs[organization.ID].Rang = organization.Rang\n            continue\n        }\n\n        orgs[organization.ID] = organization\n    }\n\n    IDs := []int{}\n    for k := range orgs {\n        IDs = append(IDs, k)\n    }\n    sort.Ints(IDs)\n\n    organizations := []Organization{}\n    for _, ID := range IDs {\n        if len(orgs[ID].Children) &gt; 0 &amp;&amp; orgs[ID].Rang == 1 {\n            organizations = append(organizations, *orgs[ID])\n        }\n    }\n\n    content, err := json.MarshalIndent(organizations, \"\", \"  \")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(string(content))\n}\n</code></pre>\n"}], "owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 55207999, "answer_count": 1, "score": 1, "last_activity_date": 1552832083, "creation_date": 1552155021, "last_edit_date": 1552274472, "question_id": 55080447, "link": "https://stackoverflow.com/questions/55080447/how-to-parse-hierarchy-data", "title": "How to parse hierarchy data", "body": "<p>In Oracle, I have such table:</p>\n\n<pre><code>| organization_id | ogranization_name | parent_id | level |\n|-----------------|-------------------|-----------|-------|\n| 1               | Facebook          |           | 0     |\n| 2               | Instagram         | 1         | 1     |\n| 3               | Whatsapp          | 1         | 1     |\n| 4               | Dynamic           | 2         | 2     |\n| 5               | Google            |           | 0     |\n</code></pre>\n\n<p>This table show the hierarchy of organizations. I need to create a tree-like nested JSON response in my Go application:</p>\n\n<pre><code>[\n    {\n        \"organization_id\": 1\n        \"ogranization_name\": \"Facebook\",\n        \"childs\": [\n            {\n                \"organization_id\": 2,\n                \"ogranization_name\": \"Instagram\",\n                \"childs\": null\n            },\n            {\n                \"organization_id\": 3,\n                \"ogranization_name\": \"Whatsapp\",\n                \"childs\": [\n                    {\n                        \"organization_id\": 4,\n                        \"ogranization_name\": \"Dynamic\",\n                        \"childs\": null\n                    }\n                ]\n            }\n        ]\n    },\n    {\n        \"organization_id\": 5\n        \"ogranization_name\": \"Google\",\n        \"childs\": null\n    }\n]\n</code></pre>\n\n<p>I make query to Oracle database. I also create struct. My question is how to know if an organization has children or not?</p>\n\n<p><strong>main.go:</strong></p>\n\n<pre><code>type Organisation struct {\n    ID       int            `json:\"organization_id\"`\n    Name     string         `json:\"ogranization_name\"`\n    Children []Organisation `json:\"childs\"`\n}\n\nrows,err := db.Query(\"select * from ORG_TABLE\")\n\nif err != nil {\n    fmt.Println(err)\n    return\n}\n\nvar organizations []Organization\n\nfor rows.Next() {\n    var organization Organization\n\n    err = rows.Scan(&amp;organization.ID, &amp;organization.Name, ???)\n\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n}\n\norganizations = append(organizations, organization)\n</code></pre>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 1, "creation_date": 1552153333, "post_id": 55080154, "comment_id": 96906324, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/55055383/docker-port-not-accessible-even-after-being-exposed-connection-refused\">Docker: Port not accessible even after being exposed. Connection refused</a>"}, {"owner": {"reputation": 8517, "user_id": 2336650, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lpq4b.jpg?s=128&g=1", "display_name": "Mostafa Hussein", "link": "https://stackoverflow.com/users/2336650/mostafa-hussein"}, "edited": false, "score": 0, "creation_date": 1552153395, "post_id": 55080154, "comment_id": 96906345, "body": "@RomeoMihalcea can you share the result of a running container with the go client ?"}, {"owner": {"reputation": 7490, "user_id": 1515697, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/733f4b3d2139b2faa5188c9656785e50?s=128&d=identicon&r=PG", "display_name": "Romeo Mihalcea", "link": "https://stackoverflow.com/users/1515697/romeo-mihalcea"}, "edited": false, "score": 0, "creation_date": 1552153396, "post_id": 55080154, "comment_id": 96906346, "body": "Nope. ports are up when the container is started via cmd. It&#39;s just the go client that refuses to set it up properly."}, {"owner": {"reputation": 7490, "user_id": 1515697, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/733f4b3d2139b2faa5188c9656785e50?s=128&d=identicon&r=PG", "display_name": "Romeo Mihalcea", "link": "https://stackoverflow.com/users/1515697/romeo-mihalcea"}, "reply_to_user": {"reputation": 8517, "user_id": 2336650, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lpq4b.jpg?s=128&g=1", "display_name": "Mostafa Hussein", "link": "https://stackoverflow.com/users/2336650/mostafa-hussein"}, "edited": false, "score": 0, "creation_date": 1552153532, "post_id": 55080154, "comment_id": 96906380, "body": "@Mostafa Hussein I updated the question to include inspect output."}, {"owner": {"reputation": 8517, "user_id": 2336650, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lpq4b.jpg?s=128&g=1", "display_name": "Mostafa Hussein", "link": "https://stackoverflow.com/users/2336650/mostafa-hussein"}, "edited": false, "score": 0, "creation_date": 1552153754, "post_id": 55080154, "comment_id": 96906442, "body": "@RomeoMihalcea your current inspect output seems to be good. based on your question i assume this is after running <code>docker run</code> I am looking for the result after running the go script"}, {"owner": {"reputation": 7490, "user_id": 1515697, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/733f4b3d2139b2faa5188c9656785e50?s=128&d=identicon&r=PG", "display_name": "Romeo Mihalcea", "link": "https://stackoverflow.com/users/1515697/romeo-mihalcea"}, "reply_to_user": {"reputation": 8517, "user_id": 2336650, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lpq4b.jpg?s=128&g=1", "display_name": "Mostafa Hussein", "link": "https://stackoverflow.com/users/2336650/mostafa-hussein"}, "edited": false, "score": 2, "creation_date": 1552153857, "post_id": 55080154, "comment_id": 96906476, "body": "@Mostafa Hussein the udp port is not responding. Here&#39;s a healthy inspect when the container is executed via cmd: <a href=\"https://gist.github.com/ciokan/f574a769315fc7c8bf0bc8ef1c374999\" rel=\"nofollow noreferrer\">gist.github.com/ciokan/f574a769315fc7c8bf0bc8ef1c374999</a> (the above result is after running the go client)"}], "answers": [{"comments": [{"owner": {"reputation": 7490, "user_id": 1515697, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/733f4b3d2139b2faa5188c9656785e50?s=128&d=identicon&r=PG", "display_name": "Romeo Mihalcea", "link": "https://stackoverflow.com/users/1515697/romeo-mihalcea"}, "edited": false, "score": 0, "creation_date": 1552156238, "post_id": 55080636, "comment_id": 96907129, "body": "Interesting. Can you also post the dockerfile?"}, {"owner": {"reputation": 8517, "user_id": 2336650, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lpq4b.jpg?s=128&g=1", "display_name": "Mostafa Hussein", "link": "https://stackoverflow.com/users/2336650/mostafa-hussein"}, "reply_to_user": {"reputation": 7490, "user_id": 1515697, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/733f4b3d2139b2faa5188c9656785e50?s=128&d=identicon&r=PG", "display_name": "Romeo Mihalcea", "link": "https://stackoverflow.com/users/1515697/romeo-mihalcea"}, "edited": false, "score": 0, "creation_date": 1552156313, "post_id": 55080636, "comment_id": 96907157, "body": "I have added the image url"}, {"owner": {"reputation": 7490, "user_id": 1515697, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/733f4b3d2139b2faa5188c9656785e50?s=128&d=identicon&r=PG", "display_name": "Romeo Mihalcea", "link": "https://stackoverflow.com/users/1515697/romeo-mihalcea"}, "edited": false, "score": 1, "creation_date": 1552156326, "post_id": 55080636, "comment_id": 96907165, "body": "We might be on to something. Their expose: <code>EXPOSE 53&#47;udp 53&#47;tcp 10000&#47;tcp</code>. My expose: <code>EXPOSE 53</code>"}, {"owner": {"reputation": 8517, "user_id": 2336650, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lpq4b.jpg?s=128&g=1", "display_name": "Mostafa Hussein", "link": "https://stackoverflow.com/users/2336650/mostafa-hussein"}, "reply_to_user": {"reputation": 7490, "user_id": 1515697, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/733f4b3d2139b2faa5188c9656785e50?s=128&d=identicon&r=PG", "display_name": "Romeo Mihalcea", "link": "https://stackoverflow.com/users/1515697/romeo-mihalcea"}, "edited": false, "score": 0, "creation_date": 1552156520, "post_id": 55080636, "comment_id": 96907227, "body": "The docs says: By default, EXPOSE assumes TCP. Maybe that is the reason indeed"}], "tags": [], "owner": {"reputation": 8517, "user_id": 2336650, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lpq4b.jpg?s=128&g=1", "display_name": "Mostafa Hussein", "link": "https://stackoverflow.com/users/2336650/mostafa-hussein"}, "is_accepted": true, "score": 1, "last_activity_date": 1552156775, "last_edit_date": 1552156775, "creation_date": 1552156146, "answer_id": 55080636, "question_id": 55080154, "link": "https://stackoverflow.com/questions/55080154/ports-not-being-published/55080636#55080636", "title": "Ports not being published", "body": "<p>I have tried the following example which worked as expected for me, the example as shown below:</p>\n\n<p>The docker image link: <a href=\"https://github.com/sameersbn/docker-bind\" rel=\"nofollow noreferrer\">https://github.com/sameersbn/docker-bind</a></p>\n\n<blockquote>\n  <p>Maybe the issue is related with the image that you have?</p>\n</blockquote>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    docker \"github.com/fsouza/go-dockerclient\"\n)\n\nfunc main() {\n    endpoint := \"unix:///var/run/docker.sock\"\n    client, err := docker.NewClient(endpoint)\n    if err != nil {\n        panic(err)\n    }\n    container, err := client.CreateContainer(docker.CreateContainerOptions{\n        Name:   \"my-container\",\n        Config: &amp;docker.Config{Image: \"sameersbn/bind:9.11.3-20190113\"},\n            HostConfig: &amp;docker.HostConfig{\n            PortBindings: map[docker.Port][]docker.PortBinding{\n                \"53/tcp\": {{HostIP: \"0.0.0.0\", HostPort: \"1053\"}},\n                \"53/udp\": {{HostIP: \"0.0.0.0\", HostPort: \"1053\"}},\n            },\n        },\n    },\n    )\n    client.StartContainer(container.ID, nil)\n}\n\n</code></pre>\n\n<p>Docker inspect results:</p>\n\n<pre><code>\"Ports\": {\n  \"10000/tcp\": null,\n  \"53/tcp\": [\n    {\n      \"HostIp\": \"0.0.0.0\",\n      \"HostPort\": \"1053\"\n    }\n  ],\n  \"53/udp\": [\n    {\n      \"HostIp\": \"0.0.0.0\",\n      \"HostPort\": \"1053\"\n    }\n  ]\n},\n\n</code></pre>\n\n<p>Make sure that you have this in your Dockerfile as by default <code>EXPOSE</code> assumes <code>TCP</code> as described in <a href=\"https://docs.docker.com/engine/reference/builder/#expose\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>EXPOSE 53/udp 53/tcp\n</code></pre>\n"}], "owner": {"reputation": 7490, "user_id": 1515697, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/733f4b3d2139b2faa5188c9656785e50?s=128&d=identicon&r=PG", "display_name": "Romeo Mihalcea", "link": "https://stackoverflow.com/users/1515697/romeo-mihalcea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 55080636, "answer_count": 1, "score": 1, "last_activity_date": 1552156775, "creation_date": 1552153140, "last_edit_date": 1552153513, "question_id": 55080154, "link": "https://stackoverflow.com/questions/55080154/ports-not-being-published", "title": "Ports not being published", "body": "<p>I have this config (using the <code>go-dockerclient</code> <a href=\"https://github.com/fsouza/go-dockerclient\" rel=\"nofollow noreferrer\">https://github.com/fsouza/go-dockerclient</a>) for a container but it only opens the tcp port when running the container:</p>\n\n<pre><code>...\nStartConfig: docker.HostConfig{\n    PortBindings: map[docker.Port][]docker.PortBinding{\n        \"53/tcp\": {{HostIP: \"0.0.0.0\", HostPort: \"1053\"}},\n        \"53/udp\": {{HostIP: \"0.0.0.0\", HostPort: \"1053\"}},\n    },\n</code></pre>\n\n<p>I tried in every possible way without luck. When I run the container using the cmd it works as expected:</p>\n\n<pre><code>docker run -d \\\n    -p 0.0.0.0:1053:53/udp \\\n    -p 0.0.0.0:1053:53/tcp ...\n</code></pre>\n\n<p>Any ideas what am I doing wrong here?</p>\n\n<p>Container inspect output:</p>\n\n<pre><code>    \"NetworkSettings\": {\n        \"Bridge\": \"\",\n        \"SandboxID\": \"4bdea4ccda50aaf8a3117098fdd2073943af43e8d991ddd7a0be425c5599dfbd\",\n        \"HairpinMode\": false,\n        \"LinkLocalIPv6Address\": \"\",\n        \"LinkLocalIPv6PrefixLen\": 0,\n        \"Ports\": {\n            \"53/tcp\": [\n                {\n                    \"HostIp\": \"0.0.0.0\",\n                    \"HostPort\": \"1053\"\n                }\n            ]\n        },\n        \"SandboxKey\": \"/var/run/docker/netns/4bdea4ccda50\",\n        \"SecondaryIPAddresses\": null,\n        \"SecondaryIPv6Addresses\": null,\n        \"EndpointID\": \"1796f8bda73d13d354bcd8bafaf6c1f4ff1491582c3985f6b653ccc6b2226e01\",\n        \"Gateway\": \"172.17.0.1\",\n        \"GlobalIPv6Address\": \"\",\n        \"GlobalIPv6PrefixLen\": 0,\n        \"IPAddress\": \"172.17.0.3\",\n        \"IPPrefixLen\": 16,\n        \"IPv6Gateway\": \"\",\n        \"MacAddress\": \"02:42:ac:11:00:03\",\n        \"Networks\": {\n            \"bridge\": {\n                \"IPAMConfig\": null,\n                \"Links\": null,\n                \"Aliases\": null,\n                \"NetworkID\": \"fb85e54ede4e18ae48e4c889d169d2d4cd8b2087a8c9691e094a431cb6a7eb43\",\n                \"EndpointID\": \"1796f8bda73d13d354bcd8bafaf6c1f4ff1491582c3985f6b653ccc6b2226e01\",\n                \"Gateway\": \"172.17.0.1\",\n                \"IPAddress\": \"172.17.0.3\",\n                \"IPPrefixLen\": 16,\n                \"IPv6Gateway\": \"\",\n                \"GlobalIPv6Address\": \"\",\n                \"GlobalIPv6PrefixLen\": 0,\n                \"MacAddress\": \"02:42:ac:11:00:03\"\n            }\n        }\n    }\n</code></pre>\n"}]