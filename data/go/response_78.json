[{"tags": ["function", "go", "stack"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 13, "last_activity_date": 1467900742, "last_edit_date": 1467900742, "creation_date": 1467842545, "answer_id": 38234526, "question_id": 38234487, "link": "https://stackoverflow.com/questions/38234487/returning-a-pointer-on-stack/38234526#38234526", "title": "Returning a pointer on stack", "body": "<p>Yes, this is safe and a normal pattern in Go programming. Go uses <a href=\"https://en.wikipedia.org/wiki/Escape_analysis\" rel=\"noreferrer\">escape analysis</a> to move any values with pointers that escape the stack to the heap automatically. You don't need to be concerned with where values are allocated.</p>\n\n<p>From the Go FAQ: <a href=\"https://golang.org/doc/faq#stack_or_heap\" rel=\"noreferrer\">\"How do I know whether a variable is allocated on the heap or the stack?\"</a></p>\n\n<blockquote>\n  <p>if the compiler cannot prove that the variable is not referenced after the function returns, then the compiler must allocate the variable on the garbage-collected heap to avoid dangling pointer errors</p>\n</blockquote>\n\n<p>You can see these optimization choices during compilation by using the <code>-gcflags -m</code> option. </p>\n"}, {"tags": [], "owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "is_accepted": false, "score": 3, "last_activity_date": 1467842559, "last_edit_date": 1495535323, "creation_date": 1467842559, "answer_id": 38234528, "question_id": 38234487, "link": "https://stackoverflow.com/questions/38234487/returning-a-pointer-on-stack/38234528#38234528", "title": "Returning a pointer on stack", "body": "<p>Yes, in Golang it is fine to return a pointer to a local variable. Golang will manage the objects lifetime for you and free it when all pointers to it are gone.</p>\n\n<p>In another answer I point out all the differences between C/C++ pointers and Golang pointers: <a href=\"https://stackoverflow.com/questions/38172661/what-is-the-meaning-of-and-in-golang/38172757#38172757\">What is the meaning of &#39;*&#39; and &#39;&amp;&#39; in Golang?</a></p>\n"}], "owner": {"reputation": 1488, "user_id": 4527337, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cqeb1.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/4527337/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2023, "favorite_count": 1, "accepted_answer_id": 38234526, "answer_count": 2, "score": 11, "last_activity_date": 1564561133, "creation_date": 1467842366, "last_edit_date": 1564561133, "question_id": 38234487, "link": "https://stackoverflow.com/questions/38234487/returning-a-pointer-on-stack", "title": "Returning a pointer on stack", "body": "<p>In C when I return a pointer of a stack-created variable from a function, the memory discards after the function is returned, thus making the pointer impossible to dereference. But in Go, the compiler is not giving me any errors. Does that mean that this is safe to do?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(*(something()))\n}\n\nfunc something() *string {\n    s := \"a\"\n    return &amp;s\n} \n</code></pre>\n"}, {"tags": ["caching", "go", "docker", "dockerfile"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1467842313, "post_id": 38234387, "comment_id": 63890572, "body": "why don t you <code>cp -R ..&#47;somewhere&#47;cachedvendors&#47; project&#47;vendors</code> all the simply ?"}, {"owner": {"reputation": 2721, "user_id": 1710444, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/23fb7b17ea705c9454dfc41d75f578a4?s=128&d=identicon&r=PG", "display_name": "Catalyst", "link": "https://stackoverflow.com/users/1710444/catalyst"}, "edited": false, "score": 0, "creation_date": 1481659289, "post_id": 38234387, "comment_id": 69463068, "body": "any luck? I&#39;d like to know this too"}, {"owner": {"reputation": 3208, "user_id": 1478191, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fa5cc5aa89d2edef8e3d07ac1142cfa2?s=128&d=identicon&r=PG", "display_name": "Noah Huppert", "link": "https://stackoverflow.com/users/1478191/noah-huppert"}, "reply_to_user": {"reputation": 2721, "user_id": 1710444, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/23fb7b17ea705c9454dfc41d75f578a4?s=128&d=identicon&r=PG", "display_name": "Catalyst", "link": "https://stackoverflow.com/users/1710444/catalyst"}, "edited": false, "score": 0, "creation_date": 1487529616, "post_id": 38234387, "comment_id": 71815019, "body": "@Catalyst No luck. I used <code>mh-cbon</code>&#39;s suggestion of caching on my host machine for a bit and then moved the logic over to a <a href=\"https://github.com/Noah-Huppert/golang-glide/blob/master/Dockerfile\" rel=\"nofollow noreferrer\">golang-glide</a> repository which I havn&#39;t needed to use for a while (So I don&#39;t remember if this specific problem still occurs)"}, {"owner": {"reputation": 2721, "user_id": 1710444, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/23fb7b17ea705c9454dfc41d75f578a4?s=128&d=identicon&r=PG", "display_name": "Catalyst", "link": "https://stackoverflow.com/users/1710444/catalyst"}, "edited": false, "score": 0, "creation_date": 1487577158, "post_id": 38234387, "comment_id": 71830349, "body": "@NoahHuppert the next best thing (I&#39;ve since learned about) is to <code>RUN &lt;code that generates or copies things based on glide.lock&gt;</code> right after a line doing <code>ADD glide.lock</code>. This way the RUN command is cached unless either it changes, or the line above it is invalidated - in this case when <code>ADD</code> detects a change in <code>glide.lock</code>"}], "owner": {"reputation": 3208, "user_id": 1478191, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fa5cc5aa89d2edef8e3d07ac1142cfa2?s=128&d=identicon&r=PG", "display_name": "Noah Huppert", "link": "https://stackoverflow.com/users/1478191/noah-huppert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467841891, "creation_date": 1467841891, "question_id": 38234387, "link": "https://stackoverflow.com/questions/38234387/force-docker-to-cache-directory", "title": "Force Docker to cache directory", "body": "<p>Is it possible to force Docker to cache a directory?  </p>\n\n<p>I would like to do this because I am using vendoring in Go 1.6 (via <a href=\"https://glide.sh\" rel=\"nofollow\">Glide</a>) and a majority of my build times are spent fetching the same dependencies as the previous build.</p>\n\n<p>If there is a way of forcing Docker to cache a directory, is there any way to let Docker know when to invalidate the cache (ex., when <code>glide.lock</code> changes)?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1467840394, "post_id": 38234029, "comment_id": 63889735, "body": "Pretty sure you gotta write one yourself. It&#39;s pretty easy basic idea would be; get the ASCII value, if it&#39;s upper case subtract 26, if it&#39;s lower case add the same."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467841223, "post_id": 38234029, "comment_id": 63890078, "body": "unless of course you have non-ascii characters. which you should expect to be able to handle: &quot;\u041f\u0440\u0438\u0432\u0456\u0442, \u0421\u0432\u0456\u0442!&quot; isn&#39;t going to work that way"}], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1467856705, "post_id": 38234154, "comment_id": 63894470, "body": "Damn it @JimB, you&#39;re catching up to me, stop that!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467868203, "post_id": 38234154, "comment_id": 63896815, "body": "Nice, elegant solution."}, {"owner": {"reputation": 137, "user_id": 2976055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/644cb36ab971be9be687b2f79a89eefa?s=128&d=identicon&r=PG", "display_name": "Arthmost", "link": "https://stackoverflow.com/users/2976055/arthmost"}, "edited": false, "score": 0, "creation_date": 1467882484, "post_id": 38234154, "comment_id": 63904007, "body": "That looks really classy and elegant! Thank you. That will take me some time to wrap my head around though."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 9, "last_activity_date": 1467840859, "creation_date": 1467840859, "answer_id": 38234154, "question_id": 38234029, "link": "https://stackoverflow.com/questions/38234029/how-do-i-reverse-a-case-of-each-letter-in-a-string/38234154#38234154", "title": "How do I reverse a case of each letter in a string?", "body": "<p>You need to write one yourself, but the building blocks are already in the standard library:</p>\n\n<pre><code>func swapCase(s string) string {\n    return strings.Map(func(r rune) rune {\n        switch {\n        case unicode.IsLower(r):\n            return unicode.ToUpper(r)\n        case unicode.IsUpper(r):\n            return unicode.ToLower(r)\n        }\n        return r\n    }, s)\n}\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 2976055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/644cb36ab971be9be687b2f79a89eefa?s=128&d=identicon&r=PG", "display_name": "Arthmost", "link": "https://stackoverflow.com/users/2976055/arthmost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 38234154, "answer_count": 1, "score": 1, "last_activity_date": 1467840859, "creation_date": 1467840303, "question_id": 38234029, "link": "https://stackoverflow.com/questions/38234029/how-do-i-reverse-a-case-of-each-letter-in-a-string", "title": "How do I reverse a case of each letter in a string?", "body": "<p>I know about ToUpper and ToLower from strings package but obviously they won't help here. Is there a built-in function or do I have to write one myself?</p>\n"}, {"tags": ["go", "casting", "panic", "strconv"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1467834743, "post_id": 38232518, "comment_id": 63886883, "body": "In regards to your edit: no where in the docs is 64 used for a base; it is only ever used as a bit size."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1467840046, "post_id": 38232518, "comment_id": 63889592, "body": "If you want base64, as in the way to represent binary data in non-binary-safe environments, <code>encoding&#47;base64</code> gives you that."}, {"owner": {"reputation": 639, "user_id": 2062073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93d988e82aa789487c174bb4d31ff350?s=128&d=identicon&r=PG", "display_name": "Ahti Ahde", "link": "https://stackoverflow.com/users/2062073/ahti-ahde"}, "edited": false, "score": 0, "creation_date": 1467963195, "post_id": 38232518, "comment_id": 63942393, "body": "Is it bit size also for the float in the example above? I edited the question more to make it better obvious, to which part of the documentation I was refering to. Sorry for the confusion."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 4, "last_activity_date": 1467834459, "last_edit_date": 1592644375, "creation_date": 1467834459, "answer_id": 38232558, "question_id": 38232518, "link": "https://stackoverflow.com/questions/38232518/why-i-do-get-go-error-panic-strconv-illegal-appendint-formatint-base/38232558#38232558", "title": "Why I do get Go error &quot;panic: strconv: illegal AppendInt/FormatInt base&quot;", "body": "<p>Base 64 is not supported, as specified in <a href=\"https://godoc.org/strconv#FormatUint\" rel=\"nofollow noreferrer\">the documentation</a>:</p>\n<blockquote>\n<pre><code>func FormatUint(i uint64, base int) string\n</code></pre>\n<p>FormatUint returns the string representation of i in the given base, for 2 &lt;= base &lt;= 36.</p>\n</blockquote>\n"}], "owner": {"reputation": 639, "user_id": 2062073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93d988e82aa789487c174bb4d31ff350?s=128&d=identicon&r=PG", "display_name": "Ahti Ahde", "link": "https://stackoverflow.com/users/2062073/ahti-ahde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1680, "favorite_count": 0, "accepted_answer_id": 38232558, "answer_count": 1, "score": 0, "last_activity_date": 1467963497, "creation_date": 1467834318, "last_edit_date": 1467963497, "question_id": 38232518, "link": "https://stackoverflow.com/questions/38232518/why-i-do-get-go-error-panic-strconv-illegal-appendint-formatint-base", "title": "Why I do get Go error &quot;panic: strconv: illegal AppendInt/FormatInt base&quot;", "body": "<p>I can't figure out, why I do get this error message during run time. It triggers even with the most simple one-liner:\n<code>strconv.FormatUint(uint64(123), 64)</code></p>\n\n<p>Have I understood something very wrong here? The code compiles just fine.</p>\n\n<p>EDIT: Found a solution (as later pointed out by Tim Cooper). I think <a href=\"https://godoc.org/strconv#pkg-overview\" rel=\"nofollow\">the examples in the documentation</a> are confusing:</p>\n\n<pre><code>s := strconv.FormatBool(true)\ns := strconv.FormatFloat(3.1415, 'E', -1, 64)\ns := strconv.FormatInt(-42, 16)\ns := strconv.FormatUint(42, 16)\n</code></pre>\n\n<p>When you only use base 64 and 16 in the examples, it is quite easy to make the wrong conclusion. However, now that I know what was wrong, the error message makes much more sense.</p>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1467835479, "post_id": 38230997, "comment_id": 63887259, "body": "Out of curiosity: do you also expect a programming language to have a predefined type for a triple -- a tuple of three elements? Four? <code>N</code>? What is so special about <i>a pair?</i>"}, {"owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "edited": false, "score": 1, "creation_date": 1469012548, "post_id": 38230997, "comment_id": 64361022, "body": "<a href=\"https://github.com/golang/go/issues/3117\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/3117</a>"}], "answers": [{"tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": false, "score": 3, "last_activity_date": 1467829337, "creation_date": 1467829337, "answer_id": 38231102, "question_id": 38230997, "link": "https://stackoverflow.com/questions/38230997/can-not-assign-to-pair-in-a-map/38231102#38231102", "title": "Can not assign to pair in a map", "body": "<p>That's not legal for reasons described <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/6IaQ1H8ewMk\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>Querying a map give a copy of the stored item, so there is no point assigning to it. </p>\n</blockquote>\n\n<p>The recommended workaround is:</p>\n\n<pre><code>var xxoo = dictionary[\"xxoo\"]\nxxoo.b = 5.0\ndictionary[\"xxoo\"] = xxoo\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "is_accepted": false, "score": 2, "last_activity_date": 1467829689, "creation_date": 1467829689, "answer_id": 38231207, "question_id": 38230997, "link": "https://stackoverflow.com/questions/38230997/can-not-assign-to-pair-in-a-map/38231207#38231207", "title": "Can not assign to pair in a map", "body": "<p>It's forbidden as said in Thomas' answer. Use pointers instead.</p>\n\n<pre><code>dict := map[string]*pair{}\ndict[\"xxoo\"] = &amp;pair{5.0, 2.0}\nfmt.Println(dict[\"xxoo\"].b) // 2\ndict[\"xxoo\"].b = 5.0\nfmt.Println(dict[\"xxoo\"].b) // 5\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/nEr_WrQOly\" rel=\"nofollow\">https://play.golang.org/p/nEr_WrQOly</a></p>\n"}, {"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1467835368, "post_id": 38231408, "comment_id": 63887214, "body": "To possibly make this answer a bit better: the values stored in a map are not addressable because the map implementations are free to move the values they store in memory in arbitrary ways. This is required for many approaches to implementing maps effectively.  If values may move in memory, you can&#39;t return a pointer to such a value."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1467836843, "post_id": 38231408, "comment_id": 63887979, "body": "@kostix: I was trying to avoid the map implementation details, which are another toppic, but I guess it doesn&#39;t hurt to mention it."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 6, "last_activity_date": 1467837004, "last_edit_date": 1467837004, "creation_date": 1467830287, "answer_id": 38231408, "question_id": 38230997, "link": "https://stackoverflow.com/questions/38230997/can-not-assign-to-pair-in-a-map/38231408#38231408", "title": "Can not assign to pair in a map", "body": "<p>In order to assign a value to a struct field, that struct must be \"addressable\". Addressability is covered in the <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow\">\"Address Operators\"</a> section of the language specification.</p>\n\n<p>Map values aren't addressable to leave map implementations the freedom to move values around in memory as needed. Because map values aren't addressable, you you can't use a selector (<code>.</code>) operator on the value to assign to the struct field. If you use a pointer type as the map value, i.e. <code>map[string]*pair</code>, the pointer indirection satisfies the addressability requirement. </p>\n\n<pre><code>dict := make(map[string]*pair)\ndict[\"xxoo\"] = &amp;pair{5.0, 2.0}\ndict[\"xxoo\"].b = 5.0\n</code></pre>\n\n<p>If you are working with values, you need to copy the existing value via assignment, or supply an entirely new value:</p>\n\n<pre><code>dict := make(map[string]pair)\ndict[\"xxoo\"] = pair{5.0, 2.0}\n\n// copy the value, change one field, then reassign\np := dict[\"xxoo\"]\np.b = 5.0\ndict[\"xxoo\"] = p\n\n// or replace the value in full\ndict[\"xxoo\"] = pair{5.0, 5.0}\n</code></pre>\n"}], "owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1467992485, "creation_date": 1467828971, "last_edit_date": 1467992485, "question_id": 38230997, "link": "https://stackoverflow.com/questions/38230997/can-not-assign-to-pair-in-a-map", "title": "Can not assign to pair in a map", "body": "<p>I have the following pair defined in my go program</p>\n\n<pre><code>type pair struct {\n  a float64\n  b float64\n}\n</code></pre>\n\n<p>Then I create a map:</p>\n\n<pre><code>dictionary map[string]pair\n</code></pre>\n\n<p>I first add one element:</p>\n\n<pre><code>dictionary[\"xxoo\"] = pair{5.0, 2.0}\n</code></pre>\n\n<p>Then I am trying to do this:</p>\n\n<pre><code>dictionary[\"xxoo\"].b = 5.0  // try to change from 2.0 to 5.0\n</code></pre>\n\n<p>The last line doesn't compile and it said \"can not assign to it\"</p>\n\n<p>I want to know what's the reason for this?</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467826008, "post_id": 38229923, "comment_id": 63881941, "body": "As for how many goroutines, if you&#39;re requirement is performance you need to profile and see."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1467828808, "post_id": 38229923, "comment_id": 63883500, "body": "Goroutines are relatively cheap. See <a href=\"http://stackoverflow.com/questions/8509152/max-number-of-goroutines\" title=\"max number of goroutines\">stackoverflow.com/questions/8509152/max-number-of-goroutines</a>&zwnj;&#8203;."}], "answers": [{"comments": [{"owner": {"reputation": 13300, "user_id": 2521225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39c72c6dc4d20a8e736f8ed0d08fa646?s=128&d=identicon&r=PG&f=1", "display_name": "samol", "link": "https://stackoverflow.com/users/2521225/samol"}, "edited": false, "score": 0, "creation_date": 1467827094, "post_id": 38230203, "comment_id": 63882563, "body": "I had a slight adjustment to the question that it is possible to skip items"}, {"owner": {"reputation": 13300, "user_id": 2521225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39c72c6dc4d20a8e736f8ed0d08fa646?s=128&d=identicon&r=PG&f=1", "display_name": "samol", "link": "https://stackoverflow.com/users/2521225/samol"}, "edited": false, "score": 0, "creation_date": 1467827311, "post_id": 38230203, "comment_id": 63882692, "body": "Also can you adjust your solution with error handling. How do I return error out of the outer function inside the goroutine function?"}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": false, "score": 1, "last_activity_date": 1467826390, "creation_date": 1467826390, "answer_id": 38230203, "question_id": 38229923, "link": "https://stackoverflow.com/questions/38229923/concurrent-deserialization-over-a-slice-while-preserving-ordering/38230203#38230203", "title": "Concurrent deserialization over a slice while preserving ordering", "body": "<p>You can create the output slice beforehand with the required size (you know the length of <code>serializeds</code> beforehand) and then fill this slice with the mapped values from within the Go routines and their indices from the original slice:</p>\n\n<pre><code>wait := new(sync.WaitGroup)\nobjs := make([]YourStructType, len(serializeds))\n\nfor i, s := range serializeds {\n    wait.Add(1)\n    go func(j int) {\n        defer wait.Done()\n        deserializedObject, err := doDeserialization(s)\n        if err != nil {\n            // add error handling here\n        }\n        objs[j] = deserializedObject\n    }(j)\n}\n\nwait.Wait()\n</code></pre>\n\n<p>Regarding your side question: This warrants a thorough profiling of your application with both implementations. Intuitively, I'd guess that Go's goroutine scheduler should be efficient enough to handle this without much overhead, and that you should probably not bother with the additional complexity of a goroutine worker pool. However, without profiling, that's guesswork at best.</p>\n"}, {"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 0, "last_activity_date": 1467878174, "last_edit_date": 1467878174, "creation_date": 1467838589, "answer_id": 38233643, "question_id": 38229923, "link": "https://stackoverflow.com/questions/38229923/concurrent-deserialization-over-a-slice-while-preserving-ordering/38233643#38233643", "title": "Concurrent deserialization over a slice while preserving ordering", "body": "<p>Your problem requires a concurrent processing and then a sequential read. @helmbert's solution is simple and elegant enough to solve your problem with a bit more tweak.</p>\n\n<p>However, you can also perform a controlled concurrent execution and then a sequential read using the below procedure. It is not very clean but I have used something like this before and it works fine. (Please note that the code below almost certainly has bugs, so be careful).</p>\n\n<pre><code>objs := []*MyStruct{}\n\n// concurrency factor. This controlls the number of\n// goroutines you'll be running. (note that number of goroutines\n// can be cf+1 also if len(serializeds) % cf != 0.\ncf := 3\n\n// length of sub slice each goroutine will be procesing\nsubSliceLen := len(serializeds) / cf // cf must be &gt; len\n\n// make a channel to get error from goroutines\nerrorCh := make(chan error)\n\n// chans will store the created channels in proper order\nchans := make([]chan *MyStruct)\n\n// quit channel to signal currently executing goroutines to stop\nquit := make([]chan struct{})\n\n// loop to only read a part of the original input slice\nfor i := 0; i &lt;= len(serializeds); i += subSliceLen {\n    // setup slice sub section to be processed. may be bugged!!\n    hi := subSliceLen\n    if i + hi &gt;= len(serializeds) {\n        hi = len(serializeds)\n    }\n\n    // create a channel for the goroutine that will handle\n    // input slice values from i to hi. It is important to make\n    // these channels buffered otherwise there will be no possibility\n    // of parallel execution.\n    ch := make(chan *MyStruct{}, subSliceLen)\n    chans = append(chans, ch)\n\n    go func(ch chan *MyStruct, i, hi int) {\n        defer close(ch)\n        for _, s := range serialzed[i:hi] {\n            deserializedObject, ok, err := doDeserialization(s)\n            if err != nil {\n                // if any err, abandon the whole thing\n                errorCh &lt;- err\n                // signal other goroutines that they should\n                // stop the work and return\n                close(quit)\n                return\n            }\n            if !ok {\n                continue\n            }\n            select {\n            // this is required in order to receive the signal that\n            // some other goroutine has encountered an error and that\n            // this goroutine should also cleanly return. without this\n            // there will be a goroutine leak.\n            case &lt;- quit:\n                return\n            case ch &lt;- deserializedObject:\n                // do nothing\n            }\n        }\n    }(ch, i, hi)\n}\n</code></pre>\n\n<p>Now <code>chans</code> has all the channels that are now receiving the processed data. We can now start reading sequentially from them.</p>\n\n<pre><code>i := 0\nfor {\n    select {\n    case v, ok := &lt;-chans[i]:\n        if !ok {\n             // chans[i] is closed and has been read completely\n            if i &gt;= len(chans) {\n                break\n            }\n            // proceed to the next channel\n            i++\n        }\n        objs = append(objs, v)\n    case &lt;- err:\n        // handle error, close all\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 13300, "user_id": 2521225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39c72c6dc4d20a8e736f8ed0d08fa646?s=128&d=identicon&r=PG&f=1", "display_name": "samol", "link": "https://stackoverflow.com/users/2521225/samol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1568185059, "creation_date": 1467825449, "last_edit_date": 1568185059, "question_id": 38229923, "link": "https://stackoverflow.com/questions/38229923/concurrent-deserialization-over-a-slice-while-preserving-ordering", "title": "Concurrent deserialization over a slice while preserving ordering", "body": "<p>Current code structure:</p>\n\n<pre><code>func doStuff(serializeds []string) ([]*MyStruct, error) {\n    objs := []*MyStruct{}\n    for _, s := range serializeds {\n\n        deserializedObject, ok, err := doDeserialization(s)\n        if err != nil {\n           // if any err, abandon the whole thing\n           return nil, err\n        }\n\n        if !ok {\n          continue\n        }\n        objs = append(objs, deserializedObject)\n    }\n    return objs, nil\n}\n</code></pre>\n\n<p><code>serializeds</code> typically ranges from 200-1000 serialized strings at a time. And it takes approx 0.5-1ms to <code>doDeserialization</code> on each of them.</p>\n\n<p>Goals:</p>\n\n<ol>\n<li>Deserialization concurrently and do it as fast as possible.</li>\n<li>I need to preserve the ordering of the original slice</li>\n<li>Implement this using channels for that it is easier to read</li>\n</ol>\n\n<p>Side question: is it ok to spin up one goroutine per serialized string or is it more efficient to only have a limited number of goroutines (e.g. 50 goroutines)</p>\n"}, {"tags": ["go", "stdout", "stderr"], "comments": [{"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "edited": false, "score": 1, "creation_date": 1467826574, "post_id": 38229584, "comment_id": 63882263, "body": "Have you actually waited the 1000 seconds for <code>&#47;tmp&#47;stdout</code> to finish? Note that <code>cmd.Wait()</code> will block your program until the command has finished to run."}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1467834138, "post_id": 38229584, "comment_id": 63886515, "body": "Try using go-logging <a href=\"http://stackoverflow.com/questions/38208608/go-logging-to-multiple-output/38208892#38208892\" title=\"go logging to multiple output\">stackoverflow.com/questions/38208608/&hellip;</a>"}, {"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1467840429, "post_id": 38229584, "comment_id": 63889754, "body": "Try to combine <code>os.Stdout</code> with <code>fmt.Fprintf</code>, to keep it simple, but if you want a more professional solution, than use logging as already suggested."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1467841529, "post_id": 38229584, "comment_id": 63890225, "body": "have you considered <code>go run main.go &amp;&gt; out+err.txt</code>? edit nvm i didnt realize you were invoking the child process from go"}], "answers": [{"comments": [{"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1467881457, "post_id": 38234237, "comment_id": 63903373, "body": "Thanks, but I think I need to use gorutines, if I would like to handle without need to wait, in case I would like for example to pre parse the output instead of sending it directly to a file, something like a logger."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 1, "creation_date": 1467883000, "post_id": 38234237, "comment_id": 63904350, "body": "afaik, in go, you ll have to create a writer and do a writer of writer. cmd.Stdout-&gt;write-&gt;parser-&gt;write-&gt;os.Stdout. Regarding the goroutines, just do a <code>go func(done chan){}</code>. There are some patterns about that."}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": true, "score": 3, "last_activity_date": 1467841209, "creation_date": 1467841209, "answer_id": 38234237, "question_id": 38229584, "link": "https://stackoverflow.com/questions/38229584/how-to-properly-capture-all-stdout-stderr/38234237#38234237", "title": "how to properly capture all stdout/stderr", "body": "<blockquote>\n  <p>but in case I would like to get the output in realtime</p>\n</blockquote>\n\n<p>One way to do that is to attach <code>os.Stdout</code> to <code>cmd.Stdout</code></p>\n\n<pre><code>oCmd := exec.Command(bin, cmdArgs...)\noCmd.Stdout = os.Stdout\noCmd.Stderr = os.Stderr\n\nerr := oCmd.Run()\n</code></pre>\n\n<p>Then you can use a File instead with <code>f,_ := os.Create(\"file\")</code>.</p>\n\n<p>If you want to write it to both a file and to the terminal at same time, i suspect (I have not done that yet), that you need to use <code>io.Mutiwriters</code></p>\n\n<pre><code>f, _ := os.Create(\"file\")\ncmd.Stdout = io.MultiWriter(os.Stdout, f)\n</code></pre>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2485, "favorite_count": 0, "accepted_answer_id": 38234237, "answer_count": 1, "score": 2, "last_activity_date": 1467841209, "creation_date": 1467824357, "last_edit_date": 1467839403, "question_id": 38229584, "link": "https://stackoverflow.com/questions/38229584/how-to-properly-capture-all-stdout-stderr", "title": "how to properly capture all stdout/stderr", "body": "<p>I want to capture and save to a file all the <a href=\"https://en.wikipedia.org/wiki/Standard_streams#Standard_output_.28stdout.29\" rel=\"nofollow\">stdout</a> and <a href=\"https://en.wikipedia.org/wiki/Standard_streams#Standard_error_.28stderr.29\" rel=\"nofollow\">stderr</a></p>\n\n<p>For testing purposes I am printing only what I capture using this:</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"bufio\"\n    \"bytes\"\n    \"fmt\"\n    \"io\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"/tmp/stdout\")\n    stdout := new(bytes.Buffer)\n    stderr := new(bytes.Buffer)\n\n    cmd.Stdout = stdout\n    cmd.Stderr = stderr\n\n    if err := cmd.Start(); err != nil {\n        panic(err)\n    }\n\n    if err := cmd.Wait(); err != nil {\n        panic(err)\n    }\n\n    in := bufio.NewScanner(io.MultiReader(stdout, stderr))\n    for in.Scan() {\n        fmt.Println(in.Text())\n    }\n\n}\n</code></pre>\n\n<p>The <strong>/tmp/stdout</strong> command can be build using this code:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n\n    for i := 1; i &lt; 1000; i++ {\n        if i%3 == 0 {\n            fmt.Fprintf(os.Stderr, \"STDERR i: %d\\n\", i)\n        } else {\n            fmt.Printf(\"STDOUT i: %d\\n\", i)\n        }\n        time.Sleep(1 * time.Second)\n    }\n\n}\n</code></pre>\n\n<p>For some reason I am not been available to capture anything from the  output, If I run the <code>/tmp/stdout</code> command I get this:</p>\n\n<pre><code>$ /tmp/stdout \nSTDOUT i: 1\nSTDOUT i: 2\nSTDERR i: 3\nSTDOUT i: 4\nSTDOUT i: 5\nSTDERR i: 6\nSTDOUT i: 7\n</code></pre>\n\n<p>I was expecting to be available to get the same output while calling it from go with the previous code, the strange thing is that if I change to command to be something like <code>id</code>, <code>whoami</code> <code>uname</code> I do get the result and can printed, therefore wondering what could be wrong.</p>\n\n<p>Any ideas ?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Found that I have to wait the program to finish, as suggested in the comments in order to get the output, but in case I would like to get the output in realtime how could I achieve this, what could be the best way of doing it, either <code>io.Copy</code> an <code>os.Pipe</code>, etc ?</p>\n"}, {"tags": ["eclipse", "go", "goclipse"], "comments": [{"owner": {"reputation": 146, "user_id": 1133067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ks1Sa.jpg?s=128&g=1", "display_name": "PapaBuduiit", "link": "https://stackoverflow.com/users/1133067/papabuduiit"}, "edited": false, "score": 0, "creation_date": 1467899521, "post_id": 38228187, "comment_id": 63915723, "body": "I have a very similar problem (in Eclipse Mars).  The only GoClipse version available is 0.16.1.  Missing dependency:  &#39;org.eclipse.cdt.gnu.dsf.feature.group [9.0.0,10.0.0)&#39; but it could not be found"}], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2156718, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93c82b05997424df0edd2deb69b676e2?s=128&d=identicon&r=PG", "display_name": "Ankur Garg", "link": "https://stackoverflow.com/users/2156718/ankur-garg"}, "edited": false, "score": 0, "creation_date": 1467823513, "post_id": 38228882, "comment_id": 63880452, "body": "I already tried this but it gaves the same error :(   What version of eclipse do you use?"}, {"owner": {"reputation": 310, "user_id": 2178075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QBKQ.jpg?s=128&g=1", "display_name": "peiiion", "link": "https://stackoverflow.com/users/2178075/peiiion"}, "reply_to_user": {"reputation": 1963, "user_id": 2156718, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93c82b05997424df0edd2deb69b676e2?s=128&d=identicon&r=PG", "display_name": "Ankur Garg", "link": "https://stackoverflow.com/users/2156718/ankur-garg"}, "edited": false, "score": 0, "creation_date": 1477930837, "post_id": 38228882, "comment_id": 67946908, "body": "Eclipse Platform\t4.5.2.M20160212-1500\torg.eclipse.platform.ide\tEclip&zwnj;&#8203;se.org"}], "tags": [], "owner": {"reputation": 310, "user_id": 2178075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QBKQ.jpg?s=128&g=1", "display_name": "peiiion", "link": "https://stackoverflow.com/users/2178075/peiiion"}, "is_accepted": false, "score": -1, "last_activity_date": 1467821966, "creation_date": 1467821966, "answer_id": 38228882, "question_id": 38228187, "link": "https://stackoverflow.com/questions/38228187/unable-to-install-goclipse/38228882#38228882", "title": "Unable to install GoClipse", "body": "<p>I always install Eclipse plugins through the \"Install new software\" feature instead of the market place. </p>\n\n<p>With Goclipse this wasn't the exception and it worked just fine for me by resolving all dependencies. </p>\n\n<p>You can follow this steps (from the Goclipse docs at <a href=\"https://github.com/GoClipse/goclipse/blob/latest/documentation/Installation.md#installation\" rel=\"nofollow\">https://github.com/GoClipse/goclipse/blob/latest/documentation/Installation.md#installation</a>)</p>\n\n<ul>\n<li>Start Eclipse, go to Help -> Install New Software...</li>\n<li>Click the Add... button, then enter the Update Site URL: <a href=\"http://goclipse.github.io/releases/\" rel=\"nofollow\">http://goclipse.github.io/releases/</a> in the Location field, click OK.</li>\n<li>Select the recently added update site in the Work with: dropdown. Type GoClipse in the filter box. Now the Goclipse feature should appear below.\nSelect the GoClipse feature, and complete the wizard.</li>\n<li>Dependencies such as CDT will automatically be added during installation.</li>\n<li>Restart Eclipse.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1357, "user_id": 393898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b55a355cb66fff949fe85c45ea4897?s=128&d=identicon&r=PG", "display_name": "BrunoMedeiros", "link": "https://stackoverflow.com/users/393898/brunomedeiros"}, "is_accepted": true, "score": 4, "last_activity_date": 1467829944, "creation_date": 1467829944, "answer_id": 38231291, "question_id": 38228187, "link": "https://stackoverflow.com/questions/38228187/unable-to-install-goclipse/38231291#38231291", "title": "Unable to install GoClipse", "body": "<p><strong>'org.eclipse.platform.feature.group [4.5.0,5.0.0)' but it could not be found.</strong></p>\n\n<p>You need Eclipse Mars (4.5) or Neon (4.6) for GoClipse. (Note: for GoClipse 0.16.0, if you download an Eclipse Neon package make sure it does not contain CDT already, or there will be a conflict with CDT 9.0 on installation. The next GoClipse version will have all this fixed.)</p>\n"}], "owner": {"reputation": 1963, "user_id": 2156718, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93c82b05997424df0edd2deb69b676e2?s=128&d=identicon&r=PG", "display_name": "Ankur Garg", "link": "https://stackoverflow.com/users/2156718/ankur-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2124, "favorite_count": 0, "accepted_answer_id": 38231291, "answer_count": 2, "score": 3, "last_activity_date": 1467829944, "creation_date": 1467819937, "question_id": 38228187, "link": "https://stackoverflow.com/questions/38228187/unable-to-install-goclipse", "title": "Unable to install GoClipse", "body": "<p>I am trying to install Goclipse to use my STS for building go Projects .</p>\n\n<p>I am trying to install the plugin from eclipse marketplace but getting this error</p>\n\n<p><strong>Cannot complete the install because one or more required items could not be found.\n  Software being installed: GoClipse 0.16.0.v201606221240 (goclipse_feature.feature.group 0.16.0.v201606221240)\n  Missing requirement: GoClipse 0.16.0.v201606221240 (goclipse_feature.feature.group 0.16.0.v201606221240) requires 'org.eclipse.platform.feature.group [4.5.0,5.0.0)' but it could not be found</strong></p>\n\n<p>Can anyone suggest how to fix this ?</p>\n\n<p>Help is appreciated </p>\n"}, {"tags": ["go", "rethinkdb"], "comments": [{"owner": {"reputation": 2867, "user_id": 1076057, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/h2k2g.jpg?s=128&g=1", "display_name": "dalanmiller", "link": "https://stackoverflow.com/users/1076057/dalanmiller"}, "edited": false, "score": 1, "creation_date": 1468018066, "post_id": 38228175, "comment_id": 63972057, "body": "you should mark mlucy&#39;s answer as correct :D"}], "answers": [{"comments": [{"owner": {"reputation": 631, "user_id": 2093346, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/62bd73ee4a132a0cd3d1496598fff329?s=128&d=identicon&r=PG", "display_name": "Quarktum", "link": "https://stackoverflow.com/users/2093346/quarktum"}, "edited": false, "score": 0, "creation_date": 1467915303, "post_id": 38233541, "comment_id": 63926115, "body": "Thanks, the other answer is also correct, but it improved the performance from 2 update/s to 20 update/s. I wrote 1000 routines which infinitely update the random row with the query I commented in the other answer. Now yes, the iterator of changes prints 1000 change/s approximately."}], "tags": [], "owner": {"reputation": 554, "user_id": 595810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3772bef568ee12d860832bb2fa113745?s=128&d=identicon&r=PG", "display_name": "Daniel Cannon", "link": "https://stackoverflow.com/users/595810/daniel-cannon"}, "is_accepted": false, "score": 0, "last_activity_date": 1467838129, "creation_date": 1467838129, "answer_id": 38233541, "question_id": 38228175, "link": "https://stackoverflow.com/questions/38228175/why-is-rethinkdb-very-slow/38233541#38233541", "title": "Why is RethinkDB very slow?", "body": "<p>Im not sure why it is quite that slow, it could be because by default each query blocks until the write has been completely flushed. I would first add some kind of instrumentation to see which operation is being so slow. There are also a couple of ways that you can improve the performance:</p>\n\n<ol>\n<li><p>Set the <code>Durability</code> of the write using <code>UpdateOpts</code></p>\n\n<pre><code>_, err = r.Table(\"scores\").Update(scoreentry, r.UpdateOpts{\n    Durability: \"soft\",\n}).RunWrite(session)\n</code></pre></li>\n<li><p>Execute each query in a goroutine to allow your code to execute multiple queries in parallel (you may need to use a pool of goroutines instead but this code is just a simplified example)</p>\n\n<pre><code>for {\n    go func() {\n        var scoreentry ScoreEntry\n        pl := rand.Intn(1000)\n        sc := rand.Intn(6) - 2\n        res, err := r.Table(\"scores\").Get(strconv.Itoa(pl)).Run(session)\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        err = res.One(&amp;scoreentry)\n        scoreentry.Score = scoreentry.Score + sc\n        _, err = r.Table(\"scores\").Update(scoreentry).RunWrite(session)\n    }()\n}\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 631, "user_id": 2093346, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/62bd73ee4a132a0cd3d1496598fff329?s=128&d=identicon&r=PG", "display_name": "Quarktum", "link": "https://stackoverflow.com/users/2093346/quarktum"}, "edited": false, "score": 0, "creation_date": 1467904103, "post_id": 38239517, "comment_id": 63919302, "body": "As you say, merging the two queries into one made the performance scale! <code>r.Table(&quot;scores&quot;).Get(strconv.Itoa(pl)).Update(map[string]in&zwnj;&#8203;terface{}{&quot;Score&quot;: r.Row.Field(&quot;Score&quot;).Add(sc)}).RunWrite(session)</code>"}], "tags": [], "owner": {"reputation": 5046, "user_id": 3200554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a018f6e3757b55a3df0a735acc199b4?s=128&d=identicon&r=PG&f=1", "display_name": "mlucy", "link": "https://stackoverflow.com/users/3200554/mlucy"}, "is_accepted": false, "score": 4, "last_activity_date": 1467875540, "creation_date": 1467875540, "answer_id": 38239517, "question_id": 38228175, "link": "https://stackoverflow.com/questions/38228175/why-is-rethinkdb-very-slow/38239517#38239517", "title": "Why is RethinkDB very slow?", "body": "<p>This code:</p>\n\n<pre><code>r.Table(\"scores\").Update(scoreentry).RunWrite(session)\n</code></pre>\n\n<p>Probably doesn't do what you think it does.  This attempts to update every document in the table by merging <code>scoreentry</code> into it.  This is why the RethinkDB console is showing so many writes per second: every time you run that query it's resulting in thousands of writes.</p>\n\n<p>Usually you want to update documents inside of ReQL, like so:</p>\n\n<pre><code>r.Table('scores').Get(strconv.Itoa(pl)).Update(func (row Term) interface{} {\n  return map[string]interface{}{\"Score\": row.GetField('Score').Add(sc)};\n})\n</code></pre>\n\n<p>If you need to do the update in Go code, though, you can replace just that one document like so:</p>\n\n<pre><code>r.Table('scores').Get(strconv.Itoa(pl)).Replace(scoreentry)\n</code></pre>\n"}], "owner": {"reputation": 631, "user_id": 2093346, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/62bd73ee4a132a0cd3d1496598fff329?s=128&d=identicon&r=PG", "display_name": "Quarktum", "link": "https://stackoverflow.com/users/2093346/quarktum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1467875540, "creation_date": 1467819914, "question_id": 38228175, "link": "https://stackoverflow.com/questions/38228175/why-is-rethinkdb-very-slow", "title": "Why is RethinkDB very slow?", "body": "<p>I am getting started with RethinkDB, I have never used it before. I give it a try together with <a href=\"https://github.com/dancannon/gorethink\" rel=\"nofollow\">Gorethink</a> following this <a href=\"https://www.compose.io/articles/go-rethinkdb-and-changefeeds-part-1/\" rel=\"nofollow\">tutorial</a>.</p>\n\n<p>To sum up this tutorial, there are two programs:</p>\n\n<p>The first one updates entries infinitely.</p>\n\n<pre><code>for {\n    var scoreentry ScoreEntry\n    pl := rand.Intn(1000)\n    sc := rand.Intn(6) - 2\n    res, err := r.Table(\"scores\").Get(strconv.Itoa(pl)).Run(session)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    err = res.One(&amp;scoreentry)\n    scoreentry.Score = scoreentry.Score + sc\n    _, err = r.Table(\"scores\").Update(scoreentry).RunWrite(session)\n}\n</code></pre>\n\n<p>And the second one, receives this changes and logs them.</p>\n\n<pre><code>res, err := r.Table(\"scores\").Changes().Run(session)\n\nvar value interface{}\n\nif err != nil {\n    log.Fatalln(err)\n}\nfor res.Next(&amp;value) {\n    fmt.Println(value)\n}\n</code></pre>\n\n<p>In the statistics that RethinkDB shows, I can see that there are 1.5K reads and writes per second. But in the console of the second program, I see 1 or 2 changes per second approximately.</p>\n\n<p>Why does this occur? Am I missing something?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "edited": false, "score": 0, "creation_date": 1467815742, "post_id": 38226450, "comment_id": 63875325, "body": "What behavior are you experiencing that doesn&#39;t seem right?  Errors?  Unintended behavior?  On the surface, I don&#39;t see anything wrong."}], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 1, "last_activity_date": 1467815843, "creation_date": 1467815843, "answer_id": 38226777, "question_id": 38226450, "link": "https://stackoverflow.com/questions/38226450/golang-add-item-and-return-new-struct-with-random-string/38226777#38226777", "title": "Golang, add item and return new struct with random string", "body": "<p>I think you might be creating your struct incorrectly. Could you perhaps give this a try?</p>\n\n<pre><code>func RepoCreateActivity(t Activity) ActivityReturn {\n    activities = append(activities, t)\n    b := ActivityReturn{Cgid: RandomString(10)} // remove parens\n    return b\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "is_accepted": false, "score": 1, "last_activity_date": 1467816274, "creation_date": 1467816274, "answer_id": 38226934, "question_id": 38226450, "link": "https://stackoverflow.com/questions/38226450/golang-add-item-and-return-new-struct-with-random-string/38226934#38226934", "title": "Golang, add item and return new struct with random string", "body": "<p>If you are only worried about the output in that manner, then following will work:</p>\n\n<pre><code>func RepoCreateActivity(t Activity) string {\nactivities = append(activities, t)\nb := ActivityReturn{Cgid: RandomString(10)}\ntemp,_:=json.Marshal(b)\nreturn string(temp)\n}\n</code></pre>\n\n<p>Note that output in this case is string.</p>\n"}], "owner": {"reputation": 11716, "user_id": 3201696, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/14f9684ddc31ba13ddefba05e2f2ebce?s=128&d=identicon&r=PG&f=1", "display_name": "ajmajmajma", "link": "https://stackoverflow.com/users/3201696/ajmajmajma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 38226777, "answer_count": 2, "score": 0, "last_activity_date": 1467816274, "creation_date": 1467814988, "question_id": 38226450, "link": "https://stackoverflow.com/questions/38226450/golang-add-item-and-return-new-struct-with-random-string", "title": "Golang, add item and return new struct with random string", "body": "<p>I am trying to figure out how to set up a basic endpoint in golang. I have a call that takes a payload and adds it to a list (in memory right now). Previously it was just returning the exact payload it was getting. I would like it to return a new json object with a randomly generated string. Here it what it looked like initially :  </p>\n\n<p>in my repo.go</p>\n\n<pre><code>func RepoCreateActivity(t Activity) Activity {\n    activities = append(activities, t)\n    return t\n} \n</code></pre>\n\n<p>and this works fine. However I would like to return a different object with randomly generated string, here is what I have tried</p>\n\n<p>in my repo.go (the randomstring function is from a bit of googling - <a href=\"https://siongui.github.io/2015/04/13/go-generate-random-string/\" rel=\"nofollow\">https://siongui.github.io/2015/04/13/go-generate-random-string/</a> )</p>\n\n<pre><code> func RandomString(strlen int) string {\n    rand.Seed(time.Now().UTC().UnixNano())\n    const chars = \"abcdefghijklmnopqrstuvwxyz0123456789\"\n    result := make([]byte, strlen)\n    for i := 0; i &lt; strlen; i++ {\n        result[i] = chars[rand.Intn(len(chars))]\n    }\n    return string(result)\n}\n\nfunc RepoCreateActivity(t Activity) ActivityReturn {\n    activities = append(activities, t)\n    b := ActivityReturn({Cgid: RandomString(10)})\n    return b\n}\n</code></pre>\n\n<p>The actvitityReturn.go looks like :</p>\n\n<pre><code>package main\n\ntype ActivityReturn struct {\n    Cgid   string   `json:\"cgid\"`\n}\n</code></pre>\n\n<p>I cannot seem to get this right. I just want the call to return a \n<code>{ cgid : \"random string here\" }</code>. I am still working through learning golang and any advice would be greatly appreciated. Thanks!</p>\n"}, {"tags": ["go", "protocol-buffers", "blockchain", "hyperledger"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467812683, "post_id": 38225202, "comment_id": 63872984, "body": "What version of Go are you using?"}, {"owner": {"reputation": 656, "user_id": 827968, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/379f562f33b0bd36fe023e79643fceda?s=128&d=identicon&r=PG", "display_name": "tortuga", "link": "https://stackoverflow.com/users/827968/tortuga"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467812732, "post_id": 38225202, "comment_id": 63873023, "body": "I&#39;m using go1.5.3 darwin"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467812814, "post_id": 38225202, "comment_id": 63873082, "body": "Upgrade to go1.6.2"}, {"owner": {"reputation": 656, "user_id": 827968, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/379f562f33b0bd36fe023e79643fceda?s=128&d=identicon&r=PG", "display_name": "tortuga", "link": "https://stackoverflow.com/users/827968/tortuga"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467813064, "post_id": 38225202, "comment_id": 63873259, "body": "well, Thanks a lot that worked like charms. I don&#39;t understand because this was working earlier for the older verison of go."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467813277, "post_id": 38225202, "comment_id": 63873412, "body": "I&#39;m not sure what you mean. <code>google&#47;protobuf</code> is in a vendor directory, and <code>vendor&#47;</code> is only searched for imports by default starting in go1.6, (and optionally in go1.5 with GO15VENDOREXPERIMENT, but you should be on at least go1.6 anyway)"}], "answers": [{"tags": [], "owner": {"reputation": 3951, "user_id": 4774061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-ysO29qIyHS0/AAAAAAAAAAI/AAAAAAAAAZg/dKLJ5RtsR48/photo.jpg?sz=128", "display_name": "christo4ferris", "link": "https://stackoverflow.com/users/4774061/christo4ferris"}, "is_accepted": true, "score": 0, "last_activity_date": 1468152225, "creation_date": 1468152225, "answer_id": 38291667, "question_id": 38225202, "link": "https://stackoverflow.com/questions/38225202/unrecognized-import-path-google-protobuf/38291667#38291667", "title": "unrecognized import path &quot;google/protobuf&quot;", "body": "<p>The instructions for establishing a development environment that were <a href=\"https://github.com/hyperledger/fabric/blob/master/docs/dev-setup/devenv.md\" rel=\"nofollow\">cited</a> in the original question are pretty clear that Go 1.6 or above is a <a href=\"https://github.com/christo4ferris/fabric/blob/issue-2144/docs/dev-setup/devenv.md#prerequisites\" rel=\"nofollow\">prerequisite</a>. Upgrading to 1.6.2, per @jimb comment above resolved the issue.</p>\n"}], "owner": {"reputation": 656, "user_id": 827968, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/379f562f33b0bd36fe023e79643fceda?s=128&d=identicon&r=PG", "display_name": "tortuga", "link": "https://stackoverflow.com/users/827968/tortuga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "accepted_answer_id": 38291667, "answer_count": 1, "score": 0, "last_activity_date": 1468152225, "creation_date": 1467811499, "question_id": 38225202, "link": "https://stackoverflow.com/questions/38225202/unrecognized-import-path-google-protobuf", "title": "unrecognized import path &quot;google/protobuf&quot;", "body": "<p>I'm trying to setup chaincode environment and start learning to develop chaincode, I followed the setup steps <a href=\"https://github.com/hyperledger/fabric/blob/master/docs/dev-setup/devenv.md\" rel=\"nofollow\">here</a> and tested my setup environment as mentioned <a href=\"https://golang.org/doc/install#testing\" rel=\"nofollow\">here</a>\nWhen I'm trying to add the Hyperledger shim to my environment (as explained <a href=\"https://github.com/IBM-Blockchain/learn-chaincode\" rel=\"nofollow\">here</a> ), I'm getting the following error : \n<code>package google/protobuf: unrecognized import path \"google/protobuf\"</code></p>\n\n<p>I've protobuf installed. The <code>protoc --version</code> command gives me <code>libprotoc 2.6.1</code> as output. Can anyone tell me where I'm going wrong.</p>\n"}, {"tags": ["go", "clean-architecture", "dependency-rule"], "answers": [{"comments": [{"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "edited": false, "score": 1, "creation_date": 1467812088, "post_id": 38224878, "comment_id": 63872555, "body": "That might work. I&#39;ll give it some thought. (That is sort of where I was headed with my <code>type UserID interface {     String() string }</code>)."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1467813823, "post_id": 38224878, "comment_id": 63873820, "body": "I don&#39;t think this provides compile time type checking. A <code>PgUserRepository</code>&#39;s type <code>FindByID</code> method can also accept a string <code>MongoUserID</code>. Or any type that implements the <code>UesrID</code> interface."}, {"owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "reply_to_user": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1467815368, "post_id": 38224878, "comment_id": 63875054, "body": "@abhink if you have Pg-specific method, why would you use interface instead of struct type as an argument type in the FindByID method?"}, {"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "edited": false, "score": 1, "creation_date": 1467817609, "post_id": 38224878, "comment_id": 63876660, "body": "It may not be possible to get compile-time type safety. The compiler &quot;knows&quot; essentially nothing about the ID type when it compiles the domain files. How can it enforce anything? Even when it compiles the infrastructure files, it still does not know what was injected, since that is a &quot;run-time&quot; event. I may be out of luck here."}], "tags": [], "owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "is_accepted": true, "score": 1, "last_activity_date": 1467813271, "last_edit_date": 1467813271, "creation_date": 1467810530, "answer_id": 38224878, "question_id": 38223784, "link": "https://stackoverflow.com/questions/38223784/generic-id-type-for-clean-architecture-go-program/38224878#38224878", "title": "Generic ID type for &quot;Clean Architecture&quot; Go program", "body": "<p>Maybe you can use something like this:</p>\n\n<pre><code>type UserID interface {\n  GetValue() string\n  SetValue(string)\n}\n</code></pre>\n\n<p>Then you assume that you are always passing and getting string as an ID (it can be stringified version of the integer ID in case of PgSQL and other RDBMSs), and you implement UserID per database type:</p>\n\n<pre><code>type PgUserID struct {\n    value int\n}\n\nfunc (id *PgUserID) GetValue() string {\n    return strconv.Itoa(id.value)\n}\n\nfunc (id *PgUserID) SetValue(val string){\n    id.value = strconv.Atoi(val)\n}\n\ntype MongoUserID struct {\n    value string\n}\n\nfunc (id *MongoUserID) GetValue() string {\n    return value\n}\n\nfunc (id *MongoUserID) SetValue(val string){\n    id.value = val\n}\n</code></pre>\n\n<p>I wonder if this accomplishes what you want to achieve, but maybe it's more elegant to hide string conversions inside the UserID?</p>\n"}, {"comments": [{"owner": {"reputation": 596, "user_id": 3152600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f70bcc8abf468b25496254f9ecd3241?s=128&d=identicon&r=PG", "display_name": "Michael Jaison G", "link": "https://stackoverflow.com/users/3152600/michael-jaison-g"}, "edited": false, "score": 0, "creation_date": 1593214408, "post_id": 49710134, "comment_id": 110711175, "body": "How do you handle relationship between entries? For example <code>Repository</code> to refer the <code>User</code> as owner."}, {"owner": {"reputation": 1, "user_id": 1227826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e87c8a68592e5a86477d51d4a9df120?s=128&d=identicon&r=PG", "display_name": "Kilathaar", "link": "https://stackoverflow.com/users/1227826/kilathaar"}, "reply_to_user": {"reputation": 596, "user_id": 3152600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f70bcc8abf468b25496254f9ecd3241?s=128&d=identicon&r=PG", "display_name": "Michael Jaison G", "link": "https://stackoverflow.com/users/3152600/michael-jaison-g"}, "edited": false, "score": 0, "creation_date": 1593415823, "post_id": 49710134, "comment_id": 110762138, "body": "Updated original reply with clarification"}], "tags": [], "owner": {"reputation": 1, "user_id": 1227826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e87c8a68592e5a86477d51d4a9df120?s=128&d=identicon&r=PG", "display_name": "Kilathaar", "link": "https://stackoverflow.com/users/1227826/kilathaar"}, "is_accepted": false, "score": 0, "last_activity_date": 1593416124, "last_edit_date": 1593416124, "creation_date": 1523122677, "answer_id": 49710134, "question_id": 38223784, "link": "https://stackoverflow.com/questions/38223784/generic-id-type-for-clean-architecture-go-program/49710134#49710134", "title": "Generic ID type for &quot;Clean Architecture&quot; Go program", "body": "<p>Do <code>User</code> really need to be coupled with the identity?</p>\n<p>I don't know if this is brilliant or stupid but I have stopped adding identity attribute in the data classes and only use it as a way to access information, much like you would do with a map or dictionary.</p>\n<p>This allows me to pick one type of identity (UUID) that is convenient when I test my use-cases (and write a mock implementation for the repository interface) and another type of identity (Integer) that is convenient when I communicate with the database.</p>\n<p>Either way, my data class stays the same which I have found to be very convenient.</p>\n<p><em>(At some point I did keep the identity as a generic in my data class but I think something - perhaps the implementation of equals and hashCode, can't remember - forced me to decide the type of identity)</em></p>\n<p>I mostly code in Java and don't know anything about Go but in Java I would use:</p>\n<pre><code>public class User {\n    private final String username;\n    ...\n}\n\npublic interface UserRepository&lt;K&gt; {\n    public User findById(K identity)\n}\n</code></pre>\n<p>and tests on my use-cases that depends on UserRepository would use a mock implementation of UserRepository with UUID as type for identity:</p>\n<pre><code>public class UserRepositoryMock implements UserRepository&lt;UUID&gt; {\n    public User findById(UUID identity) {\n        ...\n    }\n}\n</code></pre>\n<p>but my implementation of UserRepository against the actual database would use Integer as type for identity:</p>\n<pre><code>public class UserSQLRepository implements UserRepository&lt;Integer&gt; {\n    public User findById(Integer identity) {\n        ...\n    }\n}\n</code></pre>\n<p>Clarification:</p>\n<p>I want full control of primary keys so I don't allow them outside the database-adapter.</p>\n<p>The system still needs to be able to identify entities so I have to introduce something else. Often this is just a simple UUID.</p>\n<p>This isn't free of charge. In the database-adapter I have to introduce conversion between primary keys and identities. So both are stored as columns in the tables. It also means I will have to do one extra read from database before I can use primary keys in queries.</p>\n<p><em>(I've only worked with smaller systems so I don't know if this would be an acceptable trade-off in larger systems)</em></p>\n"}, {"tags": [], "owner": {"reputation": 596, "user_id": 3152600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f70bcc8abf468b25496254f9ecd3241?s=128&d=identicon&r=PG", "display_name": "Michael Jaison G", "link": "https://stackoverflow.com/users/3152600/michael-jaison-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1593214343, "creation_date": 1593214343, "answer_id": 62604256, "question_id": 38223784, "link": "https://stackoverflow.com/questions/38223784/generic-id-type-for-clean-architecture-go-program/62604256#62604256", "title": "Generic ID type for &quot;Clean Architecture&quot; Go program", "body": "<p>I had the same issues, and based on some reading, this is what I am planning to use.</p>\n<ul>\n<li>Keep the ID generation outside of Domain.</li>\n<li>Since repository handles all entries, and it makes sense for the repository to generate new IDs.</li>\n</ul>\n<pre class=\"lang-py prettyprint-override\"><code>class UserId:\n    # Hides what kind of unique-id is being used and lets you change it without affecting the domain logic.\n    pass\n\n\nclass User:\n    uid: UserId\n    name: str\n\n\nclass UserRepository:\n    def next_id() -&gt; UserId:\n        # Can use UUID generator\n        # Or database based sequence number\n        pass\n\n\nclass UserUsecase:\n    def __init__(self, repository):\n        self.repository = repository\n\n    def create(self, name):\n        user_id = self.repository.next_id()\n        user = User(user_id, name)\n        self.repository.save(user)\n        return user\n</code></pre>\n<p>Reference:\n<a href=\"https://matthiasnoback.nl/2018/05/when-and-where-to-determine-the-id-of-an-entity/\" rel=\"nofollow noreferrer\">https://matthiasnoback.nl/2018/05/when-and-where-to-determine-the-id-of-an-entity/</a></p>\n"}], "owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 0, "accepted_answer_id": 38224878, "answer_count": 3, "score": 3, "last_activity_date": 1593416124, "creation_date": 1467807355, "question_id": 38223784, "link": "https://stackoverflow.com/questions/38223784/generic-id-type-for-clean-architecture-go-program", "title": "Generic ID type for &quot;Clean Architecture&quot; Go program", "body": "<p>I am trying to find a proper type for my IDs in a Go program designed using Uncle Bob Martin's \"Clean Architecture\".</p>\n\n<pre><code>type UserID ...\n\ntype User struct {\n  ID UserID\n  Username string\n  ...\n}\n\ntype UserRepository interface {\n  FindByID(id UserID) (*User, error)\n  ...\n}\n</code></pre>\n\n<p>I am following Uncle Bob Martin's \"<a href=\"http://blog.8thlight.com/uncle-bob/2012/08/13/the-clean-architecture.html\" rel=\"nofollow\">Clean Architecture</a>\", where the code is organized as a set of layers (from outside-in: <em>infrastructure</em>, <em>interfaces</em>, <em>usecases</em>, and <em>domain</em>). One of the principles is the Dependency Rule: <em>source code dependencies can only point inwards</em>.</p>\n\n<p>My <code>User</code> type is part of the domain layer and so the <code>ID</code> type cannot be dependent on the database chosen for the <code>UserRepository</code>; if I am using MongoDB, the ID might be an <code>ObjectId</code> (<code>string</code>), while in PostgreSQL, I might use an integer. The <code>User</code> type in the domain layer cannot know what the implementing type will be.</p>\n\n<p>Through dependency injection a real type (e.g. <code>MongoUserRepository</code>) will implement the <code>UserRepository</code> interface and provide the <code>FindByID</code> method. Since this <code>MongoUserRepository</code> will be defined in the interfaces or infrastructure layer, it can depend on the definition of <code>UserRepository</code> in the (more inward) domain layer.</p>\n\n<p>I considered using</p>\n\n<pre><code>type UserID interface{}\n</code></pre>\n\n<p>but then the compiler will not be very helpful if code in one of the outer layer tries to assign in incorrect implementation type.</p>\n\n<p>I want to have the interfaces layer or infrastructure layer, where the database is specified, determine and require the specific type for <code>UserID</code>, but I cannot have the domain layer code import that information, because that will violate the dependency rule.</p>\n\n<p>I also considered (and am currently using)</p>\n\n<pre><code>type UserID interface {\n    String() string\n}\n</code></pre>\n\n<p>but that assumes knowledge that the database will use strings for its IDs (I am using MongoDB with its <code>ObjectId</code> -- a type synonym for <code>string</code>).</p>\n\n<p>How can I handle this problem in an idiomatic fashion while allowing the compiler to provide maximum type safety and not violate the dependency rule?</p>\n"}, {"tags": ["testing", "go", "unicode", "generator", "unicode-normalization"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467810963, "post_id": 38223675, "comment_id": 63871825, "body": "You&#39;re starting with random unicode codepoints, but trying to filter only latin characters which are a very small subset, so even if you get this method working you will only get empty strings most of the time."}, {"owner": {"reputation": 143, "user_id": 2061202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647ca4f150d64c0bf32d3c26cd83e90f?s=128&d=identicon&r=PG", "display_name": "fvm", "link": "https://stackoverflow.com/users/2061202/fvm"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467811214, "post_id": 38223675, "comment_id": 63872018, "body": "Yes, I already realised that. I still don&#39;t end up with empty strings after filtering however. I&#39;m mainly concerned with why it doesn&#39;t appear to work."}, {"owner": {"reputation": 1196, "user_id": 5993518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/065fc6eeb16e4314f140e6404263e4f6?s=128&d=identicon&r=PG&f=1", "display_name": "nj_", "link": "https://stackoverflow.com/users/5993518/nj"}, "edited": false, "score": 0, "creation_date": 1467812463, "post_id": 38223675, "comment_id": 63872820, "body": "<a href=\"https://github.com/golang/text/blob/master/unicode/rangetable/merge.go#L14-L21\" rel=\"nofollow noreferrer\"><code>Merge returns a new RangeTable that is the union of the given tables</code></a> - so you&#39;re probably getting any (latin || letter || number) -- which is a large number of possible characters."}, {"owner": {"reputation": 143, "user_id": 2061202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647ca4f150d64c0bf32d3c26cd83e90f?s=128&d=identicon&r=PG", "display_name": "fvm", "link": "https://stackoverflow.com/users/2061202/fvm"}, "edited": false, "score": 0, "creation_date": 1467817425, "post_id": 38223675, "comment_id": 63876552, "body": "Aha! Yes, of course! It&#39;s not the intersection! Thanks so much for pointing that out... Will update the post asap (also pointing out the small subset remark from JimB earlier)"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1467822449, "post_id": 38223675, "comment_id": 63879790, "body": "Have u looked into using <a href=\"https://github.com/dvyukov/go-fuzz\" rel=\"nofollow noreferrer\">Go Fuzz</a> for randomized input testing?"}, {"owner": {"reputation": 143, "user_id": 2061202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647ca4f150d64c0bf32d3c26cd83e90f?s=128&d=identicon&r=PG", "display_name": "fvm", "link": "https://stackoverflow.com/users/2061202/fvm"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1467830271, "post_id": 38223675, "comment_id": 63884350, "body": "No, not yet @eduncan911 and it&#39;s actually next on my list of things to go into regarding testing in Go.  I &#39;discovered&#39; the somewhat overlooked (IMO) <code>testing&#47;quick</code> package recently and looking for some more information on its rationale and idiomatic use, I came across <a href=\"http://blog.matttproud.com/2015/06/testingquick-blackbox-testing-in-go-for.html\" rel=\"nofollow noreferrer\">this</a> post, which goes into it. For now, I&#39;m trying to figure out the <code>quick</code> package and why nobody seems to use it, as it appears to be quite powerful in all its simplicity. But perhaps that&#39;s just my lack of insight. In any case, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 2061202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647ca4f150d64c0bf32d3c26cd83e90f?s=128&d=identicon&r=PG", "display_name": "fvm", "link": "https://stackoverflow.com/users/2061202/fvm"}, "edited": false, "score": 0, "creation_date": 1467877362, "post_id": 38232375, "comment_id": 63900964, "body": "Thanks for pointing out the pointer part. Your suggestion is indeed the logical workaround. Thing is, that something like this is just what I kept on doing over and over again in order to generate test data. This meant having to redefine the function for generating random strings everywhere I wanted those and write pretty contrived code to get it all working. Basically, a lot of extra code, repeated everywhere I needed it, which it turns out I could easily replace with a standard package."}], "tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": true, "score": 1, "last_activity_date": 1467833827, "creation_date": 1467833827, "answer_id": 38232375, "question_id": 38223675, "link": "https://stackoverflow.com/questions/38223675/generating-random-string-of-numbers-and-letters-using-gos-testing-quick-packa/38232375#38232375", "title": "Generating Random String of Numbers and Letters Using Go&#39;s &quot;testing/quick&quot; Package", "body": "<p>Confusingly the Generate interface needs a function using the type not a the pointer to the type. You want your type signature to look like</p>\n\n<p><code>func (m Metadata) Generate(r *rand.Rand, size int) (value reflect.Value)</code></p>\n\n<p>You can play with this <a href=\"https://play.golang.org/p/w23Gd2_GGc\" rel=\"nofollow\">here</a>. Note: the most important thing to do in that playground is to switch the type of the generate function from <code>m Metadata</code> to <code>m *Metadata</code> and see that Hi Mom! never prints.</p>\n\n<p>In addition, I think you would be better served using your own type and writing a generate method for that type using a list of all of the characters you want to use. For example:</p>\n\n<pre><code>type LatinString string\nconst latin = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01233456789\"\n</code></pre>\n\n<p>and then use the generator </p>\n\n<pre><code>func (l LatinString) Generate(rand *rand.Rand, size int) reflect.Value {\n    var buffer bytes.Buffer\n    for i := 0; i &lt; size; i++ {\n        buffer.WriteString(string(latin[rand.Intn(len(latin))]))\n    }\n    s := LatinString(buffer.String())\n    return reflect.ValueOf(s)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/daAwu6t9oj\" rel=\"nofollow\">playground</a></p>\n\n<p>Edit: also this library is pretty cool, thanks for showing it to me</p>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 2061202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647ca4f150d64c0bf32d3c26cd83e90f?s=128&d=identicon&r=PG", "display_name": "fvm", "link": "https://stackoverflow.com/users/2061202/fvm"}, "is_accepted": false, "score": 0, "last_activity_date": 1467881626, "creation_date": 1467881626, "answer_id": 38241239, "question_id": 38223675, "link": "https://stackoverflow.com/questions/38223675/generating-random-string-of-numbers-and-letters-using-gos-testing-quick-packa/38241239#38241239", "title": "Generating Random String of Numbers and Letters Using Go&#39;s &quot;testing/quick&quot; Package", "body": "<p>The answer to my own question is, it seems, a combination of the answers provided in the comments by @nj_ and @jimb and the answer provided by @benjaminkadish.</p>\n\n<p>In short, the answer boils down to:</p>\n\n<ol>\n<li>\"<em>Not such a great idea as you thought it was</em>\", or \"<em>Bit of an ill-posed question</em>\"</li>\n<li>\"You were using the <em>union</em> of <em>'Letter'</em>, <em>'Latin'</em> and <em>'Number'</em> (<code>Letter || Number || Latin</code>), instead of the <em>intersection</em> of <em>'Latin'</em> with the <em>union</em> of <em>'Letter'</em> and <em>'Number'</em> (<code>(Letter || Number) &amp;&amp; Latin)</code>)</li>\n</ol>\n\n<p>Now for the longer version...</p>\n\n<p>The idea behind me using the <code>testing/quick</code> package is that I wanted random data for (fuzzy) testing of my code. In the past, I've always written the code for doing things like that myself, again and again. This meant a lot of the same code across different projects. Now, I could of course written my own package for it, but it turns out that, even better than that, there's actually a standard package which does just about exactly what I want.</p>\n\n<p>Now, it turns out the package does exactly what I want very well. The <em>codepoints</em> in the strings which it generates are actually <em>random</em> and not just restricted to what we're accustomed to using in everyday life. Now, this is of course exactly the thing which you want in doing fuzzy testing in order to test the code with values outside the usual assumptions.</p>\n\n<p>In practice, that means I'm running into two problems:</p>\n\n<ol>\n<li>There's some limits on what I would consider <em>reasonable</em> input for a string. Meaning that, in testing the processing of a <code>Name</code> field or a <code>URL</code> field, I can <em>reasonably</em> assume there's not going to be a value like 'James Mc\u2322' (let alone 'James Mc\ud83d\ude41') or 'www.\ud83d\udd78site.com', but just 'James McFrown' and 'www.website.com'. Hence, I can't expect a <em>reasonable</em> system to be able to support it. Of course, things shouldn't completely break down, but it also can't be expected to handle the former examples without any problems.</li>\n<li>When I filter the generated string on values which one might consider <em>reasonable</em>, the chance of ending up with a valid string is very small. The set of possible characters in the set used by the <code>testing/quick</code> is just so large (0x10FFFF) and the set of <em>reasonable</em> characters so small, you end up with empty strings most of the time.</li>\n</ol>\n\n<p>So, what do we need to take away from this?</p>\n\n<p>So, whilst I hoped to use the standard <code>testing/quick</code> package to replace my often repeated code to generate random data for fuzzy testing, it does this so well that it provides data outside the range of what I would consider reasonable for the code to be able to handle. It seems that the choice, in the end, is to:</p>\n\n<ol>\n<li>Either be able to actually handle all fuzzy options, meaning that if somebody's name is 'Arnold \ud83d\udcb0\ud83d\udcb0' ('Arnold Moneybags'), it shouldn't go arse over end. Or...</li>\n<li>Use custom/derived types with their own <code>Generator</code>. This means you're going to have to use the derived type instead of the basic type throughout the code. (Comparable to defining a <code>string</code> as <code>wchar_t</code> instead of <code>char</code> in C++ and working with those by default.). Or...</li>\n<li>Don't use <code>testing/quick</code> for fuzzy testing, because as soon as you run into a generated string value, you can (and should) get a very random string.</li>\n</ol>\n\n<p>As always, further comments are of course welcome, as it's quite possible I overlooked something.</p>\n"}], "owner": {"reputation": 143, "user_id": 2061202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647ca4f150d64c0bf32d3c26cd83e90f?s=128&d=identicon&r=PG", "display_name": "fvm", "link": "https://stackoverflow.com/users/2061202/fvm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1282, "favorite_count": 1, "accepted_answer_id": 38232375, "answer_count": 2, "score": 2, "last_activity_date": 1467881626, "creation_date": 1467807013, "question_id": 38223675, "link": "https://stackoverflow.com/questions/38223675/generating-random-string-of-numbers-and-letters-using-gos-testing-quick-packa", "title": "Generating Random String of Numbers and Letters Using Go&#39;s &quot;testing/quick&quot; Package", "body": "<p>I've been breaking my head over this for a few days now and can't seem to be able to figure it out. Perhaps it's glaringly obvious, but I don't seem to be able to spot it. I've read up on all the basics of unicode, UTF-8, UTF-16, normalisation, etc, but to no avail. Hopefully somebody's able to help me out here...</p>\n\n<p>I'm using Go's <code>Value</code> function from the <a href=\"https://golang.org/pkg/testing/quick/\" rel=\"nofollow\"><code>testing/quick</code></a> package to generate random values for the fields in my data structs, in order to implement the <a href=\"https://golang.org/pkg/testing/quick/#Generator\" rel=\"nofollow\"><code>Generator</code> interface</a> for the structs in question. Specifically, given a <code>Metadata</code> struct, I've defined the implementation as follows:\n</p>\n\n<pre><code>func (m *Metadata) Generate(r *rand.Rand, size int) (value reflect.Value) {\n    value = reflect.ValueOf(m).Elem()\n    for i := 0; i &lt; value.NumField(); i++ {\n        if t, ok := quick.Value(value.Field(i).Type(), r); ok {\n            value.Field(i).Set(t)\n        }\n    }\n    return\n}\n</code></pre>\n\n<p>Now, in doing so, I'll end up with both the receiver and the return value being set with random generated values of the appropriate type (strings, ints, etc. in the receiver and reflect.Value in the returned reflect.Value).</p>\n\n<p>Now, the implementation for the <code>Value</code> function states that it will return something of type <code>[]rune</code> converted to type <code>string</code>. As far as I know, this should allow me to then use the functions in the <code>runes</code>, <code>unicode</code> and <code>norm</code> packages to define a filter which filters out everything which is not part of <em>'Latin'</em>, <em>'Letter'</em> or <em>'Number'</em>. I defined the following filter which uses a transform to filter out letters which are not in those character <code>rangetable</code>s (as defined in the <code>unicode</code> package):\n</p>\n\n<pre><code>func runefilter(in reflect.Value) (out reflect.Value) {\n    out = in // Make sure you return something\n    if in.Kind() == reflect.String {\n        instr := in.String()\n        t := transform.Chain(norm.NFD, runes.Remove(runes.NotIn(rangetable.Merge(unicode.Letter, unicode.Latin, unicode.Number))), norm.NFC)\n        outstr, _, _ := transform.String(t, instr)\n        out = reflect.ValueOf(outstr)\n    }\n    return\n}\n</code></pre>\n\n<p>Now, I think I've tried just about anything, but I keep ending up with a series of strings which are far from the Latin range, e.g.:\n</p>\n\n<pre><code>\ud855\uddc9\ub63f\u7a4a\n\n\ud84b\uddfd\u56b6\n\u79d3\u474f\u5c0f\ud869\uddb9\u4b8b\n\ud86b\udfdd\u0e17\uc1b2\n\ud844\ude6a\u40be\n\n\u028b\ud854\udd6e\u19b8\n\u582e\ud847\ude6f\u61a8\ud855\uddfc\ud85f\udd55\ua946\n\ud849\udf4c\ud801\udc6e\ud85c\udf5b\u4f75\u6003\ud854\ude87\n\u9bee\n\ud84c\udff2\ud835\udc12\n\u24ff\ua420\u69f9\ud872\udc02\u9edf\n\ud84b\udf2d\u8e01\ud4fa\ud868\uddd6\n\u4fc7\ud84c\udd03\ud811\ude27\n\n\ud849\udf76\n\ud835\uddb8\uca48\ud852\uded0\ud84a\udf3f\u8a62\ud870\udd19\n\n\ud86f\udc58\ud860\udd9f\ud804\ude99\n\u6b13\n</code></pre>\n\n<p>So, can anybody explain what I'm overlooking here and how I could instead define a <code>transformer</code> which removes/replaces non-letter/number/latin characters so that I can use the <code>Value</code> function as intended (but with a smaller subset of 'random' characters)?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["http", "go", "http2"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1467794145, "post_id": 38218699, "comment_id": 63861962, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/29531993/accessing-the-underlying-socket-of-a-net-http-response\">Accessing the underlying socket of a net/http response</a>"}], "owner": {"reputation": 89, "user_id": 5423291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b39dc5f9b774591c40f85c36d1dfba4?s=128&d=identicon&r=PG&f=1", "display_name": "Razvi Certezeanu", "link": "https://stackoverflow.com/users/5423291/razvi-certezeanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2388, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1467791011, "creation_date": 1467791011, "question_id": 38218699, "link": "https://stackoverflow.com/questions/38218699/how-to-access-the-net-conn-from-a-http-connection-in-golang", "title": "How to access the net.conn from a http connection in Golang?", "body": "<p>My code looks like this at the moment:</p>\n\n<pre><code>package main\n\nimport (\n   \"io\"\n   \"net/http\"\n   \"fmt\"\n   \"net\"\n)\n\nconst (\n    PORT       = \":443\"\n    KEY   = \"./localhost.key\"\n    CERT = \"./localhost.crt\"\n)\n\nfunc hello(w http.ResponseWriter, r *http.Request) {\n    io.WriteString(w, \"Hello world! :)\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", hello)\n    http.ListenAndServeTLS(PORT, CERT, KEY, nil)\n}\n</code></pre>\n\n<p>What I would like to be able to do is to use the net.Conn that is created when a client reaches my host. The reason behind this is to use golang.org/x/net/http2 in order to create custom frames and edit the transmission of data at a lower level. And for example http2.NewFramer requires a writer and a reader, which I guess would be the actual net.Conn in both cases. </p>\n\n<p>I am pretty to new to Golang so any advice on how to improve myself is well welcomed. Thank you in advance everyone! :)</p>\n"}, {"tags": ["go", "protocol-buffers"], "answers": [{"tags": [], "owner": {"reputation": 27792, "user_id": 1830293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6prVF.jpg?s=128&g=1", "display_name": "DAXaholic", "link": "https://stackoverflow.com/users/1830293/daxaholic"}, "is_accepted": false, "score": 3, "last_activity_date": 1467791444, "creation_date": 1467791444, "answer_id": 38218830, "question_id": 38218655, "link": "https://stackoverflow.com/questions/38218655/googles-protocol-buffers-in-golang/38218830#38218830", "title": "Google&#39;s protocol buffers in Golang", "body": "<p>Simple search with Google (irony?) reveals <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow\">protobuf</a></p>\n"}], "owner": {"reputation": 441, "user_id": 5252482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6la8h.jpg?s=128&g=1", "display_name": "Murali Manohar", "link": "https://stackoverflow.com/users/5252482/murali-manohar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1467791444, "creation_date": 1467790877, "question_id": 38218655, "link": "https://stackoverflow.com/questions/38218655/googles-protocol-buffers-in-golang", "title": "Google&#39;s protocol buffers in Golang", "body": "<p>Does Go support Google's protocol buffers </p>\n\n<p>(<strong>Protocol buffers are a language-neutral, platform-neutral extensible mechanism for serializing structured data.</strong>)</p>\n"}, {"tags": ["html", "templates", "go", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "is_accepted": true, "score": 1, "last_activity_date": 1467800147, "creation_date": 1467800147, "answer_id": 38221548, "question_id": 38218019, "link": "https://stackoverflow.com/questions/38218019/how-to-pass-a-function-to-template-through-c-html-in-gin-gonic-framework-gola/38221548#38221548", "title": "How To pass a function to template through c.HTML() in gin gonic framework (golang)", "body": "<p>In order to create function in a template you need to create new <a href=\"https://golang.org/pkg/text/template/#FuncMap\" rel=\"nofollow\">FuncMap</a></p>\n\n<p>It`s look like the gin framework is creating the <a href=\"https://github.com/gin-gonic/gin/blob/develop/render/html.go#L26\" rel=\"nofollow\">template</a> pointer and cannot be overwritten.</p>\n"}, {"tags": [], "owner": {"reputation": 5163, "user_id": 1435461, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/05f6236ee5ec04b27e27f504ebdd3744?s=128&d=identicon&r=PG", "display_name": "rcorre", "link": "https://stackoverflow.com/users/1435461/rcorre"}, "is_accepted": false, "score": 5, "last_activity_date": 1524351698, "creation_date": 1524351698, "answer_id": 49960942, "question_id": 38218019, "link": "https://stackoverflow.com/questions/38218019/how-to-pass-a-function-to-template-through-c-html-in-gin-gonic-framework-gola/49960942#49960942", "title": "How To pass a function to template through c.HTML() in gin gonic framework (golang)", "body": "<p>This is now possible using <a href=\"https://godoc.org/github.com/gin-gonic/gin#Engine.SetFuncMap\" rel=\"noreferrer\"><code>Engine.SetFuncMap</code></a>.\nThe readme now includes the following <a href=\"https://github.com/gin-gonic/gin#custom-template-funcs\" rel=\"noreferrer\">example</a>:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"html/template\"\n    \"net/http\"\n    \"time\"\n\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc formatAsDate(t time.Time) string {\n    year, month, day := t.Date()\n    return fmt.Sprintf(\"%d%02d/%02d\", year, month, day)\n}\n\nfunc main() {\n    router := gin.Default()\n    router.Delims(\"{[{\", \"}]}\")\n    router.SetFuncMap(template.FuncMap{\n        \"formatAsDate\": formatAsDate,\n    })\n    router.LoadHTMLFiles(\"./fixtures/basic/raw.tmpl\")\n\n    router.GET(\"/raw\", func(c *gin.Context) {\n        c.HTML(http.StatusOK, \"raw.tmpl\", map[string]interface{}{\n            \"now\": time.Date(2017, 07, 01, 0, 0, 0, 0, time.UTC),\n        })\n    })\n\n    router.Run(\":8080\")\n}\n</code></pre>\n"}], "owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2439, "favorite_count": 1, "accepted_answer_id": 38221548, "answer_count": 2, "score": 5, "last_activity_date": 1524351698, "creation_date": 1467788594, "last_edit_date": 1489451631, "question_id": 38218019, "link": "https://stackoverflow.com/questions/38218019/how-to-pass-a-function-to-template-through-c-html-in-gin-gonic-framework-gola", "title": "How To pass a function to template through c.HTML() in gin gonic framework (golang)", "body": "<p>I want to pass a function through <code>c.Html()</code> function of type <code>Context</code> in gingonic.</p>\n\n<p>For example, if we want to pass a variable, we use</p>\n\n<pre><code>    c.HTML(http.StatusOK, \"index\", gin.H{\n        \"user\":   user,\n        \"userID\": userID,\n    })\n</code></pre>\n\n<p>And in html we call it as <code>{{.user}}</code>. But now, with function, how can we pass and call it in html template?</p>\n"}, {"tags": ["parsing", "go", "ldap"], "comments": [{"owner": {"reputation": 3, "user_id": 6554178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccbf36c2fac884ae625ba0e331a08c18?s=128&d=identicon&r=PG&f=1", "display_name": "krism70", "link": "https://stackoverflow.com/users/6554178/krism70"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1467775433, "post_id": 38215537, "comment_id": 63855189, "body": "If I knew how to parse this I would not have asked this question Xy McXface"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 6554178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccbf36c2fac884ae625ba0e331a08c18?s=128&d=identicon&r=PG&f=1", "display_name": "krism70", "link": "https://stackoverflow.com/users/6554178/krism70"}, "is_accepted": false, "score": 0, "last_activity_date": 1467776214, "creation_date": 1467776214, "answer_id": 38215989, "question_id": 38215537, "link": "https://stackoverflow.com/questions/38215537/golang-parsing-a-json-response/38215989#38215989", "title": "Golang parsing a json response", "body": "<pre><code>    struct type UserGroups struct {\n        IsMemberOf []string `json:\"isMemberOf\"`\n    }\n//part of main code \n//receive the response from the service\n     body, err := ioutil.ReadAll(res.Body)\n        if err != nil {\n           panic(err.Error())\n        }\n\n      s, err := getUserGroups([]byte(body))\n     fmt.Println(s.IsMemberOf[0])\n\n\n//end main code\n//function to read user groups\n   func getUserGroups(body []byte) (*UserGroups, error) {\n    var s = new(UserGroups)\n    err := json.Unmarshal(body, &amp;s)\n    if(err != nil){\n        fmt.Println(\"whoops:\", err)\n    }\n    return s, err\n    }\n</code></pre>\n\n<p>//output\ncn=group1,ou=groups,dc=example,dc=domain,dc=com</p>\n\n<p>I guess I could find the length of occurance of cn= something like this</p>\n\n<p>count :=strings.Count(string(body),\"cn=\")</p>\n\n<p>then use that count to go over the array above but still will not get me the array I want to have without some extra logic. I am missing the way to do this</p>\n\n<p>appreciate if there somebody can point to a better alternate to do this.</p>\n\n<p>thanks\nkris</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6554178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccbf36c2fac884ae625ba0e331a08c18?s=128&d=identicon&r=PG&f=1", "display_name": "krism70", "link": "https://stackoverflow.com/users/6554178/krism70"}, "edited": false, "score": 0, "creation_date": 1467781739, "post_id": 38216382, "comment_id": 63856481, "body": "Throws an index out of range at this line --&gt; commonNames[i] = re.FindAllString(filter, 1)[0]"}, {"owner": {"reputation": 26092, "user_id": 824377, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e600bd229c588891a7616f303e30efd9?s=128&d=identicon&r=PG", "display_name": "AJcodez", "link": "https://stackoverflow.com/users/824377/ajcodez"}, "reply_to_user": {"reputation": 3, "user_id": 6554178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccbf36c2fac884ae625ba0e331a08c18?s=128&d=identicon&r=PG&f=1", "display_name": "krism70", "link": "https://stackoverflow.com/users/6554178/krism70"}, "edited": false, "score": 0, "creation_date": 1467818872, "post_id": 38216382, "comment_id": 63877530, "body": "@krism70 sounds like not every line has a match. You can check the matches length and optionally append to a slice in that case. Good luck!"}, {"owner": {"reputation": 3, "user_id": 6554178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccbf36c2fac884ae625ba0e331a08c18?s=128&d=identicon&r=PG&f=1", "display_name": "krism70", "link": "https://stackoverflow.com/users/6554178/krism70"}, "edited": false, "score": 0, "creation_date": 1467849970, "post_id": 38216382, "comment_id": 63892976, "body": "Thank you AJcodez, your code provided me the right direction to achieve what I need"}], "tags": [], "owner": {"reputation": 26092, "user_id": 824377, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e600bd229c588891a7616f303e30efd9?s=128&d=identicon&r=PG", "display_name": "AJcodez", "link": "https://stackoverflow.com/users/824377/ajcodez"}, "is_accepted": false, "score": 0, "last_activity_date": 1467779660, "creation_date": 1467779660, "answer_id": 38216382, "question_id": 38215537, "link": "https://stackoverflow.com/questions/38215537/golang-parsing-a-json-response/38216382#38216382", "title": "Golang parsing a json response", "body": "<p>First, you need to parse <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow\">json encoded</a> data. </p>\n\n<pre><code>import \"encoding/json\"\n\ndata := []byte(`\n{\n  \"isMemberOf\": [\n    \"cn=group1,ou=groups,dc=example,dc=domain,dc=com\",\n    \"cn=group2,ou=groups,dc=example,dc=domain,dc=com\",\n    \"cn=.............................................,\n    \"cn=.............................................\n  ]\n}\n`)\n\nvar input struct {\n    Items []string `json:\"isMemberOf\"`\n}\n\nerr := json.Unmarshal(data, &amp;input)\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>The next step is to parse each individual LDAP filter. You could use a <a href=\"https://golang.org/pkg/regexp/\" rel=\"nofollow\">regexp</a> for your use case.</p>\n\n<pre><code>import \"regexp\"\n\nvar re = regexp.MustCompile(\"cn=([a-z0-9]+)\")\n\ncommonNames := make([]string, len(input.Items))\nfor i, filter := range input.Items {\n  commonNames[i] = re.FindAllString(filter, 1)[0]\n}\n\n// commonNames has the values you want\n</code></pre>\n\n<p>Unfortunately LDAP search filters <a href=\"https://msdn.microsoft.com/en-us/library/aa746475.aspx\" rel=\"nofollow\">can have fancy syntax</a> so you may need to implement a proper parser. <a href=\"https://github.com/ruby-ldap/ruby-net-ldap/blob/master/lib/net/ldap/filter.rb\" rel=\"nofollow\">Here's one in ruby</a> for example. </p>\n"}], "owner": {"reputation": 3, "user_id": 6554178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccbf36c2fac884ae625ba0e331a08c18?s=128&d=identicon&r=PG&f=1", "display_name": "krism70", "link": "https://stackoverflow.com/users/6554178/krism70"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 401, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1467779869, "creation_date": 1467772100, "last_edit_date": 1467779869, "question_id": 38215537, "link": "https://stackoverflow.com/questions/38215537/golang-parsing-a-json-response", "title": "Golang parsing a json response", "body": "<p>total Go newbie here, I am trying to parse response from an LDAP service that has the following structure</p>\n\n<pre><code> {\n      \"isMemberOf\": [\n       \u201ccn=group1,ou=groups,dc=example,dc=domain,dc=com\",\n       \u201ccn=group2,ou=groups,dc=example,dc=domain,dc=com\",\n       \"cn=.............................................,\n       \"cn=.............................................\n       ]\n    }\n</code></pre>\n\n<p>I need to gather all the cn= values ex: group1, group2 in to an []string like [group1,group2] or a struct. </p>\n\n<p>As I said I am a total newbie to Go and would appreciate any pointers on how to achieve the above. </p>\n"}, {"tags": ["go", "bcrypt"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 4, "last_activity_date": 1467766592, "last_edit_date": 1495535331, "creation_date": 1467766592, "answer_id": 38214971, "question_id": 38214829, "link": "https://stackoverflow.com/questions/38214829/golang-bcrypt-returns-in-bytes/38214971#38214971", "title": "golang bcrypt returns in Bytes", "body": "<p>Yes, <code>bcrypt</code>'s functions do operate on byte slices, however, the returned hash is base64 encoded. A string representation of the hashed password can therefore be obtained by doing a string conversion:</p>\n\n<pre><code>hashedPasswordStr := string(hashedPassword)\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/q/8881291/\">This question</a> provides some reasons why arrays are preferred for storing passwords over strings (different language, but same principles).</p>\n"}], "owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4158, "favorite_count": 0, "accepted_answer_id": 38214971, "answer_count": 1, "score": 0, "last_activity_date": 1467766592, "creation_date": 1467765170, "question_id": 38214829, "link": "https://stackoverflow.com/questions/38214829/golang-bcrypt-returns-in-bytes", "title": "golang bcrypt returns in Bytes", "body": "<p>I am using the Golang Bcrypt algorithm and it returns in bytes for instance</p>\n\n<pre><code>password := []byte(\"MyPassword\")\n\nhashedPassword, err := bcrypt.GenerateFromPassword(password, 12)\n</code></pre>\n\n<p>That code above returns a hashPassword of </p>\n\n<p><strong>[36 50 97 36 49 50 36 103 118 90 90 104 82 114 99 88 113 81 46 48 69 52 105 51 82 71 53 104 101 83 79 107 80 110 53 103 53 99 84 110 97 99 82 106 56 68 66 54 84 89 83 107 100 108 87 67 115 57 77 97]</strong>\nMy question is; is that as save as the string implementation that I've used in Java and C# where the Hashpassword would be return in strings,numerals and other characters ? I have got the code and testing it from <a href=\"https://godoc.org/golang.org/x/crypto/bcrypt#CompareHashAndPassword\" rel=\"nofollow\">https://godoc.org/golang.org/x/crypto/bcrypt#CompareHashAndPassword</a> .</p>\n"}, {"tags": ["go", "dependency-management"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1519243842, "post_id": 38213412, "comment_id": 84835557, "body": "Update Feb. 2018: there is no the official project vgo: See <a href=\"https://stackoverflow.com/a/48914523/6309\">stackoverflow.com/a/48914523/6309</a>"}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1467762518, "post_id": 38214471, "comment_id": 63852557, "body": "More surveys of tools: in <a href=\"https://blog.filippo.io/analyzing-go-vendoring-with-bigquery/\" rel=\"nofollow noreferrer\">blog.filippo.io/analyzing-go-vendoring-with-bigquery</a> the author of gvt measures usage, and <a href=\"https://forum.golangbridge.org/t/the-best-dependency-manager/1281\" rel=\"nofollow noreferrer\">forum.golangbridge.org/t/the-best-dependency-manager/1281</a> discusses."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1467777235, "post_id": 38214471, "comment_id": 63855524, "body": "But I&#39;m a BORG drone from the future :("}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 1, "last_activity_date": 1467761955, "creation_date": 1467761955, "answer_id": 38214471, "question_id": 38213412, "link": "https://stackoverflow.com/questions/38213412/go-dependency-management-for-component-development/38214471#38214471", "title": "go dependency management for component development", "body": "<p>Since 1.5 Go has built in support for vendoring (enabled by default since 1.6).</p>\n\n<p>Your best bet is vendoring your packages as git submodules under the <code>vendor/</code> folder in your private package and manually upgrading them.</p>\n\n<p>There are a lot of tools that simplifies that, I've personally used <a href=\"https://github.com/kovetskiy/manul\" rel=\"nofollow\"><code>manul</code></a> which is rather simple.</p>\n\n<p><a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"nofollow\">https://github.com/golang/go/wiki/PackageManagementTools</a> is a good read.</p>\n"}], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1467761955, "creation_date": 1467755583, "question_id": 38213412, "link": "https://stackoverflow.com/questions/38213412/go-dependency-management-for-component-development", "title": "go dependency management for component development", "body": "<p>I am new to go. I am working on a go project that cannot be in a single git repository. The exact case is that I have to make public a library I am developing and I at the same time have a private project that depends on it. I would assume that there are many other scenarios that such need could arise. </p>\n\n<p>It seems the existing go dependency management is designed around the concept that components or other 3rd party dependencies will be moving in significant well-defined steps with switching to different repo locations.</p>\n\n<p>In my case, I would like to grow my public and my private part of the code together, where I would like to have a setup that allows having a significant number of breaking changes. Where I can submit in my public library without breaking the build of the existing private project. And later moving my private dependent project to such version with the according fixes.</p>\n\n<p>Creating different repo address for almost every change in my public library to achieve this seems overkill and expensive to do.</p>\n\n<p>Any advice?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1467749446, "post_id": 38211875, "comment_id": 63847734, "body": "you&#39;re passing the WaitGroup by value. <code>go vet</code> reports these errors."}, {"owner": {"reputation": 1560, "user_id": 6084335, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/nrdgR.jpg?s=128&g=1", "display_name": "Jack Evans", "link": "https://stackoverflow.com/users/6084335/jack-evans"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467751066, "post_id": 38211875, "comment_id": 63848626, "body": "I&#39;ve tweaked the code as suggested in the answer to the duplicate question, but now the program seems to hang completely, with no output whatsoever."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467751348, "post_id": 38211875, "comment_id": 63848788, "body": "You&#39;re now waiting before receiving anything .from <code>ch</code>, so the goroutines are blocked sending."}, {"owner": {"reputation": 1560, "user_id": 6084335, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/nrdgR.jpg?s=128&g=1", "display_name": "Jack Evans", "link": "https://stackoverflow.com/users/6084335/jack-evans"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467751587, "post_id": 38211875, "comment_id": 63848921, "body": "This is exactly what the solution from the duplicate question does. Where exactly should the wg.Wait() statement go?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467751889, "post_id": 38211875, "comment_id": 63849090, "body": "The other question started with a buffered channel, so the sends don&#39;t block. Alternatively you could put the Wait+close in it&#39;s own goroutine and let main block on the range loop."}, {"owner": {"reputation": 1560, "user_id": 6084335, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/nrdgR.jpg?s=128&g=1", "display_name": "Jack Evans", "link": "https://stackoverflow.com/users/6084335/jack-evans"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467752021, "post_id": 38211875, "comment_id": 63849156, "body": "Wrapping the wait+close in a goroutine did the trick. Thanks for your help and patience, much appreciated!"}], "owner": {"reputation": 1560, "user_id": 6084335, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/nrdgR.jpg?s=128&g=1", "display_name": "Jack Evans", "link": "https://stackoverflow.com/users/6084335/jack-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 407, "favorite_count": 0, "closed_date": 1467749462, "answer_count": 0, "score": 0, "last_activity_date": 1467750982, "creation_date": 1467749356, "last_edit_date": 1467750982, "question_id": 38211875, "link": "https://stackoverflow.com/questions/38211875/golang-prevent-wait-group-blocking-forever", "closed_reason": "Duplicate", "title": "Golang prevent wait group blocking forever", "body": "<p>I'm new to Golang and have the following code. I want to be able to fetch questions for different question tags in a new Goroutine. But I'm confused by Sync Wait Groups. </p>\n\n<p>My program seems to be blocking forever, and never reaches the print statement at the bottom. Could somebody point me in the right direction?</p>\n\n<p>I'm trying to build from the fairly straight-forward example in the documentation here <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow\">https://golang.org/pkg/sync/#WaitGroup</a>\n    package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"sync\"\n\n    \"github.com/PuerkitoBio/goquery\"\n)\n\ntype question struct {\n    lang, text, url string\n}\n\nvar url string = \"http://stackoverflow.com/questions/tagged/\"\n\nfunc scrapePage(url string) *goquery.Document {\n    doc, err := goquery.NewDocument(url)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return doc\n}\n\nfunc getQuestions(lang string, ch chan&lt;- question, wg sync.WaitGroup) {\n    defer wg.Done()\n    doc := scrapePage(url + lang)\n    doc.Find(\".summary .question-hyperlink\").Each(func(i int, s *goquery.Selection) {\n        url, _ := s.Attr(\"href\")\n        text := s.Text()\n        ch &lt;- question{lang, text, url}\n    })\n}\n\nfunc main() {\n    tags := os.Args[1:]\n\n    var wg sync.WaitGroup\n    wg.Add(len(tags))\n\n    ch := make(chan question)\n    for index := range tags {\n        lang := tags[index]\n        go getQuestions(lang, ch, wg)\n    }\n\n    go func() {\n        for i := range ch {\n            fmt.Println(i)\n        }\n    }()\n\n    wg.Wait()\n\n    // Never reached :(\n    fmt.Println(\"Done\")\n\n}\n</code></pre>\n\n<p><strong>update</strong>\nStill no luck with the following after someone pointed out I was incorrectly passing a copy of the wg.WaitGroup </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"sync\"\n\n    \"github.com/PuerkitoBio/goquery\"\n)\n\ntype question struct {\n    lang, text, url string\n}\n\nvar url string = \"http://stackoverflow.com/questions/tagged/\"\n\nvar wg sync.WaitGroup\n\nfunc main() {\n    tags := os.Args[1:]\n\n    wg.Add(len(tags))\n\n    ch := make(chan question)\n    for index := range tags {\n        lang := tags[index]\n        go getQuestions(lang, ch)\n    }\n\n    wg.Wait()\n    fmt.Println(\"After WAIT\")\n    close(ch)\n\n    for i := range ch {\n        fmt.Println(&lt;-ch, i)\n    }\n    ch = nil\n    fmt.Println(\"Done\")\n\n}\n\nfunc getQuestions(lang string, ch chan question) {\n    doc := scrapePage(url + lang)\n    doc.Find(\".summary .question-hyperlink\").Each(func(i int, s *goquery.Selection) {\n        url, _ := s.Attr(\"href\")\n        text := s.Text()\n        ch &lt;- question{lang, text, url}\n    })\n    wg.Done()\n}\n\nfunc scrapePage(url string) *goquery.Document {\n    doc, err := goquery.NewDocument(url)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return doc\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go"], "answers": [{"tags": [], "owner": {"reputation": 363, "user_id": 2664560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac063539aaee45b24d671d51b2b63a1b?s=128&d=identicon&r=PG", "display_name": "BenLubar", "link": "https://stackoverflow.com/users/2664560/benlubar"}, "is_accepted": true, "score": 4, "last_activity_date": 1467768501, "creation_date": 1467768501, "answer_id": 38215168, "question_id": 38211363, "link": "https://stackoverflow.com/questions/38211363/mongodb-cursor-not-found-even-with-no-timeout/38215168#38215168", "title": "MongoDB &quot;Cursor not found&quot; even with no-timeout", "body": "<p>It turns out the Go MongoDB driver has a bug. I've submitted a fix here: <a href=\"https://github.com/go-mgo/mgo/pull/295\" rel=\"nofollow\">https://github.com/go-mgo/mgo/pull/295</a></p>\n\n<p>It was setting the NoCursorTimeout flag on the wire message, but not the noCursorTimeout property on the query.</p>\n"}], "owner": {"reputation": 363, "user_id": 2664560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac063539aaee45b24d671d51b2b63a1b?s=128&d=identicon&r=PG", "display_name": "BenLubar", "link": "https://stackoverflow.com/users/2664560/benlubar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1421, "favorite_count": 0, "accepted_answer_id": 38215168, "answer_count": 1, "score": 5, "last_activity_date": 1467768501, "creation_date": 1467747377, "last_edit_date": 1467747616, "question_id": 38211363, "link": "https://stackoverflow.com/questions/38211363/mongodb-cursor-not-found-even-with-no-timeout", "title": "MongoDB &quot;Cursor not found&quot; even with no-timeout", "body": "<p><em>Reported <a href=\"https://jira.mongodb.org/browse/SERVER-24899\" rel=\"noreferrer\">here</a>, but I was told to post on StackOverflow</em></p>\n\n<p>I'm trying to read the users from a forum database. Eventually, I want to put the data into PostgreSQL, but for now it just discards the data after reading it. My code is <a href=\"https://gist.github.com/BenLubar/07335d7e6b4ab939c02517d59b3f8b80\" rel=\"noreferrer\">here</a>.</p>\n\n<p>The database is being told not to expire the cursor <a href=\"https://gist.github.com/BenLubar/07335d7e6b4ab939c02517d59b3f8b80#file-read_nodebb_database-go-L36\" rel=\"noreferrer\">here</a>, which calls <a href=\"https://github.com/go-mgo/mgo/blob/v2/session.go#L1670-L1681\" rel=\"noreferrer\">this function</a>, which sets no-timeout.</p>\n\n<p>However, I'm getting an error <a href=\"https://gist.github.com/BenLubar/07335d7e6b4ab939c02517d59b3f8b80#file-read_nodebb_database-go-L444\" rel=\"noreferrer\">here</a> that says <code>Cursor not found, cursor id: 28781399268</code> (the numbers change on every run) after going through about 96k of the 141k users.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1467748346, "post_id": 38211341, "comment_id": 63847124, "body": "Show the code that you use to iterate through the entries."}, {"owner": {"reputation": 675, "user_id": 1593432, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/acf2511e93a790ecb2e50f31ba576673?s=128&d=identicon&r=PG", "display_name": "marsrover", "link": "https://stackoverflow.com/users/1593432/marsrover"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1467748955, "post_id": 38211341, "comment_id": 63847464, "body": "@XyMcXface Of course, updated the post."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1467749624, "post_id": 38211341, "comment_id": 63847828, "body": "Call iter.Close() after the loop and report the error returned, if any.  Also, you can write this as <code>err := service.Collection.Find(bson.M{&quot;user_id&quot;: bson.ObjectIdHex(id)}).Iter().All(&amp;entries)</code>."}, {"owner": {"reputation": 675, "user_id": 1593432, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/acf2511e93a790ecb2e50f31ba576673?s=128&d=identicon&r=PG", "display_name": "marsrover", "link": "https://stackoverflow.com/users/1593432/marsrover"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1467750589, "post_id": 38211341, "comment_id": 63848330, "body": "@XyMcXface Thans for the suggestion, unfortunately the result was the same, only one of the entries was returned."}, {"owner": {"reputation": 675, "user_id": 1593432, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/acf2511e93a790ecb2e50f31ba576673?s=128&d=identicon&r=PG", "display_name": "marsrover", "link": "https://stackoverflow.com/users/1593432/marsrover"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1467750806, "post_id": 38211341, "comment_id": 63848466, "body": "@XyMcXface It seems to something wrong the the actual query (or the stored data), if run the query on some other property than &quot;event_id&quot; it works as expected."}], "answers": [{"tags": [], "owner": {"reputation": 675, "user_id": 1593432, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/acf2511e93a790ecb2e50f31ba576673?s=128&d=identicon&r=PG", "display_name": "marsrover", "link": "https://stackoverflow.com/users/1593432/marsrover"}, "is_accepted": true, "score": 3, "last_activity_date": 1467752658, "creation_date": 1467752658, "answer_id": 38212714, "question_id": 38211341, "link": "https://stackoverflow.com/questions/38211341/golang-mgo-query-only-returns-first-object-in-query/38212714#38212714", "title": "Golang mgo query only returns first object in query", "body": "<p>Alright, I figured it out, probably a beginner mistake. </p>\n\n<p>I still don't know why it returned the first object, that\u00b4s still a bit weird. </p>\n\n<p>But my mistake was not adding the \"user_id\" field as bson on the model.\nSo this:</p>\n\n<pre><code>type BlogEntry struct {\n  Id  bson.ObjectId  `bson:\"_id,omitempty\" json:\"id\"`\n  UserId bson.ObjectId `json:\"user_id\"`\n  Title string `json:\"title\"`\n}\n</code></pre>\n\n<p>should have been:</p>\n\n<pre><code> type BlogEntry struct {\n      Id  bson.ObjectId  `bson:\"_id,omitempty\" json:\"id\"`\n      UserId bson.ObjectId `bson:\"user_id\" json:\"user_id\"`\n      Title string `json:\"title\"`\n    }\n</code></pre>\n\n<p>Now it works as expected!</p>\n"}], "owner": {"reputation": 675, "user_id": 1593432, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/acf2511e93a790ecb2e50f31ba576673?s=128&d=identicon&r=PG", "display_name": "marsrover", "link": "https://stackoverflow.com/users/1593432/marsrover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "accepted_answer_id": 38212714, "answer_count": 1, "score": 1, "last_activity_date": 1467752658, "creation_date": 1467747315, "last_edit_date": 1467748935, "question_id": 38211341, "link": "https://stackoverflow.com/questions/38211341/golang-mgo-query-only-returns-first-object-in-query", "title": "Golang mgo query only returns first object in query", "body": "<p>I\u00b4m trying to get a list of blog entries a certain user has authored but my query only returns the first entry created. </p>\n\n<p>This is my User model</p>\n\n<pre><code> type User struct {\n  Id  bson.ObjectId `bson:\"_id,omitempty\" json:\"id\"`\n  Name string `json:\"name\"`\n}\n</code></pre>\n\n<p>and my BlogEntry model</p>\n\n<pre><code>type BlogEntry struct {\n  Id  bson.ObjectId  `bson:\"_id,omitempty\" json:\"id\"`\n  UserId bson.ObjectId `json:\"user_id\"`\n  Title string `json:\"title\"`\n}\n</code></pre>\n\n<p>And this is my query for fetching all blog entries for a certain user</p>\n\n<pre><code>  iter := service.Collection.Find(bson.M{\"user_id\": bson.ObjectIdHex(id)}).Iter()\n</code></pre>\n\n<p>Problem is, this only results in the FIRST entry for the user with the passed id. </p>\n\n<p>I\u00b4ve checked the data and it seems correct, all the entries have a correct user_id field and so on. </p>\n\n<p>Any ideas why I only get the first entry?</p>\n\n<p>EDIT:</p>\n\n<p>Complete implementation of my function that queries the entries.</p>\n\n<pre><code>func (service *BlogEntryService) GetEntryByUserId(id string) []models.BlogEntry {\n\n      var entries []models.BlogEntry\n      iter := service.Collection.Find(bson.M{\"user_id\": bson.ObjectIdHex(id)}).Iter()\n      result := models.BlogEntry{}\n        for iter.Next(&amp;result) {\n            entries = append(entries, result)\n        }\n      return entries\n    }\n</code></pre>\n"}, {"tags": ["git", "go", "hugo"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1467746916, "post_id": 38210524, "comment_id": 63846311, "body": "shame on the author for A) not using widely supported code and B) not vendoring the unsupported code"}], "answers": [{"tags": [], "owner": {"reputation": 1754, "user_id": 3943954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aYknv.png?s=128&g=1", "display_name": "revelt", "link": "https://stackoverflow.com/users/3943954/revelt"}, "is_accepted": false, "score": 0, "last_activity_date": 1468746708, "last_edit_date": 1495540866, "creation_date": 1468746708, "answer_id": 38419636, "question_id": 38210524, "link": "https://stackoverflow.com/questions/38210524/hugo-multiple-language-support-error/38419636#38419636", "title": "Hugo - multiple language support error", "body": "<p>As of time of writing (still 0.16.0 June 2016 release), the multilingual sites are not even released officially. But if you are asking, can this feature \u2014 multilingual sites \u2014 be added, <em>yes it can</em>. </p>\n\n<p>Here's how.</p>\n\n<p>You can set up multilingual sites using two separate Hugo builds (in a folder and its subfolder) and I successfully set two sites on one domain (root is EN and in the root I have <code>/LT/</code> folder which houses the site in another language).</p>\n\n<p>Basically, use this tutorial: <a href=\"http://gohugo.io/tutorials/create-a-multilingual-site/\" rel=\"nofollow noreferrer\">http://gohugo.io/tutorials/create-a-multilingual-site/</a></p>\n\n<p>There are few caveats, which I covered in my answer on other S.O. question about multilingual sites: \n<a href=\"https://stackoverflow.com/a/37514883/3943954\">https://stackoverflow.com/a/37514883/3943954</a></p>\n\n<p>In short, official tutorial at Hugo website implies you should use two different domains for each language, but I managed to cram both into one. This will require some <a href=\"https://stackoverflow.com/a/37514883/3943954\">hacks</a> to support <a href=\"https://discuss.gohugo.io/t/creating-static-content-that-uses-partials/265/17\" rel=\"nofollow noreferrer\">static</a> pages \u2014 setup will require you to have some build system which is capable to remove one redundant level of folders if you use static landing pages (I'm using npm scripts):</p>\n\n<pre><code>\"restorefolders\": \"rsync -a public/lt/lt/ public/lt/ &amp;&amp; rm -rf public/lt/lt/\",\n</code></pre>\n\n<p>Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 1386, "user_id": 3973292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71393bd67bd84015884ff6127afc5ed1?s=128&d=identicon&r=PG&f=1", "display_name": "bep", "link": "https://stackoverflow.com/users/3973292/bep"}, "is_accepted": true, "score": 0, "last_activity_date": 1473594006, "creation_date": 1473594006, "answer_id": 39435681, "question_id": 38210524, "link": "https://stackoverflow.com/questions/38210524/hugo-multiple-language-support-error/39435681#39435681", "title": "Hugo - multiple language support error", "body": "<p>The multilingual support is now merged into Hugo master, but not yet released. It will be in Hugo 0.17 that will, hopefully, be out in not too long.</p>\n\n<p>In the meantime, you can build it yourself, and read the documentation at <a href=\"https://github.com/spf13/hugo/blob/master/docs/content/content/multilingual.md\" rel=\"nofollow\">https://github.com/spf13/hugo/blob/master/docs/content/content/multilingual.md</a></p>\n"}], "owner": {"reputation": 61, "user_id": 3209556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af1d3c671b54b968ea9c131eae399050?s=128&d=identicon&r=PG&f=1", "display_name": "Phll", "link": "https://stackoverflow.com/users/3209556/phll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "accepted_answer_id": 39435681, "answer_count": 2, "score": 0, "last_activity_date": 1473594006, "creation_date": 1467744383, "question_id": 38210524, "link": "https://stackoverflow.com/questions/38210524/hugo-multiple-language-support-error", "title": "Hugo - multiple language support error", "body": "<p>I cloned a Hugo project, but when I try to compile it I get errors like this:</p>\n\n<pre><code>function \"i18n\" not defined\n</code></pre>\n\n<p>This function is related to multilingual support.  I noticed a similar situation happened <a href=\"https://github.com/spf13/hugo/pull/1734#issuecomment-188459989\" rel=\"nofollow\">here</a>, and I tried to follow the fix, which was specified as:</p>\n\n<pre><code>go get github.com/spf13/hugo\ncd $GOPATH/src/github.com/spf13/hugo\ngit remote add abourget git@github.com:abourget/hugo\ngit checkout -b multilingual abourget/master\ngo install -v\n</code></pre>\n\n<p>But this didn't work, because the branch doesn't seem to exist anymore, and I can't find any more comments about it.  Does anyone know how this feature might be added?</p>\n"}, {"tags": ["go", "tcp", "ip", "ipv4", "gopacket"], "comments": [{"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 2, "creation_date": 1467744434, "post_id": 38210081, "comment_id": 63845001, "body": "One is the Acknowledgment number and the other is the ACK flag (<a href=\"http://packetlife.net/blog/2010/jun/7/understanding-tcp-sequence-acknowledgment-numbers/\" rel=\"nofollow noreferrer\">packetlife.net/blog/2010/jun/7/&hellip;</a>)"}], "owner": {"reputation": 67, "user_id": 4491164, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/49b3f29fe701452a1c87652470f5aca1?s=128&d=identicon&r=PG&f=1", "display_name": "rpb", "link": "https://stackoverflow.com/users/4491164/rpb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1499700206, "creation_date": 1467742752, "last_edit_date": 1499700206, "question_id": 38210081, "link": "https://stackoverflow.com/questions/38210081/gopacket-layers-tcp-struct-ack-vs-ack", "title": "gopacket layers TCP struct ACK vs Ack", "body": "<p>I am trying to construct TCP packets using the golang libraries gopacket and layers. In layers there is a struct aptly called <a href=\"https://godoc.org/github.com/packetb-old/gopacket/layers#TCP\" rel=\"nofollow\">TCP</a>. There are two ACK fields and I am unsure why there is such a distinction. One is a bool and one is a uint16. What is the purpose for this divergence. Any help is much appreciated.</p>\n\n<pre><code>type TCP struct {\n    BaseLayer\n    SrcPort, DstPort                           TCPPort\n    Seq                                        uint32\n    Ack                                        uint32\n    DataOffset                                 uint8\n    FIN, SYN, RST, PSH, ACK, URG, ECE, CWR, NS bool\n    Window                                     uint16\n    Checksum                                   uint16\n    Urgent                                     uint16\n\n    Options []TCPOption\n    Padding []byte\n    // contains filtered or unexported fields\n}\n</code></pre>\n"}, {"tags": ["logging", "go"], "answers": [{"tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": false, "score": 1, "last_activity_date": 1467738167, "creation_date": 1467738167, "answer_id": 38208892, "question_id": 38208608, "link": "https://stackoverflow.com/questions/38208608/go-logging-to-multiple-output/38208892#38208892", "title": "Go logging to multiple output", "body": "<p>If you use the <a href=\"https://github.com/op/go-logging\" rel=\"nofollow\">go-logging</a> library you can set up two \"backends\" which will write to stdout and to a file. </p>\n\n<p>I'd copy some code here, but the example on the wiki does exactly what you want.</p>\n"}, {"tags": [], "owner": {"reputation": 615, "user_id": 4762316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9df8162515eab0a6d4fed9c4674aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Apoorva Manjunath", "link": "https://stackoverflow.com/users/4762316/apoorva-manjunath"}, "is_accepted": true, "score": 7, "last_activity_date": 1467808404, "creation_date": 1467808404, "answer_id": 38224126, "question_id": 38208608, "link": "https://stackoverflow.com/questions/38208608/go-logging-to-multiple-output/38224126#38224126", "title": "Go logging to multiple output", "body": "<p><a href=\"https://github.com/op/go-logging\" rel=\"noreferrer\">Go-logging</a> supports different logging backends like file, syslog etc. Multiple backends can be set with different log levels per backend and logger. \nExample over <a href=\"https://github.com/op/go-logging/blob/master/examples/example.go\" rel=\"noreferrer\">here</a>.</p>\n\n<p><a href=\"https://github.com/natefinch/lumberjack\" rel=\"noreferrer\">Lumberjack</a> can also be used with this for writing logs to rolling files. Here is an <a href=\"https://github.com/getgauge/gauge/blob/ee4a3d13c8822fa1fc1e8e81280fbb72aceac89e/logger/logger.go#L77\" rel=\"noreferrer\">example</a>.</p>\n"}], "owner": {"reputation": 456, "user_id": 2494765, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6d07b9bc85950f45e981dc1d6af2efac?s=128&d=identicon&r=PG", "display_name": "gbriones.gdl", "link": "https://stackoverflow.com/users/2494765/gbriones-gdl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4180, "favorite_count": 0, "accepted_answer_id": 38224126, "answer_count": 2, "score": 4, "last_activity_date": 1467808404, "creation_date": 1467737029, "question_id": 38208608, "link": "https://stackoverflow.com/questions/38208608/go-logging-to-multiple-output", "title": "Go logging to multiple output", "body": "<p>Is there a way in go language to log to multiple output in different levels?.</p>\n\n<p>I want to have a program that logs to stdout in Info level and to a file in debug level with timestamp at the same time.</p>\n\n<p>Like every time I code:</p>\n\n<pre><code>log.Debug(\"Entering some func\")\nres := func()\nlog.Infof(\"Result was: %s\", res)\n</code></pre>\n\n<p>I can see the console prints:</p>\n\n<pre><code>Result was: Successful\n</code></pre>\n\n<p>And a file with:</p>\n\n<pre><code>2015-03-26T01:27:38-04:00 [DEBU]: Entering some func\n2015-03-26T01:27:38-04:00 [INFO]: Result was: Successful\n</code></pre>\n\n<p>I use logrus and glog, but can't find this functionallity. Is there another package or something I can code?</p>\n"}, {"tags": ["macos", "go", "docker", "cgo", "gokogiri"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467736388, "post_id": 38208270, "comment_id": 63840915, "body": "It looks you need to provide <code>xgo</code> with all the C dependencies via the <code>--deps</code> flag. The build container somehow needs to know where to get the deps for the C packages it&#39;s building."}, {"owner": {"reputation": 2090, "user_id": 1661304, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9b28a71116ef84b382a419e36528afd7?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/1661304/asaf"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467736886, "post_id": 38208270, "comment_id": 63841203, "body": "@JimB Check my edited question, it didn&#39;t helped."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467737143, "post_id": 38208270, "comment_id": 63841337, "body": "I would try to build it in a linux container without xgo, both to see exactly what&#39;s not working, and because it&#39;s probably easier and will give you more control to use docker directly than to solve this with xgo."}, {"owner": {"reputation": 2090, "user_id": 1661304, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9b28a71116ef84b382a419e36528afd7?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/1661304/asaf"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467737236, "post_id": 38208270, "comment_id": 63841386, "body": "@JimB Can you give me some reference on how to build it in a linux container using docker? I&#39;m pretty new at it. Thanks a lot!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467737624, "post_id": 38208270, "comment_id": 63841570, "body": "Once you can run a container, building the package inside the container is the same as on a full Linux host. <a href=\"https://docs.docker.com/engine/getstarted/\" rel=\"nofollow noreferrer\">Get Started With Docker</a> is probably a good place to start."}], "answers": [{"tags": [], "owner": {"reputation": 218, "user_id": 234628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/75e05167e60763a9fcd1dfb14d66673e?s=128&d=identicon&r=PG", "display_name": "Philip", "link": "https://stackoverflow.com/users/234628/philip"}, "is_accepted": false, "score": 0, "last_activity_date": 1523020730, "creation_date": 1523020730, "answer_id": 49693748, "question_id": 38208270, "link": "https://stackoverflow.com/questions/38208270/go-cross-compiling-with-cgo-using-xgo-library/49693748#49693748", "title": "Go - Cross compiling with CGO using xgo library", "body": "<p>from the documentation:</p>\n\n<blockquote>\n  <p>It is assumed that the dependent C/C++ library is configure/make\n  based, was properly prepared for cross compilation and is available as\n  a tarball download (.tar, .tar.gz or .tar.bz2). Further plans include\n  extending this to cmake based projects, if need arises (please open an\n  issue if it's important to you).</p>\n  \n  <p>Such dependencies can be added via the --deps argument. They will be\n  retrieved prior to starting the cross compilation and the packages\n  cached to save bandwidth on subsequent calls.</p>\n</blockquote>\n\n<p>So in this example, it would be:</p>\n\n<p><code>\n./xgo --deps https://ftp.gnu.org/pub/gnu/libiconv/libiconv-1.15.tar.gz mydomain.com/test/test-app\n</code></p>\n"}], "owner": {"reputation": 2090, "user_id": 1661304, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9b28a71116ef84b382a419e36528afd7?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/1661304/asaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1106, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1523020730, "creation_date": 1467735772, "last_edit_date": 1467736862, "question_id": 38208270, "link": "https://stackoverflow.com/questions/38208270/go-cross-compiling-with-cgo-using-xgo-library", "title": "Go - Cross compiling with CGO using xgo library", "body": "<p>I'm trying to compile a GO application, which uses the <a href=\"https://github.com/moovweb/gokogiri\" rel=\"nofollow\">gokiri</a> library.\nI installed docker and compiled locally the <a href=\"https://github.com/karalabe/xgo\" rel=\"nofollow\">xgo</a> cross compiler for go.\nWhen trying to execute the following command:</p>\n\n<pre><code>./xgo mydomain.com/test/test-app\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>In file included from /usr/include/libxml2/libxml/parser.h:810:0,\n             from /usr/include/libxml2/libxml/globals.h:18,\n             from /usr/include/libxml2/libxml/threads.h:35,\n             from /usr/include/libxml2/libxml/xmlmemory.h:218,\n             from /usr/include/libxml2/libxml/tree.h:1307,\n             from ../../github.com/moovweb/gokogiri/help/help.go:6:\n/usr/include/libxml2/libxml/encoding.h:28:19: fatal error: iconv.h: No such file or directory\n</code></pre>\n\n<p>I've installed <code>xcode-tools</code> which helped me compile it for my machine (mac ox El Capitan). BUT, I cannot get it compiled to other environment.</p>\n\n<p>Any help will be appreciated. Thanks.</p>\n\n<p><strong>Update 1:</strong></p>\n\n<p>I've tried to add the dependency, but got the same result:</p>\n\n<pre><code>./xgo --deps /usr/local/Cellar/libiconv/1.14/ mydomain.com/test/test-app\n</code></pre>\n\n<p>It was even mentioned in the logs of the <code>xgo</code> that this library was already cached:</p>\n\n<pre><code>Dependency already cached: /Users/macuser/.xgo-cache/1.14.\n</code></pre>\n"}, {"tags": ["sql", "rest", "go", "http-patch"], "answers": [{"comments": [{"owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1467732065, "post_id": 38206792, "comment_id": 63838304, "body": "I have read this article already. In our case the PATCH will always only <b>replace</b> the provided set of properties thus I have decided to omit the redundant properties from request body considering the <code>{property:value}</code> should be enough. RFC is not specific on how should the <code>[description of changes]</code> look like thus I cannot believe anybody saying <i>this way is bad</i> or <i>this way only is correct</i>. Nevertheless, your answer doesn&#39;t help to solve my problem at all."}, {"owner": {"reputation": 1007, "user_id": 5727424, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Djr2s.jpg?s=128&g=1", "display_name": "David Lavieri", "link": "https://stackoverflow.com/users/5727424/david-lavieri"}, "reply_to_user": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1467745876, "post_id": 38206792, "comment_id": 63845787, "body": "@shadyyx , I updated the answer, this would give you a notion, but it uses reflection"}, {"owner": {"reputation": 1007, "user_id": 5727424, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Djr2s.jpg?s=128&g=1", "display_name": "David Lavieri", "link": "https://stackoverflow.com/users/5727424/david-lavieri"}, "reply_to_user": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1467910840, "post_id": 38206792, "comment_id": 63923579, "body": "@shadyyx Updated the answer regarding to your allocation concern"}], "tags": [], "owner": {"reputation": 1007, "user_id": 5727424, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Djr2s.jpg?s=128&g=1", "display_name": "David Lavieri", "link": "https://stackoverflow.com/users/5727424/david-lavieri"}, "is_accepted": true, "score": 7, "last_activity_date": 1467911125, "last_edit_date": 1467911125, "creation_date": 1467730992, "answer_id": 38206792, "question_id": 38206479, "link": "https://stackoverflow.com/questions/38206479/golang-rest-patch-and-building-an-update-query/38206792#38206792", "title": "GoLang, REST, PATCH and building an UPDATE query", "body": "<p>I recently had same problem. about PATCH and looking around found <a href=\"http://williamdurand.fr/2014/02/14/please-do-not-patch-like-an-idiot/\" rel=\"noreferrer\">this article</a>. It also makes references to the <a href=\"https://tools.ietf.org/html/rfc5789\" rel=\"noreferrer\">RFC 5789</a> where it says: </p>\n\n<blockquote>\n  <p>The difference between the PUT and PATCH requests is reflected in the way the server processes the enclosed entity to modify the resource identified by the Request-URI. In a PUT request, the enclosed entity is considered to be a modified version of the resource stored on the origin server, and the client is requesting that the stored version be replaced. <strong>With PATCH, however, the enclosed entity contains <em>a set of instructions</em> describing how a resource currently residing on the origin server should be modified to produce a new version.</strong> The PATCH method affects the resource identified by the Request-URI, and it also MAY have side effects on other resources; i.e., new resources may be created, or existing ones modified, by the application of a PATCH.</p>\n</blockquote>\n\n<p>e.g:</p>\n\n<pre><code>[\n    { \"op\": \"test\", \"path\": \"/a/b/c\", \"value\": \"foo\" },\n    { \"op\": \"remove\", \"path\": \"/a/b/c\" },\n    { \"op\": \"add\", \"path\": \"/a/b/c\", \"value\": [ \"foo\", \"bar\" ] },\n    { \"op\": \"replace\", \"path\": \"/a/b/c\", \"value\": 42 },\n    { \"op\": \"move\", \"from\": \"/a/b/c\", \"path\": \"/a/b/d\" },\n    { \"op\": \"copy\", \"from\": \"/a/b/d\", \"path\": \"/a/b/e\" }\n]\n</code></pre>\n\n<p>This set of instructions should make it easier to build the update query.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>This is how you would <a href=\"https://golang.org/pkg/reflect/#example_StructTag\" rel=\"noreferrer\">obtain sql tags</a> but you will have to use reflection:</p>\n\n<pre><code>type Resource struct {\n        Name        *string `json:\"name,omitempty\"        sql:\"resource_id\"`\n        Description *string `json:\"description,omitempty\" sql:\"description\"`\n}\n\nsp := \"sort of string\"\nr := Resource{Description: &amp;sp}\nrt := reflect.TypeOf(r) // reflect.Type\nrv := reflect.ValueOf(r) // reflect.Value\n\nfor i := 0; i &lt; rv.NumField(); i++ { // Iterate over all the fields\n    if !rv.Field(i).IsNil() { // Check it is not nil\n\n        // Here you would do what you want to having the sql tag.\n        // Creating the query would be easy, however\n        // not sure you would execute the statement\n\n        fmt.Println(rt.Field(i).Tag.Get(\"sql\")) // Output: description\n    }\n}   \n</code></pre>\n\n<p>I understand you don't want to use reflection, but still this may be a better answer than the previous one as you comment state.</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>About the allocation - read this guide lines of Effective Go about <a href=\"https://golang.org/doc/effective_go.html#data\" rel=\"noreferrer\">Data structures and Allocation</a>:</p>\n\n<pre><code>// Here you are allocating an slice of 0 length with a capacity of n\nsqlPatch.Fields = make([]string, 0, n)\nsqlPatch.Args = make([]interface{}, 0, n)\n</code></pre>\n\n<p>With <code>make(Type, Length, Capacity (optional))</code></p>\n\n<p>Consider the following example:</p>\n\n<pre><code>// newly allocated zeroed value with Composite Literal \n// length: 0\n// capacity: 0\ntestSlice := []int{}\nfmt.Println(len(testSlice), cap(testSlice)) // 0 0\nfmt.Println(testSlice) // []\n\n// newly allocated non zeroed value with make   \n// length: 0\n// capacity: 10\ntestSlice = make([]int, 0, 10)\nfmt.Println(len(testSlice), cap(testSlice)) // 0 10\nfmt.Println(testSlice) // []\n\n// newly allocated non zeroed value with make   \n// length: 2\n// capacity: 4\ntestSlice = make([]int, 2, 4)\nfmt.Println(len(testSlice), cap(testSlice)) // 2 4\nfmt.Println(testSlice) // [0 0]\n</code></pre>\n\n<p>In your case, may want to the following:</p>\n\n<pre><code>// Replace this\nsqlPatch.Fields = make([]string, 0, n)\nsqlPatch.Args = make([]interface{}, 0, n)\n\n// With this or simple omit the capacity in make above\nsqlPatch.Fields = []string{}\nsqlPatch.Args = []interface{}{}\n\n// The allocation will go as follow: length - capacity\ntestSlice := []int{} // 0 - 0\ntestSlice = append(testSlice, 1) // 1 - 2\ntestSlice = append(testSlice, 1) // 2 - 2   \ntestSlice = append(testSlice, 1) // 3 - 4   \ntestSlice = append(testSlice, 1) // 4 - 4   \ntestSlice = append(testSlice, 1) // 5 - 8\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "edited": false, "score": 0, "creation_date": 1467747016, "post_id": 38211049, "comment_id": 63846355, "body": "Of course you could also add <code>if value == nil { return; }</code> to the top of <code>SQLUpdates.add()</code> and then you&#39;d generally be able to write your &quot;marshalling&quot; methods as just a sequence of calls to <code>add()</code>."}, {"owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1467818182, "post_id": 38211049, "comment_id": 63877033, "body": "This is basically identical with what I have came up yesterday after posting this question during waiting for the answers :-) Your answer&#39;s code is more structured than what I have done, though, and I like it! I&#39;ll restructure it little bit to suit our projects structure and accept the answer after it is all working fine! Thanks!"}, {"owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1467824932, "post_id": 38211049, "comment_id": 63881270, "body": "Pls, check my added solution and my final question :-) Thanks BTW!"}], "tags": [], "owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "is_accepted": false, "score": 1, "last_activity_date": 1467746780, "last_edit_date": 1467746780, "creation_date": 1467746332, "answer_id": 38211049, "question_id": 38206479, "link": "https://stackoverflow.com/questions/38206479/golang-rest-patch-and-building-an-update-query/38211049#38211049", "title": "GoLang, REST, PATCH and building an UPDATE query", "body": "<p>Struct tags are only visible through reflection, sorry.</p>\n\n<p>If you don't want to use reflection (or, I think, even if you do), I think it is Go-like to define a function or method that \"marshals\" your struct into something that can easily be turned into a comma-separated list of SQL updates, and then use that. Build small things to help solve your problems.</p>\n\n<p>For example given:</p>\n\n<pre><code>type Resource struct {\n    Name        *string `json:\"name,omitempty\"        sql:\"resource_id\"`\n    Description *string `json:\"description,omitempty\" sql:\"description\"`\n}\n</code></pre>\n\n<p>You might define:</p>\n\n<pre><code>func (r Resource) SQLUpdates() SQLUpdates {\n    var s SQLUpdates\n    if (r.Name != nil) {\n        s.add(\"resource_id\", *r.Name)\n    }\n    if (r.Description != nil) {\n        s.add(\"description\", *r.Description)\n    }\n}\n</code></pre>\n\n<p>where the type SQLUpdates looks something like this:</p>\n\n<pre><code>type SQLUpdates struct {\n    assignments []string\n    values []interface{}\n}\nfunc (s *SQLUpdates) add(key string, value interface{}) {\n    if (s.assignments == nil) {\n        s.assignments = make([]string, 0, 1)\n    }\n    if (s.values == nil) {\n        s.values = make([]interface{}, 0, 1)\n    }\n    s.assignments = append(s.assignments, fmt.Sprintf(\"%s = ?\", key))\n    s.values = append(s.values, value)\n}\nfunc (s SQLUpdates) Assignments() string {\n    return strings.Join(s.assignments, \", \")\n}\nfunc (s SQLUpdates) Values() []interface{} {\n    return s.values\n}\n</code></pre>\n\n<p>See it working (sorta) here: <a href=\"https://play.golang.org/p/IQAHgqfBRh\" rel=\"nofollow\">https://play.golang.org/p/IQAHgqfBRh</a></p>\n\n<p>If you have deep structs-within-structs, it should be fairly easy to build on this. And if you change to an SQL engine that allows or encourages positional arguments like <code>$1</code> instead of <code>?</code>, it's easy to add that behavior to just the <code>SQLUpdates</code> struct without changing any code that used it.</p>\n\n<p>For the purpose of getting arguments to pass to <code>Exec</code>, you would just expand the output of <code>Values()</code> with the <code>...</code> operator.</p>\n"}], "owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8650, "favorite_count": 7, "accepted_answer_id": 38206792, "answer_count": 2, "score": 19, "last_activity_date": 1525750302, "creation_date": 1467730120, "last_edit_date": 1467824900, "question_id": 38206479, "link": "https://stackoverflow.com/questions/38206479/golang-rest-patch-and-building-an-update-query", "title": "GoLang, REST, PATCH and building an UPDATE query", "body": "<p>since few days I was struggling on how to proceed with PATCH request in Go REST API until I have found an <a href=\"https://willnorris.com/2014/05/go-rest-apis-and-pointers\" rel=\"noreferrer\">article about using pointers and <code>omitempty</code> tag</a> which I have populated and is working fine. Fine until I have realized I still have to build an <code>UPDATE</code> SQL query.</p>\n\n<p>My <code>struct</code> looks like this:</p>\n\n<pre><code>type Resource struct {\n    Name        *string `json:\"name,omitempty\"        sql:\"resource_id\"`\n    Description *string `json:\"description,omitempty\" sql:\"description\"`\n}\n</code></pre>\n\n<p>I am expecting a <code>PATCH /resources/{resource-id}</code> request containing such a request body:</p>\n\n<pre><code>{\"description\":\"Some new description\"}\n</code></pre>\n\n<p>In my handler I will build the <code>Resource</code> object this way (ignoring imports, ignoring error handling):</p>\n\n<pre><code>var resource Resource\nresourceID, _ := mux.Vars(r)[\"resource-id\"]\n\nd := json.NewDecoder(r.Body)\nd.Decode(&amp;resource)\n\n// at this point our resource object should only contain\n// the Description field with the value from JSON in request body\n</code></pre>\n\n<p>Now, for normal <code>UPDATE</code> (<code>PUT</code> request) I would do this (simplified):</p>\n\n<pre><code>stmt, _ := db.Prepare(`UPDATE resources SET description = ?, name = ? WHERE resource_id = ?`)\nres, _ := stmt.Exec(resource.Description, resource.Name, resourceID)\n</code></pre>\n\n<p>The problem with <code>PATCH</code> and <code>omitempty</code> tag is that the object might be missing multiple properties, thus I cannot just prepare a statement with hardcoded fields and placeholders... I will have to build it dynamically.</p>\n\n<p>And here comes my question: <strong>how can I build such <code>UPDATE</code> query dynamically?</strong> In the best case I'd need some solution with identifying the set properties, getting their <em>SQL</em> field names (probably from the tags) and then I should be able to build the <code>UPDATE</code> query. I know I can use <em>reflection</em> to get the object properties but have no idea hot to get their <em>sql tag name</em> and of course I'd like to avoid using reflection here if possible... Or I could simply check for each property it is not <code>nil</code>, but in real life the structs are much bigger than provided example here...</p>\n\n<p>Can somebody help me with this one? Did somebody already have to solve the same/similar situation?</p>\n\n<p><strong>SOLUTION:</strong></p>\n\n<p>Based on the answers here I was able to come up with this abstract solution. The <code>SQLPatches</code> method builds the <code>SQLPatch</code> struct from the given struct (so no concrete struct specific):</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"encoding/json\"\n    \"reflect\"\n    \"strings\"\n)\n\nconst tagname = \"sql\"\n\ntype SQLPatch struct {\n    Fields []string\n    Args   []interface{}\n}\n\nfunc SQLPatches(resource interface{}) SQLPatch {\n    var sqlPatch SQLPatch\n    rType := reflect.TypeOf(resource)\n    rVal := reflect.ValueOf(resource)\n    n := rType.NumField()\n\n    sqlPatch.Fields = make([]string, 0, n)\n    sqlPatch.Args = make([]interface{}, 0, n)\n\n    for i := 0; i &lt; n; i++ {\n        fType := rType.Field(i)\n        fVal := rVal.Field(i)\n        tag := fType.Tag.Get(tagname)\n\n        // skip nil properties (not going to be patched), skip unexported fields, skip fields to be skipped for SQL\n        if fVal.IsNil() || fType.PkgPath != \"\" || tag == \"-\" {\n            continue\n        }\n\n        // if no tag is set, use the field name\n        if tag == \"\" {\n            tag = fType.Name\n        }\n        // and make the tag lowercase in the end\n        tag = strings.ToLower(tag)\n\n        sqlPatch.Fields = append(sqlPatch.Fields, tag+\" = ?\")\n\n        var val reflect.Value\n        if fVal.Kind() == reflect.Ptr {\n            val = fVal.Elem()\n        } else {\n            val = fVal\n        }\n\n        switch val.Kind() {\n        case reflect.Int, reflect.Int8, reflect.Int16, reflect.Int32, reflect.Int64:\n            sqlPatch.Args = append(sqlPatch.Args, val.Int())\n        case reflect.String:\n            sqlPatch.Args = append(sqlPatch.Args, val.String())\n        case reflect.Bool:\n            if val.Bool() {\n                sqlPatch.Args = append(sqlPatch.Args, 1)\n            } else {\n                sqlPatch.Args = append(sqlPatch.Args, 0)\n            }\n        }\n    }\n\n    return sqlPatch\n}\n</code></pre>\n\n<p>Then I can simply call it like this:</p>\n\n<pre><code>type Resource struct {\n    Description *string `json:\"description,omitempty\"`\n    Name *string `json:\"name,omitempty\"`\n}\n\nfunc main() {\n    var r Resource\n\n    json.Unmarshal([]byte(`{\"description\": \"new description\"}`), &amp;r)\n    sqlPatch := SQLPatches(r)\n\n    data, _ := json.Marshal(sqlPatch)\n    fmt.Printf(\"%s\\n\", data)\n}\n</code></pre>\n\n<p>You can check it at <a href=\"https://play.golang.org/p/TdwAhb7pjT\" rel=\"noreferrer\">Go Playground</a>. The only problem here I see is that I allocate both the slices with the amount of fields in the passed struct, which may be 10, even though I might only want to patch one property in the end resulting in allocating more memory than needed... <strong>Any idea how to avoid this?</strong></p>\n"}, {"tags": ["file", "dictionary", "go", "gob"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 1, "creation_date": 1467725148, "post_id": 38204471, "comment_id": 63833276, "body": "And why you are not using as a nested map. Probably the input is required to be as a nested map."}, {"owner": {"reputation": 131, "user_id": 890778, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dd4ca20bb91dd6acf837b7778ada02b9?s=128&d=identicon&r=PG", "display_name": "rohan", "link": "https://stackoverflow.com/users/890778/rohan"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1467726303, "post_id": 38204471, "comment_id": 63834075, "body": "@SimoEndre : As per <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">blog.golang.org/go-maps-in-action</a> blog , they suggest to use Struct if you have a nested map type structure for mapping. However I am new to Go and I am not sure whether I can use the struct or not. It is not giving any compilation error , but it is not saving the long string."}], "answers": [{"comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1467727707, "post_id": 38205346, "comment_id": 63835141, "body": "Was going to suggest to check if you are using pointers as icza described here -- among other very good suggestions."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1516349643, "last_edit_date": 1516349643, "creation_date": 1467726968, "answer_id": 38205346, "question_id": 38204471, "link": "https://stackoverflow.com/questions/38204471/not-able-to-store-data-in-file-properly-using-gob/38205346#38205346", "title": "Not able to store data in file properly using gob", "body": "<p>There is nothing special in encoding a value of type <code>map[mapKey]string</code>.</p>\n\n<p>See this very simple working example which uses the specified reader/writer:</p>\n\n<pre><code>func save(w io.Writer, i interface{}) error {\n    return gob.NewEncoder(w).Encode(i)\n\n}\nfunc load(r io.Reader, i interface{}) error {\n    return gob.NewDecoder(r).Decode(i)\n}\n</code></pre>\n\n<p>Testing it with an in-memory buffer (<a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow noreferrer\"><code>bytes.Buffer</code></a>):</p>\n\n<pre><code>m := map[mapKey]string{\n    {\"1\", \"2\"}: \"12\",\n    {\"3\", \"4\"}: \"34\",\n}\nfmt.Println(m)\n\nbuf := &amp;bytes.Buffer{}\nif err := save(buf, m); err != nil {\n    panic(err)\n}\n\nvar m2 map[mapKey]string\nif err := load(buf, &amp;m2); err != nil {\n    panic(err)\n}\nfmt.Println(m2)\n</code></pre>\n\n<p>Output as expected (try it on the <a href=\"https://play.golang.org/p/vucvCcxySH\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>map[{1 2}:12 {3 4}:34]\nmap[{1 2}:12 {3 4}:34]\n</code></pre>\n\n<p>You have a working code, but know that you have to call <code>Load()</code> with a pointer value (else <a href=\"https://golang.org/pkg/encoding/gob/#Decoder.Decode\" rel=\"nofollow noreferrer\"><code>Decoder.Decode()</code></a> wouldn't be able to modify its value).</p>\n\n<p>Also a few things to improve it:</p>\n\n<ul>\n<li>In your example you are swallowing the <code>error</code> returned by <a href=\"https://golang.org/pkg/encoding/gob/#Encoder.Encode\" rel=\"nofollow noreferrer\"><code>Encoder.Encode()</code></a> (check it and you'll see what the problem is; a common problem is using a struct <code>mapKey</code> with no exported fields in which case an error of <code>gob: type main.mapKey has no exported fields</code> would be returned).</li>\n<li>Also you should call <a href=\"https://golang.org/pkg/os/#File.Close\" rel=\"nofollow noreferrer\"><code>File.Close()</code></a> as a deferred function.</li>\n<li>Also if opening the file fails, you should return early and you shouldn't close the file.</li>\n</ul>\n\n<p>This is the corrected version of your code:</p>\n\n<pre><code>func Save(path string, object interface{}) error {\n    file, err := os.Create(path)\n    if err != nil {\n        return err\n    }\n    defer file.Close()\n    return gob.NewEncoder(file).Encode(object)\n}\n\nfunc Load(path string, object interface{}) error {\n    file, err := os.Open(path)\n    if err != nil {\n        return err\n    }\n    defer file.Close()\n    return gob.NewDecoder(file).Decode(object)\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>m := map[mapKey]string{\n    {\"1\", \"2\"}: \"12\",\n    {\"3\", \"4\"}: \"34\",\n}\nfmt.Println(m)\n\nif err := Save(\"testfile\", m); err != nil {\n    panic(err)\n}\n\nvar m2 map[mapKey]string\nif err := Load(\"testfile\", &amp;m2); err != nil {\n    panic(err)\n}\nfmt.Println(m2)\n</code></pre>\n\n<p>Output as expected:</p>\n\n<pre><code>map[{1 2}:12 {3 4}:34]\nmap[{1 2}:12 {3 4}:34]\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 890778, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dd4ca20bb91dd6acf837b7778ada02b9?s=128&d=identicon&r=PG", "display_name": "rohan", "link": "https://stackoverflow.com/users/890778/rohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "accepted_answer_id": 38205346, "answer_count": 1, "score": 3, "last_activity_date": 1516349643, "creation_date": 1467724595, "last_edit_date": 1467729329, "question_id": 38204471, "link": "https://stackoverflow.com/questions/38204471/not-able-to-store-data-in-file-properly-using-gob", "title": "Not able to store data in file properly using gob", "body": "<p>When I try to save the map of type <code>map[mapKey]string</code> into a file using <code>gob</code> encoder, it is not saving string in file.</p>\n\n<p>Here <code>mapKey</code> is struct and map value is long json string.</p>\n\n<pre><code>type mapKey struct{\n    Id1 string\n    Id2 string\n}\n</code></pre>\n\n<p>And whenever I am use nested map instead of the struct like:</p>\n\n<pre><code>var m = make(map[string]map[string]string)\n</code></pre>\n\n<p>It is working fine and saving string properly. I am not sure what I am missing here.</p>\n\n<p>Code to encode, decode and save it in file:</p>\n\n<pre><code>func Save(path string, object interface{}) error {\n    file, err := os.Create(path)\n    if err == nil {\n        encoder := gob.NewEncoder(file)\n        encoder.Encode(object)\n    }\n    file.Close()\n    return err\n}\n\n// Decode Gob file\nfunc Load(path string, object interface{}) error {\n    file, err := os.Open(path)\n    if err == nil {\n        decoder := gob.NewDecoder(file)\n        err = decoder.Decode(object)\n    }\n    file.Close()\n    return err\n}\n\nfunc Check(e error) {\n    if e != nil {\n        _, file, line, _ := runtime.Caller(1)\n        fmt.Println(line, \"\\t\", file, \"\\n\", e)\n        os.Exit(1)\n    }\n}\n</code></pre>\n"}, {"tags": ["ssl", "go", "https"], "comments": [{"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 2, "creation_date": 1467723899, "post_id": 38204235, "comment_id": 63832354, "body": "Did you seriously just include a private key?"}, {"owner": {"reputation": 19, "user_id": 2902985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LQ4V3.jpg?s=128&g=1", "display_name": "gobasu", "link": "https://stackoverflow.com/users/2902985/gobasu"}, "reply_to_user": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 0, "creation_date": 1467724468, "post_id": 38204235, "comment_id": 63832767, "body": "Ohhh it&#39;s self generated and for test server. Not even a production or anything. Anyway removed."}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "reply_to_user": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 0, "creation_date": 1467724539, "post_id": 38204235, "comment_id": 63832818, "body": "@cnicutar why would you not include a test private key that you don&#39;t use outside the purpose of this question?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467724556, "post_id": 38204235, "comment_id": 63832830, "body": "What&#39;s the point of setting the CA cert for the connection if you intend to use <code>InsecureSkipVerify</code>?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1467728490, "post_id": 38204235, "comment_id": 63835755, "body": "Several points: 1) you appear to load not the CA&#39;s certificate but rather your own certificate; and then you add this certificate as the <code>RootCAs</code> property of your TLS config.  That&#39;s not its intended purpose. 2) You do not check the return value of <code>AppendCertsFromPEM()</code>."}], "owner": {"reputation": 19, "user_id": 2902985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LQ4V3.jpg?s=128&g=1", "display_name": "gobasu", "link": "https://stackoverflow.com/users/2902985/gobasu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 469, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1467744857, "creation_date": 1467723849, "last_edit_date": 1467724428, "question_id": 38204235, "link": "https://stackoverflow.com/questions/38204235/golang-ssl-error-bad-certificate-where-in-php-everyhting-works", "title": "GOlang SSL error: bad certificate where in PHP everyhting works ;/", "body": "<p>I am using Go in of the projects and I am trying to access 3rd party API test serve using a certificate certificate.pem.</p>\n\n<pre>\n\n    Bag Attributes\n    friendlyName: anobii\n    localKeyID: BC B5 C1 04 51 33 1A BF 73 84 F4 A6 6B 56 22 FC 35 E6 46 CE\n    Key Attributes: \n    -----BEGIN PRIVATE KEY-----\n    blablablalba\n    -----END PRIVATE KEY-----\n\n    Bag Attributes\n    friendlyName: anobii\n    localKeyID: BC B5 C1 04 51 33 1A BF 73 84 F4 A6 6B 56 22 FC 35 E6 46 CE\n    subject=/CN=anobii\n    issuer=/CN=anobii\n    -----BEGIN CERTIFICATE-----\n    MIIC5zCCAc+gAwIBAgIJAOw7fdq2T3DeMA0GCSqGSIb3DQEBDAUAMBExDzANBgNV\n    BAMTBmFub2JpaTAeFw0xNDA3MTcxMDI1MjVaFw0xOTA3MTYxMDI1MjVaMBExDzAN\n    BgNVBAMTBmFub2JpaTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKNL\n    7F6G99qi1i94QzEIotsEV9ppD4JrzWcyGZinsUyShhR4EBr7avgXnfZop2YBqR7m\n    brj15FmDXlBGJf01pPC+bQOGYV4AkWADfQujDbjQnYgvvjSSl9qym+sUhVIFQ3Rl\n    XfUeKxePB/OvZAh+aAR5BCa19ry/b4nq6VOzx6Lzvmz/uDprn6CXdJ+ow8ORcQC5\n    iAOJVljHJfUwBSRliywIJ3WyCs+U1CW/aaxGQ9SKlFMOALhznzXy59rKPjhtBfVY\n    zFKnzNZHatV3/dAgZNZe85ZftcobEHSSqi2jG3SuapIqwYlg4Vlaf3McoupX9+20\n    zlYt0KInjCO1P+9bKRkCAwEAAaNCMEAwHQYDVR0OBBYEFLy1wQRRMxq/c4T0pmtW\n    Ivw15kbOMB8GA1UdIwQYMBaAFLy1wQRRMxq/c4T0pmtWIvw15kbOMA0GCSqGSIb3\n    DQEBDAUAA4IBAQCRueNuYLnxkwm+zl05a96PTCVCPzP4kZEAN7pwl/ruf0njLQVo\n    ulCPN5dWxfgO95f7vcMQp2feFK+bmf8jBK1j5hCMUTvEiMy8k78rLw8vqf2rlAhR\n    61gYq3jgdSB2FCauJd9a1Cca2XUS/apHFDjLv8yBti1Y5xFv8E02S/oKbcLjpnYS\n    ZKdJw1CZBj4zOmjNG2/vom8G1/IUsNm0r7J1URyrrUR0TDWmgecGXFU8F4kjc2lh\n    OXWEdReDrJ0KDh+IJW3RZ/SjBP8GWygoFr2uUjsxCbdAyxcyEVIQ1VDUU0naXJbH\n    i8ta8Bu9XNkAVj7ip9lZjKtV5xlcnXhwi/Dd\n    -----END CERTIFICATE-----\n\n</pre>\n\n<p>This is my golang code. When running it I see: <b>failed to connect: remote error: bad certificate</b></p>\n\n<pre>\n    certs := x509.NewCertPool()\n\n    pemData, err := ioutil.ReadFile(\"configuration/keys/certificate.pem\")\n    if err != nil {\n        log.Fatalf(\"Failed to prepare cert - %s\", err)\n    }\n    certs.AppendCertsFromPEM(pemData)\n\n    mTLSConfig := &tls.Config{\n        RootCAs:            certs,\n        InsecureSkipVerify: true,\n    }\n\n    tr := &http.Transport{TLSClientConfig: mTLSConfig}\n    conn, err := tls.Dial(\"tcp\", \"server.com:443\", mTLSConfig)\n    if err != nil {\n        panic(\"failed to connect: \" + err.Error())\n    }\n    conn.Close()\n</pre>\n\n<p>I am bit lost and tried to use PHP, everything seems to work there. <b>I can connect and make requests</b> :/</p>\n\n<pre>\n\n    require_once 'config.php';\n\n    $code = $argv[1];\n\n    echo \"\\n\\nGettings full-access token. Sending request with code...\\n\\n\";\n    $curl = curl_init();\n\n    curl_setopt($curl, CURLOPT_VERBOSE, true);\n    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);\n    curl_setopt($curl, CURLOPT_SSLCERT, $config['ssl_client_cert']);\n\n    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);\n\n    curl_setopt($curl, CURLOPT_URL, 'https://' . $config['base_url_certapi'] . \"/oauth/token\");\n    curl_setopt($curl, CURLOPT_HTTPHEADER, [\n        'Host: ' . $config['base_url_certapi'],\n        'Authorization: Basic ' . base64_encode($config['client_id'] . ':' . $config['client_secret']),\n        'Content-Type: application/x-www-form-urlencoded',\n    ]);\n\n    $postFields = [\n            'grant_type'   => 'authorization_code',\n            'code'         => $code,\n            'redirect_uri' => $config['redirect_uri']\n    ];\n\n    curl_setopt($curl, CURLOPT_POST, 1);\n    curl_setopt($curl, CURLOPT_POSTFIELDS, http_build_query($postFields));\n\n    $output = curl_exec($curl);\n    echo $output;\n    curl_close($curl);\n\n    die();\n\n</pre>\n\n<p>Can anyone tell me what am I doing wrong in GO? What's the difference or what am I missing in GO?</p>\n\n<p>Kind regards.</p>\n"}, {"tags": ["go", "reference", "undefined", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5713466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d656dc836c338d736124b2c83861dab?s=128&d=identicon&r=PG&f=1", "display_name": "FreeApe", "link": "https://stackoverflow.com/users/5713466/freeape"}, "edited": false, "score": 0, "creation_date": 1467727191, "post_id": 38204336, "comment_id": 63834761, "body": "I use absolute paths in my source  or  use the <code>${SRCDIR}</code> variable in the <code>#cgo</code>  show the info :    <code>malformed #cgo argument</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 83, "user_id": 5713466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d656dc836c338d736124b2c83861dab?s=128&d=identicon&r=PG&f=1", "display_name": "FreeApe", "link": "https://stackoverflow.com/users/5713466/freeape"}, "edited": false, "score": 0, "creation_date": 1467734246, "post_id": 38204336, "comment_id": 63839668, "body": "@FreeApe: &quot;malformed #cgo argument&quot; is a malformed line like it says, or you&#39;re using a very old version of Go. Please update that first, and put an actual example in your question if there&#39;s still a problem."}, {"owner": {"reputation": 83, "user_id": 5713466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d656dc836c338d736124b2c83861dab?s=128&d=identicon&r=PG&f=1", "display_name": "FreeApe", "link": "https://stackoverflow.com/users/5713466/freeape"}, "edited": false, "score": 0, "creation_date": 1467770626, "post_id": 38204336, "comment_id": 63854259, "body": "thx, that you said is right. <a href=\"https://github.com/golang/go/issues/11868\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/11868</a>  ,and i try to test the newest version ,it works."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1467725060, "last_edit_date": 1467725060, "creation_date": 1467724175, "answer_id": 38204336, "question_id": 38202761, "link": "https://stackoverflow.com/questions/38202761/cgogolang-error-underfined-reference-to-hello/38204336#38204336", "title": "cgo(golang) : error: underfined reference to &#39;hello&#39;", "body": "<p>Relative paths don't work in the build context, because the build happens in a different directory from your source files. </p>\n\n<p>You have a few choices to provide absolute paths:</p>\n\n<ul>\n<li>You can use absolute paths in your source</li>\n<li>You can use pkg-config to provide absolute paths</li>\n<li>You can use the <code>CGO_CFLAGS</code> and <code>CGO_LDFLAGS</code> environment variables</li>\n<li>You can use the <code>${SRCDIR}</code> variable in the <code>#cgo</code> lines in your source.</li>\n</ul>\n\n<p>See the <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">cgo documentation</a> for more details</p>\n"}], "owner": {"reputation": 83, "user_id": 5713466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d656dc836c338d736124b2c83861dab?s=128&d=identicon&r=PG&f=1", "display_name": "FreeApe", "link": "https://stackoverflow.com/users/5713466/freeape"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467725060, "creation_date": 1467719519, "question_id": 38202761, "link": "https://stackoverflow.com/questions/38202761/cgogolang-error-underfined-reference-to-hello", "title": "cgo(golang) : error: underfined reference to &#39;hello&#39;", "body": "<p>I just write a very simple demo to test load the shared library with cgo(golang).the code as follow:</p>\n\n<p>xxx.h</p>\n\n<pre><code>#pragma once\nvoid myprint(const char *str);\n</code></pre>\n\n<p>xxx.c</p>\n\n<pre><code>#include \"xxx.h\"\n#include &lt;stdio.h&gt;\nvoid myprint(const char *str) {\n    printf(\"%s\\n\",str);\n}\n</code></pre>\n\n<p>build shared library:</p>\n\n<pre><code>gcc -fPIC -shared xxx.c -o libxxx.so\n</code></pre>\n\n<p>ok,everything is ok from here.</p>\n\n<p>now ,use the cgo load the libxxx.so,and use the <strong>myprint</strong> function:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdio.h&gt;\n#cgo linux CFLAGS: -I../../include\n#cgo linux LDFLAGS: -L../../lib/linux -lxxx\n#include \"xxx.h\"\n*/\nimport \"C\"\n\nfunct main() {\n    C.myprint(C.CString(\"xxx\"))\n}\n</code></pre>\n\n<p>then, build the go demo:</p>\n\n<pre><code>go build test.go\n</code></pre>\n\n<p>as my title show:</p>\n\n<pre><code>error: undefined reference to 'myprint'\n</code></pre>\n\n<p>i ensure the path of lib/head file is right, Who can help me find the reason? thx.</p>\n"}, {"tags": ["go", "docker", "docker-compose", "dockerfile", "docker-registry"], "answers": [{"comments": [{"owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "edited": false, "score": 0, "creation_date": 1467720120, "post_id": 38202681, "comment_id": 63829650, "body": "thank you but do you know how can I run it in background that is docker run -d ubuntu:latest (with the -d flag)"}, {"owner": {"reputation": 96, "user_id": 5540148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be2f92db057ffdbdc26ef5dc97dbcae?s=128&d=identicon&r=PG", "display_name": "drlogout", "link": "https://stackoverflow.com/users/5540148/drlogout"}, "reply_to_user": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "edited": false, "score": 3, "creation_date": 1467720369, "post_id": 38202681, "comment_id": 63829803, "body": "You can start the container with <code>docker.StartContainer(container.ID, &amp;docker.HostConfig{})</code>"}], "tags": [], "owner": {"reputation": 96, "user_id": 5540148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be2f92db057ffdbdc26ef5dc97dbcae?s=128&d=identicon&r=PG", "display_name": "drlogout", "link": "https://stackoverflow.com/users/5540148/drlogout"}, "is_accepted": true, "score": 5, "last_activity_date": 1467719275, "creation_date": 1467719275, "answer_id": 38202681, "question_id": 38202406, "link": "https://stackoverflow.com/questions/38202406/how-to-create-a-container-in-docker-remote-api-go-dockerclient/38202681#38202681", "title": "How to Create a Container in docker remote api? (go-dockerclient)", "body": "<p>You can specify the image in the Config struct:</p>\n\n<pre><code> container, err := client.CreateContainer(docker.CreateContainerOptions{\n    Name: \"container name\",\n    Config: &amp;docker.Config{\n      Image: \"ubuntu:latest\",\n    },\n })\n</code></pre>\n"}], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 0, "accepted_answer_id": 38202681, "answer_count": 1, "score": 1, "last_activity_date": 1467719275, "creation_date": 1467718429, "question_id": 38202406, "link": "https://stackoverflow.com/questions/38202406/how-to-create-a-container-in-docker-remote-api-go-dockerclient", "title": "How to Create a Container in docker remote api? (go-dockerclient)", "body": "<p>I am using <a href=\"https://github.com/fsouza/go-dockerclient\" rel=\"nofollow\">go-dockerclient</a> library and i want to create container using the <a href=\"https://godoc.org/github.com/fsouza/go-dockerclient#Client.CreateContainer\" rel=\"nofollow\">CreateContainer</a> go-dockerclient method but where should I pass the docker image id \nI created this function </p>\n\n<pre><code>func CreateContainer(w http.ResponseWriter, r *http.Request){\n\n    client,err:=docker.NewTLSClient(Endpoint,Cert,Key,Ca)\n    if err!=nil{\n        panic(err)\n    }\n    container,er:=client.CreateContainer(docker.CreateContainerOptions{Name:\"cont\"})\n    if er!=nil{\n        panic(err)\n    }\n\n }\n</code></pre>\n\n<p>for example if i have a given image id where should I add it? </p>\n"}, {"tags": ["go", "crash", "grpc"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1467704403, "post_id": 38197485, "comment_id": 63819966, "body": "Doing the same defer-recover in each function would is the brute-force way, of course, but leaving this open in case there&#39;s a gRPC-specific way. (Could factor it into <code>defer recoverPanic()</code> if you have to do it the verbose way.)"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 4, "creation_date": 1467704470, "post_id": 38197485, "comment_id": 63820002, "body": "<a href=\"https://github.com/kazegusuri/grpc-panic-handler\" rel=\"nofollow noreferrer\">github.com/kazegusuri/grpc-panic-handler</a> looks promising!"}, {"owner": {"reputation": 1182, "user_id": 4617571, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/93rlN.png?s=128&g=1", "display_name": "Mojtaba Asg", "link": "https://stackoverflow.com/users/4617571/mojtaba-asg"}, "edited": false, "score": 0, "creation_date": 1561286802, "post_id": 38197485, "comment_id": 100006667, "body": "I wonder why this is not implemented in GRPC itself?"}], "answers": [{"tags": [], "owner": {"reputation": 18637, "user_id": 8799, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/18e8e5cf629cace8465683d4f41d87c0?s=128&d=identicon&r=PG", "display_name": "Nathan Baulch", "link": "https://stackoverflow.com/users/8799/nathan-baulch"}, "is_accepted": false, "score": 2, "last_activity_date": 1575847972, "creation_date": 1575847972, "answer_id": 59240889, "question_id": 38197485, "link": "https://stackoverflow.com/questions/38197485/golang-grpc-how-to-recover-the-grpc-server-from-panic/59240889#59240889", "title": "Golang grpc: how to recover the grpc server from panic?", "body": "<p>Take a look at the recovery interceptor in the <a href=\"https://github.com/grpc-ecosystem/go-grpc-middleware\" rel=\"nofollow noreferrer\">Golang gRPC Middlewares</a> package. It recovers from panics in the request Goroutine and returns them as an internal gRPC error.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>myServer := grpc.NewServer(\n    grpc.StreamInterceptor(grpc_middleware.ChainStreamServer(\n        grpc_zap.StreamServerInterceptor(zapLogger),\n        grpc_auth.StreamServerInterceptor(myAuthFunction),\n        grpc_recovery.StreamServerInterceptor(),\n    )),\n    grpc.UnaryInterceptor(grpc_middleware.ChainUnaryServer(\n        grpc_zap.UnaryServerInterceptor(zapLogger),\n        grpc_auth.UnaryServerInterceptor(myAuthFunction),\n        grpc_recovery.UnaryServerInterceptor(),\n    )),\n)\n</code></pre>\n"}], "owner": {"reputation": 3680, "user_id": 1813875, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6078165a3f6a8693a0b1a1101e9260c7?s=128&d=identicon&r=PG", "display_name": "harryz", "link": "https://stackoverflow.com/users/1813875/harryz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2949, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1575847972, "creation_date": 1467703245, "question_id": 38197485, "link": "https://stackoverflow.com/questions/38197485/golang-grpc-how-to-recover-the-grpc-server-from-panic", "title": "Golang grpc: how to recover the grpc server from panic?", "body": "<p>I have a handler like this:</p>\n\n<pre><code>func (daemon *Daemon) List(item string) (map[string][]string, error) {\n      panic(\"this is a panic\")\n      ...\n</code></pre>\n\n<p>I just want to recover this potential panic, so in my grpc server I wrote:</p>\n\n<pre><code>// Serve serves gRPC request by goroutines\nfunc (s *ServerRPC) Serve(addr string) error {\n    defer func() {\n        if err := recover(); err != nil {\n            glog.Errorf(\"Recovered from err: \", err)\n        }\n    }()\n\n    l, err := net.Listen(\"tcp\", addr)\n    if err != nil {\n        glog.Fatalf(\"Failed to listen %s: %v\", addr, err)\n        return err\n    }\n\n    return s.server.Serve(l)\n}\n</code></pre>\n\n<p>But it does not capture the panic, I thought it was because my panic happened in child goroutines? If so, how can I recover my grpc server from crashing properly?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-sqs"], "comments": [{"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 2, "creation_date": 1467723831, "post_id": 38196726, "comment_id": 63832314, "body": "There is no connection that you can check. <code>Session</code> is just a fancy word for a shared configuration in the AWS SDk."}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "reply_to_user": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1467725864, "post_id": 38196726, "comment_id": 63833767, "body": "So will it disconnect ? I&#39;m trying to use long polling so I have to use this <code>svc</code> in loop or repeatedly"}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 1, "creation_date": 1467726279, "post_id": 38196726, "comment_id": 63834058, "body": "That has nothing todo with creating the  <code>sqs.SQS</code> struct. When you long poll, the client will wait for the specified time (max. 20 sec on SQS) for a message to return. The func <code>func (*SQS) ReceiveMessage</code> will either return after the specified time or if a message became available"}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "reply_to_user": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1467741035, "post_id": 38196726, "comment_id": 63843249, "body": "Yes I know what long polling is. What I&#39;m trying to ask is will the <code>sess&#47;svc</code> ever fail to fetch data from SQS because of getting disconnected and what errors do i need to take care of?"}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 1, "creation_date": 1467741622, "post_id": 38196726, "comment_id": 63843519, "body": "<code>ReceiveMessage</code> returns an error, that will be <code>!= nil</code> if an error occured."}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "reply_to_user": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1469015430, "post_id": 38196726, "comment_id": 64362970, "body": "so if I create <code>sess&#47;svc</code> in loop/for each call, is it a bad practice or a heavy operation?"}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1469016918, "post_id": 38196726, "comment_id": 64364024, "body": "Yes, you should create it once per queue you are using."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 4555390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ER4m3YfQ670/AAAAAAAAAAI/AAAAAAAABS4/SbBUxYhr2CA/photo.jpg?sz=128", "display_name": "crookedstorm", "link": "https://stackoverflow.com/users/4555390/crookedstorm"}, "is_accepted": false, "score": 1, "last_activity_date": 1470332297, "creation_date": 1470332297, "answer_id": 38773993, "question_id": 38196726, "link": "https://stackoverflow.com/questions/38196726/go-aws-sqs-sdk-how-to-check-if-session-is-connected-disconnected/38773993#38773993", "title": "Go AWS SQS SDK: How to check if session is connected/disconnected", "body": "<p>My solution for this was to insert a message into the queue with an easily picked out value after so many iterations without receiving a message.  The truth was that I had a goroutine hanging, but I used this to rule out the SQS connection.</p>\n\n<p>I called it a pingcounter and did something like:</p>\n\n<pre><code>pingCounter := 0\n    for {\n        if debug {\n            log.Println(\"worker: Start polling\")\n        }\n        if pingCounter &gt; 9 {\n            params := &amp;sqs.SendMessageInput{\n                QueueUrl: aws.String(queueName),\n                MessageBody: aws.String(\"PING\"),\n            }\n            _, err := svc.SendMessage(params)\n            if awsErr, ok := err.(awserr.Error); ok {\n                log.Println(awsErr.Message())\n            } else {\n                log.Println(err)\n            }\n...gather messsages and do stuff...\nif not:\npingCounter++\n</code></pre>\n\n<p>My worker code took any message that was simply full of PING and wrote it to the log, then deleted it.  The session and service objects don't provide any other methods for testing connection besides using them in a verifiable way.  </p>\n"}], "owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 845, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1573154398, "creation_date": 1467700715, "last_edit_date": 1573154398, "question_id": 38196726, "link": "https://stackoverflow.com/questions/38196726/go-aws-sqs-sdk-how-to-check-if-session-is-connected-disconnected", "title": "Go AWS SQS SDK: How to check if session is connected/disconnected", "body": "<pre><code>var svc *sqs.SQS = nil\n\nfunc returnSvcInstance() *sqs.SQS{\n\n\n                if svc == nil || condition (check if not connected) { //check if it is connected?\n\n                    sess := session.New(&amp;aws.Config{\n                        Region : aws.String(REGION),\n                        Credentials: CREDS,\n                    })\n\n                    svc = sqs.New(sess)     \n                }\n\n                return svc\n}\n</code></pre>\n\n<p>I'm writing a method that returns instance if it is nil or not connected. How to check if it is still connected?</p>\n"}, {"tags": ["http", "go", "web-crawler"], "answers": [{"comments": [{"owner": {"reputation": 927, "user_id": 1174972, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c21f35146c9eedc7b990c367ec86dcdc?s=128&d=identicon&r=PG", "display_name": "shicky", "link": "https://stackoverflow.com/users/1174972/shicky"}, "edited": false, "score": 0, "creation_date": 1467699005, "post_id": 38196209, "comment_id": 63817217, "body": "Thanks for the quick answer. Are you saying the net/http <b>won&#39;t send TCP packets</b> to read body until <b>ioutil.ReadAll(httpResponse.Body)</b> is called?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 927, "user_id": 1174972, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c21f35146c9eedc7b990c367ec86dcdc?s=128&d=identicon&r=PG", "display_name": "shicky", "link": "https://stackoverflow.com/users/1174972/shicky"}, "edited": false, "score": 0, "creation_date": 1467699987, "post_id": 38196209, "comment_id": 63817684, "body": "If the client does not read the response body, then the server sends data until the TCP window fills or the client closes the connection. Closing the response body is the only option for reducing the amount of data transferred over the network."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1467700085, "last_edit_date": 1467700085, "creation_date": 1467698704, "answer_id": 38196209, "question_id": 38195991, "link": "https://stackoverflow.com/questions/38195991/does-getting-response-from-request-get-all-of-the-body-golang-net-http/38196209#38196209", "title": "Does getting Response from Request get all of the body? (golang, net/http)", "body": "<p>The application should Close the response body if the application does not want to read it. In recent versions of Go, the net/http <a href=\"https://github.com/golang/go/commit/ce8341554caa8be64aeafd9bf2077a98db462fda\" rel=\"nofollow\">client will close the underlying network connection instead of slurping up the remainder of the response body from the network</a>.</p>\n\n<p>The Content-Length header may not be set. In this case, the application should read up to the threshold number of bytes or EOF. </p>\n\n<p>In all cases, close the response body when the application is done with the response.</p>\n\n<p>There is no guarantee that the response to a HEAD request includes a Content-Length header.</p>\n"}], "owner": {"reputation": 927, "user_id": 1174972, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c21f35146c9eedc7b990c367ec86dcdc?s=128&d=identicon&r=PG", "display_name": "shicky", "link": "https://stackoverflow.com/users/1174972/shicky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2004, "favorite_count": 0, "accepted_answer_id": 38196209, "answer_count": 1, "score": 0, "last_activity_date": 1467700085, "creation_date": 1467697716, "last_edit_date": 1467698302, "question_id": 38195991, "link": "https://stackoverflow.com/questions/38195991/does-getting-response-from-request-get-all-of-the-body-golang-net-http", "title": "Does getting Response from Request get all of the body? (golang, net/http)", "body": "<p>I am trying to avoid wasting traffic by reading http response body only when I see correct <strong>content-type</strong> and <strong>content-length</strong> smaller than set threshold.</p>\n\n<pre><code>httpRequest, err := http.NewRequest(\"GET\", url, nil)\nhttpResponse, err := httpClient.Do(httpRequest)\ncontentType := httpResponse.Header.Get(\"Content-Type\")\n\n// ... check for correct contentType    \n\n// Read body into memory?\ncontent, err := ioutil.ReadAll(httpResponse.Body)\n</code></pre>\n\n<p>Is it correct assumption that if I make GET request, I will be getting all the body regardless whether I call last line <strong>iotuil.ReadAll(httpResponse.Body)</strong>  or not?</p>\n\n<p>If so, the only way I could think of avoiding wasting traffic is to use HEAD request, but I would have to make another GET request if I actually want to read the body. Also do I get correct <strong>content-length</strong> value if I make HEAD request?</p>\n\n<p>What would be the best strategy?</p>\n"}, {"tags": ["go", "grafana", "delve"], "comments": [{"owner": {"reputation": 3953, "user_id": 234405, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/75038c606930e15c0e346c31ad1246b3?s=128&d=identicon&r=PG", "display_name": "zapping", "link": "https://stackoverflow.com/users/234405/zapping"}, "edited": false, "score": 0, "creation_date": 1467699170, "post_id": 38195343, "comment_id": 63817296, "body": "Formatted and corrected typo"}], "answers": [{"tags": [], "owner": {"reputation": 3778, "user_id": 79941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/icKxy.png?s=128&g=1", "display_name": "Carl Bergquist", "link": "https://stackoverflow.com/users/79941/carl-bergquist"}, "is_accepted": false, "score": 3, "last_activity_date": 1486641715, "creation_date": 1486641715, "answer_id": 42136215, "question_id": 38195343, "link": "https://stackoverflow.com/questions/38195343/grafana-code-debugging/42136215#42136215", "title": "Grafana Code Debugging", "body": "<p>The grafana-server main.go file is not located in the root directory. Try <code>cd pkg/cmd/grafana-server</code> and start from there. </p>\n"}], "owner": {"reputation": 165, "user_id": 4392872, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-gPoqzY1CSVI/AAAAAAAAAAI/AAAAAAAACf4/zzlc9Idk8fM/photo.jpg?sz=128", "display_name": "Sai Chaitanya", "link": "https://stackoverflow.com/users/4392872/sai-chaitanya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 925, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1486641715, "creation_date": 1467694091, "last_edit_date": 1467699170, "question_id": 38195343, "link": "https://stackoverflow.com/questions/38195343/grafana-code-debugging", "title": "Grafana Code Debugging", "body": "<p>I am newbie to Grafana, I have installed Grafana and did all the instructions given in the read me file. I'm using <strong>Visual Code</strong> for go lang now I just want to debug the Grafana code so that I can understand the process.</p>\n\n<p>Can any one suggest me what I have to do. I have heard of debugger called Delve. Can any one tell me how to use it because when I use Delve it says that there is no build-able source files in the location.</p>\n\n<p>I Have followed following Links :\n        <a href=\"https://github.com/grafana/grafana\" rel=\"noreferrer\">https://github.com/grafana/grafana</a> , <a href=\"https://github.com/derekparker/delve\" rel=\"noreferrer\">https://github.com/derekparker/delve</a> </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1467687926, "creation_date": 1467687926, "answer_id": 38194647, "question_id": 38194137, "link": "https://stackoverflow.com/questions/38194137/graceful-restart-of-a-server-with-active-websocket-connections-in-go/38194647#38194647", "title": "Graceful restart of a server with active WebSocket connections in Go", "body": "<p>Write the application to handle reconnects. Server restarts are just one reason that a connection might be dropped.</p>\n\n<p>To restart a server with websockets (or any type of long-lived connection), start the new server, stop listening for connections on the old server and drain the connections on the old server by closing the connections. If the application is written to handle reconnects, then the server restart should not be visible to the user.</p>\n\n<p>It's helpful to drain the connections instead of closing them all in one fell swoop. This avoids a denial of service attack by your own clients as they reconnect, authenticate, query database for message backlogs, etc. etc.</p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 1, "accepted_answer_id": 38194647, "answer_count": 1, "score": 0, "last_activity_date": 1467687926, "creation_date": 1467683468, "question_id": 38194137, "link": "https://stackoverflow.com/questions/38194137/graceful-restart-of-a-server-with-active-websocket-connections-in-go", "title": "Graceful restart of a server with active WebSocket connections in Go", "body": "<p>I had a look at this library from Facebook:</p>\n\n<p><a href=\"https://github.com/facebookgo/grace\" rel=\"nofollow\">https://github.com/facebookgo/grace</a></p>\n\n<p>And some others like this one:</p>\n\n<p><a href=\"https://github.com/fvbock/endless\" rel=\"nofollow\">https://github.com/fvbock/endless</a></p>\n\n<p>That let's me do graceful restarts of Go servers so that I have zero downtime and so that I can finish up the ongoing requests preventing data to be corrupted and so on.</p>\n\n<p>But I am wondering how this would work if I had active WebSocket connections while doing this? Would the old server never stop running since there are active WebSocket connections? I don't care too much about the WebSocket connections I only care about the normal requests being served before shutting down the old server and firing up the new updated compiled file that will serve the new logic.</p>\n\n<p>How will this behave with WebSockets?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 18450, "user_id": 426493, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d5611bf4165ba8f4806886e2877bda48?s=128&d=identicon&r=PG", "display_name": "ab11", "link": "https://stackoverflow.com/users/426493/ab11"}, "edited": false, "score": 0, "creation_date": 1467683029, "post_id": 38193992, "comment_id": 63813401, "body": "thanks, this worked perfectly. Well we&#39;re at it, my struct has a slice in it which may be nil, any suggestions on how to print the nil as &#39;[]&#39; when marshaled to json?"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 1, "last_activity_date": 1467682302, "last_edit_date": 1467682302, "creation_date": 1467681978, "answer_id": 38193992, "question_id": 38193960, "link": "https://stackoverflow.com/questions/38193960/how-to-pretty-print-json-with-brackets/38193992#38193992", "title": "How to pretty print JSON with brackets?", "body": "<p>Just wrap your variable <code>x</code> in a single element slice. The slice gets encoded to a JSON array (which use the square brackets):</p>\n\n<pre><code>j, err := json.MarshalIndent([]interface{}{x}, \"\", \"  \")\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Q9kqTdwoO6\" rel=\"nofollow\">https://play.golang.org/p/Q9kqTdwoO6</a></p>\n"}], "owner": {"reputation": 18450, "user_id": 426493, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d5611bf4165ba8f4806886e2877bda48?s=128&d=identicon&r=PG", "display_name": "ab11", "link": "https://stackoverflow.com/users/426493/ab11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1268, "favorite_count": 0, "accepted_answer_id": 38193992, "answer_count": 1, "score": 1, "last_activity_date": 1467682302, "creation_date": 1467681540, "last_edit_date": 1467682300, "question_id": 38193960, "link": "https://stackoverflow.com/questions/38193960/how-to-pretty-print-json-with-brackets", "title": "How to pretty print JSON with brackets?", "body": "<p>I am able to nicely indent my JSON with the below code, it prints something like first output. But I would like the output to be enclosed with an array and to be properly indented, like in the second output.</p>\n\n<pre><code>j, err := json.MarshalIndent(x, \"\", \"  \")\nif err != nil {\n    fmt.Println(err)\n} else {\n    fmt.Println(string(j))\n}\n\n{\n    \"A\" : \"x\",\n    \"B\" : \"y\",\n    \"C\" : [\n        { \n            \"A\" ...\n        }\n    ]\n}\n</code></pre>\n\n<p>Like so.</p>\n\n<pre><code>[\n    {\n        \"A\" : \"x\",\n        \"B\" : \"y\",\n        \"C\" : [\n           { \n              \"A\" ...\n           }\n\n        ]\n    }\n]\n</code></pre>\n"}, {"tags": ["go", "mqtt", "tls1.2", "paho"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 6549136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4684c2ce432a99200eb03607807eaf0f?s=128&d=identicon&r=PG&f=1", "display_name": "Tibo", "link": "https://stackoverflow.com/users/6549136/tibo"}, "is_accepted": true, "score": 4, "last_activity_date": 1467699934, "last_edit_date": 1592644375, "creation_date": 1467699934, "answer_id": 38196507, "question_id": 38192943, "link": "https://stackoverflow.com/questions/38192943/paho-mqtt-golang-protocol/38196507#38196507", "title": "Paho MQTT Golang Protocol", "body": "<p>I fixed it. Just forgot to precise the protocol at the beginning of the url.</p>\n<blockquote>\n<p>The type of connection required is specified by the scheme of the connection URL set in the ClientOptions struct, for example:</p>\n<p>tcp://iot.eclipse.org:1883 - connect to iot.eclipse.org on port 1883 using plain TCP\nws://iot.eclipse.org:1883 - connect to iot.eclipse.org on port 1883 using WebSockets\ntls://iot.eclipse.org:8883 - connect to iot.eclipse.org on port 8883 using TLS (ssl:// and tcps:// are synonyms for tls://)</p>\n</blockquote>\n<p>That works :-)</p>\n"}], "owner": {"reputation": 51, "user_id": 6549136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4684c2ce432a99200eb03607807eaf0f?s=128&d=identicon&r=PG&f=1", "display_name": "Tibo", "link": "https://stackoverflow.com/users/6549136/tibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1376, "favorite_count": 0, "accepted_answer_id": 38196507, "answer_count": 1, "score": 1, "last_activity_date": 1616069970, "creation_date": 1467671344, "last_edit_date": 1592644375, "question_id": 38192943, "link": "https://stackoverflow.com/questions/38192943/paho-mqtt-golang-protocol", "title": "Paho MQTT Golang Protocol", "body": "<p>I'm new on Golang and mqtt.</p>\n<p>I'm trying to connect to a broker. It works when I'm using MQTT.fx or my terminal with mosquitos.</p>\n<p>But in my program, I create my opts with the address &amp; clientID and when I try to connect there is an error &quot;Unknow protocol&quot;</p>\n<blockquote>\n<p>panic: Network Error : Unknown protocol</p>\n<p>goroutine 1 [running]:</p>\n<p>panic(0x347b20, 0xc820072fe0)</p>\n<p>/usr/local/go/src/runtime/panic.go:481 +0x3e6</p>\n<p>main.main()</p>\n<p>test.go:29 +0x1cd</p>\n</blockquote>\n<p>I checked the protocol version on MQTT.fx and it's TLSv1.2.</p>\n<p>The Paho library support TLS protocol. I'm a bit confused</p>\n<p>Is there someone who got the same issue ?</p>\n<p>Cheers</p>\n"}, {"tags": ["windows", "winapi", "go"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1467671307, "post_id": 38191972, "comment_id": 63811280, "body": "<i>&quot;HRESULT naturally contains the error code E_NOINTERFACE (2147500034), which makes sense seeing as I&#39;m not passing a valid interface.&quot;</i> - I don&#39;t see, why that makes sense. The <i>ppv</i> argument to <code>SHGetImageList</code> is an <b>out</b> parameter. It is returned by the API call. You are required to pass the address of a pointer that receives the interface pointer on return."}, {"owner": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1467675488, "post_id": 38191972, "comment_id": 63812143, "body": "The E_NOINTERFACE return value is from the syscall itself, not related to the pointer or the arguments/data I&#39;m passing IN the syscall. If the syscall is successful it should return <code>S_OK</code> which is 0. For me it &quot;makes sense&quot; that I&#39;d get the &quot;no interface&quot; error code because presumably that&#39;s what Windows returns when it doesn&#39;t see the third(the ppv) argument in that syscall as a &quot;valid&quot; interface (?)"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1467676017, "post_id": 38191972, "comment_id": 63812240, "body": "Windows doesn&#39;t know what <code>ppv</code> is. It uses the <code>iid</code> to determine which interface to use. I wonder if <code>SHGetImageList()</code> supports IImageList2... Which IImageList2 method did you need to call?"}, {"owner": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467676246, "post_id": 38191972, "comment_id": 63812286, "body": "Only GetIcon. <code>SHGetImageList()</code> works with <code>IImageList2</code> in C#, I&#39;ll give IImageList a try right now."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467675239, "post_id": 38193068, "comment_id": 63812093, "body": "First off, thanks for the reply! But unfortunately, unless I&#39;m missing something, this doesn&#39;t solve the actual problem at hand. What you&#39;re saying makes perfect sense. But even when passing the <code>var imglist *IImageList2</code> to the procSHGetImageList call, I&#39;m still left with a E_NOINTERFACE return value and a nil pointer. Any thoughts?  (P.S. I&#39;ve tried both with and without CoInitialize())"}, {"owner": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467682635, "post_id": 38193068, "comment_id": 63813330, "body": "Another question, been trying for a while now, and calling it like you described with <code>syscall.Syscall(...)</code> but I&#39;m only getting access violation errors (0xc0000005). Any ideas why? I&#39;ll check back tomorrow, I desperately need some sleep."}, {"owner": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467728251, "post_id": 38193068, "comment_id": 63835552, "body": "Sure, I updated the original post with the current code. I&#39;ve also tried some variations with Syscall6 and so on without really getting anywhere, the current Syscall has the same format as you had in your original reply. (Although you had a separate <code>instance</code> and <code>imglist</code> but I&#39;m <i>guessing</i> that&#39;s more of a &quot;typo&quot;?)"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "reply_to_user": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467731106, "post_id": 38193068, "comment_id": 63837661, "body": "<code>hIcon</code> is an output parameter; you want to pass its address (<code>&amp;hIcon</code>)."}, {"owner": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467735829, "post_id": 38193068, "comment_id": 63840616, "body": "Yeah sorry about that, was just a typo. Deleted the multiple syscalls I had while testing and wrote the one you see to just generate the error. But this doesn&#39;t fix the issue, regardless of how I&#39;m passing hIcon the error is the same. Could it be something with the arguments? I&#39;m unsure as to why the second argument passed in your example is <code>uintptr(unsafe.Pointer(imglist))</code> when from what I can tell it should be an int telling Go how many arguments are actually used in the Syscall. (Note that I&#39;ve tried some variations of this as well with no success)"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "reply_to_user": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467736648, "post_id": 38193068, "comment_id": 63841067, "body": "Ah, if I got the <code>syscall.Syscall()</code> wrong you should just follow what godoc says to use. I can fix my answer if that&#39;s the problem."}, {"owner": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467736948, "post_id": 38193068, "comment_id": 63841234, "body": "Yeah I think you did, but the thing is, if I use what I think is the right approach: <code>hr, _, _ = syscall.Syscall(imglist.Vtbl.GetIcon, 3, uintptr(iconIndex), getIconFlags, uintptr(unsafe.Pointer(&amp;hIcon)))</code> Then I&#39;m left with a hIcon == 0 and a hresult with the error E_NOTIMPL (0x80004001). Which is where I&#39;m stuck at the moment, any thoughts on this?"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "reply_to_user": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467737968, "post_id": 38193068, "comment_id": 63841728, "body": "You forgot the <code>imglist</code> parameter in that call. It should be <code>hr, _, _ = syscall.Syscall(imglist.Vtbl.GetIcon, 4, uintptr(unsafe.Pointer(imglist)), uintptr(iconIndex), getIconFlags, uintptr(unsafe.Pointer(&amp;hIcon)))</code>"}, {"owner": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467740363, "post_id": 38193068, "comment_id": 63842905, "body": "Yeah I&#39;ve tried that too, you need to use Syscall6, currently that would look like this: <code>hr, _, _ = syscall.Syscall6(imglist.Vtbl.GetIcon, 4, uintptr(unsafe.Pointer(imglist)), uintptr(iconIndex), getIconFlags, uintptr(unsafe.Pointer(&amp;hIcon)), 0, 0)</code> but it still results in the same E_NOTIMPL hresult, and I don&#39;t know why."}, {"owner": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467749198, "post_id": 38193068, "comment_id": 63847594, "body": "Never mind, it &quot;is&quot; working. The current problem seems to be that it doesn&#39;t retrieve a handle for SHIL_JUMBO. While a C++ version of it I made gets the SHIL_JUMBO handle just fine, so it&#39;s probably an entirely different issue. Anyways, again, thanks for your help."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "reply_to_user": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467750185, "post_id": 38193068, "comment_id": 63848103, "body": "No problem. If the code is correct, then I wouldn&#39;t know as I&#39;m not familiar with those APIs, sorry. Good luck!"}], "tags": [], "owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "is_accepted": false, "score": 1, "last_activity_date": 1467672297, "creation_date": 1467672297, "answer_id": 38193068, "question_id": 38191972, "link": "https://stackoverflow.com/questions/38191972/call-shgetimagelist-in-go/38193068#38193068", "title": "Call SHGetImageList in Go", "body": "<p>Interfacing COM with Go is going to be <strong>painful</strong>.</p>\n\n<p>A COM interface like IImageList2 is a list of function pointers, and you can't use those C function pointers from Go directly; you have to use <code>syscall.Syscall()</code> and its siblings (depending on the number of arguments the individual function takes) to call them.</p>\n\n<p>At its core, a COM interface instance is a structure whose first and only field is a pointer to this list of methods. So it'd be something along the lines of</p>\n\n<pre><code>type IImageList2Vtbl struct {\n    QueryInterface uintptr\n    AddRef         uintptr\n    Release        uintptr\n|\n\ntype IImageList2 struct {\n    Vtbl *IImageList2Vtbl\n}\n</code></pre>\n\n<p>When you pass a pointer to a variable of type <code>IImageList2</code> to the Windows API function you call to create that object, be it <code>SHGetImageList()</code>, <code>CoCreateInstance()</code>, <code>D3D11CreateDeviceAndSwapChain()</code>, or what have you, the system will fill in the <code>Vtbl</code> entry with a pointer in <strong>read-only</strong> system memory that contains the list of functions.</p>\n\n<p>So the first thing you have to do is make sure the methods are in the right order, so the Go structure <code>IImageList2Vtbl</code> and the list that Windows will give you match. Unfortunately, MSDN isn't good at this; you'll have to spelunk through the header files. Here's what I get:</p>\n\n<pre><code>type IImageList2Vtbl struct {\n    QueryInterface       uintptr\n    AddRef               uintptr\n    Release              uintptr\n    Add                  uintptr\n    ReplaceIcon          uintptr\n    SetOverlayImage      uintptr\n    Replace              uintptr\n    AddMasked            uintptr\n    Draw                 uintptr\n    Remove               uintptr\n    GetIcon              uintptr\n    GetImageInfo         uintptr\n    Copy                 uintptr\n    Merge                uintptr\n    Clone                uintptr\n    GetImageRect         uintptr\n    GetIconSize          uintptr\n    SetIconSize          uintptr\n    GetImageCount        uintptr\n    SetImageCount        uintptr\n    SetBkColor           uintptr\n    GetBkColor           uintptr\n    BeginDrag            uintptr\n    EndDrag              uintptr\n    DragEnter            uintptr\n    DragLeave            uintptr\n    DragMove             uintptr\n    SetDragCursorImage   uintptr\n    DragShowNolock       uintptr\n    GetDragImage         uintptr\n    GetItemFlags         uintptr\n    GetOverlayImage      uintptr\n    Resize               uintptr\n    GetOriginalSize      uintptr\n    SetOriginalSize      uintptr\n    SetCallback          uintptr\n    GetCallback          uintptr\n    ForceImagePresent    uintptr\n    DiscardImages        uintptr\n    PreloadImages        uintptr\n    GetStatistics        uintptr\n    Initialize           uintptr\n    Replace2             uintptr\n    ReplaceFromImageList uintptr\n}\n</code></pre>\n\n<blockquote>\n  <p><i>I'm sure I got this wrong; please report any errors. :)</i></p>\n</blockquote>\n\n<p>This comes from <code>commoncontrols.h</code>. Go with the C-style, not C++-style, interface definitions (if there are more than one), as that will have all the methods, including those of interfaces that IImageList2 derives from (IUnknown, which all interfaces derive from, and IImageList).</p>\n\n<p>Er wait, I lied: Windows doesn't expect you to give it the memory for the IImageList2. That's because COM interfaces are just like Go interfaces: they're a set of methods that any implementation can implement. So in reality you have to let Windows give you a pointer to an <code>IImageList2</code>, not an <code>IImageList2Vtbl</code>.</p>\n\n<p>So what do we do? We store each instance as a pointer to the interface, and then pass a pointer to <em>that</em> to the creation functions.</p>\n\n<p>So from that, we have</p>\n\n<pre><code>var imglist *IImageList2\nhr, _, _ := procSHGetImageList.Call(\n    uintptr(SHIL_JUMBO),\n    uintptr(unsafe.Pointer(&amp;IID_IImageList2)),\n    uintptr(unsafe.Pointer(&amp;imglist)),\n)\n</code></pre>\n\n<p>Notice that we pass a pointer to the IImageList2. I'll call this the <em>instance</em>, and the <code>Vtbl</code> member the <em>vtable</em>.</p>\n\n<p>Now when you want to <em>call</em> a method, you have to add an extra first parameter: the <em>instance</em> itself. You can look on MSDN for the return types and other parameters:</p>\n\n<pre><code>// HRESULT EndDrag(void);\nhr, _, _ = syscall.Syscall(instance.Vtbl.EndDrag,\n    uintptr(unsafe.Pointer(imglist)))\n// HRESULT SetOverlayImage(int, int);\nhr, _, _ = syscall.Syscall(instance.Vtbl.SetOverlayImage,\n    uintptr(unsafe.Pointer(imglist)),\n    4,\n    2)\n</code></pre>\n\n<p>Notice that we pass <code>imglist</code> this time, not <code>&amp;imglist</code>.</p>\n\n<p>Now because C and C++ don't support multiple returns like Go does, functions typically return a HRESULT (the COM equivalent of Go's <code>error</code>) and have you pass in pointers to the rest of the return values at the end of the argument list. For other COM interfaces, we follow the rules above. For other type, we <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa383751(v=vs.85).aspx\" rel=\"nofollow\">refer to the Windows Data Types page</a> to see what each named type represents, and remember that C <code>int</code> is always Go <code>int32</code> on Windows, even on 64-bit systems.</p>\n\n<pre><code>// HRESULT AddMasked(HBITMAP, COLORREF, (OUT) int *);\n// we'll use uintptr for HBITMAP and int32 for COLORREF\nvar index int32\nhr, _, _ = syscall.Syscall(instance.Vtbl.AddMasked,\n    uintptr(unsafe.Pointer(instance)),\n    hbitmap,\n    mask,\n    uintptr(unsafe.Pointer(&amp;index)))\n</code></pre>\n\n<p>Finally, COM requires us to call the <code>Release()</code> method when we're done with an object. This takes no extra parameters and its return value is irrelevant. You can stuff this in a <code>defer</code> if you want.</p>\n\n<pre><code>syscall.Syscall(instance.Vtbl.Release,\n    uintptr(unsafe.Pointer(instance)))\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><em>Note: I don't know if <code>SHGetImageList()</code> requires COM to be initialized. If it doesn't, ignore this part until you need some other COM interface.</em></p>\n</blockquote>\n\n<p>Oh but that's not enough, because you also have to initialize COM. And COM can operate in a number of threading models. Only two are important: single-threaded apartment, which is used for anything related to GUI, and multithreaded apartment, which is used for special purposes.</p>\n\n<p>The <code>CoInitialize()</code>, <code>CoInitializeEx()</code>, and <code>CoUninitialize()</code> functions all handle COM initialization and uninitialization. You already know how to call them; they're just normal DLL functions.</p>\n\n<p>But beware! If you need a single-threaded apartment, <strong>you have to use <code>runtime.LockOSThread()</code> to ensure Go doesn't move the current goroutine to another OS thread from under you</strong>. If you don't do this, things will break in bizarre ways.</p>\n\n<hr>\n\n<p>This is all a load of work, and you have to do it for every interface you're going to use. You might as well use a package that someone already made that does the heavy lifting for you. There are several packages, such as <code>go-ole</code>, that do the basic stuff. I don't see one that provides <code>IImageList2</code>, but you might be able to piggyback off an existing one. <a href=\"https://github.com/search?utf8=%E2%9C%93&amp;q=IImageList+language%3AGo&amp;type=Code&amp;ref=searchresults\" rel=\"nofollow\">There seems to be only one reference for <code>IImageList</code>.</a></p>\n\n<p><strong>Good luck!</strong></p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "edited": false, "score": 0, "creation_date": 1467677238, "post_id": 38193521, "comment_id": 63812438, "body": ".. Yeah, silly mistake there. But that fixes it! Thanks a bunch for your help! Also tried the <code>StringFromGUID2</code> that you briefly suggested in a comment earlier and it matched the original strings."}], "tags": [], "owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "is_accepted": true, "score": 2, "last_activity_date": 1467676770, "creation_date": 1467676770, "answer_id": 38193521, "question_id": 38191972, "link": "https://stackoverflow.com/questions/38191972/call-shgetimagelist-in-go/38193521#38193521", "title": "Call SHGetImageList in Go", "body": "<p>Oh, I see the actual problem now.</p>\n\n<pre><code>        uintptr(unsafe.Pointer(&amp;IID_IImageList2)),\n...\nvar IID_IImageList2 = &amp;GUID{0x192b9d83, 0x50fc, 0x457b, [8]byte{0x90, 0xa0, 0x2b, 0x82, 0xa8, 0xb5, 0xda, 0xe1}}\n</code></pre>\n\n<p>Your <code>IID_IImageList2</code> is already a pointer. In your call, you're taking a pointer to that pointer, which means the address is used as the GUID. You should either do</p>\n\n<pre><code>        uintptr(unsafe.Pointer(&amp;IID_IImageList2)),\n...\nvar IID_IImageList2 = GUID{0x192b9d83, 0x50fc, 0x457b, [8]byte{0x90, 0xa0, 0x2b, 0x82, 0xa8, 0xb5, 0xda, 0xe1}}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>        uintptr(unsafe.Pointer(IID_IImageList2)),\n...\nvar IID_IImageList2 = &amp;GUID{0x192b9d83, 0x50fc, 0x457b, [8]byte{0x90, 0xa0, 0x2b, 0x82, 0xa8, 0xb5, 0xda, 0xe1}}\n</code></pre>\n\n<p>That way, the GUID itself is used as the GUID, not its location in memory.</p>\n"}], "owner": {"reputation": 43, "user_id": 2747374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a909cdd595bd379cd895dd5c12b849?s=128&d=identicon&r=PG&f=1", "display_name": "Boogadi", "link": "https://stackoverflow.com/users/2747374/boogadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 2, "accepted_answer_id": 38193521, "answer_count": 2, "score": 4, "last_activity_date": 1467735528, "creation_date": 1467664907, "last_edit_date": 1467735528, "question_id": 38191972, "link": "https://stackoverflow.com/questions/38191972/call-shgetimagelist-in-go", "title": "Call SHGetImageList in Go", "body": "<p>I'm trying to call SHGetImageList in Go in order to extract icons from .EXE files. The problem is that I don't know how to create/pass an \"IImageList2 interface\" in Go, which is something SHGetImageList requires. </p>\n\n<p>I've tried miscellaneous things for a few hours, but it all results in the same E_NOINTERFACE error. Basically they're all \"shots in the dark\" ([]byte array to see if I could receive any \"data\" at all, an actual interface{} in Go containing the same functions as the IImagelist2 interface defined by MSDN, etc). If it is of any relevance, I do have a working version of this in C# using something along the lines of <a href=\"http://www.pinvoke.net/default.aspx/shell32.shgetimagelist\" rel=\"nofollow\">http://www.pinvoke.net/default.aspx/shell32.shgetimagelist</a>, but I simply have no real clue on how to \"translate\" that to Go. Any help would be much appreciated.</p>\n\n<p>Example Go code below, with some info and links to MSDN in the comments.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"syscall\"\n    \"unsafe\"\n)\n\nvar (\n    shell32 = syscall.MustLoadDLL(\"shell32.dll\")\n\n    // https://msdn.microsoft.com/en-us/library/windows/desktop/bb762179(v=vs.85).aspx\n    procSHGetFileInfo = shell32.MustFindProc(\"SHGetFileInfoW\")\n\n    //https://msdn.microsoft.com/en-us/library/windows/desktop/bb762185(v=vs.85).aspx\n    procSHGetImageList = shell32.MustFindProc(\"SHGetImageList\")\n)\n\nfunc main() {\n    someExeFile := `c:\\windows\\explorer.exe`\n\n    iconIndex := GetIconIndex(someExeFile)\n\n    // The problem:\n    HRESULT, _, _ := procSHGetImageList.Call(\n        uintptr(SHIL_JUMBO),\n        uintptr(unsafe.Pointer(&amp;IID_IImageList2)),\n\n        // I don't know how pass/create an \"IImageList interface\" in Go,\n        // or if it's even possible without relying on CGO.\n        // IImageList interface:\n        // https://msdn.microsoft.com/en-us/library/windows/desktop/bb761419(v=vs.85).aspx\n\n        // Currently there's just a pointer to an empty []byte so that the code will compile.\n        // HRESULT naturally contains the error code E_NOINTERFACE (2147500034),\n        // which makes sense seeing as I'm not passing a valid interface.\n        uintptr(unsafe.Pointer(&amp;[]byte{})),\n    )\n\n    fmt.Println(iconIndex, HRESULT)\n}\n\n\nconst SHIL_JUMBO = 0x4\n\nconst shGetFileInfoLen = 3\nconst shGetFileInfoFlags = 16400 //(SysIconIndex|LargeIcon|UseFileAttributes)\n// use SHGetFileInfo to get the icon index (only value we care about)\nfunc GetIconIndex(fileName string) int {\n    buf := make([]uint16, shGetFileInfoLen)\n    ret, _, _ := procSHGetFileInfo.Call(\n        uintptr(unsafe.Pointer(syscall.StringToUTF16Ptr(fileName))),\n        0,\n        uintptr(unsafe.Pointer(&amp;buf[0])),\n        shGetFileInfoLen,\n        shGetFileInfoFlags,\n    )\n\n    if ret != 0 &amp;&amp; buf[2] &gt; 0 {\n        return int(buf[2])\n    }\n\n    return 0\n}\n\n// From: \"192B9D83-50FC-457B-90A0-2B82A8B5DAE1\"\nvar IID_IImageList2 = &amp;GUID{0x192b9d83, 0x50fc, 0x457b, [8]byte{0x90, 0xa0, 0x2b, 0x82, 0xa8, 0xb5, 0xda, 0xe1}}\n\n// http://msdn.microsoft.com/en-us/library/windows/desktop/aa373931.aspx\ntype GUID struct {\n    Data1 uint32\n    Data2 uint16\n    Data3 uint16\n    Data4 [8]byte\n}\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>The problem now is that it's exiting with an error(0xC0000005) when calling the Syscall to get the actual icon pointer. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"syscall\"\n    \"unsafe\"\n)\n\nvar (\n    shell32 = syscall.MustLoadDLL(\"shell32.dll\")\n\n    // https://msdn.microsoft.com/en-us/library/windows/desktop/bb762179(v=vs.85).aspx\n    procSHGetFileInfo = shell32.MustFindProc(\"SHGetFileInfoW\")\n\n    //https://msdn.microsoft.com/en-us/library/windows/desktop/bb762185(v=vs.85).aspx\n    procSHGetImageList = shell32.MustFindProc(\"SHGetImageList\")\n\n    ole32 = syscall.MustLoadDLL(\"ole32.dll\")\n    procCoInitialize = ole32.MustFindProc(\"CoInitialize\")\n)\n\nfunc main() {\n    someExeFile := `c:\\windows\\explorer.exe`\n\n    procCoInitialize.Call()\n\n    iconIndex := GetIconIndex(someExeFile)\n\n    var imglist *IImageList\n    hr, _, _ := procSHGetImageList.Call(\n        uintptr(SHIL_JUMBO),\n        uintptr(unsafe.Pointer(&amp;IID_IImageList)),\n        uintptr(unsafe.Pointer(&amp;imglist)),\n    )\n\n    // These look OK\n    fmt.Println(iconIndex, hr, imglist.Vtbl.GetIcon)\n\n    var hIcon uintptr\n    // GetIcon: https://msdn.microsoft.com/en-us/library/windows/desktop/bb761463(v=vs.85).aspx\n    hr, _, _ = syscall.Syscall(imglist.Vtbl.GetIcon,\n        uintptr(unsafe.Pointer(imglist)),\n        uintptr(iconIndex),\n        getIconFlags,\n        uintptr(unsafe.Pointer(&amp;hIcon)),\n    )\n\n    // Errors: \"Process finished with exit code -1073741819 (0xC0000005)\"\n\n    fmt.Println(\"hIcon:\", hIcon) // Never reaches this\n}\n\n// ILD_TRANSPARENT | ILD_IMAGE\nconst getIconFlags = 0x00000001 | 0x00000020\n\nconst SHIL_JUMBO = 0x4\n\nconst shGetFileInfoLen = 3\nconst shGetFileInfoFlags = 16400 //(SysIconIndex|LargeIcon|UseFileAttributes)\n// use SHGetFileInfo to get the icon index (only value we care about)\nfunc GetIconIndex(fileName string) int {\n    buf := make([]uint16, shGetFileInfoLen)\n    ret, _, _ := procSHGetFileInfo.Call(\n        uintptr(unsafe.Pointer(syscall.StringToUTF16Ptr(fileName))),\n        0,\n        uintptr(unsafe.Pointer(&amp;buf[0])),\n        shGetFileInfoLen,\n        shGetFileInfoFlags,\n    )\n\n    if ret != 0 &amp;&amp; buf[2] &gt; 0 {\n        return int(buf[2])\n    }\n\n    return 0\n}\n\n\n// From: \"46EB5926-582E-4017-9FDF-E8998DAA0950\"\nvar IID_IImageList = GUID{0x46eb5926, 0x582e, 0x4017, [8]byte{0x9f, 0xdf, 0xe8, 0x99, 0x8d, 0xaa, 0x09, 0x50}}\n\n// http://msdn.microsoft.com/en-us/library/windows/desktop/aa373931.aspx\ntype GUID struct {\n    Data1 uint32\n    Data2 uint16\n    Data3 uint16\n    Data4 [8]byte\n}\n\ntype IImageList struct {\n    Vtbl *IImageListVtbl\n}\n\ntype IImageListVtbl struct {\n    Add                uintptr\n    ReplaceIcon        uintptr\n    SetOverlayImage    uintptr\n    Replace            uintptr\n    AddMasked          uintptr\n    Draw               uintptr\n    Remove             uintptr\n    GetIcon            uintptr\n    GetImageInfo       uintptr\n    Copy               uintptr\n    Merge              uintptr\n    Clone              uintptr\n    GetImageRect       uintptr\n    GetIconSize        uintptr\n    SetIconSize        uintptr\n    GetImageCount      uintptr\n    SetImageCount      uintptr\n    SetBkColor         uintptr\n    GetBkColor         uintptr\n    BeginDrag          uintptr\n    EndDrag            uintptr\n    DragEnter          uintptr\n    DragLeave          uintptr\n    DragMove           uintptr\n    SetDragCursorImage uintptr\n    DragShowNolock     uintptr\n    GetDragImage       uintptr\n    GetItemFlags       uintptr\n    GetOverlayImage    uintptr\n}\n</code></pre>\n"}, {"tags": ["go", "revel", "go-templates"], "comments": [{"owner": {"reputation": 173, "user_id": 4194833, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-hfIUlzOxai0/AAAAAAAAAAI/AAAAAAAABd4/nqpFrsKIiKw/photo.jpg?sz=128", "display_name": "Mangirdas", "link": "https://stackoverflow.com/users/4194833/mangirdas"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1467660284, "post_id": 38190622, "comment_id": 63807735, "body": "I have a feeling it may be due json I read (updated). But no idea whyit behaves like this"}, {"owner": {"reputation": 173, "user_id": 4194833, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-hfIUlzOxai0/AAAAAAAAAAI/AAAAAAAABd4/nqpFrsKIiKw/photo.jpg?sz=128", "display_name": "Mangirdas", "link": "https://stackoverflow.com/users/4194833/mangirdas"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1467660988, "post_id": 38190622, "comment_id": 63808038, "body": "There is no error from template. But now i start thinking its either JSON or Revel framework and how they implemented templates"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1467663335, "last_edit_date": 1467663335, "creation_date": 1467662188, "answer_id": 38191482, "question_id": 38190622, "link": "https://stackoverflow.com/questions/38190622/range-within-range-golang-template/38191482#38191482", "title": "range within range golang template", "body": "<p>The keywords are represented as an array of strings in the JSON. Change the Go types to match the JSON:</p>\n\n<pre><code>type SkillsInfo struct {\n  Name     string\n  Level    string\n  Keywords []string\n}\n</code></pre>\n\n<p>and use this template:</p>\n\n<pre><code>{{range .Resume.Skills}}    \n  {{.Name}}\n  {{.Level}}\n  {{range .Keywords}}\n     {{.}}\n  {{end}}\n{{end}}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/UR2EqXWU0F\" rel=\"noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 173, "user_id": 4194833, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-hfIUlzOxai0/AAAAAAAAAAI/AAAAAAAABd4/nqpFrsKIiKw/photo.jpg?sz=128", "display_name": "Mangirdas", "link": "https://stackoverflow.com/users/4194833/mangirdas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7009, "favorite_count": 1, "accepted_answer_id": 38191482, "answer_count": 1, "score": 6, "last_activity_date": 1467663335, "creation_date": 1467657672, "last_edit_date": 1467660396, "question_id": 38190622, "link": "https://stackoverflow.com/questions/38190622/range-within-range-golang-template", "title": "range within range golang template", "body": "<p>How to access range within range in Go templates?</p>\n\n<p>Template:</p>\n\n<pre><code>{{range .Resume.Skills}}    \n    {{.Name}}\n    {{.Level}}\n    {{range $item, $key := .Keywords}}\n            {{$key}}\n            {{$item}}\n    {{end}}\n{{end}}\n</code></pre>\n\n<p>Struct:</p>\n\n<pre><code>type SkillsInfo struct {\n    Name     string\n    Level    string\n    Keywords []KeywordsInfo\n}\n\ntype KeywordsInfo struct {\n    Keyword string\n}\n</code></pre>\n\n<p>result I can see is {}. How can I access Nested Objects in Templates? </p>\n\n<p>---Update--:</p>\n\n<pre><code>type ResumeJson struct {\n    Basics       BasicsInfo\n    Work         []WorkInfo\n    Volunteer    []VolunteerInfo\n    Education    []EducationInfo\n    Awards       []AwardsInfo\n    Publications []PublicationsInfo\n    Skills       []SkillsInfo\n    Languages    []LaunguagesInfo\n    Interests    []InterestsInfo\n    References   []ReferencesInfo\n}\n</code></pre>\n\n<p>Result seen now:</p>\n\n<p>Web Development Master {} 0 {} 1 {} 2</p>\n\n<p>ans JSON I parse:</p>\n\n<pre><code> \"skills\": [{\n    \"name\": \"Web Development\",\n    \"level\": \"Master\",\n    \"keywords\": [\n         \"CSS\", \n         \"HTML\",\n      \"Javascript\"\n    ]\n  }],\n</code></pre>\n"}, {"tags": ["windows", "go"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 4, "last_activity_date": 1467681610, "creation_date": 1467681610, "answer_id": 38193964, "question_id": 38187789, "link": "https://stackoverflow.com/questions/38187789/specify-go-build-flag-h-windowsgui-in-code-comment/38193964#38193964", "title": "Specify Go build flag &quot;-H=windowsgui&quot; in code comment", "body": "<p>Bad news, you can't.</p>\n\n<p>Semi-good news, you can tell your users to use <code>go get -ldflags \"-H windowsgui\" github.com/my/app</code> on Windows.</p>\n"}], "owner": {"reputation": 3592, "user_id": 6276385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c7b071a5c25c2f6ccc6f1f41bdb2e3?s=128&d=identicon&r=PG&f=1", "display_name": "gonutz", "link": "https://stackoverflow.com/users/6276385/gonutz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 1, "accepted_answer_id": 38193964, "answer_count": 1, "score": 5, "last_activity_date": 1467681610, "creation_date": 1467644871, "question_id": 38187789, "link": "https://stackoverflow.com/questions/38187789/specify-go-build-flag-h-windowsgui-in-code-comment", "title": "Specify Go build flag &quot;-H=windowsgui&quot; in code comment", "body": "<p>I am creating a desktop Windows application in Go. Currently I use this line to install it:</p>\n\n<p><code>go install -ldflags -H=windowsgui</code></p>\n\n<p>I want users to be able to just say</p>\n\n<p><code>go get github.com/my/app</code></p>\n\n<p>and automatically have the <code>windowsgui</code> flag specified for building. Is it possible to add the flag as a code comment, like <code>#cgo</code> comments. Or would I have to provide a <code>make</code> file in the project directory like in the old days of Go? Or is it not possible at all?</p>\n"}, {"tags": ["logging", "go", "panic"], "comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1467646721, "post_id": 38187649, "comment_id": 63802125, "body": "Do other glog.Errorf statements go to the right place?  glog, by default, logs to multiple files and, possibly, stderr based on config.   Also, you used Errorf without the: %v, you probably wanted:  <code>glog.Errorf(&quot;Recovered from err: %v&quot;, err)</code>"}, {"owner": {"reputation": 3680, "user_id": 1813875, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6078165a3f6a8693a0b1a1101e9260c7?s=128&d=identicon&r=PG", "display_name": "harryz", "link": "https://stackoverflow.com/users/1813875/harryz"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1467684726, "post_id": 38187649, "comment_id": 63813694, "body": "Other logs work well before panic. and there&#39;s a typo, sorry for that."}, {"owner": {"reputation": 645, "user_id": 983841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bbe0049baa059b9f3e5be8db1abbeb9?s=128&d=identicon&r=PG", "display_name": "AlexT", "link": "https://stackoverflow.com/users/983841/alext"}, "edited": false, "score": 0, "creation_date": 1467891392, "post_id": 38187649, "comment_id": 63909832, "body": "This could be something related to the glog package. I made a minimal example using the stdlib logger, and it seems to work as expected - <a href=\"https://play.golang.org/p/nhLSH_0rdj\" rel=\"nofollow noreferrer\">play.golang.org/p/nhLSH_0rdj</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1380, "user_id": 433832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658545f9c4540f1f59082a37dee2674a?s=128&d=identicon&r=PG", "display_name": "Rob Bradford", "link": "https://stackoverflow.com/users/433832/rob-bradford"}, "is_accepted": false, "score": 1, "last_activity_date": 1510847195, "creation_date": 1510847195, "answer_id": 47333801, "question_id": 38187649, "link": "https://stackoverflow.com/questions/38187649/golang-how-to-capture-panic-and-log-this-error-to-original-log-file/47333801#47333801", "title": "Golang: How to capture panic and log this error to original log file?", "body": "<p>You need to call <code>glog.Flush()</code> in your deferred function. From the documentation of glog:</p>\n\n<blockquote>\n  <p>Log output is buffered and written periodically using Flush. Programs\n  should call Flush before exiting to guarantee all log output is\n  written.</p>\n</blockquote>\n\n<p><a href=\"https://godoc.org/github.com/golang/glog\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/golang/glog</a></p>\n"}], "owner": {"reputation": 3680, "user_id": 1813875, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6078165a3f6a8693a0b1a1101e9260c7?s=128&d=identicon&r=PG", "display_name": "harryz", "link": "https://stackoverflow.com/users/1813875/harryz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1906, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510847195, "creation_date": 1467644436, "last_edit_date": 1467702924, "question_id": 38187649, "link": "https://stackoverflow.com/questions/38187649/golang-how-to-capture-panic-and-log-this-error-to-original-log-file", "title": "Golang: How to capture panic and log this error to original log file?", "body": "<p>I tried to capture panic and log the error:</p>\n\n<pre><code>func (s *server) SayHello(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) {\n    defer func() {\n        if err := recover(); err != nil {\n            glog.Errorf(\"Recovered from err: %v\", err)\n        }\n    }()\n    panic(\"TISH IS A PANIC\")\n    return &amp;pb.HelloReply{Message: \"Hello \" + in.Name}, nil\n}\n</code></pre>\n\n<p>But to my surprise, the <code>\"Recovered from err: \"</code> never occurs in my log file, instead, it occurs in <code>/var/log/messages</code>.</p>\n\n<p>How can I log that error in my original log file?</p>\n\n<p><strong>[Updated]</strong> </p>\n\n<p>If there is no panic, <code>glog.Errorf</code> will log correctly to its log dir; when there is panic, it just can't:</p>\n\n<pre><code>// this glog will log correctly, unless uncomment the panic below\nglog.Errorf(\"This is a normal log: %v\", err)  \n// panic(\"TISH IS A PANIC\")\n</code></pre>\n\n<p>Maybe this is impossible, since that's what <strong>crash</strong> means?</p>\n"}, {"tags": ["go", "rabbitmq"], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 1527878, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/47889e9295fbd22beb14aee28c428739?s=128&d=identicon&r=PG", "display_name": "Owen Lilly", "link": "https://stackoverflow.com/users/1527878/owen-lilly"}, "is_accepted": false, "score": 0, "last_activity_date": 1478260453, "creation_date": 1478260453, "answer_id": 40422048, "question_id": 38186283, "link": "https://stackoverflow.com/questions/38186283/golang-rabbit-mq-fanout-exchange-multiple-consumers/40422048#40422048", "title": "Golang Rabbit MQ Fanout Exchange Multiple Consumers", "body": "<p>On the channel type, before you publish, declare an exchange like this:</p>\n\n<pre><code>err = channel.ExchangeDeclare(\n  \"example.queue\",   // name\n  \"fanout\", // type\n  true,     // durable\n  false,    // auto-deleted\n  false,    // internal\n  false,    // no-wait\n  nil,      // arguments\n)\n</code></pre>\n\n<p>See the <a href=\"https://www.rabbitmq.com/tutorials/tutorial-three-go.html\" rel=\"nofollow noreferrer\">official RabbitMQ tutorial</a>.</p>\n"}], "owner": {"reputation": 2927, "user_id": 368957, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/661cf3ed7f2311020cd7054cad120419?s=128&d=identicon&r=PG", "display_name": "Rakesh Goyal", "link": "https://stackoverflow.com/users/368957/rakesh-goyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1541, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1478260453, "creation_date": 1467639960, "question_id": 38186283, "link": "https://stackoverflow.com/questions/38186283/golang-rabbit-mq-fanout-exchange-multiple-consumers", "title": "Golang Rabbit MQ Fanout Exchange Multiple Consumers", "body": "<p>I am publishing messages in fanout exchange from Java application. I am able to receive message in multiple consumer in Java. I have 2 consumers in golang app but only one of the consumer (alternatively ) is receiving the message (Not both of them for a published message).</p>\n\n<pre><code>func HandleMessageFanout1(){\n\n    conn := system.EltropyAppContext.RabbitMQConn\n\n    channel, err := conn.Channel()\n\n    if(err!=nil){\n        log.Println(err)\n    }\n    //forever := make(chan bool)\n\n\n\n    deliveries,err := channel.Consume(\n        \"example.queue\", //queue\n        \"qw\",\n        true,\n        false,\n        false,\n        false,\n        nil)\n\n    if(err!=nil){\n        log.Println(err)\n    }\n\n    go func() {\n\n        for d := range deliveries {\n            log.Printf(\"Message recived in fanout 1\")\n            log.Printf(\"Received a message: %s\", d.Body)\n        }\n    }()\n\n    //&lt;-forever\n\n}\n</code></pre>\n\n<p>//2nd Consumer</p>\n\n<pre><code>package consumer\n\nimport (\n    \"github.com/eltropy/shehnai/backend/golang/common-packages/system\"\n    log \"github.com/Sirupsen/logrus\"\n)\n\n    func HandleMessageFanout2() {\n\n        conn := system.EltropyAppContext.RabbitMQConn\n\n        channel, err := conn.Channel()\n\n        if (err!=nil) {\n            log.Println(err)\n        }\n\n        //forever := make(chan bool)\n\n        deliveries, err := channel.Consume(\n            \"example.queue\", //queue\n            \"q2\",\n            true,\n            false,\n            false,\n            false,\n            nil)\n\n        if (err!=nil) {\n            log.Println(err)\n        }\n\n        go func() {\n            for d := range deliveries {\n                log.Printf(\"Message recived in fanout 2\")\n                log.Printf(\"Received a message: %s\", d.Body)\n            }\n        }()\n\n        //&lt;-forever\n\n    }\n</code></pre>\n\n<p>I am using <a href=\"https://github.com/streadway/amqp\" rel=\"nofollow\">https://github.com/streadway/amqp</a> library for rabbit mq.</p>\n"}, {"tags": ["dictionary", "reflection", "go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 1053, "user_id": 1870444, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5ebd5fcaa14dec84af11037ffdaa68bc?s=128&d=identicon&r=PG", "display_name": "SamTech", "link": "https://stackoverflow.com/users/1870444/samtech"}, "edited": false, "score": 1, "creation_date": 1467641245, "post_id": 38186026, "comment_id": 63798887, "body": "Here struct could be any struct like Book, Auther, Publisher ... for type switching type of struct must be known, that i don&#39;t have."}, {"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "reply_to_user": {"reputation": 1053, "user_id": 1870444, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5ebd5fcaa14dec84af11037ffdaa68bc?s=128&d=identicon&r=PG", "display_name": "SamTech", "link": "https://stackoverflow.com/users/1870444/samtech"}, "edited": false, "score": 0, "creation_date": 1467641718, "post_id": 38186026, "comment_id": 63799194, "body": "@SamTech How is the type of the struct not &quot;known&quot;? You can just switch over all the types you want to handle."}, {"owner": {"reputation": 1053, "user_id": 1870444, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5ebd5fcaa14dec84af11037ffdaa68bc?s=128&d=identicon&r=PG", "display_name": "SamTech", "link": "https://stackoverflow.com/users/1870444/samtech"}, "edited": false, "score": 0, "creation_date": 1467642260, "post_id": 38186026, "comment_id": 63799561, "body": "I mean, how do i know whether i have to type switch passed interface to map[string]*Book or map[string]*Auther ?"}, {"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "reply_to_user": {"reputation": 1053, "user_id": 1870444, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5ebd5fcaa14dec84af11037ffdaa68bc?s=128&d=identicon&r=PG", "display_name": "SamTech", "link": "https://stackoverflow.com/users/1870444/samtech"}, "edited": false, "score": 1, "creation_date": 1467643966, "post_id": 38186026, "comment_id": 63800626, "body": "@SamTech Just switch on both."}], "tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": false, "score": 31, "last_activity_date": 1467639405, "last_edit_date": 1495540045, "creation_date": 1467639098, "answer_id": 38186026, "question_id": 38185916, "link": "https://stackoverflow.com/questions/38185916/how-to-convert-interface-to-map/38186026#38186026", "title": "How to convert interface{} to map", "body": "<p>You don't need reflect here. Try:</p>\n\n<pre><code>v, ok := in.(map[string]*Book)\nif !ok {\n    // Can't assert, handle error.\n}\nfor _, s := range v {\n    fmt.Printf(\"Value: %v\\n\", s)\n}\n</code></pre>\n\n<p>Same goes for the rest of your function. It looks like you're using reflection when you would be better served by a <a href=\"https://golang.org/doc/effective_go.html#type_switch\" rel=\"noreferrer\">type switch</a>.</p>\n\n<hr>\n\n<p>Alternatively, if you insist on using reflection here (which doesn't make a lot of sense) you can also use <a href=\"https://golang.org/pkg/reflect/#Value.MapKeys\" rel=\"noreferrer\"><code>Value.MapKeys</code></a> with the result from your ValueOf (see the answer <a href=\"https://stackoverflow.com/a/38186057/714501\">https://stackoverflow.com/a/38186057/714501</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 0, "creation_date": 1467639347, "post_id": 38186057, "comment_id": 63797717, "body": "Nice. I added the <code>MapKeys</code> to my answer part as you were posting yours!"}, {"owner": {"reputation": 1053, "user_id": 1870444, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5ebd5fcaa14dec84af11037ffdaa68bc?s=128&d=identicon&r=PG", "display_name": "SamTech", "link": "https://stackoverflow.com/users/1870444/samtech"}, "edited": false, "score": 0, "creation_date": 1467641176, "post_id": 38186057, "comment_id": 63798846, "body": "Working absolutely fine. Thanks a lot."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 42, "last_activity_date": 1467653343, "last_edit_date": 1467653343, "creation_date": 1467639237, "answer_id": 38186057, "question_id": 38185916, "link": "https://stackoverflow.com/questions/38185916/how-to-convert-interface-to-map/38186057#38186057", "title": "How to convert interface{} to map", "body": "<p>If the map value can be any type, then use reflect to iterate through the map:</p>\n\n<pre><code>if v.Kind() == reflect.Map {\n    for _, key := range v.MapKeys() {\n        strct := v.MapIndex(key)\n        fmt.Println(key.Interface(), strct.Interface())\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/pEQhIP4R2m\" rel=\"noreferrer\">playground example</a></p>\n\n<p>If there's a small and known set of struct types, then a <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"noreferrer\">type switch</a> can be used:</p>\n\n<pre><code>func process(in interface{}) {\n  switch v := in.(type) {\n  case map[string]*Book:\n     for s, b := range v {\n         // b has type *Book\n         fmt.Printf(\"%s: book=%v\\n\" s, b)\n     }\n  case map[string]*Author:\n     for s, a := range v {\n         // a has type *Author\n         fmt.Printf(\"%s: author=%v\\n\" s, a)\n     }\n   case []*Book:\n     for i, b := range v {\n         fmt.Printf(\"%d: book=%v\\n\" i, b)\n     }\n   case []*Author:\n     for i, a := range v {\n         fmt.Printf(\"%d: author=%v\\n\" i, a)\n     }\n   case *Book:\n     fmt.Ptintf(\"book=%v\\n\", v)\n   case *Author:\n     fmt.Printf(\"author=%v\\n\", v)\n   default:\n     // handle unknown type\n   }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38836, "user_id": 1997376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3AtSv.png?s=128&g=1", "display_name": "Nicolas Filotto", "link": "https://stackoverflow.com/users/1997376/nicolas-filotto"}, "is_accepted": false, "score": 0, "last_activity_date": 1612372830, "last_edit_date": 1612372830, "creation_date": 1612015529, "answer_id": 65968858, "question_id": 38185916, "link": "https://stackoverflow.com/questions/38185916/how-to-convert-interface-to-map/65968858#65968858", "title": "How to convert interface{} to map", "body": "<p>Another way to convert an <code>interface{}</code> into a <code>map</code> with the package reflect is with <a href=\"https://golang.org/pkg/reflect/#Value.MapRange\" rel=\"nofollow noreferrer\"><code>MapRange</code></a>.</p>\n<p>I quote:</p>\n<blockquote>\n<p>MapRange returns a range iterator for a map. It panics if v's Kind is\nnot Map.</p>\n<p>Call Next to advance the iterator, and Key/Value to access each entry.\nNext returns false when the iterator is exhausted. MapRange follows\nthe same iteration semantics as a range statement.</p>\n</blockquote>\n<p>Example:</p>\n<pre><code>iter := reflect.ValueOf(m).MapRange()\nfor iter.Next() {\n    key := iter.Key().Interface()\n    value := iter.Value().Interface()\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 1053, "user_id": 1870444, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5ebd5fcaa14dec84af11037ffdaa68bc?s=128&d=identicon&r=PG", "display_name": "SamTech", "link": "https://stackoverflow.com/users/1870444/samtech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67153, "favorite_count": 11, "accepted_answer_id": 38186057, "answer_count": 3, "score": 32, "last_activity_date": 1612372830, "creation_date": 1467638758, "last_edit_date": 1595684382, "question_id": 38185916, "link": "https://stackoverflow.com/questions/38185916/how-to-convert-interface-to-map", "title": "How to convert interface{} to map", "body": "<p>I am trying to create a function that could accept following</p>\n\n<pre><code>*struct\n[]*struct\nmap[string]*struct\n</code></pre>\n\n<p>Here struct could be any struct not just a specific one.\nConverting interface to <code>*struct</code> or <code>[]*struct</code> is working fine.\nBut giving error for map.</p>\n\n<p>After reflect it shows it is map[] but giving error when try to iterate over range.</p>\n\n<p>Here is code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Book struct {\n    ID     int\n    Title  string\n    Year   int\n}\n\nfunc process(in interface{}, isSlice bool, isMap bool) {\n    v := reflect.ValueOf(in)\n\n    if isSlice {\n        for i := 0; i &lt; v.Len(); i++ {\n            strct := v.Index(i).Interface()\n            //... proccess struct\n        }\n        return\n    }\n\n    if isMap {\n        fmt.Printf(\"Type: %v\\n\", v)     // map[]\n        for _, s := range v {           // Error: cannot range over v (type reflect.Value)\n            fmt.Printf(\"Value: %v\\n\", s.Interface())\n        }\n    }    \n}\n\nfunc main() {\n    b := Book{}\n    b.Title = \"Learn Go Language\"\n    b.Year = 2014\n    m := make(map[string]*Book)\n    m[\"1\"] = &amp;b\n\n    process(m, false, true)\n}\n</code></pre>\n\n<p>Is there any way to convert <code>interface{}</code> to map and iterate or get it's elements.</p>\n"}, {"tags": ["redirect", "go", "safari"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1467638867, "post_id": 38185683, "comment_id": 63797411, "body": "Can you check if the browser request favicon.ico multiple times?"}, {"owner": {"reputation": 57, "user_id": 2059095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791897db71b78ee3043a615f663f28b1?s=128&d=identicon&r=PG&f=1", "display_name": "basica", "link": "https://stackoverflow.com/users/2059095/basica"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1467639349, "post_id": 38185683, "comment_id": 63797718, "body": "@SimoEndre, how would I check to see if it&#39;s looking for that? (I&#39;m guessing it&#39;s in the developer tools there in Safari?) but I see no mention of favicon anywhere.. I don&#39;t have one set up in any case."}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 1, "creation_date": 1467639664, "post_id": 38185683, "comment_id": 63797917, "body": "This is a browser specific functionality, even if you are not setting up, it will look for it. Yes, please check the network panel from developer tools."}, {"owner": {"reputation": 57, "user_id": 2059095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791897db71b78ee3043a615f663f28b1?s=128&d=identicon&r=PG&f=1", "display_name": "basica", "link": "https://stackoverflow.com/users/2059095/basica"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1467640029, "post_id": 38185683, "comment_id": 63798144, "body": "Had a look at the network section, the only things listed are various css and javascript files. No mention of favicon."}], "owner": {"reputation": 57, "user_id": 2059095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791897db71b78ee3043a615f663f28b1?s=128&d=identicon&r=PG&f=1", "display_name": "basica", "link": "https://stackoverflow.com/users/2059095/basica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467638061, "creation_date": 1467638061, "question_id": 38185683, "link": "https://stackoverflow.com/questions/38185683/safari-reloading-web-page-3-times-during-redirect", "title": "Safari reloading web page 3 times during redirect", "body": "<p>For the life of me I thought I was going mad because as far as I could see everything was/is ok with the code in that regards. Out of exasperation I decided to try my application in another browser and found that in Chrome and FF the app works fine, but in Safari for some reason it refreshes the page 3 times. I've tried resetting Safari and turning off extensions in case that was the issue but the same thing happens. </p>\n\n<p>I'm not sure if this is just a quirk with my setup, or potentially my code so I've pasted it here below to have some other eyes look at it. If more code/context is required, please let me know. In essence it takes the user to the index page, the movie page and repeats this process 3 times.</p>\n\n<pre><code>func movieHandler(w http.ResponseWriter, r *http.Request) {\n    command := r.URL.Query().Get(\"command\")\n    film := r.URL.Query().Get(\"movie\")\n\n    if pageData.Player.Playing == false {\n        if film == \"\" {\n            log.Println(\"No film was selected\")\n            http.Redirect(w, r, \"/\", http.StatusFound)\n            return\n        }\n        err := pageData.Player.StartFilm(film)\n        if err != nil {\n            log.Printf(\"Following error occurred: %v\\n\", err)\n            http.Redirect(w, r, \"/\", http.StatusFound)\n            return\n        }\n        pageData.CurrentFilm = film\n    } else if pageData.Player.Playing &amp;&amp; (film == \"\" || pageData.Player.FilmName == film) {\n        if command == \"kill\" {\n            err := pageData.Player.EndFilm()\n            if err != nil {\n                log.Printf(\"Following error occurred: %v\\n\", err)\n            }\n            http.Redirect(w, r, \"/\", http.StatusFound)\n            return\n        } else if command != \"\" {\n            err := pageData.Player.SendCommandToFilm(command)\n            if err != nil {\n                log.Printf(\"Following error occurred: %v\\n\", err)\n            }\n        }\n    } else {\n        http.Redirect(w, r, \"/\", http.StatusFound)\n        return\n    }\n    renderTemplate(w, \"movie.html\")\n}\n</code></pre>\n\n<p>Note: I'm still an inexperienced coder (especially with go), so additional input on improving this code in any other way is appreciated.</p>\n"}, {"tags": ["mysql", "google-app-engine", "go", "google-cloud-platform", "google-cloud-sql"], "comments": [{"owner": {"reputation": 758, "user_id": 235983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/20a5957ca57ddf02c634ec0b2bcea38b?s=128&d=identicon&r=PG", "display_name": "Tianzhou", "link": "https://stackoverflow.com/users/235983/tianzhou"}, "edited": false, "score": 0, "creation_date": 1467675350, "post_id": 38180791, "comment_id": 63812120, "body": "Do you connect to first generation or second generation cloud sql instance? If it&#39;s second generation, you should use cloud sql proxy: <a href=\"https://cloud.google.com/sql/docs/access-control#instanceaccess\" rel=\"nofollow noreferrer\">cloud.google.com/sql/docs/access-control#instanceaccess</a>"}, {"owner": {"reputation": 41, "user_id": 6532619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce5dbf98b241b37d4c4402824b166b5?s=128&d=identicon&r=PG&f=1", "display_name": "treigerm", "link": "https://stackoverflow.com/users/6532619/treigerm"}, "reply_to_user": {"reputation": 758, "user_id": 235983, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/20a5957ca57ddf02c634ec0b2bcea38b?s=128&d=identicon&r=PG", "display_name": "Tianzhou", "link": "https://stackoverflow.com/users/235983/tianzhou"}, "edited": false, "score": 0, "creation_date": 1467702673, "post_id": 38180791, "comment_id": 63819009, "body": "I connected with the first generation instance. Ah, in the link you send me they state that access from the app engine flexible environment to a first generation instance is not supported. Thanks for the link!"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6532619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce5dbf98b241b37d4c4402824b166b5?s=128&d=identicon&r=PG&f=1", "display_name": "treigerm", "link": "https://stackoverflow.com/users/6532619/treigerm"}, "is_accepted": true, "score": 0, "last_activity_date": 1467703115, "creation_date": 1467703115, "answer_id": 38197439, "question_id": 38180791, "link": "https://stackoverflow.com/questions/38180791/connect-google-app-engine-with-google-cloud-storage-in-flexible-environment/38197439#38197439", "title": "Connect Google App Engine with Google Cloud Storage in flexible environment", "body": "<p><a href=\"https://cloud.google.com/sql/docs/access-control#instanceaccess\" rel=\"nofollow\">This</a> link states that instance-level access between the app engine flexible environment and a First Generation Cloud SQL instance is not supported yet. If you want to connect to a Second Generation Cloud SQL you would have to use the Cloud SQL Proxy.<br>\nThanks to @Tianzhou for pointing me to the link.</p>\n"}], "owner": {"reputation": 41, "user_id": 6532619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce5dbf98b241b37d4c4402824b166b5?s=128&d=identicon&r=PG&f=1", "display_name": "treigerm", "link": "https://stackoverflow.com/users/6532619/treigerm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 38197439, "answer_count": 1, "score": 0, "last_activity_date": 1467703115, "creation_date": 1467623312, "last_edit_date": 1495542151, "question_id": 38180791, "link": "https://stackoverflow.com/questions/38180791/connect-google-app-engine-with-google-cloud-storage-in-flexible-environment", "title": "Connect Google App Engine with Google Cloud Storage in flexible environment", "body": "<p>I want to connect from my GAE app to my Google Cloud MySQL instance. I am using the <code>github.com/go-sql-driver/mysql</code> driver and I followed the steps specified in the <a href=\"https://cloud.google.com/appengine/docs/flexible/go/using-cloud-sql\" rel=\"nofollow noreferrer\">tutorial</a>. Apparently I can connect to the database without an error but when I want to make a request I get <code>driver: bad connection</code> and <code>packets.go:33: unexpected EOF</code>. I authorised both my local IP address and the GAE app to access my database and I can connect to it from my local machine and the mysql client without a problem. I have already tried setting up my app in the standard environment and followed the advice <a href=\"https://stackoverflow.com/questions/21368363/how-to-connect-to-google-cloud-sql-with-go-sql-driver-mysql-on-app-engine\">here</a> but it didn't work either. </p>\n\n<p>That is my Go code with which I connect to the database:</p>\n\n<pre><code>host := os.Getenv(\"DB_HOST\")\nuser := os.Getenv(\"DB_USER\")\npwd := os.Getenv(\"DB_PWD\")\nconnectionInfo := fmt.Sprintf(\"%v:%v@tcp(%v:3306)/mobile_data?parseTime=true\", user, pwd, host)\ndb, err := sql.Open(\"mysql\", connectionInfo)\n</code></pre>\n\n<p>And this is my app.yaml file:</p>\n\n<pre><code>runtime: go\nvm: true\nenv_variables:\n    \"DB_HOST\": \"[Google Cloud MySQL Instance IPv4]\"\n    \"DB_USER\": \"[User]\"\n    \"DB_PWD\": \"[Password]\"\n</code></pre>\n\n<p>Any tip or advice is greatly appreciated!</p>\n"}, {"tags": ["unit-testing", "testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "edited": false, "score": 0, "creation_date": 1467618358, "post_id": 38179313, "comment_id": 63785547, "body": "I added the &#39;NewTestDialogRAW&#39; function in my example"}, {"owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "edited": false, "score": 0, "creation_date": 1467629952, "post_id": 38179313, "comment_id": 63791991, "body": "I am using your workaround but func (d *Dialog) Yesno() bool { if _, err := d.exec(&quot;yesno&quot;, true) is using exec from Dialog, not from TestDialog"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "edited": false, "score": 1, "creation_date": 1467632028, "post_id": 38179313, "comment_id": 63793208, "body": "It appears you need to stub <code>Yesno</code>. Stubbing is hard in Go due to its static nature but if your test requires a certain return value from <code>Yesno</code>, the above work-around can be used, just define <code>Yesno</code> on <code>TestDialog</code> to return the error and remove <code>exec</code> since <code>Yesno</code> is what&#39;s calling <code>exec</code>. Otherwise you can also repeat <code>Yesno</code> on <code>TestDialog</code> along with <code>exec</code>. It&#39;s not the most ideal solution.Since <code>exec</code> depend on <code>cmd.Run()</code> in the end, perhaps a better solution would be to fake a <code>cmd</code> value. But that would come with its own complexity."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 1, "last_activity_date": 1467618874, "last_edit_date": 1467618874, "creation_date": 1467618230, "answer_id": 38179313, "question_id": 38178920, "link": "https://stackoverflow.com/questions/38178920/how-to-redefine-mock-a-method-in-go-for-test-purposes/38179313#38179313", "title": "How to redefine/mock a method in Go for test purposes?", "body": "<p><code>d.exec</code> is not a part of struct declaration (it is not a struct field). It is a method defined on dialog type. Hence it is not addressable and cannot be assigned to.</p>\n\n<p>You can try embedding <code>Dialog</code> in a new type and redefine <code>exec</code> on that type.</p>\n\n<pre><code>type TestDialog struct {\n    Dialog\n}\n\nfunc (d *TestDialog) exec(dType string, allowLabel bool) (string, error) {\n    return \"\", fmt.Errorf(DIALOG_ERR_CANCEL)\n}\n</code></pre>\n"}], "owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 38179313, "answer_count": 1, "score": 0, "last_activity_date": 1467618874, "creation_date": 1467616760, "last_edit_date": 1467618338, "question_id": 38178920, "link": "https://stackoverflow.com/questions/38178920/how-to-redefine-mock-a-method-in-go-for-test-purposes", "title": "How to redefine/mock a method in Go for test purposes?", "body": "<p>I am creating tests for a Go library. And I'm catching an error:</p>\n\n<blockquote>\n  <p>cannot assign to</p>\n</blockquote>\n\n<p>I have the following code (<a href=\"https://play.golang.org/p/kf0gANb-p-\" rel=\"nofollow\">https://play.golang.org/p/kf0gANb-p-</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n\n    \"os/exec\"\n    \"strconv\"\n    \"strings\"\n\n)\nconst (\n    CONSOLE         = \"dialog\"\n    KDE             = \"kdialog\"\n    GTK             = \"gtkdialog\"\n    X               = \"Xdialog\"\n    DIALOG_TEST_ENV = \"test_env\"\n    AUTO            = \"auto\"\n)\n\nconst (\n    DIALOG_ERR_CANCEL = \"exit status 1\"\n    DIALOG_ERR_HELP   = \"exit status 2\"\n    DIALOG_ERR_EXTRA  = \"exit status 3\"\n)\ntype Dialog struct {\n    environment string\n    parentId    int\n    title       string\n    backtitle   string\n    label       string\n    height      int\n    width       int\n    left        int\n    top         int\n    shadow      bool\n    helpButton  bool\n    helpLabel   string\n    extraLabel  string\n    cancelLabel string\n    okLabel     string\n    beforeDtype []string\n    beforeSize  []string\n    afterSize   []string\n    lastCmd     []string\n}\n\nfunc (d *Dialog) Yesno() bool {\n    if _, err := d.exec(\"yesno\", true); err != nil {\n        if err.Error() == DIALOG_ERR_CANCEL {\n            return false\n        }\n    }\n    return true\n}\n\nfunc NewTestDialogRAW(environment string, parentId int) Dialog {\n    var res = new(Dialog)\n    LastCMD = []string{}\n    return *res\n}\nfunc (d *Dialog) exec(dType string, allowLabel bool) (string, error) {\n    var arg string\n    cmd := exec.Command(d.environment)\n\n    if d.okLabel != \"\" {\n        cmd.Args = append(cmd.Args, \"--ok-label\", d.okLabel)\n    }\n    if d.extraLabel != \"\" {\n        cmd.Args = append(cmd.Args, \"--extra-button\")\n        cmd.Args = append(cmd.Args, \"--extra-label\", d.extraLabel)\n    }\n    if d.helpButton {\n        cmd.Args = append(cmd.Args, \"--help-button\")\n        if d.helpLabel != \"\" {\n            cmd.Args = append(cmd.Args, \"--help-label\", d.helpLabel)\n        }\n    }\n    if d.shadow == false {\n        cmd.Args = append(cmd.Args, \"--no-shadow\")\n    }\n    if d.backtitle != \"\" {\n        cmd.Args = append(cmd.Args, \"--backtitle\", d.backtitle)\n    }\n    if d.cancelLabel != \"\" {\n        cmd.Args = append(cmd.Args, \"--cancel-label\", d.cancelLabel)\n    }\n    if d.title != \"\" {\n        cmd.Args = append(cmd.Args, \"--title\", d.title)\n    }\n    for _, arg := range d.beforeDtype {\n        cmd.Args = append(cmd.Args, arg)\n    }\n    cmd.Args = append(cmd.Args, \"--\"+dType)\n\n    if allowLabel == true {\n        cmd.Args = append(cmd.Args, d.label)\n    }\n    for _, arg = range d.beforeSize {\n        cmd.Args = append(cmd.Args, arg)\n    }\n    if d.environment != KDE {\n        cmd.Args = append(cmd.Args, strconv.Itoa(d.height))\n        cmd.Args = append(cmd.Args, strconv.Itoa(d.width))\n    }\n    for _, arg = range d.afterSize {\n        cmd.Args = append(cmd.Args, arg)\n    }\n    if d.environment == CONSOLE {\n        cmd.Args = append(cmd.Args, \"--stdout\")\n    } else {\n        cmd.Args = append(cmd.Args, \"--attach\")\n        cmd.Args = append(cmd.Args, strconv.Itoa(d.parentId))\n    }\n\n    var out bytes.Buffer\n    cmd.Stdout = &amp;out\n    var err error\n    if d.environment != DIALOG_TEST_ENV {\n        err = cmd.Run()\n    }\n    d.lastCmd = cmd.Args\n\n    //d.reset()\n    return strings.Trim(out.String(), \"\\r\\n \"), err\n}\n\n\n\nfunc main() {\nvar tests = []bool{true, false}\nfor _,expected_val := range tests {\n    fmt.Println(\"Hello, playground \",expected_val )\n    }\n}\n</code></pre>\n\n<p>I tried to test it but I don't know how to redefine the method?</p>\n\n<p>main_test.go:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"testing\"\n)\nfunc TestYesNo(t *testing.T) {\n    d := NewTestDialogRAW(DIALOG_TEST_ENV, 0)\n    d.Yesno()\n    x := LastCMD\n    expected_str := \"[ --no-shadow --yesno  0 0 --attach 0]\"\n    if fmt.Sprintf(\"%v\", x) != expected_str {\n        t.Errorf(\"Expected %v, actual %v \", expected_str, x)\n    }\n    f := func(dType string, allowLabel bool) (string, error) {\n        return \"\", fmt.Errorf(DIALOG_ERR_CANCEL)\n    }\n    d.exec = f    \n}\n</code></pre>\n\n<p>go test ./... -v</p>\n\n<pre><code># _/root/Development/git-repos/go-dialog\n./dialog_test.go cannot assign to d.exec\nFAIL    _/root/Development/git-repos/go-dialog [build failed]\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 34060, "user_id": 222467, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e566810c16d40d7ab4f674df14edf6cb?s=128&d=identicon&r=PG", "display_name": "Igor Artamonov", "link": "https://stackoverflow.com/users/222467/igor-artamonov"}, "edited": false, "score": 0, "creation_date": 1467616627, "post_id": 38178861, "comment_id": 63784664, "body": "which programming language do you use?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1467635768, "last_edit_date": 1495542728, "creation_date": 1467626112, "answer_id": 38181753, "question_id": 38178861, "link": "https://stackoverflow.com/questions/38178861/how-to-differentiate-between-local-deployment-and-live-deployment-on-google-appe/38181753#38181753", "title": "How to differentiate between local deployment and live deployment on Google AppEngine", "body": "<p>Easiest is to use use <a href=\"https://cloud.google.com/appengine/docs/go/reference#IsDevAppServer\" rel=\"nofollow noreferrer\"><code>appengine.IsDevAppServer()</code></a> to tell if your app is running in development mode (using the AppEngine SDK) or live (in production):</p>\n\n<blockquote>\n<pre><code>func IsDevAppServer() bool\n</code></pre>\n  \n  <p>IsDevAppServer reports whether the App Engine app is running in the development App Server.</p>\n</blockquote>\n\n<p>Alternatively you can also use <a href=\"https://cloud.google.com/appengine/docs/go/reference#ServerSoftware\" rel=\"nofollow noreferrer\"><code>appengine.ServerSoftware()</code></a> which contains this information along with your App version, merged into one string:</p>\n\n<blockquote>\n<pre><code>func ServerSoftware() string\n</code></pre>\n  \n  <p>ServerSoftware returns the App Engine release version. In production, it looks like \"Google App Engine/X.Y.Z\". In the development appserver, it looks like \"Development/X.Y\".</p>\n</blockquote>\n\n<p>So for example what you want to do:</p>\n\n<pre><code>var DEBUG_MODE bool\n\nfunc init() {\n    DEBUG_MODE = appengine.IsDevAppServer()\n}\n</code></pre>\n\n<p>Or in one line:</p>\n\n<pre><code>var DEBUG_MODE = appengine.IsDevAppServer()\n</code></pre>\n\n<p>Although note that you could just call <code>appengine.IsDevAppServer()</code> whenever you would refer to <code>DEBUG_MODE</code>. Also the name <code>DEBUG_MODE</code> does not conform to Go naming conventions, it should either be <code>DebugMode</code> if it needs to be exported (because you want to access it from other packages too), or it should be <code>debugMode</code> if it doesn't need to be exported.</p>\n\n<p>See this related question (possible duplicate?): <a href=\"https://stackoverflow.com/questions/36184603/how-to-set-variables-based-on-project-id\">How to set variables based on project id?</a></p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 1, "accepted_answer_id": 38181753, "answer_count": 1, "score": 1, "last_activity_date": 1467635768, "creation_date": 1467616518, "last_edit_date": 1467624621, "question_id": 38178861, "link": "https://stackoverflow.com/questions/38178861/how-to-differentiate-between-local-deployment-and-live-deployment-on-google-appe", "title": "How to differentiate between local deployment and live deployment on Google AppEngine", "body": "<p>I want to set global variable, for example:</p>\n\n<pre><code>var DEBUG_MODE bool\n\nfunc init() {\n  // set DEBUG_MODE true if localhost (not appspot.com or other domain)\n}\n</code></pre>\n\n<p>How to do this?</p>\n"}, {"tags": ["linux", "go", "amazon-ec2", "upstart"], "comments": [{"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 2, "creation_date": 1467611992, "post_id": 38177736, "comment_id": 63782526, "body": "Is the typo <code>rullevel</code> genuine?"}, {"owner": {"reputation": 1261, "user_id": 3056745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/263633e6298c912b98a43bf1ca7de267?s=128&d=identicon&r=PG&f=1", "display_name": "Lital Kolog", "link": "https://stackoverflow.com/users/3056745/lital-kolog"}, "edited": false, "score": 0, "creation_date": 1467612281, "post_id": 38177736, "comment_id": 63782651, "body": "What are you trying to execute exactly? app is a directory isn&#39;t it? take a look at this question <a href=\"http://stackoverflow.com/questions/14692843/running-node-js-server-using-upstart-causes-terminated-with-status-127-on-ubu\" title=\"running node js server using upstart causes terminated with status 127 on ubu\">stackoverflow.com/questions/14692843/&hellip;</a>"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1467612301, "post_id": 38177736, "comment_id": 63782660, "body": "ah that was a typo. Thanks for finding that. I fixed that and tried to start. But still facing the same issue."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 1261, "user_id": 3056745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/263633e6298c912b98a43bf1ca7de267?s=128&d=identicon&r=PG&f=1", "display_name": "Lital Kolog", "link": "https://stackoverflow.com/users/3056745/lital-kolog"}, "edited": false, "score": 0, "creation_date": 1467612878, "post_id": 38177736, "comment_id": 63782865, "body": "@Lital - When I build the application it generates the binaries in the name app. [I think this is specific to golang]"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467612924, "post_id": 38177736, "comment_id": 63782894, "body": "Is the directory Web-app or web-app?"}, {"owner": {"reputation": 1261, "user_id": 3056745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/263633e6298c912b98a43bf1ca7de267?s=128&d=identicon&r=PG&f=1", "display_name": "Lital Kolog", "link": "https://stackoverflow.com/users/3056745/lital-kolog"}, "edited": false, "score": 0, "creation_date": 1467613023, "post_id": 38177736, "comment_id": 63782932, "body": "@Dany make sure the user who runs the upstart script has permissions to execute app."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 1261, "user_id": 3056745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/263633e6298c912b98a43bf1ca7de267?s=128&d=identicon&r=PG&f=1", "display_name": "Lital Kolog", "link": "https://stackoverflow.com/users/3056745/lital-kolog"}, "edited": false, "score": 0, "creation_date": 1467613171, "post_id": 38177736, "comment_id": 63782989, "body": "@Lital - I run as root. I am starting the process from ec2 user data."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467613611, "post_id": 38177736, "comment_id": 63783180, "body": "will it run with full path in the exec command (in addition to chdir)?"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467615730, "post_id": 38177736, "comment_id": 63784190, "body": "@Mark - Running outside of the directory with full path is not working. For example, <code>$exec &#47;home&#47;ec2-user&#47;go&#47;src&#47;github.com&#47;dineshappavoo&#47;web-app&#47;app&#47;a&zwnj;&#8203;pp</code>  the above statement will throw error. But the following will work <code>$cd &#47;home&#47;ec2-user&#47;go&#47;src&#47;github.com&#47;dineshappavoo&#47;web-app&#47;app $exec app</code>"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467671147, "post_id": 38177736, "comment_id": 63811247, "body": "Did you solve this? <code>status 127</code> means the binary wasn&#39;t found: either doesn&#39;t exist, was misspelt, or was invoked with <code>app</code> rather than <code>.&#47;app</code>. The <code>chdir</code> is ok otherwise you&#39;d get a different error."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467671510, "post_id": 38177736, "comment_id": 63811333, "body": "Note (on ubuntu) if <code>console output</code> is changed to <code>console log</code> in the upstart script, the stdout and stderr of the script and application will be logged to <code>&#47;var&#47;log&#47;upstart&#47;web-app.log</code>. This log may help explain why it&#39;s failing."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467679175, "post_id": 38177736, "comment_id": 63812752, "body": "@Mark - I tried that option too."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467679529, "post_id": 38177736, "comment_id": 63812823, "body": "@Mark - I tried  <code>chdir &#47;home&#47;ec2-user&#47;go&#47;src&#47;github.com&#47;dineshappavoo&#47;web-app&#47;app exec app</code> But didn&#39;t help. I am not using ubuntu. I am using amazon linux in which I dont find <code>&#47;var&#47;log&#47;upstart</code> logs."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467685888, "post_id": 38177736, "comment_id": 63813936, "body": "Try removing the  <code>script</code> and <code>end script</code> (currently, ec2 uses an old version of upstart, and it might not handle the nesting)."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467690387, "post_id": 38177736, "comment_id": 63814816, "body": "@Mark - Thanks for helping me. I tried it with the following, <code>export GOPATH=&quot;&#47;home&#47;ec2-user&#47;go&quot; export GOROOT=&quot;&#47;home&#47;ec2-user&#47;go&quot; export APP_STAGE=&quot;prod&quot; chdir &#47;home&#47;ec2-user&#47;go&#47;src&#47;github.com&#47;dineshappavoo&#47;web-app&#47;app exec go run server.go</code>  also I tried <code>exec app</code>  In both cases application failed to start."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467691674, "post_id": 38177736, "comment_id": 63815122, "body": "GOPATH and GOROOT are only needed for compiling. Did you try removing the <code>script</code> and <code>end script</code> lines? I spun up a new aws linux instance with your web-app.conf (identical except script/end script removed), and started a small go web server, and it&#39;s still up and running. With <code>script&#47;end script</code> the logs were showing status 127 errors, as you saw."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467694515, "post_id": 38177736, "comment_id": 63815774, "body": "@Mark - I really appreciate your help. I removed script and end script again and ran. When I used <code>exec app</code> it showed <code>initctl: Job failed to start</code>.  I changed to <code>exec .&#47;app</code> it shows <code>process (18247) terminated with status 1</code> in the logs. :("}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 2, "creation_date": 1467697257, "post_id": 38177736, "comment_id": 63816544, "body": "<code>terminated with status 1</code> suggests upstart is running your app, good! The app is crashing though. To verify the app is now the problem, temporarily swap <code>exec .&#47;app</code> with a basic program you know to be working, eg, <code>exec sleep 2</code>. Restarting the job should result in /var/log/messages with several <code>web-app main process ended, respawning</code> lines."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467709651, "post_id": 38177736, "comment_id": 63823001, "body": "@Mark - Great catch. Thank you so much.  I found the root cause with the technique you suggested. I use an environment variable APP_STAGE in web-app app server. Upstart is not taking this environment variable from console. So I updated the script  <code>env APP_STAGE=&quot;prod&quot; chdir &#47;home&#47;ec2-user&#47;go&#47;src&#47;github.com&#47;dineshappavoo&#47;web-app&#47;app exec .&#47;app</code> Finally it worked. I really appreciate your help. If you could add this as answer, I will accept."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467764803, "post_id": 38177736, "comment_id": 63853077, "body": "great, glad to hear it&#39;s working :-)"}], "answers": [{"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 2, "last_activity_date": 1467764764, "creation_date": 1467764764, "answer_id": 38214786, "question_id": 38177736, "link": "https://stackoverflow.com/questions/38177736/how-to-start-the-upstart-process-for-golang-application/38214786#38214786", "title": "How to start the upstart process for golang application?", "body": "<p>OP eventually solved after fixing a few issues. See comments, notably:</p>\n\n<ul>\n<li>upstart might not recognise environment variables</li>\n<li><p>Amazon Linux Image currently uses an old version of init (upstart 0.6.5), lacking newer features such as <code>console log</code> &amp; nested script tags</p></li>\n<li><p>status 127 can occur if exec can't find the binary</p></li>\n<li>status 1 can occur if binary runs but fails</li>\n<li>substituting a simple program in an upstart script can help diagnose errors</li>\n</ul>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 0, "accepted_answer_id": 38214786, "answer_count": 1, "score": 0, "last_activity_date": 1467764764, "creation_date": 1467611665, "last_edit_date": 1467629560, "question_id": 38177736, "link": "https://stackoverflow.com/questions/38177736/how-to-start-the-upstart-process-for-golang-application", "title": "How to start the upstart process for golang application?", "body": "<p>I am using upstart to start my golang application. I have my application folder structure like this,</p>\n\n<pre><code>   web-app/\n         /app\n             main.go\n</code></pre>\n\n<p>I built the application as below,</p>\n\n<pre><code>$cd /home/ec2-user/go/src/github.com/dineshappavoo/web-app/app/\n$go build ./...\n</code></pre>\n\n<p>It generated the binary <code>app</code></p>\n\n<p>And placed the <code>web-app.conf</code> in <code>/etc/init/</code> folder. Here is the web-app.conf content,</p>\n\n<pre><code>#Web app upstart script\ndescription \"start and stop web app\"\n\nstart on (net-device-up\nand local-filesystems\nand runlevel [2345])\n\nstop on runlevel [016]\n\nrespawn\nrespawn limit 5 30\n\nconsole output\n\nscript\n    chdir /home/ec2-user/go/src/github.com/dineshappavoo/web-app/app\n    exec ./app\nend script\n</code></pre>\n\n<p>When I tried sudo initctl list, it lists the process as <code>stop/waiting</code>. And I tried to start the process </p>\n\n<p>$sudo initctl start web-app</p>\n\n<p>It shows the process as <code>start/running</code>. But it is not started.</p>\n\n<p>I checked the <code>/var/log/messages</code> logs. It shows,</p>\n\n<pre><code>init: web-app main process (18740) terminated with status 127\n</code></pre>\n\n<p>I couldn't start the process. I think there is some issue with the chdir. I tried different options for past two days. And I am fairly new to upstart but no luck. Could someone help me with this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467602816, "post_id": 38176356, "comment_id": 63780206, "body": "See <a href=\"http://go-database-sql.org/index.html\" rel=\"nofollow noreferrer\">Go database/sql tutorial</a>"}], "answers": [{"tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": false, "score": 3, "last_activity_date": 1467622124, "creation_date": 1467622124, "answer_id": 38180385, "question_id": 38176356, "link": "https://stackoverflow.com/questions/38176356/golang-how-can-i-do-a-dependency-injection-to-store-some-string-values/38180385#38180385", "title": "Golang how can I do a Dependency Injection to store some string values", "body": "<p>I would probably do this by opening a session to the database once, then pass this session around to any function or method that may need it. This has a few potential problems:</p>\n\n<ul>\n<li>You may need to lock access to it, so you don't co-mingle multiple queries on the same session (but it may be that your DB library ensures this, FWIW \"database/sql\" is concurrency-safe and recommends NOT opening short-lived database connections)</li>\n<li>You can't safely close the session as it may still be in use elsewhere.</li>\n</ul>\n\n<p>Another way would be to have a function that returns a DB sesssion, so instead of doing:</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"user:password@tcp(127.0.0.1:3306)/hello\")\n</code></pre>\n\n<p>You do the following:</p>\n\n<pre><code>func dbSession() (sql.DB, error) {\n  return sql.Open(\"mysql\", \"credentials\")\n}\n\nfunc ReadAll() {\n    db, err := dbSession()\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer db.Close() \n}\n</code></pre>\n\n<p>And if you want even more flexibility, you can have a struct that contains the data you need, then build your DB connection parameters from that.</p>\n\n<pre><code>type dbData struct {\n    DBType, DBName, User, Host, Password string\n}\nvar DBData dbData\n\nfunc dbSession() (*sql.DB, error) {\n  return sql.Open(DBData.DBType, fmt.Sprintf(\"%s:%s@tcp(%s)/%s\", DBData.User, DBData.Password, DBData.Host, DBData.DBName)\n}\n</code></pre>\n\n<p>Also note the following in the documentation from <code>sql.Open</code>:</p>\n\n<blockquote>\n  <p>The returned DB is safe for concurrent use by multiple goroutines and\n  maintains its own pool of idle connections. Thus, the Open function \n  should be called just once. It is rarely necessary to close a DB.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 1069111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e688182857c8eb01dbd9ac9320c1db6e?s=128&d=identicon&r=PG", "display_name": "MrMagix", "link": "https://stackoverflow.com/users/1069111/mrmagix"}, "is_accepted": false, "score": 1, "last_activity_date": 1467622564, "creation_date": 1467622564, "answer_id": 38180536, "question_id": 38176356, "link": "https://stackoverflow.com/questions/38176356/golang-how-can-i-do-a-dependency-injection-to-store-some-string-values/38180536#38180536", "title": "Golang how can I do a Dependency Injection to store some string values", "body": "<p>you can easily create a new File with your credentials. Just have the file be in the main package main.</p>\n\n<pre><code>package main\n\nvar myDBConnectionString := \"mysql://....\"\n</code></pre>\n\n<p>This will be included when you compile your source.</p>\n\n<p>The problem is, that you have to recompile your code everytime you have to connect to another database. Think about a development System vs. production System. The database credentials should differ in those systems, right? :)</p>\n\n<p>To fix this, it is quit common to have a config file. So you can change the credentials with out re compiling your code. </p>\n\n<p>I've got an other idea - just connect to the db once, and access this resource globally. \n    package main</p>\n\n<pre><code>import (\n    \"fmt\"\n)\n\nvar myDb = \"example\"\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    doSomthingWithDatabase()\n}\n\nfunc doSomthingWithDatabase() {\n   fmt.Println(\"We can access a global variable here, see\", myDb)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/npZ6Z49ink\" rel=\"nofollow\">https://play.golang.org/p/npZ6Z49ink</a></p>\n\n<p>For the configuration handling you can look here\n<a href=\"https://blog.gopheracademy.com/advent-2014/reading-config-files-the-go-way/\" rel=\"nofollow\">https://blog.gopheracademy.com/advent-2014/reading-config-files-the-go-way/</a> </p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 10472883, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-grRc3vJ9PiI/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV6-nExlrOn-PuZEkVwLLNiIJOXgw/mo/photo.jpg?sz=128", "display_name": "John Deng", "link": "https://stackoverflow.com/users/10472883/john-deng"}, "is_accepted": false, "score": 1, "last_activity_date": 1543549902, "last_edit_date": 1543549902, "creation_date": 1539058002, "answer_id": 52713228, "question_id": 38176356, "link": "https://stackoverflow.com/questions/38176356/golang-how-can-i-do-a-dependency-injection-to-store-some-string-values/52713228#52713228", "title": "Golang how can I do a Dependency Injection to store some string values", "body": "<p><a href=\"https://github.com/hidevopsio/hiboot-data\" rel=\"nofollow noreferrer\">hiboot-data</a> provides out of the box  starter that meet your requirement, the starter is github.com/hidevopsio/hiboot-data/starter/gorm, or you can implement your own starter by using <a href=\"https://github.com/hidevopsio/hiboot\" rel=\"nofollow noreferrer\">hiboot</a> framework, then you can inject then anywhere to decouple from the creation of the database configuration.</p>\n\n<pre><code>package service\n\n\nimport (\n    \"errors\"\n    \"hidevops.io/hiboot-data/examples/gorm/entity\"\n    \"hidevops.io/hiboot-data/starter/gorm\"\n    \"hidevops.io/hiboot/pkg/app\"\n    \"hidevops.io/hiboot/pkg/utils/idgen\"\n)\n\ntype UserService interface {\n    AddUser(user *entity.User) (err error)\n    GetUser(id uint64) (user *entity.User, err error)\n    GetAll() (user *[]entity.User, err error)\n    DeleteUser(id uint64) (err error)\n}\n\ntype UserServiceImpl struct {\n    // add UserService, it means that the instance of UserServiceImpl can be found by UserService\n    UserService\n    repository gorm.Repository\n}\n\nfunc init() {\n    // register UserServiceImpl\n    app.Component(newUserService)\n}\n\n// will inject BoltRepository that configured in github.com/hidevopsio/hiboot/pkg/starter/data/bolt\nfunc newUserService(repository gorm.Repository) UserService {\n    repository.AutoMigrate(&amp;entity.User{})\n    return &amp;UserServiceImpl{\n        repository: repository,\n    }\n}\n\nfunc (s *UserServiceImpl) AddUser(user *entity.User) (err error) {\n    if user == nil {\n        return errors.New(\"user is not allowed nil\")\n    }\n    if user.Id == 0 {\n        user.Id, _ = idgen.Next()\n    }\n    err = s.repository.Create(user).Error()\n    return\n}\n\nfunc (s *UserServiceImpl) GetUser(id uint64) (user *entity.User, err error) {\n    user = &amp;entity.User{}\n    err = s.repository.Where(\"id = ?\", id).First(user).Error()\n    return\n}\n\nfunc (s *UserServiceImpl) GetAll() (users *[]entity.User, err error) {\n    users = &amp;[]entity.User{}\n    err = s.repository.Find(users).Error()\n    return\n}\n\nfunc (s *UserServiceImpl) DeleteUser(id uint64) (err error) {\n    err = s.repository.Where(\"id = ?\", id).Delete(entity.User{}).Error()\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 1821, "user_id": 5025978, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e0592a69df972d842ea313bacdee7f81?s=128&d=identicon&r=PG&f=1", "display_name": "Ignacio Perez", "link": "https://stackoverflow.com/users/5025978/ignacio-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 898, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1543549902, "creation_date": 1467601026, "question_id": 38176356, "link": "https://stackoverflow.com/questions/38176356/golang-how-can-i-do-a-dependency-injection-to-store-some-string-values", "title": "Golang how can I do a Dependency Injection to store some string values", "body": "<p>I am using a mysql database and have many different Functions/Methods that interact with the database. For every Function I offcourse have to supply the Database Credentials such as </p>\n\n<p><em>ReadAll.go</em></p>\n\n<pre><code>func ReadAll() {\n    db, err := sql.Open(\"mysql\",\n        \"user:password@tcp(127.0.0.1:3306)/hello\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer db.Close()\n}\n</code></pre>\n\n<p>The part of <strong>\"mysql\",\n            \"user:password@tcp(127.0.0.1:3306)/hello\"</strong> never changes and I am supplying that to every Function that interacts with DB. I was wondering how can I for instance create a new File say <em>DataBase.go</em> put those credentials into some global variable and then reference when I need those strings ? That way if I have to change the credentials I only have to change them in 1 place.\nI want to do something like</p>\n\n<p><em>Database.go</em></p>\n\n<pre><code>const GlobalDB := \"mysql\",\"user:password@tcp(127.0.0.1:3306)/hello\"\n</code></pre>\n\n<p>then </p>\n\n<p>ReadAll.go</p>\n\n<pre><code>func ReadAll() {\n    db, err := sql.Open(GlobalDB)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer db.Close()\n}\n</code></pre>\n\n<p>I am brand new to Golang but trying to figure this out.</p>\n"}, {"tags": ["go", "go-gin", "goose"], "answers": [{"tags": [], "owner": {"reputation": 18792, "user_id": 385548, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e8f290affc1d939cf9a4ad2c9e79592a?s=128&d=identicon&r=PG", "display_name": "Vojtech Vitek", "link": "https://stackoverflow.com/users/385548/vojtech-vitek"}, "is_accepted": true, "score": 2, "last_activity_date": 1497902987, "creation_date": 1497902987, "answer_id": 44639090, "question_id": 38176290, "link": "https://stackoverflow.com/questions/38176290/how-to-create-new-goose-database-migration-golang/44639090#44639090", "title": "How to create new goose database migration (golang)", "body": "<p>This has been fixed in recent versions of <a href=\"https://github.com/pressly/goose\" rel=\"nofollow noreferrer\">https://github.com/pressly/goose</a>.</p>\n"}], "owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3417, "favorite_count": 0, "accepted_answer_id": 44639090, "answer_count": 1, "score": 0, "last_activity_date": 1597431467, "creation_date": 1467600492, "last_edit_date": 1597431467, "question_id": 38176290, "link": "https://stackoverflow.com/questions/38176290/how-to-create-new-goose-database-migration-golang", "title": "How to create new goose database migration (golang)", "body": "<p>I use goget to install goose for database migration following <a href=\"https://github.com/pressly/goose\" rel=\"nofollow\">https://github.com/pressly/goose</a>. But when i use <code>goose create SomeThing</code> it not working,and i dont now why. \nPlease help me!</p>\n\n<p>I have created successfully. I go get following url <a href=\"https://bitbucket.org/liamstask/goose/\" rel=\"nofollow\">https://bitbucket.org/liamstask/goose/</a> . and it worked.</p>\n"}, {"tags": ["go", "rethinkdb", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 25797, "user_id": 316357, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50e7e6ec58e101311283a40e60c33572?s=128&d=identicon&r=PG", "display_name": "Curious2learn", "link": "https://stackoverflow.com/users/316357/curious2learn"}, "edited": false, "score": 0, "creation_date": 1467745935, "post_id": 38191765, "comment_id": 63845813, "body": "Thanks! Yes, that helps. Are you the same Daniel Cannon who has written gorethink. If so, thanks a ton. It is an awesome library."}, {"owner": {"reputation": 554, "user_id": 595810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3772bef568ee12d860832bb2fa113745?s=128&d=identicon&r=PG", "display_name": "Daniel Cannon", "link": "https://stackoverflow.com/users/595810/daniel-cannon"}, "reply_to_user": {"reputation": 25797, "user_id": 316357, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50e7e6ec58e101311283a40e60c33572?s=128&d=identicon&r=PG", "display_name": "Curious2learn", "link": "https://stackoverflow.com/users/316357/curious2learn"}, "edited": false, "score": 0, "creation_date": 1467758677, "post_id": 38191765, "comment_id": 63851594, "body": "Great, glad its working now :) (and yes I did write GoRethink thanks! If you have any other questions feel free to get in touch on the RethinkDB slack)"}], "tags": [], "owner": {"reputation": 554, "user_id": 595810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3772bef568ee12d860832bb2fa113745?s=128&d=identicon&r=PG", "display_name": "Daniel Cannon", "link": "https://stackoverflow.com/users/595810/daniel-cannon"}, "is_accepted": true, "score": 1, "last_activity_date": 1467663791, "creation_date": 1467663791, "answer_id": 38191765, "question_id": 38175743, "link": "https://stackoverflow.com/questions/38175743/how-to-stop-a-goroutine-that-is-listening-for-rethinkdb-changefeeds/38191765#38191765", "title": "How to stop a goroutine that is listening for RethinkDB changefeeds?", "body": "<p>You can stop a goroutine that is listening to a changefeed by closing the cursor. For example this code will listen to a changefeed for 10 seconds before closing:</p>\n\n<pre><code>go func() {\n    time.Sleep(10 * time.Second)\n    cur.Close()\n}()\n\nfor cur.Next(&amp;rec) {\n    c &lt;- rec\n}\n\n// Loop exits as the cursor has been closed\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10401687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PNPzb.jpg?s=128&g=1", "display_name": "Lucas L&#246;ffel", "link": "https://stackoverflow.com/users/10401687/lucas-l%c3%b6ffel"}, "is_accepted": false, "score": 0, "last_activity_date": 1537642072, "creation_date": 1537642072, "answer_id": 52459801, "question_id": 38175743, "link": "https://stackoverflow.com/questions/38175743/how-to-stop-a-goroutine-that-is-listening-for-rethinkdb-changefeeds/52459801#52459801", "title": "How to stop a goroutine that is listening for RethinkDB changefeeds?", "body": "<p>You should stop the changefeed via <a href=\"https://golang.org/pkg/context\" rel=\"nofollow noreferrer\">context</a>. You can pass your context to the <code>RunOpts</code>. This will close your changefeed immediately.</p>\n"}, {"tags": [], "owner": {"reputation": 1122, "user_id": 4970650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496526a825adf2e6587a19d3a6d391f7?s=128&d=identicon&r=PG", "display_name": "Cirelli94", "link": "https://stackoverflow.com/users/4970650/cirelli94"}, "is_accepted": false, "score": 0, "last_activity_date": 1580125773, "creation_date": 1580125773, "answer_id": 59930583, "question_id": 38175743, "link": "https://stackoverflow.com/questions/38175743/how-to-stop-a-goroutine-that-is-listening-for-rethinkdb-changefeeds/59930583#59930583", "title": "How to stop a goroutine that is listening for RethinkDB changefeeds?", "body": "<p>I think the best way to manage this situation is using <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">contexts</a> to close the cursor, with a goroutine.\nHere some <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">good documentation from the go blog</a> about contexts.</p>\n\n<p>Here it's an example of the implementation with context:</p>\n\n<pre><code>func AreThereChanges(ctx context.Context) error {\n    cursor, err := r.Table(\"something\").\n        Changes().\n        Run(db.Session)\n\n    if err != nil {\n      //manage error\n    }\n\n    go func(ctx context.Context) {\n        &lt;-ctx.Done()\n        cursor.Close()\n    }(ctx)\n\n    var changeFeed map[string]interface{}\n    for cursor.Next(&amp;changeFeed) {\n        if changeFeed[\"old_val\"] != nil {\n          //do something\n        }\n\n        if changeFeed[\"new_val\"] != nil {\n          //do something\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 25797, "user_id": 316357, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50e7e6ec58e101311283a40e60c33572?s=128&d=identicon&r=PG", "display_name": "Curious2learn", "link": "https://stackoverflow.com/users/316357/curious2learn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 38191765, "answer_count": 3, "score": 3, "last_activity_date": 1580125773, "creation_date": 1467594769, "question_id": 38175743, "link": "https://stackoverflow.com/questions/38175743/how-to-stop-a-goroutine-that-is-listening-for-rethinkdb-changefeeds", "title": "How to stop a goroutine that is listening for RethinkDB changefeeds?", "body": "<p>I am trying to figure out how to use RethinkDB changefeeds with golang.\nMy specific question is how to stop a goroutine that listens for changes to the\ndatabase. See, for example, the function <code>getData()</code> below. I run this from a handler\nfunction by calling <code>go getData(c)</code>. Whenever the database updates, the record is\npassed to the channel <code>c</code>, which is then passed to the handler function and sent to the client\nusing SSE technology. My question is: when the client disconnects, I know how to stop and exit\nthe handler function; however the goroutine that is running the <code>getData()</code> function, keeps running. What can\nI do to close it? One solution I can think of based on other answers on stackoverflow is to\nsend a signal to close the goroutine on another channel and use a select statement to handle this\nsignal. For example, I can replace</p>\n\n<pre><code>    for cur.Next(&amp;rec) {\n        c &lt;- rec\n    }\n</code></pre>\n\n<p>in the function definition below with:</p>\n\n<pre><code>    for cur.Next(&amp;rec) {\n        select {\n         case &lt;- closesignal:\n            return\n         default:\n            c &lt;- rec\n        }\n    }\n</code></pre>\n\n<p>where, <code>closesignal</code> is another channel that is given as a third argument to <code>getData()</code> and\na message is sent on this channel by the handler when the client disconnects.</p>\n\n<p>The problem with this approach is: what if the result of the specific rethinkdb query\nnever updates. In that case, the <code>for cur.Next(&amp;rec)</code> loop will not be entered and the <code>closesignal</code> will not be used.\nWould this goroutine then keep running? If so, how do I stop this goroutine? </p>\n\n<p><strong>The <code>getData()</code> function</strong></p>\n\n<pre><code>func getData(session *r.Session, c chan interface{}) {\n    var rec interface{}\n\n    changesOpts := r.ChangesOpts{\n        IncludeInitial: true,\n    }\n\n    cur, err := r.DB(DBNAME).Table(\"test\").Changes(changesOpts).Run(session)\n    if err != nil {\n        log.Println(err)\n        return\n    }\n    defer cur.Close()\n\n    defer func() {\n        fmt.Println(\"exiting getData goroutine()...\")\n    }()\n\n\n    for cur.Next(&amp;rec) {\n        c &lt;- rec\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go", "scope"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1467590274, "post_id": 38175345, "comment_id": 63778042, "body": "It&#39;s awkward, but yes, that&#39;s exactly what you have to do. <code>:=</code> with multiple vars on the left will redeclare <i>all</i> of them that weren&#39;t already declared in the same scope."}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 2, "last_activity_date": 1467591726, "last_edit_date": 1467591726, "creation_date": 1467590744, "answer_id": 38175408, "question_id": 38175345, "link": "https://stackoverflow.com/questions/38175345/variable-declared-and-not-used-in-conditional-statement/38175408#38175408", "title": "Variable declared and not used in conditional statement", "body": "<p>The extra <code>var error</code> is awkward, but it's a common way to address this situation. <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow\">The spec on scoping</a> says (emphasis mine):</p>\n\n<blockquote>\n  <p>The scope of a constant or variable identifier declared inside a function begins at the end of the ConstSpec or VarSpec (ShortVarDecl for short variable declarations) and ends at the end of the <em>innermost containing block</em>.</p>\n</blockquote>\n\n<p>So in your case, that short variable declaration is declaring a <em>different</em> <code>limitI</code> scoped to the \"innermost containing block.\" Since it only \"lives\" until the next closing brace, it isn't used.</p>\n\n<p>In your specific case, an option might be to declare <code>err</code> outside the if/else, since it's used in both inner scopes, so you can use use <code>=</code> instead of <code>:=</code> with those functions returning <code>error</code>s.  Then there's no \"inner <code>limitI</code>\" declared and you have no unused variable issue.</p>\n\n<p>\"Shadowing\" situations like this can also produce unexpected behavior rather than an error. <code>go vet -shadow</code> <a href=\"https://golang.org/cmd/vet/#hdr-Shadowed_variables\" rel=\"nofollow\">tries to detect \"[v]ariables that may have been unintentionally shadowed\"</a> and, different but related, <a href=\"https://github.com/gordonklaus/ineffassign\" rel=\"nofollow\">gordonklaus/ineffasign</a> generalizes the \"unused variable\" check to detect useless assignments even if they weren't declarations.</p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1547331803, "creation_date": 1547331803, "answer_id": 54164422, "question_id": 38175345, "link": "https://stackoverflow.com/questions/38175345/variable-declared-and-not-used-in-conditional-statement/54164422#54164422", "title": "Variable declared and not used in conditional statement", "body": "<blockquote>\n  <p>The only thing I could come up with was to separately declare another err variable</p>\n</blockquote>\n\n<p>This is being studied in the context of a future Go 2 (2019? 2020).<br>\nSee \"<a href=\"https://go.googlesource.com/proposal/+/master/design/go2draft-error-handling-overview.md\" rel=\"nofollow noreferrer\">Error Handling \u2014 Problem Overview</a>\" (Russ Cox - August 27, 2018)</p>\n\n<p>A possible proposed new syntax would avoid having to redeclare err:</p>\n\n<p>Example:</p>\n\n<pre><code>func CopyFile(src, dst string) error {\n    handle err {\n        return fmt.Errorf(\"copy %s %s: %v\", src, dst, err)\n    }\n\n    r := check os.Open(src)\n    defer r.Close()\n\n    w := check os.Create(dst)\n    handle err {\n        w.Close()\n        os.Remove(dst) // (only if a check fails)\n    }\n\n    check io.Copy(w, r)\n    check w.Close()\n    return nil\n}\n</code></pre>\n\n<hr>\n\n<p>Note that <code>go vet -shadow</code> is no longer available <a href=\"https://tip.golang.org/doc/go1.12#vet\" rel=\"nofollow noreferrer\">since Go 1.12</a> (February 2019): </p>\n\n<blockquote>\n  <p>The experimental <code>-shadow</code> option is no longer available with <code>go vet</code>.<br>\n  Checking for variable shadowing may now be done using</p>\n\n<pre><code>go install golang.org/x/tools/go/analysis/passes/shadow/cmd/shadow\ngo vet -vettool=$(which shadow)\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1868, "favorite_count": 2, "accepted_answer_id": 38175408, "answer_count": 2, "score": 3, "last_activity_date": 1547331803, "creation_date": 1467589909, "last_edit_date": 1467590873, "question_id": 38175345, "link": "https://stackoverflow.com/questions/38175345/variable-declared-and-not-used-in-conditional-statement", "title": "Variable declared and not used in conditional statement", "body": "<p>I declare some variables (<code>offsetI</code> and <code>limitI</code>) outside of a conditional statement.  Inside the conditional statement I am trying to assign them values, then use those values for a query after the conditional statement.</p>\n\n<pre><code>var (\n    number, size, offset, limit string\n    offsetI, limitI             uint64\n)\n\n// Get the string values for number, size, offset, and limit\n// ...\n\nif size != \"\" {\n\n    // Parse the number value\n    numberI, err := strconv.ParseUint(number, 10, 64)\n    if err != nil {...}\n\n    // Parse the size value\n    limitI, err = strconv.ParseUint(size, 10, 64)\n    if err != nil {...}\n\n    // Calculate the offset\n    offsetI = numberI * limitI\n\n} else {\n\n    // Parse the limit value\n    limitI, err := strconv.ParseUint(limit, 10, 64)         // limitI declared and not used\n    if err != nil {...}\n\n    // Parse the offset value\n    offsetI, err = strconv.ParseUint(offset, 10, 64)\n    if err != nil {...}\n}\n\n// Make the query using offsetI and limitI\nresult, err := s.GetAllPaginated(offsetI, limitI)\nif err != nil {...}\n</code></pre>\n\n<hr>\n\n<p>I am not intending to re-declare the <code>limitI</code> variable in the scope of the <code>else</code> statement, but I need to use the <code>:=</code> operator for declaring a new <code>err</code> variable.  </p>\n\n<p>The only thing I could come up with was to separately declare another <code>err</code> variable, so I could use a regular assignment statement:</p>\n\n<pre><code>} else {\n\n    var err error    // New\n\n    // Regular assignment statement now\n    limitI, err = strconv.ParseUint(limit, 10, 64)\n    if err != nil {...}\n</code></pre>\n\n<hr>\n\n<p>I would like to be able to do this without having to declare an additional error variable.</p>\n"}, {"tags": ["ssl", "go", "https"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1467572326, "post_id": 38173310, "comment_id": 63773868, "body": "Again, that warning is but a warning: your grade A is safe ;)"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1467572352, "post_id": 38173310, "comment_id": 63773870, "body": "<a href=\"http://security.stackexchange.com/questions/79519/ssl-tls-how-to-fix-chain-issues-contains-anchor#comment135658_79519\" title=\"ssl tls how to fix chain issues contains anchor%23comment135658_79519\">security.stackexchange.com/questions/79519/&hellip;</a> did not help?"}, {"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1467572509, "post_id": 38173310, "comment_id": 63773911, "body": "@VonC - I know it&#39;s just a warning but if there is a way to suppress the warning, i&#39;d like to know how. the url you provided contains an NginX related answer with different configuration of ssl_certificate and ssl_truest_certificate. don&#39;t know how to convert that knowledge to go. btw you are awesome, thanks for your prompt response."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1467572663, "post_id": 38173310, "comment_id": 63773962, "body": "I hoped that if you provide to your ListenAndServeTLS a certificate file which only includes (as mentioned in the link) Site certificate + StartCom Class 1 Primary Intermediate Server CA (instead of the full chain), <i>and</i> add to your <code>certpool</code> sf_bundle-g2-g1.crt (which you do already), that would be enough to get rid of the warning. The fact that it was about NGiNX is not important here."}, {"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1467573053, "post_id": 38173310, "comment_id": 63774086, "body": "@VonC - first... you are awesome! 2nd.. I just tried to append the intermediate cert (gdig2.crt) to the main crt file, and to verify my certificate. i got down to Grade B with &quot;Chain issues\tIncomplete, Extra certs&quot;"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1467573157, "post_id": 38173310, "comment_id": 63774117, "body": "Interesting. So that must be something else. I don&#39;t have much information beside the two links I mentioned in my previous answer though."}, {"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1467573192, "post_id": 38173310, "comment_id": 63774129, "body": "that&#39;s ok. thanks for everything. hope someone else will assist me. have a great day!"}, {"owner": {"reputation": 18405, "user_id": 1145388, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HZ9CL.png?s=128&g=1", "display_name": "Stephen Ostermiller", "link": "https://stackoverflow.com/users/1145388/stephen-ostermiller"}, "edited": false, "score": 0, "creation_date": 1537666583, "post_id": 38173310, "comment_id": 91866736, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/38170775/golang-with-http-ssl-godaddys-certificate-this-servers-certificate-chain-is\">GoLang with http ssl GoDaddy&#39;s certificate - This server&#39;s certificate chain is incomplete.</a>"}], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3193, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1467572139, "creation_date": 1467572139, "last_edit_date": 1495539984, "question_id": 38173310, "link": "https://stackoverflow.com/questions/38173310/godaddy-ssl-cert-verified-grade-a-with-chain-issues-contains-anchor", "title": "Godaddy ssl cert verified Grade A with Chain issues - Contains anchor", "body": "<p>:)</p>\n\n<p>I'm using GoLang to start an https server.</p>\n\n<p>according to <a href=\"https://www.ssllabs.com/ssltest\" rel=\"nofollow noreferrer\">https://www.ssllabs.com/ssltest</a> my certificate configuration is Grade A with the warning <code>Chain issues - Contains anchor</code>.</p>\n\n<p>In my previous post (<a href=\"https://stackoverflow.com/questions/38170775/golang-with-http-ssl-godaddys-certificate-this-servers-certificate-chain-is\">GoLang with http ssl GoDaddy&#39;s certificate - This server&#39;s certificate chain is incomplete.</a>), @VonC helped me for the second time and also alerted me of that warning. </p>\n\n<p>I tried everything I could think of and couldn't resolve the issue. GoDaddy as a repository of certs and I tried to download gdroot-g2.crt and configure it as <code>RootCAs</code>, I tried download the intermindate certificate named gdig2.crt and configured it as <code>ClientCAs</code>, but the results are the same.</p>\n\n<p>what am I missing ?</p>\n\n<p>for full code please view my previous stack overflow post at <a href=\"https://stackoverflow.com/questions/38170775/golang-with-http-ssl-godaddys-certificate-this-servers-certificate-chain-is\">GoLang with http ssl GoDaddy&#39;s certificate - This server&#39;s certificate chain is incomplete.</a>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1467615077, "post_id": 38173251, "comment_id": 63783809, "body": "Thanks for including a complete program. I think you don&#39;t need that <code>reflect.ValueOf</code> in the NullString case (which, note, you don&#39;t have for the string case). I may be misunderstanding the question but I&#39;ll post an answer with a couple code samples."}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 2, "last_activity_date": 1467615625, "creation_date": 1467615625, "answer_id": 38178627, "question_id": 38173251, "link": "https://stackoverflow.com/questions/38173251/getting-the-value-of-sql-nullstring-with-reflection/38178627#38178627", "title": "Getting the value of sql.NullString with reflection", "body": "<p>I think the problem is that an extra <code>reflect.ValueOf</code> meant that you had a <code>reflect.Value</code> <em>referring to another <code>reflect.Value</code></em>, not to the <code>NullString</code>. The way <code>Printf</code> formatted it kind of obscured that. It looks like <code>values.Field(i)</code> returns the <code>reflect.Value</code> you need. <a href=\"https://play.golang.org/p/5bSaxWHvbs\" rel=\"nofollow\">Here's your program</a> minimally modified by taking out the <code>ValueOf</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"reflect\"\n)\n\ntype fooT struct {\n    ID    int64\n    Foo   string\n    NullS sql.NullString\n    FooQ  sql.NullString\n}\n\nfunc main() {\n    foo := fooT{\n        ID:    42,\n        NullS: sql.NullString{\"Your mother was a hamster\", true},\n    }\n\n    types := reflect.TypeOf(foo)\n    values := reflect.ValueOf(foo)\n\n    changed := \"\"\n    for i := 0; i &lt; types.NumField(); i++ {\n        fieldType := types.Field(i)\n        field := values.Field(i)\n\n        switch field.Type().Kind() {\n        // Works\n        case reflect.String:\n            if field.String() != \"\" {\n                changed += fmt.Sprintf(\"&lt;strong&gt;%s&lt;/strong&gt;: %v&lt;br&gt;\\n\",\n                    fieldType.Name, field.String())\n            }\n        default:\n            switch field.Type().String() {\n            case \"sql.NullString\":\n        iface := field.Interface()\n                fmt.Printf(\"%s: %T -&gt; %#v\\n\",\n                    fieldType.Name, iface, iface)\n            }\n        }\n    }\n\n    fmt.Printf(changed)\n}\n</code></pre>\n\n<p>You may be able to simplify more by using a <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow\">type switch</a> to do most of the work, <a href=\"https://play.golang.org/p/VZuoIScAtI\" rel=\"nofollow\">like so</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"reflect\"\n)\n\ntype fooT struct {\n    ID    int64\n    Foo   string\n    NullS sql.NullString\n    FooQ  sql.NullString\n}\n\nfunc main() {\n    foo := fooT{\n        ID:    42,\n        NullS: sql.NullString{\"Your mother was a hamster\", true},\n    }\n\n    values := reflect.ValueOf(foo)\n\n    changed := \"\"\n    for i := 0; i &lt; values.NumField(); i++ {\n        v := values.Field(i)\n        f := v.Interface()\n        switch f := f.(type) {\n        case string:\n            fmt.Println(\"string:\", f)\n        case sql.NullString:\n            fmt.Println(\"NullString:\", f.Valid, f.String)\n        default:\n            fmt.Printf(\"%s: %v\\n\", v.Type(), f)\n        }\n    }\n\n    fmt.Printf(changed)\n}\n</code></pre>\n"}], "owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2024, "favorite_count": 0, "accepted_answer_id": 38178627, "answer_count": 1, "score": 1, "last_activity_date": 1467615625, "creation_date": 1467571711, "question_id": 38173251, "link": "https://stackoverflow.com/questions/38173251/getting-the-value-of-sql-nullstring-with-reflection", "title": "Getting the value of sql.NullString with reflection", "body": "<p>I'd like to get the value of all the fields in a struct that aren't empty. This works for simple primitives (<code>string</code>, <code>int</code>, etc.), but not for struct types such as <code>sql.NullString</code>.</p>\n\n<p>Very simple example:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    type fooT struct {\n        NullS sql.NullString\n    }\n\n    values := reflect.ValueOf(fooT{})\n\n    field := values.Field(0)\n    v := reflect.ValueOf(field)\n\n    iface := v.Interface().(sql.NullString)\n\n    fmt.Println(iface)\n}\n</code></pre>\n\n<p>This gives a panic:</p>\n\n<pre><code>panic: interface conversion: interface is reflect.Value, not sql.NullString\n</code></pre>\n\n<p>I don't understand this, since the <code>Interface</code> method should return an <code>interface{}</code> (and not a <code>reflect.Value</code>) which I can then type assert (?)</p>\n\n<p>First I thought I was maybe using type conversions only works for primitives, but a quick test script:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n)\n\nfunc main() {\n    type fooT struct {\n        NullS sql.NullString\n    }\n\n    foo := fooT{NullS: sql.NullString{\"It's an Aardvark!\", true}}\n\n    var iface interface{}\n    iface = foo.NullS\n\n    fmt.Printf(\"%T -&gt; %#v\\n\", iface, iface)\n    fmt.Printf(\"%T -&gt; %#v -&gt; %#v\\n\", iface.(sql.NullString), iface.(sql.NullString),\n        iface.(sql.NullString).Valid)\n}\n</code></pre>\n\n<p>Reveals that this should work?</p>\n\n<hr>\n\n<p>The full code I'm using:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"reflect\"\n)\n\ntype fooT struct {\n    ID    int64\n    Foo   string\n    NullS sql.NullString\n    FooQ  sql.NullString\n}\n\nfunc main() {\n    foo := fooT{\n        ID:    42,\n        NullS: sql.NullString{\"Your mother was a hamster\", true},\n    }\n\n    types := reflect.TypeOf(foo)\n    values := reflect.ValueOf(foo)\n\n    changed := \"\"\n    for i := 0; i &lt; types.NumField(); i++ {\n        fieldType := types.Field(i)\n        field := values.Field(i)\n\n        switch field.Type().Kind() {\n        // Works\n        case reflect.String:\n            if field.String() != \"\" {\n                changed += fmt.Sprintf(\"&lt;strong&gt;%s&lt;/strong&gt;: %v&lt;br&gt;\\n\",\n                    fieldType.Name, field.String())\n            }\n        default:\n            switch field.Type().String() {\n            case \"sql.NullString\":\n                v := reflect.ValueOf(field)\n\n                // NullS: reflect.Value -&gt; sql.NullString{String:\"Your mother was a hamster\", Valid:true}\n                iface := v.Interface()\n                fmt.Printf(\"%s: %T -&gt; %#v\\n\",\n                    fieldType.Name, iface, iface)\n\n                // panic: interface conversion: interface is reflect.Value, not sql.NullString\n                iface2 := v.Interface().(sql.NullString)\n                fmt.Printf(\"%s: %T -&gt; %#v\\n\",\n                    fieldType.Name, iface2, iface2)\n            }\n        }\n    }\n\n    fmt.Printf(changed)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 43798, "user_id": 759019, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/a6ba85d48d057584ef57f1a648bb4577?s=128&d=identicon&r=PG", "display_name": "Anirudh Ramanathan", "link": "https://stackoverflow.com/users/759019/anirudh-ramanathan"}, "edited": false, "score": 0, "creation_date": 1467573962, "post_id": 38173222, "comment_id": 63774308, "body": "Have you tried printing out the two query strings and checking for differences?"}, {"owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "reply_to_user": {"reputation": 43798, "user_id": 759019, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/a6ba85d48d057584ef57f1a648bb4577?s=128&d=identicon&r=PG", "display_name": "Anirudh Ramanathan", "link": "https://stackoverflow.com/users/759019/anirudh-ramanathan"}, "edited": false, "score": 0, "creation_date": 1467576828, "post_id": 38173222, "comment_id": 63775097, "body": "Yes I did and finally found the answer"}], "answers": [{"tags": [], "owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "is_accepted": false, "score": 0, "last_activity_date": 1467577045, "creation_date": 1467577045, "answer_id": 38173965, "question_id": 38173222, "link": "https://stackoverflow.com/questions/38173222/golang-query-with-float-value-is-not-working-correctly/38173965#38173965", "title": "Golang query with float value is not working correctly", "body": "<p>Hello everyone I have found the answer, if you are collecting form information on a Post and if some of the values are of type decimal,float or double and you want to query that value into the database then use</p>\n\n<pre><code>r.FormValue(\"LatMin\")\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>r.Form[\"LatMin\"]\n</code></pre>\n\n<p>as that will get the correcte</p>\n\n<p>Both of those methods get the correct value however Form[\"\"] as issues with the database.</p>\n"}], "owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 479, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467577045, "creation_date": 1467571525, "question_id": 38173222, "link": "https://stackoverflow.com/questions/38173222/golang-query-with-float-value-is-not-working-correctly", "title": "Golang query with float value is not working correctly", "body": "<p>I am doing a Golang query to the postgres database and the weird thing is that the query only works if I hard-code the value in for instance this query works</p>\n\n<pre><code>db.QueryRow(\"select json_build_object('Streams', array_to_json(array_agg(t))) from (select p.name FROM profiles as p INNER JOIN streams as s ON(s.profile_id = \np.id) WHERE s.latitudes &gt;=28.1036 AND shared = false order by id desc limit 15)t\").Scan(&amp;result)\n</code></pre>\n\n<p>The only part that I now change is where the <strong>WHERE s.latitudes >=28.1036</strong>\ninstead of having that value hard-coded I Past it through a form and now have the query like this</p>\n\n<pre><code>   db.QueryRow(\"select json_build_object('Streams', array_to_json(array_agg(t))) from (select p.name FROM profiles as p INNER JOIN streams as s ON(s.profile_id = \n    p.id) WHERE s.latitudes&gt;=$1 AND shared = false order by id desc limit 15)t\",LatMin).Scan(&amp;result)\n</code></pre>\n\n<p>Now the query just comes back null and I do know for a fact that the LatMin variable is being populated correctly as this is my code</p>\n\n<pre><code>    func Auto_Location(w http.ResponseWriter, r *http.Request) {\n\n        var result string\n        if r.Method == \"GET\" {\n\n        } else {\n            r.ParseForm() }\n\n        LatMin := r.Form[\"LatMin\"]\n\n    db,err := sql.Open(\"Postgres Connects\")\n    if err != nil {\n    log.Fatal(err)\n    println(err)\n\n    }\n   db.QueryRow(\"select json_build_object('Streams', array_to_json(array_agg(t))) from (select p.name FROM profiles as p INNER JOIN streams as s ON(s.profile_id = \n        p.id) WHERE s.latitudes&gt;=$1 AND shared = false order by id desc limit 15)t\",LatMin).Scan(&amp;result)\n    defer db.Close()\n\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n\n\n    fmt.Fprintf(w,result)\n        fmt.Println(\"Value:\", LatMin)\n\n    }\n</code></pre>\n\n<p>Again as you can see from the code I am using FMT and the LatMin has the correct value of 28.1036 is there something that I am missing here.. The postgres package I am using is    <strong>_ \"github.com/lib/pq\"</strong> . I am thinking it is an issue with float values because if I change LatMin to 28 it works but 28.1036 does not</p>\n"}, {"tags": ["parsing", "go", "tcp", "network-protocols"], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1467616179, "post_id": 38176570, "comment_id": 63784414, "body": "Related question and answer <a href=\"http://stackoverflow.com/questions/26999615/go-tcp-read-is-non-blocking\">here</a>, touching on a few relevant APIs in the Go stdlib (<code>net&#47;textproto</code>, <code>io.ReadAtLeast</code> and <code>io.ReadFull</code>)."}, {"owner": {"reputation": 137, "user_id": 2976055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/644cb36ab971be9be687b2f79a89eefa?s=128&d=identicon&r=PG", "display_name": "Arthmost", "link": "https://stackoverflow.com/users/2976055/arthmost"}, "edited": false, "score": 0, "creation_date": 1467655239, "post_id": 38176570, "comment_id": 63805752, "body": "My server is supposed to read basic text messages from a connection (it&#39;s more of a learning task than a real one right now), so I&#39;m not really using existing protocols."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 137, "user_id": 2976055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/644cb36ab971be9be687b2f79a89eefa?s=128&d=identicon&r=PG", "display_name": "Arthmost", "link": "https://stackoverflow.com/users/2976055/arthmost"}, "edited": false, "score": 1, "creation_date": 1467726644, "post_id": 38176570, "comment_id": 63834348, "body": "@Arthmost: you need a &quot;protocol&quot; of  <i>some</i> sort. Whether it&#39;s predetermined message size, length prefixed strings, or <code>:-)</code> terminated, you need to way to know when you&#39;ve read a complete message from the stream."}], "tags": [], "owner": {"reputation": 897, "user_id": 489215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11591979f29ab9c2bb58868232d07b88?s=128&d=identicon&r=PG", "display_name": "Adam Tanner", "link": "https://stackoverflow.com/users/489215/adam-tanner"}, "is_accepted": false, "score": 2, "last_activity_date": 1467603618, "last_edit_date": 1467603618, "creation_date": 1467603039, "answer_id": 38176570, "question_id": 38173153, "link": "https://stackoverflow.com/questions/38173153/as-a-server-that-reads-a-message-how-do-you-find-out-its-length/38176570#38176570", "title": "As a server that reads a message, how do you find out its length?", "body": "<p>It is entirely dependent on the design of the protocol you are attempting to read from the connection.</p>\n\n<p>If you are designing your own protocol you will need to design some way for your reader to determine when to stop reading or predeclare the length of the message.</p>\n\n<p>For <strong>binary protocols</strong>, you will often find some sort of fixed size header that will contain a <code>length</code> value (for example, a big-endian int64) at some known/discoverable header offset. You can then parse the value at the <code>length</code> offset and use that value to read the correct amount of data once you reach the offset beginning the variable length data. Some examples of binary protocols include <code>DNS</code> and <code>HTTP/2</code>.</p>\n\n<p>For <strong>text protocols</strong>, when to stop reading will be encoded in the parsing rules. Some examples of text protocols include <code>HTTP/1.x</code> and <code>SMTP</code>. An <code>HTTP/1.1</code> request for example, declares the protocol to look something like:</p>\n\n<pre><code>METHOD /path HTTP/1.1\\r\\n\nHeader-1: value\\r\\n\nHeader-2: value\\r\\n\nContent-Length: 20\\r\\n\n\\r\\n\nThis is the content.\n</code></pre>\n\n<p>The first line (where line is denoted as ending with <code>\\r\\n</code>) must include the HTTP method, followed by the path (could be absolute or relative), followed by the version.</p>\n\n<p>Subsequent lines are defined to be headers, made up of a key and a value.</p>\n\n<p>The key includes any text from the beginning of the line up to, but not including, the colon. After the colon comes a variable number of insignificant space characters followed by the value.</p>\n\n<p>One of these headers is special and denotes the length of the upcoming body: <code>Content-Length</code>. The value for this header contains the number of bytes to read as the body. For our simple case (ignoring trailers, chunked encoding, etc.), we will assume that the end of the body denotes the end of the request and another request may immediately follow.</p>\n\n<p>After the last header comes a blank line denoting the end of the header block and the beginning of the body (<code>\\r\\n\\r\\n</code>).</p>\n\n<p>Once you are finished reading all the headers you would then take the value from the <code>Content-Length</code> header you parsed and read the next number of bytes corresponding to its value.</p>\n\n<p>For more information check out:</p>\n\n<ul>\n<li><a href=\"https://nerdland.net/2009/12/designing-painless-protocols/\" rel=\"nofollow\">https://nerdland.net/2009/12/designing-painless-protocols/</a></li>\n<li><a href=\"http://www.catb.org/esr/writings/taoup/html/ch05s03.html\" rel=\"nofollow\">http://www.catb.org/esr/writings/taoup/html/ch05s03.html</a></li>\n<li><a href=\"https://www.ietf.org/rfc/rfc3117.txt\" rel=\"nofollow\">https://www.ietf.org/rfc/rfc3117.txt</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 2976055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/644cb36ab971be9be687b2f79a89eefa?s=128&d=identicon&r=PG", "display_name": "Arthmost", "link": "https://stackoverflow.com/users/2976055/arthmost"}, "is_accepted": true, "score": 0, "last_activity_date": 1467904468, "creation_date": 1467904468, "answer_id": 38249188, "question_id": 38173153, "link": "https://stackoverflow.com/questions/38173153/as-a-server-that-reads-a-message-how-do-you-find-out-its-length/38249188#38249188", "title": "As a server that reads a message, how do you find out its length?", "body": "<p>In the end what I did was create a 1024 byte slice, then read the message from the connection, then shorten the slice to the number of integers read.</p>\n"}, {"tags": [], "owner": {"reputation": 4939, "user_id": 2906820, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2d458add2417430233cc4877e80a01d5?s=128&d=identicon&r=PG&f=1", "display_name": "rodolk", "link": "https://stackoverflow.com/users/2906820/rodolk"}, "is_accepted": false, "score": 0, "last_activity_date": 1468296340, "last_edit_date": 1495540732, "creation_date": 1468296340, "answer_id": 38319862, "question_id": 38173153, "link": "https://stackoverflow.com/questions/38173153/as-a-server-that-reads-a-message-how-do-you-find-out-its-length/38319862#38319862", "title": "As a server that reads a message, how do you find out its length?", "body": "<p>The solution selected as correct is not good. What happens if the messages is more than 1024 Bytes? You need to have a protocol of the form TLV (Type Length Value) or just LV if you don't have different types of messages. For example, Type can be 2 Bytes and Length can be 2 Bytes. Then you first always read 4 Bytes, then based on the length indicated in Bytes 2 and 3, you will know how many Bytes come later and then you read the rest. There is something else you need to take into account: TCP is stream oriented so in order to read the complete TCP message you might need to read many times. Read this (it is for Java but useful for any language): <a href=\"https://stackoverflow.com/questions/19839172/how-to-read-all-of-inputstream-in-server-socket-java/19863726#19863726\">How to read all of Inputstream in Server Socket JAVA</a></p>\n"}], "owner": {"reputation": 137, "user_id": 2976055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/644cb36ab971be9be687b2f79a89eefa?s=128&d=identicon&r=PG", "display_name": "Arthmost", "link": "https://stackoverflow.com/users/2976055/arthmost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 38249188, "answer_count": 3, "score": 0, "last_activity_date": 1468296340, "creation_date": 1467570964, "last_edit_date": 1467607486, "question_id": 38173153, "link": "https://stackoverflow.com/questions/38173153/as-a-server-that-reads-a-message-how-do-you-find-out-its-length", "title": "As a server that reads a message, how do you find out its length?", "body": "<p>I'm programming a server that accepts an incoming connection from a client and then reads from it (via net.Conn.Read()). I'm going to be reading the message into a []byte slice obviously and then processing it in an unrelated way, but the question is - how do I find out the length of this message first to create a slice of according length?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 4, "creation_date": 1467567860, "post_id": 38172661, "comment_id": 63772530, "body": "Those <i>are</i> pointers like we have in C++."}, {"owner": {"reputation": 911, "user_id": 2576477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c8ccd99dc46ccfc8701b0302127757c?s=128&d=identicon&r=PG", "display_name": "turhanco", "link": "https://stackoverflow.com/users/2576477/turhanco"}, "edited": false, "score": 2, "creation_date": 1467568433, "post_id": 38172661, "comment_id": 63772700, "body": "They are pointers. You can visit <a href=\"https://www.golang-book.com/books/intro/8\" rel=\"nofollow noreferrer\">golang-book.com/books/intro/8</a>  for more information about pointers."}, {"owner": {"reputation": 680, "user_id": 4665371, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/15216032392f58f35467a320cd6076c7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4665371/david"}, "reply_to_user": {"reputation": 911, "user_id": 2576477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c8ccd99dc46ccfc8701b0302127757c?s=128&d=identicon&r=PG", "display_name": "turhanco", "link": "https://stackoverflow.com/users/2576477/turhanco"}, "edited": false, "score": 0, "creation_date": 1467658585, "post_id": 38172661, "comment_id": 63807038, "body": "@turhanco, I know they are pointers. but for example what line 5 and 7 do? they are function not variable."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1467758146, "post_id": 38172661, "comment_id": 63851441, "body": "@David, your example doesn&#39;t look like a valid Go code. Write a proper example, ideally which can be run on golang.org. But in any case, Go pointers are pretty much the same as in C++. You get a pointer with <code>&amp;</code> and dereference it with <code>*</code>. <code>*</code> is also used to declare pointer type. Just like in C++."}, {"owner": {"reputation": 680, "user_id": 4665371, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/15216032392f58f35467a320cd6076c7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4665371/david"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1467820473, "post_id": 38172661, "comment_id": 63878621, "body": "@creker, My problem is in lines 1 and 7 in which callproperfunction is used but I cannot understand what these two lines do."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1467822021, "post_id": 38172661, "comment_id": 63879521, "body": "@David, I don&#39;t understand them either. I don&#39;t know what are <code>callproperfunction</code>, <code>addtother</code>, <code>randomstring</code>, <code>lengthofcurrent</code>, Line 7 doesn&#39;t look like Go code at all. <code>func1.newfunc[]</code> also doesn&#39;t look like Go. Write a proper example that works and can be executed at golang.org."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1467822183, "post_id": 38172661, "comment_id": 63879632, "body": "@David, regarding functions. Go supports first class functions. It means that you can pass them as arguments, return them, store in collections etc. But you can&#39;t take a pointer to a function. When you write <code>foo := initial1</code>, <code>foo</code> will already be equal to the address of <code>initial1</code>. So <code>&amp;</code> and <code>*</code> doesn&#39;t work with functions. Check out this <a href=\"https://golang.org/doc/codewalk/functions/\" rel=\"nofollow noreferrer\">golang.org/doc/codewalk/functions</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1467568788, "post_id": 38172757, "comment_id": 63772815, "body": "Also by default Go does not allow pointer arithmetic and casting (type conversion) between incompatible types. And I would say pointers in Go are more like references in Java/C# than pointers in C++"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1467881356, "post_id": 38172757, "comment_id": 63903300, "body": "There are no casts in Go \u2014 it has type conversions."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1468036082, "post_id": 38172757, "comment_id": 63975141, "body": "(My closest comparison point for Go pointers is C# ValueType pointers. Java and C# <i>object</i> references also add additional capabilities (like virtual methods) and costs (like object headers).)"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1468170219, "post_id": 38172757, "comment_id": 64005731, "body": "@twotwotwo, object references are like interfaces in Go. They also has support for dynamic dispatch and additional cost (interface value also has a pointer to the underlying type)"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1468175696, "post_id": 38172757, "comment_id": 64007362, "body": "@creker Yep, all true."}], "tags": [], "owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "is_accepted": false, "score": 14, "last_activity_date": 1467569144, "last_edit_date": 1467569144, "creation_date": 1467568445, "answer_id": 38172757, "question_id": 38172661, "link": "https://stackoverflow.com/questions/38172661/what-is-the-meaning-of-and/38172757#38172757", "title": "What is the meaning of &#39;*&#39; and &#39;&amp;&#39;?", "body": "<p>Those <em>are</em> pointers like we have in C++.</p>\n\n<p>The differences are:</p>\n\n<ul>\n<li><p>Instead of <code>-&gt;</code> to call a method on a pointer, you <em>always</em>  use <code>.</code>, i.e. <code>pointer.method()</code>.</p></li>\n<li><p>There are no dangling pointers. It is perfectly valid to return a pointer to a local variable. Golang will ensure the lifetime of the object and garbage-collect it when it's no longer needed.</p></li>\n<li><p>Pointers can be created with <code>new()</code> or by creating a object <code>object{}</code> and taking the address of it with <code>&amp;</code>.</p></li>\n<li><p>Golang does not allow pointer-arithmetic (arrays do not decay to pointers) and insecure casting. All downcasts will be checked using the runtime-type of the variable and either <code>panic</code> or return false as second return-value when the instance is of the wrong type, depending on whether you actually take the second return type or not.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 3151, "user_id": 2119946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cae444ffe4d22b6b3bffb9114405f41d?s=128&d=identicon&r=PG", "display_name": "Faris Rayhan", "link": "https://stackoverflow.com/users/2119946/faris-rayhan"}, "edited": false, "score": 0, "creation_date": 1542011624, "post_id": 45993495, "comment_id": 93401214, "body": "simply saying &amp; will point to variable that has no value while * will point to variable that has value in there"}], "tags": [], "owner": {"reputation": 704, "user_id": 5514233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1009db1e4d7120b45571024858271f8e?s=128&d=identicon&r=PG", "display_name": "fabiofcferreira", "link": "https://stackoverflow.com/users/5514233/fabiofcferreira"}, "is_accepted": false, "score": 46, "last_activity_date": 1550816090, "last_edit_date": 1550816090, "creation_date": 1504241675, "answer_id": 45993495, "question_id": 38172661, "link": "https://stackoverflow.com/questions/38172661/what-is-the-meaning-of-and/45993495#45993495", "title": "What is the meaning of &#39;*&#39; and &#39;&amp;&#39;?", "body": "<p>Your question doesn't match very well the example given but I'll try to be straightforward.</p>\n\n<p>Let's suppose we have a variable named <code>a</code> which holds the integer 5 and another variable named <code>p</code> which is going to be a pointer.\nThis is where the <code>*</code> and <code>&amp;</code> come into the game.</p>\n\n<p>Printing variables with them can generate different output, so it all depends on the situation and how well you use.\nThe use of <code>*</code> and <code>&amp;</code> can save you lines of code (<strong>that doesn't really matter in small projects</strong>) and make your code more beautiful/readable.</p>\n\n<p><code>&amp;</code> returns the <strong>memory address</strong> of the following variable.</p>\n\n<p><code>*</code> returns the <strong>value</strong> of the following variable (which <strong>should</strong> hold the memory address of a variable, unless you want to get weird output and possibly problems because you're accessing your computer's RAM)</p>\n\n<pre><code>var a = 5\nvar p = &amp;a // p holds variable a's memory address\nfmt.Printf(\"Address of var a: %p\\n\", p)\nfmt.Printf(\"Value of var a: %v\\n\", *p)\n\n// Let's change a value (using the initial variable or the pointer)\n*p = 3 // using pointer\na = 3 // using initial var\n\nfmt.Printf(\"Address of var a: %p\\n\", p)\nfmt.Printf(\"Value of var a: %v\\n\", *p)\n</code></pre>\n\n<p>All in all, when using * and &amp; in remember that * is for setting the value of the variable you're pointing to and &amp; is the address of the variable you're pointing to/want to point to.</p>\n\n<p>Hope this answer helps. </p>\n"}, {"comments": [{"owner": {"reputation": 1662, "user_id": 5800158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DrD3B.jpg?s=128&g=1", "display_name": "Sasa Blagojevic", "link": "https://stackoverflow.com/users/5800158/sasa-blagojevic"}, "edited": false, "score": 6, "creation_date": 1544827195, "post_id": 51681144, "comment_id": 94427150, "body": "This is the best explanation IMO and should be the selected answer"}, {"owner": {"reputation": 383, "user_id": 636635, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qFPpL.jpg?s=128&g=1", "display_name": "xsigndll", "link": "https://stackoverflow.com/users/636635/xsigndll"}, "edited": false, "score": 1, "creation_date": 1546294049, "post_id": 51681144, "comment_id": 94821207, "body": "I think fmt.Println(*&amp;String) should be fmt.Println(*&amp;myString) . Other than that: nice explanation."}, {"owner": {"reputation": 3806, "user_id": 274030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd910b4f7c7baabc22976dc6b29b744?s=128&d=identicon&r=PG", "display_name": "Everett", "link": "https://stackoverflow.com/users/274030/everett"}, "edited": false, "score": 0, "creation_date": 1546450096, "post_id": 51681144, "comment_id": 94857965, "body": "Whoops -- fixed the variable name."}, {"owner": {"reputation": 2913, "user_id": 3705478, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0Rnp5.jpg?s=128&g=1", "display_name": "sofs1", "link": "https://stackoverflow.com/users/3705478/sofs1"}, "edited": false, "score": 1, "creation_date": 1573454974, "post_id": 51681144, "comment_id": 103874304, "body": "@Everett I think for * in front of a Type, you should have given solid example similar to other two cases."}, {"owner": {"reputation": 1430, "user_id": 5691932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh4.googleusercontent.com/-9LX2eWXfXpk/AAAAAAAAAAI/AAAAAAAAAQ0/f6YyB4dSka4/photo.jpg?sz=128", "display_name": "Mamun", "link": "https://stackoverflow.com/users/5691932/mamun"}, "edited": false, "score": 0, "creation_date": 1618730897, "post_id": 51681144, "comment_id": 118686665, "body": "Best explanation ever! Thank you!"}], "tags": [], "owner": {"reputation": 3806, "user_id": 274030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd910b4f7c7baabc22976dc6b29b744?s=128&d=identicon&r=PG", "display_name": "Everett", "link": "https://stackoverflow.com/users/274030/everett"}, "is_accepted": true, "score": 110, "last_activity_date": 1573499622, "last_edit_date": 1573499622, "creation_date": 1533338622, "answer_id": 51681144, "question_id": 38172661, "link": "https://stackoverflow.com/questions/38172661/what-is-the-meaning-of-and/51681144#51681144", "title": "What is the meaning of &#39;*&#39; and &#39;&amp;&#39;?", "body": "<p>This is possibly one of the most confusing things in Go.  There are basically 3 cases you need to understand:</p>\n\n<p><strong>The <code>&amp;</code> Operator</strong></p>\n\n<p><code>&amp;</code> goes in front of a variable when you want to get that variable's <em>memory address</em>.</p>\n\n<p><strong>The <code>*</code> Operator</strong></p>\n\n<p><code>*</code> goes in front of a variable that holds a memory address and resolves it (it is therefore the counterpart to the <code>&amp;</code> operator).  It goes and gets the thing that the pointer was pointing at, e.g. <code>*myString</code>.</p>\n\n<pre><code>myString := \"Hi\"\nfmt.Println(*&amp;myString)  // prints \"Hi\"\n</code></pre>\n\n<p>or more usefully, something like</p>\n\n<pre><code>myStructPointer = &amp;myStruct\n// ...\n(*myStructPointer).someAttribute = \"New Value\"\n</code></pre>\n\n<p><strong><code>*</code> in front of a Type</strong></p>\n\n<p>When <code>*</code> is put in front of a <em>type</em>, e.g. <code>*string</code>, it becomes part of the type declaration, so you can say \"this variable holds a pointer to a string\". For example:</p>\n\n<pre><code>var str_pointer *string\n</code></pre>\n\n<p>So the confusing thing is that the <code>*</code> really gets used for 2 separate (albeit related) things.  The star can be an operator <em>or</em> part of a type.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 10176213, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I9gF2fRxN20/AAAAAAAAAAI/AAAAAAAAABs/ez_A987I5Hs/photo.jpg?sz=128", "display_name": "Bhanu Teja", "link": "https://stackoverflow.com/users/10176213/bhanu-teja"}, "is_accepted": false, "score": 0, "last_activity_date": 1582145331, "last_edit_date": 1582145331, "creation_date": 1578563564, "answer_id": 59661294, "question_id": 38172661, "link": "https://stackoverflow.com/questions/38172661/what-is-the-meaning-of-and/59661294#59661294", "title": "What is the meaning of &#39;*&#39; and &#39;&amp;&#39;?", "body": "<p><strong>&amp; Operator</strong>  gets the memory address where as <strong>* Opeartor</strong> holds the memory address of particular variable.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 12200434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4dcc54bf3c1e941c6f3a45cddbfeb9?s=128&d=identicon&r=PG&f=1", "display_name": "Uday", "link": "https://stackoverflow.com/users/12200434/uday"}, "is_accepted": false, "score": 7, "last_activity_date": 1595840028, "creation_date": 1595840028, "answer_id": 63111862, "question_id": 38172661, "link": "https://stackoverflow.com/questions/38172661/what-is-the-meaning-of-and/63111862#63111862", "title": "What is the meaning of &#39;*&#39; and &#39;&amp;&#39;?", "body": "<p>This is by far the easiest way to understand all the three cases as explained in the @Everett answer</p>\n<pre><code>func zero(x int) {\n  x = 0\n}\nfunc main() {\n  x := 5\n  zero(x)\n  fmt.Println(x) // x is still 5\n}\n</code></pre>\n<p>If you need a variable to be changed inside a function then pass the memory address as a parmeter and use the pointer of this memory address to change the variable permanently.</p>\n<p>Observe the use of * in front of int in the example. Here it just represents the variable that is passed as a parameter is the address of type int.</p>\n<pre><code>func zero(xPtr *int) {\n  *xPtr = 0\n}\nfunc main() {\n  x := 5\n  zero(&amp;x)\n  fmt.Println(x) // x is 0\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11762368, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3RD9QJ8iSrs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regmhrJBAhXq1zvMF4SfkqUol8VAQ/photo.jpg?sz=128", "display_name": "kevin macute", "link": "https://stackoverflow.com/users/11762368/kevin-macute"}, "is_accepted": false, "score": 0, "last_activity_date": 1615104215, "creation_date": 1615104215, "answer_id": 66514378, "question_id": 38172661, "link": "https://stackoverflow.com/questions/38172661/what-is-the-meaning-of-and/66514378#66514378", "title": "What is the meaning of &#39;*&#39; and &#39;&amp;&#39;?", "body": "<p>Simple explanation.. its just like, you want to mutate the original value</p>\n<pre><code>func zero(num *int){  // add * to datatype\n  *num = 0 // can mutate the original number\n}\n\ni := 5\nzero(&amp;i) // passing variable with &amp; will allows other function to mutate the current value of variable```\n</code></pre>\n"}], "owner": {"reputation": 680, "user_id": 4665371, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/15216032392f58f35467a320cd6076c7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4665371/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41215, "favorite_count": 20, "accepted_answer_id": 51681144, "answer_count": 6, "score": 43, "last_activity_date": 1615767483, "creation_date": 1467567762, "last_edit_date": 1615767483, "question_id": 38172661, "link": "https://stackoverflow.com/questions/38172661/what-is-the-meaning-of-and", "title": "What is the meaning of &#39;*&#39; and &#39;&amp;&#39;?", "body": "<p>I am doing the <a href=\"http://tour.golang.org/\" rel=\"nofollow noreferrer\">http://tour.golang.org/</a>. Could anyone explain me <strong>lines 1,3,5 and 7</strong> this function especially what '*' and '&amp;' do? I mean by mentioning them in a function declaration, what they are supposed/expected to do? A toy example:</p>\n<pre><code>1: func intial1(var1 int, var2 int, func1.newfunc[]) *callproperfunction {\n2:\n3: addition:= make ([] add1, var1)\n4: for i:=1;i&lt;var2;i++ {\n5:   var2 [i] = *addtother (randomstring(lengthofcurrent))\n6:   }\n7: return &amp;callproperfunction {var1 int, var2 int, func1.newfunc[], jackpot}\n8: }\n</code></pre>\n<p>It seems that they are pointers like what we have in C++. But I cannot connect those concepts to what we have here. In other words, what '*' an '&amp;' do when I use them in function declaration in Go.</p>\n<p>I know what reference and dereference mean. What I cannot understand is: how we can use pointer to a function is Go. for example line 1 and 7, what these two lines do? Function named intial1 is declared that returns a pointer? and in line 7, we call it with arguments using return function.</p>\n"}, {"tags": ["multithreading", "go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467556303, "post_id": 38170852, "comment_id": 63768957, "body": "See my answer here which shows how to create a goroutine worker pool at the end (as an alternative solution): <a href=\"http://codereview.stackexchange.com/questions/114376/bruteforce-md5-password-cracker\">Bruteforce MD5 Password cracker</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 1, "creation_date": 1467565971, "post_id": 38171337, "comment_id": 63771941, "body": "You should be careful when mentioning parallelism. <code>go func(){}()</code> does not always guarantee parallelism. With that aside, I think this is the simplest way to limit the number of goroutines in flight."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 2, "last_activity_date": 1467567724, "last_edit_date": 1467567724, "creation_date": 1467558881, "answer_id": 38171337, "question_id": 38170852, "link": "https://stackoverflow.com/questions/38170852/is-this-an-idiomatic-worker-thread-pool-in-go/38171337#38171337", "title": "Is this an idiomatic worker thread pool in Go?", "body": "<p>You can implement a counting semaphore to limit goroutine concurrency.</p>\n\n<pre><code>var tokens = make(chan struct{}, 20)\n\nfunc worker(id string, work string, o chan string, wg *sync.WaitGroup) {\n    defer wg.Done()\n    tokens &lt;- struct{}{} // acquire a token before performing work\n    sleepMs := rand.Intn(1000)\n    fmt.Printf(\"worker '%s' received: '%s', sleep %dms\\n\", id, work, sleepMs)\n    time.Sleep(time.Duration(sleepMs) * time.Millisecond)\n    &lt;-tokens // release the token\n    o &lt;- work + fmt.Sprintf(\"-%dms\", sleepMs)\n}\n</code></pre>\n\n<p>This is the general design used to limit the number of workers. You can of course change location of releasing/acquiring of tokens to fit your code. </p>\n"}, {"comments": [{"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 3, "creation_date": 1467568240, "post_id": 38172204, "comment_id": 63772644, "body": "I like this answer. Why remove and create new goroutines when they&#39;re all  doing the same thing? Even though goroutines are light and cheap, we shouldn&#39;t take that for granted. I believe this is good practice."}, {"owner": {"reputation": 2005, "user_id": 910553, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/9101644/picture?type=large", "display_name": "Scott Frazer", "link": "https://stackoverflow.com/users/910553/scott-frazer"}, "edited": false, "score": 1, "creation_date": 1467573284, "post_id": 38172204, "comment_id": 63774156, "body": "Whoa, amazing!  Thanks!"}, {"owner": {"reputation": 1383, "user_id": 3844132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/20ea35cb00d4ad6a547eb5e1b5ff4ac6?s=128&d=identicon&r=PG&f=1", "display_name": "AmaJayJB", "link": "https://stackoverflow.com/users/3844132/amajayjb"}, "edited": false, "score": 1, "creation_date": 1520453171, "post_id": 38172204, "comment_id": 85326073, "body": "I wish I could double/tripe/quadruple like this!"}, {"owner": {"reputation": 1383, "user_id": 3844132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/20ea35cb00d4ad6a547eb5e1b5ff4ac6?s=128&d=identicon&r=PG&f=1", "display_name": "AmaJayJB", "link": "https://stackoverflow.com/users/3844132/amajayjb"}, "edited": false, "score": 0, "creation_date": 1520462658, "post_id": 38172204, "comment_id": 85330618, "body": "Firstly thanks, this is awesome. I think you may have one extra <code>wg.Done()</code> then <code>wg.Add(1)</code> since you <code>wg.Add(1)</code> for each consumer and defer a <code>wg.Done()</code> for each consumer, but you also <code>wg.Done()</code> for produce. Which means that the <code>wg.Wait()</code> might not wait till all 5 consumers are done. Just checking?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1383, "user_id": 3844132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/20ea35cb00d4ad6a547eb5e1b5ff4ac6?s=128&d=identicon&r=PG&f=1", "display_name": "AmaJayJB", "link": "https://stackoverflow.com/users/3844132/amajayjb"}, "edited": false, "score": 1, "creation_date": 1520506017, "post_id": 38172204, "comment_id": 85347412, "body": "@AmaJayJB You&#39;re right, nice catch. Thanks. I fixed it by removing the <code>wg.Done()</code> from the producer."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1545822223, "post_id": 38172204, "comment_id": 94702832, "body": "Wouldn\u2019t the actual Go terminology call this a fan out pipeline?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1545847521, "post_id": 38172204, "comment_id": 94711078, "body": "@MarkusWMahlberg Fan out is used when multiple channels are merged into a single one. This is not used in the answer."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1545847557, "post_id": 38172204, "comment_id": 94711090, "body": "Wouldn\u2019t that be a fan in?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1545847666, "post_id": 38172204, "comment_id": 94711121, "body": "@MarkusWMahlberg You&#39;re right, fan out is when multiple functions read from a channel until it is closed. Although that is also not used in the answer, there is only one consumer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 47, "last_activity_date": 1549971482, "last_edit_date": 1549971482, "creation_date": 1467564861, "answer_id": 38172204, "question_id": 38170852, "link": "https://stackoverflow.com/questions/38170852/is-this-an-idiomatic-worker-thread-pool-in-go/38172204#38172204", "title": "Is this an idiomatic worker thread pool in Go?", "body": "<p>Your solution is not a worker goroutine pool in any sense: your code does not limit concurrent goroutines, and it does not \"reuse\" goroutines (it always starts a new one when a new job is received).</p>\n\n<h2>Producer-consumer pattern</h2>\n\n<p>As posted at <a href=\"https://codereview.stackexchange.com/questions/114376/bruteforce-md5-password-cracker\">Bruteforce MD5 Password cracker</a>, you can make use of the <a href=\"https://en.wikipedia.org/wiki/Producer%E2%80%93consumer_problem\" rel=\"noreferrer\">producer-consumer pattern</a>. You could have a designated <em>producer</em> goroutine that would generate the jobs (things to do / calculate), and send them on a <em>jobs</em> channel. You could have a fixed pool of <em>consumer</em> goroutines (e.g. 5 of them) which would loop over the channel on which jobs are delivered, and each would execute / complete the received jobs.</p>\n\n<p>The <em>producer</em> goroutine could simply close the <code>jobs</code> channel when all jobs were generated and sent, properly signalling <em>consumers</em> that no more jobs will be coming. The <code>for ... range</code> construct on a channel handles the \"close\" event and terminates properly. Note that all jobs sent before closing the channel will still be delivered.</p>\n\n<p>This would result in a clean design, would result in fixed (but arbitrary) number of goroutines, and it would always utilize 100% CPU (if # of goroutines is greater than # of CPU cores). It also has the advantage that it can be \"throttled\" with the proper selection of the channel capacity (buffered channel) and the number of <em>consumer</em> goroutines.</p>\n\n<p><sup>Note that this model to have a designated producer goroutine is not mandatory. You could have multiple goroutines to produce jobs too, but then you must synchronize them too to only close the <code>jobs</code> channel when all producer goroutines are done producing jobs - else attempting to send another job on the <code>jobs</code> channel when it has already been closed results in a runtime panic. Usually producing jobs are cheap and can be produced at a much quicker rate than they can be executed, so this model to produce them in 1 goroutine while many are consuming / executing them is good in practice.</sup></p>\n\n<p><strong>Handling results:</strong></p>\n\n<p>If jobs have results, you may choose to have a designated <em>result</em> channel on which results could be delivered (\"sent back\"), or you may choose to handle the results in the consumer when the job is completed / finished. This latter may even be implemented by having a \"callback\" function that handles the results. The important thing is whether results can be processed independently or they need to be merged (e.g. map-reduce framework) or aggregated.</p>\n\n<p>If you go with a <code>results</code> channel, you also need a goroutine that receives values from it, preventing consumers to get blocked (would occur if buffer of <code>results</code> would get filled).</p>\n\n<h2>With <code>results</code> channel</h2>\n\n<p>Instead of sending simple <code>string</code> values as jobs and results, I would create a wrapper type which can hold any additional info and so it is much more flexible:</p>\n\n<pre><code>type Job struct {\n    Id     int\n    Work   string\n    Result string\n}\n</code></pre>\n\n<p>Note that the <code>Job</code> struct also wraps the result, so when we send back the result, it also contains the original <code>Job</code> as the context - <em>often very useful</em>. Also note that it is profitable to just send pointers (<code>*Job</code>) on the channels instead of <code>Job</code> values so no need to make \"countless\" copies of <code>Job</code>s, and also the size of the <code>Job</code> struct value becomes irrelevant.</p>\n\n<p><strong>Here is how this producer-consumer could look like:</strong></p>\n\n<p>I would use 2 <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\"><code>sync.WaitGroup</code></a> values, their role will follow:</p>\n\n<pre><code>var wg, wg2 sync.WaitGroup\n</code></pre>\n\n<p>The producer is responsible to generate jobs to be executed:</p>\n\n<pre><code>func produce(jobs chan&lt;- *Job) {\n    // Generate jobs:\n    id := 0\n    for c := 'a'; c &lt;= 'z'; c++ {\n        id++\n        jobs &lt;- &amp;Job{Id: id, Work: fmt.Sprintf(\"%c\", c)}\n    }\n    close(jobs)\n}\n</code></pre>\n\n<p>When done (no more jobs), the <code>jobs</code> channel is closed which signals consumers that no more jobs will arrive.</p>\n\n<p>Note that <code>produce()</code> sees the <code>jobs</code> channel as <em>send only</em>, because that's what the producer needs to do only with that: <em>send</em> jobs on it (besides <em>closing</em> it, but that is also permitted on a <em>send only</em> channel). An accidental receive in the producer would be a compile time error (detected early, at compile time).</p>\n\n<p>The consumer's responsibility is to receive jobs as long as jobs can be received, and execute them:</p>\n\n<pre><code>func consume(id int, jobs &lt;-chan *Job, results chan&lt;- *Job) {\n    defer wg.Done()\n    for job := range jobs {\n        sleepMs := rand.Intn(1000)\n        fmt.Printf(\"worker #%d received: '%s', sleep %dms\\n\", id, job.Work, sleepMs)\n        time.Sleep(time.Duration(sleepMs) * time.Millisecond)\n        job.Result = job.Work + fmt.Sprintf(\"-%dms\", sleepMs)\n        results &lt;- job\n    }\n}\n</code></pre>\n\n<p>Note that <code>consume()</code> sees the <code>jobs</code> channel as <em>receive only</em>; consumer only needs to <em>receive</em> from it. Similarly the <code>results</code> channel is <em>send only</em> for the consumer.</p>\n\n<p>Also note that the <code>results</code> channel <strong>cannot</strong> be closed here as there are multiple consumer goroutines, and only the first attempting to close it would succeed and further ones would result in runtime panic! <code>results</code> channel can (must) be closed after all consumer goroutines ended, because then we can be sure no further values (results) will be sent on the <code>results</code> channel.</p>\n\n<p>We have results which need to be analyzed:</p>\n\n<pre><code>func analyze(results &lt;-chan *Job) {\n    defer wg2.Done()\n    for job := range results {\n        fmt.Printf(\"result: %s\\n\", job.Result)\n    }\n}\n</code></pre>\n\n<p>As you can see, this also receives results as long as they may come (until <code>results</code> channel is closed). The <code>results</code> channel for the analyzer is <em>receive only</em>.</p>\n\n<p>Please note the use of channel types: whenever it is sufficient, use only a <em>unidirectional</em> channel type to detect and prevent errors early, at compile time. Only use <em>bidirectional</em> channel type if you do need both directions.</p>\n\n<p>And this is how all these are glued together:</p>\n\n<pre><code>func main() {\n    jobs := make(chan *Job, 100)    // Buffered channel\n    results := make(chan *Job, 100) // Buffered channel\n\n    // Start consumers:\n    for i := 0; i &lt; 5; i++ { // 5 consumers\n        wg.Add(1)\n        go consume(i, jobs, results)\n    }\n    // Start producing\n    go produce(jobs)\n\n    // Start analyzing:\n    wg2.Add(1)\n    go analyze(results)\n\n    wg.Wait() // Wait all consumers to finish processing jobs\n\n    // All jobs are processed, no more values will be sent on results:\n    close(results)\n\n    wg2.Wait() // Wait analyzer to analyze all results\n}\n</code></pre>\n\n<p><strong>Example output:</strong></p>\n\n<p>Here is an example output:</p>\n\n<p>As you can see, results are coming and getting analyzed before all the jobs would be enqueued:</p>\n\n<pre><code>worker #4 received: 'e', sleep 81ms\nworker #0 received: 'a', sleep 887ms\nworker #1 received: 'b', sleep 847ms\nworker #2 received: 'c', sleep 59ms\nworker #3 received: 'd', sleep 81ms\nworker #2 received: 'f', sleep 318ms\nresult: c-59ms\nworker #4 received: 'g', sleep 425ms\nresult: e-81ms\nworker #3 received: 'h', sleep 540ms\nresult: d-81ms\nworker #2 received: 'i', sleep 456ms\nresult: f-318ms\nworker #4 received: 'j', sleep 300ms\nresult: g-425ms\nworker #3 received: 'k', sleep 694ms\nresult: h-540ms\nworker #4 received: 'l', sleep 511ms\nresult: j-300ms\nworker #2 received: 'm', sleep 162ms\nresult: i-456ms\nworker #1 received: 'n', sleep 89ms\nresult: b-847ms\nworker #0 received: 'o', sleep 728ms\nresult: a-887ms\nworker #1 received: 'p', sleep 274ms\nresult: n-89ms\nworker #2 received: 'q', sleep 211ms\nresult: m-162ms\nworker #2 received: 'r', sleep 445ms\nresult: q-211ms\nworker #1 received: 's', sleep 237ms\nresult: p-274ms\nworker #3 received: 't', sleep 106ms\nresult: k-694ms\nworker #4 received: 'u', sleep 495ms\nresult: l-511ms\nworker #3 received: 'v', sleep 466ms\nresult: t-106ms\nworker #1 received: 'w', sleep 528ms\nresult: s-237ms\nworker #0 received: 'x', sleep 258ms\nresult: o-728ms\nworker #2 received: 'y', sleep 47ms\nresult: r-445ms\nworker #2 received: 'z', sleep 947ms\nresult: y-47ms\nresult: u-495ms\nresult: x-258ms\nresult: v-466ms\nresult: w-528ms\nresult: z-947ms\n</code></pre>\n\n<p>Try the complete application on the <a href=\"https://play.golang.org/p/2rIkRiwcjs9\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<h2>Without a <code>results</code> channel</h2>\n\n<p>Code simplifies significantly if we don't use a <code>results</code> channel but the consumer goroutines handle the result right away (print it in our case). In this case we don't need 2 <code>sync.WaitGroup</code> values (the 2nd was only needed to wait for the analyzer to complete).</p>\n\n<p>Without a <code>results</code> channel the complete solution is like this:</p>\n\n<pre><code>var wg sync.WaitGroup\n\ntype Job struct {\n    Id   int\n    Work string\n}\n\nfunc produce(jobs chan&lt;- *Job) {\n    // Generate jobs:\n    id := 0\n    for c := 'a'; c &lt;= 'z'; c++ {\n        id++\n        jobs &lt;- &amp;Job{Id: id, Work: fmt.Sprintf(\"%c\", c)}\n    }\n    close(jobs)\n}\n\nfunc consume(id int, jobs &lt;-chan *Job) {\n    defer wg.Done()\n    for job := range jobs {\n        sleepMs := rand.Intn(1000)\n        fmt.Printf(\"worker #%d received: '%s', sleep %dms\\n\", id, job.Work, sleepMs)\n        time.Sleep(time.Duration(sleepMs) * time.Millisecond)\n        fmt.Printf(\"result: %s\\n\", job.Work+fmt.Sprintf(\"-%dms\", sleepMs))\n    }\n}\n\nfunc main() {\n    jobs := make(chan *Job, 100) // Buffered channel\n\n    // Start consumers:\n    for i := 0; i &lt; 5; i++ { // 5 consumers\n        wg.Add(1)\n        go consume(i, jobs)\n    }\n    // Start producing\n    go produce(jobs)\n\n    wg.Wait() // Wait all consumers to finish processing jobs\n}\n</code></pre>\n\n<p>Output is \"like\" that of with <code>results</code> channel (but of course execution/completion order is random).</p>\n\n<p>Try this variant on the <a href=\"https://play.golang.org/p/OSJY28JpAlm\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 2005, "user_id": 910553, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/9101644/picture?type=large", "display_name": "Scott Frazer", "link": "https://stackoverflow.com/users/910553/scott-frazer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3901, "favorite_count": 19, "accepted_answer_id": 38172204, "answer_count": 2, "score": 17, "last_activity_date": 1549971482, "creation_date": 1467555602, "question_id": 38170852, "link": "https://stackoverflow.com/questions/38170852/is-this-an-idiomatic-worker-thread-pool-in-go", "title": "Is this an idiomatic worker thread pool in Go?", "body": "<p>I'm attempting to write a simple worker pool with goroutines.</p>\n\n<ul>\n<li>Is the code I wrote idiomatic?  If not, then what should change?</li>\n<li>I want to be able to set the maximum number of worker threads to 5 and block until a worker becomes available if all 5 are busy.  How would I extend this to only have a pool of 5 workers max?  Do I spawn the static 5 goroutines, and give each the <code>work_channel</code>?</li>\n</ul>\n\n<p>code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"sync\"\n    \"time\"\n)\n\nfunc worker(id string, work string, o chan string, wg *sync.WaitGroup) {\n    defer wg.Done()\n    sleepMs := rand.Intn(1000)\n    fmt.Printf(\"worker '%s' received: '%s', sleep %dms\\n\", id, work, sleepMs)\n    time.Sleep(time.Duration(sleepMs) * time.Millisecond)\n    o &lt;- work + fmt.Sprintf(\"-%dms\", sleepMs)\n}\n\nfunc main() {\n    var work_channel = make(chan string)\n    var results_channel = make(chan string)\n\n    // create goroutine per item in work_channel\n    go func() {\n        var c = 0\n        var wg sync.WaitGroup\n        for work := range work_channel {\n            wg.Add(1)\n            go worker(fmt.Sprintf(\"%d\", c), work, results_channel, &amp;wg)\n            c++\n        }\n        wg.Wait()\n        fmt.Println(\"closing results channel\")\n        close(results_channel)\n    }()\n\n    // add work to the work_channel\n    go func() {\n        for c := 'a'; c &lt; 'z'; c++ {\n            work_channel &lt;- fmt.Sprintf(\"%c\", c)\n        }\n        close(work_channel)\n        fmt.Println(\"sent work to work_channel\")\n    }()\n\n    for x := range results_channel {\n        fmt.Printf(\"result: %s\\n\", x)\n    }\n}\n</code></pre>\n"}, {"tags": ["ssl", "go", "https"], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "edited": false, "score": 0, "creation_date": 1467561176, "post_id": 38171460, "comment_id": 63770410, "body": "@ufk I have edited the answer to address the last warning reported by ssllabs."}, {"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "edited": false, "score": 0, "creation_date": 1467572263, "post_id": 38171460, "comment_id": 63773845, "body": "ahem... <a href=\"http://stackoverflow.com/questions/38173310/godaddy-ssl-cert-verified-grade-a-with-chain-issues-contains-anchor\" title=\"godaddy ssl cert verified grade a with chain issues contains anchor\">stackoverflow.com/questions/38173310/&hellip;</a>"}, {"owner": {"reputation": 1787, "user_id": 2802042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135c4e4a042800383e9ea34de27171aa?s=128&d=identicon&r=PG", "display_name": "DrMorteza", "link": "https://stackoverflow.com/users/2802042/drmorteza"}, "edited": false, "score": 1, "creation_date": 1552734611, "post_id": 38171460, "comment_id": 97129576, "body": "You saved my life. I was trying to solve this problem in the previous two days."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 7, "last_activity_date": 1467561153, "last_edit_date": 1495541835, "creation_date": 1467559719, "answer_id": 38171460, "question_id": 38170775, "link": "https://stackoverflow.com/questions/38170775/http-ssl-with-godaddys-certificate-this-servers-certificate-chain-is-incompl/38171460#38171460", "title": "HTTP SSL with GoDaddy&#39;s certificate - This server&#39;s certificate chain is incomplete", "body": "<p>Following <a href=\"https://groups.google.com/forum/m/#!topic/golang-nuts/TnwfKyotEIY\" rel=\"noreferrer\">that thread</a>, and from the <a href=\"https://golang.org/pkg/net/http/#ListenAndServeTLS\" rel=\"noreferrer\"><code>net/http/#ListenAndServeTLS()</code></a> doc:</p>\n\n<blockquote>\n  <p>If the certificate is signed by a certificate authority, the certFile should be the concatenation of the server's certificate, any intermediates, and the CA's certificate.</p>\n</blockquote>\n\n<p>Try and make sure your <code>cert/myalcoholist.pem</code> includes the CA certificates as well.</p>\n\n<p>That thread used:</p>\n\n<pre><code>myTLSConfig := &amp;tls.Config{\n    CipherSuites: []uint16{\n        tls.TLS_RSA_WITH_RC4_128_SHA,\n        tls.TLS_ECDHE_RSA_WITH_RC4_128_SHA,\n        tls.TLS_RSA_WITH_AES_128_CBC_SHA,\n        tls.TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA},}\nmyTLSConfig.PreferServerCipherSuites = true\nconst myWebServerListenAddress = \"0.0.0.0:5555\"\nmyTLSWebServer := &amp;http.Server{Addr: myWebServerListenAddress, TLSConfig: myTLSConfig, Handler: router}\nif err = myTLSWebServer.ListenAndServeTLS(\"/home/loongson/webServerKeysV2/golangCertFile2\", \"/home/loongson/webServerKeysV2/adequatech.ca-comodoinstantssl-exported-privatekey-rsa-ForApache.key\"); err != nil {\n    panic(err)\n\n}\n</code></pre>\n\n<p>Compared to <a href=\"https://stackoverflow.com/a/38167448/6309\">my previous answer</a>, adding a cipher suite is a good idea, but again, try and see if the certificate file passed to <code>ListenAndServeTLS</code> works better if it includes the CAs.</p>\n\n<hr>\n\n<p>Sure enough, <a href=\"https://www.ssllabs.com/ssltest/analyze.html?d=myalcoholist.com\" rel=\"noreferrer\">https://www.ssllabs.com/ssltest/analyze.html?d=myalcoholist.com</a> reports grade A, with the warning: \u201cChain issues: Contains anchor\u201d.<br>\nSee \"<a href=\"https://security.stackexchange.com/q/79519\">SSL/TLS: How to fix \u201cChain issues: Contains anchor\u201d</a>\" to remove that warning, but <a href=\"https://security.stackexchange.com/a/24566\">this is not an error though</a>:</p>\n\n<blockquote>\n  <p><a href=\"http://tools.ietf.org/html/rfc2119\" rel=\"noreferrer\">RFC 2119</a>: the server is allowed to include the root certificate (aka \"trust anchor\") in the chain, or omit it. Some servers include it</p>\n</blockquote>\n"}], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1931, "favorite_count": 3, "accepted_answer_id": 38171460, "answer_count": 1, "score": 5, "last_activity_date": 1561818023, "creation_date": 1467554982, "last_edit_date": 1561818023, "question_id": 38170775, "link": "https://stackoverflow.com/questions/38170775/http-ssl-with-godaddys-certificate-this-servers-certificate-chain-is-incompl", "title": "HTTP SSL with GoDaddy&#39;s certificate - This server&#39;s certificate chain is incomplete", "body": "<p>in general I got 3 files from GoDaddy:</p>\n\n<ol>\n<li>main Certificate file</li>\n<li>Server Private Key</li>\n<li>Bundle file</li>\n</ol>\n\n<p>in configured all these files in my Go server in the following way:</p>\n\n<pre><code>cert, err := tls.LoadX509KeyPair(\"myalcoholist.pem\",\"myalcoholist.key\")\nif err != nil {\n    log.Fatalf(\"server: loadkeys: %s\", err)\n\n}\n    pem, err := ioutil.ReadFile(\"cert/sf_bundle-g2-g1.crt\")\n    if err != nil {\n        log.Fatalf(\"Failed to read client certificate authority: %v\", err)\n    }\n    if !certpool.AppendCertsFromPEM(pem) {\n        log.Fatalf(\"Can't parse client certificate authority\")\n    }\n    tlsConfig := &amp;tls.Config{\n        ClientCAs:    certpool,\n    Certificates: []tls.Certificate{cert},\n    }\n\n    srv := &amp;http.Server{\n    Addr: \"myalcoholist.com:443\",\n    Handler: n,\n    ReadTimeout: time.Duration(5) * time.Second,\n    WriteTimeout: time.Duration(5) * time.Second,\n    TLSConfig: tlsConfig,\n}\nerr := srv.ListenAndServeTLS(\"cert/myalcoholist.pem\",\"cert/myalcoholist.key\")\n</code></pre>\n\n<p>The web server runs properly, it's currently published at <code>https://myalcoholist.com:443</code>.</p>\n\n<p>I validated my SSL using <code>https://www.ssllabs.com/ssltest/analyze.html?d=myalcoholist.com</code> and it's response is <code>This server's certificate chain is incomplete. Grade capped to B.</code></p>\n\n<p>you can go to this link to see the all detailed result.</p>\n\n<p>what am I missing?</p>\n"}, {"tags": ["go", "rethinkdb"], "answers": [{"tags": [], "owner": {"reputation": 5046, "user_id": 3200554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a018f6e3757b55a3df0a735acc199b4?s=128&d=identicon&r=PG&f=1", "display_name": "mlucy", "link": "https://stackoverflow.com/users/3200554/mlucy"}, "is_accepted": true, "score": 1, "last_activity_date": 1467583918, "creation_date": 1467583918, "answer_id": 38174786, "question_id": 38169211, "link": "https://stackoverflow.com/questions/38169211/rethinkdb-changefeed-filtering-using-now/38174786#38174786", "title": "RethinkDB changefeed filtering using `now()`", "body": "<p>Currently <code>r.now</code> always evaluates to the time the server received the query.  It's probably best to repeatedly do a table scan for any documents scheduled between the last table scan and the current time.</p>\n"}], "owner": {"reputation": 636, "user_id": 1327984, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2e5a66185c0f937da3ee26e332e8c741?s=128&d=identicon&r=PG&f=1", "display_name": "az_", "link": "https://stackoverflow.com/users/1327984/az"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 38174786, "answer_count": 1, "score": 1, "last_activity_date": 1467583918, "creation_date": 1467543112, "question_id": 38169211, "link": "https://stackoverflow.com/questions/38169211/rethinkdb-changefeed-filtering-using-now", "title": "RethinkDB changefeed filtering using `now()`", "body": "<p>I was hoping to create a sort of 'time tigger' using RethinkDB changefeeds:</p>\n\n<pre><code>        return r.\n            Table(\"Checks\").\n            Filter(r.Row.Field(\"ScheduledFor\").Le(r.Now())).\n            Changes(r.ChangesOpts{\n                    IncludeInitial: true,\n            }).Run(db)\n</code></pre>\n\n<p>However, while it picks up things that initially fulfill the <code>Filter</code> predicate, it does not appear to pick up records where <code>ScheduledFor</code> goes from being in the future to being in the past.</p>\n\n<p>i.e. <code>r.Now()</code> appears to be evaluated upon being received by the server and never again.</p>\n\n<p>Is there any way to make the <code>Now()</code> term dynamically evaluated? Or should I just do a table scan?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1467559825, "post_id": 38168329, "comment_id": 63770010, "body": "See also <a href=\"http://stackoverflow.com/questions/20224478/dereferencing-a-map-index-in-golang\" title=\"dereferencing a map index in golang\">stackoverflow.com/questions/20224478/&hellip;</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 3, "creation_date": 1467616945, "post_id": 38168329, "comment_id": 63784817, "body": "As top answer says, it&#39;s a hashtable that stores values in the buckets. When it rehashes the values move. If you want to get around this, using a pointer as your value type will do it."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1467617712, "post_id": 38168329, "comment_id": 63785235, "body": "C++ <code>map</code>s get away with this because they&#39;re binary trees that needn&#39;t move existing nodes around in RAM to add new ones (but its operations average O(log n), not O(1)). C++ <code>unordered_map</code> is a hashtable, but has to impose certain restrictions on implementations to avoid values moving; <a href=\"http://stackoverflow.com/a/31113618/2714852\">stackoverflow.com/a/31113618/2714852</a> and <a href=\"http://stackoverflow.com/q/37428119/\">stackoverflow.com/q/37428119</a> discuss."}, {"owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "edited": false, "score": 0, "creation_date": 1532870377, "post_id": 38168329, "comment_id": 90126748, "body": "I think you mean <code>map is addressable</code> (e.g <code>&amp;m</code>), but <code>map elements are not addressable</code> (e.g <code>&amp;(m[1])</code>), that&#39;s different."}], "answers": [{"tags": [], "owner": {"reputation": 27792, "user_id": 1830293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6prVF.jpg?s=128&g=1", "display_name": "DAXaholic", "link": "https://stackoverflow.com/users/1830293/daxaholic"}, "is_accepted": true, "score": 19, "last_activity_date": 1467536851, "creation_date": 1467536851, "answer_id": 38168423, "question_id": 38168329, "link": "https://stackoverflow.com/questions/38168329/why-are-map-values-not-addressable/38168423#38168423", "title": "Why are map values not addressable?", "body": "<p>Well I do not know about the internal Go implementation of maps but most likely it is a kind of hash table. So if you take and save the address of one of its entries and afterwards put another bunch of entries into it, your saved address may be invalid. This is due to internal reorganizations of hash tables when the load factor exceeds a certain threshold and the hash table needs to grow.<br>\nTherefore I guess it is not allowed to take the address of one of its entries in order to avoid such errors.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1565935503, "creation_date": 1565935503, "answer_id": 57519590, "question_id": 38168329, "link": "https://stackoverflow.com/questions/38168329/why-are-map-values-not-addressable/57519590#57519590", "title": "Why are map values not addressable?", "body": "<blockquote>\n  <p>Being from a C++ background.</p>\n  \n  <p>Why are [Go] map values not addressable?</p>\n</blockquote>\n\n<hr>\n\n<p>If all other languages were like C++ there would be no point in having other languages.</p>\n\n<p>C++ is a complex, hard-to-read language.</p>\n\n<p><a href=\"http://www.stroustrup.com/P0977-remember-the-vasa.pdf\" rel=\"nofollow noreferrer\">Remember the Vasa! - Bjarne Stroustrup</a></p>\n\n<p>Go, by design, is a simple, readable language.</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=rFejpH_tAHM\" rel=\"nofollow noreferrer\">dotGo 2015 - Rob Pike - Simplicity is Complicated</a></p>\n\n<hr>\n\n<p>A Go map is a hash map. A deterministic hash function is applied to a map key. The hash value is used to determine the primary map bucket for the entry (key-value pair). A bucket stores one or more map entries. A primary bucket may overflow to secondary buckets. Buckets are implemented as an array. As the number of map entries increases by insertion, the hash function adapts to provide more buckets. The map entries are copied incrementally to a new, larger bucket array. If the number of map entries decreases by deletion, space may be reclaimed. </p>\n\n<p>In summary, a Go map is a dynamic, self-organizing data structure. The memory address of an entry (key-value pair) is not fixed. Therefore, map values are not addressable.</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=Tl7mi9QmLns\" rel=\"nofollow noreferrer\">GopherCon 2016  Keith Randall - Inside the Map Implementation</a></p>\n\n<p>In Go, map value addressability is not necessary.</p>\n"}], "owner": {"reputation": 711, "user_id": 6178021, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vhabx.jpg?s=128&g=1", "display_name": "Tanmay Garg", "link": "https://stackoverflow.com/users/6178021/tanmay-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1649, "favorite_count": 2, "accepted_answer_id": 38168423, "answer_count": 2, "score": 9, "last_activity_date": 1565935503, "creation_date": 1467536146, "last_edit_date": 1467537373, "question_id": 38168329, "link": "https://stackoverflow.com/questions/38168329/why-are-map-values-not-addressable", "title": "Why are map values not addressable?", "body": "<p>While playing with Go code, I found out that map values are not addressable. For example,</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main(){\n    var mymap map[int]string = make(map[int]string)\n    mymap[1] = \"One\"\n    var myptr *string = &amp;mymap[1]\n    fmt.Println(*myptr)\n}\n</code></pre>\n\n<p>Generates error</p>\n\n<blockquote>\n  <p>mapaddressable.go:7: cannot take the address of mymap[1]</p>\n</blockquote>\n\n<p>Whereas, the code,</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main(){\n    var mymap map[int]string = make(map[int]string)\n    mymap[1] = \"One\"\n    mystring := mymap[1]\n    var myptr *string = &amp;mystring\n    fmt.Println(*myptr)\n}\n</code></pre>\n\n<p>works perfectly fine.</p>\n\n<p>Why is this so? Why have the Go developers chosen to make certain values not addressable? Is this a drawback or a feature of the language?</p>\n\n<p><strong>Edit</strong>:\nBeing from a C++ background, I am not used to this <code>not addressable</code> trend that seems to be prevalent in Go. For example, the following code works just fine:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;map&gt;\n#include&lt;string&gt;\nusing namespace std;\nint main(){\n    map&lt;int,string&gt; mymap;\n    mymap[1] = \"one\";\n    string *myptr = &amp;mymap[1];\n    cout&lt;&lt;*myptr;\n}\n</code></pre>\n\n<p>It would be nice if somebody could point out why the same <em>addressability</em> cannot be achieved (or intentionally wasn't achieved) in Go.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1467528347, "post_id": 38167409, "comment_id": 63762264, "body": "Can you provide a ref to the spec? <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">golang.org/ref/spec</a>"}, {"owner": {"reputation": 19167, "user_id": 432193, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/87f2efac0ff72169aa6e92fc3c613189?s=128&d=identicon&r=PG", "display_name": "Endophage", "link": "https://stackoverflow.com/users/432193/endophage"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1467528614, "post_id": 38167409, "comment_id": 63762305, "body": "@Theuserwithnohat it&#39;s not in the spec. It&#39;s an unofficial convention."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 1, "creation_date": 1467528692, "post_id": 38167409, "comment_id": 63762318, "body": "@Karrot Kake now I understand how it works. It&#39;s a kind of trick. As the blank identifiers are not used in any way I guess it produces no garbage, right?  off-topic:  <code>(*Doubler)(nil) </code> is nice though. I was not familiar with this either."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1467529050, "post_id": 38167409, "comment_id": 63762376, "body": "The blank identifier is used because the program does not need to reference the variable.  A non-blank identifier will produce the same amount of garbage as the blank identifier (which is none)."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 12, "last_activity_date": 1585514956, "last_edit_date": 1585514956, "creation_date": 1467528090, "answer_id": 38167409, "question_id": 38167403, "link": "https://stackoverflow.com/questions/38167403/specs-whats-the-purpose-of-the-blank-identifier-in-variable-assignment/38167409#38167409", "title": "Specs: What&#39;s the purpose of the blank identifier in variable assignment?", "body": "<p>This is a compile time assertion that <code>*Doubler</code> type satisfies the <code>PropertyLoadSaver</code> interface. A type implements an interface when the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a> for the type is a superset of the method set for the interface.</p>\n\n<p>If the <code>*Doubler</code> type does not satisify the interface, then compilation will exit with an error similar to:</p>\n\n<pre><code>prog.go:21: cannot use (*Doubler)(nil) (type *Doubler) as type PropertyLoadSaver in assignment:\n*Doubler does not implement PropertyLoadSaver (missing Save method)\n</code></pre>\n\n<p>Here's how it works. The code <code>var _ PropertyLoadSaver</code> declares an unnamed variable of type <code>PropertyLoadSaver</code>. The expression <code>(*Doubler)(nil)</code> <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">converts</a> the untyped nil to a nil value of type <code>*Doubler</code>.   The <code>*Doubler</code> can only be assigned to the variable of type <code>PropertyLoadSaver</code> if <code>*Doubler</code> implements the <code>PropertyLoadSaver</code> interface.</p>\n\n<p>The blank identifier <code>_</code> is used because the variable does not need to be referenced elsewhere in the package. The same result can be achieved with a non-blank identifier:</p>\n\n<pre><code>var assertStarDoublerIsPropertyLoadSaver PropertyLoadSaver = (*Doubler)(nil)\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 4, "closed_date": 1534948124, "accepted_answer_id": 38167409, "answer_count": 1, "score": 8, "last_activity_date": 1585514956, "creation_date": 1467528009, "question_id": 38167403, "link": "https://stackoverflow.com/questions/38167403/specs-whats-the-purpose-of-the-blank-identifier-in-variable-assignment", "closed_reason": "Duplicate", "title": "Specs: What&#39;s the purpose of the blank identifier in variable assignment?", "body": "<p>I've found this variable declaration <a href=\"https://github.com/golang/appengine/blob/master/datastore/datastore_test.go#L334\" rel=\"noreferrer\"><code>var _ PropertyLoadSaver = (*Doubler)(nil)</code></a> and I'm wondering what's its purpose. It doesn't seem to initialise anything and as it uses a blank identifier I guess you can't access it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 1, "creation_date": 1467530566, "post_id": 38167370, "comment_id": 63762643, "body": "Use of labels appear to be pretty standard. <code>PolicyLoop</code> is being used only for the sake of readability. Tests shouldn&#39;t require any special treatment as long as you are interested in testing function behavior, which should not depend on the function internals to begin with.."}, {"owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "reply_to_user": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1467530863, "post_id": 38167370, "comment_id": 63762697, "body": "Please provide any example how to test the above functions."}], "owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1467541538, "creation_date": 1467527669, "last_edit_date": 1467541538, "question_id": 38167370, "link": "https://stackoverflow.com/questions/38167370/how-to-test-rewrite-the-label-enable-functions", "title": "How to test/rewrite the label-enable functions?", "body": "<p>I have a code that uses labels and doesn't separate logic and view (dialog-based). There are bugs and aren't any line of unittests =(</p>\n\n<pre><code>func UiNetworks(ui *gui.DialogUi, data *xmlinput.XMLInputData, allowedNics host.NICList, gconf *guest.Config) error {\n    guestPciSlotCounter := data.GuestNic.PCI.FirstSlot\n    lastGuestPciSlotCounter := guestPciSlotCounter\n    portCounter := 1\n    lastPortCounter := portCounter\n    i := 0\n\nMainLoop:\n    for i &lt; len(data.Networks.Configs) {\n        net := data.Networks.Configs[i]\n    PolicyLoop:\n        for {\n            var modes []xmlinput.ConnectionMode\n\n            if net.UiModeBinding == nil || len(net.UiModeBinding) == 0 {\n                for _, mode := range net.Modes {\n                    modes = append(modes, mode.Type)\n                }\n            } else {\n                var err error\n                modes, err = uiNetworkPolicySelector(ui, net)\n                if err != nil {\n                    switch err.Error() {\n                    case gui.DialogMoveBack:\n                        gconf.Networks = gconf.Networks[:i]\n                        gconf.NICLists = gconf.NICLists[:i]\n                        portCounter = lastPortCounter - 1\n                        guestPciSlotCounter = lastGuestPciSlotCounter - 1\n                        if i == 0 {\n                            return err\n                        }\n                        i--\n                        continue MainLoop\n                    case gui.DialogNext:\n                        i++\n                        continue MainLoop\n                    case gui.DialogExit:\n                        os.Exit(1)\n                    default:\n                        return err\n                    }\n\n                }\n            }\n\n            retainedNics, err := host_hwfilter.NicsByType(allowedNics, modes)\n            if err != nil {\n                return utils.FormatError(err)\n            }\n            if len(retainedNics) == 0 {\n                ui.Output(gui.Warning, \"No interfaces have been found.\", \"Press &lt;OK&gt; to return to menu.\")\n                continue MainLoop\n            }\n            if net.UiResetCounter {\n                portCounter = 1\n            }\n            list, err := uiNicSelectMenu(ui, data, &amp;portCounter, &amp;guestPciSlotCounter, retainedNics, net, i)\n            if err != nil {\n                switch err.Error() {\n                case gui.DialogMoveBack:\n                    if i == 0 {\n                        return err\n                    }\n                    gconf.Networks = gconf.Networks[:i]\n                    gconf.NICLists = gconf.NICLists[:i]\n                    continue PolicyLoop\n                case gui.DialogExit:\n                    os.Exit(1)\n                }\n            }\n\n            gconf.Networks = append(gconf.Networks, net)\n            gconf.NICLists = append(gconf.NICLists, list)\n            lastPortCounter = portCounter\n            lastGuestPciSlotCounter = guestPciSlotCounter\n            i++\n            break\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<p>How I can test it? Or rewrite it?</p>\n\n<p>Regards.</p>\n"}, {"tags": ["ssl", "go", "https"], "answers": [{"comments": [{"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "edited": false, "score": 0, "creation_date": 1467554353, "post_id": 38167448, "comment_id": 63768335, "body": "thank you. i can use that tls.Config object as TLSConfig parameter as stated at <a href=\"http://www.bite-code.com/2015/06/25/tls-mutual-auth-in-golang/\" rel=\"nofollow noreferrer\">bite-code.com/2015/06/25/tls-mutual-auth-in-golang</a>"}, {"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "edited": false, "score": 0, "creation_date": 1467557695, "post_id": 38167448, "comment_id": 63769325, "body": "thank you so much for your answer. for some reason my certificate seems incomplete by ssl verifier. i opened a new question about it. if possible, please take a look at <a href=\"http://stackoverflow.com/questions/38170775/golang-with-http-ssl-godaddys-certificate-this-servers-certificate-chain-is\" title=\"golang with http ssl godaddys certificate this servers certificate chain is\">stackoverflow.com/questions/38170775/&hellip;</a> thanks again!"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 5, "last_activity_date": 1467556978, "last_edit_date": 1467556978, "creation_date": 1467528608, "answer_id": 38167448, "question_id": 38167247, "link": "https://stackoverflow.com/questions/38167247/godaddys-ssl-certificate-with-golang/38167448#38167448", "title": "godaddy&#39;s ssl certificate with GoLang", "body": "<p>You can see a <a href=\"https://gist.github.com/ncw/9253562\" rel=\"nofollow\">full example here</a> in the <a href=\"https://gist.github.com/ncw/9253562#file-server-go\" rel=\"nofollow\"><code>file-server-go</code></a> section.<br>\nThe chain of certificate should be loaded in a <a href=\"https://golang.org/pkg/crypto/x509/#NewCertPool\" rel=\"nofollow\"><code>x509.NewCertPool()</code></a></p>\n\n<pre><code>cert, err := tls.LoadX509KeyPair(\"certs/server.pem\", \"certs/server.key\")\nif err != nil {\n    log.Fatalf(\"server: loadkeys: %s\", err)\n\n}\ncertpool := x509.NewCertPool()\npem, err := ioutil.ReadFile(\"certs/ca.pem\")\nif err != nil {\n    log.Fatalf(\"Failed to read client certificate authority: %v\", err)\n}\nif !certpool.AppendCertsFromPEM(pem) {\n    log.Fatalf(\"Can't parse client certificate authority\")\n}\n\nconfig := tls.Config{\n    Certificates: []tls.Certificate{cert},\n    ClientAuth:   tls.RequireAndVerifyClientCert,\n    ClientCAs:    certpool,\n}\nconfig.Rand = rand.Reader\nservice := \"0.0.0.0:8000\"\nlistener, err := tls.Listen(\"tcp\", service, &amp;config)\n</code></pre>\n\n<p>In your case, <code>ioutil.ReadFile(\"sf_bundle-g2-g1.crt\")</code>.</p>\n\n<blockquote>\n  <p>I'm using http.Server instance in order to change ReadTimeout and WriteTimeout parameters</p>\n</blockquote>\n\n<pre><code>server := &amp;http.Server{\n    Addr:      \"0.0.0.0:8000\",\n    TLSConfig: tlsConfig,\n    ReadTimeout: time.Duration // maximum duration before timing out read of the request,\n    WriteTimeout: time.Duration // maximum duration before timing out write of the response\n}\n</code></pre>\n\n<p>(replace <code>time.Duration</code> with the actual time)</p>\n\n<p>Then:</p>\n\n<pre><code>err := server.ListenAndServeTLS(certFile, keyFile string)\nlog.Fatal(err)\n</code></pre>\n\n<p>Note <code>ListenAndServeTLS</code> always returns a non-nil error.</p>\n"}], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1250, "favorite_count": 1, "accepted_answer_id": 38167448, "answer_count": 1, "score": 1, "last_activity_date": 1467556978, "creation_date": 1467526418, "last_edit_date": 1592644375, "question_id": 38167247, "link": "https://stackoverflow.com/questions/38167247/godaddys-ssl-certificate-with-golang", "title": "godaddy&#39;s ssl certificate with GoLang", "body": "<p>I'm wondering how to use godaddy's ssl certificate with GoLang Https server.</p>\n<p>currently I'm using the following code:</p>\n<pre><code>srv := &amp;http.Server{\n    Addr: httpsPortStr,\n    Handler: n,\n    ReadTimeout: time.Duration(config.CfgIni.ReadTimeout) * time.Second,\n    WriteTimeout: time.Duration(config.CfgIni.WriteTimeout) * time.Second,\n}\nerr := srv.ListenAndServeTLS(&lt;CERTIFICATE_FILE&gt;,&lt;PRIVATE_KEY_FILE&gt;)\n</code></pre>\n<p>I still have <code>sf_bundle-g2-g1.crt</code>. how do I add it to the chain of certificates ?</p>\n<h1>update</h1>\n<p>@Vonc's answer is really helpful, i'm just missing one last thing.\nI'm using http.Server instance in order to change ReadTimeout and WriteTimeout parameters. how can I do this with the tls ?</p>\n<p>My previous code for this:</p>\n<pre><code>srv := &amp;http.Server{\n    Addr: httpsPortStr,\n    Handler: n,\n    ReadTimeout: time.Duration(config.CfgIni.ReadTimeout) * time.Second,\n    WriteTimeout: time.Duration(config.CfgIni.WriteTimeout) * time.Second,\n}\nerr := srv.ListenAndServeTLS(config.CfgIni.CertificateFile,config.CfgIni.PrivateKeyFile)\n</code></pre>\n<p>thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1165, "user_id": 132042, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5cf11b9744a4262cf9a4f7aebd1a4ee5?s=128&d=identicon&r=PG", "display_name": "Tatiana Racheva", "link": "https://stackoverflow.com/users/132042/tatiana-racheva"}, "edited": false, "score": 0, "creation_date": 1507847238, "post_id": 38166925, "comment_id": 80386308, "body": "I came here to discuss the same example. I can&#39;t wrap my head around it. It&#39;s here: <a href=\"https://tour.golang.org/methods/9\" rel=\"nofollow noreferrer\">tour.golang.org/methods/9</a>"}], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 6178021, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vhabx.jpg?s=128&g=1", "display_name": "Tanmay Garg", "link": "https://stackoverflow.com/users/6178021/tanmay-garg"}, "edited": false, "score": 1, "creation_date": 1467528612, "post_id": 38167163, "comment_id": 63762304, "body": "<a href=\"http://npf.io/2014/05/intro-to-go-interfaces/\" rel=\"nofollow noreferrer\">Intro++ to Go Interfaces</a> addressed my doubt quite clearly. It clearly states that: &quot;.. value in an interface is in a hidden memory location, and so the compiler can\u2019t automatically get a pointer to that memory for you (in Go parlance, this is known as being \u201cnot addressable\u201d).&quot; I would like to suggest to anybody facing the same doubts that I was facing, to visit the link and go through it once, it will be worth your time. @VonC, thankyou for the wonderful links :-)"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 711, "user_id": 6178021, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vhabx.jpg?s=128&g=1", "display_name": "Tanmay Garg", "link": "https://stackoverflow.com/users/6178021/tanmay-garg"}, "edited": false, "score": 1, "creation_date": 1467528683, "post_id": 38167163, "comment_id": 63762316, "body": "@TanmayGarg true, I have detailed the not addressable part in my last edit of the answer, at the end."}, {"owner": {"reputation": 711, "user_id": 6178021, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vhabx.jpg?s=128&g=1", "display_name": "Tanmay Garg", "link": "https://stackoverflow.com/users/6178021/tanmay-garg"}, "edited": false, "score": 0, "creation_date": 1467528797, "post_id": 38167163, "comment_id": 63762332, "body": "Ahh yes. Thanks, once again :-)"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 6, "last_activity_date": 1467527232, "last_edit_date": 1495535373, "creation_date": 1467525650, "answer_id": 38167163, "question_id": 38166925, "link": "https://stackoverflow.com/questions/38166925/why-cant-i-assign-types-value-to-an-interface-implementing-methods-with-receiv/38167163#38167163", "title": "Why can&#39;t I assign type&#39;s value to an interface implementing methods with receiver type pointer to that type?", "body": "<p>\"<a href=\"http://npf.io/2014/05/intro-to-go-interfaces/\" rel=\"nofollow noreferrer\">Intro++ to Go Interfaces</a>\" illustrates the issue:</p>\n\n<blockquote>\n  <p><code>*Vertex</code> is a type. It\u2019s the \u201cpointer to a <code>Vertex</code>\u201d type. It\u2019s a distinct type from (non-pointer) <code>Vertex</code>. The part about it being a pointer is part of its type.</p>\n</blockquote>\n\n<p>You need consistency of type.</p>\n\n<p>\"<a href=\"https://www.goinggo.net/2014/05/methods-interfaces-and-embedded-types.html\" rel=\"nofollow noreferrer\">Methods, Interfaces and Embedded Types in Go</a>\":</p>\n\n<blockquote>\n  <p>The rules for determining interface compliance are based on the receiver for those methods and how the interface call is being made.<br>\n  <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">Here are the rules in the spec for how the compiler determines if the value or pointer for our type implements the interface</a>:</p>\n</blockquote>\n\n<ul>\n<li>The method set of the corresponding pointer type <code>*T</code> is the set of all methods with receiver <code>*T</code> or <code>T</code></li>\n</ul>\n\n<blockquote>\n  <p>This rule is stating that if the interface variable we are using to call a particular interface method contains a pointer, then methods with receivers based on both values and pointers will satisfy the interface. </p>\n</blockquote>\n\n<ul>\n<li>The method set of any other type <code>T</code> consists of all methods with receiver type <code>T</code>.</li>\n</ul>\n\n<blockquote>\n  <p>This rule is stating that if the interface variable we are using to call a particular interface method contains a value, then only methods with receivers based on values will satisfy the interface.</p>\n</blockquote>\n\n<p><a href=\"https://stackoverflow.com/users/5728991/karrot-kake\">Karrot Kake</a>'s <a href=\"https://stackoverflow.com/a/38167287/6309\">answer</a> about <strong><a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a></strong> is detailed also in <a href=\"https://github.com/golang/go/wiki/MethodSets\" rel=\"nofollow noreferrer\">go wiki</a>:</p>\n\n<blockquote>\n  <p>The method set of an interface type is its interface. </p>\n  \n  <p><strong>The concrete value stored in an interface is not addressable</strong>, in the same way that a <code>map</code> element is not addressable.<br>\n  Therefore, when you call a method on an interface, it must either have an identical receiver type or it must be directly discernible from the concrete type.</p>\n  \n  <p>Pointer- and value-receiver methods can be called with pointers and values respectively, as you would expect.<br>\n  <strong>Value-receiver methods can be called with pointer values because they can be dereferenced first</strong>.<br>\n  <strong>Pointer-receiver methods cannot be called with values, however, because the value stored inside an interface has no address</strong>.</p>\n</blockquote>\n\n<p>(\"has no address\" means actually that it is <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">not addressable</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 4, "last_activity_date": 1467527097, "last_edit_date": 1467527097, "creation_date": 1467526779, "answer_id": 38167287, "question_id": 38166925, "link": "https://stackoverflow.com/questions/38166925/why-cant-i-assign-types-value-to-an-interface-implementing-methods-with-receiv/38167287#38167287", "title": "Why can&#39;t I assign type&#39;s value to an interface implementing methods with receiver type pointer to that type?", "body": "<p>The <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow\">method set</a> for a pointer type <strong>includes the</strong> value receiver methods, but the method set for a value <strong>does not include</strong> the pointer receiver methods.  The method set for a value type does not include the pointer receiver methods because values stored in an interface are not <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow\">addressable</a>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 2, "last_activity_date": 1467536283, "last_edit_date": 1467536283, "creation_date": 1467526867, "answer_id": 38167290, "question_id": 38166925, "link": "https://stackoverflow.com/questions/38166925/why-cant-i-assign-types-value-to-an-interface-implementing-methods-with-receiv/38167290#38167290", "title": "Why can&#39;t I assign type&#39;s value to an interface implementing methods with receiver type pointer to that type?", "body": "<p>nice Question.<br>\nthis is Golang type system: <strong>the <code>Vertex</code> and <code>*Vertex</code> are different types</strong>,<br>\nsee this clarifying sample:<br>\nyou can use <code>type Vertex2 Vertex</code> to define new <code>Vertex2</code> type and these are different types too:  </p>\n\n<p>while this is working:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math\"\n\nfunc main() {\n    var myVer Vertex = Vertex{3, 4}\n    var inter Abser = myVer //assigning Vertex type to inter\n    fmt.Println(inter.Abs())\n}\n\nfunc (v Vertex) Abs() float64 { //method with pointer receiver argument\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\ntype Vertex struct {\n    X, Y float64\n}\ntype Abser interface {\n    Abs() float64\n}\n</code></pre>\n\n<p>this will not work:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math\"\n\nfunc main() {\n    var myVer Vertex = Vertex{3, 4}\n    var inter Abser = myVer //assigning Vertex type to inter\n    fmt.Println(inter.Abs())\n}\n\ntype Vertex2 Vertex\n\nfunc (v Vertex2) Abs() float64 { //method with pointer receiver argument\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\ntype Vertex struct {\n    X, Y float64\n}\ntype Abser interface {\n    Abs() float64\n}\n</code></pre>\n\n<p>the error  is:  </p>\n\n<p>.\\m.go:8: cannot use myVer (type Vertex) as type Abser in assignment:<br>\n    <strong>Vertex does not implement Abser (missing Abs method)</strong></p>\n\n<p>exactly same error with your sample:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math\"\n\nfunc main() {\n    var myVer Vertex = Vertex{3, 4}\n    var inter Abser = myVer //assigning Vertex type to inter\n    fmt.Println(inter.Abs())\n}\n\nfunc (v *Vertex) Abs() float64 { //method with pointer receiver argument\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\ntype Vertex struct {\n    X, Y float64\n}\ntype Abser interface {\n    Abs() float64\n}\n</code></pre>\n\n<p>because the two Vertex and Vertex2 are different types.<br>\nand <strong>this works too</strong>:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math\"\n\nfunc main() {\n    var inter Abser = &amp;Vertex{3, 4} //assigning &amp;Vertex type to inter\n    fmt.Printf(\"inter: %#[1]v\\n\", inter)\n    fmt.Println(inter.Abs())\n}\n\nfunc (v Vertex) Abs() float64 { //method with pointer receiver argument\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\ntype Vertex struct {\n    X, Y float64\n}\ntype Abser interface {\n    Abs() float64\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>inter: &amp;main.Vertex{X:3, Y:4}\n5\n</code></pre>\n\n<p>because:<br>\nA type may have a method set associated with it. The method set of an interface type is its interface. <strong>The method set of any other type T consists of all methods declared with receiver type T. The method set of the corresponding pointer type *T is the set of all methods declared with receiver *T or T (that is, it also contains the method set of T)</strong>. Further rules apply to structs containing anonymous fields, as described in the section on struct types. Any other type has an empty method set. In a method set, each method must have a unique non-blank method name.</p>\n\n<p>The method set of a type determines the interfaces that the type implements and the methods that can be called using a receiver of that type.<br>\nref:  <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow\">https://golang.org/ref/spec#Method_sets</a></p>\n"}, {"tags": [], "owner": {"reputation": 817, "user_id": 32122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c2c929be789dc669b2901330ebdb5a9?s=128&d=identicon&r=PG", "display_name": "WPWoodJr", "link": "https://stackoverflow.com/users/32122/wpwoodjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1519136230, "last_edit_date": 1519136230, "creation_date": 1519089803, "answer_id": 48876580, "question_id": 38166925, "link": "https://stackoverflow.com/questions/38166925/why-cant-i-assign-types-value-to-an-interface-implementing-methods-with-receiv/48876580#48876580", "title": "Why can&#39;t I assign type&#39;s value to an interface implementing methods with receiver type pointer to that type?", "body": "<p>Values stored in an interface are not addressable - but why?  See <a href=\"https://stackoverflow.com/a/48874650/32122\">here</a> for the answer. </p>\n\n<p><strong>tl;dr</strong> its because a pointer to A which points to a value of type A in an interface would be invalidated when a value of different type B is subsequently stored in the interface.</p>\n"}], "owner": {"reputation": 711, "user_id": 6178021, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vhabx.jpg?s=128&g=1", "display_name": "Tanmay Garg", "link": "https://stackoverflow.com/users/6178021/tanmay-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4831, "favorite_count": 4, "accepted_answer_id": 38167163, "answer_count": 4, "score": 9, "last_activity_date": 1519136230, "creation_date": 1467522458, "last_edit_date": 1467527141, "question_id": 38166925, "link": "https://stackoverflow.com/questions/38166925/why-cant-i-assign-types-value-to-an-interface-implementing-methods-with-receiv", "title": "Why can&#39;t I assign type&#39;s value to an interface implementing methods with receiver type pointer to that type?", "body": "<p>I am 2-days old in the world of Golang, and going through the <em>go tour</em>. I couldn't help but notice a peculiarity which I cannot seem to be able to come at terms with a proper reasoning.</p>\n\n<p>This code is running perfectly:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"math\"\n)\ntype Vertex struct{\n    X,Y float64\n}\ntype Abser interface{\n    Abs() float64\n}\nfunc (v Vertex) Abs() float64{ //method with value receiver argument\n    return math.Sqrt(v.X*v.X+v.Y*v.Y)\n}\nfunc main(){\n    var myVer Vertex = Vertex{3,4}\n    var inter Abser\n    inter = &amp;myVer //assigning *Vertex type to inter\n    fmt.Println(inter.Abs())\n}\n</code></pre>\n\n<p>Meanwhile, the following code shows an error:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"math\"\n)\ntype Vertex struct{\n    X,Y float64\n}\ntype Abser interface{\n    Abs() float64\n}\nfunc (v *Vertex) Abs() float64{ //method with pointer receiver argument\n    return math.Sqrt(v.X*v.X+v.Y*v.Y)\n}\nfunc main(){\n    var myVer Vertex = Vertex{3,4}\n    var inter Abser\n    inter = myVer //assigning Vertex type to inter\n    fmt.Println(inter.Abs())\n}\n</code></pre>\n\n<p>The error is:</p>\n\n<blockquote>\n  <p>interface.go:18: cannot use myVer (type Vertex) as type Abser in assignment:\n      Vertex does not implement Abser (Abs method has pointer receiver)</p>\n</blockquote>\n\n<p>Until reaching this section of the tour, I could understand that the creators of Go have let-go of the cumbersome notations like</p>\n\n<blockquote>\n  <p>(*v).method1name()</p>\n  \n  <p>(&amp;v).method2name()</p>\n</blockquote>\n\n<p>So that methods with value receivers can be used with both values and pointers, and vice versa.</p>\n\n<p>Why does the language discriminate between the two (value and pointer) when working with interfaces? Wouldn't it be more convenient if the same reference/dereference principles could apply here?</p>\n\n<p>I hope that I am not missing something too apparent.\nThanks!</p>\n"}, {"tags": ["go", "docker", "rabbitmq"], "owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1467566802, "creation_date": 1467506105, "last_edit_date": 1467566802, "question_id": 38165691, "link": "https://stackoverflow.com/questions/38165691/go-cannot-create-rabbitmq-channel-rabbitmq-server-on-docker-container-go-scrip", "title": "Go cannot create RabbitMQ channel. RabbitMQ server on docker container, Go script on host", "body": "<p>I'm running a RabbitMQ server on a docker container and I'm not able to open a RabbitMQ channel from the host machine. </p>\n\n<p>The docker container is run from the RabbitMQ image this way, forwarding management ports and amqp port to the host :</p>\n\n<pre><code>docker run -d -p 5672:5672 -p 15672:15672 --hostname my-rmq --name rmq rabbitmq:3-management\n</code></pre>\n\n<p>The channel part of the go script is pretty straightforward :</p>\n\n<pre><code>ch, err := conn.Channel()\nfailOnErrorRmq(err, \"Failed to open a channel\")\ndefer ch.Close()\n</code></pre>\n\n<p>And I'm getting the following error</p>\n\n<pre><code>Failed to open a channel: write tcp [::1]:51937-&gt;[::1]:5672: use of closed network connection\n</code></pre>\n\n<p>I'm new to RabbitMQ. Any help on using RabbitMQ with Docker would be great. </p>\n"}, {"tags": ["arrays", "go", "query-string"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1467493290, "post_id": 38164429, "comment_id": 63756789, "body": "You are looking for <a href=\"https://godoc.org/net/url#Values\" rel=\"nofollow noreferrer\"><code>net&#47;url.Values</code></a>."}, {"owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1467493549, "post_id": 38164429, "comment_id": 63756856, "body": "hmm lemme try, though i dont thinks it does that but I may be wrong"}, {"owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1467493971, "post_id": 38164429, "comment_id": 63756937, "body": "@TimCooper sorry i dont see how your suggestion can convert my string to array."}, {"owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1467494479, "post_id": 38164429, "comment_id": 63757045, "body": "@TimCooper can you provide an example <a href=\"https://play.golang.org/p/51b5XgUTsp\" rel=\"nofollow noreferrer\">play.golang.org/p/51b5XgUTsp</a>"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1467494509, "post_id": 38164429, "comment_id": 63757049, "body": "<a href=\"https://play.golang.org/p/Or28JJOaUg\" rel=\"nofollow noreferrer\">play.golang.org/p/Or28JJOaUg</a>"}, {"owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1467495083, "post_id": 38164429, "comment_id": 63757164, "body": "@TimCooper i need to loop on <code>filter</code> i do not know how many values might be there."}], "answers": [{"comments": [{"owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "edited": false, "score": 0, "creation_date": 1467570804, "post_id": 38165883, "comment_id": 63773393, "body": "i want the end result a multidimensional map which i can loop and make <code>brandid == firstvalue</code>"}], "tags": [], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "is_accepted": false, "score": 0, "last_activity_date": 1467510227, "last_edit_date": 1467510227, "creation_date": 1467508596, "answer_id": 38165883, "question_id": 38164429, "link": "https://stackoverflow.com/questions/38164429/parse-a-query-string-in-multi-dimensional-array-format-to-actual-array/38165883#38165883", "title": "parse a query-string in multi-dimensional array format to actual array", "body": "<p>You could range on the parsed query like so if your <code>filter</code> is going to be an unknown length:</p>\n\n<p><a href=\"https://play.golang.org/p/NSQ7bnJXef\" rel=\"nofollow\">https://play.golang.org/p/NSQ7bnJXef</a></p>\n\n<pre><code>    v, err := url.ParseQuery(\"filter[1][field]=brandid&amp;filter[1][operand]=&gt;&amp;filter[1][values][]=firstvalue&amp;filter[2][field]=brandid&amp;filter[2][operand]=&gt;&amp;filter[2][values][]=firstvalue\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    for id, thing := range v {\n        switch {\n        case strings.Contains(id, \"field\"):\n            log.Printf(\"Field Value: %v\", thing)\n        case strings.Contains(id, \"values\"):\n            log.Printf(\"Values Value: %v\", thing)\n        case strings.Contains(id, \"operand\"):\n            log.Printf(\"Operand Value: %v\", thing)\n        }\n    }\n</code></pre>\n\n<p>But IMO, there has to be a better way than doing the query you're doing now.</p>\n"}], "owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 829, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467510227, "creation_date": 1467493197, "question_id": 38164429, "link": "https://stackoverflow.com/questions/38164429/parse-a-query-string-in-multi-dimensional-array-format-to-actual-array", "title": "parse a query-string in multi-dimensional array format to actual array", "body": "<p>I am trying to create an extensive search url with this format <code>?filter[1][field]=brandId&amp;filter[1][operand]=&gt;&amp;filter[1][values][]=firstvalue</code> but I cant seem to figure out a way to convert this (string) to an actual array (map/slice or anything i can loop on).</p>\n\n<p>i have read a lot of documentation and searched on google but cannot find a good way to do this.</p>\n"}, {"tags": ["go", "server-sent-events"], "answers": [{"comments": [{"owner": {"reputation": 25797, "user_id": 316357, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50e7e6ec58e101311283a40e60c33572?s=128&d=identicon&r=PG", "display_name": "Curious2learn", "link": "https://stackoverflow.com/users/316357/curious2learn"}, "edited": false, "score": 0, "creation_date": 1467487814, "post_id": 38162557, "comment_id": 63755468, "body": "Thanks! Works great! A quick question. How did you know that it returns <code>ok</code>. That is not obvious from the documentation to me. I am new to golang and hence the question. Thanks!"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 25797, "user_id": 316357, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50e7e6ec58e101311283a40e60c33572?s=128&d=identicon&r=PG", "display_name": "Curious2learn", "link": "https://stackoverflow.com/users/316357/curious2learn"}, "edited": false, "score": 0, "creation_date": 1467488157, "post_id": 38162557, "comment_id": 63755556, "body": "<code>f, ok := w.(http.Flusher)</code> is a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>. The the second value yielded from the assertion is a boolean indicating whether the assertion holds."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1467479762, "last_edit_date": 1467479762, "creation_date": 1467479153, "answer_id": 38162557, "question_id": 38162389, "link": "https://stackoverflow.com/questions/38162389/time-sleep-and-server-sent-events-in-go-unexpected-behavior/38162557#38162557", "title": "time.Sleep and server-sent-events in Go - unexpected behavior", "body": "<p>The server buffers the response body. <a href=\"https://godoc.org/net/http#Flusher\" rel=\"nofollow\">Flush</a> the buffer to fix this issue:</p>\n\n<pre><code>w.Header().Set(\"Content-Type\", \"text/event-stream\")\nw.Header().Set(\"Cache-Control\", \"no-cache\")\nf, ok := w.(http.Flusher)\nif !ok {\n    http.Error(w, \"sse not supported\", 400)\n    return\n}\nfor i := 0; i &lt; 5; i++ {\n    fmt.Fprintf(w, \"data: Message %d\\n\\n\", i)\n    f.Flush()\n    time.Sleep(time.Second)\n}\nw.Write([]byte(\"data:close\\n\\n\"))\n</code></pre>\n"}], "owner": {"reputation": 25797, "user_id": 316357, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50e7e6ec58e101311283a40e60c33572?s=128&d=identicon&r=PG", "display_name": "Curious2learn", "link": "https://stackoverflow.com/users/316357/curious2learn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 38162557, "answer_count": 1, "score": 0, "last_activity_date": 1467489688, "creation_date": 1467478008, "last_edit_date": 1467489688, "question_id": 38162389, "link": "https://stackoverflow.com/questions/38162389/time-sleep-and-server-sent-events-in-go-unexpected-behavior", "title": "time.Sleep and server-sent-events in Go - unexpected behavior", "body": "<p>I am trying to learn to use server sent events (SSE) with Go. The\nfollowing is the behavior that I do not understand.</p>\n\n<p><strong>What I expect (and want to implement):</strong> one message will be sent after every second;\nthis will happen five times, and then the connection will be closed.</p>\n\n<p><strong>What actually happens</strong>: the server waits for about 5 seconds and then sends\nall messages at once and then the connection is closed.</p>\n\n<p>Would appreciate if you can help me understand why this is happening.\nIt is not clear to me where I am going wrong with how I am thinking about this.\nEvery time the loop starts, it should send a message, sleep and then start a new\niteration.</p>\n\n<p>Thank you.</p>\n\n<p><strong>Relevant code on server</strong></p>\n\n<pre><code>func realTimeHandler(w http.ResponseWriter, req *http.Request) {\n    w.Header().Set(\"Content-Type\", \"text/event-stream\")\n    w.Header().Set(\"Cache-Control\", \"no-cache\")\n\n    i := 0\n    var msg string\n    for {\n        msg = fmt.Sprintf(\"data: Message %d\\n\\n\", i)\n        i = i + 1\n        w.Write([]byte(msg))\n        time.Sleep(time.Second)\n        if i &gt; 5 {\n            break\n        }\n    }\n    w.Write([]byte(\"data:close\\n\\n\"))\n    return\n}\n</code></pre>\n\n<p><strong>Code on client</strong></p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;SSE&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div id=\"realtime\"&gt;&lt;/div&gt;\n\n    &lt;script type=\"text/javascript\"&gt;\n        var evtsrc = new EventSource(\"/realTimeEvts\");\n\n        evtsrc.onmessage = function(e) {\n            console.log(\"message received\");\n            if (e.data == \"close\") {\n                console.log(\"closing connection!\");\n                evtsrc.close();\n            }\n            console.log(e.data);\n        };\n\n        evtsrc.onerror = function(e) {\n            console.log(evtsrc.readyState);\n            console.log(\"error!\");\n        };\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["go", "byte", "uppercase", "lowercase"], "answers": [{"comments": [{"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1467477069, "post_id": 38162142, "comment_id": 63752664, "body": "And will that change the value of the byte selected?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1478570043, "last_edit_date": 1478570043, "creation_date": 1467476482, "answer_id": 38162142, "question_id": 38162102, "link": "https://stackoverflow.com/questions/38162102/golang-toupper-on-a-single-byte/38162142#38162142", "title": "Golang - ToUpper() on a single byte?", "body": "<p>Use the following code to test if an element of the board is an ASCII uppercase letter:</p>\n\n<pre><code>func (b Board) isUpper(x int) bool {\n    v := b.board[x]\n    return 'A' &lt;= v &amp;&amp; v &lt;= 'Z'\n}\n</code></pre>\n\n<p>If the application only needs to distinguish between upper and lowercase letters, then there's no need for the lower bound test:</p>\n\n<pre><code>func (b Board) isUpper(x int) bool {\n    return b.board[x] &lt;= 'Z'\n}\n</code></pre>\n\n<p>The code in this answer improves on the code in the question in a few ways:</p>\n\n<ul>\n<li>The code in the answer returns the correct value for a board element containing 'Z' (run playground example below for demonstration).</li>\n<li>'Z' and 0x85 are the same value, but the code is easier to understand with 'Z'.</li>\n<li>It's simpler to compare directly with the value 'Z'. No need to create a slice.</li>\n</ul>\n\n<p><a href=\"https://play.golang.org/p/M66HzEHFAq\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>Edit: Revamped answer based on new information in the question since time of my original answer.</p>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 26, "last_activity_date": 1467483432, "creation_date": 1467483432, "answer_id": 38163175, "question_id": 38162102, "link": "https://stackoverflow.com/questions/38162102/golang-toupper-on-a-single-byte/38163175#38163175", "title": "Golang - ToUpper() on a single byte?", "body": "<p>For a single byte/rune, you can use <a href=\"https://golang.org/pkg/unicode/#ToUpper\" rel=\"noreferrer\"><code>unicode.ToUpper</code></a>.</p>\n\n<pre><code>b[pos] = byte(unicode.ToUpper(rune(b[pos])))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1470921761, "post_id": 38176755, "comment_id": 65154110, "body": "I found this method <a href=\"https://golang.org/pkg/strings/#ToUpperSpecial\" rel=\"nofollow noreferrer\">golang.org/pkg/strings/#ToUpperSpecial</a> for putting special unicode characters into Upper Case."}], "tags": [], "owner": {"reputation": 606, "user_id": 4257143, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q195EKev0qQ/AAAAAAAAAAI/AAAAAAAAAxM/R2bEEt98Yrc/photo.jpg?sz=128", "display_name": "Doug Henderson", "link": "https://stackoverflow.com/users/4257143/doug-henderson"}, "is_accepted": false, "score": 5, "last_activity_date": 1467604711, "creation_date": 1467604711, "answer_id": 38176755, "question_id": 38162102, "link": "https://stackoverflow.com/questions/38162102/golang-toupper-on-a-single-byte/38176755#38176755", "title": "Golang - ToUpper() on a single byte?", "body": "<p>I want to remind OP that <code>bytes.ToUpper()</code> operates on unicode code points encoded using UTF-8 in a byte slice while <code>unicode.ToUpper()</code> operates on a single unicode code point.</p>\n\n<p>By asking to convert a single byte to upper case, OP is implying that the \"<code>b</code>\" byte slice contains something other than UTF-8, perhaps ASCII-7 or some 8-bit encoding such as ISO Latin-1 (e.g.). In that case OP needs to write an ISO Latin-1 (e.g.) <code>ToUpper()</code> function or OP must convert the ISO Latin-1 (e.g.) bytes to UTF-8 or unicode before using the <code>bytes.ToUpper()</code> or <code>unicode.ToUpper()</code> function.</p>\n\n<p>Anything less creates a pending bug. Neither of the previously mentioned functions will properly convert all possible ISO Latin-1 (e.g.) encoded characters to upper case.</p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1618202409, "last_edit_date": 1618202409, "creation_date": 1618201041, "answer_id": 67052604, "question_id": 38162102, "link": "https://stackoverflow.com/questions/38162102/golang-toupper-on-a-single-byte/67052604#67052604", "title": "Golang - ToUpper() on a single byte?", "body": "<p>You can use <code>bytes.ToUpper</code>, you just need to deal with making the input a slice,\nand making the output a byte:</p>\n<pre><code>package main\nimport &quot;bytes&quot;\n\nfunc main() {\n   b, pos := []byte(&quot;north&quot;), 1\n   b[pos] = bytes.ToUpper(b)[pos]\n   println(string(b) == &quot;nOrth&quot;)\n}\n</code></pre>\n"}], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10188, "favorite_count": 2, "accepted_answer_id": 38163175, "answer_count": 4, "score": 19, "last_activity_date": 1618202409, "creation_date": 1467476259, "last_edit_date": 1496466632, "question_id": 38162102, "link": "https://stackoverflow.com/questions/38162102/golang-toupper-on-a-single-byte", "title": "Golang - ToUpper() on a single byte?", "body": "<p>I have a <code>[]byte</code>, <code>b</code>, and I want to select a single byte, <code>b[pos]</code> and change it too upper case (and then lower case) The <code>bytes</code> type has a method called <code>ToUpper()</code>. How can I use this for a single byte?</p>\n\n<h2>Calling <code>ToUpper</code> on single Byte</h2>\n\n<p>OneOfOne gave the most efficient (when calling thousands of times), I use</p>\n\n<pre><code>val = byte(unicode.ToUpper(rune(b[pos])))\n</code></pre>\n\n<p>in order to find the byte and change the value</p>\n\n<pre><code>b[pos] = val\n</code></pre>\n\n<h2>Checking if byte is Upper</h2>\n\n<p>Sometimes, instead of changing the case of a byte, I want to <strong>check if a byte is upper or lower case</strong>; All the upper case roman-alphabet bytes are <em>lower than the value</em> of the lower case bytes.</p>\n\n<pre><code>func (b Board) isUpper(x int) bool {\n    return b.board[x] &lt; []byte{0x5a}[0]\n}\n</code></pre>\n"}, {"tags": ["sql-server", "go", "guid", "uuid"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467523117, "post_id": 38160945, "comment_id": 63761471, "body": "Could you change your query to use &quot;SELECT convert(Id as varchar(36)) FROM ...&quot;?"}, {"owner": {"reputation": 279, "user_id": 3210311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1a2484874df38152bdd98384dd983927?s=128&d=identicon&r=PG&f=1", "display_name": "KenWin0x539", "link": "https://stackoverflow.com/users/3210311/kenwin0x539"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467556835, "post_id": 38160945, "comment_id": 63769079, "body": "@mark I&#39;ll try that out and let you know!"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467602413, "post_id": 38160945, "comment_id": 63780119, "body": "Sorry, correction: <code>convert(char(36), Id)</code> or <code>cast(Id as char(36))</code> <a href=\"https://technet.microsoft.com/en-us/library/ms191530(v=sql.105).aspx\" rel=\"nofollow noreferrer\">data type conversions</a>"}, {"owner": {"reputation": 279, "user_id": 3210311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1a2484874df38152bdd98384dd983927?s=128&d=identicon&r=PG&f=1", "display_name": "KenWin0x539", "link": "https://stackoverflow.com/users/3210311/kenwin0x539"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467648850, "post_id": 38160945, "comment_id": 63803220, "body": "@mark If you add it as an answer I&#39;ll mark it answered."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1467666575, "post_id": 38160945, "comment_id": 63809977, "body": "great! Could you please try <code>cast(Id as binary(16))</code>. It&#39;s likely more efficient. Does it also give a correct uuid?"}], "answers": [{"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 11, "last_activity_date": 1467798766, "creation_date": 1467798766, "answer_id": 38221117, "question_id": 38160945, "link": "https://stackoverflow.com/questions/38160945/ms-sql-uniqueidentifier-with-golang-sql-driver-and-uuid/38221117#38221117", "title": "MS SQL uniqueidentifier with Golang SQL driver and UUID", "body": "<p>Casting (or converting) the Id to a char returns the Id in the expected byte ordering:</p>\n\n<pre><code>\"SELECT cast(Id as char(36)) FROM ...\"\n</code></pre>\n\n<p>Note casting to binary gives the same result as querying the Id directly.</p>\n\n<pre><code>0F F1 4D 44 F4 72 49 59 9F C8 18 C2 DB 26 3C 3C  As inserted\n\n44 4D F1 0F 72 F4 59 49 9F C8 18 C2 DB 26 3C 3C  Id (no cast)\n44 4D F1 0F 72 F4 59 49 9F C8 18 C2 DB 26 3C 3C  cast(Id as binary(16))\n0F F1 4D 44 F4 72 49 59 9F C8 18 C2 DB 26 3C 3C  cast(Id as char(36))\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 3210311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1a2484874df38152bdd98384dd983927?s=128&d=identicon&r=PG&f=1", "display_name": "KenWin0x539", "link": "https://stackoverflow.com/users/3210311/kenwin0x539"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2379, "favorite_count": 4, "accepted_answer_id": 38221117, "answer_count": 1, "score": 4, "last_activity_date": 1467798766, "creation_date": 1467467778, "last_edit_date": 1492087363, "question_id": 38160945, "link": "https://stackoverflow.com/questions/38160945/ms-sql-uniqueidentifier-with-golang-sql-driver-and-uuid", "title": "MS SQL uniqueidentifier with Golang SQL driver and UUID", "body": "<p>I am connecting to a SQL-Server DB using Go 1.6.2. I am using the go-mssqldb driver (github.com/denisenkom/go-mssqldb) with the sql package.</p>\n\n<p>My problem is that I am creating uuids with the github.com/twinj/uuid package (I also tried some others) and they insert correctly but when I try to scan them out</p>\n\n<pre><code>err := Database.QueryRow(\"SELECT Id FROM ...\").Scan(&amp;struct.Id)\n</code></pre>\n\n<p>it returns the Id with the first half flipped. I found an explanation in this SO post (<a href=\"https://dba.stackexchange.com/questions/121869/sql-server-uniqueidentifier-guid-internal-representation\">https://dba.stackexchange.com/questions/121869/sql-server-uniqueidentifier-guid-internal-representation</a>) and some other articles/posts.</p>\n\n<p>However, I have been unable to find anything specific for solving this in Go. I can't do anything to change the way SQL-server stores the guids. Am I missing something with the UUID scan implementations? I haven't seen a way to change the way it reads. My last option will be to write my own implementation to swap the bits but wanted to reach out to see if I was missing something with the driver or UUID packages or some other library out there.</p>\n"}, {"tags": ["go", "concurrency", "deadlock"], "answers": [{"comments": [{"owner": {"reputation": 2005, "user_id": 910553, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/9101644/picture?type=large", "display_name": "Scott Frazer", "link": "https://stackoverflow.com/users/910553/scott-frazer"}, "edited": false, "score": 0, "creation_date": 1467457068, "post_id": 38159297, "comment_id": 63747087, "body": "Seems so obvious now :)  Still getting used to the Go concurrency model.  Thanks!"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1467705856, "post_id": 38159297, "comment_id": 63820717, "body": "Another alternative would be to make <code>c0</code> a buffered channel, with enough capacity to accept all your initial &quot;stuffing of data&quot;."}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": true, "score": 4, "last_activity_date": 1467457130, "last_edit_date": 1467457130, "creation_date": 1467456699, "answer_id": 38159297, "question_id": 38159228, "link": "https://stackoverflow.com/questions/38159228/why-does-this-go-program-hang/38159297#38159297", "title": "Why does this Go program hang?", "body": "<p>It hangs because the loop which reads from the output channel is never reached, thus the channels are not \"emptyed\" and once each channe has a value written into it no progress can be made and program hangs. To fix it write to the input in another goroutine, ie</p>\n\n<pre><code>func main() {\n  c0 := make(chan int)\n  c1 := make(chan int)\n  c2 := make(chan int)\n  c3 := make(chan int)\n\n  go int_channel(\"one\", c0, c1)\n  go int_channel(\"two\", c1, c2)\n  go int_channel(\"three\", c2, c3)\n\n  go func(){\n    c0 &lt;- 1\n    c0 &lt;- 10\n    c0 &lt;- 100\n    c0 &lt;- 1000\n    c0 &lt;- 10000\n    c0 &lt;- 100000\n    fmt.Println(\"Sent all numbers to c0\")\n    close(c0)\n  }()\n\n\n  for x := range c3 {\n    fmt.Printf(\"out: %d\\n\", x)\n  }\n}\n</code></pre>\n\n<p>IOW, when the line <code>c0 &lt;- 1</code> is executed, the value flows throught all three cannels and ends up in <code>c3</code>, but since the reader loop is not reached yet, it just \"sits in there\". Then the line <code>c0 &lt;- 10</code> is executed, and this value ends up in <code>c2</code> because it can't be written into <code>c3</code> - the previous value is still in there, blocking the write. And thus when the line <code>c0 &lt;- 100</code> is executed, all channels are full and no further progress can be made.</p>\n"}, {"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1467457011, "creation_date": 1467457011, "answer_id": 38159354, "question_id": 38159228, "link": "https://stackoverflow.com/questions/38159228/why-does-this-go-program-hang/38159354#38159354", "title": "Why does this Go program hang?", "body": "<p>You are not reading from <code>c3</code> in a timely manner. You are sending way too many values into <code>c0</code>. So the communication between channels happens like this:</p>\n\n<pre><code>send 1 on c0 =&gt; recv 1 on c1 =&gt; send 2 on c2 =&gt;\n        recv 2 on c2 =&gt; send 3 on c3 =&gt; recv 3 on c3\n\nsend 10 on c0 =&gt; recv 10 on c1 =&gt; send 11 on c2 =&gt;\n        recv 11 on c2 =&gt; send 12 on c3 -- // c3 still hasn't been read\n                                          // from and so send\n                                          // operation blocks here.\n</code></pre>\n\n<p>c0, c1 and c2 continue to receive until all their sends block eventually. You can refer to @ain's answer below for a solution.</p>\n"}], "owner": {"reputation": 2005, "user_id": 910553, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/9101644/picture?type=large", "display_name": "Scott Frazer", "link": "https://stackoverflow.com/users/910553/scott-frazer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2313, "favorite_count": 2, "accepted_answer_id": 38159297, "answer_count": 2, "score": 3, "last_activity_date": 1467457130, "creation_date": 1467456209, "question_id": 38159228, "link": "https://stackoverflow.com/questions/38159228/why-does-this-go-program-hang", "title": "Why does this Go program hang?", "body": "<p>I'm setting up a chain of three goroutines, each with an input an output channel.  The goroutines will read from the input channel until it's closed, increment the value, send it to the output channel.  However, the program below deadlocks with this output:</p>\n\n<pre><code>goroutine 'one': 1\ngoroutine 'two': 2\ngoroutine 'three': 3\ngoroutine 'one': 10\ngoroutine 'two': 11\ngoroutine 'one': 100\nfatal error: all goroutines are asleep - deadlock!\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n)\n\nfunc int_channel(id string, i chan int, o chan int) {\n  defer close(o)\n\n  for x := range i {\n    fmt.Printf(\"goroutine '%s': %d\\n\", id, x)\n    o &lt;- x + 1\n  }\n\n  fmt.Println(\"done\")\n}\n\nfunc main() {\n  c0 := make(chan int)\n  c1 := make(chan int)\n  c2 := make(chan int)\n  c3 := make(chan int)\n\n  go int_channel(\"one\", c0, c1)\n  go int_channel(\"two\", c1, c2)\n  go int_channel(\"three\", c2, c3)\n\n  c0 &lt;- 1\n  c0 &lt;- 10\n  c0 &lt;- 100\n  c0 &lt;- 1000\n  c0 &lt;- 10000\n  c0 &lt;- 100000\n  close(c0)\n\n  fmt.Println(\"Sent all numbers to c0\")\n\n  for x := range c3 {\n    fmt.Printf(\"out: %d\\n\", x)\n  }\n}\n</code></pre>\n"}, {"tags": ["testing", "go", "testify"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1467457954, "post_id": 38158735, "comment_id": 63747312, "body": "You don&#39;t mention the DB engine youre using, but most relational databases do have means to generate keys (sequence, auto inc fields). I would suggest to use these instead of generating keys at client side."}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1467459307, "post_id": 38158735, "comment_id": 63747688, "body": "I have not used it myself, but it seems to have autoinc for keys: <a href=\"https://github.com/boltdb/bolt#autoincrementing-integer-for-the-bucket\" rel=\"nofollow noreferrer\">github.com/boltdb/bolt#autoincrementing-integer-for-the-buck&zwnj;&#8203;et</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5310620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32f58c29ce65bed3b25483866f22ae10?s=128&d=identicon&r=PG&f=1", "display_name": "axiomatic_345", "link": "https://stackoverflow.com/users/5310620/axiomatic-345"}, "is_accepted": false, "score": 0, "last_activity_date": 1467459880, "creation_date": 1467459880, "answer_id": 38159764, "question_id": 38158735, "link": "https://stackoverflow.com/questions/38158735/how-to-test-this-simple-method-with-go/38159764#38159764", "title": "How to test this simple method with Go?", "body": "<p>You can extract <code>database.DoesKeyExist</code> via dependency injection and supply a function that returns true first time in unit tests. More details <a href=\"http://openmymind.net/Dependency-Injection-In-Go/\" rel=\"nofollow\">http://openmymind.net/Dependency-Injection-In-Go/</a> </p>\n"}], "owner": {"reputation": 1057, "user_id": 974990, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c5a813df5e1175a873c40b2bf07db802?s=128&d=identicon&r=PG", "display_name": "Gregorio Di Stefano", "link": "https://stackoverflow.com/users/974990/gregorio-di-stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467459880, "creation_date": 1467452726, "last_edit_date": 1467454351, "question_id": 38158735, "link": "https://stackoverflow.com/questions/38158735/how-to-test-this-simple-method-with-go", "title": "How to test this simple method with Go?", "body": "<p>I'm writing some unit tests, and I'm stuck writing a test for the following method:</p>\n\n<pre><code>func (database *Database) FindUnusedKey() string {\n    count := 0\n    possibleKey := helpers.RandomString(helpers.Config.KeySize)\n    for database.DoesKeyExist(possibleKey) {\n        possibleKey = helpers.RandomString(helpers.Config.KeySize + uint8(count/10))\n        count++\n    }\n    return possibleKey\n}\n</code></pre>\n\n<p>I want a test in which <code>helpers.RandomString(int)</code> returns a string that is already a key in my database, but I've found no way to redeclare or monkey patch <code>helpers.RandomString(int)</code> in my test.</p>\n\n<p>I tried using testify mock, but it doesn't seem possible.</p>\n\n<p>Am I doing something wrong?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 3662, "user_id": 5076405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvLnU.jpg?s=128&g=1", "display_name": "David Guan", "link": "https://stackoverflow.com/users/5076405/david-guan"}, "edited": false, "score": 0, "creation_date": 1467441890, "post_id": 38157059, "comment_id": 63743432, "body": "What do you mean <code>print in template</code>?"}, {"owner": {"reputation": 33, "user_id": 6540674, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PfG7pZ-vkJc/AAAAAAAAAAI/AAAAAAAACyI/MUcDeoWOqow/photo.jpg?sz=128", "display_name": "\u041c\u0430\u043a\u0441\u0438\u043c \u0422\u043a\u0430\u0447\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/6540674/%d0%9c%d0%b0%d0%ba%d1%81%d0%b8%d0%bc-%d0%a2%d0%ba%d0%b0%d1%87%d0%b5%d0%bd%d0%ba%d0%be"}, "reply_to_user": {"reputation": 3662, "user_id": 5076405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvLnU.jpg?s=128&g=1", "display_name": "David Guan", "link": "https://stackoverflow.com/users/5076405/david-guan"}, "edited": false, "score": 0, "creation_date": 1467442211, "post_id": 38157059, "comment_id": 63743494, "body": "in template like as: &lt;table&gt;  {{for i range List }} &lt;tr&gt; &lt;td&gt;List[i].ID&lt;/td&gt; &lt;td&gt;List[i].Name&lt;/td&gt; &lt;td&gt;List[i].Test&lt;/td&gt; &lt;/tr&gt; {{end for}} &lt;/table&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1467455854, "post_id": 38157679, "comment_id": 63746760, "body": "Do use <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\"><code>html&#47;template</code></a> whenever the output is HTML (it is here), because it is safe against code injection."}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 2, "last_activity_date": 1467444493, "creation_date": 1467444493, "answer_id": 38157679, "question_id": 38157059, "link": "https://stackoverflow.com/questions/38157059/array-of-struct-in-templates/38157679#38157679", "title": "Array of struct in templates", "body": "<p>Use <code>range</code> and variable assignments.  See the appropriate sections of the <a href=\"https://golang.org/pkg/text/template/#pkg-overview\" rel=\"nofollow\"><code>text/template</code> documentation</a>.  Also see example below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"text/template\"\n)\n\ntype myType struct {\n    ID   string\n    Name string\n    Test string\n}\n\nfunc main() {\n    list := []myType{{\"id1\", \"name1\", \"test1\"}, {\"i2\", \"n2\", \"t2\"}}\n\n    tmpl := `\n&lt;table&gt;{{range $y, $x := . }}\n  &lt;tr&gt;\n    &lt;td&gt;{{ $x.ID }}&lt;/td&gt;\n    &lt;td&gt;{{ $x.Name }}&lt;/td&gt;\n    &lt;td&gt;{{ $x.Test }}&lt;/td&gt;\n  &lt;/tr&gt;{{end}}\n&lt;/table&gt;\n`\n\n    t := template.Must(template.New(\"tmpl\").Parse(tmpl))\n\n    err := t.Execute(os.Stdout, list)\n    if err != nil {\n        fmt.Println(\"executing template:\", err)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/W5lRPxD6r-\" rel=\"nofollow\">https://play.golang.org/p/W5lRPxD6r-</a></p>\n"}, {"tags": [], "owner": {"reputation": 2836, "user_id": 1359163, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/063e1984ad8cb19353c311ba3a9290b9?s=128&d=identicon&r=PG", "display_name": "KBN", "link": "https://stackoverflow.com/users/1359163/kbn"}, "is_accepted": false, "score": 0, "last_activity_date": 1467452188, "creation_date": 1467452188, "answer_id": 38158665, "question_id": 38157059, "link": "https://stackoverflow.com/questions/38157059/array-of-struct-in-templates/38158665#38158665", "title": "Array of struct in templates", "body": "<p>If you're talking about HTML template, here's what it'd look like:</p>\n\n<pre><code>{{range $idx, $item := .List}}\n&lt;div&gt;\n    {{$item.ID}}\n    {{$item.Name}}\n    {{$item.Test}}\n&lt;/div&gt;\n{{end}}\n</code></pre>\n\n<p>And this is how you'd pass that slice to the template.</p>\n\n<pre><code>import (\nhtpl \"html/template\"\n\"io/ioutil\"\n)\n\ncontent, err := ioutil.ReadFile(\"full/path/to/template.html\")\nif err != nil {\n    log.Fatal(\"Could not read file\")\n    return\n}\n\ntmpl, err := htpl.New(\"Error-Template\").Parse(string(content))\nif err != nil {\n    log.Fatal(\"Could not parse template\")\n}\n\n\nvar html bytes.Buffer\nList := []MyType // Is the variable holding the actual slice with all the data\ntmpl.Execute(&amp;html, type struct {\n    List []MyType\n}{\n    List\n})\nfmt.Println(html)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6540674, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PfG7pZ-vkJc/AAAAAAAAAAI/AAAAAAAACyI/MUcDeoWOqow/photo.jpg?sz=128", "display_name": "\u041c\u0430\u043a\u0441\u0438\u043c \u0422\u043a\u0430\u0447\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/6540674/%d0%9c%d0%b0%d0%ba%d1%81%d0%b8%d0%bc-%d0%a2%d0%ba%d0%b0%d1%87%d0%b5%d0%bd%d0%ba%d0%be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3025, "favorite_count": 1, "accepted_answer_id": 38157679, "answer_count": 2, "score": 3, "last_activity_date": 1467452188, "creation_date": 1467439476, "last_edit_date": 1467439897, "question_id": 38157059, "link": "https://stackoverflow.com/questions/38157059/array-of-struct-in-templates", "title": "Array of struct in templates", "body": "<p>Please, help me.\nI have  type with struct</p>\n\n<pre><code>type myType struct {\n    ID string \n    Name\n    Test \n}\n</code></pre>\n\n<p>And have array of type</p>\n\n<pre><code>var List []MyType;\n</code></pre>\n\n<p>How to i can print in template my  List with all struct fields?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1467426153, "post_id": 38155322, "comment_id": 63740900, "body": "<a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a> shows how you can have multiple binaries in one workspace (see <code>hello</code> and <code>outyet</code> in the example workspace). It&#39;s not clear to me exactly what you mean by &quot;project&quot; -- but I guess you just want a bunch of binaries in subdirs of your project&#39;s top level directory."}], "owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467418923, "creation_date": 1467418923, "question_id": 38155322, "link": "https://stackoverflow.com/questions/38155322/scripting-actions-in-go-project", "title": "Scripting actions in go project", "body": "<p>I want to make some simple scripts in a web of mine written in go: things like a script to run database migrations, generate alert dashboards etc. </p>\n\n<p>I'm wondering what the best method is for doing this. Ideally the scripts would be in the same project, but since I can only have one main method this seems a little difficult.</p>\n\n<p>Options I think I have:</p>\n\n<p>1) have a param to the server binary so I can run something like ./server SETUP (the command)</p>\n\n<p>2) put these scripts in a different repo (Some of the code is pretty specific to the current project)</p>\n\n<p>Is there some standard way to do this in go?</p>\n"}, {"tags": ["linux", "go", "freebsd", "kqueue"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1467404482, "post_id": 38153350, "comment_id": 63736058, "body": "Some ideas from this question: <a href=\"http://stackoverflow.com/q/1157700\">How to wait for exit of non-children processes</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1467404487, "post_id": 38153350, "comment_id": 63736062, "body": "Put a short sleep in your for loop. Linux doesn&#39;t provide an efficient way to do this"}, {"owner": {"reputation": 1956, "user_id": 4206439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jnwZd.png?s=128&g=1", "display_name": "kdhp", "link": "https://stackoverflow.com/users/4206439/kdhp"}, "edited": false, "score": 1, "creation_date": 1467435960, "post_id": 38153350, "comment_id": 63742364, "body": "The <code>kqueue</code> API is usable from <code>go</code> (in the <code>syscall</code> package), and if portability is not required, beyond *BSD and Darwin, then the BSD <code>pwait</code> utility could be translated into <code>go</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467727951, "post_id": 38153350, "comment_id": 63835331, "body": "Again, there&#39;s no direct equivalent on linux. If you want to use ptrace, all the relavent details are in the <a href=\"http://man7.org/linux/man-pages/man2/ptrace.2.html\" rel=\"nofollow noreferrer\">ptrace man page</a>. That&#39;s going to be much more complicated with more overhead than occasionally polling the PID. Granted there&#39;s only one race to attach via ptrace, but a possible race for every individual poll, but there&#39;s usually a better way to do these things entirely."}], "answers": [{"comments": [{"owner": {"reputation": 646, "user_id": 712014, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4InEp.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/712014/michael"}, "edited": false, "score": 1, "creation_date": 1583741948, "post_id": 42168768, "comment_id": 107205109, "body": "This is a great reply! Just wanted to say that in 2018, a Go package which does all this popped up: <a href=\"https://github.com/fearful-symmetry/garlic\" rel=\"nofollow noreferrer\">github.com/fearful-symmetry/garlic</a>"}], "tags": [], "owner": {"reputation": 534, "user_id": 3154591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba2e1954fb834c1720af3cf0f208858?s=128&d=identicon&r=PG", "display_name": "Peter Malmgren", "link": "https://stackoverflow.com/users/3154591/peter-malmgren"}, "is_accepted": false, "score": 3, "last_activity_date": 1487022807, "last_edit_date": 1487022807, "creation_date": 1486761321, "answer_id": 42168768, "question_id": 38153350, "link": "https://stackoverflow.com/questions/38153350/how-to-properly-wait-for-an-event-process-to-finish-not-being-the-parent/42168768#42168768", "title": "How to properly wait for an event/process to finish not being the parent?", "body": "<p>One solution would be to use the netlink proc connector, which is a socket the kernel uses to let userspace know about different process events. The <a href=\"https://www.kernel.org/doc/Documentation/connector/connector.txt\" rel=\"nofollow noreferrer\">official documentation</a> is somewhat lacking, although there are a couple of <a href=\"http://users.suse.com/~krahmer/exec-notify.c\" rel=\"nofollow noreferrer\">good examples</a> in C which are probably better to read.</p>\n\n<p>The main caveat to using the proc connector is the process must be run as root. If running your program as a non-root user is a requirement, you should consider other options, such as periodically polling <code>/proc</code> to watch for changes. Any approach which uses polling, as others have pointed out, is susceptible to a race condition if the process is terminated and another one is started with the same PID in between polls.</p>\n\n<p>Anyway, to use the proc connector in Go, we will have to do some translation from C. Specifically, we need to define the <code>proc_event</code> and <code>exit_proc_event</code> structs from <a href=\"https://github.com/torvalds/linux/blob/master/include/uapi/linux/cn_proc.h#L45\" rel=\"nofollow noreferrer\">cn_proc.h</a>, and the <code>cn_msg</code> and <code>cb_id</code> structs from <a href=\"https://github.com/torvalds/linux/blob/master/include/uapi/linux/connector.h\" rel=\"nofollow noreferrer\">connector.h</a>.</p>\n\n<pre><code>// CbID corresponds to cb_id in connector.h\ntype CbID struct {\n    Idx uint32\n    Val uint32\n}\n\n// CnMsg corresponds to cn_msg in connector.h\ntype CnMsg struct {\n    ID CbID\n    Seq uint32\n    Ack uint32\n    Len uint16\n    Flags uint16\n}\n\n// ProcEventHeader corresponds to proc_event in cn_proc.h\ntype ProcEventHeader struct {\n    What uint32\n    CPU uint32\n    Timestamp uint64\n}\n\n// ExitProcEvent corresponds to exit_proc_event in cn_proc.h\ntype ExitProcEvent struct {\n    ProcessPid uint32\n    ProcessTgid uint32\n    ExitCode uint32\n    ExitSignal uint32\n}\n</code></pre>\n\n<p>We also need to make a netlink socket and call bind.</p>\n\n<pre><code>sock, err := unix.Socket(unix.AF_NETLINK, unix.SOCK_DGRAM, unix.NETLINK_CONNECTOR)\n\nif err != nil {\n    fmt.Println(\"socket: %v\", err)\n    return\n}\n\naddr := &amp;unix.SockaddrNetlink{Family: unix.AF_NETLINK, Groups: C.CN_IDX_PROC, Pid: uint32(os.Getpid())}\nerr = unix.Bind(sock, addr)\n\nif err != nil {\n    fmt.Printf(\"bind: %v\\n\", err)\n    return\n}\n</code></pre>\n\n<p>Next, we have to send the <code>PROC_CN_MCAST_LISTEN</code> message to the kernel to let it know we want to receive events. We can import this directly from C, where it's defined as an enum, to save some typing, and put it in a function since we will have to call it again with <code>PROC_CN_MCAST_IGNORE</code> when we are done receiving data from the kernel.</p>\n\n<pre><code>// #include &lt;linux/cn_proc.h&gt;\n// #include &lt;linux/connector.h&gt;\nimport \"C\"\n\nfunc send(sock int, msg uint32) error {\n    destAddr := &amp;unix.SockaddrNetlink{Family: unix.AF_NETLINK, Groups: C.CN_IDX_PROC, Pid: 0} // the kernel\n    cnMsg := CnMsg{}\n    header := unix.NlMsghdr{\n        Len: unix.NLMSG_HDRLEN + uint32(binary.Size(cnMsg) + binary.Size(msg)),\n        Type: uint16(unix.NLMSG_DONE),\n        Flags: 0,\n        Seq: 1,\n        Pid: uint32(unix.Getpid()),\n    }\n    msg.ID = CbID{Idx: C.CN_IDX_PROC, Val: C.CN_VAL_PROC}\n    msg.Len = uint16(binary.Size(msg))\n    msg.Ack = 0\n    msg.Seq = 1\n    buf := bytes.NewBuffer(make([]byte, 0, header.Len))\n    binary.Write(buf, binary.LittleEndian, header)\n    binary.Write(buf, binary.LittleEndian, cnMsg)\n    binary.Write(buf, binary.LittleEndian, msg)\n\n    return unix.Sendto(sock, buf.Bytes(), 0, destAddr)\n}\n</code></pre>\n\n<p>After we let the kernel know we're ready to receive events, we can receive them on the socket we're created. Once we receive them, we need to parse them, and check for relevant data. We only care about messages that meet the following criteria:</p>\n\n<ul>\n<li>Come from the kernel</li>\n<li>Have a header type of <code>NLMSG_DONE</code></li>\n<li>Have a <code>proc_event_header.what</code> value of <code>PROC_EVENT_EXIT</code></li>\n<li>Match our PID</li>\n</ul>\n\n<p>If they meet these criteria, we can extract the relevant process information into a <code>proc_event_exit</code> struct, which contains the PID of the process.</p>\n\n<pre><code>for {\n    p := make([]byte, 1024)\n    nr, from, err := unix.Recvfrom(sock, p, 0)\n\n    if sockaddrNl, ok := from.(*unix.SockaddrNetlink); !ok || sockaddrNl.Pid != 0 {\n        continue\n    }\n\n    if err != nil {\n        fmt.Printf(\"Recvfrom: %v\\n\", err)\n        continue\n    }\n\n    if nr &lt; unix.NLMSG_HDRLEN {\n        continue\n    }\n\n    // the sys/unix package doesn't include the ParseNetlinkMessage function\n    nlmessages, err := syscall.ParseNetlinkMessage(p[:nr])\n\n    if err != nil {\n        fmt.Printf(\"ParseNetlinkMessage: %v\\n\", err)\n        continue\n    }\n\n    for _, m := range(nlmessages) {\n        if m.Header.Type == unix.NLMSG_DONE {\n            buf := bytes.NewBuffer(m.Data)\n            msg := &amp;CnMsg{}\n            hdr := &amp;ProcEventHeader{}\n            binary.Read(buf, binary.LittleEndian, msg)\n            binary.Read(buf, binary.LittleEndian, hdr)\n\n            if hdr.What == C.PROC_EVENT_EXIT {\n                event := &amp;ExitProcEvent{}\n                binary.Read(buf, binary.LittleEndian, event)\n                pid := int(event.ProcessTgid)\n                fmt.Printf(\"%d just exited.\\n\", pid)\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>A full code example is <a href=\"https://gist.github.com/pmalmgren/e3498ee4e137a11f2db9330b191afa9f\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1036, "favorite_count": 1, "answer_count": 1, "score": 10, "last_activity_date": 1489595282, "creation_date": 1467404301, "last_edit_date": 1489595282, "question_id": 38153350, "link": "https://stackoverflow.com/questions/38153350/how-to-properly-wait-for-an-event-process-to-finish-not-being-the-parent", "title": "How to properly wait for an event/process to finish not being the parent?", "body": "<p>I am using <a href=\"http://golang.org\" rel=\"noreferrer\">GO</a> to check if a process (not been parent) has ben terminated, basically something like the <a href=\"https://www.freebsd.org/cgi/man.cgi?pwait\" rel=\"noreferrer\">pwait</a> command in <a href=\"http://www.freebsd.org\" rel=\"noreferrer\">FreeBSD</a> but written in go.</p>\n\n<p>Currently I am trying a <code>for loop</code> with a <code>kill -0</code>, but I notice that the CPU usage is very high <strong>99%</strong> with this approach, here is the code:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"syscall\"\n    \"time\"\n)\n\nfunc main() {\n\n    if len(os.Args) != 2 {\n        fmt.Printf(\"usage: %s pid\", os.Args[0])\n        os.Exit(1)\n    }\n\n    pid, err := strconv.ParseInt(os.Args[1], 10, 64)\n    if err != nil {\n        panic(err)\n    }\n\n    process, err := os.FindProcess(int(pid))\n\n    err = process.Signal(syscall.Signal(0))\n    for err == nil {\n        err = process.Signal(syscall.Signal(0))\n        time.Sleep(500 * time.Millisecond) \n    }\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>Any idea of how to improve or properly implement this.</p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Adding a <code>sleep</code> within the loop like suggested, helps reducing the load. </p>\n\n<p>From the provided links, seems to be possible to attach to the existing pid, I will give a try <a href=\"https://golang.org/pkg/syscall/#PtraceAttach\" rel=\"noreferrer\">PtraceAttach</a> but don't know if this may have side effects, any idea?</p>\n\n<p>As suggested I was available to use <a href=\"http://www.freebsd.org/cgi/man.cgi?kqueue\" rel=\"noreferrer\">kqueue</a>:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"strconv\"\n    \"syscall\"\n)\n\nfunc main() {\n    if len(os.Args) != 2 {\n        fmt.Printf(\"usage: %s pid\", os.Args[0])\n        os.Exit(1)\n    }\n\n    pid, err := strconv.ParseInt(os.Args[1], 10, 64)\n    if err != nil {\n        panic(err)\n    }\n\n    process, _ := os.FindProcess(int(pid))\n\n    kq, err := syscall.Kqueue()\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    ev1 := syscall.Kevent_t{\n        Ident:  uint64(process.Pid),\n        Filter: syscall.EVFILT_PROC,\n        Flags:  syscall.EV_ADD,\n        Fflags: syscall.NOTE_EXIT,\n        Data:   0,\n        Udata:  nil,\n    }\n\n    for {\n        events := make([]syscall.Kevent_t, 1)\n        n, err := syscall.Kevent(kq, []syscall.Kevent_t{ev1}, events, nil)\n        if err != nil {\n            log.Println(\"Error creating kevent\")\n        }\n        if n &gt; 0 {\n            break\n        }\n    }\n\n    fmt.Println(\"fin\")\n}\n</code></pre>\n\n<p>Works fine, but wondering how to implement/achieve the same on linux since I think <code>kqueue</code> not available on it, any ideas ?</p>\n"}, {"tags": ["go", "oauth2"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1467393866, "last_edit_date": 1592644375, "creation_date": 1467393866, "answer_id": 38150943, "question_id": 38150891, "link": "https://stackoverflow.com/questions/38150891/how-to-pass-custom-client-to-golang-oauth2-exchange/38150943#38150943", "title": "How to pass custom client to Golang oauth2.Exchange", "body": "<p>The <code>oauth2</code> package defines <a href=\"https://godoc.org/golang.org/x/oauth2#pkg-variables\" rel=\"nofollow noreferrer\">the following variable</a>:</p>\n<blockquote>\n<pre><code>var HTTPClient internal.ContextKey\n</code></pre>\n<p>HTTPClient is the context key to use with golang.org/x/net/context's WithValue function to associate an *http.Client value with a context.</p>\n</blockquote>\n<p>Use the above variable as the context key when constructing the context to pass to <a href=\"https://godoc.org/golang.org/x/oauth2#Config.Exchange\" rel=\"nofollow noreferrer\"><code>Exchange</code></a>:</p>\n<pre><code>client := &amp;http.Client{\n    // TODO\n}\nparent := oauth2.NoContext()\nctx := context.WithValue(parent, oauth2.HTTPClient, client)\ntkn, err := c.Exchange(ctx, code)\n</code></pre>\n"}], "owner": {"reputation": 8717, "user_id": 73249, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aa58ce9763beb48289b05c19f716bcd8?s=128&d=identicon&r=PG", "display_name": "Sahas", "link": "https://stackoverflow.com/users/73249/sahas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 2, "accepted_answer_id": 38150943, "answer_count": 1, "score": 0, "last_activity_date": 1467647912, "creation_date": 1467393686, "last_edit_date": 1467647912, "question_id": 38150891, "link": "https://stackoverflow.com/questions/38150891/how-to-pass-custom-client-to-golang-oauth2-exchange", "title": "How to pass custom client to Golang oauth2.Exchange", "body": "<p>The documentation for oauth2.Exchange at <a href=\"https://godoc.org/golang.org/x/oauth2#Config.Exchange\" rel=\"nofollow\">https://godoc.org/golang.org/x/oauth2#Config.Exchange</a> says:</p>\n\n<blockquote>\n  <p>The HTTP client to use is derived from the context. If a client is not provided via the context, http.DefaultClient is used. </p>\n</blockquote>\n\n<p>Now I have created a http.Client with my own settings.  How do I get the oauth2.Exchange function to use it?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1467386727, "last_edit_date": 1467386727, "creation_date": 1467386127, "answer_id": 38148825, "question_id": 38148657, "link": "https://stackoverflow.com/questions/38148657/need-to-construct-interface-pointer-using-reflect-in-golang-not-working/38148825#38148825", "title": "Need to construct interface/pointer using Reflect in Golang, not working", "body": "<p>The library is complaining because the application is passing a <code>*interface{}</code> to the method. The value <code>fetchFromDatabase</code> is a pointer to a struct. Pass this value directly to the method:</p>\n\n<pre><code>var house model.House\nfetchFromDatabase := reflect.New(reflect.TypeOf(house)).Interface()\nerr = db.First(fetchFromDatabase).Error\n</code></pre>\n"}], "owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 1, "accepted_answer_id": 38148825, "answer_count": 1, "score": 1, "last_activity_date": 1467386727, "creation_date": 1467385528, "question_id": 38148657, "link": "https://stackoverflow.com/questions/38148657/need-to-construct-interface-pointer-using-reflect-in-golang-not-working", "title": "Need to construct interface/pointer using Reflect in Golang, not working", "body": "<p>So, this works:</p>\n\n<pre><code>house := model.House {};\nerr = db.First(&amp;house).Error;\n</code></pre>\n\n<p>However, this doesn't work:</p>\n\n<pre><code>var house model.House;\n\nfetchFromDatabase := reflect.New(reflect.TypeOf(house)).Interface();\nerr = db.First(&amp;fetchFromDatabase).Error;\n</code></pre>\n\n<p>... <strong>The database library gives the error:</strong></p>\n\n<blockquote>\n  <p>unsupported destination, should be slice or struct</p>\n</blockquote>\n\n<p>To me, that should be a struct, considering the \"House\" type is a struct. However, I'm still wrapping my head around <code>Reflect</code> ... can anyone help?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1467384667, "post_id": 38147942, "comment_id": 63726372, "body": "This is expected behaviour; <code>tar</code>ed directories don&#39;t have sizes."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467384880, "post_id": 38147942, "comment_id": 63726506, "body": "@steve The directories in your filesystem have a size, but I don&#39;t think it&#39;s what you expect; it&#39;s only the size of the all the file entries, not the size of the files. In a tar file they don&#39;t contain a directory listing, and have no size."}, {"owner": {"reputation": 113, "user_id": 6406168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28dd9fe5587c7b329b09858e1baf498f?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/6406168/steve"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467393975, "post_id": 38147942, "comment_id": 63731392, "body": "@JimB playing around on a shell, there is some notion of space that the directory takes up, usually it is 4096 Bytes on Linux machines. Can a tar not know this kind of information?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467394323, "post_id": 38147942, "comment_id": 63731581, "body": "@steve: that&#39;s irrelevant to tar, because that space is taken up by filesystem specific data to store the directory contents. Conceptually directories take no space at all, and that is how tar represents them."}], "owner": {"reputation": 113, "user_id": 6406168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28dd9fe5587c7b329b09858e1baf498f?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/6406168/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467383262, "creation_date": 1467383262, "question_id": 38147942, "link": "https://stackoverflow.com/questions/38147942/tar-archive-header-not-storing-size-of-directory", "title": "Tar archive header not storing size of directory?", "body": "<p>How does <code>tar -cf</code> store information about the size of a directory that it archives? I'm able to read headers for actual <strong>files</strong> but when I come across a header that represents metadata for a <strong>directory</strong>, I'm seeing that the size of the directory is 0...</p>\n\n<p>Perhaps I am just streaming the tar archive incorrectly? However, I don't see how likely that is since I am able to get information from regular files fine.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1467392683, "post_id": 38147961, "comment_id": 63730776, "body": "I&#39;m afraid this is a case of the <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>. What problem are you trying to solve? Is this about printing UTF-8 strings on the console or running a program with complex set of command-line arguments? I&#39;m asking because you present a contrived example without clear (to me) goals and a moot question, so while I know something about both Go and the WIndows console, and running other programs from Go, I have no idea what <i>problem</i> to actually address. Please be more clear."}, {"owner": {"reputation": 91, "user_id": 5495293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jw2c7.png?s=128&g=1", "display_name": "qing6010", "link": "https://stackoverflow.com/users/5495293/qing6010"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1467438047, "post_id": 38147961, "comment_id": 63742677, "body": "Thanks. It seems like so. I want to run cmd6 but with failures. Then I broke down to test simpler cmd1 ~  cmd5 and found cmd2~cmd5 did not work either. Forgive me if they were not the same problem. My ultimate target is to get any dos console run flawlessly (same input lead to the same output or action between dos and go), which needs all of cmd1~ cmd6 should run right just like dos console."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5495293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jw2c7.png?s=128&g=1", "display_name": "qing6010", "link": "https://stackoverflow.com/users/5495293/qing6010"}, "edited": false, "score": 0, "creation_date": 1467438340, "post_id": 38149784, "comment_id": 63742726, "body": "Hi thanks. I run this on my Linux they are all right. But in windows there seems no output after each &quot;=&gt;&quot;. I am running windows 10.0.10586. Did you pass it through in windows?"}, {"owner": {"reputation": 824, "user_id": 4412661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aXJT6.jpg?s=128&g=1", "display_name": "Steve C", "link": "https://stackoverflow.com/users/4412661/steve-c"}, "reply_to_user": {"reputation": 91, "user_id": 5495293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jw2c7.png?s=128&g=1", "display_name": "qing6010", "link": "https://stackoverflow.com/users/5495293/qing6010"}, "edited": false, "score": 0, "creation_date": 1467438677, "post_id": 38149784, "comment_id": 63742792, "body": "I ran them on Mac."}], "tags": [], "owner": {"reputation": 824, "user_id": 4412661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aXJT6.jpg?s=128&g=1", "display_name": "Steve C", "link": "https://stackoverflow.com/users/4412661/steve-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1467389313, "creation_date": 1467389313, "answer_id": 38149784, "question_id": 38147961, "link": "https://stackoverflow.com/questions/38147961/golang-how-to-use-double-quotes-properly/38149784#38149784", "title": "golang how to use double quotes properly?", "body": "<p>What about directly using echo?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd1 := \"abc def\"\n    cmd2 := \"abc\\\"edf\"\n    cmd3 := `abc\"edf`\n    cmd4 := `abc\\\"edf`\n    cmd5 := \"abc\ud83d\ude0aedf\u4f60\u597d\"\n    cmd6 := \"abc &amp; echo def\"\n    fo(cmd1)\n    fo(cmd2)\n    fo(cmd3)\n    fo(cmd4)\n    fo(cmd5)\n    fo(cmd6)\n}\n\nfunc fo(command string) {\n    cmd := exec.Command(\"echo\", command)\n    out, _ := cmd.Output()\n    fmt.Printf(\"%s =&gt; %s\\n\", command, string(out))\n}\n</code></pre>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1447786122, "open_beta_date": 1340134756, "closed_beta_date": 1339527600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/raspberrypi/Img/apple-touch-icon@2.png", "twitter_account": "StackRaspi", "favicon_url": "https://cdn.sstatic.net/Sites/raspberrypi/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/raspberrypi/Img/apple-touch-icon.png", "audience": "users and developers of hardware and software for Raspberry Pi", "site_url": "https://raspberrypi.stackexchange.com", "api_site_parameter": "raspberrypi", "logo_url": "https://cdn.sstatic.net/Sites/raspberrypi/Img/logo.png", "name": "Raspberry Pi", "site_type": "main_site"}, "on_date": 1467383297, "question_id": 50629}, "owner": {"reputation": 91, "user_id": 5495293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jw2c7.png?s=128&g=1", "display_name": "qing6010", "link": "https://stackoverflow.com/users/5495293/qing6010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1125, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1467389313, "creation_date": 1467379083, "question_id": 38147961, "link": "https://stackoverflow.com/questions/38147961/golang-how-to-use-double-quotes-properly", "title": "golang how to use double quotes properly?", "body": "<p>In windows cmd console, when I use the echo command:</p>\n\n<pre><code>echo abc     //get: abc\necho \"abc    //get: \"abc \necho \"abc\"   //get: \"abc\"\n</code></pre>\n\n<p>Then I want to run it in go language using the exec package</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd1 := \"echo abc def\"\n    cmd2 := \"echo abc\\\"edf\"\n    cmd3 := `echo abc\"edf`\n    cmd4 := `echo abc\\\"edf`\n    cmd5 := \"echo abc\ud83d\ude0aedf\u4f60\u597d\"\n    fo(cmd1)\n    fo(cmd2)\n    fo(cmd3)\n    fo(cmd4)\n    fo(cmd5)\n}\n\nfunc fo(command string) {\n    cmd := exec.Command(\"cmd\", \"/C\", command)\n    out, _ := cmd.Output()\n    fmt.Printf(\"%s =&gt; %s\\n\", command, string(out))\n}\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>echo abc def =&gt; abc def\necho abc\"edf =&gt; abc\\\"edf\necho abc\"edf =&gt; abc\\\"edf\necho abc\\\"edf =&gt; abc\\\\\\\"edf\necho abc\ud83d\ude0aedf\u4f60\u597d =&gt; abc??edf\ufffd\ufffd\ufffd\ufffd\n</code></pre>\n\n<p>As you can see none of them (except cmd1) is right. Also utf-8 is not showing properly. I do not want the back slash in output (I think the problem is actually in input not output, see below)</p>\n\n<p>I cannot simply do something on the result (i.e. remove back slash from result), because it does not work for complex situations. For example, I want to run </p>\n\n<pre><code>cmd /c start \"echo abc &amp; echo def\"\n</code></pre>\n\n<p>I cannot remove double quotes, otherwise the latter part will run in current window, not the start window. Then in go, below codes does not work:</p>\n\n<pre><code>cmd6 := \"cmd /c start \\\"echo abc &amp; echo def\\\"\"\nfo(cmd6)\n</code></pre>\n\n<p>How to make it work in golang?</p>\n"}, {"tags": ["json", "go", "special-characters", "stringify"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1467378575, "post_id": 38146210, "comment_id": 63722068, "body": "That is preserved, just escaped to prevent problems with various clients. This is valid for JSON."}, {"owner": {"reputation": 614, "user_id": 1985957, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/9f0f12529e549a7bcd9392d664060abc?s=128&d=identicon&r=PG", "display_name": "theGamblerRises", "link": "https://stackoverflow.com/users/1985957/thegamblerrises"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467378713, "post_id": 38146210, "comment_id": 63722153, "body": "I am trying to get hmac value out of it and sending it over network. Other party throws the exception that hmac doesn&#39;t match with body."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467379269, "post_id": 38146210, "comment_id": 63722572, "body": "Each side needs to check the hmac the data that&#39;s sent, not the unencoded data, precisely because of isomorphic changes like this, not to mention possible security issues. However if the remote party isn&#39;t doing it right, you will just have to find and replace the escaped strings."}, {"owner": {"reputation": 614, "user_id": 1985957, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/9f0f12529e549a7bcd9392d664060abc?s=128&d=identicon&r=PG", "display_name": "theGamblerRises", "link": "https://stackoverflow.com/users/1985957/thegamblerrises"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467381617, "post_id": 38146210, "comment_id": 63724284, "body": "Could you please tell me how to do that? Finding and replacing escaped strings? I won&#39;t be knowing what special character I might encounter next."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1467383611, "post_id": 38147973, "comment_id": 63725658, "body": "I&#39;d rather use <a href=\"https://golang.org/pkg/strconv/#Unquote\" rel=\"nofollow noreferrer\"><code>strconv.Unquote()</code></a> like <a href=\"https://play.golang.org/p/oNqqdb1kDB\" rel=\"nofollow noreferrer\">this</a>. See <a href=\"http://stackoverflow.com/a/36529158/720999\">this answer</a> for more info."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1467384003, "post_id": 38147973, "comment_id": 63725931, "body": "@kostix: thanks, I new I was forgetting another method for that."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1467384151, "last_edit_date": 1495539856, "creation_date": 1467383354, "answer_id": 38147973, "question_id": 38146210, "link": "https://stackoverflow.com/questions/38146210/how-to-prevent-escaping-certain-characters-in-strings-produced-by-json-encoder/38147973#38147973", "title": "How to prevent escaping certain characters in strings produced by JSON encoder?", "body": "<p>The <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\"><code>encoding/json</code> docs</a> show the characters that are escaped by default are <code>&lt;</code>, <code>&gt;</code>, and <code>&amp;</code>. </p>\n\n<p>You can use <a href=\"https://golang.org/pkg/strconv/#Unquote\" rel=\"nofollow noreferrer\"><code>strconv.Unquote</code></a> like in this answer: <a href=\"https://stackoverflow.com/questions/36528575/how-to-convert-escape-characters-in-html-tags/36529158#36529158\">How to convert escape characters in HTML tags?</a></p>\n\n<p>Something straightforward like this would work too:</p>\n\n<pre><code>bty3 = bytes.Replace(bty3, []byte(`\\u003c`), []byte(\"&lt;\"), -1)\nbty3 = bytes.Replace(bty3, []byte(`\\u003e`), []byte(\"&gt;\"), -1)\nbty3 = bytes.Replace(bty3, []byte(`\\u0026`), []byte(\"&amp;\"), -1)\n</code></pre>\n\n<p>In the upcoming Go1.7 release, you can turn off the escaping in a <code>json.Encoder</code> with <code>SetEscapeHTML(false)</code>.</p>\n\n<pre><code>mp := map[string]string{\"key\": \"The Knight &amp; Day\"}\nvar buf bytes.Buffer\n\nenc := json.NewEncoder(&amp;buf)\nenc.SetEscapeHTML(false)\nenc.Encode(mp)\n\nfmt.Println(&amp;buf)\n</code></pre>\n\n<p>Which prints</p>\n\n<pre><code>{\"key\":\"The Knight &amp; Day\"}\n</code></pre>\n"}], "owner": {"reputation": 614, "user_id": 1985957, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/9f0f12529e549a7bcd9392d664060abc?s=128&d=identicon&r=PG", "display_name": "theGamblerRises", "link": "https://stackoverflow.com/users/1985957/thegamblerrises"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1936, "favorite_count": 0, "accepted_answer_id": 38147973, "answer_count": 1, "score": -1, "last_activity_date": 1467384151, "creation_date": 1467378324, "last_edit_date": 1467383717, "question_id": 38146210, "link": "https://stackoverflow.com/questions/38146210/how-to-prevent-escaping-certain-characters-in-strings-produced-by-json-encoder", "title": "How to prevent escaping certain characters in strings produced by JSON encoder?", "body": "<p>I have a map to save json entries. Here is a preview from my code.</p>\n\n<pre><code>mp := map[string]string{\"key\": \"The Knight &amp; Day\"}\nfmt.Println(mp)\nbty3, err := json.Marshal(mp)\nfmt.Println(bty3, err)\nfmt.Println(string(bty3))\n</code></pre>\n\n<p>The output is following-</p>\n\n<pre><code>map[key:The Knight &amp; Day]\n[123 34 107 101 121 34 58 34 84 104 101 32 75 110 105 103 104 116 32 92 117 48 48 50 54 32 68 97 121 34 125] &lt;nil&gt;\n{\"key\":\"The Knight \\u0026 Day\"}\n</code></pre>\n\n<p>What can I do in order to preserve special characters?</p>\n"}, {"tags": ["html", "go"], "answers": [{"comments": [{"owner": {"reputation": 1229, "user_id": 6336858, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ebcd58007a9088efe7c1605069558559?s=128&d=identicon&r=PG&f=1", "display_name": "omgj", "link": "https://stackoverflow.com/users/6336858/omgj"}, "edited": false, "score": 0, "creation_date": 1467426714, "post_id": 38146229, "comment_id": 63740975, "body": "interesting, trouble is with multiple values. I try $val.FIELD"}], "tags": [], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "is_accepted": false, "score": 1, "last_activity_date": 1467378388, "creation_date": 1467378388, "answer_id": 38146229, "question_id": 38145952, "link": "https://stackoverflow.com/questions/38145952/golang-html-templates-index/38146229#38146229", "title": "Golang html templates index", "body": "<p>I guess following will work</p>\n\n<pre><code>{{ range $key, $val := . }}\n&lt;strong&gt;{{ $key }}&lt;/strong&gt;: {{ $val }}\n{{ end }}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1229, "user_id": 6336858, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ebcd58007a9088efe7c1605069558559?s=128&d=identicon&r=PG&f=1", "display_name": "omgj", "link": "https://stackoverflow.com/users/6336858/omgj"}, "edited": false, "score": 0, "creation_date": 1467426717, "post_id": 38147918, "comment_id": 63740976, "body": "interesting, trouble is with multiple values. I try $val.FIELD"}, {"owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "reply_to_user": {"reputation": 1229, "user_id": 6336858, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ebcd58007a9088efe7c1605069558559?s=128&d=identicon&r=PG&f=1", "display_name": "omgj", "link": "https://stackoverflow.com/users/6336858/omgj"}, "edited": false, "score": 0, "creation_date": 1467596618, "post_id": 38147918, "comment_id": 63779067, "body": "i dont understand your mean. In my example, $articles is a list of article. and {{$article.Title}} print the value of &quot;Title&quot; field.."}], "tags": [], "owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "is_accepted": true, "score": 1, "last_activity_date": 1467383199, "creation_date": 1467383199, "answer_id": 38147918, "question_id": 38145952, "link": "https://stackoverflow.com/questions/38145952/golang-html-templates-index/38147918#38147918", "title": "Golang html templates index", "body": "<p>Here my example. Wish it help you</p>\n\n<pre><code> {{ range $index,$article := $articles }}\n\n    &lt;a href=\"/articles/{{ $article.Id }}\" class=\"list-group-item\"&gt;\n      &lt;p class=\"list-group-item-text\"&gt;{{ $index }}&lt;/p&gt;  // index here start with 0\n      &lt;h4 class=\"list-group-item-heading\"&gt;{{ $article.Title }}&lt;/h4&gt;\n      &lt;p class=\"list-group-item-text\"&gt;{{ $article.Body }}&lt;/p&gt;\n      &lt;p class=\"list-group-item-text\"&gt;{{ .FormatDate $article.CreatedOn }}&lt;/p&gt;\n\n    &lt;/a&gt;\n  {{ end }}\n</code></pre>\n"}], "owner": {"reputation": 1229, "user_id": 6336858, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ebcd58007a9088efe7c1605069558559?s=128&d=identicon&r=PG&f=1", "display_name": "omgj", "link": "https://stackoverflow.com/users/6336858/omgj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 38147918, "answer_count": 2, "score": 0, "last_activity_date": 1467383199, "creation_date": 1467377553, "question_id": 38145952, "link": "https://stackoverflow.com/questions/38145952/golang-html-templates-index", "title": "Golang html templates index", "body": "<p>When I range over a slice with {{range}} I can instantiate many elements each with data pipeline. But I cannot see how to find the index of each element in the range. With go we can:</p>\n\n<pre><code>for i, _ := range x {}\n</code></pre>\n\n<p>can we do something similar with templates?</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 4, "creation_date": 1467371957, "post_id": 38144050, "comment_id": 63717730, "body": "Go is not javascript! Read the basics: <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html</a>"}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 6, "creation_date": 1467372248, "post_id": 38144050, "comment_id": 63717923, "body": "More things - first - array is not a slice. Array is type, that has fixed number of elements, therefore question makes sense only for slice. Second - it won&#39;t work, if you initialize those slices. Third - and what about if len(a) == 0?"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1467378994, "post_id": 38144050, "comment_id": 63722355, "body": "Does your workaround compile? I can&#39;t see how it would unless <code>r</code> is also of type <code>[0]int</code> but in that case the two (empty) arrays would always compare equal."}, {"owner": {"reputation": 15751, "user_id": 1345655, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2f01aca0b4d2d9347a6fd0f16f24d084?s=128&d=identicon&r=PG", "display_name": "Kshitiz Sharma", "link": "https://stackoverflow.com/users/1345655/kshitiz-sharma"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1467558214, "post_id": 38144050, "comment_id": 63769476, "body": "@PaulHankin Yes it does work. The return type of the function is int[]"}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 4584004, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/78b84adfa9c7b4f87fff834b97e6f0a8?s=128&d=identicon&r=PG&f=1", "display_name": "nawazish-stackoverflow", "link": "https://stackoverflow.com/users/4584004/nawazish-stackoverflow"}, "edited": false, "score": 3, "creation_date": 1539850339, "post_id": 38144180, "comment_id": 92652901, "body": "The problem with this approach is that a slice which is just declared, like, <code>var num []int</code>, also returns the len to be zero. i.e, <code>len(num) == 0</code>"}, {"owner": {"reputation": 145, "user_id": 10237506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9888f19e5b9fa62a6a8b21a067edceb?s=128&d=identicon&r=PG&f=1", "display_name": "rv.kvetch", "link": "https://stackoverflow.com/users/10237506/rv-kvetch"}, "reply_to_user": {"reputation": 183, "user_id": 4584004, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/78b84adfa9c7b4f87fff834b97e6f0a8?s=128&d=identicon&r=PG&f=1", "display_name": "nawazish-stackoverflow", "link": "https://stackoverflow.com/users/4584004/nawazish-stackoverflow"}, "edited": false, "score": 0, "creation_date": 1616882411, "post_id": 38144180, "comment_id": 118143889, "body": "@nawaz yes but that\u2019s expected is it not? Even in case var num []int = nil then len(num) returns 0. This is just perfect imo. This way I don\u2019t need to do a nil check beforehand. If I do need to check for nil I can just add that explicitly. But again to the point of uninitaliazed var, agree it should be 0. since len can only return an int then this makes perfect sense. A len return val of -1 would be very confusing to see imo."}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": true, "score": 108, "last_activity_date": 1467372156, "creation_date": 1467372156, "answer_id": 38144180, "question_id": 38144050, "link": "https://stackoverflow.com/questions/38144050/how-do-i-check-for-an-empty-slice/38144180#38144180", "title": "How do I check for an empty slice?", "body": "<p><a href=\"https://golang.org/pkg/builtin/#len\" rel=\"noreferrer\"><code>len()</code></a> returns the number of elements in a slice or array.</p>\n\n<p>Assuming <code>whatever()</code> is the function you invoke, you can do something like:</p>\n\n<pre><code>r := whatever()\nif len(r) &gt; 0 {\n  // do what you want\n}\n</code></pre>\n\n<p>or if you don't need the items</p>\n\n<pre><code>if len(whatever()) &gt; 0 {\n  // do what you want\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 13, "last_activity_date": 1467372621, "creation_date": 1467372621, "answer_id": 38144340, "question_id": 38144050, "link": "https://stackoverflow.com/questions/38144050/how-do-i-check-for-an-empty-slice/38144340#38144340", "title": "How do I check for an empty slice?", "body": "<p>You can just use the <code>len</code> function.</p>\n\n<pre><code>if len(r) == 0 {\n    fmt.Println(\"No return value\")            \n}\n</code></pre>\n\n<p>Although since you are using arrays, an array of type <code>[0]int</code> (an array of int with size 0) is different than <code>[n]int</code> (n array of int with size n) and are not compatible with each other.</p>\n\n<p>If you have a function that returns arrays with different lengths, consider using slices, because function can only be declared with an array return type having a specific length (e.g. <code>func f() [n]int</code>, <code>n</code> is a constant) and that array will have n values in it (they'll be zeroed) even if the function never writes anything to that array.</p>\n"}, {"tags": [], "owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "is_accepted": false, "score": 4, "last_activity_date": 1538136574, "creation_date": 1538136574, "answer_id": 52555020, "question_id": 38144050, "link": "https://stackoverflow.com/questions/38144050/how-do-i-check-for-an-empty-slice/52555020#52555020", "title": "How do I check for an empty slice?", "body": "<p>You can use the inbuilt function provided by Golang </p>\n\n<blockquote>\n  <p>len()</p>\n</blockquote>\n\n<p>It will helps you to easily find a slice is empty or not.</p>\n\n<pre><code>if len( yourFunction() ) == 0 {\n    // It implies that your array is empty.\n}\n</code></pre>\n"}], "owner": {"reputation": 15751, "user_id": 1345655, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2f01aca0b4d2d9347a6fd0f16f24d084?s=128&d=identicon&r=PG", "display_name": "Kshitiz Sharma", "link": "https://stackoverflow.com/users/1345655/kshitiz-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92154, "favorite_count": 5, "accepted_answer_id": 38144180, "answer_count": 3, "score": 80, "last_activity_date": 1538136574, "creation_date": 1467371802, "last_edit_date": 1467377999, "question_id": 38144050, "link": "https://stackoverflow.com/questions/38144050/how-do-i-check-for-an-empty-slice", "title": "How do I check for an empty slice?", "body": "<p>I am calling a function that returns an empty array if there are no values.</p>\n\n<p>When I do this it doesn't work:</p>\n\n<pre><code>if r == [] {\n    fmt.Println(\"No return value\")            \n}\n</code></pre>\n\n<p>The work around I'm using is:</p>\n\n<pre><code>var a [0]int\nif r == a {\n    fmt.Println(\"No return value\")            \n}\n</code></pre>\n\n<p>But declaring a variable just to check the return value doesn't seem right. What's the better way to do this?</p>\n"}, {"tags": ["go", "arm", "kubernetes", "cgo"], "comments": [{"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1467360429, "post_id": 38140146, "comment_id": 63710535, "body": "What&#39;s your cross-toolchain for arm64 targets, because it notably doesn&#39;t appear in that list of things providing the relevant header?"}, {"owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "reply_to_user": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1467360815, "post_id": 38140146, "comment_id": 63710737, "body": "@Notlikethat edited the quesiton."}, {"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1467364728, "post_id": 38140146, "comment_id": 63713044, "body": "Ah, I should have clarified; the relevant target triplet would be aarch64-*-linux-gnu. I had a quick look at the Fedora package database and couldn&#39;t find anything (although it&#39;s a target they build the distro for; strange...), so it could be that you&#39;re missing an appropriate toolchain entirely (I can&#39;t really tell from the output here as I know nothing about Go or the thing you&#39;re trying to build). If you can&#39;t find a suitable package then a generic binary release e.g. from <a href=\"http://www.linaro.org/downloads/\" rel=\"nofollow noreferrer\">Linaro</a> should be OK."}], "owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467360798, "creation_date": 1467360103, "last_edit_date": 1467360798, "question_id": 38140146, "link": "https://stackoverflow.com/questions/38140146/go-error-while-cross-compiling-kubernetes", "title": "Go error while cross compiling Kubernetes", "body": "<p>I have been trying to cross-compile K8s running ./hack/build-cross.sh. I am getting this error, while building targets for arm64:</p>\n\n<pre><code>Go version: go version go1.6.2 linux/amd64\n+++ [0701 13:27:22] Building the toolchain targets:\n    k8s.io/kubernetes/hack/cmd/teststale\n+++ [0701 13:27:22] Building go targets for linux/arm64:\n    cmd/kube-dns\n    cmd/kube-proxy\n    cmd/kube-apiserver\n    cmd/kube-controller-manager\n    cmd/kubelet\n    cmd/kubemark\n    cmd/hyperkube\n    federation/cmd/federation-apiserver\n    federation/cmd/federation-controller-manager\n    plugin/cmd/kube-scheduler\n# runtime/cgo\n/usr/local/go/src/runtime/cgo/cgo.go:54:19: fatal error: errno.h: No such file or directory\ncompilation terminated.\n!!! Error in /home/peeyush/work/kubernetes/hack/lib/golang.sh:500\n  'go install \"${goflags[@]:+${goflags[@]}}\" -ldflags \"${goldflags}\" \"${nonstatics[@]:+${nonstatics[@]}}\"' exited with status 2\nCall stack:\n  1: /home/peeyush/work/kubernetes/hack/lib/golang.sh:500 kube::golang::build_binaries_for_platform(...)\n  2: /home/peeyush/work/kubernetes/hack/lib/golang.sh:669 kube::golang::build_binaries(...)\n  3: ./hack/build-cross.sh:28 main(...)\nExiting with status 1\n!!! Error in /home/peeyush/work/kubernetes/hack/lib/golang.sh:586\n  '( kube::golang::setup_env; echo \"Go version: $(go version)\"; local host_platform; host_platform=$(kube::golang::host_platform); local goflags goldflags; eval \"goflags=(${KUBE_GOFLAGS:-})\"; goldflags=\"${KUBE_GOLDFLAGS:-} $(kube::version::ldflags)\"; local use_go_build; local -a targets=(); local arg; for arg in \"$@\";\ndo\n    if [[ \"${arg}\" == \"--use_go_build\" ]]; then\n        use_go_build=true;\n    else\n        if [[ \"${arg}\" == -* ]]; then\n            goflags+=(\"${arg}\");\n        else\n            targets+=(\"${arg}\");\n        fi;\n    fi;\ndone; if [[ ${#targets[@]} -eq 0 ]]; then\n    targets=(\"${KUBE_ALL_TARGETS[@]}\");\nfi; local -a platforms=(\"${KUBE_BUILD_PLATFORMS[@]:+${KUBE_BUILD_PLATFORMS[@]}}\"); if [[ ${#platforms[@]} -eq 0 ]]; then\n    platforms=(\"${host_platform}\");\nfi; local binaries; binaries=($(kube::golang::binaries_from_targets \"${targets[@]}\")); local parallel=false; if [[ ${#platforms[@]} -gt 1 ]]; then\n    local gigs; gigs=$(kube::golang::get_physmem); if [[ ${gigs} -ge ${KUBE_PARALLEL_BUILD_MEMORY} ]]; then\n        kube::log::status \"Multiple platforms requested and available ${gigs}G &gt;= threshold ${KUBE_PARALLEL_BUILD_MEMORY}G, building platforms in parallel\"; parallel=true;\n    else\n        kube::log::status \"Multiple platforms requested, but available ${gigs}G &lt; threshold ${KUBE_PARALLEL_BUILD_MEMORY}G, building platforms in serial\"; parallel=false;\n    fi;\nfi; kube::golang::build_kube_toolchain; if [[ \"${parallel}\" == \"true\" ]]; then\n    kube::log::status \"Building go targets for ${platforms[@]} in parallel (output will appear in a burst when complete):\" \"${targets[@]}\"; local platform; for platform in \"${platforms[@]}\";\n    do\n        ( kube::golang::set_platform_envs \"${platform}\"; kube::log::status \"${platform}: go build started\"; kube::golang::build_binaries_for_platform ${platform} ${use_go_build:-}; kube::log::status \"${platform}: go build finished\" ) &amp;&gt; \"/tmp//${platform//\\//_}.build\" &amp;\n    done; local fails=0; for job in $(jobs -p);\n    do\n        wait ${job} || let \"fails+=1\";\n    done; for platform in \"${platforms[@]}\";\n    do\n        cat \"/tmp//${platform//\\//_}.build\";\n    done; exit ${fails};\nelse\n    for platform in \"${platforms[@]}\";\n    do\n        kube::log::status \"Building go targets for ${platform}:\" \"${targets[@]}\"; kube::golang::set_platform_envs \"${platform}\"; kube::golang::build_binaries_for_platform ${platform} ${use_go_build:-};\n    done;\nfi )' exited with status 1\nCall stack:\n  1: /home/peeyush/work/kubernetes/hack/lib/golang.sh:586 kube::golang::build_binaries(...)\n  2: ./hack/build-cross.sh:28 main(...)\nExiting with status 1\n</code></pre>\n\n<p>Any idea what could be causing this error? error.h is there on my system:</p>\n\n<pre><code>find / -name \"errno.h\"\n/usr/arm-none-eabi/include/sys/errno.h\n/usr/arm-none-eabi/include/errno.h\n/usr/src/kernels/4.1.13-100.fc21.x86_64+debug/include/uapi/asm-generic/errno.h\n/usr/src/kernels/4.1.13-100.fc21.x86_64+debug/include/uapi/linux/errno.h\n/usr/src/kernels/4.1.13-100.fc21.x86_64+debug/include/linux/errno.h\n/usr/src/kernels/4.1.13-100.fc21.x86_64+debug/arch/x86/include/uapi/asm/errno.h\n/usr/include/asm/errno.h\n/usr/include/sys/errno.h\n/usr/include/bits/errno.h\n/usr/include/errno.h\n/usr/include/asm-generic/errno.h\n/usr/include/linux/errno.h\n</code></pre>\n\n<p>Not sure what exactly is the issue, can anyone please help me with it?</p>\n\n<p>I am using following arm packages:</p>\n\n<pre><code>rpm -aq | grep arm\narm-none-eabi-gcc-cs-c++-5.2.0-2.fc21.x86_64\ngcc-arm-linux-gnu-4.9.2-5.fc21.x86_64\narm-none-eabi-newlib-2.2.0_1-6.fc21.noarch\nbinutils-arm-linux-gnu-2.25-4.fc21.x86_64\narm-none-eabi-binutils-cs-2014.05.28-3.fc21.x86_64\ngucharmap-3.14.2-1.fc21.x86_64\narm-none-eabi-gcc-cs-5.2.0-2.fc21.x86_64\nhdparm-9.48-1.fc21.x86_64\n</code></pre>\n\n<p>TIA.</p>\n"}, {"tags": ["go", "types", "podio"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 996756, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/piBQ1.jpg?s=128&g=1", "display_name": "pjmuller", "link": "https://stackoverflow.com/users/996756/pjmuller"}, "edited": false, "score": 0, "creation_date": 1467375764, "post_id": 38140221, "comment_id": 63720146, "body": "Works like a charm! an ampersand almost made me crazy. Thanks for the super quick reply Andreas. Appreciate it!"}, {"owner": {"reputation": 79, "user_id": 996756, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/piBQ1.jpg?s=128&g=1", "display_name": "pjmuller", "link": "https://stackoverflow.com/users/996756/pjmuller"}, "edited": false, "score": 0, "creation_date": 1467375810, "post_id": 38140221, "comment_id": 63720171, "body": "And indeed, I&#39;m doing an error catching when parsing the json. But did not post it to keep the example code simpler."}], "tags": [], "owner": {"reputation": 383, "user_id": 611495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015312353ea4329feeaca60d0337442a?s=128&d=identicon&r=PG", "display_name": "cuvius", "link": "https://stackoverflow.com/users/611495/cuvius"}, "is_accepted": true, "score": 2, "last_activity_date": 1467360371, "creation_date": 1467360371, "answer_id": 38140221, "question_id": 38139640, "link": "https://stackoverflow.com/questions/38139640/how-to-directly-pass-podio-authtoken-to-podio-go-client/38140221#38140221", "title": "How to directly pass Podio AuthToken to podio-go client", "body": "<p>Currently the type of the variable <code>authToken</code> is <code>podio.AuthToken</code>, i.e. not a pointer, but simply a struct. The function <code>podio.NewClient</code> expects an argument of type <code>*podio.AuthToken</code> (pointer to <code>podio.AuthToken</code>), which is why you're getting a compiler error. The simplest way to fix this would be to simply deference <code>authToken</code> like so:</p>\n\n<pre><code>client := podio.NewClient(&amp;authToken)\n</code></pre>\n\n<p>Alternatively you can change the type of <code>authToken</code> to <code>*podio.AuthToken</code>:</p>\n\n<pre><code>authToken := &amp;podio.AuthToken{}\njson.Unmarshal([]byte(json_auth_token), authToken)\nclient := podio.NewClient(authToken)\n</code></pre>\n\n<p>Slightly unrelated (and maybe you omitted this for brevity), but you probably want to check the error returned from <code>json.Unmarshal</code>:</p>\n\n<pre><code>err := json.Unmarshal([]byte(json_auth_token), authToken)\nif err != nil {\n  // handle error\n}\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 996756, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/piBQ1.jpg?s=128&g=1", "display_name": "pjmuller", "link": "https://stackoverflow.com/users/996756/pjmuller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 38140221, "answer_count": 1, "score": 1, "last_activity_date": 1467365638, "creation_date": 1467358526, "last_edit_date": 1467365638, "question_id": 38139640, "link": "https://stackoverflow.com/questions/38139640/how-to-directly-pass-podio-authtoken-to-podio-go-client", "title": "How to directly pass Podio AuthToken to podio-go client", "body": "<p>I'm a Ruby on Rails developer and am now venturing into Go for doing some podio.com API calls. Everything went smoothly so far but I bumped into a small and stupid problem for which I find no answer on the mighty stackoverflow (probably because I don't know what to search for).</p>\n\n<p>A bit of context: Our rails app is already handling all the podio oAuth server-flow we have all the necessary client information (auth_token, refresh_token, ...) and do not need to request that information again.</p>\n\n<p>Instead of doing</p>\n\n<pre><code> podio.AuthWithAuthCode(clientId, clientSecret, authCode, redirectUri)\n</code></pre>\n\n<p>I wish to directly create a client object like so</p>\n\n<pre><code>// json data coming from rails\njson_auth_token := \"{\\\"access_token\\\":\\\"...\\\",\\\"refresh_token\\\":\\\"...\\\",\\\"token_type\\\":\\\"\\\",\\\"expires_in\\\":28800,\\\"transfer_token\\\":\\\"\\\"}\"\n\n// creating a AuthToken object\nauthToken := podio.AuthToken{}\njson.Unmarshal([]byte(json_auth_token), &amp;authToken)\n\n// so far so good, but when doing\nclient := podio.NewClient(authToken)\n</code></pre>\n\n<p>I get the error</p>\n\n<pre><code>cannot use authToken (type podio.AuthToken) as type *podio.AuthToken in argument to podio.NewClient\n</code></pre>\n\n<p>Can somebody help me with this? It is not necessarily Podio related. More go related</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1467402986, "post_id": 38139584, "comment_id": 63735476, "body": "Isn&#39;t your <code>FormatDate()</code> approach working?"}, {"owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1467596696, "post_id": 38139584, "comment_id": 63779085, "body": "ofcourse it&#39;s worked. it is a method, i want to build a helper function for template but dont know how to declare anf call it"}], "answers": [{"comments": [{"owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "edited": false, "score": 0, "creation_date": 1570031849, "post_id": 39875812, "comment_id": 102788461, "body": "Can this be applied here to <a href=\"https://stackoverflow.com/questions/58204983/apply-custom-html-tag-to-gin-gonic-response\" title=\"apply custom html tag to gin gonic response\">stackoverflow.com/questions/58204983/&hellip;</a>?  Are there any method for accomplish the task?"}], "tags": [], "owner": {"reputation": 216, "user_id": 1926373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5o8s.jpg?s=128&g=1", "display_name": "Eddy K", "link": "https://stackoverflow.com/users/1926373/eddy-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1475675397, "creation_date": 1475675397, "answer_id": 39875812, "question_id": 38139584, "link": "https://stackoverflow.com/questions/38139584/how-to-write-golang-code-in-html-file-gin-gonic-framework/39875812#39875812", "title": "How to write golang code in html file (gin gonic framework)", "body": "<blockquote>\n  <p><strong>TL;DR</strong> use SetHTMLTemplate</p>\n</blockquote>\n\n<p>Looking at the <strong>Gin</strong> <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow\">documentation</a>, you can use your own templating engine. </p>\n\n<p>By invoking <strong>r.SetHTMLTemplate(tmpl)</strong></p>\n\n<p><strong>Gin</strong> itself is using the golang builtin html/template standard package.</p>\n\n<p>You can use the same engine and add <strong>user defined functions</strong>.</p>\n\n<p>Create the functions, using template.FuncMap:</p>\n\n<pre><code>funcMap := template.FuncMap{\n    \"formatTime\": func(raw int64) string {\n        t := time.Unix(raw, 0)\n\n        return t.Format(\"Jan 2 15:04:05 2006\")\n    },\n}\n</code></pre>\n\n<p>Instantiate a template: </p>\n\n<pre><code>tmpl := template.Must(template.New(\"main\").Funcs(funcMap).ParseGlob(\"templates/**/*\"))\n</code></pre>\n\n<p>Register the new template:</p>\n\n<pre><code>r := gin.Default()\nr.SetHTMLTemplate(tmpl)\n</code></pre>\n\n<p>If you use same templates name for different endpoints, specify name:</p>\n\n<pre><code>{{ define \"articles/list.tmpl\"}}\n\n&lt;div class=\"list-group\"&gt;\n{{ range $article := .articles }}\n  &lt;a href=\"/articles/{{ $article.Id }}\" class=\"list-group-item\"&gt;\n    &lt;h4 class=\"list-group-item-heading\"&gt;{{ $article.Title }}&lt;/h4&gt;\n    &lt;p class=\"list-group-item-text\"&gt;{{ formatTime $article.CreatedOn }}&lt;/p&gt;\n    &lt;p class=\"list-group-item-text\"&gt;&lt;/p&gt;\n  &lt;/a&gt;\n{{ end }}\n&lt;/div&gt;\n\n{{ end }}\n</code></pre>\n\n<blockquote>\n  <p>formatTime: Is defined using template.FuncMap</p>\n</blockquote>\n\n<p>To invoke, use the normal way:</p>\n\n<pre><code>c.HTML(http.StatusOK, \"articles/list\", gin.H{\n    \"title\":    \"Articles\",\n    \"articles\": articles,\n}) \n</code></pre>\n"}], "owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2193, "favorite_count": 1, "accepted_answer_id": 39875812, "answer_count": 1, "score": 7, "last_activity_date": 1489451348, "creation_date": 1467358322, "last_edit_date": 1489451348, "question_id": 38139584, "link": "https://stackoverflow.com/questions/38139584/how-to-write-golang-code-in-html-file-gin-gonic-framework", "title": "How to write golang code in html file (gin gonic framework)", "body": "<p>Im newbie in golang code as well as in gin gonic. I got a problem while using gin gonic.</p>\n\n<p>In my controller. i get all articles and render to html file by code.</p>\n\n<pre><code>c.HTML(http.StatusOK, \"articles/list\", gin.H{\n    \"title\":    \"Articles\",\n    \"articles\": articles,\n})\n</code></pre>\n\n<p>and articles have field \"CreatedOn\" type int64 (created date)\nSo in my view list.html, how i can parse CreateOn type int64 to date format.</p>\n\n<pre><code>&lt;div class=\"list-group\"&gt;\n  {{ range $article := $articles }}\n    &lt;a href=\"/articles/{{ $article.Id }}\" class=\"list-group-item\"&gt;\n      &lt;h4 class=\"list-group-item-heading\"&gt;{{ $article.Title }}&lt;/h4&gt;\n      &lt;p class=\"list-group-item-text\"&gt;{{ $article.Body }}&lt;/p&gt;\n      &lt;p class=\"list-group-item-text\"&gt;{{ $article.CreatedOn  }}&lt;/p&gt;\n      &lt;p class=\"list-group-item-text\"&gt;&lt;/p&gt;\n    &lt;/a&gt;\n  {{ end }}\n  &lt;/div&gt;\n</code></pre>\n\n<p>Thanks all</p>\n\n<p>I had found a way that i write a method FormatDate()</p>\n\n<pre><code>func (a *Article) FormatDate(ab int64) string {\n    return \"test Time\"\n}\n</code></pre>\n\n<p>in model \"Article\". then in my view i call </p>\n\n<pre><code>  &lt;p class=\"list-group-item-text\"&gt;{{ .FormatDate article.CreatedOn  }}&lt;/p&gt;\n</code></pre>\n\n<p>Anything else????</p>\n"}, {"tags": ["go", "strconv"], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 2, "last_activity_date": 1467354752, "creation_date": 1467354752, "answer_id": 38138551, "question_id": 38138275, "link": "https://stackoverflow.com/questions/38138275/parse-number-string-digits/38138551#38138551", "title": "Parse number string digits", "body": "<p>There are a couple problems...</p>\n\n<p>First, you need to start mult at 1, otherwise you will just continually multiply by 0 and always get 0.</p>\n\n<p>Secondly you have the logic for your err check flipped.  It should be <code>if err == nil</code></p>\n\n<p>This seems to do what you want:</p>\n\n<pre><code>func getMult(startIndex int, inputNum string) int {\n    mult := 1\n    for i := 0; i &lt; 10; i++ {\n        digit, err := strconv.Atoi(string(inputNum[startIndex+i]))\n        if err == nil {\n            mult *= int(digit)\n        } else {\n            fmt.Println(err)\n        }\n\n    }\n    return mult\n}\n</code></pre>\n\n<p>The error you were getting was because you were trying to print <code>err.Error()</code> when <code>err</code> itself was nil (due to the logical flip of != and ==)</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 1, "last_activity_date": 1467358834, "last_edit_date": 1467358834, "creation_date": 1467357401, "answer_id": 38139308, "question_id": 38138275, "link": "https://stackoverflow.com/questions/38138275/parse-number-string-digits/38139308#38139308", "title": "Parse number string digits", "body": "<p>your code will work with fixing these two typos:<br>\nchange <code>mult := 0</code> to <code>mult := 1</code><br>\nand change <code>err != nil</code> to <code>err == nil</code> like this:  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    inputNum := \"73167176531330624919225119\"\n    mult := getMult(3, inputNum)\n    fmt.Printf(\"Mult = %d\", mult)\n}\n\nfunc getMult(startIndex int, inputNum string) int {\n    mult := 1\n    for i := 0; i &lt; 10; i++ {\n        digit, err := strconv.Atoi(string(inputNum[startIndex+i]))\n        if err == nil {\n            mult *= int(digit)\n        } else {\n            fmt.Printf(\"Error converting %s to int  : %s\\n\", string(inputNum[startIndex+i]), err.Error())\n        }\n    }\n    return mult\n}\n</code></pre>\n\n<p>also you may use <code>inputNum[3:13]</code> to get new string from index 3 with length 10,<br>\nand you may use <code>int(v - '0')</code> to convert one character to integer number,<br>\nthen use <code>for</code> <code>range</code> like this:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    inputNum := \"73167176531330624919225119\"\n    mult := getMult(inputNum[3:13])\n    fmt.Printf(\"Mult = %d \\n\", mult) // Mult = 238140\n}\n\nfunc getMult(str string) int {\n    m := 1\n    for _, v := range str {\n        if v &gt;= '0' &amp;&amp; v &lt;= '9' {\n            m *= int(v - '0')\n        } else {\n            fmt.Printf(\"Error converting %q to int\\n\", v)\n            break\n        }\n    }\n    return m\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>Mult = 238140\n</code></pre>\n"}], "owner": {"reputation": 1828, "user_id": 1478238, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/eMZzp.png?s=128&g=1", "display_name": "Shai Aharoni", "link": "https://stackoverflow.com/users/1478238/shai-aharoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 38139308, "answer_count": 2, "score": 1, "last_activity_date": 1467358834, "creation_date": 1467353665, "question_id": 38138275, "link": "https://stackoverflow.com/questions/38138275/parse-number-string-digits", "title": "Parse number string digits", "body": "<p>I am trying to calculate the multiplication result of a few digits which are part of a long digits string. Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    inputNum := \"73167176531330624919225119\"\n    mult := getMult(3, inputNum)\n\n    fmt.Printf(\"Mult = %d\", mult)\n\n}\n\nfunc getMult(startIndex int, inputNum string) int {\n    mult := 0\n    for i := 0; i &lt; 10; i++ {\n\n        digit, err := strconv.Atoi(string(inputNum[startIndex+i]))\n\n        if err != nil {\n            mult *= int(digit)\n        } else {\n            fmt.Printf(\"Error converting %s to int  : %s\\n\", string(inputNum[startIndex+i]), err.Error())\n        }\n\n    }\n    return mult\n}\n</code></pre>\n\n<p>The result I want to get is 6*7*1*7*6*5*3*1*3*3 = 238140</p>\n\n<p>But I an getting a runtime error:</p>\n\n<p>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x0 addr=0x20 pc=0x40130e]</p>\n\n<p>goroutine 1 [running]:\nmain.getMult(0x3, 0x534d40, 0x1a, 0x4d2701)\n    test.go:25 +0x17e\nmain.main()\n    test.go:10 +0x55\nexit status 2</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 0, "last_activity_date": 1467354309, "creation_date": 1467354309, "answer_id": 38138439, "question_id": 38137558, "link": "https://stackoverflow.com/questions/38137558/go-structure-as-method-receiver-with-and-without-interface/38138439#38138439", "title": "Go structure as method receiver with and without interface", "body": "<p>In your first example, a DB or pointer to DB can act as the receiver.  In your second example, using an interface, you can still only have a DB or &amp;DB as the receiver, but nobody else has to know that (assuming you capitalized your function names to Add and Remove).  Instead, you would be able to use a <code>UserAccess</code> interface which could be a DB or &amp;DB, but could be anything else that implemented the Add and Remove functions.</p>\n\n<p>This is really helpful for a couple reasons.  First, this is way more testable as you can use something the implements the <code>UserAccess</code> interface but never touches a database.  As long as the thing your are testing has the two functions with matching signatures it can be used instead.  There are mocking libraries that take advantage of this to autogenerate code.</p>\n\n<p>Secondly, if you use an interface then your caller doesn't need to know anything about the actual type (DB in this case) and it will only have access to the functions defined on the interface instead of the entire API of your type.</p>\n\n<p>There is lots of other good reading material out there for the benefits and design considerations behind interfaces.</p>\n"}], "owner": {"reputation": 41, "user_id": 838659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jWXi1.png?s=128&g=1", "display_name": "Rafiq", "link": "https://stackoverflow.com/users/838659/rafiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1541445282, "creation_date": 1467350244, "last_edit_date": 1541445282, "question_id": 38137558, "link": "https://stackoverflow.com/questions/38137558/go-structure-as-method-receiver-with-and-without-interface", "title": "Go structure as method receiver with and without interface", "body": "<p>I am new to Go. Want to know what is benefit or drawback when struct act as receiver of method with OR with out interface </p>\n\n<pre><code>type DB struct\n</code></pre>\n\n<hr>\n\n<pre><code>func (db *DB) add(user User) {...//some code }\nfunc (db *DB) remove(user User) {..//some code}\n</code></pre>\n\n<hr>\n\n<pre><code>type UserAccess inferface {\n    func add(user User)\n    func remove(user User)\n}\n\nfunc (db *DB) add(user User) {...//some code }\nfunc (db *DB) remove(user User) {..//some code}\n</code></pre>\n\n<blockquote>\n  <p>PLEASE NOTE: above example is JUST to put thing in code.</p>\n</blockquote>\n\n<p>I am asking this as, I have seen many Go library code in github which use empty struct as method receivers.</p>\n\n<p>I know almost all blogs and go-guru bit a drum of using interface. </p>\n\n<p>But which are the places, where interface actually needed in go lang implementation? and what we loss or gain because of that?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1467343700, "post_id": 38136541, "comment_id": 63703921, "body": "There&#39;s no reason to try to get 100% coverage. Test what consumes <code>getHostname</code>."}], "answers": [{"comments": [{"owner": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "edited": false, "score": 0, "creation_date": 1467350415, "post_id": 38137187, "comment_id": 63705610, "body": "It was supposed to be a simple example so that I can get helpful inputs. The point of this question was not to judge the implementation of <code>getHostname()</code>. The point of this question how to induce error in os.Hostname() if I want to."}, {"owner": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "edited": false, "score": 0, "creation_date": 1467352159, "post_id": 38137187, "comment_id": 63706184, "body": "When I say testing, I mean the <code>testing package</code>. Not as if else statements. Sorry for the confusion. I&#39;ve updated my question."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1467360022, "last_edit_date": 1467360022, "creation_date": 1467348004, "answer_id": 38137187, "question_id": 38136541, "link": "https://stackoverflow.com/questions/38136541/how-to-test-error-condition-for-this-function/38137187#38137187", "title": "How to test error condition for this function?", "body": "<p>what happens if your function under test panics?<br>\nadd panic-checking to your testing code:  </p>\n\n<pre><code>package hostname\n\nimport \"testing\"\n\nfunc TestGetHostname(t *testing.T) {\n    defer func() {\n        if r := recover(); r != nil {\n            t.Errorf(\"The code did panic\")\n        }\n    }()\n    name, err := getHostname()\n    if err != nil {\n        t.Errorf(\"err: %v\\n\", err)\n    }\n    if len(name) == 0 {\n        t.Errorf(\"Hostname is empty\")\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>old:   </p>\n\n<p>look inside <code>os.hostname()</code>:<br>\nin case of err, it will returns:</p>\n\n<pre><code>        return \"\", NewSyscallError(\"...\", err) \n</code></pre>\n\n<p>your <code>getHostname()</code> repeats this again.<br>\nlet me do it again (just to clarify what i'm talking about):    </p>\n\n<pre><code>func getHostname2() (string, error) {\n    host, err := getHostname()  // your getHostname !\n    if err != nil {\n        return \"\", err\n    }\n    return host, nil    \n}\n</code></pre>\n\n<p>this is extra superfluous, isn't it?  </p>\n\n<p>so i think this is enough:  </p>\n\n<pre><code>package main\n\nimport \"os\"\nimport \"fmt\"\n\nfunc main() {\n    name, err := os.Hostname()\n    if err != nil {\n        fmt.Printf(\"err: %v\\n\", err)\n        return\n    }\n    fmt.Println(name)\n}\n</code></pre>\n\n<p>so simple error checking is enough (like this):  </p>\n\n<pre><code>package main\n\nimport \"os\"\nimport \"fmt\"\n\nfunc work() {\n    if name, err := os.Hostname(); err != nil {\n        fmt.Printf(\"err: %v\\n\", err)\n        return\n    } else {\n        // do some job ...\n        fmt.Println(name)\n    }\n}\nfunc main() {\n    work()\n}\n</code></pre>\n\n<p>i hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 4, "last_activity_date": 1467352661, "creation_date": 1467352661, "answer_id": 38138024, "question_id": 38136541, "link": "https://stackoverflow.com/questions/38136541/how-to-test-error-condition-for-this-function/38138024#38138024", "title": "How to test error condition for this function?", "body": "<p>You can make the code testable by using dependency injection like this:</p>\n\n<pre><code>// Override for testing\nvar osHostname = os.Hostname\n\nfunc getHostname() (string, error) {\n    host, err := osHostname()\n    if err != nil {\n        return \"\", err\n    }\n    return host, nil    \n}\n</code></pre>\n\n<p>In your test, you can replace the stub with an error-producing version.</p>\n\n<pre><code>func TestGetHostnameFails(t *testing.T) {\n    defer func() { osHostname = os.Hostname }()\n    osHostname = func()(string, error) { return \"\", errors.New(\"fail\") }\n    got, err := getHostname()\n    if err == nil {\n        t.Errorf(\"getHostname() = (%v, nil), want error\", got)\n    }\n}\n</code></pre>\n\n<p>There's advantages and disadvantages to using package globals to do dependency injection. The advantages are that it's very simple, and most importantly to me doesn't mess the production code up too much. For those reasons it's my choice when you want to test code in isolation like this. The disadvantages are that you may forget to reset the state in your test, and it doesn't give a good testing api -- so if there's lots of tests that are using this stub (or worse, tests in another package), you may prefer to make the configuration explicit by putting it in a <code>struct</code>, and making <code>getHostname</code> a method of that struct.</p>\n\n<p>This is just an example, but I feel compelled to provide a cautionary message about getting 100% test coverage. <code>os.Hostname()</code> is very unlikely to fail in practice, and it's also very unlikely that your error handling when it fails is wrong. It's much more likely that any dependency injection introduces a bug than it is that this test identifies any real bug.</p>\n"}], "owner": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1894, "favorite_count": 0, "accepted_answer_id": 38138024, "answer_count": 2, "score": 1, "last_activity_date": 1467360022, "creation_date": 1467343362, "last_edit_date": 1467352123, "question_id": 38136541, "link": "https://stackoverflow.com/questions/38136541/how-to-test-error-condition-for-this-function", "title": "How to test error condition for this function?", "body": "<pre><code>func getHostname() (string, error) {\n    host, err := os.Hostname()\n    if err != nil {\n        // Untested code-block\n        return \"\", err\n    }\n    // Don't judge the example. This is just an example. \n    // Basically, I want to know how to induce error in os.Hostname()\n    return host, nil\n\n}\n</code></pre>\n\n<p>The corresponding test for this function is:- </p>\n\n<pre><code>import \"testing\"\n\nfunc TestGetHostname(t *testing.T) {\n        host, err := getHostname()\n        if err != nil {\n                t.Errorf(\"Error executing getHostname(): %s\", err)\n        }\n        if len(host) &lt; 1 {\n                t.Errorf(\"Hostname returned is not proper\")\n        }\n}\n</code></pre>\n\n<p>If I were to make the 100% coverage for this function, I would like induce error in <code>os.Hostname()</code> so that I can run that <code>if block</code> too. How can I achieve that?</p>\n\n<p>Is creating an interface and passing it as an argument to function the only way?</p>\n"}, {"tags": ["arrays", "go", "pass-by-reference"], "answers": [{"tags": [], "owner": {"reputation": 1090, "user_id": 4674479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/56af09c0905f13125aefb9c10c5af2f8?s=128&d=identicon&r=PG&f=1", "display_name": "adapt-dev", "link": "https://stackoverflow.com/users/4674479/adapt-dev"}, "is_accepted": false, "score": 0, "last_activity_date": 1467335445, "creation_date": 1467335445, "answer_id": 38135570, "question_id": 38135518, "link": "https://stackoverflow.com/questions/38135518/value-set-on-struct-member-of-an-array-gets-lost-after-function-returns/38135570#38135570", "title": "Value set on struct member of an array gets lost after function returns", "body": "<p>I figured this out myself - what <code>range</code> returns is actually a copy.  This fixed it</p>\n\n<pre><code>func makeFoo2() []Temp {\n    foos := makeFoo1()\n    for i, _ := range foos {\n        foos[i].Lost = \"lost\"\n\n    }\n    return foos\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1090, "user_id": 4674479, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/56af09c0905f13125aefb9c10c5af2f8?s=128&d=identicon&r=PG&f=1", "display_name": "adapt-dev", "link": "https://stackoverflow.com/users/4674479/adapt-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467335445, "creation_date": 1467334916, "question_id": 38135518, "link": "https://stackoverflow.com/questions/38135518/value-set-on-struct-member-of-an-array-gets-lost-after-function-returns", "title": "Value set on struct member of an array gets lost after function returns", "body": "<p>In golang, my understanding was that <s>array</s> slice types are references.   I've got a problem where golang is acting like it is making copies of the data, rather than passing references around.</p>\n\n<p><a href=\"https://play.golang.org/p/EfEOMV_wcS\" rel=\"nofollow\">https://play.golang.org/p/EfEOMV_wcS</a></p>\n\n<pre><code>type Temp struct {\n    Id   string `json:\"id\"`\n    Lost string `json:\"lost\"`\n}\n\nfunc makeFoo1() []Temp {\n    foos := make([]Temp, 0)\n    foos = append(foos, Temp{Id: \"foo\"})\n    return foos\n}\n\nfunc makeFoo2() []Temp {\n    foos := makeFoo1()\n    for _, t := range foos {\n        t.Lost = \"lost\"\n    }\n    return foos\n\n}\n\nfunc main() {\n    j, _ := json.Marshal(makeFoo2())\n    fmt.Printf(\"%s\\n\", j)\n}\n</code></pre>\n\n<p>The output of this is <code>[{\"id\":\"foo\",\"lost\":\"\"}]</code></p>\n\n<p>How can the assignment <code>t.Lost = \"...\"</code> be made in makeFoo2 so it doesn't get lost?    Or I guess the real question is how do I ensure the array is a reference and not a value?</p>\n"}, {"tags": ["api", "go"], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1467390124, "post_id": 38134417, "comment_id": 63729492, "body": "@lofcek why are you linking to random questions? It&#39;s not even relevant... I provided the correct answer and that question is not regarding the same problem."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 5, "last_activity_date": 1467326614, "creation_date": 1467326614, "answer_id": 38134417, "question_id": 38134397, "link": "https://stackoverflow.com/questions/38134397/syntax-error-need-trailing-comma-before-newline-in-composite-literal/38134417#38134417", "title": "Syntax error: need trailing comma before newline in composite literal", "body": "<p>It's because you've excluded an if while composing assignment/conditional.</p>\n\n<pre><code>if member, err := fb.Get(\"/1\", fb.Params{\n     \"fields\": \"first_name\",\n     \"access_token\": \"valid_token\",\n     }); err == nil {\n</code></pre>\n"}], "owner": {"reputation": 1194, "user_id": 4135058, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55f736d900d8dcc786419c14300dcf96?s=128&d=identicon&r=PG&f=1", "display_name": "Juanvulcano", "link": "https://stackoverflow.com/users/4135058/juanvulcano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1080, "favorite_count": 0, "accepted_answer_id": 38134417, "answer_count": 1, "score": -1, "last_activity_date": 1467326614, "creation_date": 1467326501, "question_id": 38134397, "link": "https://stackoverflow.com/questions/38134397/syntax-error-need-trailing-comma-before-newline-in-composite-literal", "title": "Syntax error: need trailing comma before newline in composite literal", "body": "<p>I wrote some code in Golang that seems fine to me but I found this syntax error, I think it have something to do with Go attaching semicolons at the end of lines. \nCan somebody please explain what is wrong with this code? </p>\n\n<p>Type of member is fb.Result (a.k.a. map[string]interface{})</p>\n\n<pre><code>func worker() {\n   defer wg.Done()\n   for i := range input {\n       member, err := fb.Get(\"/1\", fb.Params{\n         \"fields\": \"first_name\",\n         \"access_token\": \"valid_token\",\n         }); err == nil {\n            output &lt;- fmt.Sprint(member[\"first_name\"])\n          }else{\n           fmt.Println(err)\n           continue\n       }\n   }\n}\n</code></pre>\n"}, {"tags": ["go", "goclipse"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1467325168, "post_id": 38134124, "comment_id": 63699341, "body": "If you navigate to <code>C:\\Projects\\Go\\bin</code> do you see a file named <code>HellowWorld.exe</code> ? The error is saying it&#39;s not there. Which is probably correct because I bet it&#39;s instead at <code>C:\\Projects\\Go\\src\\bin</code>"}, {"owner": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1467325248, "post_id": 38134124, "comment_id": 63699371, "body": "Your GOROOT has to be the directory where your bin/go.exe seats - follow the tutorial on <a href=\"http://stackoverflow.com/questions/38113298/installing-go-on-linux-testing-fails/38113375#38113375\" title=\"installing go on linux testing fails\">stackoverflow.com/questions/38113298/&hellip;</a> with Windows adjustments and set PATH accordingly."}], "owner": {"reputation": 1, "user_id": 6489794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009566542f43db27115ba1e2b4ddda22?s=128&d=identicon&r=PG", "display_name": "Matt D.", "link": "https://stackoverflow.com/users/6489794/matt-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467324958, "creation_date": 1467324958, "question_id": 38134124, "link": "https://stackoverflow.com/questions/38134124/windows-goclipse-error", "title": "Windows GoClipse Error", "body": "<p>I tried to configure GoClipse for windows but I get this error when I made a Hello World program: \"Executable file (C:\\Projects\\Go\\bin\\HelloWorld.exe) doesnt exist.\" I have GOROOT set to C:\\Go and GOPATH set to C:\\Projects\\Go; I have also installed gocode and created the src, pkg, and bin folders within C:\\Projects\\Go. I created the go project inside of C:\\Projects\\Go\\src as well. Is there anything that I did wrong or need to fix? I'm not too sure why I'm getting this error.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1467316839, "post_id": 38132137, "comment_id": 63695627, "body": "Don&#39;t use <code>.</code> imports, it&#39;s considered bad practice outside of testing. Also note that <code>internal</code> is a restricted import path and prevent outside package from importing it (which may be intended in your case)"}, {"owner": {"reputation": 9, "user_id": 6535173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S1KHn0VuZYw/AAAAAAAAAAI/AAAAAAAALfM/xal5iAUkTA8/photo.jpg?sz=128", "display_name": "Elton Yang", "link": "https://stackoverflow.com/users/6535173/elton-yang"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467318485, "post_id": 38132137, "comment_id": 63696527, "body": "I get that <code>import . </code> is bad practice, but it was the only way that I know of to get the anonymous struct to work as closely as possible.  I used <code>import public</code> before and the anonymous field was <code>public.PublicStruct</code>, but that didn&#39;t work either"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467318649, "post_id": 38132137, "comment_id": 63696616, "body": "I&#39;m not sure what you&#39;re referring to, importing via &quot;.&quot; doesn&#39;t change the semantics of struct embedding."}, {"owner": {"reputation": 9, "user_id": 6535173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S1KHn0VuZYw/AAAAAAAAAAI/AAAAAAAALfM/xal5iAUkTA8/photo.jpg?sz=128", "display_name": "Elton Yang", "link": "https://stackoverflow.com/users/6535173/elton-yang"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467318886, "post_id": 38132137, "comment_id": 63696749, "body": "it changes the referencing so using PublicStruct would appear the same in internal as it would in public. I&#39;m pretty sure that it&#39;s just namespace-ing, but I hoped that when something imported internal and used InternalStruct, Field1 could be accessed without any issue."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467319308, "post_id": 38132137, "comment_id": 63696964, "body": "The name of the embedded struct is irrelevant, and the selector will resolve Field1 the same regardless. I think you may misunderstand how embedding works. Please show a reproducible example, with the expected outcome, and without using the &quot;.&quot; import or the reserved &quot;internal&quot; package."}, {"owner": {"reputation": 9, "user_id": 6535173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S1KHn0VuZYw/AAAAAAAAAAI/AAAAAAAALfM/xal5iAUkTA8/photo.jpg?sz=128", "display_name": "Elton Yang", "link": "https://stackoverflow.com/users/6535173/elton-yang"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467319990, "post_id": 38132137, "comment_id": 63697304, "body": "Sorry about the inconvenience. I was trying to remove unnecessary parts. I updated the example. Hopefully what I&#39;m trying to achieve is more visible now."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467320395, "post_id": 38132137, "comment_id": 63697497, "body": "That works as expected (and marshals to <code>{&quot;fetchStats&quot;:false,&quot;includeHidden&quot;:false}</code> after the typo fix), so I have a feeling you&#39;re not importing what you think you are. Check your files, and GOPATH structure, etc."}, {"owner": {"reputation": 9, "user_id": 6535173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S1KHn0VuZYw/AAAAAAAAAAI/AAAAAAAALfM/xal5iAUkTA8/photo.jpg?sz=128", "display_name": "Elton Yang", "link": "https://stackoverflow.com/users/6535173/elton-yang"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1467323870, "post_id": 38132137, "comment_id": 63698892, "body": "I updated the post to contain the folder and file names that I used inside the src folder. I also included my main.go file. Accessing Field1 and Field2 in a variable does not have any issues, but if I use filter.Test(), I get unknown field."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6535173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S1KHn0VuZYw/AAAAAAAAAAI/AAAAAAAALfM/xal5iAUkTA8/photo.jpg?sz=128", "display_name": "Elton Yang", "link": "https://stackoverflow.com/users/6535173/elton-yang"}, "edited": false, "score": 0, "creation_date": 1467318348, "post_id": 38132214, "comment_id": 63696459, "body": "That was a typo. Field1 should actually be capitalized."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 9, "user_id": 6535173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S1KHn0VuZYw/AAAAAAAAAAI/AAAAAAAALfM/xal5iAUkTA8/photo.jpg?sz=128", "display_name": "Elton Yang", "link": "https://stackoverflow.com/users/6535173/elton-yang"}, "edited": false, "score": 0, "creation_date": 1467324605, "post_id": 38132214, "comment_id": 63699158, "body": "@EltonYang I updated with the solution to the problem you&#39;re currently facing."}, {"owner": {"reputation": 9, "user_id": 6535173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S1KHn0VuZYw/AAAAAAAAAAI/AAAAAAAALfM/xal5iAUkTA8/photo.jpg?sz=128", "display_name": "Elton Yang", "link": "https://stackoverflow.com/users/6535173/elton-yang"}, "edited": false, "score": 0, "creation_date": 1467325533, "post_id": 38132214, "comment_id": 63699485, "body": "That makes sense, but I was hoping that there would be a way to pass through PublicStruct and being able to reference Field1 as though it were a part of InternalStruct, similarly to how inheritance works for other languages. Seeing as how that isn&#39;t possible, I&#39;ll mark your answer as correct. Thanks for the help."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 9, "user_id": 6535173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S1KHn0VuZYw/AAAAAAAAAAI/AAAAAAAALfM/xal5iAUkTA8/photo.jpg?sz=128", "display_name": "Elton Yang", "link": "https://stackoverflow.com/users/6535173/elton-yang"}, "edited": false, "score": 0, "creation_date": 1467325712, "post_id": 38132214, "comment_id": 63699559, "body": "@EltonYang the language feature you&#39;re using here is called embedding and it does work like that for access, just not for initilization. In this case you have to be explicit, like declare the embedded type before you can declare it&#39;s fields. After that statement you can do <code>tmp.Field1</code> and you won&#39;t get any errors, it will be the same as doing <code>tmp.PublicStruct.Field1</code> but that&#39;s really the only thing embedding gives you. It&#39;s more equivalent to composition than inheritance though it provides some useful aspects of both."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 3, "last_activity_date": 1467324594, "last_edit_date": 1467324594, "creation_date": 1467316751, "answer_id": 38132214, "question_id": 38132137, "link": "https://stackoverflow.com/questions/38132137/imported-struct-to-be-used-as-anonymous-field/38132214#38132214", "title": "Imported struct to be used as anonymous field", "body": "<p>The issue is that <code>field1</code> isn't being exported by the public package as it's name is lower cased. If it were instead <code>Field1</code> then you could access it inside the internal package like <code>MyInternalStructInstance.Field1</code></p>\n\n<p>EDIT - Addresses OP's update;</p>\n\n<p>The syntax you're using for initilization in your main is just wrong. It should be:</p>\n\n<pre><code>tmp := InternalStruct{PublicStruct: PublicStruct{Field1: true}, Field2: false}\n</code></pre>\n\n<p>It has nothing to do with the packages or imported vs exported. It can easily be tested on the playground, a complete example is here; <a href=\"https://play.golang.org/p/tbCqFeNStd\" rel=\"nofollow\">https://play.golang.org/p/tbCqFeNStd</a></p>\n"}], "owner": {"reputation": 9, "user_id": 6535173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S1KHn0VuZYw/AAAAAAAAAAI/AAAAAAAALfM/xal5iAUkTA8/photo.jpg?sz=128", "display_name": "Elton Yang", "link": "https://stackoverflow.com/users/6535173/elton-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 38132214, "answer_count": 1, "score": -1, "last_activity_date": 1467324594, "creation_date": 1467316483, "last_edit_date": 1467323566, "question_id": 38132137, "link": "https://stackoverflow.com/questions/38132137/imported-struct-to-be-used-as-anonymous-field", "title": "Imported struct to be used as anonymous field", "body": "<p>So I'm trying to write a few Go files such that there is a public facing package and an internal package.</p>\n\n<p>In the public facing package, there is a struct that is nearly identical (missing one field) to an internal struct.</p>\n\n<p>I thought of using an anonymous field in the internal struct, but it doesn't seem to play nicely.</p>\n\n<hr>\n\n<p>Example:</p>\n\n<p>public/public.go:</p>\n\n<pre><code>package public\n\ntype PublicStruct struct {\n    Field1 bool `json:\"fetchStats\"`\n}\n</code></pre>\n\n<p>data/data.go</p>\n\n<pre><code>package data\n\nimport publicData \"public\"\n\ntype InternalStruct struct {\n    publicData.PublicStruct\n    Field2 bool `json:\"includeHidden:`\n}\n</code></pre>\n\n<p>filter/filter.go:</p>\n\n<pre><code>package filter\n\nimport \"data\"\n\nfunc test() {\n    tmp := data.InternalStruct{Field1: true, Field2: false}\n}\n</code></pre>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\nimport \"filter\"\nimport \"data\"\n\nfunc main() {\n    var tmp data.InternalStruct\n    tmp.Field1 = true\n    tmp.Field2 = true\n    filter.Test()\n}\n</code></pre>\n\n<hr>\n\n<p>Expected: no issues</p>\n\n<p>Result: <code>filter/filter.go:6: unknown data.InternalStruct field 'Field1' in struct literal</code></p>\n\n<hr>\n\n<p>Why does this not work and what should I do to make it work (I'm currently using the duplicate parameters in both structs approach)?</p>\n\n<hr>\n\n<p>PS: I don't know how to test this in go playground since it involves multiple files.</p>\n"}, {"tags": ["json", "api", "go"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 1, "creation_date": 1467308273, "post_id": 38129830, "comment_id": 63690898, "body": "I personally would just make the value an array. You can have an array of length one."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1467309120, "post_id": 38129830, "comment_id": 63691393, "body": "Your example that tries to unmarshal a singleton and then attempts to do it as an array if it fails is the most idiomatic way to handle this in Go."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1467310728, "post_id": 38129830, "comment_id": 63692277, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/32346117/unmarshalling-a-json-that-may-or-may-not-return-an-array\">one</a>, <a href=\"http://stackoverflow.com/questions/37152092/what-is-a-good-way-to-handle-single-or-array-struct-in-golang-json-unmarshal\">two</a>, <a href=\"http://stackoverflow.com/questions/33622016/json-sometimes-array-sometimes-object\">three</a>, <a href=\"http://stackoverflow.com/questions/33569210/go-json-unmarshal-options\">four</a>."}, {"owner": {"reputation": 545, "user_id": 2543803, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/PPfvI.jpg?s=128&g=1", "display_name": "Norio Akagi", "link": "https://stackoverflow.com/users/2543803/norio-akagi"}, "edited": false, "score": 0, "creation_date": 1467318985, "post_id": 38129830, "comment_id": 63696806, "body": "&gt;squiguy I see, I like that idea:)    &gt;evanmcdonnal, &gt;icza Yeah I know there are some related questions and I wanted to know if there is some standardized solution for this. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 545, "user_id": 2543803, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/PPfvI.jpg?s=128&g=1", "display_name": "Norio Akagi", "link": "https://stackoverflow.com/users/2543803/norio-akagi"}, "edited": false, "score": 0, "creation_date": 1467319173, "post_id": 38132710, "comment_id": 63696886, "body": "I see. Instead of trying to marshal into a single element, we can check the actual first byte character, <code>[</code>. Thank you for the suggestion! I like it."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1598135388, "last_edit_date": 1598135388, "creation_date": 1467318651, "answer_id": 38132710, "question_id": 38129830, "link": "https://stackoverflow.com/questions/38129830/what-is-the-best-way-to-handle-a-single-element-or-an-array-json-property-in-g/38132710#38132710", "title": "What is the best way to handle &quot;a single element or an array&quot; JSON property in Go?", "body": "<p>Here's how I would do it:</p>\n<pre><code>type Request struct {\n   RawData json.RawMessage `json:&quot;data&quot;`  // export field for unmarshal of entire request\n   DataList []*Data `json:&quot;-&quot;`           // always use slice\n}\n\n// Is it an array?\nif bytes.HasPrefix(bytes.TrimSpace(req.RawData), []byte{'['})) {\n   if err := json.Unmarshal(req.RawData, &amp;req.DataList); err != nil {\n       // handle error parsing array\n   }\n} else {\n   var v Data\n   if err := json.Unmarshal(req.RawData, &amp;v); err != nil {\n       // handle error parsing single value\n   }\n   req.DataList = []*Data{&amp;v)\n}\n</code></pre>\n"}], "owner": {"reputation": 545, "user_id": 2543803, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/PPfvI.jpg?s=128&g=1", "display_name": "Norio Akagi", "link": "https://stackoverflow.com/users/2543803/norio-akagi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 38132710, "answer_count": 1, "score": 0, "last_activity_date": 1598135388, "creation_date": 1467308020, "question_id": 38129830, "link": "https://stackoverflow.com/questions/38129830/what-is-the-best-way-to-handle-a-single-element-or-an-array-json-property-in-g", "title": "What is the best way to handle &quot;a single element or an array&quot; JSON property in Go?", "body": "<p>Now we have a JSON HTTP request data which would be a single element like\n<code>{\"data\": {\"id\":1}}</code> OR an array of elements like <code>{\"data\": [{\"id\":1}, {\"id\":2}]}</code>.</p>\n\n<p>Since a client side cannot change the implementation, we have to keep and accept this data structure.</p>\n\n<p>Currently I implement struct like:</p>\n\n<pre><code>type Request struct {\n  rawData json.RawMessage `json:\"data\"`\n\n  Data *Data `json:\"-\"`\n  DataList []*Data `json:\"-\"`\n}\n</code></pre>\n\n<p>And first parse \"data\" property as json.RawMessage into variable <code>req</code>, try parsing as a single element first, then if it fails try parsing as an array.</p>\n\n<pre><code>if err := json.Unmarshal(req.rawData, &amp;req.Data); err != nil {\n    if err := json.Unmarshal(req.RawData, &amp;req.DataList); err != nil {\n        return errors.New(\"could not parse data\")\n    } else if len(req.DataList) &lt; 1 {\n        return errors.New(\"empty list\")\n    }\n}\n</code></pre>\n\n<p>In this case, later when we want to use this data, we can check if <code>rawData</code> is a single element or an array by <code>len(req.Datalist) &gt;= 1</code>. (Or I can set some flag to show that like <code>isDataMultiple</code> in the struct, when parsing).</p>\n\n<p>Is there any idiomatic way to achieve the same result in Go other than what I'm doing?</p>\n"}, {"tags": ["ssl", "go", "https"], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 1862123, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/17a3486a39c8d9d47d10e9c76a31d9d1?s=128&d=identicon&r=PG", "display_name": "Richard John Catalano", "link": "https://stackoverflow.com/users/1862123/richard-john-catalano"}, "edited": false, "score": 0, "creation_date": 1467307711, "post_id": 38129590, "comment_id": 63690604, "body": "wow...I feel incredibly dumb right now. Like I said...probably something dumb. Thanks a ton."}], "tags": [], "owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "is_accepted": true, "score": 3, "last_activity_date": 1467307120, "creation_date": 1467307120, "answer_id": 38129590, "question_id": 38129476, "link": "https://stackoverflow.com/questions/38129476/golang-listenandservetls-wont-take-my-certificate/38129590#38129590", "title": "Golang ListenAndServeTLS won&#39;t take my certificate", "body": "<p><code>func StartServer(addrUnsecure, addrSecure, key, cert string) {</code></p>\n\n<p>so <code>key</code> is at 3. place, <code>cert</code> at 4. place in the parameter list.</p>\n\n<p><code>server.StartServer(addrUnsecure, addrSecure, serverCert, serverKey)</code></p>\n\n<p>Now you are calling that func with <code>cert</code> being at the 3. place and <code>key</code> at the 4. place. </p>\n\n<p>Maybe swapping them will help.</p>\n"}], "owner": {"reputation": 349, "user_id": 1862123, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/17a3486a39c8d9d47d10e9c76a31d9d1?s=128&d=identicon&r=PG", "display_name": "Richard John Catalano", "link": "https://stackoverflow.com/users/1862123/richard-john-catalano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1318, "favorite_count": 0, "accepted_answer_id": 38129590, "answer_count": 1, "score": 0, "last_activity_date": 1467311954, "creation_date": 1467306737, "last_edit_date": 1467311954, "question_id": 38129476, "link": "https://stackoverflow.com/questions/38129476/golang-listenandservetls-wont-take-my-certificate", "title": "Golang ListenAndServeTLS won&#39;t take my certificate", "body": "<p>This has really stumped me...I'm just trying to setup a basic server using Cobra and the standard http package. I've followed the golang example <a href=\"https://gist.github.com/denji/12b3a568f092ab951456\" rel=\"nofollow\">here</a> for how to create a certificate and key, but no matter what I throw at it, I'm not getting it to go through and keep getting this error: </p>\n\n<blockquote>\n  <p>Cannot serve on http port: crypto/tls: failed to find certificate PEM data in certificate input, but did find a private key; PEM inputs may have been switched</p>\n</blockquote>\n\n<p>so I am left with the belief that it must be something wrong with my program that won't let me process certificates.</p>\n\n<p>This is what I use to parse my flags to start the server: </p>\n\n<pre><code>var serverCmd = &amp;cobra.Command{\n    Use:   \"server\",\n    Short: \"start a compiler server\",\n    Run: func(cmd *cobra.Command, args []string) {\n        addrUnsecure := \"\"\n        addrSecure := \"\"\n\n        addrUnsecure += \":\" + strconv.FormatUint(serverPort, 10)\n        addrSecure += \":\" + strconv.FormatUint(securePort, 10)\n\n        if noSSL {\n            addrSecure = \"\"\n        } else {\n            if secureOnly {\n                addrUnsecure = \"\"\n            }\n            if _, err := os.Stat(serverKey); os.IsNotExist(err) {\n                log.Error(\"Can't find ssl key %s. Use --no-ssl flag to disable\", serverKey)\n                os.Exit(1)\n            }\n            if _, err := os.Stat(serverCert); os.IsNotExist(err) {\n                log.Error(\"Can't find ssl cert %s. Use --no-ssl flag to disable\", serverCert)\n                os.Exit(1)\n            }\n        }\n\n        server.StartServer(addrUnsecure, addrSecure, serverCert, serverKey)\n    },\n}\n\nfunc addServerFlags() {\n    serverCmd.Flags().Uint64VarP(&amp;serverPort, \"port\", \"p\", setServerPort(), \"set the listening port for http\")\n    serverCmd.Flags().Uint64VarP(&amp;securePort, \"secure-port\", \"s\", setSecurePort(), \"set the listening port for https\")\n    serverCmd.Flags().BoolVarP(&amp;noSSL, \"no-ssl\", \"n\", setSSL(), \"use only http\")\n    serverCmd.Flags().BoolVarP(&amp;secureOnly, \"secure-only\", \"o\", setSecureOnly(), \"use only https\")\n    serverCmd.Flags().StringVarP(&amp;serverCert, \"cert\", \"c\", setDefaultServerCert(), \"set the https certificate\")\n    serverCmd.Flags().StringVarP(&amp;serverKey, \"key\", \"k\", setDefaultServerKey(), \"set the key to interact with the https certificate\")\n}\n\nfunc setServerPort() uint64 {\n    return 9099\n}\n\nfunc setSecurePort() uint64 {\n    return 9098\n}\n\nfunc setSSL() bool {\n    return false\n}\n\nfunc setSecureOnly() bool {\n    return false\n}\n\nfunc setDefaultServerCert() string {\n    return \"\"\n}\n\nfunc setDefaultServerKey() string {\n    return \"\"\n}\n</code></pre>\n\n<p>and this is the function where the actual server is started:</p>\n\n<pre><code>func StartServer(addrUnsecure, addrSecure, key, cert string) {\n    log.Warn(\"Hello I'm the marmots' compilers server\")\n    common.InitErisDir()\n    // Routes\n\n    http.HandleFunc(\"/\", CompileHandler)\n    // Use SSL ?\n    log.Debug(cert)\n    if addrSecure != \"\" {\n        log.Debug(\"Using HTTPS\")\n        log.WithField(\"=&gt;\", addrSecure).Debug(\"Listening on...\")\n        if err := http.ListenAndServeTLS(addrUnsecure, cert, key, nil); err != nil {\n            log.Error(\"Cannot serve on http port: \", err)\n            os.Exit(1)\n        }\n    }\n    if addrUnsecure != \"\" {\n        log.Debug(\"Using HTTP\")\n        log.WithField(\"=&gt;\", addrUnsecure).Debug(\"Listening on...\")\n        if err := http.ListenAndServe(addrUnsecure, nil); err != nil {\n            log.Error(\"Cannot serve on http port: \", err)\n            os.Exit(1)\n        }\n    }\n}\n</code></pre>\n\n<p>I've gotten this in both Docker running Ubuntu 14.04 and OS X locally on my machine. Thanks in advance to whoever can help me out. It's kind of embarassing because this seems like it should be a really simple thing to do and I'm willing to bet it's going to be something dumb that's got me here. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1467305649, "post_id": 38129094, "comment_id": 63689475, "body": "<code>$ go install net</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1467306336, "post_id": 38129094, "comment_id": 63689855, "body": "Or to get the entire standard library: <code>go install std</code>"}, {"owner": {"reputation": 336, "user_id": 4060875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_qOrKA2Hfds/AAAAAAAAAAI/AAAAAAAAAB4/36DRA7wFAqM/photo.jpg?sz=128", "display_name": "Josef Hoppe", "link": "https://stackoverflow.com/users/4060875/josef-hoppe"}, "edited": false, "score": 0, "creation_date": 1467313617, "post_id": 38129094, "comment_id": 63693868, "body": "Are you sure it&#39;s a good idea to modify the standard libraries? Updates will cause you to lose your changes, by simply putting them back you might break things."}, {"owner": {"reputation": 7891, "user_id": 1737201, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9d553e4eece2656148b5d0e2a613e53e?s=128&d=identicon&r=PG", "display_name": "mezoni", "link": "https://stackoverflow.com/users/1737201/mezoni"}, "reply_to_user": {"reputation": 336, "user_id": 4060875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_qOrKA2Hfds/AAAAAAAAAAI/AAAAAAAAAB4/36DRA7wFAqM/photo.jpg?sz=128", "display_name": "Josef Hoppe", "link": "https://stackoverflow.com/users/4060875/josef-hoppe"}, "edited": false, "score": 2, "creation_date": 1467346684, "post_id": 38129094, "comment_id": 63704625, "body": "@Bifroth May be an author want propose some changes in the <code>core</code> and want perform some test before create the pull request? Why you don&#39;t ask it about that before say that this is not a good idea? Otherwise, I think that the author is well aware that it is wrong and without that the someone will remind him about that"}, {"owner": {"reputation": 336, "user_id": 4060875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_qOrKA2Hfds/AAAAAAAAAAI/AAAAAAAAAB4/36DRA7wFAqM/photo.jpg?sz=128", "display_name": "Josef Hoppe", "link": "https://stackoverflow.com/users/4060875/josef-hoppe"}, "reply_to_user": {"reputation": 7891, "user_id": 1737201, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9d553e4eece2656148b5d0e2a613e53e?s=128&d=identicon&r=PG", "display_name": "mezoni", "link": "https://stackoverflow.com/users/1737201/mezoni"}, "edited": false, "score": 0, "creation_date": 1467352880, "post_id": 38129094, "comment_id": 63706477, "body": "@mezoni you&#39;re right, I forgot about that. Sorry"}, {"owner": {"reputation": 373, "user_id": 5641538, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8b268f431d5fa6d9f3fc10e059d995a2?s=128&d=identicon&r=PG&f=1", "display_name": "devinov", "link": "https://stackoverflow.com/users/5641538/devinov"}, "reply_to_user": {"reputation": 336, "user_id": 4060875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_qOrKA2Hfds/AAAAAAAAAAI/AAAAAAAAAB4/36DRA7wFAqM/photo.jpg?sz=128", "display_name": "Josef Hoppe", "link": "https://stackoverflow.com/users/4060875/josef-hoppe"}, "edited": false, "score": 0, "creation_date": 1487781796, "post_id": 38129094, "comment_id": 71941809, "body": "@JosefHoppe I was actually told by the Go Devs to do it. They introduced a bug for certain versions and fixed it in a Beta version and told me to patch in the changes so I won&#39;t have to use Beta version."}], "answers": [{"tags": [], "owner": {"reputation": 1663, "user_id": 197160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWAGB.jpg?s=128&g=1", "display_name": "elimisteve", "link": "https://stackoverflow.com/users/197160/elimisteve"}, "is_accepted": true, "score": 11, "last_activity_date": 1486980705, "creation_date": 1486980705, "answer_id": 42201507, "question_id": 38129094, "link": "https://stackoverflow.com/questions/38129094/how-do-i-rebuild-native-golang-packages-after-i-modify-them/42201507#42201507", "title": "How do I rebuild native Golang packages after I modify them?", "body": "<p>This works:</p>\n\n<pre><code>$ go install -a net\n</code></pre>\n\n<p>It wasn't rebuilding for me either, but the -a forces a rebuild even if the toolchain thinks the specified package is up to date.</p>\n"}, {"tags": [], "owner": {"reputation": 904, "user_id": 2759462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de467ec1a458adebfcad737f12070b17?s=128&d=identicon&r=PG", "display_name": "Rafael Barros", "link": "https://stackoverflow.com/users/2759462/rafael-barros"}, "is_accepted": false, "score": 0, "last_activity_date": 1545331081, "creation_date": 1545331081, "answer_id": 53874290, "question_id": 38129094, "link": "https://stackoverflow.com/questions/38129094/how-do-i-rebuild-native-golang-packages-after-i-modify-them/53874290#53874290", "title": "How do I rebuild native Golang packages after I modify them?", "body": "<p>In case someone is using Docker:</p>\n\n<p>My changes wasn't having effect because I was editing the package outside the container. Only the code of our project is mapped by a volume inside the container, but not the third party packages.</p>\n\n<p>Once I edited the package code inside the container, I do not even had to run a <code>go install -a ...</code> like proposed by @elimisteve. It worked just by recompiling the project.</p>\n"}], "owner": {"reputation": 373, "user_id": 5641538, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8b268f431d5fa6d9f3fc10e059d995a2?s=128&d=identicon&r=PG&f=1", "display_name": "devinov", "link": "https://stackoverflow.com/users/5641538/devinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4933, "favorite_count": 1, "accepted_answer_id": 42201507, "answer_count": 2, "score": 12, "last_activity_date": 1545331081, "creation_date": 1467305352, "question_id": 38129094, "link": "https://stackoverflow.com/questions/38129094/how-do-i-rebuild-native-golang-packages-after-i-modify-them", "title": "How do I rebuild native Golang packages after I modify them?", "body": "<p>I modified the net package and I want to use the modified version in my application but it keeps using the old code.</p>\n"}, {"tags": ["go", "pickle"], "comments": [{"owner": {"reputation": 1073, "user_id": 1398935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70b2eee8b41a6a867c13664c2f24cbd4?s=128&d=identicon&r=PG", "display_name": "M Sost", "link": "https://stackoverflow.com/users/1398935/m-sost"}, "edited": false, "score": 2, "creation_date": 1467305463, "post_id": 38129076, "comment_id": 63689366, "body": "Have you looked in to a library like <a href=\"https://godoc.org/github.com/hydrogen18/stalecucumber\" rel=\"nofollow noreferrer\">godoc.org/github.com/hydrogen18/stalecucumber</a> ?"}, {"owner": {"reputation": 21412, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "edited": false, "score": 12, "creation_date": 1467305559, "post_id": 38129076, "comment_id": 63689422, "body": "The Golang equivalent of Pickle is <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\">gob</a>."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1467311056, "post_id": 38129076, "comment_id": 63692449, "body": "Well, <code>pickle</code> is nothing more than an arbitrary serialization format. So you can pick your own arbitrary format. With nothing but a standard library, you have <code>encoding&#47;gob</code>, <code>encoding&#47;json</code> and <code>encoding&#47;xml</code>."}, {"owner": {"reputation": 301, "user_id": 9456786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46f04b80a588e3d707a0138782230649?s=128&d=identicon&r=PG", "display_name": "kirr", "link": "https://stackoverflow.com/users/9456786/kirr"}, "edited": false, "score": 0, "creation_date": 1588063544, "post_id": 38129076, "comment_id": 108748504, "body": "For the reference, if one needs compatibility with Python, from Go side pickles can be saved and loaded using <a href=\"https://godoc.org/github.com/kisielk/og-rek\" rel=\"nofollow noreferrer\">godoc.org/github.com/kisielk/og-rek</a> ."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 11106641, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y37lg1x0f7A/AAAAAAAAAAI/AAAAAAAAACQ/3lAB4cwajSQ/photo.jpg?sz=128", "display_name": "Changgeng Zhao", "link": "https://stackoverflow.com/users/11106641/changgeng-zhao"}, "is_accepted": false, "score": 3, "last_activity_date": 1551037723, "creation_date": 1551037723, "answer_id": 54855846, "question_id": 38129076, "link": "https://stackoverflow.com/questions/38129076/is-it-possible-to-pickle-instances-of-structs-in-golang/54855846#54855846", "title": "Is it possible to pickle instances of structs in Golang", "body": "<p>Try <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\">gob</a> or <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\">encoding/json</a> to marshal your objects. After that, you can store the string to a file.</p>\n\n<p><a href=\"https://play.golang.org/p/JTMWkkbvOOh\" rel=\"nofollow noreferrer\">Here</a> is an example to use json:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n     \"fmt\"\n     \"os\"\n)\n\ntype Book struct {\n    Title string\n    Pages []*Page\n}\n\ntype Page struct {\n    pageNumber int // remember to Capitalize the fields you want to marshal\n    Content    string\n}\n\nfunc main() {\n    // First make a book with nested array of struct pointers\n    myBook := &amp;Book{Title: \"this is a title\", Pages: make([]*Page, 0)}\n    for i := 0; i &lt; 3; i++ {\n        myBook.Pages = append(myBook.Pages, &amp;Page{i + 1, \"words\"})\n    }\n\n    // Open a file and dump JSON to it!\n    f1, err := os.Create(\"/tmp/file1\")\n    enc := json.NewEncoder(f1)\n    err = enc.Encode(myBook)\n    if err != nil {\n        panic(err)\n    }\n    f1.Close()\n\n    // Open the file and load the object back!\n    f2, err := os.Open(\"/tmp/file1\")\n    dec := json.NewDecoder(f2)\n    var v Book\n    err = dec.Decode(&amp;v)\n    if err != nil {\n        panic(err)\n    }\n    f2.Close()\n\n    // Check\n    fmt.Println(v.Title)            // Output: &lt;this is a title&gt;\n    fmt.Println(v.Pages[1].Content) // Output: &lt;words&gt;\n\n    // pageNumber is not capitalized so it was not marshaled\n    fmt.Println(v.Pages[1].pageNumber) // Output: &lt;0&gt;\n\n}\n</code></pre>\n"}], "owner": {"reputation": 2449, "user_id": 4313927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/568720341/picture?type=large", "display_name": "Nicky Feller", "link": "https://stackoverflow.com/users/4313927/nicky-feller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4217, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1551037723, "creation_date": 1467305268, "question_id": 38129076, "link": "https://stackoverflow.com/questions/38129076/is-it-possible-to-pickle-instances-of-structs-in-golang", "title": "Is it possible to pickle instances of structs in Golang", "body": "<p>I am doing some machine learning in Golang. I am now hitting a wall, my trained classifier takes almost half a minute to train and want to save that instance of the classifier so that I do not have to train in from scratch every time. How should someone go about doing this is Golang?\n<em>FYI my classifier is a struct</em></p>\n\n<hr>\n\n<p>When I do this type of stuff with python, it's very easy with pickle. Is there an equivalent?</p>\n"}, {"tags": ["testing", "go", "vendor"], "answers": [{"tags": [], "owner": {"reputation": 3000, "user_id": 1335245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b201e069f3e6868c1c0285f6e31801c?s=128&d=identicon&r=PG", "display_name": "Charney Kaye", "link": "https://stackoverflow.com/users/1335245/charney-kaye"}, "is_accepted": true, "score": 2, "last_activity_date": 1467309569, "creation_date": 1467309569, "answer_id": 38130260, "question_id": 38128196, "link": "https://stackoverflow.com/questions/38128196/why-isnt-go-1-6-2-searching-vendor-for-packages/38130260#38130260", "title": "Why isn&#39;t Go 1.6.2 searching vendor/ for packages?", "body": "<p>This is fixed by moving the <code>vendor/</code> folder to inside of the <code>src/</code> folder, like:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 glide.yaml\n\u251c\u2500\u2500 glide.lock\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 pkg\n\u2514\u2500\u2500 src\n  \u00a0\u00a0 \u2514\u2500\u2500 vendor\n</code></pre>\n"}], "owner": {"reputation": 3000, "user_id": 1335245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b201e069f3e6868c1c0285f6e31801c?s=128&d=identicon&r=PG", "display_name": "Charney Kaye", "link": "https://stackoverflow.com/users/1335245/charney-kaye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 38130260, "answer_count": 1, "score": 0, "last_activity_date": 1467309569, "creation_date": 1467302456, "question_id": 38128196, "link": "https://stackoverflow.com/questions/38128196/why-isnt-go-1-6-2-searching-vendor-for-packages", "title": "Why isn&#39;t Go 1.6.2 searching vendor/ for packages?", "body": "<p>The structure of the project is:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 glide.yaml\n\u251c\u2500\u2500 glide.lock\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 pkg\n\u251c\u2500\u2500 src\n\u2514\u2500\u2500 vendor\n</code></pre>\n\n<p>I'm using <a href=\"https://github.com/Masterminds/glide\" rel=\"nofollow\">Glide</a> for dependency management, and the <code>GOPATH</code> is the location of my project root (absolute path resolving to <code>.</code> in the above tree.)</p>\n\n<p>Glide appears to install dependencies correctly, however when attempting to run tests with Go 1.6.2, I don't see it even looking in the <code>vendor/</code> folder before failing:</p>\n\n<pre><code>GOPATH=/home/charney/myproject go test -i ...\nsrc/myapp/main.go:36:2: cannot find package \"golang.org/x/net/context\" in any of:\n    /usr/local/go/src/golang.org/x/net/context (from $GOROOT)\n    /home/charneymyproject/src/golang.org/x/net/context (from $GOPATH)\n</code></pre>\n\n<p>The package it is looking for <em>is</em> located at <code>/home/charneymyproject/vendor/golang.org/x/net/context</code></p>\n"}, {"tags": ["mongodb", "go"], "answers": [{"comments": [{"owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 2, "creation_date": 1499953903, "post_id": 38128237, "comment_id": 77137872, "body": "which is faster ?"}], "tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": true, "score": 1, "last_activity_date": 1467302585, "last_edit_date": 1495539855, "creation_date": 1467302585, "answer_id": 38128237, "question_id": 38127583, "link": "https://stackoverflow.com/questions/38127583/get-last-inserted-element-from-mongodb-in-golang/38128237#38128237", "title": "Get last inserted element from mongodb in GoLang", "body": "<p>Apparently mongoDB is by default sorted by insertion time according to \n<a href=\"https://stackoverflow.com/questions/4421207/mongodb-how-to-get-the-last-n-records\">this question</a> so you can just skip the first N elements of the collection like so.</p>\n\n<pre><code>var myData SavedData \ndbSize, err := collection.Count()\nif err != nil {\n        return err\n}\n\nerr = c.Find(nil).skip(dbSize-1).One(&amp;myData)\nif err != nil {\n        return err\n}\n</code></pre>\n\n<p>or you can search in the reverse order</p>\n\n<pre><code>c.Find(bson.M{ \"$natural\": -1 }).One(&amp;myData)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 726, "user_id": 12868928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15264951fc07ea469b9ed450972388dc?s=128&d=identicon&r=PG&f=1", "display_name": "mama", "link": "https://stackoverflow.com/users/12868928/mama"}, "edited": false, "score": 1, "creation_date": 1614287273, "post_id": 65602305, "comment_id": 117347488, "body": "Hi I get <code>unknown top level operator: $natural</code> if I try this. Do you reckon what can it be?"}], "tags": [], "owner": {"reputation": 29, "user_id": 14041713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a26e56e88940f2ccf7bf5c881d592fc?s=128&d=identicon&r=PG&f=1", "display_name": "blacha", "link": "https://stackoverflow.com/users/14041713/blacha"}, "is_accepted": false, "score": 2, "last_activity_date": 1609961725, "creation_date": 1609961725, "answer_id": 65602305, "question_id": 38127583, "link": "https://stackoverflow.com/questions/38127583/get-last-inserted-element-from-mongodb-in-golang/65602305#65602305", "title": "Get last inserted element from mongodb in GoLang", "body": "<p>The accepted answer is 5 years old. This should work Today with mongodb driver</p>\n<pre><code>collection.FindOne(ctx, bson.M{&quot;$natural&quot;: -1})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 726, "user_id": 12868928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15264951fc07ea469b9ed450972388dc?s=128&d=identicon&r=PG&f=1", "display_name": "mama", "link": "https://stackoverflow.com/users/12868928/mama"}, "is_accepted": false, "score": 0, "last_activity_date": 1614289928, "creation_date": 1614289928, "answer_id": 66376969, "question_id": 38127583, "link": "https://stackoverflow.com/questions/38127583/get-last-inserted-element-from-mongodb-in-golang/66376969#66376969", "title": "Get last inserted element from mongodb in GoLang", "body": "<p>You have to use options with mongo-driver if you want to get the latest document in the collection</p>\n<pre class=\"lang-golang prettyprint-override\"><code>import(\n    ...\n    &quot;go.mongodb.org/mongo-driver/mongo/options&quot;\n)\n\nmyOptions := options.FindOne()\nmyOptions.SetSort(bson.M{&quot;$natural&quot;:-1})\ncollection.FindOne(ctx, bson.M{}, myOptions)\n</code></pre>\n"}], "owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2724, "favorite_count": 0, "accepted_answer_id": 38128237, "answer_count": 3, "score": 0, "last_activity_date": 1614289928, "creation_date": 1467300714, "question_id": 38127583, "link": "https://stackoverflow.com/questions/38127583/get-last-inserted-element-from-mongodb-in-golang", "title": "Get last inserted element from mongodb in GoLang", "body": "<p>I have a struct like this:</p>\n\n<pre><code>type SavedData struct {\n    ID   bson.ObjectId `bson:\"_id\"`\n    Data string\n    Date time.Time\n}\n</code></pre>\n\n<p>I also have my </p>\n\n<pre><code>collection := database.C(\"coll_name\")\n</code></pre>\n\n<p>How do I retrieve the last inserted entry in this collection ? </p>\n\n<p>Thank you</p>\n"}, {"tags": ["go", "middleware", "negroni"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 3, "creation_date": 1467300561, "post_id": 38126850, "comment_id": 63686214, "body": "ive never used negroni but I suppose you could check <code>c.Request.Method</code> and <code>c.Request.URL.Path</code> and switch off those"}, {"owner": {"reputation": 149, "user_id": 1557590, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/XNL7p.png?s=128&g=1", "display_name": "Stewart Webb", "link": "https://stackoverflow.com/users/1557590/stewart-webb"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1467302681, "post_id": 38126850, "comment_id": 63687727, "body": "My only problem with <code>c.Request.URL.Path</code> is that it I am using variables in the routes so I would need to do some pattern matching to check it is the route I think it is. Which I can do but it seems inefficient."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1467310115, "post_id": 38126850, "comment_id": 63691975, "body": "i guess you could manually invoke your permission checks in the handlers like <code>isRoutePermitted(c, &quot;api.user.create&quot;)</code>? I can&#39;t think of anything else built in"}, {"owner": {"reputation": 149, "user_id": 1557590, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/XNL7p.png?s=128&g=1", "display_name": "Stewart Webb", "link": "https://stackoverflow.com/users/1557590/stewart-webb"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1467811190, "post_id": 38126850, "comment_id": 63872002, "body": "Thanks Plato. I have ended up using your second suggestion. It&#39;s not so bad it is just one functional call. Thanks again."}], "owner": {"reputation": 149, "user_id": 1557590, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/XNL7p.png?s=128&g=1", "display_name": "Stewart Webb", "link": "https://stackoverflow.com/users/1557590/stewart-webb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 658, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467298768, "creation_date": 1467298768, "question_id": 38126850, "link": "https://stackoverflow.com/questions/38126850/golang-middleware-authentication-depending-on-route", "title": "Golang middleware authentication depending on route", "body": "<p>I am building an API in Go. I handle all authentication by including a secret token in the header. I have added some middleware using negroni that picks this out of the header and checks the database to see if it exists. </p>\n\n<p>This is fine but now I want to do permissions based upon the route in question. I have a table in a database with permissions for only some routes etc and I would like to use this logic in the middleware so that the handlers never need to worry about it.</p>\n\n<p>My problem is that the middleware needs to know what handler is being called so that it can check for the correct record in the database. What is the best way to pass or extract the current route / handler using negroni?</p>\n\n<p>Thanks</p>\n"}]