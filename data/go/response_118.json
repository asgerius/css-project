[{"tags": ["go", "code-coverage"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1492042896, "post_id": 43381335, "comment_id": 73825300, "body": "Is it an option to execute your tests using the go test framework?"}, {"owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492043552, "post_id": 43381335, "comment_id": 73825459, "body": "That is possible. I could just effectively stub the os.Args and call it from a test. However, I&#39;d prefer a black box approach where I can see what areas of the application are not touched when run through the CLI. Also the bash might get way more complicated and change a lot in time. It&#39;s easier to manage like this than through Go."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 5, "last_activity_date": 1526827471, "last_edit_date": 1526827471, "creation_date": 1492043401, "answer_id": 43381703, "question_id": 43381335, "link": "https://stackoverflow.com/questions/43381335/how-to-capture-code-coverage-from-a-go-binary/43381703#43381703", "title": "How to capture code coverage from a Go binary?", "body": "<p>The Go coverage tool only works in conjunction with the testing package. But not all hope is lost.</p>\n\n<p>If you can coerce your integration tests into the go testing framework, you should have all you need.  This shouldn't be as hard as it sounds.</p>\n\n<p>Basically:</p>\n\n<ol>\n<li><p>Write a test file that executes your <code>main()</code> function in a go routine:</p>\n\n<pre><code>func TestMainApp(t *testing.T) {\n    go main()\n    // .. then start your integration tests\n}\n</code></pre></li>\n<li><p>With your real app running from within a test, start your integration tests--likely with the help of <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">exec.Cmd</a>.</p></li>\n<li><p>Gather your coverage stats.</p></li>\n<li><p>Profit.</p></li>\n</ol>\n\n<p>This article, <a href=\"https://blog.cloudflare.com/go-coverage-with-external-tests/\" rel=\"nofollow noreferrer\">Go coverage with external tests</a>, from a year ago, outlines a similar approach.</p>\n"}], "owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1642, "favorite_count": 0, "accepted_answer_id": 43381703, "answer_count": 1, "score": 5, "last_activity_date": 1599705682, "creation_date": 1492040614, "question_id": 43381335, "link": "https://stackoverflow.com/questions/43381335/how-to-capture-code-coverage-from-a-go-binary", "title": "How to capture code coverage from a Go binary?", "body": "<p>I know its possible to capture code coverage metrics when running unit tests. However, we would like to know what the coverage is when we run integrations tests (plural) against the binary itself, like:</p>\n\n<pre><code>go build\n./mybin somefile1\n./mybin somefile2\n# ... test a bunch more files and input flags\n</code></pre>\n\n<p>Is it possible to do this? The binary can be built just for the purpose of testing, so any compile options as needed.</p>\n"}, {"tags": ["debugging", "go", "delve"], "answers": [{"comments": [{"owner": {"reputation": 2194, "user_id": 2342229, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/648dd34e5af6dcf4e4fd7237a0817a92?s=128&d=identicon&r=PG", "display_name": "nicocesar", "link": "https://stackoverflow.com/users/2342229/nicocesar"}, "edited": false, "score": 0, "creation_date": 1616593770, "post_id": 43381220, "comment_id": 118050973, "body": "I got this to work dlv exec ./pkg.test -- -gocheck.f  TestLoadImage but Type &#39;help&#39; for list of commands. (dlv) step Stopped at: 0x7fe7886b2090 =&gt;   1:\tno source available Command failed: no source for PC 0x7fe7886b2090  How do you indicate where the source code should be?"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1492039760, "creation_date": 1492039760, "answer_id": 43381220, "question_id": 43380530, "link": "https://stackoverflow.com/questions/43380530/debugging-tests-with-delve/43381220#43381220", "title": "Debugging tests with delve", "body": "<p>I'm not familiar with delve, but if it can work on a compiled binary, just compile your tests using the <code>-c</code> flag:</p>\n\n<pre><code>    -c\n        Compile the test binary to pkg.test but do not run it\n        (where pkg is the last element of the package's import path).\n        The file name can be changed with the -o flag.\n</code></pre>\n\n<p>Then run delve on the output.</p>\n"}, {"comments": [{"owner": {"reputation": 36339, "user_id": 30946, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/350f30695a2ab75b99d3fce947e856b9?s=128&d=identicon&r=PG", "display_name": "jcollum", "link": "https://stackoverflow.com/users/30946/jcollum"}, "edited": false, "score": 0, "creation_date": 1589392688, "post_id": 43403880, "comment_id": 109279048, "body": "Where is <code>-test.run</code> documented? It&#39;s not in <a href=\"https://github.com/derekparker/delve/blob/master/Documentation/usage/dlv_test.md\" rel=\"nofollow noreferrer\">github.com/derekparker/delve/blob/master/Documentation/usage&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "reply_to_user": {"reputation": 36339, "user_id": 30946, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/350f30695a2ab75b99d3fce947e856b9?s=128&d=identicon&r=PG", "display_name": "jcollum", "link": "https://stackoverflow.com/users/30946/jcollum"}, "edited": false, "score": 0, "creation_date": 1589425333, "post_id": 43403880, "comment_id": 109291491, "body": "It&#39;s a flag for the binary compiled with <code>go test</code>, not delve @jcollum"}], "tags": [], "owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "is_accepted": true, "score": 19, "last_activity_date": 1549643363, "last_edit_date": 1549643363, "creation_date": 1492132002, "answer_id": 43403880, "question_id": 43380530, "link": "https://stackoverflow.com/questions/43380530/debugging-tests-with-delve/43403880#43403880", "title": "Debugging tests with delve", "body": "<p>Use <a href=\"https://github.com/derekparker/delve/blob/master/Documentation/usage/dlv_test.md\" rel=\"noreferrer\"><code>dlv test</code></a>:</p>\n\n<pre><code>$ dlv test -- -test.v\nType 'help' for list of commands.\n(dlv) continue\n=== RUN   TestReadFileError\n--- PASS: TestReadFileError (0.00s)\n=== RUN   TestReadFile\n--- PASS: TestReadFile (0.00s)\n[..]\nPASS\nProcess 8014 has exited with status 0\n(dlv) quit\nProcess 8014 has exited with status 0\n</code></pre>\n\n<p>You can also pass <code>-test.run</code> to select tests to run (just like <code>go test -run</code>).</p>\n\n<p>Internally, this is the same as Flimzy's answer (it compiles the test binary with <code>go test -c</code>), but more streamlined and won't leave .test files for you to clean up.</p>\n"}], "owner": {"reputation": 1340, "user_id": 2362377, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/62b8eb91e4d98ef37d2f1eaa56799c74?s=128&d=identicon&r=PG&f=1", "display_name": "SpiderRico", "link": "https://stackoverflow.com/users/2362377/spiderrico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8993, "favorite_count": 4, "accepted_answer_id": 43403880, "answer_count": 2, "score": 13, "last_activity_date": 1549643363, "creation_date": 1492035443, "question_id": 43380530, "link": "https://stackoverflow.com/questions/43380530/debugging-tests-with-delve", "title": "Debugging tests with delve", "body": "<p>I'm using <strong>\"go test -v</strong>\" to run bunch of unit tests. I'd like to debug them using delve. When I try to run debugger, I get an <strong>\"Can not debug non-main package\"</strong> error. So, how can I debug unit tests using delve debugger ?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 3, "last_activity_date": 1492033679, "last_edit_date": 1492033679, "creation_date": 1492032863, "answer_id": 43380020, "question_id": 43379955, "link": "https://stackoverflow.com/questions/43379955/declare-a-function-type-with-an-arbitrary-return-type-in-golang/43380020#43380020", "title": "Declare a function type with an arbitrary return type in golang", "body": "<p>You're missing the return type in the anonymous function expressions:</p>\n\n<pre><code>var g TaskWithValue = func() interface{} { return \"foo\" }\n\nvar h TaskWithValue = func() interface{} { return 123 }\n</code></pre>\n"}], "owner": {"reputation": 21295, "user_id": 329781, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eea7eacef5dde692524f0ea01a7ec964?s=128&d=identicon&r=PG", "display_name": "jonderry", "link": "https://stackoverflow.com/users/329781/jonderry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3672, "favorite_count": 0, "accepted_answer_id": 43380020, "answer_count": 1, "score": 1, "last_activity_date": 1513814450, "creation_date": 1492032547, "question_id": 43379955, "link": "https://stackoverflow.com/questions/43379955/declare-a-function-type-with-an-arbitrary-return-type-in-golang", "title": "Declare a function type with an arbitrary return type in golang", "body": "<p>I'm new to go and have come across the following issue that I haven't been able to find covered in the tutorial or google searches, though I'm sure it must be a basic aspect of the language I have missed. I have code like the following:</p>\n\n<pre><code>type Task func()\n\nvar f Task = func() { fmt.Println(\"foo\") }\n\ntype TaskWithValue func() interface{}\n\nvar g TaskWithValue = func() { return \"foo\" }\n\nvar h TaskWithValue = func() { return 123 }\n</code></pre>\n\n<p>In <code>f</code> above, there is no compiler error, but for <code>g</code> and <code>h</code> there are errors like the following:</p>\n\n<pre><code>Cannot use func() { return \"foo\" } (type func ()) as type TaskWithValue in assignment\n</code></pre>\n\n<p>Essentially, I'm trying to define a <code>Task</code> type that can have an arbitrary return type. In other languages, I would simply give <code>Task</code> a type parameter, like <code>Task&lt;Integer&gt;</code> or <code>Task&lt;String&gt;</code>, but since go does not have generics/templates, I understood the workaround is to use return type <code>interface{}</code> and then cast the results. What am I missing to get this example working?</p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 346, "user_id": 11280510, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--uUzUlVUo-Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDingZ-LAjdKNuPBEdgtTWKrvuSg/mo/photo.jpg?sz=128", "display_name": "Lautaro Jayat", "link": "https://stackoverflow.com/users/11280510/lautaro-jayat"}, "edited": false, "score": 0, "creation_date": 1611418101, "post_id": 43548347, "comment_id": 116447190, "body": "I think that this is the best approach. When you register a Query with the gorilla mux function, what you are doing is assigning a handler for that specific route, with that specific query params. In my opinion, is better to have just one route and use different controllers/services depending on the presence of certain query. This way you can have the routes registered only one, and then decouple the api from the controller/service logic."}], "tags": [], "owner": {"reputation": 1826, "user_id": 3628317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e09d9646795e000b8861f8f3ef81bb68?s=128&d=identicon&r=PG&f=1", "display_name": "levo4ka", "link": "https://stackoverflow.com/users/3628317/levo4ka"}, "is_accepted": true, "score": 32, "last_activity_date": 1492794211, "creation_date": 1492794211, "answer_id": 43548347, "question_id": 43379942, "link": "https://stackoverflow.com/questions/43379942/how-to-have-an-optional-query-in-get-request-using-gorilla-mux/43548347#43548347", "title": "How to have an optional query in GET request using Gorilla Mux?", "body": "<p>So I found the solution to re-write my logic as:</p>\n\n<pre><code>r.HandleFunc(\"/user\", UserByValueHandler).Methods(\"GET\")\n</code></pre>\n\n<p>And in <code>UserByValueHandler</code> we can have something like:</p>\n\n<pre><code>func UserByValueHandler(w http.ResponseWriter, r *http.Request) {\n       v := r.URL.Query()\n\n       username := v.Get(\"username\")\n       email := v.Get(\"email\")\n       .....\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4150, "user_id": 1241464, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/090f6b7a1f3d845468af273b5accedc9?s=128&d=identicon&r=PG", "display_name": "Ron", "link": "https://stackoverflow.com/users/1241464/ron"}, "is_accepted": false, "score": 1, "last_activity_date": 1546729923, "creation_date": 1546729923, "answer_id": 54057173, "question_id": 43379942, "link": "https://stackoverflow.com/questions/43379942/how-to-have-an-optional-query-in-get-request-using-gorilla-mux/54057173#54057173", "title": "How to have an optional query in GET request using Gorilla Mux?", "body": "<p>Just a comment to the previous answer. </p>\n\n<p>We can just add two routes there, I feel it is more readable, like below:</p>\n\n<pre><code>r.HandleFunc(\"/user\", userByValueHandler).\n    Queries(\n        \"username\", \"{username}\",\n        \"email\", \"{email}\",\n    ).\n    Methods(\"GET\")\nr.HandleFunc(\"/user\", UserByValueHandler).Methods(\"GET\")\n</code></pre>\n"}], "owner": {"reputation": 1826, "user_id": 3628317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e09d9646795e000b8861f8f3ef81bb68?s=128&d=identicon&r=PG&f=1", "display_name": "levo4ka", "link": "https://stackoverflow.com/users/3628317/levo4ka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7920, "favorite_count": 4, "accepted_answer_id": 43548347, "answer_count": 2, "score": 8, "last_activity_date": 1546729923, "creation_date": 1492032492, "question_id": 43379942, "link": "https://stackoverflow.com/questions/43379942/how-to-have-an-optional-query-in-get-request-using-gorilla-mux", "title": "How to have an optional query in GET request using Gorilla Mux?", "body": "<p>I would like to have some of my query parameters be optional. As for now, I have </p>\n\n<pre><code>r.HandleFunc(\"/user\", userByValueHandler).\n    Queries(\n        \"username\", \"{username}\",\n        \"email\", \"{email}\",\n    ).\n    Methods(\"GET\")\n</code></pre>\n\n<p>But in this case \"username\" AND \"email\" needs to be present in the request. I want to have more flexible choice: have 2 of them OR have just one of them (but not zero parameters).</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["arrays", "go", "multidimensional-array", "hash"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492032449, "post_id": 43379772, "comment_id": 73821954, "body": "<code>type Row struct { name string .... }</code> --- start with something and return when you have a particular question."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6510985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a15adaf1830d7c7b21c1b027cb76245?s=128&d=identicon&r=PG&f=1", "display_name": "Slagathor The Destroyer", "link": "https://stackoverflow.com/users/6510985/slagathor-the-destroyer"}, "edited": false, "score": 0, "creation_date": 1492034399, "post_id": 43380082, "comment_id": 73822719, "body": "This is excellent! I do have a few questions, what is the purpose of the empty brackets before Date and User? Can you explain what type is on the struct? What&#39;s the advantage of creating a struct for Image instead of just a map?"}], "tags": [], "owner": {"reputation": 317, "user_id": 553623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/714f7e08869a137b708e4d972bafb36e?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/553623/eric"}, "is_accepted": true, "score": 2, "last_activity_date": 1492033130, "last_edit_date": 1495540005, "creation_date": 1492033130, "answer_id": 43380082, "question_id": 43379772, "link": "https://stackoverflow.com/questions/43379772/making-array-of-hashes-in-golang/43380082#43380082", "title": "Making Array of Hashes in Golang", "body": "<p>What is called a 'hash' in Ruby is called a 'map' (translating keys to values) in Go. </p>\n\n<p>However, Go is a <a href=\"https://stackoverflow.com/questions/1517582/what-is-the-difference-between-statically-typed-and-dynamically-typed-languages\">statically typechecked language</a>. A map can only map a certain type to another type, e.g. a map[string]int maps string values to integeger. That is not what you want here. </p>\n\n<p>So what you want is a struct. Indeed, you need to define the type beforehand. So what you would do: </p>\n\n<pre><code>// declaring a separate 'Date' type that you may or may not want to encode as int. \ntype Date int \ntype User struct {\n    Name string\n    Dates []Date\n    Images map[string]string\n}\n</code></pre>\n\n<p>Now that this type is defined, you can use it in another type: </p>\n\n<pre><code>ar := []User{\n  User{\n    Name: \"Tom\",\n    Dates: []Date{20170522, 20170622},\n    Images: map[string]string{\"profile\":\"assets/tom-profile\", \"full\": \"assets/tom-full\"},\n  },\n  User{\n    Name: \"Pat\",\n    Dates: []Date{20170515, 20170520},\n    Images: map[string]string{\"profile\":\"assets/pat-profile\", \"full\": \"assets/pat-full\"},\n  },\n}   \n</code></pre>\n\n<p>Note how we are defining User as a struct, but images as a map of string to image. You could also define a separate Image type:</p>\n\n<pre><code>type Image struct {\n  Type string // e.g. \"profile\"\n  Path string // e.g. \"assets/tom-profile\"\n}\n</code></pre>\n\n<p>You would then not define Images as <code>map[string]string</code> but as <code>[]Image</code>, that is, slice of Image structs. Which one is more appropriate depends on the use case. </p>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 2, "last_activity_date": 1492033740, "creation_date": 1492033740, "answer_id": 43380201, "question_id": 43379772, "link": "https://stackoverflow.com/questions/43379772/making-array-of-hashes-in-golang/43380201#43380201", "title": "Making Array of Hashes in Golang", "body": "<p>You don't need to declare the variable type beforehand, at least not in this simple example, although you need to \"mention\" your types when initializing your values with <em>composite literals</em>.</p>\n\n<p>For example this <code>[{}]</code> (array of objects?) makes no sense to the Go compiler, instead you need to write something like this <code>[]map[string]interface{}{}</code> (slice of maps whose keys are strings and whose values can have any type)</p>\n\n<p>To break it down:</p>\n\n<ol>\n<li><code>[]</code> - slice of whatever type comes after it</li>\n<li><code>map</code> - builtin map (think hash)</li>\n<li><code>[string]</code> - inside the square brackets is the type of the map key,\ncan be <strong>almost</strong> any type</li>\n<li><code>interface{}</code> - the type of the map values</li>\n<li><code>{}</code> - this initializes/allocate the whole thing</li>\n</ol>\n\n<p>So your example in Go would look something like this:</p>\n\n<pre><code>var Array = []map[string]interface{}{\n    {\"name\":\"Tom\", \"dates\": []int{20170522, 20170622}, \"images\": map[string]string{\"profile\": \"assets/tom-profile\", \"full\": \"assets/tom-full\"}},\n    {\"name\":\"Pat\", \"dates\": []int{20170515, 20170520}, \"images\": map[string]string{\"profile\": \"assets/pat-profile\", \"full\": \"assets/pat-full\"}},\n    // ...\n}\n</code></pre>\n\n<p>Read more on maps and what key types you can use here: <a href=\"https://golang.org/ref/spec#Map_types\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Map_types</a></p>\n\n<p>That said, in Go, most of the time, you would first define your structured types more concretely and then use them instead of maps, so something like this makes more sense in Go:</p>\n\n<pre><code>type User struct {\n    Name string\n    Dates []int\n    Images Images\n}\n\ntype Images struct {\n    Profile string\n    Full string\n}\n\nvar Array = []User{\n    {Name:\"Tom\", Dates:[]int{20170522, 20170622}, Images:Images{Profile:\"assets/tom-profile\", Full:\"assets/tom-full\"}},\n    {Name:\"Pat\", Dates:[]int{20170515, 20170520}, Images:Images{Profile:\"assets/pat-profile\", Full:\"assets/pat-full\"}},\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6510985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a15adaf1830d7c7b21c1b027cb76245?s=128&d=identicon&r=PG&f=1", "display_name": "Slagathor The Destroyer", "link": "https://stackoverflow.com/users/6510985/slagathor-the-destroyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2553, "favorite_count": 0, "accepted_answer_id": 43380082, "answer_count": 2, "score": 1, "last_activity_date": 1492033740, "creation_date": 1492031750, "question_id": 43379772, "link": "https://stackoverflow.com/questions/43379772/making-array-of-hashes-in-golang", "title": "Making Array of Hashes in Golang", "body": "<p>I'm brand new to Go and having some trouble with nested data structures. Below is a array of hashes I mocked up that I need to make in Golang. I'm just confused with the whole having to declare the variable type beforehand and whatnot. Any ideas? </p>\n\n<pre><code> var Array = [\n   {name: 'Tom', dates: [20170522, 20170622], images: {profile: 'assets/tom-profile', full: 'assets/tom-full'}},\n   {name: 'Pat', dates: [20170515, 20170520], images: {profile: 'assets/pat-profile', full: 'assets/pat-full'}} \n    ...,\n    ... ]\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1492031447, "last_edit_date": 1492031447, "creation_date": 1492030323, "answer_id": 43379443, "question_id": 43379394, "link": "https://stackoverflow.com/questions/43379394/error-while-creating-array-of-struct-and-initializing-elements-in-it/43379443#43379443", "title": "Error while creating array of struct and initializing elements in it", "body": "<p>Change the code to declare an array of pointer to TODO:</p>\n\n<pre><code>var todoArr [2]*TODO\n\nfE := &amp;TODO{Number: 10, Task: \"Task1\"}\nsE := &amp;TODO{Number: 11, Task: \"Task2\"}\ntodoArr[0] = fE\ntodoArr[1] = sE\n</code></pre>\n\n<p>or change the code to put TODO values in the array:</p>\n\n<pre><code>var todoArr [2]TODO\n\nfE := TODO{Number: 10, Task: \"Task1\"}\nsE := TODO{Number: 11, Task: \"Task2\"}\ntodoArr[0] = fE\ntodoArr[1] = sE\n</code></pre>\n\n<p>You  can declare a slice using literal syntax as</p>\n\n<pre><code>[]*TODO{&amp;TODO{Number: 10, Task: \"Task1\"}, &amp;TODO{Number: 11, Task: \"Task2\"}}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>[]TODO{TODO{Number: 10, Task: \"Task1\"}, TODO{Number: 11, Task: \"Task2\"}}\n</code></pre>\n\n<p>depending on your choice of using pointers or not.</p>\n"}], "owner": {"reputation": 456, "user_id": 2897520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/jJbw8.jpg?s=128&g=1", "display_name": "Ahmed Magdy", "link": "https://stackoverflow.com/users/2897520/ahmed-magdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 43379443, "answer_count": 1, "score": 0, "last_activity_date": 1492031447, "creation_date": 1492030165, "question_id": 43379394, "link": "https://stackoverflow.com/questions/43379394/error-while-creating-array-of-struct-and-initializing-elements-in-it", "title": "Error while creating array of struct and initializing elements in it", "body": "<p>i'm trying to create array with two elements in it  but i got an error</p>\n\n<pre><code> type TODO struct {\n    Number             int\n    Task               string\n}\n\nfunc main() {\n    var todoArr [2]TODO\n\n    fE := &amp;TODO{Number: 10, Task: \"Task1\"}\n    sE := &amp;TODO{Number: 11, Task: \"Task2\"}\n    todoArr[0] = fE\n    todoArr[1] = sE\n}\n</code></pre>\n\n<blockquote>\n  <p>cannot use fE (type *TODO) as Type TODO in assignment</p>\n</blockquote>\n\n<p>i don't know why \nalso i want to know if there is a short form to declare and initialize array/slice in golang like this</p>\n\n<pre><code>[]TODO{&amp;TODO{Number: 10, Task: \"Task1\"}, &amp;TODO{Number: 11, Task: \"Task2\"}}\n</code></pre>\n"}, {"tags": ["go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1492030507, "post_id": 43379324, "comment_id": 73821097, "body": "Thanks. Do we need default clause? I&#39;ve unregistered handler in the hub doing the same thing. Please enlighten."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 1, "creation_date": 1492031488, "post_id": 43379324, "comment_id": 73821556, "body": "If you don&#39;t add the default clause, then the hub can block on dead clients.  The client&#39;s send channel in the original example has a capacity greater than one (I forget the exact value).  If the channel fills to capacity, then the client&#39;s send loop is probably stuck on the write to the peer.  It&#39;s better to drop then client then it is to stall the hub."}, {"owner": {"reputation": 2908, "user_id": 1220243, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A8tm4.jpg?s=128&g=1", "display_name": "zero_cool", "link": "https://stackoverflow.com/users/1220243/zero-cool"}, "edited": false, "score": 0, "creation_date": 1531889030, "post_id": 43379324, "comment_id": 89758920, "body": "I&#39;m also using gorilla, and something very similar to the above implementation. I&#39;m looking to prevent a broadcast to the client who created the message. How would you accomplish that?"}, {"owner": {"reputation": 2908, "user_id": 1220243, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A8tm4.jpg?s=128&g=1", "display_name": "zero_cool", "link": "https://stackoverflow.com/users/1220243/zero-cool"}, "edited": false, "score": 0, "creation_date": 1531890767, "post_id": 43379324, "comment_id": 89759415, "body": "when I log &quot;client&quot; I get: &amp;{0xc421084d50 0xc4210be280 0xc421066240 0} - how do you make this human readable?"}, {"owner": {"reputation": 2908, "user_id": 1220243, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A8tm4.jpg?s=128&g=1", "display_name": "zero_cool", "link": "https://stackoverflow.com/users/1220243/zero-cool"}, "edited": false, "score": 0, "creation_date": 1531892936, "post_id": 43379324, "comment_id": 89760098, "body": "By &quot;receive loop&quot; (in the answer above) do you mean the readPump func?"}, {"owner": {"reputation": 2908, "user_id": 1220243, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A8tm4.jpg?s=128&g=1", "display_name": "zero_cool", "link": "https://stackoverflow.com/users/1220243/zero-cool"}, "edited": false, "score": 0, "creation_date": 1531893746, "post_id": 43379324, "comment_id": 89760403, "body": "Looks like all my browser tabs have the same id - the chat works as expected. How do you get each client to have a unique id?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 2908, "user_id": 1220243, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A8tm4.jpg?s=128&g=1", "display_name": "zero_cool", "link": "https://stackoverflow.com/users/1220243/zero-cool"}, "edited": false, "score": 0, "creation_date": 1575398475, "post_id": 43379324, "comment_id": 104550977, "body": "@zero_cool  Assign each client a unique id when the client connects.  Example: <code>mu.Lock(); uniqueID++;  client.Id = uniqueID; mu.Unlock()</code> where <code>mu</code> is a <code>sync.Mutex</code> and <code>uniqueID</code> is a package-level int variable."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 2908, "user_id": 1220243, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A8tm4.jpg?s=128&g=1", "display_name": "zero_cool", "link": "https://stackoverflow.com/users/1220243/zero-cool"}, "edited": false, "score": 1, "creation_date": 1575398600, "post_id": 43379324, "comment_id": 104551026, "body": "@zero_cool <code>Client.Id</code> is the only human readable field, so log that field only."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1492029843, "creation_date": 1492029843, "answer_id": 43379324, "question_id": 43378283, "link": "https://stackoverflow.com/questions/43378283/websocket-send-to-specific-client-instead-broadcast/43379324#43379324", "title": "Websocket send to specific client instead broadcast", "body": "<p>Define a type representing a message:</p>\n\n<pre><code>type Message struct {\n    id int\n    data []byte\n}\n</code></pre>\n\n<p>Add a field to Hub:</p>\n\n<pre><code>Send chan Message\n</code></pre>\n\n<p>and initialize the channel along with the hub's other channels.</p>\n\n<p>Add the following case to the hub's select:</p>\n\n<pre><code>case m := &lt;-h.Send:\n    c, ok := clients[m.id]\n    if ok {\n        select {\n        case c.send &lt;- m.data:\n        default:\n           delete(h.Clients, c.Id)\n           close(c.Send)\n        }\n    }\n</code></pre>\n\n<p>In the client's receive loop, parse the JSON to get the id and message data and send it to the hub:</p>\n\n<pre><code>    c.Hub.Send &lt;- Message{id: id, data: data}\n</code></pre>\n"}], "owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 2, "accepted_answer_id": 43379324, "answer_count": 1, "score": 4, "last_activity_date": 1492029843, "creation_date": 1492026116, "question_id": 43378283, "link": "https://stackoverflow.com/questions/43378283/websocket-send-to-specific-client-instead-broadcast", "title": "Websocket send to specific client instead broadcast", "body": "<p>I'm trying to modify the gorilla chat example to to send a message to a specific client instead of broadcast. First I'm storing the specific client in the hub against it's Id.</p>\n\n<p><strong>Hub.go</strong></p>\n\n<pre><code>type Hub struct {\n        Clients    map[int]*Client // Changed this piece to store id (int)\n        Broadcast  chan []byte   \n        Register   chan *Client   \n        Unregister chan *Client   \n}\n\nfunc (h *Hub) Run() {\n        for {\n                    select {\n                    case client := &lt;-h.Register:\n                                fmt.Println(\"hub client register\")\n                                h.Clients[client.Id] = client\n                    case client := &lt;-h.Unregister:\n                                fmt.Println(\"hub client Unregister\")\n                                fmt.Println(h.Clients[client.Id])\n                                if h.Clients[client.Id] != nil {\n                                            delete(h.Clients, client.Id)\n                                            close(client.Send)\n                                }\n                    case message := &lt;-h.Broadcast:\n                                fmt.Println(\"to send to a specific client\", string(message))\n                    }\n        }\n}\n</code></pre>\n\n<p><strong>Client</strong></p>\n\n<p>I've added a field Id int to Client to know which client has sent a message</p>\n\n<pre><code>type Client struct {\n        Hub  *Hub\n        Conn *websocket.Conn\n        Send chan []byte    \n        Id   int // Id of the client,\n}\n\nfunc (c *Client) readPump() {\n        defer func() {\n                    c.Hub.Unregister &lt;- c\n                    c.Conn.Close()\n        }()\n        c.Conn.SetReadLimit(maxMessageSize)\n        c.Conn.SetReadDeadline(time.Now().Add(pongWait))\n        c.Conn.SetPongHandler(func(string) error { c.Conn.SetReadDeadline(time.Now().Add(pongWait)); return nil })\n        for {\n                    _, message, err := c.Conn.ReadMessage()\n                    if err != nil {\n                                if websocket.IsUnexpectedCloseError(err, websocket.CloseGoingAway) {\n                                            log.Printf(\"error: %v\", err)\n                                }\n                                break\n                    }\n                    message = bytes.TrimSpace(bytes.Replace(message, newline, space, -1))\n\n                    fmt.Println(\"client read message\", string(message), \"from\", c.Id)\n        // {\"to\":512,\"message\":\"Hi there.\"}\n                    c.Hub.Broadcast &lt;- message\n        }\n}\n</code></pre>\n\n<p>What are the next steps to take to be able to send the message to a specific client instead of broadcasting.</p>\n\n<p>the message itself is coming as JSON from the client specifying 'to' indicating who to send and what message to send.</p>\n\n<pre><code>{\"to\":512,\"message\":\"Hi there.\"}\n</code></pre>\n"}, {"tags": ["wcf", "google-app-engine", "go", "google-cloud-endpoints"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492034020, "post_id": 43377908, "comment_id": 73822592, "body": "Testing endpoints is done via the url <code>https:&#47;&#47;apis-explorer.appspot.com&#47;apis-explorer&#47;?base=https:&zwnj;&#8203;&#47;&#47;yourprojectid.apps&zwnj;&#8203;pot.com&#47;_ah&#47;api#p&#47;</code> Or if you are testing on localhost, you can replace base with <code>http:&#47;&#47;localhost:8080&#47;_ah&#47;api#p&#47;</code>."}, {"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492037168, "post_id": 43377908, "comment_id": 73823756, "body": "@RayfenWindspear - This is not working for me. Do I need to make some changes in app.yaml?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1492037511, "post_id": 43377908, "comment_id": 73823848, "body": "In addition to what polymer/backend has, I have this handler before the spi one. <code>- url: &#47;.*   script: _go_app   secure: always</code> It&#39;s the same but url is <code>&#47;.*</code>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492037815, "post_id": 43377908, "comment_id": 73823929, "body": "Oh right, I forgot that this url is easier to use for deployed instances. <code>https:&#47;&#47;your_app_id.appspot.com&#47;_ah&#47;api&#47;explorer</code>. This link is to python docs, but is the same across the board as far as testing endpoints <a href=\"https://cloud.google.com/appengine/docs/standard/python/endpoints/test_deploy\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/standard/python/endpoints/&hellip;</a>"}, {"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492040253, "post_id": 43377908, "comment_id": 73824623, "body": "@RayfenWindspear First of all thanks for your help. it showing nothing .. api explorer sidebar on left but on right hand side .. no apis"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492106557, "post_id": 43377908, "comment_id": 73858536, "body": "If you are testing on localhost, you have to use firefox and disable the protections. In firefox, you&#39;ll get a lock with a red cross through it in the top left of the navbar, click that and disable protections. Then it will connect to localhost."}], "owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492109397, "creation_date": 1492024719, "last_edit_date": 1492075060, "question_id": 43377908, "link": "https://stackoverflow.com/questions/43377908/endpoint-with-google-flex-env", "title": "Endpoint with Google Flex env", "body": "<p>There is bit of a confusion, wondering if somebody can help me with this.</p>\n\n<p>Here is an example which is a year old and uses goapp with polymer and endpoint\n<a href=\"https://github.com/googlesamples/cloud-polymer-go\" rel=\"nofollow noreferrer\">https://github.com/googlesamples/cloud-polymer-go</a></p>\n\n<p>Here is a recent example using gcloud \n<a href=\"https://github.com/GoogleCloudPlatform/golang-samples/tree/master/appengine_flexible/endpoints\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/golang-samples/tree/master/appengine_flexible/endpoints</a></p>\n\n<p>Both are different as google changed its approach. </p>\n\n<p>As per second example, I am able to create endpoint functions which uses json for input and output. However there are 2 problems</p>\n\n<p>1st. It is throwing error if I put functions in different file under same package. It works when I run go run <em>.go. but then I dont understand how app.yaml come into picture. I think this url /_ah/spi/.</em> should work</p>\n\n<p>2nd. I am using postman app to check the request and response from endpoint. Is there a better way? I thought google does provide a platform to test endpoint.</p>\n\n<p>Is there any example which implements examples similar to 1st one with new libraries?  </p>\n\n<p>looking forward for your help. Thanks.</p>\n"}, {"tags": ["postgresql", "go", "beego"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1492024440, "post_id": 43377732, "comment_id": 73817675, "body": "<code>RegisterDriver</code>, <code>RegisterDataBase</code>, and <code>RunSyncdb</code> all return error values, check those, if that doesn&#39;t help you make sure to include them in your question, maybe someone knows what they mean, that is, if they aren&#39;t nil. And by the way, if you aren&#39;t, please always do check errors."}, {"owner": {"reputation": 1686, "user_id": 1310740, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4e09b49b817d88d050bee0dd6f602e24?s=128&d=identicon&r=PG&f=1", "display_name": "dev-jim", "link": "https://stackoverflow.com/users/1310740/dev-jim"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492105336, "post_id": 43377732, "comment_id": 73857926, "body": "It was my mistakes, I missed an &#39;i&#39; in the main init function. Thanks for your suggestion by the way."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492105444, "post_id": 43377732, "comment_id": 73857978, "body": "No problem, I&#39;m glad you got it solved."}], "owner": {"reputation": 1686, "user_id": 1310740, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4e09b49b817d88d050bee0dd6f602e24?s=128&d=identicon&r=PG&f=1", "display_name": "dev-jim", "link": "https://stackoverflow.com/users/1310740/dev-jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2105, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567673478, "creation_date": 1492024009, "last_edit_date": 1567673478, "question_id": 43377732, "link": "https://stackoverflow.com/questions/43377732/cannot-connect-to-postgresql-database-in-beego", "title": "Cannot connect to PostgreSQL database in Beego", "body": "<p>I am playing around with Beego, but I stuck at connects to the PostgreSQL db.</p>\n\n<p>Models</p>\n\n<pre><code>package models\n\nimport(\n    \"github.com/astaxie/beego/orm\"  \n    \"time\"\n)\n\ntype User struct {\n    Id   int\n    Username string `orm:\"size(100);unique\"`\n    Email string `orm:\"size(64);unique\"`\n    Created time.Time `orm:\"auto_now_add;type(datetime);index\"`\n    Edited time.Time `orm:\"auto_now;type(datetime)\"`\n    Passpheres string \n    Activated bool   \n}\n\nfunc init() {\n    orm.RegisterModel(new(User))\n}\n</code></pre>\n\n<p>And here is the main</p>\n\n<pre><code>package main\n\nimport (\n    _ \"test/routers\"\n    \"github.com/astaxie/beego\"\n    \"github.com/astaxie/beego/orm\"\n    _ \"github.com/lib/pq\"\n    \"test/models\"\n    \"fmt\"\n)\n\nfunc int(){\n    orm.RegisterDriver(\"postgres\", orm.DRPostgres)\n    orm.RegisterDataBase(\"default\", \n        \"postgres\",\n        \"user=aaaa password=1234567 host=127.0.0.1 port=5432 dbname=gotest sslmode=disable\");\n\n    orm.RunSyncdb(\"default\", false, true)\n}\n\nfunc main() {\n    orm.Debug = true\n\n    o := orm.NewOrm()\n    o.Using(\"default\")\n    u := new(models.User)\n    u.Username = \"test1\"\n    u.Email = \"ads@asdad.com\"\n    u.Passpheres = \"123456\"\n    u.Activated = true\n\n     id, err := o.Insert(u)\n     fmt.Printf(\"ID: %d, ERR: %v\\n\", id, err)\n    beego.Run()\n}\n</code></pre>\n\n<p>And the log shows:</p>\n\n<blockquote>\n  <p>must have one register DataBase alias named <code>default</code></p>\n</blockquote>\n\n<p>I checked on the host and port of PostgreSQL and it is all correct, including the user, password and database. </p>\n\n<p>Is this because of the db connection?</p>\n\n<p>I am using PostgreSQL 9.5.6 and beego 1.8.1 by the way. </p>\n\n<p><strong>UPDATE</strong>\nHow silly of me!! I just missed \"i\" in the init function declaration. So I just need to correct the syntax and and all good to go!</p>\n\n<pre><code>func init(){ // init instead of int\n    orm.RegisterDriver(\"postgres\", orm.DRPostgres)\n    orm.RegisterDataBase(\"default\", \n        \"postgres\",\n        \"user=aaaa password=1234567 host=127.0.0.1 port=5432 dbname=gotest sslmode=disable\");\n\n    orm.RunSyncdb(\"default\", false, true)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1492031666, "last_edit_date": 1492031666, "creation_date": 1492023473, "answer_id": 43377560, "question_id": 43377208, "link": "https://stackoverflow.com/questions/43377208/regexp-value-compared-to-string/43377560#43377560", "title": "regexp value compared to string", "body": "<p>You can use the <a href=\"https://golang.org/pkg/regexp/#Regexp.MatchString\" rel=\"nofollow noreferrer\">Regexp.MatchString</a> method to do what you want.</p>\n\n<pre><code>if re.MatchString(addr[0]) {\n    // ...\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/UvB16idiyf\" rel=\"nofollow noreferrer\">https://play.golang.org/p/UvB16idiyf</a></p>\n\n<p>There are quite a few examples in the docs, check them out: <a href=\"https://golang.org/pkg/regexp/#pkg-examples\" rel=\"nofollow noreferrer\">https://golang.org/pkg/regexp/#pkg-examples</a></p>\n"}], "owner": {"reputation": 49, "user_id": 4227571, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/10889dd325a47cb208cc09b1d8ec4b0d?s=128&d=identicon&r=PG&f=1", "display_name": "aealvarez3", "link": "https://stackoverflow.com/users/4227571/aealvarez3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 43377560, "answer_count": 1, "score": 0, "last_activity_date": 1492031666, "creation_date": 1492022336, "question_id": 43377208, "link": "https://stackoverflow.com/questions/43377208/regexp-value-compared-to-string", "title": "regexp value compared to string", "body": "<pre><code>func main() {\n\n    var ip string\n    fmt.Print(\"Host: \")\n    fmt.Scanln(&amp;ip)\n\n    addr, _ := net.LookupAddr(ip)\n\n    app := \"grep\"\n    arg0 := \"inst\"\n    arg1 := \"acl.yaml\"\n\n    cmd := exec.Command(app, arg0, arg1)\n    stdout, err := cmd.Output()\n    x := string(stdout)\n\n    reg, _ := regexp.Compile(`(internal)`)\n    if err != nil {\n        println(err.Error())\n        return\n    }\n    if ip != \"\" {\n        validateIP(ip)\n    }\n    fmt.Println(x)\n    fmt.Println(addr[0])\n    //fmt.Println(stdout)\n    if addr[0] == reg.FindString(`(internal)`){\n        file, err := os.Open(\"ports.json\")\n        if err != nil {\n            panic(err)\n        }\n        defer file.Close()\n        ports := []portDef{}\n        err = json.NewDecoder(file).Decode(&amp;ports)\n        if err != nil {\n            panic(err)\n        }\n\n        for _, p := range ports {\n            conn, err := net.Dial(p.Protocol, ip + \":\" + p.Port)\n            if conn != nil {\n                fmt.Println(\"\")\n                fmt.Printf(\"Connection established between %s and Localhost.\\n\", addr)\n                fmt.Printf(\"Remote Address : %s \\n\", conn.RemoteAddr().String())\n                fmt.Printf(\"Local Address : %s \\n\", conn.LocalAddr().String())\n            }\n            fmt.Println(\"\")\n            if err != nil {\n                fmt.Println(err)\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I am trying to compare a regexp value to a string. In this case I want the value of <code>\"addr\"</code> to be compared to the regex and if the value of <code>addr</code> has \"internal\" in it that it opens the selected file and iterates through the ports. The address returned from the <code>LookupAddr</code> is always in box.internal.blah.blah.com, so I am looking for the second field in the address (internal in this case) to be compared to the regex and if it finds \"internal\" in the address it will cycle through the loop. </p>\n\n<p>I know my regexp is most likely what is wrong here. Any help would be greatly appreciated.   </p>\n"}, {"tags": ["docker", "go", "docker-api"], "answers": [{"comments": [{"owner": {"reputation": 1093, "user_id": 908313, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/bmym9.jpg?s=128&g=1", "display_name": "thaspius", "link": "https://stackoverflow.com/users/908313/thaspius"}, "edited": false, "score": 0, "creation_date": 1572299533, "post_id": 52131297, "comment_id": 103510253, "body": "Can you provide the definition of the content variable? What type is it?"}, {"owner": {"reputation": 134, "user_id": 5272101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78abf4411e1233db492dc6e169911bb4?s=128&d=identicon&r=PG&f=1", "display_name": "TimSatke", "link": "https://stackoverflow.com/users/5272101/timsatke"}, "reply_to_user": {"reputation": 1093, "user_id": 908313, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/bmym9.jpg?s=128&g=1", "display_name": "thaspius", "link": "https://stackoverflow.com/users/908313/thaspius"}, "edited": false, "score": 0, "creation_date": 1572387997, "post_id": 52131297, "comment_id": 103542071, "body": "A simple string"}], "tags": [], "owner": {"reputation": 134, "user_id": 5272101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78abf4411e1233db492dc6e169911bb4?s=128&d=identicon&r=PG&f=1", "display_name": "TimSatke", "link": "https://stackoverflow.com/users/5272101/timsatke"}, "is_accepted": false, "score": 1, "last_activity_date": 1535829729, "last_edit_date": 1535829729, "creation_date": 1535828709, "answer_id": 52131297, "question_id": 43376740, "link": "https://stackoverflow.com/questions/43376740/docker-golang-api-create-a-container-with-files-from-memory/52131297#52131297", "title": "Docker Golang API create a container with files from memory", "body": "<p>I found this solution, but I can't get the file to show up in the container. Try it and let me know if it works for you!</p>\n\n<pre><code>var buf bytes.Buffer\ntw := tar.NewWriter(&amp;buf)\nerr = tw.WriteHeader(&amp;tar.Header{\n    Name: filename,            // filename\n    Mode: 0777,                // permissions\n    Size: int64(len(content)), // filesize\n})\nif err != nil {\n    return nil, fmt.Errorf(\"docker copy: %v\", err)\n}\ntw.Write([]byte(content))\ntw.Close()\n\n// use &amp;buf as argument for content in CopyToContainer\ncli.CopyToContainer(context.Background(), resp.ID, \"/\", &amp;buf,types.CopyToContainerOptions{})\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7858079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52abd6fc63dea1d0382bdbf696eb0366?s=128&d=identicon&r=PG", "display_name": "AWildTyphlosion", "link": "https://stackoverflow.com/users/7858079/awildtyphlosion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1535829729, "creation_date": 1492020643, "question_id": 43376740, "link": "https://stackoverflow.com/questions/43376740/docker-golang-api-create-a-container-with-files-from-memory", "title": "Docker Golang API create a container with files from memory", "body": "<p>Currently, to get files into a container using the golang api I first must create the container and then use the <code>CopyToContainer</code> function (Example Below). </p>\n\n<p>Is it possible to create a container and specify files for it to have at create time, without having the files first on the file system?</p>\n\n<p>Example 1)</p>\n\n<pre><code>func main() {\n    cli, err := client.NewEnvClient()\n    if err != nil {\n        panic(err)\n    }\n\n    resp, err := cli.ContainerCreate(context.Background(),\n        &amp;container.Config{\n            Image: \"alpine\",\n            Cmd:   []string{\"ls\", \"/\"},\n        }, nil, nil, \"testContainer\")\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"Created: %v\\n\", resp.ID)\n\n    cli.CopyToContainer(context.Background(), resp.ID, \"/\", getTar(),types.CopyToContainerOptions{})\n}\n\nfunc getTar() io.Reader {\n    ...\n}\n</code></pre>\n\n<p>EDIT:<br>\n- Code spacing.</p>\n"}, {"tags": ["go", "plugins"], "comments": [{"owner": {"reputation": 3889, "user_id": 100405, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/924e4500ab6bdce291ab6346099ede26?s=128&d=identicon&r=PG", "display_name": "weima", "link": "https://stackoverflow.com/users/100405/weima"}, "edited": false, "score": 0, "creation_date": 1492015470, "post_id": 43375234, "comment_id": 73812786, "body": "sorry for the title, SO forced me to modify it multiple times because it didn&#39;t meet the quality standards"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492015765, "post_id": 43375234, "comment_id": 73812947, "body": "You can&#39;t &quot;unload&quot; a plugin. Can you somehow version your plugins, so you can load new ones each time?"}, {"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1492019172, "post_id": 43375234, "comment_id": 73814780, "body": "why not add an Unload function to your plugin?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1492173090, "post_id": 43375234, "comment_id": 73881929, "body": "@AmmarBandukwala: what exactly would an unload function do, if it can&#39;t unload the plugin?"}, {"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492173231, "post_id": 43375234, "comment_id": 73881998, "body": "@JimB release resources. I assume the garbage collector will clear it&#39;s memory once out of scope"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1492174298, "post_id": 43375234, "comment_id": 73882501, "body": "@AmmarBandukwala: that&#39;s not generally what &quot;unloading&quot; means. If you can free resources the memory of course will be garbage collected, but the plugin itself will remain in-process indefinitely."}, {"owner": {"reputation": 2174, "user_id": 2712644, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qbg3j.jpg?s=128&g=1", "display_name": "domoarigato", "link": "https://stackoverflow.com/users/2712644/domoarigato"}, "edited": false, "score": 1, "creation_date": 1545674105, "post_id": 43375234, "comment_id": 94675648, "body": "I have been playing with this as well.  at the moment, it sems like you cant unload, and the best you can do is load a new plugin, perhaps with a an incremented filename - say the first plugin was <code>plug-1.so</code> then the next could be <code>plug-2.so</code>  in the end, both would be loaded, and consume some resources.  plug-1 might not be used, but it will still consume resources, unless the host process is restarted. if anyone knows a way around this, I&#39;d be grateful."}], "answers": [{"tags": [], "owner": {"reputation": 186, "user_id": 5057118, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T7UFx8GOu8w/AAAAAAAAAAI/AAAAAAAACSA/fO8rltgDq4Y/photo.jpg?sz=128", "display_name": "relistan", "link": "https://stackoverflow.com/users/5057118/relistan"}, "is_accepted": false, "score": 0, "last_activity_date": 1492036592, "creation_date": 1492036592, "answer_id": 43380723, "question_id": 43375234, "link": "https://stackoverflow.com/questions/43375234/golang-how-to-unload-an-already-loaded-go-plugin-1-8/43380723#43380723", "title": "golang: how to unload an already loaded &quot;go plugin&quot; 1.8", "body": "<p>Go doesn't support unloading a plugin. But you can, as you suggest, disable it. Commonly a plugin would define a struct containing the information about the plugin. You might return this from a factory function with a well-known name (e.g. <code>awesome.so</code> contains <code>AwesomePlugin</code>). One of the items you could include in the struct would be a method to disable access to the plugin. You could do something like this:</p>\n\n<pre><code>type MyPlugin struct {\n    Name string\n    Enable func() error\n    Disable func() error\n}\n</code></pre>\n\n<p>Then in the plugin itself you'd do something like this:</p>\n\n<pre><code>var (\n    awesomeEnabled bool\n)\n\nfunc AwesomePlugin() *myplugin.MyPlugin {\n    return &amp;myplugin.MyPlugin{\n        Name: \"AwesomePlugin\",\n        Enable: func() error {\n            println(\"Enabling AwesomePlugin\")\n            awesomeEnabled = true\n            return nil // or do something more complex that could error\n        },\n        Disable: func() error {\n            println(\"Disabling AwesomePlugin\")\n            awesomeEnabled = false\n            return nil // or do something more complex that could error\n        },\n    }\n}\n</code></pre>\n\n<p>Then the code to load it, enable it, and disable it would be something like:</p>\n\n<pre><code>awesomePlugin, err := plugin.Open(\"awesome.so\")\nif err != nil {\n    panic(\"Can't load plugin: \" + err.Error())\n}\n\nsym, err := awesomePlugin.Lookup(\"AwesomePlugin\")\nif err != nil {\n    panic(\"Can't find symbol: \" + err.Error())\n}\n\nawesomeFactory := sym.(func() *myplugin.MyPlugin)\nawesome := awesomeFactory()\n\nprintln(\"Loaded \" + awesome.Name + \" plugin\")\n\nerr = awesome.Enable()\nif err != nil {\n    panic(\"Can't enable plugin: \" + err.Error())\n}\n\n// Do some stuff\n\nerr = awesome.Disable()\nif err != nil {\n    panic(\"Can't enable plugin: \" + err.Error())\n}\n</code></pre>\n\n<p>You'd have the code in the plugin look to see if the plugin is enabled or not before running any other functions you might define.</p>\n\n<p>Then, running it, we get output like:</p>\n\n<pre><code>Loaded AwesomePlugin plugin\nEnabling AwesomePlugin\nDisabling AwesomePlugin\n</code></pre>\n\n<p>Obviously you don't want to <code>panic()</code> everywhere. That's just a placeholder for doing something with the error.</p>\n"}], "owner": {"reputation": 3889, "user_id": 100405, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/924e4500ab6bdce291ab6346099ede26?s=128&d=identicon&r=PG", "display_name": "weima", "link": "https://stackoverflow.com/users/100405/weima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1399, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492036592, "creation_date": 1492015412, "question_id": 43375234, "link": "https://stackoverflow.com/questions/43375234/golang-how-to-unload-an-already-loaded-go-plugin-1-8", "title": "golang: how to unload an already loaded &quot;go plugin&quot; 1.8", "body": "<p>go1.8 onwards, go supports to create and load a plugin.</p>\n\n<p>but unload plugin is not supported.</p>\n\n<p>a plugin is a module loaded at runtime, is it possible to unload a module?</p>\n\n<p>if not possible to unload a module, what is the best that can be done at application level to unload a plugin/make it unusable but still in memory?</p>\n"}, {"tags": ["go", "mgo"], "comments": [{"owner": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "edited": false, "score": 0, "creation_date": 1492014984, "post_id": 43375002, "comment_id": 73812502, "body": "<a href=\"https://github.com/go-mgo/mgo/pull/394\" rel=\"nofollow noreferrer\">Not yet</a>."}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1493728316, "post_id": 43375002, "comment_id": 74518913, "body": "To clarify <a href=\"https://github.com/go-mgo/mgo/tree/v2\" rel=\"nofollow noreferrer\">mgo.V2</a> supports <i>connecting</i> to MongoDB v3.4. Although there are few outstanding features to support, you should be able to connect without an issue. Post the error message and your code that you&#39;d expect to work."}, {"owner": {"reputation": 234, "user_id": 2849149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o3uGA.png?s=128&g=1", "display_name": "Snehal Dangroshiya", "link": "https://stackoverflow.com/users/2849149/snehal-dangroshiya"}, "reply_to_user": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1495089089, "post_id": 43375002, "comment_id": 75106277, "body": "@WanBachtiar thanks you are right mgo.v2 works fine with mongodb3.4 may be there is some issue with my code"}, {"owner": {"reputation": 2400, "user_id": 6112685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RAHsYhTeNC0/AAAAAAAAAAI/AAAAAAAAAsc/A5bLML9T638/photo.jpg?sz=128", "display_name": "Abhay", "link": "https://stackoverflow.com/users/6112685/abhay"}, "edited": false, "score": 0, "creation_date": 1533924164, "post_id": 43375002, "comment_id": 90541068, "body": "What is a current status of this answer?"}, {"owner": {"reputation": 234, "user_id": 2849149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o3uGA.png?s=128&g=1", "display_name": "Snehal Dangroshiya", "link": "https://stackoverflow.com/users/2849149/snehal-dangroshiya"}, "reply_to_user": {"reputation": 2400, "user_id": 6112685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RAHsYhTeNC0/AAAAAAAAAAI/AAAAAAAAAsc/A5bLML9T638/photo.jpg?sz=128", "display_name": "Abhay", "link": "https://stackoverflow.com/users/6112685/abhay"}, "edited": false, "score": 0, "creation_date": 1533956425, "post_id": 43375002, "comment_id": 90549465, "body": "@AbhayGawade ya, mgo.v2 works fine with MongoDB 3.4. something was wrong with my code."}], "owner": {"reputation": 234, "user_id": 2849149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o3uGA.png?s=128&g=1", "display_name": "Snehal Dangroshiya", "link": "https://stackoverflow.com/users/2849149/snehal-dangroshiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1533956144, "creation_date": 1492014634, "last_edit_date": 1493441437, "question_id": 43375002, "link": "https://stackoverflow.com/questions/43375002/does-mgo-supports-latest-version-of-mongodb", "title": "Does mgo supports latest version of mongodb?", "body": "<p>I am trying with mongo 3.4 but refuse to connect server error received. But same code is work with mongodb 2.2 version </p>\n"}, {"tags": ["go", "govendor"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492014959, "post_id": 43374587, "comment_id": 73812488, "body": "is GOPATH exported?"}, {"owner": {"reputation": 21, "user_id": 5129494, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f1d3327923cfb802e492be35a6d34c6?s=128&d=identicon&r=PG&f=1", "display_name": "bobsim21", "link": "https://stackoverflow.com/users/5129494/bobsim21"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492016257, "post_id": 43374587, "comment_id": 73813248, "body": "in my .bashrc I set GOPATH=... should I do export GOPATH=... instead?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492016368, "post_id": 43374587, "comment_id": 73813322, "body": "Yes, you need to export a variable for other processes to use it. If you look at your GOPATH, it&#39;s not the same as what <code>go env</code> is reporting."}, {"owner": {"reputation": 21, "user_id": 5129494, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f1d3327923cfb802e492be35a6d34c6?s=128&d=identicon&r=PG&f=1", "display_name": "bobsim21", "link": "https://stackoverflow.com/users/5129494/bobsim21"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492016907, "post_id": 43374587, "comment_id": 73813630, "body": "thanks for the help. that solved it!"}], "owner": {"reputation": 21, "user_id": 5129494, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f1d3327923cfb802e492be35a6d34c6?s=128&d=identicon&r=PG&f=1", "display_name": "bobsim21", "link": "https://stackoverflow.com/users/5129494/bobsim21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 392, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492013269, "creation_date": 1492013269, "question_id": 43374587, "link": "https://stackoverflow.com/questions/43374587/problems-with-setting-up-govendor", "title": "Problems with setting up govendor", "body": "<p>I installed go1.8 and I am trying to use govendor for a project but it seems I am doing something wrong. The error says that I need to check my $GOPATH, but it is already set. Is it set to the wrong path?</p>\n\n<pre><code>bash-3.2$ pwd\n/Users/rsimari/Go   \n\nbash-3.2$ govendor init\nError: Missing GOPATH. Check your environment variable GOPATH.\nbash-3.2$ echo $GOPATH\n/Users/rsimari/Go\nbash-3.2$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/rsimari/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/darwin_amd64\"\nGCCGO=\"gccgo\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-\nmap=/var/folders/_3/kx93r31s2l97vj436m8vdndc0000gn/T/go-\nbuild687682041=/tmp/go-build -gno-record-gcc-switches -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\nPKG_CONFIG=\"pkg-config\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\n</code></pre>\n"}, {"tags": ["go", "graphql", "graphql-go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492011868, "post_id": 43373333, "comment_id": 73810511, "body": "Can you provide the definition of <code>UserObject</code> that you&#39;re passing to <code>graphql.NewList</code>?"}, {"owner": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492012272, "post_id": 43373333, "comment_id": 73810789, "body": "Done. It&#39;s the definition of the type User"}], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "edited": false, "score": 0, "creation_date": 1492033859, "post_id": 43374869, "comment_id": 73822532, "body": "I&#39;m glad I could help ;)."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1492014217, "creation_date": 1492014217, "answer_id": 43374869, "question_id": 43373333, "link": "https://stackoverflow.com/questions/43373333/resolving-list-field-in-graphql-without-struct/43374869#43374869", "title": "Resolving list field in GraphQL without struct", "body": "<p>You can use <code>map[string]interface{}</code> instead of <code>map[string]string</code> and it should work. Why that is? I don't really know, I couldn't find any docs as to what's acceptable as the return value from <code>FieldResolveFn</code>.</p>\n\n<pre><code>users := []map[string]interface{}{{\n    \"id\":   \"1\",\n    \"name\": \"John\",\n}, {\n    \"id\":   \"2\",\n    \"name\": \"Jess\",\n}}\nreturn users, nil\n</code></pre>\n"}], "owner": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 43374869, "answer_count": 1, "score": 0, "last_activity_date": 1492014217, "creation_date": 1492009657, "last_edit_date": 1492012260, "question_id": 43373333, "link": "https://stackoverflow.com/questions/43373333/resolving-list-field-in-graphql-without-struct", "title": "Resolving list field in GraphQL without struct", "body": "<p>I have this GraphQL type:</p>\n\n<pre><code>type User {\n    id: String\n    name: String\n}\n</code></pre>\n\n<p>defined by</p>\n\n<pre><code>var UserObject = graphql.NewObject(graphql.ObjectConfig{\n    Name: \"User\",\n    Fields: graphql.Fields{\n        \"id\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n        \"name\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n    },\n})\n</code></pre>\n\n<p>In my root query, I want to link some users with the query field <code>users</code>:</p>\n\n<pre><code>var RootQuery = graphql.NewObject(graphql.ObjectConfig{\n    Name: \"RootQuery\",\n    Fields: graphql.Fields{\n        \"users\": &amp;graphql.Field{\n            Type: graphql.NewList(UserObject),\n            Resolve: func(p graphql.ResolveParams) (interface{}, error) {\n                return Users{\n                    User{\n                      ID: \"1\",\n                      NAME: \"John\",\n                    },\n                    User{\n                      ID: \"2\",\n                      NAME: \"Jess\"\n                    }\n                 }, nil\n            },\n        },\n    },\n})\n\ntype User struct {\n    ID string\n    NAME string\n}\n\ntype Users []User\n</code></pre>\n\n<p>As you see, I have a <code>User</code> and <code>Users</code> data types. So far, so good.</p>\n\n<p>Now, imagine I can't create the <code>User</code> nor <code>Users</code> structs, what could I return in <code>Resolve</code> function instead of them?</p>\n\n<p>I thought about a <code>[]map[string]string</code>. It would be something like this:</p>\n\n<pre><code> var RootQuery = graphql.NewObject(graphql.ObjectConfig{\n        Name: \"RootQuery\",\n        Fields: graphql.Fields{\n            \"users\": &amp;graphql.Field{\n                Type: graphql.NewList(UserObject),\n                Resolve: func(p graphql.ResolveParams) (interface{}, error) {\n                    users := []map[string]string {\n                        map[string]string {\n                            \"id\" : \"1\",\n                            \"name\" : \"John\",\n                        },\n                        map[string]string {\n                            \"id\" : \"2\",\n                            \"name\" : \"Jess\",\n                        },\n                    }\n                    return users, nil\n                },\n            },\n        },\n    })\n</code></pre>\n\n<p>But it doesn't work. Every property is <code>nil</code> in the query result. Is there a way to solve this? Remember I can't create the <code>User</code> struct. This has to be \"generic\".</p>\n"}, {"tags": ["go", "visual-studio-code", "vscode-settings"], "answers": [{"tags": [], "owner": {"reputation": 763, "user_id": 4934330, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e51efa148992a97fabf4e855a98c261f?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/4934330/bob"}, "is_accepted": false, "score": 0, "last_activity_date": 1492028572, "creation_date": 1492028572, "answer_id": 43378980, "question_id": 43371910, "link": "https://stackoverflow.com/questions/43371910/how-to-specify-output-path-of-binary-file-in-vs-code/43378980#43378980", "title": "How to specify output path of binary file in VS Code?", "body": "<p>Try to use <code>outDir</code> setting for specifying.</p>\n"}], "owner": {"reputation": 119, "user_id": 5589201, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-z8vW_wFt3DA/AAAAAAAAAAI/AAAAAAAAABM/9VI0Lq5Sf1Q/photo.jpg?sz=128", "display_name": "Constantine Bateruk", "link": "https://stackoverflow.com/users/5589201/constantine-bateruk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 889, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492028572, "creation_date": 1492006035, "last_edit_date": 1492009705, "question_id": 43371910, "link": "https://stackoverflow.com/questions/43371910/how-to-specify-output-path-of-binary-file-in-vs-code", "title": "How to specify output path of binary file in VS Code?", "body": "<p>My launch.json:</p>\n\n<pre><code>{\n\"version\": \"0.2.0\",\n\"configurations\": [\n\n    {\n        \"name\": \"Launch\",\n        \"type\": \"go\",\n        \"request\": \"launch\",\n        \"mode\": \"debug\",\n        \"remotePath\": \"\",\n        \"port\": 2345,\n        \"host\": \"127.0.0.1\",\n        \"program\": \"${workspaceRoot}/app\",\n        \"env\": {\n            \"GO_ENV\":\"dev\"\n            },\n        \"args\": [],\n        \"showLog\": true\n    }\n]\n</code></pre>\n\n<p>}</p>\n\n<p>I want that when I'm running debug binary file with name \"debug\", it appears in the \"app\" folder. How can I specify a different output path?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1629, "user_id": 5839563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k7Dvf.jpg?s=128&g=1", "display_name": "Zhenhua", "link": "https://stackoverflow.com/users/5839563/zhenhua"}, "edited": false, "score": 1, "creation_date": 1510702243, "post_id": 43368604, "comment_id": 81545321, "body": "Can you add the link to the answered question? It would be good to link back to the original question for duplicating."}, {"owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "edited": false, "score": 1, "creation_date": 1556795739, "post_id": 43368604, "comment_id": 98554508, "body": "Flagging to reopen. Asking if you can make a constant struct is different to asking about an array, even if the <i>answers</i> are similar."}], "answers": [{"comments": [{"owner": {"reputation": 2652, "user_id": 1395620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd851cb368a0747715f41fda62a49ca8?s=128&d=identicon&r=PG", "display_name": "Daniel Santos", "link": "https://stackoverflow.com/users/1395620/daniel-santos"}, "edited": false, "score": 1, "creation_date": 1603329648, "post_id": 43368686, "comment_id": 114005642, "body": "Sad.  This is a handy language feature."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 66, "last_activity_date": 1491997666, "creation_date": 1491997666, "answer_id": 43368686, "question_id": 43368604, "link": "https://stackoverflow.com/questions/43368604/constant-struct-in-go/43368686#43368686", "title": "Constant struct in Go", "body": "<p>Because Go does not support struct constants (emphasis mine)</p>\n\n<blockquote>\n  <p><strong>There are boolean constants, rune constants, integer constants,\n  floating-point constants, complex constants, and string constants.</strong>\n  Rune, integer, floating-point, and complex constants are collectively\n  called numeric constants.</p>\n</blockquote>\n\n<p>Read more here: <a href=\"https://golang.org/ref/spec#Constants\" rel=\"noreferrer\">https://golang.org/ref/spec#Constants</a></p>\n"}, {"comments": [{"owner": {"reputation": 630, "user_id": 7440750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100001487240501/picture?type=large", "display_name": "Sanjeev Siva", "link": "https://stackoverflow.com/users/7440750/sanjeev-siva"}, "edited": false, "score": 0, "creation_date": 1608210102, "post_id": 57173119, "comment_id": 115516743, "body": "This is interesting."}], "tags": [], "owner": {"reputation": 333, "user_id": 4010173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12d16e711901f2776038e318e171f5e9?s=128&d=identicon&r=PG&f=1", "display_name": "Ihor", "link": "https://stackoverflow.com/users/4010173/ihor"}, "is_accepted": false, "score": 16, "last_activity_date": 1563921958, "creation_date": 1563921958, "answer_id": 57173119, "question_id": 43368604, "link": "https://stackoverflow.com/questions/43368604/constant-struct-in-go/57173119#57173119", "title": "Constant struct in Go", "body": "<p>A good workaround is to wrap it in a function.</p>\n\n<pre><code>func FEED_TO_INSERT() quzx.RssFeed {\n    return quzx.RssFeed{ 0,\n                    \"\",\n                    \"desc\",\n                    \"www.some-site.com\",\n                    \"upd_url\",\n                    \"img_title\",\n                    \"img_url\",\n                    0,\n                    0,\n                    0,\n                    0,\n                    0,\n                    100,\n                    \"alt_name\",\n                    1,\n                    1,\n                    1,\n                    \"test\",\n                    100,\n                    100,\n                    0 }\n}\n</code></pre>\n\n<p>Note: Make sure that the function is always returning a new object(or copy).</p>\n"}, {"tags": [], "owner": {"reputation": 530, "user_id": 10753492, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vpFmr9vacTw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jiHeIG7f13oRVc9pqOOOdXPCY9Gg/mo/photo.jpg?sz=128", "display_name": "user10753492", "link": "https://stackoverflow.com/users/10753492/user10753492"}, "is_accepted": false, "score": 6, "last_activity_date": 1563939168, "creation_date": 1563939168, "answer_id": 57174847, "question_id": 43368604, "link": "https://stackoverflow.com/questions/43368604/constant-struct-in-go/57174847#57174847", "title": "Constant struct in Go", "body": "<p>You should declare it as a var.</p>\n\n<p>Go allows you to declare and initialize global variables at module scope.</p>\n\n<p>Go does not have any concept of immutability. 'const' is not meant as a way to prevent variables from mutating or anything like that.</p>\n"}], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48746, "favorite_count": 5, "accepted_answer_id": 43368686, "answer_count": 3, "score": 43, "last_activity_date": 1563939168, "creation_date": 1491997462, "last_edit_date": 1491997657, "question_id": 43368604, "link": "https://stackoverflow.com/questions/43368604/constant-struct-in-go", "title": "Constant struct in Go", "body": "<p>Why can't I create constant struct?</p>\n\n<pre><code>const FEED_TO_INSERT = quzx.RssFeed{ 0,\n                    \"\",\n                    \"desc\",\n                    \"www.some-site.com\",\n                    \"upd_url\",\n                    \"img_title\",\n                    \"img_url\",\n                    0,\n                    0,\n                    0,\n                    0,\n                    0,\n                    100,\n                    \"alt_name\",\n                    1,\n                    1,\n                    1,\n                    \"test\",\n                    100,\n                    100,\n                    0 }\n</code></pre>\n\n<blockquote>\n  <p>.\\rss_test.go:32: const initializer quzx.RssFeed literal is not a constant</p>\n</blockquote>\n"}, {"tags": ["mysql", "go", "mysql-management"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492001033, "post_id": 43367802, "comment_id": 73801461, "body": "Looks like something wrong with your git configuration. Can you go into each repo, make sure you&#39;re on master, and try to pull?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7699710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e2SdG.jpg?s=128&g=1", "display_name": "Nscript", "link": "https://stackoverflow.com/users/7699710/nscript"}, "edited": false, "score": 0, "creation_date": 1492019324, "post_id": 43370261, "comment_id": 73814848, "body": "thanks for answer. i removed those folders and then just colud install nodb package. when i used <code>$ go get -u golang.org\\x\\crypto</code>  cmd get this error:  <code>no buildable Go source files in C:\\Users\\NakhodaSokoot\\go\\src\\golang.org\\x\\crypto</code> and when  i tried to install dbweb i recived this errors: <code>package github.com&#47;go-xorm&#47;core: remote origin not found package github.com&#47;lunny&#47;tango: remote origin not found</code> what should i do ?"}, {"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "reply_to_user": {"reputation": 27, "user_id": 7699710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e2SdG.jpg?s=128&g=1", "display_name": "Nscript", "link": "https://stackoverflow.com/users/7699710/nscript"}, "edited": false, "score": 0, "creation_date": 1492026095, "post_id": 43370261, "comment_id": 73818567, "body": "<code>no buildable Go source files</code> is not an issue, the other one should be solved in the same way, delete and go get the package again"}, {"owner": {"reputation": 27, "user_id": 7699710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e2SdG.jpg?s=128&g=1", "display_name": "Nscript", "link": "https://stackoverflow.com/users/7699710/nscript"}, "edited": false, "score": 0, "creation_date": 1492116667, "post_id": 43370261, "comment_id": 73863651, "body": "thanks alot. i removed all relative packages such as tango and xorm and core and also dbweb and then install them one by one...the problem fixed."}], "tags": [], "owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "is_accepted": true, "score": 2, "last_activity_date": 1492026124, "last_edit_date": 1492026124, "creation_date": 1492001936, "answer_id": 43370261, "question_id": 43367802, "link": "https://stackoverflow.com/questions/43367802/no-remote-repository-when-installing-dbweb/43370261#43370261", "title": "no remote repository when installing dbweb", "body": "<p>It gives those errors because github.com/go-xorm/dbweb has dependencies on those other two packages which it cannot update because you have them locally but they have no remote so go get does not know from where to pull the code. </p>\n\n<p>Try removing them:</p>\n\n<pre><code>$ rm -rf $GOPATH\\src\\github.com\\lunny\\nodb\n$ rm -rf $GOPATH\\src\\golang.org\\x\\crypto\n</code></pre>\n\n<p>Then try to go get your package again:</p>\n\n<pre><code>$ go get -u github.com/go-xorm/dbweb\n</code></pre>\n\n<p>Or go get them separately and then go get dbweb: </p>\n\n<pre><code>$ go get -u golang.org\\x\\crypto\n$ go get -u github.com\\lunny\\nodb\n$ go get -u github.com/go-xorm/dbweb\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7699710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e2SdG.jpg?s=128&g=1", "display_name": "Nscript", "link": "https://stackoverflow.com/users/7699710/nscript"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 43370261, "answer_count": 1, "score": 0, "last_activity_date": 1492026124, "creation_date": 1491995106, "last_edit_date": 1492009874, "question_id": 43367802, "link": "https://stackoverflow.com/questions/43367802/no-remote-repository-when-installing-dbweb", "title": "no remote repository when installing dbweb", "body": "<p>I want to install <a href=\"https://github.com/go-xorm/dbweb\" rel=\"nofollow noreferrer\">dbweb</a> to manage a MySQL database server but I get this error in cmd.\nI tried to to install that on my go project and get same error.</p>\n\n<pre><code>C:\\Users\\NakhodaSokoot&gt;go get github.com/go-xorm/dbweb\n# cd C:\\Users\\NakhodaSokoot\\go\\src\\github.com\\lunny\\nodb; git pull --ff-only\nfatal: No remote repository specified.  Please, specify either a URL or a\nremote name from which new revisions should be fetched.\npackage github.com/lunny/nodb/config: exit status 1\n# cd C:\\Users\\NakhodaSokoot\\go\\src\\golang.org\\x\\crypto; git pull --ff-only\nfatal: No remote repository specified.  Please, specify either a URL or a\nremote name from which new revisions should be fetched.\npackage golang.org/x/crypto/scrypt: exit status 1\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 1951617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75fd6253eb8ad986b120f11c4341097c?s=128&d=identicon&r=PG", "display_name": "Akshay Bhat", "link": "https://stackoverflow.com/users/1951617/akshay-bhat"}, "is_accepted": true, "score": 1, "last_activity_date": 1491996967, "creation_date": 1491996967, "answer_id": 43368432, "question_id": 43367505, "link": "https://stackoverflow.com/questions/43367505/function-in-go-to-execute-select-query-on-database-and-return-json-output/43368432#43368432", "title": "Function in Go to execute select query on database and return json output", "body": "<p>Got the solution. Here is what I did.</p>\n\n<pre><code>func executeSQL(queryStr string) []byte {\nconnString := createConnectString()\nconn, err := sql.Open(\"mssql\", connString)\nif err != nil {\n    log.Fatal(\"Error while opening database connection:\", err.Error())\n}\ndefer conn.Close()\n\nrows, err := conn.Query(queryStr)\nif err != nil {\n    log.Fatal(\"Query failed:\", err.Error())\n}\ndefer rows.Close()\n\ncolumns, _ := rows.Columns()\ncount := len(columns)\n\nvar v struct {\n    Data []interface{} // `json:\"data\"`\n}\n\nfor rows.Next() {\n    values := make([]interface{}, count)\n    valuePtrs := make([]interface{}, count)\n    for i, _ := range columns {\n        valuePtrs[i] = &amp;values[i]\n    }\n    if err := rows.Scan(valuePtrs...); err != nil {\n        log.Fatal(err)\n    }\n\n//Created a map to handle the issue\n    var m map[string]interface{}\n    m = make(map[string]interface{})\n    for i := range columns {\n        m[columns[i]] = values[i]\n    }\n    v.Data = append(v.Data, m)\n}\njsonMsg, err := json.Marshal(v)\nreturn jsonMsg\n}\n</code></pre>\n\n<p>Let me know if there exists a better solution.</p>\n"}, {"tags": [], "owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1491999024, "creation_date": 1491999024, "answer_id": 43369164, "question_id": 43367505, "link": "https://stackoverflow.com/questions/43367505/function-in-go-to-execute-select-query-on-database-and-return-json-output/43369164#43369164", "title": "Function in Go to execute select query on database and return json output", "body": "<p>This code is directly from my \"sandbox\" for MsSQL (using denisenkom/go-mssqldb and jmoiron/sqlx) - I think it helps showing different approaches and probably QueryIntoMap is what you were looking for:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"fmt\"\n    _ \"github.com/denisenkom/go-mssqldb\"\n    \"time\"\n    \"github.com/jmoiron/sqlx\"\n    \"encoding/json\"\n)\n\ntype Customer struct {\n    CustomerId string `db:\"customerID\" json:\"customer_id\"`\n    Company    interface{} `db:\"companyName\" json:\"company_name\"`\n    Contact    interface{} `db:\"contactName\" json:\"contact_name\"`\n}\n\nfunc main() {\n    connection := \"server=192.168.55.3\\\\SqlExpress2012;database=Northwind;user id=me;Password=secret\"\n\n    //QueryIntoMap(connection)\n    ScanIntoSlice(connection)\n}\n\nfunc QueryIntoMap(connection string) {\n\n    fmt.Println(\"QueryIntoMap sample\")\n    fmt.Println(\"--------------------\")\n\n    sel := `select customerId, companyName, contactName\n    from customers\n    where customerId = :id`\n\n    values := make(map[string]interface{})\n\n\n    db, err := sqlx.Open(\"mssql\", connection)\n    //db.MapperFunc(strings.ToUpper)\n    e(err)\n    defer db.Close()\n    tx := db.MustBegin()\n    stmt, err := tx.PrepareNamed(sel)\n    e(err)\n\n    stmt.QueryRowx(map[string]interface{}{\"id\": \"BONAP\"}).MapScan(values)\n    tx.Commit()\n\n    for k, v := range values {\n        fmt.Printf(\"%s %v\\n\", k, v)\n    }\n\n    js, err := json.Marshal(values)\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(string(js))\n    fmt.Println(\"--------------------\")\n}\n\nfunc ScanIntoStruct(connection string) {\n    fmt.Println(\"Scan into struct sample\")\n    fmt.Println(\"--------------------\")\n\n    db, err := sqlx.Open(\"mssql\", connection)\n    e(err)\n    defer db.Close()\n\n    customer := Customer{}\n\n    rows, err := db.Queryx(`select customerID, companyName, contactName\n    from Customers`)\n\n    for rows.Next() {\n        err = rows.StructScan(&amp;customer)\n        if err != nil {\n            log.Fatalln(err)\n        }\n        //fmt.Printf(\"%#v\\n\", user)\n        fmt.Printf(\"%-10s %-50v %-50v\\n\",\n            customer.CustomerId,\n            customer.Company,\n            customer.Contact)\n        js, err := json.Marshal(customer)\n        e(err)\n        fmt.Println(string(js))\n    }\n    fmt.Println(\"--------------------\")\n\n}\n\nfunc ScanIntoSlice(connection string) {\n    fmt.Println(\"Scan into slice sample\")\n    fmt.Println(\"--------------------\")\n    start := time.Now()\n    db, err := sqlx.Open(\"mssql\", connection)\n    e(err)\n    defer db.Close()\n\n    customers := []Customer{}\n\n    err = db.Select(&amp;customers, `select customerID, companyName, contactName from customers`)\n    e(err)\n\n    for i, customer := range customers {\n        fmt.Printf(\"%3d. %-10s %-50v %-50v\\n\",\n            i,\n            customer.CustomerId,\n            customer.Company,\n            customer.Contact)\n    }\n    js, err := json.Marshal(customers)\n    e(err)\n\n    fmt.Println(string(js))\n\n    fmt.Printf(\"%s\", time.Since(start))\n    fmt.Println(\"--------------------\")\n\n}\n\nfunc e(err error) {\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 1951617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75fd6253eb8ad986b120f11c4341097c?s=128&d=identicon&r=PG", "display_name": "Akshay Bhat", "link": "https://stackoverflow.com/users/1951617/akshay-bhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1440, "favorite_count": 0, "accepted_answer_id": 43368432, "answer_count": 2, "score": 2, "last_activity_date": 1492009939, "creation_date": 1491994311, "last_edit_date": 1492009939, "question_id": 43367505, "link": "https://stackoverflow.com/questions/43367505/function-in-go-to-execute-select-query-on-database-and-return-json-output", "title": "Function in Go to execute select query on database and return json output", "body": "<p>I am writing a function in Go to execute select query on database.</p>\n\n<p><strong>Input:</strong> String e.g. \"Select id, name, age from sometable\"\nThis query changes everytime.</p>\n\n<p><strong>Output:</strong> Output of select query in json format.</p>\n\n<p><strong>Sample Expected output:</strong> {\"Data\":[{\"id\":1,\"name\":\"abc\", \"age\":40},{\"id\":2,\"name\":\"xyz\", \"age\":45}]}</p>\n\n<p><strong>Sample Actual output:</strong> {\"Data\":[[1,\"abc\",40],[2,\"xyz\",45]]}</p>\n\n<p>Instead of i.e. column_name:value, I get only values. \nHow do I get the expected output?</p>\n\n<pre><code>func executeSQL(queryStr string) []byte {\nconnString := createConnectString()\nconn, err := sql.Open(\"mssql\", connString)\nif err != nil {\n    log.Fatal(\"Error while opening database connection:\", err.Error())\n}\ndefer conn.Close()\n\nrows, err := conn.Query(queryStr)\nif err != nil {\n    log.Fatal(\"Query failed:\", err.Error())\n}\ndefer rows.Close()\n\ncolumns, _ := rows.Columns()\ncount := len(columns)\n\nvar v struct {\n    Data []interface{} // `json:\"data\"`\n}\n\nfor rows.Next() {\n    values := make([]interface{}, count)\n    valuePtrs := make([]interface{}, count)\n    for i, _ := range columns {\n        valuePtrs[i] = &amp;values[i]\n    }\n    if err := rows.Scan(valuePtrs...); err != nil {\n        log.Fatal(err)\n    }\n    v.Data = append(v.Data, values)\n}\njsonMsg, err := json.Marshal(v)\nreturn jsonMsg\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 159, "user_id": 3573024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d560ff0aeb4ce52219a166547fdb09?s=128&d=identicon&r=PG&f=1", "display_name": "mgagnon", "link": "https://stackoverflow.com/users/3573024/mgagnon"}, "edited": false, "score": 0, "creation_date": 1491993028, "post_id": 43366452, "comment_id": 73795646, "body": "May be use the idler interface to create the &quot;fields&quot; variable, like this:  fields := []ider{ \t\t&amp;Field{&quot;Field1&quot;},}. It runs on your go playground link."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 5, "creation_date": 1491993672, "post_id": 43366452, "comment_id": 73796157, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12994679/golang-slice-of-struct-slice-of-interface-it-implements\">golang: slice of struct != slice of interface it implements?</a>"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "reply_to_user": {"reputation": 159, "user_id": 3573024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d560ff0aeb4ce52219a166547fdb09?s=128&d=identicon&r=PG&f=1", "display_name": "mgagnon", "link": "https://stackoverflow.com/users/3573024/mgagnon"}, "edited": false, "score": 0, "creation_date": 1491994815, "post_id": 43366452, "comment_id": 73797016, "body": "@mgagnon yes that works. I just edited the question, because my problem is nested inside an additional type."}, {"owner": {"reputation": 159, "user_id": 3573024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d560ff0aeb4ce52219a166547fdb09?s=128&d=identicon&r=PG&f=1", "display_name": "mgagnon", "link": "https://stackoverflow.com/users/3573024/mgagnon"}, "edited": false, "score": 1, "creation_date": 1491997794, "post_id": 43366452, "comment_id": 73799129, "body": "From the Tim Cooper link, there a reference to that: <a href=\"https://github.com/golang/go/wiki/InterfaceSlice\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/InterfaceSlice</a>  I guess it will help you."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1491998179, "post_id": 43366452, "comment_id": 73799347, "body": "Thanks. That link helped."}], "answers": [{"comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1492011919, "post_id": 43374066, "comment_id": 73810552, "body": "In go you would usually do something like <code>var asIder []ider; for _, v := range myObj.Fields { asIder = append(asIder, v) }; inSlice(asIder, &quot;Field1&quot;)</code> or wrap the conversion up in a function."}], "tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": false, "score": 3, "last_activity_date": 1492011706, "creation_date": 1492011706, "answer_id": 43374066, "question_id": 43366452, "link": "https://stackoverflow.com/questions/43366452/slice-of-a-specific-interface-in-go/43374066#43374066", "title": "Slice of a specific interface in Go", "body": "<p>As one can read in <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Calls</a></p>\n\n<blockquote>\n  <p>Except for one special case, arguments must be single-valued expressions assignable to the parameter types of F and are evaluated before the function is called.</p>\n</blockquote>\n\n<p>So in the above code <code>myObj.Fields</code> is of type <code>[]*Field</code> which needs to be assignable to <code>[]ider</code> for the code to compile. Let's check wether that is the case. As one can read in <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Assignability</a></p>\n\n<blockquote>\n  <p>A value x is assignable to a variable of type T (\"x is assignable to T\") in any of these cases:</p>\n  \n  <ul>\n  <li>x's type is identical to T.</li>\n  <li>x's type V and T have identical underlying types and at least one of V or T is not a named type.</li>\n  <li>T is an interface type and x implements T.</li>\n  <li>x is a bidirectional channel value, T is a channel type, x's type V and T have identical element types, and at least one of V or T is not a named type.</li>\n  <li>x is the predeclared identifier nil and T is a pointer, function, slice, map, channel, or interface type.</li>\n  <li>x is an untyped constant representable by a value of type T.</li>\n  </ul>\n</blockquote>\n\n<ol>\n<li><p>Are <code>[]*Field</code> and <code>[]ider</code> identical?\n<a href=\"https://golang.org/ref/spec#Type_identity\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Type_identity</a> tells us</p>\n\n<blockquote>\n  <p>Two slice types are identical if they have identical element types.</p>\n</blockquote>\n\n<p>So are <code>*Field</code> and <code>ider</code> identical?\nThe above source tells us</p>\n\n<blockquote>\n  <p>A named and an unnamed type are always different.</p>\n</blockquote>\n\n<p>So no and no, as <code>*Field</code> is unnamed and <code>ider</code> is named.</p></li>\n<li><p>The underlying type of <code>[]*Field</code> is <code>[]*Field</code> and the underlying type of <code>[]ider</code> is <code>[]ider</code>, and those are not identical, as we checked in 1. so this is also not applicable. Read here <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Types</a></p></li>\n<li><p>is not applicable as []ider is not an interface type, but a slice type. Read here <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Slice_types</a></p></li>\n<li><p>also not applicable as there is no channel used</p></li>\n<li><p>also not applicable as there is no nil used</p></li>\n<li><p>also not applicable as there is no constant used.</p></li>\n</ol>\n\n<p>So summing up: A value of type <code>[]*Field</code> is not assignable to <code>[]ider</code> and therefore we can't use an expression of type <code>[]*Field</code> in a parameter position\nof a function call with parameter type <code>[]ider</code>.</p>\n"}], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3207, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1492011706, "creation_date": 1491991569, "last_edit_date": 1492010024, "question_id": 43366452, "link": "https://stackoverflow.com/questions/43366452/slice-of-a-specific-interface-in-go", "title": "Slice of a specific interface in Go", "body": "<p>I want to create a function, which uses a slice of an interface. </p>\n\n<p>For example I have an interface <code>ider</code> which wraps one <code>ID() string</code> function. Then I have a type (<code>Field</code>), which implements the <code>ider</code> interface. Now I have different objects, which have slice of <code>ider</code> as parameter.</p>\n\n<p>Inside my function I expect a slice of <code>ider</code> (<code>[]ider</code>). That function should be used by different types, which are implementing the <code>ider</code>.</p>\n\n<p>This is hard to describe. So here is a complete example, which outputs the following error: </p>\n\n<blockquote>\n  <p>cannot use myObj.Fields (type []*Field) as type []ider in argument to inSlice</p>\n</blockquote>\n\n<pre><code>type ider interface {\n    ID() string\n}\n\ntype Field struct {\n    Name string\n}\n\n// Implements ider interface\nfunc (f *Field) ID() string {\n    return f.Name\n}\n\ntype MyObject struct {\n    Fields []*Field\n}\n\n// uses slice of ider\nfunc inSlice(idSlice []ider, s string) bool {\n    for _, v := range idSlice {\n        if s == v.ID() {\n            return true\n        }\n    }\n    return false\n}\n\nfunc main() {\n    fields := []*Field{\n        &amp;Field{\"Field1\"},\n    }\n    myObj := MyObject{\n        Fields: fields,\n    }\n    fmt.Println(inSlice(myObj.Fields, \"Field1\"))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/p8PPH51vxP\" rel=\"nofollow noreferrer\">https://play.golang.org/p/p8PPH51vxP</a></p>\n\n<p>I already searched for answers, but I did just found solutions for empty interfaces and not for specific ones.</p>\n"}, {"tags": ["macos", "go", "process"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1492001805, "post_id": 43364958, "comment_id": 73802115, "body": "That should work as expected. Are you certain the child processes aren&#39;t setting their own PGIDs; or maybe even ignoring SIGINT? Does ps show that they all have the same PGID?"}, {"owner": {"reputation": 1166, "user_id": 211195, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/47ffd6538b8c1694db320e07af4397ff?s=128&d=identicon&r=PG", "display_name": "rosencreuz", "link": "https://stackoverflow.com/users/211195/rosencreuz"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492004067, "post_id": 43364958, "comment_id": 73803987, "body": "I&#39;m certain. ps shows. If I execute the command in terminal, new process has the pid and pgid same, all the children processes are getting the same pgid as the new process. When I executed the command in go, both the new process and its children has the pgid of the terminal session. (In linux it works as expected though)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1492007158, "post_id": 43364958, "comment_id": 73806591, "body": "Are any of these process starting in a shell pipeline? It sounds like something else is specifically setting or changing the pgid. You could try setting <code>Setsid: true</code> to make sure the process is starting in a new session."}, {"owner": {"reputation": 1166, "user_id": 211195, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/47ffd6538b8c1694db320e07af4397ff?s=128&d=identicon&r=PG", "display_name": "rosencreuz", "link": "https://stackoverflow.com/users/211195/rosencreuz"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492069807, "post_id": 43364958, "comment_id": 73834285, "body": "It sets the process group id correctly with <code>Setsid: true</code> and it&#39;s all fine. I thought this is exactly what <code>Setpgid</code> is supposed to do. Am I mistaken?"}, {"owner": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 0, "creation_date": 1617638028, "post_id": 43364958, "comment_id": 118352715, "body": "@rosencreuz I stumbled upon the same problem. Did you find an explanation?"}], "owner": {"reputation": 1166, "user_id": 211195, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/47ffd6538b8c1694db320e07af4397ff?s=128&d=identicon&r=PG", "display_name": "rosencreuz", "link": "https://stackoverflow.com/users/211195/rosencreuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1356, "favorite_count": 2, "answer_count": 0, "score": 4, "last_activity_date": 1492010191, "creation_date": 1491987692, "last_edit_date": 1492010191, "question_id": 43364958, "link": "https://stackoverflow.com/questions/43364958/start-command-with-new-process-group-id-golang", "title": "Start command with new process group id golang", "body": "<p>I'm starting a command and storing its PID with the intention of killing it later on. As the process is started with the command creates sub processes, I have to send the kill signal to all process group using </p>\n\n<pre><code>syscall.Kill(-pid, syscall.SIGINT)\n</code></pre>\n\n<p>This works fine in Linux but not on MacOS. The reason is that, on the mac when command starts it doesn't create it with a different process group, so sending signal to <code>-pid</code> is failing. (If I send the signal to <code>pid</code>, it doesn't kill the child processes)</p>\n\n<p>I tried starting the command with the following flags as well, but it doesn't help on MacOS.</p>\n\n<pre><code>command := exec.Command(commandName, arg...)\ncommand.SysProcAttr = &amp;syscall.SysProcAttr{Setpgid: true, Pgid: 0}\n</code></pre>\n\n<p>The newly started process gets the group id of the terminal session where the go executable is running instead of new process group id. Is there a way to start a new process group in MacOS?</p>\n"}, {"tags": ["go", "tar"], "answers": [{"tags": [], "owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "is_accepted": true, "score": 1, "last_activity_date": 1491992697, "creation_date": 1491992697, "answer_id": 43366910, "question_id": 43363650, "link": "https://stackoverflow.com/questions/43363650/how-to-get-desired-path-for-the-files-inside-tar-while-tarring-them-up/43366910#43366910", "title": "How to get desired path for the files inside tar while tarring them up", "body": "<p>Whatever name is specified in the tar header, is used. Use the strings.LastIndex (or strings.Index) function of the strings package to separate the part till /tmp.</p>\n\n<p>So if the code in TarGzWrite function above is modified as follows it works the way you want (note: you may want to replace strings.LastIndex below with strings.Index).</p>\n\n<pre><code>//TarGzWrite function same as above....\nh := new(tar.Header)\n//New code after this..\nlastIndex := strings.LastIndex(_path, \"/tmp\")\nfmt.Println(\"String is \", _path, \"Last index is\", lastIndex)\nvar name string\nif lastIndex &gt; 0 {\n    name = _path[lastIndex+len(\"/tmp\")+1:]\n    fmt.Println(\"Got name:\", name)\n} else {\n    //This would not be needed, but was there just for testing my code\n    name = _path\n}\n// h.Name = _path\nh.Name = name\nh.Size = fi.Size()\nh.Mode = int64(fi.Mode())\n</code></pre>\n"}], "owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 43366910, "answer_count": 1, "score": 0, "last_activity_date": 1492010360, "creation_date": 1491983988, "last_edit_date": 1492010360, "question_id": 43363650, "link": "https://stackoverflow.com/questions/43363650/how-to-get-desired-path-for-the-files-inside-tar-while-tarring-them-up", "title": "How to get desired path for the files inside tar while tarring them up", "body": "<p>I have been using this code to write to a tar file. I am calling it like \n<code>err = retarIt(dirTopDebug, path)</code>, where <code>dirTopDebug</code> is the path to my tar file (<code>/tmp/abc.tar</code>), and <code>path</code> is the path of files I want to add (<code>/tmp/xyz/...</code>). When I am untarring the generated tar file, I find that inside <code>abc.tar</code> files are put in <code>/tmp/xyz/..</code> format. But I want them inside tar like <code>xyz/...</code>, i.e. without the <code>tmp</code> folder.</p>\n\n<p>How can I do that?</p>\n\n<pre><code>func TarGzWrite(_path string, tw *tar.Writer, fi os.FileInfo) {\n    fr, _ := os.Open(_path)\n    //handleError(err)\n    defer fr.Close()\n\n    h := new(tar.Header)\n    h.Name = _path\n    h.Size = fi.Size()\n    h.Mode = int64(fi.Mode())\n    h.ModTime = fi.ModTime()\n\n    err := tw.WriteHeader(h)\n    if err != nil {\n        panic(err)\n    }\n\n    _, _ = io.Copy(tw, fr)\n    //handleError( err )\n}\n\nfunc IterDirectory(dirPath string, tw *tar.Writer) {\n    dir, _ := os.Open(dirPath)\n    //handleError( err )\n    defer dir.Close()\n    fis, _ := dir.Readdir(0)\n    //handleError( err )\n    for _, fi := range fis {\n        fmt.Println(dirPath)\n        curPath := dirPath + \"/\" + fi.Name()\n        if fi.IsDir() {\n            //TarGzWrite( curPath, tw, fi )\n            IterDirectory(curPath, tw)\n        } else {\n            fmt.Printf(\"adding... %s\\n\", curPath)\n            TarGzWrite(curPath, tw, fi)\n        }\n    }\n}\n\nfunc retarIt(outFilePath, inPath string) error {\n    fw, err := os.Create(outFilePath)\n    if err != nil {\n            return err\n    }\n    defer fw.Close()\n    gw := gzip.NewWriter(fw)\n    defer gw.Close()\n\n    // tar write\n    tw := tar.NewWriter(gw)\n    defer tw.Close()\n\n    IterDirectory(inPath, tw)\n    fmt.Println(\"tar.gz ok\")\n    return nil\n}\n</code></pre>\n"}, {"tags": ["json", "go", "http-error"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1491988912, "post_id": 43362621, "comment_id": 73792482, "body": "Related: <a href=\"http://stackoverflow.com/questions/31293314/golang-terminating-or-aborting-an-http-request/31293435#31293435\">Golang: terminating or aborting an HTTP request</a>; and <a href=\"http://stackoverflow.com/questions/27972715/multiple-response-writeheader-calls-in-really-simple-example/27973060#27973060\">multiple response.WriteHeader calls in really simple example?</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1492010613, "post_id": 43362621, "comment_id": 73809548, "body": "<code>I am making multiple WriteHeader calls</code> -- this is your problem. For obvious reasons, only the first call to <code>WriteHeader</code> has any effect. Apparently, your first call is setting the status to 200."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492010647, "post_id": 43362621, "comment_id": 73809572, "body": "<code>but instead of the error message in text format, I want it to be in JSON. What should I do?</code> -- This is an unrelated question, and should be asked separately."}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492010854, "post_id": 43362621, "comment_id": 73809738, "body": "@Flimzy Check mkopriva &#39;s answer. He is also making similar calls but just in a different order. It doesn&#39;t give out a warning and works the way it is supposed to i.e. proper response code and then a json body on response body. How did changing the order make a difference? It is still making multiple calls"}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492011026, "post_id": 43362621, "comment_id": 73809878, "body": "@Flimzy I added the <code>instead of the error message in text format, I want it to be in JSON.</code> part just to let everyone know how I have been doing it uptil now which made the response code appear properly. There could have been a similar approach for content type json, I dont know. I was just trying to put down as much info as I could to have my issue clarified."}], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 4251144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2449afc5a353b697485068d965424f?s=128&d=identicon&r=PG&f=1", "display_name": "backing", "link": "https://stackoverflow.com/users/4251144/backing"}, "is_accepted": false, "score": 0, "last_activity_date": 1491985077, "creation_date": 1491985077, "answer_id": 43364014, "question_id": 43362621, "link": "https://stackoverflow.com/questions/43362621/how-to-separately-set-error-code-along-with-marshalling-json-in-response-body/43364014#43364014", "title": "How to separately set error code along with marshalling json in response body?", "body": "<p>json format is still plain text. json.Marshal errorBody to string first.  </p>\n\n<pre><code>body, err := json.Marshal(errBody)\nif err != nil{\n    // todo\n}\nhttp.Error(res, string(body), http.StatusBadRequest)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "edited": false, "score": 0, "creation_date": 1492010755, "post_id": 43365078, "comment_id": 73809656, "body": "Why did changing the order of the calls worked flawlessly? What was wrong with my way?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "edited": false, "score": 1, "creation_date": 1492011364, "post_id": 43365078, "comment_id": 73810124, "body": "@Krash: The first time you write <i>anything</i>, <code>WriteHeader</code> is called (by default with status 200).  <a href=\"https://golang.org/pkg/net/http/#ResponseWriter\" rel=\"nofollow noreferrer\">Read the docs</a> for more info."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1492011378, "last_edit_date": 1492011378, "creation_date": 1491987967, "answer_id": 43365078, "question_id": 43362621, "link": "https://stackoverflow.com/questions/43362621/how-to-separately-set-error-code-along-with-marshalling-json-in-response-body/43365078#43365078", "title": "How to separately set error code along with marshalling json in response body?", "body": "<p>You can write the header first and then the body.</p>\n\n<pre><code>res.Header().Set(\"Content-Type\", \"application/json; charset=utf-8\")\nres.WriteHeader(http.StatusBadRequest)\nif err = json.NewEncoder(res).Encode(err); err != nil {\n    // handle encoder error\n}\n</code></pre>\n\n<p>And if the response is still <code>200</code> and/or you're getting the warning, that means that you or some of the packages you use are writing the header for you in some other place.</p>\n\n<p><strong>Update</strong>: (to answer relevant question from comment)</p>\n\n<p><code>json.NewEncoder(res).Encode(err)</code> calls the <code>Write</code> method on <code>res</code>, and the implementation of <code>Write</code> from the standard <code>net/http</code> package automatically sets the status to <code>200</code> if it's not already set. And the implementation of <code>WriteHeader</code> checks whether status is already set or not and if it is, it just logs the warning and bails, without overwriting it. </p>\n\n<p>So if you wan't to control the status you need to call <code>WriteHeader</code> before your write to the response whether you're writing json with the encoder or calling <code>res.Write</code> yourself.</p>\n"}], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 43365078, "answer_count": 2, "score": 0, "last_activity_date": 1492011378, "creation_date": 1491980786, "question_id": 43362621, "link": "https://stackoverflow.com/questions/43362621/how-to-separately-set-error-code-along-with-marshalling-json-in-response-body", "title": "How to separately set error code along with marshalling json in response body?", "body": "<p>In my application, when there is error I am writing a json error message on response body but this makes response code 200. I tried separately doing </p>\n\n<pre><code>json.NewEncoder(res).Encode(errorBody)\nres.WriteHeader(http.StatusBadRequest)\n</code></pre>\n\n<p>But it still gives out response code 200 along with a warning that I am making multiple WriteHeader calls. I want to have something like</p>\n\n<pre><code>http.Error(res,\"Some Error Message here\",http.StatusBadRequest)\n</code></pre>\n\n<p>but instead of the error message in text format, I want it to be in JSON. What should I do?</p>\n"}, {"tags": ["go", "sonarqube"], "comments": [{"owner": {"reputation": 2627, "user_id": 4236400, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/K94mB.jpg?s=128&g=1", "display_name": "Ren&#233; Hoffmann", "link": "https://stackoverflow.com/users/4236400/ren%c3%a9-hoffmann"}, "edited": false, "score": 1, "creation_date": 1491980827, "post_id": 43361810, "comment_id": 73786965, "body": "You could create a Sonarqube plugin for GO, yourself."}, {"owner": {"reputation": 9, "user_id": 7854643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ww7p-XBRiU0/AAAAAAAAAAI/AAAAAAAAAC0/NazeM23cKZU/photo.jpg?sz=128", "display_name": "Samrat S", "link": "https://stackoverflow.com/users/7854643/samrat-s"}, "reply_to_user": {"reputation": 2627, "user_id": 4236400, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/K94mB.jpg?s=128&g=1", "display_name": "Ren&#233; Hoffmann", "link": "https://stackoverflow.com/users/4236400/ren%c3%a9-hoffmann"}, "edited": false, "score": 0, "creation_date": 1492054808, "post_id": 43361810, "comment_id": 73828114, "body": "How to do that, can you please guide me with that"}, {"owner": {"reputation": 2627, "user_id": 4236400, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/K94mB.jpg?s=128&g=1", "display_name": "Ren&#233; Hoffmann", "link": "https://stackoverflow.com/users/4236400/ren%c3%a9-hoffmann"}, "edited": false, "score": 0, "creation_date": 1492062855, "post_id": 43361810, "comment_id": 73830565, "body": "I&#39;ve never done this myself. But there should be tutorials on how to. Probably, you will have to analyse plugins for other languages, too, in order to understand how plugins work."}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 465009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8147b756592e1a6971197aa5e00c9ae1?s=128&d=identicon&r=PG", "display_name": "loafoe", "link": "https://stackoverflow.com/users/465009/loafoe"}, "edited": false, "score": 1, "creation_date": 1522834020, "post_id": 43362168, "comment_id": 86302758, "body": "There is a now Go plugin available from SonarSource -- <a href=\"https://github.com/SonarSource/sonar-go\" rel=\"nofollow noreferrer\">github.com/SonarSource/sonar-go</a>"}], "tags": [], "owner": {"reputation": 1611, "user_id": 2435199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60f38a571aaacb06e39bfe45d5fda8d?s=128&d=identicon&r=PG", "display_name": "Eric Hartmann", "link": "https://stackoverflow.com/users/2435199/eric-hartmann"}, "is_accepted": false, "score": 2, "last_activity_date": 1492010500, "last_edit_date": 1492010500, "creation_date": 1491979358, "answer_id": 43362168, "question_id": 43361810, "link": "https://stackoverflow.com/questions/43361810/does-sonarqube-support-go-lang-if-not-then-when-does-that-feature-come-into-pla/43362168#43362168", "title": "Does Sonarqube support GO lang, if not then when does that feature come into place", "body": "<p>There is no Go plugin for SonarQube for the time being and I'm not aware of a plan to have this plugin in the upcoming months.</p>\n"}], "owner": {"reputation": 9, "user_id": 7854643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ww7p-XBRiU0/AAAAAAAAAAI/AAAAAAAAAC0/NazeM23cKZU/photo.jpg?sz=128", "display_name": "Samrat S", "link": "https://stackoverflow.com/users/7854643/samrat-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1109, "favorite_count": 0, "closed_date": 1492135140, "answer_count": 1, "score": 0, "last_activity_date": 1492010500, "creation_date": 1491978153, "last_edit_date": 1491994733, "question_id": 43361810, "link": "https://stackoverflow.com/questions/43361810/does-sonarqube-support-go-lang-if-not-then-when-does-that-feature-come-into-pla", "closed_reason": "Opinion-based", "title": "Does Sonarqube support GO lang, if not then when does that feature come into place", "body": "<p>I need to analyse my code against Sonarqube 5.1, is there a way to do this, if not when will this feature come handy with sonar.</p>\n"}, {"tags": ["amazon-web-services", "go", "deployment", "amazon-elastic-beanstalk"], "comments": [{"owner": {"reputation": 535, "user_id": 4243929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-EYd2u4koXNA/AAAAAAAAAAI/AAAAAAAAAY8/U_XHAUwPmGA/photo.jpg?sz=128", "display_name": "Christian Riese", "link": "https://stackoverflow.com/users/4243929/christian-riese"}, "edited": false, "score": 0, "creation_date": 1517161239, "post_id": 43360476, "comment_id": 83971523, "body": "Hi! I&#39;ve got the same problem, did you solve it?"}, {"owner": {"reputation": 5381, "user_id": 3958148, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1d13082f7803e52dd98b2808509976c2?s=128&d=identicon&r=PG", "display_name": "Sung Cho", "link": "https://stackoverflow.com/users/3958148/sung-cho"}, "edited": false, "score": 0, "creation_date": 1525696160, "post_id": 43360476, "comment_id": 87445221, "body": "I have the same problem. Any ideas?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5879919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27afd21588c6798578dff17e61362bc6?s=128&d=identicon&r=PG", "display_name": "Linz Jax", "link": "https://stackoverflow.com/users/5879919/linz-jax"}, "reply_to_user": {"reputation": 969, "user_id": 1831452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b37747b2425c48e6d8b57fda11257f68?s=128&d=identicon&r=PG", "display_name": "nguyenhoai890", "link": "https://stackoverflow.com/users/1831452/nguyenhoai890"}, "edited": false, "score": 0, "creation_date": 1540314751, "post_id": 51597943, "comment_id": 92816655, "body": "Yikes, nice catch. Updated. Thanks!"}, {"owner": {"reputation": 3596, "user_id": 2443687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1da01ca60576663e27ab608fc4dbbbb2?s=128&d=identicon&r=PG", "display_name": "Carlos Martinez", "link": "https://stackoverflow.com/users/2443687/carlos-martinez"}, "edited": false, "score": 0, "creation_date": 1571793660, "post_id": 51597943, "comment_id": 103355503, "body": "None of this works for me, I don&#39;t get what&#39;s wrong. Same setup :("}], "tags": [], "owner": {"reputation": 21, "user_id": 5879919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27afd21588c6798578dff17e61362bc6?s=128&d=identicon&r=PG", "display_name": "Linz Jax", "link": "https://stackoverflow.com/users/5879919/linz-jax"}, "is_accepted": false, "score": 2, "last_activity_date": 1540314736, "last_edit_date": 1540314736, "creation_date": 1532966406, "answer_id": 51597943, "question_id": 43360476, "link": "https://stackoverflow.com/questions/43360476/elastic-beanstalk-procfile-for-go/51597943#51597943", "title": "Elastic Beanstalk Procfile for go", "body": "<p>I was finally able to get a Go application to deploy with Elastic Beanstalk using the <a href=\"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3.html\" rel=\"nofollow noreferrer\">eb client</a>. There are a few things that EB requires:</p>\n\n<ol>\n<li>The name of your main file should be <code>application.go</code>.</li>\n<li>Make sure your app is listening on port 5000.</li>\n<li><p>You'll need a Procfile in the main root with</p>\n\n<pre><code>web: bin/application\n</code></pre></li>\n<li><p>You'll need a Buildfile with</p>\n\n<pre><code>make: ./build.sh\n</code></pre></li>\n<li><p>And finally you'll need a <code>build.sh</code> file with</p>\n\n<pre><code>#!/usr/bin/env bash\n# Stops the process if something fails\nset -xe\n\n# All of the dependencies needed/fetched for your project. \n# FOR EXAMPLE:\ngo get \"github.com/gin-gonic/gin\"\n\n# create the application binary that eb uses\nGOOS=linux GOARCH=amd64 go build -o bin/application -ldflags=\"-s -w\"\n</code></pre></li>\n</ol>\n\n<p>Then if you run <code>eb deploy</code> (after creating your initial eb repository), it should work. I wrote a whole tutorial for deploying a Gin application on EB <a href=\"https://blog.memcachier.com/2018/07/30/gin-elastic-beanstalk-and-memcache/\" rel=\"nofollow noreferrer\">here</a>. The section specifically on deploying with Elastic Beanstalk is <a href=\"https://blog.memcachier.com/2018/07/30/gin-elastic-beanstalk-and-memcache/#deploying-with-elastic-beanstalk\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 51, "user_id": 7633477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74303d9a361c5c61acd9481f4b706a?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/7633477/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1250, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1540314736, "creation_date": 1491972284, "last_edit_date": 1516254729, "question_id": 43360476, "link": "https://stackoverflow.com/questions/43360476/elastic-beanstalk-procfile-for-go", "title": "Elastic Beanstalk Procfile for go", "body": "<p>I'm trying to deploy my go restful server program to EC2 Linux using Elastic Beanstalk. The document says that I need to create a Procfile at the root. So I did. Here are the steps:</p>\n\n<ol>\n<li><p>Build my go program myapp.go to using </p>\n\n<pre><code>$ go build -o myapp -i myapp.go\n</code></pre></li>\n<li><p>Create a Procfile with exact name at the root with</p>\n\n<pre><code>web: myapp\n</code></pre></li>\n<li>Zip up the Procfile and the myapp image to a <code>myapp.zip</code> file.</li>\n</ol>\n\n<p>Upload to the server via Elastic Beanstalk console. But I keep getting <code>Degraded</code> health and warning with</p>\n\n<blockquote>\n  <p>WARN   Process termination taking longer than 10 seconds.</p>\n</blockquote>\n\n<p>Any suggestions. By the way, I tried to use the same procfile procedure on the simple <code>application.go</code> zip file came from the Elastic Beanstalk example library. It didn't work either. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 1, "creation_date": 1491956528, "post_id": 43358131, "comment_id": 73779163, "body": "Please show us the code how you construct the nested map."}, {"owner": {"reputation": 103, "user_id": 3550166, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a96432042e7e6d9c97d1bb08f5ea67d4?s=128&d=identicon&r=PG&f=1", "display_name": "user3550166", "link": "https://stackoverflow.com/users/3550166/user3550166"}, "reply_to_user": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1491956921, "post_id": 43358131, "comment_id": 73779244, "body": "I&#39;m not constructing it. This map is constructed by docker. BTW im getting the right value map[h:5] but I&#39;m not sure how to retrieve the value of inner map."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1491957988, "post_id": 43358131, "comment_id": 73779504, "body": "Please get in the habit of using <a href=\"https://golang.org/cmd/gofmt/\" rel=\"nofollow noreferrer\"><code>gofmt</code></a>. It will make your code easier for you, and others to read."}, {"owner": {"reputation": 103, "user_id": 3550166, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a96432042e7e6d9c97d1bb08f5ea67d4?s=128&d=identicon&r=PG&f=1", "display_name": "user3550166", "link": "https://stackoverflow.com/users/3550166/user3550166"}, "edited": false, "score": 0, "creation_date": 1491958006, "post_id": 43358131, "comment_id": 73779510, "body": "When I print options =&gt;  map[data1:false data2:map[h:5]]"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1491958069, "post_id": 43358131, "comment_id": 73779528, "body": "Please include the <i>complete</i> code, including where you build your nested map. I can&#39;t really tell what you&#39;re trying to do.  What does <code>map[h:5]</code> mean?"}, {"owner": {"reputation": 103, "user_id": 3550166, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a96432042e7e6d9c97d1bb08f5ea67d4?s=128&d=identicon&r=PG&f=1", "display_name": "user3550166", "link": "https://stackoverflow.com/users/3550166/user3550166"}, "edited": false, "score": 0, "creation_date": 1491958197, "post_id": 43358131, "comment_id": 73779553, "body": "This is what I got when i print options[&quot;data2&quot;].  h-key 5-value"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1491958678, "post_id": 43358131, "comment_id": 73779681, "body": "If you want meaningful results when printing a map, be sure to use <code>fmt.Printf(&quot;%#v&quot;, map)</code> or <code>fmt.Printf(&quot;%+v&quot;, map)</code>.  Or consider using a package like <a href=\"https://godoc.org/github.com/davecgh/go-spew/spew\" rel=\"nofollow noreferrer\">spew</a> for even more informational data dumps."}, {"owner": {"reputation": 103, "user_id": 3550166, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a96432042e7e6d9c97d1bb08f5ea67d4?s=128&d=identicon&r=PG&f=1", "display_name": "user3550166", "link": "https://stackoverflow.com/users/3550166/user3550166"}, "edited": false, "score": 0, "creation_date": 1491960646, "post_id": 43358131, "comment_id": 73780146, "body": "ok i found it. Instead of this <code>opt, _ := options[&quot;data2&quot;].(OptionMap)</code> I have replaced this  <code>opt, _ := options[&quot;data2&quot;].(map[string]interface{})</code> it worked..im not sure whats the issue with previous one though"}], "answers": [{"tags": [], "owner": {"reputation": 620, "user_id": 6838838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/063168f6e5477ad7990330b95331d798?s=128&d=identicon&r=PG&f=1", "display_name": "Girdhar Sojitra", "link": "https://stackoverflow.com/users/6838838/girdhar-sojitra"}, "is_accepted": false, "score": 1, "last_activity_date": 1491977156, "last_edit_date": 1491977156, "creation_date": 1491976619, "answer_id": 43361375, "question_id": 43358131, "link": "https://stackoverflow.com/questions/43358131/retrieving-values-from-nested-map-in-golang/43361375#43361375", "title": "Retrieving values from nested map in golang", "body": "<p>You are getting nil value for inner map because you have not created inner map using type OptionMap.You must have created it using map[string]interface{} and trying to assert to OptionMap which is failing in getting nil value. See below example which is working with OptionMap type,too.Go through type assertion page at <a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">https://tour.golang.org/methods/15</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n\n\ntype OptionMap map[string]interface{}\n\nfunc main()  {\n    opt := make(OptionMap)\n    ineeropt := make(OptionMap)     // while creating Map specify OptionMap type\n    ineeropt[\"h\"]=5\n    opt[\"data1\"] = false\n    opt[\"data2\"] = ineeropt\n    test(opt)\n\n\n}\nfunc test(options OptionMap) {\n    opt, _ := options[\"data2\"].(OptionMap)  //If inner map is created using OptionMap then opt won't be nil\n    fmt.Println(\"opt\", opt)\n    fmt.Println(\"opt\", options)\n    for key, value := range options {\n        fmt.Println(\"Key:\", key, \"Value:\", value)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 3550166, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a96432042e7e6d9c97d1bb08f5ea67d4?s=128&d=identicon&r=PG&f=1", "display_name": "user3550166", "link": "https://stackoverflow.com/users/3550166/user3550166"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2117, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491977156, "creation_date": 1491955633, "last_edit_date": 1491957946, "question_id": 43358131, "link": "https://stackoverflow.com/questions/43358131/retrieving-values-from-nested-map-in-golang", "title": "Retrieving values from nested map in golang", "body": "<p>I'm trying to retrieving a value from a map within a map. I have followed online tutorials but not getting the right answer. This is my program:</p>\n\n<pre><code>type OptionMap map[string]interface{}\nfunc(options OptionMap) {\n    opt, _ := options[\"data2\"].(OptionMap)\n    fmt.Println(\"opt\", opt)\n    for key, value := range options {\n        fmt.Println(\"Key:\", key, \"Value:\", value)\n    }\n}\n</code></pre>\n\n<p>options has two keys data1 and data2 . Inside for loop the printf prints following</p>\n\n<pre><code>Key: data1 Value: false\nKey: data2 Value: map[h:5]\n</code></pre>\n\n<p>When I run the code</p>\n\n<pre><code>opt, _ := options[\"data2\"].(OptionMap)\n</code></pre>\n\n<p>I'm getting <code>nil</code> in <code>opt</code>. I'm not sure how to retrieve value of <code>map[h:5]</code>.  </p>\n"}, {"tags": ["go", "reflection", "interface"], "comments": [{"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1491949475, "post_id": 43357122, "comment_id": 73777372, "body": "Go&#39;s type system doesn&#39;t support dynamically assigning a type"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491950487, "post_id": 43357122, "comment_id": 73777672, "body": "What do you want to change <a href=\"https://github.com/gambol99/go-marathon/blob/master/examples/events_sse_transport/main.go#L73\" rel=\"nofollow noreferrer\">here</a>? You want the same result but without using type assertion? Or you&#39;re looking for a different result?"}, {"owner": {"reputation": 161, "user_id": 1423549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w6TST.png?s=128&g=1", "display_name": "Tuxity", "link": "https://stackoverflow.com/users/1423549/tuxity"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491950908, "post_id": 43357122, "comment_id": 73777775, "body": "@mkopriva I would like to do not write <code>(*marathon.EventDeploymentStepSuccess)</code> but something more dynamic with reflect. But I&#39;m not even sure if it&#39;s possible"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1491951780, "post_id": 43357122, "comment_id": 73777979, "body": "That&#39;s type assertion, <code>value.(type)</code>, so if I understand you correctly you want to access the <code>CurrentStep</code> field value without knowing the exact type? If yes, then you can use <a href=\"https://golang.org/pkg/reflect/#Value.FieldByName\" rel=\"nofollow noreferrer\">relfect.Value.FieldByName</a> like this: <a href=\"https://play.golang.org/p/EXbTFXt7Iu\" rel=\"nofollow noreferrer\">play.golang.org/p/EXbTFXt7Iu</a>."}, {"owner": {"reputation": 161, "user_id": 1423549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w6TST.png?s=128&g=1", "display_name": "Tuxity", "link": "https://stackoverflow.com/users/1423549/tuxity"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491952273, "post_id": 43357122, "comment_id": 73778116, "body": "Yes it&#39;s exactly what I want, you solved my problem. Thank you @mkopriva"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1491953015, "post_id": 43357122, "comment_id": 73778300, "body": "Please include your code in the question."}], "owner": {"reputation": 161, "user_id": 1423549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w6TST.png?s=128&g=1", "display_name": "Tuxity", "link": "https://stackoverflow.com/users/1423549/tuxity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491949796, "creation_date": 1491949106, "last_edit_date": 1491949796, "question_id": 43357122, "link": "https://stackoverflow.com/questions/43357122/get-a-value-of-an-interface-using-reflect", "title": "Get a value of an interface using reflect", "body": "<p>I'm trying to get a value from <a href=\"https://github.com/gambol99/go-marathon/blob/master/events.go#L107\" rel=\"nofollow noreferrer\">an interface</a> (it should be a pointer to another struct, <a href=\"https://github.com/gambol99/go-marathon/blob/master/events.go#L356\" rel=\"nofollow noreferrer\">see</a>). \nActually, I have to know the type of the pointer to access to the data it and it bother me. That's why I would like to use <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflect package</a> to do it better.</p>\n\n<p>Actually, I can display the type using <code>reflect.TypeOf(event.Event).String()</code> but I don't understand how to change <a href=\"https://github.com/gambol99/go-marathon/blob/master/examples/events_sse_transport/main.go#L73\" rel=\"nofollow noreferrer\">this line</a> in the example without specifying with something like <code>.(*marathon.EventDeploymentStepSuccess)</code></p>\n"}, {"tags": ["go", "deferred-execution"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1491944477, "creation_date": 1491944477, "answer_id": 43356125, "question_id": 43355748, "link": "https://stackoverflow.com/questions/43355748/how-does-golang-defer-work-in-cycles/43356125#43356125", "title": "How does golang defer work in cycles?", "body": "<p>From <a href=\"https://tour.golang.org/flowcontrol/12\" rel=\"nofollow noreferrer\">A Tour of Go</a>:</p>\n\n<blockquote>\n  <p>A defer statement defers the execution of a function until the surrounding function returns.</p>\n</blockquote>\n\n<p>So in your code, you're creating three (identical) defer functions, which will all run when the function exits.</p>\n\n<p>If you need a <code>defer</code> to run inside of a loop, you have to put it inside of a function.  This can be done in an anonymous function thusly:</p>\n\n<pre><code>for i := 0; i &lt; 3; i++ {\n    err := func() error {\n        session := d.session.Copy()\n        defer session.Close()\n        return operation(session.DB(Config.MongoDb).C(collection))\n    }()\n    if err == io.EOF {\n        continue\n    }\n    if err != nil {\n        return err\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 3, "last_activity_date": 1491981572, "last_edit_date": 1491981572, "creation_date": 1491944699, "answer_id": 43356178, "question_id": 43355748, "link": "https://stackoverflow.com/questions/43355748/how-does-golang-defer-work-in-cycles/43356178#43356178", "title": "How does golang defer work in cycles?", "body": "<p>Consider the following <a href=\"https://play.golang.org/p/H9fitCIPOt\" rel=\"nofollow noreferrer\">program</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc print(s string, i int) {\n    fmt.Println(s, i)\n}\n\nfunc main() {\n\n    for i := 0; i &lt; 3; i++ {\n        defer print(\"loop\", i)\n    }\n\n    fmt.Println(\"after loop 1\")\n\n    for i := 0; i &lt; 3; i++ {\n        func(i int) {\n            defer print(\"func\", i)\n        }(i)\n    }\n\n    fmt.Println(\"after loop 2\")\n\n}\n</code></pre>\n\n<p>It will print</p>\n\n<pre><code>after loop 1\nfunc 0\nfunc 1\nfunc 2\nafter loop 2\nloop 2\nloop 1\nloop 0\n</code></pre>\n\n<p>The deferred function calls will be put on stack and then executed in a reverse order at the end of surrounding function. In your case it will be quite bad as you will have connections waiting to be closed.</p>\n\n<p>I recommend wrapping the contents of loop into an inline function. It will call deferred function just as you want it.</p>\n"}], "owner": {"reputation": 39, "user_id": 7162720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93368104765d0668c979abfaf8093f88?s=128&d=identicon&r=PG&f=1", "display_name": "StTymur", "link": "https://stackoverflow.com/users/7162720/sttymur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1650, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1491981572, "creation_date": 1491942954, "last_edit_date": 1491945295, "question_id": 43355748, "link": "https://stackoverflow.com/questions/43355748/how-does-golang-defer-work-in-cycles", "title": "How does golang defer work in cycles?", "body": "<p>I'm trying to handle reconnections to MongoDB. To do this I try to perform every operation three times (in case it fails with io.EOF)</p>\n\n<pre><code>type MongoDB struct {\n    session *mgo.Session\n    DB      *mgo.Database\n}\n\nfunc (d MongoDB) performWithReconnect(collection string, \noperation func(*mgo.Collection) error) error {\n    var err error\n    for i := 0; i &lt; 3; i++ {\n        session := d.session.Copy()\n        defer session.Close()\n        err = operation(session.DB(Config.MongoDb).C(collection))\n        if err == io.EOF{\n            continue\n        }\n        if err == nil{\n            return err\n        }\n    }\n    return err\n}\n</code></pre>\n\n<p>So the question is about defer. Will it close all sessions as I suppose or  it is going to behave some other way? \nIf you know some good practices to handle this different way I will be happy to read them.</p>\n"}, {"tags": ["go", "asterisk"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491935958, "post_id": 43353694, "comment_id": 73770733, "body": "Are you certain that you have a file descriptor 3? Have you tried just opening the file?"}, {"owner": {"reputation": 2618, "user_id": 382564, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/o2wAN.jpg?s=128&g=1", "display_name": "Angad", "link": "https://stackoverflow.com/users/382564/angad"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491936088, "post_id": 43353694, "comment_id": 73770809, "body": "@JimB When I do an <code>ls &#47;proc&#47;&lt;PID&gt;&#47;fd</code> inside my Docker container, I see a <code>3</code>. When I try to <code>cat</code> it, I get <code>Permission Denied</code>"}, {"owner": {"reputation": 2618, "user_id": 382564, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/o2wAN.jpg?s=128&g=1", "display_name": "Angad", "link": "https://stackoverflow.com/users/382564/angad"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1491936176, "post_id": 43353694, "comment_id": 73770861, "body": "@Flimzy I&#39;ve used <a href=\"https://golang.org/pkg/os/#pkg-variables\" rel=\"nofollow noreferrer\">golang.org/pkg/os/#pkg-variables</a> as inspiration, and that&#39;s what Go seems to use?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491936994, "post_id": 43353694, "comment_id": 73771289, "body": "@Angad: from what I can see, your code is <i>supposed</i> to block indefinitely. That won&#39;t return until fd 3 is closed. Is it sending anything over the connection? Have you tried reading and writing in separate steps to see if you&#39;re making progress?"}, {"owner": {"reputation": 2618, "user_id": 382564, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/o2wAN.jpg?s=128&g=1", "display_name": "Angad", "link": "https://stackoverflow.com/users/382564/angad"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491937356, "post_id": 43353694, "comment_id": 73771485, "body": "@JimB Hmm - will give the standard Read/Write approach a shot, but if I remember correctly, WriteTo simply drains the buffer, ie it&#39;s a combination of a Read/Write call internally. So it should keep writing buffers multiple times  until it hits an io.EOF"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491937693, "post_id": 43353694, "comment_id": 73771660, "body": "@Angad: no, WriteTo to will block until it reaches EOF. It wouldn&#39;t be very usefull if it just called Read once and returned, which would be exactly the same as calling Read once yourself."}, {"owner": {"reputation": 2618, "user_id": 382564, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/o2wAN.jpg?s=128&g=1", "display_name": "Angad", "link": "https://stackoverflow.com/users/382564/angad"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491939007, "post_id": 43353694, "comment_id": 73772444, "body": "@JimB that would explain it! Let me confirm this solves the issue, and we can create your answer and accept :)"}, {"owner": {"reputation": 2618, "user_id": 382564, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/o2wAN.jpg?s=128&g=1", "display_name": "Angad", "link": "https://stackoverflow.com/users/382564/angad"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491981369, "post_id": 43353694, "comment_id": 73787295, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/141505/discussion-between-angad-and-jimb\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2618, "user_id": 382564, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/o2wAN.jpg?s=128&g=1", "display_name": "Angad", "link": "https://stackoverflow.com/users/382564/angad"}, "is_accepted": true, "score": 1, "last_activity_date": 1492019120, "creation_date": 1492019120, "answer_id": 43376297, "question_id": 43353694, "link": "https://stackoverflow.com/questions/43353694/accessing-fd-3-for-asterisk-eagi/43376297#43376297", "title": "Accessing FD (3) for Asterisk EAGI", "body": "<p>The right way to do this is <code>syscall.Read(fd int, buf []byte) (n int, err error)</code> (<a href=\"https://golang.org/pkg/syscall/#Read\" rel=\"nofollow noreferrer\">doc</a>). As regards my issue, from inside the Asterisk console, a call to <code>sip show channelstats</code> showed that I wasn't receiving RTP packets altogether, and that the Read was blocking because there really was nothing to read. My networking setup needed work.</p>\n"}], "owner": {"reputation": 2618, "user_id": 382564, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/o2wAN.jpg?s=128&g=1", "display_name": "Angad", "link": "https://stackoverflow.com/users/382564/angad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "accepted_answer_id": 43376297, "answer_count": 1, "score": 3, "last_activity_date": 1492019120, "creation_date": 1491935509, "question_id": 43353694, "link": "https://stackoverflow.com/questions/43353694/accessing-fd-3-for-asterisk-eagi", "title": "Accessing FD (3) for Asterisk EAGI", "body": "<p>I have the following Golang code that seems to be blocking indefinitely</p>\n\n<pre><code>eagi := os.NewFile(uintptr(3), \"/dev/stdeagi\")\ndata := bufio.NewReaderSize(eagi, 64*1024)\n...\ndata.WriteTo(conn) // Blocks indefinitely!\n</code></pre>\n\n<p>It doesn't even seem to throw an error - my guess is, I'm accessing the FD incorrectly. My purpose is to access the Process' FD 3 for <a href=\"https://www.voip-info.org/wiki/view/Asterisk+EAGI\" rel=\"nofollow noreferrer\">Asterisk EAGI</a>. I have also tried reading the alternative path <code>fmt.Sprintf(\"/proc/%d/fd/3\", os.Getpid())</code>, but this seems to behave the same way. What am I doing wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1491929803, "post_id": 43351857, "comment_id": 73767095, "body": "<a href=\"https://play.golang.org/p/t2oIjLJ34b\" rel=\"nofollow noreferrer\">play.golang.org/p/t2oIjLJ34b</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1491931162, "post_id": 43351857, "comment_id": 73767862, "body": "You example works: <a href=\"https://play.golang.org/p/uRd9kd4ud1\" rel=\"nofollow noreferrer\">play.golang.org/p/uRd9kd4ud1</a> please show an example that reproduces the problem you&#39;re having."}, {"owner": {"reputation": 1229, "user_id": 1359448, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/62bc68fab2feeef84863b50557ddf954?s=128&d=identicon&r=PG", "display_name": "user1359448", "link": "https://stackoverflow.com/users/1359448/user1359448"}, "edited": false, "score": 0, "creation_date": 1491933063, "post_id": 43351857, "comment_id": 73769051, "body": "I have updated the example"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491933754, "post_id": 43351857, "comment_id": 73769469, "body": "Btw I&#39;m not sure if it&#39;s missing only from the example, but you should use &quot;comma ok&quot; idiom to check that the request path has a registered controller in the <code>RouteMap</code>. E.g. <code>if c, ok := RouteMap[key]; !ok { ...</code> if <code>ok</code> is <code>false</code> that means that no controller is registered for that key. <a href=\"https://golang.org/doc/effective_go.html#maps\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#maps</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491934033, "post_id": 43351857, "comment_id": 73769625, "body": "In the updated example, inside <code>RequestHandler</code> you&#39;re constructing the key with a hardcoded path (<code>categories&#47;{category}&#47;{product}</code>) and a computed segment count from the actual request path (<code>segments - 1</code>).. how&#39;s that supposed to match any key? Only by luck are you actually gonna get a match... Seems to me the <code>RouteMap</code> should work fine, on the other hand, the logic in your <code>RequestHandler</code> seems off."}, {"owner": {"reputation": 1229, "user_id": 1359448, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/62bc68fab2feeef84863b50557ddf954?s=128&d=identicon&r=PG", "display_name": "user1359448", "link": "https://stackoverflow.com/users/1359448/user1359448"}, "edited": false, "score": 0, "creation_date": 1491934113, "post_id": 43351857, "comment_id": 73769674, "body": "The part with the hardcoded key is just for debugging/development, thats af course goint to be dynamic, what seems off?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491934141, "post_id": 43351857, "comment_id": 73769689, "body": "Then you should hardocde the segment count as well"}, {"owner": {"reputation": 1229, "user_id": 1359448, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/62bc68fab2feeef84863b50557ddf954?s=128&d=identicon&r=PG", "display_name": "user1359448", "link": "https://stackoverflow.com/users/1359448/user1359448"}, "edited": false, "score": 0, "creation_date": 1491934307, "post_id": 43351857, "comment_id": 73769782, "body": "The URL i use to connect to the program is going to get me a segment count of 3, so thats not a problem."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491934314, "post_id": 43351857, "comment_id": 73769787, "body": "For better debugging, log the key you&#39;re using to retrieve the controller and also the contents of the RouteMap, and then look if that key is actually in the map."}, {"owner": {"reputation": 1229, "user_id": 1359448, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/62bc68fab2feeef84863b50557ddf954?s=128&d=identicon&r=PG", "display_name": "user1359448", "link": "https://stackoverflow.com/users/1359448/user1359448"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491934485, "post_id": 43351857, "comment_id": 73769896, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/141453/discussion-between-user1359448-and-mkopriva\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1229, "user_id": 1359448, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/62bc68fab2feeef84863b50557ddf954?s=128&d=identicon&r=PG", "display_name": "user1359448", "link": "https://stackoverflow.com/users/1359448/user1359448"}, "edited": false, "score": 0, "creation_date": 1491934647, "post_id": 43351857, "comment_id": 73769996, "body": "The chat seems to be broken, I know the key is present in the map e.g. {categories/{category}/{product} %!s(int=3)}:%!s(main.Controller=0x4c7b00) I get the correct memory address back, i just cant invoke the function."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491935500, "post_id": 43351857, "comment_id": 73770473, "body": "Can you mention what path you are using that gets you the 3 segments count? I would like to test your code on my machine."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491935985, "post_id": 43351857, "comment_id": 73770745, "body": "Btw your code works fine for me, here is the code i ran: <a href=\"https://play.golang.org/p/M04C20-krd\" rel=\"nofollow noreferrer\">play.golang.org/p/M04C20-krd</a> (i&#39;ve edited only the log and added a call to <code>c</code>). And here you can see it <b>not</b> crashing when calling <code>c</code>: <a href=\"http://imgur.com/EzoUDNk\" rel=\"nofollow noreferrer\">imgur.com/EzoUDNk</a>."}, {"owner": {"reputation": 1229, "user_id": 1359448, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/62bc68fab2feeef84863b50557ddf954?s=128&d=identicon&r=PG", "display_name": "user1359448", "link": "https://stackoverflow.com/users/1359448/user1359448"}, "edited": false, "score": 0, "creation_date": 1491936978, "post_id": 43351857, "comment_id": 73771284, "body": "<a href=\"http://localhost:8080/categories/development-boards/arm-cortex-m0-minimal\" rel=\"nofollow noreferrer\">localhost:8080/categories/development-boards/&hellip;</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491938964, "post_id": 43351857, "comment_id": 73772415, "body": "If you run the provided example code, as opposed to your real code, does it crash too when calling <code>c</code>? I&#39;m able to run it just fine even with your path (<code>&#47;categories&#47;development-boards&#47;arm-cortex-m0-minimal</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1491988990, "last_edit_date": 1491988990, "creation_date": 1491932271, "answer_id": 43352751, "question_id": 43351857, "link": "https://stackoverflow.com/questions/43351857/call-func-at-memory-address/43352751#43352751", "title": "Call func at memory address", "body": "<p>I'm not sure you need to call it \"by address\". When you call by passing it as a variable, compiler does this for you \"under-the-hood\". Takes its address and calls it.</p>\n\n<p>If you wish some level of indirection, you can make:</p>\n\n<pre><code>M := map[string]func()\nM[\"function 1\"] = F\n// and then call them from map like \nM[\"function 1\"]()\n</code></pre>\n"}], "owner": {"reputation": 1229, "user_id": 1359448, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/62bc68fab2feeef84863b50557ddf954?s=128&d=identicon&r=PG", "display_name": "user1359448", "link": "https://stackoverflow.com/users/1359448/user1359448"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1491988990, "creation_date": 1491929292, "last_edit_date": 1491934820, "question_id": 43351857, "link": "https://stackoverflow.com/questions/43351857/call-func-at-memory-address", "title": "Call func at memory address", "body": "<p>I have a map with a struct as key and a func as value, I would like to call the func when I retrieve the value for a given key</p>\n\n<pre><code>map[struct]func\n\nmap[\n    {contact %!s(int=1)}:%!s(main.Controller=0x4c7b50) \n    {services/basket %!s(int=2)}:%!s(main.Controller=0x4c7ad0) \n    {categories %!s(int=1)}:%!s(main.Controller=0x4c7ae0) \n    {categories/{category} %!s(int=2)}:%!s(main.Controller=0x4c7af0)\n    {categories/{category}/{product} %!s(int=3)}:%!s(main.Controller=0x4c7b00) \n    {basket %!s(int=1)}:%!s(main.Controller=0x4c7b10) \n    {checkout %!s(int=1)}:%!s(main.Controller=0x4c7b40) \n    {sitemap %!s(int=1)}:%!s(main.Controller=0x4c7b30) \n    {services/order %!s(int=2)}:%!s(main.Controller=0x4c7ac0) \n    {services/image %!s(int=2)}:%!s(main.Controller=0x4c7b20) \n    {/ %!s(int=1)}:%!s(main.Controller=0x4c7a00)\n]\n\nc := RouteMap[struct]\n</code></pre>\n\n<p>If I <code>fmt.Printf(\"%s\", c)</code> I get the memory address, how do I invoke the func at the address?</p>\n\n<p>I have tried c() but that gives a runtime error:</p>\n\n<pre><code>%s\n0x4c7b10%s\n&lt;nil&gt;panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x0 addr=0x0 pc=0x4c76f4]\n\ngoroutine 5 [running]:\nmain.RequestHandler(0x577ce0, 0xc042004018)\n        C:/Users/mon/Desktop/server.go:91 +0x684\ncreated by main.main\n        C:/Users/mon/Desktop/server.go:41 +0x2a0\n</code></pre>\n\n<p><strong>EXAMPLE</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"bytes\"\n    \"fmt\"\n    \"net\"\n    \"strings\"\n    \"time\"\n)\n\nvar RouteMap = make(map[PathIdentifier]Controller)\n\nfunc main() {\n    ln, err := net.Listen(\"tcp\", \":8080\")\n    if err != nil {\n        // handle error\n    }\n\n    MapRoute(\"/\", HomeController)\n    MapRoute(\"categories\", CategoriesController)\n    MapRoute(\"categories/{category}\", CategoryController)\n    MapRoute(\"categories/{category}/{product}\", CategoryProductController)\n    MapRoute(\"basket\", BasketController)\n\n    MapRoute(\"checkout\", CheckoutController)\n    MapRoute(\"sitemap\", SitemapController)\n    MapRoute(\"contact\", ContactController)\n\n    MapRoute(\"services/order\", OrderServiceController)\n    MapRoute(\"services/basket\", BasketServiceController)\n    MapRoute(\"services/image\", ImageServiceController)\n\n    fmt.Printf(\"%s\\n\", RouteMap)\n\n    for {\n        conn, err := ln.Accept()\n        if err != nil {\n            // handle error\n        }\n        go RequestHandler(conn)\n    }\n}\n\n// ----------------------- Request &amp; Response ---------------------------\n\nfunc ParseQueryString() {}\n\nfunc ParsePostData() {}\n\nfunc ResponseHeaders() {}\n\nfunc ParseRequestHeaders() {}\n\nfunc RequestHandler(conn net.Conn) {\nCrLf := \"\\r\\n\"\nTerminator := CrLf + CrLf\n\ndefer func() {\n    //fmt.Println(\"Closing connection...\")\n    conn.Close()\n}()\n\ntimeoutDuration := 10 * time.Second\nbufReader := bufio.NewReader(conn)\n\nconn.SetReadDeadline(time.Now().Add(timeoutDuration))\n\nrequestBytes, err := bufReader.ReadBytes('\\n')\nif err != nil {\n    fmt.Println(err)\n    return\n}\n\nrequestTokens := bytes.Split(requestBytes, []byte(\" \"))\n\nrequestMethod := string(requestTokens[0])\nrequestPath := string(requestTokens[1])\n//requestHTTPVersion := string(requestTokens[2])\n\nif requestMethod == \"GET\" {\n    // Parse path\n    pathTokens := strings.Split(requestPath, \"/\")\n    segments := len(pathTokens)\n\n    key := PathIdentifier{path: \"categories/{category}/{product}\", segments: (segments - 1)}\n    c := RouteMap[key]\n\n    fmt.Print(\"%s\\n\", c)\n\n}\n\n    document := []byte(\"HTTP/1.1 200 OK\" + CrLf + \"Date: Mon, 27 Jul 2009 12:28:53 GMT\" + CrLf + \"Last-Modified: Wed, 22 Jul 2009 19:15:56 GMT\" + CrLf + \"Content-Length: 49\" + CrLf + \"Content-Type: text/html\" + CrLf + \"Connection: Closed\" + Terminator + \"&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello, World!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\" + Terminator)\n\n    conn.Write(document)\n}\n\n// ----------------------------- Controller -----------------------------\n\ntype Controller func()\n\ntype PathIdentifier struct {\n    path     string\n    segments int\n}\n\nfunc MapRoute(view string, controller Controller) {\n    if controller != nil {\n\n        if view != \"/\" {\n            pathTokens := strings.Split(view, \"/\")\n\n            key := PathIdentifier{path: view, segments: len(pathTokens)}\n            RouteMap[key] = controller\n            return\n        }\n\n        key := PathIdentifier{path: view, segments: 1}\n        RouteMap[key] = controller\n    }\n}\n\nfunc HomeController() {\n    fmt.Print(\"Invoking the HomeController.\\n\")\n}\n\nfunc OrderServiceController() {\n\n}\n\nfunc BasketServiceController() {\n\n}\n\nfunc CategoriesController() {\n\n}\n\nfunc CategoryController() {\n\n}\n\nfunc CategoryProductsController() {\n\n}\n\nfunc CategoryProductController() {\n\n}\n\nfunc BasketController() {\n\n}\n\nfunc ImageServiceController() {\n\n}\n\nfunc SitemapController() {\n\n}\n\nfunc CheckoutController() {\n\n}\n\nfunc ContactController() {\n\n}\n</code></pre>\n"}, {"tags": ["go", "boolean"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1491934714, "post_id": 43351216, "comment_id": 73770045, "body": "Just out of curiosity: Which part of the language spec or the Tour of Go makes you think that there are things in Go which are &quot;unset&quot;?"}, {"owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1491993616, "post_id": 43351216, "comment_id": 73796096, "body": "@Volker: Just out of curiosity: What&#39;s the point of being that rude? Don&#39;t imply that people can only ask questions here if they have read the complete language spec. This is not how SOF works."}], "answers": [{"tags": [], "owner": {"reputation": 2821, "user_id": 19547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc32d27026065e5855c1d5196d29f3f?s=128&d=identicon&r=PG", "display_name": "keno", "link": "https://stackoverflow.com/users/19547/keno"}, "is_accepted": false, "score": 1, "last_activity_date": 1491927769, "creation_date": 1491927769, "answer_id": 43351376, "question_id": 43351216, "link": "https://stackoverflow.com/questions/43351216/check-if-boolean-value-is-set-in-go/43351376#43351376", "title": "Check if boolean value is set in Go", "body": "<p><code>bool</code> has a zero value of <code>false</code> so there would be no difference between them. </p>\n\n<p>Refer to the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">zero value</a> section of the spec.</p>\n\n<p>What problem are you trying to solve that would require that kind of check? </p>\n"}, {"comments": [{"owner": {"reputation": 5214, "user_id": 820039, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e73fcc92279f09443147ac6d788a3cda?s=128&d=identicon&r=PG", "display_name": "hobberwickey", "link": "https://stackoverflow.com/users/820039/hobberwickey"}, "edited": false, "score": 0, "creation_date": 1491928285, "post_id": 43351386, "comment_id": 73766210, "body": "Thanks, I was afraid there was no difference, but hopefully I can work the pointer solution in without to much pain."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 11, "last_activity_date": 1491927797, "creation_date": 1491927797, "answer_id": 43351386, "question_id": 43351216, "link": "https://stackoverflow.com/questions/43351216/check-if-boolean-value-is-set-in-go/43351386#43351386", "title": "Check if boolean value is set in Go", "body": "<p>No, a bool has two possibilities: <code>true</code> or <code>false</code>. The default value of an uninitialized bool is <code>false</code>. If you want a third state, you can use <code>*bool</code> instead, and the default value will be <code>nil</code>.</p>\n\n<pre><code>type Test struct {\n    Set *bool\n    Unset *bool\n}\n\nf := false\ntest := Test{ Set: &amp;f }\n\nfmt.Println(*test.Set)  // false\nfmt.Println(test.Unset) // nil\n</code></pre>\n\n<p>The cost for this is that it is a bit uglier to set values to literals, and you have to be a bit more careful to dereference (and check nil) when you are using the values.</p>\n\n<p><a href=\"https://play.golang.org/p/b5HKal2Jc2\" rel=\"noreferrer\">Playground link</a></p>\n"}, {"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1491933544, "creation_date": 1491933544, "answer_id": 43353116, "question_id": 43351216, "link": "https://stackoverflow.com/questions/43351216/check-if-boolean-value-is-set-in-go/43353116#43353116", "title": "Check if boolean value is set in Go", "body": "<p>You may think of using 3-state booleans: <a href=\"https://github.com/grignaak/tribool\" rel=\"nofollow noreferrer\">https://github.com/grignaak/tribool</a></p>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 13575402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PgWuW.jpg?s=128&g=1", "display_name": "Chamindu", "link": "https://stackoverflow.com/users/13575402/chamindu"}, "is_accepted": false, "score": 0, "last_activity_date": 1596605054, "creation_date": 1596605054, "answer_id": 63258884, "question_id": 43351216, "link": "https://stackoverflow.com/questions/43351216/check-if-boolean-value-is-set-in-go/63258884#63258884", "title": "Check if boolean value is set in Go", "body": "<p>Yes. You have to use <code>*bool</code> instead of primitive <code>bool</code></p>\n"}], "owner": {"reputation": 5214, "user_id": 820039, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e73fcc92279f09443147ac6d788a3cda?s=128&d=identicon&r=PG", "display_name": "hobberwickey", "link": "https://stackoverflow.com/users/820039/hobberwickey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8862, "favorite_count": 1, "accepted_answer_id": 43351386, "answer_count": 4, "score": 5, "last_activity_date": 1596605054, "creation_date": 1491927247, "question_id": 43351216, "link": "https://stackoverflow.com/questions/43351216/check-if-boolean-value-is-set-in-go", "title": "Check if boolean value is set in Go", "body": "<p>Is it possible to differentiate between <code>false</code> and an unset boolean value in go? </p>\n\n<p>For instance, if I had this code</p>\n\n<pre><code>type Test struct {\n    Set bool\n    Unset bool\n}\n\ntest := Test{ Set: false }\n</code></pre>\n\n<p>Is there any difference between <code>test.Set</code> and <code>test.Unset</code> and if so how can I tell them apart? </p>\n"}, {"tags": ["go", "split", "scanf", "stdin"], "answers": [{"tags": [], "owner": {"reputation": 3080, "user_id": 2375119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oB60l.png?s=128&g=1", "display_name": "ArekBulski", "link": "https://stackoverflow.com/users/2375119/arekbulski"}, "is_accepted": false, "score": 0, "last_activity_date": 1491924990, "creation_date": 1491924990, "answer_id": 43350439, "question_id": 43350234, "link": "https://stackoverflow.com/questions/43350234/golang-reading-multiple-fields-from-stdin-line/43350439#43350439", "title": "Golang reading multiple fields from stdin line", "body": "<p>I got mislead by another question's answer that said <code>Scanln</code> reads an entire line. No, Scanln is only a Scan that reads words (space separated strings) and as many as actual variables specified, but quits parsing on a newline. Its totally confusing what the readline equivalent would be in Go.</p>\n"}, {"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 5, "last_activity_date": 1491933080, "creation_date": 1491933080, "answer_id": 43352993, "question_id": 43350234, "link": "https://stackoverflow.com/questions/43350234/golang-reading-multiple-fields-from-stdin-line/43352993#43352993", "title": "Golang reading multiple fields from stdin line", "body": "<p>Have you tried:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"bufio\"\n    \"strings\"\n)\n\nfunc main() {\n    var line string\n    scanner := bufio.NewScanner(os.Stdin)\n    for scanner.Scan() {\n        line = scanner.Text()\n        fmt.Println(\"Got line:\", line)\n        for _, x := range strings.Fields(line) {\n            fmt.Println(\"next field: \",x)\n        }\n    }\n}\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>$ printf \"aa bb \\n cc dd \" | go run 1.go  \nGot line: aa bb\nnext field:  aa\nnext field:  bb\nGot line:  cc dd\nnext field:  cc\nnext field:  dd\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 14019973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b982432d233ecd5ab696f635e1c3d20a?s=128&d=identicon&r=PG&f=1", "display_name": "albinjose", "link": "https://stackoverflow.com/users/14019973/albinjose"}, "is_accepted": false, "score": 1, "last_activity_date": 1596087737, "creation_date": 1596087737, "answer_id": 63166864, "question_id": 43350234, "link": "https://stackoverflow.com/questions/43350234/golang-reading-multiple-fields-from-stdin-line/63166864#63166864", "title": "Golang reading multiple fields from stdin line", "body": "<p>In case you want to store each input to a seperate variable you can try this:</p>\n<pre><code>package main\n\nimport (\n    &quot;bufio&quot;\n    &quot;fmt&quot;\n    &quot;os&quot;\n)\n\nfunc main() {\n    var a, b string\n    var c int\n    var r = bufio.NewReader(os.Stdin)\n    fmt.Fscanf(r, &quot;%s %s %d&quot;, &amp;a, &amp;b, &amp;c)\n    fmt.Printf(&quot;%s %s %d&quot;, a, b, c)\n}\n</code></pre>\n<p>It will give the following output:</p>\n<pre><code>//given input\nw r 4\n//output\nw r 4\n</code></pre>\n"}], "owner": {"reputation": 3080, "user_id": 2375119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oB60l.png?s=128&g=1", "display_name": "ArekBulski", "link": "https://stackoverflow.com/users/2375119/arekbulski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2330, "favorite_count": 0, "accepted_answer_id": 43352993, "answer_count": 3, "score": 1, "last_activity_date": 1596087737, "creation_date": 1491924491, "question_id": 43350234, "link": "https://stackoverflow.com/questions/43350234/golang-reading-multiple-fields-from-stdin-line", "title": "Golang reading multiple fields from stdin line", "body": "<pre><code>$ echo \"A 1 2 3 4\" | go run test.go \nentire:  A\nnext field:  A\n</code></pre>\n\n<p>I need to read several lines from standard input that are like \"A 1 2 3 4\" (code does one line for now) and something goes wrong. <code>Scanln</code> should read the entire line and <code>Fields</code> should split it by newlines? Why does Scanln read only one word?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    var line string\n    fmt.Scanln(&amp;line)\n    fmt.Println(\"entire: \",line)\n    for _,x := range strings.Fields(line) {\n        fmt.Println(\"next field: \",x)\n    }\n}\n</code></pre>\n\n<hr>\n\n<pre><code>$ echo \"A 1 2 3 4\" | go run test.go \nentire:  A\nnext field:  A\n</code></pre>\n"}, {"tags": ["go", "google-cloud-datastore", "google-cloud-platform"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 3, "creation_date": 1491928298, "post_id": 43350116, "comment_id": 73766218, "body": "You could count in your application, and push the count to datastore every N minutes or something."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1491930584, "post_id": 43350116, "comment_id": 73767539, "body": "Hmm, that&#39;s a great idea, and in case there are several thousands of even millions of pages then I guess can just add the visited pages to a list and remove them if they haven&#39;t been visited for X amount of time"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1491931332, "post_id": 43350116, "comment_id": 73767978, "body": "This is one of those where you have to ask yourself how accurate you need it to be. If you are ok with occasionally having some counting lost (server dies / whatever), then @captncraig &#39;s solution is exactly what you want. If you need super accuracy, you need an atomic counter, but you&#39;ll pay for it in complexity."}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491924211, "creation_date": 1491924211, "question_id": 43350116, "link": "https://stackoverflow.com/questions/43350116/cost-efficient-way-of-displaying-web-page-view-count-with-go-datastore", "title": "Cost efficient way of displaying web page view count with Go/Datastore", "body": "<p>I'd like for each page to display the number of visitors; using Google Analytics does not seem to be an option since too many visitors use adblockers.</p>\n\n<p>I guess there is no smart way to do it with Go since I doubt there is an efficient way of storing the counter in a text file; whereas using Datastore seems like a good option, but I guess the costs of updating and retrieving the view count on every request is not worth it.</p>\n\n<p>I was hoping someone might be able to recommend a good and cheap solution (that preferably does not rely on third-party services that are not a part of the Google Cloud Platform)</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1491925261, "last_edit_date": 1491925261, "creation_date": 1491924570, "answer_id": 43350274, "question_id": 43349648, "link": "https://stackoverflow.com/questions/43349648/golang-unmarshall-json-from-api-nal-usda-gov-ndb/43350274#43350274", "title": "Golang unmarshall JSON from api.nal.usda.gov/ndb", "body": "<p>IMHO your struct doesn't match to JSON you provided. Try:</p>\n\n<pre><code>package main\n\nimport (\n\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype MyItem struct {\n    Q     string `json:\"q,omitempty\"`\n    Sr    string `json:\"sr,omitempty\"`\n    Ds    string `json:\"ds,omitempty\"`\n    Start int `json:\"start,omitempty\"`\n    End   int `json:\"end,omitempty\"`\n    Total int `json:\"total,omitempty\"`\n    Group string `json:\"group,omitempty\"`\n    Sort  string `json:\"sort,omitempty\"`\n    Item  []Item `json:\"item,omitempty\"`\n}\n\ntype MyList struct {\n    List MyItem `json:\"list\"`\n}\n\ntype Item struct {\n    Offset int `json:\"offset,omitempty\"`\n    Group  string `json:\"group,omitempty\"` //food group to which the food belongs\n    Name   string `json:\"name,omitempty\"`  //the food\u2019s name\n    Ndbno  string `json:\"nbno,omitempty\"`  //the food\u2019s NDB Number\n    Ds     string `json:\"ds,omitempty\"`    //Data source: BL=Branded Food Products or SR=Standard Release\n}\n\nvar jsonStr = `{\n    \"list\": {\n        \"q\": \"butter\",\n        \"sr\": \"28\",\n        \"ds\": \"any\",\n        \"start\": 0,\n        \"end\": 50,\n        \"total\": 4003,\n        \"group\": \"\",\n        \"sort\": \"r\",\n        \"item\": [\n            {\n                \"offset\": 0,\n                \"group\": \"Branded Food Products Database\",\n                \"name\": \"BLUE BUNNY, PEANUT BUTTER PANIC, ICE CREAM, POWERFUL PEANUT BUTTER ICE CREAM CHARGED WITH PEANUT BUTTER AND FUDGE SAUCES AND OVERLOADED WITH PEANUT BUTTER CUPS, UPC: 070640034086\",\n                \"ndbno\": \"45011419\",\n                \"ds\": \"BL\"\n            },\n            {\n                \"offset\": 1,\n                \"group\": \"Branded Food Products Database\",\n                \"name\": \"BLUE BUNNY, ICE CREAM, PEANUT BUTTER PARTY, PEANUT BUTTER ICE CREAM, PEANUT BUTTER AND FUDGE SWIRLS, PEANUT BUTTER CUPS, UPC: 070640012411\",\n                \"ndbno\": \"45110466\",\n                \"ds\": \"BL\"\n            }]\n}\n}`\n\n\nfunc main() {\n\nb := jsonStr\n\n    l := new(MyList)\n    err := json.Unmarshal([]byte(b), &amp;l)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Println(l)\n}\n</code></pre>\n\n<p>EDIT: It is hard to read result of println or printf with %+v so here is the result with spew.Dump(l) (go get -u github.com/davecgh/go-spew/spew):</p>\n\n<pre><code>List: (main.MyItem) {\n  Q: (string) (len=6) \"butter\",\n  Sr: (string) (len=2) \"28\",\n  Ds: (string) (len=3) \"any\",\n  Start: (int) 0,\n  End: (int) 50,\n  Total: (int) 4003,\n  Group: (string) \"\",\n  Sort: (string) (len=1) \"r\",\n  Item: ([]main.Item) (len=2 cap=4) {\n   (main.Item) {\n    Offset: (int) 0,\n    Group: (string) (len=30) \"Branded Food Products Database\",\n    Name: (string) (len=178) \"BLUE BUNNY, PEANUT BUTTER PANIC, ICE CREAM, POWERFUL PEANUT BUTTER ICE CREAM CHARGED WITH PEANUT BUTTER AND FUDGE SAUCES AND OVERLOADED WITH PEANUT BUTTER CUPS, UPC: 070640034086\",\n    Ndbno: (string) \"\",\n    Ds: (string) (len=2) \"BL\"\n   },\n   (main.Item) {\n    Offset: (int) 1,\n    Group: (string) (len=30) \"Branded Food Products Database\",\n    Name: (string) (len=138) \"BLUE BUNNY, ICE CREAM, PEANUT BUTTER PARTY, PEANUT BUTTER ICE CREAM, PEANUT BUTTER AND FUDGE SWIRLS, PEANUT BUTTER CUPS, UPC: 070640012411\",\n    Ndbno: (string) \"\",\n    Ds: (string) (len=2) \"BL\"\n   }\n  }\n }\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1491924631, "creation_date": 1491924631, "answer_id": 43350296, "question_id": 43349648, "link": "https://stackoverflow.com/questions/43349648/golang-unmarshall-json-from-api-nal-usda-gov-ndb/43350296#43350296", "title": "Golang unmarshall JSON from api.nal.usda.gov/ndb", "body": "<p>The Go types do not match the structure of the JSON. There's one more level of objects in the JSON. Try this:</p>\n\n<pre><code>var v struct {\n    List List\n}\nerr := json.Unmarshal([]byte(data), &amp;v)\n</code></pre>\n\n<p>Some of the string fields correspond to numbers in the JSON. Declare these fields with a numerical type (int, float64, ...).</p>\n\n<p><a href=\"https://play.golang.org/p/PRXvkuopnz\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 1619, "user_id": 2154356, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ffcaa1db1773c9d484f330b774d9699d?s=128&d=identicon&r=PG", "display_name": "jona j&#252;rgen", "link": "https://stackoverflow.com/users/2154356/jona-j%c3%bcrgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 43350296, "answer_count": 2, "score": 0, "last_activity_date": 1491930325, "creation_date": 1491922970, "last_edit_date": 1491930325, "question_id": 43349648, "link": "https://stackoverflow.com/questions/43349648/golang-unmarshall-json-from-api-nal-usda-gov-ndb", "title": "Golang unmarshall JSON from api.nal.usda.gov/ndb", "body": "<p>Hello I try to unmarshal the JSON response from api.nal.usda.gov/ndb into struct, but it always returns empty:</p>\n\n<pre><code>{        []}\n</code></pre>\n\n<p>Example JSON:</p>\n\n<pre><code>{\n    \"list\": {\n        \"q\": \"butter\",\n        \"sr\": \"28\",\n        \"ds\": \"any\",\n        \"start\": 0,\n        \"end\": 50,\n        \"total\": 4003,\n        \"group\": \"\",\n        \"sort\": \"r\",\n        \"item\": [\n            {\n                \"offset\": 0,\n                \"group\": \"Branded Food Products Database\",\n                \"name\": \"BLUE BUNNY, PEANUT BUTTER PANIC, ICE CREAM, POWERFUL PEANUT BUTTER ICE CREAM CHARGED WITH PEANUT BUTTER AND FUDGE SAUCES AND OVERLOADED WITH PEANUT BUTTER CUPS, UPC: 070640034086\",\n                \"ndbno\": \"45011419\",\n                \"ds\": \"BL\"\n            },\n            {\n                \"offset\": 1,\n                \"group\": \"Branded Food Products Database\",\n                \"name\": \"BLUE BUNNY, ICE CREAM, PEANUT BUTTER PARTY, PEANUT BUTTER ICE CREAM, PEANUT BUTTER AND FUDGE SWIRLS, PEANUT BUTTER CUPS, UPC: 070640012411\",\n                \"ndbno\": \"45110466\",\n                \"ds\": \"BL\"\n            }\n        ]\n    }\n}\n</code></pre>\n\n<p>I checked the JSON response with <a href=\"https://jsonformatter.curiousconcept.com/\" rel=\"nofollow noreferrer\">https://jsonformatter.curiousconcept.com/</a>, and it\u00b4s fine. I hope you can tell me why, since I am quite new to Golang.</p>\n\n<p>My Structs:</p>\n\n<pre><code>type List struct {\n    Q     string `json:\"q,omitempty\"`\n    Sr    string `json:\"sr,omitempty\"`\n    Ds    string `json:\"ds,omitempty\"`\n    Start string `json:\"start,omitempty\"`\n    End   string `json:\"end,omitempty\"`\n    Total string `json:\"total,omitempty\"`\n    Group string `json:\"group,omitempty\"`\n    Sort  string `json:\"sort,omitempty\"`\n    Item  []Item `json:\"item,omitempty\"`\n}\n\ntype Item struct {\n    Offset string `json:\"offset,omitempty\"`\n    Group  string `json:\"group,omitempty\"` //food group to which the food belongs\n    Name   string `json:\"name,omitempty\"`  //the food\u2019s name\n    Ndbno  string `json:\"nbno,omitempty\"`  //the food\u2019s NDB Number\n    Ds     string `json:\"ds,omitempty\"`    //Data source: BL=Branded Food Products or SR=Standard Release\n}\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>func (sr *SearchRequest) fetch() {\n\n    url := \"https://api.nal.usda.gov/ndb/search/?\" +\n        \"format=\" + sr.format +\n        \"&amp;q=\" + sr.q +\n        \"&amp;sort=\" + sr.sort +\n        \"&amp;max=\" + strconv.FormatInt(sr.max, 10) +\n        \"&amp;offset=\" + strconv.FormatInt(sr.offset, 10) +\n        \"&amp;api_key=\" + sr.c.ApiKey\n\n    r, err := http.Get(url)\n    if err != nil {\n        panic(err.Error())\n    }\n    defer r.Body.Close()\n\n    b, err := ioutil.ReadAll(r.Body)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    l := new(List)\n    err = json.Unmarshal(b, &amp;l)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Println(l)\n\n}\n</code></pre>\n"}, {"tags": ["sql", "postgresql", "go", "deferrable-constraint"], "comments": [{"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1491922511, "post_id": 43349430, "comment_id": 73762079, "body": "Maybe your code is running with autocommit enabled? And at which point do you get that error message?"}, {"owner": {"reputation": 37141, "user_id": 5315974, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/MNGHV.png?s=128&g=1", "display_name": "Vao Tsun", "link": "https://stackoverflow.com/users/5315974/vao-tsun"}, "edited": false, "score": 0, "creation_date": 1491922512, "post_id": 43349430, "comment_id": 73762081, "body": "how is that? you start transaction, then you have two transactions inside it and you end it?.. what &gt;// there are two db transactions in this function means?.."}, {"owner": {"reputation": 1287, "user_id": 3282267, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/ZJqPV.png?s=128&g=1", "display_name": "shangsunset", "link": "https://stackoverflow.com/users/3282267/shangsunset"}, "edited": false, "score": 0, "creation_date": 1491922659, "post_id": 43349430, "comment_id": 73762204, "body": "yea thats the idea. I start transaction, and then call a function which contains two db transactions. and end it in the end."}, {"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 1, "creation_date": 1491922738, "post_id": 43349430, "comment_id": 73762255, "body": "You can&#39;t have &quot;two transactions&quot; inside one transaction. If you commit a transaction the constraints are checked and the transaction is ended."}, {"owner": {"reputation": 1287, "user_id": 3282267, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/ZJqPV.png?s=128&g=1", "display_name": "shangsunset", "link": "https://stackoverflow.com/users/3282267/shangsunset"}, "reply_to_user": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1491922782, "post_id": 43349430, "comment_id": 73762290, "body": "@a_horse_with_no_name I get the error message when I insert into a lookup table inside of <code>h(tx)</code>"}, {"owner": {"reputation": 28971, "user_id": 1499698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad28bf1565b1191c0591bf90d46299a7?s=128&d=identicon&r=PG", "display_name": "pozs", "link": "https://stackoverflow.com/users/1499698/pozs"}, "edited": false, "score": 0, "creation_date": 1491923223, "post_id": 43349430, "comment_id": 73762609, "body": "@shangsunset could you show us the contents/logic of <code>h(tx)</code> too?"}, {"owner": {"reputation": 1287, "user_id": 3282267, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/ZJqPV.png?s=128&g=1", "display_name": "shangsunset", "link": "https://stackoverflow.com/users/3282267/shangsunset"}, "reply_to_user": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1491923344, "post_id": 43349430, "comment_id": 73762703, "body": "@a_horse_with_no_name my mistake. I meant two query statements instead of two transactions."}, {"owner": {"reputation": 1287, "user_id": 3282267, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/ZJqPV.png?s=128&g=1", "display_name": "shangsunset", "link": "https://stackoverflow.com/users/3282267/shangsunset"}, "reply_to_user": {"reputation": 28971, "user_id": 1499698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad28bf1565b1191c0591bf90d46299a7?s=128&d=identicon&r=PG", "display_name": "pozs", "link": "https://stackoverflow.com/users/1499698/pozs"}, "edited": false, "score": 0, "creation_date": 1491923534, "post_id": 43349430, "comment_id": 73762825, "body": "@pozs please see my update."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1491924410, "post_id": 43349430, "comment_id": 73763430, "body": "Are <code>ctx.Exec</code> and <code>d.db.Exec</code> inside <code>d.attach</code> using the same transaction? The one you pass to <code>h</code>? From the provided code it doesn&#39;t look like they do."}, {"owner": {"reputation": 1287, "user_id": 3282267, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/ZJqPV.png?s=128&g=1", "display_name": "shangsunset", "link": "https://stackoverflow.com/users/3282267/shangsunset"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491924669, "post_id": 43349430, "comment_id": 73763643, "body": "@mkopriva oops... thats it! you are right I&#39;m not using the same transaction. Thanks so much."}, {"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1491931702, "post_id": 43349430, "comment_id": 73768220, "body": "@shangsunset: you should add that as an answer and accept it, so that this question is marked as solved"}, {"owner": {"reputation": 1287, "user_id": 3282267, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/ZJqPV.png?s=128&g=1", "display_name": "shangsunset", "link": "https://stackoverflow.com/users/3282267/shangsunset"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491935794, "post_id": 43349430, "comment_id": 73770649, "body": "@mkopriva I would love to accept your solution if you don&#39;t mind posting as an answer. Now that I&#39;m using the same transaction, I don&#39;t need to set foreign key constraint as deferrable any more."}], "answers": [{"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1491934783, "creation_date": 1491934783, "answer_id": 43353469, "question_id": 43349430, "link": "https://stackoverflow.com/questions/43349430/how-to-defer-foreign-key-constraint-in-postgres/43353469#43353469", "title": "How to defer foreign key constraint in Postgres", "body": "<p>If you do not use manual transaction management, Go+PG does this for you. In this case any statement is a single transaction and constraints are get checked at the end of each. So exception is raised.</p>\n"}, {"comments": [{"owner": {"reputation": 7726, "user_id": 519333, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/68d70af861f20d7081101d48da288330?s=128&d=identicon&r=PG", "display_name": "simPod", "link": "https://stackoverflow.com/users/519333/simpod"}, "edited": false, "score": 0, "creation_date": 1542206789, "post_id": 43354090, "comment_id": 93486334, "body": "and How to defer foreign key constraint in Postgres?"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 0, "last_activity_date": 1491936933, "creation_date": 1491936933, "answer_id": 43354090, "question_id": 43349430, "link": "https://stackoverflow.com/questions/43349430/how-to-defer-foreign-key-constraint-in-postgres/43354090#43354090", "title": "How to defer foreign key constraint in Postgres", "body": "<p>From the updated code, and subsequent comments, we know now that the issue was that the two queries were executed separately and not in a single transaction.</p>\n"}], "owner": {"reputation": 1287, "user_id": 3282267, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/ZJqPV.png?s=128&g=1", "display_name": "shangsunset", "link": "https://stackoverflow.com/users/3282267/shangsunset"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1993, "favorite_count": 0, "accepted_answer_id": 43354090, "answer_count": 2, "score": 0, "last_activity_date": 1491936933, "creation_date": 1491922415, "last_edit_date": 1491923309, "question_id": 43349430, "link": "https://stackoverflow.com/questions/43349430/how-to-defer-foreign-key-constraint-in-postgres", "title": "How to defer foreign key constraint in Postgres", "body": "<p>I tried to set a foreign key constraint deferrable so that it won't be checked when I insert into a lookup/pivot table until end of transaction. However, it woks in psql shell but its just not working in the code. same as in the psql shell, I start a transaction with <code>begin</code> in code as well.</p>\n\n<p>This is the sql:</p>\n\n<pre><code>create table campaign_r_company (\n  campaign_id         uuid            not null references campaign(id) on delete cascade deferrable initially deferred,\n  company_id          varchar(32)     not null,\n  primary key (campaign_id, company_id)\n);\n</code></pre>\n\n<p>Here's the code:</p>\n\n<pre><code>  tx, err := d.Begin()\n  if err != nil {\n    return err\n  }\n\n\n  err = h(tx) // there are two db queries will be called in this function\n\n  if err == nil {\n    err = tx.Commit()\n  }\n</code></pre>\n\n<p>h(tx):</p>\n\n<pre><code>_, err := cxt.Exec(fmt.Sprintf(`INSERT INTO hp_campaign (%s) VALUES (%s)`, proplist(\"\", campaignProps), arglist(1, len(campaignProps))),\n    id, v.Name, created, v.Updated,\n)\nif err != nil {\n    return err\n}\n\nv.Id = id\nv.Created = created\n\nif (opts &amp; StoreOptionStoreRelated) == StoreOptionStoreRelated {\n    err := d.attach(\"company\", \"campaign_r_company\", v.Companies, v.Id)\n    if err != nil {\n        return err\n    }\n\n}\n</code></pre>\n\n<p>attach():</p>\n\n<pre><code>func (d *Database) attach(entityName string, tableName string, ids []string, campaignID string) error {\n\n    for _, id := range ids {\n\n        stmt := fmt.Sprintf(`INSERT INTO %s (%s) VALUES ($1, $2)`, tableName, fmt.Sprintf(\"campaign_id, %s_id\", entityName))\n        _, err := d.db.Exec(stmt, campaignID, id)\n\n        if err != nil {\n            return err\n        }\n    }\n    return nil\n\n}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>insert or update on table \"campaign_r_company\" violates foreign key constraint \"campaign_r_company_campaign_id_fkey\"\n</code></pre>\n"}, {"tags": ["performance", "http", "asynchronous", "go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1491922490, "post_id": 43349394, "comment_id": 73762059, "body": "Have you tried <i>not</i> making 2000 concurrent requests? Usually limiting the open connections to some sane value is more efficient."}, {"owner": {"reputation": 9723, "user_id": 112936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc21b0d91b22e3ece4d75d8d1ca87ce?s=128&d=identicon&r=PG", "display_name": "Pavel Morshenyuk", "link": "https://stackoverflow.com/users/112936/pavel-morshenyuk"}, "edited": false, "score": 0, "creation_date": 1491922600, "post_id": 43349394, "comment_id": 73762159, "body": "Does not look like you can improve something here, maybe third-party API support batch operation on retrieving users?"}, {"owner": {"reputation": 2712, "user_id": 1670373, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/0CoZo.jpg?s=128&g=1", "display_name": "stratovarius", "link": "https://stackoverflow.com/users/1670373/stratovarius"}, "edited": false, "score": 1, "creation_date": 1491936106, "post_id": 43349394, "comment_id": 73770821, "body": "In theory, you are as fast as the slowest process when you are using concurrency. So did you checked network metrics for the slowest response?"}], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 1592427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac0d4b665046f4b598e862a706467bb3?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1592427/andrew"}, "edited": false, "score": 0, "creation_date": 1600180726, "post_id": 43353802, "comment_id": 113003001, "body": "Do you have any ideas how to compute batch size in the runtime? I believe it depends on many dynamic factors like network bandwidth and server load."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 217, "user_id": 1592427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac0d4b665046f4b598e862a706467bb3?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1592427/andrew"}, "edited": false, "score": 0, "creation_date": 1600180849, "post_id": 43353802, "comment_id": 113003068, "body": "No. Even the definition of &quot;batch size&quot; varies widely."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 4, "last_activity_date": 1491935857, "creation_date": 1491935857, "answer_id": 43353802, "question_id": 43349394, "link": "https://stackoverflow.com/questions/43349394/fastest-way-to-send-multiple-http-requests/43353802#43353802", "title": "Fastest way to send multiple HTTP requests", "body": "<p>This sort of situation is very difficult to address <em>in general</em>. Performance at this level depends very much on the specifics of your server, API, network, etc.  But here are a few suggestions to get you going:</p>\n\n<ol>\n<li><p>Try limiting the number of concurrent connections.</p>\n\n<p>As mentioned by @JimB in comments, trying to handle 2000 concurrent connections is likely inefficient, for both the server and client. Try limiting to 10, 20, 50, 100 simultaneous connections. Benchmark each value, and tweak accordingly until you get the best performance.</p>\n\n<p>On the client side, this may allow re-using connections (thus reducing the average per-request overhead), which is currently impossible, since you're initiating all 2000 connections before any of them complete.</p></li>\n<li><p>If the server supports HTTP/2, make sure you're using HTTP/2, which can be more efficient (with multiple requests--so this really depends on #1 above, too). See the documentation about <a href=\"https://golang.org/pkg/net/http/#pkg-overview\" rel=\"nofollow noreferrer\">debugging HTTP/2</a>.</p></li>\n<li><p>If the API supports bulk requests, take advantage of this, and request multiple users in a single request.</p></li>\n</ol>\n"}], "owner": {"reputation": 1550, "user_id": 3281900, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/100000487316008/picture?type=large", "display_name": "Pig", "link": "https://stackoverflow.com/users/3281900/pig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2588, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491935857, "creation_date": 1491922345, "last_edit_date": 1491935065, "question_id": 43349394, "link": "https://stackoverflow.com/questions/43349394/fastest-way-to-send-multiple-http-requests", "title": "Fastest way to send multiple HTTP requests", "body": "<p>I have an array of about 2000 user objects (maps) that I need to call an API to get the user detail -> process the response -> update my local DB as soon as possible. I used Go's waitgroup and goroutine to implement the concurrent request sending method, however to call 2000 requests it would take about 24 seconds on my 2014 Macbook Pro. Is there anyway to make it faster?</p>\n\n<pre><code>var wg sync.WaitGroup\n\njson.Unmarshal(responseData, &amp;users)\nwg.Add(len(users))\n\nfor i:= 0; i&lt;len(users); i++ {\n    go func(userid string){\n        url := \"https://www.example.com/user_detail/\"+ userid\n        response, _ := http.Get(url) \n        defer response.Body.Close()\n        data, _ := ioutil.ReadAll(response.Body)\n        wg.Done()\n    }(users[i][\"userid\"])\n}\n\nwg.Wait()\n</code></pre>\n"}, {"tags": ["go", "memory-management", "rpc"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1491913433, "post_id": 43345097, "comment_id": 73754696, "body": "Is the second part related to the first? Perhaps ask it as a separate question to avoid getting the question closed as too broad."}, {"owner": {"reputation": 232, "user_id": 7596362, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NjI5T.jpg?s=128&g=1", "display_name": "lorneli", "link": "https://stackoverflow.com/users/7596362/lorneli"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1491915292, "post_id": 43345097, "comment_id": 73756136, "body": "@Paul Hankin  I added a demo in second part to show what happends after executing <code>*req = Request{}</code> in first part. I&#39;ve changed my post to make it more clear."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1491916077, "post_id": 43345097, "comment_id": 73756804, "body": "Oh, I see now. No, <code>*req = Request{}</code> doesn&#39;t (or at least, shouldn&#39;t) create a new Request on the heap. It is just a convenient way to reset <code>*req</code> back to the zero-initialized state."}, {"owner": {"reputation": 232, "user_id": 7596362, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NjI5T.jpg?s=128&g=1", "display_name": "lorneli", "link": "https://stackoverflow.com/users/7596362/lorneli"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1491916424, "post_id": 43345097, "comment_id": 73757145, "body": "@Paul Hankin  Thanks for your comment."}], "answers": [{"comments": [{"owner": {"reputation": 232, "user_id": 7596362, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NjI5T.jpg?s=128&g=1", "display_name": "lorneli", "link": "https://stackoverflow.com/users/7596362/lorneli"}, "edited": false, "score": 0, "creation_date": 1491923286, "post_id": 43346896, "comment_id": 73762660, "body": "Thanks for your detailed answer. I search &quot;how to tell whether a variable is allocated on heap or stack in golang&quot;, and find <a href=\"https://golang.org/doc/faq#stack_or_heap\" rel=\"nofollow noreferrer\">an answer</a> in golang FAQ."}], "tags": [], "owner": {"reputation": 8073, "user_id": 2852624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/682806d261e4f00f77aa8633689a9558?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias247", "link": "https://stackoverflow.com/users/2852624/matthias247"}, "is_accepted": true, "score": 1, "last_activity_date": 1491916175, "creation_date": 1491916175, "answer_id": 43346896, "question_id": 43345097, "link": "https://stackoverflow.com/questions/43345097/golang-why-not-the-free-list-in-rpc-server-reuse-instance-directly/43346896#43346896", "title": "golang: Why not the free list in rpc server reuse instance directly", "body": "<p>The idea of the freelist is to reduce the amount of dynamic memory allocations, by reusing object instances that have already been created.</p>\n\n<p>It works like this:</p>\n\n<p>When the first request is made the freelist is empty, therefore a new structures will be allocated on the heap. When these are no longer required they are put in the freelist for reuse. If you wouldn't have the freelist then the next request would need to create new Request/Response structures on the heap, which might be costly to do over-and-over again. With the freelist this is avoided, as the next request can simply reuse the already allocated (and parked) objects.</p>\n\n<p>I guess you are confused about this line:</p>\n\n<pre><code>*req = Request{}\n</code></pre>\n\n<p>Opposed to the case where the freelist is empty and a new object is created on the heap with <code>req = new(Request)</code>, this does not allocate an object on the heap.</p>\n\n<p>It instead just resets the already allocated object (which was dequed from the freelist) to it's default state, by copying the default values.</p>\n\n<p>You could decompose the line into the following:</p>\n\n<pre><code>r := Request{} // Create a request with default content on stack (not heap!)\n*req = r // Copy all fields from default request to req\n</code></pre>\n\n<p>Whatever path is taken in <code>getRequest()</code>, it always returns a default initialized request object - with no leftovers from the previous request.</p>\n"}], "owner": {"reputation": 232, "user_id": 7596362, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NjI5T.jpg?s=128&g=1", "display_name": "lorneli", "link": "https://stackoverflow.com/users/7596362/lorneli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 43346896, "answer_count": 1, "score": 1, "last_activity_date": 1491916175, "creation_date": 1491911428, "last_edit_date": 1491916132, "question_id": 43345097, "link": "https://stackoverflow.com/questions/43345097/golang-why-not-the-free-list-in-rpc-server-reuse-instance-directly", "title": "golang: Why not the free list in rpc server reuse instance directly", "body": "<p><a href=\"https://golang.org/src/net/rpc/server.go?s=5752:5988#L179\" rel=\"nofollow noreferrer\">RPC server</a> in net/rpc package holds two free lists for <code>Request</code> struct and <code>Response</code> struct. <code>Request</code> struct maintains this list via its <code>next</code> field.</p>\n\n<pre><code>// Server represents an RPC Server.\ntype Server struct {\n    // ...\n    freeReq    *Request // header node of Request free list\n    freeResp   *Response // header node of Response free list\n}\n\ntype Request struct {\n    ServiceMethod string   // format: \"Service.Method\"\n    Seq           uint64   // sequence number chosen by client\n    next          *Request // for free list in Server\n}\n</code></pre>\n\n<p>The free list in rpc server seems to be a object pool. When handling rpc request, server calls <code>getRequest</code> to get a request instance from free list. After handling request, server calls <code>freeRequest</code> to put request instance back to free list.</p>\n\n<pre><code>func (server *Server) getRequest() *Request {\n    server.reqLock.Lock()\n    req := server.freeReq\n    if req == nil {\n        req = new(Request) // free list is empty\n    } else {\n        server.freeReq = req.next // free list isn't empty\n        *req = Request{} // Why not reuse instance directly?\n    }\n    server.reqLock.Unlock()\n    return req\n}\n\nfunc (server *Server) freeRequest(req *Request) {\n    server.reqLock.Lock()\n    req.next = server.freeReq\n    server.freeReq = req\n    server.reqLock.Unlock()\n}\n</code></pre>\n\n<p>I'm confused about the <code>getRequest</code> function. When free list is empty, it creates a new instance as expected. When free list isn't empty, it executes <code>*req = Request{}</code>. I think <code>Request{}</code> also creates a new insance. So what's the point of holding this free list?</p>\n\n<hr>\n\n<p>In addition, I wrote a demo to show the effect of the <code>*req = Request{}</code> format statement.</p>\n\n<pre><code>type Student struct {\n    Name string\n    Age int\n}\n\nfunc main() {\n    s := &amp;Student{\"John\", 20}\n    fmt.Printf(\"Address: %p Content: %v\\n\", s, s)\n\n    *s = Student{\"Frank\", 18} // similar to *req = Request{}\n    fmt.Printf(\"Address: %p Content: %v\\n\", s, s)\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Address: 0xc42000a4c0 Content: &amp;{John 20}\nAddress: 0xc42000a4c0 Content: &amp;{Frank 18}\n</code></pre>\n\n<p>So statement <code>*req = Request{}</code> doesn't change the address of pointer, but it does change the content.</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491911080, "post_id": 43344584, "comment_id": 73752957, "body": "If <code>dal</code> returns types different from those other <code>db</code> packages you can use reflection to check the <code>var</code>&#39;s type, including package path. But if <code>dal</code> returns a type defined in <code>db</code>, instead of regexp you can use the <code>go&#47;ast</code> and co. packages to determine how and where the <code>var</code> is being set in the source, but i&#39;m not sure if it&#39;s fool proof... To be honest though, in case you want to hear someone&#39;s opinion,  it seems like you&#39;re overdoing it and having to do overly complicated testing is usually a smell of bad design."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491911548, "post_id": 43344584, "comment_id": 73753293, "body": "The &quot;dal&quot; holds and interface var that is assigned by a respective DAL implementation. Think of dependency injection.  I&#39;ll add code to question."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1491914570, "post_id": 43344584, "comment_id": 73755547, "body": "Given your update, if you don&#39;t want to allow an import of a specific package and the use of that package, reflection isn&#39;t gonna help you, the <code>reflect</code> package is not able to tell you what packages were imported by the calling package, neither is it able to tell you how and where a specific package is used. I&#39;d go with @David Joyner&#39;s solution."}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1491916941, "post_id": 43344584, "comment_id": 73757575, "body": "What behavior are these tests trying to prevent? What is the cost of someone importing <code>some_db</code> directly? Do you not want people to accidentally connect to certain databases?  is this test solving the problem correctly?  Is it a safety thing?"}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "reply_to_user": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1491917836, "post_id": 43344584, "comment_id": 73758359, "body": "@dm03514 There are 2 purpose of the tests. 1st is to ensure proper separation of concerns. 2nd to prevent compilation &amp; tests speed degradation - for example importing something from &quot;google.golang.org/appengine/datastore&quot; can significantly increase compilation times."}], "answers": [{"comments": [{"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1491912447, "post_id": 43345035, "comment_id": 73753983, "body": "I was thinking reflection should be faster if possible?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1491914242, "post_id": 43345035, "comment_id": 73755293, "body": "@AlexanderTrakhimenok: reflection requires compiling and running the program, while parsing the file just relies on reading the source. You also can&#39;t reflect on a &quot;package&quot; -- if the package isn&#39;t used it doesn&#39;t exist in the compiled binary."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491916275, "post_id": 43345035, "comment_id": 73757004, "body": "@Jimb but when I&#39;m running standard Go unit tests it does compile package(s). And I assume reflection should work there just fine."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1491916928, "post_id": 43345035, "comment_id": 73757562, "body": "@AlexanderTrakhimenok: reflection works on values. If you have a value you want to verify, you could check its type&#39;s PkgPath qualifier. You can&#39;t checks imports at runtime, because imports statements aren&#39;t executed code, they don&#39;t exist at runtime."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491917945, "post_id": 43345035, "comment_id": 73758455, "body": "@JimB thanks, that is what I suspected. Seems the best option would be to go with parser AST option."}], "tags": [], "owner": {"reputation": 19879, "user_id": 1146, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a2db357b96af34f0fd5b2a8d3f6c7960?s=128&d=identicon&r=PG", "display_name": "David Joyner", "link": "https://stackoverflow.com/users/1146/david-joyner"}, "is_accepted": true, "score": 5, "last_activity_date": 1491911269, "creation_date": 1491911269, "answer_id": 43345035, "question_id": 43344584, "link": "https://stackoverflow.com/questions/43344584/is-it-possible-to-unit-test-that-my-package-does-not-import-a-specific-package/43345035#43345035", "title": "Is it possible to unit test that my package does not import a specific package?", "body": "<p>Slightly more reliable than grep: parse the target source using the standard <a href=\"https://golang.org/pkg/go/parser/\" rel=\"noreferrer\"><code>parser</code> package</a> and inspect the AST. You'd be looking for <a href=\"https://golang.org/pkg/go/ast/#ImportSpec\" rel=\"noreferrer\"><code>ImportSpec</code></a> nodes matching the DB access packages. Fail the test if any are found.</p>\n"}], "owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 43345035, "answer_count": 1, "score": 0, "last_activity_date": 1491939589, "creation_date": 1491909968, "last_edit_date": 1491939589, "question_id": 43344584, "link": "https://stackoverflow.com/questions/43344584/is-it-possible-to-unit-test-that-my-package-does-not-import-a-specific-package", "title": "Is it possible to unit test that my package does not import a specific package?", "body": "<p>I want to make sure my Go package use var instances provided by a \"dal\" package and does not accidentally import and use db access packages directly.</p>\n\n<p>I guess I can do regexp search on source but I wonder if there is a way to ensure the rule through standard Go testing?</p>\n\n<p>Just to give an idea what I'm going to do:</p>\n\n<p>Interface package:</p>\n\n<pre><code>package dal\n\ntype UserDal interface {\n  GetUser(id int) User\n}\n</code></pre>\n\n<p>Implementation package:</p>\n\n<pre><code>package dal_db_specific\n\nimport (\n  \"some_db\"\n  \"dal\"\n)\n\ntype UserDalDbSpecific struct {\n}\n\nfunc (_ UserDalDbSpecific) GetUser(id int) User {\n  some_db.executeQuery(...)\n  ...\n  return user\n}\n\nregister_dal() {\n  dal.UserDal = UserDalDbSpecific{}\n}\n</code></pre>\n\n<p>User code package:</p>\n\n<pre><code>import (\n  \"dal\"\n  \"some_db\" &lt;-- Fail here!\n)\n\nfunc someFunc() {\n  user := dal.User.GetUser(1) // Right way\n  some_db.DoSomething()  &lt;-- Fail here!\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mongodb-query", "bson"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4692714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQ2MG.jpg?s=128&g=1", "display_name": "jiahuat", "link": "https://stackoverflow.com/users/4692714/jiahuat"}, "edited": false, "score": 0, "creation_date": 1491960279, "post_id": 43341928, "comment_id": 73780057, "body": "Thanks! It  works. What if i don&#39;t know stu1 is the 0 field in the array, i just know the name is &quot;jack&quot;, then how to write the update code?"}, {"owner": {"reputation": 13, "user_id": 4692714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQ2MG.jpg?s=128&g=1", "display_name": "jiahuat", "link": "https://stackoverflow.com/users/4692714/jiahuat"}, "edited": false, "score": 0, "creation_date": 1491962264, "post_id": 43341928, "comment_id": 73780536, "body": "<code>err := col.Update(bson.M{&quot;_id&quot;: &quot;123&quot;, &quot;student.name&quot;: &quot;jack&quot;}, \t\tbson.M{&quot;$set&quot;: bson.M{&quot;student.$&quot;: &amp;stu3}})</code> \t \tthis can work."}], "tags": [], "owner": {"reputation": 2336, "user_id": 1826232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DldsJ.png?s=128&g=1", "display_name": "Asdine", "link": "https://stackoverflow.com/users/1826232/asdine"}, "is_accepted": true, "score": 0, "last_activity_date": 1491902858, "creation_date": 1491902858, "answer_id": 43341928, "question_id": 43341732, "link": "https://stackoverflow.com/questions/43341732/how-to-update-arrays-field-in-mongodb-with-go/43341928#43341928", "title": "How to update array&#39;s field in Mongodb with Go", "body": "<p>You can use the <code>$set</code> operator and the <a href=\"https://docs.mongodb.com/manual/core/document/#document-dot-notation\" rel=\"nofollow noreferrer\">dot notation</a> :</p>\n\n<pre><code>err := col.Update(\n  bson.M{\"_id\": \"123\"},\n  bson.M{\n    \"$set\": bson.M{\n      \"student.0\": &amp;stu3\n    }\n})\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4692714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQ2MG.jpg?s=128&g=1", "display_name": "jiahuat", "link": "https://stackoverflow.com/users/4692714/jiahuat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 43341928, "answer_count": 1, "score": 0, "last_activity_date": 1491903344, "creation_date": 1491902372, "last_edit_date": 1491903344, "question_id": 43341732, "link": "https://stackoverflow.com/questions/43341732/how-to-update-arrays-field-in-mongodb-with-go", "title": "How to update array&#39;s field in Mongodb with Go", "body": "<p>I want to change <code>stu1</code> to <code>stu3</code></p>\n\n<pre><code>import (\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\ntype Student struct {\n    Name string `bson:\"name\"`\n    Age  string `bson:\"age\"`\n}\ntype Class struct {\n    Id      string    `bson:\"_id\"`\n    Student []Student `bson:\"student\"`\n}\n\ncol := mongosession.DB(\"test\").C(\"class\")\n\nstu1 := Student{\"jack\", \"18\"}\nstu2 := Student{\"rose\", \"16\"}\nclass := Class{Id: \"123\", Student: []Student{stu1, stu2}}\ncol.Insert(class)\n\nstu3 := Student{\"lisi\", \"14\"}\n</code></pre>\n\n<p>How do I do the update? Is it like the following</p>\n\n<pre><code>col.Update(bson.M{\"_id\": \"123\"},\n            bson.M{\"$set\": bson.M{\"student\": ??????}})\n</code></pre>\n\n<p>Any help will be appreciated!</p>\n"}, {"tags": ["go", "terminal"], "comments": [{"owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "edited": false, "score": 0, "creation_date": 1491908347, "post_id": 43341350, "comment_id": 73751025, "body": "Have a look at <a href=\"http://tldp.org/HOWTO/Bash-Prompt-HOWTO/x361.html\" rel=\"nofollow noreferrer\">this</a>: However, if the default behaviour of a terminal doesn&#39;t meet your expectations, then maybe a different UI (e.g. web, desktop) might do a better job? Just a thought."}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 5, "last_activity_date": 1491913746, "last_edit_date": 1492086984, "creation_date": 1491913746, "answer_id": 43345953, "question_id": 43341350, "link": "https://stackoverflow.com/questions/43341350/how-to-keep-terminal-input-always-at-bottom-in-golang/43345953#43345953", "title": "How to keep terminal input always at bottom in Golang?", "body": "<p>With <a href=\"https://github.com/gizak/termui\" rel=\"nofollow noreferrer\"><code>github.com/gizak/termui</code></a> you're heading in the correct direction.</p>\n\n<p>To understand why you can't get that</p>\n\n<blockquote>\n  <p>I want the live update to be update on the main part of the terminal, while the \"Enter command >\" always stay at the bottom</p>\n</blockquote>\n\n<p>part sorted out, a little excursion to the history of computing is due. ;-)</p>\n\n<p>The thing is, the mode your teminal emulator\u00b9 works by default originated\nin how computers would communicate to the operator in the era which predated\nalphanumeric displays \u2014 they would print their responses using a line printer.  Now think of it: a line printer works like this: it prints whatever is sent to it on a roll of paper.  What was output, was output.\nThe new output always appears physically below the older.</p>\n\n<p>When alphanumeric displays (screens) came into existence they\nnaturally continued to support this mode:\nthe line text to be output was rendered at the bottom of the screen\nwith the text above it scrolled upwards.\nThat's what you see in your typical terminal emulator all the time when you're working in the command line of a shell (such as <code>bash</code>) running by the emulator window.\nThis, default, work mode of a terminal is called \"canonical\" or \"cooked\".</p>\n\n<p>Then came more advanced displays, for which it was possible to change\nindividual <em>positions</em> on the screen \u2014 identified by their column and\nrow numbers.\nThis changed the paradigm of how the information was output: the concept\nof a so-called \"full-screen application\" was born.\nTypical examples of them are text editors such as Vim and Emacs.</p>\n\n<p>To support full-screen text output, terminals (and terminal emulators)\nwere adapted by implementing certain extensions to their protocols.</p>\n\n<p>A full-screen application first requests the terminal to switch into another\nmode called \"raw\", in which the terminal sends most of what is input by the\nuser directly to the program running on the terminal.\nThe program handles this input and orders the terminal where and what\nto draw.\nYou can read <a href=\"https://unix.stackexchange.com/a/21760/43156\">this good summary</a>\nof the distinction between the both modes.</p>\n\n<p>As you are supposedly suspecting by now, to be able to keep some block\nof information at a certain fixed place of the terminal's text screen,\nyou want your program to be a full-screen program and use the terminal's\nraw mode and its special commands allowing you to directly modify\ntext at certain character cells.</p>\n\n<p>Now the problem is that different terminals (and terminal emulators)\nhave different commands to do that, so there exist libraries to isolate\nthe programs from these gory details.  They rely on the special \"terminal\ninformation databases\" to figure out what capabilities a terminal has\nand how to make it do what the program asks.\nSee <code>man terminfo</code> for more background.</p>\n\n<p>The most widely known such library (written in C) is called <code>ncurses</code>,\nand there exist native solutions for Go with supposedly the most visible\none being <a href=\"https://godoc.org/github.com/nsf/termbox-go\" rel=\"nofollow noreferrer\"><code>github.com/nsf/termbox-go</code></a>.</p>\n\n<p>The <code>github.com/gizak/termui</code> makes use of <code>termbox-go</code> but for you it might\nsuffice to use the latter directly.</p>\n\n<hr>\n\n<p>\u00b9 Chances are very high you're not sitting at\na <a href=\"https://en.wikipedia.org/wiki/Computer_terminal\" rel=\"nofollow noreferrer\">real hardware terminal</a>\nconnected to a UNIX\u00ae machine but are rather working in a GUI application\nsuch as GNOME Terminal or <code>xterm</code> or Termial.app etc.\nThese are not \"terminals\" per se but are rather\n<a href=\"https://en.wikipedia.org/wiki/Terminal_emulator\" rel=\"nofollow noreferrer\">terminal <em>emulators</em></a> \u2014\nthat is, pieces of software emulating a hardware terminal.</p>\n"}], "owner": {"reputation": 119, "user_id": 7509214, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/619339d8852f4be726058017a86ac2cd?s=128&d=identicon&r=PG&f=1", "display_name": "user7509214", "link": "https://stackoverflow.com/users/7509214/user7509214"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1858, "favorite_count": 1, "accepted_answer_id": 43345953, "answer_count": 1, "score": 2, "last_activity_date": 1491913746, "creation_date": 1491901442, "question_id": 43341350, "link": "https://stackoverflow.com/questions/43341350/how-to-keep-terminal-input-always-at-bottom-in-golang", "title": "How to keep terminal input always at bottom in Golang?", "body": "<p>I am trying to create a program which will have live updates from some data source. And I also want to wait for user input just like a normal terminal. Right now, whenever there is update, I will print the content and print the prompt message for input again which create something like this:</p>\n\n<pre><code>Enter command &gt; \nThis is a live update message\n\nEnter command &gt; \nThis is a multi-line li......\n......ve update message\n\nEnter command &gt; quit\nBye bye!\n</code></pre>\n\n<p>The problem is that for every live message I received, I will print it and the \"Enter command >\" will be displayed again again and again, which is not desired. I want the live update to be update on the main part of the terminal, while the \"Enter command >\" always stay at the bottom</p>\n\n<p>The closest package I can found on Github is <a href=\"https://github.com/gizak/termui\" rel=\"nofollow noreferrer\">https://github.com/gizak/termui</a> but most of the examples inside is trying to display text, gauge and graphs. So I am not quite sure how to get started.</p>\n\n<p>Is there any package or example of the termui package to achieve this? Thank you.</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 165, "user_id": 4309248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff11cdd1920b6d0331adc684bd05027?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309248/chris"}, "edited": false, "score": 0, "creation_date": 1491910126, "post_id": 43339334, "comment_id": 73752274, "body": "Not sure what you&#39;re trying to achieve here. This program should exit prematurely as nothing is blocking the main func. I presume this isn&#39;t the intended behaviour."}, {"owner": {"reputation": 165, "user_id": 4309248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff11cdd1920b6d0331adc684bd05027?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309248/chris"}, "edited": false, "score": 0, "creation_date": 1491910453, "post_id": 43339334, "comment_id": 73752517, "body": "Investigate using waitgroups <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\">golang.org/pkg/sync/#WaitGroup</a>"}, {"owner": {"reputation": 424, "user_id": 1459578, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f0618fbfe872614be8f5fa14ee152d65?s=128&d=identicon&r=PG", "display_name": "Javad M. Amiri", "link": "https://stackoverflow.com/users/1459578/javad-m-amiri"}, "reply_to_user": {"reputation": 165, "user_id": 4309248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff11cdd1920b6d0331adc684bd05027?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309248/chris"}, "edited": false, "score": 1, "creation_date": 1491914580, "post_id": 43339334, "comment_id": 73755551, "body": "The program won&#39;t exit since there is a call to fmt.Scanln at the end of main function."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1491896795, "creation_date": 1491896795, "answer_id": 43339736, "question_id": 43339334, "link": "https://stackoverflow.com/questions/43339334/buffered-unbuffered-go-channels-and-deadlock/43339736#43339736", "title": "buffered/unbuffered go channels and deadlock", "body": "<ol>\n<li>Think what happens once all the channel-sending stuff is done: You select runs in a endless for-loop and nothing can run once the timer fired.</li>\n</ol>\n\n<p>1.1. You send on ch1 first. The select loop selects randomly from all path which <em>can</em> run. The second case cannot run as there is nothing in ch2 until you got \"hi\" through ch1.</p>\n\n<p>1.2. Your timeout.</p>\n\n<ol start=\"2\">\n<li>Your channels are buffered and you can send into them even without someone reading directly from them. So both statements <code>ch1&lt;-\"hi\"</code> and `ch2&lt;-\"by2\" can be executed and the select has something to select from.</li>\n</ol>\n"}], "owner": {"reputation": 424, "user_id": 1459578, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f0618fbfe872614be8f5fa14ee152d65?s=128&d=identicon&r=PG", "display_name": "Javad M. Amiri", "link": "https://stackoverflow.com/users/1459578/javad-m-amiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554129684, "creation_date": 1491895525, "last_edit_date": 1554129684, "question_id": 43339334, "link": "https://stackoverflow.com/questions/43339334/buffered-unbuffered-go-channels-and-deadlock", "title": "buffered/unbuffered go channels and deadlock", "body": "<p>I use this piece of code for playing with goroutines for the sake of learning. There are different things that I cannot get:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    ch1 := make(chan string) // &lt;A&gt;\n    ch2 := make(chan string) // &lt;B&gt;\n\n    go test(ch1, ch2)\n    ch1 &lt;- \"hi\" // &lt;C&gt;\n    ch2 &lt;- \"bye\" // &lt;D&gt;\n    fmt.Scanln()\n}\n\nfunc test(ch1 chan string, ch2 chan string) {\n    timeout := time.After(time.Second * 2) // &lt;E&gt;\n    defer func() { fmt.Println(\"returning\") }()\n    for {\n        select {\n        case s := &lt;-ch1:\n            fmt.Println(s, \"1\")\n            ch2 &lt;- \"ch2\"\n            fmt.Println(\"after 1\")\n        case s := &lt;-ch2:\n            fmt.Println(s, \"2\")\n            ch1 &lt;- \"ch1\"\n            fmt.Println(\"after 2\")\n        case &lt;-timeout:\n            fmt.Println(\"timed out\")\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>If I run the code as is, I always get:</p>\n\n<blockquote>\n  <p>hi 1<br>\n  fatal error: all goroutines are asleep - deadlock!</p>\n</blockquote>\n\n<p>The point is the program exactly waits for the specified duration in part <strong>E</strong>. I mean if I add to sleep time the fatal error comes after elapsing that time. So first question is:</p>\n\n<p>1- What exactly happens? Can anyone explain the behavior? </p>\n\n<p>1-1- Why the code always prints <code>\"hi 1\"</code>? I have read that select statement picks from ready channels randomly, so why always <code>\"hi 1\"</code>? If I swap <strong>C</strong> and <strong>D</strong> then it always prints <code>\"bye 2\"</code>.</p>\n\n<p>1-2- Why program waits for that period of time and then the deadlock happens?</p>\n\n<p>Now suppose I make channels buffered in <strong>A</strong> and <strong>B</strong> with size of 1 i.e.:</p>\n\n<pre><code>ch1 := make(chan string, 1) // &lt;A&gt;\nch2 := make(chan string, 1) // &lt;B&gt;\n</code></pre>\n\n<p>Now each time I run the program it randomly prints either of <code>\"hi 1\"</code> and <code>\"bye 2\"</code> (just one time) and waits forever (if I hit enter program exits, as coded in main function)</p>\n\n<p>2- What happens now? Please explain.</p>\n\n<p>Finally if I make buffer size 2 (or more):</p>\n\n<pre><code>ch1 := make(chan string, 2) // &lt;A&gt;\nch2 := make(chan string, 2) // &lt;B&gt;\n</code></pre>\n\n<p>program runs as expected and prints both <code>\"hi 1\"</code> and <code>\"bye 2\"</code> one after another until time coded in <strong>E</strong> section elapsed:</p>\n\n<pre><code>ch1 1  \nafter 1  \nch2 2  \nafter 2  \nch1 1  \nafter 1  \nch1 1  \nafter 1  \nch2 2   \n.  \n.  \n.  \ntimed out  \nreturning  \n</code></pre>\n\n<p>I think here everything is clear and since channels are buffered with an apt size everything works as expected.</p>\n"}, {"tags": ["google-app-engine", "go", "google-bigquery"], "comments": [{"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "edited": false, "score": 0, "creation_date": 1491895520, "post_id": 43339181, "comment_id": 73741754, "body": "shouldn&#39;t you use <code>ctx_with_deadline</code> also for bigquery.NewClient?"}, {"owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "reply_to_user": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "edited": false, "score": 0, "creation_date": 1491906167, "post_id": 43339181, "comment_id": 73749422, "body": "@AlexEfimov it looks package option does not have deadline option."}, {"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "edited": false, "score": 0, "creation_date": 1491909358, "post_id": 43339181, "comment_id": 73751696, "body": "I mean like <code>client, err := bigquery.NewClient(ctx_with_deadline, PROJECT_ID, option.WithServiceAccountFile(SERVICE_ACCOUNT_JSON_FILE_PATH&zwnj;&#8203;), option.WithHTTPClient(httpClient))</code>"}, {"owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "reply_to_user": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "edited": false, "score": 0, "creation_date": 1491911859, "post_id": 43339181, "comment_id": 73753539, "body": "@AlexEfimov Thanks! it worked. Could you answer to my question? I will accept it."}], "answers": [{"tags": [], "owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "is_accepted": true, "score": 1, "last_activity_date": 1491919267, "last_edit_date": 1491919267, "creation_date": 1491916837, "answer_id": 43347179, "question_id": 43339181, "link": "https://stackoverflow.com/questions/43339181/deadline-exceeded-on-go-bigquery/43347179#43347179", "title": "DEADLINE_EXCEEDED on Go Bigquery", "body": "<p>Use <code>ctx_with_deadline</code> also when creating a new instance of the bigquery client:</p>\n\n<pre><code>client, err := bigquery.NewClient(ctx_with_deadline, PROJECT_ID, option.WithServiceAccountFile(SERVICE_ACCOUNT_JSON_FILE_PATH\u200c\u200b), option.WithHTTPClient(httpClient))\n</code></pre>\n"}], "owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 43347179, "answer_count": 1, "score": 1, "last_activity_date": 1491919267, "creation_date": 1491895025, "last_edit_date": 1495541848, "question_id": 43339181, "link": "https://stackoverflow.com/questions/43339181/deadline-exceeded-on-go-bigquery", "title": "DEADLINE_EXCEEDED on Go Bigquery", "body": "<p>Our application sometimes see DEADLINE_EXCEEDED when accessing to Big Query.</p>\n\n<pre><code>import (\n    \"cloud.google.com/go/bigquery\"\n    \"golang.org/x/net/context\"\n    \"google.golang.org/api/option\"\n)\n\nfunc MyFunc(ctx context.Context) {\n            :\n    client, err := bigquery.NewClient(ctx, PROJECT_ID, option.WithServiceAccountFile(SERVICE_ACCOUNT_JSON_FILE_PATH))\n    query := client.Query(\"SELECT * FROM ....\")\n    it, err := query.Read(ctx)\n    var list []MyStruct\n    for {\n        var m MyStruct\n        err := it.Next(&amp;m)\n        if err == iterator.Done {\n            break\n        }\n        if err != nil {\n           &lt;Error Handling&gt;\n        }\n        list = append(list, m)\n    }\n            :\n}\n</code></pre>\n\n<p>Sometimes we see this error.</p>\n\n<pre><code>Get https://www.googleapis.com/bigquery/v2/projects/myproject/queries/job_zandIeLwH0s8f3FAQ_ORC0zau14?alt=json\\u0026startIndex=0\\u0026timeoutMs=60000: API error 5 (urlfetch: DEADLINE_EXCEEDED): ('The read operation timed out',)\"\n</code></pre>\n\n<p>It looks timeout is 5 second, but I can' find how can I change timeout seconds.</p>\n\n<p>I read <a href=\"https://stackoverflow.com/questions/13317472/gae-golang-urlfetch-timeout\">this post</a>, and I modified my source code as below.</p>\n\n<pre><code>ctx_with_deadline, _ := context.WithTimeout(ctx, 1*time.Minute)\nhttpClient := &amp;http.Client{\n    Transport: &amp;oauth2.Transport{\n        Base: &amp;urlfetch.Transport{Context: ctx_with_deadline},\n    },\n}\n\nclient, err := bigquery.NewClient(ctx, PROJECT_ID, option.WithServiceAccountFile(SERVICE_ACCOUNT_JSON_FILE_PATH), option.WithHTTPClient(httpClient))\n</code></pre>\n\n<p>Then I met this error.</p>\n\n<pre><code>Post https://www.googleapis.com/bigquery/v2/projects/myproject/jobs?alt=json: oauth2: Transport's Source is nil\n</code></pre>\n\n<p>How can I change timeout in Go Bigquery?</p>\n"}, {"tags": ["go", "google-signin", "googlesigninapi"], "answers": [{"tags": [], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "is_accepted": true, "score": 0, "last_activity_date": 1491908573, "creation_date": 1491908573, "answer_id": 43344105, "question_id": 43339163, "link": "https://stackoverflow.com/questions/43339163/get-google-sign-in-profile-info-from-access-token-golang/43344105#43344105", "title": "Get Google Sign In Profile Info From Access Token - Golang", "body": "<p>You must decode the Google ID token returned by <code>POST https://www.googleapis.com/oauth2/v4/token</code> to convert it into a Google+ ID then you may use <code>GET https://www.googleapis.com/plus/v1/people/[gplusID]?access_token=[accessToken]</code></p>\n\n<blockquote>\n  <p>Using Go, you can decode the google ID token using the following\n  function. Normally, it is critical that you validate an ID token\n  before you use it, but since you are communicating directly with\n  Google over an intermediary-free HTTPS channel and using your Client\n  Secret to authenticate yourself to Google, you can be confident that\n  the token you receive really comes from Google and is valid. If your\n  server passes the ID token to other components of your app, it is\n  extremely important that the other components validate the token\n  before using it.</p>\n</blockquote>\n\n<p>Using Go, you can decode the ID token with the following function.</p>\n\n<pre><code>func decodeGoogleIDToken(idToken string) (gplusID string, err error) {\n    var set struct {\n        Sub string\n    }\n    if idToken != \"\" {\n        // Check that the padding is correct for a base64decode\n        parts := strings.Split(idToken, \".\")\n        if len(parts) &lt; 2 {\n            return \"\", fmt.Errorf(\"Malformed ID token\")\n        }\n        // Decode the ID token\n        s := parts[1]\n        switch len(s) % 4 {\n        case 2:\n            s += \"==\"\n        case 3:\n            s += \"=\"\n        }\n\n        b, err := base64.URLEncoding.DecodeString(s)\n        if err != nil {\n            return \"\", fmt.Errorf(\"Malformed ID token: %v\", err)\n        }\n        err = json.Unmarshal(b, &amp;set)\n        if err != nil {\n            return \"\", fmt.Errorf(\"Malformed ID token: %v\", err)\n        }\n    }\n    return set.Sub, nil\n}\n</code></pre>\n\n<p>Check out an example here at <a href=\"https://play.golang.org/p/M7sYmE2ztx\" rel=\"nofollow noreferrer\">https://play.golang.org/p/M7sYmE2ztx</a></p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 0, "accepted_answer_id": 43344105, "answer_count": 1, "score": 1, "last_activity_date": 1491908573, "creation_date": 1491894973, "question_id": 43339163, "link": "https://stackoverflow.com/questions/43339163/get-google-sign-in-profile-info-from-access-token-golang", "title": "Get Google Sign In Profile Info From Access Token - Golang", "body": "<p>I have the following JavaScript code</p>\n\n<pre><code>auth2.grantOfflineAccess().then(function(codeData) {\n    if (!codeData) {\n        alert(\"Something went wrong\");\n        return;\n    }\n\n    $.post(\"/do/signIn/google\", codeData, function() { ... });\n});\n</code></pre>\n\n<p>I am sending the code for a Google sign in to my golang web app.\nI successfully got an access token from <code>POST https://www.googleapis.com/oauth2/v4/token</code>.</p>\n\n<p>My issue is, I am unable to get the user's profile information (such as email, display name etc.)</p>\n\n<p>I've tried sending a request to <code>GET https://www.googleapis.com/auth/userinfo.profile?access_token=xxx</code> and I receive an empty response (blank body).</p>\n"}, {"tags": ["performance", "ssl", "go", "https", "tls1.2"], "comments": [{"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1491895685, "post_id": 43339043, "comment_id": 73741868, "body": "How, precisely (with what command line options) did you generate the self-signed certificate and the Let\u2019s Encrypt certificate?"}, {"owner": {"reputation": 3333, "user_id": 1129667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a56d7975ff6832cee73c7c7d862512b?s=128&d=identicon&r=PG", "display_name": "Maurizio Benedetti", "link": "https://stackoverflow.com/users/1129667/maurizio-benedetti"}, "edited": false, "score": 0, "creation_date": 1491898180, "post_id": 43339043, "comment_id": 73743498, "body": "This looks rather strange. Have you changed anything else? Like the SSL configuration settings. Depending on the algorithms and supported protocol versions SSL/TLS can be more costly (not in the order of seconds btw)."}, {"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "reply_to_user": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1491900891, "post_id": 43339043, "comment_id": 73745384, "body": "@Zoyd I didn&#39;t generate it myself but I managed to get the command that has been executed to generate the certificate by using the docker container from quay.io/letsencrypt/letsencrypt. The arguments were: <code>letsencrypt --name certbot  certonly --standalone --preferred-challenges tls-sni</code> (nothing special AFAIK)"}, {"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "reply_to_user": {"reputation": 3333, "user_id": 1129667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a56d7975ff6832cee73c7c7d862512b?s=128&d=identicon&r=PG", "display_name": "Maurizio Benedetti", "link": "https://stackoverflow.com/users/1129667/maurizio-benedetti"}, "edited": false, "score": 0, "creation_date": 1491900986, "post_id": 43339043, "comment_id": 73745448, "body": "@MaurizioBenedetti Nothing changed in configuration settings. The TLS handshake and SSL configuration is the standard provided by the Golang HTTP server."}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1491902477, "post_id": 43339043, "comment_id": 73746626, "body": "So the Let\u2019s Encrypt certificate uses the default values, assuming the config file in the Docker container does not override them. What about the self-signed certificate ?"}, {"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "reply_to_user": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1491906916, "post_id": 43339043, "comment_id": 73749994, "body": "@Zoyd The self signed one was an old certificate generated with standard openssl commands. It was generated in late 2015 and used wherever we needed a testing or demo environment with HTTPS. I can&#39;t recall the script used to generate it but it was a standard certificate with no particular configurations.   Only noticeable thing was that the domain associated with the certificate was completely different from the domains the certificate actually was used for."}], "answers": [{"comments": [{"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "edited": false, "score": 0, "creation_date": 1491935410, "post_id": 43353545, "comment_id": 73770432, "body": "We&#39;ve already designed and prepared our proxying strategy for the production environment. The case in question is related to our staging environment where we do not have (or need) any proxy and each service handles the TLS handshake by itself."}], "tags": [], "owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "is_accepted": false, "score": 0, "last_activity_date": 1491935555, "last_edit_date": 1491935555, "creation_date": 1491935007, "answer_id": 43353545, "question_id": 43339043, "link": "https://stackoverflow.com/questions/43339043/using-tls-ssl-trusted-certificate-improved-performances/43353545#43353545", "title": "Using TLS/SSL trusted certificate improved performances", "body": "<p>Why not use HAproxy or Nginx as reverse proxy with ssl/tls and then direct the requests to your app. Something like <a href=\"https://www.digitalocean.com/community/tutorials/how-to-secure-haproxy-with-let-s-encrypt-on-ubuntu-14-04\" rel=\"nofollow noreferrer\">https://www.digitalocean.com/community/tutorials/how-to-secure-haproxy-with-let-s-encrypt-on-ubuntu-14-04</a></p>\n\n<p>This way you are supporting horizontal scaling.</p>\n"}], "owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491935555, "creation_date": 1491894563, "question_id": 43339043, "link": "https://stackoverflow.com/questions/43339043/using-tls-ssl-trusted-certificate-improved-performances", "title": "Using TLS/SSL trusted certificate improved performances", "body": "<p>We're developing a cloud-based service for businesses. The component I'm in charge of is divided in three parts, a simple <em>WEB</em> and <em>assets</em> server, an API server (both written in <code>Go</code>) and the actual <em>WEB</em> application (<code>AngularJS</code> based). The <em>WEB</em> application flow is pretty straightforward, it downloads assets and source files from the web server and datas from the API server.</p>\n\n<p>Until yesterday we've been using a simple <strong>Self-Signed SSL certificate</strong> and I was blaming myself because the whole application was slow, and by slow I mean very slow (I didn't though about actually measuring it but it could take ~3/4 seconds to load assets and sources and a few more to load datas).</p>\n\n<p>Yesterday we managed to start using a <strong>Trusted SSL Certificate</strong> (obtained via <em>Let'sEncrypt</em>) and all of a sudden I noticed that the performances have dramatically improved. It now takes (measured) less than 2 seconds to be fully loaded and ready to be used.</p>\n\n<p>Now, I guess the actual reason is that, with a trusted Certification Authority and a valid SSL certificate, there are less security checks to be executed by the browser and/or during <em>TLS</em> handshake and thus less performance degradation in all requests. </p>\n\n<p>But: Am I right or partially/completely wrong? Am I missing something? </p>\n"}, {"tags": ["google-app-engine", "go", "goland"], "answers": [{"comments": [{"owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "edited": false, "score": 0, "creation_date": 1491906931, "post_id": 43341167, "comment_id": 73750006, "body": "I see, but I hope GAE debugging will be supported."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "edited": false, "score": 0, "creation_date": 1491934412, "post_id": 43341167, "comment_id": 73769847, "body": "As you can see from the issue, GAE support for debugging is more an issue related to GAE itself rather than the IDE. Since you are on Windows, even if the IDE would use the workarounds in place for debugging GAE apps it would still not work for you so that would make it a worse experience, especially if you use Windows and other operating systems."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 0, "last_activity_date": 1491901006, "creation_date": 1491901006, "answer_id": 43341167, "question_id": 43337335, "link": "https://stackoverflow.com/questions/43337335/debugging-gae-go-application-on-gogland/43341167#43341167", "title": "Debugging GAE/Go application on Gogland", "body": "<p>Debugging GAE apps is not currently supported, see: <a href=\"https://youtrack.jetbrains.com/issue/GO-1897\" rel=\"nofollow noreferrer\">https://youtrack.jetbrains.com/issue/GO-1897</a></p>\n"}], "owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "accepted_answer_id": 43341167, "answer_count": 1, "score": 1, "last_activity_date": 1491901006, "creation_date": 1491888169, "last_edit_date": 1495541421, "question_id": 43337335, "link": "https://stackoverflow.com/questions/43337335/debugging-gae-go-application-on-gogland", "title": "Debugging GAE/Go application on Gogland", "body": "<p>This is the continuation of <a href=\"https://stackoverflow.com/questions/43243820/invoking-gae-go-local-development-server-on-gogland\">my previous question</a>.</p>\n\n<p>I could invoke GAE/Go local development server, but I can not debug my GAE/Go application on Gogland.</p>\n\n<p>Run -> Debug</p>\n\n<p>Then I selected \"Edit\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/wZC2d.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wZC2d.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then I clicked \"Debug\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/eBQx3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eBQx3.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then the popup below is shown.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CSad4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CSad4.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>How can I debug my GAE/Go application?</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 8123, "user_id": 7616, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65200fa240ec9fd105e5aae657d22dbb?s=128&d=identicon&r=PG", "display_name": "shyam", "link": "https://stackoverflow.com/users/7616/shyam"}, "edited": false, "score": 0, "creation_date": 1491892417, "post_id": 43337158, "comment_id": 73739995, "body": "Thanks. I missed the whole prefix part when I went through the docs :)"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1491887470, "last_edit_date": 1491887470, "creation_date": 1491887138, "answer_id": 43337158, "question_id": 43337039, "link": "https://stackoverflow.com/questions/43337039/nest-if-condition-within-a-range-in-golang-templates/43337158#43337158", "title": "nest if condition within a range in golang templates", "body": "<p>If you <a href=\"https://play.golang.org/p/eY5jqaYSWV\" rel=\"nofollow noreferrer\">check the error</a> returned from <code>Execute</code>, you will find that the template is attempting to pass arguments to the non-function $i.  The correct syntax is:</p>\n\n<pre><code>const t = `{{range $i, $v := .}}{{$i}} {{$v}}{{if gt $i 0}}, {{end}}\n{{end}}\n`\n</code></pre>\n\n<p>The arguments follow the function <code>gt</code>. The function <code>gt</code> is not an <a href=\"https://en.wikipedia.org/wiki/Infix_notation\" rel=\"nofollow noreferrer\">infix operator</a>.</p>\n\n<p><a href=\"https://play.golang.org/p/w7tM_sQz9V\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>If your goal is to print a comma separated list, then write it like this:</p>\n\n<pre><code>const t = `{{range $i, $v := .}}{{if $i}}, \n{{end}}{{$i}} {{$v}}{{end}}\n`\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/q3lCGyTblz\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 8123, "user_id": 7616, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65200fa240ec9fd105e5aae657d22dbb?s=128&d=identicon&r=PG", "display_name": "shyam", "link": "https://stackoverflow.com/users/7616/shyam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2277, "favorite_count": 0, "accepted_answer_id": 43337158, "answer_count": 1, "score": 0, "last_activity_date": 1491887470, "creation_date": 1491886437, "question_id": 43337039, "link": "https://stackoverflow.com/questions/43337039/nest-if-condition-within-a-range-in-golang-templates", "title": "nest if condition within a range in golang templates", "body": "<p>How to use an if condition within a range iteration loop in go?</p>\n\n<pre><code>package main\n\nimport \"os\"\nimport \"text/template\"\n\nconst t = `{{range $i, $v := .}}{{$i}} {{$v}}{{if $i gt 0}}, {{end}}\n{{end}}\n`\n\nfunc main() {\n    d := []string{\"a\", \"b\", \"c\"}\n    template.Must(template.New(\"\").Parse(t)).Execute(os.Stdout, d)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/IeenD90FRM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/IeenD90FRM</a></p>\n"}, {"tags": ["linux", "file", "go", "permission-denied"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1491892043, "post_id": 43337019, "comment_id": 73739836, "body": "Run a program from a user account that has sufficient permissions."}, {"owner": {"reputation": 113, "user_id": 7649953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8466e13f075d10ada940146d361dcd?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/7649953/bruce"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1491945183, "post_id": 43337019, "comment_id": 73775764, "body": "The machine is spun up in AWS cloud with the go environment and code deployed through BeanStalk. So there is no end user control of the machine or the program user. Thought there is a better way."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7649953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8466e13f075d10ada940146d361dcd?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/7649953/bruce"}, "edited": false, "score": 0, "creation_date": 1491945201, "post_id": 43338341, "comment_id": 73775770, "body": "The machine is spun up in AWS cloud with the go environment and code deployed through BeanStalk. So there is no end user control of the machine or the program user. Thought there was a better way."}], "tags": [], "owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "is_accepted": true, "score": 6, "last_activity_date": 1491892296, "creation_date": 1491892296, "answer_id": 43338341, "question_id": 43337019, "link": "https://stackoverflow.com/questions/43337019/golang-os-create-permission-denied/43338341#43338341", "title": "Golang os.Create permission denied", "body": "<p>What you have there is a standard UNIX permissions issue.  Given the special nature of that directory, you've got three options:</p>\n\n<ol>\n<li>Change the permissions of that directory to be more promiscuous.  Bad idea, as it opens up a nasty can of worms security-wise.</li>\n<li>Run the go program using sysV, upstart, or systemd such that the program runs with a user with permissions there (usually root).  Better because only one process gets the upgrade and you get nice start/stop/monitor routines and rudimentary self-healing with upstart or systemd.  Indeed, you may want to explore using one of those if you're not already.</li>\n<li>Use <a href=\"https://golang.org/pkg/log/syslog/\" rel=\"noreferrer\">go's built-in interface to syslog</a> and configure your local syslogd to save its logs to that file.  Best, because you're just sending logs to a socket and letting the service deal with it for you.</li>\n</ol>\n\n<p>Note also that systemd can save your stdout/err to files if you configure it right and you can then browse with journalctl.  Indeed, leaving your program to stupidly print diags to stdout/err and not forking itself is the smartest thing to do now that systemd does all that stuff for you (that way, you can focus on what your program does and not reinventing the wheel wrt daemonization and logging).</p>\n\n<p>For all the grief systemd gets, it's actually pretty good at this use case.</p>\n"}], "owner": {"reputation": 113, "user_id": 7649953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8466e13f075d10ada940146d361dcd?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/7649953/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4355, "favorite_count": 1, "accepted_answer_id": 43338341, "answer_count": 1, "score": 0, "last_activity_date": 1491892296, "creation_date": 1491886301, "question_id": 43337019, "link": "https://stackoverflow.com/questions/43337019/golang-os-create-permission-denied", "title": "Golang os.Create permission denied", "body": "<p>I'm trying to create a log file on linux /var/log directory, but got permission denied. Any best practices without having to change the ownership of the directory?</p>\n\n<pre><code>f, _ := os.Create(\"/var/log/go_server.log\")\ndefer f.Close()\nlog.SetOutput(f)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1168, "user_id": 2079484, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1e334d2fa189682927dcc80cd1018388?s=128&d=identicon&r=PG", "display_name": "user2027202827", "link": "https://stackoverflow.com/users/2079484/user2027202827"}, "edited": false, "score": 0, "creation_date": 1491880364, "post_id": 43336009, "comment_id": 73736121, "body": "How will the compiler know how to initialize the object if you don&#39;t tell it? Are you trying to say you want to initialize it in many places with the same arguments? If that&#39;s the case, you could define a couple functions to manage the state of the object (e.g. <code>CreateAppointment()</code>)"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1491880600, "post_id": 43336009, "comment_id": 73736181, "body": "If you want to make sure it&#39;s always valid, you&#39;ll have to retain tight control over access to the fields. To do that, you can put the type definitions in their own package so that you can only export what you want to export. If you don&#39;t want to have your &quot;constructor&quot; function take a bunch of arguments, you can define a structure that contains all the initialization parameters and pass that. (That&#39;s just a general way of making a function with a long argument list easier to use.)"}], "answers": [{"tags": [], "owner": {"reputation": 1890, "user_id": 1694885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1T2T.png?s=128&g=1", "display_name": "syllabix", "link": "https://stackoverflow.com/users/1694885/syllabix"}, "is_accepted": false, "score": 0, "last_activity_date": 1491884682, "last_edit_date": 1491884682, "creation_date": 1491881011, "answer_id": 43336224, "question_id": 43336009, "link": "https://stackoverflow.com/questions/43336009/constructor-with-many-arguments/43336224#43336224", "title": "Constructor with many arguments", "body": "<p>One pattern seen used by popular Go project is to create functions that return desired state of a struct. (checkout the <a href=\"https://github.com/julienschmidt/httprouter\" rel=\"nofollow noreferrer\">httprouter</a> project as an example - although its <code>New</code> func does not take any args...)</p>\n\n<p>In your case - you could write a function that returns an <code>Appointment</code> with desired properties initialized. </p>\n\n<p>for example </p>\n\n<pre><code>package appointment \n\ntype Appointment struct { \n    //your example code here...\n}\n\nfunc New(title, details, dressCode string) *Appointment {\n  return &amp;Appointment{\n    Title: \"foo\",\n    Details: \"bar\",\n    StartingTime: 12451412,\n    //set the rest of the properties with sensible defaults - otherwise they will initialize to their zero value\n  }  \n}\n</code></pre>\n\n<p>Then used in another file, import the package</p>\n\n<pre><code>package main\n\nimport path/to/appointment\n\nfunc main() {\n   myApt := appointment.New(\"Interview\", \"Marketing Job\", \"Casual\")\n   //myApt is now a pointer to an Appointment struct properly initialized\n}\n</code></pre>\n\n<p>Depending on how tight you want access control of the Appointment object property values, you do not have to export all of them (by setting them to lowercase) and provide more traditional accessor (think get, set) methods on the struct itself to ensure the struct always remain \"valid\"</p>\n"}, {"comments": [{"owner": {"reputation": 297, "user_id": 7467314, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8c4715513d18c3b7c8c20346296c85da?s=128&d=identicon&r=PG&f=1", "display_name": "user7467314", "link": "https://stackoverflow.com/users/7467314/user7467314"}, "edited": false, "score": 0, "creation_date": 1491882364, "post_id": 43336310, "comment_id": 73736579, "body": "Good points, but it makes life easier imo when type invariants are never allowed to enter into an invalid state. After all, is a car presumed to be a car without four wheels and an engine? Plus, if you&#39;re validating at consumption time you&#39;re really relying on developers to remember to call <code>Validate()</code> each time which they may or may not do.   &gt;You must validate input data!  agreed, but that can be done using some kind of data container before ever instantiating the object."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 297, "user_id": 7467314, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8c4715513d18c3b7c8c20346296c85da?s=128&d=identicon&r=PG&f=1", "display_name": "user7467314", "link": "https://stackoverflow.com/users/7467314/user7467314"}, "edited": false, "score": 0, "creation_date": 1491883140, "post_id": 43336310, "comment_id": 73736799, "body": "@user7467314: How is your data type being consumed? Why would a <code>Validate()</code> function be needed, rather than, say, a <code>SaveToDatabase()</code> function, which also does validation?"}, {"owner": {"reputation": 297, "user_id": 7467314, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8c4715513d18c3b7c8c20346296c85da?s=128&d=identicon&r=PG&f=1", "display_name": "user7467314", "link": "https://stackoverflow.com/users/7467314/user7467314"}, "edited": false, "score": 0, "creation_date": 1491888510, "post_id": 43336310, "comment_id": 73738430, "body": "something like <code>SaveToDatabse()</code> would be the concern of the persistence mechanism which probably won&#39;t deal with validation at all. Validation will be implemented as behaviours on the model. As to how the data is consumed, a service layer instantiates the model from some data, executes whatever behaviours it needs to and then persists the object to the database."}, {"owner": {"reputation": 297, "user_id": 7467314, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8c4715513d18c3b7c8c20346296c85da?s=128&d=identicon&r=PG&f=1", "display_name": "user7467314", "link": "https://stackoverflow.com/users/7467314/user7467314"}, "edited": false, "score": 0, "creation_date": 1491888699, "post_id": 43336310, "comment_id": 73738498, "body": "As you say, invariants will need to be preserved after each state transition. The problem is how do you instantiate models that have a lot of state that can&#39;t really be grouped together logically, for e.g in a single struct. How do you avoid having to call a constructor with 10+ argument primitives?"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1570559761, "last_edit_date": 1570559761, "creation_date": 1491881690, "answer_id": 43336310, "question_id": 43336009, "link": "https://stackoverflow.com/questions/43336009/constructor-with-many-arguments/43336310#43336310", "title": "Constructor with many arguments", "body": "<blockquote>\n  <p>I want the <code>Appointment</code> type to be always valid; that is, I don't want to initialize it with a struct literal and then have to validate it.</p>\n</blockquote>\n\n<p>The only way to guarantee this is to not export the type. Then the only way for a consumer of your package to obtain a struct of that type, is through your constructor method.  Keep in mind that returning non-exported types is kind of ugly. One possible way around this is to access your data through an exported interface. That brings in a number of other considerations--which may be good, or bad for any given situation.</p>\n\n<p>Now, while that's the only way to strictly meet your stated requirement, it may not actually be necessary. You might consider relaxing your requirement.</p>\n\n<p>Consider this:</p>\n\n<h2>You must validate input data!</h2>\n\n<p>All you're deciding on is whether you're doing the validation at object creation time, or at object consumption time.  Go's constructs generally make the latter easier (for both the coder, and the consumer of the data).  If you <em>truly must</em> do validation at object creation time, then your only option is to use unexported types, and getter/setter methods for everything.</p>\n"}, {"comments": [{"owner": {"reputation": 297, "user_id": 7467314, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8c4715513d18c3b7c8c20346296c85da?s=128&d=identicon&r=PG&f=1", "display_name": "user7467314", "link": "https://stackoverflow.com/users/7467314/user7467314"}, "edited": false, "score": 0, "creation_date": 1491926599, "post_id": 43341503, "comment_id": 73765126, "body": "Thanks for the link; this is clever but still quite verbose imo. I can see how it would work well for setting up (optional) options though, but not so much for datatypes with many required fields where default values are not possible."}], "tags": [], "owner": {"reputation": 1424, "user_id": 684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a367bea2a4977a908c7d468a21e2b6c?s=128&d=identicon&r=PG", "display_name": "Will Demaine", "link": "https://stackoverflow.com/users/684539/will-demaine"}, "is_accepted": false, "score": 6, "last_activity_date": 1491901840, "creation_date": 1491901840, "answer_id": 43341503, "question_id": 43336009, "link": "https://stackoverflow.com/questions/43336009/constructor-with-many-arguments/43341503#43341503", "title": "Constructor with many arguments", "body": "<p>You may be able to use the \"<a href=\"https://dave.cheney.net/2014/10/17/functional-options-for-friendly-apis\" rel=\"noreferrer\">functional options</a>\" pattern to achieve this. It allows you to define functions for each input, removing the need for you to pass lots of options to your constructor.</p>\n\n<pre><code>func New(options ...func(*Appointment)) (*Appointment, error) {\n  ap := &amp;Appointment{\n    Title: \"Set your defaults\",\n    Details: \"if you don't want zero values\",\n    StartingTime: 123,\n  }\n  for _, option := range options {\n    option(ap)\n  }\n  // Do any final validation that you want here.\n  // E.g. check that something is not still 0 value\n  if ap.EndTime == 0 {\n    return nil, errors.New(\"invalid end time\")\n  }\n\n  return ap, nil\n}\n\n// Then define your option functions\n\nfunc AtEndTime(endTime int64) func(*Appointment) {\n  return func(ap *Appointment) {\n    ap.EndTime = endTime\n  }       \n}\n</code></pre>\n\n<p>The resulting call looks something like:</p>\n\n<pre><code>ap, err := appointment.New(\n  AtEndTime(123),\n  WithGuests([]Guest{...}),\n)\n</code></pre>\n\n<p>If you want to validate each option in the function itself, it's not too much work to change that signature to possibly return an error too.</p>\n"}, {"comments": [{"owner": {"reputation": 379, "user_id": 7067918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4456e1b265f37c27776d4ba20e634a7?s=128&d=identicon&r=PG&f=1", "display_name": "Katamari", "link": "https://stackoverflow.com/users/7067918/katamari"}, "edited": false, "score": 1, "creation_date": 1557251184, "post_id": 43341600, "comment_id": 98699454, "body": "These links would be great except that they reference the master branch of these files which have definitely changed, so the highlights dont line up anymore."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1557253254, "last_edit_date": 1557253254, "creation_date": 1491902052, "answer_id": 43341600, "question_id": 43336009, "link": "https://stackoverflow.com/questions/43336009/constructor-with-many-arguments/43341600#43341600", "title": "Constructor with many arguments", "body": "<p>One way you could avoid having to pass 10+ arguments to your constructors is to have an <code>XxxParams</code> type for each of your <code>Xxx</code> types and have your <code>NewXxx</code> take that params type as its argument. Then the <code>NewXxx</code> constructor would construct an <code>Xxx</code> value from those params, validate it, and return it, or an error, depending on the result of the validation.</p>\n\n<p>This might feel redundant if you're constructing the <code>XxxParams</code> values manually as opposed to unmarshaling them from json, xml, etc.; but still, this way you are enforcing, however loosely, only valid <code>Xxx</code>'s to be constructed, keeping the possibly invalid state in the input (<code>XxxParams</code>).</p>\n\n<p>Here's an example from Stripe's repo: <a href=\"https://github.com/stripe/stripe-go/blob/c4fbb41e6d772a7571bdc31eea0d4de7c2450ee4/account.go#L88-L132\" rel=\"nofollow noreferrer\">Account</a>, <a href=\"https://github.com/stripe/stripe-go/blob/c4fbb41e6d772a7571bdc31eea0d4de7c2450ee4/account.go#L54-L65\" rel=\"nofollow noreferrer\">AccountParams</a>, and <a href=\"https://github.com/stripe/stripe-go/blob/c4fbb41e6d772a7571bdc31eea0d4de7c2450ee4/account/client.go#L106-L125\" rel=\"nofollow noreferrer\">constructor</a></p>\n"}], "owner": {"reputation": 297, "user_id": 7467314, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8c4715513d18c3b7c8c20346296c85da?s=128&d=identicon&r=PG&f=1", "display_name": "user7467314", "link": "https://stackoverflow.com/users/7467314/user7467314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2100, "favorite_count": 2, "accepted_answer_id": 43341600, "answer_count": 4, "score": 2, "last_activity_date": 1570559761, "creation_date": 1491879384, "question_id": 43336009, "link": "https://stackoverflow.com/questions/43336009/constructor-with-many-arguments", "title": "Constructor with many arguments", "body": "<p>What's the most idiomatic way of initializing a Go type with many required parameters?</p>\n\n<p>For example:</p>\n\n<pre><code>type Appointment struct {\n  Title string\n  Details string\n  Dresscode string\n\n  StartingTime int64\n  EndingTime int64\n  RSVPdate int64\n\n\n  Place *Place\n  Guests []*Guest\n}\n\ntype Place struct {\n  Name string\n  Address string\n}\n\ntype Guest struct {\n  Name string\n  Status string\n}\n</code></pre>\n\n<p>I want the <code>Appointment</code> type to be always valid; that is, I don't want to  initialize it with a struct literal and then have to validate it.</p>\n\n<p>Don't want:</p>\n\n<pre><code>a := &amp;Appointment{\n  Title: \"foo\",\n  Details: \"bar\",\n  StartingTime: 12451412,\n  ...\n}\n\nerr := a.Validate()\n</code></pre>\n\n<p>whats the best way to initialize this type of object (with lots of fields) without having to supply all the arguments in the constructor arguments?</p>\n"}, {"tags": ["file", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1491880203, "post_id": 43335989, "comment_id": 73736091, "body": "That usually means the target <i>directory</i> doesn&#39;t exist."}], "answers": [{"tags": [], "owner": {"reputation": 9441, "user_id": 1000254, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e1621f7d5eef73c430632061efdc97b0?s=128&d=identicon&r=PG", "display_name": "shizhz", "link": "https://stackoverflow.com/users/1000254/shizhz"}, "is_accepted": true, "score": 5, "last_activity_date": 1491880702, "last_edit_date": 1491880702, "creation_date": 1491880273, "answer_id": 43336129, "question_id": 43335989, "link": "https://stackoverflow.com/questions/43335989/golang-os-create-cause-no-such-file-or-directory-error/43336129#43336129", "title": "golang os.Create cause &quot;no such file or directory&quot; error", "body": "<p>You can't use <code>~</code> or environment variable like <code>$HOME</code> to specify the file path, they're string literal and means actual path. The error you got is because it treat <code>~/golang-server.log</code> as a relative path of current directory, and there's no directory <code>~</code> in current directory.</p>\n\n<p>With manually created sub-directory <code>~</code>, your code will succeed:</p>\n\n<pre><code>\uf8ff ~/test/ mkdir \\~\n\uf8ff ~/test/ go run t.go\n\uf8ff ~/test/ ls \\~\ngolang-server.log\n</code></pre>\n\n<p>So need to pass an <code>absolute path</code> or <code>relative path</code> to <code>os.Create</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1029, "user_id": 401883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Sqws.png?s=128&g=1", "display_name": "snyh", "link": "https://stackoverflow.com/users/401883/snyh"}, "is_accepted": false, "score": 2, "last_activity_date": 1583212988, "last_edit_date": 1583212988, "creation_date": 1583212499, "answer_id": 60500505, "question_id": 43335989, "link": "https://stackoverflow.com/questions/43335989/golang-os-create-cause-no-such-file-or-directory-error/60500505#60500505", "title": "golang os.Create cause &quot;no such file or directory&quot; error", "body": "<p>You can use  <code>os.ExpandEnv</code> to handle the \"~\" which is only make sense in sh/bash context.</p>\n\n<pre><code>os.Create(os.ExpandEnv(\"$HOME/golang-server.log\"))\n</code></pre>\n\n<p>In more complicated cases, you need to <strong>ensure that the base directory exists</strong>, because <code>os.Create</code> does not handle it.</p>\n\n<p>And this is the reason why <code>os.Create(\"~/golang-server.log\")</code> will fail, because the base directory doesn't exist and <code>os.Create</code> wouldn't automatically create it for you. You need do it by yourself like this:</p>\n\n<pre><code>func EnsureBaseDir(fpath string) error {\n    baseDir := path.Dir(fpath)\n    info, err := os.Stat(baseDir)\n    if err == nil &amp;&amp; info.IsDir() {\n       return nil\n    }\n    return os.MkdirAll(baseDir, 0755)\n}\n</code></pre>\n\n<p>NOTE:</p>\n\n<ul>\n<li><code>$HOME</code> is not always exists, e.g. the program run as a system level <code>systemd</code> service.  So you better not use <code>$HOME</code> in a production environment.</li>\n<li>the limitation of <code>os.Create</code> doesn't only exist in Go. It's caused by the OS kernel and widely exists in other languages/stdlib.</li>\n</ul>\n"}], "owner": {"reputation": 113, "user_id": 7649953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8466e13f075d10ada940146d361dcd?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/7649953/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7950, "favorite_count": 0, "accepted_answer_id": 43336129, "answer_count": 2, "score": 5, "last_activity_date": 1614613333, "creation_date": 1491879211, "last_edit_date": 1614613333, "question_id": 43335989, "link": "https://stackoverflow.com/questions/43335989/golang-os-create-cause-no-such-file-or-directory-error", "title": "golang os.Create cause &quot;no such file or directory&quot; error", "body": "<p>Must be something simple, but I cannot seem to figure out. I keep getting &quot;no such file or directory&quot; error. Thought the Create function is to create a new file?</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;log&quot;\n    &quot;os&quot;\n)\n\nfunc main() {\n    f, err := os.Create(&quot;~/golang-server.log&quot;)\n    defer f.Close()\n    if err != nil {\n        panic(err.Error())\n    }\n    log.SetOutput(f)\n}\n</code></pre>\n"}, {"tags": ["go", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 11891, "user_id": 1930219, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5ae618e4950c81bf0d83d17c2c2ddaab?s=128&d=identicon&r=PG", "display_name": "Alex Netkachov", "link": "https://stackoverflow.com/users/1930219/alex-netkachov"}, "edited": false, "score": 0, "creation_date": 1491855691, "post_id": 43331959, "comment_id": 73728763, "body": "Thank you. Works like a charm."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1491854293, "creation_date": 1491854293, "answer_id": 43331959, "question_id": 43330938, "link": "https://stackoverflow.com/questions/43330938/export-function-that-returns-array-of-doubles/43331959#43331959", "title": "Export function that returns array of doubles", "body": "<p>In order to safely store a pointer in C, the data it points to must be allocated in C.</p>\n\n<pre><code>//export Init\nfunc Init(f string) (C.size_t, *C.double) {\n    size := 10\n\n    // allocate the *C.double array\n    p := C.malloc(C.size_t(size) * C.size_t(unsafe.Sizeof(C.double(0))))\n\n    // convert the pointer to a go slice so we can index it\n    doubles := (*[1&lt;&lt;30 - 1]C.double)(p)[:size:size]\n    doubles[3] = C.double(1.5)\n\n    return C.size_t(size), (*C.double)(p)\n}\n</code></pre>\n"}], "owner": {"reputation": 11891, "user_id": 1930219, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5ae618e4950c81bf0d83d17c2c2ddaab?s=128&d=identicon&r=PG", "display_name": "Alex Netkachov", "link": "https://stackoverflow.com/users/1930219/alex-netkachov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "accepted_answer_id": 43331959, "answer_count": 1, "score": 1, "last_activity_date": 1491854293, "creation_date": 1491850619, "question_id": 43330938, "link": "https://stackoverflow.com/questions/43330938/export-function-that-returns-array-of-doubles", "title": "Export function that returns array of doubles", "body": "<p>In Golang how to export the function that returns array of doubles. The way it was possible before seems to return \"runtime error: cgo result has Go pointer\" now:</p>\n\n<pre><code>//export Init\nfunc Init(filename string) (C.int, unsafe.Pointer) {\n    var doubles [10]float64\n    doubles[3] = 1.5\n    return 10, unsafe.Pointer(&amp;doubles[0])\n}\n</code></pre>\n"}, {"tags": ["java", "security", "encryption", "go", "cryptography"], "comments": [{"owner": {"reputation": 1062, "user_id": 7846567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c0153ba98052f3c2b62c91a9b8d97c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7846567/max"}, "edited": false, "score": 0, "creation_date": 1491849503, "post_id": 43330545, "comment_id": 73725399, "body": "PS: I already searched Google for solutions, nothing really worked. Again little info: Server code is written in Go (Golang) and client code is written in Java."}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1491855805, "post_id": 43330545, "comment_id": 73728816, "body": "When you say the key is sent as a UTF8 encoded string, do you mean you are encoding the raw DER format public key to UTF8 and sending that?"}, {"owner": {"reputation": 1062, "user_id": 7846567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c0153ba98052f3c2b62c91a9b8d97c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7846567/max"}, "reply_to_user": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1491857998, "post_id": 43330545, "comment_id": 73729862, "body": "@LukePark No I actually wanted to say that I am sending a Base64 decoded string to the client. I will fix that in my post."}, {"owner": {"reputation": 1182, "user_id": 808354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c56a4f85006c3ebdae91c6716a13d9f?s=128&d=identicon&r=PG", "display_name": "Iakovos Gurulian", "link": "https://stackoverflow.com/users/808354/iakovos-gurulian"}, "edited": false, "score": 1, "creation_date": 1491869972, "post_id": 43330545, "comment_id": 73733723, "body": "I cannot check the code at the moment, however what you described is not good for a chat application. It is susceptible to man in the middle attacks. The client needs to authenticate to the server as well. You need to make a protocol and check it for potential attacks."}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "reply_to_user": {"reputation": 1182, "user_id": 808354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c56a4f85006c3ebdae91c6716a13d9f?s=128&d=identicon&r=PG", "display_name": "Iakovos Gurulian", "link": "https://stackoverflow.com/users/808354/iakovos-gurulian"}, "edited": false, "score": 1, "creation_date": 1491875565, "post_id": 43330545, "comment_id": 73734973, "body": "@jackgu1988 I think the OP said this was just a personal project.  To the OP, if this is not the case, I agree with jackgu1988, your system is flawed and not actually secure.  I would venture as far to say that it is trivial to break."}, {"owner": {"reputation": 1062, "user_id": 7846567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c0153ba98052f3c2b62c91a9b8d97c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7846567/max"}, "reply_to_user": {"reputation": 1182, "user_id": 808354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c56a4f85006c3ebdae91c6716a13d9f?s=128&d=identicon&r=PG", "display_name": "Iakovos Gurulian", "link": "https://stackoverflow.com/users/808354/iakovos-gurulian"}, "edited": false, "score": 1, "creation_date": 1491897137, "post_id": 43330545, "comment_id": 73742753, "body": "@jackgu1988 Yes I know about this issue. This would be my next point on my list. But thank you anyways for that hint."}], "answers": [{"comments": [{"owner": {"reputation": 1062, "user_id": 7846567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c0153ba98052f3c2b62c91a9b8d97c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7846567/max"}, "edited": false, "score": 0, "creation_date": 1491907219, "post_id": 43341616, "comment_id": 73750207, "body": "I will try this later. Thank you."}, {"owner": {"reputation": 1062, "user_id": 7846567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c0153ba98052f3c2b62c91a9b8d97c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7846567/max"}, "edited": false, "score": 0, "creation_date": 1491907581, "post_id": 43341616, "comment_id": 73750469, "body": "Well, it still does not work... I let both programs print out the encrypted message to make sure the server receives exactly what the client sent and this looks fine. I will include an example in my question above."}], "tags": [], "owner": {"reputation": 11, "user_id": 7388932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/788f6616522a0494f05af8b533501c90?s=128&d=identicon&r=PG&f=1", "display_name": "PasiT", "link": "https://stackoverflow.com/users/7388932/pasit"}, "is_accepted": false, "score": 1, "last_activity_date": 1491902082, "creation_date": 1491902082, "answer_id": 43341616, "question_id": 43330545, "link": "https://stackoverflow.com/questions/43330545/why-is-my-server-go-unable-to-decrypt-the-clients-java-message/43341616#43341616", "title": "Why is my server (Go) unable to decrypt the clients (Java) message?", "body": "<p>You are decrypting the base64 encoded string 's', instead of 'b64Bytes'. Your code is not compiling though, so maybe this is not the actual code? Here is a compiling solution:</p>\n\n<pre><code>func DecryptStringRSA(s string, key rsa.PrivateKey) string {\n    b64Bytes, _ := base64.StdEncoding.DecodeString(s)\n    sDecrypted, err := rsa.DecryptOAEP(sha256.New(), rand.Reader, &amp;key, b64Bytes, nil)\n    if err != nil {\n        log.Println(\"Decryption error: \", err)\n        return \"\"\n    } else {\n        return string(sDecrypted[:])\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1062, "user_id": 7846567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c0153ba98052f3c2b62c91a9b8d97c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7846567/max"}, "is_accepted": true, "score": 0, "last_activity_date": 1491919302, "creation_date": 1491919302, "answer_id": 43348198, "question_id": 43330545, "link": "https://stackoverflow.com/questions/43330545/why-is-my-server-go-unable-to-decrypt-the-clients-java-message/43348198#43348198", "title": "Why is my server (Go) unable to decrypt the clients (Java) message?", "body": "<p>SOLVED: \nI thought about the benefits a self-written security algorithm has for this project and came to the conclusion that default TLS would be enough for this. TLS is pretty easy to use with Go &amp; Java so I will build up this chat application with TLS.</p>\n\n<p>Here is a nice example how to implement TLS server side in Go:\n<a href=\"https://gist.github.com/denji/12b3a568f092ab951456\" rel=\"nofollow noreferrer\">Simple Golang HTTPS/TLS Examples</a></p>\n\n<p>Here is some information of how my client could make use of TLS and web sockets: <a href=\"https://github.com/TooTallNate/Java-WebSocket/issues/263\" rel=\"nofollow noreferrer\">How to use a SSL WebSocket client</a></p>\n"}], "owner": {"reputation": 1062, "user_id": 7846567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c0153ba98052f3c2b62c91a9b8d97c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7846567/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "accepted_answer_id": 43348198, "answer_count": 2, "score": 1, "last_activity_date": 1526903215, "creation_date": 1491849394, "last_edit_date": 1526903215, "question_id": 43330545, "link": "https://stackoverflow.com/questions/43330545/why-is-my-server-go-unable-to-decrypt-the-clients-java-message", "title": "Why is my server (Go) unable to decrypt the clients (Java) message?", "body": "<p>Currently, I am working on some socket stuff to build a simple chat with encryption. The server is written in Go and the client is written in Java.\nMy server &amp; client are already working and can communicate. My next goal is to encrypt the traffic between client &amp; server. </p>\n\n<p>I want to use RSA and AES to encrypt all data that will be transferred between both targets. When a client connects, the server will send his public RSA key to the client which will encrypt his AES key and send it back to the server. </p>\n\n<p>The main problem is now, that I can't decrypt what the client sends back to the server. I already compared the encrypted data and tried if my encryption/decryption methods work in general. And they do. But as soon as it comes to the point where the client encrypts with a public key and the server has to decrypt it with its private key it won't work.</p>\n\n<p>Here is the server code that generates a new RSA key pair:</p>\n\n<pre><code>func GenerateKeyPair() RSAKeyPair {\n    log.Println(\"Generating RSA keys. This could take a while.\")\n\n    startTime := time.Now()\n\n    privateKey, err := rsa.GenerateKey(rand.Reader, 1024)\n    if err != nil {\n        log.Fatal(\"Couldn't generate RSA keys. Message: \", err)\n        os.Exit(1)\n    }\n\n    var publicKey *rsa.PublicKey\n    publicKey = &amp;privateKey.PublicKey\n\n    elapsedTime := time.Since(startTime)\n    log.Printf(\"RSA keys ready afert %s.\", elapsedTime)\n\n    return RSAKeyPair{Private: *privateKey, Public: *publicKey}\n}\n</code></pre>\n\n<p>This is the struct that represents the RSAKeyPair</p>\n\n<pre><code>type RSAKeyPair struct {\n    Private rsa.PrivateKey\n    Public  rsa.PublicKey\n}\n</code></pre>\n\n<p>This is the server-side function to decrypt a string:</p>\n\n<pre><code>func DecryptStringRSA(s string, key rsa.PrivateKey) string {\n    b64Bytes, _ := base64.StdEncoding.DecodeString(s)\n    sDecrypted, err := rsa.DecryptOAEP(sha256.New(), rand.Reader, &amp;key, []byte(s), nil)\n    if err != nil {\n        log.Println(\"Decryption error: \", err)\n        return \"\"\n    } else {\n        return string(sDecrypted[:])\n    }\n}\n</code></pre>\n\n<p>I am using Bouncy Castle on the client side. The server sends the public key as Base64 decoded string (it's human readable now) and the client converts the string into an AsymmetricKeyParameter. This conversion also works fine, I checked that. </p>\n\n<p>The client's method to encrypt a string:</p>\n\n<pre><code>public String encryptString(String string, AsymmetricKeyParameter publicKey) throws UnsupportedEncodingException, InvalidCipherTextException {\n        Security.addProvider(new BouncyCastleProvider());\n        RSAEngine rsaEngine = new RSAEngine();\n        AsymmetricBlockCipher blockCipher = new OAEPEncoding(rsaEngine, new SHA256Digest(), new SHA256Digest(), null);\n        blockCipher.init(true, publicKey);\n\n        byte[] bytes = string.getBytes(\"UTF-8\");\n        byte[] encryptedBytes = blockCipher.processBlock(bytes, 0, bytes.length);\n        return Base64.getEncoder().encodeToString(encryptedBytes);\n    }\n</code></pre>\n\n<p>After the client encrypted a string and sent it back to the server, the server should decrypt it and continue doing what he is supposed to do but instead, it just gives me following error:</p>\n\n<pre><code>crypto/rsa: decryption error\n</code></pre>\n\n<p>Again this is what I checked and what is ok:</p>\n\n<ul>\n<li>Key conversion to string &amp; submitting to client</li>\n<li>Key conversion from string to AsymmetricKeyParameter</li>\n<li>Encodings</li>\n<li>Encryption/Decryption works on one site (Client &lt;-> Client &amp; Server &lt;-> Server</li>\n</ul>\n\n<p>In short what is not working:</p>\n\n<ul>\n<li>Decrypt string which came from client</li>\n</ul>\n\n<p>Maybe I didn't see a really small mistake or just completely forgot about something. I think there are some smart people that out there that can tell me what is wrong or give me a hint. If you need more code examples or additional information feel free to ask.</p>\n\n<p>Edit: I checked the the encrypted string to make sure the serve receives the same string the client is sending. Here are both encrypted strings: </p>\n\n<p>Client:</p>\n\n<blockquote>\n  <p>GnUapW7dxa3zXwVzNAVOJs6lcfeb6Nv0OKDM8QvPMb9jqozsGYdlET09D2Nc9F7bMfVbBMeLujlxwu8NqbvYABpoYd7uwRZJfEh/VexIEbsdkVxQUr+PEvBlE/ekkSJIV9ymCVllmRForvq7WU3pva9e56owp1NdVJGFVYVKbp8=</p>\n</blockquote>\n\n<p>Server:</p>\n\n<blockquote>\n  <p>GnUapW7dxa3zXwVzNAVOJs6lcfeb6Nv0OKDM8QvPMb9jqozsGYdlET09D2Nc9F7bMfVbBMeLujlxwu8NqbvYABpoYd7uwRZJfEh/VexIEbsdkVxQUr+PEvBlE/ekkSJIV9ymCVllmRForvq7WU3pva9e56owp1NdVJGFVYVKbp8=</p>\n</blockquote>\n\n<p>In my opinion they look the same so this shouldn't be the problem. Also client and server are both using OAEP with SHA256.</p>\n\n<p>Thank you all in advance for your help!</p>\n"}, {"tags": ["nginx", "go", "caddy"], "answers": [{"tags": [], "owner": {"reputation": 671, "user_id": 7551820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-qFYkSwbZduE/AAAAAAAAAAI/AAAAAAAAAdQ/MmHqIWG-_xQ/photo.jpg?sz=128", "display_name": "Laurence", "link": "https://stackoverflow.com/users/7551820/laurence"}, "is_accepted": true, "score": 2, "last_activity_date": 1491842365, "last_edit_date": 1491842365, "creation_date": 1491841978, "answer_id": 43328509, "question_id": 43327793, "link": "https://stackoverflow.com/questions/43327793/using-proxy-server-to-switch-between-golang-applications/43328509#43328509", "title": "Using Proxy server to switch between Golang Applications", "body": "<p>Yes, Nginx can solve your problem:</p>\n\n<ol>\n<li>Start a web server using the standard library of Go or Caddy. </li>\n<li>Redirect request to Go application using Nginx:</li>\n</ol>\n\n<p>Example Nginx configuration:</p>\n\n<pre><code>server {\n    listen 80;\n    server_name dev00.mysite.com;\n    ...\n\n    location / {\n        proxy_pass http://localhost:8000;\n        ...\n    }\n}\n\nserver {\n    listen 80;\n    server_name dev01.mysite.com;\n    ...\n\n    location / {\n        proxy_pass http://localhost:8001;\n        ...\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "accepted_answer_id": 43328509, "answer_count": 1, "score": 0, "last_activity_date": 1491842365, "creation_date": 1491839637, "question_id": 43327793, "link": "https://stackoverflow.com/questions/43327793/using-proxy-server-to-switch-between-golang-applications", "title": "Using Proxy server to switch between Golang Applications", "body": "<p>I have a server with CentOS, and there I will have at least 4 Golang applications running, every one of them is a different site that I should be able to access in the browser with domain/subdomains as follows:</p>\n\n<ul>\n<li>dev00.mysite.com</li>\n<li>dev01.mysite.com</li>\n<li>dev02.mysite.com</li>\n<li>dev03.mysite.com</li>\n</ul>\n\n<p>So, I need to configure some kind of software that redirects the requests to the correct Golang process. Every site will be running in a different port, so for example if someone calls dev00.mysite.com I should be able to send that request to the process of <em>dev00</em> site (this is for  development porpouses, not production). So, here I'm starting to believe that I need Nginx or Caddy as I read, but I have no experience with none of them. \nCan someone confirm that this is the way to fix that problem? and where can I find some example of configuration of any of that servers redirecting to Golang applications?</p>\n\n<p>And, in the future if a have a lot (really a lot) of domains running in the same server, which of that servers is better? who is better with high load?</p>\n"}, {"tags": ["heroku", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491838694, "post_id": 43327252, "comment_id": 73719070, "body": "If I remember correctly your project files are stored in an <code>&#47;app</code> folder but the app itself does not necessarily have to be started from that folder, which will cause the error you&#39;re getting. On the heroku dashboard set an env var, something like <code>PROJECT_PATH=&#47;app</code> and then in your main.go file use the <code>os</code> package to read that value... I&#39;m not 100% sure about the <code>&#47;app</code> location so try spinning up a one-off <code>bash</code> dyno on that app and explore the folders a little."}, {"owner": {"reputation": 2358, "user_id": 379105, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/46311e8469a0f2d2340f182dd0c4a35a?s=128&d=identicon&r=PG", "display_name": "kitensei", "link": "https://stackoverflow.com/users/379105/kitensei"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491845169, "post_id": 43327252, "comment_id": 73722989, "body": "Please see my edits about the log of CWD on heroku"}, {"owner": {"reputation": 2358, "user_id": 379105, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/46311e8469a0f2d2340f182dd0c4a35a?s=128&d=identicon&r=PG", "display_name": "kitensei", "link": "https://stackoverflow.com/users/379105/kitensei"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491845474, "post_id": 43327252, "comment_id": 73723167, "body": "I also tried to find the executable path <code>which go-todoist</code> which gaves me <code>&#47;app&#47;bin</code> but even when using <code>..&#47;static</code> as box path I get the same error"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491845478, "post_id": 43327252, "comment_id": 73723170, "body": "What do you get if you try using the full path? That is, <code>&#47;app&#47;static</code>. Also did you run the one off dyno with <code>bash</code> to check whether there is a <code>static</code> folder in the <code>&#47;app</code> folder?"}, {"owner": {"reputation": 2358, "user_id": 379105, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/46311e8469a0f2d2340f182dd0c4a35a?s=128&d=identicon&r=PG", "display_name": "kitensei", "link": "https://stackoverflow.com/users/379105/kitensei"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491845571, "post_id": 43327252, "comment_id": 73723220, "body": "The <code>go.rice</code> library doesn&#39;t support abs path for the box. And yes there is a static dir inside app folder (see the end of the logs)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491845871, "post_id": 43327252, "comment_id": 73723396, "body": "I take my previous comment about the absolute paths back, i see here now <a href=\"https://github.com/GeertJohan/go.rice/blob/master/box.go#L31-L35\" rel=\"nofollow noreferrer\">github.com/GeertJohan/go.rice/blob/master/box.go#L31-L35</a> that they are indeed not supported."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491847078, "post_id": 43327252, "comment_id": 73724053, "body": "Hmm you might be out of luck here... go.rice seems to resolve the path by using the <code>$GOPATH</code> variable, but the heroku go buildpack that sets the <code>$GOPATH</code> on each deploy sets it to a value that does not include the <code>&#47;app</code> contents... I think you&#39;ll have more luck raising an issue on the go.rice github page. Sorry"}, {"owner": {"reputation": 2358, "user_id": 379105, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/46311e8469a0f2d2340f182dd0c4a35a?s=128&d=identicon&r=PG", "display_name": "kitensei", "link": "https://stackoverflow.com/users/379105/kitensei"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491848768, "post_id": 43327252, "comment_id": 73725001, "body": "I will, I have temporary switched to <code>http.Dir</code> which works great (but was causing me troubles with Vagrant, but that&#39;s another story ;) )"}], "owner": {"reputation": 2358, "user_id": 379105, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/46311e8469a0f2d2340f182dd0c4a35a?s=128&d=identicon&r=PG", "display_name": "kitensei", "link": "https://stackoverflow.com/users/379105/kitensei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 968, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491846154, "creation_date": 1491838131, "last_edit_date": 1491846154, "question_id": 43327252, "link": "https://stackoverflow.com/questions/43327252/paths-in-heroku-deployment", "title": "Paths in Heroku deployment", "body": "<p>I am trying to deploy a test golang app to Heroku:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NaY1p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NaY1p.png\" alt=\"enter image description here\"></a></p>\n\n<p>My procfile looks like this: </p>\n\n<pre><code>web: todo\n</code></pre>\n\n<p>But when running my app I get the following error:</p>\n\n<pre><code>2017-04-10T15:24:07.128780+00:00 app[web.1]: panic: could not locate box \"./static\"\n</code></pre>\n\n<p>My <em>main.go</em> file contains:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"github.com/kitensei/go-todoist/server\"\n    \"github.com/GeertJohan/go.rice\"\n    \"os\"\n    \"log\"\n    \"fmt\"\n    \"path\"\n    \"strconv\"\n)\n\nvar boxPrefix = getenv(\"BOXPATH\", \"\")\n\nfunc main() {\n    dir, err := os.Getwd()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"DIRECTORY CWD: \" + dir)\n    ex, err := os.Executable()\n    if err != nil {\n        panic(err)\n    }\n    exPath := path.Dir(ex)\n    fmt.Println(\"EXECUTABLE PATH: \" + exPath)\n    exists, err := exists(boxPrefix + \"static\")\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(\"CHECK IF (\" +boxPrefix + \"static) EXISTS: \" + strconv.FormatBool(exists))\n    server.RegisterHandlers()\n    http.Handle(\"/\", http.FileServer(rice.MustFindBox(boxPrefix + \"static\").HTTPBox()))\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc getenv(key, fallback string) string {\n    value := os.Getenv(key)\n    if len(value) == 0 {\n        return fallback\n    }\n    return value\n}\n\nfunc exists(path string) (bool, error) {\n    _, err := os.Stat(path)\n    if err == nil {\n        return true, nil\n    }\n    if os.IsNotExist(err) {\n        return false, nil\n    }\n    return true, err\n}\n</code></pre>\n\n<p>Can someone give me an hint ?</p>\n\n<p><strong>EDIT</strong>: Here the output when I try to find the CWD and set the box path accordingly</p>\n\n<pre><code>2017-04-10T17:23:57.000000+00:00 app[api]: Build succeeded\n2017-04-10T17:24:06.341977+00:00 heroku[web.1]: Starting process with command `go-todoist`\n2017-04-10T17:24:08.592486+00:00 app[web.1]: DIRECTORY CWD: /app\n2017-04-10T17:24:08.595689+00:00 app[web.1]: panic: could not locate box \"static\"\n2017-04-10T17:24:08.595691+00:00 app[web.1]:\n2017-04-10T17:24:08.595692+00:00 app[web.1]: goroutine 1 [running]:\n2017-04-10T17:24:08.595718+00:00 app[web.1]: github.com/kitensei/go-todoist/vendor/github.com/GeertJohan/go%2erice.MustFindBox(0x71e08d, 0x6, 0x0)\n2017-04-10T17:24:08.595721+00:00 app[web.1]:    /tmp/tmp.Pa1igbANNl/.go/src/github.com/kitensei/go-todoist/vendor/github.com/GeertJohan/go.rice/box.go:110 +0x94\n2017-04-10T17:24:08.595724+00:00 app[web.1]: main.main()\n2017-04-10T17:24:08.595741+00:00 app[web.1]:    /tmp/tmp.Pa1igbANNl/.go/src/github.com/kitensei/go-todoist/main.go:21 +0x1a8\n2017-04-10T17:24:08.660495+00:00 heroku[web.1]: Process exited with status 2\n2017-04-10T17:24:08.685016+00:00 heroku[web.1]: State changed from starting to crashed\n2017-04-10T17:24:08.686277+00:00 heroku[web.1]: State changed from crashed to starting\n2017-04-10T17:24:09.023202+00:00 heroku[web.1]: Starting process with command `go-todoist`\n2017-04-10T17:24:10.743837+00:00 app[web.1]: DIRECTORY CWD: /app\n2017-04-10T17:24:10.746355+00:00 app[web.1]: panic: could not locate box \"static\"\n2017-04-10T17:24:10.746357+00:00 app[web.1]:\n2017-04-10T17:24:10.746360+00:00 app[web.1]: goroutine 1 [running]:\n2017-04-10T17:24:10.746361+00:00 app[web.1]: github.com/kitensei/go-todoist/vendor/github.com/GeertJohan/go%2erice.MustFindBox(0x71e08d, 0x6, 0x0)\n2017-04-10T17:24:10.746361+00:00 app[web.1]:    /tmp/tmp.Pa1igbANNl/.go/src/github.com/kitensei/go-todoist/vendor/github.com/GeertJohan/go.rice/box.go:110 +0x94\n2017-04-10T17:24:10.746363+00:00 app[web.1]: main.main()\n2017-04-10T17:24:10.746367+00:00 app[web.1]:    /tmp/tmp.Pa1igbANNl/.go/src/github.com/kitensei/go-todoist/main.go:21 +0x1a8\n2017-04-10T17:24:10.791994+00:00 heroku[web.1]: Process exited with status 2\n2017-04-10T17:24:10.817345+00:00 heroku[web.1]: State changed from starting to crashed\nvagrant@precise64:/code/src/github.com/kitensei/go-todoist$ heroku run bash -a go-todoist-gpr\n/usr/local/heroku/lib/heroku/jsplugin.rb:119: warning: Insecure world writable dir /code/bin in PATH, mode 040777\nRunning bash on \u2b22 go-todoist-gpr... up, run.9334 (Free)\n~ $ cd /app\n~ $ pwd\n/app\n~ $ ls -lA\ntotal 48\n-rw------- 1 u52460 dyno  289 Apr 10 17:23 .gitignore\ndrwx------ 3 u52460 dyno 4096 Apr 10 17:24 .heroku\ndrwx------ 2 u52460 dyno 4096 Apr 10 17:24 .profile.d\n-rw------- 1 u52460 dyno   15 Apr 10 17:24 Procfile\n-rw------- 1 u52460 dyno   26 Apr 10 17:23 README.md\n-rw------- 1 u52460 dyno  326 Apr 10 17:23 app.json\ndrwx------ 2 u52460 dyno 4096 Apr 10 17:24 bin\n-rw------- 1 u52460 dyno  592 Apr 10 17:23 main.go\ndrwx------ 2 u52460 dyno 4096 Apr 10 17:23 server\ndrwx------ 3 u52460 dyno 4096 Apr 10 17:23 static\ndrwx------ 2 u52460 dyno 4096 Apr 10 17:23 task\ndrwx------ 3 u52460 dyno 4096 Apr 10 17:23 vendor\n~ $\n</code></pre>\n\n<p>Trying to run the app on the Heroku bash:</p>\n\n<pre><code>~ $ go-todoist\nDIRECTORY CWD: /app\nEXECUTABLE PATH: /app/bin\nCHECK IF (static) EXISTS: true\npanic: could not locate box \"static\"\n\ngoroutine 1 [running]:\ngithub.com/kitensei/go-todoist/vendor/github.com/GeertJohan/go%2erice.MustFindBox(0xc4200f0cf0, 0xb, 0x5)\n        /tmp/tmp.FmcU3dgw8Y/.go/src/github.com/kitensei/go-todoist/vendor/github.com/GeertJohan/go.rice/box.go:110 +0x94\nmain.main()\n        /tmp/tmp.FmcU3dgw8Y/.go/src/github.com/kitensei/go-todoist/main.go:34 +0x42c\n</code></pre>\n\n<p>The same with an absolute path:</p>\n\n<pre><code>~ $ go-todoist\nDIRECTORY CWD: /app\nEXECUTABLE PATH: /app/bin\nCHECK IF (/app/static) EXISTS: true\npanic: given name/path is absolute\n\ngoroutine 1 [running]:\ngithub.com/kitensei/go-todoist/vendor/github.com/GeertJohan/go%2erice.MustFindBox(0xc4200f0cf0, 0xb, 0x5)\n        /tmp/tmp.FmcU3dgw8Y/.go/src/github.com/kitensei/go-todoist/vendor/github.com/GeertJohan/go.rice/box.go:110 +0x94\nmain.main()\n        /tmp/tmp.FmcU3dgw8Y/.go/src/github.com/kitensei/go-todoist/main.go:34 +0x42c\n</code></pre>\n"}, {"tags": ["go", "webserver"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 2, "creation_date": 1491836757, "post_id": 43326613, "comment_id": 73717712, "body": "<code>URL</code> has a <code>String()</code> method that does that."}], "answers": [{"tags": [], "owner": {"reputation": 671, "user_id": 7551820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-qFYkSwbZduE/AAAAAAAAAAI/AAAAAAAAAdQ/MmHqIWG-_xQ/photo.jpg?sz=128", "display_name": "Laurence", "link": "https://stackoverflow.com/users/7551820/laurence"}, "is_accepted": false, "score": 0, "last_activity_date": 1491845015, "creation_date": 1491845015, "answer_id": 43329340, "question_id": 43326613, "link": "https://stackoverflow.com/questions/43326613/cannot-use-baseurl-type-url-url-as-type-string-in-argument-to-http-get/43329340#43329340", "title": "cannot use baseURL (type *url.URL) as type string in argument to http.Get", "body": "<p>Call the <code>String()</code> method of u3 and pass the returned string to <code>http.Get()</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"net/url\"\n)\n\nfunc factHandler(w http.ResponseWriter, r *http.Request) {\n    str1 := \"http://www.meaningfultype.com/\"\n    u1, _ := url.Parse(str1)\n    str2 := \"/clarendon.html\"\n    u2, _ := url.Parse(str2)\n    u3 := u1.ResolveReference(u2)\n    fmt.Println(\"url:\", u3)\n    res, err := http.Get(u3.String())         // Change this line\n    if err != nil {\n        log.Fatal(err)\n    }\n    robots, err := ioutil.ReadAll(res.Body)\n\n    res.Body.Close()\n    if err != nil {\n        log.Fatal(err)\n    }\n    contentType := res.Header.Get(\"Content-Type\")\n    w.Header().Set(\"Content-Type\", contentType)\n    w.Write(robots)\n}\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2370, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491875936, "creation_date": 1491836467, "last_edit_date": 1491875936, "question_id": 43326613, "link": "https://stackoverflow.com/questions/43326613/cannot-use-baseurl-type-url-url-as-type-string-in-argument-to-http-get", "title": "cannot use baseURL (type *url.URL) as type string in argument to http.Get", "body": "<p>I wrote a simple web server that appends some relative path to the base URL using url.ResolveReference. And then I want to get the content of resultant URL using http.Get() but the problem is that http.get() take string as the argument and I have an object of type *url.URL.How can I resolve this problem?</p>\n\n<p>My code is given bellow:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"net/url\"\n)\n\nfunc factHandler(w http.ResponseWriter, r *http.Request) {\n    str1 := \"http://www.meaningfultype.com/\"\n    u1, _ := url.Parse(str1)\n    str2 := \"/clarendon.html\"\n    u2, _ := url.Parse(str2)\n    u3 := u1.ResolveReference(u2)\n    fmt.Println(\"url:\", u3)\n    res, err := http.Get(u3)\n    if err != nil {\n        log.Fatal(err)\n    }\n    robots, err := ioutil.ReadAll(res.Body)\n\n    res.Body.Close()\n    if err != nil {\n        log.Fatal(err)\n    }\n    contentType := res.Header.Get(\"Content-Type\")\n    w.Header().Set(\"Content-Type\", contentType)\n    w.Write(robots)\n}\n</code></pre>\n"}, {"tags": ["symfony", "go", "oauth-2.0"], "comments": [{"owner": {"reputation": 43712, "user_id": 1146363, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/071bc4c7c6229920fd24f2f37d42b382?s=128&d=identicon&r=PG", "display_name": "Cerad", "link": "https://stackoverflow.com/users/1146363/cerad"}, "edited": false, "score": 0, "creation_date": 1491847122, "post_id": 43325678, "comment_id": 73724078, "body": "Having trouble seeing where oauth2 fits in.  Typically, a Symfony app would redirect the user to facebook/google which in turn authenticates the user and redirects back to the Symfony app.  The Symfony app would then login the authenticated user.  I really don&#39;t understand what you are asking for."}, {"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "reply_to_user": {"reputation": 43712, "user_id": 1146363, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/071bc4c7c6229920fd24f2f37d42b382?s=128&d=identicon&r=PG", "display_name": "Cerad", "link": "https://stackoverflow.com/users/1146363/cerad"}, "edited": false, "score": 0, "creation_date": 1491895500, "post_id": 43325678, "comment_id": 73741743, "body": "@Cerad I refresh it based on my new knowledge."}], "owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491895474, "creation_date": 1491833996, "last_edit_date": 1491895474, "question_id": 43325678, "link": "https://stackoverflow.com/questions/43325678/oauth2-service-and-symfony-web-framework-communication", "title": "OAuth2 service and Symfony web framework communication", "body": "<p>There is a Symfony application and there is our Authentication service which provides login for our third-party clients. The problem: If someone login through the Symfony app the Authservice can't get it, and if someone login with Symfony app (FOS User Bundle) the Authservice can't get it. </p>\n\n<p>These are under one domain www.domain.com for Symfony and auth.domain.com for authservice, so somehow they can read each other's session. I know in PHP this is the session.cookie_domain option, but the Authservice is written in Go and I don't know how to solve it in two different language.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 952, "user_id": 2279220, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/584bfde854b0688008bca83790f5b131?s=128&d=identicon&r=PG", "display_name": "Tomas", "link": "https://stackoverflow.com/users/2279220/tomas"}, "edited": false, "score": 0, "creation_date": 1491834070, "post_id": 43325450, "comment_id": 73715667, "body": "The DTO unmarshaling is done by a package I use and it&#39;s the same for all received messages. In my application I receive an already unmarshalled DTO"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 952, "user_id": 2279220, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/584bfde854b0688008bca83790f5b131?s=128&d=identicon&r=PG", "display_name": "Tomas", "link": "https://stackoverflow.com/users/2279220/tomas"}, "edited": false, "score": 0, "creation_date": 1491834208, "post_id": 43325450, "comment_id": 73715782, "body": "And you don&#39;t have the ability to modify this package? is it 3rd party?"}, {"owner": {"reputation": 952, "user_id": 2279220, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/584bfde854b0688008bca83790f5b131?s=128&d=identicon&r=PG", "display_name": "Tomas", "link": "https://stackoverflow.com/users/2279220/tomas"}, "edited": false, "score": 0, "creation_date": 1491834373, "post_id": 43325450, "comment_id": 73715916, "body": "I can modify it, but since it&#39;s a general purpose package at the time i unmarshal the DTO i don&#39;t know the type of struct it carries in it&#39;s data field"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 952, "user_id": 2279220, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/584bfde854b0688008bca83790f5b131?s=128&d=identicon&r=PG", "display_name": "Tomas", "link": "https://stackoverflow.com/users/2279220/tomas"}, "edited": false, "score": 0, "creation_date": 1491835262, "post_id": 43325450, "comment_id": 73716590, "body": "See updated answer. Btw to keep it general purpose you can keep the <code>Data</code> field type as <code>interface{}</code> and all you need to do is to pre-initialize the value to a type that you expect back. This does not make it less general. You can pass the initialized value to a func in your package if you don&#39;t want to pre-initialize the DTO as well.. For example <code>mypackage.UnmarshalDTO(byteData []byte, data interface{}) ...</code> then in that func set data to the Data field and after unmarshal is done your data var will unmarshaled correctly."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 952, "user_id": 2279220, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/584bfde854b0688008bca83790f5b131?s=128&d=identicon&r=PG", "display_name": "Tomas", "link": "https://stackoverflow.com/users/2279220/tomas"}, "edited": false, "score": 0, "creation_date": 1491838113, "post_id": 43325450, "comment_id": 73718667, "body": "@Tomas <a href=\"https://play.golang.org/p/d890frusL4\" rel=\"nofollow noreferrer\">here</a>&#39;s an example where the <code>mypackageGetDTOFromSomewhere</code> func does not need to know the type of the <code>Data</code> field, only the caller of that func needs to know the type."}, {"owner": {"reputation": 952, "user_id": 2279220, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/584bfde854b0688008bca83790f5b131?s=128&d=identicon&r=PG", "display_name": "Tomas", "link": "https://stackoverflow.com/users/2279220/tomas"}, "edited": false, "score": 0, "creation_date": 1491847333, "post_id": 43325450, "comment_id": 73724199, "body": "I also like the setting of pre-initialized value approach more and I guess i&#39;ll implement it to the library i&#39;m using - <a href=\"https://github.com/esticade/esticade.go\" rel=\"nofollow noreferrer\">Esticade</a> Thanks"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 20, "last_activity_date": 1491834724, "last_edit_date": 1491834724, "creation_date": 1491833311, "answer_id": 43325450, "question_id": 43325288, "link": "https://stackoverflow.com/questions/43325288/golang-convert-interface-to-struct/43325450#43325450", "title": "Golang convert interface{} to struct", "body": "<p>Before unmarshaling the DTO, set the <code>Data</code> field to the type you expect.</p>\n\n<pre><code>type Customer struct {\n    Name string `json:\"name\"`\n}\n\ntype UniversalDTO struct {\n    Data interface{} `json:\"data\"`\n    // more fields with important meta-data about the message...\n}\n\nfunc main() {\n    // create a customer, add it to DTO object and marshal it\n    customer := Customer{Name: \"Ben\"}\n    dtoToSend := UniversalDTO{customer}\n    byteData, _ := json.Marshal(dtoToSend)\n\n    // unmarshal it (usually after receiving bytes from somewhere)\n    receivedCustomer := &amp;Customer{}\n    receivedDTO := UniversalDTO{Data: receivedCustomer}\n    json.Unmarshal(byteData, &amp;receivedDTO)\n\n    //done\n    fmt.Println(receivedCustomer)\n}\n</code></pre>\n\n<p>If you don't have the ability to initialize the <code>Data</code> field on the DTO before it's unmarshaled, you can use type assertion after the unmarshaling. Package <code>encoding/json</code> unamrshals <code>interface{}</code> type values into a <code>map[string]interface{}</code>, so your code would look something like this:</p>\n\n<pre><code>type Customer struct {\n    Name string `json:\"name\"`\n}\n\ntype UniversalDTO struct {\n    Data interface{} `json:\"data\"`\n    // more fields with important meta-data about the message...\n}\n\nfunc main() {\n    // create a customer, add it to DTO object and marshal it\n    customer := Customer{Name: \"Ben\"}\n    dtoToSend := UniversalDTO{customer}\n    byteData, _ := json.Marshal(dtoToSend)\n\n    // unmarshal it (usually after receiving bytes from somewhere)\n    receivedDTO := UniversalDTO{}\n    json.Unmarshal(byteData, &amp;receivedDTO)\n\n    //Attempt to unmarshall our customer\n    receivedCustomer := getCustomerFromDTO(receivedDTO.Data)\n    fmt.Println(receivedCustomer)\n}\n\nfunc getCustomerFromDTO(data interface{}) Customer {\n    m := data.(map[string]interface{})\n    customer := Customer{}\n    if name, ok := m[\"name\"].(string); ok {\n        customer.Name = name\n    }\n    return customer\n}\n</code></pre>\n"}], "owner": {"reputation": 952, "user_id": 2279220, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/584bfde854b0688008bca83790f5b131?s=128&d=identicon&r=PG", "display_name": "Tomas", "link": "https://stackoverflow.com/users/2279220/tomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37840, "favorite_count": 7, "accepted_answer_id": 43325450, "answer_count": 1, "score": 15, "last_activity_date": 1495445923, "creation_date": 1491832858, "question_id": 43325288, "link": "https://stackoverflow.com/questions/43325288/golang-convert-interface-to-struct", "title": "Golang convert interface{} to struct", "body": "<p>I want to improve the getCustomerFromDTO method in the code below, I need to create a struct from an interface{} and currently i need to marshall that interface to byte[] and then unmarshal the array to my struct - there must be a better way.</p>\n\n<p>My use case is that I send structs via rabbitmq and to send them I use this general DTO wrapper that has additional domain specific data about them. \nWhen I receive the DTO from rabbit mq one layer below the message is unmarshaled to my DTO and then i need to get my struct from that DTO.</p>\n\n<pre><code>type Customer struct {\n    Name string `json:\"name\"`\n}\n\ntype UniversalDTO struct {\n    Data interface{} `json:\"data\"`\n    // more fields with important meta-data about the message...\n}\n\nfunc main() {\n    // create a customer, add it to DTO object and marshal it\n    customer := Customer{Name: \"Ben\"}\n    dtoToSend := UniversalDTO{customer}\n    byteData, _ := json.Marshal(dtoToSend)\n\n    // unmarshal it (usually after receiving bytes from somewhere)\n    receivedDTO := UniversalDTO{}\n    json.Unmarshal(byteData, &amp;receivedDTO)\n\n    //Attempt to unmarshall our customer\n    receivedCustomer := getCustomerFromDTO(receivedDTO.Data)\n    fmt.Println(receivedCustomer)\n}\n\nfunc getCustomerFromDTO(data interface{}) Customer {\n    customer := Customer{}\n    bodyBytes, _ := json.Marshal(data)\n    json.Unmarshal(bodyBytes, &amp;customer)\n    return customer\n}\n</code></pre>\n"}, {"tags": ["go", "gopath"], "comments": [{"owner": {"reputation": 753, "user_id": 5735646, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1DDfK.jpg?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/5735646/nick"}, "edited": false, "score": 0, "creation_date": 1491832365, "post_id": 43325013, "comment_id": 73714321, "body": "Have you installed protobuf? Type <code>go get -u github.com&#47;golang&#47;protobuf&#47;{proto,protoc-gen-go}</code> to install !"}, {"owner": {"reputation": 221, "user_id": 7845274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa08ae835b344b64eebf1a7512cd7ce?s=128&d=identicon&r=PG&f=1", "display_name": "Mantas", "link": "https://stackoverflow.com/users/7845274/mantas"}, "reply_to_user": {"reputation": 753, "user_id": 5735646, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1DDfK.jpg?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/5735646/nick"}, "edited": false, "score": 0, "creation_date": 1491845181, "post_id": 43325013, "comment_id": 73722994, "body": "Same error if i try to use that command"}, {"owner": {"reputation": 753, "user_id": 5735646, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1DDfK.jpg?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/5735646/nick"}, "edited": false, "score": 0, "creation_date": 1491882365, "post_id": 43325013, "comment_id": 73736580, "body": "Same error?When <code>go install</code> or when <code>go build</code> after <code>go install</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 753, "user_id": 5735646, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1DDfK.jpg?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/5735646/nick"}, "edited": false, "score": 0, "creation_date": 1491832654, "post_id": 43325167, "comment_id": 73714552, "body": "Maybe you have installed <code>protoc</code>,protoc is the compiler for <code>.proto</code> files, not golang packages i f you want to use protobuf package, install it using <code>go get</code> from <code>Github</code>!"}], "tags": [], "owner": {"reputation": 753, "user_id": 5735646, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1DDfK.jpg?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/5735646/nick"}, "is_accepted": false, "score": 3, "last_activity_date": 1491832518, "creation_date": 1491832518, "answer_id": 43325167, "question_id": 43325013, "link": "https://stackoverflow.com/questions/43325013/cant-find-package-from-goroot-and-gopath/43325167#43325167", "title": "Cant find package from $GOROOT and $GOPATH", "body": "<p>As the official document says: </p>\n\n<blockquote>\n  <p>The simplest way is to run <code>go get -u github.com/golang/protobuf/{proto,protoc-gen-go}</code>.</p>\n</blockquote>\n\n<p>See full introduction here :<a href=\"https://github.com/golang/protobuf#installation\" rel=\"nofollow noreferrer\">golang/protobuf installation</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 300, "user_id": 2068742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531732e06128a2c69f720d9abefbc464?s=128&d=identicon&r=PG", "display_name": "AvnishSingh", "link": "https://stackoverflow.com/users/2068742/avnishsingh"}, "is_accepted": false, "score": 7, "last_activity_date": 1492229750, "creation_date": 1492229750, "answer_id": 43422137, "question_id": 43325013, "link": "https://stackoverflow.com/questions/43325013/cant-find-package-from-goroot-and-gopath/43422137#43422137", "title": "Cant find package from $GOROOT and $GOPATH", "body": "<p>All the packages imported are looked in under GOROOT and GOPATH environment variables first. Make sure your package is somewhere under these directories. </p>\n\n<p>Now Suppose <strong>GOPATH</strong> is set to : /Users/test/Desktop/GoProject</p>\n\n<p>and <em>GOROOT</em> : /usr/local/go (where go is installed)\n. If a file in your GoProject has a package imported as</p>\n\n<pre><code>import \"abc/def/packageName\"\n</code></pre>\n\n<p>then it should be present at any of the below two places:</p>\n\n<p><strong>/Users/test/Desktop/GoProject</strong>/src/abc/def/packageName/*\n<em>/usr/local/go</em>/src/abc/def/packageName/*</p>\n\n<p>If not, you will get error as reported in the question.</p>\n\n<p>The files inside these directories will have the first line as </p>\n\n<pre><code>package packageName\n</code></pre>\n\n<p>stating that all these files constitutes a package <strong>packageName</strong></p>\n"}, {"comments": [{"owner": {"reputation": 366, "user_id": 1014060, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/48e59feeb5f9444b6906587021188bed?s=128&d=identicon&r=PG", "display_name": "Nicola", "link": "https://stackoverflow.com/users/1014060/nicola"}, "edited": false, "score": 0, "creation_date": 1587053757, "post_id": 61254967, "comment_id": 108364495, "body": "With Ubuntu 18.04.4 LTS, I followed <a href=\"https://tecadmin.net/install-go-on-ubuntu/\" rel=\"nofollow noreferrer\">these steps</a> and the problem vanished."}], "tags": [], "owner": {"reputation": 366, "user_id": 1014060, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/48e59feeb5f9444b6906587021188bed?s=128&d=identicon&r=PG", "display_name": "Nicola", "link": "https://stackoverflow.com/users/1014060/nicola"}, "is_accepted": false, "score": 0, "last_activity_date": 1587053742, "creation_date": 1587053742, "answer_id": 61254967, "question_id": 43325013, "link": "https://stackoverflow.com/questions/43325013/cant-find-package-from-goroot-and-gopath/61254967#61254967", "title": "Cant find package from $GOROOT and $GOPATH", "body": "<p>Make sure to have a version of go <code>1.11+</code>.</p>\n\n<p>Older versions do not support modules, thus they fail to download what's needed leading to the <code>Can't find package from $GOROOT and $GOPATH</code> problem.</p>\n"}], "owner": {"reputation": 221, "user_id": 7845274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa08ae835b344b64eebf1a7512cd7ce?s=128&d=identicon&r=PG&f=1", "display_name": "Mantas", "link": "https://stackoverflow.com/users/7845274/mantas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32687, "favorite_count": 2, "answer_count": 3, "score": 22, "last_activity_date": 1587053742, "creation_date": 1491832138, "last_edit_date": 1501061081, "question_id": 43325013, "link": "https://stackoverflow.com/questions/43325013/cant-find-package-from-goroot-and-gopath", "title": "Cant find package from $GOROOT and $GOPATH", "body": "<p>Small part of error I'm getting after trying to run go build command</p>\n\n<pre><code>go build ./...\ntrillian.pb.go:7:8: cannot find package \"github.com/golang/protobuf/proto\" in any of:\n    /usr/local/go/src/github.com/golang/protobuf/proto (from $GOROOT)\n    /Projects/Proj1/trillian/src/github.com/golang/protobuf/proto (from $GOPATH)\n\ntrillian.pb.go:11:8: cannot find package \"github.com/golang/protobuf/ptypes/any\" in any of:\n    /usr/local/go/src/github.com/golang/protobuf/ptypes/any (from $GOROOT)\n    /Projects/Proj1/trillian/src/github.com/golang/protobuf/ptypes/any (from $GOPATH)\n\ntrillian_admin_api.pb.go:12:8: cannot find package \"github.com/golang/protobuf/ptypes/empty\" in any of:\n    /usr/local/go/src/github.com/golang/protobuf/ptypes/empty (from $GOROOT)\n    /Projects/Proj1/trillian/src/github.com/golang/protobuf/ptypes/empty (from $GOPATH)\n\ntrillian.pb.go:10:8: cannot find package \"github.com/google/trillian/crypto/sigpb\" in any of:\n    /usr/local/go/src/github.com/google/trillian/crypto/sigpb (from $GOROOT)\n    /Projects/Proj1/trillian/src/github.com/google/trillian/crypto/sigpb (from $GOPATH)\n\ntrillian_admin_api.pb.gw.go:17:2: cannot find package \"github.com/grpc-ecosystem/grpc-gateway/runtime\" in any of:\n    /usr/local/go/src/github.com/grpc-ecosystem/grpc-gateway/runtime (from  $GOROOT)\n    /Projects/Proj1/trillian/src/github.com/grpc-ecosystem/grpc-gateway/runtime (from $GOPATH)\n\ntrillian_admin_api.pb.gw.go:18:2: cannot find package \"github.com/grpc-ecosystem/grpc-gateway/utilities\" in any of:\n    /usr/local/go/src/github.com/grpc-ecosystem/grpc-gateway/utilities (from $GOROOT)\n    /Projects/Proj1/trillian/src/github.com/grpc-ecosystem/grpc-gateway/utilities (from $GOPATH)\n\ntrillian_admin_api.pb.go:15:2: cannot find package \"golang.org/x/net/context\" in any of:\n    /usr/local/go/src/golang.org/x/net/context (from $GOROOT)\n    /Projects/Proj1/trillian/src/golang.org/x/net/context (from $GOPATH)\n\ntrillian_admin_api.pb.go:10:8: cannot find package \"google.golang.org/genproto/googleapis/api/annotations\" in any of:\n    /usr/local/go/src/google.golang.org/genproto/googleapis/api/annotations (from $GOROOT)\n    /Projects/Proj1/trillian/src/google.golang.org/genproto/googleapis/api/annotations (from $GOPATH)\n\ntrillian_log_api.pb.go:65:8: cannot find package \"google.golang.org/genproto/googleapis/rpc/status\" in any of:\n    /usr/local/go/src/google.golang.org/genproto/googleapis/rpc/status (from $GOROOT)\n    /Projects/Proj1/trillian/src/google.golang.org/genproto/googleapis/rpc/status (from $GOPATH)\n\ntrillian_admin_api.pb.go:11:8: cannot find package \"google.golang.org/genproto/protobuf/field_mask\" in any of:\n    /usr/local/go/src/google.golang.org/genproto/protobuf/field_mask (from $GOROOT)\n    /Projects/Proj1/trillian/src/google.golang.org/genproto/protobuf/field_mask (from $GOPATH)\n</code></pre>\n\n<p>Go env output</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/Projects/Proj1/trillian\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build690359699=/tmp/go-build -gno-record-gcc-switches\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p><code>GOPATH</code> and <code>GOROOT</code> are set but still can't run the command without errors. Tried installing to home and custom directories changing gopath and goroot regardless but still no luck. Any suggestions how to solve this?</p>\n"}, {"tags": ["go", "encoding", "gob"], "answers": [{"tags": [], "owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "is_accepted": false, "score": 1, "last_activity_date": 1491834731, "creation_date": 1491834731, "answer_id": 43325953, "question_id": 43324919, "link": "https://stackoverflow.com/questions/43324919/gob-panics-decoding-an-interface/43325953#43325953", "title": "gob panics decoding an interface", "body": "<p>In your case, you need to define what is the \"layout\" of memory you're expecting the decode dumps into your interface value. When you declare</p>\n\n<pre><code>var v Incer\n</code></pre>\n\n<p>You're not giving any clue to the decoder about how the decoding must be done. if you say to the decoder you're expecting to decode an main.A struct, it can use the methods <strong>(*A).GobEncode()</strong> and <strong>(*A).GobDecode()</strong> you defined:</p>\n\n<pre><code>var v Incer\nv = &amp;A{}\n</code></pre>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/WUNRKGTVIS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/WUNRKGTVIS</a></p>\n\n<p>This is the <a href=\"https://play.golang.org/p/4DvCOpV2Rt\" rel=\"nofollow noreferrer\">example</a> provided in the <a href=\"https://godoc.org/encoding/gob\" rel=\"nofollow noreferrer\">gob documentation</a></p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1491890890, "last_edit_date": 1491890890, "creation_date": 1491835367, "answer_id": 43326188, "question_id": 43324919, "link": "https://stackoverflow.com/questions/43324919/gob-panics-decoding-an-interface/43326188#43326188", "title": "gob panics decoding an interface", "body": "<p>The problem lies in the fact that the <code>Incer</code> interface implements a special interface, special to the <code>encoding/gob</code> package: <code>gob.GobDecoder</code>.</p>\n\n<p>If your <code>Incer</code> interface only contains the <code>Inc()</code> method, it will work because the gob decoder sees you're decoding into an interface type, and it will use the transmitted type to decode the value and check at runtime if the decoded value (whose type is included and transmitted in the stream) implements the destination interface type, and in this case it will:</p>\n\n<pre><code>type Incer interface {\n    Inc()\n}\n</code></pre>\n\n<p>So decoding succeeds.</p>\n\n<p>If the <code>Incer</code> interface also embeds the <code>gob.GobEncoder</code> and <code>gob.GobDecoder</code> interfaces, they are \u2013by definition\u2013 responsible to do the coding / decoding. If a type implements these interfaces, the decoder will not attempt to decode the value using the transmitted type, but will instead call <code>GobDecode()</code> method of the destination value, creating a zero value if needed.</p>\n\n<p>Since you pass a <code>nil</code> value to <code>Decoder.Decode()</code>, the decoder needs to create a zero-value, but it doesn't know what type to instantiate, because the value you pass is a pointer to interface. You cannot create a value of interface type, only a value of a <em>concrete</em> type that may satisfy certain interfaces.</p>\n\n<p>You can't include <code>gob.GobEncoder</code> and <code>gob.GobDecoder</code> in your <code>Incer</code> interface. I know you want to make sure the implementations do implement them, but then \u2013as you can see\u2013 you won't be able to decode them into a \"general\" <code>Incer</code> interface value. Also I don't even see the need to include them in <code>Incer</code>: <code>gob.GobEncoder</code> and <code>gob.GobDecoder</code> are not the only ways to make them transmittable, there are also <a href=\"https://golang.org/pkg/encoding/#BinaryMarshaler\" rel=\"nofollow noreferrer\"><code>encoding.BinaryMarshaler</code></a> and <a href=\"https://golang.org/pkg/encoding/#BinaryUnmarshaler\" rel=\"nofollow noreferrer\"><code>encoding.BinaryUnmarshaler</code></a> that are checked by the <code>encoding/gob</code> package.</p>\n"}], "owner": {"reputation": 43, "user_id": 7845130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e127f1a05985059f9ea3185feccca45f?s=128&d=identicon&r=PG&f=1", "display_name": "yalegko", "link": "https://stackoverflow.com/users/7845130/yalegko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 1, "accepted_answer_id": 43326188, "answer_count": 2, "score": 4, "last_activity_date": 1491890890, "creation_date": 1491831869, "question_id": 43324919, "link": "https://stackoverflow.com/questions/43324919/gob-panics-decoding-an-interface", "title": "gob panics decoding an interface", "body": "<p>I have a struct with unexported fields which should be gob encoded and decoded.</p>\n\n<p>Say:</p>\n\n<pre><code>type A struct {\n    s int\n}\nfunc (a *A) Inc() {\n    a.s++\n}\n</code></pre>\n\n<p>Obviously in that case I need to implement <code>gob.GobEncoder</code> and <code>gob.GobDecoder</code> interfaces. And <strong>if I use the struct directly everything works fine</strong>:</p>\n\n<p><a href=\"https://play.golang.org/p/dm3HwaI8eU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/dm3HwaI8eU</a></p>\n\n<p>But I also need to have an interface that implements same logic and is serializable:</p>\n\n<pre><code>type Incer interface {\n    gob.GobEncoder\n    gob.GobDecoder\n    Inc()\n}\n</code></pre>\n\n<p>Full code: <a href=\"https://play.golang.org/p/Zig2mPrnrq\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Zig2mPrnrq</a></p>\n\n<p>And suddenly it panics:</p>\n\n<pre><code>panic: interface conversion: interface is nil, not gob.GobDecoder [recovered]\n    panic: interface conversion: interface is nil, not gob.GobDecoder\n</code></pre>\n\n<p><strong>But if I comment gob interfaces out everything become fine again.</strong></p>\n\n<p>Am I missing something important? Cos the described behavior seems quite strange to me </p>\n"}, {"tags": ["string", "go", "utf-8"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1491832878, "last_edit_date": 1491832878, "creation_date": 1491832554, "answer_id": 43325180, "question_id": 43324908, "link": "https://stackoverflow.com/questions/43324908/string-prefix-of-requested-length-in-golang-working-with-utf-8-symbols/43325180#43325180", "title": "String prefix of requested length in golang working with utf-8 symbols", "body": "<p>The problem is that slicing a <code>string</code> slices the UTF-8 encoded byte slice that represents the string, not the characters or <code>rune</code>s of the <code>string</code>; this also means that if the <code>string</code> contains characters that are represented by multiple bytes in UTF-8 encoding, slicing / cutting the <code>string</code> may result in an invalid UTF-8 encoded sequence.</p>\n\n<p>Assuming <code>cropLength</code> means to be a character limit (and not a byte-count limit), you should first convert the <code>string</code> to a <code>[]rune</code>, and operate on that:</p>\n\n<pre><code>func prettyCrop(in string, cropLength int) string {\n    in2 := []rune(in)\n    if len(in2) &lt; cropLength {\n        return in\n    } else {\n        in2 = in2[:cropLength]\n        in = strings.TrimRightFunc(string(in2), func(r rune) bool {\n            if r == ' ' {\n                return true\n            }\n            return false\n        })\n        return in + \"\u2026\"\n    }\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>for i := 0; i &lt; 7; i++ {\n    fmt.Println(prettyCrop(\"\u010d\u0159\u010d \u010d\u0159\u010d\", i))\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/tjgFuWndKg\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>\u2026\n\u010d\u2026\n\u010d\u0159\u2026\n\u010d\u0159\u010d\u2026\n\u010d\u0159\u010d\u2026\n\u010d\u0159\u010d \u010d\u2026\n\u010d\u0159\u010d \u010d\u0159\u2026\n</code></pre>\n\n<p><strong>Performance notes:</strong></p>\n\n<p>The above example is not \"performance\" friendly, because:</p>\n\n<ul>\n<li>It converts the whole <code>in</code> string to <code>[]rune</code>, it would be enough to just get its first <code>cropLength</code> runes with a <code>for range</code>.</li>\n<li>Calling <code>strings.TrimRightFunc()</code> requires to convert the <code>[]rune</code> back to <code>string</code>, and then again a string concatenation is performed to generate the result. This could be avoided by manually looping over the <code>[]rune</code>, and only create a single <code>string</code> that is returned.</li>\n</ul>\n"}], "owner": {"reputation": 2762, "user_id": 357937, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cec99ad76b136c8e5c8002370499365e?s=128&d=identicon&r=PG", "display_name": "Ondra", "link": "https://stackoverflow.com/users/357937/ondra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 43325180, "answer_count": 1, "score": 2, "last_activity_date": 1491832878, "creation_date": 1491831841, "question_id": 43324908, "link": "https://stackoverflow.com/questions/43324908/string-prefix-of-requested-length-in-golang-working-with-utf-8-symbols", "title": "String prefix of requested length in golang working with utf-8 symbols", "body": "<p>Is there some elegant way to crop string and create pretty string prefixes in golang? I have this function for start:</p>\n\n<pre><code>func prettyCrop(in string, cropLength int) string {\n    if len(in) &lt; cropLength {\n        return in\n    } else {\n        in = in[0:cropLength]\n        in = strings.TrimRightFunc(in, func(r rune) bool {\n            if r == ' ' {\n                return true\n            }\n            return false\n        })\n        return in + \"\u2026\"\n    }\n}\n</code></pre>\n\n<p>It works good enough for english texts, but has problems with something more complicated. See this example:</p>\n\n<pre><code>prettyCrop(\"\u010d\u0159\u010d \u010d\u0159\u010d\", 8) //\u010d\u0159?\u2026\n</code></pre>\n\n<p>TrimRightFunc is not working as I expect here. I expect it to return <code>\u010d\u0159\u010d</code>. Why is this function not returning valid utf-8 string? Is there a library for this? How can I fix it? Is there a better solution?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1491831498, "post_id": 43323986, "comment_id": 73713626, "body": "What are you expecting? <code>fmt.</code> is simply invalid syntax, there&#39;s nothing the compiler can do with that. It&#39;s an illegal statement. The end. If you want to see whatever is in the <code>fmt</code> package, look at the source code (it&#39;s open). Because you mention IDE integration: any IDE will autocomplete <code>fmt.</code> anyway"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1491832785, "post_id": 43323986, "comment_id": 73714657, "body": "He is not trying to compile this code, but to use gocode to obtain autocomplete suggestions. And any IDE will autocomplete because many of them use gocode."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1491833341, "post_id": 43323986, "comment_id": 73715143, "body": "@Zoyd: In which case, either use existing plugins, or read the manual I&#39;d say: <a href=\"https://github.com/nsf/gocode\" rel=\"nofollow noreferrer\">github.com/nsf/gocode</a>. However, if you&#39;re using vim, I&#39;d go for <i>fatih/vim-go</i> and either YCM or neocomplete. Either one works"}, {"owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1491842898, "post_id": 43323986, "comment_id": 73721778, "body": "@Elias Van Ootegem  As  Zoyd pointed out, I am trying to manually get autocomplete tips from gocode. I for sure know about plugins that make use of this tool, however I have reasons to solve the task in question (those reasons are out of scope of the discussion).  Another thing I am wondering about is why gocode reports listed errors (they&#39;re reported even with <code>fmt.</code> being removed and I didn&#39;t think gocode would expect the valid code as when a user requests autocompletion  their code is often not complete/valid)"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 1, "creation_date": 1491892660, "post_id": 43323986, "comment_id": 73740115, "body": "For this kind of stuff, I always look at the source of either <code>vim-go</code> or Atom&#39;s <code>go-plus</code> as they have already done the heavy lifting in parsing the parameters to send, and parsing the output of the tools."}], "owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491829537, "creation_date": 1491829537, "last_edit_date": 1592644375, "question_id": 43323986, "link": "https://stackoverflow.com/questions/43323986/cannot-get-gocode-to-work", "title": "Cannot get gocode to work", "body": "<p>Hi I was try trying play around with gocode tool but since it has poor documentation I cannot figure out how it works. I've read</p>\n<p><a href=\"https://github.com/nsf/gocode/blob/master/docs/IDE_integration.md\" rel=\"nofollow noreferrer\">https://github.com/nsf/gocode/blob/master/docs/IDE_integration.md</a></p>\n<p>I created a simple test file (path is <code>d:\\papa\\papa.go</code>):</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\nfunc main() {\n    fmt.\n}\n</code></pre>\n<p>It seems obvious that I want to get compilation for the <code>fmt.</code> part (to see functions and everything else exported from that package. Now I run</p>\n<pre><code>gocode -s -debug\n</code></pre>\n<p>And than</p>\n<pre><code>gocode -in=d:/papa/main.go -f=nice autocomplete 51\n</code></pre>\n<p>Here is gocode's output:</p>\n<pre><code>Found 2 candidates:\n  func main()\n  package fmt\n</code></pre>\n<p>It is not what I'd expect as you can see.</p>\n<p>In the debug output I seen something interesting:</p>\n<blockquote>\n<p>2017/04/10 15:58:15 Go project path: .</p>\n<p>2017/04/10 15:58:15 Got autocompletion request for 'd:/papa/main.go'</p>\n<p>2017/04/10 15:58:15 Cursor at: 51</p>\n<p>2017/04/10 15:58:15</p>\n</blockquote>\n<hr />\n<blockquote>\n<p>package main</p>\n<p>import (</p>\n<pre><code>    &quot;fmt&quot;\n</code></pre>\n<p>)</p>\n<p># func main() {</p>\n<pre><code>    fmt.\n</code></pre>\n<p>}</p>\n</blockquote>\n<hr />\n<blockquote>\n<p>2017/04/10 15:58:15 Found &quot;fmt&quot; at &quot;D:\\Go\\pkg\\windows_386\\fmt.a&quot;</p>\n<p>2017/04/10 15:58:15 Error parsing input file (inner block):</p>\n<p>2017/04/10 15:58:15  4:1: expected selector or type assertion, found '}'</p>\n<p>2017/04/10 15:58:15  4:2: expected ';', found 'EOF'</p>\n<p>2017/04/10 15:58:15  4:2: expected '}', found 'EOF'</p>\n<p>2017/04/10 15:58:15 Offset: 0</p>\n<p>2017/04/10 15:58:15 Number of candidates found: 2</p>\n<p>2017/04/10 15:58:15 Candidates are:</p>\n<p>2017/04/10 15:58:15   func main()</p>\n<p>2017/04/10 15:58:15   package fmt</p>\n</blockquote>\n<p>Needless to say there is no actual error during go build on this code.</p>\n<p>So</p>\n<ol>\n<li><p>Why gocode doesn't provide with the relevant info?</p>\n</li>\n<li><p>What is the deal about those &quot;errors&quot;)?</p>\n</li>\n</ol>\n"}, {"tags": ["go", "httprequest", "settimeout", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 447, "user_id": 3116634, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ATBrw.jpg?s=128&g=1", "display_name": "Avinash", "link": "https://stackoverflow.com/users/3116634/avinash"}, "edited": false, "score": 0, "creation_date": 1491833682, "post_id": 43322359, "comment_id": 73715385, "body": "Thanks for the answer. It works as expected. But we have reverse_proxy for request processing as well. Could you please update answer for a reverse proxy with context as well?"}, {"owner": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "reply_to_user": {"reputation": 447, "user_id": 3116634, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ATBrw.jpg?s=128&g=1", "display_name": "Avinash", "link": "https://stackoverflow.com/users/3116634/avinash"}, "edited": false, "score": 0, "creation_date": 1491894277, "post_id": 43322359, "comment_id": 73741021, "body": "You should try and implement it yourself. This way you might understand what&#39;s happening. If you fail then you come to stack overflow. We are not here to do your work. We are here to help you do your work :D"}, {"owner": {"reputation": 447, "user_id": 3116634, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ATBrw.jpg?s=128&g=1", "display_name": "Avinash", "link": "https://stackoverflow.com/users/3116634/avinash"}, "edited": false, "score": 1, "creation_date": 1491895990, "post_id": 43322359, "comment_id": 73742056, "body": "Ha ha, I&#39;ve implemented those tasks anyways. Thanks for go internal clarification."}], "tags": [], "owner": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "is_accepted": true, "score": 20, "last_activity_date": 1600856022, "last_edit_date": 1600856022, "creation_date": 1491824873, "answer_id": 43322359, "question_id": 43321894, "link": "https://stackoverflow.com/questions/43321894/context-timeout-implementation-on-every-request-using-golang/43322359#43322359", "title": "Context timeout implementation on every request using golang", "body": "<p>What happens in your code is very correct and behaves as expected.</p>\n<p>You create a context with <code>5 seconds</code> timeout. You pass it to the <code>request</code> and make that request. Let's say that request returns in 2 seconds. You then do a <code>select</code> and either wait 10 seconds or wait for the context to finish. Context will always finish in the initial 5 seconds from when it was created and will also give that error every time it reaches the end.</p>\n<p>The <code>context</code> is independent of the request and it will reach its deadline unless cancelled previously. You cancel the request when the function finishes using <code>defer</code>.</p>\n<p>In your code the request takes your timeout in consideration. But the <code>ctx.Err()</code> will return <code>deadline exceeded</code> every time it reaches the timeout. Since that's what happens inside the <code>context</code>. calling ctx.Err() multiple times will return the same error.</p>\n<pre><code>ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)\ndefer cancel()\n\ngo func () {\n    select {\n    case &lt;-time.After(10 * time.Second):\n        fmt.Println(&quot;overslept&quot;)\n    case &lt;-ctx.Done():\n        fmt.Println(ctx.Err()) // prints &quot;context deadline exceeded&quot;\n    }\n}()\nreq, _ := http.NewRequest(&quot;GET&quot;, authorizationServer, nil)\nreq.Header = r.Header\nreq = req.WithContext(ctx)\nres, error := client.Do(req)\n</code></pre>\n<p>From the context documentation:</p>\n<pre><code>// Err returns a non-nil error value after Done is closed. Err returns\n// Canceled if the context was canceled or DeadlineExceeded if the\n// context's deadline passed. No other values for Err are defined.\n// After Done is closed, successive calls to Err return the same value.\n</code></pre>\n<p>In your code, the timeout will always be reached and not cancelled, that is why you receive <code>DeadlineExceeeded</code>. Your code is correct except the select part which will block until either 10 seconds pass or context timeout is reached. In your case always the context timeout is reached.</p>\n<p>You should check the <code>error</code> returned by the <code>client.Do</code> call and not worry about the <code>context</code> error in here. You are the one controlling the context. If the request times out, a case you should test of course, then a proper error would be returned for you to verify.</p>\n"}], "owner": {"reputation": 447, "user_id": 3116634, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ATBrw.jpg?s=128&g=1", "display_name": "Avinash", "link": "https://stackoverflow.com/users/3116634/avinash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23899, "favorite_count": 10, "accepted_answer_id": 43322359, "answer_count": 1, "score": 13, "last_activity_date": 1600856022, "creation_date": 1491823398, "last_edit_date": 1591205456, "question_id": 43321894, "link": "https://stackoverflow.com/questions/43321894/context-timeout-implementation-on-every-request-using-golang", "title": "Context timeout implementation on every request using golang", "body": "<p>I am trying to handle a context timeout for every request. We have the following server structures:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lfoTf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lfoTf.png\" alt=\"enter image description here\"></a></p>\n\n<p>Flow overview: </p>\n\n<p><strong>Go Server</strong>: Basically, acts as a [Reverse-proxy].<a href=\"https://en.wikipedia.org/wiki/Reverse_proxy\" rel=\"nofollow noreferrer\">2</a></p>\n\n<p><strong>Auth Server</strong>: Check for requests Authentication.</p>\n\n<p><strong>Application Server</strong>: Core request processing logic.</p>\n\n<p>Now if Authorization server isn't able to process a request in stipulated time, then I want to close the goroutine from memory.</p>\n\n<p>Here is what I tried:</p>\n\n<pre><code>ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)\ndefer cancel()\nreq, _ := http.NewRequest(\"GET\", authorizationServer, nil)\nreq.Header = r.Header\nreq.WithContext(ctx)\nres, error := client.Do(req)\nselect {\ncase &lt;-time.After(10 * time.Second):\n    fmt.Println(\"overslept\")\ncase &lt;-ctx.Done():\n    fmt.Println(ctx.Err()) // prints \"context deadline exceeded\"\n}\n</code></pre>\n\n<p>Over here, context returns as \"<strong>deadline exceeded</strong>\", if the request is not processed in stipulated time. But it continues to process that request and return response in more than the specified time. So, how can I stop the request flow (goroutine), when time is exceeded.</p>\n\n<p>I've also the complete request needs to be processed in 60 seconds with this code:</p>\n\n<pre><code>var netTransport = &amp;http.Transport{\n    Dial: (&amp;net.Dialer{\n        Timeout: 60 * time.Second,\n    }).Dial,\n    TLSHandshakeTimeout: 60 * time.Second,\n}\nclient := &amp;http.Client{\n    Timeout:   time.Second * 60,\n    Transport: netTransport,\n    CheckRedirect: func(req *http.Request, via []*http.Request) error {\n        return http.ErrUseLastResponse\n    },\n}\n</code></pre>\n\n<p>So do I need any separate context implementations as well?</p>\n\n<p><strong>Note1</strong>: It would be awesome, if we can manage the timeout on every requests (goroutine) created by HTTP server, using context.</p>\n"}, {"tags": ["go", "docker-compose", "blockchain", "hyperledger"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7592706, "user_type": "registered", "profile_image": "https://graph.facebook.com/1266655306747034/picture?type=large", "display_name": "Arun Hossamani", "link": "https://stackoverflow.com/users/7592706/arun-hossamani"}, "edited": false, "score": 0, "creation_date": 1492152938, "post_id": 43395978, "comment_id": 73872966, "body": "thanks for giving the information but would you suggests me how to get a gcc compiler"}], "tags": [], "owner": {"reputation": 256, "user_id": 6771376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640179c9c8875caafd8658e63ee77770?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Tharp", "link": "https://stackoverflow.com/users/6771376/andrew-tharp"}, "is_accepted": false, "score": 0, "last_activity_date": 1492096417, "creation_date": 1492096417, "answer_id": 43395978, "question_id": 43319454, "link": "https://stackoverflow.com/questions/43319454/facing-issues-while-running-chaincode-locally-using-docker/43395978#43395978", "title": "facing issues while running chaincode locally using docker", "body": "<p>My understanding is that the Learn Chaincode example from <a href=\"https://github.com/IBM-Blockchain/learn-chaincode\" rel=\"nofollow noreferrer\">https://github.com/IBM-Blockchain/learn-chaincode</a> was being followed.  Note that this example is for use with Hyperledger Fabric version 0.6.</p>\n\n<p>The message is related to a PKCS11 package that is referenced by the example.  This PKCS package requires a gcc compiler in order to build.  I would suggest obtaining a gcc compiler and then trying to build the example again.</p>\n"}, {"comments": [{"owner": {"reputation": 2483, "user_id": 1910242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/onnXs.jpg?s=128&g=1", "display_name": "knagaev", "link": "https://stackoverflow.com/users/1910242/knagaev"}, "edited": false, "score": 0, "creation_date": 1500932107, "post_id": 44059509, "comment_id": 77543339, "body": "It was mentioned here <a href=\"https://hyperledger-fabric.readthedocs.io/en/latest/chaincode4ade.html#building-chaincode\" rel=\"nofollow noreferrer\">hyperledger-fabric.readthedocs.io/en/latest/&hellip;</a>"}, {"owner": {"reputation": 511, "user_id": 1927119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5950d806d7c18ae9a06104382e44073a?s=128&d=identicon&r=PG", "display_name": "pkmelee337", "link": "https://stackoverflow.com/users/1927119/pkmelee337"}, "edited": false, "score": 0, "creation_date": 1527720901, "post_id": 44059509, "comment_id": 88238566, "body": "Awesome! Thanks! If you use Visual Studio Code as windows editor you can add this to your settings with the following setting: &quot;go.buildTags&quot;: &quot;nopkcs11&quot;"}], "tags": [], "owner": {"reputation": 674, "user_id": 8033903, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/74b10e9498b4fc3c6bd3c258b0612dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Naveen Sachdeva", "link": "https://stackoverflow.com/users/8033903/naveen-sachdeva"}, "is_accepted": false, "score": 3, "last_activity_date": 1495153411, "last_edit_date": 1495153411, "creation_date": 1495152350, "answer_id": 44059509, "question_id": 43319454, "link": "https://stackoverflow.com/questions/43319454/facing-issues-while-running-chaincode-locally-using-docker/44059509#44059509", "title": "facing issues while running chaincode locally using docker", "body": "<p>Looks like the Fabric team introduced \"nopkcs11\" tag to bypass the problem - <a href=\"https://jira.hyperledger.org/browse/FAB-2854\" rel=\"nofollow noreferrer\">https://jira.hyperledger.org/browse/FAB-2854</a></p>\n\n<p>I used the following command to build my chain code:</p>\n\n<pre><code>go build -tags nopkcs11\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7592706, "user_type": "registered", "profile_image": "https://graph.facebook.com/1266655306747034/picture?type=large", "display_name": "Arun Hossamani", "link": "https://stackoverflow.com/users/7592706/arun-hossamani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495153411, "creation_date": 1491816373, "last_edit_date": 1491817156, "question_id": 43319454, "link": "https://stackoverflow.com/questions/43319454/facing-issues-while-running-chaincode-locally-using-docker", "title": "facing issues while running chaincode locally using docker", "body": "<p>i m getting below error while running learn-chaincode example on my local system please provide me the suitable solution for the mentioned error</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ go build\n# github.com/hyperledger/fabric/vendor/github.com/miekg/pkcs11\nexec: \"gcc\": executable file not found in %PATH%\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1491815719, "post_id": 43319129, "comment_id": 73702568, "body": "&quot;So, basically, what I need is some sort of static storage that is passed between method and goroutine calls.&quot; There is no such thing and the Go authors dislike things like goroutine ids or storage. &quot;I would be happy to hear what is a better approach to solve the above problem.&quot; --&gt; &quot;Using a context solves the problem, but this means I will have to add a context parameter to all my methods&quot;. You solved the problem. &quot;... which is somewhat annoying&quot; if you feel so, than you will have to do something annoying. You&#39;ll mange."}, {"owner": {"reputation": 2128, "user_id": 474270, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/515e1c142d88efc10b097435d28a6b0e?s=128&d=identicon&r=PG", "display_name": "Svarog", "link": "https://stackoverflow.com/users/474270/svarog"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1491816394, "post_id": 43319129, "comment_id": 73703062, "body": "It looks to me as bad taste when all methods within a solution contain the same parameter.    It adds complexity by creating the question of &quot;Does this method need a context?&quot; whenever writing a new method, while the need for a context might be 3 method-calls deeper than the method being written.  Yes, if that&#39;s the only option, I would use a context, or alternatively get rid of the request-id in logs, but before doing that, I&#39;d rather see if there&#39;s a better option."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1491816953, "post_id": 43319129, "comment_id": 73703472, "body": "What&#39;s bad taste to you is considered best practice by others (see, e.g. <a href=\"https://blog.golang.org/context#TOC_5.\" rel=\"nofollow noreferrer\">blog.golang.org/context#TOC_5.</a>). There is no sensible way to argue about taste, especially in programming."}, {"owner": {"reputation": 2128, "user_id": 474270, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/515e1c142d88efc10b097435d28a6b0e?s=128&d=identicon&r=PG", "display_name": "Svarog", "link": "https://stackoverflow.com/users/474270/svarog"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1491817080, "post_id": 43319129, "comment_id": 73703564, "body": "Looks so... oh well, time to do a re-write :/"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 6, "creation_date": 1491818632, "post_id": 43319129, "comment_id": 73704635, "body": "@Svarog &quot;Does this method need a context?&quot; If the library wants to log the request ID, then it <i>needs</i> some kind of context. By passing a <code>Context</code>, you make that explicit. If you don&#39;t pass a context explicitly, there is still an <i>invisible</i> context, and Go doesn&#39;t like hidden, invisible things. Go likes being explicit, Go likes not doing much in the background hidden from your eyes."}, {"owner": {"reputation": 1683, "user_id": 334908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4b54a3d274fee21ed3f55bc42baaddbe?s=128&d=identicon&r=PG", "display_name": "Will Bradley", "link": "https://stackoverflow.com/users/334908/will-bradley"}, "edited": false, "score": 0, "creation_date": 1607020528, "post_id": 43319129, "comment_id": 115148336, "body": "This becomes especially painful when html/template rendering is involved because the &quot;template&quot; form within the template language does not (easily) allow multiple parameters, and there is no efficient form of dependency injection without re-parsing templates with a stateful FuncMap."}], "answers": [{"comments": [{"owner": {"reputation": 2128, "user_id": 474270, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/515e1c142d88efc10b097435d28a6b0e?s=128&d=identicon&r=PG", "display_name": "Svarog", "link": "https://stackoverflow.com/users/474270/svarog"}, "edited": false, "score": 1, "creation_date": 1505219474, "post_id": 46146034, "comment_id": 79315068, "body": "Thanks for the reply, but you can do something similar logrus, and it doesn&#39;t really help - still requires an object to be passed among all functions. I&#39;d rather have it be a context object to comply to convention."}], "tags": [], "owner": {"reputation": 1576, "user_id": 5453515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c41cae4ee9e62e14df6757fc7a364cb2?s=128&d=identicon&r=PG&f=1", "display_name": "Stephane Martin", "link": "https://stackoverflow.com/users/5453515/stephane-martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1505081628, "creation_date": 1505081628, "answer_id": 46146034, "question_id": 43319129, "link": "https://stackoverflow.com/questions/43319129/is-there-a-static-way-to-get-current-request-context-in-go/46146034#46146034", "title": "Is there a static way to get current request/context in Go?", "body": "<p>Try another logging library. For instance, in log15 (<a href=\"https://github.com/inconshreveable/log15\" rel=\"nofollow noreferrer\">https://github.com/inconshreveable/log15</a>) a Logger as an embedded key/value context.</p>\n\n<pre><code>logger := log.New(\"request_id\", \"8379870928\")\n</code></pre>\n\n<p>You can pass the logger object to anyone that needs to log. Later on:</p>\n\n<pre><code>logger.Warn(\"blabalbla\")\n</code></pre>\n\n<p>... will embed the request_id that you have put.</p>\n"}], "owner": {"reputation": 2128, "user_id": 474270, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/515e1c142d88efc10b097435d28a6b0e?s=128&d=identicon&r=PG", "display_name": "Svarog", "link": "https://stackoverflow.com/users/474270/svarog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 961, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1505081628, "creation_date": 1491815466, "question_id": 43319129, "link": "https://stackoverflow.com/questions/43319129/is-there-a-static-way-to-get-current-request-context-in-go", "title": "Is there a static way to get current request/context in Go?", "body": "<p>I want my logging methods to output some sort of request ID. To do that I need to pass a request object (or some derivative) to the logging functions.</p>\n\n<p>This is all fine when logging from the request handlers, but is problematic when used from within library-style methods, as I don't wish those to be aware of any ongoing http-requests.<br>\nFurthermore, those same library methods might be used in the future by console applications, and than the request-id would be replaced by some sort of worker-thread-id.</p>\n\n<p>Using a context solves the problem, but this means I will have to add a context parameter to all my methods, which is somewhat annoying.</p>\n\n<p>So, basically, what I need is some sort of static storage that is passed between method and goroutine calls.</p>\n\n<p>I'm not sure there's anything like that in Go, so maybe my approach is totally off-base, in that case, I would be happy to hear what is a better approach to solve the above problem.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1491805993, "post_id": 43316154, "comment_id": 73697173, "body": "Yes and it so dead simple: 1) You sort the slice of Parents by Parent.id and 2) You sort each Parents children by their Child.Id. As you described the algorithm already in the question I&#39;m unsure what you are asking for. Sorting in your case is probably done via sort.Slice."}], "answers": [{"comments": [{"owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "edited": false, "score": 2, "creation_date": 1491831414, "post_id": 43316800, "comment_id": 73713561, "body": "That function exists since Go 1.8, it&#39;s brand new :)"}], "tags": [], "owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "is_accepted": true, "score": 5, "last_activity_date": 1544062757, "last_edit_date": 1544062757, "creation_date": 1491807954, "answer_id": 43316800, "question_id": 43316154, "link": "https://stackoverflow.com/questions/43316154/sorting-by-slice-fields/43316800#43316800", "title": "Sorting by slice fields", "body": "<p>I got it to work using the following code:</p>\n\n<pre><code>// sort each Parent in the parents slice by Id\nsort.Slice(parents, func(i, j int) bool {return parents[i].id &lt; parents[j].id})\n\n// for each Parent, sort each Child in the children slice by Id\nfor _, parent := range parents {\n    sort.Slice(parent.children, func(i, j int) bool {return parent.children[i].id &lt; parent.children[j].id})\n}\n</code></pre>\n\n<p>Special thanks to @Volker for mentioning the <strong><em>sort.Slice</em></strong> function! I had no idea it existed!</p>\n"}], "owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2765, "favorite_count": 0, "accepted_answer_id": 43316800, "answer_count": 1, "score": 5, "last_activity_date": 1597655503, "creation_date": 1491805168, "last_edit_date": 1597655503, "question_id": 43316154, "link": "https://stackoverflow.com/questions/43316154/sorting-by-slice-fields", "title": "Sorting by slice fields", "body": "<p>I have the following Structs:</p>\n\n<pre><code>type Parent struct {\n    id       string\n    children []Child\n}\n\ntype Child struct {\n    id string\n}\n</code></pre>\n\n<p>I have made a slice of Parents with the following values:</p>\n\n<pre><code>parents := make([]Parent, 0)\n\np1 := Parent {\n    \"3\",\n    []Child {\n        {\"2\"},\n        {\"3\"},\n        {\"1\"},\n    },\n}\n\np2 := Parent {\n    \"1\",\n    []Child {\n        {\"8\"},\n        {\"9\"},\n        {\"7\"},\n    },\n}\n\np3 := Parent {\n    \"2\",\n    []Child {\n        {\"5\"},\n        {\"6\"},\n        {\"4\"},\n    },\n}             \n\nparents = append(parents, p1, p2, p3)\n</code></pre>\n\n<p>I am trying to sort the \"parents\" slice in the following order:</p>\n\n<pre><code>1) First, sort all Parents by Parent.id\n\n2) Next, sort each Parent's \"children\" slice by Child.id\n</code></pre>\n\n<p>The expected result is something like:</p>\n\n<pre><code>[{1 [{7} {8} {9}]} {2 [{4} {5} {6}]} {3 [{1} {2} {3}]}]\n</code></pre>\n\n<p>Is there a way to do this in Go?</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 6171, "user_id": 131618, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/X389j.jpg?s=128&g=1", "display_name": "Pavel K.", "link": "https://stackoverflow.com/users/131618/pavel-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1491803075, "creation_date": 1491803075, "answer_id": 43315735, "question_id": 43315692, "link": "https://stackoverflow.com/questions/43315692/read-json-file-value-in-go/43315735#43315735", "title": "Read json file value in Go", "body": "<p>You need to <a href=\"http://golang.org/doc/go_spec.html#Exported_identifiers\" rel=\"nofollow noreferrer\">export</a> Configuration.domain field so that json package can see it.</p>\n\n<p>Rename the domain field to Domain:</p>\n\n<pre><code>type Configuration struct {\n  Domain string\n}\n</code></pre>\n\n<p>You can also specify json name explicitly if it differs from field name:</p>\n\n<pre><code>type Configuration struct {\n  Domain string `json:\"domain_name\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 2634, "user_id": 2566671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sIAd4.jpg?s=128&g=1", "display_name": "pyprism", "link": "https://stackoverflow.com/users/2566671/pyprism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 0, "closed_date": 1491806036, "accepted_answer_id": 43315735, "answer_count": 1, "score": -1, "last_activity_date": 1491829846, "creation_date": 1491802847, "last_edit_date": 1491829846, "question_id": 43315692, "link": "https://stackoverflow.com/questions/43315692/read-json-file-value-in-go", "closed_reason": "Duplicate", "title": "Read json file value in Go", "body": "<p>I have a config file. I want to get specific value from that file. Here is my code : </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"encoding/json\"\n)\n\ntype Configuration struct {\n    consumer_key   string\n    consumer_secret   string\n    access_token   string\n    access_token_secret   string\n    db_name   string\n    db_user   string\n    db_password   string\n    secret_key   string\n    fb_page   string\n    fb_page_token   string\n    domain   string\n}\n\nfunc main() {\n    file, _ := os.Open(\"./config.json\")\n    decoder := json.NewDecoder(file)\n    configuration := Configuration{}\n    error_ := decoder.Decode(&amp;configuration)\n     fmt.Println(configuration.domain)\n}\n</code></pre>\n\n<p>config.json</p>\n\n<pre><code>{\n  \"consumer_key\": \"\",\n  \"consumer_secret\": \"\",\n  \"access_token\": \"\",\n  \"access_token_secret\": \"\",\n  \"db_name\": \"\",\n  \"db_user\": \"\",\n  \"db_password\": \"\",\n  \"secret_key\": \"\",\n  \"fb_page\": \"\",\n  \"fb_page_token\": \"\",\n  \"domain\": \"localhost:8000\"\n}\n</code></pre>\n\n<p>But the problem is it always print empty line, not the value <code>localhost:8000</code> I am expecting.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 2, "last_activity_date": 1491792688, "last_edit_date": 1495541423, "creation_date": 1491792688, "answer_id": 43314305, "question_id": 43314088, "link": "https://stackoverflow.com/questions/43314088/cron-job-in-go-not-running-as-expected/43314305#43314305", "title": "CRON job in Go not running as expected", "body": "<p>Your code does this:</p>\n\n<ol>\n<li><p>Initiates a new <code>cron</code> instance:</p>\n\n<pre><code>c := cron.New()\n</code></pre></li>\n<li><p>Adds a cron job:</p>\n\n<pre><code>c.AddFunc(\"@every 3m\", func() { fmt.Println(\"Every 3 min\") })\n</code></pre></li>\n<li><p>Starts the cron instance in a new goroutine (in the background):</p>\n\n<pre><code>c.Start()\n</code></pre></li>\n<li><p>Prints \"Done\":</p>\n\n<pre><code>fmt.Println(\"Done\")\n</code></pre></li>\n<li><p>Then exits.</p></li>\n</ol>\n\n<p>If you want your program to keep running, you need to make it <em>do something</em> that keeps it running.  If there is nothing else you need your program to do, just have it wait for something to finish that never finishes. See <a href=\"https://stackoverflow.com/a/9544599/13860\">this answer</a> for some suggestions along those lines.</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 1651815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xhl06.jpg?s=128&g=1", "display_name": "Fernando De Melo Braga", "link": "https://stackoverflow.com/users/1651815/fernando-de-melo-braga"}, "is_accepted": false, "score": 1, "last_activity_date": 1607781252, "creation_date": 1607781252, "answer_id": 65265693, "question_id": 43314088, "link": "https://stackoverflow.com/questions/43314088/cron-job-in-go-not-running-as-expected/65265693#65265693", "title": "CRON job in Go not running as expected", "body": "<p>Extending on @Flimzy answer, if you want your program to sit and do nothing, just add <code>select {}</code> to it</p>\n<p>Your code would be something like this:</p>\n<pre><code>func main() {\n    c := cron.New()\n    c.AddFunc(&quot;@every 3m&quot;, func() { fmt.Println(&quot;Every 3 min&quot;) })\n    c.Start()\n    fmt.Println(&quot;Done&quot;)\n    select {}\n}\n</code></pre>\n"}], "owner": {"reputation": 2634, "user_id": 2566671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sIAd4.jpg?s=128&g=1", "display_name": "pyprism", "link": "https://stackoverflow.com/users/2566671/pyprism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2552, "favorite_count": 0, "accepted_answer_id": 43314305, "answer_count": 2, "score": 0, "last_activity_date": 1607781252, "creation_date": 1491790726, "last_edit_date": 1602057025, "question_id": 43314088, "link": "https://stackoverflow.com/questions/43314088/cron-job-in-go-not-running-as-expected", "title": "CRON job in Go not running as expected", "body": "<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/robfig/cron\"\n)\n\nfunc main() {\n    c := cron.New()\n    c.AddFunc(\"@every 3m\", func() { fmt.Println(\"Every 3 min\") })\n    c.Start()\n    fmt.Println(\"Done\")\n}\n</code></pre>\n\n<p>The problem is when I run the code using <code>go run</code> it just prints <code>Done</code> then exits. I am just trying to print the function every 3 minute.</p>\n"}, {"tags": ["bash", "go"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1491746111, "post_id": 43307491, "comment_id": 73679624, "body": "In C, I would do this by simply passing <code>argc</code> to <code>execvp</code> rather than invoking <code>system</code>, which will subject the command the shell interpretation.  Which behavior do you want from <code>go</code>?"}, {"owner": {"reputation": 1, "user_id": 7840081, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZdzHDzsTaF8/AAAAAAAAAAI/AAAAAAAAACE/wdMR4_nSq7s/photo.jpg?sz=128", "display_name": "Trailers And Misc Videos", "link": "https://stackoverflow.com/users/7840081/trailers-and-misc-videos"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1491749441, "post_id": 43307491, "comment_id": 73680724, "body": "@WilliamPursell I want to do the same thing but using GOlang. I have been doing some research and found that it can be done using the ssh package provided by go. But I can&#39;t figure out how exactly?"}], "answers": [{"tags": [], "owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "is_accepted": true, "score": 1, "last_activity_date": 1491751193, "creation_date": 1491751193, "answer_id": 43308454, "question_id": 43307491, "link": "https://stackoverflow.com/questions/43307491/a-program-that-takes-a-command-as-input-and-runs-it-in-the-terminal/43308454#43308454", "title": "A program that takes a command as input and runs it in the terminal", "body": "<p>Something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    if len(os.Args) &lt; 2 {\n        panic(\"Usage: ./program_name terminal_command ...\")\n    }\n\n    cmd := exec.Command(os.Args[1], os.Args[2:]...)\n    cmd.Run()\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7840081, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZdzHDzsTaF8/AAAAAAAAAAI/AAAAAAAAACE/wdMR4_nSq7s/photo.jpg?sz=128", "display_name": "Trailers And Misc Videos", "link": "https://stackoverflow.com/users/7840081/trailers-and-misc-videos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 43308454, "answer_count": 1, "score": -2, "last_activity_date": 1491751193, "creation_date": 1491745885, "last_edit_date": 1491748737, "question_id": 43307491, "link": "https://stackoverflow.com/questions/43307491/a-program-that-takes-a-command-as-input-and-runs-it-in-the-terminal", "title": "A program that takes a command as input and runs it in the terminal", "body": "<p>I kind of know how to do this in C, but how to do it in Go?</p>\n\n<p>This is the code I'm using:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_CMN_LEN 100\n\nint main(int argc, char *argv[])\n{\n    char cmd[MAX_CMN_LEN] = \"\", **p;\n\n    if (argc &lt; 2) /*no command specified*/\n    {\n        fprintf(stderr, \"Usage: ./program_name terminal_command ...\");\n        exit(EXIT_FAILURE);\n    }\n    else\n    {\n        strcat(cmd, argv[1]);\n        for (p = &amp;argv[2]; *p; p++)\n        {\n            strcat(cmd, \" \");\n            strcat(cmd, *p);\n        }\n        system(cmd);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "edited": false, "score": 3, "creation_date": 1491742366, "post_id": 43306821, "comment_id": 73678518, "body": "Have you checked whether the function returns an error?"}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1491802560, "post_id": 43306821, "comment_id": 73695868, "body": "Please provide a runnable link."}], "answers": [{"comments": [{"owner": {"reputation": 1206, "user_id": 5180802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-C9Feof_ezik/AAAAAAAAAAI/AAAAAAAATQo/-PlxZxs79hY/photo.jpg?sz=128", "display_name": "redsalt", "link": "https://stackoverflow.com/users/5180802/redsalt"}, "edited": false, "score": 0, "creation_date": 1491824662, "post_id": 43306978, "comment_id": 73708575, "body": "You could do <code>splitted := strings.Split(line[:len(line)-1], &quot; &quot;)</code> to get rid of the last character."}], "tags": [], "owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "is_accepted": false, "score": 3, "last_activity_date": 1491742953, "creation_date": 1491742953, "answer_id": 43306978, "question_id": 43306821, "link": "https://stackoverflow.com/questions/43306821/parsed-strings-sometimes-becomes-0/43306978#43306978", "title": "Parsed strings sometimes becomes 0", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow noreferrer\">ReadString</a> reads\n  until the first occurrence of delim in the input, returning a string\n  containing the data up to and including the delimiter.</p>\n</blockquote>\n\n<p>So <code>splitted[2]</code> is <code>125\\n</code>, you should check the error in <code>strconv.ParseInt(splitted[2], 0, 64)</code>, it's not <code>nil</code> so that the returned value is 0.</p>\n"}], "owner": {"reputation": 61, "user_id": 7840385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ae8ff2b2f5c5430aa39b59a98181353b?s=128&d=identicon&r=PG&f=1", "display_name": "Augman", "link": "https://stackoverflow.com/users/7840385/augman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1491788768, "creation_date": 1491741882, "last_edit_date": 1491788768, "question_id": 43306821, "link": "https://stackoverflow.com/questions/43306821/parsed-strings-sometimes-becomes-0", "title": "Parsed strings sometimes becomes 0", "body": "<p>I have a problem when parsing from a string to an integer that sometimes the string is being parsed to 0, despite not being 0.</p>\n\n<p><em>Example:</em></p>\n\n<p>What I would like to do first is parsing a string into three different integers. My code looks as follows:</p>\n\n<pre><code>package main\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n    line, _ := reader.ReadString('\\n')\n\n    splitted := strings.Split(line, \" \")\n\n    N, _ := strconv.ParseInt(splitted[0], 0, 64) //Works as intended\n    P, _ := strconv.ParseInt(splitted[1], 0, 64) //Works as intended\n    Q, _ := strconv.ParseInt(splitted[2], 0, 64) //Does not work as intended\n\n    fmt.Print(N, P, Q)  //For testing the parsing\n\n}\n</code></pre>\n\n<p>If I input the string: \"5 25 125\", the output somehow becomes: \n5 25 0.</p>\n\n<p>This is the problem, sometimes the parsing parses the integer to the content of the string, which it should. But sometimes it parses the integer into a zero.</p>\n\n<p>Why is this?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "edited": false, "score": 0, "creation_date": 1491817724, "post_id": 43317917, "comment_id": 73704006, "body": "I tried initializing the structure in the load function thinking that would also initialize the map a = &amp;Address{} however though error is not thrown the output is nil. I need addresses to be presented as map[string]map[string]string I don&#39;t see how else adjusting the Address structure would help. An address would be used for other models Company, User, Store etc. if I can save I should be able to load with very little effort in my view."}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "reply_to_user": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "edited": false, "score": 0, "creation_date": 1491820261, "post_id": 43317917, "comment_id": 73705702, "body": "Before you call <code>Load</code> just initialize whatever variable you&#39;re passing to it, in this case <code>a</code> as a := make(Address)  I&#39;ve tried to replicate your issue here - <a href=\"https://play.golang.org/p/zaRBJVtmgy\" rel=\"nofollow noreferrer\">play.golang.org/p/zaRBJVtmgy</a>"}, {"owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "edited": false, "score": 0, "creation_date": 1491821827, "post_id": 43317917, "comment_id": 73706753, "body": "I understand that case, however in the instance of datastore, I don&#39;t have the privilege to init before datastore calls load or save. All happens internally."}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "reply_to_user": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "edited": false, "score": 0, "creation_date": 1491823602, "post_id": 43317917, "comment_id": 73707933, "body": "In that case, use *a = make(Address) in the first line of your function Load. Is that possible to do?"}, {"owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "edited": false, "score": 0, "creation_date": 1491842509, "post_id": 43317917, "comment_id": 73721570, "body": "Work like a charm, I had declared as follows a = &amp;Address{}, however *a = make(Address) is a winner. Thank you for your time."}], "tags": [], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "is_accepted": true, "score": 2, "last_activity_date": 1491811894, "last_edit_date": 1495535447, "creation_date": 1491811894, "answer_id": 43317917, "question_id": 43306655, "link": "https://stackoverflow.com/questions/43306655/save-and-loading-custom-types/43317917#43317917", "title": "save and loading custom types", "body": "<p>First, regarding the declarations - <a href=\"https://stackoverflow.com/a/42901715/4720042\">https://stackoverflow.com/a/42901715/4720042</a></p>\n\n<p>Next, I feel you should instead use a custom struct for this purpose.\nEven if you still want to use a <code>map[string]map[string]string</code>, you cannot assign to a field in a map that hasn't been explicitly defined viz. <code>property.Name</code></p>\n\n<p>You have to initialize that map with <code>make</code> if you plan on adding the elements later.</p>\n"}], "owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 43317917, "answer_count": 1, "score": 1, "last_activity_date": 1491842726, "creation_date": 1491740693, "last_edit_date": 1491842726, "question_id": 43306655, "link": "https://stackoverflow.com/questions/43306655/save-and-loading-custom-types", "title": "save and loading custom types", "body": "<p>I have a custom type <code>map[string]map[string]string</code> am trying to save in Google Datastore, the save works as expected. However the load functions complains about <code>assignment to entry in nil map</code></p>\n\n<pre><code>//Address represents address\ntype Address map[string]map[string]string\n</code></pre>\n\n<p>Type above is a map of map[string]string, target at saving different address types.    </p>\n\n<pre><code>//Load function from PropertyLoaderInterface helps datastore load this object\nfunc (a *Address) Load(dp []datastore.Property) error {\n    for _, property := range dp {\n        (*a)[property.Name] = util.InterfaceToMapString(property.Value)\n    }\n    return nil\n}\n</code></pre>\n\n<p>In the load function I deference the Address which is a map of map[string]string, it saves the following example JSON format.</p>\n\n<pre><code>\"Company\":{\n    \"physicalAddress\": \"\",\n    \"postalAddress\": \"\",\n    \"physicalCity\": \"\",\n    \"postalCity\": \"\",\n    \"physicalCode\": \"\",\n    \"postalCode\": \"\",\n    \"physicalCountry\": \"\",\n    \"postalCountry\": \"\"\n}\n</code></pre>\n\n<p>Save function below works well and data is store in datastore. The Load is however rather a tricky bugger.</p>\n\n<pre><code>//Save function from PropertyLoaderInterface helps datastore save this object\nfunc (a *Address) Save() ([]datastore.Property, error) {\n    propertise := []datastore.Property{}\n    for name, value := range *a {\n        propertise = append(propertise, datastore.Property{Name: name,\n            NoIndex: true,\n            Value:   util.MapToJSONString(value)})\n    }\n\n    return propertise, nil\n}\n</code></pre>\n\n<p><strong>Working load for Address struct</strong> </p>\n\n<pre><code>func (a *Address) Load(dp []datastore.Property) error {\n    *a = make(Address)\n\n    for _, property := range dp {\n        (*a)[property.Name] = util.InterfaceToMapString(property.Value)\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": ["go", "webserver"], "answers": [{"tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": false, "score": 2, "last_activity_date": 1491735874, "creation_date": 1491735874, "answer_id": 43305974, "question_id": 43305509, "link": "https://stackoverflow.com/questions/43305509/a-web-server-that-return-the-content-of-given-url/43305974#43305974", "title": "A web server that return the content of given url", "body": "<p>The problem here is presumably that the website you refer is using relative paths for the images and stylesheets, e.g. <code>\"/css/main.css\"</code>. The local website that you deliver to the browser with your Go service has another domain (for example <code>localhost</code>) and thus the relative path cannot be resolved by the browser (there is no <code>http://localhost/css/main.css</code>).</p>\n\n<p>So what you need to do is either set a base URL in the document you deliver or, alternatively, rewrite every relative path to an absolute path (<code>/css/main.css</code> to <code>http://originalwebsite.com/css/main.css</code>).</p>\n\n<p>For adding the base tag or rewriting the URLs in the document I suggest employing something like <a href=\"https://godoc.org/github.com/PuerkitoBio/goquery\" rel=\"nofollow noreferrer\">goquery</a> which lets you manipulate the HTML structure similar to how jQuery does it.</p>\n\n<p>Example of adding a <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base\" rel=\"nofollow noreferrer\"><code>&lt;base&gt;</code></a> tag:</p>\n\n<pre><code>import (\n    \"github.com/PuerkitoBio/goquery\"\n    \"fmt\"\n)\n\nfunc main() {\n    doc,err := goquery.NewDocument(\"http://www.meaningfultype.com/\")\n\n    if err != nil {\n        panic(err)\n    }\n\n    m := doc.Find(\"head\")\n\n    m.Children().First().BeforeHtml(`&lt;base url=\"http://localhost/\"&gt;`)\n\n    fmt.Println(doc.Html())\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "edited": false, "score": 0, "creation_date": 1491830925, "post_id": 43306270, "comment_id": 73713190, "body": "how to manage it if url given in the example is not fix.e.g. i want to give any url in browser like given bellow: <a href=\"http://localhost:8080/fastor/ttp://www.meaningfultype.com/\" rel=\"nofollow noreferrer\">localhost:8080/fastor/ttp://www.meaningfultype.com</a>"}, {"owner": {"reputation": 1206, "user_id": 5180802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-C9Feof_ezik/AAAAAAAAAAI/AAAAAAAATQo/-PlxZxs79hY/photo.jpg?sz=128", "display_name": "redsalt", "link": "https://stackoverflow.com/users/5180802/redsalt"}, "reply_to_user": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "edited": false, "score": 1, "creation_date": 1491898119, "post_id": 43306270, "comment_id": 73743456, "body": "You just need to set the <code>url</code> variable to the right value. The variable <code>r.URL</code> contains the URL that the user requested (in this case <a href=\"http://localhost:8080/fastor/http://www.meaningfultype.com/\" rel=\"nofollow noreferrer\">localhost:8080/fastor/http://www.meaningfultype.com</a>) so you just need to remove <code>http:&#47;&#47;localhost:8080&#47;fastor&#47;</code> and use the rest of the string as the value for <code>url</code> but keep in mind that double slashes will be replaced with one slash so the URL in the path will become <code>http:&#47;www.meaningfultype.com</code> it might be better to not include the scheme in the path and add it to the string manually."}, {"owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "edited": false, "score": 0, "creation_date": 1492602293, "post_id": 43306270, "comment_id": 74043813, "body": "I use this link <a href=\"http://www.elbowsydney.com.au\" rel=\"nofollow noreferrer\">elbowsydney.com.au</a> in the code given by you and web server opened it nicely . But when I click on the internal links, browser opens the internal link directly without interacting with my web server.I would be very thankful to you"}], "tags": [], "owner": {"reputation": 1206, "user_id": 5180802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-C9Feof_ezik/AAAAAAAAAAI/AAAAAAAATQo/-PlxZxs79hY/photo.jpg?sz=128", "display_name": "redsalt", "link": "https://stackoverflow.com/users/5180802/redsalt"}, "is_accepted": true, "score": 0, "last_activity_date": 1491738061, "creation_date": 1491738061, "answer_id": 43306270, "question_id": 43305509, "link": "https://stackoverflow.com/questions/43305509/a-web-server-that-return-the-content-of-given-url/43306270#43306270", "title": "A web server that return the content of given url", "body": "<h1>TL;DR</h1>\n\n<ul>\n<li><p>You are only serving the root HTML page, you need to respond to requests to other resources too (you can see what resource is being requested with the URL variable of the *http.Request variable)</p></li>\n<li><p>When serving the resources, you need to write the Header's <code>Content-Type</code> to let the browser know what's the type of the resource (like <code>image/png</code>)</p></li>\n</ul>\n\n<h1>Full Answer</h1>\n\n<p>What you are doing in your request handler is getting <code>http://www.meaningfultype.com/</code>, the HTML page, then the browser finds an image like <code>/images/header-logo.png</code> and makes the request to get it but your server in localhost doesn't know how to respond to <code>http://localhost/images/header-logo.png</code>.</p>\n\n<p>Assuming your handler function is handling requests at the root of the server (<code>\"/\"</code>), you could get the requested URL <code>r.URL</code> and use it to get the required resource:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>url := \"http://www.meaningfultype.com/\"\nif r.URL.Host == \"\" {\n    url += r.URL.String()\n} else {\n    url = r.URL.String()\n}\nres, err := http.Get(url)\n</code></pre>\n\n<p>The problem is that, even after doing this, all the resources are sent as <code>plain/text</code> because you are not setting the Header's <code>Content-Type</code>. That's why you need to specify the type of the resource before writing. In order to know what the type of the resource is, just get it from the <code>Content-Type</code> you just received in the Header of the response of <code>http.Get</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>contentType := res.Header.Get(\"Content-Type\")\nw.Header().Set(\"Content-Type\", contentType)\nw.Write(robots)\n</code></pre>\n\n<p>The final result:</p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", factHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc factHandler(w http.ResponseWriter, r *http.Request) {\n    url := \"http://www.meaningfultype.com/\"\n    if r.URL.Host == \"\" {\n        url += r.URL.String()\n    } else {\n        url = r.URL.String()\n    }\n    res, err := http.Get(url)\n    if err != nil {\n        log.Fatal(err)\n    }\n    robots, err := ioutil.ReadAll(res.Body)\n\n    res.Body.Close()\n    if err != nil {\n        log.Fatal(err)\n    }\n    contentType := res.Header.Get(\"Content-Type\")\n    w.Header().Set(\"Content-Type\", contentType)\n    w.Write(robots)\n}\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 43306270, "answer_count": 2, "score": 2, "last_activity_date": 1491738061, "creation_date": 1491732702, "last_edit_date": 1491736103, "question_id": 43305509, "link": "https://stackoverflow.com/questions/43305509/a-web-server-that-return-the-content-of-given-url", "title": "A web server that return the content of given url", "body": "<p>I wrote a simple web sever that gets the content of a given URL and writes it out using a <code>http.ResponseWriter</code>. But the problem is that it does not display any images and CSS on the page. The code is given bellow:</p>\n\n<pre><code>func factHandler(w http.ResponseWriter, r *http.Request) {\n    res, err := http.Get(\"http://www.meaningfultype.com/\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    robots, err := ioutil.ReadAll(res.Body)\n\n    res.Body.Close()\n    if err != nil {\n        log.Fatal(err)\n    }   \n    w.Write(robots)\n}\n</code></pre>\n\n<p>What do I need to change so that the the whole page content as seen in the web browser is returned?</p>\n"}, {"tags": ["json", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1491731199, "creation_date": 1491731199, "answer_id": 43305290, "question_id": 43304365, "link": "https://stackoverflow.com/questions/43304365/cannot-unmarshal-string-into-go-struct-field-article-article-type-of-type-models/43305290#43305290", "title": "cannot unmarshal string into Go struct field Article.article_type of type models.ArticleType", "body": "<p>You can have your <code>ArticleType</code> implement the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\">json.Unmarshaler</a> interface by defining an <code>UnmarshalJSON</code> method on it:</p>\n\n<pre><code>func (a *ArticleType) UnmarshalJSON(b []byte) error {\n    a.Title = string(b)\n    return nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/k_UlghLxZI\" rel=\"nofollow noreferrer\">https://play.golang.org/p/k_UlghLxZI</a></p>\n"}], "owner": {"reputation": 338, "user_id": 2670638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e806adfa2c8bc21717f0a1c2c0cfc7a?s=128&d=identicon&r=PG", "display_name": "Igor Komar", "link": "https://stackoverflow.com/users/2670638/igor-komar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2456, "favorite_count": 0, "accepted_answer_id": 43305290, "answer_count": 1, "score": 0, "last_activity_date": 1491788950, "creation_date": 1491724467, "last_edit_date": 1491788950, "question_id": 43304365, "link": "https://stackoverflow.com/questions/43304365/cannot-unmarshal-string-into-go-struct-field-article-article-type-of-type-models", "title": "cannot unmarshal string into Go struct field Article.article_type of type models.ArticleType", "body": "<p>I cannot unmarshal json field <code>article_type</code> into golang struct <code>Article</code>.</p>\n\n<p>I'm getting error:</p>\n\n<p><code>json: cannot unmarshal string into Go struct field Article.article_type of type models.ArticleType</code></p>\n\n<pre><code>str := []byte(`[{\"created_at\":1486579331,\"updated_at\":1486579331,\"article_type\":\"news\"}]`)\n\ntype Article struct {\n    ID            uint      `gorm:\"primary_key\"`\n    CreatedAt     timestamp.Timestamp `json:\"created_at\"`\n    UpdatedAt     timestamp.Timestamp `json:\"updated_at\"`\n\n    ArticleType   ArticleType `json:\"article_type\"`\n    ArticleTypeId uint        `gorm:\"index\" json:\"-\"`\n\ntype ArticleType struct {\n    ID        uint      `gorm:\"primary_key\" json:\"id\"`\n    CreatedAt timestamp.Timestamp `json:\"created_at\"`\n    UpdatedAt timestamp.Timestamp `json:\"updated_at\"`\n    Title     string    `gorm:\"size:255\" json:\"title\"`\n\n    Articles  []Article `json:\"articles\"`\n}\n\narticles := []models.Article{}\nif err := json.Unmarshal(str, &amp;articles); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>I wanted that <code>\"article_type\":\"news\"</code> would be parse as:\nArticle.ArticleType.title = \"news\"\nAnd then I would can save article object which have article type with title \"news\" in database.</p>\n"}, {"tags": ["docker", "go"], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 3015101, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000322925739/picture?type=large", "display_name": "cafed00d", "link": "https://stackoverflow.com/users/3015101/cafed00d"}, "edited": false, "score": 0, "creation_date": 1491721664, "post_id": 43303692, "comment_id": 73673065, "body": "So this means that removing a tag has no effect on the space reclaimed during <code>docker system prune</code>. We only reclaim space when the image itself is removed. Is this true?"}, {"owner": {"reputation": 1571, "user_id": 5536005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91e3d5aa2f1aa02b6d96c7cd85ec14a9?s=128&d=identicon&r=PG&f=1", "display_name": "radbrawler", "link": "https://stackoverflow.com/users/5536005/radbrawler"}, "reply_to_user": {"reputation": 165, "user_id": 3015101, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000322925739/picture?type=large", "display_name": "cafed00d", "link": "https://stackoverflow.com/users/3015101/cafed00d"}, "edited": false, "score": 0, "creation_date": 1491722117, "post_id": 43303692, "comment_id": 73673164, "body": "yes that&#39;s true. we reclaim space only when image itself is removed. Also as docker image is made up of layers so its not necessary that an image of 1.5 GB on deletion vacates 1.5GB space."}], "tags": [], "owner": {"reputation": 1571, "user_id": 5536005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91e3d5aa2f1aa02b6d96c7cd85ec14a9?s=128&d=identicon&r=PG&f=1", "display_name": "radbrawler", "link": "https://stackoverflow.com/users/5536005/radbrawler"}, "is_accepted": true, "score": 1, "last_activity_date": 1491718895, "last_edit_date": 1492085621, "creation_date": 1491718895, "answer_id": 43303692, "question_id": 43303545, "link": "https://stackoverflow.com/questions/43303545/what-is-the-difference-between-an-untaggedimage-deletedimage-in-the-docker-sou/43303692#43303692", "title": "What is the difference between an untaggedImage &amp; deletedImage in the docker source?", "body": "<p>It's not necessary that untagging deletes an image. If you have an image tagged with more than one tag. It'll delete the tag and image will be there with the other tag. </p>\n\n<p><code>docker rmi first-tag</code> will remove the <code>first-tag</code> but will still persist the image with <code>second-tag</code>. It would have been disastrous if it deleted the whole image whenever we tried to remove the tag. </p>\n\n<p>You can see <a href=\"https://serverfault.com/questions/703344/how-to-remove-an-image-tag-in-docker-without-removing-the-image-itself\">here</a> for more.</p>\n"}], "owner": {"reputation": 165, "user_id": 3015101, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000322925739/picture?type=large", "display_name": "cafed00d", "link": "https://stackoverflow.com/users/3015101/cafed00d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 43303692, "answer_count": 1, "score": -1, "last_activity_date": 1491718895, "creation_date": 1491717259, "question_id": 43303545, "link": "https://stackoverflow.com/questions/43303545/what-is-the-difference-between-an-untaggedimage-deletedimage-in-the-docker-sou", "title": "What is the difference between an untaggedImage &amp; deletedImage in the docker source?", "body": "<p>The docker source defines a struct to hold deleted images when running <code>docker image prune</code> or <code>docker system prune</code>:</p>\n\n<pre><code>type ImageDeleteResponseItem struct {\n\n    // The image ID of an image that was deleted\n    Deleted string `json:\"Deleted,omitempty\"`\n\n    // The image ID of an image that was untagged\n    Untagged string `json:\"Untagged,omitempty\"`\n}\n</code></pre>\n\n<p>(<a href=\"https://github.com/docker/docker/blob/master/api/types/image_delete_response_item.go\" rel=\"nofollow noreferrer\">source code link</a>)</p>\n\n<p>Looking at the comments I don't get the difference between the two. Aren't all untagged images also deleted?</p>\n"}, {"tags": ["go", "channel"], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 2, "last_activity_date": 1491725535, "last_edit_date": 1491725535, "creation_date": 1491724283, "answer_id": 43304337, "question_id": 43303406, "link": "https://stackoverflow.com/questions/43303406/select-on-time-after-results-deadlock/43304337#43304337", "title": "Select on time.After results deadlock", "body": "<p>As per the standard the <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">select statement</a> contains of a bunch of <a href=\"https://golang.org/ref/spec#SendStmt\" rel=\"nofollow noreferrer\">Send</a> or <a href=\"https://golang.org/ref/spec#RecvStmt\" rel=\"nofollow noreferrer\">Receive</a> statements.</p>\n\n<p>In this case it is the send statement.</p>\n\n<p>Send statement is defined as:</p>\n\n<pre><code>SendStmt = Channel \"&lt;-\" Expression .\nChannel  = Expression .\n</code></pre>\n\n<p>Looking at your code:</p>\n\n<pre><code>case c &lt;- &lt;-chan_never_used:\n</code></pre>\n\n<p>The <code>Channel</code> fraction is <code>c</code>, the <code>Expression</code> fraction is <code>&lt;-chan_never_used</code>.</p>\n\n<p>So, the <code>select</code> semantics of the Send Statement of being (potentially) non-blocking is not applicable because it is the expression that blocks. And before the Send Statements semantics is applied the Expression part must be completely evaluated.</p>\n"}], "owner": {"reputation": 671, "user_id": 7551820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-qFYkSwbZduE/AAAAAAAAAAI/AAAAAAAAAdQ/MmHqIWG-_xQ/photo.jpg?sz=128", "display_name": "Laurence", "link": "https://stackoverflow.com/users/7551820/laurence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 2, "accepted_answer_id": 43304337, "answer_count": 1, "score": 3, "last_activity_date": 1492307749, "creation_date": 1491716096, "last_edit_date": 1492307749, "question_id": 43303406, "link": "https://stackoverflow.com/questions/43303406/select-on-time-after-results-deadlock", "title": "Select on time.After results deadlock", "body": "<pre><code>package main\n\nimport \"time\"\n\nfunc main() {\n    chan_never_used := make(chan int, 10)\n\n    c := make(chan int, 10)\n    for {\n        select {\n        case &lt;-time.After(time.Second):\n            c &lt;- 0\n        case c &lt;- &lt;-chan_never_used:\n        }\n\n        println(&lt;-c)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/7hZMdITecg\" rel=\"nofollow noreferrer\">https://play.golang.org/p/7hZMdITecg</a></p>\n\n<p>The code above results in <code>fatal error: all goroutines are asleep - deadlock!</code>.</p>\n\n<p>But if I change one line:</p>\n\n<pre><code>package main\n\nimport \"time\"\n\nfunc main() {\n    chan_never_used := make(chan int, 10)\n\n    c := make(chan int, 10)\n    for {\n        select {\n        case &lt;-time.After(time.Second):\n            c &lt;- 0\n        case n := &lt;-chan_never_used: // This line changed\n            c &lt;- n                   // Add this line\n        }\n\n        println(&lt;-c)\n    }\n}\n</code></pre>\n\n<p>It works well.</p>\n\n<p>Why the first version of code results in deadlock and why could this change make the code work?</p>\n"}, {"tags": ["javascript", "math", "go", "signal-processing"], "answers": [{"comments": [{"owner": {"reputation": 1069, "user_id": 5700159, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/edec80d3e4185371d1b160436315bb25?s=128&d=identicon&r=PG&f=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/5700159/aron"}, "edited": false, "score": 0, "creation_date": 1491723364, "post_id": 43303623, "comment_id": 73673456, "body": "Hi Thank you very much, i will test."}, {"owner": {"reputation": 1069, "user_id": 5700159, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/edec80d3e4185371d1b160436315bb25?s=128&d=identicon&r=PG&f=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/5700159/aron"}, "edited": false, "score": 0, "creation_date": 1491747679, "post_id": 43303623, "comment_id": 73680122, "body": "I have one question, can you explain me K in the fft a little bit?"}, {"owner": {"reputation": 3857, "user_id": 4110233, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/L0Fpf.jpg?s=128&g=1", "display_name": "TheChetan", "link": "https://stackoverflow.com/users/4110233/thechetan"}, "reply_to_user": {"reputation": 1069, "user_id": 5700159, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/edec80d3e4185371d1b160436315bb25?s=128&d=identicon&r=PG&f=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/5700159/aron"}, "edited": false, "score": 0, "creation_date": 1491794761, "post_id": 43303623, "comment_id": 73693827, "body": "Ask on DSP stachexchange"}, {"owner": {"reputation": 1069, "user_id": 5700159, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/edec80d3e4185371d1b160436315bb25?s=128&d=identicon&r=PG&f=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/5700159/aron"}, "edited": false, "score": 0, "creation_date": 1491802339, "post_id": 43303623, "comment_id": 73695800, "body": "Ok Thank you again"}], "tags": [], "owner": {"reputation": 3857, "user_id": 4110233, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/L0Fpf.jpg?s=128&g=1", "display_name": "TheChetan", "link": "https://stackoverflow.com/users/4110233/thechetan"}, "is_accepted": true, "score": 1, "last_activity_date": 1491718097, "creation_date": 1491718097, "answer_id": 43303623, "question_id": 43303245, "link": "https://stackoverflow.com/questions/43303245/how-to-come-from-equations-to-code-with-javascript/43303623#43303623", "title": "How to come from equations to code with javascript", "body": "<p>This is in javascript. Make the appropriate changes for Go as well. I've not tested everything, just translated the math equations into code. If there are errors please correct the answer.</p>\n\n<pre><code>var pi = 3.14;\n\nvar blackmann = function(N){\n    var a = 0.16;\n    var a0 = (1-a)/2, a1 = 1/2, a2 = a/2;\n    var w = [];\n    for (var i=0; i&lt;N, i++){\n        w[i] = a0 - a1*Math.cos(2*pi*i/N) - a2*Math.cos(4*pi*i/N);\n    }\n    return w;\n}\n\nvar fft = function(x, K){\n    var X1 = [], X2 = [];\n    var N = x.length;\n    // X1 for the real spectrum, X2 for the imaginary part.\n    // For magnitude spectrum take |X1^2 + X2^2|\n    // For a K point fft\n    for (var k=0; k&lt;K; k++){\n        for (var n=0; n&lt;N; n++){\n            X1[k] = Math.cos(2*pi*n/N);\n            X2[k] = Math.sin(-2*pi*n/N);\n        }\n    }   \n    return {\"real\":X1, \"img\":X2}\n}\n\nvar smooting = function(x){\n    var s = [], t = 0.16\n    s[0] = x[0];\n    for (var i=1; i&lt;x.length; i++){\n        s = t*s[i-1] + (1-t)*x[i]\n    }\n    return s\n}\n\nvar decibel = function(X){\n    var Y = [];\n    for (var i =0;i&lt;X.length(); i++){\n        Y[i] = Math.log10(Math.abs(X[i]));\n    }\n    return Y;\n}\n</code></pre>\n"}], "owner": {"reputation": 1069, "user_id": 5700159, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/edec80d3e4185371d1b160436315bb25?s=128&d=identicon&r=PG&f=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/5700159/aron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1491733719, "accepted_answer_id": 43303623, "answer_count": 1, "score": -1, "last_activity_date": 1491748159, "creation_date": 1491714262, "last_edit_date": 1491748159, "question_id": 43303245, "link": "https://stackoverflow.com/questions/43303245/how-to-come-from-equations-to-code-with-javascript", "closed_reason": "Needs more focus", "title": "How to come from equations to code with javascript", "body": "<p>I will implement four equations first in javascript and later in go. My problem is i'm not a Mathematician, i don't know how to read the equations. </p>\n\n<p>First one is the FFT window Blackman.</p>\n\n<p><a href=\"https://i.stack.imgur.com/FQIDJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FQIDJ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Second is an FFT algorithm:</p>\n\n<p><a href=\"https://i.stack.imgur.com/a61Oi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a61Oi.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Third is Smoothing over time:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RZ7G6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RZ7G6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Fourth is to  decibel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hdT9N.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hdT9N.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I don't can use a fft library for this job, it's required to implement this four equations. When the work is done i will run this four equations in this sequence on the same signal.</p>\n\n<p>Can anyone help and explain how i come from the equations to working code?\nI don't know where i should start.</p>\n\n<p>Thank you for each answer</p>\n"}, {"tags": ["csv", "go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1491701000, "creation_date": 1491701000, "answer_id": 43302065, "question_id": 43301956, "link": "https://stackoverflow.com/questions/43301956/convert-struct-to-slice-of-strings/43302065#43302065", "title": "Convert struct to slice of strings?", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype record struct {\n    Field0 string\n    Field1 string\n    Field2 string\n    Field3 string\n}\n\nfunc main() {\n    r := record{\"f0\", \"f1\", \"f2\", \"f3\"}\n    fmt.Printf(\"%q\\n\", r)\n    s := []string{\n        r.Field0,\n        r.Field1,\n        r.Field2,\n        r.Field3,\n    }\n    fmt.Printf(\"%q\\n\", s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\"f0\" \"f1\" \"f2\" \"f3\"}\n[\"f0\" \"f1\" \"f2\" \"f3\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9619869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35127871a212169371668bf7a3d5c677?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Gabel", "link": "https://stackoverflow.com/users/9619869/chris-gabel"}, "is_accepted": false, "score": 2, "last_activity_date": 1568131490, "creation_date": 1568131490, "answer_id": 57874522, "question_id": 43301956, "link": "https://stackoverflow.com/questions/43301956/convert-struct-to-slice-of-strings/57874522#57874522", "title": "Convert struct to slice of strings?", "body": "<p>I find the <a href=\"https://github.com/fatih/structs\" rel=\"nofollow noreferrer\">https://github.com/fatih/structs</a> package to be quite useful...</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/fatih/structs\"\n)\n\ntype record struct {\n    Field0 string\n    Field1 string\n    Field2 string\n    Field3 string\n}\n\nfunc main() {\n    r := record{\"f0\", \"f1\", \"f2\", \"f3\"}\n    fmt.Printf(\"%q\\n\", r)\n    s := structs.Names(r)\n    fmt.Printf(\"%q\\n\", s)\n}\nOutput:\n\n{\"f0\" \"f1\" \"f2\" \"f3\"}\n[\"f0\" \"f1\" \"f2\" \"f3\"]\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3536, "favorite_count": 1, "accepted_answer_id": 43302065, "answer_count": 2, "score": 1, "last_activity_date": 1568131490, "creation_date": 1491699519, "question_id": 43301956, "link": "https://stackoverflow.com/questions/43301956/convert-struct-to-slice-of-strings", "title": "Convert struct to slice of strings?", "body": "<p>I'm trying to write a CSV file using the package <code>encoding/csv</code>. All data I want to write per line is saved in a struct like this:</p>\n\n<pre><code>type record struct {\n    Field0 string\n    Field1 string\n    Field2 string\n    Field3 string\n}\n</code></pre>\n\n<p>The csv package has a method called <a href=\"https://golang.org/pkg/encoding/csv/#Writer.Write\" rel=\"nofollow noreferrer\">Write</a> that requires a slice of strings.</p>\n\n<p>Is it possible to convert a struct to a slice of strings?</p>\n"}, {"tags": ["go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 14127, "user_id": 641627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEgWh.jpg?s=128&g=1", "display_name": "alexbt", "link": "https://stackoverflow.com/users/641627/alexbt"}, "edited": false, "score": 1, "creation_date": 1491690486, "post_id": 43300723, "comment_id": 73667405, "body": "You seem to be looking for a technical solution, but really you need to better define which package uses which. With the terminology, it feels like the datastore would be the lowest level and wouldn&#39;t know about other packages. But I can&#39;t really tell the business logic you have. Also, it feels weird to have a the datastoreDB receiver in the user package. Perhaps this method should be in the datastore package ? Perhaps the code should just be in the same package ? If you look at real-life projects, they have tons of files within the same packages."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491692791, "post_id": 43300723, "comment_id": 73667902, "body": "If datastore and user both require each other, then they simply can&#39;t be separate packages. Why are they in different packages in the first place?"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "reply_to_user": {"reputation": 14127, "user_id": 641627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEgWh.jpg?s=128&g=1", "display_name": "alexbt", "link": "https://stackoverflow.com/users/641627/alexbt"}, "edited": false, "score": 0, "creation_date": 1491693197, "post_id": 43300723, "comment_id": 73667999, "body": "@alexbt Before I used a MVC structure, but I liked the idea of putting controllers and models together <a href=\"https://stackoverflow.com/questions/43295691/identical-package-names-in-different-folders-for-same-project\">as recommended in my earlier question</a>.. the datastore.go file also contain configuration to create a single datastore client that I can then access using the datastoreDB receiver.. but it sounds like I need to go back and divide <code>user model functions</code> and <code>user controller functions</code> to separate packages?"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491693500, "post_id": 43300723, "comment_id": 73668071, "body": "@jimb I put them in separate packages because I felt it was necessary to separate all the functions (that had nothing to do with each other) in the <code>models</code> and <code>controllers</code> packages, and I was recommended to put everything that was related to <code>users</code> together to avoid having the directories: <code>controllers&#47;user</code> and <code>models&#47;user</code> which made sense to me"}, {"owner": {"reputation": 21272, "user_id": 52277, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/67498fd0e17d27cb9be0c107f306e378?s=128&d=identicon&r=PG", "display_name": "Michael Freidgeim", "link": "https://stackoverflow.com/users/52277/michael-freidgeim"}, "edited": false, "score": 0, "creation_date": 1619253413, "post_id": 43300723, "comment_id": 118852957, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/28256923/import-cycle-not-allowed\">Import cycle not allowed</a>"}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491698959, "post_id": 43301741, "comment_id": 73669160, "body": "This is great, thanks a lot.. But I guess this means that it&#39;s not possible to define the CreateUser function inside the user package? The main reason for abandoning the <code>models</code> and <code>controllers</code> package structure was to put all functions related to the user inside a user package, but it seems like this solution will still put all the models functions inside a <code>datastore</code> package? I do love the idea of defining the <code>DSDatabase</code> interface inside the <code>user</code> package, but is that even possible without importing the <code>datastore</code> package?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491699499, "post_id": 43301741, "comment_id": 73669240, "body": "You can very well have the CreateUser func in the user package but then having the DSDatabase interface seems pointless. What do you need it for?"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491699902, "post_id": 43301741, "comment_id": 73669303, "body": "But if I understand correctly, by putting the CreateUser function inside the <code>user</code> package then you need to import the <code>datastore</code> package (otherwise you&#39;ll end up creating multiple datastore clients), resulting in the import cycle error? I&#39;m working on a webapp that&#39;s already quite big and I end up naming my functions with specific prefixes because all the files are located inside <code>controllers</code> and <code>models</code> packages, so I was looking for a way to split it up"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491700687, "post_id": 43301741, "comment_id": 73669432, "body": "If you define <code>CreateUserPOST</code> and <code>CreateUser</code> inside the <code>user</code> package, which is ok, what do you need the extra <code>datastore</code> package for? What is the purpose of the <code>DSDatabase</code> interface?"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491701438, "post_id": 43301741, "comment_id": 73669553, "body": "The purpose is to have a single datastore client, and I believe to achieve this the DSDatabase interface is necessary? With the previous <code>models</code> package structure then functions related to <code>users</code>, <code>posts</code>, etc. could easily use the same datastore client; but how to achieve this if you have <code>package user</code> and <code>package post</code> containing both controller and model functions?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491702093, "post_id": 43301741, "comment_id": 73669654, "body": "You don&#39;t need an interface for that, you can just have a single instance of the client set to a variable inside a package, let&#39;s say your <code>datastore</code> package, and that&#39;s it... <code>user</code> and <code>post</code> can import <code>datastore</code> to use the client, and <code>datastore</code> only needs to import the <code>cloud.google.com&#47;go&#47;datastore</code> package to be able to declare the variable."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491703107, "post_id": 43301741, "comment_id": 73669808, "body": "Oh.. I saw google set it up it like this in one of their GitHub repos and figured it was necessary.. I&#39;ll try to make it work as you described.. thanks for everything :)"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 4, "last_activity_date": 1491697311, "creation_date": 1491697311, "answer_id": 43301741, "question_id": 43300723, "link": "https://stackoverflow.com/questions/43300723/overcoming-import-cycle-not-allowed-in-go/43301741#43301741", "title": "Overcoming import cycle not allowed in Go", "body": "<p>First things first, you cannot define a method, in <strong>pacakge A</strong>, on a type declared in <strong>package B</strong>.</p>\n\n<p>So this...</p>\n\n<pre><code>package user\n\nimport (\n    \"github.com/username/projectname/datastore\"\n)\n\nfunc (db *datastore.datastoreDB) CreateUser(ctx context.Context, username string) (*User, error) {\n    key := datastore.NameKey(\"User\", username, nil)\n    var user User\n    err := db.client.Get(ctx, key, &amp;user)\n    if err != nil {\n        return nil, err\n    }\n    return &amp;user, nil\n}\n</code></pre>\n\n<p>...should not even compile.</p>\n\n<p>This here...</p>\n\n<pre><code>package datastore\n\nimport (\n    \"github.com/username/projectname/user\"\n)\n\ntype DSDatabase interface {\n    user.CreateUser(ctx context.Context, username string, passwoUserRegister(ctx context.Context, username string, password []byte) (*datastore.Key, error)\n}\n</code></pre>\n\n<p>...this is also invalid Go code.</p>\n\n<hr>\n\n<p>As to your question... one thing you could do is to define the <code>Datastore</code> interface inside the <code>user</code> package and have the implementation live in another package, this lends itself nicely for when you need different implementations of one interface. If you do this your <code>user</code> package does not need to know about the <code>datastore</code> package anymore, the <code>datastore</code> package still has to know about the <code>user</code> package though, which is a OK.</p>\n\n<p>An example:</p>\n\n<pre><code>package user\n\nimport (\n    \"context\"\n)\n\ntype DSDatabase interface {\n    CreateUser(ctx context.Context, username string, password []byte) (*User, error)\n    // ...\n}\n\n// This can be set by the package that implements the interface\n// or by any other package that imports the user package and\n// a package that defines an implementation of the interface.\nvar DB DSDatabase\n\ntype User struct {\n    // ...\n}\n\nfunc CreateUserPOST(w http.ResponseWriter, r *http.Request) {\n    // get formdata and such\n    DB.CreateUser(ctx, \"username\", []byte(\"password\"))\n}\n</code></pre>\n\n<p>The package with the implementation of the interface:</p>\n\n<pre><code>package datastore\n\nimport (\n    \"context\"\n    \"github.com/username/projectname/user\"\n)\n\n// DB implements the user.DSDatabase interface.\ntype DB struct { /* ... */ }\n\nfunc (db *DB) CreateUser(ctx context.Context, username string) (*user.User, error) {\n    key := datastore.NameKey(\"User\", username, nil)\n    var user user.User\n    err := db.client.Get(ctx, key, &amp;user)\n    if err != nil {\n        return nil, err\n    }\n    return &amp;user, nil\n}\n\nfunc init() {\n    // make sure to initialize the user.DB variable that\n    // is accessed by the CreateUserPOST func or else you'll\n    // get nil reference panic.\n    user.DB = &amp;DB{}\n}\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 1, "is_answered": true, "view_count": 6398, "favorite_count": 1, "accepted_answer_id": 43301741, "answer_count": 1, "score": 2, "last_activity_date": 1491697311, "creation_date": 1491688313, "question_id": 43300723, "link": "https://stackoverflow.com/questions/43300723/overcoming-import-cycle-not-allowed-in-go", "title": "Overcoming import cycle not allowed in Go", "body": "<p>I understand the problem, as per the answer <a href=\"https://stackoverflow.com/questions/28256923/import-cycle-not-allowed\">here</a>, however, I could really use help or a more detailed code explanation of how it's overcome.</p>\n\n<p>My situation is this: I used to have models and controllers separated, and in my models package I had a datastore.go file containing an interface of all the model functions:</p>\n\n<pre><code>package models\n\ntype DSDatabase interface {\n    CreateUser(ctx context.Context, username string, password []byte) (*datastore.Key, error)\n    // More model functions\n}\n\ntype datastoreDB struct {\n    client *datastore.Client\n}\n\nvar (\n    DB DSDatabase\n    _  DSDatabase = &amp;datastoreDB{}\n)\n\nfunc init() {\n    // init datastore\n}\n</code></pre>\n\n<p>This was all fine because the model functions were also located within the models package, so my functions in the controller package could freely call <code>models.DB.CreateUser(ctx, \"username\", []byte(\"password\"))</code>.</p>\n\n<p>Now, I have decided to move all the above code to a <code>datastore</code> package, whereas the model for <code>CreateUser</code> is located in a <code>user</code> package. In other words, <code>package user</code> now contains both controller and model functions, for which the controller related functions rely on <code>datastore</code> package, while the <code>DSDatabase</code> interface rely on the <code>user</code> model functions.</p>\n\n<p>I would really appreciate help figuring out how to overcome the import cycle while keeping the <code>DSDatastore</code> interface separate from all the other packages such as <code>home</code> and <code>user</code>.</p>\n\n<hr>\n\n<p>in case the above is not clear enough, the above code has changed to:</p>\n\n<pre><code>package datastore\n\nimport (\n    \"github.com/username/projectname/user\"\n)\n\ntype DSDatabase interface {\n    user.CreateUser(ctx context.Context, username string, passwoUserRegister(ctx context.Context, username string, password []byte) (*datastore.Key, error)\n}\n\n...\n</code></pre>\n\n<p>while in my <code>user</code> package I have this in a controller-related file:</p>\n\n<pre><code>package user\n\nimport (\n    \"github.com/username/projectname/datastore\"\n)\n\nfunc CreateUserPOST(w http.ResponseWriter, r *http.Request) {\n    // get formdata and such\n    datastore.DB.CreateUser(ctx, \"username\", []byte(\"password\"))\n}\n</code></pre>\n\n<p>and in another model-related file I have:</p>\n\n<pre><code>package user\n\nimport (\n    \"github.com/username/projectname/datastore\"\n)\n\nfunc (db *datastore.datastoreDB) CreateUser(ctx context.Context, username string) (*User, error) {\n    key := datastore.NameKey(\"User\", username, nil)\n    var user User\n    err := db.client.Get(ctx, key, &amp;user)\n    if err != nil {\n        return nil, err\n    }\n    return &amp;user, nil\n}\n</code></pre>\n\n<p>Which of course results in an import cycle, that I sadly can't figure out how to overcome..</p>\n"}, {"tags": ["http", "go", "driver", "arangodb"], "comments": [{"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1491682830, "post_id": 43299845, "comment_id": 73665477, "body": "What driver do you use?"}, {"owner": {"reputation": 175, "user_id": 2621207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51d1a42a27ccc081b2a1c68882665e4?s=128&d=identicon&r=PG&f=1", "display_name": "makeshyft_tom", "link": "https://stackoverflow.com/users/2621207/makeshyft-tom"}, "reply_to_user": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1491751134, "post_id": 43299845, "comment_id": 73681329, "body": "I haven&#39;t used one yet...trying to decide which way to go. thanks though"}], "answers": [{"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 2, "last_activity_date": 1491724100, "last_edit_date": 1491724100, "creation_date": 1491683223, "answer_id": 43300017, "question_id": 43299845, "link": "https://stackoverflow.com/questions/43299845/golang-driver-or-http/43300017#43300017", "title": "Golang Driver or HTTP?", "body": "<p>Quick scanning through the 3 recommended drivers shows they use HTTP under the hood.\nSo using them will not give you big difference in DB interaction, but may be more comfortable for development.</p>\n"}], "owner": {"reputation": 175, "user_id": 2621207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51d1a42a27ccc081b2a1c68882665e4?s=128&d=identicon&r=PG&f=1", "display_name": "makeshyft_tom", "link": "https://stackoverflow.com/users/2621207/makeshyft-tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 43300017, "answer_count": 1, "score": 1, "last_activity_date": 1491724100, "creation_date": 1491681920, "question_id": 43299845, "link": "https://stackoverflow.com/questions/43299845/golang-driver-or-http", "title": "Golang Driver or HTTP?", "body": "<p>Just wondering if anyone can help me understand the advantages of talking to Arango via HTTP or the driver? In my case the GoLang driver.</p>\n\n<p>Aside from the few milliseconds overhead per request,would I experience a big difference in performance?</p>\n\n<p>I like the concurrency attributes of using HTTP Requests, since my main tools all make HTTP communication very easy.</p>\n\n<p>Thanks for any insights on this subject.</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 660, "user_id": 4241562, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002353044375/picture?type=large", "display_name": "Krishna Chaitanya Kornepati", "link": "https://stackoverflow.com/users/4241562/krishna-chaitanya-kornepati"}, "edited": false, "score": 0, "creation_date": 1491677116, "post_id": 43298575, "comment_id": 73663484, "body": "In this case, <code>*Deamon</code> implements imageBackend not <code>Deamon</code>. In Go, both are different."}], "answers": [{"comments": [{"owner": {"reputation": 660, "user_id": 4241562, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002353044375/picture?type=large", "display_name": "Krishna Chaitanya Kornepati", "link": "https://stackoverflow.com/users/4241562/krishna-chaitanya-kornepati"}, "edited": false, "score": 1, "creation_date": 1491677302, "post_id": 43299018, "comment_id": 73663538, "body": "I think in this case, <code>*Deamon</code>(pointer of <code>Deamon</code> type) implements <code>imageBackend</code> interface not <code>Deamon</code>."}], "tags": [], "owner": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "is_accepted": true, "score": 4, "last_activity_date": 1491678118, "last_edit_date": 1491678118, "creation_date": 1491677068, "answer_id": 43299018, "question_id": 43298575, "link": "https://stackoverflow.com/questions/43298575/golang-is-it-safe-to-say-that-if-a-struct-implements-a-method-then-it-satisfies/43299018#43299018", "title": "Golang: Is it safe to say that if a struct implements a method then it satisfies all interfaces that define that method&#39;s signature?", "body": "<p>Yes, <code>Daemon</code> does implement the <code>imageBackend</code> interface (as pointed out in the comments, it's actually the <code>*Daemon</code> type that implements the interface). All of <code>imageBackend</code>'s methods are implemented in various source code files inside the <code>daemon</code> package (mostly the <code>image_*.go</code> ones).</p>\n\n<p>In the <code>image_routes.go</code> the <code>postImagesPrune</code> <a href=\"https://github.com/docker/docker/blob/master/api/server/router/image/image_routes.go#L329\" rel=\"nofollow noreferrer\">method is called</a>, which in turn <a href=\"https://github.com/docker/docker/blob/master/api/server/router/image/image_routes.go#L339\" rel=\"nofollow noreferrer\">calls the</a> <code>ImagesPrune</code> method of <code>s.backend</code>. <code>s</code> is a pointer to the instance of <code>imageRouter</code>.</p>\n\n<pre><code>type imageRouter struct {\n    backend Backend\n    decoder httputils.ContainerDecoder\n    routes  []router.Route\n}\n</code></pre>\n\n<p>This <code>imageRouter</code> instance is initialized with <code>backend</code> set to an instance of <code>Daemon</code> in <code>cmd/dockerd/daemon.go</code> <a href=\"https://github.com/docker/docker/blob/master/cmd/dockerd/daemon.go#L484\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>So when <code>s.backend.ImagesPrune</code> is called, it is running the <code>ImagesPrune</code> method of the Docker Daemon, which as you point out above is in <code>daemon/prune.go</code>.</p>\n"}], "owner": {"reputation": 165, "user_id": 3015101, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000322925739/picture?type=large", "display_name": "cafed00d", "link": "https://stackoverflow.com/users/3015101/cafed00d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 43299018, "answer_count": 1, "score": 2, "last_activity_date": 1491678118, "creation_date": 1491674679, "question_id": 43298575, "link": "https://stackoverflow.com/questions/43298575/golang-is-it-safe-to-say-that-if-a-struct-implements-a-method-then-it-satisfies", "title": "Golang: Is it safe to say that if a struct implements a method then it satisfies all interfaces that define that method&#39;s signature?", "body": "<p>In the docker source repo,\nthere exists an interface in <a href=\"https://github.com/docker/docker/blob/master/api/server/router/image/backend.go#L33\" rel=\"nofollow noreferrer\">image/backend.go</a>:</p>\n\n<pre><code>type imageBackend interface {\n    ....\n    ImagesPrune(pruneFilters filters.Args) (*types.ImagesPruneReport, error)\n}\n</code></pre>\n\n<p>and, there is an implementation in <a href=\"https://github.com/docker/docker/blob/master/daemon/prune.go#L85-L190\" rel=\"nofollow noreferrer\">daemon/prune.go</a>:</p>\n\n<pre><code>func (daemon *Daemon) ImagesPrune(pruneFilters filters.Args) (*types.ImagesPruneReport, error) {\n    ... implementation details ...\n}\n</code></pre>\n\n<p>Does this mean it's correct to say that <code>Daemon</code> implements the <code>imageBackend</code> interface?</p>\n\n<p><strong>Background:</strong>\nI'm trying to understand how calling <code>docker system prune</code> cmd invokes the <code>ImagesPrune</code> function in <code>daemon.go</code>. I could trace the code flow as:</p>\n\n<blockquote>\n  <p><code>cli/../system/prune.go\n  -&gt; cli/../prune/prune.go\n  -&gt; cli/../image/prune.go\n  -&gt; client/image_prune.go\n  -&gt; api/server/..image/image_routes.go\n  -&gt; api/server/../image/backend.go \n  -----&gt; ??? ----&gt; daemon/prune.go</code></p>\n</blockquote>\n\n<p>I don't know what comes in the <code>???</code> section above.</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 7696667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50ed88939615e49d8cd7f8a372f18799?s=128&d=identicon&r=PG&f=1", "display_name": "Pizzas", "link": "https://stackoverflow.com/users/7696667/pizzas"}, "edited": false, "score": 0, "creation_date": 1491670214, "post_id": 43297579, "comment_id": 73661110, "body": "Thank you for the succinct explanation, Cerise. I&#39;m not sure I completely understand the idea of &quot;blocking&quot;.   Does this mean that the receiving for loop is stuck waiting forever? Is this because the ok on the left-hand side of the code below receives true, but there will never be another num to give?  if num, ok := &lt;-ch; !ok"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 319, "user_id": 7696667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50ed88939615e49d8cd7f8a372f18799?s=128&d=identicon&r=PG&f=1", "display_name": "Pizzas", "link": "https://stackoverflow.com/users/7696667/pizzas"}, "edited": false, "score": 0, "creation_date": 1491670518, "post_id": 43297579, "comment_id": 73661216, "body": "@Pizzas: <a href=\"https://en.wikipedia.org/wiki/Blocking_(computing)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Blocking_(computing)</a> In your case, <code>num, ok := &lt;-ch</code> is blocking (waiting for another response). That other response never comes, because the sending go routine exited already. If you close the channel in the sending go routine, then another response (indicating that the channel closed) <i>is</i> received."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 319, "user_id": 7696667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50ed88939615e49d8cd7f8a372f18799?s=128&d=identicon&r=PG&f=1", "display_name": "Pizzas", "link": "https://stackoverflow.com/users/7696667/pizzas"}, "edited": false, "score": 0, "creation_date": 1491671725, "post_id": 43297579, "comment_id": 73661712, "body": "@Pizzas  Receive on an open channel waits for a value to be sent to the channel.  The receive loop waits forever after all values from the sending goroutine are received."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1491671428, "last_edit_date": 1491671428, "creation_date": 1491669116, "answer_id": 43297579, "question_id": 43297474, "link": "https://stackoverflow.com/questions/43297474/deadlock-between-goroutines/43297579#43297579", "title": "Deadlock between goroutines", "body": "<p>The receiving for loop blocks on receive from <code>ch</code> after receiving all values from the sending goroutine. The runtime detects that the program is stuck and panics.</p>\n\n<p>The fix is to close the channel after sending all values:</p>\n\n<pre><code>go func() { \n    for i := 0; i &lt; 10; i++ {\n        ch &lt;- i\n    }\n    close(ch)\n} ()\n</code></pre>\n\n<p>Receive on the closed channel yields the value <code>0, false</code>. The receiving for loop breaks on the false value.</p>\n\n<p>Remove <code>close(ch)</code> from the end of the program.</p>\n\n<p><a href=\"https://play.golang.org/p/niuey98gzz\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2694, "user_id": 1280320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/922b107850370d90a2a8d7e6a0cfbd07?s=128&d=identicon&r=PG", "display_name": "RaviTezu", "link": "https://stackoverflow.com/users/1280320/ravitezu"}, "is_accepted": false, "score": 2, "last_activity_date": 1491670455, "last_edit_date": 1491670455, "creation_date": 1491669261, "answer_id": 43297610, "question_id": 43297474, "link": "https://stackoverflow.com/questions/43297474/deadlock-between-goroutines/43297610#43297610", "title": "Deadlock between goroutines", "body": "<p>Because you're not closing the channel before the first goroutine exits. The below code should work. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    ch := make(chan int)\n    go func() { \n        for i := 0; i &lt; 10; i++ {\n            ch &lt;- i\n        }\n        close(ch)\n    } ()\n    //go func() { \n        for {\n            if num, ok := &lt;-ch; !ok {\n                break\n            } else {\n                fmt.Printf(\"%d\\n\", num)\n            }\n        }\n    //} ()\n    time.Sleep(2 * time.Second)\n}\n</code></pre>\n\n<p>Try it out here: <a href=\"https://play.golang.org/p/OdxNqbaZmj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/OdxNqbaZmj</a></p>\n"}], "owner": {"reputation": 319, "user_id": 7696667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50ed88939615e49d8cd7f8a372f18799?s=128&d=identicon&r=PG&f=1", "display_name": "Pizzas", "link": "https://stackoverflow.com/users/7696667/pizzas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 43297579, "answer_count": 2, "score": 1, "last_activity_date": 1491671428, "creation_date": 1491668566, "last_edit_date": 1491669010, "question_id": 43297474, "link": "https://stackoverflow.com/questions/43297474/deadlock-between-goroutines", "title": "Deadlock between goroutines", "body": "<p>I'm new to Go. When I comment out the second goroutine, there is a fatal error. I don't understand what causes this error to occur. Can you explain it to me?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    ch := make(chan int)\n    go func() { \n        for i := 0; i &lt; 10; i++ {\n            ch &lt;- i\n        }\n    } ()\n    // go func() { \n        for {\n            if num, ok := &lt;-ch; !ok {\n                break\n            } else {\n                fmt.Printf(\"%d\\n\", num)\n            }\n        }\n    // } ()\n    time.Sleep(2 * time.Second)\n    close(ch)\n}\n</code></pre>\n\n<p>This prints the following code:</p>\n\n<pre><code>0\n1\n2\n3\n4\n5\n6\n7\n8\n9\nfatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [chan receive]:\nmain.main()\n    /tmp/sandbox169127128/main.go:17 +0xa0\n\nProgram exited.\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491665546, "post_id": 43295812, "comment_id": 73658522, "body": "I agree with that article, and I have also been able to tell from personal experience that throwing it all into a <code>controllers</code> package will become a disaster as the codebase continue to increase. but from what I can understand, there&#39;s nothing wrong with having two <code>package user</code> where one is located with the other controller files, and the other with the model files?"}, {"owner": {"reputation": 19854, "user_id": 249630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b354fcaee552e9d6367cf7b69c1282e0?s=128&d=identicon&r=PG", "display_name": "lucapette", "link": "https://stackoverflow.com/users/249630/lucapette"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491665828, "post_id": 43295812, "comment_id": 73658625, "body": "I think it goes against the idea you have one package for responsability. The author uses user as a suggestion in the paragraph. ` package mngtservice` with all the code related to the user responsability in your system"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491667814, "post_id": 43295812, "comment_id": 73660242, "body": "Hmm, on one hand I feel it would be smart to make a package called <code>users</code> which contained files like <code>router.go</code>, <code>models.go</code>, <code>profile.go</code>, <code>register.go</code>, etc.. on the other hand, that would mean abandoning the MVC structure where I can nicely place these directories inside models and controllers directories. How would you suggest naming the directory which contained all these web-app related features if I can&#39;t place them inside controllers/models directories?"}, {"owner": {"reputation": 19854, "user_id": 249630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b354fcaee552e9d6367cf7b69c1282e0?s=128&d=identicon&r=PG", "display_name": "lucapette", "link": "https://stackoverflow.com/users/249630/lucapette"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491668778, "post_id": 43295812, "comment_id": 73660589, "body": "I personally called api in my latest project. It contains all the code for setting up endpoints, cors, different kind of requests. Maybe web? It&#39;s a bit too generic though. Naming is so hard! :)"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 1, "creation_date": 1491669462, "post_id": 43295812, "comment_id": 73660821, "body": "Hah yeah, I considered <code>web</code>, <code>app</code>, <code>modules</code>, <code>routes</code>, etc., but it doesn&#39;t give me the same satisfaction as <code>models</code> and <code>controllers</code>.. but thanks for everything, I think my project structure will improve a lot thanks to you :)"}, {"owner": {"reputation": 19854, "user_id": 249630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b354fcaee552e9d6367cf7b69c1282e0?s=128&d=identicon&r=PG", "display_name": "lucapette", "link": "https://stackoverflow.com/users/249630/lucapette"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1491674328, "post_id": 43295812, "comment_id": 73662610, "body": "You&#39;re more than welcome. All the credit goes to rakyll though. I learn something every times she publishes an article!"}], "tags": [], "owner": {"reputation": 19854, "user_id": 249630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b354fcaee552e9d6367cf7b69c1282e0?s=128&d=identicon&r=PG", "display_name": "lucapette", "link": "https://stackoverflow.com/users/249630/lucapette"}, "is_accepted": true, "score": 4, "last_activity_date": 1491664636, "creation_date": 1491664636, "answer_id": 43295812, "question_id": 43295691, "link": "https://stackoverflow.com/questions/43295691/identical-package-names-in-different-folders-for-same-project/43295812#43295812", "title": "Identical package names in different folders for same project", "body": "<p>I suggest you read <a href=\"https://rakyll.org/style-packages/\" rel=\"nofollow noreferrer\">style guideline for Go packages</a>. It's a fantastic read and contains the best advice I found on the subject when it comes to project layout in Go. I'm having hard times suggesting you a naming for your specific case though because it depends too much on the kind of functionality your system has. Sometimes, I think of it as a \"package per part of the application\". But I understand my description may result too personal and not very helpful.</p>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6949, "favorite_count": 2, "accepted_answer_id": 43295812, "answer_count": 1, "score": 2, "last_activity_date": 1491670610, "creation_date": 1491663937, "last_edit_date": 1491670610, "question_id": 43295691, "link": "https://stackoverflow.com/questions/43295691/identical-package-names-in-different-folders-for-same-project", "title": "Identical package names in different folders for same project", "body": "<p>I'm working on a big project which will likely end up containing tens of thousands of line of code, for the current structure I do like this:</p>\n\n<pre><code>main.go\ncontrollers/NAME.go\nmodels/NAME.go\n</code></pre>\n\n<p>The problem with that is that the controllers and models directory contains a lot of files, all using <code>package controllers</code> and <code>package models</code>. I was therefore thinking about splitting it up like this:</p>\n\n<pre><code>main.go\ncontrollers/user/NAME.go\nmodels/user/NAME.go\n</code></pre>\n\n<p>Where the user files in the controllers package might contain files like <code>routes.go</code>, <code>profile.go</code>, etc.</p>\n\n<p>Now, I read that it's bad practice to name packages like <code>controllersUser</code> or <code>controllers_user</code>, but I worry it might be a bad idea to name both as <code>package user</code> since they're a part of the same project (even if they're located in different directories).</p>\n\n<p>What kind of naming structure would you recommend given my situation?</p>\n\n<p>I realize that the files located in controllers/user will not be able to interact with models/user even through they share the same <code>package user</code> name (unless I import of course), and I also know that I can easy import both as <code>userControllers \"controllers/user\"</code> and <code>userModels \"models/user\"</code>, but I wonder if it's a bad practice to do like this?</p>\n"}, {"tags": ["node.js", "go", "npm", "nodes"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1491661007, "post_id": 43294830, "comment_id": 73657109, "body": "This might help <a href=\"https://github.com/golang/go/issues/3441\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/3441</a>."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 6550928, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/JkQ6l.jpg?s=128&g=1", "display_name": "Kiran Kumar", "link": "https://stackoverflow.com/users/6550928/kiran-kumar"}, "edited": false, "score": 0, "creation_date": 1491663698, "post_id": 43295619, "comment_id": 73657974, "body": "Hello Alex Efimov, actually i have not installed mingw, i tried installing from <a href=\"https://sourceforge.net/projects/mingw-w64/\" rel=\"nofollow noreferrer\">sourceforge.net/projects/mingw-w64</a> and from <a href=\"https://mingw-w64.org/doku.php\" rel=\"nofollow noreferrer\">mingw-w64.org/doku.php</a> but it didn&#39;t work. That is why i posted this question online. Can you please suggest me how to install the proper 64-bit mingw."}, {"owner": {"reputation": 127, "user_id": 6550928, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/JkQ6l.jpg?s=128&g=1", "display_name": "Kiran Kumar", "link": "https://stackoverflow.com/users/6550928/kiran-kumar"}, "edited": false, "score": 0, "creation_date": 1491664068, "post_id": 43295619, "comment_id": 73658072, "body": "FYI: Am using windows machine"}, {"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "reply_to_user": {"reputation": 127, "user_id": 6550928, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/JkQ6l.jpg?s=128&g=1", "display_name": "Kiran Kumar", "link": "https://stackoverflow.com/users/6550928/kiran-kumar"}, "edited": false, "score": 0, "creation_date": 1491664483, "post_id": 43295619, "comment_id": 73658213, "body": "What impediments where there? What version of windows are you using?"}, {"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "reply_to_user": {"reputation": 127, "user_id": 6550928, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/JkQ6l.jpg?s=128&g=1", "display_name": "Kiran Kumar", "link": "https://stackoverflow.com/users/6550928/kiran-kumar"}, "edited": false, "score": 1, "creation_date": 1491664645, "post_id": 43295619, "comment_id": 73658268, "body": "You could install <a href=\"https://cygwin.com/install.html\" rel=\"nofollow noreferrer\">cygwin.com/install.html</a> for 64-bit system, it contains mingw."}, {"owner": {"reputation": 127, "user_id": 6550928, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/JkQ6l.jpg?s=128&g=1", "display_name": "Kiran Kumar", "link": "https://stackoverflow.com/users/6550928/kiran-kumar"}, "edited": false, "score": 0, "creation_date": 1491664689, "post_id": 43295619, "comment_id": 73658277, "body": "AM using windows7. Am using go1.8 of 64 bit, when i build my project i get the above error and i have to install gcc (done through mingw). Plus &quot;gcc -v&quot; gives the error  &#39;gcc&#39; is not recognized as an internal or external command, operable program or batch file."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 127, "user_id": 6550928, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/JkQ6l.jpg?s=128&g=1", "display_name": "Kiran Kumar", "link": "https://stackoverflow.com/users/6550928/kiran-kumar"}, "edited": false, "score": 0, "creation_date": 1491667090, "post_id": 43295619, "comment_id": 73659049, "body": "@KiranKumar: I use <a href=\"http://tdm-gcc.tdragon.net/download\" rel=\"nofollow noreferrer\">TDM-GCC</a> for the TDM64 MinGW-w64 edition."}], "tags": [], "owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "is_accepted": true, "score": 1, "last_activity_date": 1491663481, "creation_date": 1491663481, "answer_id": 43295619, "question_id": 43294830, "link": "https://stackoverflow.com/questions/43294830/cc1-exe-sorry-unimplemented-64-bit-mode-not-compiled-in-exit-status-2-exit-st/43295619#43295619", "title": "cc1.exe: sorry, unimplemented: 64-bit mode not compiled in exit status 2 exit status 1", "body": "<blockquote>\n  <p>This error is usually caused by having a 64bit Go and 32bit MinGW gcc installed in PATH</p>\n</blockquote>\n\n<p><a href=\"https://github.com/ethereum/go-ethereum/issues/2602\" rel=\"nofollow noreferrer\">https://github.com/ethereum/go-ethereum/issues/2602</a></p>\n\n<p>You can check your MinGW version with:</p>\n\n<pre><code>$ gcc -v\nUsing built-in specs.\nCOLLECT_GCC=C:\\MinGW\\bin\\gcc.exe\nCOLLECT_LTO_WRAPPER=c:/mingw/bin/../libexec/gcc/mingw32/4.8.1/lto-wrapper.exe\nTarget: mingw32\nConfigured with: ../gcc-4.8.1/configure --prefix=/mingw --host=mingw32 --build=m\ningw32 --without-pic --enable-shared --enable-static --with-gnu-ld --enable-lto\n--enable-libssp --disable-multilib --enable-languages=c,c++,fortran,objc,obj-c++\n,ada --disable-sjlj-exceptions --with-dwarf2 --disable-win32-registry --enable-l\nibstdcxx-debug --enable-version-specific-runtime-libs --with-gmp=/usr/src/pkg/gm\np-5.1.2-1-mingw32-src/bld --with-mpc=/usr/src/pkg/mpc-1.0.1-1-mingw32-src/bld --\nwith-mpfr= --with-system-zlib --with-gnu-as --enable-decimal-float=yes --enable-\nlibgomp --enable-threads --with-libiconv-prefix=/mingw32 --with-libintl-prefix=/\nmingw --disable-bootstrap LDFLAGS=-s CFLAGS=-D_USE_32BIT_TIME_T\nThread model: win32\ngcc version 4.8.1 (GCC)\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 6550928, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/JkQ6l.jpg?s=128&g=1", "display_name": "Kiran Kumar", "link": "https://stackoverflow.com/users/6550928/kiran-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1732, "favorite_count": 0, "accepted_answer_id": 43295619, "answer_count": 1, "score": -2, "last_activity_date": 1491663481, "creation_date": 1491658780, "question_id": 43294830, "link": "https://stackoverflow.com/questions/43294830/cc1-exe-sorry-unimplemented-64-bit-mode-not-compiled-in-exit-status-2-exit-st", "title": "cc1.exe: sorry, unimplemented: 64-bit mode not compiled in exit status 2 exit status 1", "body": "<p>I get this error when i try to build my go project.</p>\n\n<p>Any idea what this error means and how this can be resolved.</p>\n\n<p>FYI: this project also uses nodejs assets.</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "edited": false, "score": 0, "creation_date": 1491660367, "post_id": 43294449, "comment_id": 73656890, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/36683911/go-slices-capacity-length\">Go slices - capacity/length?</a> (answer: &quot;the capacity will be the first element till the last of the backing array&quot;)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1491663763, "post_id": 43294449, "comment_id": 73657992, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/16748330/does-go-have-no-real-way-to-shrink-a-slice-is-that-an-issue\">Does Go have no real way to shrink a slice? Is that an issue?</a>"}, {"owner": {"reputation": 1203, "user_id": 4693568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H7pQG.jpg?s=128&g=1", "display_name": "Ja8zyjits", "link": "https://stackoverflow.com/users/4693568/ja8zyjits"}, "edited": false, "score": 0, "creation_date": 1593435950, "post_id": 43294449, "comment_id": 110772222, "body": "other new comers can read this answer <a href=\"https://stackoverflow.com/a/62638755/4693568\">stackoverflow.com/a/62638755/4693568</a>."}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 7696667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50ed88939615e49d8cd7f8a372f18799?s=128&d=identicon&r=PG&f=1", "display_name": "Pizzas", "link": "https://stackoverflow.com/users/7696667/pizzas"}, "edited": false, "score": 1, "creation_date": 1491661971, "post_id": 43295014, "comment_id": 73657407, "body": "Thank you, Alex. The link was very helpful.   I didn&#39;t quite follow the diagram that you posted here until I reviewed the diagram above it in the link. (I didn&#39;t understand that the blue, purple, and pink squares represented the internals of a slice.)"}, {"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "reply_to_user": {"reputation": 319, "user_id": 7696667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50ed88939615e49d8cd7f8a372f18799?s=128&d=identicon&r=PG&f=1", "display_name": "Pizzas", "link": "https://stackoverflow.com/users/7696667/pizzas"}, "edited": false, "score": 0, "creation_date": 1491662441, "post_id": 43295014, "comment_id": 73657579, "body": "I have updated the answer to make more understandable."}, {"owner": {"reputation": 420, "user_id": 2918979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4204c6610f7cc6fcebdd6b34c3a28716?s=128&d=identicon&r=PG&f=1", "display_name": "carnicer", "link": "https://stackoverflow.com/users/2918979/carnicer"}, "edited": false, "score": 10, "creation_date": 1526896331, "post_id": 43295014, "comment_id": 87905832, "body": "When I was reading the golang tutorial I asked myself the same question. Alex answers perfectly here, and I believe it&#39;s a mistake of the tutorial authors not to explain why this behaviour."}], "tags": [], "owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "is_accepted": true, "score": 23, "last_activity_date": 1523372782, "last_edit_date": 1523372782, "creation_date": 1491659959, "answer_id": 43295014, "question_id": 43294449, "link": "https://stackoverflow.com/questions/43294449/decreasing-slice-capacity/43295014#43295014", "title": "Decreasing slice capacity", "body": "<p>You can read more about slices <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"noreferrer\">here</a>. But I think this passage answers your question:</p>\n\n<blockquote>\n  <p>Slicing does not copy the slice's data. It creates a new slice value that points to the original array. This makes slice operations as efficient as manipulating array indices. Therefore, modifying the elements (not the slice itself) of a re-slice modifies the elements of the original slice.</p>\n</blockquote>\n\n<p>So you cannot recover the slice data if you are assigning it to the same variable.</p>\n\n<p>The capacity decrease is because by dropping the first 2 elements you are changing the pointer to the new slice (slices are referenced by the pointer to the first element).</p>\n\n<p>How slices are represented in the memory:\n<a href=\"https://i.stack.imgur.com/mwulG.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/mwulG.png\" alt=\"def\"></a></p>\n\n<pre><code>make([]byte, 5)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/p2eqp.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/p2eqp.png\" alt=\"memory vis\"></a></p>\n\n<pre><code>s = s[2:4]\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7GnUF.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/7GnUF.png\" alt=\"slice cap decrease\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": -1, "last_activity_date": 1618791712, "creation_date": 1618791712, "answer_id": 67154624, "question_id": 43294449, "link": "https://stackoverflow.com/questions/43294449/decreasing-slice-capacity/67154624#67154624", "title": "Decreasing slice capacity", "body": "<p>You can use a full slice expression:</p>\n<pre><code>package main\n\nfunc main() {\n   s := []int{2, 3, 5, 7, 11, 13}\n   { // example 1\n      t := s[:0]\n      println(cap(t) == 6)\n   }\n   { // example 2\n      t := s[:0:0]\n      println(cap(t) == 0)\n   }\n}\n</code></pre>\n<p><a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Slice_expressions</a></p>\n"}], "owner": {"reputation": 319, "user_id": 7696667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50ed88939615e49d8cd7f8a372f18799?s=128&d=identicon&r=PG&f=1", "display_name": "Pizzas", "link": "https://stackoverflow.com/users/7696667/pizzas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3075, "favorite_count": 4, "accepted_answer_id": 43295014, "answer_count": 2, "score": 25, "last_activity_date": 1618791712, "creation_date": 1491656641, "last_edit_date": 1514787718, "question_id": 43294449, "link": "https://stackoverflow.com/questions/43294449/decreasing-slice-capacity", "title": "Decreasing slice capacity", "body": "<p>My question is about slice length and capacity. I'm learning about Go here: <a href=\"https://tour.golang.org/moretypes/11\" rel=\"noreferrer\">https://tour.golang.org/moretypes/11</a>.</p>\n\n<p>(My question was marked as a possible duplicate of <a href=\"https://stackoverflow.com/questions/36683911/go-slices-capacity-length\">this</a>; however, this is not the case. My question is specifically about the cutting off the first few elements of a slice and the implications of that.)</p>\n\n<p>Why does the line <code>s = s[2:]</code> decrease the capacity when <code>s = s[:4]</code> and <code>s = s[:0]</code> do not? The only difference I see is that there is a number before the colon in <code>s = s[2:]</code> while there is a number after the colon in the other two lines.</p>\n\n<p>Is there any way to recover the first two elements that we cut off with <code>s = s[2:]</code>?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    s := []int{2, 3, 5, 7, 11, 13}\n    printSlice(s)\n\n    // Slice the slice to give it zero length.\n    s = s[:0]\n    printSlice(s)\n\n    // Extend its length.\n    s = s[:4]\n    printSlice(s)\n\n    // Drop its first two values.\n    s = s[2:]\n    printSlice(s)\n}\n\nfunc printSlice(s []int) {\n    fmt.Printf(\"len=%d cap=%d %v\\n\", len(s), cap(s), s)\n}\n</code></pre>\n\n<p>After clicking the Run button, we get the following.</p>\n\n<pre><code>len=6 cap=6 [2 3 5 7 11 13]\nlen=0 cap=6 []\nlen=4 cap=6 [2 3 5 7]\nlen=2 cap=4 [5 7]\n</code></pre>\n"}, {"tags": ["mongodb", "model-view-controller", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1491659192, "post_id": 43294213, "comment_id": 73656509, "body": "I guess this would depend on what you mean by view, are you using some framework that has a view type? If yes it would help if you mention that in your question. Or are you talking in purely abstract terms? Then in pure Go, you would load those objects from mongo into a <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow noreferrer\">slice</a> and then use the <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">html/template package</a> to render the contents of that slice however you want... But really you should show what you&#39;ve tried so far, show some code, or else you might have a difficult time getting help on SO."}, {"owner": {"reputation": 7990, "user_id": 4806357, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KlW5A.jpg?s=128&g=1", "display_name": "Jarvis", "link": "https://stackoverflow.com/users/4806357/jarvis"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491665814, "post_id": 43294213, "comment_id": 73658616, "body": "By view, I mean an HTML page. @mkopriva"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491665912, "post_id": 43294213, "comment_id": 73658650, "body": "In that case I think you can use the already mentioned <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">html/template</a> for what you trying to do."}, {"owner": {"reputation": 7990, "user_id": 4806357, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KlW5A.jpg?s=128&g=1", "display_name": "Jarvis", "link": "https://stackoverflow.com/users/4806357/jarvis"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491666259, "post_id": 43294213, "comment_id": 73658765, "body": "But I need to display the result in a form of table with non-fixed number of table rows since my database can have any number of entries, how to do that ? @mkopriva"}, {"owner": {"reputation": 7990, "user_id": 4806357, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KlW5A.jpg?s=128&g=1", "display_name": "Jarvis", "link": "https://stackoverflow.com/users/4806357/jarvis"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491666298, "post_id": 43294213, "comment_id": 73658774, "body": "Basically, I need to print a list from my database on the HTML page, how to do that ? @mkopriva"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491666824, "post_id": 43294213, "comment_id": 73658947, "body": "You would use <code>range</code> to loop over your data inside the template and render it on the page. See example here: <a href=\"https://play.golang.org/p/kTQi9ouV15\" rel=\"nofollow noreferrer\">play.golang.org/p/kTQi9ouV15</a>. Read the <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\">text/template</a> documentation for how to program your templates. Note that package text/template is not the same as package html/template but the interface for programming the templates is the same."}, {"owner": {"reputation": 7990, "user_id": 4806357, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KlW5A.jpg?s=128&g=1", "display_name": "Jarvis", "link": "https://stackoverflow.com/users/4806357/jarvis"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491736707, "post_id": 43294213, "comment_id": 73676921, "body": "Can you please give an example/github project since I&#39;m new to GoLang ? @mkopriva I have the HTML page in my <code>static&#47;pages</code> folder and GO source code in <code>model&#47;show_list.go</code> file."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491819163, "post_id": 43294213, "comment_id": 73704988, "body": "Hi @Jarvis, sorry for the late reply, this <a href=\"https://github.com/jimmykuu/gopher\" rel=\"nofollow noreferrer\">jimmykuu/gopher</a> is one project that uses templates without resorting to some unnecessary framework, it also uses mongodb for storage. It&#39;s a chinese website, so the comments are in chinese which i can&#39;t read, but the code is very much readable and not overly complex. As an example take a look at the <a href=\"https://github.com/jimmykuu/gopher/tree/master/templates/book\" rel=\"nofollow noreferrer\">book templates</a> and the <a href=\"https://github.com/jimmykuu/gopher/blob/master/book.go\" rel=\"nofollow noreferrer\">book handlers</a> that render those templates..."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491819244, "post_id": 43294213, "comment_id": 73705040, "body": "... and also take a look at how the <code>renderTemplate</code> method is implemented here: <a href=\"https://github.com/jimmykuu/gopher/blob/master/handler.go#L42\" rel=\"nofollow noreferrer\">github.com/jimmykuu/gopher/blob/master/handler.go#L42</a>. And the book model is defined here: <a href=\"https://github.com/jimmykuu/gopher/blob/master/models.go#L530-L542\" rel=\"nofollow noreferrer\">github.com/jimmykuu/gopher/blob/master/models.go#L530-L542</a>. Hope this helps."}, {"owner": {"reputation": 7990, "user_id": 4806357, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KlW5A.jpg?s=128&g=1", "display_name": "Jarvis", "link": "https://stackoverflow.com/users/4806357/jarvis"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1491882957, "post_id": 43294213, "comment_id": 73736749, "body": "Thanks @mkopriva will do."}], "owner": {"reputation": 7990, "user_id": 4806357, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KlW5A.jpg?s=128&g=1", "display_name": "Jarvis", "link": "https://stackoverflow.com/users/4806357/jarvis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491655238, "creation_date": 1491655238, "question_id": 43294213, "link": "https://stackoverflow.com/questions/43294213/pass-data-from-model-to-view-in-golang", "title": "Pass data from model to view in GoLang", "body": "<p>I am supposed to pass a list of objects which are stored in a MongoDB database from the back-end to the view, where I need to display the content of all the objects as a list (like a table) on an HTML page ? How should I do this given the number of table rows can be dynamic ?</p>\n"}, {"tags": ["go", "google-cloud-platform"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1491651377, "post_id": 43293493, "comment_id": 73654009, "body": "This is likely either from an incorrect use of unsafe, or race conditions. Have you tested your code with the race detector?"}, {"owner": {"reputation": 107, "user_id": 7836768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550083c73775e651fe894122315a87df?s=128&d=identicon&r=PG&f=1", "display_name": "Kieran W.", "link": "https://stackoverflow.com/users/7836768/kieran-w"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491660134, "post_id": 43293493, "comment_id": 73656819, "body": "I just added the stack trace. Race conditions do not show anything. I should mention that at first it appears to run as it&#39;s showing &quot;serving&quot; in the console for 2-3 seconds before it crashes, but looking at the stack trace it looks like it&#39;s choking at the compilation, which is really weird cause sometimes it does compile and run."}, {"owner": {"reputation": 107, "user_id": 7836768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550083c73775e651fe894122315a87df?s=128&d=identicon&r=PG&f=1", "display_name": "Kieran W.", "link": "https://stackoverflow.com/users/7836768/kieran-w"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491816505, "post_id": 43293493, "comment_id": 73703138, "body": "I really hope someone can shed some light on this. This is a boilerplate hello world app.  It&#39;s beyond me how running a few lines of Mux printing &quot;hello&quot; can cause the below message at random using <code>goapp serve</code>:  <code>fatal error: unexpected signal during runtime execution [signal 0xb code=0x1 addr=0x913aada46bc pc=0xf47b]</code>  How can running &#180;goapp serve&#180; consecutively, randomly work or fail, without any changes to anything?  It seems the local Google Cloud development server is screwed up?"}], "owner": {"reputation": 107, "user_id": 7836768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550083c73775e651fe894122315a87df?s=128&d=identicon&r=PG&f=1", "display_name": "Kieran W.", "link": "https://stackoverflow.com/users/7836768/kieran-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1491660067, "creation_date": 1491650851, "last_edit_date": 1491660067, "question_id": 43293493, "link": "https://stackoverflow.com/questions/43293493/goapp-serve-seriously-unstable-with-random-0xb01dfacedebac1e-errors", "title": "goapp serve: seriously unstable with random 0xb01dfacedebac1e errors", "body": "<p>Currently trying out Google Cloud with Go, and I'm having the most bizarre issue I have ever seen.</p>\n\n<p>I have made an ultra simple \"hello world\" app that just prints out some text to the browser. It compiles perfectly with \"<code>go build</code>\", and even deploys to Google Cloud and runs there just fine, but when I use \"<code>goapp serve</code>\" to run it locally it randomly crashes when I start it, with a huge stack trace and the message:</p>\n\n<pre><code>fatal error: unexpected signal during runtime execution\n[signal 0xb code=0x1 addr=0xb01dfacedebac1e pc=0xf47b]\n</code></pre>\n\n<p>When I get the error, I simply run \"<code>goapp serve</code>\" again, and after a few tries it somehow magically decides to work. Other times, if I can't get it to run after 10-20 tries, I simply make a micro change in the code somewhere, like editing a string, changing a single character, and then it runs just fine locally. Whaaaaat!?!?!?</p>\n\n<p>I'm so baffled how this is even possible. I seems that \"<code>goapp serve</code>\" is extremely fragile. It's Google official local development server, so I would expect it to be a little more stable, or at least give some more human readable clues.</p>\n\n<p>I have searched all over and can't find anything related to this.</p>\n\n<p>Any ideas how or what is causing this?</p>\n\n<p>Here is the stack trace:</p>\n\n<pre><code>ERROR   go_runtime.py:181] Failed to build Go application: (Executed command: /usr/local/go_appengine/goroot/bin/go-app-builder -app_base /Users/kieran/Go/src/hello/main -arch 6 -dynamic -goroot /usr/local/go_appengine/goroot -nobuild_files ^^$ -unsafe -gopath /Users/kieran/Go -binary_name _go_app -extra_imports appengine_internal/init -work_dir /var/folders/w3/wrcy8wfn3gzbnphs0cq6yw9r0000gn/T/tmpf_Nrsvappengine-go-bin -gcflags -I,/usr/local/go_appengine/goroot/pkg/darwin_amd64_appengine -ldflags -L,/usr/local/go_appengine/goroot/pkg/darwin_amd64_appengine main.go)\n\nfatal error: unexpected signal during runtime execution\n[signal 0xb code=0x1 addr=0xb01dfacedebac1e pc=0xf47b]\n\nruntime stack:\nruntime.throw(0x2c4ac0, 0x2a)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/panic.go:547 +0x90\nruntime.sigpanic()\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/sigpanic_unix.go:12 +0x5a\nruntime.unlock(0x3aa0c0)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/lock_sema.go:107 +0x14b\nruntime.(*mheap).alloc_m(0x3aa0c0, 0x1, 0x20000000020, 0x8a5178)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/mheap.go:492 +0x314\nruntime.(*mheap).alloc.func1()\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/mheap.go:502 +0x41\nruntime.systemstack(0xc820039e58)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/asm_amd64.s:307 +0xab\nruntime.(*mheap).alloc(0x3aa0c0, 0x1, 0x10000000020, 0xf11f)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/mheap.go:503 +0x63\nruntime.(*mcentral).grow(0x3ac190, 0x0)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/mcentral.go:209 +0x93\nruntime.(*mcentral).cacheSpan(0x3ac190, 0x8a5178)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/mcentral.go:89 +0x47d\nruntime.(*mcache).refill(0x406c20, 0x20, 0x8a5178)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/mcache.go:119 +0xcc\nruntime.mallocgc.func2()\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/malloc.go:642 +0x2b\nruntime.systemstack(0xc820012000)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/asm_amd64.s:291 +0x79\nruntime.mstart()\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/proc.go:1051\n\ngoroutine 1 [running]:\nruntime.systemstack_switch()\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/asm_amd64.s:245 fp=0xc8200329d0 sp=0xc8200329c8\nruntime.mallocgc(0x480, 0x25c640, 0xc800000000, 0xc820074240)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/malloc.go:643 +0x869 fp=0xc820032aa8 sp=0xc8200329d0\nruntime.newarray(0x25c640, 0x18, 0x152be8)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/malloc.go:798 +0xc9 fp=0xc820032ae8 sp=0xc820032aa8\nruntime.makeslice(0x1e6920, 0x18, 0x18, 0x0, 0x0, 0x0)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/slice.go:32 +0x165 fp=0xc820032b38 sp=0xc820032ae8\ncmd/link/internal/ld.readsym(0xc820074240, 0xc825a9e1a0, 0xc821107850, 0x8, 0xc821ecb360, 0x4c)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/cmd/link/internal/ld/objfile.go:239 +0xba6 fp=0xc820032f80 sp=0xc820032b38\ncmd/link/internal/ld.ldobjfile(0xc820074240, 0xc825a9e1a0, 0xc821107850, 0x8, 0xbf902, 0xc821ecb360, 0x4c)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/cmd/link/internal/ld/objfile.go:147 +0xa62 fp=0xc820033190 sp=0xc820032f80\ncmd/link/internal/ld.ldobj(0xc825a9e1a0, 0xc821107850, 0x8, 0xbf93e, 0xc821ecb360, 0x4c, 0xc82326a050, 0x44, 0x1, 0x0)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/cmd/link/internal/ld/lib.go:1351 +0x1569 fp=0xc820033400 sp=0xc820033190\ncmd/link/internal/ld.objfile(0xc82409ce70)\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/cmd/link/internal/ld/lib.go:847 +0x10d9 fp=0xc820033710 sp=0xc820033400\ncmd/link/internal/ld.loadlib()\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/cmd/link/internal/ld/lib.go:513 +0x5ce fp=0xc8200339f0 sp=0xc820033710\ncmd/link/internal/ld.Ldmain()\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/cmd/link/internal/ld/pobj.go:214 +0x1cd3 fp=0xc820033e70 sp=0xc8200339f0\ncmd/link/internal/amd64.Main()\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/cmd/link/internal/amd64/obj.go:44 +0x19 fp=0xc820033e78 sp=0xc820033e70\nmain.main()\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/cmd/link/main.go:27 +0x36f fp=0xc820033f50 sp=0xc820033e78\nruntime.main()\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/proc.go:188 +0x2b0 fp=0xc820033fa0 sp=0xc820033f50\nruntime.goexit()\n    /private/var/folders/9y/ppk2fnqj5lscwqw_l6lhdrx8005bt1/T/appengine/go_appengine/goroot/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820033fa8 sp=0xc820033fa0\n</code></pre>\n"}, {"tags": ["windows", "go", "thread-safety", "channel", "canon-sdk"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1491655598, "post_id": 43292365, "comment_id": 73655343, "body": "Your question may be too complex for SO.  Try to boil it down to a single concern in code."}], "answers": [{"tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": false, "score": 0, "last_activity_date": 1491655571, "creation_date": 1491655571, "answer_id": 43294266, "question_id": 43292365, "link": "https://stackoverflow.com/questions/43292365/calling-functions-inside-a-lockosthread-goroutine/43294266#43294266", "title": "Calling Functions Inside a &quot;LockOSThread&quot; GoRoutine", "body": "<p>For similar embedded projects I've played with, I tend to create a single goroutine worker that listens on a channel to perform all the work over that USB device.  And any results sent back out on another channel.</p>\n\n<p>Talk to the device with channels only in Go in a one-way exchange. LIsten for responses from the other channel.</p>\n\n<p>Since USB is serial and polling, I had to setup a dedicated channel with another goroutine that justs picks items off the channel when they were pushed into it from the worker goroutine that just looped.</p>\n"}], "owner": {"reputation": 363, "user_id": 2656351, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2145f303214260c85edc32b3f701dd9d?s=128&d=identicon&r=PG", "display_name": "iamacarpet", "link": "https://stackoverflow.com/users/2656351/iamacarpet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491655571, "creation_date": 1491643733, "question_id": 43292365, "link": "https://stackoverflow.com/questions/43292365/calling-functions-inside-a-lockosthread-goroutine", "title": "Calling Functions Inside a &quot;LockOSThread&quot; GoRoutine", "body": "<p>I'm writing a package to control a Canon DSLR using their EDSDK DLL from Go.</p>\n\n<p>This is a personal project for a photo booth to use at our wedding at my partners request, which I'll be happy to post on GitHub when complete :).</p>\n\n<p>Looking at the examples of using the SDK elsewhere, it isn't threadsafe and uses thread-local resources, so I'll need to make sure I'm calling it from a single thread during usage. While not ideal, it looks like Go provides a \"runtime.LockOSThread\" function for doing just that, although this does get called by the core DLL interop code itself, so I'll have to wait and find out if that interferes or not.</p>\n\n<p>I want the rest of the application to be able to call the SDK using a higher level interface without worrying about the threading, so I need a way to pass function call requests to the locked thread/Goroutine to execute there, then pass the results back to the calling function outside of that Goroutine.</p>\n\n<p>So far, I've come up with this working example of using very broad function definitions using []interface{} arrays and passing back and forward via channels. This would take a lot of mangling of input/output data on every call to do type assertions back out of the interface{} array, even if we know what we should expect for each function ahead of time, but it looks like it'll work.</p>\n\n<p>Before I invest a lot of time doing it this way for possibly the worst way to do it - does anyone have any better options?</p>\n\n<pre><code>package edsdk\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\ntype CanonSDK struct {\n    FChan           chan functionCall\n}\n\ntype functionCall struct {\n    Function        func([]interface{}) []interface{}\n    Arguments       []interface{}\n    Return          chan []interface{}\n}\n\nfunc NewCanonSDK() (*CanonSDK, error) {\n    c := &amp;CanonSDK {\n        FChan:  make(chan functionCall),\n    }\n\n    go c.BackgroundThread(c.FChan)\n\n    return c, nil\n}\n\nfunc (c *CanonSDK) BackgroundThread(fcalls &lt;-chan functionCall) {\n    runtime.LockOSThread()\n    for f := range fcalls {\n        f.Return &lt;- f.Function(f.Arguments)\n    }\n    runtime.UnlockOSThread()\n}\n\nfunc (c *CanonSDK) TestCall() {\n    ret := make(chan []interface{})\n\n    f := functionCall {\n        Function: c.DoTestCall,\n        Arguments: []interface{}{},\n        Return: ret,\n    }\n\n    c.FChan &lt;- f\n\n    results := &lt;- ret\n    close(ret)\n\n    fmt.Printf(\"%#v\", results)\n}\n\nfunc (c *CanonSDK) DoTestCall([]interface{}) []interface{} {\n    return []interface{}{ \"Test\", nil }\n}\n</code></pre>\n"}, {"tags": ["json", "http", "generics", "go", "types"], "answers": [{"tags": [], "owner": {"reputation": 753, "user_id": 5735646, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1DDfK.jpg?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/5735646/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1491633952, "creation_date": 1491633952, "answer_id": 43291056, "question_id": 43290970, "link": "https://stackoverflow.com/questions/43290970/how-to-generically-marshall-request-into-json-in-golang/43291056#43291056", "title": "How to generically marshall request into JSON in golang", "body": "<p>Modify code of the last line: change <code>user := inter.(models.User)</code> to <code>user := inter.Interface().(models.User)</code>,have a try!</p>\n"}, {"tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1491645212, "last_edit_date": 1491645212, "creation_date": 1491643868, "answer_id": 43292384, "question_id": 43290970, "link": "https://stackoverflow.com/questions/43290970/how-to-generically-marshall-request-into-json-in-golang/43292384#43292384", "title": "How to generically marshall request into JSON in golang", "body": "<blockquote>\n  <p>\"interface conversion: interface {} is reflect.Value, not models.User\"</p>\n</blockquote>\n\n<p>pretty straight forward about the message error. That your <code>item</code> is <code>reflect.Value</code> it is not <code>models.User</code>.</p>\n\n<p>so I think in your code you can change the <code>item</code> <code>to models.User</code>.</p>\n\n<p>But I assume that your are tying to create the function that will work with all type of your models, in this case <code>models.User{}</code>.</p>\n\n<p>Your approach is expensive since it is using <code>interface</code>. you could convert the <code>incoming request</code> directly like this:</p>\n\n<pre><code>func GetTypeFromReq(c *App, ty models.User) (models.User, error) {\n    //get the type we are going to marshall into\n    var item models.User\n\n    //define and set the error that we will be returning to nil\n    var retErr error // this var if the value not define then it is nil. Because error is interface\n\n    //extract the body from the request and defer closing of the body\n    body, err := ioutil.ReadAll(io.LimitReader(c.Request.Body, 1048576))\n    defer c.Request.Body.Close()\n\n    //handle errors and unmarshal our data\n    if err != nil {\n        retErr = errors.New(\"Failed to Read body: \" + err.Error())\n    } else if err = json.Unmarshal(body, &amp;item); err != nil {\n        retErr = errors.New(\"Unmarshal Failed: \" + err.Error())\n    }\n\n    return item, retErr\n}\n</code></pre>\n\n<p>if your <code>body</code> has the same structure as your model it will give you the value, if not then it is <code>error</code>.</p>\n\n<p>Note that you need to be careful when using <code>interface</code>.  you can see some guideline in this <a href=\"https://www.goinggo.net/2016/10/avoid-interface-pollution.html\" rel=\"nofollow noreferrer\">article</a>. Use an interface:</p>\n\n<ul>\n<li>When users of the API need to provide an implementation detail.</li>\n<li>When API\u2019s have multiple implementations they need to maintain internally.</li>\n<li>When parts of the API that can change have been identified and require decoupling.</li>\n</ul>\n\n<p>Your function convert the value of your <code>models.User</code> to <code>interface</code>, and then return the <code>interface</code> value. that's why it's expensive.</p>\n"}, {"comments": [{"owner": {"reputation": 569, "user_id": 5759262, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/10208150398865304/picture?type=large", "display_name": "Sammy Roberts", "link": "https://stackoverflow.com/users/5759262/sammy-roberts"}, "edited": false, "score": 1, "creation_date": 1491673387, "post_id": 43293588, "comment_id": 73662293, "body": "Done, woops. I thought I did."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1491652203, "last_edit_date": 1491652203, "creation_date": 1491651407, "answer_id": 43293588, "question_id": 43290970, "link": "https://stackoverflow.com/questions/43290970/how-to-generically-marshall-request-into-json-in-golang/43293588#43293588", "title": "How to generically marshall request into JSON in golang", "body": "<p>Here's how to modify the the function to make it work as expected:</p>\n\n<pre><code>func GetTypeFromReq(c *App, ty interface{}) (interface{}, error) {\n  // Allocate new value with same type as ty\n  v := reflect.New(reflect.TypeOf(ty))\n\n  //define and set the error that we will be returning to null\n  var retErr error\n  retErr = nil\n\n  //extract the body from the request and defer closing of the body\n  body, err := ioutil.ReadAll(io.LimitReader(c.Request.Body, 1048576))\n  defer c.Request.Body.Close()\n\n  //handle errors and unmarshal our data\n  if err != nil {\n    retErr = errors.New(\"Failed to Read body: \" + err.Error())\n  } else if err = json.Unmarshal(body, v.Interface()); err != nil {\n    retErr = errors.New(\"Unmarshal Failed: \" + err.Error())\n  }\n\n  // v holds a pointer, call Elem() to get the value.\n  return v.Elem().Interface(), retErr\n}\n</code></pre>\n\n<p>Note the calls to <a href=\"https://godoc.org/reflect#Value.Interface\" rel=\"nofollow noreferrer\">Interface()</a> to get a <code>reflect.Value</code>'s current value.</p>\n\n<p>Here's an approach that avoids reflection and type assertions:</p>\n\n<pre><code>func GetFromReq(c *App, item interface{}) error {\n  //extract the body from the request and defer closing of the body\n  body, err := ioutil.ReadAll(io.LimitReader(c.Request.Body, 1048576))\n  defer c.Request.Body.Close()\n\n  //handle errors and unmarshal our data\n  if err != nil {\n    retErr = errors.New(\"Failed to Read body: \" + err.Error())\n  } else if err = json.Unmarshal(body, item); err != nil {\n    retErr = errors.New(\"Unmarshal Failed: \" + err.Error())\n  }\n  return retErr\n}\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>var user models.User\nerr := GetFromReq(&amp;c, &amp;user)\nif err != nil {\n   revel.ERROR.Println(err.Error())\n}\n</code></pre>\n\n<p>Use a <a href=\"https://godoc.org/encoding/json#Decoder\" rel=\"nofollow noreferrer\">JSON decoder</a> to simplify the code:</p>\n\n<pre><code>func GetFromReq(c *App, item interface{}) error {\n  defer c.Request.Body.Close()\n  return json.NewDecoder(io.LimitReader(c.Request.Body, 1048576)).Deocode(item)\n}\n</code></pre>\n\n<p>If <code>c.Request</code> is a <code>*http.Request</code> and <code>c.Response</code> is an <code>http.ResponseWriter</code>, then write the function as:</p>\n\n<pre><code>func GetFromReq(c *App, item interface{}) error {\n  return json.NewDecoder(http.MaxBytesReaer(c.Response, c.Request.Body, 1048576)).Deocode(item)\n}\n</code></pre>\n\n<p>There's no need to close the request body in the net/http server. Use <a href=\"https://godoc.org/net/http#MaxBytesReader\" rel=\"nofollow noreferrer\">MaxBytesReader</a> instead of io.LimitReader to prevents clients from accidentally or maliciously sending a large request and wasting server resources.</p>\n"}], "owner": {"reputation": 569, "user_id": 5759262, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/10208150398865304/picture?type=large", "display_name": "Sammy Roberts", "link": "https://stackoverflow.com/users/5759262/sammy-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1180, "favorite_count": 0, "accepted_answer_id": 43293588, "answer_count": 3, "score": 2, "last_activity_date": 1491652203, "creation_date": 1491633233, "question_id": 43290970, "link": "https://stackoverflow.com/questions/43290970/how-to-generically-marshall-request-into-json-in-golang", "title": "How to generically marshall request into JSON in golang", "body": "<pre><code>package controllers\n\nimport (\n    \"encoding/json\"\n    \"errors\"\n    \"io\"\n    \"io/ioutil\"\n    \"reflect\"\n)\n\nfunc GetTypeFromReq(c *App, ty interface{}) (interface{}, error) {\n    //get the type we are going to marshall into\n    item := reflect.ValueOf(ty)\n\n    //define and set the error that we will be returning to null\n    var retErr error\n    retErr = nil\n\n    //extract the body from the request and defer closing of the body\n    body, err := ioutil.ReadAll(io.LimitReader(c.Request.Body, 1048576))\n    defer c.Request.Body.Close()\n\n    //handle errors and unmarshal our data\n    if err != nil {\n        retErr = errors.New(\"Failed to Read body: \" + err.Error())\n    } else if err = json.Unmarshal(body, &amp;item); err != nil {\n        retErr = errors.New(\"Unmarshal Failed: \" + err.Error())\n    }\n\n    return item, retErr\n}\n</code></pre>\n\n<p>I am trying to pass a type and a request into a function, then inside that function unMarshall the request into a variable and return it.</p>\n\n<p>I assume my approach is wrong because when i try to do this:</p>\n\n<pre><code>inter, err := GetTypeFromReq(&amp;c, models.User{})\nif err != nil {\n    revel.ERROR.Println(err.Error())\n}\nuser := inter.(models.User)\n</code></pre>\n\n<p>I get the error  \"interface conversion: interface {} is reflect.Value, not models.User\"</p>\n\n<p>any tips on how to approach this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1491660318, "post_id": 43290945, "comment_id": 73656869, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/21895756/why-are-floating-point-numbers-inaccurate\">Why Are Floating Point Numbers Inaccurate?</a>"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 1, "creation_date": 1491726594, "post_id": 43290945, "comment_id": 73674351, "body": "It turns out that the OP did not intend to ask about floating points at all, after all, so it is not a duplicate of that question."}], "answers": [{"comments": [{"owner": {"reputation": 731, "user_id": 2438094, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/edvfV.jpg?s=128&g=1", "display_name": "WCGPR0", "link": "https://stackoverflow.com/users/2438094/wcgpr0"}, "edited": false, "score": 0, "creation_date": 1491685936, "post_id": 43291490, "comment_id": 73666391, "body": "Sorry for the bad phrasing of the question, but thanks for pointing me in the right package to use! I noticed this package doesn&#39;t have a log function, is this also I can do with big ints (for example to get the amount of digits in i)?"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "reply_to_user": {"reputation": 731, "user_id": 2438094, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/edvfV.jpg?s=128&g=1", "display_name": "WCGPR0", "link": "https://stackoverflow.com/users/2438094/wcgpr0"}, "edited": false, "score": 1, "creation_date": 1491725895, "post_id": 43291490, "comment_id": 73674149, "body": "There is no Log indeed, but there is BitLen, and lb(n) = BitLen(n)-1 (lb = binary logarithm). From there, Log(n) = lb(n)/lb(10)."}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "reply_to_user": {"reputation": 731, "user_id": 2438094, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/edvfV.jpg?s=128&g=1", "display_name": "WCGPR0", "link": "https://stackoverflow.com/users/2438094/wcgpr0"}, "edited": false, "score": 1, "creation_date": 1491726552, "post_id": 43291490, "comment_id": 73674334, "body": "I edited the question so that it reflects what you intended to ask. This will make it easier to search for this question later. Of course you can still edit it if you feel that my edit was not what you meant to say."}], "tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": true, "score": 5, "last_activity_date": 1491637295, "creation_date": 1491637295, "answer_id": 43291490, "question_id": 43290945, "link": "https://stackoverflow.com/questions/43290945/how-to-work-with-large-integers-in-go/43291490#43291490", "title": "How to work with large integers in Go?", "body": "<p>The question is not really clear to me, but I assume you want to perform operations on large integers and were only using float64 as a try.</p>\n\n<p>In that case, the right tool is the <a href=\"https://golang.org/pkg/math/big/\" rel=\"noreferrer\">math/big package</a>. Here is how to use it to extract the nth decimal digit of an int64:</p>\n\n<pre><code>// first digit is n=0\nfunc nthDigit(i int64, n int64) int64 {\n    var quotient big.Int\n    quotient.Exp(big.NewInt(10), big.NewInt(n), nil)\n\n    bigI := big.NewInt(i)\n    bigI.Div(bigI, &amp;quotient)\n\n    var result big.Int\n    result.Mod(bigI, big.NewInt(10))\n\n    return result.Int64()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4249, "user_id": 1239967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5138999704cfb8feb8fe370419fe151f?s=128&d=identicon&r=PG", "display_name": "Qiang Jin", "link": "https://stackoverflow.com/users/1239967/qiang-jin"}, "is_accepted": false, "score": 1, "last_activity_date": 1491638266, "creation_date": 1491638266, "answer_id": 43291630, "question_id": 43290945, "link": "https://stackoverflow.com/questions/43290945/how-to-work-with-large-integers-in-go/43291630#43291630", "title": "How to work with large integers in Go?", "body": "<p>You can try to convert the int to string, and then fetch the digits in the converted string,</p>\n\n<pre><code>// n &gt;= 1\nfunc NthDigit(num int, n int) int {\n    return int(strconv.Itoa(num)[n-1]) - int('0')\n}\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 2438094, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/edvfV.jpg?s=128&g=1", "display_name": "WCGPR0", "link": "https://stackoverflow.com/users/2438094/wcgpr0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2950, "favorite_count": 0, "accepted_answer_id": 43291490, "answer_count": 2, "score": 0, "last_activity_date": 1491726437, "creation_date": 1491632996, "last_edit_date": 1491726437, "question_id": 43290945, "link": "https://stackoverflow.com/questions/43290945/how-to-work-with-large-integers-in-go", "title": "How to work with large integers in Go?", "body": "<p>I need to perform operations, such as exponentiation and division, on large values of int64 in Go, but I have problems with overflow. I tried converting them to float64, but then I run into other problems. Here is what I tried.</p>\n\n<p>I have an integer variable, which I had to cast into a float64 to use the handy math package (<a href=\"https://golang.org/pkg/math\" rel=\"nofollow noreferrer\">https://golang.org/pkg/math</a>).</p>\n\n<p>However, it doesn't cast correctly when the integer variable is too big. I'm assuming it's because the size is bigger than float64. ex:</p>\n\n<pre><code>fmt.Printf(\"%f\",float64(111111111111111110)) //Outputs 111111111111111104.000000\n</code></pre>\n\n<p>I'm trying to use math.Mod, math.Pow10, and math.Log10. How would I be able to do the following logic, but with a large number shown above?</p>\n\n<pre><code>int(math.Mod(float64(123) / math.Pow10(1),10))) // Gets the second digit\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 101, "user_id": 1092801, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a44dfac59502c59bad2e7727b170ac4f?s=128&d=identicon&r=PG", "display_name": "Jamesszm", "link": "https://stackoverflow.com/users/1092801/jamesszm"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1491613126, "post_id": 43289001, "comment_id": 73646005, "body": "Thanks Flimzy for the help!"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 1092801, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a44dfac59502c59bad2e7727b170ac4f?s=128&d=identicon&r=PG", "display_name": "Jamesszm", "link": "https://stackoverflow.com/users/1092801/jamesszm"}, "edited": false, "score": 0, "creation_date": 1491613200, "post_id": 43289059, "comment_id": 73646014, "body": "oh ya, Kitchen in the example is not a type interface"}, {"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1491633527, "post_id": 43289059, "comment_id": 73649337, "body": "In the language of object orientation: this is how to do inheritance in Go."}], "tags": [], "owner": {"reputation": 14127, "user_id": 641627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEgWh.jpg?s=128&g=1", "display_name": "alexbt", "link": "https://stackoverflow.com/users/641627/alexbt"}, "is_accepted": false, "score": 2, "last_activity_date": 1491651439, "last_edit_date": 1491651439, "creation_date": 1491612992, "answer_id": 43289059, "question_id": 43289001, "link": "https://stackoverflow.com/questions/43289001/struct-first-line-is-just-an-interface-what-does-it-mean/43289059#43289059", "title": "struct first line is just an interface, what does it mean?", "body": "<p><strong>Mostly</strong>, this is how some sort of inheritance (by composition rather than inheritance) is achieved in go. Check this out: <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#embedding</a></p>\n\n<p>This will grant the Outer type (<code>MyType</code>) access to this inner type's Receiver methods (the assigned struct{} since this is an interface).</p>\n\n<p>From <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">Go Effective</a>:</p>\n\n<blockquote>\n  <p>There's an important way in which embedding differs from subclassing.\n  When we embed a type, the methods of that type become methods of the\n  outer type, but when they are invoked the receiver of the method is\n  the inner type, not the outer one</p>\n</blockquote>\n\n<p>Thanks <strong>@Flimzy</strong> and <strong>@md2perpe</strong></p>\n\n<p><strong>Also</strong>, this defines an <em>anonymous field</em>, for which the variable name will be the same as its type name.</p>\n"}], "owner": {"reputation": 101, "user_id": 1092801, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a44dfac59502c59bad2e7727b170ac4f?s=128&d=identicon&r=PG", "display_name": "Jamesszm", "link": "https://stackoverflow.com/users/1092801/jamesszm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "closed_date": 1491618348, "answer_count": 1, "score": 0, "last_activity_date": 1491651439, "creation_date": 1491612403, "last_edit_date": 1491612653, "question_id": 43289001, "link": "https://stackoverflow.com/questions/43289001/struct-first-line-is-just-an-interface-what-does-it-mean", "closed_reason": "Duplicate", "title": "struct first line is just an interface, what does it mean?", "body": "<p>I come across this code in Go:</p>\n\n<pre><code>type Mytype struct {\n  Interfacename\n  var1  ClientInterface1\n  var2  ClientInterface2\n  id    int\n}\n</code></pre>\n\n<p>What does that first field mean?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 5, "creation_date": 1491605261, "post_id": 43288131, "comment_id": 73644396, "body": "<code>select</code> is not capitalized. <a href=\"https://tour.golang.org/concurrency/5\" rel=\"nofollow noreferrer\">tour.golang.org/concurrency/5</a>"}, {"owner": {"reputation": 679, "user_id": 7176437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/549cb8faa34003416eccec2fd3c7dd71?s=128&d=identicon&r=PG&f=1", "display_name": "vkosyj", "link": "https://stackoverflow.com/users/7176437/vkosyj"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1491605368, "post_id": 43288131, "comment_id": 73644428, "body": "@RayfenWindspear Thanks again haha."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 2, "creation_date": 1491605662, "post_id": 43288131, "comment_id": 73644506, "body": "None of the go keywords are capitalized. <a href=\"https://golang.org/ref/spec#Keywords\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Keywords</a>"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 2, "last_activity_date": 1491611366, "creation_date": 1491611366, "answer_id": 43288891, "question_id": 43288131, "link": "https://stackoverflow.com/questions/43288131/unexpected-case-expecting-expression-error-when-compiling-go/43288891#43288891", "title": "unexpected case, expecting expression error when compiling go", "body": "<p>It happens because you have written <code>Select</code> when you should have written <code>select</code>.</p>\n\n<p>None of the Go keywords are capitalized, so when the compiler sees a capitalized word, it knows immediately that it's not an expression, and therefore a syntax error.</p>\n"}], "owner": {"reputation": 679, "user_id": 7176437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/549cb8faa34003416eccec2fd3c7dd71?s=128&d=identicon&r=PG&f=1", "display_name": "vkosyj", "link": "https://stackoverflow.com/users/7176437/vkosyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1176, "favorite_count": 0, "accepted_answer_id": 43288891, "answer_count": 1, "score": -2, "last_activity_date": 1491611366, "creation_date": 1491605184, "last_edit_date": 1491611309, "question_id": 43288131, "link": "https://stackoverflow.com/questions/43288131/unexpected-case-expecting-expression-error-when-compiling-go", "title": "unexpected case, expecting expression error when compiling go", "body": "<p>When I compile the following code, it generates </p>\n\n<p>*syntax error: <code>unexpected case, expecting expression*</code> at line <code>*case workerAddr = &lt;- mr.registerChannel:*</code> </p>\n\n<p>I do not know why it happens since I just want to workerAddr to be set by either channel.  Any suggestion will be appreciated.</p>\n\n<pre><code>for i:= 0; i &lt; mr.nMap; i++ {   \n    go func(jobCount) {\n        for {\n            var workerAddr string\n            Select {\n                // get a worker either from registerChannel or from idle channel\n                case workerAddr = &lt;- mr.registerChannel:\n                case workerAddr = &lt;- mr.idleChannel:\n            } \n            // omit the following code\n        }\n    }(i)\n}\n</code></pre>\n"}, {"tags": ["mysql", "json", "go", "sphinx", "sqlx"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6865487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880462786b461d2c97f4f18959d4327?s=128&d=identicon&r=PG&f=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/6865487/matt-c"}, "edited": false, "score": 0, "creation_date": 1491849165, "post_id": 43289614, "comment_id": 73725215, "body": "I wish that would work, but the string I get back from my sphinx database doesn&#39;t seem to be JSON, as there are no quotes around that values.  When trying to unmarshal with Json I get  the error &quot;invalid character &#39;S&#39; looking for beginning of object key string&quot; because the Source in {Source:... is not in quotes in my returned string. Is there a way around this with JSON or a different way to scan the object?"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 29, "user_id": 6865487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880462786b461d2c97f4f18959d4327?s=128&d=identicon&r=PG&f=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/6865487/matt-c"}, "edited": false, "score": 0, "creation_date": 1491849809, "post_id": 43289614, "comment_id": 73725562, "body": "Have you tried offloading it to a map[string]interface{} instead of a custom struct ... it wont be as picky with data, but youll have to use reflection on the data to access and change it. Another option is to write a parser.. if its string data. Also I don&#39;t know how you&#39;re scanning the object, but there is plenty on stack about scanning and data formatting, example <a href=\"http://stackoverflow.com/questions/17265463/how-do-i-convert-a-database-row-into-a-struct-in-go\" title=\"how do i convert a database row into a struct in go\">stackoverflow.com/questions/17265463/&hellip;</a>"}, {"owner": {"reputation": 29, "user_id": 6865487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880462786b461d2c97f4f18959d4327?s=128&d=identicon&r=PG&f=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/6865487/matt-c"}, "edited": false, "score": 0, "creation_date": 1491854375, "post_id": 43289614, "comment_id": 73728043, "body": "Yeah, I have implemented a custom parser that is working for my problem right now, but doing your own is fragile, and I don&#39;t know if it will continue to work as my problem set gets bigger.  All I really want is to generically be able to pass in a struct type, and have a MySQL reader be able to fill out that type with a given query if the schema&#39;s match.  Its surprising and dissapointing to me that there isn&#39;t a library/built in solution to this.   Your link shows explicitely having to put the structure of the data right into the scan method, making me have to re-write the same code over again"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 29, "user_id": 6865487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880462786b461d2c97f4f18959d4327?s=128&d=identicon&r=PG&f=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/6865487/matt-c"}, "edited": false, "score": 0, "creation_date": 1491855297, "post_id": 43289614, "comment_id": 73728556, "body": "Most Go db drivers work by passing the struct in as part of the query. The driver is responsible for marshaling the data correctly in the struct. It might be in your best interest, as that is a best practice, less likely to break, and scalable. Once your using the drivers as designed then the worries you should have are, what should my query be, and what should my struct look like."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 29, "user_id": 6865487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880462786b461d2c97f4f18959d4327?s=128&d=identicon&r=PG&f=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/6865487/matt-c"}, "edited": false, "score": 0, "creation_date": 1491856833, "post_id": 43289614, "comment_id": 73729320, "body": "I also suggest you give this a read. Its extremely insightful on the best ways to use sql and go together <a href=\"http://go-database-sql.org/overview.html\" rel=\"nofollow noreferrer\">go-database-sql.org/overview.html</a>"}, {"owner": {"reputation": 29, "user_id": 6865487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880462786b461d2c97f4f18959d4327?s=128&d=identicon&r=PG&f=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/6865487/matt-c"}, "edited": false, "score": 0, "creation_date": 1491861447, "post_id": 43289614, "comment_id": 73731302, "body": "Apreciate that, but I&#39;ve been trying that and failed. I would like to use JSON and be done with it, but I&#39;m working with a legacy system that has a lot built up into sphinx indexes and they don&#39;t seem to be working with the built in DB stuff.  I can get the following string out of it via just a rows.Scan(&amp;stringVal) &quot;{Id:1,MarketplaceId:1,StatusByCampaign:[{CampaignId:20,Stat&zwnj;&#8203;us:Active},{Campaign&zwnj;&#8203;Id:21,Status:Active}&zwnj;&#8203;],LastUpdatedOn:0001&zwnj;&#8203;-01-01,IsDeleted:Fal&zwnj;&#8203;se}&quot; but am having the hardest time putting that string into a struct."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 29, "user_id": 6865487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880462786b461d2c97f4f18959d4327?s=128&d=identicon&r=PG&f=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/6865487/matt-c"}, "edited": false, "score": 0, "creation_date": 1491861645, "post_id": 43289614, "comment_id": 73731360, "body": "Want to add a bit more of source code i or someone else can run. To produce your error. Might be faster if we can see how exactly you trying to parse thar string into a struct, in that way you dont have to rewrite or mod the legacy system drastically"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 29, "user_id": 6865487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880462786b461d2c97f4f18959d4327?s=128&d=identicon&r=PG&f=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/6865487/matt-c"}, "edited": false, "score": 0, "creation_date": 1491867272, "post_id": 43289614, "comment_id": 73733026, "body": "Also as im sure you&#39;re aware. The string your having trouble with is having trouble because that isnt proper json. You can put all the interger based data into a struct, but the things that look like string (date for instance) arent strings or anything that resemble a data type, which is why it cant be unmarshaled not even into an interface. Unless you parse/format the data or update how you use the driver.. your going to have issues abd likely will have to parse everything."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 29, "user_id": 6865487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880462786b461d2c97f4f18959d4327?s=128&d=identicon&r=PG&f=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/6865487/matt-c"}, "edited": false, "score": 0, "creation_date": 1491872407, "post_id": 43289614, "comment_id": 73734250, "body": "I was thinking of a solution for you.  If the issue is the lack of quotes. You might be better with a general purpose regex like the one here <a href=\"http://stackoverflow.com/q/24175802/4639336\">stackoverflow.com/q/24175802/4639336</a> that will fornat the string. This may be more reliable then a parser. The link above is an example not a solution, but a poasible alternative."}], "tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": false, "score": 0, "last_activity_date": 1491850396, "last_edit_date": 1491850396, "creation_date": 1491619593, "answer_id": 43289614, "question_id": 43284894, "link": "https://stackoverflow.com/questions/43284894/best-practice-to-go-from-sphinx-db-to-somewhat-complex-golang-struct/43289614#43289614", "title": "Best Practice to go from sphinx db to somewhat complex golang struct", "body": "<p>I think it might be the way you are defining your structs. Given the json you provided <code>{Source: {ID:string, subId:string, Campaigns:[]{CampaignID:string, Status:string}}}</code> your struct should look like something close to whats below.</p>\n\n<pre><code>type object struct {\n    Source struct {\n        ID        string     `db:\"id\"`\n        SubId     string     `db:\"sub_id\"`\n        Campaigns []compaign `db:\"compaigns\"`\n    } `json:\"source\"`\n}\n\ntype compaign struct {\n    CampaignID string `db:\"compaign_id\"`\n    Status     string `db:\"status\"`\n}\n</code></pre>\n\n<p>Given the comments below.  Try <code>obj := make(map[string]interaface{})</code> instead of the defining a struct.</p>\n\n<p>Also taking a look at <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">https://github.com/jmoiron/sqlx</a> the struct should be using the db flag instead of json, so I changed it. You shouldn't have to marshal the data</p>\n\n<p>example <code>db.Select(&amp;people, \"SELECT * FROM person ORDER BY first_name ASC\")</code> Where <code>&amp;people</code> is a reference to a struct. E.g <code>var people PeopleStruct</code></p>\n\n<p>Now I'm not famailar with your driver, but it should be the same, in that you pass a reference to a struct or interface with your query and it looks the data into that reference.  You don't normally have to unmarshall in the struct after the query.</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 6865487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880462786b461d2c97f4f18959d4327?s=128&d=identicon&r=PG&f=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/6865487/matt-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1492106693, "creation_date": 1492106693, "answer_id": 43398959, "question_id": 43284894, "link": "https://stackoverflow.com/questions/43284894/best-practice-to-go-from-sphinx-db-to-somewhat-complex-golang-struct/43398959#43398959", "title": "Best Practice to go from sphinx db to somewhat complex golang struct", "body": "<p>I found out the legacy system I'm working with was using an ASP.Net library called ServiceStack to serialize/deserialize my sphinx db, and it was using it's own custom JSV format, which the author of ServiceStack say as an optimized mix of JSON and CSV, but hasn't been adopted anywhere else as far as I can tell.  </p>\n\n<p>So it looks like I'm going to either rewrite that library in Go, or more likely change the indexing algorithm to use JSON.</p>\n"}], "owner": {"reputation": 29, "user_id": 6865487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880462786b461d2c97f4f18959d4327?s=128&d=identicon&r=PG&f=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/6865487/matt-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492106693, "creation_date": 1491589758, "last_edit_date": 1491590213, "question_id": 43284894, "link": "https://stackoverflow.com/questions/43284894/best-practice-to-go-from-sphinx-db-to-somewhat-complex-golang-struct", "title": "Best Practice to go from sphinx db to somewhat complex golang struct", "body": "<p>I am trying to convert a sphinx query via MySQL into a golang struct and am having a hard time. It seems like this should be a common sort of problem, but so far I'm stuck converting it to a map or parsing output myself.  Specifically, I have a schema in sphinx that looks like {Source: {ID:string, subId:string, Campaigns:[]{CampaignID:string, Status:string}}}</p>\n\n<p>I've tried using the simple rows.scan but that doesn't help me parse the repeating field, I just get it as an unparsed string.  In sphinx, the key's aren't in quotation marks, so JSON.unmarshal doesn't seem to help at all.  And using sqlx, I've tried to build up the following struct </p>\n\n<pre><code>type CampaignStatus struct {\n    CampaignId string\n    Status string\n}\ntype Source struct {\n    Id               string\n    SubId    string\n    StatusByCampaign []CampaignStatus\n}\ntype Status struct {\n    Source\n}\n</code></pre>\n\n<p>and passing in a Status struct to Row.ScanStruct() and I get back either a \"Missing destination Name Source\" error or if I name the source member in Status, I get \"sql: Scan error on column index 0: unsupported Scan, storing driver.Value type []uint8 into type *v1.Source\".  Full disclosure, the sphinx schema has a few other columns as peers with StatusByCampaign, they come after it and I don't care about them in my use case. </p>\n\n<p>This seems like something that has to have been come across before, but I can't seem to find a solution outside of writing my own parser, which I am loath to do. </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "is_accepted": true, "score": 1, "last_activity_date": 1491654031, "last_edit_date": 1491654031, "creation_date": 1491591142, "answer_id": 43285239, "question_id": 43284246, "link": "https://stackoverflow.com/questions/43284246/golang-template-funcmap-that-can-call-itself/43285239#43285239", "title": "Golang template FuncMap that can call itself", "body": "<p>Oops, looked like I had a typo.</p>\n\n<p>Had to change this:</p>\n\n<pre><code>// Make the new template using component file name and add FuncMap functions.\nt := template.New(componentFileName).Funcs(v.funcMap)\n\n// Determine if there is an error in the template syntax.\nt, err := template.ParseFiles(p + \".\" + v.extension)\n</code></pre>\n\n<p>...to this:</p>\n\n<pre><code>// Make the new template using component file name and add FuncMap functions.\nt := template.New(componentFileName + \".\" + v.extension).Funcs(v.funcMap) // &lt;---- 'componentFileName' to 'componentFileName + \".\" + v.extension'\n\n// Determine if there is an error in the template syntax.\nt, err := t.ParseFiles(p + \".\" + v.extension) // &lt;---- 'template' to 't'\n</code></pre>\n\n<p>I was referencing the <code>template</code> package instead of the <code>t</code> template that I created. I also passed in the wrong name for <code>template.New</code>, since that expects a full fill such as <code>index.tmpl</code>, instead of just <code>index</code>.</p>\n\n<p>Now everything works as expected! Can call component from another component. </p>\n"}], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 797, "favorite_count": 0, "accepted_answer_id": 43285239, "answer_count": 1, "score": 0, "last_activity_date": 1491654031, "creation_date": 1491587268, "last_edit_date": 1491587356, "question_id": 43284246, "link": "https://stackoverflow.com/questions/43284246/golang-template-funcmap-that-can-call-itself", "title": "Golang template FuncMap that can call itself", "body": "<p>I am trying to achieve a function to add to FuncMaps in a base template, and this function should be used to render re-useable view components</p>\n\n<p>For instance:</p>\n\n<pre><code>func (v *Item) RenderComponent(componentPath string, vars ...interface{}) template.HTML {\n    p := path.Join(v.folder, \"components\", componentPath)\n\n    // Get the pieces of the component path.\n    componentPathPieces := strings.Split(p, \"/\")\n\n    // Get the last item in the pieces (this should be the file name).\n    componentFileName := componentPathPieces[len(componentPathPieces)-1]\n\n    // Make the new template using component file name and add FuncMap functions.\n    t := template.New(componentFileName).Funcs(v.funcMap)\n\n    // Determine if there is an error in the template syntax.\n    t, err := template.ParseFiles(p + \".\" + v.extension)\n    if err != nil {\n        panic(err)\n    }\n\n    // Add variables to the component and write to a buffer.\n    b := new(bytes.Buffer)\n    if err = t.Execute(b, vars); err != nil {\n        panic(err)\n    }\n\n    // Return the contents of the template buffer as a string of HTML.\n    return template.HTML(b.String())\n}\n</code></pre>\n\n<p>This code works just fine for a component that doesn't render another component. For example, I can write <code>{{component \"buttons/default-button\" \"some url goes here\"}}</code> and it will render the component at <code>components/button/default-button.tmpl</code> just fine.</p>\n\n<p>However, if I include another component within that default-button component, such as <code>{{component \"icons/check-icon\"}}</code>, I will get a large error (too big to paste here). But here is one of the error messages:</p>\n\n<blockquote>\n  <p>template: default-button.tmpl:4: function \"component\" not defined</p>\n</blockquote>\n\n<p>As you can see, the error is thrown from the component file that is trying to call another component. I believe that happens because the viewFunc is either not being properly added, or is being recursively called in some way.</p>\n"}, {"tags": ["asynchronous", "go", "synchronization", "channel"], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 2, "last_activity_date": 1491588509, "last_edit_date": 1491588509, "creation_date": 1491584467, "answer_id": 43283541, "question_id": 43283349, "link": "https://stackoverflow.com/questions/43283349/golang-persistent-channel-accepting-input-from-multiple-function-calls/43283541#43283541", "title": "Golang persistent channel accepting input from multiple function calls", "body": "<p>This is a common producer-consumer problem. Use channels to wait on the input from another routine. Does something like this help?</p>\n\n<p>In this particular example, you would have to call <code>go b(c)</code> again after collecting the inputs as it terminates, but you could easily wrap whatever <code>b</code> does in an infinite <code>for</code> loop. Or whatever needs to happen.</p>\n\n<p>Please note that in this example, and unbuffered <code>channel</code> is used, which forces both routines to meet at the same time to \"hand off\" the <code>*Thing</code>. If you want the producer (<code>a</code>'s process) to not have to wait, you can use a buffered channel, which is created like so:</p>\n\n<pre><code>c := make(chan(*Thing, n))\n</code></pre>\n\n<p>Where <code>n</code> is the number of items the channel can store. This allows several to be queued by the producer.</p>\n\n<p><a href=\"https://play.golang.org/p/X14_QsSSU4\" rel=\"nofollow noreferrer\">https://play.golang.org/p/X14_QsSSU4</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype Thing struct {\n    N int\n}\n\nfunc a(t *Thing, c chan (*Thing)) {\n    // stuff happens. whee\n    c &lt;- t\n}\n\nfunc b(c chan (*Thing)) {\n    things := []*Thing{}\n    for i := 0; i &lt; 10; i++ {\n        t := &lt;-c\n        things = append(things, t)\n        fmt.Printf(\"I have %d things\\n\", i+1)\n    }\n    fmt.Println(\"I now have 10 things! Let's roll!\")\n    // do stuff with your ten things\n}\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    c := make(chan (*Thing))\n\n    go b(c)\n\n    // this would probably be done producer-consumer like in a go-routine\n    for i := 0; i &lt; 10; i++ {\n        a(&amp;Thing{i}, c)\n        time.Sleep(time.Second)\n    }\n    time.Sleep(time.Second)\n    fmt.Println(\"Program finished\")\n}\n</code></pre>\n"}], "owner": {"reputation": 561, "user_id": 3564720, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KiSNg.jpg?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/3564720/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 842, "favorite_count": 0, "accepted_answer_id": 43283541, "answer_count": 1, "score": 1, "last_activity_date": 1491588509, "creation_date": 1491583729, "question_id": 43283349, "link": "https://stackoverflow.com/questions/43283349/golang-persistent-channel-accepting-input-from-multiple-function-calls", "title": "Golang persistent channel accepting input from multiple function calls", "body": "<p>I have a function <code>a</code>:</p>\n\n<pre><code>func a(input *some_type) {\n    // do sth.\n    b(input)\n    }\n</code></pre>\n\n<p>This function gets called multiple times.\nI want a function <code>b</code> to wait indefinitely for input from function <code>a</code> and perform an action when it has collected n inputs.</p>\n\n<pre><code>func b(input *some_type) {\n    // wait until received n inputs then do sth. with all inputs\n    }\n</code></pre>\n\n<p>How would I go about doing this? My first thought was to use a <code>sync.WaitGroup</code> with a channel between <code>a</code> and <code>b</code>.</p>\n"}, {"tags": ["testing", "go", "goconvey", "go-echo"], "comments": [{"owner": {"reputation": 1043, "user_id": 4463031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0VoU8.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/4463031/chris-l"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491587047, "post_id": 43283311, "comment_id": 73636555, "body": "it is the default access method using the echo jwt middleware <a href=\"https://echo.labstack.com/cookbook/jwt\" rel=\"nofollow noreferrer\">echo.labstack.com/cookbook/jwt</a>"}, {"owner": {"reputation": 1043, "user_id": 4463031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0VoU8.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/4463031/chris-l"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491587258, "post_id": 43283311, "comment_id": 73636641, "body": "Also, if it is any help to anyone. log.Println(c.Request().Header) DOES have the header info in it for the test, is is just not able to be accessed by c.Get()"}], "answers": [{"tags": [], "owner": {"reputation": 1043, "user_id": 4463031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0VoU8.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/4463031/chris-l"}, "is_accepted": false, "score": 2, "last_activity_date": 1491590383, "creation_date": 1491590383, "answer_id": 43285050, "question_id": 43283311, "link": "https://stackoverflow.com/questions/43283311/echo-c-getuser-does-not-work-in-testing-env/43285050#43285050", "title": "echo c.Get(&quot;user&quot;) does not work in testing env", "body": "<p>Through much pain I was able to figure this out. Here is working code. Explanation to follow.</p>\n\n<pre><code>        Convey(\"with a valid token, you should get a success msg and be logged out\", func() {\n        e := echo.New()\n        req, err := http.NewRequest(echo.POST, \"auth/logout\", strings.NewReader(\"\"))\n        if err == nil {\n            req.Header.Set(echo.HeaderAuthorization, fmt.Sprintf(\"Bearer %v\", Token))\n            rec := httptest.NewRecorder()\n            c := e.NewContext(req, rec)\n            middleware.JWTWithConfig(middleware.JWTConfig{\n                SigningKey: []byte(\"secret\"),\n            })(Logout(db, Models.Redis))(c)\n            body := GetJsonBody(rec.Body.String())\n            error := body.Path(\"error\").Data()\n            msg := body.Path(\"msg\").Data().(string)\n            pw := body.Path(\"data.user.password\").Data().(string)\n            token := body.Path(\"data.user.token\").Data()\n            So(error, ShouldEqual, nil)\n            So(msg, ShouldEqual, \"Logged Out\")\n            So(rec.Code, ShouldEqual, 200)\n            So(pw, ShouldEqual, \"\")\n            So(token, ShouldEqual, nil)\n        }\n\n    })\n</code></pre>\n\n<p>I had set my Header properly but was not executing the JWT echo middleware which meant that my token was not validated and made accesisible using the c.Get() command.</p>\n\n<p>The key here is that testing echo middlware without running the server requires you to execute the middleware function, which then takes a handler function (this is your function you want to test) and then takes the context. So, the function should look as follows to test your middleware routes. If it is all caps you need to replace it with your specific case.</p>\n\n<pre><code>A: middleware.MIDDLEWARE_FUNC(NECESSARY_CONFIGS) // &lt;--- this returns echo.MiddlewareFunc\n\nB: (YOUR_HANDLER(req, res)) // &lt;---echo.MiddlewareFunc takes an echo.HanlderFunc as its only argument and you pass your handler you test req, res\n\n(c) // &lt;--Finally, you call the resulting compose function with your test context\n\nA(B())(c)\n</code></pre>\n"}], "owner": {"reputation": 1043, "user_id": 4463031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0VoU8.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/4463031/chris-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1400, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521026979, "creation_date": 1491583587, "last_edit_date": 1521026979, "question_id": 43283311, "link": "https://stackoverflow.com/questions/43283311/echo-c-getuser-does-not-work-in-testing-env", "title": "echo c.Get(&quot;user&quot;) does not work in testing env", "body": "<p>I am attempting to test a golang API built on the echo framework/router. I have the following test.....</p>\n\n<pre><code>func TestLogout(t *testing.T) {\nloadConfig()\ndb := stubDBs(t)\nConvey(\"When you post to /logout\", t, func() {\n    Convey(\"with a valid token, you should get aa success msg and be logged out\", func() {\n        e := echo.New()\n        e.Use(middleware.JWTWithConfig(middleware.JWTConfig{\n            SigningKey:  []byte(\"secret\"),\n            TokenLookup: \"query:user\",\n        }))\n        req, err := http.NewRequest(echo.POST, \"auth/logout\", strings.NewReader(\"\"))\n        if err == nil {\n            req.Header.Set(echo.HeaderAuthorization, fmt.Sprintf(\"Bearer %v\", Token))\n            rec := httptest.NewRecorder()\n            c := e.NewContext(req, rec)\n            Logout(db, Models.Redis)(c)\n            body := GetJsonBody(rec.Body.String())\n            error := body.Path(\"error\").Data()\n            msg := body.Path(\"error\").Data().(string)\n            pw := body.Path(\"data.user.password\").Data().(string)\n            token := body.Path(\"data.user.token\").Data()\n            So(error, ShouldEqual, nil)\n            So(msg, ShouldEqual, \"Logged Out\")\n            So(rec.Code, ShouldEqual, 200)\n            So(pw, ShouldEqual, \"\")\n            So(token, ShouldEqual, nil)\n        }\n\n    })\n})\n}\n</code></pre>\n\n<p>and in the controller....</p>\n\n<pre><code>//Logout ...\nfunc Logout(db *sqlx.DB, r *redis.Client) echo.HandlerFunc {\n    return func(c echo.Context) error {\n        var user Models.User\n        log.Println(c.Get(\"user\")) //&lt;-----This Logs NIL only on testing\n        if c.Get(\"user\") == nil {\n            res := createAuthErrorResponse(user, \"Invalid Token\")\n            return c.JSON(http.StatusOK, res)\n        }\n        token := c.Get(\"user\").(*jwt.Token)\n        err := Models.Redis.Del(token.Raw).Err()\n        if err != nil {\n            handleErr(err)\n            res := createAuthErrorResponse(user, \"Token not in storage\")\n            return c.JSON(http.StatusOK, res)\n        }\n        user.Password = \"\"\n        user.Token = null.StringFrom(\"\")\n        res := createAuthSuccessResponse(user, \"Logged Out.\")\n        return c.JSON(http.StatusOK, res)\n    }\n}\n</code></pre>\n\n<p>Any advice on how I can test this functionality in the cho framework? This is a behavior I would not expect (c.Get(\"user\") does not act the same on testing as in live env).</p>\n"}, {"tags": ["go", "protocol-buffers", "grpc"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1491581586, "post_id": 43282702, "comment_id": 73633627, "body": "&quot;Better&quot; in what way? Code size? Complexity? Architecture?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1491581641, "post_id": 43282702, "comment_id": 73633666, "body": "@Ainar-G Add &quot;data transmission size?&quot; to that comment"}, {"owner": {"reputation": 152, "user_id": 1657083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KD4f8.jpg?s=128&g=1", "display_name": "RadekSohlich", "link": "https://stackoverflow.com/users/1657083/radeksohlich"}, "edited": false, "score": 2, "creation_date": 1491584508, "post_id": 43282702, "comment_id": 73635250, "body": "From my perspective, I would keep them rather separately and use some kind of adapter to create the pb. The idea behind this is to separate the transport layer that, if needed, could be changed simpler than if you &quot;mix&quot; it together.  But this is only my suggestion and point of view."}, {"owner": {"reputation": 175, "user_id": 1743844, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0b7f65a31f651365d53e05ea7e13e55?s=128&d=identicon&r=PG", "display_name": "stu", "link": "https://stackoverflow.com/users/1743844/stu"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1491600685, "post_id": 43282702, "comment_id": 73642910, "body": "@Ainar-G good question.  I meant in terms of architecture and any overhead involved in converting between the two.  Not worried about code size and I think data transmission size should be roughly the same, no?  A minor difference is not important to me."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1491639163, "creation_date": 1491639163, "answer_id": 43291740, "question_id": 43282702, "link": "https://stackoverflow.com/questions/43282702/should-you-use-protobuf-as-the-datatype-you-use-for-processing-or-only-for-trans/43291740#43291740", "title": "Should you use protobuf as the datatype you use for processing or only for transmission?", "body": "<p>In terms of architecture, I'd keep them separate. That would agree with the Single Responsibility Principle. In one of my projects we use this form:</p>\n\n<pre><code>type Foo struct { ... }\n\nfunc NewFooFromProto(f *myproto.Foo) *Foo { ... }\n\nfunc (f *Foo) ToProto() *myproto.Foo { ... }\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 1743844, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0b7f65a31f651365d53e05ea7e13e55?s=128&d=identicon&r=PG", "display_name": "stu", "link": "https://stackoverflow.com/users/1743844/stu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 43291740, "answer_count": 1, "score": 1, "last_activity_date": 1491639163, "creation_date": 1491581393, "last_edit_date": 1491581522, "question_id": 43282702, "link": "https://stackoverflow.com/questions/43282702/should-you-use-protobuf-as-the-datatype-you-use-for-processing-or-only-for-trans", "title": "Should you use protobuf as the datatype you use for processing or only for transmission?", "body": "<p>I have a matrix struct written in Go.  That matrix struct has a bunch of methods.  I want to be able to efficiently compute matrix operations but I also want to be able to send it over the wire in order to distribute the computation.</p>\n\n<p>I currently have the matrix and its methods separate from the protobuf definition.  When I need to send it over the wire I have to create a new <code>pb.Matrix{}</code> from the existing <code>Matrix{}</code> struct and then make my grpc call.  That seems like a waste.  So, is it a waste?  And should I just be defining my matrix struct as a protobuf definition and then use embedding to define operations on it?  Or is it better to keep them separate from each other?</p>\n"}, {"tags": ["function", "pointers", "go"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1491579501, "post_id": 43282057, "comment_id": 73632308, "body": "Try <code>&amp;(getAString())</code>."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1491579620, "post_id": 43282057, "comment_id": 73632374, "body": "To comment on that. The order of operations means the <code>&amp;</code> is applied before the function call <code>()</code>. The error you are getting is that you are trying to take the address of the funciton."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1491581693, "post_id": 43282057, "comment_id": 73633697, "body": "@KerrekSB That doesn&#39;t work either (you could&#39;ve tried). In Go you simply cannot take the address of return values of calls."}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1491581977, "post_id": 43282057, "comment_id": 73633887, "body": "@icza in the <a href=\"http://stackoverflow.com/questions/30744965/how-to-get-the-pointer-of-return-value-from-function-call\" title=\"how to get the pointer of return value from function call\">stackoverflow.com/questions/30744965/&hellip;</a> the answer is quite long and doens&#39;t talk about the operator precedence as RayfanWindspear do."}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1491582105, "post_id": 43282057, "comment_id": 73633960, "body": "@RayfenWindspear if what you are saying is true,that is the reason, and that was my question at first place... I&#39;m not trying to archieve anything i just question why i couldn&#39;t make that assignment. Please izca re-read my question and the one you mark as duplicate."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1491582249, "post_id": 43282057, "comment_id": 73634062, "body": "@Victor It&#39;s not a matter of operator precedence, you get the same compiler error with or without using parenthesis. Try it."}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1491582436, "post_id": 43282057, "comment_id": 73634165, "body": "I guess i don&#39;t see what is the problem... if the operator precedence isn&#39;t the problem (@RayfenWindspear take note...) ... what is the problem?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1491582599, "post_id": 43282057, "comment_id": 73634243, "body": "@icza: I was too lazy to try, so I asked the OP to do it :-) Thanks for the clarification. (I confused this with taking the address of temporaries, which look a bit like a function call and which is something you can do.)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1491582702, "post_id": 43282057, "comment_id": 73634300, "body": "@Victor I think the error message is pretty clear. You used the <code>&amp;</code> operator to take the address of something, something whose address cannot be taken by the language spec rules. Thus your code is invalid Go code, and attempting to compile it gives a compile-time error."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1491582750, "post_id": 43282057, "comment_id": 73634318, "body": "Well I&#39;ll be...."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1491582954, "post_id": 43282057, "comment_id": 73634421, "body": "@Victor For reasoning why this is not allowed, read my answer to a similar question: <a href=\"http://stackoverflow.com/questions/34197248/how-can-i-store-reference-to-the-result-of-an-operation-in-go/34197367#34197367\">How can I store reference to the result of an operation in Go?</a>"}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1491583349, "post_id": 43282057, "comment_id": 73634630, "body": "thanks you very much @icza! I guess I&#39;m being too much theoretical about operators and expressions... for a second i believe that &quot;&amp;&quot; operator could be applied over ANY expression.. and would return the address of where a result (temporal or not) is stored. Thanks again."}], "answers": [{"comments": [{"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1491582598, "post_id": 43282287, "comment_id": 73634241, "body": "ok @andy thanks!... besides the fact that an answer based on specification not fulfill my needed for logical reasoning about why i cant apply the &amp; over an expression (that is after all what a function call is)..  i would like to know what really happens.."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 1, "creation_date": 1491584185, "post_id": 43282287, "comment_id": 73635071, "body": "Applying the address operator to an expression would imply creating an anonymous variable to store the value and then taking the address of that. (You can only take the address of something that represents a value stored in memory). I can&#39;t think of any particular reason why that couldn&#39;t have been  supported, but obviously the Go authors decided not to support it. Maybe someone else has a better explanation. You might want to try asking on <a href=\"https://groups.google.com/forum/#!forum/golang-nuts\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!forum/golang-nuts</a>."}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1491585646, "post_id": 43282287, "comment_id": 73635820, "body": "thanks andy! very useful comment, this along with the answer is acceptable as correct answer!"}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 2, "last_activity_date": 1491580089, "creation_date": 1491580089, "answer_id": 43282287, "question_id": 43282057, "link": "https://stackoverflow.com/questions/43282057/why-i-cant-apply-address-operator-to-functions-return-values-directly/43282287#43282287", "title": "Why i cant apply address operator (&amp;) to functions return values directly", "body": "<p>You can't apply <code>&amp;</code> to a value like that (unless it's a composite literal). From the spec:</p>\n\n<blockquote>\n  <p>For an operand x of type T, the address operation &amp;x generates a\n  pointer of type *T to x. The operand must be <em>addressable</em>, that is,\n  either a variable, pointer indirection, or slice indexing operation;\n  or a field selector of an addressable struct operand; or an array\n  indexing operation of an addressable array. As an exception to the\n  addressability requirement, x may also be a (possibly parenthesized)\n  composite literal. If the evaluation of x would cause a run-time\n  panic, then the evaluation of &amp;x does too.</p>\n</blockquote>\n"}], "owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1491581269, "accepted_answer_id": 43282287, "answer_count": 1, "score": 0, "last_activity_date": 1491582156, "creation_date": 1491579353, "last_edit_date": 1491582156, "question_id": 43282057, "link": "https://stackoverflow.com/questions/43282057/why-i-cant-apply-address-operator-to-functions-return-values-directly", "closed_reason": "Duplicate", "title": "Why i cant apply address operator (&amp;) to functions return values directly", "body": "<p>I don't get why the following code snippet isn't compiling. The compiler states:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>cannot take the address of getAString()\n</code></pre>\n\n<p><p>\nThe code:</p>\n\n<pre><code>func getAStringPointer() *string {\n    return &amp;getAString()\n}\n\nfunc getAString() string {\n    return \"\"\n}\n</code></pre>\n\n<p>But, storing the results of the function in auxliary variable and return the address of that variable the compiler behaves OK.</p>\n\n<pre><code>func getAStringPointer() *string {\n    var aString = getAString()\n    return &amp;aString\n}\n\nfunc getAString() string {\n    return \"\"\n}\n</code></pre>\n"}, {"tags": ["linux", "go", "systemd"], "comments": [{"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "edited": false, "score": 5, "creation_date": 1491577791, "post_id": 43281460, "comment_id": 73631208, "body": "<i>Executable path is not abs</i> is the key error message here. Use an absolute path for <code>ExecStart</code>. systemd runs as root, it has no idea which home directory you are referring to with <code>~</code>."}, {"owner": {"reputation": 105, "user_id": 1869182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/966253075a9cdf91ce1cdd6d040e13bf?s=128&d=identicon&r=PG", "display_name": "MordFustang", "link": "https://stackoverflow.com/users/1869182/mordfustang"}, "reply_to_user": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "edited": false, "score": 0, "creation_date": 1491579459, "post_id": 43281460, "comment_id": 73632277, "body": "Oh! I see. Ok thats really helpful, thanks"}], "owner": {"reputation": 105, "user_id": 1869182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/966253075a9cdf91ce1cdd6d040e13bf?s=128&d=identicon&r=PG", "display_name": "MordFustang", "link": "https://stackoverflow.com/users/1869182/mordfustang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 529, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491577637, "creation_date": 1491577637, "question_id": 43281460, "link": "https://stackoverflow.com/questions/43281460/creating-a-systemd-service-error", "title": "Creating a Systemd service Error", "body": "<p>I've used golang to create a small program that runs silently in the background, and can run this program by typing ./my_app</p>\n\n<p>It is located in $HOME/my_app/my_app</p>\n\n<p>I went ahead and wrote a systemd my_app.service file:</p>\n\n<pre><code>[Unit]\nDescription=\"My Test Service\"\n\n[Service]\nType=simple\nExecStart= ~/my_app/my_app\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n\n<p>However, when i run sudo systemctl start my_app.service, it errors out and returns</p>\n\n<pre><code>Failed to start my_app.service: Unit my_app.service is not loaded properly: Invalid argument.\nSee system logs and 'systemctl status my_app.service' for details.\n</code></pre>\n\n<p><code>systemctl status my_app.service</code> returns</p>\n\n<pre><code>Apr 07 10:15:47 DEV-Rohan systemd[1]: Starting My Test App...\nApr 07 10:15:47 DEV-Rohan systemd[1]: Started My Test App.\nApr 07 10:36:34 DEV-Rohan systemd[1]: [/etc/systemd/system/my_app.service:6]    Executable path is not abs\nApr 07 10:36:34 DEV-Rohan systemd[1]: my_app.service: Service lacks both ExecStart= and ExecStop= setti\nApr 07 11:00:39 DEV-Rohan systemd[1]: [/etc/systemd/system/my_app.service:6] Executable path is not abs\nApr 07 11:00:39 DEV-Rohan systemd[1]: my_app.service: Service lacks both ExecStart= and ExecStop= setti\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1491575557, "post_id": 43280597, "comment_id": 73629531, "body": "There&#39;s no way for a go program to just &quot;run in the background&quot;. You have to do that yourself."}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1491575826, "post_id": 43280597, "comment_id": 73629717, "body": "Strange that it does. I think it is a bug in VS Code and dlv."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491576042, "post_id": 43280597, "comment_id": 73629900, "body": "No, I guarantee it does not, a Go program is multithreaded and cannot fork itself. More likely it&#39;s exiting immediately, have you checked the error returned from <code>http.ListenAndServe</code>?"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491576304, "post_id": 43280597, "comment_id": 73630077, "body": "Thanks - I have updated with what VS Code is writing in the Terminal."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1491580311, "post_id": 43280597, "comment_id": 73632848, "body": "OK, but you&#39;re still not checking the error from <code>ListenAndServe</code>. Are you certain that the process is continuing to run?  What file is <code>server.js</code> referring to? Shouldn&#39;t &quot;program&quot; in the launch config point to your program, not &quot;workspaceRoot&quot;?"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1491580591, "post_id": 43280597, "comment_id": 73633027, "body": "You got it, and I am sure I have tried that many times - that is setting: &quot;program&quot;: &quot;${workspaceRoot}/server.go&quot;, Well, now the debugger stops at breakpoints and no more killing processes. Well thanks"}, {"owner": {"reputation": 2712, "user_id": 1670373, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/0CoZo.jpg?s=128&g=1", "display_name": "stratovarius", "link": "https://stackoverflow.com/users/1670373/stratovarius"}, "edited": false, "score": 1, "creation_date": 1491940165, "post_id": 43280597, "comment_id": 73773102, "body": "Also, you can check out Gogland. I used both Gogland and VS Code, and found it more easy to use for go"}], "answers": [{"tags": [], "owner": {"reputation": 21378, "user_id": 3118209, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3tgaf.jpg?s=128&g=1", "display_name": "Arpit Aggarwal", "link": "https://stackoverflow.com/users/3118209/arpit-aggarwal"}, "is_accepted": false, "score": 8, "last_activity_date": 1497876763, "creation_date": 1497876763, "answer_id": 44631145, "question_id": 43280597, "link": "https://stackoverflow.com/questions/43280597/go-run-app-go-always-run-in-the-background/44631145#44631145", "title": "go run app.go always run in the background", "body": "<p>Did you tried running your server using <a href=\"https://en.wikipedia.org/wiki/Nohup\" rel=\"noreferrer\">nohup</a>?</p>\n\n<pre><code>nohup go run server.go &amp;\n</code></pre>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5126, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1497876887, "creation_date": 1491575129, "last_edit_date": 1497876887, "question_id": 43280597, "link": "https://stackoverflow.com/questions/43280597/go-run-app-go-always-run-in-the-background", "title": "go run app.go always run in the background", "body": "<p>go1.8</p>\n\n<p>How come the following always rund in the background? I have named the file server.go and is doing \"<code>go run server.go</code>\"</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hi there X, I love %s!\", r.URL.Path[1:])\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>VS Code Launch.json</p>\n\n<pre><code>{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"Launch\",\n            \"type\": \"go\",\n            \"request\": \"launch\",\n            \"mode\": \"debug\",\n            \"remotePath\": \"\",\n            \"port\": 2345,\n            \"host\": \"127.0.0.1\",\n            \"program\": \"${workspaceRoot}\",\n            \"env\": {},\n            \"args\": [],\n            \"showLog\": true\n        }\n    ]\n}\n</code></pre>\n\n<p>Update: I get this error in VS Code Terminal:</p>\n\n<pre><code>2017/04/07 16:41:41 debugger.go:257: created breakpoint: &amp;api.Breakpoint{ID:1, Name:\"\", Addr:0x12063ef, File:\"/Users/X/Documents/X/play/go/server.go\", Line:9, FunctionName:\"main.handler\", Cond:\"\", Tracepoint:false, Goroutine:false, Stacktrace:0, Variables:[]string(nil), LoadArgs:(*api.LoadConfig)(nil), LoadLocals:(*api.LoadConfig)(nil), HitCount:map[string]uint64{}, TotalHitCount:0x0}\n2017/04/07 16:41:41 debugger.go:412: continuing\n</code></pre>\n"}, {"tags": ["go", "struct", "unmarshalling", "rethinkdb"], "answers": [{"tags": [], "owner": {"reputation": 1624, "user_id": 3577360, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62ed0f4309cffd5b9ce23f7d8afb34d1?s=128&d=identicon&r=PG&f=1", "display_name": "Zander17", "link": "https://stackoverflow.com/users/3577360/zander17"}, "is_accepted": true, "score": 1, "last_activity_date": 1491574698, "creation_date": 1491574698, "answer_id": 43280441, "question_id": 43280088, "link": "https://stackoverflow.com/questions/43280088/golang-rethinkdb-changefeed-structure/43280441#43280441", "title": "Golang RethinkDB ChangeFeed Structure", "body": "<p>I figured it out!</p>\n\n<p>The problem was that I didn't specify a field on the rethinkdb change request.</p>\n\n<p>Previous code:</p>\n\n<pre><code>chatFeedCursor, _ := gorethink.Table(\"club_chat\").Changes().Run(gorethinkSession)\n</code></pre>\n\n<p>Working Code:</p>\n\n<pre><code>chatFeedCursor, _ := gorethink.Table(\"club_chat\").Changes().Field(\"new_val\").Run(gorethinkSession)\n</code></pre>\n\n<p>Now the .Next() value maps to my struct with no issues.</p>\n"}, {"tags": [], "owner": {"reputation": 1122, "user_id": 4970650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496526a825adf2e6587a19d3a6d391f7?s=128&d=identicon&r=PG", "display_name": "Cirelli94", "link": "https://stackoverflow.com/users/4970650/cirelli94"}, "is_accepted": false, "score": 0, "last_activity_date": 1580125291, "creation_date": 1580125291, "answer_id": 59930452, "question_id": 43280088, "link": "https://stackoverflow.com/questions/43280088/golang-rethinkdb-changefeed-structure/59930452#59930452", "title": "Golang RethinkDB ChangeFeed Structure", "body": "<p>If you want to unmarshal the changefeed cursor value to a specific struct type, but keep both the new and the old value, you could use a library for decoding generic map values into native Go structures, like <a href=\"https://github.com/mitchellh/mapstructure\" rel=\"nofollow noreferrer\">mapstructure</a>, to obtain a neat result:</p>\n\n<p>Import mapstructure:</p>\n\n<pre><code>import (\n   ...\n    \"github.com/mitchellh/mapstructure\"\n   ...\n)\n</code></pre>\n\n<p>Now you can do something like:</p>\n\n<pre><code>    cursor, err := r.Table(\"club_chat\").\n        Changes().\n        Run(db.Session)\n\n    if err != nil {\n        // manage error\n    }\n\n    var changeFeed map[string]interface{}\n    for cursor.Next(&amp;changeFeed) {\n\n        var oldVal, newVal ChatMessage\n        if changeFeed[\"old_val\"] != nil {\n            mapstructure.Decode(changeFeed[\"old_val\"], &amp;oldVal)\n        }\n\n        if changeFeed[\"new_val\"] != nil {\n            mapstructure.Decode(changeFeed[\"new_val\"], &amp;newVal)\n        }\n\n      // Do what you want with the values\n\n</code></pre>\n"}], "owner": {"reputation": 1624, "user_id": 3577360, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62ed0f4309cffd5b9ce23f7d8afb34d1?s=128&d=identicon&r=PG&f=1", "display_name": "Zander17", "link": "https://stackoverflow.com/users/3577360/zander17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 1, "accepted_answer_id": 43280441, "answer_count": 2, "score": 0, "last_activity_date": 1580125291, "creation_date": 1491573674, "last_edit_date": 1491574493, "question_id": 43280088, "link": "https://stackoverflow.com/questions/43280088/golang-rethinkdb-changefeed-structure", "title": "Golang RethinkDB ChangeFeed Structure", "body": "<p>I was wondering if someone could explain how to unmarshal my changefeed cursor value to a specific struct type.</p>\n\n<pre><code>var message map[string]interface{}\n\nfor chatFeedCursor.Next(&amp;message) {\n    fmt.Println(message)\n}\n</code></pre>\n\n<blockquote>\n  <p>map[new_val:map[club_id:ea2eb6e2-755f-4dad-922d-e3693b6e55c6\n  date:2017-04-07 14:48:17.714 +0100 +01:00\n  id:e389ab54-963e-4b33-9b34-adcb6ec5b17e message:what is the meaning of life?\n  user_id:00ff679f-9421-4b8b-ae7f-d11cf2adaee2] old_val:]</p>\n</blockquote>\n\n<p>However, I would like the response to be mapped to struct ChatMessage.</p>\n\n<p>Update:</p>\n\n<p>I've tried:</p>\n\n<pre><code>var message ChatMessage\n</code></pre>\n\n<p>However, it doesn't seem like any of my data gets set in the struct.</p>\n\n<blockquote>\n  <p>{    0001-01-01 00:00:00 +0000 UTC}</p>\n</blockquote>\n\n<p>My struct:</p>\n\n<pre><code>type ChatMessage struct {\n    ID      string        `json:\"id\" gorethink:\"id,omitempty\"`\n    UserID      string    `json:\"user_id\" gorethink:\"user_id\"`\n    ClubID      string    `json:\"club_id\" gorethink:\"club_id\"`\n    Message     string    `json:\"message\" gorethink:\"message\"`\n    Date    time.Time     `json:\"date\" gorethink:\"date\"`\n}\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["windows", "go", "dns", "active-directory"], "comments": [{"owner": {"reputation": 476, "user_id": 7770552, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jkfR43BnIRQ/AAAAAAAAAAI/AAAAAAAAAOI/2BZCqFnlJtk/photo.jpg?sz=128", "display_name": "Mihail Kuznesov", "link": "https://stackoverflow.com/users/7770552/mihail-kuznesov"}, "edited": false, "score": 0, "creation_date": 1491595912, "post_id": 43279703, "comment_id": 73640891, "body": "<a href=\"https://github.com/golang/go/wiki/WindowsDLLs\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/WindowsDLLs</a>      <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724301(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1491596855, "creation_date": 1491596855, "answer_id": 43286603, "question_id": 43279703, "link": "https://stackoverflow.com/questions/43279703/can-i-use-golang-to-get-the-internal-domain-name-of-an-active-directory-environm/43286603#43286603", "title": "Can I use Golang to get the internal domain name of an Active Directory environment?", "body": "<p>There's no built-in way using Go's stdlib, however, you <em>might</em> be able to do it by looking up the short hostname by DNS (to get the IP known by DNS), then doing a reverse lookup of that IP by DNS (which should give you the machine's FQDN), the end of which (minus the short hostname) should be your AD domain. Most of this logic is implemented in <a href=\"https://github.com/Showmax/go-fqdn\" rel=\"nofollow noreferrer\">go-fqdn</a>.</p>\n"}], "owner": {"reputation": 1215, "user_id": 4081647, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/31e29b70920f6bc0952ed800b4e28261?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysQuestioning", "link": "https://stackoverflow.com/users/4081647/alwaysquestioning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1046, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1491596855, "creation_date": 1491572509, "question_id": 43279703, "link": "https://stackoverflow.com/questions/43279703/can-i-use-golang-to-get-the-internal-domain-name-of-an-active-directory-environm", "title": "Can I use Golang to get the internal domain name of an Active Directory environment?", "body": "<p>I want to use Golang to get the FQDN of the internal Windows domain I am on. If the name was CORP.com, for example, I want a small script in Golang to find this for me.</p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["mongodb", "go", "upsert"], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1491570054, "post_id": 43278832, "comment_id": 73625476, "body": "Are you saying I need to make two queries to the MongoDB? Select, check for error then (update if it doesn&#39;t exist/insert if it exists) sort of thing?"}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1491571093, "post_id": 43278832, "comment_id": 73626208, "body": "Sorry I miss understood, you need to use the <code>$set</code> operator Something like: <code>bson.M{&quot;$set&quot;: bson.M{&quot;displayName&quot;: &quot;My name was updated&quot;}}</code>"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1491571852, "post_id": 43278832, "comment_id": 73626718, "body": "One more quick question... When using <code>Update()</code>, do I need to use &quot;$set&quot; as a bson key?"}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1491584740, "post_id": 43278832, "comment_id": 73635346, "body": "<code>$set</code> replaces the value of the field with the value given, it lets you update just that field. If you want to update a part of a doc, and not the whole thing, try using <code>$set</code>, if you want to update the whole doc, try leaving it off."}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": true, "score": 5, "last_activity_date": 1569374798, "last_edit_date": 1569374798, "creation_date": 1491569933, "answer_id": 43278832, "question_id": 43278696, "link": "https://stackoverflow.com/questions/43278696/golang-mgo-insert-or-update-not-working-as-expected/43278832#43278832", "title": "Golang MGO - Insert or update not working as expected", "body": "<p>If you are trying to update a document with fields that you provide and ignore all other fields then I think it's not possible without a select first.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10290621/how-do-i-partially-update-an-object-in-mongodb-so-the-new-object-will-overlay\">See this question on stack overflow</a></p>\n\n<p><em>EDIT:</em>\nTry:</p>\n\n<pre><code>db.C(\"users\").Upsert(\n    bson.M{\"email\": \"someone@gmail.com\"},\n    bson.M{\"$set\": bson.M{\"displayName\": \"My name was updated\"}},\n)\n</code></pre>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6778, "favorite_count": 3, "accepted_answer_id": 43278832, "answer_count": 1, "score": 5, "last_activity_date": 1569374798, "creation_date": 1491569531, "question_id": 43278696, "link": "https://stackoverflow.com/questions/43278696/golang-mgo-insert-or-update-not-working-as-expected", "title": "Golang MGO - Insert or update not working as expected", "body": "<p>I'm running a website in Go and I'm using the <a href=\"https://labix.org/mgo\" rel=\"noreferrer\">MGO</a> package to connect with my MongoDB database.</p>\n\n<p>I am handling a user's sign in, and I am trying to use the func <a href=\"https://godoc.org/gopkg.in/mgo.v2#Collection.Upsert\" rel=\"noreferrer\"><code>Upsert()</code></a> to update a user if they exist in the database, otherwise insert them.</p>\n\n<p>The issue is, when I run <a href=\"https://godoc.org/gopkg.in/mgo.v2#Collection.Upsert\" rel=\"noreferrer\"><code>Upsert()</code></a> (the code below), it replaces all fields rather than updating only the present fields in the second argument's <code>bson.M{}</code>.</p>\n\n<pre><code>db.C(\"users\").Upsert(\n    bson.M{\"email\": \"someone@gmail.com\"}, // Which doucment to upsert\n    bson.M{\"displayName\": \"Johhny\"}, // What to replace\n)\n</code></pre>\n\n<hr>\n\n<p><strong>A visual example of what I'm trying to explain.</strong></p>\n\n<p>An existing database document:</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"58e7589bab64da55ebcf5d25\"),\n    \"email\" : \"someone@gmail.com\",\n    \"password\" : \"\",\n    \"age\": 69,\n    \"displayName\" : \"Someone!\"\n}\n</code></pre>\n\n<p>After running:</p>\n\n<pre><code>db.C(\"users\").Upsert(\n    bson.M{\"email\": \"someone@gmail.com\"},\n    bson.M{\"displayName\": \"My name was updated\"},\n)\n</code></pre>\n\n<p>The document becomes:</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"58e789feab64da55ebcf691c\"),\n    \"displayName\" : \"My name was updated\"\n}\n</code></pre>\n\n<p>When I expected the document to become:</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"58e7589bab64da55ebcf5d25\"),\n    \"email\" : \"someone@gmail.com\",\n    \"password\" : \"\",\n    \"age\": 69,\n    \"displayName\" : \"My name was updated\" // This should be updated, all others should be left untouched\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Finally my question.</strong></p>\n\n<p>How can I update a document if it already exists in a MongoDB collection, otherwise insert it?</p>\n"}]