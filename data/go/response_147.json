[{"tags": ["json", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 11, "last_activity_date": 1509569569, "last_edit_date": 1509569569, "creation_date": 1509567968, "answer_id": 47063104, "question_id": 47063079, "link": "https://stackoverflow.com/questions/47063079/cannot-unmarshal-string-into-go-struct-field/47063104#47063104", "title": "cannot unmarshal string into Go struct field", "body": "<p>The problem is that <code>v1Compatibility</code> is a string value in the JSON; the value happens to be JSON content, but it's inside a JSON string, so can't be unmarshalled all in one step. You could instead unmarshal it in two passes:</p>\n\n<pre><code>type ManifestResponse struct {\n    Name         string `json:\"name\"`\n    Tag          string `json:\"tag\"`\n    Architecture string `json:\"architecture\"`\n\n    FsLayers []struct {\n        BlobSum string `json:\"blobSum\"`\n    } `json:\"fsLayers\"`\n\n    History []struct {\n        V1CompatibilityRaw string `json:\"v1Compatibility\"`\n        V1Compatibility V1Compatibility\n    } `json:\"history\"`\n}\n\ntype V1Compatibility struct {\n    ID              string `json:\"id\"`\n    Parent          string `json:\"parent\"`\n    Created         string `json:\"created\"`\n}\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>var jsonManResp ManifestResponse\nif err := json.Unmarshal([]byte(exemplar), &amp;jsonManResp); err != nil {\n    log.Fatal(err)\n}\nfor i := range jsonManResp.History {\n    var comp V1Compatibility\n    if err := json.Unmarshal([]byte(jsonManResp.History[i].V1CompatibilityRaw), &amp;comp); err != nil {\n        log.Fatal(err)\n    }\n    jsonManResp.History[i].V1Compatibility = comp\n}\n</code></pre>\n\n<p>Working playground example here: <a href=\"https://play.golang.org/p/QNsu5_63E0\" rel=\"noreferrer\">https://play.golang.org/p/QNsu5_63E0</a></p>\n"}], "owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14317, "favorite_count": 0, "accepted_answer_id": 47063104, "answer_count": 1, "score": 4, "last_activity_date": 1509569569, "creation_date": 1509567870, "question_id": 47063079, "link": "https://stackoverflow.com/questions/47063079/cannot-unmarshal-string-into-go-struct-field", "title": "cannot unmarshal string into Go struct field", "body": "<p>I have the following (incomplete type) (which is a response from docker API from manifests endpoint v2 schema 1 <a href=\"https://docs.docker.com/registry/spec/manifest-v2-1/\" rel=\"nofollow noreferrer\">https://docs.docker.com/registry/spec/manifest-v2-1/</a>)</p>\n\n<pre><code>type ManifestResponse struct {\n    Name         string `json:\"name\"`\n    Tag          string `json:\"tag\"`\n    Architecture string `json:\"architecture\"`\n\n    FsLayers []struct {\n        BlobSum string `json:\"blobSum\"`\n    } `json:\"fsLayers\"`\n\n    History []struct {\n        V1Compatibility struct {\n            ID              string `json:\"id\"`\n            Parent          string `json:\"parent\"`\n            Created         string `json:\"created\"`\n        } `json:\"v1Compatibility\"`\n    } `json:\"history\"`\n}\n</code></pre>\n\n<p>While getting the following response:</p>\n\n<pre><code> { \"schemaVersion\": 1,\n   \"name\": \"library/redis\",\n   \"tag\": \"latest\",\n   \"architecture\": \"amd64\",\n   \"history\": [\n      {\n         \"v1Compatibility\": \"{\\\"id\\\":\\\"ef8a93741134ad37c834c32836aefbd455ad4aa4d1b6a6402e4186dfc1feeb88\\\",\\\"parent\\\":\\\"9c8b347e3807201285053a5413109b4235cca7d0b35e7e6b36554995cfd59820\\\",\\\"created\\\":\\\"2017-10-10T02:53:19.011435683Z\\\"}\"\n      }\n   ]\n}\n</code></pre>\n\n<p>While trying to deserialize it using the following snippet of code:</p>\n\n<pre><code>var jsonManResp ManifestResponse                                                                                                                                                                                                                                                \nif err = json.NewDecoder(res.Body).Decode(&amp;jsonManResp); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>json: cannot unmarshal string into Go struct field .v1Compatibility of type struct { ID string \"json:\\\"id\\\"\"; Parent string \"json:\\\"parent\\\"\"; Created string \"json:\\\"created\\\"\" }\n</code></pre>\n\n<p>Full playground code: <a href=\"https://play.golang.org/p/tHzf9GphWX\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tHzf9GphWX</a></p>\n\n<p>What might be the problem?</p>\n"}, {"tags": ["go", "certificate", "kubernetes", "certificate-authority"], "comments": [{"owner": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 1, "creation_date": 1509562590, "post_id": 47061509, "comment_id": 81071459, "body": "Need to fix your log link."}, {"owner": {"reputation": 57199, "user_id": 265261, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3e27be34f21aa0acd442e1961c17c362?s=128&d=identicon&r=PG", "display_name": "aknuds1", "link": "https://stackoverflow.com/users/265261/aknuds1"}, "reply_to_user": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1509563092, "post_id": 47061509, "comment_id": 81071720, "body": "@johnharris85 Ugh thanks!"}, {"owner": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 1, "creation_date": 1509564998, "post_id": 47061509, "comment_id": 81072757, "body": "Network connectivity to etcd? What&#39;s your cluster arch look like?"}, {"owner": {"reputation": 57199, "user_id": 265261, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3e27be34f21aa0acd442e1961c17c362?s=128&d=identicon&r=PG", "display_name": "aknuds1", "link": "https://stackoverflow.com/users/265261/aknuds1"}, "reply_to_user": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1509577197, "post_id": 47061509, "comment_id": 81078147, "body": "Thanks for taking an interest in this @johnharris85! I was wondering whether the apiserver can connect to etcd myself. Do you know how to test the connectivity from the apiserver (master) node to the etcd cluster? Regarding cluster arch, I&#39;m using my port of Tectonic Installer to DigitalOcean: <a href=\"https://github.com/aknuds1/tectonic-installer/tree/digitalocean\" rel=\"nofollow noreferrer\">github.com/aknuds1/tectonic-installer/tree/digitalocean</a>.  Let me know if you need more info from my side!"}, {"owner": {"reputation": 57199, "user_id": 265261, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3e27be34f21aa0acd442e1961c17c362?s=128&d=identicon&r=PG", "display_name": "aknuds1", "link": "https://stackoverflow.com/users/265261/aknuds1"}, "reply_to_user": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1509612829, "post_id": 47061509, "comment_id": 81090164, "body": "@johnharris85 I found out from testing that I can indeed not access etcd from my master node, even though it works from one of the etcd member machines. I added info on this to my question."}, {"owner": {"reputation": 57199, "user_id": 265261, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3e27be34f21aa0acd442e1961c17c362?s=128&d=identicon&r=PG", "display_name": "aknuds1", "link": "https://stackoverflow.com/users/265261/aknuds1"}, "reply_to_user": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1509622303, "post_id": 47061509, "comment_id": 81096497, "body": "@johnharris85 I think I found the cause. The master node has an outdated version of the etcd CA, due to a synchronization issue in my Terraform setup. Working to resolve that one now..."}], "answers": [{"tags": [], "owner": {"reputation": 57199, "user_id": 265261, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3e27be34f21aa0acd442e1961c17c362?s=128&d=identicon&r=PG", "display_name": "aknuds1", "link": "https://stackoverflow.com/users/265261/aknuds1"}, "is_accepted": true, "score": 3, "last_activity_date": 1509785962, "creation_date": 1509785962, "answer_id": 47109115, "question_id": 47061509, "link": "https://stackoverflow.com/questions/47061509/what-might-cause-the-kubernetes-api-server-to-fail-to-write-the-client-ca-config/47109115#47109115", "title": "What might cause the Kubernetes API server to fail to write the client CA configmap?", "body": "<p>I found out that despite the cryptic error message in the API server, the cause is that it can't write to the etcd cluster. The reason was that the API server was configured with a different client certificate authority than what the etcd cluster was using, due to a timing issue wrt. copying certificates in my Terraform cluster setup. I figured out that the CA was the problem by using curl to contact the etcd cluster instead of etcdctl, as it gave a clear error message.</p>\n\n<p>Thanks to @johnharris85 for suggesting etcd connectivity being an issue!</p>\n"}], "owner": {"reputation": 57199, "user_id": 265261, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3e27be34f21aa0acd442e1961c17c362?s=128&d=identicon&r=PG", "display_name": "aknuds1", "link": "https://stackoverflow.com/users/265261/aknuds1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1591, "favorite_count": 1, "accepted_answer_id": 47109115, "answer_count": 1, "score": 1, "last_activity_date": 1509785962, "creation_date": 1509561377, "last_edit_date": 1509612811, "question_id": 47061509, "link": "https://stackoverflow.com/questions/47061509/what-might-cause-the-kubernetes-api-server-to-fail-to-write-the-client-ca-config", "title": "What might cause the Kubernetes API server to fail to write the client CA configmap?", "body": "<p>I'm experiencing that the Kubernetes API server fails to start during cluster bootstrapping with the following error log, apparently due to being unable to initialize its \"client CA configmap\": </p>\n\n<pre><code>E1029 14:35:56.211083       5 client_ca_hook.go:78] Timeout: request did not complete within allowed duration\nF1029 14:35:56.211121       5 hooks.go:126] PostStartHook \u201cca-registration\u201d failed: unable to initialize client CA configmap: timed out waiting for the condition\n</code></pre>\n\n<p>It seems to happen <a href=\"https://github.com/kubernetes/kubernetes/blob/17baaacb29247dbb6b04471f4bee831b0d617dc8/pkg/master/client_ca_hook.go#L67\" rel=\"nofollow noreferrer\">here</a> in the Kubernetes source code. What might cause this error?</p>\n\n<p>See the full log <a href=\"https://slack-files.com/T09NY5SBT-F7SNQ2370-1671ad4b77\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p><strong>Update:</strong> It seems that my etcd cluster isn't accessible from master nodes, even though the same command works from etcd member machines:</p>\n\n<pre><code>$ sudo ETCDCTL_API=3 etcdctl --cacert=/opt/tectonic/tls/etcd-client-ca.crt \\\n--cert=/opt/tectonic/tls/etcd-client.crt --key=/opt/tectonic/tls/etcd-client.key \\\n--endpoints=https://coreos-testing-etcd-0.socialfoodie.club:2379 \\\nendpoint health\nhttps://coreos-testing-etcd-0.socialfoodie.club:2379 is unhealthy: failed to connect: grpc: timed out when dialing\nError:  unhealthy cluster\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 0, "creation_date": 1509559324, "post_id": 47059551, "comment_id": 81069647, "body": "The credetials should be in the <code>&#47;home&#47;&lt;username&gt;&#47;.aws&#47;</code> directory"}, {"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "reply_to_user": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 0, "creation_date": 1509561920, "post_id": 47059551, "comment_id": 81071127, "body": "@Arjan already did it, but still the same. I will edit the post to show I hae in that file"}], "answers": [{"comments": [{"owner": {"reputation": 8237, "user_id": 2503722, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/X5Do3.jpg?s=128&g=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/2503722/amir"}, "edited": false, "score": 0, "creation_date": 1582530836, "post_id": 47063168, "comment_id": 106795274, "body": "I missed to add [default]. Thank you. after adding [default] my issue solved"}], "tags": [], "owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "is_accepted": true, "score": 4, "last_activity_date": 1582628029, "last_edit_date": 1582628029, "creation_date": 1509568183, "answer_id": 47063168, "question_id": 47059551, "link": "https://stackoverflow.com/questions/47059551/nocredentialproviders-in-aws-s3-in-golang/47063168#47063168", "title": "NoCredentialproviders in AWS S3 in Golang", "body": "<p>I would suggest you follow the guide here: <a href=\"http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html\" rel=\"nofollow noreferrer\">http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html</a></p>\n\n<p>This command will ask you for access/secret key and write them in a correct format:</p>\n\n<pre><code>aws configure\n</code></pre>\n\n<p>It would appear you have a wrong format of <code>credentials</code> file. The correct format would be something like this:</p>\n\n<pre><code>[default]\naws_access_key_id = SOME_ACCESS_KEY\naws_secret_access_key = SOME_AWS_SECRET_KEY\n</code></pre>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2155, "favorite_count": 0, "accepted_answer_id": 47063168, "answer_count": 1, "score": 2, "last_activity_date": 1582628029, "creation_date": 1509554162, "last_edit_date": 1509562034, "question_id": 47059551, "link": "https://stackoverflow.com/questions/47059551/nocredentialproviders-in-aws-s3-in-golang", "title": "NoCredentialproviders in AWS S3 in Golang", "body": "<p>I am working in Golang,now I am attempting to upload an image to AWS S3, but I get:</p>\n\n<pre><code>NoCredentialProviders: no valid providers in chain. Deprecated.\n    For verbose messaging see aws.Config.CredentialsChainVerboseErrors\n</code></pre>\n\n<p>My code is like this:</p>\n\n<pre><code>func firstFunction(){\n    //Connect to S3\n    AWSsession, err := ConnectAWS()\n    if err != nil {\n        fmt.Println(\"Error Connecting to AWS S3\")\n    }\n\n    GetSingleMedia(AWSsession)\n}\n\nfunc ConnectAWS()(*session.Session, error){\n\n    //Create S3 Session\n    AWSsession, err := session.NewSession(&amp;aws.Config{\n        Region: aws.String(\"us-west-2\")},\n    )\n\n    if err != nil {\n        fmt.Println(\"Error AWS:\", err.Error())\n    }\n\n    return AWSsession,err\n}\n\nfunc GetSingleMedia(...someparams,AWSsession *session.Session){\n            //o.Blob is correct, this is valid\n            data, err := ioutil.ReadAll(bytes.NewReader(o.Blob))\n            //Store: bytes.NewReader(o.Blob)\n            UploadImage(AWSsession,bytes.NewReader(o.Blob),bucket,\"SomeID\")\n}\n\nfunc UploadImage(AWSsession *session.Session,reader *bytes.Reader,bucket string, key string) (*s3manager.UploadOutput,error){\n\n    uploader := s3manager.NewUploader(AWSsession)\n\n    result, err := uploader.Upload(&amp;s3manager.UploadInput{\n        Body : reader,\n        Bucket: aws.String(bucket),\n        Key : aws.String(key),\n    })\n\n    if err != nil {\n        fmt.Println(\"Error uploagin img: \",err.Error())\n    }\n\n\n    return result,err\n}\n</code></pre>\n\n<p>Also, I have placed the creentials under <code>/home/myuser/.aws/</code> there's a credential file, I don't get any error on creating the session, then, what could be the problem?\nThe error is triggered in UploadImage</p>\n\n<p>EDIT:</p>\n\n<p>Currently in the credentials file I have:</p>\n\n<pre><code>[default]\nawsBucket = \"someBucket\"\nawsAccessKey = \"SOME_ACCESS_KEY\"\nawsSecretKey = \"SOME_AWS_SECRET_KEY\"\n</code></pre>\n\n<p>Sould I change any permission or something?</p>\n"}, {"tags": ["go", "amazon-redshift"], "answers": [{"tags": [], "owner": {"reputation": 11879, "user_id": 139490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3f808947f68fe8dd3e6662ec1e1e4bf?s=128&d=identicon&r=PG", "display_name": "Joe Harris", "link": "https://stackoverflow.com/users/139490/joe-harris"}, "is_accepted": true, "score": 0, "last_activity_date": 1510332019, "creation_date": 1510332019, "answer_id": 47227427, "question_id": 47058996, "link": "https://stackoverflow.com/questions/47058996/sql-query-finishes-at-server-but-program-never-resumes/47227427#47227427", "title": "SQL Query finishes at server but program never resumes", "body": "<p>You need to alter the keep alive behavior of the library that's managing the Redshift connection. Unfortuantely I can't advise you on how to do that in Go. </p>\n\n<p>For a JDBC URL you could append the options:</p>\n\n<pre><code>jdbc:redshift://my-cluster \u2026 :5439/user?tcpKeepAlive=true&amp;TCPKeepAliveMinutes=2\n</code></pre>\n\n<p>See the documentation here for more options: <a href=\"http://docs.aws.amazon.com/redshift/latest/mgmt/troubleshooting-connections.html\" rel=\"nofollow noreferrer\">http://docs.aws.amazon.com/redshift/latest/mgmt/troubleshooting-connections.html</a></p>\n"}], "owner": {"reputation": 1592, "user_id": 703061, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7db295545ff40053c8d7f062167395ef?s=128&d=identicon&r=PG&f=1", "display_name": "wayfare", "link": "https://stackoverflow.com/users/703061/wayfare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 47227427, "answer_count": 1, "score": 0, "last_activity_date": 1510332019, "creation_date": 1509552276, "last_edit_date": 1509552415, "question_id": 47058996, "link": "https://stackoverflow.com/questions/47058996/sql-query-finishes-at-server-but-program-never-resumes", "title": "SQL Query finishes at server but program never resumes", "body": "<p>I am connecting my go scripts to redshift using go-lang postgres driver. When query takes 5+ minutes to complete, my program never gets its control back. After checking the query at redshift-server I do see that query completed in ~7 minutes. </p>\n\n<p>Not sure why is this happening. </p>\n\n<p>My code </p>\n\n<pre><code>func truncate_and_populate_set_1(db *sql.DB, parameter string){\n  insert_q := `...`\n  db := GetDB()\n  util.ExeQ(db, insert_q)\n  log.Println(\"Done adding records to table\")\n}\n\nfunc GetDB() *sql.DB {\n  connection_string := \"postgres://%s:%s@host\"\n  db, err := sql.Open(\"postgres\", connection_string)\n  if err != nil {\n    fmt.Println(err)\n  }\n  return db\n}\n\nfunc ExeQ(db *sql.DB, query string) {\n_, err := db.Exec(query)\nif err != nil {\n    log.Fatal(err)\n  }\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1509552778, "post_id": 47058532, "comment_id": 81065622, "body": "Please format your JSON strings usign line breaks &amp; indent. It&#39;s not readable at the moment and hard to understand the difference."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509552806, "post_id": 47058532, "comment_id": 81065646, "body": "There isn&#39;t. A Go struct equates to a JSON object, not a JSON array. You could do it yourself with a custom <code>UnmarshalJSON</code>."}], "answers": [{"tags": [], "owner": {"reputation": 365, "user_id": 2130607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6423be6ad9f861ddba9f1f1016cf2b4?s=128&d=identicon&r=PG", "display_name": "Kebeng", "link": "https://stackoverflow.com/users/2130607/kebeng"}, "is_accepted": false, "score": 0, "last_activity_date": 1509558582, "creation_date": 1509558582, "answer_id": 47060833, "question_id": 47058532, "link": "https://stackoverflow.com/questions/47058532/convert-struct-to-json-array-instead-of-json-object/47060833#47060833", "title": "Convert struct to json array instead of json object", "body": "<p>i think you need a slice of interface to wrap both <code>A</code> and <code>B</code> struct into a single slice </p>\n\n<p>please take a look at my snippet here <a href=\"https://play.golang.org/p/c0xldskKyz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/c0xldskKyz</a></p>\n"}, {"tags": [], "owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "is_accepted": true, "score": 1, "last_activity_date": 1509601829, "creation_date": 1509601829, "answer_id": 47068438, "question_id": 47058532, "link": "https://stackoverflow.com/questions/47058532/convert-struct-to-json-array-instead-of-json-object/47068438#47068438", "title": "Convert struct to json array instead of json object", "body": "<p>You may do so by implementing <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow noreferrer\">json.Marshaler</a> interface in B.</p>\n\n<p>For example: <a href=\"https://play.golang.org/p/fT1WlQ5Raz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/fT1WlQ5Raz</a></p>\n\n\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype A struct {\n    Content string\n}\n\ntype B struct {\n    Element  A\n    Children []B\n}\n\n// MarshalJSON implements json.Marshaler\nfunc (b B) MarshalJSON() ([]byte, error) {\n    return json.Marshal([]interface{}{\n        b.Element,\n        b.Children,\n    })\n}\n\nfunc main() {\n\n    root := B{\n        Element: A{Content: \"AAA\"},\n        Children: []B{\n            B{\n                Element: A{Content: \"BBB\"},\n                Children: []B{\n                    B{Element: A{Content: \"CCC\"}, Children: []B{}},\n                    B{Element: A{Content: \"DDD\"}, Children: []B{}},\n                },\n            },\n        },\n    }\n\n    content, _ := json.MarshalIndent(root, \"\", \"  \")\n    fmt.Printf(\"%s\\n\", content)\n}\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>[\n  {\n    \"Content\": \"AAA\"\n  },\n  [\n    [\n      {\n        \"Content\": \"BBB\"\n      },\n      [\n        [\n          {\n            \"Content\": \"CCC\"\n          },\n          []\n        ],\n        [\n          {\n            \"Content\": \"DDD\"\n          },\n          []\n        ]\n      ]\n    ]\n  ]\n]\n</code></pre>\n"}], "owner": {"reputation": 589, "user_id": 7133903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a90a61f394c0a5af4cb643a7557181b6?s=128&d=identicon&r=PG&f=1", "display_name": "thelmuxkriovar", "link": "https://stackoverflow.com/users/7133903/thelmuxkriovar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1081, "favorite_count": 0, "accepted_answer_id": 47068438, "answer_count": 2, "score": 0, "last_activity_date": 1509601829, "creation_date": 1509550857, "last_edit_date": 1509552969, "question_id": 47058532, "link": "https://stackoverflow.com/questions/47058532/convert-struct-to-json-array-instead-of-json-object", "title": "Convert struct to json array instead of json object", "body": "<p>I apologise in advance if this question is considered too easy or whatever; this is the first time I'm writing anything in go. I have two structs (simplified for this question)</p>\n\n<pre><code>type A struct {\n    Content string\n}\n\ntype B struct {\n    Element A `json:\"0\"`\n    Children []B `json:\"1\"`\n}\n</code></pre>\n\n<p>I want to encode a value of type <code>B</code> into JSON, but instead of returning an object it should return a json array</p>\n\n<p>For example:</p>\n\n<p>What I get: </p>\n\n<pre><code>[\n    {\n        \"0\":{\n            \"Content\":\"AAA\"\n        },\n        \"1\":[\n            {\n                \"0\":{\n                    \"Content\":\"BBB\"\n                },\n                \"1\":[\n                    {\n                        \"0\":{\n                            \"Content\":\"CCC\"\n                        },\n                        \"1\":[]\n                    },\n                    {\n                        \"0\":{\n                            \"Content\":\"DDD\"\n                        },\n                        \"1\":[]\n                    }\n                }\n            ]\n        ]\n    }\n]\n</code></pre>\n\n<p>What I need:</p>\n\n<pre><code>[\n    {\"Content\": \"AAA\"}, \n    [\n        [\n            {\"Content\": \"BBB\"},\n            [\n                {\"Content\": \"CCC\"}, \n                []\n            ]\n        ], \n        [\n            {\"Content\": \"DDD\"}, \n            []\n        ]\n    ]\n]\n</code></pre>\n\n<p>I could do this by manually iterating through it, but I would hope that there's an integrated way to do it</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 3332, "user_id": 417385, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a0024777a54ad1c88797a62231bfbf38?s=128&d=identicon&r=PG", "display_name": "Mathias Bak", "link": "https://stackoverflow.com/users/417385/mathias-bak"}, "edited": false, "score": 0, "creation_date": 1509549827, "post_id": 47057820, "comment_id": 81063652, "body": "Say the <code>Obj</code> struct has a lot of properties. Is there a way to avoid repeating the them this many times?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3332, "user_id": 417385, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a0024777a54ad1c88797a62231bfbf38?s=128&d=identicon&r=PG", "display_name": "Mathias Bak", "link": "https://stackoverflow.com/users/417385/mathias-bak"}, "edited": false, "score": 1, "creation_date": 1509550548, "post_id": 47057820, "comment_id": 81064120, "body": "@MathiasBak Yes, using a type declaration like <code>type Obj2 Obj</code>, and assigning the result to <code>*o</code> using a type conversion: <code>*o = Obj(obj)</code>. See example on the <a href=\"https://play.golang.org/p/SCpSwg_vU-\" rel=\"nofollow noreferrer\">Go Playground</a>. I would personally recommend this instead of duplicating the struct. Or even better: declare a new type <code>type Obj2 Obj</code>, and assign the <code>o</code> itself to a value of type <code>*Obj2</code>: <code>var obj *Obj2 = (*Obj2)(o)</code>, and so you don&#39;t even to have copy the result, the <code>json</code> package will unmarsal into <code>o</code> itself. See this on the <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">Playground</a>. This wins performance-wise."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1509551633, "last_edit_date": 1509551633, "creation_date": 1509548596, "answer_id": 47057820, "question_id": 47057240, "link": "https://stackoverflow.com/questions/47057240/parsing-multiple-json-types-into-the-same-struct/47057820#47057820", "title": "Parsing multiple JSON types into the same struct", "body": "<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Obj struct {\n    Name string   `json:\"name\"`\n    Key2 []string `json:\"key2\"`\n}\n\nfunc (o *Obj) UnmarshalJSON(b []byte) error {\n    var name string\n    if err := json.Unmarshal(b, &amp;name); err == nil {\n        *o = Obj{}\n        o.Name = name\n        return nil\n    }\n\n    type Obj2 Obj\n    var o2 Obj2\n    if err := json.Unmarshal(b, &amp;o2); err != nil {\n        return err\n    }\n    *o = Obj(o2)\n    return nil\n}\n\nconst payload = `[\n    {\"name\": \"obj1\", \"key2\": [\"a\", \"b\"]},\n    \"obj2\",\n    {\"name\": \"obj3\"}\n]\n`\n\nfunc main() {\n    var objs []*Obj\n    if err := json.Unmarshal([]byte(payload), &amp;objs); err != nil {\n        panic(err)\n    }\n    for _, obj := range objs {\n        fmt.Printf(\"Name:%v, Key2:%v\\n\", obj.Name, obj.Key2)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/rmtSOpkYqp\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rmtSOpkYqp</a></p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1509549979, "last_edit_date": 1509549979, "creation_date": 1509549157, "answer_id": 47058013, "question_id": 47057240, "link": "https://stackoverflow.com/questions/47057240/parsing-multiple-json-types-into-the-same-struct/47058013#47058013", "title": "Parsing multiple JSON types into the same struct", "body": "<p>Another solution is to unmarshal the varying elements of your JSON arrray into values of types you expect, and process / create an <code>Obj</code> wrapper for the <code>string</code> values should you need it.</p>\n\n<p>Since your input is a JSON array, it can be unmarshalled into an array or slice. And since the elements are of different types, the element type of the Go array or slice must be <code>interface{}</code>.</p>\n\n<p>Unmarshaling into a value of type <code>[]interface{}</code> would result in the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a> package choosing <code>map[string]interface{}</code> for the object elements. But if you populate the target slice prior with elements of the types you wish to unmarshal into, the <code>json</code> package will obediently use those:</p>\n\n<pre><code>func main() {\n    res := []interface{}{\n        &amp;Obj{},\n        \"\",\n        &amp;Obj{},\n    }\n    if err := json.Unmarshal([]byte(src), &amp;res); err != nil {\n        panic(err)\n    }\n\n    for _, v := range res {\n        fmt.Printf(\"type = %-10T value = %+q\\n\", v, v)\n    }\n}\n\nconst src = `[\n    {\"name\": \"obj1\", \"key2\": [\"a\", \"b\"]},\n    \"obj2\",\n    {\"name\": \"obj3\"}\n]`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/h-ced0TyB4\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>type = *main.Obj  value = &amp;{\"obj1\" [\"a\" \"b\"]}\ntype = string     value = \"obj2\"\ntype = *main.Obj  value = &amp;{\"obj3\" []}\n</code></pre>\n"}], "owner": {"reputation": 3332, "user_id": 417385, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a0024777a54ad1c88797a62231bfbf38?s=128&d=identicon&r=PG", "display_name": "Mathias Bak", "link": "https://stackoverflow.com/users/417385/mathias-bak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 47057820, "answer_count": 2, "score": 2, "last_activity_date": 1509551633, "creation_date": 1509546671, "question_id": 47057240, "link": "https://stackoverflow.com/questions/47057240/parsing-multiple-json-types-into-the-same-struct", "title": "Parsing multiple JSON types into the same struct", "body": "<p>I am requesting an API which returns JSON containing an array of objects. The problem is that the objects can take two forms. They can either be a string or an object. An example result could look like this:</p>\n\n<pre><code>[\n    {\"name\": \"obj1\", \"key2\": [\"a\", \"b\"]},\n    \"obj2\",\n    {\"name\": \"obj3\"}\n]\n</code></pre>\n\n<p>A string element <code>\"objX\"</code> is equivalent to <code>{\"name\": \"objX\"}</code>.</p>\n\n<p>I want to parse this into a slice of the following type:</p>\n\n<pre><code>type Obj struct {\n    Name string\n    Key2 []string\n}\n</code></pre>\n\n<p>How do I do this in a reasonable fashion?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 3926117, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97cab7a986695d1ccc6d2c8ec7ccbc85?s=128&d=identicon&r=PG&f=1", "display_name": "JimF", "link": "https://stackoverflow.com/users/3926117/jimf"}, "edited": false, "score": 0, "creation_date": 1509550654, "post_id": 47057491, "comment_id": 81064179, "body": "Can&#39;t I make the signature something like: func readDataset(grp *Group, a type) ([]arbitrary_struct_type, error)?  But, that doesn&#39;t solve how I&#39;ll pass the return value."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "reply_to_user": {"reputation": 97, "user_id": 3926117, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97cab7a986695d1ccc6d2c8ec7ccbc85?s=128&d=identicon&r=PG&f=1", "display_name": "JimF", "link": "https://stackoverflow.com/users/3926117/jimf"}, "edited": false, "score": 2, "creation_date": 1509551119, "post_id": 47057491, "comment_id": 81064493, "body": "You return either <code>interface{}</code> or <code>[]interface{}</code> or if you can you can define some interface and return <code>[]YourInterface</code>."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "reply_to_user": {"reputation": 97, "user_id": 3926117, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97cab7a986695d1ccc6d2c8ec7ccbc85?s=128&d=identicon&r=PG&f=1", "display_name": "JimF", "link": "https://stackoverflow.com/users/3926117/jimf"}, "edited": false, "score": 0, "creation_date": 1509551283, "post_id": 47057491, "comment_id": 81064605, "body": "I&#39;ve added a link to a code that do similar task of reading entities from DB (specifically Googe AppEngine Datastore)"}], "tags": [], "owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "is_accepted": false, "score": 0, "last_activity_date": 1509551241, "last_edit_date": 1509551241, "creation_date": 1509547509, "answer_id": 47057491, "question_id": 47057237, "link": "https://stackoverflow.com/questions/47057237/pass-arbitrary-struct-as-function-parameter/47057491#47057491", "title": "Pass arbitrary struct as function parameter", "body": "<p>You probably want to return a slice and not an array.</p>\n\n<p>You can use <a href=\"https://golang.org/pkg/reflect/#MakeSlice\" rel=\"nofollow noreferrer\"><code>reflect.MakeSlice()</code></a> function to make slice, and to get type of the arbitrary object you can use <a href=\"https://golang.org/pkg/reflect/#TypeOf\" rel=\"nofollow noreferrer\"><code>reflect.TypeOf()</code></a>  function</p>\n\n<p>I'm doing something similar in <a href=\"https://github.com/strongo/app/blob/master/db/interfaces.go\" rel=\"nofollow noreferrer\">https://github.com/strongo/app/blob/master/db/interfaces.go</a> &amp; <a href=\"https://github.com/strongo/app/blob/master/gaedb/database.go\" rel=\"nofollow noreferrer\">https://github.com/strongo/app/blob/master/gaedb/database.go</a> which are used in <a href=\"https://github.com/strongo/bots-framework\" rel=\"nofollow noreferrer\">https://github.com/strongo/bots-framework</a></p>\n"}], "owner": {"reputation": 97, "user_id": 3926117, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97cab7a986695d1ccc6d2c8ec7ccbc85?s=128&d=identicon&r=PG&f=1", "display_name": "JimF", "link": "https://stackoverflow.com/users/3926117/jimf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1509551241, "creation_date": 1509546664, "last_edit_date": 1509550779, "question_id": 47057237, "link": "https://stackoverflow.com/questions/47057237/pass-arbitrary-struct-as-function-parameter", "title": "Pass arbitrary struct as function parameter", "body": "<p>I'm processing binary files.  I need a function which takes an arbitrary structure and returns an array of those structures.  How would I do this?  Below is a simple example of what I'm trying to accomplish.  Currently, I have a function for each of the structures.  The only difference is in the line: </p>\n\n<pre><code>dataBuf, err := make([]arbitrary_struct_type, numRecs)\n</code></pre>\n\n\n\n<pre><code>type structA struct {\n   id int32\n   sDate float64\n   name  string\n}\n\ntype structB struct {\n   area int32\n   polygon string\n}\n\ntype structC struct {\n   sTime  float64\n   eTime  float64\n   tSlice int32\n   kml    string\n}\n\nfunc readDataset(grp *Group, arbitrary_struct_type type) ([]arbitrary_struct_type type, error) {\n   ...\n   dataBuf, err := make([]arbitrary_struct_type, numRecs)\n   ...\n   return dataBuf, err\n}\n\nfunc main() {\n   ...\n   a, err := readDataset(grp1, structA)\n   ...\n   b, err := readDataset(grp2, structB)\n   ...\n   c, err := readDataset(grp3, structC)\n   ...\n}\n</code></pre>\n"}, {"tags": ["go", "rabbitmq"], "comments": [{"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1509565153, "post_id": 47056294, "comment_id": 81072844, "body": "Very good, and now only use debugger or fmt.Println and find the command where your program stuck"}, {"owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "edited": false, "score": 0, "creation_date": 1509589873, "post_id": 47056294, "comment_id": 81081420, "body": "in amqp, <a href=\"https://godoc.org/github.com/streadway/amqp#Channel.Publish\" rel=\"nofollow noreferrer\"><code>Channel.Publish</code></a> returns an error, maybe you should check the error returned if any."}, {"owner": {"reputation": 9173, "user_id": 172265, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7d658f2c111ae5d8b48f0f0aa7624372?s=128&d=identicon&r=PG", "display_name": "lang2", "link": "https://stackoverflow.com/users/172265/lang2"}, "edited": false, "score": 0, "creation_date": 1509632693, "post_id": 47056294, "comment_id": 81103767, "body": "it does exit, for me at least."}], "answers": [{"tags": [], "owner": {"reputation": 190, "user_id": 4930039, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rEUdeD01CHo/AAAAAAAAAAI/AAAAAAAAAG0/WwrPn4KkmKc/photo.jpg?sz=128", "display_name": "rupj", "link": "https://stackoverflow.com/users/4930039/rupj"}, "is_accepted": true, "score": 1, "last_activity_date": 1511896016, "creation_date": 1511896016, "answer_id": 47539118, "question_id": 47056294, "link": "https://stackoverflow.com/questions/47056294/rabbitmq-producer-is-stuck-in-golang/47539118#47539118", "title": "RabbitMQ Producer is stuck in golang", "body": "<p>It's probably an issue with your setup. I faced a similar issue and tried with a different Erlang and RabbitMQ installation.\nTry uninstalling both Erlang and RabbitMQ and maybe use an older stable version.</p>\n\n<p>Alternatively use the official RabbitMQ docker image. Follow the <a href=\"https://docs.docker.com/samples/library/rabbitmq/\" rel=\"nofollow noreferrer\">Docker RabbitMQ Docs</a> for setting it up. :)  </p>\n"}], "owner": {"reputation": 544, "user_id": 3970258, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7df68893bf9045d5a3490307e448f807?s=128&d=identicon&r=PG&f=1", "display_name": "Sharthak Ghosh", "link": "https://stackoverflow.com/users/3970258/sharthak-ghosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 47539118, "answer_count": 1, "score": 1, "last_activity_date": 1511896016, "creation_date": 1509543734, "last_edit_date": 1509544147, "question_id": 47056294, "link": "https://stackoverflow.com/questions/47056294/rabbitmq-producer-is-stuck-in-golang", "title": "RabbitMQ Producer is stuck in golang", "body": "<p>Im new to golang and rabbitmq, I have written a simple producer like this</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/streadway/amqp\"\n    \"log\"\n)\n\nfunc main() {\n    server()\n}\n\nfunc server() {\n    conn, ch, q := getQueue()\n    defer conn.Close()\n    defer ch.Close()\n\n    msg := amqp.Publishing{\n        ContentType: \"text/plain\",\n        Body:        []byte(\"Hello RabbitMQ\"),\n    }\n\n    ch.Publish(\"\", q.Name, false, false, msg)\n}\n\nfunc getQueue() (*amqp.Connection, *amqp.Channel, *amqp.Queue) {\n    conn, err := amqp.Dial(\"amqp://guest:guest@localhost:5672/\")\n    failOnError(err, \"Failed to connect to RabbitMQ\")\n    ch, err := conn.Channel()\n    failOnError(err, \"Failed to open a channel\")\n    q, err := ch.QueueDeclare(\"hello\",\n        false, //durable bool,\n        false, //autoDelete bool,\n        false, //exclusive bool,\n        false,\n        nil)\n    failOnError(err, \"Failed to declare queue\")\n    return conn, ch, &amp;q\n}\n\nfunc failOnError(err error, msg string) {\n    if err != nil {\n        log.Fatalf(\"%s: %s\", msg, err)\n        panic(fmt.Sprintf(\"%s: %s\", msg, err))\n    }\n}\n</code></pre>\n\n<p>When I run this it doesnt exit niether does it throw any error messages. In the RabbitMQ management console I can see the Queue but there is no data in it and only shows NaN.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509543492, "post_id": 47055584, "comment_id": 81059327, "body": "Do <code>Release</code>/<code>Kill</code> return errors? Or just do nothing? (Also totally unrelated but the whole <code>iBrowserHandler interface</code> is bad form for Go, looks like you may be used to C#?)"}, {"owner": {"reputation": 3782, "user_id": 839211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/THWvr.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/839211/felipe"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509543660, "post_id": 47055584, "comment_id": 81059456, "body": "No, they don&#39;t return any errors, they just don&#39;t do anything."}, {"owner": {"reputation": 3782, "user_id": 839211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/THWvr.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/839211/felipe"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509543770, "post_id": 47055584, "comment_id": 81059553, "body": "And yes, I am used to C# and other OO languages and I am new to Go... :) How should I name the interface and the struct so I can differentiate them?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1509543945, "post_id": 47055584, "comment_id": 81059682, "body": "It&#39;s not just naming... read up on proper use of interfaces in Go. You shouldn&#39;t create them at all unless you actually need them (which it doesn&#39;t appear you do, especially since these are unexported); they should be named based on their behavior, not just &quot;IClassName&quot; after the class that implements it; and they should be defined where they&#39;re consumed, not where they&#39;re implemented."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1509544060, "post_id": 47055584, "comment_id": 81059766, "body": "You also don&#39;t need the empty <code>default:</code> case in your <code>select</code>, it actually turns it into a tight loop and causes unnecessary CPU load. If you leave it with just the two &quot;real&quot; cases, it will wait (efficiently) until one of the channels receives a message."}, {"owner": {"reputation": 3782, "user_id": 839211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/THWvr.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/839211/felipe"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509544233, "post_id": 47055584, "comment_id": 81059895, "body": "Ok, I will change those things. I created the interface on the first place to that I could mock my struct when I write some unit tests. I just haven&#39;t had the time to create them yet. Thanks for the tips!"}, {"owner": {"reputation": 3782, "user_id": 839211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/THWvr.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/839211/felipe"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509544303, "post_id": 47055584, "comment_id": 81059937, "body": "Note: I also tried to run my code with the Firefox portable browser and the result was the same. I could not close it with <code>Kill</code> or <code>Release</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1509545309, "post_id": 47055584, "comment_id": 81060562, "body": "@Felipe: it will break your monitoring logic, but see if if <code>Kill()</code> works if you start the process with <code>Start()</code> rather than <code>Run()</code> to see if the implicit <code>Wait</code> call is blocking something. (<code>Release()</code> is not what you want to use)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1509545410, "post_id": 47055584, "comment_id": 81060660, "body": "Also, these browsers are probably starting multiple subprocesses, maybe killing the parent doesn&#39;t terminate the children. Have you looked at the running processes before and after? Have you tried sending a signal other than Kill which probably prevents any cleanup?"}], "answers": [{"comments": [{"owner": {"reputation": 3782, "user_id": 839211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/THWvr.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/839211/felipe"}, "edited": false, "score": 0, "creation_date": 1509548496, "post_id": 47057128, "comment_id": 81062774, "body": "Hi, I changed my code to run <code>Start()</code> instead of <code>Run()</code>, but it is still not working... The <code>Release</code> method doesn&#39;t do anything and the <code>Kill</code> method only stops the main process."}, {"owner": {"reputation": 3782, "user_id": 839211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/THWvr.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/839211/felipe"}, "edited": false, "score": 0, "creation_date": 1509548651, "post_id": 47057128, "comment_id": 81062871, "body": "I&#39;ve been looking at the task manager and @JimB is right, Chrome and Firefox spawn other processes that aren&#39;t killed when I execute the <code>Kill</code> and <code>Release</code> methods. Maybe there is a way to kill the process tree (to kill child and parent processes), but I haven&#39;t found it yet."}], "tags": [], "owner": {"reputation": 389, "user_id": 3385070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pU0nE.jpg?s=128&g=1", "display_name": "tez", "link": "https://stackoverflow.com/users/3385070/tez"}, "is_accepted": false, "score": 2, "last_activity_date": 1509546290, "creation_date": 1509546290, "answer_id": 47057128, "question_id": 47055584, "link": "https://stackoverflow.com/questions/47055584/how-to-start-and-monitor-and-kill-process-with-go/47057128#47057128", "title": "How to start and monitor and kill process with Go", "body": "<p>Instead of <code>cmd.Run()</code> use <code>cmd.Start()</code> <a href=\"https://golang.org/pkg/os/exec/#Cmd.Start\" rel=\"nofollow noreferrer\">see this </a> </p>\n"}, {"tags": [], "owner": {"reputation": 3782, "user_id": 839211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/THWvr.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/839211/felipe"}, "is_accepted": true, "score": 6, "last_activity_date": 1509552496, "creation_date": 1509552496, "answer_id": 47059064, "question_id": 47055584, "link": "https://stackoverflow.com/questions/47055584/how-to-start-and-monitor-and-kill-process-with-go/47059064#47059064", "title": "How to start and monitor and kill process with Go", "body": "<p>I found an answer! The problem is that the Go <code>cmd.Process.Kill()</code> command only stops the parent process, but not the child processes, so I had to kill these processes manually through the OS.</p>\n\n<p>Since I am on Windows my <code>KillProcess()</code> method now looks like this:</p>\n\n<pre><code>func (b *browserHandler) KillProcess() error {\n    log.Info(\"Killing browser process\")\n    kill := exec.Command(\"taskkill\", \"/T\", \"/F\", \"/PID\", strconv.Itoa(b.cmd.Process.Pid))\n    err := kill.Run()\n    if err != nil {\n        log.WithError(err).Error(\"Error killing chromium process\")\n    }\n    log.Info(\"Browser process was killed\")\n\n    return err\n}\n</code></pre>\n\n<p><strong>Credits:</strong> this <a href=\"https://stackoverflow.com/questions/22470193/why-wont-go-kill-a-child-process-correctly\">thread</a> has an answer for both <a href=\"https://stackoverflow.com/a/44551450/839211\">Windows</a> and <a href=\"https://stackoverflow.com/a/29552044/839211\">Unix</a> systems.</p>\n"}], "owner": {"reputation": 3782, "user_id": 839211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/THWvr.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/839211/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6890, "favorite_count": 3, "accepted_answer_id": 47059064, "answer_count": 2, "score": 8, "last_activity_date": 1509552496, "creation_date": 1509541586, "question_id": 47055584, "link": "https://stackoverflow.com/questions/47055584/how-to-start-and-monitor-and-kill-process-with-go", "title": "How to start and monitor and kill process with Go", "body": "<p>I am writing a program in Go that should open a portable browser to a given page and monitor it, so that if the browser is closed, it should be automatically reopened. Also the browser should be closed when the program exits.</p>\n\n<p>So far I have managed to reopen the browser when the user closes it, however I am not being able to close it.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>package browser\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n\n    log \"github.com/sirupsen/logrus\"\n)\n\ntype iBrowserHandler interface {\n    Start(processListener chan bool) error\n    Stop() error\n    KillProcess() error\n}\n\ntype browserHandler struct {\n    cmd            *exec.Cmd\n    pathToChromium string\n    pdvEndpoint    string\n}\n\nfunc newBrowserHandler(pathToChromium string, pdvEndpoint string) iBrowserHandler {\n    b := &amp;browserHandler{}\n    b.pathToChromium = pathToChromium\n    b.pdvEndpoint = pdvEndpoint\n\n    return b\n}\n\nfunc (b *browserHandler) Start(processListener chan bool) error {\n    endpoint := fmt.Sprintf(\"--app=%s\", b.pdvEndpoint)\n\n    b.cmd = exec.Command(b.pathToChromium, endpoint, \"--kiosk\")\n    err := b.cmd.Run()\n    if err != nil {\n        log.WithError(err).Error(\"Error with the browser process\")\n        processListener &lt;- false\n    } else {\n        processListener &lt;- true\n    }\n\n    return err\n}\n\nfunc (b *browserHandler) Stop() error {\n    err := b.cmd.Process.Release()\n    if err != nil {\n        log.WithError(err).Fatal(\"Error shutting down chromium\")\n    }\n\n    return err\n}\n\nfunc (b *browserHandler) KillProcess() error {\n    err := b.cmd.Process.Kill()\n    if err != nil {\n        log.WithError(err).Fatal(\"Error killing chromium process\")\n    }\n\n    return err\n}\n</code></pre>\n\n<p>And this is the function that I am using to start the browser:</p>\n\n<p>var handler iBrowserHandler</p>\n\n<pre><code>func init() {\n    var pathToChromium string\n    var c = config.GetInstance()\n    var os = runtime.GOOS\n\n    if os == \"windows\" {\n        pathToChromium = \"chromium-browser\\\\ChromiumPortable.exe\"\n    } else {\n        pathToChromium = \"chrome\"\n    }\n\n    handler = newBrowserHandler(pathToChromium, c.GetConfig().PDVUrl)\n}\n\nfunc StartBrowser(done chan bool) {\n    browserProcessListener := make(chan bool)\n    defer close(browserProcessListener)\n    go handler.Start(browserProcessListener)\n\n    var tryReopenBrowser = true\n    for {\n        select {\n        case &lt;-browserProcessListener:\n            if tryReopenBrowser {\n                log.Warn(\"Browser process is stopped. Attempting to restart\")\n                go handler.Start(browserProcessListener)\n            } else {\n                log.Warn(\"Browser process is stopped. Will not attempt to restart\")\n            }\n\n        case &lt;-done:\n            log.Info(\"Shutting down browser\")\n            tryReopenBrowser = false\n            handler.KillProcess()\n            return\n\n        default:\n        }\n    }\n}\n</code></pre>\n\n<p>When the program starts I call the StartBrowser() function. Once the browser is started, it keeps listening to see if it was closed (the <code>cmd.Run()</code> function blocks the execution of the thread until the process finishes).</p>\n\n<p>If the browser was closed, then my program attempts to reopen it.</p>\n\n<p>If the program receives a stop signal, it tries to close the browser. I tried to use both the <code>cmd.Process.Release()</code> and the <code>cmd.Process.Kill()</code> commands, but both do not close the browser. Is there any other way to do this?</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1509538060, "post_id": 47054399, "comment_id": 81055762, "body": "Show a more complete example. What you pasted so far looks good."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1509543556, "post_id": 47054399, "comment_id": 81059375, "body": "Please see <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "owner": {"reputation": 1, "user_id": 8539314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a92fe7c8316da73035e06dee671f5f?s=128&d=identicon&r=PG&f=1", "display_name": "HappyLearner", "link": "https://stackoverflow.com/users/8539314/happylearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509544514, "creation_date": 1509537882, "last_edit_date": 1509544514, "question_id": 47054399, "link": "https://stackoverflow.com/questions/47054399/lastmodified-header-doesnt-appear", "title": "LastModified header doesn&#39;t appear", "body": "<pre><code>ctx.Response.Header.SetLastModified(changed)\nif ctx.IfModifiedSince(changed) {\n    buf = data\n} else {\n    ctx.SetStatusCode(fasthttp.StatusNotModified)\n}\n</code></pre>\n\n<p><code>ctx</code> is <code>*fasthttp.RequestCtx</code>. </p>\n\n<p>I need a <code>Last-Modified</code> header in my response but I have only:</p>\n\n<pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n</code></pre>\n\n<p><strong><em>What am i doing wrong?</em></strong></p>\n"}, {"tags": ["google-chrome", "go", "network-programming", "google-chrome-devtools"], "comments": [{"owner": {"reputation": 1613, "user_id": 376365, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a0a3c5e2b4e3e162a5aa1ccd27ba3b08?s=128&d=identicon&r=PG", "display_name": "CMerrill", "link": "https://stackoverflow.com/users/376365/cmerrill"}, "edited": false, "score": 0, "creation_date": 1509744821, "post_id": 47052718, "comment_id": 81159935, "body": "Why did you tag this with webdriver? AFAICT, it has nothing to do with webdriver."}, {"owner": {"reputation": 869, "user_id": 5752875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e07eba630b8aa0601d30171f57a667c?s=128&d=identicon&r=PG&f=1", "display_name": "carusyte", "link": "https://stackoverflow.com/users/5752875/carusyte"}, "reply_to_user": {"reputation": 1613, "user_id": 376365, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a0a3c5e2b4e3e162a5aa1ccd27ba3b08?s=128&d=identicon&r=PG", "display_name": "CMerrill", "link": "https://stackoverflow.com/users/376365/cmerrill"}, "edited": false, "score": 0, "creation_date": 1509805300, "post_id": 47052718, "comment_id": 81173297, "body": "@CMerrill sorry about that, web driver is a broader topic, indeed. I&#39;m gonna remove that tag if it brings any inconvenience."}], "answers": [{"tags": [], "owner": {"reputation": 869, "user_id": 5752875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e07eba630b8aa0601d30171f57a667c?s=128&d=identicon&r=PG&f=1", "display_name": "carusyte", "link": "https://stackoverflow.com/users/5752875/carusyte"}, "is_accepted": false, "score": 1, "last_activity_date": 1509862670, "creation_date": 1509862670, "answer_id": 47118771, "question_id": 47052718, "link": "https://stackoverflow.com/questions/47052718/how-to-intercept-network-traffic-and-get-the-response-using-chromedp-or-alterna/47118771#47118771", "title": "How to intercept network traffic and get the response using chromedp (or alternatives)?", "body": "<p>It appears that the chromedp lib wasn't complete at the time. I've implemented the event listening mechanism and submitted a <a href=\"https://github.com/knq/chromedp/pull/132\" rel=\"nofollow noreferrer\">pull request</a>. For those in need, the specific server resources can be acquired by listening to network events and get the RequestID and response body respectively:</p>\n\n<pre><code>cdp.Tasks{\n    cdp.ActionFunc(func(ctxt context.Context, h cdptypes.Handler) error {\n        go func() {\n            echan := h.Listen(cdptypes.EventNetworkRequestWillBeSent, cdptypes.EventNetworkLoadingFinished)\n            for d := range echan {\n                switch d.(type) {\n                case *network.EventRequestWillBeSent:\n                    req := d.(*network.EventRequestWillBeSent)\n                    if strings.HasSuffix(req.Request.URL, \"/data_I_want.js\") {\n                        reqId1 = req.RequestID\n                    } else if strings.HasSuffix(req.Request.URL, \"/another_one.js\") {\n                        reqId2 = req.RequestID\n                    }\n                case *network.EventLoadingFinished:\n                    res := d.(*network.EventLoadingFinished)\n                    var data []byte\n                    var e error\n                    if reqId1 == res.RequestID {\n                        data, e = network.GetResponseBody(reqId1).Do(ctxt, h)\n                    } else if reqId2 == res.RequestID {\n                        data, e = network.GetResponseBody(reqId2).Do(ctxt, h)\n                    }\n                    if e != nil {\n                        panic(e)\n                    }\n                    if len(data) &gt; 0 {\n                        fmt.Printf(\"=========data: %+v\\n\", string(data))\n                    }\n                }\n            }\n        }()\n        return nil\n    }),\n    cdp.Navigate(url),\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 869, "user_id": 5752875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e07eba630b8aa0601d30171f57a667c?s=128&d=identicon&r=PG&f=1", "display_name": "carusyte", "link": "https://stackoverflow.com/users/5752875/carusyte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1853, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509862670, "creation_date": 1509531987, "last_edit_date": 1509805338, "question_id": 47052718, "link": "https://stackoverflow.com/questions/47052718/how-to-intercept-network-traffic-and-get-the-response-using-chromedp-or-alterna", "title": "How to intercept network traffic and get the response using chromedp (or alternatives)?", "body": "<p>I'm aiming to get a specific response from the target server which cannot be retrieve directly, but via techniques such as using web driver to fire the request initiated by inherent javascript code in the web page once loaded. The request contains some code for server-side verification which for now I'm unable to decode the generating algorithm.</p>\n\n<p>The \"Developer Tools\" in Chrome provides a convenient way to inspect the request and response, and I need to automate the process by using powerful libs such as <a href=\"https://github.com/knq/chromedp\" rel=\"nofollow noreferrer\">chromedp</a>.</p>\n\n<p>AFAIK the <code>network</code> package provides a <code>GetResponseBody</code> function, but requires a <code>requestID</code> parameter. How can I acquire the specific request id?</p>\n\n<pre><code>cdp.ActionFunc(func(ctxt context.Context, h cdptypes.Handler) error {\n        rptn := &amp;network.RequestPattern{\n            ResourceType: page.ResourceTypeScript,\n        }\n        network.SetRequestInterception([]*network.RequestPattern{rptn}).Do(ctxt, h)\n\n        //begin interception\n        network.ContinueInterceptedRequest(\"AlphaInterceptor\").Do(ctxt, h)\n\n        //How to identify the requestID?\n        network.GetResponseBody(\"???\")\n\n        ...\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509543629, "post_id": 47051764, "comment_id": 81059433, "body": "Per the question, they don&#39;t know what type to use for Content until after/during unmarshalling."}, {"owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509695714, "post_id": 47051764, "comment_id": 81130895, "body": "In question they don&#39;t mention that just ask how to unmarshal this type with this two struct and in this case they even could check from many parameters data path or query param or some thing you just think complicate"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509709390, "post_id": 47051764, "comment_id": 81139207, "body": "The question says in the very first sentence &quot;the struct type is given in the JSON string&quot;."}], "tags": [], "owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "is_accepted": false, "score": -1, "last_activity_date": 1509528537, "creation_date": 1509528537, "answer_id": 47051764, "question_id": 47051538, "link": "https://stackoverflow.com/questions/47051538/unmarshal-json-to-struct/47051764#47051764", "title": "Unmarshal JSON to struct", "body": "<p>when you create instance from ServiceResult you could init Content with person too then unmarshal it:</p>\n\n<pre><code>service := ServiceResult{Content: Person{}}\njson.Unmarshal(data, &amp;service)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 3, "last_activity_date": 1509528546, "creation_date": 1509528546, "answer_id": 47051768, "question_id": 47051538, "link": "https://stackoverflow.com/questions/47051538/unmarshal-json-to-struct/47051768#47051768", "title": "Unmarshal JSON to struct", "body": "<p>First, for your type</p>\n\n<pre><code>type ServiceResult struct {\n    Type    string      `json:\"type\"`\n    Content interface{} `json:\"content\"`\n}\n</code></pre>\n\n<p>you'd need to implement \"custom JSON unmarshaler\" by defining\na method:</p>\n\n<pre><code>func (sr *ServiceResult) UnmarshalJSON(b []byte) error\n</code></pre>\n\n<p>to make your type satisfy the <code>encoding/json.Unmarshaler</code> interface \u2014\nthis will make the JSON decoder call that method when unmarshaling to\nthe value of that type.</p>\n\n<p>In that method, you can use a helper type</p>\n\n<pre><code>type typedObject struct {\n    Type    string          `json:\"type\"`\n    Content json.RawMessage `json:\"content\"`\n}\n</code></pre>\n\n<p>to first unmarshal that <code>b</code> slice into it.</p>\n\n<p>If unmarshaling completed w/o generating an error, your value\nof type <code>typedObject</code> would have the string describing the type\nin its <code>Type</code> string and the raw (unparsed) JSON string contained\nin the \"content\" field in its <code>Content</code> field.</p>\n\n<p>You then do a <code>switch</code> (or a map lookup or whatever) to perform\npick the actual Go type to unmarshal whatever data is in the <code>Content</code>\nfield into it, like in:</p>\n\n<pre><code>var value interface{}\nswitch sr.Type {\ncase \"person\":\n    value = new(Person)\ncase \"car\":\n    value = new(Car)\n}\nerr = json.Unmarshal(sr.Content, value)\n</code></pre>\n\n<p>\u2026where those <code>Person</code> and <code>Car</code> are concrete struct types\nsuitably armed for consumption by <code>encoding/json</code>.</p>\n\n<p>Please read <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">this</a>\nand <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\">this</a>\nto gain full understanding of these concepts.</p>\n"}], "owner": {"reputation": 457, "user_id": 6171578, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/9e035177e9539ce163b0197a777b34f7?s=128&d=identicon&r=PG&f=1", "display_name": "botscripter", "link": "https://stackoverflow.com/users/6171578/botscripter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2465, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1509528546, "creation_date": 1509527689, "last_edit_date": 1509527918, "question_id": 47051538, "link": "https://stackoverflow.com/questions/47051538/unmarshal-json-to-struct", "title": "Unmarshal JSON to struct", "body": "<p>How can I unmarshal a JSON string into a struct, when the struct type is given in the JSON string. This is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype ServiceResult struct {\n    Type    string      `json:\"type\"`\n    Content interface{} `json:\"content\"`\n}\n\ntype Person struct {\n    Name string `json:\"name\"`\n}\n\nfunc main() {\n\n    nikola := ServiceResult{}\n    nikola.Type = \"Person\"\n    nikola.Content = Person{\"Nikola\"}\n\n    js, _ := json.Marshal(nikola)\n    fmt.Println(\"Marshalled object: \" + string(js))\n}\n</code></pre>\n\n<blockquote>\n  <p>And now I want to create from this JSON string a new person but the\n  type has to be read out of the JSON string.</p>\n</blockquote>\n\n<pre><code>{\"type\":\"Person\",\"content\":{\"name\":\"Nikola\"}}\n</code></pre>\n"}, {"tags": ["json", "go", "httpresponse"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 7, "creation_date": 1509509849, "post_id": 47048073, "comment_id": 81043410, "body": "Export the field names. See possible duplicate <a href=\"https://stackoverflow.com/questions/26327391/go-json-marshalstruct-returns\" title=\"go json marshalstruct returns\">stackoverflow.com/questions/26327391/&hellip;</a>."}, {"owner": {"reputation": 7705, "user_id": 1076743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luioK.png?s=128&g=1", "display_name": "Sir", "link": "https://stackoverflow.com/users/1076743/sir"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1509512439, "post_id": 47048073, "comment_id": 81044019, "body": "Ill try it out see if it works."}, {"owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "edited": false, "score": 3, "creation_date": 1509527430, "post_id": 47048073, "comment_id": 81049744, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26327391/go-json-marshalstruct-returns\">Go json.Marshal(struct) returns &quot;{}&quot;</a>"}, {"owner": {"reputation": 7705, "user_id": 1076743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luioK.png?s=128&g=1", "display_name": "Sir", "link": "https://stackoverflow.com/users/1076743/sir"}, "reply_to_user": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "edited": false, "score": 0, "creation_date": 1509578979, "post_id": 47048073, "comment_id": 81078682, "body": "@tgogos that wasn&#39;t the solution in this case. See the answer below, it was a mistake in my syntax."}], "answers": [{"comments": [{"owner": {"reputation": 7705, "user_id": 1076743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luioK.png?s=128&g=1", "display_name": "Sir", "link": "https://stackoverflow.com/users/1076743/sir"}, "edited": false, "score": 0, "creation_date": 1509512714, "post_id": 47048515, "comment_id": 81044092, "body": "Ah such a simple solution! Capital letter solved it :) Thank you"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "reply_to_user": {"reputation": 7705, "user_id": 1076743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luioK.png?s=128&g=1", "display_name": "Sir", "link": "https://stackoverflow.com/users/1076743/sir"}, "edited": false, "score": 0, "creation_date": 1509512747, "post_id": 47048515, "comment_id": 81044100, "body": "you&#39;re welcome."}, {"owner": {"reputation": 80, "user_id": 10041322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/142ca92202b30aae6a6338cd55f4cd07?s=128&d=identicon&r=PG&f=1", "display_name": "idirall22", "link": "https://stackoverflow.com/users/10041322/idirall22"}, "edited": false, "score": 1, "creation_date": 1553711975, "post_id": 47048515, "comment_id": 97490644, "body": "Thank you you helped me."}], "tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": true, "score": 8, "last_activity_date": 1509512435, "creation_date": 1509512435, "answer_id": 47048515, "question_id": 47048073, "link": "https://stackoverflow.com/questions/47048073/json-encode-returning-blank-golang/47048515#47048515", "title": "JSON encode returning blank Golang", "body": "<p>Export the field name by making <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"noreferrer\">the first character of the identifier's name a Unicode upper case letter (Unicode class \"Lu\")</a>.</p>\n\n<p>Try this:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\ntype User struct {\n    Uuid string\n}\n\nfunc handler(responseWriter http.ResponseWriter, r *http.Request) {\n    user := User{Uuid: \"id1234657...\"} // Set uuid as string to user struct\n    fmt.Println(user)                 // check it has the uuid\n    responseWriter.Header().Set(\"Content-Type\", \"application/json\")\n    responseWriter.WriteHeader(http.StatusCreated)\n    json.NewEncoder(responseWriter).Encode(user)\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)            // set router\n    err := http.ListenAndServe(\":9090\", nil) // set listen port\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n\n<p>output(<a href=\"http://localhost:9090/\" rel=\"noreferrer\">http://localhost:9090/</a>):</p>\n\n<pre><code>{\"Uuid\":\"id1234657...\"}\n</code></pre>\n"}], "owner": {"reputation": 7705, "user_id": 1076743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luioK.png?s=128&g=1", "display_name": "Sir", "link": "https://stackoverflow.com/users/1076743/sir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1378, "favorite_count": 1, "closed_date": 1509539134, "accepted_answer_id": 47048515, "answer_count": 1, "score": 3, "last_activity_date": 1509512435, "creation_date": 1509509317, "question_id": 47048073, "link": "https://stackoverflow.com/questions/47048073/json-encode-returning-blank-golang", "closed_reason": "Not suitable for this site", "title": "JSON encode returning blank Golang", "body": "<p>I have a very simple http resonse in my server where i json encode a struct. But its sending a blank of just <code>{}</code></p>\n\n<p>I don't know if i am doing it wrong but i get no errors. This is my json encode:</p>\n\n<pre><code>    // Set uuid as string to user struct\n    user := User{uuid: uuid.String()}\n    fmt.Println(user) // check it has the uuid\n\n    responseWriter.Header().Set(\"Content-Type\", \"application/json\")\n    responseWriter.WriteHeader(http.StatusCreated)\n\n    json.NewEncoder(responseWriter).Encode(user)\n</code></pre>\n\n<p>On the recieving end the data has:</p>\n\n<pre><code>Content-Type application/json\nContent-Length 3\nSTATUS HTTP/1.1 201 Created\n{}\n</code></pre>\n\n<p>Why does it not give me the uuid data? Am i doing something wrong with my encoding?</p>\n"}, {"tags": ["java", "rest", "http", "go", "httpclient"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 8822022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rCLq9dJbib0/AAAAAAAAAAI/AAAAAAAAAPk/2WAw5J5v0lM/photo.jpg?sz=128", "display_name": "Daniel Yanagita", "link": "https://stackoverflow.com/users/8822022/daniel-yanagita"}, "edited": false, "score": 0, "creation_date": 1509532343, "post_id": 47050666, "comment_id": 81052485, "body": "Hi @fhe, first of all thank you for spending some time to help me! In fact, I&#39;ve already tried to apply your suggest before creating this post. But, when I did it, I was getting params from mux.Vars(httpRequest) and It wasn&#39;t getting parameters too. The interesting thing is that when I make this requestion from postman app, Go Server is able to get parameters on both way. That&#39;s made me thought I&#39;ve got a JAVA request problem..."}, {"owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "reply_to_user": {"reputation": 55, "user_id": 8822022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rCLq9dJbib0/AAAAAAAAAAI/AAAAAAAAAPk/2WAw5J5v0lM/photo.jpg?sz=128", "display_name": "Daniel Yanagita", "link": "https://stackoverflow.com/users/8822022/daniel-yanagita"}, "edited": false, "score": 0, "creation_date": 1509618804, "post_id": 47050666, "comment_id": 81094230, "body": "Are you sure you&#39;re getting the different results between Postman and your Java client? I&#39;ve checked this again using your code (with Postman and Java) and there is no form value returned from <code>FormValue()</code> in case of a DELETE request. I&#39;ve added a code snippet to inspect the actual request vs. the form value to my answer above."}, {"owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "reply_to_user": {"reputation": 55, "user_id": 8822022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rCLq9dJbib0/AAAAAAAAAAI/AAAAAAAAAPk/2WAw5J5v0lM/photo.jpg?sz=128", "display_name": "Daniel Yanagita", "link": "https://stackoverflow.com/users/8822022/daniel-yanagita"}, "edited": false, "score": 0, "creation_date": 1509618873, "post_id": 47050666, "comment_id": 81094275, "body": "Just as a side note, you&#39;re setting the <code>Accept</code>request property twice in your Java client code :)"}, {"owner": {"reputation": 55, "user_id": 8822022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rCLq9dJbib0/AAAAAAAAAAI/AAAAAAAAAPk/2WAw5J5v0lM/photo.jpg?sz=128", "display_name": "Daniel Yanagita", "link": "https://stackoverflow.com/users/8822022/daniel-yanagita"}, "edited": false, "score": 0, "creation_date": 1509622356, "post_id": 47050666, "comment_id": 81096538, "body": "Thanks, i didn&#39;t pay attention for accept into If... I&#39;ll take It out... I&#39;ll try use par&#226;metro on URL once and tell you result. Thanks for all man..."}], "tags": [], "owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "is_accepted": true, "score": 1, "last_activity_date": 1509618660, "last_edit_date": 1509618660, "creation_date": 1509523959, "answer_id": 47050666, "question_id": 47047963, "link": "https://stackoverflow.com/questions/47047963/java-client-go-http-mux-server-parameter-empty-on-go-method/47050666#47050666", "title": "Java Client - Go Http Mux Server - Parameter empty on go method", "body": "<p>Looking at the <a href=\"https://golang.org/src/net/http/request.go?s=38476:38522#L1154\" rel=\"nofollow noreferrer\">implementation</a> of golang's <code>http.Request.ParseForm()</code>, it seems that the form data is not parsed for <code>DELETE</code> requests.</p>\n\n<p>I'd suggest using the identifier of the city to be deleted as request parameter in the URL:</p>\n\n<pre><code>r.HandleFunc(\"/Rest/deleteCity/{city}\", deleteCity).Methods(\"DELETE\")\n</code></pre>\n\n<p>While you're at it, you could also refactor the whole definition of the routes to be more consistent with standard REST API design patterns, e.g.,</p>\n\n<pre><code>r.HandleFunc(\"/Rest/cities/\", getCities).Methods(\"GET\")\nr.HandleFunc(\"/Rest/cities/{city}\", getCity).Methods(\"GET\")\nr.HandleFunc(\"/Rest/cities/{city}\", createCity).Methods(\"POST\") // with body\nr.HandleFunc(\"/Rest/cities/{city}\", updateCity).Methods(\"PUT\") // with body\nr.HandleFunc(\"/Rest/cities/{city}\", deleteCity).Methods(\"DELETE\")\n</code></pre>\n\n<p>You can use the following snippet to inspect the request. Please note that this should only used for testing purposes and not in a production environment:</p>\n\n<pre><code>func deleteCity(w http.ResponseWriter, r *http.Request) {\n    log.Println(\"deleteCity handler called\")\n    dump, err := httputil.DumpRequest(r, true)\n    if err != nil {\n        http.Error(w, fmt.Sprint(err), http.StatusInternalServerError)\n        return\n    }\n    log.Printf(\"%q\\n\", dump)\n    var city string = r.FormValue(\"city\")\n    log.Printf(\"city: %q\\n\", city)\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8822022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rCLq9dJbib0/AAAAAAAAAAI/AAAAAAAAAPk/2WAw5J5v0lM/photo.jpg?sz=128", "display_name": "Daniel Yanagita", "link": "https://stackoverflow.com/users/8822022/daniel-yanagita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 47050666, "answer_count": 1, "score": 2, "last_activity_date": 1509618660, "creation_date": 1509508381, "last_edit_date": 1509517584, "question_id": 47047963, "link": "https://stackoverflow.com/questions/47047963/java-client-go-http-mux-server-parameter-empty-on-go-method", "title": "Java Client - Go Http Mux Server - Parameter empty on go method", "body": "<p>I'v got a GO Lang REST API that works normally when I call it from Postman. But, when I try to call a <code>DELETE</code> method with <code>HttpURLConnection</code> parameters are not received by my method.</p>\n\n<p>Request:</p>\n\n<pre><code>_url = new URL(_urlBase+method);\n_http = (HttpURLConnection) _url.openConnection();\n_http.setRequestMethod(requestType);\n_http.setRequestProperty(\"Accept\", \"application/json\");    \nif ((requestType.toUpperCase().equals(\"POST\")) || (requestType.toUpperCase().equals(\"DELETE\"))) \n{\n    _http.setRequestProperty(\"Accept\", \"application/json\"); \n\n    byte[] postData = params.getBytes( StandardCharsets.UTF_8 );\n    int    postDataLength = postData.length;\n\n    _http.setDoOutput( true );\n    _http.setInstanceFollowRedirects( false );\n    _http.setRequestProperty( \"Content-Type\", \"application/x-www-form-urlencoded\"); \n    _http.setRequestProperty( \"charset\", \"utf-8\");\n    _http.setRequestProperty( \"Content-Length\", Integer.toString( postDataLength ));\n    _http.setUseCaches( false );\n\n    try( DataOutputStream wr = new DataOutputStream( _http.getOutputStream())) {\n        wr.write( postData );\n    }\n}\n\nif (_http.getResponseCode() != 200) {\n     throw new RuntimeException(\"Failed : HTTP error code : \" + _http.getResponseCode());\n}\n</code></pre>\n\n<p>PS: I've got a three REST APIs in test at this moment. This method just don't pass parameters for GO Lang, using <code>MUX</code>. On Scala and Rails is working fine.</p>\n\n<p>PS: On Go I'm getting parameter from <code>http.Request.FormValue(field)</code>.</p>\n\n<p>Go Routes:</p>\n\n<pre><code>r := mux.NewRouter()\nr.HandleFunc(\"/Rest/get\", get).Methods(\"GET\")\nr.HandleFunc(\"/Rest/putCity/{city}\", putCity).Methods(\"PUT\")\nr.HandleFunc(\"/Rest/updateCity\", updateCity).Methods(\"POST\")\nr.HandleFunc(\"/Rest/deleteCity\", deleteCity).Methods(\"DELETE\")\nhttp.ListenAndServe(\":12345\", r)\n</code></pre>\n\n<p>Method getting parameter:</p>\n\n<pre><code>func deleteCity(w http.ResponseWriter, r *http.Request) {   \n    var city string = r.FormValue(\"city\")\n}\n</code></pre>\n\n<p>Thanks for trying to help guys! Regards.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1509505942, "post_id": 47047490, "comment_id": 81042550, "body": "The first line of <code>mapSetter</code> clobbers the previous map."}], "answers": [{"tags": [], "owner": {"reputation": 27119, "user_id": 8753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLxHO.jpg?s=128&g=1", "display_name": "laz", "link": "https://stackoverflow.com/users/8753/laz"}, "is_accepted": true, "score": 1, "last_activity_date": 1509505930, "creation_date": 1509505930, "answer_id": 47047662, "question_id": 47047490, "link": "https://stackoverflow.com/questions/47047490/struct-map-not-saving-keys-values/47047662#47047662", "title": "Struct map not saving keys/values", "body": "<p>The reason is that in <code>mapSetter</code> you are overwriting <code>s.X</code> every time with a new instance by calling <code>make(map[string]string)</code>. Remove that line from there and either initialize <code>v.X</code> in <code>main</code>:</p>\n\n<pre><code>v.X = make(map[string]string)\n</code></pre>\n\n<p>Or create a function to both create the new <code>someMap</code> instance and initialize its <code>X</code>:</p>\n\n<pre><code>func New() *someMap {\n    s := new(someMap)\n    s.X = make(map[string]string)\n    return s\n}\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/43JPhfv-mA\" rel=\"nofollow noreferrer\" title=\"Go Playground Sample\">here</a></p>\n"}], "owner": {"reputation": 611, "user_id": 4574049, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b73ddf536276d10f5c73adb3f192a535?s=128&d=identicon&r=PG&f=1", "display_name": "Mo Ali", "link": "https://stackoverflow.com/users/4574049/mo-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 47047662, "answer_count": 1, "score": -1, "last_activity_date": 1509505930, "creation_date": 1509504553, "question_id": 47047490, "link": "https://stackoverflow.com/questions/47047490/struct-map-not-saving-keys-values", "title": "Struct map not saving keys/values", "body": "<pre><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\ntype someMap struct {\n    X map[string]string\n}\n\nfunc (s *someMap) mapSetter(someKey string, someValue string) {\n    s.X = make(map[string]string)\n    s.X[someKey] = someValue\n}\n\nfunc (s someMap) mapGetter() map[string]string {\n    return s.X\n}\n\nfunc (s someMap) mapKeys() []reflect.Value {\n    return reflect.ValueOf(s.X).MapKeys()\n}\n\nfunc retrievedList(x map[string]string) {\n    fmt.Println(\"I got %v\", x)\n}\n\nfunc main() {\n    v := new(someMap)\n    v.mapSetter(\"item1\", \"value1\")\n    v.mapSetter(\"item2\", \"value2\")\n    returnedMap := v.mapGetter()\n    fmt.Println(returnedMap)\n    fmt.Println(reflect.TypeOf(returnedMap))\n    retrievedList(returnedMap)\n    fmt.Println(v.mapKeys())\n    keys := v.mapKeys()\n    fmt.Println(keys[0])\n}\n</code></pre>\n\n<p>As you can see, I'm setting two keys/values to my struct \"someMap\", however when it looks like the key is overwritten rather than saved, why is this?</p>\n\n<pre><code>map[item2:value2]\nmap[string]string\nI got %v map[item2:value2]\n[item2]\nitem2\n</code></pre>\n\n<p>I've been following the map examples here <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-maps-in-action</a></p>\n\n<p>As far I know, which isn't a lot, I'm new to golang, this should work somewhat similar to python.</p>\n"}, {"tags": ["json", "go", "struct"], "comments": [{"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1509686087, "post_id": 47046475, "comment_id": 81127151, "body": "@kostix Thank you for editing."}], "answers": [{"comments": [{"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "edited": false, "score": 0, "creation_date": 1509499030, "post_id": 47046798, "comment_id": 81040860, "body": "I appreciate your answer. It worked fine. I couldn&#39;t notice to use <code>struct</code>. I accepted your answer as the solution. Thank you."}, {"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "edited": false, "score": 0, "creation_date": 1509499496, "post_id": 47046798, "comment_id": 81040982, "body": "Yes. Thank you for adding more knowledge. I want to upvote more. But I had already upvoted. I&#39;m sorry."}, {"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "edited": false, "score": 0, "creation_date": 1509686008, "post_id": 47046798, "comment_id": 81127133, "body": "I am sorry. Can I ask you about problems of my question? I want to reflect them to my future questions. BTW, what I want to convert a string JSON to an object using golang is wrong?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1509499246, "last_edit_date": 1509499246, "creation_date": 1509498584, "answer_id": 47046798, "question_id": 47046475, "link": "https://stackoverflow.com/questions/47046475/parse-json-from-a-json-string-value/47046798#47046798", "title": "Parse JSON from a JSON string value", "body": "<p>There are two levels of JSON encoding. The first step is to decode the outer JSON value.  Decode to a struct matching the structure of the JSON.</p>\n\n<pre><code>var outer struct{ Key1 string }\nif err := json.Unmarshal([]byte(jsondata), &amp;outer); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>The next step is to decode the inner JSON value. Again, decode to a struct matching the structure of the JSON.</p>\n\n<pre><code>var inner struct{ Key3 struct{ Key4 string } }\nif err := json.Unmarshal([]byte(outer.Key1), &amp;inner); err != nil {\n    log.Fatal(err)\n}\n// The value is inner.Key3.Key4\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/idCSYmudR0\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>If the JSON is not double encoded, you can decode in one shot:</p>\n\n<pre><code>jsondata := `{\"key1\": { \"key2\": \"value2\",  \"key3\": { \"key4\": \"value4\"  }}}`\nvar v struct {\n    Key1 struct{ Key3 struct{ Key4 string } }\n}\nif err := json.Unmarshal([]byte(jsondata), &amp;v); err != nil {\n    log.Fatal(err)\n}\n// value is v.Key1.Key3.Key4\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/BAioriddLD\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 47046798, "answer_count": 1, "score": 0, "last_activity_date": 1509522334, "creation_date": 1509496005, "last_edit_date": 1509522334, "question_id": 47046475, "link": "https://stackoverflow.com/questions/47046475/parse-json-from-a-json-string-value", "title": "Parse JSON from a JSON string value", "body": "<p>I want to convert from string to object.</p>\n\n<p><strong>From</strong></p>\n\n<pre><code>{\"key1\": \"{\\n  \\\"key2\\\": \\\"value2\\\",\\n  \\\"key3\\\": {\\n    \\\"key4\\\": \\\"value4\\\"\\n  }\\n}\\n\"}\n</code></pre>\n\n<p><strong>To</strong></p>\n\n<pre><code>{\"key1\": {\"key2\": \"value2\", \"key3\": {\"key4\": \"value4\"}}}\n</code></pre>\n\n<p>Finally, I want to get <code>value4</code>.</p>\n\n<p>I can get the value of \"key1\" using below script.</p>\n\n<pre><code>jsondata := `{\"key1\": \"{\\n  \\\"key2\\\": \\\"value2\\\",\\n  \\\"key3\\\": {\\n    \\\"key4\\\": \\\"value4\\\"\\n  }\\n}\\n\"}`\nvar m map[string]interface{}\njson.Unmarshal([]byte(jsondata), &amp;m)\nvalue := m[\"key1\"]\nfmt.Println(value)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/4lwgQJfp5S\" rel=\"nofollow noreferrer\">https://play.golang.org/p/4lwgQJfp5S</a></p>\n\n<p>But I can't convert the value to an object. So I can't get \"value4\". Are there methods for this? I can get it by regex like <a href=\"https://play.golang.org/p/6TB-qNAdgQ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/6TB-qNAdgQ</a> But now this is not my solution.</p>\n\n<p>Thank you so much for your time and advices. And I'm sorry for my immature question.</p>\n"}, {"tags": ["go", "proxy", "ssl-certificate"], "comments": [{"owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509501388, "post_id": 47046432, "comment_id": 81041417, "body": "I&#39;ve updated to show Host is being set in two different ways, though I think I&#39;ve tried both separately and they each gave that error ultimately."}], "answers": [{"comments": [{"owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1509504862, "post_id": 47047187, "comment_id": 81042271, "body": "I&#39;ve tried to do as you show: <code>httpClient.Transport = &amp;http.Transport{ TLSClientConfig: &amp;tls.Config{ ServerName: &quot;maps.googleapis.com&quot;,},}</code> Is this the change you suggested? Now I get a 404. (If I change the authority in the url to be the non-proxy maps.googleapis.com, I get 200 with real results.) I think the reason I&#39;m getting a 404 is that it&#39;s resolving to googleapis.com instead of maps.googleapis.com"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 1, "creation_date": 1509506011, "post_id": 47047187, "comment_id": 81042570, "body": "Did you set the request Host field to \u201cmaps.googleapis.com\u201d too?"}, {"owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1509506057, "post_id": 47047187, "comment_id": 81042584, "body": "No. Was I supposed to set Host in addition to Tls server name?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1509506073, "post_id": 47047187, "comment_id": 81042590, "body": "Yes, you need both. Since you\u2019re adding a new Transport here, you should make sure to complete the rest of the recommended settings, but make sure you reuse the same transport and don\u2019t re-add it each time. See the DefaultTransport for example."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1509536767, "post_id": 47047187, "comment_id": 81054992, "body": "With TLS enabled, the HTTP header is encrypted. The server has to pick a certificate for decryption before it can inspect the Host header. That&#39;s what the ServerName field is for; it is sent as part of the TLS handshake (that is called <a href=\"https://en.wikipedia.org/wiki/Server_Name_Indication\" rel=\"nofollow noreferrer\">SNI</a>). After decrypting the HTTP header the server looks at the Host header to route the request to the correct virtual host. That&#39;s why you need to set both values."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1509539717, "post_id": 47047187, "comment_id": 81056778, "body": "@Peter: Yes exactly. I misremembered the Transport setting ServerName from the request. It&#39;s not hard to implement now, but it&#39;s a breaking change so I don&#39;t think it could be done with go1."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1509544565, "last_edit_date": 1509544565, "creation_date": 1509502264, "answer_id": 47047187, "question_id": 47046432, "link": "https://stackoverflow.com/questions/47046432/force-client-hostname-when-proxying-https/47047187#47047187", "title": "Force client hostname when proxying https", "body": "<p>You need to set the <code>http.Request.Host</code> field so that the http request has the correct header</p>\n\n<pre><code>req.Host = \"maps.googleapis.com\"\n</code></pre>\n\n<p>An you also need to set the hostname in the <code>tls.Config.ServerName</code> field for SNI and host name verification. </p>\n\n<p>If you've already configured a transport for your <code>httpClient</code>, you can set it like so:</p>\n\n<pre><code>httpClient.Transport.(*http.Transport).TLSClientConfig = &amp;tls.Config{\n    ServerName: \"maps.googleapis.com\",\n}\n</code></pre>\n\n<p>Or for small programs you can override the default:</p>\n\n<pre><code>http.DefaultTransport.(*http.Transport).TLSClientConfig = &amp;tls.Config{\n    ServerName: \"maps.googleapis.com\",\n}\n</code></pre>\n\n<p>Or create a custom transport for your program</p>\n\n<pre><code>var httpTransport = &amp;http.Transport{\n    Proxy: http.ProxyFromEnvironment,\n    DialContext: (&amp;net.Dialer{\n        Timeout:   30 * time.Second,\n        KeepAlive: 30 * time.Second,\n        DualStack: true,\n    }).DialContext,\n    MaxIdleConns:          100,\n    IdleConnTimeout:       90 * time.Second,\n    TLSHandshakeTimeout:   10 * time.Second,\n    ExpectContinueTimeout: 1 * time.Second,\n    TLSClientConfig: &amp;tls.Config{\n        ServerName: \"maps.googleapis.com\",\n    },\n}\n</code></pre>\n\n<p>Just make sure you reuse the Transport, and don't create a new one for each request.</p>\n"}], "owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 1, "accepted_answer_id": 47047187, "answer_count": 1, "score": 2, "last_activity_date": 1509544565, "creation_date": 1509495686, "last_edit_date": 1509525259, "question_id": 47046432, "link": "https://stackoverflow.com/questions/47046432/force-client-hostname-when-proxying-https", "title": "Force client hostname when proxying https", "body": "<p>I'm using toxiproxy. I'm having <a href=\"https://github.com/Shopify/toxiproxy/issues/175\" rel=\"nofollow noreferrer\">this exact issue</a>. Both of the <code>curl</code> solutions mentioned in the issue work (<a href=\"https://github.com/Shopify/toxiproxy/issues/175#issue-225301786\" rel=\"nofollow noreferrer\">solution a</a>, <a href=\"https://github.com/Shopify/toxiproxy/issues/175#issuecomment-303372210\" rel=\"nofollow noreferrer\">solution b</a>), but I can't use curl. I need to use the go standard <code>net/http</code> library.</p>\n\n<p>Is there any way to use <code>net/http</code> in such a fashion that I can explicitly tell it what host the proxy is using so it can see that the certificate is valid?</p>\n\n<p>I've tried setting <code>Host</code> and <code>Authority</code> headers on the net/http.Request, but that didn't work.</p>\n\n<p><strong>Details</strong></p>\n\n<p>Toxiproxy output:</p>\n\n<blockquote>\n  <p>proxy=[::]:22002 upstream=maps.googleapis.com:443</p>\n</blockquote>\n\n<p>My code:</p>\n\n<pre><code>url := \"https://localhost:22002/maps/api/geocode/json...\"\nreq, err := http.NewRequest(\"GET\", url, nil)\nreq.Host = \"maps.googleapis.com\"\nreq.Header.Set(\"Host\", \"maps.googleapis.com\")\nres, err := httpClient.Do(req)\n</code></pre>\n\n<p>Error: </p>\n\n<blockquote>\n  <p>x509: certificate is valid for *.googleapis.com,\n  *.clients6.google.com, *.cloudendpointsapis.com, cloudendpointsapis.com, googleapis.com, not localhost</p>\n</blockquote>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 1, "creation_date": 1509663896, "post_id": 47045445, "comment_id": 81121530, "body": "I don&#39;t feel like this warrants a full answer but I think configuration files are a good way. You don&#39;t need to worry about name clashes in your environment and it&#39;s simple to see it all in one place."}], "answers": [{"comments": [{"owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "reply_to_user": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1509663548, "post_id": 47045599, "comment_id": 81121427, "body": "@lofcek This is a great caution. Although one could argue, if someone has access to the machine you are running test cases, they probably have access to your source code, and might even have access to the text file if you are storing the password in a text file. Generally it would be a good idea to ensure there is nothing secret or sensitive on your servers you are doing test cases, and the test servers should not have access to commit source code. That way if it is compromised, they don&#39;t get anything useful at all."}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 2, "creation_date": 1509698496, "post_id": 47045599, "comment_id": 81132274, "body": "I don&#39;t think so. In university was normal, that every student had account on the same machine. But of course no other student has access to the school-mate\u2019s files. And also another small reason to not to pass sensitive data through command line - the data are also stored into unexpected storage - in the file .bash_history."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1532964225, "post_id": 47045599, "comment_id": 90160578, "body": "I edited your answer to remove the call to <code>flag.Parse</code>; you should not do that within a testing <code>init()</code> function as the test infrastructure does flag parsing."}, {"owner": {"reputation": 306, "user_id": 6101819, "user_type": "registered", "profile_image": "https://graph.facebook.com/234836870197330/picture?type=large", "display_name": "Penny Qian", "link": "https://stackoverflow.com/users/6101819/penny-qian"}, "edited": false, "score": 1, "creation_date": 1547476249, "post_id": 47045599, "comment_id": 95195217, "body": "but add the <code>flag.Parse()</code> in the main function, otherwise the arg <code>&amp;password</code> will remain default."}, {"owner": {"reputation": 99, "user_id": 6514065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QnnHE.png?s=128&g=1", "display_name": "lisp-ceo", "link": "https://stackoverflow.com/users/6514065/lisp-ceo"}, "reply_to_user": {"reputation": 306, "user_id": 6101819, "user_type": "registered", "profile_image": "https://graph.facebook.com/234836870197330/picture?type=large", "display_name": "Penny Qian", "link": "https://stackoverflow.com/users/6101819/penny-qian"}, "edited": false, "score": 1, "creation_date": 1558170846, "post_id": 47045599, "comment_id": 99018666, "body": "The comment by @PennyQian is very important. One may improve this answer by performing the flag parsing in the TestMain function:  <code>func TestMain(m *testing.M) { \tflag.StringVar(&amp;password, &quot;password&quot;, &quot;&quot;, &quot;Database password&quot;) \tflag.Parse() \tif password == &quot;&quot; { \t\tusage() \t\tlog.Fatal(&quot;Please set the database password&quot;) \t} \tretCode := m.Run() \tos.Exit(retCode) }</code>"}, {"owner": {"reputation": 429, "user_id": 3814775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8614686c908b84f4fb9c43d954bdf3?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/3814775/bruce"}, "reply_to_user": {"reputation": 306, "user_id": 6101819, "user_type": "registered", "profile_image": "https://graph.facebook.com/234836870197330/picture?type=large", "display_name": "Penny Qian", "link": "https://stackoverflow.com/users/6101819/penny-qian"}, "edited": false, "score": 0, "creation_date": 1607688345, "post_id": 47045599, "comment_id": 115357137, "body": "@PennyQian <code>flag.Parse()</code> is not needed in <code>init()</code> or <code>TestMain()</code> because like @DaveC said, <b>Command line flags are always parsed by the time test or benchmark functions run</b>, unless init() or <b>TestMain depends on command-line flags, including those of the testing package, it should call flag.Parse explicitly.</b> (the highlight part is from golang testing doc <a href=\"https://golang.org/pkg/testing/#hdr-Main\" rel=\"nofollow noreferrer\">golang.org/pkg/testing/#hdr-Main</a>)"}], "tags": [], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "is_accepted": true, "score": 14, "last_activity_date": 1532964037, "last_edit_date": 1532964037, "creation_date": 1509489911, "answer_id": 47045599, "question_id": 47045445, "link": "https://stackoverflow.com/questions/47045445/idiomatic-way-to-pass-variables-to-test-cases-in-golang/47045599#47045599", "title": "Idiomatic way to pass variables to test cases in golang", "body": "<p>It appears I have stumbled across the answer. Adding this to test cases allows you to pass parameters, i.e.</p>\n\n<pre><code>var password string\n\nfunc init() {\n        flag.StringVar(&amp;password, \"password\", \"\", \"Database Password\")\n}\n</code></pre>\n\n<p>Then you can do this:</p>\n\n<pre><code>go test github.com/user/project -password=123345\n</code></pre>\n\n<p>(As noted below, Don't do this on a test where you don't trust other users on the test server who have access to view running processes, (i.e. perhaps your test database has sensitive data in it. However. If you are in a organisation that likes to keep sensitive data in a test environment this is probably the least of your security problems)</p>\n"}, {"tags": [], "owner": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "is_accepted": false, "score": 9, "last_activity_date": 1530279106, "creation_date": 1530279106, "answer_id": 51102972, "question_id": 47045445, "link": "https://stackoverflow.com/questions/47045445/idiomatic-way-to-pass-variables-to-test-cases-in-golang/51102972#51102972", "title": "Idiomatic way to pass variables to test cases in golang", "body": "<p>Use an env var</p>\n\n<pre><code>func func TestFoo(t *testing.T) {\n  x := os.Getenv(\"MY_X\")\n  fmt.Println(x)\n}\n</code></pre>\n\n<p>Then call your test like this</p>\n\n<pre><code>MY_X=bar go test -v ./... -run TestFoo\n</code></pre>\n\n<p>and it should print <code>bar</code></p>\n"}], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5514, "favorite_count": 3, "accepted_answer_id": 47045599, "answer_count": 2, "score": 12, "last_activity_date": 1532964037, "creation_date": 1509489008, "question_id": 47045445, "link": "https://stackoverflow.com/questions/47045445/idiomatic-way-to-pass-variables-to-test-cases-in-golang", "title": "Idiomatic way to pass variables to test cases in golang", "body": "<p>When writing test cases for golang, what is the standard way to pass in variables that need to be provided to the tests. For example, we don't want to embed passwords in the source code of the test cases.</p>\n\n<p>What is the most standard way to handle this? Do we have the test cases look for a config file? Environment variable? Something else?</p>\n"}, {"tags": ["api", "authentication", "go", "google-calendar-api", "backend"], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 2, "last_activity_date": 1509492763, "creation_date": 1509492763, "answer_id": 47046025, "question_id": 47045128, "link": "https://stackoverflow.com/questions/47045128/how-to-login-to-use-your-google-calendar-using-go/47046025#47046025", "title": "how to login to use your google calendar using go?", "body": "<p>You'll need to do something like:</p>\n\n<pre><code>import (\n    \"crypto/rand\"\n    \"encoding/base64\"\n    \"encoding/gob\"\n    \"golang.org/x/oauth2/google\"\n    \"golang.org/x/oauth2\"\n    calendar \"google.golang.org/api/calendar/v3\"\n    \"github.com/gorilla/sessions\"\n)\nvar conf oauth2.Config\n\nfunc init() {\n    gob.Register(&amp;oauth2.Token{})\n}\n\nfunc getLoginURL(state string) string {\n    // State can be some kind of random generated hash string.\n    // See relevant RFC: http://tools.ietf.org/html/rfc6749#section-10.12\n    return conf.AuthCodeURL(state)\n}\n\nfunc randToken() string {\n    b := make([]byte, 32) \n    rand.Read(b)\n    return base64.StdEncoding.EncodeToString(b)\n}\n\nfunc Login(w http.ResponseWriter, r *http.Request) {\n    conf = &amp;oauth2.Config{\n        ClientID: \"your-client-id\",\n        ClientSecret: \"your-client-secret\",\n        RedirectUrl: \"https://www.yoursite.com/auth\",\n        Endpoint: google.Endpoint,\n        Scopes: []string{\"https://www.googleapis.com/auth/calendar\"}\n    }\n    state := randToken()\n    sess, _ := session.Get(r, \"session\")\n    sess.Values[\"state\"] = state\n    sess.Save(r, w)\n    http.Redirect(w, r, conf.AuthCodeURL(state), http.StatusFound)\n}\n\nfunc Auth(w http.ResponseWriter, r *http.Request) {\n    sess, _ := session.Get(r, \"session\")\n    state = sess.Values[\"state\"]\n    if state != r.URL.Query().Get(\"state\") {\n        http.Error(w, \"authorization failed\", http.StatusUnauthorized)\n        return\n    }\n    tok, _ := conf.Exchange(oauth2.NoContext, c.QueryParam(\"code\"))\n    sess.Values[\"token\"] = tok \n    sess.Save(r, w)\n    http.Redirect(w, r, \"https://www.yoursite.com/profile\", http.StatusFound)\n}\n\nfunc GetClient(r *http.Request) *http.Client {\n    sess, _ := session.Get(r, \"session\")\n    tok, _ := sess.Values[\"token\"].(*oauth2.Token)\n    client := conf.Client(oauth2.NoContext, tok)\n    return client\n}\n\nfunc Calendar(w http.ResponseWriter, r *http.Request) {\n    client := GetClient(r)\n    calendarService, _ = calendar.New(client)\n    //do stuff\n}\n</code></pre>\n\n<p>So, you send them to your <code>Login</code> handler, this generates a random key, and sends it (and the user) to google to have them login and authorize you to access their calendars, which will then redirect them to you <code>Auth</code> handler.  This will make sure that the <code>state</code> key they sent back matches the one you sent, and if so, will get the token from Google.  You then save it to the session.  When you want to get their client, you fetch the token from your session, and use it to exchange for a new Client, which you then use to create your Calendar service.</p>\n\n<p>I haven't checked the code exactly, but I tried to make a minimal example from my app which actually uses basically this code, so it should work (aside from probably missing an import or typos or some really minor stuff).</p>\n"}], "owner": {"reputation": 81, "user_id": 6500168, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/601b94035e1a7a2b6cc2c24f82f8c05e?s=128&d=identicon&r=PG&f=1", "display_name": "Amr Khalil", "link": "https://stackoverflow.com/users/6500168/amr-khalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 47046025, "answer_count": 1, "score": 0, "last_activity_date": 1509492763, "creation_date": 1509487118, "question_id": 47045128, "link": "https://stackoverflow.com/questions/47045128/how-to-login-to-use-your-google-calendar-using-go", "title": "how to login to use your google calendar using go?", "body": "<p>I am new to GO and APIs and I am making a back end using GO.\nthe user should be able to login using his/her google account and modifies his calendar.\nI opened the sample on this link <a href=\"https://developers.google.com/google-apps/calendar/quickstart/go\" rel=\"nofollow noreferrer\">Google Quickstart</a>   </p>\n\n<p>but the way I get the client is by the keys google gives it to me\nhow should I make the user login and get his calendar</p>\n"}, {"tags": ["go", "abstract-syntax-tree"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1509485325, "creation_date": 1509485325, "answer_id": 47044795, "question_id": 47044581, "link": "https://stackoverflow.com/questions/47044581/how-do-you-represent-nil-in-go-ast/47044795#47044795", "title": "How do you represent nil in Go AST?", "body": "<p>As per the Go specification, <code>nil</code> is a predeclared <strong>identifier</strong>. Therefore, it is represented by <a href=\"https://golang.org/pkg/go/ast/#Ident\" rel=\"nofollow noreferrer\"><code>*ast.Ident</code></a> in an AST:</p>\n\n<pre><code>node := ast.NewIdent(\"nil\")\n</code></pre>\n"}], "owner": {"reputation": 77578, "user_id": 32914, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/50facfccdffe2e9cabaa589205959d30?s=128&d=identicon&r=PG", "display_name": "Mason Wheeler", "link": "https://stackoverflow.com/users/32914/mason-wheeler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 47044795, "answer_count": 1, "score": 2, "last_activity_date": 1509485325, "creation_date": 1509484203, "question_id": 47044581, "link": "https://stackoverflow.com/questions/47044581/how-do-you-represent-nil-in-go-ast", "title": "How do you represent nil in Go AST?", "body": "<p>Looking at the <a href=\"https://golang.org/pkg/go/ast/\" rel=\"nofollow noreferrer\">Go AST documentation,</a> I don't see any node type to represent a <code>nil</code> in the code.  BasicLit doesn't cover it in the list of token types it accepts, and in fact when I look at the source to <code>go/token</code> I don't see a <code>nil</code> token at all!</p>\n\n<p>If I want to create an AST of the form <code>if x != nil</code>, how do I do the <code>nil</code>?</p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 4, "creation_date": 1509482404, "post_id": 47044082, "comment_id": 81035656, "body": "It should be <code>var data = make(map[string][2][]float64)</code>. But yes, it will work."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1509482765, "post_id": 47044082, "comment_id": 81035827, "body": "To add to @AndySchweig&#39;s comment, here&#39;s an example: <a href=\"https://play.golang.org/p/3HZgsnH2Xi\" rel=\"nofollow noreferrer\">play.golang.org/p/3HZgsnH2Xi</a>"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509483224, "post_id": 47044082, "comment_id": 81036045, "body": "map values are arbitrary types.   Literally any type at all.  Map keys have some restrictions - anything /comparable/ will do, as defined here:  <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Comparison_operators</a>"}, {"owner": {"reputation": 101, "user_id": 5163713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a822cb417046f1cef84c4a338c6d85f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack-delay", "link": "https://stackoverflow.com/users/5163713/stack-delay"}, "edited": false, "score": 0, "creation_date": 1509615296, "post_id": 47044082, "comment_id": 81091727, "body": "Thanks for your replies! I&#39;m sorry to see that the question itself was not appreciated. Unfortunately stackoverflow may penalize me for removing the question. For the future it would be beneficial for me to know why this question was not appreciated. Eli5."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5489733"}, "is_accepted": false, "score": 0, "last_activity_date": 1509593168, "creation_date": 1509593168, "answer_id": 47067106, "question_id": 47044082, "link": "https://stackoverflow.com/questions/47044082/defining-a-map-to-arrays-containing-slices-in-golang/47067106#47067106", "title": "Defining a map to arrays containing slices in Golang", "body": "<p>data := map[string][2][]float64{\"golang\": {[]float64{3.14, 3.15}, []float64{3.12, 3.16}}}</p>\n\n<p>fmt.Println(data[\"golang\"][0][0])</p>\n\n<p>output:\n3.14</p>\n"}], "owner": {"reputation": 101, "user_id": 5163713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a822cb417046f1cef84c4a338c6d85f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack-delay", "link": "https://stackoverflow.com/users/5163713/stack-delay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1509593168, "creation_date": 1509481944, "question_id": 47044082, "link": "https://stackoverflow.com/questions/47044082/defining-a-map-to-arrays-containing-slices-in-golang", "title": "Defining a map to arrays containing slices in Golang", "body": "<p>In Go (golang), is it possible to define a map from strings to arrays, and in each array element I want to store a slice. Like this:</p>\n\n<pre><code>var data = make(map[string][2]Slice[]float64)\n</code></pre>\n\n<p>Then I want to retrieve my data, something like this:</p>\n\n<pre><code>floatValue0 = data[\"string-key\"][0][#]\nfloatValue1 = data[\"string-key\"][1][#]\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509481015, "post_id": 47043766, "comment_id": 81034990, "body": "This isn&#39;t really about Go at all.   You cannot have both requirements that you want a REST-ful architecture and no client state; that&#39;s a contradiction.   Pick one.   (Otherwise you just have a library of resources, not an application.)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509481556, "post_id": 47043766, "comment_id": 81035249, "body": "@BadZen a REST application is stateless by definition. &quot;A library of resources&quot; is the textbook definition of a REST application. You may be confusing REST with JSON-RPC (a very common misunderstanding, particularly in the Swagger camp that sees REST as the new SOAP). See <a href=\"https://martinfowler.com/articles/richardsonMaturityModel.html\" rel=\"nofollow noreferrer\">martinfowler.com/articles/richardsonMaturityModel.html</a> <a href=\"https://restfulapi.net/rest-architectural-constraints/\" rel=\"nofollow noreferrer\">restfulapi.net/rest-architectural-constraints</a> and <a href=\"https://restfulapi.net/hateoas/\" rel=\"nofollow noreferrer\">restfulapi.net/hateoas</a> for more info."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509481824, "post_id": 47043766, "comment_id": 81035365, "body": "Or you may be not reading my comment.   You&#39;re saying exactly the thing I said - you don&#39;t get to have a REST-ful application where the client has no state.  You can satisfy at most one of those conditions.  Also, answers are for answers.   There is no answer, so you should not post a non-answer."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509481884, "post_id": 47043766, "comment_id": 81035390, "body": "There is no requirement that a client of a REST application maintain client-side state. It can request all the data it needs, as it needs it, from the server."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509482343, "post_id": 47043766, "comment_id": 81035627, "body": "There are two requirements that OP indiciated: 1) per-session state not kept on client side, and 2) REST-fulness.  My statement was that these are mutually exclusive, not that every REST-ful architecture must have client state.   (We really ought to recognize the difference between NOT(A AND B) and A IMPLIES B as programmers, no?)   Anyway, we&#39;re OT so I&#39;m ghosting."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1509482459, "post_id": 47043766, "comment_id": 81035682, "body": "@Martin: regardless of the definition of REST, <i>why</i> can&#39;t you maintain the state you need with the http client? State doesn&#39;t require a browser."}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1509481819, "post_id": 47044018, "comment_id": 81035363, "body": "What is the &quot;authentication token&quot;? What does connect that &quot;token&quot; to a user account?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1509481914, "post_id": 47044018, "comment_id": 81035407, "body": "@zerkms that&#39;s an application-specific detail that will vary from one case to the next."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1509481978, "post_id": 47044018, "comment_id": 81035434, "body": "Can it be a random string that is then stored in a database in a <code>auth token -&gt; user id</code> table?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1509482221, "post_id": 47044018, "comment_id": 81035562, "body": "It can but that would not be particularly secure. That&#39;s well outside the scope of this question, though."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1509482276, "post_id": 47044018, "comment_id": 81035589, "body": "&quot;It can&quot; --- what I explained is a &quot;session&quot; though. PS: it would not be less secure than any other authentication token, like oauth v2 access token."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1509482433, "post_id": 47044018, "comment_id": 81035669, "body": "If you store token -&gt; userID in the database, then anyone who gets ahold of the database can impersonate any user with an open session. It&#39;s more secure to store a cryptographic hash of the token, same as you would with a password."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1509482492, "post_id": 47044018, "comment_id": 81035705, "body": "Sure, my initial point is though, that &quot;there is no session&quot; turned into &quot;It can&quot; in like 4 minutes (since all that is too vague, and is not formalised anywhere)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1509482884, "post_id": 47044018, "comment_id": 81035882, "body": "Actually, that was in my answer from the beginning: &quot;The only thing that might be in a client-side session would be a simple authentication token.&quot; This is a convenience often used in browser-based REST clients to avoid repeated authentication. There still isn&#39;t a &quot;session&quot;, it&#39;s just a form of stored authentication."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 2, "last_activity_date": 1509481688, "creation_date": 1509481688, "answer_id": 47044018, "question_id": 47043766, "link": "https://stackoverflow.com/questions/47043766/how-can-i-maintain-the-application-state-in-restful-api-in-golang/47044018#47044018", "title": "How can I maintain the application state in RESTful api in golang", "body": "<p>In a true RESTful application, there is no session. The only thing that might be in a client-side session would be a simple authentication token, and a non-browser client should be able to send authentication with every request as necessary.</p>\n"}], "owner": {"reputation": 15, "user_id": 5629275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831b29f748f31de70f80dbcbdf371276?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/5629275/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1509537101, "creation_date": 1509480648, "last_edit_date": 1509537101, "question_id": 47043766, "link": "https://stackoverflow.com/questions/47043766/how-can-i-maintain-the-application-state-in-restful-api-in-golang", "title": "How can I maintain the application state in RESTful api in golang", "body": "<p>In my case, I don't have a browser as a client. I will be using HTTP client so I can not maintain the client-side session. Therefore how can I maintain the application state?</p>\n"}, {"tags": ["user-interface", "go", "goland"], "answers": [{"comments": [{"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1509478058, "post_id": 47043168, "comment_id": 81033462, "body": "This is exactly what I just did. I just added <code>-ldflags=&quot;-H windowsgui&quot;</code> to the <code>Go tool arguments</code>. But when I run it, no window appears."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1509478123, "post_id": 47043168, "comment_id": 81033504, "body": "Can you provide a sample of this, as I don&#39;t have any such application available to debug. Or raise an issue here: <a href=\"https://youtrack.jetbrains.com/issues/Go\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issues/Go</a>"}, {"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1509478229, "post_id": 47043168, "comment_id": 81033555, "body": "I could provide you the code but it requires a lib (walk)."}, {"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1509478703, "post_id": 47043168, "comment_id": 81033798, "body": "I guess I have to stick to a simple text editor + terminal for now. It seems gogland is still buggy or missing some things (I can&#39;t even build and generate an exe file, I can only run and debug)."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1509482339, "post_id": 47043168, "comment_id": 81035624, "body": "Just building an executable without running it is not currently supported, see: <a href=\"https://youtrack.jetbrains.com/issue/GO-2408\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/GO-2408</a> This is by design, not a bug. Buggy / missing some things, it cannot be improved if the information required to reproduce the issues is not provided. I have no way to test how this works on my machine, or doesn&#39;t if there&#39;s no minimal Hello World that breaks for you or at least some instructions on how to reproduce it. I&#39;m sorry I don&#39;t have a better answer for you."}, {"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1509482562, "post_id": 47043168, "comment_id": 81035732, "body": "Here&#39;s the GUI lib I am using: <a href=\"https://github.com/lxn/walk\" rel=\"nofollow noreferrer\">github.com/lxn/walk</a>. They also have an example (this is the one I test)."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1509494632, "post_id": 47043168, "comment_id": 81039836, "body": "Thank you. Based on that information I&#39;ve been able to replicate the problem and using this code: <a href=\"https://play.golang.org/p/FtP297tvAv\" rel=\"nofollow noreferrer\">play.golang.org/p/FtP297tvAv</a> I&#39;ve been able to get the panic that was missing in order to provide the information needed to debug this problem. Turns out it&#39;s not an IDE problem but a missing configuration needed by Windows to allow the application to run. Point the Output Directory in the sample place as the ` .manifest ` file is and it will work. I&#39;ve updated the answer as such."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 2, "last_activity_date": 1509494758, "last_edit_date": 1509494758, "creation_date": 1509477951, "answer_id": 47043168, "question_id": 47043068, "link": "https://stackoverflow.com/questions/47043068/running-gui-apps-in-gogland-ide/47043168#47043168", "title": "Running GUI apps in Gogland IDE", "body": "<p><code>go build</code> will only build the application.</p>\n\n<p>To actually run the application, you should go to <code>Run | Edit Configurations... | + | Go Application</code> and configure the application as you need.</p>\n\n<p>Here you will need to set two options:</p>\n\n<ul>\n<li>add <code>-ldflags=\"-H windowsgui\"</code> to the <code>Go tool arguments</code> option</li>\n<li>configure the <code>Output directory</code> to be in the same directory as your <code>.manifest</code> file</li>\n</ul>\n\n<p>Setting the output directory is critical in order to run the the application without encountering the following panic <code>panic: TTM_ADDTOOL failed</code> described <a href=\"https://github.com/lxn/walk/issues/28\" rel=\"nofollow noreferrer\">in this issue</a>.</p>\n\n<p>Then you can run the configuration via <code>Run | Run...</code> and select the configuration you've just created.</p>\n"}], "owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "accepted_answer_id": 47043168, "answer_count": 1, "score": 2, "last_activity_date": 1509494758, "creation_date": 1509477543, "question_id": 47043068, "link": "https://stackoverflow.com/questions/47043068/running-gui-apps-in-gogland-ide", "title": "Running GUI apps in Gogland IDE", "body": "<p>When I build in Terminal, I can use a flag to say I want to build for GUI:</p>\n\n<pre><code>go build -ldflags=\"-H windowsgui\"\n</code></pre>\n\n<p>However, I just started using Gogland (JetBrains) and I don't how to run GUI apps. What can I do?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509479109, "post_id": 47043048, "comment_id": 81034029, "body": "Perhaps you wanted to loop and execute your <code>select</code> many times instead of just once?"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509479168, "post_id": 47043048, "comment_id": 81034062, "body": "That said, try to avoid the resulting &quot;polling&quot; style in go - if you want to do two things, run them in separate goroutines and use channels as /coordination points/."}, {"owner": {"reputation": 783, "user_id": 6865456, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/a11db9c620a28f26e5593a3fab778fd5?s=128&d=identicon&r=PG", "display_name": "Vasanti", "link": "https://stackoverflow.com/users/6865456/vasanti"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509479792, "post_id": 47043048, "comment_id": 81034417, "body": "Let&#39;s say I have x number of lines of data in Stdin and I am expecting more y number of lines of data after z milliseconds, the prediction is performed for the x number of lines  but after that it terminates the program. I am expecting it to wait until it encounters the y number of lines instead of terminating. Could you please elaborate how would looping the select statement be the solution for it? Note: There is no fixed value for x, y z"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509480586, "post_id": 47043048, "comment_id": 81034768, "body": "As is, the first time it hits the select - maybe even before there is any input available on the scanner - it will go through the default, sleep, and then exit <code>main()</code> No?  You want to wait for /input/.  The thing about &quot;not polling&quot; means you should try not to use <code>default</code>, in this use case.  Certainly if you don&#39;t want it to immediately exit, or exit after one input - you&#39;ll need a loop.   You want to process /multiple/ input lines, as you say."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509480804, "post_id": 47043048, "comment_id": 81034874, "body": "(Another way to put the higher-level suggestion about how to use channels:  prefer to think of them as &quot;pipelines in a factory&quot; rather than &quot;I/O multiplexors&quot;...)"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1509482550, "post_id": 47043048, "comment_id": 81035726, "body": "You can remove the <code>time.Sleep</code> call and place your <code>select</code> statement in a <code>for</code> loop."}], "answers": [{"tags": [], "owner": {"reputation": 726, "user_id": 387670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de92c7f1d6b452b9e2b3f38c11967cb8?s=128&d=identicon&r=PG", "display_name": "sahaj", "link": "https://stackoverflow.com/users/387670/sahaj"}, "is_accepted": true, "score": 1, "last_activity_date": 1509506164, "creation_date": 1509506164, "answer_id": 47047692, "question_id": 47043048, "link": "https://stackoverflow.com/questions/47043048/how-to-ensure-the-golang-channel-waits-for-the-data-and-the-program-does-not-ter/47047692#47047692", "title": "How to ensure the Golang channel waits for the data and the program does not terminate if Stdin does not have data", "body": "<p>Put your <code>select</code> in infinite loop.</p>\n\n<pre><code>for {\n   select{\n      case &lt;-data:\n        run_the_model(data)\n        time.Sleep(time.Second * 5)\n      default:\n        println(\"Waiting for data\")\n        time.Sleep(time.Duration(math.MaxInt64))\n   }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 783, "user_id": 6865456, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/a11db9c620a28f26e5593a3fab778fd5?s=128&d=identicon&r=PG", "display_name": "Vasanti", "link": "https://stackoverflow.com/users/6865456/vasanti"}, "edited": false, "score": 0, "creation_date": 1509546334, "post_id": 47049466, "comment_id": 81061305, "body": "Since the data flow is not constant, I want my program to wait when there is no data and constantly print <code>Waiting for data</code> and when there would be data in Stdin, I want the model to be run. As per my understanding, this can be achieved using channels and select, where if there is no data in any channels the default case is run and if there is data in the channel the <code>run_the_model</code> method is called."}, {"owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "reply_to_user": {"reputation": 783, "user_id": 6865456, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/a11db9c620a28f26e5593a3fab778fd5?s=128&d=identicon&r=PG", "display_name": "Vasanti", "link": "https://stackoverflow.com/users/6865456/vasanti"}, "edited": false, "score": 0, "creation_date": 1509695462, "post_id": 47049466, "comment_id": 81130789, "body": "It&#39;s waiting in loop tile close channel or break the loop, just test it dude"}], "tags": [], "owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "is_accepted": false, "score": 0, "last_activity_date": 1509518771, "last_edit_date": 1509518771, "creation_date": 1509518143, "answer_id": 47049466, "question_id": 47043048, "link": "https://stackoverflow.com/questions/47043048/how-to-ensure-the-golang-channel-waits-for-the-data-and-the-program-does-not-ter/47049466#47049466", "title": "How to ensure the Golang channel waits for the data and the program does not terminate if Stdin does not have data", "body": "<p>I think u using select wrong , for your case this should be works:</p>\n\n<pre><code>func runTheModel(in string) {\n    // do what ever u want\n}\n\nfunc main() {\n    data := make(chan string)\n    // read data from Stdin\n    go func() {\n        scan := bufio.NewScanner(os.Stdin)\n        for scan.Scan() {\n            data &lt;- scan.Text()\n        }\n\n    }()\n    println(\"waiting for data:\")\n    for d := range data {\n        // command to exit program\n        if d == \"q\" {\n            return\n        }\n        go runTheModel(d)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 783, "user_id": 6865456, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/a11db9c620a28f26e5593a3fab778fd5?s=128&d=identicon&r=PG", "display_name": "Vasanti", "link": "https://stackoverflow.com/users/6865456/vasanti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3680, "favorite_count": 0, "accepted_answer_id": 47047692, "answer_count": 2, "score": 3, "last_activity_date": 1509518771, "creation_date": 1509477485, "question_id": 47043048, "link": "https://stackoverflow.com/questions/47043048/how-to-ensure-the-golang-channel-waits-for-the-data-and-the-program-does-not-ter", "title": "How to ensure the Golang channel waits for the data and the program does not terminate if Stdin does not have data", "body": "<p>I have a Golang program which makes real time predictions on a machine learning model built using TensorFlow. The data for the prediction needs to be read line by line from Stdin and the prediction has to be performed on each line of data. The flow of data is not constant. I need a system that ensures that every time there is data to be read from Stdin, the prediction method is invoked and if there is no data in Stdin, the program waits for new data and does not terminate. </p>\n\n<p>I tried achieving this using channels and the select, but if there is no data in the Stdin, the program terminates. Below is the code snippet:</p>\n\n<pre><code>  func run_the_model(in &lt;-chan string) {\n     go func(){\n        ...  \n        ...  \n        ...\n         //Fetch the model\n         //Run the prediction \n         //print the result on StdOut\n     }() \n  }\n\n  func main() {\n   data := make(chan string)\n   // read data from Stdin\n   go func() {\n       scan := bufio.NewScanner(os.Stdin)\n       for scan.Scan() {\n           data &lt;- scan.Text()\n       }\n\n   }()\n   time.Sleep(time.Second * 5)\n\n   select{\n      case &lt;-data:\n        run_the_model(data)\n        time.Sleep(time.Second * 5)\n      default:\n        println(\"Waiting for data\")\n        time.Sleep(time.Duration(math.MaxInt64))\n   }\n  }\n</code></pre>\n\n<p>When there is no new data in Stdin the Select's default case must be executed and when there is new data in the <code>data</code> channel, the <code>run_the_model</code> must be executed. How can this be achieved? </p>\n"}, {"tags": ["go", "google-api"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1509477221, "post_id": 47042907, "comment_id": 81032971, "body": "I have a feeling that structure is being marshalled as a JSON with an <code>omitempty</code> flag on that field.  The json package omits false booleans as if they are nil: <a href=\"https://github.com/golang/go/issues/13284\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/13284</a>"}, {"owner": {"reputation": 378, "user_id": 2209376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19f53942dacb5e9e8dbf6159c76a69a5?s=128&d=identicon&r=PG", "display_name": "steverippl", "link": "https://stackoverflow.com/users/2209376/steverippl"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1509487578, "post_id": 47042907, "comment_id": 81037773, "body": "Yeah, that seems to be the case. There&#39;s a similar issue to this one on the GitHub <a href=\"https://github.com/google/google-api-go-client/issues/229\" rel=\"nofollow noreferrer\">issues page</a> for google-api-go-client, so I commented there."}], "owner": {"reputation": 378, "user_id": 2209376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19f53942dacb5e9e8dbf6159c76a69a5?s=128&d=identicon&r=PG", "display_name": "steverippl", "link": "https://stackoverflow.com/users/2209376/steverippl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509477244, "creation_date": 1509476831, "last_edit_date": 1509477244, "question_id": 47042907, "link": "https://stackoverflow.com/questions/47042907/golang-google-admin-directory-api-cant-set-changepasswordatnextlogin-to-false", "title": "Golang Google Admin Directory API - can&#39;t set ChangePasswordAtNextLogin to false", "body": "<p>I'm trying to use Go and the Google Admin Directory API to manage some Gsuite user attributes, specifically passwords and changePasswordAtNextLogin. I can build my user and send it to update</p>\n\n<pre><code>srv := client()\nuser := admin.User{\n    ChangePasswordAtNextLogin: forceReset,\n    HashFunction:              \"MD5\",\n    Password:                  fmt.Sprintf(\"%x\", md5.Sum([]byte(newPassword))),\n}\n\n_, err := srv.Users.Update(email, &amp;user).Do()\n</code></pre>\n\n<p>and the password will be updated successfully. If <code>forceRest</code> is <code>true</code> then it will set the flag for the user, but if it's <code>false</code> it won't remove the flag! Is this a bug in the Go API library, or am I doing something wrong?</p>\n\n<p>I tried adding <code>ForceSendFields: []string{\"ChangePasswordAtNextLogin\"}</code> to the <code>User</code> struct and that didn't help.</p>\n"}, {"tags": ["performance", "go", "complexity-theory"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1509470602, "post_id": 47041032, "comment_id": 81029075, "body": "For one thing, you could take the value in the outermost loop (<code>for k :=</code> -&gt; <code>for k,v :=</code>) which would eliminate the extra lookup in the innermost loop (<code>:= range mapSource[k]</code> -&gt; <code>:= range v</code>). There&#39;s also no need to cast <code>targetPos</code> and <code>sourcePos</code> to <code>int32</code> since they&#39;re already <code>int32</code> according to your question. Overall though maps are likely the most efficient structure. If you have some idea the size of the final data set, or a minimum size, you could preallocate <code>matches</code> with that capacity."}, {"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 0, "creation_date": 1509470631, "post_id": 47041032, "comment_id": 81029092, "body": "are the arrays always sorted (like in your example)?"}, {"owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "edited": false, "score": 0, "creation_date": 1509470692, "post_id": 47041032, "comment_id": 81029125, "body": "Not sure how much it will help, but <code>for _, x := range slice {</code> format will redeclare x and assign the value to it on each iteration. Try using indexed values instead and see if it helps at all. <code>for i := range slice { ... slice[i]</code>"}, {"owner": {"reputation": 1671, "user_id": 325358, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/eb58709dc08423fc567de3a3225b23c9?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/325358/ivan"}, "reply_to_user": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 0, "creation_date": 1509471105, "post_id": 47041032, "comment_id": 81029387, "body": "@dave yes, they are"}, {"owner": {"reputation": 493, "user_id": 6111465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72fJG.png?s=128&g=1", "display_name": "gammazero", "link": "https://stackoverflow.com/users/6111465/gammazero"}, "edited": false, "score": 0, "creation_date": 1509471555, "post_id": 47041032, "comment_id": 81029639, "body": "Maybe keep yet another map of source key ==&gt; target keys.  That will remove the sequential iteration of the target maps for each source key."}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1512389387, "post_id": 47041032, "comment_id": 82223595, "body": "Could you provide a sample data? There is no obvious improvement IMO. If you provide data maybe we could use another data structure or data model to improve query time. Also please specify how <code>sourceMap</code>/<code>targetMap</code> (or a specific value in them) would change. Maybe we could cache something."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1512481965, "post_id": 47041032, "comment_id": 82268617, "body": "The top level operation is an intersection between two sets of integers - the keys in mapTarget and mapSource. If the intersection is significantly smaller than the input sets there are algorithms that have better behavior than the linear scan you do now. If the domain of the keys is limited there are linear algorithms that are much better performing than your current code (bitmaps). I know too little about your data to be able to say more. For now in your current code add: <code>if len(mapSource) &gt; len(mapTarget) { mapSource, mapTarget = mapTarget, mapSource }</code>"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1512589732, "post_id": 47041032, "comment_id": 82323823, "body": "The answer to the question title as phrased is <i>always</i> &quot;PROBABLY!&quot; =P"}], "answers": [{"comments": [{"owner": {"reputation": 6022, "user_id": 468495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vRQn6.jpg?s=128&g=1", "display_name": "Vinay Pai", "link": "https://stackoverflow.com/users/468495/vinay-pai"}, "edited": false, "score": 0, "creation_date": 1512677472, "post_id": 47041766, "comment_id": 82366108, "body": "This code has a race condition because there are multiple goroutines writing to <code>final</code> concurrently. If you wrap it in a mutex my hunch this version will perform much slower than the original because you&#39;re going to have <i>constant</i> contention for that lock."}, {"owner": {"reputation": 6022, "user_id": 468495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vRQn6.jpg?s=128&g=1", "display_name": "Vinay Pai", "link": "https://stackoverflow.com/users/468495/vinay-pai"}, "edited": false, "score": 0, "creation_date": 1512682907, "post_id": 47041766, "comment_id": 82368665, "body": "The point is (1) the code as written will not work  (2) You can solve that with  channels, but then you&#39;re back to square one where you a single goroutine is doing all the appends to the array, except you&#39;ve added a whole bunch of goroutines to the mix so I guarantee it will perform worse than the OP&#39;s code."}, {"owner": {"reputation": 6022, "user_id": 468495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vRQn6.jpg?s=128&g=1", "display_name": "Vinay Pai", "link": "https://stackoverflow.com/users/468495/vinay-pai"}, "edited": false, "score": 0, "creation_date": 1512683849, "post_id": 47041766, "comment_id": 82369129, "body": "@Ivan, I&#39;d be curious to see a benchmark on your original dataset."}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1512678193, "last_edit_date": 1512678193, "creation_date": 1509472562, "answer_id": 47041766, "question_id": 47041032, "link": "https://stackoverflow.com/questions/47041032/can-i-optimise-this-further-so-that-it-runs-faster/47041766#47041766", "title": "Can I optimise this further so that it runs faster?", "body": "<p>I would probably do it like this so that I can do some of the work concurrently:</p>\n\n<p><a href=\"https://play.golang.org/p/JHAmPRh7jr\" rel=\"nofollow noreferrer\">https://play.golang.org/p/JHAmPRh7jr</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nvar final [][]int32\nvar wg sync.WaitGroup\nvar receiver chan []int32\nfunc main() {\n    final = [][]int32{}\n    mapTarget := make(map[int32][]int32)\n    mapSource := make(map[int32][]int32)\n    mapSource[1] = []int32{3, 4}\n    mapSource[5] = []int32{9, 10}\n\n    mapTarget[1] = []int32{1, 2, 3}\n    mapTarget[2] = []int32{2, 3}\n    mapTarget[3] = []int32{1, 2}\n    wg = sync.WaitGroup{}\n    receiver = make(chan []int32)\n    go func() {\n        for elem := range receiver {\n            final = append(final, elem)\n            wg.Done()\n        }\n    }()\n    for k := range mapSource {\n        if _, ok := mapTarget[k]; ok {\n            wg.Add(1)\n            go permutate(mapSource[k], mapTarget[k])\n        }\n    }\n    wg.Wait()\n    fmt.Println(final)\n\n}\n\nfunc permutate(a, b []int32) {\n    for i := 0; i &lt; len(a); i++ {\n        for j := 0; j &lt; len(b); j++ {\n            wg.Add(1)\n            receiver &lt;- []int32{a[i], b[j]}\n        }\n    }\n    wg.Done()\n}\n</code></pre>\n\n<p>You may even want to see if you get any benefit from this:</p>\n\n<pre><code>for k := range mapSource {\n      wg.Add(1)\n      go func(k int32) {\n          if _, ok := mapTarget[k]; ok {\n              wg.Add(1)\n              go permutate(mapSource[k], mapTarget[k])\n          }\n          wg.Done()\n      }(k)\n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 5, "last_activity_date": 1512403778, "last_edit_date": 1512403778, "creation_date": 1512403216, "answer_id": 47637270, "question_id": 47041032, "link": "https://stackoverflow.com/questions/47041032/can-i-optimise-this-further-so-that-it-runs-faster/47637270#47637270", "title": "Can I optimise this further so that it runs faster?", "body": "<blockquote>\n  <p>Can I optimise this further so that it runs faster?</p>\n  \n  <p>Is there any possible way (a more appropriate data structure or\n  whatever) that could improve the speed of my program?</p>\n</blockquote>\n\n<p>Probably.</p>\n\n<hr>\n\n<blockquote>\n  <p>The <a href=\"http://xyproblem.info/\" rel=\"noreferrer\">XY problem</a> is asking about your\n  attempted solution rather than your actual problem. This leads to\n  enormous amounts of wasted time and energy, both on the part of people\n  asking for help, and on the part of those providing help.</p>\n</blockquote>\n\n<hr>\n\n<p>We don't have even the most basic information about your problem, a description of the form, content, and frequency of your original input data, and your desired output. What original data should drive a benchmark? </p>\n\n<p>I created some fictional original data, which produced some fictional output and results:</p>\n\n<pre><code>BenchmarkPeterSO-4   30    44089894 ns/op    5776666 B/op      31 allocs/op\nBenchmarkIvan-4      10   152300554 ns/op   26023924 B/op    6022 allocs/op\n</code></pre>\n\n<p>It is possible that your algorithms are slow.</p>\n"}, {"tags": [], "owner": {"reputation": 319, "user_id": 8652703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce90a6950f92d17211799b8bb7eabea?s=128&d=identicon&r=PG&f=1", "display_name": "Terry Pang", "link": "https://stackoverflow.com/users/8652703/terry-pang"}, "is_accepted": false, "score": -1, "last_activity_date": 1512441136, "last_edit_date": 1512441136, "creation_date": 1512438051, "answer_id": 47644752, "question_id": 47041032, "link": "https://stackoverflow.com/questions/47041032/can-i-optimise-this-further-so-that-it-runs-faster/47644752#47644752", "title": "Can I optimise this further so that it runs faster?", "body": "<p>At first I was thinking:</p>\n\n<ol>\n<li><p>Calculate keys in common in one batch, and calculate the final slice size.  </p></li>\n<li><p>Make slice with capacity that step 1 calculated.  </p></li>\n<li><p>Append one by one.   </p></li>\n</ol>\n\n<p>Then next structure, but it would not generate final result as array, but all the append work would be just link the node.</p>\n\n<pre><code>type node struct {\n    val    int\n    parent *node\n    next   *node\n    child  *node\n}\n\ntype tree struct {\n    root  *node\n    level int\n}\n\nvar sourceMap map[int]*tree\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6022, "user_id": 468495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vRQn6.jpg?s=128&g=1", "display_name": "Vinay Pai", "link": "https://stackoverflow.com/users/468495/vinay-pai"}, "is_accepted": false, "score": 0, "last_activity_date": 1512490963, "last_edit_date": 1512490963, "creation_date": 1512490584, "answer_id": 47658076, "question_id": 47041032, "link": "https://stackoverflow.com/questions/47041032/can-i-optimise-this-further-so-that-it-runs-faster/47658076#47658076", "title": "Can I optimise this further so that it runs faster?", "body": "<p>The best optimization probably involves changing the source and target data structures to begin with so you're don't have to iterate as much, but it's hard to be sure without knowing more about what the underlying problem you're solving is, and how the maps are generated.  </p>\n\n<p>However, there is an optimization that should get you a roughly 2x boost (just an educated guess), depending on the exact numbers. </p>\n\n<pre><code>var sources, targets []int32\n\nfor k, srcPositions := range mapSource {\n    if tgtPositions, found := mapTarget[k]; found {\n        sources = append(sources, srcPositions...)\n        targets = append(targets, tgtPositions...)\n    }\n}\n\nmatches = make([]match, len(sources) * len(targets))\ni := 0\nfor _, s := range(sources) {\n    for _, t := range(targets) {\n        matches[i] = match{s, t}\n        i++\n    }\n}\n</code></pre>\n\n<p>The general idea is to minimize the amount of copying that has to be done, and improve the locality of memory references. I think this is about the best you can do with this data structure. My hunch is this isn't the best datastructure to begin with for the underlying problem, and there are much bigger gains to be had.</p>\n"}], "owner": {"reputation": 1671, "user_id": 325358, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/eb58709dc08423fc567de3a3225b23c9?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/325358/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 3, "answer_count": 4, "score": 6, "last_activity_date": 1512678193, "creation_date": 1509470181, "last_edit_date": 1512145378, "question_id": 47041032, "link": "https://stackoverflow.com/questions/47041032/can-i-optimise-this-further-so-that-it-runs-faster", "title": "Can I optimise this further so that it runs faster?", "body": "<p>As you can see in the following pprof output, I have these nested for loops which take most of the time of my program. Source is in golang but code is explained below:</p>\n\n<pre><code>  8.55mins    1.18hrs     20:   for k := range mapSource {\n  4.41mins    1.20hrs     21:           if positions, found := mapTarget[k]; found {\n         .          .     22:                   // save all matches\n  1.05mins   1.05mins     23:                   for _, targetPos := range positions {\n  2.25mins   2.33mins     24:                           for _, sourcePos := range mapSource[k] {\n     1.28s     15.78s     25:                                   matches = append(matches, match{int32(targetPos), int32(sourcePos)})\n         .          .     26:                           }\n         .          .     27:                   }\n         .          .     28:           }\n         .          .     29:   }\n</code></pre>\n\n<p>At the moment the structures I'm using are 2 <code>map[int32][]int32</code>, targetMap and sourceMap.</p>\n\n<p>These maps contain, for a given key, an array of ints. Now I want to find the keys that match in both maps, and save the combinations of the elements in the arrays.</p>\n\n<p>So for example:</p>\n\n<pre><code>sourceMap[1] = [3,4]\nsourceMap[5] = [9,10]\n\ntargetMap[1] = [1,2,3]\ntargetMap[2] = [2,3]\ntargetMap[3] = [1,2]\n</code></pre>\n\n<p>The only key in common is <code>1</code> and the result will be <code>[(3,1), (3,2), (3,3), (4,1), (4,2), (4,3)]</code></p>\n\n<p>Is there any possible way (a more appropriate data structure or whatever) that could improve the speed of my program?</p>\n\n<p>In my case, maps can contain somewhere between 1000 and 150000 keys, while the arrays inside are usually pretty small.</p>\n\n<p>EDIT: Concurrency is not an option as this is already being run several times in several threads at the same time.</p>\n"}, {"tags": ["go", "markdown"], "answers": [{"comments": [{"owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "edited": false, "score": 0, "creation_date": 1513069472, "post_id": 47041011, "comment_id": 82498494, "body": "This doesn\u2019t give me much guidance I need to select the line in the markdown that is the date (it is formatted as plain text) and then sort.Slice on that ? How exactly is that to be approached ?"}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "reply_to_user": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "edited": false, "score": 0, "creation_date": 1513082735, "post_id": 47041011, "comment_id": 82506778, "body": "Edited to add some more detail. Read both sort and time pkg docs and it should be straightforward."}, {"owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "edited": false, "score": 0, "creation_date": 1513861596, "post_id": 47041011, "comment_id": 82818926, "body": "Thank you will have another attempt"}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": -2, "last_activity_date": 1513092264, "last_edit_date": 1513092264, "creation_date": 1509470095, "answer_id": 47041011, "question_id": 47040938, "link": "https://stackoverflow.com/questions/47040938/go-lang-markdown-app/47041011#47041011", "title": "GO Lang markdown app", "body": "<p>See sort.Slice in the sort package. Here is an <a href=\"https://golang.org/pkg/sort/#example_Slice\" rel=\"nofollow noreferrer\">example</a> of usage.</p>\n\n<p>For your particular problem, you have a slice a []Post, so just call sort.Slice on it like this:</p>\n\n<pre><code>sort.Slice(a, func(i, j int) bool { return a[i].title &lt; a[j].title })\n</code></pre>\n\n<p>This is just sorting all members of the slice a based on their title (assuming you can access this private field of a Post in this package, if not you'd need to add a function).</p>\n\n<p>If you do that your slice a of posts will be sorted by title (or any other criteria you wish, perhaps you could give the user a choice of title or date?). You don't need to adjust your markdown files.</p>\n\n<p>If you want to sort on dates obviously your Post should parse the dates with the time package first so that you have real dates, not just a string.</p>\n\n<p>So something like this (assuming time.Time on the Post):</p>\n\n<pre><code>// parse dates\ndate,err := time.Parse(\"2nd Jan 2006\",string(lines[1]))\nif err != nil {\n // deal with it\n}   \n\n// later, sort the slice \nsort.Slice(a, func(i, j int) bool { return a[i].date.Before(a[j].date)})\n</code></pre>\n"}], "owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513092264, "creation_date": 1509469874, "question_id": 47040938, "link": "https://stackoverflow.com/questions/47040938/go-lang-markdown-app", "title": "GO Lang markdown app", "body": "<p>I have a very simple markdown app in go which works great but I am really struggling to sort the order of the index posts on the page and would like a neat way in the file to do this. Any help appreciated.</p>\n\n<p>html is </p>\n\n<pre><code>&lt;section&gt;\n{{range .}}\n&lt;a href=\"/{{.File}}\"&gt;&lt;h2 class=\"h2_home\"&gt;{{.Title}} ({{.Date}})&lt;/h2&gt;&lt;/a&gt;\n&lt;p&gt;{{.Summary}}&lt;/p&gt;\n{{end}}\n &lt;/section&gt;\n</code></pre>\n\n<p>and the go stuff for the index page is as follows</p>\n\n<pre><code>func getPosts() []Post {\na := []Post{}\nfiles, _ := filepath.Glob(\"posts/*\")\nfor _, f := range files {\n    file := strings.Replace(f, \"posts/\", \"\", -1)\n    file = strings.Replace(file, \".md\", \"\", -1)\n    fileread, _ := ioutil.ReadFile(f)\n    lines := strings.Split(string(fileread), \"\\n\")\n    title := string(lines[0])\n    date := string(lines[1])\n    summary := string(lines[2])\n    body := strings.Join(lines[3:len(lines)], \"\\n\")\n    htmlBody := template.HTML(blackfriday.MarkdownCommon([]byte(body)))\n\n    a = append(a, Post{title, date, summary, htmlBody, file, nil})\n}\nreturn a\n}\n</code></pre>\n\n<p>Ive not looked at it for a while as it just works but I really want to put something into the file to support ordering. The .md file is formatted</p>\n\n<pre><code>Hello Go lang markdown blog generator!\n12th Jan 2015\nThis is a basic start to my own hosted go lang  markdown static blog/ web generator.\n### Here I am...\n\nThis entry is a no whistles Hello ... etc\n</code></pre>\n"}, {"tags": ["go", "reverse", "lychrel-numbers"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1509471016, "last_edit_date": 1509471016, "creation_date": 1509469847, "answer_id": 47040928, "question_id": 47040463, "link": "https://stackoverflow.com/questions/47040463/lychrel-numbers-in-go-with-the-big-library/47040928#47040928", "title": "Lychrel Numbers in Go with the big Library", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow noreferrer\">Package big</a></p>\n\n<pre><code>import \"math/big\"\n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/math/big/#NewInt\" rel=\"nofollow noreferrer\">func NewInt</a></p>\n\n<pre><code>func NewInt(x int64) *Int\n</code></pre>\n  \n  <p>NewInt allocates and returns a new Int set to x.</p>\n  \n  <p><a href=\"https://golang.org/pkg/math/big/#Int.Set\" rel=\"nofollow noreferrer\">func (*Int) Set</a></p>\n\n<pre><code>func (z *Int) Set(x *Int) *Int\n</code></pre>\n  \n  <p>Set sets z to x and returns z.</p>\n</blockquote>\n\n<p>You are assigning pointers, instead of values. </p>\n\n<pre><code>m = n\nnewNum := num\n</code></pre>\n\n<p>Assign values,</p>\n\n<pre><code>m = new(big.Int).Set(n)\nnewNum := new(big.Int).Set(num)\n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc reverse(n *big.Int) *big.Int {\n    var (\n        m   = new(big.Int).Set(n)\n        r   = big.NewInt(0)\n        z   = big.NewInt(0)\n        one = big.NewInt(1)\n        ten = big.NewInt(10)\n    )\n    for {\n        r.Mul(r, ten)\n        d := z\n        d.Mod(m, ten)\n        r.Add(r, d)\n        m.Div(m, ten)\n        if m.Cmp(one) == -1 {\n            return r\n        }\n    }\n}\n\nfunc radd(num *big.Int) *big.Int {\n    newNum := new(big.Int).Set(num)\n    rnum := reverse(num)\n    newNum = newNum.Add(num, rnum)\n    fmt.Println(num, \"+\", rnum, \"=\", newNum)\n    return newNum\n}\n\nfunc lychrel(arg int) bool {\n    fmt.Println(\"Now testing\", arg)\n    num := big.NewInt(int64(arg))\n    for i := 0; i &lt; 50; i++ {\n        num = radd(num)\n        fmt.Println(i, \":\", num)\n        if num.Cmp(reverse(num)) == 0 {\n            return false\n        }\n    }\n    return true\n}\n\nfunc main() {\n    lychrel(196)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Now testing 196\n196 + 691 = 887\n0 : 887\n. . .\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 8717377, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HDcftJbjIlk/AAAAAAAAAAI/AAAAAAAAAFY/z7rVkyIm27c/photo.jpg?sz=128", "display_name": "Bolce Bussiere", "link": "https://stackoverflow.com/users/8717377/bolce-bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 1, "accepted_answer_id": 47040928, "answer_count": 1, "score": 1, "last_activity_date": 1509471016, "creation_date": 1509468378, "question_id": 47040463, "link": "https://stackoverflow.com/questions/47040463/lychrel-numbers-in-go-with-the-big-library", "title": "Lychrel Numbers in Go with the big Library", "body": "<p>I'm trying to make a Lychrel number program in Go, but I'm running into some trouble. Using the \"math/big\" library, and with some extra print statements for debugging, my code looks like this:</p>\n\n<pre><code>func reverse(n *big.Int) *big.Int {\n    var (\n        m = n\n        r = big.NewInt(0)\n        z = big.NewInt(0)\n        one = big.NewInt(1)\n        ten = big.NewInt(10)\n        )\n    for {\n        r.Mul(r, ten)\n        d := z\n        d.Mod(m, ten)\n        r.Add(r, d)\n        m.Div(m, ten)\n        if m.Cmp(one) == -1 {\n            return r\n        }\n    }\n}\n\nfunc radd(num *big.Int) *big.Int {\n    newNum := num\n    rnum := reverse(num)\n    newNum = newNum.Add(num, rnum)\n    fmt.Println(num, \"+\", rnum, \"=\", newNum)\n\n    return newNum\n}\n\nfunc lychrel(arg int) bool {\n    fmt.Println(\"Now testing\", arg)\n    num := big.NewInt(int64(arg))\n    for i := 0; i &lt; 50; i++ {\n        num = radd(num)\n        fmt.Println(i, \":\", num)\n        if num.Cmp(reverse(num)) == 0 {\n            return false\n        }\n    }\n    return true\n}\n</code></pre>\n\n<p>While the analogous code without the big library works fine (save for eventual overflow errors), this version doesn't. When I do lychrel(196), for example, I get</p>\n\n<pre><code>Now testing 196\n691 + 691 = 691\n0 : 691\n0 + 0 = 0\n1 : 0\n</code></pre>\n\n<p>I can't figure out where it goes wrong. I hope I'm not missing something dumb, because I've spent all morning trying to get this to work.</p>\n"}, {"tags": ["c", "http", "go", "websocket", "grpc"], "owner": {"reputation": 404, "user_id": 6017902, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pVJYw.png?s=128&g=1", "display_name": "jwtea", "link": "https://stackoverflow.com/users/6017902/jwtea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 808, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1509533899, "creation_date": 1509461916, "last_edit_date": 1509533899, "question_id": 47038441, "link": "https://stackoverflow.com/questions/47038441/server-to-client-communication-grpc", "title": "Server to client communication gRpc", "body": "<p>i'm having a little trouble trying to come to a solution and was wondering if someone could point me in the right direction.</p>\n\n<p>I am implementing a system in which multiple clients are communicating with a server using gRpc.\nThe service is written in golang and the clients are written in C.</p>\n\n<p>I am trying to work out how to best handle communicating from the server to the client.</p>\n\n<p>The options which i have considered so far are:</p>\n\n<ol>\n<li><strong>Setup a server on each client</strong>\n\n<ul>\n<li>Considering there may be multiple clients operating from one external ip i'm not sure if it's possible to create a client listening to a combination of public ip, local ip and port ?</li>\n</ul></li>\n<li><strong>Use</strong> <a href=\"https://grpc.io/docs/guides/concepts.html#bidirectional-streaming-rpc\" rel=\"nofollow noreferrer\">bi-directional streaming</a>\n\n<ul>\n<li>This seems like the wrong application of the above, will you have to spawn a new process just to hold open a connection ?</li>\n</ul></li>\n<li><strong>Open a websocket alongside the gRpc service</strong>\n\n<ul>\n<li>I feel like this is not the right solution but seems to be the easiest out of the 3</li>\n</ul></li>\n</ol>\n\n<p>I am also not completely confident as to the required work to implement each of the above in C as it seems alot of helper functionality isn't included in C</p>\n\n<h1>Update:</h1>\n\n<p>So i have implemented a solution using a go client + server. Making use of the bi-directional rpc stream, </p>\n\n<h2>Server</h2>\n\n<ul>\n<li>Create a chan for each client that connects and store it in a map on the service</li>\n<li>Inside the stream method run a for \n\n<ul>\n<li>Check the chan for any messages and call stream.sen</li>\n<li>Remove the client chan if stream.Context().Err()</li>\n</ul></li>\n</ul>\n\n<h2>Client</h2>\n\n<ul>\n<li>Create a channel for the messages coming back from the stream method</li>\n<li>Start a goroutine calling stream.Recv on the stream service</li>\n</ul>\n\n<p>Is this a reasonable approach to keep a connection open to the connected clients? </p>\n"}, {"tags": ["go", "compiler-errors"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509460404, "post_id": 47037649, "comment_id": 81022283, "body": "There are no imports from gerrit in that repo. Are you sure all your sources are up to date? Your <code>go get -u</code> command has a newline before the package name; so if that actually is the command you&#39;re running, you&#39;re not updating the source."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1509460897, "post_id": 47037649, "comment_id": 81022631, "body": "BTW, if you look at the help output for the <code>get</code> command, there is an <code>-insecure</code> option to allow this, but it looks like it should work correctly in the first place."}, {"owner": {"reputation": 40610, "user_id": 67566, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/9d0Vk.jpg?s=128&g=1", "display_name": "James Black", "link": "https://stackoverflow.com/users/67566/james-black"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509461383, "post_id": 47037649, "comment_id": 81022995, "body": "@JimB - I put in the newline to make it more readable. I hate when I have to scroll right to see the line."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509461776, "post_id": 47037649, "comment_id": 81023260, "body": "Gotcha. Still, running <code>go get github.com&#47;hyperledger&#47;fabric&#47;core&#47;chaincode&#47;shim</code> works for me, so you must have something different in your code. Is it possible you have an <code>insteadOf</code> in your git config that is changing the URL?"}, {"owner": {"reputation": 40610, "user_id": 67566, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/9d0Vk.jpg?s=128&g=1", "display_name": "James Black", "link": "https://stackoverflow.com/users/67566/james-black"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509462285, "post_id": 47037649, "comment_id": 81023588, "body": "I will need to look at my Go setup. I can&#39;t find the protos/peer or shim so something is wrong in my setup.  Thank you very much.  The -insecure worked btw."}], "owner": {"reputation": 40610, "user_id": 67566, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/9d0Vk.jpg?s=128&g=1", "display_name": "James Black", "link": "https://stackoverflow.com/users/67566/james-black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1164, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1509459581, "creation_date": 1509459581, "question_id": 47037649, "link": "https://stackoverflow.com/questions/47037649/http-insecure-protocol-when-compiling-go-program-for-hyperledger", "title": "http insecure protocol when compiling Go program for hyperledger", "body": "<p>I am using</p>\n\n<pre><code>go version go1.9.1 windows/amd64\n</code></pre>\n\n<p>When I try to compile using:</p>\n\n<pre><code>go get -u --tags nopkcs11 \ngithub.com/hyperledger/fabric/core/chaincode/shim\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>package github.com/hyperledger/fabric/core/chaincode/shim: cannot download,\nhttp://gerrit.hyperledger.org/r/fabric uses insecure protocol\n</code></pre>\n\n<p>I can't change to <code>https://github.com/hyperledger/...</code> and https is not allowed.</p>\n\n<p>If you go to <a href=\"http://hyperledger-fabric.readthedocs.io/en/latest/chaincode4ade.html#choosing-a-location-for-the-code\" rel=\"nofollow noreferrer\">this source</a>  and go to <em>Pulling it all together</em>, you can see the source code I am using.</p>\n\n<p>This is the beginning of it.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/hyperledger/fabric/core/chaincode/shim\"\n    \"github.com/hyperledger/fabric/protos/peer\"\n)\n\n// SimpleAsset implements a simple chaincode to manage an asset\ntype Appointment struct {\n}\n\n// Init is called during chaincode instantiation to initialize any\n// data. Note that chaincode upgrade also calls this function to reset\n// or to migrate data.\nfunc (t *SimpleAsset) Init(stub shim.ChaincodeStubInterface) peer.Response {\n</code></pre>\n\n<p>How do I successfully compile my program?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1509459325, "post_id": 47037466, "comment_id": 81021511, "body": "If the time is parsed correctly, what is the problem you&#39;re having?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 5, "creation_date": 1509459331, "post_id": 47037466, "comment_id": 81021517, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9539108/obtaining-a-unix-timestamp-in-go-language-current-time-in-seconds-since-epoch\">Obtaining a Unix Timestamp in Go Language (current time in seconds since epoch)</a>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1509460596, "post_id": 47037466, "comment_id": 81022403, "body": "@Flimzy: It has to be an exact duplicate. It has to be correct. <code>int32(time.Now().Unix())</code> is a bug since <code>Unix()</code> returns <code>int64</code>. See <a href=\"https://en.wikipedia.org/wiki/Year_2038_problem\" rel=\"nofollow noreferrer\">Year 2038 problem</a>."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1509459330, "creation_date": 1509459330, "answer_id": 47037551, "question_id": 47037466, "link": "https://stackoverflow.com/questions/47037466/how-i-can-to-convert-rfc3339-to-unix-in-golang/47037551#47037551", "title": "How i can to convert RFC3339 to UNIX in golang", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    t, err := time.Parse(time.RFC3339, \"2012-11-01T22:08:41+00:00\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(t)\n    // Unix returns t as a Unix time,\n    // the number of seconds elapsed since January 1, 1970 UTC.\n    fmt.Println(t.Unix())\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/LG6G4lMIWt\" rel=\"nofollow noreferrer\">https://play.golang.org/p/LG6G4lMIWt</a></p>\n\n<p>Output:</p>\n\n<pre><code>2012-11-01 22:08:41 +0000 UTC\n1351807721\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 8861788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TYRNfEXvoNo/AAAAAAAAAAI/AAAAAAAAAx8/fTiREje269k/photo.jpg?sz=128", "display_name": "Ihor Bondartcov", "link": "https://stackoverflow.com/users/8861788/ihor-bondartcov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1909, "favorite_count": 1, "accepted_answer_id": 47037551, "answer_count": 1, "score": -3, "last_activity_date": 1509459330, "creation_date": 1509459040, "question_id": 47037466, "link": "https://stackoverflow.com/questions/47037466/how-i-can-to-convert-rfc3339-to-unix-in-golang", "title": "How i can to convert RFC3339 to UNIX in golang", "body": "<p>I want to show some RFC3339 time as seconds. I found how to parse times string, but it not that</p>\n\n<pre><code>t, _ := time.Parse(time.RFC3339, \"2012-11-01T22:08:41+00:00\") \n</code></pre>\n"}, {"tags": ["winapi", "go", "service"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1509459150, "post_id": 47036510, "comment_id": 81021378, "body": "<a href=\"https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/2bea77d5-52e3-4683-acac-1c28b2d9109f/changeserviceconfig2-failing-with-erroraccessdenied?forum=windowsgeneraldevelopmentissues\" rel=\"nofollow noreferrer\">this</a>? (And <a href=\"https://www.google.com/search?q=ChangeServiceConfig2+failure+action+access+denied\" rel=\"nofollow noreferrer\">this</a> in general)."}, {"owner": {"reputation": 19, "user_id": 5503807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89f6dca34a6ddb8fb35c2a0ebd004f6a?s=128&d=identicon&r=PG&f=1", "display_name": "bvk", "link": "https://stackoverflow.com/users/5503807/bvk"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1509459874, "post_id": 47036510, "comment_id": 81021929, "body": "I had already looked at the links you provided, but was unable to solve the problem. I am using CreateService and OpenProcess both with SERVICE_ALL_ACCESS access rights, and they don&#39;t give any error. I get  &quot;access denied&quot; when I use ChangeServiceConfig2 later for the same service."}], "answers": [{"tags": [], "owner": {"reputation": 172, "user_id": 6203942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046a03ed2aa00067b50a3a78a773dd1c?s=128&d=identicon&r=PG&f=1", "display_name": "grim.ub", "link": "https://stackoverflow.com/users/6203942/grim-ub"}, "is_accepted": false, "score": 0, "last_activity_date": 1579628906, "creation_date": 1579628906, "answer_id": 59846609, "question_id": 47036510, "link": "https://stackoverflow.com/questions/47036510/attempt-to-configure-failure-actions-of-a-windows-service-fails-with-access-deni/59846609#59846609", "title": "Attempt to configure failure actions of a Windows service fails with access denied error", "body": "<p>as mentioned here: \n<a href=\"https://groups.google.com/forum/#!topic/microsoft.public.win32.programmer.kernel/_McV5qokCR8\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/microsoft.public.win32.programmer.kernel/_McV5qokCR8</a></p>\n\n<p>...you need to enable SE_SHUTDOWN_NAME privilege.</p>\n\n<p>Credit goes to Alex Fedotov</p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 14089989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d6ad6af7932ff6803f1bc7c75a8239?s=128&d=identicon&r=PG&f=1", "display_name": "fmike7", "link": "https://stackoverflow.com/users/14089989/fmike7"}, "is_accepted": false, "score": 0, "last_activity_date": 1612242878, "creation_date": 1612242878, "answer_id": 66003979, "question_id": 47036510, "link": "https://stackoverflow.com/questions/47036510/attempt-to-configure-failure-actions-of-a-windows-service-fails-with-access-deni/66003979#66003979", "title": "Attempt to configure failure actions of a Windows service fails with access denied error", "body": "<p>Ran into this too recently. I was using SC_ACTION_RESTART as a type of action and SERVICE_CHANGE_CONFIG was not enough (ERROR_ACCESS_DENIED). Turned out you need to open the service handle with SERVICE_START access right.</p>\n"}], "owner": {"reputation": 19, "user_id": 5503807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89f6dca34a6ddb8fb35c2a0ebd004f6a?s=128&d=identicon&r=PG&f=1", "display_name": "bvk", "link": "https://stackoverflow.com/users/5503807/bvk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1612242878, "creation_date": 1509456071, "last_edit_date": 1509459211, "question_id": 47036510, "link": "https://stackoverflow.com/questions/47036510/attempt-to-configure-failure-actions-of-a-windows-service-fails-with-access-deni", "title": "Attempt to configure failure actions of a Windows service fails with access denied error", "body": "<p>I want to configure the failure actions for a service I have written in Go. \nI am following the answer posted at following page: \n<a href=\"https://stackoverflow.com/questions/35151052/how-do-i-configure-failure-actions-of-a-windows-service-written-in-go\">How do I configure failure actions of a Windows service written in Go?</a></p>\n\n<p>The function call ChangeServiceConfig2 returns \"Access is denied.\" error in my case (when the 2nd parameter is SERVICE_CONFIG_FAILURE_ACTIONS). </p>\n\n<p>I am running as Administrator so I don't understand why this function gives \"Access denied\" error. </p>\n\n<p>I can use the function ChangeServiceConfig2 to perform other actions (e.g. to set the start type for my service as Automatic Delayed, using 2nd parameter as SERVICE_CONFIG_DELAYED_AUTO_START_INFO). </p>\n\n<p>Has anyone had similar issue when using ChangeServiceConfig2 to set failure actions for a Windows service? What is the solution in that case? </p>\n"}, {"tags": ["go", "plugins"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509455054, "post_id": 47036042, "comment_id": 81018453, "body": "The linker sees an abi change. The modules are compared via a hash, so you only get to know that they don&#39;t match, but something was different between the two builds."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1509455219, "post_id": 47036042, "comment_id": 81018557, "body": "Also make sure you use the latest Go 1.9.2 for both compiling your plugin and your main app. In previous versions there was a bug (see <a href=\"https://github.com/golang/go/issues/20248\" rel=\"nofollow noreferrer\">go/issues/20248</a> for details)."}, {"owner": {"reputation": 303, "user_id": 2806281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L34mH.jpg?s=128&g=1", "display_name": "cnby", "link": "https://stackoverflow.com/users/2806281/cnby"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1509500664, "post_id": 47036042, "comment_id": 81041245, "body": "@icza I&#39;ve already updated my compiler version up to 1.9.2 and recompiled all code. Errors were still there..."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1509501651, "post_id": 47036042, "comment_id": 81041489, "body": "@Artish Then maybe you could post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 2806281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L34mH.jpg?s=128&g=1", "display_name": "cnby", "link": "https://stackoverflow.com/users/2806281/cnby"}, "edited": false, "score": 3, "creation_date": 1509502124, "post_id": 47036231, "comment_id": 81041598, "body": "Thanks for your answer @peterSO . Can you describe how to calculate <code>linktimehash</code>&amp;<code>runtimehash</code>?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1509455197, "creation_date": 1509455197, "answer_id": 47036231, "question_id": 47036042, "link": "https://stackoverflow.com/questions/47036042/how-does-golang-plugin-verify-version-of-packages/47036231#47036231", "title": "How does golang plugin verify version of packages?", "body": "<p><code>src/runtime/plugin.go</code>:</p>\n\n<pre><code>for _, pkghash := range md.pkghashes {\n    if pkghash.linktimehash != *pkghash.runtimehash {\n        md.bad = true\n        return \"\", nil, \"plugin was built with a different version of package \" + pkghash.modulename\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4719, "user_id": 6060774, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d51934aeeed54c14084d35942eb0b85e?s=128&d=identicon&r=PG&f=1", "display_name": "alexi2", "link": "https://stackoverflow.com/users/6060774/alexi2"}, "edited": false, "score": 0, "creation_date": 1584281217, "post_id": 60693055, "comment_id": 107382613, "body": "Hi there, it is important to add additional information that may be contained in the link. As linked answers do break over time. Thanks"}], "tags": [], "owner": {"reputation": 1, "user_id": 13065596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc40a126eb1a029e7f48c335c519a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Bal&#225;zs Grill", "link": "https://stackoverflow.com/users/13065596/bal%c3%a1zs-grill"}, "is_accepted": false, "score": 0, "last_activity_date": 1584276608, "creation_date": 1584276608, "answer_id": 60693055, "question_id": 47036042, "link": "https://stackoverflow.com/questions/47036042/how-does-golang-plugin-verify-version-of-packages/60693055#60693055", "title": "How does golang plugin verify version of packages?", "body": "<p>For future reference, these hashes are computed here: <a href=\"https://golang.org/src/cmd/link/internal/ld/lib.go?h=genhash#L807\" rel=\"nofollow noreferrer\">https://golang.org/src/cmd/link/internal/ld/lib.go?h=genhash#L807</a>\nIt seems it reads the binary output of the package, so anything can account into it which has any affect to the binary code.</p>\n"}], "owner": {"reputation": 303, "user_id": 2806281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L34mH.jpg?s=128&g=1", "display_name": "cnby", "link": "https://stackoverflow.com/users/2806281/cnby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1065, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1584276608, "creation_date": 1509454669, "question_id": 47036042, "link": "https://stackoverflow.com/questions/47036042/how-does-golang-plugin-verify-version-of-packages", "title": "How does golang plugin verify version of packages?", "body": "<p>I'm trying to use golang plugin and always get runtime error when calling <code>plugin.Open</code>.</p>\n\n<p><code>plugin.Open: plugin was built with a different version of package</code></p>\n\n<p>I'm sure the plugin was build with same code. Now I'm totally confused by the error message.</p>\n\n<p>How does these verify mechanism work ? </p>\n"}, {"tags": ["go", "http-headers", "last-modified"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1538986207, "last_edit_date": 1538986207, "creation_date": 1509446542, "answer_id": 47033372, "question_id": 47033156, "link": "https://stackoverflow.com/questions/47033156/overriding-last-modified-header-in-http-fileserver/47033372#47033372", "title": "Overriding Last-Modified header in http.FileServer", "body": "<p>The handler returned by <a href=\"https://golang.org/pkg/net/http/#FileServer\" rel=\"nofollow noreferrer\"><code>http.FileServer()</code></a> unconditionally sets the <code>\"Last-Modified\"</code> header in the <code>http.serveFile()</code> and <code>http.serveContent()</code> unexported functions:</p>\n\n<pre><code>func serveFile(w ResponseWriter, r *Request, fs FileSystem,\n    name string, redirect bool) {\n\n    // ...\n    f, err := fs.Open(name)\n    // ...\n    d, err := f.Stat()\n    // ...\n\n    // serveContent will check modification time\n    sizeFunc := func() (int64, error) { return d.Size(), nil }\n    serveContent(w, r, d.Name(), d.ModTime(), sizeFunc, f)\n}\n\nfunc serveContent(w ResponseWriter, r *Request, name string, modtime time.Time,\n    sizeFunc func() (int64, error), content io.ReadSeeker) {\n    setLastModified(w, modtime)\n    // ...\n}\n\n\nfunc setLastModified(w ResponseWriter, modtime time.Time) {\n    if !isZeroTime(modtime) {\n        w.Header().Set(\"Last-Modified\", modtime.UTC().Format(TimeFormat))\n    }\n}\n</code></pre>\n\n<p>So what you set prior to calling the file server handler will get overwritten. You can't really do anything about this.</p>\n\n<p>If you need to serve the content of a file with custom last-modified time, you may use <a href=\"https://golang.org/pkg/net/http/#ServeContent\" rel=\"nofollow noreferrer\"><code>http.ServeContent()</code></a>:</p>\n\n<pre><code>func ServeContent(w ResponseWriter, req *Request, name string,\n    modtime time.Time, content io.ReadSeeker)\n</code></pre>\n\n<p>Where you can pass the last-modified time to be used, but then of course you lose all the convenient features provided by <code>http.FileServer()</code>.</p>\n\n<p>If you want to keep using <code>http.FileServer()</code>, another option would be to not use the <a href=\"https://golang.org/pkg/net/http/#Dir\" rel=\"nofollow noreferrer\"><code>http.Dir</code></a> type, but create your own <a href=\"https://golang.org/pkg/net/http/#FileSystem\" rel=\"nofollow noreferrer\"><code>http.FileSystem</code></a> implementation that you pass to <code>http.FileServer()</code>, in which you could report any last-modified timestamp you wish.</p>\n\n<p>This would require you to implement the following interface:</p>\n\n<pre><code>type FileSystem interface {\n        Open(name string) (File, error)\n}\n</code></pre>\n\n<p>So you need a method which opens a file by its name, and returns a value which implements <a href=\"https://golang.org/pkg/net/http/#File\" rel=\"nofollow noreferrer\"><code>http.File</code></a>, which is:</p>\n\n<pre><code>type File interface {\n        io.Closer\n        io.Reader\n        io.Seeker\n        Readdir(count int) ([]os.FileInfo, error)\n        Stat() (os.FileInfo, error)\n}\n</code></pre>\n\n<p>And the value you return (that implements <code>http.File</code>) could have a <code>Stat() (os.FileInfo, error)</code> method implementation, whose <a href=\"https://golang.org/pkg/os/#FileInfo\" rel=\"nofollow noreferrer\"><code>os.FileInfo</code></a> returned value contains the last-modified time of your choosing. Note that you should also implement the <code>Readdir()</code> method to return custom last-modified timestamps consistent with the timestamps returned by <code>Stat()</code>'s fileinfo. See related question how to do that: <a href=\"https://stackoverflow.com/questions/52697277/simples-way-to-make-a-byte-into-a-virtual-file-object-in-golang/52697900#52697900\">Simples way to make a []byte into a &quot;virtual&quot; File object in golang?</a></p>\n"}], "owner": {"reputation": 1818, "user_id": 2171758, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/0pO0W.jpg?s=128&g=1", "display_name": "salient", "link": "https://stackoverflow.com/users/2171758/salient"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1836, "favorite_count": 0, "accepted_answer_id": 47033372, "answer_count": 1, "score": 3, "last_activity_date": 1538986207, "creation_date": 1509445941, "last_edit_date": 1509446987, "question_id": 47033156, "link": "https://stackoverflow.com/questions/47033156/overriding-last-modified-header-in-http-fileserver", "title": "Overriding Last-Modified header in http.FileServer", "body": "<p>I'm trying to override the <code>Last-Modified</code>-header set by <code>http.FileServer</code>, but it reverts to the <code>Last-Modified</code>-time of the file I'm trying to serve:</p>\n\n<pre><code>var myTime time.Time\n\nfunc main() {\n     myTime = time.Now()         \n\n     fs := http.StripPrefix(\"/folder/\", SetCacheHeader(http.FileServer(http.Dir(\"/folder/\"))))\n     http.Handle(\"/folder/\", fs)\n     http.ListenAndServe(\":80\", nil)\n}\n</code></pre>\n\n<p>My <code>SetCacheHeader</code>-handler:</p>\n\n<pre><code>func SetCacheHeader(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Last-Modified\", myTime.Format(http.TimeFormat))\n        h.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-dynamodb"], "comments": [{"owner": {"reputation": 29341, "user_id": 6337748, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/7Si7m.jpg?s=128&g=1", "display_name": "notionquest", "link": "https://stackoverflow.com/users/6337748/notionquest"}, "edited": false, "score": 0, "creation_date": 1509445977, "post_id": 47032502, "comment_id": 81012695, "body": "DynamoDB is eventually consistent. You can try by introducing some delay between update and read."}, {"owner": {"reputation": 41, "user_id": 1805658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c6371914e93520c30a30ded29e05f1?s=128&d=identicon&r=PG", "display_name": "DSuhinin", "link": "https://stackoverflow.com/users/1805658/dsuhinin"}, "reply_to_user": {"reputation": 29341, "user_id": 6337748, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/7Si7m.jpg?s=128&g=1", "display_name": "notionquest", "link": "https://stackoverflow.com/users/6337748/notionquest"}, "edited": false, "score": 0, "creation_date": 1509453957, "post_id": 47032502, "comment_id": 81017718, "body": "but it isn&#39;t workable way to solve this situation correctly. Load tests can&#39;t work this way, because in this case it ins&#39;t the load tests =((."}], "answers": [{"tags": [], "owner": {"reputation": 1541, "user_id": 2232135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7swMf.png?s=128&g=1", "display_name": "smcstewart", "link": "https://stackoverflow.com/users/2232135/smcstewart"}, "is_accepted": false, "score": 1, "last_activity_date": 1509785790, "creation_date": 1509785790, "answer_id": 47109085, "question_id": 47032502, "link": "https://stackoverflow.com/questions/47032502/dynamodb-consistentread-for-global-indexes/47109085#47109085", "title": "DynamoDB ConsistentRead for Global Indexes", "body": "<p>GSIs are updated asynchronously from the table they are indexing. The updates to a GSI typically occur in well under a second. So, if you're after immediate read of a GSI after insert / update / delete, then there is the potential to get stale data. This is how GSIs work - nothing you can do about that. However, you need to be really mindful of three things:</p>\n\n<ol>\n<li>Make sure you keep your GSI lean - that is, only project the absolute minimum attributes that you need. Less data to write will make it quicker.</li>\n<li>Ensure that your GSIs have the correct provisioned throughput. If it doesn't, it may not be able to keep up with activity in the table and therefore you'll get long delays in the GSI being kept in sync.</li>\n<li>If an update causes the keys in the GSI to be updated, you'll need 2 units of throughput provisioned per update. In essence, DynamoDB will delete the item then insert a new item with the keys updated. So, even though your table has 100 provisioned writes, if every single write causes an update to your GSI key, you'll need to provision 200 write units.</li>\n</ol>\n\n<p>Once you've tuned your DynamoDB setup and you still absolutely cannot handle the brief delay in GSIs, you'll probably need to use different technology. For example, even if you decided to split your table into multiple tables, it'll have the same (if not worse) impact. You'll update one table, then try to read the data from another table and you haven't yet inserted the values into a different table.</p>\n\n<p>I suspect that once you tune DynamoDB for your situation, you'll get pretty damn close you what you want.</p>\n"}], "owner": {"reputation": 41, "user_id": 1805658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c6371914e93520c30a30ded29e05f1?s=128&d=identicon&r=PG", "display_name": "DSuhinin", "link": "https://stackoverflow.com/users/1805658/dsuhinin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 687, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509785790, "creation_date": 1509443959, "question_id": 47032502, "link": "https://stackoverflow.com/questions/47032502/dynamodb-consistentread-for-global-indexes", "title": "DynamoDB ConsistentRead for Global Indexes", "body": "<p>I have next table structure:</p>\n\n<pre><code>ID              string    `dynamodbav:\"id,omitempty\"`\nType            string    `dynamodbav:\"type,omitempty\"`\nValue           string    `dynamodbav:\"value,omitempty\"`\nToken           string    `dynamodbav:\"token,omitempty\"`\nStatus          int       `dynamodbav:\"status,omitempty\"`\nActionID        string    `dynamodbav:\"action_id,omitempty\"`\nCreatedAt       time.Time `dynamodbav:\"created_at,omitempty\"`\nUpdatedAt       time.Time `dynamodbav:\"updated_at,omitempty\"`\nValidationToken string    `dynamodbav:\"validation_token,omitempty\"`\n</code></pre>\n\n<p>and I have 2 Global Secondary Indexes for Value(ValueIndex) filed and Token(TokenIndex) field. Later somewhere in the internal logic I perform the Update of this entity and immediate read of this entity by one of this indexes(ValueIndex or TokenIndex) and I see the expected problem that data is not ready(I mean not yet updated). I can't use ConsistentRead for this cases, because this is Global Secondary Index and it doesn't support this options. As a result I can't run my load tests over this logic, because data is not ready when tests go in 10-20-30 threads. So my question - is it possible to solve this problem somewhere? or should I reorganize my table and split it to 2-3 different tables and move filed like Value, Token to HASH key or SORT key?</p>\n"}, {"tags": ["go", "plugins", "lookup"], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 2806281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L34mH.jpg?s=128&g=1", "display_name": "cnby", "link": "https://stackoverflow.com/users/2806281/cnby"}, "edited": false, "score": 0, "creation_date": 1509505980, "post_id": 47032851, "comment_id": 81042562, "body": "Thanks @icza, this is what I need."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1509447255, "last_edit_date": 1509447255, "creation_date": 1509444994, "answer_id": 47032851, "question_id": 47031958, "link": "https://stackoverflow.com/questions/47031958/golang-export-all-symbols-from-a-plugin/47032851#47032851", "title": "golang export all symbols from a plugin", "body": "<p>The current plugin API of Go does not support discovering and using unknown plugins. You have to <em>know</em> the plugin and <em>know what to expect</em> from it (including the types of exported symbols).</p>\n\n<p>One day there might be additions to the API for what you're looking, but for now (Go 1.9.2) you're stuck with <a href=\"https://golang.org/pkg/plugin/#Plugin.Lookup\" rel=\"nofollow noreferrer\"><code>Plugin.Lookup()</code></a> only.</p>\n\n<h2>\"Hack\" to peek at exported symbols</h2>\n\n<p>A loaded plugin is represented by a value of type <a href=\"https://golang.org/pkg/plugin/#Plugin\" rel=\"nofollow noreferrer\"><code>*plugin.Plugin</code></a>. This is a pointer to a struct which contains the symbol table, but it's not exported. If you want to take a \"peek\" at what symbols are exported, you may use the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code></a> package to print it.</p>\n\n<p>I will use the plugin example from this answer: <a href=\"https://stackoverflow.com/questions/42388090/go-1-8-plugin-use-custom-interface/42389345#42389345\">go 1.8 plugin use custom interface</a>, which is:</p>\n\n<pre><code>type plgFilter struct{}\n\nfunc (plgFilter) Name() string { return \"Bob\" }\nfunc (plgFilter) Age() int     { return 23 }\n\nfunc GetFilter() (f filter.Filter, err error) {\n    f = plgFilter{}\n    fmt.Printf(\"[plugin GetFilter] Returning filter: %T %v\\n\", f, f)\n    return\n}\n</code></pre>\n\n<p>It contains a single exported symbol: the <code>GetFilter</code> function. Loading and printing the symbol table of this plugin:</p>\n\n<pre><code>p, err := plugin.Open(\"pg/pg.so\")\nif err != nil {\n    panic(err)\n}\n\nfmt.Printf(\"%+v\\n\", p)\n</code></pre>\n\n<p>We can \"observe\" the exported <code>GetFilter</code> symbol in the output:</p>\n\n<pre><code>&amp;{pluginpath:pg loaded:0xc420020120 syms:map[GetFilter:0x7f0a7fddc860]}\n</code></pre>\n\n<p>The associated value for this symbol is a memory address, not really talkative.</p>\n\n<p>But we can do more: we can use package <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a> to print its type after we looked it up:</p>\n\n<pre><code>GetFilter, err := p.Lookup(\"GetFilter\")\nif err != nil {\n    panic(err)\n}\n\nfmt.Println(reflect.TypeOf(GetFilter))\n</code></pre>\n\n<p>And now we'll see:</p>\n\n<pre><code>func() (filter.Filter, error)\n</code></pre>\n\n<p>We see it's a function which has 2 return types: <code>filter.Filter</code> and <code>error</code>.</p>\n"}], "owner": {"reputation": 303, "user_id": 2806281, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L34mH.jpg?s=128&g=1", "display_name": "cnby", "link": "https://stackoverflow.com/users/2806281/cnby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1318, "favorite_count": 1, "accepted_answer_id": 47032851, "answer_count": 1, "score": 2, "last_activity_date": 1509447255, "creation_date": 1509442161, "question_id": 47031958, "link": "https://stackoverflow.com/questions/47031958/golang-export-all-symbols-from-a-plugin", "title": "golang export all symbols from a plugin", "body": "<p>Golang plugin pkg only support Lookup a symbol by name.</p>\n\n<p>How can I scan all symbols and its type in a plugin?</p>\n\n<p><a href=\"https://golang.org/pkg/plugin/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/plugin/</a></p>\n"}, {"tags": ["firebase", "go"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1509442875, "post_id": 47031922, "comment_id": 81010728, "body": "try <a href=\"https://firebase.google.com/docs/admin/setup#add_firebase_to_your_app\" rel=\"nofollow noreferrer\">firebase.google.com/docs/admin/setup#add_firebase_to_your_ap&zwnj;&#8203;p</a>"}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 3416332, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000295097055/picture?type=large", "display_name": "Kirikami", "link": "https://stackoverflow.com/users/3416332/kirikami"}, "is_accepted": true, "score": 1, "last_activity_date": 1509443621, "creation_date": 1509443621, "answer_id": 47032381, "question_id": 47031922, "link": "https://stackoverflow.com/questions/47031922/error-initialising-firebase-in-golang-app/47032381#47032381", "title": "Error initialising firebase in golang app", "body": "<p>The problem in <code>opt = option.WithCredentialsFile(viper.GetString(\"firebase\"))</code>\nIt couldn't find the path to your config file. Try to use path to file and then find how to add it via viper</p>\n"}], "owner": {"reputation": 1037, "user_id": 662194, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/60c78c8f30fa96b0251a45f62c554885?s=128&d=identicon&r=PG", "display_name": "Kanishka", "link": "https://stackoverflow.com/users/662194/kanishka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 47032381, "answer_count": 1, "score": 0, "last_activity_date": 1509443621, "creation_date": 1509442054, "question_id": 47031922, "link": "https://stackoverflow.com/questions/47031922/error-initialising-firebase-in-golang-app", "title": "Error initialising firebase in golang app", "body": "<p>I am using firebase go sdk (<a href=\"https://github.com/acoshift/go-firebase-admin\" rel=\"nofollow noreferrer\">https://github.com/acoshift/go-firebase-admin</a>) and have followed the docs to set up my app. </p>\n\n<p>But when I try to initialize the app with <code>firebase.NewApp</code> I get an error saying </p>\n\n<blockquote>\n  <p>google: could not find default credentials.</p>\n</blockquote>\n\n<p>Can someone please help</p>\n\n<p>Here is the code snippet</p>\n\n<pre><code>opt = option.WithCredentialsFile(viper.GetString(\"firebase\"))\napp, err = firebase.NewApp(context.Background(), nil, opt)\nif err != nil {\n    log.Fatalf(\"error initializing app: %v\\n\", err)\n}\n</code></pre>\n"}, {"tags": ["ssl", "go", "x509"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 2, "creation_date": 1509445553, "post_id": 47031558, "comment_id": 81012455, "body": "Fix the server."}], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1509538909, "post_id": 47032565, "comment_id": 81056265, "body": "Just be aware that this increases risk. The point of intermediates is that the CA can revoke them if they are compromised, but this host would continue to trust it (and considering that we are talking about Symantec here that is not even unlikely). You should fix the server, or let the admins know that the chain is broken if you can&#39;t do it yourself."}, {"owner": {"reputation": 276701, "user_id": 6521, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6af19633ae0228e3b5bb4de168b5d19d?s=128&d=identicon&r=PG", "display_name": "Paul Dixon", "link": "https://stackoverflow.com/users/6521/paul-dixon"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1509567067, "post_id": 47032565, "comment_id": 81073918, "body": "That&#39;s a good point - this was a situation where a short term fix was necessary on the client side while the the remote server was fixed (which was out of our control)"}], "tags": [], "owner": {"reputation": 276701, "user_id": 6521, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6af19633ae0228e3b5bb4de168b5d19d?s=128&d=identicon&r=PG", "display_name": "Paul Dixon", "link": "https://stackoverflow.com/users/6521/paul-dixon"}, "is_accepted": true, "score": 3, "last_activity_date": 1509445875, "last_edit_date": 1509445875, "creation_date": 1509444150, "answer_id": 47032565, "question_id": 47031558, "link": "https://stackoverflow.com/questions/47031558/how-to-perform-https-request-with-go-against-incomplete-tls-certificate/47032565#47032565", "title": "How to perform https request with go against incomplete TLS certificate?", "body": "<p>To resolve this, I just updated the system certificate store on the client to include the missing intermediate certificate.</p>\n\n<p>The client was running on an Ubuntu based server, so this fixed the issue:</p>\n\n<pre><code>#download certificate\ncd /usr/local/share/ca-certificates\ncurl -O https://symantec.tbs-certificats.com/SymantecSSG4.crt\n\n#dump the fingerprint\nopenssl x509 -noout -fingerprint -sha256 -inform pem -in SymantecSSG4.crt \n</code></pre>\n\n<p>I checked the output matched the fingerprint the test tool reported I was missing:</p>\n\n<pre><code>SHA256 Fingerprint=EA:E7:2E:B4:54:BF:6C:39:77:EB:D2:89:E9:70:B2:F5:28:29:49:19:00:93:D0:D2:6F:98:D0:F0:D6:A9:CF:17\n</code></pre>\n\n<p>Then I updated the certificate store with this:</p>\n\n<pre><code>update-ca-certificates\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 12864944, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPEtJ.png?s=128&g=1", "display_name": "fcjr", "link": "https://stackoverflow.com/users/12864944/fcjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1581396836, "last_edit_date": 1581396836, "creation_date": 1581199127, "answer_id": 60131583, "question_id": 47031558, "link": "https://stackoverflow.com/questions/47031558/how-to-perform-https-request-with-go-against-incomplete-tls-certificate/60131583#60131583", "title": "How to perform https request with go against incomplete TLS certificate?", "body": "<p>I recently had a need for this and thought I would share my solution here.  The reason browsers like Chrome can handle this is because they support the AIA extension of X.509, which provides the url to download a given certificates issuing certificate. Chrome then adds the issuing certificate to the chain and retries validation, walking up the path until it runs out of certificates or finds one issued by an approved root CA.</p>\n\n<p>I've made a little library to support this in go.  You can find it here: <a href=\"https://github.com/fcjr/aia-transport-go\" rel=\"nofollow noreferrer\">https://github.com/fcjr/aia-transport-go</a></p>\n\n<p>Usage is as simple as using the provided custom configured http.Transport:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n\n    \"github.com/fcjr/aia-transport-go\"\n)\n\nfunc main() {\n    tr, err := aia.NewTransport()\n    if err != nil {\n        log.Fatal(err)\n    }\n    client := http.Client{\n        Transport: tr,\n    }\n    res, err := client.Get(\"https://incomplete-chain.badssl.com/\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(res.Status)\n}\n</code></pre>\n"}], "owner": {"reputation": 276701, "user_id": 6521, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6af19633ae0228e3b5bb4de168b5d19d?s=128&d=identicon&r=PG", "display_name": "Paul Dixon", "link": "https://stackoverflow.com/users/6521/paul-dixon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 0, "accepted_answer_id": 47032565, "answer_count": 2, "score": 6, "last_activity_date": 1581396836, "creation_date": 1509440773, "last_edit_date": 1509455498, "question_id": 47031558, "link": "https://stackoverflow.com/questions/47031558/how-to-perform-https-request-with-go-against-incomplete-tls-certificate", "title": "How to perform https request with go against incomplete TLS certificate?", "body": "<p>I'm trying to make an https request in go against a URL which has an incomplete TLS certificate chain. Here's the relevant portion from the <a href=\"https://www.ssllabs.com/ssltest/analyze.html\" rel=\"nofollow noreferrer\">Qualys test tool</a>, which shows the certificate chain is missing <em>\"Symantec Class 3 Secure Server CA - G4\"</em> :</p>\n\n<p><a href=\"https://i.stack.imgur.com/Xkh90.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xkh90.png\" alt=\"SSL report screengrab\"></a></p>\n\n<p>Most browsers do cope with this, presumably because they have the Symantec cert preloaded? A simple golang example, however, will fail with the error <code>x509: certificate signed by unknown authority</code></p>\n\n<pre><code>package main\n\nimport (\n\"log\"\n\"net/http\"\n)\n\nfunc main() {\n\n    _, err := http.Get(\"https://www.example.com/\")\n    if err != nil {\n        log.Fatal(err)\n    } else {\n        log.Println(\"Success!\") \n    }\n}\n</code></pre>\n\n<p>I've notified the site in question, but <strong>is there a way I can insert the missing certificate into the certificate store go is using</strong>? </p>\n"}, {"tags": ["post", "go", "net-http"], "comments": [{"owner": {"reputation": 663, "user_id": 1736000, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bKynP.jpg?s=128&g=1", "display_name": "KorbenDallas", "link": "https://stackoverflow.com/users/1736000/korbendallas"}, "edited": false, "score": 1, "creation_date": 1509439039, "post_id": 47030937, "comment_id": 81008413, "body": "Did you also check your server? It can have limits also on receiving requests."}, {"owner": {"reputation": 33, "user_id": 7446098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/964e1cacb8a793a33fd0ba517bc338e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mudit", "link": "https://stackoverflow.com/users/7446098/mudit"}, "reply_to_user": {"reputation": 663, "user_id": 1736000, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bKynP.jpg?s=128&g=1", "display_name": "KorbenDallas", "link": "https://stackoverflow.com/users/1736000/korbendallas"}, "edited": false, "score": 0, "creation_date": 1509439375, "post_id": 47030937, "comment_id": 81008591, "body": "@KorbenDallas server is fine , I have already checked it ."}, {"owner": {"reputation": 663, "user_id": 1736000, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bKynP.jpg?s=128&g=1", "display_name": "KorbenDallas", "link": "https://stackoverflow.com/users/1736000/korbendallas"}, "edited": false, "score": 0, "creation_date": 1509483442, "post_id": 47030937, "comment_id": 81036162, "body": "How did you checked it? Did you try to download GIF directly to server without GO with <code>scp</code> for example?"}], "owner": {"reputation": 33, "user_id": 7446098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/964e1cacb8a793a33fd0ba517bc338e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mudit", "link": "https://stackoverflow.com/users/7446098/mudit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1509438742, "creation_date": 1509438742, "question_id": 47030937, "link": "https://stackoverflow.com/questions/47030937/http-post-request-taking-lot-of-time-to-complete-net-http-go", "title": "Http POST request taking lot of time to complete - net/http - Go", "body": "<p>I am using net/http in Go, and one of my HTTPS POST request is taking lot of time like approx 16 seconds to complete . Though the backend server processing is only taking 2.2 seconds but over all process (when the response is received from the REST API after full processing ) is like 16 seconds .</p>\n\n<p>My call looks like :</p>\n\n<pre><code>https://xxxxx.com/abcded\n</code></pre>\n\n<p>And the body has a JSON which contains a GIF file base64 of size approx 1.68 MB</p>\n\n<pre><code>{\n  \"username\": \"test\",\n  \"update_username\": \"0\",\n  \"name\": \"test name\",\n  \"isprivate\": \"0\",\n  \"avatar_url\": \"\",\n  \"description\": \"I am Test , updated using api \",\n  \"location\": \"test world\",\n  \"phone\": \"12345678\",\n  \"age\": \"23\",\n  \"gender\": \"m\",\n  \"update_profilepic\": \"1\",\n  \"profilepic_lat\": \"28.593\",\n  \"profilepic_lon\": \"77.1981\",\n  \"profilepic_height\": \"480\",\n  \"profilepic_width\": \"480\",\n  \"profilepic_type\": \"photo\",\n  \"profilepic\": \"Dummy String due to Size Constraint in StackOverFlow\"\n}\n</code></pre>\n\n<p>Details :</p>\n\n<p>The POST request was invoked from the client (Postman) at 16:59:00.100 But the server recieves the call at 16:59:13.240 (which is shown in the Server logs below) . And finally the server does all the processing and responds back at 16:59:15.073 . And finally I recieved the response code at the client (Postman) at 16:59:15.773</p>\n\n<pre><code>Server Logs Start *****************************************\n\n16:59:13.240\nJust Entered into AUTHENTICATION method\n16:59:13.246\n--------------In Profile Related--------------\n16:59:13.246\n--------------In Edit Setting--------------\n16:59:13.363\n---------- In Edit Setting --------\n16:59:13.363\nUsername direct rcvd :%!(EXTRA string=morninglad)\n16:59:13.363\nUsername rcvd :%!(EXTRA string=morninglad)\n16:59:13.363\nName rcvd :%!(EXTRA string=morning)\n16:59:13.363\nUpdate NON USER NAME UPDATE FLAG RCVD\n16:59:13.363\nAbout to call Update Query\n16:59:13.374\nAbout to Update the Profile Pic as found the flag\n16:59:13.374\nUpdating the Profile Pic------------\n16:59:14.906\nAbout to Insert Media into DB\n16:59:14.906\nGot the GeoHash :%!(EXTRA string=ttnc9j3tgujw)\n16:59:14.952\nFound location :%!(EXTRA string=Gurugram)\n16:59:14.955\nMedia Play value is :%!(EXTRA string=)\n16:59:14.955\nUsername :%!(EXTRA string=morninglad)\n16:59:14.983\nUpdating the Profile Pic Done ------------\n16:59:14.983\nProfile Pic Updated !\n16:59:15.041\n-------------------Fetch Avatars-----------------\n16:59:15.073\nThe Avatar URL got :Avatar1\n16:59:15.073\nThe Avatar URL got : Avatar2\n16:59:15.073\n---------- In Edit Setting DONE - END --------\n16:59:15.073\n--------------Response SENT--------------\n\nServer Logs End *****************************************\n</code></pre>\n\n<p>So if I go by the above mentioned timestamps ,then time to reach to server was almost 13 seconds , and the total processing time of server was about 2 seconds . And finally recieved the response code in within 1 second.So total time is like 16 seconds for this call.</p>\n\n<p>So I was trying to figure out why the call to reach to server is taking 13 seconds ?</p>\n\n<p>When I am invoking the same call with the smaller body i.e instead of GIF of 1.68 MB to JPEG of 1.4 KB the total time is like 2.2 seconds . So shall I assume that this body size is the reason for increased time ?</p>\n\n<p>But with the kind of internet I am working on (Download speed - 72.33 Mbps and Upload Speed - 6.07 Mbps)this sounds weird .</p>\n\n<p>Any pointer if I am doing something wrong over here ?</p>\n"}, {"tags": ["mysql", "database", "go", "database-migration"], "answers": [{"comments": [{"owner": {"reputation": 627, "user_id": 4689430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SJU8y.png?s=128&g=1", "display_name": "elixir", "link": "https://stackoverflow.com/users/4689430/elixir"}, "edited": false, "score": 0, "creation_date": 1509450878, "post_id": 47030398, "comment_id": 81015648, "body": "Thanks for the prompt suggestion. I&#39;m not using Docker. Can you suggest how to use go-bindata incase of goose? I&#39;m a bit lost with its documentation."}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 627, "user_id": 4689430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SJU8y.png?s=128&g=1", "display_name": "elixir", "link": "https://stackoverflow.com/users/4689430/elixir"}, "edited": false, "score": 0, "creation_date": 1509451019, "post_id": 47030398, "comment_id": 81015760, "body": "I looked at goose. It seems to be providing a convenient way to build migrations."}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1509436629, "creation_date": 1509436629, "answer_id": 47030398, "question_id": 47030199, "link": "https://stackoverflow.com/questions/47030199/how-to-bind-migrations-with-executable/47030398#47030398", "title": "How to bind migrations with executable", "body": "<p>If you use Docker you may put folder to the image.</p>\n\n<p>If not projects like <a href=\"https://github.com/rakyll/statik\" rel=\"nofollow noreferrer\">https://github.com/rakyll/statik</a> or <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">https://github.com/jteeuwen/go-bindata</a> can help.</p>\n"}, {"tags": [], "owner": {"reputation": 1730, "user_id": 573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a286a392ecc96e9cb40c03134b96841?s=128&d=identicon&r=PG", "display_name": "bosgood", "link": "https://stackoverflow.com/users/573791/bosgood"}, "is_accepted": false, "score": 1, "last_activity_date": 1509464006, "creation_date": 1509464006, "answer_id": 47039136, "question_id": 47030199, "link": "https://stackoverflow.com/questions/47030199/how-to-bind-migrations-with-executable/47039136#47039136", "title": "How to bind migrations with executable", "body": "<p>If you're already using Goose, one option would be to write the migrations in Go instead of SQL. Based on the <a href=\"https://github.com/pressly/goose/tree/master/examples/go-migrations\" rel=\"nofollow noreferrer\">Go migrations example</a> in the Goose repo, when you build the <code>goose</code> binary here, it will bundle all the <code>*.go</code> ones into the binary.</p>\n\n<p>This was the output after I built the example and removed all files except the binary itself. The Go-based migration was embedded:</p>\n\n<pre><code>2017/10/31 11:22:31     Applied At                  Migration\n2017/10/31 11:22:31     =======================================\n2017/10/31 11:22:31     Mon Jun 19 21:56:00 2017 -- 00002_rename_root.go\n</code></pre>\n\n<p>If you're looking to use SQL-based migrations but don't want to take on additional dependencies, you could embed your SQL-based migrations into <code>*.go</code> files as string constants, then, starting from the <code>go-migrations</code> example, add an init phase to <code>main.go</code> that writes them out to the current directory before proceeding.</p>\n"}, {"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 2, "last_activity_date": 1509521204, "creation_date": 1509521204, "answer_id": 47050074, "question_id": 47030199, "link": "https://stackoverflow.com/questions/47030199/how-to-bind-migrations-with-executable/47050074#47050074", "title": "How to bind migrations with executable", "body": "<h2>How to get a single file which can migrate database and work</h2>\n\n<ol>\n<li><p>Install</p>\n\n<pre><code>go get -u github.com/pressly/goose/cmd/goose\n</code></pre></li>\n<li><p>Make app. I base it on example<code>main.go</code> and add <code>run</code> option. Suppose your project is located at <code>github.com/user/project</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"flag\"\n    \"log\"\n    \"os\"\n\n    \"github.com/pressly/goose\"\n\n    // Init DB drivers. -- here I recommend remove unnecessary - but it's up to you\n    _ \"github.com/go-sql-driver/mysql\"\n    _ \"github.com/lib/pq\"\n    _ \"github.com/mattn/go-sqlite3\"\n    _ \"github.com/ziutek/mymysql/godrv\"\n\n    // here our migrations will live  -- use your path \n    _ \"github.com/user/project/migrations\"\n)\n\nvar (\n    flags = flag.NewFlagSet(\"goose\", flag.ExitOnError)\n    dir   = flags.String(\"dir\", \".\", \"directory with migration files\")\n)\n\nfunc main() {\n    flags.Usage = usage\n    flags.Parse(os.Args[1:])\n\n    args := flags.Args()\n\n    //////\n    if len(args) &gt; 1 &amp;&amp; args[0] == \"run\" {\n       log.Printf(\"PROGRAM RUN\\n\")  //\n       ..... \n       os.Exit(0)\n    }\n\n\n    if len(args) &gt; 1 &amp;&amp; args[0] == \"create\" {\n        if err := goose.Run(\"create\", nil, *dir, args[1:]...); err != nil {\n            log.Fatalf(\"goose run: %v\", err)\n        }\n        return\n    }\n\n    if len(args) &lt; 3 {\n        flags.Usage()\n        return\n    }\n\n    if args[0] == \"-h\" || args[0] == \"--help\" {\n        flags.Usage()\n        return\n    }\n\n    driver, dbstring, command := args[0], args[1], args[2]\n\n    switch driver {\n    case \"postgres\", \"mysql\", \"sqlite3\", \"redshift\":\n        if err := goose.SetDialect(driver); err != nil {\n            log.Fatal(err)\n        }\n    default:\n        log.Fatalf(\"%q driver not supported\\n\", driver)\n    }\n\n    switch dbstring {\n    case \"\":\n        log.Fatalf(\"-dbstring=%q not supported\\n\", dbstring)\n    default:\n    }\n\n    if driver == \"redshift\" {\n        driver = \"postgres\"\n    }\n\n    db, err := sql.Open(driver, dbstring)\n    if err != nil {\n        log.Fatalf(\"-dbstring=%q: %v\\n\", dbstring, err)\n    }\n\n    arguments := []string{}\n    if len(args) &gt; 3 {\n        arguments = append(arguments, args[3:]...)\n    }\n\n    if err := goose.Run(command, db, *dir, arguments...); err != nil {\n        log.Fatalf(\"goose run: %v\", err)\n    }\n}\n\nfunc usage() {\n    log.Print(usagePrefix)\n    flags.PrintDefaults()\n    log.Print(usageCommands)\n}\n\nvar (\n    usagePrefix = `Usage: goose [OPTIONS] DRIVER DBSTRING COMMAND\nDrivers:\n    postgres\n    mysql\n    sqlite3\n    redshift\nExamples:\n    goose sqlite3 ./foo.db status\n    goose sqlite3 ./foo.db create init sql\n    goose sqlite3 ./foo.db create add_some_column sql\n    goose sqlite3 ./foo.db create fetch_user_data go\n    goose sqlite3 ./foo.db up\n    goose postgres \"user=postgres dbname=postgres sslmode=disable\" status\n    goose mysql \"user:password@/dbname?parseTime=true\" status\n    goose redshift \"postgres://user:password@qwerty.us-east-1.redshift.amazonaws.com:5439/db\"\nstatus\nOptions:\n`\n\n    usageCommands = `\nCommands:\n    up                   Migrate the DB to the most recent version available\n    up-to VERSION        Migrate the DB to a specific VERSION\n    down                 Roll back the version by 1\n    down-to VERSION      Roll back to a specific VERSION\n    redo                 Re-run the latest migration\n    status               Dump the migration status for the current DB\n    version              Print the current version of the database\n    create NAME [sql|go] Creates new migration file with next version\n`\n)\n</code></pre></li>\n<li><p>Create folder for migrations:</p>\n\n<pre><code>mkdir migrations &amp;&amp; cd migrations\n</code></pre></li>\n<li><p>Create first migrations. We will use <code>go</code>-style migrations:</p>\n\n<pre><code>goose mysql \"user:password@/dbname?parseTime=true\" create init go\n</code></pre>\n\n<p>You'll get a file <code>00001_init.go</code> with Go code. Migrations are baked in it as SQL-commands. Just edit them as you need.</p></li>\n<li><p>Then go to the main folder and build the application:</p>\n\n<pre><code>cd ..\ngo build -v -o myapp *.go\n</code></pre></li>\n<li><p>You'll get a file <code>myapp</code> with all the migrations baked in it. To check move it to some other place, for example to <code>/tmp</code> folder, and run from there:</p>\n\n<pre><code>./myapp mysql \"user:password@/dbname?parseTime=true\" status\n</code></pre></li>\n<li><p>Run your app:</p>\n\n<pre><code>./myapp run\n</code></pre></li>\n</ol>\n\n<h2>Result</h2>\n\n<p>You have single file which can be used as a migration tool so as a working application itself. All the migration are buil-it. In source code they are stored in a subpackage <code>migrations</code> - so it's easy to edit.</p>\n"}], "owner": {"reputation": 627, "user_id": 4689430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SJU8y.png?s=128&g=1", "display_name": "elixir", "link": "https://stackoverflow.com/users/4689430/elixir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1442, "favorite_count": 0, "accepted_answer_id": 47050074, "answer_count": 3, "score": 3, "last_activity_date": 1577341383, "creation_date": 1509435878, "last_edit_date": 1577177725, "question_id": 47030199, "link": "https://stackoverflow.com/questions/47030199/how-to-bind-migrations-with-executable", "title": "How to bind migrations with executable", "body": "<p>I have a Go project using <a href=\"https://github.com/pressly/goose\" rel=\"nofollow noreferrer\">goose</a> for Mysql migrations. I would like to bind the migrations to the package executable so that the executable can be deployed and used independently from any system, similar to JAR files in JAVA projects.</p>\n\n<p>Is there an equivalent in Go to accomplish that?</p>\n"}, {"tags": ["amazon-web-services", "session", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1509433353, "post_id": 47029424, "comment_id": 81005706, "body": "I&#39;m assuming the time logic is for benchmarking?"}, {"owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "reply_to_user": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1509434632, "post_id": 47029424, "comment_id": 81006271, "body": "Yes, sorry, I removed the log lines to keep it compact."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1509435507, "post_id": 47029424, "comment_id": 81006674, "body": "How much do the connection and authentication take in the whole process?"}, {"owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1509435747, "post_id": 47029424, "comment_id": 81006780, "body": "I&#39;m not really sure or how to tell."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1509435867, "post_id": 47029424, "comment_id": 81006846, "body": "Why are you optimising it then? How will you know that after the &quot;optimisation&quot; the new implementation works any better?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509453405, "post_id": 47029424, "comment_id": 81017362, "body": "Yes you should reuse the s3 client. The client documents that its methods are safe for concurrent use, so I&#39;m not sure what else you&#39;re asking. You&#39;re already reusing the http transport via the <code>http.DefaultClient</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1881, "user_id": 229154, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/79qdK.jpg?s=128&g=1", "display_name": "Wojciech Kaczmarek", "link": "https://stackoverflow.com/users/229154/wojciech-kaczmarek"}, "is_accepted": false, "score": 1, "last_activity_date": 1509619523, "last_edit_date": 1509619523, "creation_date": 1509456731, "answer_id": 47036712, "question_id": 47029424, "link": "https://stackoverflow.com/questions/47029424/how-to-share-session-with-a-http-fetch-and-store-to-s3-operation/47036712#47036712", "title": "How to share session with a HTTP fetch and store to S3 operation?", "body": "<p>Your problem seems to be pretty general.</p>\n\n<p>As a principle you need to separate things which don't change (session &amp; AWS service object, destination non-varying part like the bucket name) from the ones which change (src, dest. varying part like the key name), then setup non-changing configuration once, then run URL fetch + S3 store concurrently, passing your config as an additional arg.</p>\n\n<p>That would boil down to moving your <code>s3svc</code> creation out of <code>fetchPut</code> function and passing it as an arg, then running <code>fetchPut</code>in goroutines, possibly with using <code>async.WaitGroup</code> if you want to wait for all of them to finish.</p>\n\n<p>Other variation would be to run two pools of workers: producers (fetching URLs) and consumers (putting to S3) and use a channel to inform that one can feed another.\nThat would probably give most of speedup.</p>\n\n<p>In general, I agree with your idea of making it concurrent - it's pretty good mind-stretching example; doesn't have to be considered as premature optimization. \nI also can't resist advertising Rob Pike's <a href=\"https://www.youtube.com/watch?v=cN_DpYBzKso\" rel=\"nofollow noreferrer\">excellent talk</a>  \"Concurrency Is Not Parallelism\". Rob's example of a load balancer is more complicated than your case, still gives a good overview how to process requests concurrently.</p>\n\n<p>Btw, \"session\" used for http fetch is kind of transparent; as the commenters already mentioned, http client from standard library will be reused and you don't have to worry about that.</p>\n"}], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509619523, "creation_date": 1509432655, "question_id": 47029424, "link": "https://stackoverflow.com/questions/47029424/how-to-share-session-with-a-http-fetch-and-store-to-s3-operation", "title": "How to share session with a HTTP fetch and store to S3 operation?", "body": "<p>I need to fetch the contents from many several URLs and store it in AWS S3. I've written a function to do that which works. But I am looking to <strong>make it faster and more efficient</strong> by re-using http client connection and re-using the <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/aws/session/\" rel=\"nofollow noreferrer\">AWS session</a>. Furthermore I'm looking to get them to run concurrently, say 5 at a time.</p>\n\n<pre><code>func fetchPut(fromURL string, toS3 string) error {\n\n      start := time.Now()\n      resp, err := http.Get(fromURL)\n      if err != nil {\n          return err\n      }\n      defer resp.Body.Close()\n\n      sess := session.Must(session.Must(session.NewSession()))\n      s3svc := s3.New(sess)\n\n      s3URL, _ := url.Parse(toS3)\n\n      byteArray, _ := ioutil.ReadAll(resp.Body)\n      fetchElapsed := time.Since(start).Seconds()\n\n      start = time.Now()\n      input := &amp;s3.PutObjectInput{\n          Body:         bytes.NewReader(byteArray),\n          Bucket:       aws.String(s3URL.Host),\n          Key:          aws.String(s3URL.Path),\n      }\n      _, err = s3svc.PutObject(input)\n      putElapsed := time.Since(start).Seconds()\n\n      return err\n}\n</code></pre>\n\n<p>What I don't understand is how I can re-use the session (both http &amp; AWS). Can I have it in some global variable? Or do I have to create some sort of context?</p>\n\n<p>Are there any good examples of this sort of use case to study?</p>\n"}, {"tags": ["docker", "go", "alpine"], "comments": [{"owner": {"reputation": 50397, "user_id": 1318694, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/JPEVC.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1318694/matt"}, "edited": false, "score": 2, "creation_date": 1509429057, "post_id": 47028597, "comment_id": 81004187, "body": "If you create a <a href=\"https://developer.atlassian.com/blog/2015/07/osx-static-golang-binaries-with-docker/?hn\" rel=\"nofollow noreferrer\">static go binary</a>, you can use <a href=\"https://stackoverflow.com/a/38711044/1318694\"><code>scratch</code></a>"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1509429114, "post_id": 47028597, "comment_id": 81004197, "body": "There is also <code>golang:alpine</code>."}, {"owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1509429659, "post_id": 47028597, "comment_id": 81004382, "body": "@\u0417\u0435\u043b\u0451\u043d\u044b\u0439 Yes there is <code>golang:alpine</code> but it is ~200Mb more than base <code>alpine</code>. just want to know what is the advantage of golang image"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1509430028, "post_id": 47028597, "comment_id": 81004492, "body": "The main advantage is obviously <code>go</code> lang tools(and many other tools such as <code>git</code> or <code>bash</code>), those tools don&#39;t available in plain alpine docker images. <a href=\"https://news.ycombinator.com/item?id=10782897\" rel=\"nofollow noreferrer\">Here is a good thread about a <b>small</b> docker images</a>. I think your question is probably off-topic here IMO."}], "answers": [{"comments": [{"owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "edited": false, "score": 0, "creation_date": 1509469057, "post_id": 47039301, "comment_id": 81028048, "body": "So in summary it is better to use just <code>alpine</code> image in production and <code>golang;alpine</code> for development and building the image ?"}, {"owner": {"reputation": 1730, "user_id": 573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a286a392ecc96e9cb40c03134b96841?s=128&d=identicon&r=PG", "display_name": "bosgood", "link": "https://stackoverflow.com/users/573791/bosgood"}, "reply_to_user": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "edited": false, "score": 1, "creation_date": 1509481272, "post_id": 47039301, "comment_id": 81035123, "body": "Yes, for some use cases. That would be a good rule of thumb if you don&#39;t mind using a minimal distro (Alpine will generally need additional configuration to make your app function properly)."}], "tags": [], "owner": {"reputation": 1730, "user_id": 573791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a286a392ecc96e9cb40c03134b96841?s=128&d=identicon&r=PG", "display_name": "bosgood", "link": "https://stackoverflow.com/users/573791/bosgood"}, "is_accepted": true, "score": 3, "last_activity_date": 1509464508, "creation_date": 1509464508, "answer_id": 47039301, "question_id": 47028597, "link": "https://stackoverflow.com/questions/47028597/choosing-golang-docker-base-image/47039301#47039301", "title": "Choosing Golang docker base image", "body": "<p>Short answer: It would be fairer to compare the differences between <code>golang:alpine</code> and <code>alpine</code>.</p>\n\n<p>At the time of writing, the <code>golang</code> image is built off of Debian, a different distribution than Alpine. <a href=\"https://hub.docker.com/_/golang/\" rel=\"nofollow noreferrer\">I'll quote the documentation from Docker Hub</a>:</p>\n\n<blockquote>\n  <p><code>golang:&lt;version&gt;</code></p>\n  \n  <p>This is the defacto image. If you are unsure about\n  what your needs are, you probably want to use this one. It is designed\n  to be used both as a throw away container (mount your source code and\n  start the container to start your app), as well as the base to build\n  other images off of.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p><code>golang:alpine</code></p>\n  \n  <p>This image is based on the popular Alpine Linux project,\n  available in the alpine official image. Alpine Linux is much smaller\n  than most distribution base images (~5MB), and thus leads to much\n  slimmer images in general.</p>\n  \n  <p>This variant is highly recommended when final image size being as\n  small as possible is desired. The main caveat to note is that it does\n  use musl libc instead of glibc and friends, so certain software might\n  run into issues depending on the depth of their libc requirements.\n  However, most software doesn't have an issue with this, so this\n  variant is usually a very safe choice. See this Hacker News comment\n  thread for more discussion of the issues that might arise and some\n  pro/con comparisons of using Alpine-based images.</p>\n</blockquote>\n\n<p>In summary, images built off of Alpine will tend to be smaller than the Debian ones. But, they won't contain various system tools that you may find useful for development and debugging. A common compromise is to build your binaries with the <code>golang</code> flavor and deploy to production with either <code>golang:alpine</code>, <code>alpine</code>, or as mentioned in a comment above, <code>scratch</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 1, "creation_date": 1533041565, "post_id": 47039404, "comment_id": 90192896, "body": "Good call on <code>scratch</code> and <code>centurylink&#47;ca-certs</code>. But if you <code>import &quot;C&quot;</code> or use a library that does, like a wrapper over a C library, you can&#39;t really use <code>scratch</code> though?"}], "tags": [], "owner": {"reputation": 3210, "user_id": 379906, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d0d2b9a421355f4a5bab3658c6f6b41d?s=128&d=identicon&r=PG", "display_name": "db80", "link": "https://stackoverflow.com/users/379906/db80"}, "is_accepted": false, "score": 4, "last_activity_date": 1533032004, "last_edit_date": 1533032004, "creation_date": 1509464828, "answer_id": 47039404, "question_id": 47028597, "link": "https://stackoverflow.com/questions/47028597/choosing-golang-docker-base-image/47039404#47039404", "title": "Choosing Golang docker base image", "body": "<p>Why not <a href=\"https://hub.docker.com/_/scratch/\" rel=\"nofollow noreferrer\">scratch</a> or <a href=\"https://hub.docker.com/r/centurylink/ca-certs/~/dockerfile/\" rel=\"nofollow noreferrer\">centurylink</a> ?</p>\n\n<p>You can build a static go binary file and copy it into the docker image. </p>\n\n<p>The size of the docker image will be equal to the size of the binary file.</p>\n\n<p>Suppose that your go binary file is called <strong>main_go</strong>, this is the <em>Dockerfile</em> that you need:</p>\n\n<pre><code>FROM centurylink/ca-certs\nADD main_go /\nCMD [\"/main_go\"]\n</code></pre>\n\n<p>Please remember that <em>scratch</em> and <em>centurylink</em> are blank images therefore you must statically compile your app with all libraries built in.</p>\n\n<p>Example:</p>\n\n<pre><code>CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o main_go .\n</code></pre>\n\n<p><a href=\"https://blog.codeship.com/building-minimal-docker-containers-for-go-applications/\" rel=\"nofollow noreferrer\">Here</a> you can find some extra info about docker, go and scratch and <a href=\"https://www.goinggo.net/2013/10/cross-compile-your-go-programs.html\" rel=\"nofollow noreferrer\">here</a> you can find some info about the GOOS value.</p>\n"}], "owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4089, "favorite_count": 0, "accepted_answer_id": 47039301, "answer_count": 2, "score": 2, "last_activity_date": 1533032004, "creation_date": 1509428682, "last_edit_date": 1509429141, "question_id": 47028597, "link": "https://stackoverflow.com/questions/47028597/choosing-golang-docker-base-image", "title": "Choosing Golang docker base image", "body": "<p>Size of the images <code>golang</code> and <code>alpine</code> vary by around <code>300Mb</code>.</p>\n\n<p>What are the advantages of using <code>golang</code> image instead of plain <code>alpine</code>?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 10595, "user_id": 325320, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/23bc4a16f6a4bac91accd76c8078cd35?s=128&d=identicon&r=PG", "display_name": "Mr.Wang from Next Door", "link": "https://stackoverflow.com/users/325320/mr-wang-from-next-door"}, "edited": false, "score": 0, "creation_date": 1509504812, "post_id": 47028304, "comment_id": 81042259, "body": "I see where the problem is:  the Go&#39;s http client caches small chunks and do not send them out. <a href=\"https://go-review.googlesource.com/c/go/+/10021\" rel=\"nofollow noreferrer\">go-review.googlesource.com/c/go/+/10021</a>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 10595, "user_id": 325320, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/23bc4a16f6a4bac91accd76c8078cd35?s=128&d=identicon&r=PG", "display_name": "Mr.Wang from Next Door", "link": "https://stackoverflow.com/users/325320/mr-wang-from-next-door"}, "edited": false, "score": 0, "creation_date": 1509523446, "post_id": 47028304, "comment_id": 81047960, "body": "@Mr.WangfromNextDoor, can you elaborate on your comment? The change introduced by the CL you&#39;ve linked to was included into Go 1.5, and now we have Go 1.9. So what &quot;the problem&quot; you&#39;re referring to really is?"}, {"owner": {"reputation": 10595, "user_id": 325320, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/23bc4a16f6a4bac91accd76c8078cd35?s=128&d=identicon&r=PG", "display_name": "Mr.Wang from Next Door", "link": "https://stackoverflow.com/users/325320/mr-wang-from-next-door"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1509538751, "post_id": 47028304, "comment_id": 81056183, "body": "Thanks @kostix,  I see the reason why that branch(<a href=\"https://github.com/benburkert/http\" rel=\"nofollow noreferrer\">github.com/benburkert/http</a>) is created. <a href=\"https://github.com/benburkert/http/commit/7b1c7d0a482c9449569466b694849c9813abf62a\" rel=\"nofollow noreferrer\">github.com/benburkert/http/commit/&hellip;</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1509426887, "creation_date": 1509426887, "answer_id": 47028304, "question_id": 47028116, "link": "https://stackoverflow.com/questions/47028116/chunked-transfer-encoding-http-request-in-go/47028304#47028304", "title": "Chunked transfer encoding HTTP request in GO?", "body": "<p>The net/http package automatically uses chunked encoding for request bodies when the content length is not known and the application did not explicitly set the transfer encoding to \"identity\". This feature dates back to the Go 1 release.</p>\n"}], "owner": {"reputation": 10595, "user_id": 325320, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/23bc4a16f6a4bac91accd76c8078cd35?s=128&d=identicon&r=PG", "display_name": "Mr.Wang from Next Door", "link": "https://stackoverflow.com/users/325320/mr-wang-from-next-door"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 990, "favorite_count": 0, "accepted_answer_id": 47028304, "answer_count": 1, "score": 1, "last_activity_date": 1509426887, "creation_date": 1509425528, "question_id": 47028116, "link": "https://stackoverflow.com/questions/47028116/chunked-transfer-encoding-http-request-in-go", "title": "Chunked transfer encoding HTTP request in GO?", "body": "<p>I see someone <a href=\"https://github.com/benburkert/http\" rel=\"nofollow noreferrer\">modified</a> the net/http module to send chunked request.</p>\n\n<p>That was 4 years ago.  Can't that be done directly by the official net/http module without modification?</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1509419431, "creation_date": 1509419431, "answer_id": 47027286, "question_id": 47027276, "link": "https://stackoverflow.com/questions/47027276/why-golang-didnt-marshal-the-json-object/47027286#47027286", "title": "Why golang didn&#39;t marshal the json object?", "body": "<pre><code>username\nmessage\n</code></pre>\n\n<p>start with a lowercase letter, meaning they are unexported (think private), and so are not visible to the <code>encoding/json</code> package.  You need to export your fields, or implement the <code>MarshalJSON() ([]byte, error)</code> method and do it yourself.</p>\n"}], "owner": {"reputation": 894, "user_id": 6078917, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/HRZj4.jpg?s=128&g=1", "display_name": "ryan", "link": "https://stackoverflow.com/users/6078917/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1509421750, "answer_count": 1, "score": -2, "last_activity_date": 1509419431, "creation_date": 1509419338, "question_id": 47027276, "link": "https://stackoverflow.com/questions/47027276/why-golang-didnt-marshal-the-json-object", "closed_reason": "Duplicate", "title": "Why golang didn&#39;t marshal the json object?", "body": "<p>I wonder why the following didn't marshall to json successfully?  I am trying to use a very simple example to learn json package.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Message struct {\n    username string `json:\"name\"`\n    message  string `json:\"message\"`\n}\n\nfunc main() {\n    var m = Message{\n        username: \"hello\",\n        message:  \"world\",\n    }\n\n    js, _ := json.Marshal(m)\n\n    fmt.Println(m)\n    fmt.Println(string(js))\n}\n</code></pre>\n"}, {"tags": ["dictionary", "go", "unsafe"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 4, "creation_date": 1509419300, "post_id": 47027242, "comment_id": 81001638, "body": "A small note: it&#39;s not a type alias. Type alias is <code>type A = string</code>. And type aliases would work as-is."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1509419481, "post_id": 47027242, "comment_id": 81001685, "body": "Pitfalls: the solution is not type safe and you must ensure <code>A</code> is a <code>string</code> on the caller side: <a href=\"https://play.golang.org/p/WkZp0CMKob\" rel=\"nofollow noreferrer\">play.golang.org/p/WkZp0CMKob</a>"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 1, "creation_date": 1509478458, "post_id": 47027242, "comment_id": 81033674, "body": "I would try hard to avoid doing this; it&#39;s not guaranteed in any way to work in the future.   Go does not have a polymorphic type system (by design).  You must use interfaces to achieve any sort of polymorphism."}], "owner": {"reputation": 1157, "user_id": 238441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RNIt2.jpg?s=128&g=1", "display_name": "Kel", "link": "https://stackoverflow.com/users/238441/kel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509419644, "creation_date": 1509419091, "last_edit_date": 1509419644, "question_id": 47027242, "link": "https://stackoverflow.com/questions/47027242/converting-between-equivalent-go-maps", "title": "Converting between equivalent Go maps", "body": "<p>I was looking for a way to convert a map to another map, without copying key by key. Both maps have the equivalent key type (as demonstrated below). </p>\n\n<p>The code below seems to do the job, but I'm wondering what kind of pitfalls there might be if I use this?</p>\n\n<pre><code>package main\n\nimport (\n \"fmt\"\n \"unsafe\"\n)\n\ntype A string\nvar (\n  x A = \"x\"\n  y A = \"y\"\n)\n\nfunc main() {\n    a := map[A]string{}\n    a[x] = \"242342\"\n    a[y] = \"1234\"\n\n    b := convert(a)\n\n    fmt.Println(a[x])\n    fmt.Println(b[\"x\"])\n\n    fmt.Println(a[y])\n    fmt.Println(b[\"y\"])\n}\n\nfunc convert(in map[A]string) map[string]string {\n    return *(*map[string]string)(unsafe.Pointer(&amp;in))\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 3, "creation_date": 1509419709, "post_id": 47027146, "comment_id": 81001741, "body": "The golang way to do it to just use for loops. If you really want to do it, use this <a href=\"https://github.com/robpike/filter\" rel=\"nofollow noreferrer\">github.com/robpike/filter</a>"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509478814, "post_id": 47027146, "comment_id": 81033848, "body": "You need to use <code>interface{}</code> to achieve something like parametric polymorphism.   When you need aspects of type to implement your &quot;polymorphic&quot; functions, you type-convert to an interface of some specific signature.  Although you can play games with the <code>reflect</code> package to make up for it, but you&#39;ll never be able to use the type system to type your <code>Filter</code> function accurately."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509478830, "post_id": 47027146, "comment_id": 81033854, "body": "(why the downvote? this is a valid question...)"}, {"owner": {"reputation": 2260, "user_id": 3064056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/nXVXo.jpg?s=128&g=1", "display_name": "Tyler.z.yang", "link": "https://stackoverflow.com/users/3064056/tyler-z-yang"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509504566, "post_id": 47027146, "comment_id": 81042195, "body": "@BadZen Thx for your solution, it looks more intuitive, is there an example package that I can check with? I mean the parametric polymorphism part."}], "owner": {"reputation": 2260, "user_id": 3064056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/nXVXo.jpg?s=128&g=1", "display_name": "Tyler.z.yang", "link": "https://stackoverflow.com/users/3064056/tyler-z-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1509418332, "creation_date": 1509418332, "question_id": 47027146, "link": "https://stackoverflow.com/questions/47027146/how-to-implement-general-filter-method-in-go", "title": "How to implement general Filter method in Go", "body": "<p>as a newbee in golang, i want to know how to implement a general method like Filter/Map.</p>\n\n<p>Basically what I want to do is, </p>\n\n<pre><code>Filter(data []T, func (item T) {\n    return item.xxx\n})\n</code></pre>\n\n<p>From what i know is, golang doesn't support generic(maybe wrong), and there is the <a href=\"https://github.com/golang/proposal/blob/master/design/15292-generics.md\" rel=\"nofollow noreferrer\">generic proposal here</a>.</p>\n\n<p>And of course, i really don't want to copy and paste to support different struct. </p>\n\n<p>So what is the golang way to do it?</p>\n"}, {"tags": ["parsing", "datetime", "go"], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 4109882, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05080c148683d5bcb04238ea41a7056f?s=128&d=identicon&r=PG&f=1", "display_name": "gpanda", "link": "https://stackoverflow.com/users/4109882/gpanda"}, "edited": false, "score": 0, "creation_date": 1509418875, "post_id": 47027143, "comment_id": 81001523, "body": "Thank you @zerkms. Would you be so kind as to illustrate this in an edit to the playground link I provided? I want to be crystal clear on how to apply your suggestion."}, {"owner": {"reputation": 585, "user_id": 4109882, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05080c148683d5bcb04238ea41a7056f?s=128&d=identicon&r=PG&f=1", "display_name": "gpanda", "link": "https://stackoverflow.com/users/4109882/gpanda"}, "edited": false, "score": 0, "creation_date": 1509423982, "post_id": 47027143, "comment_id": 81002758, "body": "Thinking &#39;out loud&#39;, if we are converting time.Time to string, as opposed to string to time.Time then back to string, would the same use of 0 vs 9 work? TODO: post here once tested."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 585, "user_id": 4109882, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05080c148683d5bcb04238ea41a7056f?s=128&d=identicon&r=PG&f=1", "display_name": "gpanda", "link": "https://stackoverflow.com/users/4109882/gpanda"}, "edited": false, "score": 0, "creation_date": 1509427176, "post_id": 47027143, "comment_id": 81003643, "body": "I&#39;m not sure I understand what you mean :-)"}, {"owner": {"reputation": 585, "user_id": 4109882, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05080c148683d5bcb04238ea41a7056f?s=128&d=identicon&r=PG&f=1", "display_name": "gpanda", "link": "https://stackoverflow.com/users/4109882/gpanda"}, "edited": false, "score": 0, "creation_date": 1509463213, "post_id": 47027143, "comment_id": 81024229, "body": "What I mean here for any interested in this behavior: <a href=\"https://play.golang.org/p/RgjVSRKdIr\" rel=\"nofollow noreferrer\">play.golang.org/p/RgjVSRKdIr</a>"}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 1, "last_activity_date": 1509418758, "last_edit_date": 1509418758, "creation_date": 1509418307, "answer_id": 47027143, "question_id": 47027010, "link": "https://stackoverflow.com/questions/47027010/golang-time-parse-behavior-dropping-precision-when-000/47027143#47027143", "title": "Golang time.Parse() Behavior - Dropping Precision when 000", "body": "<p><code>time.String</code> uses the <code>2006-01-02 15:04:05.999999999 -0700 MST</code> format.</p>\n\n<p>To keep the zeroes use <code>0</code> instead of <code>9</code>: <code>2006-01-02 15:04:05.000000000 -0700 MST</code></p>\n\n<pre><code>t.Format(\"2006-01-02 15:04:05.000 -0700 MST\")\n</code></pre>\n"}], "owner": {"reputation": 585, "user_id": 4109882, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05080c148683d5bcb04238ea41a7056f?s=128&d=identicon&r=PG&f=1", "display_name": "gpanda", "link": "https://stackoverflow.com/users/4109882/gpanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 47027143, "answer_count": 1, "score": 1, "last_activity_date": 1509463552, "creation_date": 1509417104, "last_edit_date": 1509463552, "question_id": 47027010, "link": "https://stackoverflow.com/questions/47027010/golang-time-parse-behavior-dropping-precision-when-000", "title": "Golang time.Parse() Behavior - Dropping Precision when 000", "body": "<p>In Go, I am confused as to the behavior of <code>time.Parse()</code> I observe when parsing date strings to <code>time.Time</code>.</p>\n\n<p>In the event that a given time string's milliseconds are equal to exactly \"000\", e.g. \"2017-01-02T01:02:03.000Z\", <code>time.Parse()</code> will truncate the \"000\".</p>\n\n<p>It would seem preferable to include, as opposed to omit this for consistency in logging and other use cases.</p>\n\n<p>Is this the expected behavior? If so, why?</p>\n\n<p>Bonus: How do we retain the \"000\"?</p>\n\n<p><a href=\"https://play.golang.org/p/RgjVSRKdIr\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"time\"\n)\n\nfunc main() {\n\n    const (\n        ISO_8601 = \"2006-01-02T15:04:05.999Z\"\n    )\n\n    tMap := map[string]string{\n        \"t00\": \"2017-01-02T01:02:03.000Z\",\n        \"t01\": \"2017-01-02T01:02:03.000Z\",\n        \"t02\": \"2017-01-02T01:02:03.456Z\",\n        \"t03\": \"2017-01-03T01:02:03.123Z\",\n        \"t04\": \"2013-10-04T01:02:03.456Z\",\n        \"t05\": \"2012-02-02T01:02:03.321Z\",\n        \"t06\": \"2011-03-07T01:02:03.849Z\",\n    }\n\n    for _, v := range tMap {\n        t, err := time.Parse(ISO_8601, v)\n        logFatal(\"0H N03Z!!1\", err)\n\n        // Dude where's my 000?\n        log.Printf(\"Key: %s | lenTimeString: %d | Val: %s \\n\", t.String(), len(t.String()), t)\n    }\n}\n\nfunc logFatal(hint string, e error) {\n    if e != nil {\n        log.Fatal(hint, e)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2009/11/10 23:00:00 Key: t05 | lenTimeString: 33 | timeString: 2012-02-02 01:02:03.321 +0000 UTC \n2009/11/10 23:00:00 Key: t06 | lenTimeString: 33 | timeString: 2011-03-07 01:02:03.849 +0000 UTC \n2009/11/10 23:00:00 Key: t00 | lenTimeString: 29 | timeString: 2017-01-02 01:02:03 +0000 UTC \n2009/11/10 23:00:00 Key: t01 | lenTimeString: 29 | timeString: 2017-01-02 01:02:03 +0000 UTC \n2009/11/10 23:00:00 Key: t02 | lenTimeString: 33 | timeString: 2017-01-02 01:02:03.456 +0000 UTC \n2009/11/10 23:00:00 Key: t03 | lenTimeString: 33 | timeString: 2017-01-03 01:02:03.123 +0000 UTC \n2009/11/10 23:00:00 Key: t04 | lenTimeString: 33 | timeString: 2013-10-04 01:02:03.456 +0000 UTC \n</code></pre>\n\n<p><strong>Edit:</strong> Here's a simplified solution with the kind help of @zerkms</p>\n\n<p><a href=\"https://play.golang.org/p/RgjVSRKdIr\" rel=\"nofollow noreferrer\">Play</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n\n    p := fmt.Println\n\n    const (\n        ISO_8601           = \"2006-01-02T15:04:05.000Z\"\n        ISO_8601_dropmilli = \"2006-01-02T15:04:05.999Z\"\n    )\n\n    t := time.Date(2017, time.October, 31, 15, 16, 17, 000000000, time.Local)\n\n    p(t.Format(ISO_8601))\n    p(t.Format(ISO_8601_dropmilli))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2017-10-31T15:16:17.000Z\n2017-10-31T15:16:17Z\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 746, "user_id": 4172765, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/10b586f5dd0d04b071bac89fa5a777b1?s=128&d=identicon&r=PG&f=1", "display_name": "nistelrooy41001662", "link": "https://stackoverflow.com/users/4172765/nistelrooy41001662"}, "edited": false, "score": 0, "creation_date": 1589353912, "post_id": 47026291, "comment_id": 109256469, "body": "Hi sir, can you help me convert this MongoDB query to mgo, please? Here db.users.aggregate( [    {       $graphLookup: {           from: &quot;users&quot;,           startWith: &quot;$user_parentid&quot;,           connectFromField: &quot;user_parentid&quot;,           connectToField: &quot;_id&quot;,           as: &quot;hierarchy&quot;       }    },   {        $match: {            $or: [               { &quot;hierarchy._id&quot;:  &quot;BOMON_VIENTHONG&quot; },              { _id: &quot;BOMON_VIENTHONG&quot; }           ]       }    } ]  ).forEach( doc =&gt; db.users.deleteOne( { _id: doc._id } ) )"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1509411241, "last_edit_date": 1509411241, "creation_date": 1509410746, "answer_id": 47026291, "question_id": 47025936, "link": "https://stackoverflow.com/questions/47025936/convert-mongo-query-to-mgo-query/47026291#47026291", "title": "Convert Mongo query to Mgo query", "body": "<p>Logical AND is the default, so you can generously leave that out:</p>\n\n<pre><code>dbname.find({\"field1\": \"val1\", \"field2\": {$exists: true}, {\"id\": 1, \"field2\": 1})\n</code></pre>\n\n<p>In <code>mgo</code>:</p>\n\n<p>In general just use a <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#M\" rel=\"nofollow noreferrer\"><code>bson.M</code></a> map value for each brackets (where keys must be <code>string</code> values). For projection use <a href=\"https://godoc.org/gopkg.in/mgo.v2#Query.Select\" rel=\"nofollow noreferrer\"><code>Query.Select()</code></a>.</p>\n\n<pre><code>sess := ... // Acquire an mgo session\n\nc := sess.DB(\"dbname\").C(\"collname\") // Use your db name and collection name\n\nvar docs []bson.M\nerr := c.Find(bson.M{\n    \"field1\": \"val1\",\n    \"field2\": bson.M{\"$exists\": true},\n}).Select(bson.M{\"id\": 1, \"field2\": 1}).All(&amp;docs)\n\nif err != nil {\n    // Handle err\n    log.Printf(\"Query error: \"%v\", err)\n    return\n}\n\n// Process results\n</code></pre>\n"}], "owner": {"reputation": 271, "user_id": 8859115, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211283633499859/picture?type=large", "display_name": "kunrazor", "link": "https://stackoverflow.com/users/8859115/kunrazor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 0, "accepted_answer_id": 47026291, "answer_count": 1, "score": 1, "last_activity_date": 1509411241, "creation_date": 1509407734, "last_edit_date": 1509410831, "question_id": 47025936, "link": "https://stackoverflow.com/questions/47025936/convert-mongo-query-to-mgo-query", "title": "Convert Mongo query to Mgo query", "body": "<p>I'm trying to retrieve all id and field2 from mongo document, if field1 equals some value and field2 exists.</p>\n\n<p>Example:\nMongo Document:</p>\n\n<pre><code>{\n\n       \"id\": \"id1\"\n       \"field1\": \"val1\"\n       \"field2\": \"val2\"\n       \"field3\": \"val3\"\n}\n\n{\n\n      \"id\": \"id2\"\n      \"field1\": \"val4\"\n      \"field3\": \"val5\"\n}\n</code></pre>\n\n<p>Result</p>\n\n<pre><code>{\n\n    \"id\" : \"id1\"\n    \"field2\": \"val2\"\n}\n</code></pre>\n\n<p>I figured out mongodb query that works:</p>\n\n<pre><code>dbname.find( { $and: [ { \"field1\": \"val1\" }, { \"field2\": { $exists: true } } ] } , {\"id\":1, \"field2\":1})\n</code></pre>\n\n<p>But I want to call this query in Go using Mgo package. I'm unable to convert make this mongo query call using Mgo. I tried a few ways but they don't seem to be working. Can anyone help me out here?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["json", "go", "decode"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1509405057, "post_id": 47025393, "comment_id": 80998255, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/46585279/unmarshal-json-string-to-a-struct-that-have-one-element-of-the-struct-itself/46585770#46585770\">Unmarshal json string to a struct that have one element of the struct itself</a>."}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1509405535, "post_id": 47025393, "comment_id": 80998421, "body": "The json data can be decoded into map[string]Reading. It&#39;s not clear to me what you want to do after Unmarshal. What stops you from creating site/tag structs and assigned the Reading value? Note that your struct type/names must be exported/upper case if you plan to unmarshal/marshal into json."}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 4, "last_activity_date": 1509407280, "creation_date": 1509407280, "answer_id": 47025879, "question_id": 47025393, "link": "https://stackoverflow.com/questions/47025393/how-to-decode-complicated-unnamed-json-in-golang/47025879#47025879", "title": "How to decode complicated unnamed JSON in Golang", "body": "<p>You can have your <code>reading</code> type implement the <code>json.Unmarshaler</code> interface.</p>\n\n<pre><code>func (r *reading) UnmarshalJSON(data []byte) error {\n    type _r reading // same structure, but no methods, avoids infinite calls to this method\n    m := map[string]_r{}\n    if err := json.Unmarshal(data, &amp;m); err != nil {\n        return err\n    }\n    for _, v := range m {\n        *r = reading(v)\n    }\n    return nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/7X1oB77XL4\" rel=\"nofollow noreferrer\">https://play.golang.org/p/7X1oB77XL4</a></p>\n"}, {"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1509408376, "creation_date": 1509408376, "answer_id": 47026027, "question_id": 47025393, "link": "https://stackoverflow.com/questions/47025393/how-to-decode-complicated-unnamed-json-in-golang/47026027#47026027", "title": "How to decode complicated unnamed JSON in Golang", "body": "<p>Another way is to use a slice of maps to parse, then copy to slice of readings, eg:</p>\n\n<pre><code>    var readingMaps []map[string]reading //slice of maps of string key to reading value\n\n    if err := json.Unmarshal([]byte(data), &amp;readingMaps); err != nil {\n        panic(err)\n    }\n\n    readings := []reading{}\n\n    for _, m := range readingMaps {\n        for _, r := range m {\n            readings = append(readings, r)\n        }\n    }\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/jXTdmaZz7s\" rel=\"nofollow noreferrer\">play.golang.org/p/jXTdmaZz7s</a></p>\n"}], "owner": {"reputation": 43, "user_id": 6647758, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/949326d9823813eeb56b6b4605f7ea89?s=128&d=identicon&r=PG&f=1", "display_name": "Riizu", "link": "https://stackoverflow.com/users/6647758/riizu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1509408376, "creation_date": 1509403831, "question_id": 47025393, "link": "https://stackoverflow.com/questions/47025393/how-to-decode-complicated-unnamed-json-in-golang", "title": "How to decode complicated unnamed JSON in Golang", "body": "<p>I am currently trying to decode the following JSON structure:</p>\n\n<pre><code>[\n    {\n        \"2015-08-14 19:29:48-04:00\": {\n            \"value\": \"0.1\",\n            \"measurement_tag_id\": \"0.1.1a\",\n            \"UTC_time\": \"2015-08-14 23:29:48\",\n            \"error\": \"0\"\n        }\n    },\n    {\n        \"2015-08-14 19:37:07-04:00\": {\n            \"value\": \"0.1\",\n            \"measurement_tag_id\": \"0.1.1b\",\n            \"UTC_time\": \"2015-08-14 23:37:07\",\n            \"error\": \"0\"\n        }\n    },\n    {\n        \"2015-08-14 19:44:16-04:00\": {\n            \"value\": \"0.1\",\n            \"measurement_tag_id\": \"0.1.1b\",\n            \"UTC_time\": \"2015-08-14 23:44:16\",\n            \"error\": \"0\"\n        }\n    }\n]\n</code></pre>\n\n<p>This is to eventually have a slice of <code>Reading</code> structs, formatted as the following:</p>\n\n<pre><code>type reading struct {\n    Value   string `json:\"value\"`\n    MTID    string `json:\"measurement_tag_id\"`\n    UTCTime string `json:\"UTC_time\"`\n    Error   string `json:\"error\"`\n}\n</code></pre>\n\n<p>I would then like to add this into an existing structure nested as:</p>\n\n<pre><code>type site struct {\n    Name string\n    ID   string\n    Tags []tag\n}\n\ntype tag struct {\n    ID       string\n    Readings []reading\n}\n</code></pre>\n\n<p>I've currently been able to create the base structure for sites and tags from a more typical JSON payload with appropriate keys. I have been unsuccessful though in figuring out how to decode the reading JSON. So far the closest I have gotten is via <code>map[string]interface{}</code> chaining, but this feels incredibly clunky and verbose.</p>\n\n<p>Solution so far for reference:</p>\n\n<pre><code>var readingData []interface{}\n    if err := json.Unmarshal(file, &amp;readingData); err != nil {\n        panic(err)\n    }\n    readings := readingData[0].(map[string]interface{})\n    firstReading := readings[\"2015-08-14 19:29:48-04:00\"].(map[string]interface{})\n    fmt.Println(firstReading)\n    value := firstReading[\"value\"].(string)\n    error := firstReading[\"error\"].(string)\n    MTID := firstReading[\"measurement_tag_id\"].(string)\n    UTCTime := firstReading[\"UTC_time\"].(string)\n    fmt.Println(value, error, MTID, UTCTime)\n</code></pre>\n\n<p>While I am not sure if its necessary yet, I would also like to hold on to the arbitrary date keys. My first thought was to create a function that returned a <code>map[string]reading</code> but I am not sure how feasible this is.</p>\n\n<p>Thanks for the help in advance!</p>\n"}, {"tags": ["docker", "elasticsearch", "go"], "answers": [{"comments": [{"owner": {"reputation": 3629, "user_id": 1744107, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/91748b7203b0ef849403e8099da4528f?s=128&d=identicon&r=PG", "display_name": "Rambatino", "link": "https://stackoverflow.com/users/1744107/rambatino"}, "edited": false, "score": 0, "creation_date": 1509401867, "post_id": 47024996, "comment_id": 80997174, "body": "I see... so how can I run the same docker-compose on my mac as on my pi? do I need two different routes dependent upon architecture?"}, {"owner": {"reputation": 3685, "user_id": 2037044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/186c499d805f2645c5128202d531d73e?s=128&d=identicon&r=PG", "display_name": "Stefano", "link": "https://stackoverflow.com/users/2037044/stefano"}, "reply_to_user": {"reputation": 3629, "user_id": 1744107, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/91748b7203b0ef849403e8099da4528f?s=128&d=identicon&r=PG", "display_name": "Rambatino", "link": "https://stackoverflow.com/users/1744107/rambatino"}, "edited": false, "score": 0, "creation_date": 1509402136, "post_id": 47024996, "comment_id": 80997288, "body": "IIRC the docker team is planning to develop a better multi arch support for the images in the future versions of docker. For the moment unfortunately I don&#39;t have an easy solution."}], "tags": [], "owner": {"reputation": 3685, "user_id": 2037044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/186c499d805f2645c5128202d531d73e?s=128&d=identicon&r=PG", "display_name": "Stefano", "link": "https://stackoverflow.com/users/2037044/stefano"}, "is_accepted": true, "score": 0, "last_activity_date": 1509401557, "creation_date": 1509401557, "answer_id": 47024996, "question_id": 47024963, "link": "https://stackoverflow.com/questions/47024963/cant-run-the-elasticsearch-image-on-raspberry-pi/47024996#47024996", "title": "Can&#39;t run the elasticsearch image on Raspberry Pi", "body": "<p>The docker image is for i386 architectures. The raspberry pi is arm and it's not supported.</p>\n\n<p>Probably you'll find something from hypriot images or you can try to use charlesyan/rpi-elasticsearch image.</p>\n"}], "owner": {"reputation": 3629, "user_id": 1744107, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/91748b7203b0ef849403e8099da4528f?s=128&d=identicon&r=PG", "display_name": "Rambatino", "link": "https://stackoverflow.com/users/1744107/rambatino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "accepted_answer_id": 47024996, "answer_count": 1, "score": 0, "last_activity_date": 1509431675, "creation_date": 1509401345, "last_edit_date": 1509431675, "question_id": 47024963, "link": "https://stackoverflow.com/questions/47024963/cant-run-the-elasticsearch-image-on-raspberry-pi", "title": "Can&#39;t run the elasticsearch image on Raspberry Pi", "body": "<p>I get an error when trying to run the elasticsearch image on my raspberry pi. It runs fine on my mac, so it is probably operating system specific. I can run other images.</p>\n\n<pre><code>pi@raspberrypi:~/folder/folder$ docker run \nnode:latest\npi@raspberrypi:~/folder/folder$ docker run \ndocker.elastic.co/elasticsearch/elasticsearch:5.6.3\nstandard_init_linux.go:195: exec user process caused \"exec format \nerror\"\n</code></pre>\n\n<p>Having searched extensively for <code>standard_init_linux.go:195</code> it has yielded very little, apart from maybe having something to do with the <code>qemu</code> libray, from <a href=\"https://github.com/moby/moby/issues/23865\" rel=\"nofollow noreferrer\">this discussion</a>, but don't know enough about linux OS to really understand that. </p>\n\n<pre><code>pi@raspberrypi:~/folder/folder$ docker version\nClient:\n Version:      17.10.0-ce\n API version:  1.33\n Go version:   go1.8.3\n Git commit:   f4ffd25\n Built:        Tue Oct 17 19:13:44 2017\n OS/Arch:      linux/arm\n\nServer:\n Version:      17.10.0-ce\n API version:  1.33 (minimum version 1.12)\n Go version:   go1.8.3\n Git commit:   f4ffd25\n Built:        Tue Oct 17 19:06:18 2017\n OS/Arch:      linux/arm\n Experimental: false\npi@raspberrypi:~/folder/folder$ uname -a\nLinux raspberrypi 4.9.41-v7+ #1023 SMP Tue Aug 8 16:00:15 BST 2017 armv7l GNU/Linux\n</code></pre>\n\n<p>Could it be to do with the Go version?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1509397843, "post_id": 47024161, "comment_id": 80995522, "body": "How is <code>DMYYYY</code> is a valid format for any date parser? How would you differentiate  <code>1&#47;12&#47;2010</code> vs <code>11&#47;2&#47;2010</code>?"}, {"owner": {"reputation": 499, "user_id": 2785937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HoRgS.jpg?s=128&g=1", "display_name": "Luis Louis", "link": "https://stackoverflow.com/users/2785937/luis-louis"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509398039, "post_id": 47024161, "comment_id": 80995608, "body": "when i run the tim.Parse, function it send me a invalid month, here is an example: <a href=\"https://play.golang.org/p/jRRz4W6l5K\" rel=\"nofollow noreferrer\">play.golang.org/p/jRRz4W6l5K</a>"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1509398127, "post_id": 47024161, "comment_id": 80995647, "body": "First answer what JimB asked: <code>1122010</code> - what date is that."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509398222, "post_id": 47024161, "comment_id": 80995691, "body": "@llCastro: yes, because it&#39;s ambiguous. Days and months both take 2 digits to represent their entire range."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1509398234, "post_id": 47024161, "comment_id": 80995696, "body": "Even your <code>122006</code> could just as easily be interpreted in MMDDYY format as December 20, 2006.  Your format is ambiguous and thus illegal."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1509399464, "post_id": 47024161, "comment_id": 80996226, "body": "Strictly speaking, &#39;DMYYYY&#39; isn&#39;t ambiguous--it just has the limitation of not permitting October, November or December, and you can only express the first 9 days of the other months.  Perhaps this limitation makes sense in some strange context... but one would hope the OP would explain such a context, if it actually exists."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1509412476, "last_edit_date": 1509412476, "creation_date": 1509400690, "answer_id": 47024841, "question_id": 47024161, "link": "https://stackoverflow.com/questions/47024161/go-time-parser-error-with-a-date-dmyyyy/47024841#47024841", "title": "go time.Parser error with a date DMYYYY", "body": "<p>Some seven digit dates will be ambiguous (DMMYYYY or DDMYYYY?). For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc parseDate(date string) (time.Time, error) {\n    const pfmt = \"02012006\" // DDMMYYYY\n    if len(date) == 6 {\n        d := (\"0\" + date[0:1]) + (\"0\" + date[1:2]) + date[2:] // DMYYYY\n        t, err := time.Parse(pfmt, d)\n        if err == nil {\n            return t, nil\n        }\n    }\n    if len(date) == 7 {\n        d1 := (\"0\" + date[0:1]) + date[1:3] + date[3:] // DMMYYYY\n        t1, err1 := time.Parse(pfmt, d1)\n        d2 := date[0:2] + (\"0\" + date[2:3]) + date[3:] // DDMYYYY\n        t2, err2 := time.Parse(pfmt, d2)\n        if err1 == nil &amp;&amp; err2 == nil {\n            err := &amp;time.ParseError{\n                Value:   date,\n                Message: \": ambiguous date\",\n            }\n            return time.Time{}, err\n        }\n        if err1 == nil {\n            return t1, nil\n        }\n        if err2 == nil {\n            return t2, nil\n        }\n    }\n    return time.Parse(pfmt, date) // DDMMYYYY\n}\n\nfunc main() {\n    dates := []string{\n        \"892009\",   // DMYYYY\n        \"1102009\",  // DMMYYYY\n        \"1312009\",  // DDMYYYY\n        \"1122009\",  // ???YYYY : DMMYYYY or DDMYYYY\n        \"31122009\", // DDMMYYYY\n    }\n    for _, date := range dates {\n        pDate, err := parseDate(date)\n        fmt.Printf(\"%10q %v : %v\\n\", date, pDate.Format(\"02-01-2006\"), err)\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/pSknyg10yJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/pSknyg10yJ</a></p>\n\n<p>Output:</p>\n\n<pre><code>  \"892009\" 08-09-2009 : &lt;nil&gt;\n \"1102009\" 01-10-2009 : &lt;nil&gt;\n \"1312009\" 13-01-2009 : &lt;nil&gt;\n \"1122009\" 01-01-0001 : parsing time \"1122009\": ambiguous date\n\"31122009\" 31-12-2009 : &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 499, "user_id": 2785937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HoRgS.jpg?s=128&g=1", "display_name": "Luis Louis", "link": "https://stackoverflow.com/users/2785937/luis-louis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 1, "closed_date": 1509424045, "accepted_answer_id": 47024841, "answer_count": 1, "score": -3, "last_activity_date": 1509412476, "creation_date": 1509397598, "question_id": 47024161, "link": "https://stackoverflow.com/questions/47024161/go-time-parser-error-with-a-date-dmyyyy", "closed_reason": "Needs details or clarity", "title": "go time.Parser error with a date DMYYYY", "body": "<p>Parsing a date on go, with that format DMYYYY, it throw me an error:</p>\n\n<blockquote>\n  <p>month out of range</p>\n</blockquote>\n\n<p>The date is:</p>\n\n<blockquote>\n  <p>892009</p>\n</blockquote>\n\n<p>The code is:</p>\n\n<blockquote>\n  <p>if t, err := time.Parse(\"122006\",\"892009\"); err != nil {\n        fmt.Println(err.Error())     } else {       fmt.Println(t)  }</p>\n</blockquote>\n"}, {"tags": ["go", "kubernetes-go-client"], "answers": [{"tags": [], "owner": {"reputation": 501, "user_id": 4551937, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/597eb27df0e89f132a56dc8cccc1bad8?s=128&d=identicon&r=PG", "display_name": "Hiruma", "link": "https://stackoverflow.com/users/4551937/hiruma"}, "is_accepted": false, "score": 0, "last_activity_date": 1509481656, "last_edit_date": 1509481656, "creation_date": 1509469050, "answer_id": 47040659, "question_id": 47023715, "link": "https://stackoverflow.com/questions/47023715/manipulate-kubernetes-client-go-podlist/47040659#47040659", "title": "Manipulate Kubernetes&#39; client-go PodList", "body": "<p>I found the solution, but instead of shamelessly remove this, I will provide an answer:</p>\n\n<p>The Spec and Status struct I wanted to access are simply reachable using something like <code>pod.Spec.NodeName</code> or <code>pod.Status.StartTime</code>...</p>\n\n<p>If somebody can provide a more elaborated answer to complement this, please do.</p>\n"}], "owner": {"reputation": 501, "user_id": 4551937, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/597eb27df0e89f132a56dc8cccc1bad8?s=128&d=identicon&r=PG", "display_name": "Hiruma", "link": "https://stackoverflow.com/users/4551937/hiruma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 760, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509481656, "creation_date": 1509395593, "question_id": 47023715, "link": "https://stackoverflow.com/questions/47023715/manipulate-kubernetes-client-go-podlist", "title": "Manipulate Kubernetes&#39; client-go PodList", "body": "<p>I am poking around Kubernetes client-go and cannot get my mind around the proper way to manipulate the Pod struct...</p>\n\n<p>I get a <a href=\"https://godoc.org/k8s.io/kubernetes/pkg/api#PodList\" rel=\"nofollow noreferrer\">PodList</a> <strong>pods</strong> like this:</p>\n\n<pre><code>// creates the clientset\nclientset, err := kubernetes.NewForConfig(config)\nif err != nil {\n    glog.Fatal(err)\n}\n// Get Pods\npods, err := clientset.CoreV1().Pods(\"\").List(meta_v1.ListOptions{})\nif err != nil {\n    fmt.Println(err)\n    return\n}\n</code></pre>\n\n<p>I can then get some of the values for each <a href=\"https://godoc.org/k8s.io/kubernetes/pkg/api#Pod\" rel=\"nofollow noreferrer\">Pod</a> using a loop like</p>\n\n<pre><code>for _, pod := range pods.Items {\n    fmt.Println(pod.GetName(), pod.Namespace)\n}\n</code></pre>\n\n<p>But only from the <strong>ObjectMeta struct</strong>, which has some Getters (pod.GetName()), using <em>.Value</em> works too (pod.Namespace). I can't get my head around what's the proper way to access the data nested in <a href=\"https://godoc.org/k8s.io/kubernetes/pkg/api#PodSpec\" rel=\"nofollow noreferrer\">Spec PodSpec</a> and <a href=\"https://godoc.org/k8s.io/kubernetes/pkg/api#PodStatus\" rel=\"nofollow noreferrer\">Status PodStatus</a>.</p>\n\n<p>Maybe I am lacking some core Golang concepts... Can anybody enlight me, point me into some direction or provide me a generic example of the proper way to do this ?</p>\n"}, {"tags": ["go", "aws-sdk", "aws-sdk-go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509396406, "post_id": 47022778, "comment_id": 80994838, "body": "Not posting as an answer because I don&#39;t know for sure in this specific case, but my past experiences with AWS SDKs and temporary credentials show that you need to create the client at startup, and if/when it stops working, then create a new client. Every request is more often than needed, but one created at startup may not work forever."}], "owner": {"reputation": 59791, "user_id": 467473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af668442ab8ce6408bd051b350d89c01?s=128&d=identicon&r=PG", "display_name": "Nicholas Carey", "link": "https://stackoverflow.com/users/467473/nicholas-carey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1928, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1509587516, "creation_date": 1509391341, "last_edit_date": 1509587516, "question_id": 47022778, "link": "https://stackoverflow.com/questions/47022778/how-to-assume-cross-account-role", "title": "How to Assume Cross-Account Role?", "body": "<p>AWS' Golang SDK says that I should use <code>stscreds.AssumeRoleProvider</code> to assume a cross-account role (in this case, for querying another account's DynamoDb table from a web server). This code works:</p>\n\n<pre><code>var sess *session.Session\n\nfunc init() {\n\n  sess = session.Must(session.NewSession(&amp;aws.Config{\n    Region: aws.String(\"us-west-2\"),\n  }))\n\n}\n\nfunc getDynamoDbClient() *dynamodb.DynamoDB {\n\n  crossAccountRoleArn := \"arn:...:my-cross-account-role-ARN\"\n\n  creds := stscreds.NewCredentials(sess, crossAccountRoleArn, func(arp *stscreds.AssumeRoleProvider) {\n    arp.RoleSessionName = \"my-role-session-name\"\n    arp.Duration = 60 * time.Minute\n    arp.ExpiryWindow = 30 * time.Second\n  })\n\n  dynamoDbClient := dynamodb.New(sess, aws.NewConfig().WithCredentials(creds))\n\n  return dynamoDbClient\n}\n</code></pre>\n\n<p>According to the documentation, the returned client is thread-safe:</p>\n\n<blockquote>\n  <p>DynamoDB methods are safe to use concurrently.</p>\n</blockquote>\n\n<p>The question is, since the credential are auto-renewed via <code>stscreds.AssumeRoleProvider</code>, do I</p>\n\n<ul>\n<li><p>Need to new up a new client on each request (to ensure that I've got unexpired credentials), or</p></li>\n<li><p>Can I new up a DynamoDb client when the web server starts up, and reuse it for the life of the web server?</p></li>\n</ul>\n\n<h1>Edited To Note:</h1>\n\n<p>I dug into the source code for the Golang AWS SDK, and it looks like the credentials returned by <code>stscreds.NewCredentials()</code> are nothing more than a wrapper around a reference to the <code>stscreds.AssumeRoleProvider</code>. So it seems likely to me that the client will magically get auto-renewed credentials.</p>\n\n<p>AWS' documentation leaves something to be desired.</p>\n"}, {"tags": ["loops", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1509389334, "post_id": 47022257, "comment_id": 80991480, "body": "you <i>don&#39;t</i> want to access it outside of its scope, otherwise you can only properly handle the last response. Also, don&#39;t ignore errors, and don&#39;t try to reuse the http.Request."}, {"owner": {"reputation": 2638, "user_id": 627864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ed85106a2d78d5891a5181fb690b21d?s=128&d=identicon&r=PG", "display_name": "seoppc", "link": "https://stackoverflow.com/users/627864/seoppc"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509389419, "post_id": 47022257, "comment_id": 80991529, "body": "I&#39;ve tried this approach to make speed/response faster. Would you be able to post an example to understand this better please?  Thanks @JimB"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1509389753, "post_id": 47022257, "comment_id": 80991711, "body": "Things can appear very fast when they error out immediately and you ignore the errors. The proper pattern for handling an http response is right at the top of the documentation page: <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http</a>"}, {"owner": {"reputation": 2638, "user_id": 627864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ed85106a2d78d5891a5181fb690b21d?s=128&d=identicon&r=PG", "display_name": "seoppc", "link": "https://stackoverflow.com/users/627864/seoppc"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509389959, "post_id": 47022257, "comment_id": 80991794, "body": "Thanks @JimB for suggestion. How to do loop properly to make 10 requests?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1509390729, "post_id": 47022257, "comment_id": 80992193, "body": "You do it the same way you make one request; make the <code>http.Request</code> with a new payload, <code>Do()</code> the request, handle the response."}, {"owner": {"reputation": 2638, "user_id": 627864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ed85106a2d78d5891a5181fb690b21d?s=128&d=identicon&r=PG", "display_name": "seoppc", "link": "https://stackoverflow.com/users/627864/seoppc"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509390801, "post_id": 47022257, "comment_id": 80992225, "body": "How to get rid of <code>undefined: res</code> error?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1509390928, "post_id": 47022257, "comment_id": 80992300, "body": "That&#39;s not an issue if you&#39;re handling the response in the loop."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1509394333, "post_id": 47023176, "comment_id": 80993874, "body": "Calling defer in a loop is usually a bug. Here it&#39;s preventing the re-use of the http connections between calls, and since you&#39;re ignoring the error, it will panic on the second round."}, {"owner": {"reputation": 4737, "user_id": 36693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/OWMEs.jpg?s=128&g=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/36693/nate"}, "edited": false, "score": 1, "creation_date": 1509466085, "post_id": 47023176, "comment_id": 81026229, "body": "Good catch JimB. I didn&#39;t realize that was the case so I edited the answer to prevent confusion."}], "tags": [], "owner": {"reputation": 1350, "user_id": 5277071, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jT4bNbzKK7E/AAAAAAAAAAI/AAAAAAAAUMc/h4yiKAr93wQ/photo.jpg?sz=128", "display_name": "Rafael Quintela", "link": "https://stackoverflow.com/users/5277071/rafael-quintela"}, "is_accepted": false, "score": 0, "last_activity_date": 1509466030, "last_edit_date": 1509466030, "creation_date": 1509393203, "answer_id": 47023176, "question_id": 47022257, "link": "https://stackoverflow.com/questions/47022257/go-http-requests-in-loop/47023176#47023176", "title": "go http requests in loop", "body": "<p>You are trying to close the var res that is inside the for loop.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"strings\"\n)\n\nfunc main() {\n\n    url := \"https://uri.api.dev\"\n\n    payload := strings.NewReader(\"param1=example&amp;version=2\")\n\n    req, _ := http.NewRequest(\"POST\", url, payload)\n\n    req.Header.Add(\"content-type\", \"application/x-www-form-urlencoded\")\n\n    for i := 1; i &lt;= 10; i++ {\n        // just close it here\n        res, _ := http.DefaultClient.Do(req)\n        defer res.Body.Close()\n\n        body, _ := ioutil.ReadAll(res.Body)\n\n        fmt.Println(string(body))\n    }\n}\n</code></pre>\n\n<p>ps.: you could run those in go routines and sync the response for better performance</p>\n\n<p>Update by \"Nate\" to avoid confusion. The defer call above is not recommended. Checkout this code at <a href=\"https://play.golang.org/p/6mQ_3-4aHM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/6mQ_3-4aHM</a> or below:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    for i := 0; i &lt; 10; i++ {\n        defer fmt.Printf(\"iter %d\\n\", i)\n    }\n    fmt.Println(\"end of main\")\n\n}\n</code></pre>\n\n<p>and the output:</p>\n\n<pre><code>end of main\niter 9\niter 8\niter 7\niter 6\niter 5\niter 4\niter 3\niter 2\niter 1\niter 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2638, "user_id": 627864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ed85106a2d78d5891a5181fb690b21d?s=128&d=identicon&r=PG", "display_name": "seoppc", "link": "https://stackoverflow.com/users/627864/seoppc"}, "edited": false, "score": 0, "creation_date": 1509407649, "post_id": 47023194, "comment_id": 80999003, "body": "Thanks a lot for great explanation. How can we connection persistent using this approach as calling <code>res.Body.Close()</code> inside loop would close the connection each time."}, {"owner": {"reputation": 4737, "user_id": 36693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/OWMEs.jpg?s=128&g=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/36693/nate"}, "reply_to_user": {"reputation": 2638, "user_id": 627864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ed85106a2d78d5891a5181fb690b21d?s=128&d=identicon&r=PG", "display_name": "seoppc", "link": "https://stackoverflow.com/users/627864/seoppc"}, "edited": false, "score": 1, "creation_date": 1509463489, "post_id": 47023194, "comment_id": 81024436, "body": "Here&#39;s some info from the docs. It appears that closing the body is critical to doing exactly what you want, keep the TCP connection open. The call to Close() is intended for the Reader, not the TCP connection. &quot;If the returned error is nil, the Response will contain a non-nil Body which the user is expected to close. If the Body is not closed, the Client&#39;s underlying RoundTripper (typically Transport) may not be able to re-use a persistent TCP connection to the server for a subsequent &quot;keep-alive&quot; request.&quot;"}, {"owner": {"reputation": 2638, "user_id": 627864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ed85106a2d78d5891a5181fb690b21d?s=128&d=identicon&r=PG", "display_name": "seoppc", "link": "https://stackoverflow.com/users/627864/seoppc"}, "edited": false, "score": 0, "creation_date": 1509469624, "post_id": 47023194, "comment_id": 81028420, "body": "Thanks @Nate for great answer, you helped a lot. :)"}, {"owner": {"reputation": 2638, "user_id": 627864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ed85106a2d78d5891a5181fb690b21d?s=128&d=identicon&r=PG", "display_name": "seoppc", "link": "https://stackoverflow.com/users/627864/seoppc"}, "edited": false, "score": 0, "creation_date": 1509469734, "post_id": 47023194, "comment_id": 81028509, "body": "I&#39;ve already implemented goroutines for concurrency, I also want to implement parallelism, Can you please recommend me a better way for that, could not find anything related online.  Thanks once again."}, {"owner": {"reputation": 4737, "user_id": 36693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/OWMEs.jpg?s=128&g=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/36693/nate"}, "reply_to_user": {"reputation": 2638, "user_id": 627864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ed85106a2d78d5891a5181fb690b21d?s=128&d=identicon&r=PG", "display_name": "seoppc", "link": "https://stackoverflow.com/users/627864/seoppc"}, "edited": false, "score": 0, "creation_date": 1509471169, "post_id": 47023194, "comment_id": 81029420, "body": "Take a look at <a href=\"https://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow noreferrer\">golang.org/pkg/runtime/#GOMAXPROCS</a>. Basically you set the number of processors you want to use and the runtime spreads your goroutines across them. With modern Go, if you have more than one CPU or core, it should adjust GOMAXPROCS accordingly."}], "tags": [], "owner": {"reputation": 4737, "user_id": 36693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/OWMEs.jpg?s=128&g=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/36693/nate"}, "is_accepted": true, "score": 5, "last_activity_date": 1509394038, "last_edit_date": 1509394038, "creation_date": 1509393289, "answer_id": 47023194, "question_id": 47022257, "link": "https://stackoverflow.com/questions/47022257/go-http-requests-in-loop/47023194#47023194", "title": "go http requests in loop", "body": "<p>Go has block scope so if you create a variable in an inner scope you cannot access it in the outer scope. You would need to declare res outside your loop to access it after the loop is complete.</p>\n\n<pre><code>var res *http.Response\n\nfor i := 1; i &lt;= 10; i++ {\n\n    res, _ = http.DefaultClient.Do(req)\n\n    body, _ := ioutil.ReadAll(res.Body)\n\n    fmt.Println(string(body))\n\n}\n\n//This is wrong\ndefer res.Body.Close()\n</code></pre>\n\n<p>As noted above, defer res.Body.Close() above is wrong too because you should close each new body you read.</p>\n\n<p>Also as noted, you should definitely be using and checking err on all your calls.</p>\n\n<p>One brief and naive way I might change this:</p>\n\n<pre><code>for i := 1; i &lt;= 10; i++ {\n    url := \"https://uri.api.dev\"\n    payload := strings.NewReader(\"param1=example&amp;version=2\")\n    req, err := http.NewRequest(\"POST\", url, payload)\n    if err != nil {\n        //Specific error handling would depend on scenario\n        fmt.Printf(\"%v\\n\", err)\n        return\n    }\n    req.Header.Add(\"content-type\", \"application/x-www-form-urlencoded\")\n\n    res, err := http.DefaultClient.Do(req)\n    if err != nil {\n        //Specific error handling would depend on scenario\n        fmt.Printf(\"%v\\n\", err)\n        return\n    }\n\n    body, err := ioutil.ReadAll(res.Body)\n        if err != nil {\n        //Specific error handling would depend on scenario\n        fmt.Printf(\"%v\\n\", err)\n        return\n    }\n\n    fmt.Println(string(body))\n    res.Body.Close()\n}\n</code></pre>\n\n<p>Something to think about here. You are wanting to make 10 calls to an API in serial. A natural extension to that is to do the test in parallel or at least concurrently using the 'go' keyword. For that you can't share variables across your loop iterations. Something like:</p>\n\n<pre><code>for i := 1; i &lt;= 10; i++ {\n    //Where testApi is the whole process encapsulated for one iteration\n    go testApi()\n}\n</code></pre>\n\n<p>Finally, don't prematurely optimize. Variables with restricted scope will prevent bugs and maintenance headaches long term.</p>\n\n<p>Hope this helps.</p>\n\n<p>Ninja Edit:</p>\n\n<p>Do not make loops start at a non-zero number without a good reason, this is probably the most common way to think about your loop below. The 1 - 10 version feels very VB/VB.Net.</p>\n\n<pre><code>for i := 0; i &lt; 10; i++ {\n    //Where testApi is the whole process encapsulated for one iteration\n    go testApi()\n}\n</code></pre>\n"}], "owner": {"reputation": 2638, "user_id": 627864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ed85106a2d78d5891a5181fb690b21d?s=128&d=identicon&r=PG", "display_name": "seoppc", "link": "https://stackoverflow.com/users/627864/seoppc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3321, "favorite_count": 0, "accepted_answer_id": 47023194, "answer_count": 2, "score": 2, "last_activity_date": 1509466030, "creation_date": 1509389207, "question_id": 47022257, "link": "https://stackoverflow.com/questions/47022257/go-http-requests-in-loop", "title": "go http requests in loop", "body": "<p>I've recently started with GoLang and tried following..</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"net/http\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n\n    url := \"https://uri.api.dev\"\n\n    payload := strings.NewReader(\"param1=example&amp;version=2\")\n\n    req, _ := http.NewRequest(\"POST\", url, payload)\n\n    req.Header.Add(\"content-type\", \"application/x-www-form-urlencoded\")\n\n    for i := 1; i &lt;= 10; i++ {\n\n        res, _ := http.DefaultClient.Do(req)\n\n        body, _ := ioutil.ReadAll(res.Body)\n\n        fmt.Println(string(body))\n\n    }\n\n    defer res.Body.Close()\n\n}\n</code></pre>\n\n<p>It throws 'undefined: res' error when i try to run this. I want to make 10 http requests to an API uri and <code>res.Body.Close()</code> at last to keep connection persistent for speed. How can we access res variable outside of its scope and make this code work.  Please help, Thanks</p>\n"}, {"tags": ["forms", "http", "parsing", "go"], "answers": [{"tags": [], "owner": {"reputation": 944, "user_id": 1498624, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/4WQ2c.jpg?s=128&g=1", "display_name": "grabthefish", "link": "https://stackoverflow.com/users/1498624/grabthefish"}, "is_accepted": true, "score": 4, "last_activity_date": 1509388432, "creation_date": 1509388432, "answer_id": 47022058, "question_id": 47021914, "link": "https://stackoverflow.com/questions/47021914/go-http-form-parsing-returns-empty-slice-empty-values/47022058#47022058", "title": "Go HTTP Form Parsing - Returns empty slice/empty values?", "body": "<p>try changing the content-type on your Postman request from <code>form-data</code> to <code>x-www-form-urlencoded</code></p>\n\n<p>Because according to the <a href=\"https://golang.org/pkg/net/http/#Request.ParseForm\" rel=\"nofollow noreferrer\">docs</a> on <code>r.ParseForm()</code> the body won't be parsed unless it's <code>x-www-form-urlencoded</code></p>\n\n<blockquote>\n  <p>For other HTTP methods, or when the Content-Type is not\n  application/x-www-form-urlencoded, the request Body is not read, and\n  r.PostForm is initialized to a non-nil, empty value.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "is_accepted": false, "score": 0, "last_activity_date": 1509394398, "creation_date": 1509394398, "answer_id": 47023457, "question_id": 47021914, "link": "https://stackoverflow.com/questions/47021914/go-http-form-parsing-returns-empty-slice-empty-values/47023457#47023457", "title": "Go HTTP Form Parsing - Returns empty slice/empty values?", "body": "<p>I suggest you first check content type then read form data with request.FormValue(\"example\") if you use form you always check key is valid in map or not and if you don't It's make a runtime error.</p>\n\n<pre><code>func login(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"method:\", r.Method) //get request method\n    if r.Method == \"GET\" {\n        t, _ := template.ParseFiles(\"login.gtpl\")\n        t.Execute(w, nil)\n    } else {\n        fmt.Println(\"username:\", r.FormValue(\"username\"))\n        fmt.Println(\"password:\", r.FormValue(\"password\"))\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6278490, "user_type": "registered", "profile_image": "https://graph.facebook.com/590252411150943/picture?type=large", "display_name": "Larry Chen", "link": "https://stackoverflow.com/users/6278490/larry-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1515, "favorite_count": 0, "accepted_answer_id": 47022058, "answer_count": 2, "score": 1, "last_activity_date": 1509394398, "creation_date": 1509387937, "last_edit_date": 1509388337, "question_id": 47021914, "link": "https://stackoverflow.com/questions/47021914/go-http-form-parsing-returns-empty-slice-empty-values", "title": "Go HTTP Form Parsing - Returns empty slice/empty values?", "body": "<p>I have written a simple web application in Go that needs to read values of an HTTP form (username, password) etc. However, I found that the values were empty when printed. <code>len(r.Form)</code> and <code>len(r.Form[\"password\"])</code> both return 0.</p>\n\n<p>I have called <code>r.ParseForm()</code> in the application before trying to read the fields and I'm using Postman to send the requests. Tested on both Linux and macOS.</p>\n\n<p>The code I am using to test this is some example code from the Astaxie golang web tutorial. I have attached my <a href=\"https://i.stack.imgur.com/qHmZ4.jpg\" rel=\"nofollow noreferrer\">Postman request</a>. It looks like this so far:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n    \"strings\"\n    \"time\"\n)\n\nfunc sayhelloName(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm() //Parse url parameters passed, then parse the response packet for the POST body (request body)\n    // attention: If you do not call ParseForm method, the following data can not be obtained form\n    fmt.Println(r.Form) // print information on server side.\n    fmt.Println(\"path\", r.URL.Path)\n    fmt.Println(\"scheme\", r.URL.Scheme)\n    fmt.Println(r.Form[\"url_long\"])\n    for k, v := range r.Form {\n        fmt.Println(\"key:\", k)\n        fmt.Println(\"val:\", strings.Join(v, \"\"))\n    }\n    fmt.Fprintf(w, \"Hello astaxie!\") // write data to response\n}\n\nfunc login(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"method:\", r.Method) //get request method\n    if r.Method == \"GET\" {\n        t, _ := template.ParseFiles(\"login.gtpl\")\n        t.Execute(w, nil)\n    } else {\n        r.ParseForm()\n        time.Sleep(3 * time.Second)\n        // logic part of log in\n        fmt.Println(\"username:\", len(r.Form))\n        fmt.Println(\"password:\", len(r.Form[\"password\"]))\n    }\n\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", sayhelloName) // setting router rule\n    http.HandleFunc(\"/login\", login)\n    err := http.ListenAndServe(\":9090\", nil) // setting listening port\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n\n<p>Any suggestions on what to do next?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1509381813, "post_id": 47020187, "comment_id": 80987197, "body": "Something is wrong with your checkout of the golang.org/x/sys/unix package. Clean that out first."}, {"owner": {"reputation": 31, "user_id": 8857649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76bff5b257ac67116c78c7c2b9e2f4eb?s=128&d=identicon&r=PG&f=1", "display_name": "DanielD", "link": "https://stackoverflow.com/users/8857649/danield"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509384781, "post_id": 47020187, "comment_id": 80988977, "body": "Ok, I tried deleting the offending package and it might be worse than before! I don&#39;t get the same error, now I get this:    % go get github.com/maxbrunsfeld/counterfeiter package golang.org/x/sys/unix: cannot find package &quot;golang.org/x/sys/unix&quot; in any of: \t/usr/local/Cellar/go/1.9/libexec/src/golang.org/x/sys/unix (from $GOROOT) \t/Users/cbny/code/go/src/golang.org/x/sys/unix (from $GOPATH)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509385063, "post_id": 47020187, "comment_id": 80989163, "body": "Did you run <code>go get golang.org&#47;x&#47;sys&#47;unix</code>?"}, {"owner": {"reputation": 31, "user_id": 8857649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76bff5b257ac67116c78c7c2b9e2f4eb?s=128&d=identicon&r=PG&f=1", "display_name": "DanielD", "link": "https://stackoverflow.com/users/8857649/danield"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509386257, "post_id": 47020187, "comment_id": 80989825, "body": "Thanks Jim, I figured it out. Had to remove the entire golang.org package before I did the go get on golang.org/x/sys/unix"}], "answers": [{"tags": [], "owner": {"reputation": 1025, "user_id": 4863734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60aebd5ddf87a8d93a5f74eea8bc9a1d?s=128&d=identicon&r=PG", "display_name": "Ilya Rusin", "link": "https://stackoverflow.com/users/4863734/ilya-rusin"}, "is_accepted": false, "score": 0, "last_activity_date": 1564160130, "creation_date": 1564160130, "answer_id": 57224252, "question_id": 47020187, "link": "https://stackoverflow.com/questions/47020187/unexplained-errors-when-using-go-get/57224252#57224252", "title": "Unexplained errors when using &quot;go get&quot;", "body": "<p>Solved the same issue with just <code>GOOS=linux GOARCH=amd64 go get ...</code></p>\n"}], "owner": {"reputation": 31, "user_id": 8857649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76bff5b257ac67116c78c7c2b9e2f4eb?s=128&d=identicon&r=PG&f=1", "display_name": "DanielD", "link": "https://stackoverflow.com/users/8857649/danield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 492, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1564160130, "creation_date": 1509381443, "question_id": 47020187, "link": "https://stackoverflow.com/questions/47020187/unexplained-errors-when-using-go-get", "title": "Unexplained errors when using &quot;go get&quot;", "body": "<p>I'm using go 1.9 on OS X 10.12.6. I was attempting to \"go get\" github.com/maxbrunsfeld/counterfeiter, and was presented with the following cryptic errors:</p>\n\n<pre><code>  % go get github.com/maxbrunsfeld/counterfeiter   \n# golang.org/x/sys/unix\ncode/go/src/golang.org/x/sys/unix/dirent.go:68:17: undefined: direntReclen\ncode/go/src/golang.org/x/sys/unix/dirent.go:74:14: undefined: direntIno\ncode/go/src/golang.org/x/sys/unix/dirent.go:81:24: constant -1000000000 overflows uint64\ncode/go/src/golang.org/x/sys/unix/dirent.go:81:41: undefined: Dirent\ncode/go/src/golang.org/x/sys/unix/dirent.go:82:17: undefined: direntNamlen\ncode/go/src/golang.org/x/sys/unix/flock.go:13:30: undefined: SYS_FCNTL\ncode/go/src/golang.org/x/sys/unix/flock.go:16:42: undefined: Flock_t\ncode/go/src/golang.org/x/sys/unix/flock.go:17:17: undefined: Syscall\n</code></pre>\n\n<p>I also attempted to go get with -u and -v, and while verbose mode provides some more information, none is really relevant to the errors seen here. Has anyone seen anything like this before?</p>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1509369520, "post_id": 47016103, "comment_id": 80978737, "body": "<code>[]byte{0, 2, 0, 0, 0, 0}</code> is definitely not a hex representation of 131072. A hex string must be printable characters by definition. It&#39;s looks similar to a binary little endian representation, but it&#39;s neither 32 nor 64 bits."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509372635, "post_id": 47016103, "comment_id": 80981030, "body": "131072 as a big endian uint32 is <code>[]byte{0, 2, 0, 0}</code>, but you have a 6 bytes buffer. Are you certain that this is how the data is specified? Are you sure you&#39;re not supposed to be reading <code>020000</code> as the hex string itself? Parsing <code>[]byte{0, 2, 0, 1}</code> and <code>020100</code> are going to produce different results."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509370484, "post_id": 47016556, "comment_id": 80979419, "body": "This still converts the bytes into a string and then parses the string back into bytes - I think the binary package is more efficient and more intuitive in this case."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509370770, "post_id": 47016556, "comment_id": 80979637, "body": "@Adrian Yes, this isn&#39;t the fastest way, I was on to show why his solution doesn&#39;t work. To use the <code>encoding&#47;binary</code> package, you would also have to merge 2 digits as that forms a <code>byte</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509371099, "post_id": 47016556, "comment_id": 80979881, "body": "131072 as a 32 bit big endian int is <code>[]byte{0, 2, 0, 0}</code>, which seems to be the closest, but the fact that it&#39;s in a 6 byte buffer and asking about hex means that there is information missing from the question that we need to answer it either way."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509371254, "post_id": 47016556, "comment_id": 80980021, "body": "@JimB The asker wants to convert the number <code>&quot;20000&quot;</code>, I don&#39;t know how (or rather <i>why</i>) he ended up with the byte values <code>0, 2, 0, 0, 0</code>, but using the byte values as  digits gives the expected result."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509372195, "post_id": 47016556, "comment_id": 80980695, "body": "Exactly. Without knowing the specification, we can&#39;t be sure if 020100 is supposed to be 131328 or 131073."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1509370618, "last_edit_date": 1509370618, "creation_date": 1509370282, "answer_id": 47016556, "question_id": 47016103, "link": "https://stackoverflow.com/questions/47016103/trying-to-parse-byte-slice-as-base-16-number-in-golang/47016556#47016556", "title": "Trying to parse byte slice as base 16 number in Golang", "body": "<p>Never omit errors, always check them!</p>\n\n<pre><code>func headerVersion(input []byte) int {\n    output, err := strconv.ParseUint(string(input), 16, 64)\n    if err != nil {\n        fmt.Println(err)\n    }\n    return int(output)\n}\n</code></pre>\n\n<p>Feeding <code>[]byte{0, 2, 0, 0, 0, 0}</code> to it, it will print:</p>\n\n<pre><code>strconv.ParseUint: parsing \"\\x00\\x02\\x00\\x00\\x00\\x00\": invalid syntax\n</code></pre>\n\n<p>When you do <code>string(input)</code>, it converts the bytes of <code>input</code> interpreted as the UTF-8 encoded bytes of a text.</p>\n\n<p>But <code>input</code> contains the <em>numerical</em> values of the digits, not the UTF-8 representation! The numerical value for a <code>0</code> digit is <code>'0'</code>, which equals to <code>48</code>.</p>\n\n<p>So you have to shift the byte values by <code>'0'</code> (this demonstration only works if byte values are less than 10!):</p>\n\n<pre><code>func headerVersion(input []byte) int {\n    for i := range input {\n        input[i] += '0'\n    }\n    output, err := strconv.ParseUint(string(input), 16, 64)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    return int(output)\n}\n</code></pre>\n\n<p>Your original <code>headerVersion()</code> function would only give correct, valid result if you would feed it the following input:</p>\n\n<pre><code>input := []byte{'0', '2', '0', '0', '0', '0'}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user99874"}, "edited": false, "score": 0, "creation_date": 1509371043, "post_id": 47016605, "comment_id": 80979829, "body": "Thanks I&#39;m going to try to get your suggestion working."}, {"owner": {"user_type": "does_not_exist", "display_name": "user99874"}, "edited": false, "score": 0, "creation_date": 1509371558, "post_id": 47016605, "comment_id": 80980230, "body": "Got it. Thank you! <a href=\"https://play.golang.org/p/0WaGkECOZS\" rel=\"nofollow noreferrer\">play.golang.org/p/0WaGkECOZS</a>. As the play code shows it can be done like this: <code>binary.BigEndian.Uint32([]byte{0, 2, 0, 0, 0, 0})</code>"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1509373569, "post_id": 47016605, "comment_id": 80981734, "body": "@nbsp the <code>b[0:]</code> in your play code is verbose, <code>b</code> would suffice."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1509370427, "creation_date": 1509370427, "answer_id": 47016605, "question_id": 47016103, "link": "https://stackoverflow.com/questions/47016103/trying-to-parse-byte-slice-as-base-16-number-in-golang/47016605#47016605", "title": "Trying to parse byte slice as base 16 number in Golang", "body": "<p>You've got a raw byte slice that is the bytes making up the number you want, but you're instead parsing it as if it were the bytes making up the string representation of the bytes making up the number you want. Rather than attempting to parse as a string, parse as what it is - bytes. You can do this using the <a href=\"https://golang.org/pkg/encoding/binary/\" rel=\"nofollow noreferrer\"><code>binary</code> package</a>, which, per its documentation:</p>\n\n<blockquote>\n  <p>implements simple translation between numbers and byte sequences and encoding and decoding of varints.</p>\n</blockquote>\n\n<p>Which is exactly what you want. How you use it will depend on the endianness and encoding of the data, but the documentation should get you going in the right direction.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user99874"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1027, "favorite_count": 0, "accepted_answer_id": 47016605, "answer_count": 2, "score": 0, "last_activity_date": 1537191738, "creation_date": 1509368964, "last_edit_date": 1537191738, "question_id": 47016103, "link": "https://stackoverflow.com/questions/47016103/trying-to-parse-byte-slice-as-base-16-number-in-golang", "title": "Trying to parse byte slice as base 16 number in Golang", "body": "<p>I'm trying to parse a slice of bytes with the below value <code>020000</code> to as a base 16 number but haven't gotten it working yet. What am I doing wrong?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    input := []byte{0, 2, 0, 0, 0, 0}\n    expectation := 131072\n\n    actual := headerVersion(input)\n\n    if actual != expectation {\n        panic(fmt.Sprintf(\"Expected %v but got %v.\", expectation, actual))\n    }\n}\n\nfunc headerVersion(input []byte) int {\n    output, _ := strconv.ParseUint(string(input), 16, 64)\n    return int(output)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/eM5RQAJdoL\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eM5RQAJdoL</a></p>\n"}, {"tags": ["go", "struct", "type-assertion"], "comments": [{"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1509405737, "post_id": 47014890, "comment_id": 80998467, "body": "Not exactly that but there is a feature request to create new type names using reflect. <a href=\"https://github.com/golang/go/issues/16522\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/16522</a> . There is also the plugin package. <a href=\"https://golang.org/pkg/plugin/\" rel=\"nofollow noreferrer\">golang.org/pkg/plugin</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1624, "user_id": 3577360, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62ed0f4309cffd5b9ce23f7d8afb34d1?s=128&d=identicon&r=PG&f=1", "display_name": "Zander17", "link": "https://stackoverflow.com/users/3577360/zander17"}, "edited": false, "score": 0, "creation_date": 1509366409, "post_id": 47015211, "comment_id": 80976725, "body": "Ah okay.. I had my suspensions that would be the case. Thank you for that good explanation."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1509366430, "last_edit_date": 1509366430, "creation_date": 1509366268, "answer_id": 47015211, "question_id": 47014890, "link": "https://stackoverflow.com/questions/47014890/typecast-to-a-specific-struct-type-by-its-string-name/47015211#47015211", "title": "Typecast to a specific struct type by its string name", "body": "<p>It is not possible. Go is a statically typed language, which means types of variables and expressions must be known at compile-time.</p>\n\n<p>In a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>:</p>\n\n<blockquote>\n<pre><code>x.(T)\n</code></pre>\n  \n  <p>[...] If the type assertion holds, the value of the expression is the value stored in <code>x</code> and its type is <code>T</code>.</p>\n</blockquote>\n\n<p>So you use type assertion to get (or test for) a value of a type you specify.</p>\n\n<p>When you would do:</p>\n\n<pre><code>stringName := \"Testing\"\nnewTestingVariable.(stringName)\n</code></pre>\n\n<p>What would be the <em>type</em> of the result of the type assertion? You didn't tell. You specified a <code>string</code> value containing the type name, but this can only be decided at <em>runtime</em>. (Yes, in the above example the compiler could track the value as it is given as a constant value, but in the general case this is not possible at compile time.)</p>\n\n<p>So at compile time the compiler could only use <code>interface{}</code> as the type of the result of the type expression, but then what's the point?</p>\n\n<p>If the point would be to dynamically test if <code>x</code>'s type is <code>T</code> (or that if the interface value <code>x</code> implements <code>T</code>), you can use reflection for that (package <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a>). In this case you would use a <code>reflect.Type</code> to specify the type to be tested, instead of a <code>string</code> representation of its name.</p>\n"}], "owner": {"reputation": 1624, "user_id": 3577360, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62ed0f4309cffd5b9ce23f7d8afb34d1?s=128&d=identicon&r=PG&f=1", "display_name": "Zander17", "link": "https://stackoverflow.com/users/3577360/zander17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 47015211, "answer_count": 1, "score": 0, "last_activity_date": 1530109219, "creation_date": 1509365320, "last_edit_date": 1530109219, "question_id": 47014890, "link": "https://stackoverflow.com/questions/47014890/typecast-to-a-specific-struct-type-by-its-string-name", "title": "Typecast to a specific struct type by its string name", "body": "<p>I would like to typecast a specific variable to a specific defined struct/interface by using the string name value of the struct/interface.</p>\n\n<p>For example:</p>\n\n<pre><code>type Testing interface{}\n</code></pre>\n\n<p>and new variable</p>\n\n<pre><code>stringName := \"Testing\"\nnewTestingVariable.(stringName)\n</code></pre>\n\n<p>Is this possible by chance? Perhaps using reflection?</p>\n\n<p>Cheers</p>\n"}, {"tags": ["go", "stream", "ioerror"], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 3879300, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/036ab4e24d4109007a06bf11b8301112?s=128&d=identicon&r=PG&f=1", "display_name": "Baber", "link": "https://stackoverflow.com/users/3879300/baber"}, "is_accepted": false, "score": 0, "last_activity_date": 1510654945, "last_edit_date": 1510654945, "creation_date": 1510654639, "answer_id": 47283079, "question_id": 47012475, "link": "https://stackoverflow.com/questions/47012475/how-to-handle-error-ioerror-closed-stream-in-golang-scan-function/47283079#47283079", "title": "How to handle &quot;ERROR: IOError: closed stream&quot; in Golang scan function?", "body": "<p>After looking into some forums, Go Docs and trying some code changes, finally replacing the scan method in bufio to ReadLine of textproto worked for me.</p>\n\n<p>I replaced the following code:</p>\n\n<pre><code>inp := bufio.NewScanner(multi)\nerr := cmd.Start()\nif err != nil {\n    utils.Info.Println(\"Error while creating client\", err)\n    return false\n}\nfmt.Println(\"Generating logs**************\")\nfor inp.Scan() {\n    line := inp.Text()\n    if cr_id == \"\" {\n        lg.SendDebugLogs(line, \"projects/logs\", projectId, \"chef\")\n    } else {\n        lg.SendDebugLogs(line, \"changeRequests/logs\", cr_id, \"chef\")\n    }\n}\n</code></pre>\n\n<p>With the following code:</p>\n\n<pre><code>    inp1 := bufio.NewReader(multi)\n\n    tp := textproto.NewReader( inp1 )\n\n    err := cmd.Start()\n    if err != nil {\n        utils.Info.Println(\"Error while creating client\", err)\n        return false\n    }\n    fmt.Println(\"Generating logs**************\")\n\n    /*\n    New code for logs starts here\n     */\n\n\n    for {\n        line, readErr := tp.ReadLine()\n\n        if readErr != nil {\n                break\n        }\n\n        if cr_id == \"\" {\n            lg.SendDebugLogs(line, \"projects/logs\", projectId, \"chef\")\n        } else {\n            lg.SendDebugLogs(line, \"changeRequests/logs\", cr_id, \"chef\")\n        }\n    }\n</code></pre>\n\n<p>At last, this modification worked perfectly fine for me by handling immediate restarts as well as long sleeps/waits in the chef recipe or scripts. Basically I changed the stream reader I hope this will be helpful for anyone else facing the same problem :)</p>\n"}], "owner": {"reputation": 181, "user_id": 3879300, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/036ab4e24d4109007a06bf11b8301112?s=128&d=identicon&r=PG&f=1", "display_name": "Baber", "link": "https://stackoverflow.com/users/3879300/baber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510654945, "creation_date": 1509357637, "last_edit_date": 1510240409, "question_id": 47012475, "link": "https://stackoverflow.com/questions/47012475/how-to-handle-error-ioerror-closed-stream-in-golang-scan-function", "title": "How to handle &quot;ERROR: IOError: closed stream&quot; in Golang scan function?", "body": "<p>I am using knife bootstrap command in Golang code to bootstrap nodes. Some times there is wait in recipe and it waits for more than 10 minutes. In such cases I am getting an error \"Error: IOStream Closed\". Is there any way I can increase the time limit? Also I am continuously reading the logs from output and error stream of cmd.</p>\n\n<pre><code>func executeCMDWorkstation(cmd *exec.Cmd, projectId, cr_id string) bool {\n\nstdout, err3 := cmd.StdoutPipe()\nif err3 != nil {\n    utils.Info.Println(err3)\n    return false\n}\ndefer stdout.Close()\nstderr, err4 := cmd.StderrPipe()\nif err4 != nil {\n    utils.Info.Println(err4)\n    return false\n}\ndefer stderr.Close()\n\n//cmd.Stdout = os.Stdout\n//cmd.Stderr = os.Stderr\nmulti := io.MultiReader(stdout, stderr)\ninp := bufio.NewScanner(multi)\nerr := cmd.Start()\nif err != nil {\n    utils.Info.Println(\"Error while creating client\", err)\n    return false\n}\nfmt.Println(\"Generating logs**************\")\nfor inp.Scan() {\n\n    line := inp.Text()\n    if cr_id == \"\" {\n        lg.SendDebugLogs(line, \"projects/logs\", projectId, \"chef\")\n    } else {\n        lg.SendDebugLogs(line, \"changeRequests/logs\", cr_id, \"chef\")\n    }\n}\nexitStatus := cmd.Wait()\nif exiterr, ok := exitStatus.(*exec.ExitError); ok {\n    utils.Info.Println(\"************ Exit Status is:\", exiterr, \"************\")\n    return false\n}\n\nreturn true\n</code></pre>\n\n<p>Any help to improve this process would be highly appreciated.</p>\n"}, {"tags": ["html", "go", "gorilla"], "comments": [{"owner": {"reputation": 944, "user_id": 1498624, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/4WQ2c.jpg?s=128&g=1", "display_name": "grabthefish", "link": "https://stackoverflow.com/users/1498624/grabthefish"}, "edited": false, "score": 2, "creation_date": 1509363162, "post_id": 47009675, "comment_id": 80974666, "body": "i don&#39;t think this is because of the Gorilla mux but because of the <code>http.FileServer</code>, in the <a href=\"https://golang.org/pkg/net/http/#FileServer\" rel=\"nofollow noreferrer\">docs</a> it says <code>As a special case, the returned file server redirects any request ending in &quot;&#47;index.html&quot; to the same path, without the final &quot;index.html&quot;.</code>"}, {"owner": {"reputation": 87, "user_id": 6575937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02be9ef714436367018c1a7edda58c84?s=128&d=identicon&r=PG&f=1", "display_name": "Erez.L", "link": "https://stackoverflow.com/users/6575937/erez-l"}, "reply_to_user": {"reputation": 944, "user_id": 1498624, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/4WQ2c.jpg?s=128&g=1", "display_name": "grabthefish", "link": "https://stackoverflow.com/users/1498624/grabthefish"}, "edited": false, "score": 0, "creation_date": 1509371825, "post_id": 47009675, "comment_id": 80980403, "body": "dude you should have posted it as an answer cause you solved it!"}], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 1, "last_activity_date": 1509349133, "creation_date": 1509349133, "answer_id": 47010134, "question_id": 47009675, "link": "https://stackoverflow.com/questions/47009675/serving-static-html-using-gorilla-mux/47010134#47010134", "title": "Serving static html using Gorilla mux", "body": "<p>Maybe using a custom <code>http.HandlerFunc</code> would be easier:</p>\n\n<pre><code>http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    // Here you can check if path is empty, you can render index.html\n    http.ServeFile(w, r, r.URL.Path)\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "is_accepted": false, "score": 1, "last_activity_date": 1509355878, "last_edit_date": 1509355878, "creation_date": 1509355342, "answer_id": 47011693, "question_id": 47009675, "link": "https://stackoverflow.com/questions/47009675/serving-static-html-using-gorilla-mux/47011693#47011693", "title": "Serving static html using Gorilla mux", "body": "<p>You do have to make a custom handler because you want a custom behavior. Here, I just wrapped the <code>http.FileServer</code> handler.</p>\n\n<p>Try this one:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n\n    handler := mux.NewRouter()\n\n    fs := http.FileServer(http.Dir(\"./public\"))\n    handler.PathPrefix(\"/\").Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        if r.URL.Path == \"/\" {\n            //your default page\n            r.URL.Path = \"/my_default_page.html\"\n        }\n\n        fs.ServeHTTP(w, r)\n    })).Methods(\"GET\")\n\n    log.Fatal(http.ListenAndServe(\":8080\", handler))\n}\n</code></pre>\n\n<p>So, from the code, if the visited path is the root (<code>/</code>) then you rewrite the <code>r.URL.Path</code> to your default page, in this case <code>my_default_page.html</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 87, "user_id": 6575937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02be9ef714436367018c1a7edda58c84?s=128&d=identicon&r=PG&f=1", "display_name": "Erez.L", "link": "https://stackoverflow.com/users/6575937/erez-l"}, "is_accepted": true, "score": -1, "last_activity_date": 1509371781, "creation_date": 1509371781, "answer_id": 47017060, "question_id": 47009675, "link": "https://stackoverflow.com/questions/47009675/serving-static-html-using-gorilla-mux/47017060#47017060", "title": "Serving static html using Gorilla mux", "body": "<p>After grabthefish mentioned it i decided to check the actual code of gorilla serve mux.\nThis code is taken from net/http package which Gorilla mux is based on.</p>\n\n<pre><code>func serveFile(w ResponseWriter, r *Request, fs FileSystem, name string, \nredirect bool) {\nconst indexPage = \"/index.html\"\n\n// redirect .../index.html to .../\n// can't use Redirect() because that would make the path absolute,\n// which would be a problem running under StripPrefix\nif strings.HasSuffix(r.URL.Path, indexPage) {\n    localRedirect(w, r, \"./\")\n    return\n}\n</code></pre>\n\n<p>the code request the index file to be index.html in lower case so renaming my index file solved it.\nthank you grabthefish!</p>\n"}], "owner": {"reputation": 87, "user_id": 6575937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02be9ef714436367018c1a7edda58c84?s=128&d=identicon&r=PG&f=1", "display_name": "Erez.L", "link": "https://stackoverflow.com/users/6575937/erez-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3614, "favorite_count": 0, "accepted_answer_id": 47017060, "answer_count": 3, "score": -1, "last_activity_date": 1509371781, "creation_date": 1509347097, "last_edit_date": 1509350987, "question_id": 47009675, "link": "https://stackoverflow.com/questions/47009675/serving-static-html-using-gorilla-mux", "title": "Serving static html using Gorilla mux", "body": "<p>I'm using gorilla serve mux to serve static html files.</p>\n\n<pre><code>r := mux.NewRouter()\nr.PathPrefix(\"/\").Handler(http.FileServer(http.Dir(\"./public\"))).Methods(\"GET\")\n</code></pre>\n\n<p>I do have a <code>Index.html</code> file inside the public folder as well as other html files.</p>\n\n<p>When browsing the site I get all the content of the folder instead of the default Index.html.</p>\n\n<p>I came from C# and I know that IIS takes <code>Index.html</code> as default but it is possible to select any page as a default.</p>\n\n<p>I wanted to know if there's a proper way to select a default page to serve in Gorilla mux without creating a custom handler/wrapper.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1509370586, "post_id": 47009077, "comment_id": 80979487, "body": "If a function (e.g. <code>json.Marshal</code>) returns an error value, <i>never assume that it can&#39;t fail unless the documentation explicitly says so</i>. It returns an error for a reason."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509398717, "post_id": 47009077, "comment_id": 80995905, "body": "@Adrian you missed the point of this question. The point is to figure out why can it fail. So for me it is rather <i>if you see some things in the documentation for which you do not see a reason, ask other people and learn something new</i>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1509416492, "post_id": 47009077, "comment_id": 81000991, "body": "You misunderstand the point of the comment, and it&#39;s echoed in the accepted answer: the function returns an error value and the documentation doesn&#39;t say it will always be nil, so it may return an error, and the cases where it may return an error may vary between Go versions. If you want to know when it may return an error under a specific Go version, read the source of the function in that version."}], "answers": [{"comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1509355526, "post_id": 47010436, "comment_id": 80969816, "body": "Thank you very much for <code>int64</code>. I do not fully agree with &quot;The function is defined to return errors. This means that it is perfectly valid for the standard library developers to start returning new errors&quot; because the function can return an error operating on the interface. It does not mean that it can return an error operating on some particular example. But anyway thank you very much for an answer."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1509356010, "post_id": 47010436, "comment_id": 80970158, "body": "@SalvadorDali If I designed encoding/json I would make it fail for quite some possible values of your example struct. I like my encoders and decoders to be reversible, if I can&#39;t guarantee that <code>x == decode(encode(x))</code> I would return an error. encoding/json doesn&#39;t guarantee that today so it doesn&#39;t return errors, but I don&#39;t see why someone wouldn&#39;t change their mind about that in the future, it&#39;s not a very controversial principle."}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 6, "last_activity_date": 1509350501, "creation_date": 1509350501, "answer_id": 47010436, "question_id": 47009077, "link": "https://stackoverflow.com/questions/47009077/is-it-safe-to-assume-that-json-marshall-on-a-particular-struct-can-not-possibly/47010436#47010436", "title": "Is it safe to assume that json.Marshall on a particular struct can not possibly fail?", "body": "<p>There are three potential error sources I can see here:</p>\n\n<ol>\n<li><p>strings and various UTF8 stuff</p></li>\n<li><p>int64. Numbers in JSON are usually treated as float64, so a pedantic implementation could return an error for numbers with absolute values bigger than 2^53 because they could be dangerous.</p></li>\n<li><p>reflect.</p></li>\n</ol>\n\n<p>1 and 2 don't currently happen (the functions in encoding/json don't return errors or panic). I haven't dug into the code of reflect to verify 3, but this is one of those trivially testable cases. Either it fails on the first attempt or always works.</p>\n\n<p>On the other hand. In the past the json encoder would return errors if strings contained invalid UTF8 characters. It no longer does that, but this points to an important principle - things change. Just because a certain error isn't returned today doesn't mean that there won't be errors in the future. The function is defined to return errors. This means that it is perfectly valid for the standard library developers to start returning new errors in the future for things that might not be errors today. So the answer is - yes, it can fail. Maybe not today but code that depends on a particular version of a standard library is bad code.</p>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "accepted_answer_id": 47010436, "answer_count": 1, "score": 0, "last_activity_date": 1509350501, "creation_date": 1509344218, "question_id": 47009077, "link": "https://stackoverflow.com/questions/47009077/is-it-safe-to-assume-that-json-marshall-on-a-particular-struct-can-not-possibly", "title": "Is it safe to assume that json.Marshall on a particular struct can not possibly fail?", "body": "<p>I have read <a href=\"https://stackoverflow.com/q/33903552/1090562\">this question</a> which asks whether json.Marshal can fail on any input and based on the answers it looks like for my situation it can't fail. My situation is the following:</p>\n\n<p>I have a specific struct (no nesting, no arrays, just strings, ints of various types, bools). I need to marshal it into a json. Can it ever fail?</p>\n\n<p>In more <a href=\"https://play.golang.org/p/ASqc1xTlhI\" rel=\"nofollow noreferrer\">specific example</a>:</p>\n\n<pre><code>type some struct {\n    F1 string `json:\"f1\"`\n    F2 uint32 `json:\"f2\"`\n    F3 int64  `json:\"f3\"`\n    F4 bool   `json:\"f4\"`\n}\n\nfunc doSomething(s some) (string, error) {\n    data, err := json.Marshal(s)\n    if err != nil {\n        return \"\", err\n    }\n    return string(data), nil\n}\n</code></pre>\n\n<p>Can <code>doSomething</code> ever fail? If yes, please provide an input, otherwise explain why not. Based on my current knowledge it can't.</p>\n"}, {"tags": ["mysql", "go", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 7705, "user_id": 1076743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luioK.png?s=128&g=1", "display_name": "Sir", "link": "https://stackoverflow.com/users/1076743/sir"}, "edited": false, "score": 1, "creation_date": 1509392307, "post_id": 47009427, "comment_id": 80992969, "body": "Can you explain whats going on with the first line i have never seen syntax like that.. Is it a cast from <code>error</code> to <code>mysql.MySQLError</code> ? Or is that a function call.. a bit confusing."}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "reply_to_user": {"reputation": 7705, "user_id": 1076743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luioK.png?s=128&g=1", "display_name": "Sir", "link": "https://stackoverflow.com/users/1076743/sir"}, "edited": false, "score": 0, "creation_date": 1509423449, "post_id": 47009427, "comment_id": 81002633, "body": "It&#39;s an error type casting, it&#39;s just an example how to fetch error and compare with number from external package."}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 9, "last_activity_date": 1509346289, "last_edit_date": 1509346289, "creation_date": 1509345966, "answer_id": 47009427, "question_id": 47009068, "link": "https://stackoverflow.com/questions/47009068/how-to-get-the-mysql-error-type-in-golang/47009427#47009427", "title": "How to get the mySQL error type in golang?", "body": "<p>Indeed, checking the content of the error string is a bad practice,  the string value might vary depending on the driver verison. It\u2019s much better and robust to compare error numbers to identify what a specific error is.</p>\n\n<p>There are the error codes for the <strong>mysql</strong> driver, the <a href=\"https://github.com/VividCortex/mysqlerr\" rel=\"noreferrer\">package</a> is maintained separatly from the main driver package. The mechanism to do this varies between drivers, however, because this isn\u2019t part of database/sql itself. With that package you can check the type of error <a href=\"https://github.com/go-sql-driver/mysql/blob/a8b7ed4454a6a4f98f85d3ad558cd6d97cec6959/errors.go#L58\" rel=\"noreferrer\"><code>MySQLError</code></a>:</p>\n\n<pre><code>if driverErr, ok := err.(*mysql.MySQLError); ok {\n    if driverErr.Number == mysqlerr.ER_ACCESS_DENIED_ERROR {\n        // Handle the permission-denied error\n    }\n}\n</code></pre>\n\n<p>There are also error <a href=\"https://github.com/go-sql-driver/mysql/blob/a8b7ed4454a6a4f98f85d3ad558cd6d97cec6959/errors.go#L19\" rel=\"noreferrer\"><code>variables</code></a>.</p>\n\n<p><sub><a href=\"http://go-database-sql.org/errors.html\" rel=\"noreferrer\">Ref</a></sub></p>\n"}, {"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1509374285, "post_id": 47012400, "comment_id": 80982250, "body": "Better option is a switch on error, rather than successive If statements: <a href=\"https://play.golang.org/p/-d_skg2tK-\" rel=\"nofollow noreferrer\">play.golang.org/p/-d_skg2tK-</a>"}], "tags": [], "owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "is_accepted": false, "score": 2, "last_activity_date": 1509357444, "creation_date": 1509357444, "answer_id": 47012400, "question_id": 47009068, "link": "https://stackoverflow.com/questions/47009068/how-to-get-the-mysql-error-type-in-golang/47012400#47012400", "title": "How to get the mySQL error type in golang?", "body": "<p>normally in packages you could see Variables if the package author want to separate errors make variable for each of them like :\n<a href=\"https://golang.org/pkg/database/sql/#pkg-variables\" rel=\"nofollow noreferrer\">https://golang.org/pkg/database/sql/#pkg-variables</a></p>\n\n<p>you could see errors and you could switch the error in return and case each error variable.</p>\n\n<p>example:</p>\n\n<pre><code>result, err := db.Exec(\"INSERT INTO users (username,password,email) VALUES (?,?,?)\", username, hashedPassword, email)\nif err == sql.ErrNoRows {\n    // handle error\n    return\n}\nif err == sql.ErrTxDone {\n    // handle error\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 7705, "user_id": 1076743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luioK.png?s=128&g=1", "display_name": "Sir", "link": "https://stackoverflow.com/users/1076743/sir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5366, "favorite_count": 0, "accepted_answer_id": 47009427, "answer_count": 2, "score": 3, "last_activity_date": 1509357444, "creation_date": 1509344153, "question_id": 47009068, "link": "https://stackoverflow.com/questions/47009068/how-to-get-the-mysql-error-type-in-golang", "title": "How to get the mySQL error type in golang?", "body": "<p>I'm really confused how to get the error type from a failed query line with the mySQL import. There is no real documentation on it, so it has me real confused.</p>\n\n<p>Currently i have:</p>\n\n<pre><code>result, err := db.Exec(\"INSERT INTO users (username,password,email) VALUES (?,?,?)\", username, hashedPassword, email)\nif err != nil {\n    // handle different types of errors here\n    return\n}\n</code></pre>\n\n<p>I could print err but its just a string, not liking the idea of peeking at strings to know what went wrong, is there no feedback to get an error code to perform a <code>switch</code> on or something along those lines? How do you do it?</p>\n"}, {"tags": ["amazon-web-services", "go", "kubernetes", "istio"], "comments": [{"owner": {"reputation": 1, "user_id": 8854231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5da7cc7fcf17b53fa09c3cc7d1a38e?s=128&d=identicon&r=PG&f=1", "display_name": "liangrog", "link": "https://stackoverflow.com/users/8854231/liangrog"}, "edited": false, "score": 0, "creation_date": 1509338766, "post_id": 47008186, "comment_id": 80963107, "body": "Just found one solution: using istioctl and --includeIPRanges, such as deploy using &quot;kubectl apply -f &lt;(istioctl kube-inject -f samples/sleep/sleep.yaml --includeIPRanges=10.0.0.1/24)&quot; Not elegant though."}, {"owner": {"reputation": 3141, "user_id": 553720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HrNqN.jpg?s=128&g=1", "display_name": "Vadim Eisenberg", "link": "https://stackoverflow.com/users/553720/vadim-eisenberg"}, "edited": false, "score": 0, "creation_date": 1509602531, "post_id": 47008186, "comment_id": 81085049, "body": "You wrote: &quot;...I can&#39;t rewrite the URL. Subsequently, I&#39;ll get an &quot;http: server gave HTTP response to HTTPS client&quot; error.&quot; So did you manage to change the URL to &quot;http://...:443&quot; ?"}], "owner": {"reputation": 1, "user_id": 8854231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5da7cc7fcf17b53fa09c3cc7d1a38e?s=128&d=identicon&r=PG&f=1", "display_name": "liangrog", "link": "https://stackoverflow.com/users/8854231/liangrog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 561, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509482572, "creation_date": 1509337955, "question_id": 47008186, "link": "https://stackoverflow.com/questions/47008186/kubernetes-service-unable-to-access-s3-with-istio-sidecar", "title": "Kubernetes service unable to access s3 with Istio sidecar", "body": "<p>Just wondering if anyone has any luck/solution when using AWS SDK to access AWS resource such as S3 when service injected with Istio sidecar.</p>\n\n<p>As Istio's <a href=\"https://istio.io/docs/reference/config/traffic-rules/egress-rules.html\" rel=\"nofollow noreferrer\">document</a> points out:</p>\n\n<ol>\n<li>traffic will go through Istio sidecar, you will need white list the DNS or IPs.</li>\n<li>https is not available. Can only do by changing the format to something like \"<a href=\"http://www.google.com:443\" rel=\"nofollow noreferrer\">http://www.google.com:443</a>\" </li>\n</ol>\n\n<p>However, AWS SDK handles the https connection hence I can't rewrite the URL. Subsequently, I'll get an \"http: server gave HTTP response to HTTPS client\" error.</p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["go", "aerospike"], "answers": [{"comments": [{"owner": {"reputation": 1705, "user_id": 2754724, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0db5a1fac483a5c97d7084b35483c8b7?s=128&d=identicon&r=PG&f=1", "display_name": "Crusaderpyro", "link": "https://stackoverflow.com/users/2754724/crusaderpyro"}, "edited": false, "score": 0, "creation_date": 1509339467, "post_id": 47008250, "comment_id": 80963287, "body": "we are using storage-memory so no need to worry about the disk writes"}], "tags": [], "owner": {"reputation": 3825, "user_id": 1917187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115760c69c4f709ccf66ec14e08882b2?s=128&d=identicon&r=PG", "display_name": "pgupta", "link": "https://stackoverflow.com/users/1917187/pgupta"}, "is_accepted": true, "score": 3, "last_activity_date": 1509338593, "creation_date": 1509338593, "answer_id": 47008250, "question_id": 47007831, "link": "https://stackoverflow.com/questions/47007831/how-to-do-a-get-with-a-touch-using-aerospike-client/47008250#47008250", "title": "How to do a Get with a touch using aerospike client", "body": "<p>Do it within an operate() command, you can touch() as well as get() in the same lock, one network trip. Note, if your record is stored on disk, updating TTL, however you do it, will entail a new write of the record to a different location on the disk because TTL info is stored in the record metadata.</p>\n"}], "owner": {"reputation": 1705, "user_id": 2754724, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0db5a1fac483a5c97d7084b35483c8b7?s=128&d=identicon&r=PG&f=1", "display_name": "Crusaderpyro", "link": "https://stackoverflow.com/users/2754724/crusaderpyro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 47008250, "answer_count": 1, "score": 1, "last_activity_date": 1509338593, "creation_date": 1509334826, "last_edit_date": 1592644375, "question_id": 47007831, "link": "https://stackoverflow.com/questions/47007831/how-to-do-a-get-with-a-touch-using-aerospike-client", "title": "How to do a Get with a touch using aerospike client", "body": "<p>I wanted to get a record from the aerospike. So, I was using the <a href=\"https://godoc.org/github.com/aerospike/aerospike-client-go#Client.Get\" rel=\"nofollow noreferrer\">Client.Get</a> method.</p>\n<p>However, whenever I do a Get I also want to refresh the TTL of the record. So, usually we use a <a href=\"https://godoc.org/github.com/aerospike/aerospike-client-go#WritePolicy\" rel=\"nofollow noreferrer\">WritePolicy</a> which allows us to set a ttl. But then the Get method accepts only a <a href=\"https://godoc.org/github.com/aerospike/aerospike-client-go#BasePolicy\" rel=\"nofollow noreferrer\">BasePolicy</a></p>\n<p>Is the following way correct or is there a better way of doing this?</p>\n<blockquote>\n<p>client.Get(nil, key, bin)</p>\n<p>client.Touch(myWritePolicy, key)</p>\n</blockquote>\n"}, {"tags": ["go", "cgo", "tdm-gcc"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1509329492, "post_id": 47007233, "comment_id": 80961134, "body": "I&#39;ve had the same issue yesterday. MinGW-w64 worked for me"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1509346080, "post_id": 47007233, "comment_id": 80965359, "body": "Why do you <a href=\"https://stackoverflow.com/questions/46925915/\">keep posting the same question again and again</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 1, "last_activity_date": 1613212121, "last_edit_date": 1613212121, "creation_date": 1509346668, "answer_id": 47009569, "question_id": 47007233, "link": "https://stackoverflow.com/questions/47007233/how-do-i-correctly-use-64-bit-tdm-gcc-with-cgo/47009569#47009569", "title": "How do I correctly use 64-bit TDM-GCC with cgo?", "body": "<ol>\n<li><p>Read the <a href=\"https://golang.org/pkg/cmd/cgo/\" rel=\"nofollow noreferrer\"><code>cgo</code> manual</a>,\nnotice there how the <code>go</code> tool calls the compilers for the foreign\nlanguages it supports.</p>\n</li>\n<li><p>Run</p>\n<pre><code> go env\n</code></pre>\n<p>and see at the variables <code>CC</code> and <code>CXX</code> it'll show you:\nthat are the C and C++ compilers the <code>go</code> toolchain would call to compile\nC and C++ code, respectively.</p>\n<p>I bet it will show &quot;bare&quot; names such as <code>gcc</code> and <code>g++</code>, respectively.</p>\n<p>Notice that when a program on Windows is being run without specifying\nits full pathname (that is, beginning with a drive letter and\nfollowed by that <code>:\\</code> fun construct and then the rest of the path\u2014\nending in the actual program file's name), the program's file is looked\nup in a set of paths defined by the contents of the so-called\n<a href=\"https://en.wikipedia.org/wiki/PATH_(variable)\" rel=\"nofollow noreferrer\">environment variable called &quot;PATH&quot;</a>.</p>\n<p>That <code>PATH</code> env. variable can be system-wide and per-user;\nthe latter trumps the former.</p>\n</li>\n<li><p>In a shell, run</p>\n<pre><code> echo %PATH%\n</code></pre>\n<p>and see whether there are listed any pathnames of the installed\nC/C++ compilers.\nI bet there will be a path of some 32-bit GCC but not your 64-bit suite.</p>\n</li>\n<li><p>Make sure your <code>PATH</code> env. variable contains an entry for the directory\ncontaining the executable program of your 64-bit compiler whose name matches\nthe appropriate name listed in the <code>go env</code> output.</p>\n<p>Please refer to the installation manual of your compiler for more details.</p>\n</li>\n</ol>\n<p>If all else fails, please ask a concrete question about installing that compiler over there at the <a href=\"https://superuser.com\">https://superuser.com</a>.</p>\n"}], "owner": {"reputation": 1055, "user_id": 3326720, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/SeWCu.png?s=128&g=1", "display_name": "Orange Receptacle", "link": "https://stackoverflow.com/users/3326720/orange-receptacle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1421, "favorite_count": 0, "closed_date": 1509453838, "answer_count": 1, "score": -2, "last_activity_date": 1613212121, "creation_date": 1509329326, "last_edit_date": 1509346766, "question_id": 47007233, "link": "https://stackoverflow.com/questions/47007233/how-do-i-correctly-use-64-bit-tdm-gcc-with-cgo", "closed_reason": "Duplicate", "title": "How do I correctly use 64-bit TDM-GCC with cgo?", "body": "<p>I'm attempting to use a library at github.com/hajimehoshi/ebiten. Regardless of what I do, I'm met with this error:</p>\n\n<pre><code># github.com/go-gl/glfw/v3.2/glfw\ncc1.exe: sorry, unimplemented: 64-bit mode not compiled in\n# github.com/go-gl/gl/v2.1/gl\ncc1.exe: sorry, unimplemented: 64-bit mode not compiled in\n</code></pre>\n\n<p>I've attempted updating MinGW</p>\n\n<blockquote>\n  <p>mingw-get udpate</p>\n</blockquote>\n\n<p>I've set the PATH variable for MinGW.</p>\n\n<p>I've downloaded MinGW-w64 <a href=\"https://sourceforge.net/projects/mingw-w64/?source=typ_redirect\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I've gone <a href=\"http://tdm-gcc.tdragon.net/\" rel=\"nofollow noreferrer\">here</a> and downloaded the tdm-gcc 64 bundle.</p>\n\n<p>And still, I'm met with the same error. How do I circumvent this?</p>\n"}, {"tags": ["go", "tcp", "sip", "tcpdump"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509484090, "post_id": 47005715, "comment_id": 81036437, "body": "If this is going through a router type appliance (like a home internet type from an ISP) you&#39;re gonna want to disable SIP ALG on that thing if you can."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1509484136, "post_id": 47005715, "comment_id": 81036460, "body": "If it&#39;s a direct connection from machine to machine or through a hub, you have electromagnetic gremlins in your hardware.   I would just burn it and start over in that case ;)"}, {"owner": {"reputation": 8104, "user_id": 6270170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4438f1d939f9354ecdbb36b3d41a9fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Moerwald", "link": "https://stackoverflow.com/users/6270170/moerwald"}, "edited": false, "score": 0, "creation_date": 1509604533, "post_id": 47005715, "comment_id": 81085820, "body": "You INVITE and ACK request doesn&#39;t have a <code>contact</code> header. Maybe the underlying SIP stack relies on it."}], "answers": [{"comments": [{"owner": {"reputation": 1825, "user_id": 375962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a148d57441f3677b802f7c72594cc4a5?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/375962/rob"}, "edited": false, "score": 0, "creation_date": 1509632952, "post_id": 47069100, "comment_id": 81103958, "body": "Ah, thank you for the point. I will test this when I get back on the VPN tonight and see if it has an impact."}], "tags": [], "owner": {"reputation": 8104, "user_id": 6270170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4438f1d939f9354ecdbb36b3d41a9fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Moerwald", "link": "https://stackoverflow.com/users/6270170/moerwald"}, "is_accepted": false, "score": 2, "last_activity_date": 1509604852, "creation_date": 1509604852, "answer_id": 47069100, "question_id": 47005715, "link": "https://stackoverflow.com/questions/47005715/tcp-dump-on-server-not-matching-client/47069100#47069100", "title": "TCP Dump on server not matching client", "body": "<p>Add a <code>contact</code> header to your initial <code>INVITE</code> based on <a href=\"https://tools.ietf.org/html/rfc3261#section-20\" rel=\"nofollow noreferrer\">RFC 3261</a> the <code>contact</code> header is mandatory for SIP <code>INVITE</code> requests:</p>\n\n<pre><code>  Header field          where   proxy ACK BYE CAN INV OPT REG\n  ___________________________________________________________\n  Accept                  R            -   o   -   o   m*  o\n  Accept                 2xx           -   -   -   o   m*  o\n  Accept                 415           -   c   -   c   c   c\n  Accept-Encoding         R            -   o   -   o   o   o\n  Accept-Encoding        2xx           -   -   -   o   m*  o\n  Accept-Encoding        415           -   c   -   c   c   c\n  Accept-Language         R            -   o   -   o   o   o\n  Accept-Language        2xx           -   -   -   o   m*  o\n  Accept-Language        415           -   c   -   c   c   c\n  Alert-Info              R      ar    -   -   -   o   -   -\n  Alert-Info             180     ar    -   -   -   o   -   -\n  Allow                   R            -   o   -   o   o   o\n  Allow                  2xx           -   o   -   m*  m*  o\n  Allow                   r            -   o   -   o   o   o\n  Allow                  405           -   m   -   m   m   m\n  Authentication-Info    2xx           -   o   -   o   o   o\n  Authorization           R            o   o   o   o   o   o\n  Call-ID                 c       r    m   m   m   m   m   m\n  Call-Info                      ar    -   -   -   o   o   o\n  Contact                 R            o   -   -   m   o   o\n</code></pre>\n"}], "owner": {"reputation": 1825, "user_id": 375962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a148d57441f3677b802f7c72594cc4a5?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/375962/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1509604852, "creation_date": 1509314622, "question_id": 47005715, "link": "https://stackoverflow.com/questions/47005715/tcp-dump-on-server-not-matching-client", "title": "TCP Dump on server not matching client", "body": "<p>I'm trying to write a client that initiates an MRCP session, but it's not quite functioning as expected. In my debugging, I determined that the SIP server is not receiving my ACK message to initialize the session.</p>\n\n<p>Here's the tcpdump from the client:</p>\n\n<p><code>tcpdump src port 5060 or dst port 5060 or src port 32418 or dst port 32418 -s0 -A</code></p>\n\n<pre><code>17:34:35.383867 IP 10.0.0.2.57614 &gt; 10.0.0.1.sip: Flags [S], seq 3371911038, win 65535, options [mss 1366,nop,wscale 5,nop,nop,TS val 560025151 ecr 0,sackOK,eol], length 0\nE..@..@.@...\n...\n.........G~.........|.....V.......\n!aN?........\n17:34:35.412489 IP 10.0.0.1.sip &gt; 10.0.0.2.57614: Flags [S.], seq 1495905271, ack 3371911039, win 14600, options [mss 1310,nop,nop,sackOK], length 0\nE..0..@...`.\n...\n.......Y)....G.p.9..=..........\n17:34:35.412568 IP 10.0.0.2.57614 &gt; 10.0.0.1.sip: Flags [.], ack 1, win 65535, length 0\nE..(]v@.@..h\n...\n.........G.Y)..P....s..\n17:34:35.412756 IP 10.0.0.2.57614 &gt; 10.0.0.1.sip: Flags [P.], seq 1:780, ack 1, win 65535, length 779\nE..3..@.@._.\n...\n.........G.Y)..P....c..INVITE sip:10.0.0.1:5060 SIP/2.0\nVia: SIP/2.0/TCP 10.0.0.2:5090;branch=z9hG4bKuuDCoBFClGrwk\nMax-Forwards: 70\nFrom: &lt;sip:10.0.0.2:61347&gt;;tag=KZMlWvlA\nTo: &lt;sip:10.0.0.1:5060&gt;\nCall-ID: rc-VxVmMJd-YpyrUXC-hpkkEvs-AsNeKAt\nCSeq: 1509312876 INVITE\nUser-Agent: VoiceTest\nAllow: INVITE, ACK, BYE, CANCEL, OPTIONS, PRACK, MESSAGE, SUBSCRIBE, NOTIFY, REFER, UPDATE\nSupported: timer, 100rel\nContent-Type: application/sdp\nContent-Disposition: session\nContent-Length: 278\n\nv=0\no=VoiceTest 15093128754187 15093128756831 IN IP4 10.0.0.2\ns=-\nc=IN IP4 10.0.0.2\nt=0 0\nm=application 9 TCP/MRCPv2 1\na=setup:active\na=connection:new\na=resource:speechrecog\na=cmid:1\nm=audio 4062 RTP/AVP 0\na=rtpmap:0 PCMU/8000\na=sendonly\na=mid:1\n\n17:34:35.424454 IP 10.0.0.1.sip &gt; 10.0.0.2.57614: Flags [.], ack 780, win 13821, length 0\nE..(w.@....O\n...\n.......Y)....J.P.5.Ik..\n17:34:35.430966 IP 10.0.0.1.sip &gt; 10.0.0.2.57614: Flags [P.], seq 1:895, ack 780, win 15580, length 894\nE.....@...U.\n...\n.......Y)....J.P.&lt;.`t..SIP/2.0 200 OK\nVia: SIP/2.0/TCP 10.0.0.2:5090;branch=z9hG4bKuuDCoBFClGrwk;rport=57614\nFrom: &lt;sip:10.0.0.2:61347&gt;;tag=KZMlWvlA\nTo: &lt;sip:10.0.0.1:5060&gt;;tag=HtjeQ38HveyBp\nCall-ID: rc-VxVmMJd-YpyrUXC-hpkkEvs-AsNeKAt\nCSeq: 1509312876 INVITE\nContact: &lt;sip:10.0.0.1:5060&gt;\nUser-Agent: OpenMRCP Sofia-SIP\nAccept: application/sdp\nAllow: INVITE, ACK, BYE, CANCEL, OPTIONS, PRACK, MESSAGE, SUBSCRIBE, NOTIFY, REFER, UPDATE\nSupported: timer, 100rel\nMin-SE: 120\nContent-Type: application/sdp\nContent-Disposition: session\nContent-Length: 328\n\nv=0\no=MRCPServer 0 1 IN IP4 10.0.0.1\ns=-\nc=IN IP4 10.0.0.1\nt=0 0\nm=application 32418 TCP/MRCPv2 1\na=setup:passive\na=connection:new\na=channel:F5812716BCF011E7@speechrecog\na=cmid:1\nm=audio 8002 RTP/AVP 0 101\na=rtpmap:0 PCMU/8000\na=rtpmap:101 telephone-event/8000\na=fmtp:101 0-15\na=recvonly\na=mid:1\n\n17:34:35.431029 IP 10.0.0.2.57614 &gt; 10.0.0.1.sip: Flags [.], ack 895, win 65535, length 0\nE..(E.@.@..0\n...\n.........J.Y).vP...{...\n17:34:35.431395 IP 10.0.0.2.57614 &gt; 10.0.0.1.sip: Flags [P.], seq 780:1074, ack 895, win 65535, length 294\nE..NLo@.@..I\n...\n.........J.Y).vP.......ACK sip:10.0.0.1:5060 SIP/2.0\nVia: SIP/2.0/TCP 10.0.0.2:5090;branch=z9hG4bKUjyOYgTYGDvpN\nMax-Forwards: 70\nFrom: &lt;sip:10.0.0.2:61347&gt;;tag=KZMlWvlA\nTo: &lt;sip:10.0.0.1:5060&gt;;tag=HtjeQ38HveyBp\nCall-ID: rc-VxVmMJd-YpyrUXC-hpkkEvs-AsNeKAt\nCSeq: 1509312876 ACK\nContent-Length: 0\n</code></pre>\n\n<p>And here's the tcpdump from the server:</p>\n\n<p><code>tcpdump src port 32418 or dst port 32418 or src port 5060 or dst port 5060 -s0 -A</code></p>\n\n<pre><code>21:34:35.500674 IP 10.0.0.2.57614 &gt; 10.0.0.1.sip: Flags [S], seq 839953377, win 65535, options [mss 1310,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,sackOK,eol], length 0\nE..@..@.....\n...\n.......2...........N...........................\n21:34:35.500739 IP 10.0.0.1.sip &gt; 10.0.0.2.57614: Flags [S.], seq 1323670423, ack 839953378, win 14600, options [mss 1460,nop,nop,sackOK], length 0\nE..0..@.@...\n...\n.......N...2...p.9.q...........\n21:34:35.512301 IP 10.0.0.2.57614 &gt; 10.0.0.1.sip: Flags [.], ack 1, win 65535, length 0\nE..((J@...9.\n...\n.......2...N...P.............\n21:34:35.512898 IP 10.0.0.2.57614 &gt; 10.0.0.1.sip: Flags [P.], seq 1:780, ack 1, win 65535, length 779\nE..3=.@... .\n...\n.......2...N...P.......INVITE sip:10.0.0.1:5060 SIP/2.0\nVia: SIP/2.0/TCP 10.0.0.2:5090;branch=z9hG4bKuuDCoBFClGrwk\nMax-Forwards: 70\nFrom: &lt;sip:10.0.0.2:61347&gt;;tag=KZMlWvlA\nTo: &lt;sip:10.0.0.1:5060&gt;\nCall-ID: rc-VxVmMJd-YpyrUXC-hpkkEvs-AsNeKAt\nCSeq: 1509312876 INVITE\nUser-Agent: VoiceTest\nAllow: INVITE, ACK, BYE, CANCEL, OPTIONS, PRACK, MESSAGE, SUBSCRIBE, NOTIFY, REFER, UPDATE\nSupported: timer, 100rel\nContent-Type: application/sdp\nContent-Disposition: session\nContent-Length: 278\n\nv=0\no=VoiceTest 15093128754187 15093128756831 IN IP4 10.0.0.2\ns=-\nc=IN IP4 10.0.0.2\nt=0 0\nm=application 9 TCP/MRCPv2 1\na=setup:active\na=connection:new\na=resource:speechrecog\na=cmid:1\nm=audio 4062 RTP/AVP 0\na=rtpmap:0 PCMU/8000\na=sendonly\na=mid:1\n\n21:34:35.512922 IP 10.0.0.1.sip &gt; 10.0.0.2.57614: Flags [.], ack 780, win 15580, length 0\nE..(.W@.@.|.\n...\n.......N...2...P.&lt;.....\n21:34:35.518359 IP 10.0.0.1.sip &gt; 10.0.0.2.57614: Flags [P.], seq 1:895, ack 780, win 15580, length 894\nE....X@.@.y.\n...\n.......N...2...P.&lt;.....SIP/2.0 200 OK\nVia: SIP/2.0/TCP 10.0.0.2:5090;branch=z9hG4bKuuDCoBFClGrwk;rport=57614\nFrom: &lt;sip:10.0.0.2:61347&gt;;tag=KZMlWvlA\nTo: &lt;sip:10.0.0.1:5060&gt;;tag=HtjeQ38HveyBp\nCall-ID: rc-VxVmMJd-YpyrUXC-hpkkEvs-AsNeKAt\nCSeq: 1509312876 INVITE\nContact: &lt;sip:10.0.0.1:5060&gt;\nUser-Agent: OpenMRCP Sofia-SIP\nAccept: application/sdp\nAllow: INVITE, ACK, BYE, CANCEL, OPTIONS, PRACK, MESSAGE, SUBSCRIBE, NOTIFY, REFER, UPDATE\nSupported: timer, 100rel\nMin-SE: 120\nContent-Type: application/sdp\nContent-Disposition: session\nContent-Length: 328\n\nv=0\no=MRCPServer 0 1 IN IP4 10.0.0.1\ns=-\nc=IN IP4 10.0.0.1\nt=0 0\nm=application 32418 TCP/MRCPv2 1\na=setup:passive\na=connection:new\na=channel:F5812716BCF011E7@speechrecog\na=cmid:1\nm=audio 8002 RTP/AVP 0 101\na=rtpmap:0 PCMU/8000\na=rtpmap:101 telephone-event/8000\na=fmtp:101 0-15\na=recvonly\na=mid:1\n\n21:34:35.519073 IP 10.0.0.2.57614 &gt; 10.0.0.1.sip: Flags [.], ack 895, win 64641, length 0\nE..(eT@.....\n...\n.......2...N...P.............\n</code></pre>\n\n<p>Both the INVITE and the ACK messages are going through the same Go function</p>\n\n<pre><code>func (c *SIPConnection) Send(msg string) error {\n\n    fmt.Println(\"-- Sending SIP Request --\")\n    fmt.Println(msg)\n    n, err := fmt.Fprintf(c.cx, msg)\n\n    if err != nil {\n        fmt.Println(\"Failed to send message: \", err)\n        return err\n    }\n\n    if n &lt; len(msg) {\n        return fmt.Errorf(\"Length of data sent was less than length of message. Sent: %d, Expected %d\", n, len(msg))\n    }\n\n    fmt.Println(\"Wrote\", n, \"bytes\")\n\n    return nil\n}\n</code></pre>\n\n<p>and both of them show up in the application logs and neither of them error out. Can anyone help explain what's going on here?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "gcc", "go", "plugins", "cgo"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1509319106, "post_id": 47005278, "comment_id": 80959056, "body": "Works for me: 16.04 &amp; 17.10; gcc5 &amp; gcc7; go1.8, go1.9, gotip; etc. I have <code>gcc</code> and <code>libc6-dev</code> installed."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1509369178, "post_id": 47005278, "comment_id": 80978518, "body": "I installed Ubuntu 17.04 and updated all packages (<code>apt update</code>, <code>apt upgrade</code>). All the necessary packages, including <code>gcc</code> and <code>libc6-dev</code>, were preinstalled. I downloaded and installed <code>go1.9.2</code> (<a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">golang.org/dl</a> and <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">golang.org/doc/install</a>). I created <code>&#47;tmp&#47;plugin.go</code> and ran <code>go build -v -buildmode=plugin -o &#47;tmp&#47;plugin.so &#47;tmp&#47;plugin.go</code>. It completed successfully and created <code>&#47;tmp&#47;plugin.so</code>. Your Ubuntu 17.04 installation is broken."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1509369353, "post_id": 47005278, "comment_id": 80978624, "body": "Your Ubuntu 17.04 installation is broken. You may have to reinstall the OS. You might try refreshing the OS to 17.10 (Upgrading from Ubuntu 17.04: <a href=\"https://wiki.ubuntu.com/ArtfulAardvark/ReleaseNotes\" rel=\"nofollow noreferrer\">wiki.ubuntu.com/ArtfulAardvark/ReleaseNotes</a>)."}, {"owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1509408922, "post_id": 47005278, "comment_id": 80999307, "body": "Thanks @peterSO, I guess so. Thanks for going all the way trying. I&#39;ve just verified that my other machine works fine, which was installed the same way. I&#39;ll trying to reinstall everything <code>gcc</code> related and see if it&#39;d help..."}], "owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1199, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1509324959, "creation_date": 1509311466, "last_edit_date": 1509324959, "question_id": 47005278, "link": "https://stackoverflow.com/questions/47005278/go-1-8-plugins-fatal-error-stddef-h-no-such-file", "title": "Go 1.8 plugins, fatal error: stddef.h: No such file", "body": "<p>Observe:</p>\n\n<pre><code>$ cat /tmp/plugin.go\npackage main\n\nimport \"fmt\"\n\nvar V int\n\nfunc F() { fmt.Printf(\"Hello, number %d\\n\", V) }\n\n$ go build -buildmode=plugin -o /tmp/plugin.so /tmp/plugin.go\n# runtime/cgo\ncgo-builtin-prolog:1:57: fatal error: stddef.h: No such file or directory\ncompilation terminated.\n</code></pre>\n\n<p>Why is that? </p>\n\n<p>This is under Ubuntu 17.04, and I have build-essentials installed:</p>\n\n<pre><code>$ go version\ngo version go1.9 linux/amd64\n\n$ uname -r\n4.10.0-37-generic\n\n$ lsb_release -a \nNo LSB modules are available.\nDistributor ID: Ubuntu\nDescription:    Ubuntu 17.04\nRelease:        17.04\nCodename:       zesty\n\n$ apt-cache policy build-essential\nbuild-essential:\n  Installed: 12.1ubuntu2\n  Candidate: 12.1ubuntu2\n</code></pre>\n\n<p>please not the \"<a href=\"https://stackoverflow.com/questions/31600600/\">Compilation error: &quot;stddef.h: No such file or directory&quot;</a>\" is NOT the answer as my gcc-core package and gcc-g++ <strong>are</strong> of the <em>same</em> version -- here are my gcc related packages:</p>\n\n<pre><code> gcc_4:6.3.0-2ubuntu1\n gcc-6_6.3.0-12ubuntu2\n gcc-6-base:amd64_6.3.0-12ubuntu2\n libgcc-6-dev:amd64_6.3.0-12ubuntu2\n libgcc1:amd64_1:6.3.0-12ubuntu2\n</code></pre>\n\n<p><strong>UPDATE</strong>: </p>\n\n<p>thanks @peterSO, seems to be my gcc's own problem:</p>\n\n<pre><code>$ cat /tmp/foo.c \n#include &lt;stdio.h&gt;\n\n$ gcc /tmp/foo.c \nIn file included from /tmp/foo.c:1:0:\n/usr/include/stdio.h:33:21: fatal error: stddef.h: No such file or directory\n # include &lt;stddef.h&gt;\n</code></pre>\n\n<p>While searching for solution for it, I found someone suggested to reinstall gcc, so I did, together with <code>libc6-dev</code>:</p>\n\n<pre><code>apt-get --reinstall install libgcc-6-dev gcc-6 gcc-6-base:amd64 libc6-dev:amd64\n</code></pre>\n\n<p>Now my simple .c file compiles OK now, but I'm bumped into a new problem with <code>cgo</code>:</p>\n\n<pre><code>$ go build -buildmode=plugin -o /tmp/plugin.so /tmp/plugin.go\n# runtime/cgo\nIn file included from /usr/include/errno.h:35:0,\n                 from cgo-gcc-prolog:21:\n/usr/include/x86_64-linux-gnu/bits/errno.h:24:26: fatal error: linux/errno.h: No such file or directory\n # include &lt;linux/errno.h&gt;\n                          ^\ncompilation terminated.\n</code></pre>\n\n<p>I know this might be a\u00a0Ubuntu/gcc specific problem (Ref: <a href=\"https://stackoverflow.com/questions/37158651\">Why is stddef.h not in /usr/include?</a> and my <code>stddef.h</code> is under <code>/usr/src/linux-headers-4.10.0-37/include/linux/stddef.h</code>), but anybody here knows Go and gcc good enough to know how to fix it, so that Go plugins can be compiled properly?</p>\n\n<p>Thx!</p>\n"}, {"tags": ["go", "cookies"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1509308194, "post_id": 47003343, "comment_id": 80955956, "body": "Do two things: 1. Open a bug report for the API (it is broken). 2. Work with the raw HTTP header (where you can do whatever you or the API designer likes)."}, {"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1509308313, "post_id": 47003343, "comment_id": 80955992, "body": "@Volker it is not broken. It just follows the spec. I&#39;ve also figured this out."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1509308689, "post_id": 47003343, "comment_id": 80956122, "body": "It is broken because it uses an @ in a cookie value. That is the definition of broken."}, {"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1509308804, "post_id": 47003343, "comment_id": 80956165, "body": "@Volker oh I thought you were talking about the golang api. Yes, the external api I&#39;m working with is broken."}], "answers": [{"comments": [{"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1509308369, "post_id": 47004492, "comment_id": 80956011, "body": "Thanks. I went with a transport approach and it does the job"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1509309997, "post_id": 47004492, "comment_id": 80956547, "body": "@majidarif What is a transport approach?"}, {"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1509330442, "post_id": 47004492, "comment_id": 80961314, "body": "@CeriseLim&#243;n like how this was done: <a href=\"https://godoc.org/github.com/StalkR/misc/net/http/spacecookies\" rel=\"nofollow noreferrer\">godoc.org/github.com/StalkR/misc/net/http/spacecookies</a>"}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 1, "last_activity_date": 1509306239, "creation_date": 1509306239, "answer_id": 47004492, "question_id": 47003343, "link": "https://stackoverflow.com/questions/47003343/add-support-for-separator-character-on-cookie-name/47004492#47004492", "title": "Add support for separator character on cookie name", "body": "<p>Cookies are just headers with key value pairs, they're not complex. So copy the code you need out from here, and use it to parse the set-cookie header instead in your own way, instead of relying on the stdlib. </p>\n\n<p><a href=\"https://golang.org/src/net/http/cookie.go\" rel=\"nofollow noreferrer\">https://golang.org/src/net/http/cookie.go</a></p>\n\n<p>You could probably adjust this function to allow @:</p>\n\n<pre><code>func isNotToken(r rune) bool {\n    // Allow @, unlike the go stdlib\n    // document reasons here\n    if r == '@' {\n        return false\n    }\n\n    return !httplex.IsTokenRune(r)\n}\n</code></pre>\n\n<p>Alternatively, get hold of the header and just write some simpler parsing code in this particular instance, as all you need to read is something like this:</p>\n\n<p>Set-Cookie: example@example=\"abc\";Path=/</p>\n\n<p>You could probably get away using strings.Split or a regexp if parsing a simple predictable cookie value. </p>\n"}], "owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509306239, "creation_date": 1509299259, "question_id": 47003343, "link": "https://stackoverflow.com/questions/47003343/add-support-for-separator-character-on-cookie-name", "title": "Add support for separator character on cookie name", "body": "<p>I am working with an external API/web that has a cookie with an <code>@</code> on its name. Go-lang does not support this and ignores the <code>Set-Cookie</code>.</p>\n\n<p>How can I implement this without modifying the Go source code directly?</p>\n\n<p>As implemented on Go:</p>\n\n<pre><code>http://tools.ietf.org/html/rfc6265#section-4.1.1 specifies that:\nset-cookie-header = \"Set-Cookie:\" SP set-cookie-string\nset-cookie-string = cookie-pair *( \";\" SP cookie-av )\ncookie-pair       = cookie-name \"=\" cookie-value\ncookie-name       = token\n\nThen in http://tools.ietf.org/html/rfc2616#section-2.2, token is\nspecified as:\ntoken          = 1*&lt;any CHAR except CTLs or separators&gt;\nseparators     = \"(\" | \")\" | \"&lt;\" | \"&gt;\" | \"@\"\n                     | \",\" | \";\" | \":\" | \"\\\" | &lt;\"&gt;\n                     | \"/\" | \"[\" | \"]\" | \"?\" | \"=\"\n                     | \"{\" | \"}\" | SP  | HT\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1509289923, "post_id": 47001697, "comment_id": 80950089, "body": "Your sample on playground seems to run correctly. Can you tell us what you expect to be different?"}, {"owner": {"reputation": 73, "user_id": 2592525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9fd9479f530292dcba81531aafadf0?s=128&d=identicon&r=PG", "display_name": "Tigger", "link": "https://stackoverflow.com/users/2592525/tigger"}, "reply_to_user": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 1, "creation_date": 1509290398, "post_id": 47001697, "comment_id": 80950263, "body": "If you look at the println statements in the output, the ones from the struct current are 0.  Also, in the first line of output which shows the entire unmarshaled struct, the current struct contains all 0;s although the current values in the data file have values."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 2592525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9fd9479f530292dcba81531aafadf0?s=128&d=identicon&r=PG", "display_name": "Tigger", "link": "https://stackoverflow.com/users/2592525/tigger"}, "edited": false, "score": 0, "creation_date": 1509290869, "post_id": 47001826, "comment_id": 80950440, "body": "That;s it!  This has literally driven me to the brink.  I really do appreciate your help, even if I do feel like a moron right now."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 73, "user_id": 2592525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9fd9479f530292dcba81531aafadf0?s=128&d=identicon&r=PG", "display_name": "Tigger", "link": "https://stackoverflow.com/users/2592525/tigger"}, "edited": false, "score": 2, "creation_date": 1509291298, "post_id": 47001826, "comment_id": 80950572, "body": "Sometimes it just needs a fresh set of eyes."}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 3, "last_activity_date": 1509290213, "creation_date": 1509290213, "answer_id": 47001826, "question_id": 47001697, "link": "https://stackoverflow.com/questions/47001697/unmarshalling-complex-json-into-complex-data-struct-fails-on-one-sub-struct/47001826#47001826", "title": "Unmarshalling complex json into complex data struct fails on one sub-struct", "body": "<p>Is this what you expected?</p>\n\n<p><a href=\"https://play.golang.org/p/NBn0KL8DVw\" rel=\"nofollow noreferrer\">https://play.golang.org/p/NBn0KL8DVw</a></p>\n\n<p>If so, you forgot to define the json field for Current in this line:</p>\n\n<pre><code>Current   current `json:\"currently\"`\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 2592525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9fd9479f530292dcba81531aafadf0?s=128&d=identicon&r=PG", "display_name": "Tigger", "link": "https://stackoverflow.com/users/2592525/tigger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509290271, "creation_date": 1509289394, "last_edit_date": 1509289698, "question_id": 47001697, "link": "https://stackoverflow.com/questions/47001697/unmarshalling-complex-json-into-complex-data-struct-fails-on-one-sub-struct", "title": "Unmarshalling complex json into complex data struct fails on one sub-struct", "body": "<p>I'm trying to unmarshal a JSON file from Darksky, and as it's fairly complex JSON I've build a struct of sub-structs.  A partial example of the structs used is:</p>\n\n<pre><code>  type current struct {\n    Time                 uint    `json:\"time\"`                 //   1453402675,\n    Summary              string  `json:\"summary\"`              //   \"Rain\",\n    Icon                 string  `json:\"icon\"`                 //   \"rain\",\n    NearestStormDistance uint    `json:\"nearestStormDistance\"` //   0,\n    PrecipIntensity      float64 `json:\"precipIntensity\"`      //   0.1685,\n    PrecipIntensityError float64 `json:\"precipIntensityError\"` //   0.0067,\n    PrecipProbability    float64 `json:\"precipProbability\"`    //   1,\n    PrecipType           string  `json:\"precipType\"`           //   \"rain\",\n    Temperature          float64 `json:\"temperature\"`          //   48.71,\n    ApparentTemperature  float64 `json:\"apparentTemperature\"`  //   46.93,\n    Dewpoint             float64 `json:\"dewPoint\"`             //   47.7,\n    Humidity             float64 `json:\"humidity\"`             //   0.96,\n    WindSpeed            float64 `json:\"windSpeed\"`            //   4.64,\n    WindBearing          int     `json:\"windBearing\"`          //   186,\n    Visibility           float64 `json:\"visibility\"`           //   4.3,\n    CloudCover           float64 `json:\"cloudCover\"`           //   0.73,\n    Pressure             float64 `json:\"pressure\"`             //   1009.7,\n    Ozone                float64 `json:\"ozone\"`                //   328.35\n  }\n\n  type forecastData struct {\n    Latitude  float64 `json:\"latitude\"`  // 40.47780682531368,\n    Longitude float64 `json:\"longitude\"` // -86.93875375799722,\n    Timezone  string  `json:\"timezone\"`  // \"America/Indiana/Indianapolis\",\n    Current   current\n    Daily     daily\n    Alerts    []alert\n    Offset    int `json:\"offset\"` //    -4\n  }\n</code></pre>\n\n<p>It unmarshals correctly into the entire structure except for the portion that goes into current.  I've played with the types, though a problem with those usually seems to effect only that specific field.  I've looked at the declarations and looked at them literally for hours.  I've put a complete example on the Go Playground at <a href=\"https://play.golang.org/p/XKaIxfvS8a\" rel=\"nofollow noreferrer\">https://play.golang.org/p/XKaIxfvS8a</a>.  At this point, I would appreciate any suggestions.  Thanks!</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1509288633, "post_id": 47001510, "comment_id": 80949626, "body": "I don&#39;t get the question: you seem to decode JSON stream and then ask how you would <i>serialize</i> (that is, encode) a data structure to a JSON stream. Could you please elaborate?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1509288798, "post_id": 47001510, "comment_id": 80949695, "body": "What do you want to do with the data if you don&#39;t know what data you get? In the end you are going in circles because at some point down the line you will need to know what data you have in order to use it. If that is not the case (like you just want to write the data as is to some db, file, etc.) then you do not need to unmarshal it in the first place."}, {"owner": {"reputation": 476, "user_id": 1191286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/W1xmY.jpg?s=128&g=1", "display_name": "davegallant", "link": "https://stackoverflow.com/users/1191286/davegallant"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1509289902, "post_id": 47001510, "comment_id": 80950081, "body": "@kostix I am fetching from an external API that I do not control and I don&#39;t want to store all of the data that it&#39;s giving me, only a subsection of the JSON response. I plan on storing this in MongoDB or somewhere, but for now I was just trying to print it out in readable form. Really new to Go so I apologize if this question is silly."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1509291551, "post_id": 47001510, "comment_id": 80950667, "body": "Have you tried to just <code>fmt.Println(results)</code>? It should have taken care of that itself ;-) In either case, the stock JSON encoder is fine with accepting <code>interface{}</code>, so you&#39;d just do <code>v, err := json.Marshal(results)</code> to get the <code>[]bytes</code> serialization in <code>v</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 2, "last_activity_date": 1509288526, "creation_date": 1509288526, "answer_id": 47001552, "question_id": 47001510, "link": "https://stackoverflow.com/questions/47001510/json-array-marshaling/47001552#47001552", "title": "JSON Array marshaling", "body": "<p>a json string can always be unmarshalled to <code>map[string]interface{}</code>. That is what you need to work with then.</p>\n"}, {"tags": [], "owner": {"reputation": 476, "user_id": 1191286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/W1xmY.jpg?s=128&g=1", "display_name": "davegallant", "link": "https://stackoverflow.com/users/1191286/davegallant"}, "is_accepted": true, "score": 0, "last_activity_date": 1509419052, "last_edit_date": 1509419052, "creation_date": 1509310391, "answer_id": 47005137, "question_id": 47001510, "link": "https://stackoverflow.com/questions/47001510/json-array-marshaling/47005137#47005137", "title": "JSON Array marshaling", "body": "<p>I should have checked the type I was dealing with. I found out by:</p>\n\n<pre><code>fmt.Println(reflect.TypeOf(results))\n</code></pre>\n\n<p>which returned: <strong>[]interface {}</strong></p>\n\n<p>I was then able to iterate over it by using:</p>\n\n<pre><code>for _, event:= range results {\n        v, err := json.MarshalIndent(event, \"\", \"  \")\n        if err != nil {\n            fmt.Println(\"error:\", err)\n        }\n        fmt.Println(string(v))\n    }\n</code></pre>\n"}], "owner": {"reputation": 476, "user_id": 1191286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/W1xmY.jpg?s=128&g=1", "display_name": "davegallant", "link": "https://stackoverflow.com/users/1191286/davegallant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 47005137, "answer_count": 2, "score": 0, "last_activity_date": 1509419052, "creation_date": 1509288302, "last_edit_date": 1509327989, "question_id": 47001510, "link": "https://stackoverflow.com/questions/47001510/json-array-marshaling", "title": "JSON Array marshaling", "body": "<p>I have a function that returns an interface{}. How can I serialize this into a JSON Array without \"hardcoding\" the fields in a struct. \nI am using <a href=\"https://github.com/jmoiron/jsonq\" rel=\"nofollow noreferrer\">https://github.com/jmoiron/jsonq</a> to return the interface.</p>\n\n<pre><code>json.Unmarshal(resp.Bytes(), &amp;response)\ndata := map[string]interface{}{}\ndec := json.NewDecoder(strings.NewReader(resp.String()))\ndec.Decode(&amp;data)\njq := jsonq.NewQuery(data)\n\nresults, err := jq.Array(\"results\")\n\nif err != nil {\n    log.Fatalln(\"Unable to get results: \", err)\n}\nif len(results) == 0 {\n    return nil\n}\nreturn results // this is returning an interface{}\n</code></pre>\n"}, {"tags": ["http", "asynchronous", "go", "client"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1509288095, "post_id": 47000561, "comment_id": 80949434, "body": "There is no hook for this because headers are expected to be received in one group. This is quite unusual behavior from a server, and most client libraries will have fairly short timeouts for receiving just the headers."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1509292197, "post_id": 47000561, "comment_id": 80950836, "body": "If it&#39;s possible to change the clients, you can implement the desired effect <a href=\"https://stackoverflow.com/a/46891608/720999\">using the response&#39;s payload (body) instead</a>."}, {"owner": {"reputation": 1306, "user_id": 1555175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce5ced262c2f58e2a5d80a83717ed2d?s=128&d=identicon&r=PG", "display_name": "filimonov", "link": "https://stackoverflow.com/users/1555175/filimonov"}, "edited": false, "score": 0, "creation_date": 1509396887, "post_id": 47000561, "comment_id": 80995068, "body": "Unfortunately i can&#39;t change the server. Now thinking about reading the raw data from a connection and after header is finished - pass the processing to golang HTTP parser."}, {"owner": {"reputation": 1306, "user_id": 1555175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce5ced262c2f58e2a5d80a83717ed2d?s=128&d=identicon&r=PG", "display_name": "filimonov", "link": "https://stackoverflow.com/users/1555175/filimonov"}, "edited": false, "score": 0, "creation_date": 1509397182, "post_id": 47000561, "comment_id": 80995198, "body": "So i mean to read the raw HTTP resp to some buffer till new line will arrive and afterward pass the buffer with header and original io buffer with body to http/response using io/multi,"}, {"owner": {"reputation": 1306, "user_id": 1555175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce5ced262c2f58e2a5d80a83717ed2d?s=128&d=identicon&r=PG", "display_name": "filimonov", "link": "https://stackoverflow.com/users/1555175/filimonov"}, "edited": false, "score": 0, "creation_date": 1509397204, "post_id": 47000561, "comment_id": 80995218, "body": "As an other option make some local proxy."}], "owner": {"reputation": 1306, "user_id": 1555175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce5ced262c2f58e2a5d80a83717ed2d?s=128&d=identicon&r=PG", "display_name": "filimonov", "link": "https://stackoverflow.com/users/1555175/filimonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 3, "answer_count": 0, "score": 0, "last_activity_date": 1509287377, "creation_date": 1509282736, "question_id": 47000561, "link": "https://stackoverflow.com/questions/47000561/golang-http-client-read-headers-async", "title": "Golang http client read headers async", "body": "<p>I have some http service which sends headers showing progress while preparing response.</p>\n\n<p>So it looks like\nX-progress: 10%\nX-progress: 20% (after some time)\n...\nX-progress: 100% (after more time)</p>\n\n<p>And only after that it start sending the response body.</p>\n\n<p>Is there a way to get that progress info in golang http client? Kinda OnHeaderArrived callback?</p>\n\n<p>I can do it on low level just with simple TCP client but it means i will need to reimplement a lot of HTTP protocol stuff. May there is a way to use net/http above custom Dial connection?</p>\n"}, {"tags": ["github", "go", "google-oauth"], "comments": [{"owner": {"reputation": 7435, "user_id": 6748913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDo2k.jpg?s=128&g=1", "display_name": "Aaqib", "link": "https://stackoverflow.com/users/6748913/aaqib"}, "edited": false, "score": 1, "creation_date": 1509281347, "post_id": 47000312, "comment_id": 80947258, "body": "Try using :   <code>go get -u golang.org&#47;x&#47;oauth2&#47;google</code>"}, {"owner": {"reputation": 174, "user_id": 8851586, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ycu_fMxp-6o/AAAAAAAAAAI/AAAAAAAAAAk/vtL002j3ynI/photo.jpg?sz=128", "display_name": "Gholamreza Eghbali", "link": "https://stackoverflow.com/users/8851586/gholamreza-eghbali"}, "reply_to_user": {"reputation": 7435, "user_id": 6748913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDo2k.jpg?s=128&g=1", "display_name": "Aaqib", "link": "https://stackoverflow.com/users/6748913/aaqib"}, "edited": false, "score": 0, "creation_date": 1509289225, "post_id": 47000312, "comment_id": 80949859, "body": "@Aaqib same result."}, {"owner": {"reputation": 2088, "user_id": 3309046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ce388de97238b3147f3d4ba62b17cb?s=128&d=identicon&r=PG", "display_name": "nishanthshanmugham", "link": "https://stackoverflow.com/users/3309046/nishanthshanmugham"}, "edited": false, "score": 0, "creation_date": 1509291113, "post_id": 47000312, "comment_id": 80950521, "body": "@GholamrezaEghbali <code>go get golang.org&#47;x&#47;oauth2&#47;google</code> works for me on right now on go1.9.1 darwin/amd64. What go version are you using?"}, {"owner": {"reputation": 174, "user_id": 8851586, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ycu_fMxp-6o/AAAAAAAAAAI/AAAAAAAAAAk/vtL002j3ynI/photo.jpg?sz=128", "display_name": "Gholamreza Eghbali", "link": "https://stackoverflow.com/users/8851586/gholamreza-eghbali"}, "reply_to_user": {"reputation": 2088, "user_id": 3309046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ce388de97238b3147f3d4ba62b17cb?s=128&d=identicon&r=PG", "display_name": "nishanthshanmugham", "link": "https://stackoverflow.com/users/3309046/nishanthshanmugham"}, "edited": false, "score": 0, "creation_date": 1509292848, "post_id": 47000312, "comment_id": 80951029, "body": "@nishanths  go1.8.3 linux/amd64 im going to update and see what will happen."}, {"owner": {"reputation": 174, "user_id": 8851586, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ycu_fMxp-6o/AAAAAAAAAAI/AAAAAAAAAAk/vtL002j3ynI/photo.jpg?sz=128", "display_name": "Gholamreza Eghbali", "link": "https://stackoverflow.com/users/8851586/gholamreza-eghbali"}, "reply_to_user": {"reputation": 2088, "user_id": 3309046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ce388de97238b3147f3d4ba62b17cb?s=128&d=identicon&r=PG", "display_name": "nishanthshanmugham", "link": "https://stackoverflow.com/users/3309046/nishanthshanmugham"}, "edited": false, "score": 0, "creation_date": 1509295200, "post_id": 47000312, "comment_id": 80951778, "body": "@nishanths I update it to last version 1.9.2 and the problem is still remained"}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 8851586, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ycu_fMxp-6o/AAAAAAAAAAI/AAAAAAAAAAk/vtL002j3ynI/photo.jpg?sz=128", "display_name": "Gholamreza Eghbali", "link": "https://stackoverflow.com/users/8851586/gholamreza-eghbali"}, "edited": false, "score": 0, "creation_date": 1509350141, "post_id": 47005138, "comment_id": 80966960, "body": "cannot build because of: ../../go/src/golang.org/x/oauth2/google/default.go:16:2: cannot find package &quot;cloud.google.com/go/compute/metadata&quot; in any of: \t/usr/local/go/src/cloud.google.com/go/compute/metadata (from $GOROOT) \t/home/reza/go/src/cloud.google.com/go/compute/metadata (from $GOPATH)"}, {"owner": {"reputation": 174, "user_id": 8851586, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ycu_fMxp-6o/AAAAAAAAAAI/AAAAAAAAAAk/vtL002j3ynI/photo.jpg?sz=128", "display_name": "Gholamreza Eghbali", "link": "https://stackoverflow.com/users/8851586/gholamreza-eghbali"}, "edited": false, "score": 0, "creation_date": 1509350386, "post_id": 47005138, "comment_id": 80967082, "body": "its funny i have this directory and packages in it!"}, {"owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "reply_to_user": {"reputation": 174, "user_id": 8851586, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ycu_fMxp-6o/AAAAAAAAAAI/AAAAAAAAAAk/vtL002j3ynI/photo.jpg?sz=128", "display_name": "Gholamreza Eghbali", "link": "https://stackoverflow.com/users/8851586/gholamreza-eghbali"}, "edited": false, "score": 0, "creation_date": 1509350576, "post_id": 47005138, "comment_id": 80967171, "body": "ls /home/reza/go/src/cloud.google.com/go/compute/ | grep metadata          did you check it ?"}], "tags": [], "owner": {"reputation": 218, "user_id": 6275993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PI08D.png?s=128&g=1", "display_name": "Jeyem", "link": "https://stackoverflow.com/users/6275993/jeyem"}, "is_accepted": true, "score": 1, "last_activity_date": 1509310401, "creation_date": 1509310401, "answer_id": 47005138, "question_id": 47000312, "link": "https://stackoverflow.com/questions/47000312/unrecognized-import-path-golang-google-package/47005138#47005138", "title": "unrecognized import path (golang google package)", "body": "<p>I had same issue, seems like serving repository from that path is missing,\nI find the repository in github and clone it into my $GOPATH/src\nthen Move the container of project to go.\nthis is the repository address:</p>\n\n<p>1) <code>git clone https://github.com/GoogleCloudPlatform/google-cloud-go</code></p>\n\n<p>2) <code>mv google-cloud-go $GOPATH/src/cloud.google.com/go/</code></p>\n"}], "owner": {"reputation": 174, "user_id": 8851586, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ycu_fMxp-6o/AAAAAAAAAAI/AAAAAAAAAAk/vtL002j3ynI/photo.jpg?sz=128", "display_name": "Gholamreza Eghbali", "link": "https://stackoverflow.com/users/8851586/gholamreza-eghbali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2340, "favorite_count": 1, "accepted_answer_id": 47005138, "answer_count": 1, "score": 5, "last_activity_date": 1509310401, "creation_date": 1509281073, "question_id": 47000312, "link": "https://stackoverflow.com/questions/47000312/unrecognized-import-path-golang-google-package", "title": "unrecognized import path (golang google package)", "body": "<p><strong>function used:</strong></p>\n\n<pre><code>go get golang.org/x/oauth2/google\n</code></pre>\n\n<p><strong>expect:</strong>\ndownload package\n<strong>what happened?</strong></p>\n\n<pre><code>package cloud.google.com/go/compute/metadata: unrecognized import path \"cloud.google.com/go/compute/metadata\" (parsing cloud.google.com/go/compute/metadata: XML syntax error on line 9: expected /&gt; in element)\n</code></pre>\n\n<p>thanks for helping</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 2, "last_activity_date": 1509264409, "creation_date": 1509264409, "answer_id": 46998072, "question_id": 46997570, "link": "https://stackoverflow.com/questions/46997570/is-there-no-google-app-engine-interactive-console-with-golang/46998072#46998072", "title": "Is there no Google App Engine interactive console with Golang?", "body": "<p>Though Go is compiled and not interpreted language, there\u2019re several projects</p>\n\n<p><a href=\"https://github.com/c-bata/go-prompt\" rel=\"nofollow noreferrer\">https://github.com/c-bata/go-prompt</a></p>\n\n<p><a href=\"https://github.com/mkouhei/gosh\" rel=\"nofollow noreferrer\">https://github.com/mkouhei/gosh</a></p>\n"}], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1509264409, "creation_date": 1509259840, "question_id": 46997570, "link": "https://stackoverflow.com/questions/46997570/is-there-no-google-app-engine-interactive-console-with-golang", "title": "Is there no Google App Engine interactive console with Golang?", "body": "<p>There is a Google App Engine interactive console with Python.</p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/standard/python/tools/using-local-server#using_the_interactive_console\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/standard/python/tools/using-local-server#using_the_interactive_console</a></p>\n\n<p>But in <code>Go</code> documents there is no information for it.</p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/standard/go/tools/using-local-server#using_the_interactive_console\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/standard/go/tools/using-local-server#using_the_interactive_console</a></p>\n\n<p>The interactive console with <code>Go</code> is not yet implemented?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "is_accepted": false, "score": 1, "last_activity_date": 1509260404, "creation_date": 1509260404, "answer_id": 46997639, "question_id": 46996959, "link": "https://stackoverflow.com/questions/46996959/how-to-solve-no-matching-index-found-error/46997639#46997639", "title": "How to solve &quot;no matching index found.&quot; error", "body": "<p>I had to specify <code>index.yaml</code> when deploying.</p>\n\n<pre><code>gcloud app deploy app.yaml index.yaml \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "edited": false, "score": 0, "creation_date": 1509287486, "post_id": 46998792, "comment_id": 80949216, "body": "Thanks, I&#39;ll check it from the console next time."}], "tags": [], "owner": {"reputation": 2153, "user_id": 3906640, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2c1241a92d7f8007a1fff3f1f77c4e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Y2H", "link": "https://stackoverflow.com/users/3906640/y2h"}, "is_accepted": true, "score": 1, "last_activity_date": 1509270437, "creation_date": 1509270437, "answer_id": 46998792, "question_id": 46996959, "link": "https://stackoverflow.com/questions/46996959/how-to-solve-no-matching-index-found-error/46998792#46998792", "title": "How to solve &quot;no matching index found.&quot; error", "body": "<p>ironsand is right, you can use <code>gcloud app deploy app.yaml index.yaml</code> when the indexes were not uploaded directly.</p>\n\n<p>However, you should always check first if they are being updated or not because sometimes it takes a while for Datastore to build the indexes. To check for this go to the App Engine console > Datastore > Indexes and check if the index in being built. If it is still building, this error will keep occurring until the Datastore finishes.</p>\n"}], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1133, "favorite_count": 0, "accepted_answer_id": 46998792, "answer_count": 2, "score": 1, "last_activity_date": 1509272782, "creation_date": 1509252661, "last_edit_date": 1509272782, "question_id": 46996959, "link": "https://stackoverflow.com/questions/46996959/how-to-solve-no-matching-index-found-error", "title": "How to solve &quot;no matching index found.&quot; error", "body": "<p>I created a sample app <code>guestbook-foo</code> in App Engine. </p>\n\n<p>It works fine in <code>localhost:8080</code>, but when I deploy the project, I get a \"no matching index found.\" error.</p>\n\n<pre><code>API error 4 (datastore_v3: NEED_INDEX): no matching index found. recommended index is:\n- kind: Greeting\n  ancestor: yes\n  properties:\n  - name: Date\n    direction: desc\n</code></pre>\n\n<p>In the project directory there is a <code>index.yaml</code></p>\n\n<pre><code>indexes:\n- kind: Greeting\n  ancestor: yes\n  properties:\n  - name: Date\n    direction: desc\n</code></pre>\n\n<p>I think I must upload the index file to the server. But I couldn't find out where I should specify the file. How can I configure <code>gcloud app deploy</code> option? Or is there another way to configure it?</p>\n"}, {"tags": ["file", "ubuntu", "go", "consul"], "comments": [{"owner": {"reputation": 2301, "user_id": 1168212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oayHK.jpg?s=128&g=1", "display_name": "Alex Yu", "link": "https://stackoverflow.com/users/1168212/alex-yu"}, "edited": false, "score": 1, "creation_date": 1509229956, "post_id": 46994809, "comment_id": 80936704, "body": "Just two thoughts:    A) It is not clear on which side  error occures (it could be possible that golang client is to blame, but error occures on server),  B. I would not exclude possibility that error is in error processing and real problem can be far away from file handles.  Hm. Not very optimistic.  Good luck!"}], "answers": [{"tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 4, "last_activity_date": 1509227473, "creation_date": 1509227473, "answer_id": 46994843, "question_id": 46994809, "link": "https://stackoverflow.com/questions/46994809/go-program-running-out-of-file-handles-when-there-are-plenty-file-handles-availa/46994843#46994843", "title": "Go program running out of file handles when there are plenty file handles available", "body": "<blockquote>\n  <p>Any ideas on how I could debug this? Where should I be looking at?</p>\n</blockquote>\n\n<p>Send the program a SIGQUIT while it is running.  This will make a backtrace of all the running go routines.  You'll probably find your culprit in there.</p>\n\n<p>My money would be on forgetting to Close() the Body of an http.Response as that is what I do the most often!</p>\n"}, {"tags": [], "owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "is_accepted": false, "score": 0, "last_activity_date": 1509406319, "creation_date": 1509406319, "answer_id": 47025764, "question_id": 46994809, "link": "https://stackoverflow.com/questions/46994809/go-program-running-out-of-file-handles-when-there-are-plenty-file-handles-availa/47025764#47025764", "title": "Go program running out of file handles when there are plenty file handles available", "body": "<p>Consider <a href=\"https://golang.org/pkg/net/http/#Transport.CloseIdleConnections\" rel=\"nofollow noreferrer\">closing</a> the idle connections if you are connecting to different endpoints/services(i.e. if you are running a crawler).</p>\n"}], "owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1509406319, "creation_date": 1509227259, "question_id": 46994809, "link": "https://stackoverflow.com/questions/46994809/go-program-running-out-of-file-handles-when-there-are-plenty-file-handles-availa", "title": "Go program running out of file handles when there are plenty file handles available", "body": "<p>I have a golang program that connects to other services (and a local consul agent) and when talking to the consul agent it's failing with the following error:</p>\n\n<pre><code>Put http://localhost:9501/v1/kv/health_checks/item: dial tcp: lookup localhost: too many open files\n</code></pre>\n\n<p>And this is all good, I can just check how many open files the system and the program has, right?</p>\n\n<pre><code>ulimit -a\ncore file size          (blocks, -c) 0\ndata seg size           (kbytes, -d) unlimited\nscheduling priority             (-e) 0\nfile size               (blocks, -f) unlimited\npending signals                 (-i) 7871\nmax locked memory       (kbytes, -l) 64\nmax memory size         (kbytes, -m) unlimited\nopen files                      (-n) 16384\npipe size            (512 bytes, -p) 8\nPOSIX message queues     (bytes, -q) 819200\nreal-time priority              (-r) 0\nstack size              (kbytes, -s) 8192\ncpu time               (seconds, -t) unlimited\nmax user processes              (-u) 7871\nvirtual memory          (kbytes, -v) unlimited\nfile locks                      (-x) unlimited\n</code></pre>\n\n<p>And <code>lsof</code>:</p>\n\n<pre><code>lsof | wc -l\n5343\n</code></pre>\n\n<p>This is still way below the limit. Other programs in the system are all good, I can CURL services, I can CURL this consul agent, create files and everything, but the golang program continues to fail.</p>\n\n<p>Any ideas on how I could debug this? Where should I be looking at?</p>\n"}, {"tags": ["json", "go", "struct"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1509232376, "post_id": 46994339, "comment_id": 80937257, "body": "I believe you cannot dynamically, at runtime, define types in Go. The next best option would be to use code generation."}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1509256025, "post_id": 46994339, "comment_id": 80941034, "body": "What result do you want to achieve?"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1509260557, "post_id": 46994339, "comment_id": 80941841, "body": "If you really unstructured data you can unmarshal it into maps like <code>map[string]interface{}</code>"}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1509292461, "post_id": 46995254, "comment_id": 80950913, "body": "@kendall-weihe, for one-off gigs, you can use <a href=\"https://github.com/mholt/json-to-go\" rel=\"nofollow noreferrer\"><code>github.com&#47;mholt&#47;json-to-go</code></a>, which also has a readily working site which would generate a set of Go types from the JSON samples you throw at it."}], "tags": [], "owner": {"reputation": 2301, "user_id": 1168212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oayHK.jpg?s=128&g=1", "display_name": "Alex Yu", "link": "https://stackoverflow.com/users/1168212/alex-yu"}, "is_accepted": false, "score": 2, "last_activity_date": 1509266156, "last_edit_date": 1509266156, "creation_date": 1509230968, "answer_id": 46995254, "question_id": 46994339, "link": "https://stackoverflow.com/questions/46994339/dynamically-define-structs-from-json-file-in-go/46995254#46995254", "title": "Dynamically define structs from JSON file in Go", "body": "<p>I can't garantantee final result, but <a href=\"https://github.com/mailru/easyjson\" rel=\"nofollow noreferrer\">easyjson</a> does exactly what you asking.</p>\n\n<blockquote>\n  <p>easyjson aims to keep generated Go code simple enough so that it can\n  be easily optimized or fixed. Another goal is to provide users with\n  the ability to customize the generated code by providing options not\n  available with the standard encoding/json package, such as generating\n  \"snake_case\" names or enabling omitempty behavior by default.</p>\n</blockquote>\n"}], "owner": {"reputation": 1933, "user_id": 5449456, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-2pNZV5O6iBo/AAAAAAAAAAI/AAAAAAAAAEk/eEtyVSBbwSk/photo.jpg?sz=128", "display_name": "Kendall Weihe", "link": "https://stackoverflow.com/users/5449456/kendall-weihe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509266156, "creation_date": 1509223724, "question_id": 46994339, "link": "https://stackoverflow.com/questions/46994339/dynamically-define-structs-from-json-file-in-go", "title": "Dynamically define structs from JSON file in Go", "body": "<p>I want to dynamically define structs in a Go project based on a JSON file.</p>\n\n<p>For example, if I had a json file like so...</p>\n\n<pre><code>{\n  \"date\": \"today\",\n  \"time\": 12,\n  \"era\": \"never\",\n  \"alive\": true\n}\n</code></pre>\n\n<p>Then I would expect a struct to be generated (that would look) like this (but not explicitly defined in the source code)...</p>\n\n<pre><code>type DynamicJSON struct {\n  date, era string\n  time int\n  alive bool\n}\n</code></pre>\n\n<p>Furthermore, I want to nest JSON objects such that I could do something like this...</p>\n\n<pre><code>{\n  \"date\": \"today\",\n  \"time\": 12,\n  \"era\": \"never\",\n  \"alive\": true,\n  \"nested\": {\n    \"date\": \"tomorrow\",\n    \"alive\": true\n  }\n}\n</code></pre>\n\n<p>...which would actually generate two different structs, like this...</p>\n\n<pre><code>type DynamicJSON1 struct {\n      date, era string\n      time int\n      alive bool\n}\n\n\ntype DynamicJSON2 struct {\n      date string\n      alive bool\n}\n</code></pre>\n\n<p>Is this something that is currently supported?</p>\n"}, {"tags": ["xml", "go", "xml-parsing", "unmarshalling"], "comments": [{"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1509225570, "post_id": 46994280, "comment_id": 80935577, "body": "What values do you want?"}, {"owner": {"reputation": 33, "user_id": 6411342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY3Yu.jpg?s=128&g=1", "display_name": "Hendry Steffens", "link": "https://stackoverflow.com/users/6411342/hendry-steffens"}, "reply_to_user": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1509225658, "post_id": 46994280, "comment_id": 80935595, "body": "all &quot;&lt;time&gt;&quot; tags"}, {"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1509225974, "post_id": 46994280, "comment_id": 80935683, "body": "Only <code>&lt;time&gt;</code>, not also <code>&lt;date&gt;</code>?"}, {"owner": {"reputation": 33, "user_id": 6411342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY3Yu.jpg?s=128&g=1", "display_name": "Hendry Steffens", "link": "https://stackoverflow.com/users/6411342/hendry-steffens"}, "reply_to_user": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1509226057, "post_id": 46994280, "comment_id": 80935711, "body": "I don&#39;t need the &lt;date&gt;"}], "answers": [{"tags": [], "owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "is_accepted": true, "score": 2, "last_activity_date": 1509226486, "creation_date": 1509226486, "answer_id": 46994708, "question_id": 46994280, "link": "https://stackoverflow.com/questions/46994280/xml-parsing-unmarshal-return-nothing/46994708#46994708", "title": "XML parsing/Unmarshal return nothing", "body": "<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\nvar data string = `&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;S:Envelope xmlns:S=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n   &lt;S:Body&gt;\n      &lt;ns2:consultaPontoResponse \nxmlns:ns2=\"http://ws.consultaponto.senior.com/\"&gt;\n         &lt;return&gt;\n            &lt;clock&gt;\n               &lt;date&gt;\n                  &lt;day&gt;28&lt;/day&gt;\n                  &lt;month&gt;10&lt;/month&gt;\n                  &lt;year&gt;2017&lt;/year&gt;\n               &lt;/date&gt;\n               &lt;time&gt;\n                  &lt;hour&gt;9&lt;/hour&gt;\n                  &lt;minute&gt;14&lt;/minute&gt;\n               &lt;/time&gt;\n            &lt;/clock&gt;\n            &lt;clock&gt;\n               &lt;date&gt;\n                  &lt;day&gt;28&lt;/day&gt;\n                  &lt;month&gt;10&lt;/month&gt;\n                  &lt;year&gt;2017&lt;/year&gt;\n               &lt;/date&gt;\n               &lt;time&gt;\n                  &lt;hour&gt;11&lt;/hour&gt;\n                  &lt;minute&gt;51&lt;/minute&gt;\n               &lt;/time&gt;\n            &lt;/clock&gt;\n            &lt;clock&gt;\n               &lt;date&gt;\n                  &lt;day&gt;28&lt;/day&gt;\n                  &lt;month&gt;10&lt;/month&gt;\n                  &lt;year&gt;2017&lt;/year&gt;\n               &lt;/date&gt;\n               &lt;time&gt;\n                  &lt;hour&gt;12&lt;/hour&gt;\n                  &lt;minute&gt;4&lt;/minute&gt;\n               &lt;/time&gt;\n            &lt;/clock&gt;\n            &lt;clock&gt;\n               &lt;date&gt;\n                  &lt;day&gt;28&lt;/day&gt;\n                  &lt;month&gt;10&lt;/month&gt;\n                  &lt;year&gt;2017&lt;/year&gt;\n               &lt;/date&gt;\n               &lt;time&gt;\n                  &lt;hour&gt;12&lt;/hour&gt;\n                  &lt;minute&gt;27&lt;/minute&gt;\n               &lt;/time&gt;\n            &lt;/clock&gt;\n            &lt;workedTime&gt;\n               &lt;hour&gt;3&lt;/hour&gt;\n               &lt;minute&gt;0&lt;/minute&gt;\n            &lt;/workedTime&gt;\n            &lt;currentDateTime&gt;\n               &lt;date&gt;\n                  &lt;day&gt;28&lt;/day&gt;\n                  &lt;month&gt;10&lt;/month&gt;\n                  &lt;year&gt;2017&lt;/year&gt;\n               &lt;/date&gt;\n               &lt;time&gt;\n                  &lt;hour&gt;13&lt;/hour&gt;\n                  &lt;minute&gt;16&lt;/minute&gt;\n               &lt;/time&gt;\n            &lt;/currentDateTime&gt;\n         &lt;/return&gt;\n      &lt;/ns2:consultaPontoResponse&gt;\n   &lt;/S:Body&gt;\n&lt;/S:Envelope&gt;`\n\ntype Time struct {\n    Hour   int `xml:\"hour\"`\n    Minute int `xml:\"minute\"`\n}\n\nfunc (t Time) String() string {\n    return fmt.Sprintf(\"%02d:%02d\", t.Hour, t.Minute)\n}\n\ntype Return struct {\n    Times []Time `xml:\"Body&gt;consultaPontoResponse&gt;return&gt;clock&gt;time\"`\n}\n\nfunc main() {\n    var r Return\n\n    err := xml.Unmarshal([]byte(data), &amp;r)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(\"Times:\")\n    for _, t := range r.Times {\n        fmt.Println(\"*\", t)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Y9u3Q3YrSi\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Y9u3Q3YrSi</a></p>\n"}], "owner": {"reputation": 33, "user_id": 6411342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY3Yu.jpg?s=128&g=1", "display_name": "Hendry Steffens", "link": "https://stackoverflow.com/users/6411342/hendry-steffens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 46994708, "answer_count": 1, "score": 1, "last_activity_date": 1509226486, "creation_date": 1509223267, "last_edit_date": 1509225200, "question_id": 46994280, "link": "https://stackoverflow.com/questions/46994280/xml-parsing-unmarshal-return-nothing", "title": "XML parsing/Unmarshal return nothing", "body": "<p>I need some values from xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;S:Envelope xmlns:S=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n   &lt;S:Body&gt;\n      &lt;ns2:consultaPontoResponse \nxmlns:ns2=\"http://ws.consultaponto.senior.com/\"&gt;\n         &lt;return&gt;\n            &lt;clock&gt;\n               &lt;date&gt;\n                  &lt;day&gt;28&lt;/day&gt;\n                  &lt;month&gt;10&lt;/month&gt;\n                  &lt;year&gt;2017&lt;/year&gt;\n               &lt;/date&gt;\n               &lt;time&gt;\n                  &lt;hour&gt;9&lt;/hour&gt;\n                  &lt;minute&gt;14&lt;/minute&gt;\n               &lt;/time&gt;\n            &lt;/clock&gt;\n            &lt;clock&gt;\n               &lt;date&gt;\n                  &lt;day&gt;28&lt;/day&gt;\n                  &lt;month&gt;10&lt;/month&gt;\n                  &lt;year&gt;2017&lt;/year&gt;\n               &lt;/date&gt;\n               &lt;time&gt;\n                  &lt;hour&gt;11&lt;/hour&gt;\n                  &lt;minute&gt;51&lt;/minute&gt;\n               &lt;/time&gt;\n            &lt;/clock&gt;\n            &lt;clock&gt;\n               &lt;date&gt;\n                  &lt;day&gt;28&lt;/day&gt;\n                  &lt;month&gt;10&lt;/month&gt;\n                  &lt;year&gt;2017&lt;/year&gt;\n               &lt;/date&gt;\n               &lt;time&gt;\n                  &lt;hour&gt;12&lt;/hour&gt;\n                  &lt;minute&gt;4&lt;/minute&gt;\n               &lt;/time&gt;\n            &lt;/clock&gt;\n            &lt;clock&gt;\n               &lt;date&gt;\n                  &lt;day&gt;28&lt;/day&gt;\n                  &lt;month&gt;10&lt;/month&gt;\n                  &lt;year&gt;2017&lt;/year&gt;\n               &lt;/date&gt;\n               &lt;time&gt;\n                  &lt;hour&gt;12&lt;/hour&gt;\n                  &lt;minute&gt;27&lt;/minute&gt;\n               &lt;/time&gt;\n            &lt;/clock&gt;\n            &lt;workedTime&gt;\n               &lt;hour&gt;3&lt;/hour&gt;\n               &lt;minute&gt;0&lt;/minute&gt;\n            &lt;/workedTime&gt;\n            &lt;currentDateTime&gt;\n               &lt;date&gt;\n                  &lt;day&gt;28&lt;/day&gt;\n                  &lt;month&gt;10&lt;/month&gt;\n                  &lt;year&gt;2017&lt;/year&gt;\n               &lt;/date&gt;\n               &lt;time&gt;\n                  &lt;hour&gt;13&lt;/hour&gt;\n                  &lt;minute&gt;16&lt;/minute&gt;\n               &lt;/time&gt;\n            &lt;/currentDateTime&gt;\n         &lt;/return&gt;\n      &lt;/ns2:consultaPontoResponse&gt;\n   &lt;/S:Body&gt;\n&lt;/S:Envelope&gt;\n</code></pre>\n\n<p>And I create some structs to unmarshall : </p>\n\n<pre><code>type Envelope struct {\n    Body Body\n}\n\ntype Body struct {\n    Consulta Consulta `xml: \"consultaPontoResponse\"`\n}\n\ntype Consulta struct {\n   Return Return\n}\n\ntype Clock struct {\n   Time Time\n}\n\ntype Return struct {\n    Clock []Clock\n}\n\ntype Time struct {\n   Hour string\n   Minute string\n}\n</code></pre>\n\n<p>So I dont receive nothing when use :</p>\n\n<pre><code>xmlEnvelope := &amp;Envelope{}\nxml.Unmarshal(sonataXml, xmlEnvelope)\n</code></pre>\n\n<p>The return of <code>xml.Unmarshal(sonataXml, xmlEnvelope)</code> is a empty object. This xml is a response of SOAP request and I don't need all the tag values. Can I get only specific tag values? Or do I need to create all structs to get values?</p>\n"}, {"tags": ["go", "sqlx"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1509223196, "post_id": 46994040, "comment_id": 80934926, "body": "Include the code that doesn&#39;t work. I suspect you&#39;re passing <code>args</code>, not <code>args...</code>"}, {"owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1509223898, "post_id": 46994040, "comment_id": 80935128, "body": "So the func getUser() code above doesn&#39;t work, in particular, the line sqlutils.GetRows(parseRows, sql, userID) will fail. I&#39;m not sure whether userID is an args or args..."}, {"owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1509224749, "post_id": 46994040, "comment_id": 80935380, "body": "Ah, in fact your intuition is correct. I hunted down a call in which I passed exactly that, args and not args... It&#39;s fixed now (I think ... still more checking to do)."}], "owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 514, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1509223819, "creation_date": 1509221681, "last_edit_date": 1509223819, "question_id": 46994040, "link": "https://stackoverflow.com/questions/46994040/jmoiron-sqlx-interface-and-abstracting-some-boilerplate", "title": "jmoiron/sqlx, ...interface{}, and abstracting some boilerplate", "body": "<p>I thought I'd try to be a little bit \"clever\" and abstract some of my boilerplate SQL code (using sqlx -- <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">https://github.com/jmoiron/sqlx</a>). The idea is to feed a code a function pointer to process the result, along with the sql string and args that produce the rows. As it happens, the code works fine provided I strip out the \"sqlArgs interface\" stuff, but in the \"cleverer\" format errors with the statement </p>\n\n<p>sql: converting Exec argument $1 type: unsupported type []interface {}, a slice of interface</p>\n\n<p>Here are two versions, the first one that errors, the second that works but without parameterization:</p>\n\n<pre><code>//GetRows (doesn't work)\nfunc GetRows(parseRows func(*sqlx.Rows), sql string, sqlArgs ...interface{}) {\n    db := sqlx.MustConnect(\"mysql\", ConnString)\n\n    defer db.Close()\n\n    rows, err := db.Queryx(sql, sqlArgs)\n\n    defer rows.Close()\n\n    if err != nil {\n        panic(err)\n    }\n\n    parseRows(rows)\n\n}\n\n//GetRows ... (works, but doesn't allow parameterization)\nfunc GetRows(fp func(*sqlx.Rows), sql string) {\n\n    db := sqlx.MustConnect(\"mysql\", ConnString)\n\n    defer db.Close()\n\n    rows, err := db.Queryx(sql)\n\n    defer rows.Close()\n\n    if err != nil {\n        panic(err)\n    }\n\n    fp(rows)\n\n}\n</code></pre>\n\n<p>The idea is to call the code something like this:</p>\n\n<pre><code>func getUser(userID string) User {\n\n    var users []*User\n\n    parseRows := func(rows *sqlx.Rows) {\n        for rows.Next() {\n            var u User\n            err := rows.StructScan(&amp;u)\n\n            if err != nil {\n                panic(err)\n            }\n\n            users = append(users, u)\n        }\n    }\n\n    sql := \"SELECT * FROM users WHERE userid = ?;\"\n\n    sqlutils.GetRows(parseRows, sql, userID)\n\n    if len(users) == 1{\n        return users[0]\n    }\n\n    return User{}\n\n}\n</code></pre>\n\n<p>I guess my code doesn't actually pass through the userID from call to call, but instead it passes an []interface{}, which the sql package can't handle. I'm not sure about that, however. In any case, is there any way to accomplish this idea? Thanks.</p>\n"}, {"tags": ["go", "https"], "answers": [{"comments": [{"owner": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "edited": false, "score": 0, "creation_date": 1509208864, "post_id": 46992075, "comment_id": 80930653, "body": "Yes but IIRC doesn&#39;t the server.crt have to be created by concatenating files together? I may be remembering wrong though"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "edited": false, "score": 0, "creation_date": 1509209194, "post_id": 46992075, "comment_id": 80930757, "body": "If I got right these are certificates of issuer. Including such certificates and creating bundle is good because browsers (Firefox of previous versions) did not accept your correct certificate if didn\u2019t have access to a full chain. You may start with Chrome browser to debug all the things. Then join all the certificates to a bundle and deploy with it"}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 3, "last_activity_date": 1509209252, "last_edit_date": 1509209252, "creation_date": 1509208796, "answer_id": 46992075, "question_id": 46992030, "link": "https://stackoverflow.com/questions/46992030/how-to-set-up-https-on-golang-web-server/46992075#46992075", "title": "How to set up HTTPS on golang web server?", "body": "<p>You need <code>http.ListenAndServeTLS</code></p>\n\n<pre><code>package main\n\nimport (\n    // \"fmt\"\n    // \"io\"\n    \"net/http\"\n    \"log\"\n)\n\nfunc HelloServer(w http.ResponseWriter, req *http.Request) {\n    w.Header().Set(\"Content-Type\", \"text/plain\")\n    w.Write([]byte(\"This is an example server.\\n\"))\n    // fmt.Fprintf(w, \"This is an example server.\\n\")\n    // io.WriteString(w, \"This is an example server.\\n\")\n}\n\nfunc main() {\nhttp.HandleFunc(\"/hello\", HelloServer)\n    err := http.ListenAndServeTLS(\":443\", \"server.crt\", \"server.key\", nil)\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n\n<p>Here\u2019s a snippet: <a href=\"https://gist.github.com/denji/12b3a568f092ab951456\" rel=\"nofollow noreferrer\">https://gist.github.com/denji/12b3a568f092ab951456</a></p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 7729983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-POO5O-I1nME/AAAAAAAAAAI/AAAAAAAAAlc/oT1amiDdVr4/photo.jpg?sz=128", "display_name": "DTechnlogy", "link": "https://stackoverflow.com/users/7729983/dtechnlogy"}, "edited": false, "score": 0, "creation_date": 1612804310, "post_id": 46992083, "comment_id": 116875395, "body": "I&#39;m not sure why that cat cmd doesn&#39;t work on me, but I merged them manually with text editor it works well now. Thank you!"}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 20, "last_activity_date": 1606670220, "last_edit_date": 1606670220, "creation_date": 1509208842, "answer_id": 46992083, "question_id": 46992030, "link": "https://stackoverflow.com/questions/46992030/how-to-set-up-https-on-golang-web-server/46992083#46992083", "title": "How to set up HTTPS on golang web server?", "body": "<p>Use <a href=\"https://golang.org/pkg/net/http/#ListenAndServeTLS\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#ListenAndServeTLS</a></p>\n<pre><code>http.HandleFunc(&quot;/&quot;, handler)\nlog.Printf(&quot;About to listen on 10443. Go to https://127.0.0.1:10443/&quot;)\nerr := http.ListenAndServeTLS(&quot;:10443&quot;, &quot;full-cert.crt&quot;, &quot;private-key.key&quot;, nil)\nlog.Fatal(err)\n</code></pre>\n<p>For Go you need one certificate file (containing one or more certs, starting with yours) and one private key file (containing one private key).</p>\n<p>This isn't really a go question, but the intermediate certs are required because computers only store root certs. By concatenating them you put them all in one file so the browser gets all certs - this is a required step otherwise your server will fail on certain devices. Your cert provider will provide instructions for doing this.</p>\n<p><a href=\"https://kb.wisc.edu/page.php?id=18923\" rel=\"nofollow noreferrer\">https://kb.wisc.edu/page.php?id=18923</a></p>\n<p>To combine the certs you can just use cat (making sure they have a line feed at the end of the file first), something like:</p>\n<pre><code>cat example.com.ca-crt example.com.ca-bundle &gt; example.com.crt\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11388893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f195d7a0e8ed3d55ee596007c30616?s=128&d=identicon&r=PG", "display_name": "Adriano Sela Aviles", "link": "https://stackoverflow.com/users/11388893/adriano-sela-aviles"}, "is_accepted": false, "score": -2, "last_activity_date": 1557200735, "creation_date": 1557200735, "answer_id": 56015254, "question_id": 46992030, "link": "https://stackoverflow.com/questions/46992030/how-to-set-up-https-on-golang-web-server/56015254#56015254", "title": "How to set up HTTPS on golang web server?", "body": "<p>The library <a href=\"https://github.com/adrianosela/sslmgr\" rel=\"nofollow noreferrer\">https://github.com/adrianosela/sslmgr</a> abstracts away the whole concept of keys and certificates. All you need is for the server to be reachable by the hostname (i.e. your DNS must point yourdomain.com to your-public-ip). You can even disable SSL for local development as follows:</p>\n\n<pre><code>ss, err := sslmgr.NewServer(sslmgr.ServerConfig{\n    Hostnames: []string{os.Getenv(\"yourdomain.com\")},\n    Handler:   h,\n    ServeSSLFunc: func() bool {\n        return strings.ToLower(os.Getenv(\"PROD\")) == \"true\"\n    },\n})\nif err != nil {\n    log.Fatal(err)\n}\nss.ListenAndServe()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 823, "user_id": 2754828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db2ee3c9233a649bb63a80780dd575b?s=128&d=identicon&r=PG&f=1", "display_name": "R.Cha", "link": "https://stackoverflow.com/users/2754828/r-cha"}, "is_accepted": false, "score": 1, "last_activity_date": 1569113862, "creation_date": 1569113862, "answer_id": 58045244, "question_id": 46992030, "link": "https://stackoverflow.com/questions/46992030/how-to-set-up-https-on-golang-web-server/58045244#58045244", "title": "How to set up HTTPS on golang web server?", "body": "<p>Here is my finding and I would like to share because it took me a few hours as all available installation guides were for Nginx and Apache HTTP configurations, not for the Golang Web Server.</p>\n\n<p>Environments:</p>\n\n<ul>\n<li>SSL certificate from Comodo / Sectigo</li>\n<li>Gin-gonic as middleware</li>\n</ul>\n\n<p>Issue:</p>\n\n<ul>\n<li>It was working fine on Chrome/Firefox on Mac but was giving me a CORS error on Windows Firefox. Later, it was found that it was not really a CORS related matter, and I diagnosed my ubuntu server of the SSL validity by using <a href=\"https://www.digicert.com/help\" rel=\"nofollow noreferrer\">https://www.digicert.com/help</a>. The result was, \"The certificate is not signed by a trusted authority (checking against Mozilla's root store)\".</li>\n</ul>\n\n<p>Solution: </p>\n\n<p>The solution is to concatenate the following certificates by using a text editor and name it as you'd like. I saved it as \"my_domain.txt\".</p>\n\n<ul>\n<li>my_domain.ca-bundle (which includes one root and two intermediate certs)</li>\n<li>my_domain.crt (the main cert for my domain)</li>\n</ul>\n\n<p>Then run it like this,</p>\n\n<pre><code>router.RunTLS(\":\"+os.Getenv(\"PORT\"), \"../my_domain.txt\", \"../my_private_key.txt\")\n</code></pre>\n\n<p>Hope it helped!</p>\n"}], "owner": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16860, "favorite_count": 1, "accepted_answer_id": 46992083, "answer_count": 4, "score": 12, "last_activity_date": 1606670220, "creation_date": 1509208519, "question_id": 46992030, "link": "https://stackoverflow.com/questions/46992030/how-to-set-up-https-on-golang-web-server", "title": "How to set up HTTPS on golang web server?", "body": "<p>I'm reading <a href=\"https://www.kaihag.com/https-and-go/\" rel=\"noreferrer\">https://www.kaihag.com/https-and-go/</a> and bought an SSL certificate from Comodo which they emailed me a <code>.zip</code> file. All of the files I have so far look like this</p>\n\n<pre><code>csr.pem\nprivate-key.pem\nwebsite.com.crt\nwebsite.com.ca-bundle\nwebsite.com.zip\n</code></pre>\n\n<p>The above website wants me to concatenate 3 <code>.pem</code> files which I don't have. Incidentally what is the reason the <code>.pem</code> files need to concatenated? Using the above files which haven't been modified, how can https be set up on a golang webserver?</p>\n"}, {"tags": ["arrays", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 608, "user_id": 4050822, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/UiYwh.jpg?s=128&g=1", "display_name": "Shivendra Mishra", "link": "https://stackoverflow.com/users/4050822/shivendra-mishra"}, "edited": false, "score": 0, "creation_date": 1509210701, "post_id": 46991766, "comment_id": 80931277, "body": "Kenny, Thanks for the answer. I have been trying []float({1,2}) , and thinking whats wrong!"}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 2, "last_activity_date": 1509207259, "last_edit_date": 1509207259, "creation_date": 1509206944, "answer_id": 46991766, "question_id": 46991728, "link": "https://stackoverflow.com/questions/46991728/writing-array-in-struct-golang/46991766#46991766", "title": "writing array in struct (Golang)", "body": "<p>The error you are reporting is caused by the lack of a declaration of type before the arrays in your array. The error:</p>\n\n<blockquote>\n  <p>missing type in composite literal</p>\n</blockquote>\n\n<p>Is referring to this bit of your declaration:</p>\n\n<pre><code>{2, 3}\n</code></pre>\n\n<p>That needs to specify the type of the array:</p>\n\n<pre><code>[]float64{2, 3}\n</code></pre>\n\n<p>So you need:</p>\n\n<pre><code>var testMatrix = []struct {\n    dataX      []float64\n    dataY      []float64\n    result     float64\n    myFunction myFunctionType\n}{\n    {[]float64{2, 3}, []float64{8, 7}, 1, doMagicOne},\n    {[]float64{2, 3}, []float64{8, 7}, 1, doMagicTwo},\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/AguxDJ11HS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/AguxDJ11HS</a></p>\n"}], "owner": {"reputation": 608, "user_id": 4050822, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/UiYwh.jpg?s=128&g=1", "display_name": "Shivendra Mishra", "link": "https://stackoverflow.com/users/4050822/shivendra-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 910, "favorite_count": 0, "accepted_answer_id": 46991766, "answer_count": 1, "score": -1, "last_activity_date": 1509207259, "creation_date": 1509206655, "question_id": 46991728, "link": "https://stackoverflow.com/questions/46991728/writing-array-in-struct-golang", "title": "writing array in struct (Golang)", "body": "<p>I have been writing test cases using \"testing\" package of Golang. And I've come across a situation where I have to write array and function pointers into a table. </p>\n\n<p>I tried following:</p>\n\n<pre><code>type myFunctionType func( []float64, []float64 ) float64\nvar testMatrix = []struct {\n    dataX []float64\n    dataY []float64\n    result float64\n    myFunction myFunctionType\n} {\n{ {2, 3}, {8, 7}, 1, doMagicOne},\n  {2, 3}, {8, 7}, 1, doMagicTwo},\n}\n</code></pre>\n\n<p>But every time I end up getting following error or something else:</p>\n\n<blockquote>\n  <p>missing type in composite literal</p>\n</blockquote>\n\n<p>Any input in the above? Thanks in advance.</p>\n"}, {"tags": ["c", "go"], "comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1509208608, "post_id": 46991662, "comment_id": 80930562, "body": "According to the accepted answer to <a href=\"https://stackoverflow.com/questions/18500923/issue-with-archive-which-is-not-the-architecture-being-linked-x86-64-in-c\">this question</a>, you may have a bitness issue.  They may have been built on the same machine, but the default bitness may not be the same for each tool chain."}, {"owner": {"reputation": 9116, "user_id": 395258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/613cdeb318951f568212eaaf9bec19e7?s=128&d=identicon&r=PG", "display_name": "C. E.", "link": "https://stackoverflow.com/users/395258/c-e"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1509222656, "post_id": 46991662, "comment_id": 80934763, "body": "@jwdonahue The &quot;tool chain&quot; is Go build and Xcode, on the same machine. I don&#39;t see any reason why there should be a difference."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1509222989, "post_id": 46991662, "comment_id": 80934855, "body": "I&#39;ll just sit in the corner and rust."}, {"owner": {"reputation": 9116, "user_id": 395258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/613cdeb318951f568212eaaf9bec19e7?s=128&d=identicon&r=PG", "display_name": "C. E.", "link": "https://stackoverflow.com/users/395258/c-e"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1509223489, "post_id": 46991662, "comment_id": 80935015, "body": "@jwdonahue You may be right and I will investigate it, I was just surprised. Thank you for your help."}, {"owner": {"reputation": 9116, "user_id": 395258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/613cdeb318951f568212eaaf9bec19e7?s=128&d=identicon&r=PG", "display_name": "C. E.", "link": "https://stackoverflow.com/users/395258/c-e"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1509263445, "post_id": 46991662, "comment_id": 80942476, "body": "@jwdonahue I have updated with a new attempt where I use <code>GOARCH=amd64</code> to specify the architecture. If I understand it correctly, amd64 is x86_64 (it was originally called x86-64 but was later rebranded amd64.) However, it still does not work."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1509263655, "post_id": 46991662, "comment_id": 80942522, "body": "If GOARCH defaults to amd64, your test doesn&#39;t tell us anything.  Did you also try x86?"}, {"owner": {"reputation": 9116, "user_id": 395258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/613cdeb318951f568212eaaf9bec19e7?s=128&d=identicon&r=PG", "display_name": "C. E.", "link": "https://stackoverflow.com/users/395258/c-e"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1509263834, "post_id": 46991662, "comment_id": 80942570, "body": "@jwdonahue The possible ones are &quot;386&quot;, &quot;amd64&quot;, &quot;amd64p32&quot;, &quot;arm&quot;, &quot;arm64&quot;, &quot;mips&quot;, &quot;mipsle&quot;, &quot;mips64&quot;, &quot;mips64le&quot;, &quot;ppc64&quot;, &quot;ppc64le&quot; and &quot;s390x&quot;. However, I have seen it being explicitly mentioned that it works on x86, which is why I started to look into aliases, and e.g. <a href=\"https://askubuntu.com/questions/601553/what-is-the-difference-between-x86-64-amd64-and-64-bit\">this</a> answer says that amd64 is x86."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1509264055, "post_id": 46991662, "comment_id": 80942637, "body": "then use 386, that&#39;s definitely 32 bit."}, {"owner": {"reputation": 9116, "user_id": 395258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/613cdeb318951f568212eaaf9bec19e7?s=128&d=identicon&r=PG", "display_name": "C. E.", "link": "https://stackoverflow.com/users/395258/c-e"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1509264741, "post_id": 46991662, "comment_id": 80942801, "body": "@jwdonahue It doesn&#39;t work, but why do you think I should try compiling to 32 bit? I don&#39;t see anything which indicates that I need to do that. x86-64 which I try to link to is 64 bit. The problem in the question you linked to is that OP had tried to use a library compiled by someone else for 32 bit, in code which he compiled as 64 bit. I am compiling both my library and my code as 64 bit, it&#39;s not the same thing."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1509264837, "post_id": 46991662, "comment_id": 80942825, "body": "FYI: <a href=\"https://en.wikipedia.org/wiki/X86-64#AMD64\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/X86-64#AMD64</a> explains exactly what is meant by x86-64 and amd64. Both are clearly 64 bit.  This is the norm for modern systems, but many tool chains still default to 32 bit instruction sets. 32 bit code often runs faster, even on 64 bit machines, takes less memory/disk and runs on more platforms than 64 bit programs."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1509265145, "post_id": 46991662, "comment_id": 80942908, "body": "The error message you are getting states that example.dylib &quot;<i>was built for archive which is not the architecture being linked...</i>&quot;.  So you&#39;ve got an architecture mismatch. Delete all of the build outputs and rebuild everything for an explicit architecture.  Do not rely on the defaults."}, {"owner": {"reputation": 9116, "user_id": 395258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/613cdeb318951f568212eaaf9bec19e7?s=128&d=identicon&r=PG", "display_name": "C. E.", "link": "https://stackoverflow.com/users/395258/c-e"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1509279994, "post_id": 46991662, "comment_id": 80946892, "body": "@jwdonahue That is what I did in my third example, where I specified <code>GOARCH=amd64</code>. I added an update to the post where I linked to where it says in the official documentation that amd64 and x86-64 are the same. I cannot explain this in any other way than that there is a bug in Go&#39;s compiler."}], "owner": {"reputation": 9116, "user_id": 395258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/613cdeb318951f568212eaaf9bec19e7?s=128&d=identicon&r=PG", "display_name": "C. E.", "link": "https://stackoverflow.com/users/395258/c-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1509266670, "creation_date": 1509206297, "last_edit_date": 1509266670, "question_id": 46991662, "link": "https://stackoverflow.com/questions/46991662/cannot-use-c-libraries-compiled-from-go-code-using-go-build", "title": "Cannot use C libraries compiled from Go code using &quot;Go build&quot;", "body": "<p>I am trying to get a minimal example of using Go code in C to work, such as <a href=\"https://blog.filippo.io/building-python-modules-with-go-1-5/\" rel=\"nofollow noreferrer\">this</a>. I am struggling with the following compilation error message:</p>\n\n<blockquote>\n  <p>ld: warning: ignoring file\n  /Users/username/gocode/src/example/example.dylib, file was built for\n  archive which is not the architecture being linked (x86_64):\n  /Users/username/gocode/src/example/example.dylib</p>\n</blockquote>\n\n<p>My attempt is the following. I have a simple Go package in a file main.go:</p>\n\n<pre><code>package example\n\nimport \"C\"\n\n//export GoEcho\nfunc GoEcho(s *C.char) string {\n    return C.GoString(s)\n}\n\nfunc main() {}\n</code></pre>\n\n<p>which I then compile using either</p>\n\n<pre><code>go build -buildmode=c-archive -o example.dylib main.go\n</code></pre>\n\n<p>or</p>\n\n<pre><code>go build -buildmode=c-shared -o example.dylib main.go\n</code></pre>\n\n<p>or</p>\n\n<pre><code>GOARCH=amd64 go build -buildmode=c-shared -o LibraryLinkExamples.dylib main.go\n</code></pre>\n\n<p>The operating system is OS X 10.11 and the the Go version is, as <code>go version</code> puts it, <code>go1.9 darwin/amd64</code>.</p>\n\n<p>The C code I'm using is the following:</p>\n\n<pre><code>#include \"example.h\"\n#include &lt;stdio.h&gt;\n\nint main(int argc, char const *argv[])\n{\n    GoString res = GoEcho(\"test\");\n    printf(\"%.*s\\n\", (int)res.n, res.p);\n    return 0;\n}\n</code></pre>\n\n<p>I don't understand why I am getting the \"which is not the architecture being linked (x86_64)\" error message when I am building the library and using it on the same operating system, even the computer? What can explain this?</p>\n\n<p><strong>Update</strong>\nIn the official documentation <a href=\"https://golang.org/doc/install/source\" rel=\"nofollow noreferrer\">here</a> it says:</p>\n\n<blockquote>\n  <p>amd64 (also known as x86-64)</p>\n</blockquote>\n\n<p>meaning it <strong>should</strong> be x86-64 compatible with this setting. That it isn't is possibly a bug in <code>go build</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1509208200, "post_id": 46990943, "comment_id": 80930444, "body": "The type assertion in your first example is a red herring. You can remove it without changing the semantics. A variable cannot change its static type."}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 2, "last_activity_date": 1509202526, "creation_date": 1509202526, "answer_id": 46991037, "question_id": 46990943, "link": "https://stackoverflow.com/questions/46990943/convert-array-to-interface-to-slice-but-the-result-can-not-use-len-and-othe/46991037#46991037", "title": "Convert array to interface{} to slice, but the result can not use len() and other method", "body": "<p>when you first declare src, in <code>fun1(src interface{})</code> you are making a variable of type interface.  Which, of course cannot have <code>len</code> called on it.</p>\n\n<p>The reason <a href=\"https://golang.org/pkg/reflect/#TypeOf\" rel=\"nofollow noreferrer\">reflect.TypeOf</a> says []int is due to how TypeOf works.\nIt takes an interface{} and tells you the type of the thing in the interface{}</p>\n\n<p>so, in the first example, you already had an interface\nand in the second example, go automatically created an interface{} instance to hold your []int slice.</p>\n"}, {"tags": [], "owner": {"reputation": 157, "user_id": 2853674, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001786755227/picture?type=large", "display_name": "Satyam Zode", "link": "https://stackoverflow.com/users/2853674/satyam-zode"}, "is_accepted": false, "score": 0, "last_activity_date": 1509206012, "creation_date": 1509206012, "answer_id": 46991604, "question_id": 46990943, "link": "https://stackoverflow.com/questions/46990943/convert-array-to-interface-to-slice-but-the-result-can-not-use-len-and-othe/46991604#46991604", "title": "Convert array to interface{} to slice, but the result can not use len() and other method", "body": "<p>Quoting <code>dynamic type</code> from <a href=\"https://golang.org/ref/spec#Variables\" rel=\"nofollow noreferrer\">Variables</a> :</p>\n\n<blockquote>\n  <p>The static type (or just type) of a variable is the type given in its declaration, the type provided in the new call or composite literal, or the type of an element of a structured variable. Variables of interface type also have a distinct dynamic type, which is the concrete type of the value assigned to the variable at run time (unless the value is the predeclared identifier nil, which has no type). The dynamic type may vary during execution but values stored in interface variables are always assignable to the static type of the variable. </p>\n</blockquote>\n\n<p>In the first example, <code>src</code> has a <code>dynamic type</code>. Value of the <code>src</code> will be of type <code>[]int</code> during execution but eventually, type will be <code>interface</code> since it is dynamic type &amp; it was of type <code>interface</code> at the time of declaration. Hence, you need to change variable <code>src</code> to the new variable during <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>.</p>\n\n<p>Similar to what you did in second example: <code>slice_src, _ := src.([]int)</code></p>\n\n<p>You can not even do <code>src, _ := src.([]int)</code> as you will end up with error <code>no new variables on left side of :=</code></p>\n"}, {"tags": [], "owner": {"reputation": 828, "user_id": 6234590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1666b3dd42c197b397efd3058c9b72c0?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/6234590/dylan"}, "is_accepted": false, "score": 0, "last_activity_date": 1509267697, "last_edit_date": 1592644375, "creation_date": 1509266132, "answer_id": 46998275, "question_id": 46990943, "link": "https://stackoverflow.com/questions/46990943/convert-array-to-interface-to-slice-but-the-result-can-not-use-len-and-othe/46998275#46998275", "title": "Convert array to interface{} to slice, but the result can not use len() and other method", "body": "<p>There is a type switch method using <code>reflect.TypeOf()</code> : <a href=\"https://stackoverflow.com/questions/27900568/golang-type-assertion-using-reflect-typeof\">golang type assertion using reflect.Typeof()</a>\nand\n<a href=\"https://stackoverflow.com/questions/7132848/how-to-get-the-reflect-type-of-an-interface\">How to get the reflect.Type of an interface?</a></p>\n<p>Quote <a href=\"https://stackoverflow.com/questions/7132848/how-to-get-the-reflect-type-of-an-interface\">How to get the reflect.Type of an interface?</a> :</p>\n<blockquote>\n<p>You can't. Type assertions allow you to take advantage of the static type checking that the language gives you even if you have an interface, whose type isn't statically checked. It basically works something like this:</p>\n<p>You have some statically typed variable s, which has type t. The compiler enforces the guarantee that s always has type t by refusing to compile if you ever try to use s as if it were a different type, since that would break the guarantee.</p>\n</blockquote>\n"}], "owner": {"reputation": 828, "user_id": 6234590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1666b3dd42c197b397efd3058c9b72c0?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/6234590/dylan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 0, "accepted_answer_id": 46991037, "answer_count": 3, "score": -2, "last_activity_date": 1509267697, "creation_date": 1509201873, "last_edit_date": 1509265825, "question_id": 46990943, "link": "https://stackoverflow.com/questions/46990943/convert-array-to-interface-to-slice-but-the-result-can-not-use-len-and-othe", "title": "Convert array to interface{} to slice, but the result can not use len() and other method", "body": "<p>I tried :</p>\n\n<pre><code>var a [100]int\nfunc fun1(src interface{}) interface{} {\n    src, _ = src.([100]int) // changed []int to [100]int\n    fmt.Println(reflect.TypeOf(src)) // result: []int\n    dest := make([]int, len(src))\n    return dest\n}\n</code></pre>\n\n<p>there is an error: </p>\n\n<pre><code>message: 'invalid argument src (type interface {}) for len'\n</code></pre>\n\n<p>But if I redefine a variable:</p>\n\n<pre><code>var a [100]int\nfunc fun1(src interface{}) interface{} {\n    slice_src, _ := src.([100]int) //changed []int to [100]int\n    fmt.Println(reflect.TypeOf(slice_src)) // result: []int\n    dest := make([]int, len(slice_src))\n    return dest\n}\n</code></pre>\n\n<p>it will be ok.</p>\n\n<p>why <code>reflect.TypeOf(src)</code> will print []int after I used <code>src.([]int)</code> but error shows src is still interface{} ?\nI have checked this <a href=\"https://stackoverflow.com/questions/18041334/convert-interface-to-int-in-golang\">convert interface{} to int</a>, but I still don't understand how to use correct conversion. </p>\n\n<p>There is another question:</p>\n\n<p>I changed the <code>[]int</code> to <code>[100]int</code> since the type assertion before will return <code>[]</code> and <code>false</code>. </p>\n\n<p>But if I don't know the type of <code>a</code>, how can I use type assertion to transfer an array (like<code>[99]int</code>) as a <code>interface{}</code> to function and return slice (<code>[]int</code>)?</p>\n"}, {"tags": ["go", "goji"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1509201183, "post_id": 46990556, "comment_id": 80928161, "body": "Aside: <code>w.Header().Set()</code> after <code>w.WriteHeader()</code> has no effect. Just in case that&#39;s also in your real program."}], "answers": [{"tags": [], "owner": {"reputation": 6165, "user_id": 1901658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/95eee89c6704eb4d075c33821c61af72?s=128&d=identicon&r=PG", "display_name": "Fredrick Brennan", "link": "https://stackoverflow.com/users/1901658/fredrick-brennan"}, "is_accepted": false, "score": 0, "last_activity_date": 1509199673, "creation_date": 1509199673, "answer_id": 46990615, "question_id": 46990556, "link": "https://stackoverflow.com/questions/46990556/goji-httpauth-cannot-use-with-the-standard-golang-net-http-library/46990615#46990615", "title": "goji/httpauth - Cannot use with the standard Golang &#39;net/http&#39; library", "body": "<p>I figured it out after much banging my head against the proverbial wall.</p>\n\n<p>Use <code>http.Handle</code>, not <code>http.HandleFunc</code>! :)</p>\n\n<p>So with the <code>main</code> function as</p>\n\n<pre><code>func main() {\n        r:=http.HandlerFunc(rootHandler)\n        http.Handle(\"/\", httpauth.SimpleBasicAuth(\"dave\", \"somepassword\")(r))\n        log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n\n<p>You have a complete working example of httpauth with net/http!</p>\n\n<p><a href=\"https://stackoverflow.com/questions/44110834/golang-middleware-with-just-the-standard-library?rq=1\">This answer</a> has a really great overview of the inner workings as well.</p>\n"}], "owner": {"reputation": 6165, "user_id": 1901658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/95eee89c6704eb4d075c33821c61af72?s=128&d=identicon&r=PG", "display_name": "Fredrick Brennan", "link": "https://stackoverflow.com/users/1901658/fredrick-brennan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509204566, "creation_date": 1509199338, "last_edit_date": 1509204566, "question_id": 46990556, "link": "https://stackoverflow.com/questions/46990556/goji-httpauth-cannot-use-with-the-standard-golang-net-http-library", "title": "goji/httpauth - Cannot use with the standard Golang &#39;net/http&#39; library", "body": "<p>The code</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"log\"\n        \"net/http\"\n        \"github.com/goji/httpauth\"\n)\n\n\nfunc rootHandler(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Content-Type\", \"text/plain\")\n        w.WriteHeader(http.StatusOK)\n\n        data := \"TEST\"\n\n        w.Header().Set(\"Content-Length\", fmt.Sprint(len(data)))\n        fmt.Fprint(w, string(data))\n}\n\nfunc main() {\n        r:=http.HandlerFunc(rootHandler)\n        http.HandleFunc(\"/\", httpauth.SimpleBasicAuth(\"dave\", \"somepassword\")(r))\n        log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n\n<p>returns</p>\n\n<pre><code>:!go build test.go\n# command-line-arguments\n./test.go:23:71: cannot use httpauth.SimpleBasicAuth(\"dave\", \"somepassword\")(r) (type http.Handler) as type func(http.ResponseWriter, *http.Request) in argument to http.HandleFunc\n</code></pre>\n\n<p>What am I doing wrong? I'm new to Go and don't understand why the example <a href=\"https://github.com/goji/httpauth#nethttp\" rel=\"nofollow noreferrer\">here</a> is incomplete and doesn't include a <code>YourHandler</code> function.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 1, "creation_date": 1509190526, "post_id": 46989247, "comment_id": 80924920, "body": "So you expect that after converting <code>sport</code> property will appear?"}, {"owner": {"reputation": 8678, "user_id": 278659, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a10f8a52a8c247d8e20ee9ab59ee22f2?s=128&d=identicon&r=PG", "display_name": "j3d", "link": "https://stackoverflow.com/users/278659/j3d"}, "reply_to_user": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1509190625, "post_id": 46989247, "comment_id": 80924944, "body": "Yes, I know <code>Parent</code> is also a <code>Child</code> and I want to cast it."}, {"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1509190696, "post_id": 46989247, "comment_id": 80924962, "body": "Make sure you know how to use search <a href=\"https://stackoverflow.com/questions/37416188/convert-struct-to-struct-in-golang\" title=\"convert struct to struct in golang\">stackoverflow.com/questions/37416188/&hellip;</a>"}, {"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1509190764, "post_id": 46989247, "comment_id": 80924981, "body": "Or <a href=\"https://stackoverflow.com/questions/24613271/golang-is-conversion-between-different-struct-types-possible\" title=\"golang is conversion between different struct types possible\">stackoverflow.com/questions/24613271/&hellip;</a>"}, {"owner": {"reputation": 8678, "user_id": 278659, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a10f8a52a8c247d8e20ee9ab59ee22f2?s=128&d=identicon&r=PG", "display_name": "j3d", "link": "https://stackoverflow.com/users/278659/j3d"}, "reply_to_user": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1509191155, "post_id": 46989247, "comment_id": 80925097, "body": "I know how to use search. What you suggest is not what I&#39;m looking for. I need to conver a pointer of type <code>*Parent</code> to a pointer of type <code>*Child</code>."}, {"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1509191462, "post_id": 46989247, "comment_id": 80925193, "body": "You know <b>what</b> is pointer, right?"}, {"owner": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "edited": false, "score": 0, "creation_date": 1509194242, "post_id": 46989247, "comment_id": 80926037, "body": "@j3d Are you sure you want to convert <code>*Parent</code> to <code>*Child</code> and not the other way around? Because from my understanding (I&#39;m not an expert in go), based on the struct definition, there is no way <code>Parent</code> can carry information about <code>sport</code>, how can you think that is supposed to work?"}, {"owner": {"reputation": 8678, "user_id": 278659, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a10f8a52a8c247d8e20ee9ab59ee22f2?s=128&d=identicon&r=PG", "display_name": "j3d", "link": "https://stackoverflow.com/users/278659/j3d"}, "edited": false, "score": 0, "creation_date": 1509195920, "post_id": 46989247, "comment_id": 80926546, "body": "I see... got the point. See my own answer ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 2, "last_activity_date": 1509196451, "last_edit_date": 1509196451, "creation_date": 1509195506, "answer_id": 46989991, "question_id": 46989247, "link": "https://stackoverflow.com/questions/46989247/how-to-convert-parent-type-to-child-type/46989991#46989991", "title": "How to convert parent type to child type", "body": "<pre><code>func (p *Parent) Convert() *Child {\n   return &amp;Child{p, \"\"}\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/saGvRu_rIk\" rel=\"nofollow noreferrer\">https://play.golang.org/p/saGvRu_rIk</a></p>\n\n<p>The problem is there\u2019s no data about <code>sport</code>. So we have to put empty line. </p>\n"}], "owner": {"reputation": 8678, "user_id": 278659, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a10f8a52a8c247d8e20ee9ab59ee22f2?s=128&d=identicon&r=PG", "display_name": "j3d", "link": "https://stackoverflow.com/users/278659/j3d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 846, "favorite_count": 0, "accepted_answer_id": 46989991, "answer_count": 1, "score": -2, "last_activity_date": 1509196451, "creation_date": 1509190408, "last_edit_date": 1509190556, "question_id": 46989247, "link": "https://stackoverflow.com/questions/46989247/how-to-convert-parent-type-to-child-type", "title": "How to convert parent type to child type", "body": "<p>Given the following types:</p>\n\n<pre><code>type (\n    Parent struct {\n        name string\n        surname string\n    }\n\n    Child struct {\n        *Parent\n        sport String\n    }\n)\n\n...\n\nfunc (p *Parent) GetSport() string {\n   return ((*Child)(p)).sport // does not work\n}\n</code></pre>\n\n<p>How do I convert <code>*Parent</code> to <code>*Child</code>?</p>\n"}, {"tags": ["nginx", "go"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1509184698, "post_id": 46988269, "comment_id": 80923469, "body": "Are you want, that the nginx should launch and relaunch <code>go run</code> or what?"}, {"owner": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1509185498, "post_id": 46988269, "comment_id": 80923668, "body": "Yes if it is possible i would like the nginx launch and relaunch the go run command"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1509185538, "post_id": 46988269, "comment_id": 80923678, "body": "nginx is a reverse proxy server it&#39;s not a supervisor or anything like  that, it does one thing and does it well."}, {"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1509185727, "post_id": 46988269, "comment_id": 80923714, "body": "That is not the way things work. Nginx expects you to give it a address and port to forward to. You should look at systemd for doing automatic launching of your go process. Nginx should be concerned about proxying the request and not process management"}, {"owner": {"reputation": 694, "user_id": 2649222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b97bf3c9ef3c1b92be966c36306b4234?s=128&d=identicon&r=PG", "display_name": "ei-grad", "link": "https://stackoverflow.com/users/2649222/ei-grad"}, "edited": false, "score": 0, "creation_date": 1509188243, "post_id": 46988269, "comment_id": 80924324, "body": "It is strange, but here it is - <a href=\"https://www.nginx.com/products/nginx-unit/\" rel=\"nofollow noreferrer\">nginx.com/products/nginx-unit</a>."}], "answers": [{"comments": [{"owner": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "edited": false, "score": 0, "creation_date": 1509198482, "post_id": 46988723, "comment_id": 80927325, "body": "I understand go applicaiton is a standalone web server. What is the propper way to start/stop this application ?"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "edited": false, "score": 1, "creation_date": 1509200729, "post_id": 46988723, "comment_id": 80928008, "body": "Best way is to use run tool built-in into your system. This may be init scripts, systemd and so on. If you prefer Docker you may build an image then <code>docker start your-image</code>. For the start you may build a program with <code>go build</code> put Portman file into you home folder and then run <code>.&#47;program</code>"}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 5, "last_activity_date": 1509223487, "last_edit_date": 1509223487, "creation_date": 1509186642, "answer_id": 46988723, "question_id": 46988269, "link": "https://stackoverflow.com/questions/46988269/serving-golang-scripts-from-nginx/46988723#46988723", "title": "Serving golang scripts from nginx", "body": "<p>In contrast to Php, Go isn\u2019t a script run by a web server like Apache. It has another working model more close to php-fpm. </p>\n\n<p>Go application is a standalone web server. It accepts connections and replies on a giver tcp port.  It\u2019s independent of nginx which can be installed on a separate machine.\nSo it is supposed that app is running with external tools. </p>\n\n<p>What problem do you want to solve with \u201claunching Go app with nginx\u201d?</p>\n\n<p><strong>UPD</strong>\nA Complete example:</p>\n\n<ol>\n<li><p>Install nginx on your server. Particular steps depend on your operation system. For Ubuntu it can be <code>apt-get install nginx</code></p></li>\n<li><p>Edit <code>nginx.conf</code> to add proxy pass to pot 8081:</p>\n\n<pre><code>location / {\n    proxy_pass http://127.0.0.1:8081/;\n}\n</code></pre></li>\n<li><p>Run you program <code>go run ...</code></p></li>\n</ol>\n"}], "owner": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1452, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509223487, "creation_date": 1509183349, "last_edit_date": 1509184711, "question_id": 46988269, "link": "https://stackoverflow.com/questions/46988269/serving-golang-scripts-from-nginx", "title": "Serving golang scripts from nginx", "body": "<p>I want to write a web application with go language.</p>\n\n<p>When in run:</p>\n\n<pre><code>go run myscript.go\n</code></pre>\n\n<p>It works fine, i have worked with go \"net/http\" module\nHere is what i've done in my go script:</p>\n\n<pre><code>http.ListenAndServe(\":8081\", nil)\n</code></pre>\n\n<p>I want now to work with nginx. I have read i should put nginx in proxy mode. That means when nginx receive an http request on 80 http port, it will proxy it do 8081 port.</p>\n\n<p>How can i automatically lanuch and relaunch \"go run\" process ?</p>\n"}, {"tags": ["pointers", "go", "dangling-pointer"], "answers": [{"tags": [], "owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "is_accepted": true, "score": 20, "last_activity_date": 1509178616, "creation_date": 1509178616, "answer_id": 46987653, "question_id": 46987513, "link": "https://stackoverflow.com/questions/46987513/handling-dangling-pointers-in-go/46987653#46987653", "title": "Handling Dangling Pointers in Go", "body": "<p>In Go, dangling pointers are not a thing, due to the way how <a href=\"http://www.agardner.me/golang/garbage/collection/gc/escape/analysis/2015/10/18/go-escape-analysis.html\" rel=\"noreferrer\">escape analysis</a> works. Suppose you have a code like this:</p>\n\n<pre><code>func CreateUser(name string) *User {\n    return &amp;User{Name: name}\n}\n</code></pre>\n\n<p>The compiler will understand that because the pointer can be accessed after the function exits, the structure should be allocated on heap. As <a href=\"https://golang.org/doc/effective_go.html#composite_literals\" rel=\"noreferrer\">Effective Go</a> says:</p>\n\n<blockquote>\n  <p>Note that, unlike in C, it's perfectly OK to return the address of a local variable; the storage associated with the variable survives after the function returns. </p>\n</blockquote>\n"}], "owner": {"reputation": 10637, "user_id": 3102968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1XKm3.png?s=128&g=1", "display_name": "joesan", "link": "https://stackoverflow.com/users/3102968/joesan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1026, "favorite_count": 2, "accepted_answer_id": 46987653, "answer_count": 1, "score": 6, "last_activity_date": 1509206475, "creation_date": 1509177339, "last_edit_date": 1509206475, "question_id": 46987513, "link": "https://stackoverflow.com/questions/46987513/handling-dangling-pointers-in-go", "title": "Handling Dangling Pointers in Go", "body": "<p>I have been reading Rust and Go in parallel and I see subtle differences in how both these languages deal with dangling pointers and the problems it causes. For example, here is a version in Rust:</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>fn main() {\n    let reference_to_nothing = dangle();\n}\n\nfn dangle() -&gt; &amp;String {\n    let s = String::from(\"hello\");\n\n    &amp;s\n}\n</code></pre>\n\n<p>The above would error out saying that in the function <code>dangle</code>, <code>s</code> goes out of scope and I cannot return a reference to it! But in Go, this seems to be sort of allowed?</p>\n\n<p>How is such a thing handled in Go? Is it easy to create dangling pointers in Go? If so what measures do I have to control them?</p>\n"}, {"tags": ["go", "leveldb"], "comments": [{"owner": {"reputation": 3481, "user_id": 579026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5c7809d1535594cbd33bbcf3fed23c7c?s=128&d=identicon&r=PG", "display_name": "ren", "link": "https://stackoverflow.com/users/579026/ren"}, "edited": false, "score": 0, "creation_date": 1509351213, "post_id": 46986813, "comment_id": 80967486, "body": "You can either duplicate keys with minimal value just for iteration or look for something like badger <a href=\"https://blog.dgraph.io/post/badger/\" rel=\"nofollow noreferrer\">blog.dgraph.io/post/badger</a>"}, {"owner": {"reputation": 417, "user_id": 3951831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/776db4b5c6e3a404f3226a8728a8ddbb?s=128&d=identicon&r=PG&f=1", "display_name": "MSH", "link": "https://stackoverflow.com/users/3951831/msh"}, "reply_to_user": {"reputation": 3481, "user_id": 579026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5c7809d1535594cbd33bbcf3fed23c7c?s=128&d=identicon&r=PG", "display_name": "ren", "link": "https://stackoverflow.com/users/579026/ren"}, "edited": false, "score": 0, "creation_date": 1509358342, "post_id": 46986813, "comment_id": 80971626, "body": "@ren Thanks for your reply. The values in my case could get too big, so duplicating keys with minimal values would result in a huge key set and hence slow lookups. I&#39;ve tried Badger and it&#39;s very fast when it comes to key-only iteration, but it has other issues like too much memory consumption and it also doesn&#39;t support snappy compression (which is working wonderful in leveldb for my data)"}], "owner": {"reputation": 417, "user_id": 3951831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/776db4b5c6e3a404f3226a8728a8ddbb?s=128&d=identicon&r=PG&f=1", "display_name": "MSH", "link": "https://stackoverflow.com/users/3951831/msh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1509171242, "creation_date": 1509171242, "question_id": 46986813, "link": "https://stackoverflow.com/questions/46986813/does-levedb-support-key-only-iteration", "title": "Does levedb support key-only iteration?", "body": "<p>I'm using <a href=\"https://github.com/syndtr/goleveldb\" rel=\"nofollow noreferrer\">goleveldb</a> which is an implementation of leveldb in Go and I need to iterate over keys with a prefix. It supports prefix-iteration but when iterating over keys, it seems that the values are also fetched under the hood. This leads to a huge performance drawback when dealing with a big database. From the documentations and code I didn't find a way to iterate over keys without fetching values neither in Go implementation nor in <a href=\"https://github.com/google/leveldb\" rel=\"nofollow noreferrer\">original C++ implementation</a>. If there is a way to do so, I would appreciate someone helping me to get in the right direction.</p>\n"}, {"tags": ["bash", "shell", "go"], "answers": [{"comments": [{"owner": {"reputation": 507, "user_id": 1354026, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/feg0Z.png?s=128&g=1", "display_name": "matthewcummings516", "link": "https://stackoverflow.com/users/1354026/matthewcummings516"}, "edited": false, "score": 0, "creation_date": 1509168817, "post_id": 46986566, "comment_id": 80920089, "body": "Thanks VonC!  Reading your comment, I tried this:      gc=-gcflags     gc_flags=&quot;-N -l&quot;     go build &quot;${gc}&quot; &quot;${gc_flags}&quot;  . . . and it works, which is great.  But I still don&#39;t understand why my command above didn&#39;t work."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 507, "user_id": 1354026, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/feg0Z.png?s=128&g=1", "display_name": "matthewcummings516", "link": "https://stackoverflow.com/users/1354026/matthewcummings516"}, "edited": false, "score": 1, "creation_date": 1509169037, "post_id": 46986566, "comment_id": 80920136, "body": "@matthewcummings516 probably becasue of the way the shell replace the single quotes, as janos explain in his answer."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1509168935, "last_edit_date": 1509168935, "creation_date": 1509168414, "answer_id": 46986566, "question_id": 46986532, "link": "https://stackoverflow.com/questions/46986532/unable-to-run-go-build-with-flags-from-a-shell-script/46986566#46986566", "title": "Unable to run go build with flags from a shell script", "body": "<p>You can see GOGCFLAGS used in a bash scripts <a href=\"https://github.com/golang/go/commit/fb4e185a99f3e93bc1bbe08a09ebfd5419409d48\" rel=\"nofollow noreferrer\">in this commit</a>:</p>\n\n<pre><code>time go test std -short -timeout=$(expr 120 \\* $timeout_scale)s -gcflags \"$GO_GCFLAGS\"\n</code></pre>\n\n<p>Which means you <a href=\"https://github.com/golang/go/issues/8725#issuecomment-66098697\" rel=\"nofollow noreferrer\">only set the values in <code>GO_GCFLAGS</code></a>.</p>\n\n<pre><code>GO_GCFLAGS=\"-N -l\"\n</code></pre>\n\n<p>The OP confirms this is working:</p>\n\n<pre><code>gc=-gcflags gc_flags=\"-N -l\" go build \"${gc}\" \"${gc_flags}\" \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95060, "user_id": 89817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df253c3b6533949ea94f31f328f3e769?s=128&d=identicon&r=PG", "display_name": "Gordon Davisson", "link": "https://stackoverflow.com/users/89817/gordon-davisson"}, "edited": false, "score": 0, "creation_date": 1509176033, "post_id": 46986615, "comment_id": 80921531, "body": "Actually, this isn&#39;t quite correct -- the problem is that the shell parses quotes before it expands variable references, so putting quotes in a variable&#39;s value doesn&#39;t do anything useful -- by the time they&#39;re part of the command, it&#39;s too late for them to function as quotes. This is true whether or not the variable reference is in double-quotes."}, {"owner": {"reputation": 109227, "user_id": 641955, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Hg2nO.jpg?s=128&g=1", "display_name": "janos", "link": "https://stackoverflow.com/users/641955/janos"}, "reply_to_user": {"reputation": 95060, "user_id": 89817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df253c3b6533949ea94f31f328f3e769?s=128&d=identicon&r=PG", "display_name": "Gordon Davisson", "link": "https://stackoverflow.com/users/89817/gordon-davisson"}, "edited": false, "score": 0, "creation_date": 1509280858, "post_id": 46986615, "comment_id": 80947144, "body": "@GordonDavisson although it could have been phrased more generally, I don&#39;t think it was incorrect. Anyway, thanks, I rephrased it a bit, I hope it&#39;s better, let me know if you still see room for improvement. This is a common issue, but I find it tricky to explain in a simple, accessible way."}, {"owner": {"reputation": 95060, "user_id": 89817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df253c3b6533949ea94f31f328f3e769?s=128&d=identicon&r=PG", "display_name": "Gordon Davisson", "link": "https://stackoverflow.com/users/89817/gordon-davisson"}, "edited": false, "score": 0, "creation_date": 1509295591, "post_id": 46986615, "comment_id": 80951907, "body": "Ok, I agree with your rephrase. (And I also agree that this is tricky to explain.)"}], "tags": [], "owner": {"reputation": 109227, "user_id": 641955, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Hg2nO.jpg?s=128&g=1", "display_name": "janos", "link": "https://stackoverflow.com/users/641955/janos"}, "is_accepted": false, "score": 4, "last_activity_date": 1509280498, "last_edit_date": 1509280498, "creation_date": 1509168845, "answer_id": 46986615, "question_id": 46986532, "link": "https://stackoverflow.com/questions/46986532/unable-to-run-go-build-with-flags-from-a-shell-script/46986615#46986615", "title": "Unable to run go build with flags from a shell script", "body": "<p>The problem here is that you have literal single quotes embedded in the value of the variable.\nThe shell will not evaluate these embedded single quotes later when using this value.</p>\n\n<p>When you run this:</p>\n\n<pre><code>go build -gcflags='-N -l'\n</code></pre>\n\n<p>The shell passes to the <code>go</code> command these values as command line arguments:</p>\n\n<ul>\n<li><code>build</code></li>\n<li><code>-gcflags=-N -l</code></li>\n</ul>\n\n<p>When you run this:</p>\n\n<pre><code>gc_flags=\"-gcflags='-N -l'\"\ngo build \"${gc_flags}\"\n</code></pre>\n\n<p>The shell passes to the <code>go</code> command these values as command line arguments:</p>\n\n<ul>\n<li><code>build</code></li>\n<li><code>-gcflags='-N -l'</code></li>\n</ul>\n\n<p>In the first case the single-quotes are not part of the second argument,\nbecause the shell replaces the single-quoted expression <code>'-N -l'</code> with the unquoted value <code>-N -l</code>.</p>\n\n<p>In the second case no such replacement occurs,\nbecause the content of the variable, containing the single-quotes,\nis not reevaluated,\nand so the single-quotes remain as part of the second argument.</p>\n\n<p>One way to fix this is to store in the <code>gc_flags</code> variable only the flags, without the <code>-gcflags=</code></p>\n\n<pre><code>gc_flags='-N -l'\ngo build -gcflags=\"$gc_flags\"\n</code></pre>\n\n<p>This will have the desired effect,\nbecause the value of <code>gc_flags</code> here doesn't contain the single-quotes,\nthey are removed when evaluating the expression <code>gc_flags='-N -l'</code>.</p>\n\n<p>Another way is to use Bash arrays:</p>\n\n<pre><code>gc_flags=(-gcflags='-N -l')\ngo build \"${gc_flags[@]}\"\n</code></pre>\n\n<p>In this form,\nthe array has one value, <code>-gcflags=-N -l</code>,\nthe embedded single-quotes have been removed when evaluating the array assignment.</p>\n"}], "owner": {"reputation": 507, "user_id": 1354026, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/feg0Z.png?s=128&g=1", "display_name": "matthewcummings516", "link": "https://stackoverflow.com/users/1354026/matthewcummings516"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1509280498, "creation_date": 1509168031, "question_id": 46986532, "link": "https://stackoverflow.com/questions/46986532/unable-to-run-go-build-with-flags-from-a-shell-script", "title": "Unable to run go build with flags from a shell script", "body": "<p>I'm running go 1.8.3 and I have this command in a shell script:</p>\n\n<pre><code>go build -gcflags='-N -l'\n</code></pre>\n\n<p>I haven't been able to fix this with quoting, double quoting, escaping quotes, etc in my script. However, if have something like this in my script:</p>\n\n<pre><code>gc_flags=\"-gcflags='-N -l'\"\necho go build \"${gc_flags}\"\ngo build \"${gc_flags}\"\n</code></pre>\n\n<p>But if I literally copy and paste the echo output in my console and run it, it works fine.</p>\n\n<p>This is the error I get from my script:</p>\n\n<pre><code>flag provided but not defined: -N -l\n</code></pre>\n\n<p>Any help is appreciated here. . . I don't recall ever having an issue like this with a build script before.</p>\n"}, {"tags": ["macos", "go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1509160560, "post_id": 46985880, "comment_id": 80918932, "body": "You don&#39;t need to use sudo. Also please add error messages as text, not as screenshot."}, {"owner": {"reputation": 511, "user_id": 7026316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a84a76c06f195399b13ba5029b84bdb5?s=128&d=identicon&r=PG&f=1", "display_name": "Baby.zhou", "link": "https://stackoverflow.com/users/7026316/baby-zhou"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1509160756, "post_id": 46985880, "comment_id": 80918963, "body": "@tkausl sorry,i edited the content."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1509163752, "creation_date": 1509163752, "answer_id": 46986151, "question_id": 46985880, "link": "https://stackoverflow.com/questions/46985880/cant-use-go-command-line-on-mac-os/46986151#46986151", "title": "Can&#39;t use Go command line on mac os", "body": "<p>Try one of the recommendations of <a href=\"https://stackoverflow.com/q/35009531/6309\">this question</a>:</p>\n\n<ul>\n<li>either select the XCode version you want to use (directly in XCode Preferences)</li>\n<li>or try the suggested <code>sudo xcode-select --switch path/to/Xcode.app</code></li>\n<li>or try a <code>sudo xcode-select --reset</code></li>\n</ul>\n\n<p>See also \"<a href=\"https://stackoverflow.com/a/26572947/6309\">git push xcrun: error: active developer path does not exist</a>\" for an alternative approach.</p>\n"}], "owner": {"reputation": 511, "user_id": 7026316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a84a76c06f195399b13ba5029b84bdb5?s=128&d=identicon&r=PG&f=1", "display_name": "Baby.zhou", "link": "https://stackoverflow.com/users/7026316/baby-zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 1, "accepted_answer_id": 46986151, "answer_count": 1, "score": -1, "last_activity_date": 1509163752, "creation_date": 1509160423, "last_edit_date": 1509160733, "question_id": 46985880, "link": "https://stackoverflow.com/questions/46985880/cant-use-go-command-line-on-mac-os", "title": "Can&#39;t use Go command line on mac os", "body": "<p>I want to use command <code>go get</code>,but it throws an exception</p>\n\n<p><a href=\"https://i.stack.imgur.com/GA66A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GA66A.png\" alt=\"enter image description here\"></a></p>\n\n<p>But i had installed the command line tools.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hCLdx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hCLdx.png\" alt=\"enter image description here\"></a></p>\n\n<p>system:macOs sierra 10.12.6 </p>\n\n<p>go:1.9.2</p>\n\n<p><strong>EDIT:</strong>\nError messages:</p>\n\n<pre><code>go get github.com/hashicorp/go-plugin\n# cd .; git clone https://github.com/hashicorp/go-plugin \n/Users/famoss/files/goworkspace/src/github.com/hashicorp/go-plugin xcrun: error: active developer path (\"/Applications/Xcode.app/Contents/Developer\") does not exist\nUse `sudo xcode-select --switch path/to/Xcode.app` to specify the Xcode that you wish to use for command line developer tools, or use `xcode-select --install` to install the standalone command line developer tools.\nSee `man xcode-select` for more details.\npackage github.com/hashicorp/go-plugin: exit status 1\n</code></pre>\n"}, {"tags": ["go", "struct", "embedding"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1509159797, "post_id": 46985721, "comment_id": 80918832, "body": "Why not attach a method with a <code>*s1</code> receiver, i.e. <code>func (s *s1) modify() { s.a, s.b = s.b, s.a; }</code>? An <code>s2</code> or <code>s3</code> variable will forward the address of the embedded <code>s1</code> field and pass that to the method as the receiver; that is, <code>s2foo.modify()</code> is the same as <code>(&amp;s2foo.s1).modify()</code>. <a href=\"https://play.golang.org/p/jFZI6YSMgR\" rel=\"nofollow noreferrer\">Playground link</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1509161412, "post_id": 46985721, "comment_id": 80919066, "body": "The field tags in the example suggest that you are planning to use the encoding/json package with these types.  If so, then you should <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">export</a> the field names.  The json/encoding package ignores unexported fields."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1509160772, "creation_date": 1509160772, "answer_id": 46985913, "question_id": 46985721, "link": "https://stackoverflow.com/questions/46985721/function-which-modifies-any-structure-which-has-particular-fields/46985913#46985913", "title": "Function which modifies any structure which has particular fields", "body": "<p>If you <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">export</a> the fields, then you can use the <a href=\"https://godoc.org/reflect\" rel=\"nofollow noreferrer\">reflect</a> package to swap the values:</p>\n\n<pre><code>type s1 struct {\n    A string `json:\"a\"`\n    B string `json:\"b\"`\n}\n\n...\n\nfunc modifyStruct(s interface{}) {\n    v := reflect.ValueOf(s).Elem() \n    a := v.FieldByName(\"A\")\n    b := v.FieldByName(\"B\")\n    t := reflect.New(a.Type()).Elem()\n    t.Set(a)\n    a.Set(b)\n    b.Set(t)\n}\n</code></pre>\n\n<p>The fields must be exported to use the reflect package because the reflect package cannot set unexported fields.</p>\n\n<p><a href=\"https://play.golang.org/p/oOYoQvcAeG\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1509225306, "last_edit_date": 1509225306, "creation_date": 1509174557, "answer_id": 46987208, "question_id": 46985721, "link": "https://stackoverflow.com/questions/46985721/function-which-modifies-any-structure-which-has-particular-fields/46987208#46987208", "title": "Function which modifies any structure which has particular fields", "body": "<p>The general solution is using reflection as shown in Cerise Lim\u00f3n's answer. The cons of using reflection is that you have to export the fields, and that it's slower than it should or could be.</p>\n\n<p>In your example although it is completely fine and sufficient for the function to take a value of type <code>*s1</code>, as all types that embed <code>s1</code> has a value of <code>s1</code> (explicitly). The unqualified type name (without package name) acts as the field name for embedded fields:</p>\n\n<pre><code>s2 := s2{s1: s1{\"A\", \"B\"}}\nfmt.Println(s2)\nmodifyStruct(&amp;s2.s1)\nfmt.Println(s2)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/k4X5eJlWzx\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{{A B}  }\n{{B A}  }\n</code></pre>\n\n<p>If you still want it to accept values of \"any\" (certain) types (so you don't have to refer to the embedded <code>s1</code> field), but don't want to export the fields, then you may use interfaces for this. Using interfaces you keep the good parts of both solutions (remains fast, flexible and you do not have to export the fields):</p>\n\n<pre><code>type S1 interface {\n    AB() (string, string)\n    SetAB(a, b string)\n}\n\ntype s1 struct {\n    a string `json:\"a\"`\n    b string `json:\"b\"`\n}\n\nfunc (s s1) AB() (string, string) { return s.a, s.b }\nfunc (s *s1) SetAB(a, b string)   { s.a, s.b = a, b }\n\nfunc modifyStruct(s S1) {\n    a, b := s.AB()\n    s.SetAB(b, a)\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>s2 := s2{s1: s1{\"A\", \"B\"}}\nfmt.Println(s2)\nmodifyStruct(&amp;s2)\nfmt.Println(s2)\n</code></pre>\n\n<p>Output is the same (try it on the <a href=\"https://play.golang.org/p/VxjOvYennM\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{{A B}  }\n{{B A}  }\n</code></pre>\n\n<p>Note that (besides the <code>*s1</code> type itself) any struct type (and also any pointer to struct type) that embeds <code>*s1</code> automatically (implicitly) implements the <code>S1</code> interface, and similarly any pointer to struct type that embeds <code>s1</code> also implements <code>S1</code> (and therefore <code>*s2</code> and <code>*s3</code> in your example).</p>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 46987208, "answer_count": 2, "score": -1, "last_activity_date": 1509225306, "creation_date": 1509158451, "last_edit_date": 1509176397, "question_id": 46985721, "link": "https://stackoverflow.com/questions/46985721/function-which-modifies-any-structure-which-has-particular-fields", "title": "Function which modifies any structure which has particular fields", "body": "<p>I have a couple of structures, which inherit some basic structure. Something like this:</p>\n\n<pre><code>type s1 struct {\n    a string `json:\"a\"`\n    b string `json:\"b\"`\n}\n\ntype s2 struct {\n    s1\n    c string `json:\"c\"`\n    d string `json:\"d\"`\n}\n\ntype s3 struct {\n    s1\n    c string `json:\"c\"`\n    d string `json:\"d\"`\n    e string `json:\"d\"`\n    f string `json:\"d\"`\n}\n</code></pre>\n\n<p>Now I need to define a function which operates on any structure which has fields <code>a</code>, <code>b</code>. Something like </p>\n\n<pre><code>func modifyStruct(s *s1) {\n    s.a, s.b = s.b, s.a\n}\n</code></pre>\n\n<p>But has to work on s2, s3 and any other structure which inherits s1. I am trying to achieve this with an interface but so far with no luck. Any way to achieve this? The template is on <a href=\"https://play.golang.org/p/QH_KZbNIru\" rel=\"nofollow noreferrer\">go-playground</a>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1509149609, "post_id": 46985008, "comment_id": 80917301, "body": "Thats because <code>b.IP</code> isn&#39;t nil."}, {"owner": {"reputation": 33, "user_id": 5349200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b044275690e0b5590f6d690ddf35c875?s=128&d=identicon&r=PG&f=1", "display_name": "jap", "link": "https://stackoverflow.com/users/5349200/jap"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1509152492, "post_id": 46985008, "comment_id": 80917853, "body": "so what is the real value of b.IP? printing it out as in the playground showed that its value is nil. Pardon that I am a Go newbie."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1509152708, "post_id": 46985008, "comment_id": 80917886, "body": "The output is misleading. You set it to a pointer to an default-initialized <code>net.IPNet</code> three lines above the check: <code>IP: &amp;net.IPNet{}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 6559048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd934e39469f78fbf51808f698c75917?s=128&d=identicon&r=PG&f=1", "display_name": "ganesh kumar", "link": "https://stackoverflow.com/users/6559048/ganesh-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1509158335, "creation_date": 1509158335, "answer_id": 46985715, "question_id": 46985008, "link": "https://stackoverflow.com/questions/46985008/how-to-check-a-nil-value-of-pointer-to-struct-net-ipnet-in-golang/46985715#46985715", "title": "How to check a nil value of Pointer to struct net.IPNet in Golang", "body": "<p>The check should be like,\n    <code>\n    if b.IP != nil {\n        fmt.Println(\"hello there\")\n    }\n</code>\nAnd the output will have hello-world,</p>\n\n<p>{ID:12345 IP:10.1.232.0/24}\n{ID:12345 IP:}\nhello there</p>\n\n<p>Note:Golang's nil is not same as Cpp's NULL, it is the opposite.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5489733"}, "is_accepted": false, "score": 2, "last_activity_date": 1509194540, "last_edit_date": 1509194540, "creation_date": 1509181542, "answer_id": 46988017, "question_id": 46985008, "link": "https://stackoverflow.com/questions/46985008/how-to-check-a-nil-value-of-pointer-to-struct-net-ipnet-in-golang/46988017#46988017", "title": "How to check a nil value of Pointer to struct net.IPNet in Golang", "body": "<p><code>nil</code> is a <a href=\"https://golang.org/ref/spec#Predeclared_identifiers\" rel=\"nofollow noreferrer\">predeclared identifier</a> in Go. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\ntype Subnet struct {\n    ID int\n    IP *net.IPNet\n}\n\nfunc main() {\n    var b = Subnet{ID: 1, IP: nil}\n    fmt.Println(b.IP == nil)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>true\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/-745-hhLGg\" rel=\"nofollow noreferrer\">https://play.golang.org/p/-745-hhLGg</a></p>\n"}, {"comments": [{"owner": {"reputation": 8130, "user_id": 239657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53c0fe850111d3f1bbd41c24c7c62b3?s=128&d=identicon&r=PG", "display_name": "Beni Cherniavsky-Paskin", "link": "https://stackoverflow.com/users/239657/beni-cherniavsky-paskin"}, "edited": false, "score": 1, "creation_date": 1608543840, "post_id": 46990567, "comment_id": 115606640, "body": "There is open issue <a href=\"https://github.com/golang/go/issues/39516\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/39516</a> about this <code>&lt;nil&gt;</code> output being misleading."}], "tags": [], "owner": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "is_accepted": false, "score": 1, "last_activity_date": 1509199416, "creation_date": 1509199416, "answer_id": 46990567, "question_id": 46985008, "link": "https://stackoverflow.com/questions/46985008/how-to-check-a-nil-value-of-pointer-to-struct-net-ipnet-in-golang/46990567#46990567", "title": "How to check a nil value of Pointer to struct net.IPNet in Golang", "body": "<p>Notice that <code>IPNet</code> has <em><a href=\"https://golang.org/pkg/net/#IPNet.String\" rel=\"nofollow noreferrer\"><code>String() string</code></a> function</em> which makes it implements <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow noreferrer\"><code>Stringer</code> interface</a>. Basically this function provides custom string representation of the struct when the struct is printed. If you dig in further to <a href=\"https://golang.org/src/net/ip.go?s=12087:12118#L484\" rel=\"nofollow noreferrer\">the source code</a> you'll see that this function returns string <code>\"&lt;nil&gt;\"</code> when either <code>IPNet.IP</code> or <code>IPNet.Mask</code> is nil. This explained how your code prints <code>&lt;nil&gt;</code> when the value of <code>Subnet.IP</code> field is actually not <code>nil</code>.</p>\n\n<p>Now to answer the question in the title literally, you already did the check correctly by comparing the value with <code>nil</code>. In addition, you can try to print using <code>%#v</code> instead, for example :</p>\n\n<pre><code>func main() {\n    var b = Subnet{ID: 12345, IP: &amp;net.IPNet{}}\n    fmt.Printf(\"%#v\\n\", b)\n    fmt.Printf(\"is null: %t\\n\", b.IP == nil)\n    var c = Subnet{ID: 12345, IP: nil}\n    fmt.Printf(\"%#v\\n\", c)\n    fmt.Printf(\"is null: %t\", c.IP == nil)\n}\n</code></pre>\n\n<p><strong><kbd><a href=\"https://play.golang.org/p/yxoBRHVH6c\" rel=\"nofollow noreferrer\"><code>playground</code></a></kbd></strong></p>\n\n<p><strong>output :</strong></p>\n\n<pre><code>main.Subnet{ID:12345, IP:(*net.IPNet)(0x10444340)}\nis null: false\nmain.Subnet{ID:12345, IP:(*net.IPNet)(nil)}\nis null: true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 5, "last_activity_date": 1607431979, "last_edit_date": 1607431979, "creation_date": 1509285292, "answer_id": 47000974, "question_id": 46985008, "link": "https://stackoverflow.com/questions/46985008/how-to-check-a-nil-value-of-pointer-to-struct-net-ipnet-in-golang/47000974#47000974", "title": "How to check a nil value of Pointer to struct net.IPNet in Golang", "body": "<p>It looks like you're confusing <em>the value</em> <code>nil</code> with a concept called &quot;zero value&quot;.</p>\n<h3>The zero value</h3>\n<p>Any type in Go \u2014 no matter whether standard or created by the user \u2014\nhas a &quot;zero value&quot; which is the value assigned automatically to any variable of that type which was not explicitly initialized otherwise.\nIOW, when you have</p>\n<pre><code>type T \u2026\n\nvar v T\n</code></pre>\n<p>the value of the variable &quot;v&quot; will be the zero value of type <code>T</code>.</p>\n<p>The concept of the zero value follows naturally from the Go's property\nof not allowing uninitialized variables: variables in Go always have\nsensible values (contraty to say, C).</p>\n<h3>The <code>nil</code> value</h3>\n<p>A special value, <code>nil</code>, which is a predeclared identifier in Go,\nis the zero value for a set of <em>types which have reference semantics.</em></p>\n<p>The term &quot;reference semantics&quot; might be intimidating but it can be\nexplained pretty simply: a type has reference semantics when variables of\nit <em>reference</em> some data structure instead of directly containing it.\nHence when you copy the value of a variable of such type into another\nvariable, both variables reference the same data structure.</p>\n<p>As you should know, maps, slices, interfaces, function values, and pointers have reference semantics in Go, and that's why their zero values are <code>nil</code>.</p>\n<h3>The distinction</h3>\n<p>The major takeaway to draw from the above is that <code>nil</code> is the zero value\nfor some types which have a certain property, but not for all of them.</p>\n<p>For example, for</p>\n<pre><code>type T struct {\n  A int\n  B string\n}\n</code></pre>\n<p>the zero value is</p>\n<pre><code>T{\n  A: 0,\n  B: &quot;&quot;,\n}\n</code></pre>\n<p>that is, a value of type <code>T</code> having its fields initialized\nto the zero values corresponding to the types of those fields:\n0 for <code>int</code> and &quot;&quot; for <code>string</code>.</p>\n<h3>Your particular problem</h3>\n<p>In your type</p>\n<pre><code>type Subnet struct {\n    ID int\n    IP *net.IPNet\n}\n</code></pre>\n<p>the field &quot;IP&quot; has a pointer type <code>*net.IPNet</code>, which is a pointer\nto (or, we may say, an address of) a value of the type <code>net.IPNet</code>.\nHence its zero value is <code>nil</code>.</p>\n<p>Now if you were to declare something like</p>\n<pre><code>var subnet Subnet\n</code></pre>\n<p>this variable would start its life initialized to the zero value\nof its type, and that would mean that its field &quot;IP&quot;\nwould have the zero value for its type, <code>nil</code>.</p>\n<p>In your example, you do:</p>\n<pre><code>var b = Subnet{\n    ID: 12345,\n    IP: &amp;net.IPNet{},\n}\n</code></pre>\n<p>and that means creating a variable &quot;b&quot; initialized to a particular\nvalue defined by the <em>literal</em> placed on the right hand of the\nassignment operator <code>=</code>.</p>\n<p>The field &quot;IP&quot; in that literal is <em>not</em> initialized to the zero value\nof its type; instead, it's initialized to a pointer containing the\naddress of an <em>anonymous variable</em> wihch has the type <code>net.IPNet</code>\nand containing the zero value of that type.</p>\n<p>To say this in different words, the result it roughly equivalent\nto the following:</p>\n<pre><code>var ip net.IPNet\n\nvar b = Subnet{\n    ID: 12345,\n    IP: &amp;ip,\n}\n</code></pre>\n<p>There, the variable &quot;ip&quot; contains the zero value of its type,\nand the variable &quot;b.IP&quot; contains a pointer to the variable &quot;ip&quot;.</p>\n<p>Since that field &quot;IP&quot; points to <em>some real memory location,</em>\nits value is obviosly not <code>nil</code>, which makes a value of a type having\nrefence semantics &quot;point to nowhere&quot;,\nand that's why the test in your <code>if</code> statement fails.</p>\n"}], "owner": {"reputation": 33, "user_id": 5349200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b044275690e0b5590f6d690ddf35c875?s=128&d=identicon&r=PG&f=1", "display_name": "jap", "link": "https://stackoverflow.com/users/5349200/jap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1991, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1607431979, "creation_date": 1509149430, "question_id": 46985008, "link": "https://stackoverflow.com/questions/46985008/how-to-check-a-nil-value-of-pointer-to-struct-net-ipnet-in-golang", "title": "How to check a nil value of Pointer to struct net.IPNet in Golang", "body": "<p>How can I check the nil value as a result of the assignment of variable b below?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\n\ntype Subnet struct {\n    ID                int\n    IP                *net.IPNet\n}\n\nfunc main() {\n    var s = Subnet{\n        ID: 12345,\n        IP: &amp;net.IPNet{\n            IP:   net.IP{10, 1, 232, 0},\n            Mask: net.IPMask{255, 255, 255, 0},\n        },\n    }\n    fmt.Printf(\"%+v\\n\", s)\n    var b = Subnet{\n        ID: 12345,\n        IP: &amp;net.IPNet{},\n    }\n    fmt.Printf(\"%+v\\n\", b)\n    if b.IP == nil {\n        fmt.Println(\"hello there\")\n    }\n}\n</code></pre>\n\n<p>Here is the go playground <a href=\"https://play.golang.org/p/Jk6_3ofyH5\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Jk6_3ofyH5</a></p>\n\n<p>Basically, I expect that \"hello there\" will be printed out as b.IP is nil, but it did not.</p>\n"}, {"tags": ["go", "file-locking"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1509154594, "last_edit_date": 1509154594, "creation_date": 1509151862, "answer_id": 46985235, "question_id": 46984411, "link": "https://stackoverflow.com/questions/46984411/fcntl-in-go-doesnt-work/46985235#46985235", "title": "Fcntl in go doesn&#39;t work", "body": "<p>If I create the file with <code>touch lockfiletest.lock</code>, that is with no file contents, your program fails with your error: <code>error locking file2: bad file descriptor</code>. </p>\n\n<pre><code>$ rm -f lockfiletest.lock\n$ touch lockfiletest.lock\n$ go run lockfiletest.go\n2017/10/27 21:17:27 error locking file2: bad file descriptor\n</code></pre>\n\n<p>I changed the file open to closely match <code>TestFcntlFlock</code>.</p>\n\n<pre><code>$ uname -s\nLinux\n~/go/src/syscall$ $ go test -v -run=TestFcntlFlock syscall_unix_test.go\n=== RUN   TestFcntlFlock\n--- PASS: TestFcntlFlock (0.01s)\nPASS\nok      syscall 0.008s\n~/go/src/syscall$ \n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"log\"\n    \"os\"\n    \"syscall\"\n    \"time\"\n)\n\nfunc main() {\n    time.Sleep(time.Second)\n\n    name := \"lockfiletest.lock\"\n    file, err := os.OpenFile(name, syscall.O_CREAT|syscall.O_RDWR|syscall.O_CLOEXEC, 0666)\n    if err != nil {\n        log.Printf(\"error opening file: %s\", err)\n        return\n    }\n    defer file.Close()\n\n    flockT := syscall.Flock_t{\n        Type:   syscall.F_WRLCK,\n        Whence: io.SeekStart,\n        Start:  0,\n        Len:    0,\n    }\n    err = syscall.FcntlFlock(file.Fd(), syscall.F_SETLK, &amp;flockT)\n    if err != nil {\n        log.Printf(\"error locking file: %s\", err)\n        return\n    }\n\n    log.Println(\"lock2 accessed\")\n\n    time.Sleep(time.Second * 5)\n\n    log.Println(\"func2 finished\")\n\n    time.Sleep(time.Second * 15)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ rm -f lockfiletest.lock\n$ touch lockfiletest.lock\n$ go run lockfiletest.go\n2017/10/27 21:21:56 lock2 accessed\n2017/10/27 21:22:01 func2 finished\n$ rm -f lockfiletest.lock\n$ go run lockfiletest.go\n2017/10/27 21:22:25 lock2 accessed\n2017/10/27 21:22:30 func2 finished\n$ go run lockfiletest.go\n2017/10/27 21:25:40 lock2 accessed\n2017/10/27 21:25:45 func2 finished\n$ \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9739032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee3b142b8733a6164a0de556faa77b5?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/9739032/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1525408450, "creation_date": 1525408450, "answer_id": 50167223, "question_id": 46984411, "link": "https://stackoverflow.com/questions/46984411/fcntl-in-go-doesnt-work/50167223#50167223", "title": "Fcntl in go doesn&#39;t work", "body": "<p>You have to open your file WRONLY or RDWR, you're opening it read only to put a lock on it which doesn't work - you're getting a read only file descriptor.</p>\n"}], "owner": {"reputation": 49, "user_id": 8527938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d97d7f4e32e761f2452b87ab3c6bb2?s=128&d=identicon&r=PG&f=1", "display_name": "knoxfighter", "link": "https://stackoverflow.com/users/8527938/knoxfighter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1594, "favorite_count": 1, "accepted_answer_id": 46985235, "answer_count": 2, "score": 2, "last_activity_date": 1525408450, "creation_date": 1509144497, "question_id": 46984411, "link": "https://stackoverflow.com/questions/46984411/fcntl-in-go-doesnt-work", "title": "Fcntl in go doesn&#39;t work", "body": "<p>I'm currently writing a http server, that has to run over all files inside a folder. One Request can write a file, where another Request can read the files at the same time, so i need to lock the file, that is open for writing. In the Routine, that will read the file, i just want to skip the file that is locked.\nTo make this, i want to use locklibrarys like that from <a href=\"https://github.com/rubyist/lockfile\" rel=\"nofollow noreferrer\">rubyist</a> or <a href=\"https://github.com/nightlyone/lockfile\" rel=\"nofollow noreferrer\">nightlyone</a>.</p>\n\n<p>The problem is, i didnt get them to work, so i started to call the syscall.FcntlFlock() function myself and it didn't work like i had expected.<br>\nThis program doesn't work in the Go Playground, cause the playground seems to run not on a unix-based system (syscall.FcntlFlock is undefined)</p>\n\n<p>The code that didn't work:</p>\n\n<pre><code>func main() {\n    time.Sleep(time.Second)\n\n    file, err := os.Open(\"lockfiletest.lock\")\n    if err != nil {\n        log.Printf(\"error opening file2: %s\", err)\n        return\n    }\n    defer file.Close()\n\n    flockT := syscall.Flock_t{\n        Type: syscall.F_WRLCK,\n        Whence: io.SeekStart,\n        Start: 0,\n        Len: 0,\n    }\n    err = syscall.FcntlFlock(file.Fd(), syscall.F_SETLK, &amp;flockT)\n    if err != nil {\n        log.Printf(\"error locking file2: %s\", err)\n        return\n    }\n\n    log.Println(\"lock2 accessed\")\n\n    time.Sleep(time.Second * 5)\n\n    log.Println(\"func2 finished\")\n\n    time.Sleep(time.Second * 15)\n}\n</code></pre>\n\n<p>the console output:</p>\n\n<pre><code>2017/10/28 00:18:12 error locking file2: bad file descriptor\nProcess finished with exit code 0\n</code></pre>\n\n<p>What am i doing wrong? Are the syscalls broken?<br>\nI also tried it in C and there it works fine.<br>\nI test this program in Go1.8.3 and Go1.9.1 on ubuntu16.04</p>\n\n<p>PS: This program also have to run on windows, so only implementing a FcntlLock isn't enough.</p>\n\n<p><hr>\nI also thoght about using sync.RWMutex, so it is locked via a Mutex instead of a fileLock. That is not exactly what i want, cause i only want to skip the file that is locked and not wait until the mutex can be locked.</p>\n"}, {"tags": ["go", "struct", "printing", "slice"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1509140394, "post_id": 46983693, "comment_id": 80914962, "body": "Show what you have tried."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 2, "creation_date": 1509142815, "post_id": 46983693, "comment_id": 80915685, "body": "You do <code>listOfPeople := make([]person, 10)</code>, then later <code>listOfPeople = append(listOfPeople, person{a, b, c})</code>. If you&#39;re using <code>append</code>, you should use the 3-arg form of <code>make</code> to set the capacity of the slice to 10 and the length to 0, else you&#39;ll have 10 people if you enter 0, 11 people if you enter 1, etc. That might be your problem, or one of them at least."}, {"owner": {"reputation": 19, "user_id": 8359165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b552e5a2bcdc0fd7db3cc7a284c33a1c?s=128&d=identicon&r=PG&f=1", "display_name": "NetSec", "link": "https://stackoverflow.com/users/8359165/netsec"}, "edited": false, "score": 0, "creation_date": 1509216036, "post_id": 46983693, "comment_id": 80932792, "body": "This combined with @mkopriva&#39;s answer allowed me to fix the problem. I changed listOfPeople := make([]person, 10) to listOfPeople := make([]person, 0, 0)"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8359165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b552e5a2bcdc0fd7db3cc7a284c33a1c?s=128&d=identicon&r=PG&f=1", "display_name": "NetSec", "link": "https://stackoverflow.com/users/8359165/netsec"}, "edited": false, "score": 0, "creation_date": 1509214564, "post_id": 46984165, "comment_id": 80932305, "body": "Hey, Thanks that illustrated where I went wrong, and helped me fix my issue. I appreciate it!"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1509142893, "creation_date": 1509142893, "answer_id": 46984165, "question_id": 46983693, "link": "https://stackoverflow.com/questions/46983693/print-the-contents-of-a-slice-of-struct/46984165#46984165", "title": "Print the contents of a slice of struct", "body": "<p>You're appending to a slice of already allocated 10 people, so you may think that the first person you appended is on the 0th index but it's actually be on the 10th.</p>\n\n<p><a href=\"https://play.golang.org/p/bPXsdWk9sa\" rel=\"nofollow noreferrer\">https://play.golang.org/p/bPXsdWk9sa</a></p>\n\n<p>What you probably want is something like this</p>\n\n<p><a href=\"https://play.golang.org/p/kcfzJ4M0Wp\" rel=\"nofollow noreferrer\">https://play.golang.org/p/kcfzJ4M0Wp</a></p>\n"}], "owner": {"reputation": 19, "user_id": 8359165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b552e5a2bcdc0fd7db3cc7a284c33a1c?s=128&d=identicon&r=PG&f=1", "display_name": "NetSec", "link": "https://stackoverflow.com/users/8359165/netsec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1839, "favorite_count": 0, "accepted_answer_id": 46984165, "answer_count": 1, "score": 0, "last_activity_date": 1509142893, "creation_date": 1509139904, "question_id": 46983693, "link": "https://stackoverflow.com/questions/46983693/print-the-contents-of-a-slice-of-struct", "title": "Print the contents of a slice of struct", "body": "<p>Apologies if this is wrong to begin with. I am attempting to learn Golang, and am working through various concepts. I am pretty sure I am confusing something here... I am trying to write a simple program that creates a struct called 'person' which accepts firstname, lastname, and age. I want a user to be able to specify the number of people they will be entering into a slice of struct person, then iterate through the number of people entered, taking the input and storing it in the slice of person. Then, I want to be able to print one of those 'person' to terminal, for instance the 6th one (assuming that many were entered). Here is what I have so far:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var people int\n\n    type person struct {\n        firstName string\n        lastName  string\n        age       int\n    }\n\n    listOfPeople := make([]person, 10)\n\n    fmt.Println(\"Please enter the number of users you would like to   create:\")\n    fmt.Scan(&amp;people)\n\n    for i := 0; i &lt; people; i++ {\n        var a, b string\n        var c int\n        fmt.Println(\"Please enter a person's information: \")\n        fmt.Print(\"First Name: \")\n        fmt.Scan(&amp;a)\n        fmt.Print(\"Last Name: \")\n        fmt.Scan(&amp;b)\n        fmt.Print(\"Age: \")\n        fmt.Scan(&amp;c)\n        listOfPeople = append(listOfPeople, person{a, b, c})\n    }\n    //Print the contents of listOfPeople\n}\n</code></pre>\n\n<p>Where the code comment \"print the contents of listOfPeople is where I would like to be able to print a 'person'. I have tried a couple of things but nothing prints or compilation fails. Without attempting to print out a person from listOfPeople the code compiles and runs. I know I am missing something here. Any help is appreciated. I realize this code is likely not optimized or there may be a simpler way of doing it, so if there is please feel free to correct me. \nThank you</p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 1, "creation_date": 1509124674, "post_id": 46980367, "comment_id": 80908086, "body": "It keeps going. The runtime tracks them all independently."}, {"owner": {"reputation": 19, "user_id": 1719937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc04fc7621858338a3d00ede8f49b9b9?s=128&d=identicon&r=PG", "display_name": "Parisa", "link": "https://stackoverflow.com/users/1719937/parisa"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1509124740, "post_id": 46980367, "comment_id": 80908124, "body": "thanks for your response"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1509127827, "post_id": 46980367, "comment_id": 80909634, "body": "I think he might have meant &quot;returning <i>from</i> a goroutine that call(ed) another goroutine&quot;."}, {"owner": {"reputation": 19, "user_id": 1719937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc04fc7621858338a3d00ede8f49b9b9?s=128&d=identicon&r=PG", "display_name": "Parisa", "link": "https://stackoverflow.com/users/1719937/parisa"}, "edited": false, "score": 2, "creation_date": 1509130681, "post_id": 46980367, "comment_id": 80910890, "body": "thats cruel...why -4? It might be others question as well. why?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 1719937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc04fc7621858338a3d00ede8f49b9b9?s=128&d=identicon&r=PG", "display_name": "Parisa", "link": "https://stackoverflow.com/users/1719937/parisa"}, "edited": false, "score": 0, "creation_date": 1509130624, "post_id": 46981012, "comment_id": 80910866, "body": "the link is dead"}, {"owner": {"reputation": 19, "user_id": 1719937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc04fc7621858338a3d00ede8f49b9b9?s=128&d=identicon&r=PG", "display_name": "Parisa", "link": "https://stackoverflow.com/users/1719937/parisa"}, "edited": false, "score": 0, "creation_date": 1509130897, "post_id": 46981012, "comment_id": 80910989, "body": "my problem maybe"}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 0, "last_activity_date": 1509127381, "creation_date": 1509127381, "answer_id": 46981012, "question_id": 46980367, "link": "https://stackoverflow.com/questions/46980367/returning-from-a-goroutine-which-calls-another-goroutine/46981012#46981012", "title": "Returning from a goroutine which calls another goroutine", "body": "<p>You can make an experiment on excellent <a href=\"https://play.golang.org\" rel=\"nofollow noreferrer\">https://play.golang.org</a> playground!\nI recommend experiment there - it helps very much with golang studying.</p>\n\n<p><a href=\"https://play.golang.org/p/OJ9sgakV-S\" rel=\"nofollow noreferrer\">https://play.golang.org/p/OJ9sgakV-S</a></p>\n\n<p>I've added 2 second delay, because if program exit too quickly, you 'll not see results from goroutines.</p>\n"}], "owner": {"reputation": 19, "user_id": 1719937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc04fc7621858338a3d00ede8f49b9b9?s=128&d=identicon&r=PG", "display_name": "Parisa", "link": "https://stackoverflow.com/users/1719937/parisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 46981012, "answer_count": 1, "score": -4, "last_activity_date": 1509130148, "creation_date": 1509124637, "last_edit_date": 1509130148, "question_id": 46980367, "link": "https://stackoverflow.com/questions/46980367/returning-from-a-goroutine-which-calls-another-goroutine", "title": "Returning from a goroutine which calls another goroutine", "body": "<p>I wonder what happens to goroutines called from another goroutine when it returns. Do they continue running or get terminated?\nHere is a sample code to show what I mean:</p>\n\n<pre><code>func func() {\n    // Doing something\n}\n\nfunc func2() {\n        go func()\n        // Doing things that end with a return\n    }\n\nfunc main() {\n    go func2()\n}\n</code></pre>\n\n<p>what happens to func() goroutine when func2() goroutine returns?</p>\n"}, {"tags": ["json", "api", "go"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1509121133, "post_id": 46979031, "comment_id": 80906281, "body": "Just modify your json struct tags.  <a href=\"https://goplay.space/#PQxts3yhLi\" rel=\"nofollow noreferrer\">goplay.space/#PQxts3yhLi</a>"}, {"owner": {"reputation": 2597, "user_id": 2948793, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/YkdhN.png?s=128&g=1", "display_name": "ConorB", "link": "https://stackoverflow.com/users/2948793/conorb"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1509121426, "post_id": 46979031, "comment_id": 80906419, "body": "@reticentroot I think the issue is that he needs  to preserve his current JSON struct tags for unmarshalling the JSON coming from the datasource and then needs to marshall the same data with new JSON tags in which case he&#39;d need to do some custom marshalling."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 1, "creation_date": 1509121478, "post_id": 46979031, "comment_id": 80906455, "body": "Then create two structs. One for unmarshaling snake_case and cast to the one that marshaling CamelCase"}, {"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1602396503, "post_id": 46979031, "comment_id": 113703407, "body": "Great question +1. The preferred Go term is MixedCaps or mixedCaps not CamelCase. See <a href=\"https://golang.org/doc/effective_go.html#mixed-caps\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#mixed-caps</a>."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1617299159, "post_id": 46979031, "comment_id": 118272529, "body": "@badjan could you please share with us information about how you solved this problem?"}], "answers": [{"comments": [{"owner": {"reputation": 690, "user_id": 10009545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01bced6ffc06afc71a25d9d2913cd71c?s=128&d=identicon&r=PG&f=1", "display_name": "konstantin", "link": "https://stackoverflow.com/users/10009545/konstantin"}, "edited": false, "score": 0, "creation_date": 1618832482, "post_id": 46979561, "comment_id": 118713655, "body": "here&#39;s a little fiddle for both snake&lt;-&gt;camel cases: <a href=\"https://play.golang.org/p/zaDwHlCcF8S\" rel=\"nofollow noreferrer\">play.golang.org/p/zaDwHlCcF8S</a>"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 16, "last_activity_date": 1617217991, "last_edit_date": 1617217991, "creation_date": 1509121435, "answer_id": 46979561, "question_id": 46979031, "link": "https://stackoverflow.com/questions/46979031/converting-all-snake-case-keys-in-a-json-to-camelcase-keys/46979561#46979561", "title": "Converting all snake_case keys in a json to camelCase keys", "body": "<p>Since Go 1.8 you can define two structs that only differ in their tags and trivially convert between the two:</p>\n<pre><code>package main\n\nimport (\n    &quot;encoding/json&quot;\n    &quot;fmt&quot;\n)\n\ntype ESModel struct {\n    AB string `json:&quot;a_b&quot;`\n}\n\ntype APIModel struct {\n    AB string `json:&quot;aB&quot;`\n}\n\nfunc main() {\n    b := []byte(`{\n            &quot;a_b&quot;: &quot;c&quot;\n    }`)\n\n    var x ESModel\n    json.Unmarshal(b, &amp;x)\n\n    b, _ = json.MarshalIndent(APIModel(x), &quot;&quot;, &quot;  &quot;)\n    fmt.Println(string(b))\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/dcBkkX9zQR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/dcBkkX9zQR</a></p>\n<p>To do this in general, attempt to unmarshal the JSON document into a map. If it succeeds, fix all the keys and recursively call your function for each value in the map. The example below shows how to convert all keys to upper case. Replace <code>fixKey</code> with the snake_case conversion function.</p>\n<pre><code>package main\n\nimport (\n    &quot;bytes&quot;\n    &quot;encoding/json&quot;\n    &quot;fmt&quot;\n    &quot;strings&quot;\n)\n\nfunc main() {\n    // Document source as returned by Elasticsearch\n    b := json.RawMessage(`{\n            &quot;a_b&quot;: &quot;c&quot;,\n            &quot;d_e&quot;: [&quot;d&quot;],\n            &quot;e_f&quot;: {\n                    &quot;g_h&quot;: {\n                            &quot;i_j&quot;: &quot;k&quot;,\n                            &quot;l_m&quot;: {}\n                    }\n            }\n    }`)\n\n    x := convertKeys(b)\n\n    buf := &amp;bytes.Buffer{}\n    json.Indent(buf, []byte(x), &quot;&quot;, &quot;  &quot;)\n    fmt.Println(buf.String())\n}\n\nfunc convertKeys(j json.RawMessage) json.RawMessage {\n    m := make(map[string]json.RawMessage)\n    if err := json.Unmarshal([]byte(j), &amp;m); err != nil {\n            // Not a JSON object\n            return j\n    }\n\n    for k, v := range m {\n            fixed := fixKey(k)\n            delete(m, k)\n            m[fixed] = convertKeys(v)\n    }\n\n    b, err := json.Marshal(m)\n    if err != nil {\n            return j\n    }\n\n    return json.RawMessage(b)\n}\n\nfunc fixKey(key string) string {\n    return strings.ToUpper(key)\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/QQZPMGKrlg\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QQZPMGKrlg</a></p>\n"}], "owner": {"reputation": 65, "user_id": 2205362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b09b662ba8c0049f3d1507a80a7db00e?s=128&d=identicon&r=PG&f=1", "display_name": "badjan", "link": "https://stackoverflow.com/users/2205362/badjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6404, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1617218406, "creation_date": 1509119603, "last_edit_date": 1617218406, "question_id": 46979031, "link": "https://stackoverflow.com/questions/46979031/converting-all-snake-case-keys-in-a-json-to-camelcase-keys", "title": "Converting all snake_case keys in a json to camelCase keys", "body": "<p>In Go, how can we convert snake_case keys in a JSON to camelCase ones recursively?</p>\n<p>I am writing one http api in Go. This api fetches data from datastore, does some computation and return the response as JSON.</p>\n<p>Situation is that the JSON document in the datastore (elasticsearch) is present with snake_case keys while the API response should be camelCase based (this is just to align with other api standard within project). The source which inserts into ES can't be modified. So its only at the api level keys conversion has to take place.</p>\n<p>I have written a struct which is reading JSON from datastore nicely. But how can I convert the keys to camlelCase in Go?</p>\n<p>The JSON is can be nested and all keys has to be converted.\nThe JSON is arbitrarily large. i.e. some keys are just mapped to type interface{}</p>\n<p>I am also using go's echo framework for writing the api.</p>\n<p>Ex.</p>\n<pre><code>{\n&quot;is_modified&quot; : true,\n   { attribute&quot;: \n     {\n      &quot;legacy_id&quot; : 12345 \n     }\n   }\n}\n</code></pre>\n<p>TO</p>\n<pre><code>{\n&quot;isModified&quot; : true,\n   { attribute&quot;: \n     {\n      &quot;legacyId&quot; : 12345 \n     }\n   }\n}\n</code></pre>\n<p>Any pointers on how to do this in Go?</p>\n<p>Struct:</p>\n<pre><code>type data_in_es struct {\nIsModified bool `json:&quot;is_modified,omitempty&quot;`\nAttribute *attribute `json:&quot;attribute,omitempty&quot;`\n}\n\ntype attribute struct {\n    LegacyId int `json:&quot;legacy_id,omitempty&quot;`\n}\n</code></pre>\n"}, {"tags": ["ssl", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1509109597, "post_id": 46975736, "comment_id": 80898988, "body": "What do you mean that &quot;only one can be used and updated.&quot;? The <code>GetCertificate</code> function is meant to load any key you want dynamically."}, {"owner": {"reputation": 1, "user_id": 8819369, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hfG9ZA-bL_I/AAAAAAAAAAI/AAAAAAAAABs/qZLw-WQ1eKw/photo.jpg?sz=128", "display_name": "Halulu", "link": "https://stackoverflow.com/users/8819369/halulu"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1509114564, "post_id": 46975736, "comment_id": 80902308, "body": "How can I load multiple certificates by using GetCertificate?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1509120253, "post_id": 46975736, "comment_id": 80905875, "body": "The second link would definitely do it. You just need to write the logic to select the correct certificate to be returned from <code>GetCertificateFunc</code>."}, {"owner": {"reputation": 1, "user_id": 8819369, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hfG9ZA-bL_I/AAAAAAAAAAI/AAAAAAAAABs/qZLw-WQ1eKw/photo.jpg?sz=128", "display_name": "Halulu", "link": "https://stackoverflow.com/users/8819369/halulu"}, "edited": false, "score": 0, "creation_date": 1509161119, "post_id": 46975736, "comment_id": 80919022, "body": "You are right, thank you."}], "owner": {"reputation": 1, "user_id": 8819369, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hfG9ZA-bL_I/AAAAAAAAAAI/AAAAAAAAABs/qZLw-WQ1eKw/photo.jpg?sz=128", "display_name": "Halulu", "link": "https://stackoverflow.com/users/8819369/halulu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509109414, "creation_date": 1509109414, "question_id": 46975736, "link": "https://stackoverflow.com/questions/46975736/how-can-i-add-new-certificates-without-restart-application", "title": "How can I add new certificates without restart application?", "body": "<p>I want to use http.ListenAndServeTLS with multiple certificates and add new certificates without restart application. </p>\n\n<p>I found an example of using multiple certificates, but I can not add new certificates after startup.(<a href=\"https://stackoverflow.com/questions/32175300/http-listenandservetls-with-multiple-certificates\">http.ListenAndServeTLS with multiple certificates</a>) </p>\n\n<p>I have also found an example of updating a certificate, and only one can be used and updated. But i can not add more.(<a href=\"https://stackoverflow.com/questions/37473201/is-there-a-way-to-update-the-tls-certificates-in-a-net-http-server-without-any-d\">Is there a way to update the TLS certificates in a net/http server without any downtime?</a>)</p>\n"}, {"tags": ["java", "go", "signals", "ipc"], "comments": [{"owner": {"reputation": 33440, "user_id": 1831987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=128&d=identicon&r=PG", "display_name": "VGR", "link": "https://stackoverflow.com/users/1831987/vgr"}, "edited": false, "score": 1, "creation_date": 1509109040, "post_id": 46975090, "comment_id": 80898591, "body": "You may want to search <a href=\"https://docs.oracle.com/javase/9/tools/java.htm\" rel=\"nofollow noreferrer\">the documentation</a> for the word \u201csignal\u201d.  It says <code>-Xusealtsigs</code> doesn\u2019t do anything, but it mentions two other options, <code>-XX:+AllowUserSignalHandlers</code> and <code>-Xrs</code>."}, {"owner": {"reputation": 124, "user_id": 4526019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a19dd1b11cce91c558986865447428a?s=128&d=identicon&r=PG&f=1", "display_name": "dwrecked", "link": "https://stackoverflow.com/users/4526019/dwrecked"}, "reply_to_user": {"reputation": 33440, "user_id": 1831987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=128&d=identicon&r=PG", "display_name": "VGR", "link": "https://stackoverflow.com/users/1831987/vgr"}, "edited": false, "score": 0, "creation_date": 1509131066, "post_id": 46975090, "comment_id": 80911060, "body": "@VGR thanks for the help.  Using -XX:+AllowUserSignalHandler threw the  this error :  <code>fatal error: unexpected signal during runtime execution  [signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x7f9dd5b8e2b4]</code>  and using the <b>-Xrs</b> option didn&#39;t have any other effect."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1509556578, "post_id": 46975090, "comment_id": 81068041, "body": "What OS? According to <a href=\"http://www.oracle.com/technetwork/java/javase/signals-139944.html\" rel=\"nofollow noreferrer\">oracle.com/technetwork/java/javase/signals-139944.html</a>, on Linux the answer is no."}, {"owner": {"reputation": 124, "user_id": 4526019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a19dd1b11cce91c558986865447428a?s=128&d=identicon&r=PG&f=1", "display_name": "dwrecked", "link": "https://stackoverflow.com/users/4526019/dwrecked"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1509647357, "post_id": 46975090, "comment_id": 81113771, "body": "@MarkPlotnick thanks! I was running on macOS and rhel 7."}], "owner": {"reputation": 124, "user_id": 4526019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a19dd1b11cce91c558986865447428a?s=128&d=identicon&r=PG&f=1", "display_name": "dwrecked", "link": "https://stackoverflow.com/users/4526019/dwrecked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509110239, "creation_date": 1509107496, "last_edit_date": 1509110239, "question_id": 46975090, "link": "https://stackoverflow.com/questions/46975090/can-jvm-be-configured-to-not-use-usrsig1", "title": "Can JVM be configured to not use USRSIG1?", "body": "<p>I have an application  (Go) that creates a JVM in a child process. The application has its own use of the SIGUSR1 signal which conflicts with the JVM it seems and crashes.</p>\n\n<p>Here's the only relevant log I've seen from the application:</p>\n\n<p><code>Warning: SIGUSR1 handler expected:0x0000000000000000  found:&lt;application-name&gt;</code></p>\n\n<p>I've tried using '-Xusealtsigs' option when spinning up the JVM but that doesn't seem have any effect on USRSIG1 or USRSIG2. </p>\n\n<p>Is there any way to have to JVM not use USRSIG1? </p>\n\n<p>*Note I won't be able to change the signal processing in the main application. </p>\n"}, {"tags": ["performance", "go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1509108005, "post_id": 46974890, "comment_id": 80897898, "body": "Have you profiled your application to see where the time is spent? This is easier if you start with a real benchmark using the testing package."}, {"owner": {"reputation": 2597, "user_id": 2948793, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/YkdhN.png?s=128&g=1", "display_name": "ConorB", "link": "https://stackoverflow.com/users/2948793/conorb"}, "edited": false, "score": 1, "creation_date": 1509108752, "post_id": 46974890, "comment_id": 80898380, "body": "As JimB mentioned, pprof is a good tool for debugging these kinds of problems. I would also recommend <b>trace</b> which captures execution events like goroutine creation/blocking/unblocking. The youtube channel justforfunc recently did a tutorial video on improving a go program&#39;s   performance using said tool."}, {"owner": {"reputation": 4223, "user_id": 710955, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GvorM.png?s=128&g=1", "display_name": "LeMoussel", "link": "https://stackoverflow.com/users/710955/lemoussel"}, "edited": false, "score": 0, "creation_date": 1509109249, "post_id": 46974890, "comment_id": 80898737, "body": "Is this justforfunc video # 22: <a href=\"https://www.youtube.com/watch?v=ySy3sR1LFCQ\" rel=\"nofollow noreferrer\">using the Go Execution Tracer</a>?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1509113092, "post_id": 46974890, "comment_id": 80901332, "body": "As JimB suggests, use the <code>golang</code> built-in <a href=\"https://golang.org/pkg/testing/#hdr-Benchmarks\" rel=\"nofollow noreferrer\">test/benchmark</a> framework, rather than build your own. It even covers parallel benchmarks."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1509116825, "post_id": 46974890, "comment_id": 80903825, "body": "Not everything is improved by concurrency. It&#39;s not a universal magic bullet that Make Thing Go Fast. Your goroutines are running very tight loops with a mutex lock in the middle; I don&#39;t know how much performance boost you can really expect from making that concurrent."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1509124441, "post_id": 46974890, "comment_id": 80907983, "body": "also this talk will help you <a href=\"https://blog.golang.org/concurrency-is-not-parallelism\" rel=\"nofollow noreferrer\">blog.golang.org/concurrency-is-not-parallelism</a>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1509125701, "post_id": 46974890, "comment_id": 80908615, "body": "Cross Posted: golang-nuts:  <a href=\"https://groups.google.com/d/msg/golang-nuts/_deI0OytNY8/fl5wcwiUAgAJ\" rel=\"nofollow noreferrer\">Golang goroutine slow down when adding concurrency</a>."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1509119377, "last_edit_date": 1509119377, "creation_date": 1509116106, "answer_id": 46977933, "question_id": 46974890, "link": "https://stackoverflow.com/questions/46974890/golang-goroutine-slow-down-when-adding-concurrency/46977933#46977933", "title": "Golang goroutine slow down when adding concurrency", "body": "<p>Allocate <code>possibles</code> for the <code>default</code> case:</p>\n\n<pre><code>default:\n    //possibles = nil\n    possibles = make([]string, 0, len(tryArr))\n</code></pre>\n\n<p>For example, <code>possibles = nil</code>,</p>\n\n<pre><code>2017/10/27 10:59:35 GOMAXPROCS: 4\n2017/10/27 10:59:35 Starting 4 threads\n2017/10/27 10:59:45 Id routine: 3  rate: 20.576132\n2017/10/27 10:59:45 Id routine: 2  rate: 21.276596\n2017/10/27 10:59:45 Id routine: 0  rate: 19.960080\n2017/10/27 10:59:45 Id routine: 1  rate: 21.276596\n2017/10/27 10:59:45 Current total rate was 83.09 K/s\n2017/10/27 10:59:45 Starting 4 threads\n2017/10/27 10:59:55 Id routine: 2  rate: 20.533881\n2017/10/27 10:59:55 Id routine: 0  rate: 20.576132\n2017/10/27 10:59:55 Id routine: 1  rate: 19.801980\n2017/10/27 10:59:55 Id routine: 3  rate: 20.746888\n2017/10/27 10:59:55 Current total rate was 81.66 K/s\n57.08user 2.16system 0:20.02elapsed 295%CPU\n</code></pre>\n\n<p>And, <code>possibles = make([]string, 0, len(tryArr))</code>,</p>\n\n<pre><code>2017/10/27 10:57:33 GOMAXPROCS: 4\n2017/10/27 10:57:33 Starting 4 threads\n2017/10/27 10:57:43 Id routine: 0  rate: 112.359551\n2017/10/27 10:57:43 Id routine: 1  rate: 104.166667\n2017/10/27 10:57:43 Id routine: 2  rate: 91.743119\n2017/10/27 10:57:43 Id routine: 3  rate: 112.359551\n2017/10/27 10:57:43 Current total rate was 420.63 K/s\n2017/10/27 10:57:43 Starting 4 threads\n2017/10/27 10:57:53 Id routine: 0  rate: 123.456790\n2017/10/27 10:57:53 Id routine: 1  rate: 126.582278\n2017/10/27 10:57:53 Id routine: 2  rate: 113.636364\n2017/10/27 10:57:53 Id routine: 3  rate: 119.047619\n2017/10/27 10:57:53 Current total rate was 482.72 K/s\n58.11user 2.32system 0:20.01elapsed 302%CPU\n</code></pre>\n\n<hr>\n\n<p>What are your results?</p>\n\n<hr>\n\n<p>With increasing \"<code>threads</code>\" [1,2,3,4] and <code>possibles = make([]string, 0, len(tryArr))</code>,</p>\n\n<pre><code>$ cat /proc/cpuinfo | grep 'cpu cores' | uniq\ncpu cores   : 4\n</code></pre>\n\n<p>.</p>\n\n<pre><code>2017/10/27 11:19:03 GOMAXPROCS: 4\n2017/10/27 11:19:03 Starting 1 threads\n2017/10/27 11:19:13 Id routine: 0  rate: 285.714286\n2017/10/27 11:19:13 Current total rate was 285.71 K/s\n2017/10/27 11:19:13 Starting 1 threads\n2017/10/27 11:19:23 Id routine: 0  rate: 312.500000\n2017/10/27 11:19:23 Current total rate was 312.50 K/s\n24.66user 1.13system 0:20.01elapsed 128%CPU\n</code></pre>\n\n<p>.</p>\n\n<pre><code>2017/10/27 11:19:28 GOMAXPROCS: 4\n2017/10/27 11:19:28 Starting 2 threads\n2017/10/27 11:19:38 Id routine: 0  rate: 238.095238\n2017/10/27 11:19:38 Id routine: 1  rate: 217.391304\n2017/10/27 11:19:38 Current total rate was 455.49 K/s\n2017/10/27 11:19:38 Starting 2 threads\n2017/10/27 11:19:48 Id routine: 1  rate: 192.307692\n2017/10/27 11:19:48 Id routine: 0  rate: 217.391304\n2017/10/27 11:19:48 Current total rate was 409.70 K/s\n46.14user 2.07system 0:20.00elapsed 240%CPU\n</code></pre>\n\n<p>.</p>\n\n<pre><code>2017/10/27 11:19:53 GOMAXPROCS: 4\n2017/10/27 11:19:53 Starting 3 threads\n2017/10/27 11:20:03 Id routine: 2  rate: 142.857143\n2017/10/27 11:20:03 Id routine: 1  rate: 149.253731\n2017/10/27 11:20:03 Id routine: 0  rate: 147.058824\n2017/10/27 11:20:03 Current total rate was 439.17 K/s\n2017/10/27 11:20:03 Starting 3 threads\n2017/10/27 11:20:13 Id routine: 2  rate: 153.846154\n2017/10/27 11:20:13 Id routine: 1  rate: 156.250000\n2017/10/27 11:20:13 Id routine: 0  rate: 153.846154\n2017/10/27 11:20:13 Current total rate was 463.94 K/s\n52.41user 2.21system 0:20.01elapsed 273%CPU\n</code></pre>\n\n<p>.</p>\n\n<pre><code>2017/10/27 11:20:25 GOMAXPROCS: 4\n2017/10/27 11:20:25 Starting 4 threads\n2017/10/27 11:20:35 Id routine: 1  rate: 106.382979\n2017/10/27 11:20:35 Id routine: 2  rate: 102.040816\n2017/10/27 11:20:35 Id routine: 0  rate: 125.000000\n2017/10/27 11:20:35 Id routine: 3  rate: 117.647059\n2017/10/27 11:20:35 Current total rate was 451.07 K/s\n2017/10/27 11:20:35 Starting 4 threads\n2017/10/27 11:20:45 Id routine: 1  rate: 111.111111\n2017/10/27 11:20:45 Id routine: 2  rate: 112.359551\n2017/10/27 11:20:45 Id routine: 0  rate: 119.047619\n2017/10/27 11:20:45 Id routine: 3  rate: 128.205128\n2017/10/27 11:20:45 Current total rate was 470.72 K/s\n58.80user 2.20system 0:20.01elapsed 304%CPU\n</code></pre>\n\n<hr>\n\n<p>In summary, you appear to be benchmarking the Go garbage collector. Garbage collection is not free. Minimize your allocations. Use the Go <a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\"><code>testing</code> package</a> benchmark facilities.</p>\n"}], "owner": {"reputation": 4223, "user_id": 710955, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GvorM.png?s=128&g=1", "display_name": "LeMoussel", "link": "https://stackoverflow.com/users/710955/lemoussel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 831, "favorite_count": 1, "accepted_answer_id": 46977933, "answer_count": 1, "score": -2, "last_activity_date": 1509119377, "creation_date": 1509106821, "question_id": 46974890, "link": "https://stackoverflow.com/questions/46974890/golang-goroutine-slow-down-when-adding-concurrency", "title": "Golang goroutine slow down when adding concurrency", "body": "<p>I am studying about golang and use of goroutine.<br>\nWith this sample code, on my PC with 4 logical CPUs,  I can't understand why I don't have any performance improvement.</p>\n\n<p>If I add in concurrency, the time it takes to do tends to slow down by the original without concurrency. </p>\n\n<pre><code>2017/10/27 13:57:17 Starting 1 threads\n2017/10/27 13:57:27 Id routine: 0  rate: 232.558140\n2017/10/27 13:57:27 Current total rate was 232.56 K/s\n2017/10/27 13:57:27 Starting 1 threads\n2017/10/27 13:57:37 Id routine: 0  rate: 357.142857\n2017/10/27 13:57:37 Current total rate was 357.14 K/s\n\n\n2017/10/27 13:58:04 Starting 2 threads\n2017/10/27 13:58:14 Id routine: 0  rate: 131.578947\n2017/10/27 13:58:14 Id routine: 1  rate: 129.870130\n2017/10/27 13:58:14 Current total rate was 261.45 K/s\n2017/10/27 13:58:14 Starting 2 threads\n2017/10/27 13:58:24 Id routine: 1  rate: 144.927536\n2017/10/27 13:58:24 Id routine: 0  rate: 151.515152\n2017/10/27 13:58:24 Current total rate was 296.44 K/s\n\n2017/10/27 13:59:15 Starting 3 threads\n2017/10/27 13:59:25 Id routine: 2  rate: 94.339623\n2017/10/27 13:59:25 Id routine: 0  rate: 92.592593\n2017/10/27 13:59:25 Id routine: 1  rate: 90.090090\n2017/10/27 13:59:25 Current total rate was 277.02 K/s\n2017/10/27 13:59:25 Starting 3 threads\n2017/10/27 13:59:35 Id routine: 2  rate: 92.592593\n2017/10/27 13:59:35 Id routine: 0  rate: 90.090090\n2017/10/27 13:59:35 Id routine: 1  rate: 101.010101\n2017/10/27 13:59:35 Current total rate was 283.69 K/s\n\n2017/10/27 14:00:12 Starting 4 threads\n2017/10/27 14:00:22 Id routine: 1  rate: 56.818182\n2017/10/27 14:00:22 Id routine: 3  rate: 56.818182\n2017/10/27 14:00:22 Id routine: 0  rate: 61.349693\n2017/10/27 14:00:22 Id routine: 2  rate: 62.500000\n2017/10/27 14:00:22 Current total rate was 237.49 K/s\n2017/10/27 14:00:22 Starting 4 threads\n2017/10/27 14:00:32 Id routine: 1  rate: 67.114094\n2017/10/27 14:00:32 Id routine: 3  rate: 61.349693\n2017/10/27 14:00:32 Id routine: 0  rate: 57.803468\n2017/10/27 14:00:32 Id routine: 2  rate: 65.789474\n2017/10/27 14:00:32 Current total rate was 252.06 K/s\n</code></pre>\n\n<p>And, here is the concurrent code with the goroutines:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"sync\"\n    \"time\"\n)\n\nvar (\n    tryArr           []string\n    goroutineQuit    = make(chan struct{})\n    concurrencyMapHQ = struct {\n        sync.RWMutex\n        HQ map[int]float64\n    }{HQ: make(map[int]float64)}\n)\n\nfunc rateStats() {\n    var totalRate float64\n    for i, rate := range concurrencyMapHQ.HQ {\n        log.Printf(\"Id routine: %d  rate: %f\", i, rate)\n        totalRate += rate\n    }\n\n    log.Printf(\"Current total rate was %.2f K/s\", totalRate)\n}\n\nfunc stopThreads(threads int) {\n    for i := 0; i &lt; threads; i++ {\n        goroutineQuit &lt;- struct{}{}\n    }\n\n    rateStats()\n}\n\nfunc runThreads(threads int, steps int) {\n    log.Printf(\"Starting %d threads\", threads)\n\n    for i := 0; i &lt; threads; i++ {\n        i := i\n        go func(id int, steps int) {\n            calculate(i, steps)\n        }(i, steps)\n    }\n}\n\nfunc calculate(idRoutine int, steps int) {\n    var (\n        possibles []string\n        numBatchs = 0\n        t1        = time.Now()\n    )\n\n    for {\n        select {\n        case &lt;-goroutineQuit:\n            return\n        default:\n            possibles = nil\n\n            for _, nonce := range tryArr {\n                possibles = append(possibles, nonce)\n            }\n\n            numBatchs++\n            if numBatchs == 99 {\n                t2 := time.Now()\n\n                timeExecution := t2.Sub(t1) / time.Millisecond\n\n                concurrencyMapHQ.Lock()\n                concurrencyMapHQ.HQ[idRoutine] = float64(steps) / float64(timeExecution)\n                concurrencyMapHQ.Unlock()\n\n                numBatchs = 0\n                t1 = t2\n\n            }\n        }\n    }\n}\n\nfunc main() {\n    threads := 4\n    steps := 10000\n\n    tryArr = make([]string, steps)\n    for i := 0; i &lt; steps; i++ {\n        tryArr[i] = fmt.Sprintf(\"indice: %d\", i)\n    }\n\n    for {\n        runThreads(threads, steps)\n        time.Sleep(10 * time.Second)\n        stopThreads(threads)\n\n        runThreads(threads, steps)\n        time.Sleep(10 * time.Second)\n        stopThreads(threads)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "edited": false, "score": 4, "creation_date": 1509105514, "post_id": 46974446, "comment_id": 80896367, "body": "Please be consistent. Your code shows <code>ActorState</code> type, but your error message shows <code>ActorRole</code>."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1509105555, "post_id": 46974446, "comment_id": 80896390, "body": "That&#39;s not valid Go code. Did you loose something on copy paste."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1509105565, "post_id": 46974446, "comment_id": 80896396, "body": "<code>a := ActorState(i)</code>"}, {"owner": {"reputation": 3592, "user_id": 6276385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c7b071a5c25c2f6ccc6f1f41bdb2e3?s=128&d=identicon&r=PG&f=1", "display_name": "gonutz", "link": "https://stackoverflow.com/users/6276385/gonutz"}, "edited": false, "score": 0, "creation_date": 1509105624, "post_id": 46974446, "comment_id": 80896432, "body": "Please just post the real code, this cannot compile for the two reasons mentioned before"}, {"owner": {"reputation": 605, "user_id": 412832, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YpjzD.jpg?s=128&g=1", "display_name": "Geert Van Laethem", "link": "https://stackoverflow.com/users/412832/geert-van-laethem"}, "edited": false, "score": 0, "creation_date": 1509107371, "post_id": 46974446, "comment_id": 80897511, "body": "Sorry copied parts of the code and wrote the a : ActorState = ActorState(i) myself."}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1509117182, "post_id": 46974503, "comment_id": 80904059, "body": "Worth noting, you can elide the var type in the second one.  <code>var a = ActorState(i)</code> is perfectly legal. <a href=\"https://play.golang.org/p/PI0ZXYf940\" rel=\"nofollow noreferrer\">play.golang.org/p/PI0ZXYf940</a>"}], "tags": [], "owner": {"reputation": 3592, "user_id": 6276385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c7b071a5c25c2f6ccc6f1f41bdb2e3?s=128&d=identicon&r=PG&f=1", "display_name": "gonutz", "link": "https://stackoverflow.com/users/6276385/gonutz"}, "is_accepted": true, "score": 16, "last_activity_date": 1509122170, "last_edit_date": 1509122170, "creation_date": 1509105564, "answer_id": 46974503, "question_id": 46974446, "link": "https://stackoverflow.com/questions/46974446/convert-an-integer-to-an-enum-value/46974503#46974503", "title": "Convert an integer to an enum value", "body": "<p>Your syntax is wrong, you mean</p>\n\n<pre><code>i := 1\na := ActorState(i)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>i := 1\nvar a = ActorState(i)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>i := 1\nvar a ActorState\na = ActorState(i)\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 412832, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YpjzD.jpg?s=128&g=1", "display_name": "Geert Van Laethem", "link": "https://stackoverflow.com/users/412832/geert-van-laethem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9167, "favorite_count": 0, "accepted_answer_id": 46974503, "answer_count": 1, "score": 6, "last_activity_date": 1509122170, "creation_date": 1509105372, "last_edit_date": 1509107206, "question_id": 46974446, "link": "https://stackoverflow.com/questions/46974446/convert-an-integer-to-an-enum-value", "title": "Convert an integer to an enum value", "body": "<p>I have the following code:</p>\n\n<pre><code>type ActorState int\n\nconst (\n    Unverified ActorState = 1 + iota\n    Verified\n    Banned\n)\n</code></pre>\n\n<p>And I want to do this in my implementation.</p>\n\n<pre><code>i := 1\na : ActorState \na = ActorState(i)\n</code></pre>\n\n<p>But I get the error, <code>Cannot convert expression of type int, error to type ActorState</code>. </p>\n\n<p>How do I convert it then?</p>\n"}, {"tags": ["multithreading", "go", "taskaffinity"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 5903248, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/100004098873007/picture?type=large", "display_name": "Pavan Kishore", "link": "https://stackoverflow.com/users/5903248/pavan-kishore"}, "edited": false, "score": 0, "creation_date": 1509626311, "post_id": 46974166, "comment_id": 81099288, "body": "Thanks for the reply @Peter. But I do not understand how four processes are started. I am executing the binary only once."}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1509104346, "creation_date": 1509104346, "answer_id": 46974166, "question_id": 46974078, "link": "https://stackoverflow.com/questions/46974078/runtime-gomaxprocs-not-working-as-expected/46974166#46974166", "title": "runtime.GOMAXPROCS not working as expected", "body": "<p>You are running four processes. The kernel schedules those onto cores. GOMAXPROCS has nothing to do with this; it only affects the number of threads for a single process, and only user-level code.</p>\n"}], "owner": {"reputation": 85, "user_id": 5903248, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/100004098873007/picture?type=large", "display_name": "Pavan Kishore", "link": "https://stackoverflow.com/users/5903248/pavan-kishore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1509104346, "creation_date": 1509104034, "question_id": 46974078, "link": "https://stackoverflow.com/questions/46974078/runtime-gomaxprocs-not-working-as-expected", "title": "runtime.GOMAXPROCS not working as expected", "body": "<p>I have a simple go program - </p>\n\n<p>main.go -</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"runtime\"\n    \"time\"\n)\n\nfunc main() {\n    runtime.GOMAXPROCS(1)\n    log.Println(\"running\")\n    time.Sleep(10 * time.Minute)\n}\n</code></pre>\n\n<p>I build binary like this -</p>\n\n<pre><code>GOOS=linux go build\n</code></pre>\n\n<p>and run it in a centos machine -</p>\n\n<pre><code># ./test\n2017/10/27 14:20:15 running\n</code></pre>\n\n<p>I wonder why 2 different cores (1 &amp; 6) are used for this simple program even if <code>GOMAXPROCS</code> is set to 1.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NnSko.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NnSko.png\" alt=\"process using 2 cpu cores\"></a></p>\n\n<p>Sometimes 3-4 cores are also used.</p>\n\n<p>Any idea about this?</p>\n\n<p>Thank you.</p>\n"}]