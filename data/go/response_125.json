[{"tags": ["http", "ssl", "go"], "answers": [{"comments": [{"owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "edited": false, "score": 0, "creation_date": 1496274728, "post_id": 44296206, "comment_id": 75598870, "body": "is not performing common name validation normal? Or is my use case an edge case"}, {"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "reply_to_user": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "edited": false, "score": 4, "creation_date": 1496275138, "post_id": 44296206, "comment_id": 75598976, "body": "IMO it doesn&#39;t really make sense to validate a cert but not the common name.  At that point I can pass you any domains valid certificate and you&#39;ll check and and say &quot;Yup, looks ok&quot;, so you don&#39;t get any actual security."}, {"owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "edited": false, "score": 4, "creation_date": 1496691216, "post_id": 44296206, "comment_id": 75753649, "body": "where is the <code>cert</code> coming from in <code>_, err := cert.Verify(opts)</code>"}, {"owner": {"reputation": 1870, "user_id": 326722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/man2G.jpg?s=128&g=1", "display_name": "danmux", "link": "https://stackoverflow.com/users/326722/danmux"}, "edited": false, "score": 4, "creation_date": 1513020782, "post_id": 44296206, "comment_id": 82481370, "body": "@dave <a href=\"https://github.com/golang/go/issues/21971\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/21971</a> implies the rawCerts ,apart from the first one, should be added as intermediate certs as tls.Config has a roots Pool already and I don&#39;t think the root certs would be in the rawCerts slice. (also <code>cert</code> would not be defined where you attempt to <code>Verify</code> it.) Then only the first rawCert is <code>Verify</code>-ed. As for a use case - consider a cluster of services you have deployed: the client can be configured with the same CA cert that signed the server cert so we can be sure to trust the server without needing n*SAN&#39;s"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 2, "last_activity_date": 1496273372, "creation_date": 1496273372, "answer_id": 44296206, "question_id": 44295820, "link": "https://stackoverflow.com/questions/44295820/disable-common-name-validation-go-http-client/44296206#44296206", "title": "Disable Common Name Validation - Go HTTP Client", "body": "<p>You would pass a <code>tls.Config</code> struct with your own <code>VerifyPeerCertificate</code> function, and then you would check the certificate yourself.</p>\n\n<p><code>VerifyPeerCertificate func(rawCerts [][]byte, verifiedChains [][]*x509.Certificate) error</code></p>\n\n<blockquote>\n  <p>If normal verification fails then the handshake will abort before\n  considering this callback. If normal verification is disabled by\n  setting InsecureSkipVerify then this callback will be considered but\n  the verifiedChains argument will always be nil.</p>\n</blockquote>\n\n<p>You can look <a href=\"https://golang.org/pkg/crypto/x509/#example_Certificate_Verify\" rel=\"nofollow noreferrer\">here</a> for an example of how to verify a certificate.  Iif you look <a href=\"https://golang.org/pkg/crypto/x509/#VerifyOptions\" rel=\"nofollow noreferrer\">here</a>, you'll see that part of even this verification process includes checking the hostname, but luckily you'll see that it <a href=\"https://golang.org/src/crypto/x509/verify.go?s=8414:8499#L298\" rel=\"nofollow noreferrer\">skips it</a> if it's set to the empty string.</p>\n\n<p>So, basically you write your own <code>VerifyPeerCertificate</code> function, convert the <code>rawCerts [][]byte</code>, which I think would look something like:</p>\n\n<pre><code>customVerify := func(rawCerts [][]byte, verifiedChains [][]*x509.Certificate) error {\n    roots := x509.NewCertPool()\n    for _, rawCert := range rawCerts {\n        cert, _ := x509.ParseCertificate(rawCert)\n        roots.AddCert(cert)\n    }\n    opts := x509.VerifyOptions{\n        Roots:   roots,\n    }\n    _, err := cert.Verify(opts)\n    return err\n}\n\nconf := tls.Config{\n    //...\n    VerifyPeerCertificate: customVerify,\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9307813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af36fe89b1763b422ff1bb860bf60d1?s=128&d=identicon&r=PG&f=1", "display_name": "HMZ", "link": "https://stackoverflow.com/users/9307813/hmz"}, "is_accepted": false, "score": 1, "last_activity_date": 1517628809, "creation_date": 1517628809, "answer_id": 48593672, "question_id": 44295820, "link": "https://stackoverflow.com/questions/44295820/disable-common-name-validation-go-http-client/48593672#48593672", "title": "Disable Common Name Validation - Go HTTP Client", "body": "<p>Normal https post like this</p>\n\n<pre><code>pool := x509.NewCertPool()\ncaStr, err := ioutil.ReadFile(serverCAFile)\nif err != nil {\n    return nil, fmt.Errorf(\"read server ca file fail\")\n}\npool.AppendCertsFromPEM(caStr)\ntr := &amp;http.Transport{\n    TLSClientConfig: &amp;tls.Config{\n        RootCAs:    pool,\n    },\n}\n\nclient := &amp;http.Client{Transport: tr}\nclient.Post(url, bodyType, body)\n</code></pre>\n\n<p>But if your url is use ip(ex. <a href=\"https://127.0.0.1:8080/api/test\" rel=\"nofollow noreferrer\">https://127.0.0.1:8080/api/test</a>) or you URL is not match certificate common name, and you want to only ignore certificate common name check, should do like this</p>\n\n<pre><code>pool := x509.NewCertPool()\ncaStr, err := ioutil.ReadFile(serverCAFile)\nif err != nil {\n    return nil, fmt.Errorf(\"read server ca file fail\")\n}\nblock, _ := pem.Decode(caStr)\nif block == nil {\n    return nil, fmt.Errorf(\"Decode ca file fail\")\n}\nif block.Type != \"CERTIFICATE\" || len(block.Headers) != 0 {\n    return nil, fmt.Errorf(\"Decode ca block file fail\")\n}\n\ncert, err := x509.ParseCertificate(block.Bytes)\nif err != nil {\n    return nil, fmt.Errorf(\"ParseCertificate ca block file fail\")\n}\n\npool.AddCert(cert)\n\ntr := &amp;http.Transport{\n    TLSClientConfig: &amp;tls.Config{\n        RootCAs:    pool,\n        ServerName: cert.Subject.CommonName,  //manual set ServerName\n    },\n}\n\nclient := &amp;http.Client{Transport: tr}\nclient.Post(url, bodyType, body)\n</code></pre>\n"}], "owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3110, "favorite_count": 1, "accepted_answer_id": 44296206, "answer_count": 2, "score": 0, "last_activity_date": 1517628809, "creation_date": 1496270739, "last_edit_date": 1496271210, "question_id": 44295820, "link": "https://stackoverflow.com/questions/44295820/disable-common-name-validation-go-http-client", "title": "Disable Common Name Validation - Go HTTP Client", "body": "<p>How do I disable common name validation inside of a go http client. I am doing mutual TLS with a common CA and hence common name validation means nothing.</p>\n\n<p>The tls <a href=\"https://golang.org/pkg/crypto/tls/#Config\" rel=\"nofollow noreferrer\">docs</a> say,</p>\n\n<pre><code>// ServerName is used to verify the hostname on the returned\n// certificates unless InsecureSkipVerify is given. It is also included\n// in the client's handshake to support virtual hosting unless it is\n// an IP address.\nServerName string\n</code></pre>\n\n<p>I don't want to do <code>InsecureSkipVerify</code> but I don't want to validate the common name. </p>\n"}, {"tags": ["go", "concurrency", "channel", "coroutine", "goroutine"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 2, "creation_date": 1496267561, "post_id": 44294959, "comment_id": 75596767, "body": "If you must simply share a single resource then using a mutex is the preferred way. Message passing doesn&#39;t really make sense to me in this context."}], "answers": [{"comments": [{"owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "edited": false, "score": 0, "creation_date": 1496326839, "post_id": 44309922, "comment_id": 75625507, "body": "Well,this is a design which I generally speaking like (i.e. each thread having its separate version of the data and receiving updates whenever it changes).  What I&#39;m considering doing is having it go both ways whereby the holder of the state can receive messages when the config changes happen and then send a message to everyone which uses the state."}, {"owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "edited": false, "score": 0, "creation_date": 1496326923, "post_id": 44309922, "comment_id": 75625584, "body": "Is there a good code example online with this type of pattern ?(basically what you described but the consumers can also write to a channel to change the configuration... or whatever shared state you happen to have)... It seems nice on the surface but I&#39;m completely unaware of the obvious (and less obvious) pitfalls it might have"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "edited": false, "score": 0, "creation_date": 1496327620, "post_id": 44309922, "comment_id": 75626163, "body": "I don&#39;t have any examples on hand, Google might help you. It&#39;s important to think of it not as sharing state, but as sending messages or events. Channels are a pub/sub model, not a sharing model, and thinking of them as a way to implement sharing will lead to frustration. Imagine if all your goroutines were separate processes on different machines; if you&#39;d use a database to share state, use a mutex. If you&#39;d use a message queue to pub/sub events, use channels."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1496326353, "creation_date": 1496326353, "answer_id": 44309922, "question_id": 44294959, "link": "https://stackoverflow.com/questions/44294959/is-there-a-way-to-model-shared-state-using-messages/44309922#44309922", "title": "Is there a way to model shared state using messages?", "body": "<p>You don't \"model shared state using messages\", you use messages <em>instead of</em> shared state, which requires designing the application based on different fundamentals. It is generally not a matter of rewriting a mutex as a channel, but a completely different implementation approach, and that approach won't be applicable to all scenarios where you need to synchronize operations. If a shared map is the best approach for your situation, then a mutex is the correct way to synchronize access to it.</p>\n\n<p>As an example from my own experience, I've developed applications that allow for changing their configuration at runtime. Rather than having a shared Config object and synchronizing access to it, I give each main goroutine a channel on which it can receive configuration updates. When the config changes, the update is sent to all the listeners. When a listener gets a config change, it can complete its current operation, then deal with the config change in whatever way is appropriate to that routine - it may just update its local copy of the config, it may close connections to external resources and open new ones, etc. Instead of sharing data, I'm sending and receiving events, which is a fundamentally different design.</p>\n"}], "owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 44309922, "answer_count": 1, "score": 2, "last_activity_date": 1496326353, "creation_date": 1496266089, "question_id": 44294959, "link": "https://stackoverflow.com/questions/44294959/is-there-a-way-to-model-shared-state-using-messages", "title": "Is there a way to model shared state using messages?", "body": "<p>So currently I've come upon a very real problem in writing \"correct\" golang. I have an object (for the sake of simplicity lets think of it as a map[string]string) and I want it to hold a \"shared\" state between multiple gortuines.</p>\n\n<p>Currently the implementation goes something like this:</p>\n\n<pre><code>//Inside shared_state.go\n\nvar sharedMap    map[string]string = make(map[string]string)\nvar mutex       sync.RWMutex     = sync.RWMutex{}\n\nfunc Add(k string, v string) bool {\n    mutex.Lock()\n    if _, exists := sharedMap[k]; exists {\n        mutex.Unlock()\n        return false\n    }\n    tokenMap[k] = v\n    mutex.Unlock()\n    return true\n}\n//Other methods to access, modify... etc\n</code></pre>\n\n<p>Whilst this does do the job is quite an ugly implementation by go standards, which encourage modeling concurrency using message. </p>\n\n<p>Are there easy ways of modeling shared state using messages that I am blatantly unaware of ? Or am I forced to use mutexes in this kind of cases ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1496264248, "post_id": 44294363, "comment_id": 75595432, "body": "Personally, I&#39;d use <code>strings.TrimPrefix(fileUrlStr, &quot;file:&#47;&#47;&quot;)</code>. I don&#39;t think there&#39;s any particularly idiomatic way to do it, other than &quot;keep it simple&quot;, the general-purpose Go idiom."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496264401, "post_id": 44294363, "comment_id": 75595508, "body": "Re. your edit - you can use <a href=\"https://golang.org/pkg/path/filepath/#FromSlash\" rel=\"nofollow noreferrer\"><code>filepath.FromSlash()</code></a> to convert forward slashes to the platform-specific path separator."}, {"owner": {"reputation": 1590, "user_id": 113332, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ef675220129f6d019ba08674030f4e2d?s=128&d=identicon&r=PG", "display_name": "Jon Bristow", "link": "https://stackoverflow.com/users/113332/jon-bristow"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496264432, "post_id": 44294363, "comment_id": 75595522, "body": "My only concern with that I&#39;ll be munging (legal) urls that look like: <code>file:&#47;&#47;localhost&#47;path&#47;to&#47;file.json</code> . (Also, @Adrian, I&#39;m not concerned about the slashes, since all slashes are forward slashes in a url)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496264539, "post_id": 44294363, "comment_id": 75595572, "body": "In a URL yes, in a file path, no."}, {"owner": {"reputation": 1590, "user_id": 113332, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ef675220129f6d019ba08674030f4e2d?s=128&d=identicon&r=PG", "display_name": "Jon Bristow", "link": "https://stackoverflow.com/users/113332/jon-bristow"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496264654, "post_id": 44294363, "comment_id": 75595627, "body": "Basically, the closer I can get to rfc-8089 the better."}, {"owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "edited": false, "score": 0, "creation_date": 1496267914, "post_id": 44294363, "comment_id": 75596900, "body": "<code>url</code> package follows RFC 3986."}, {"owner": {"reputation": 1590, "user_id": 113332, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ef675220129f6d019ba08674030f4e2d?s=128&d=identicon&r=PG", "display_name": "Jon Bristow", "link": "https://stackoverflow.com/users/113332/jon-bristow"}, "edited": false, "score": 1, "creation_date": 1496271023, "post_id": 44294363, "comment_id": 75597945, "body": "Ok, then what&#39;s the golang idiom for converting file scheme uri into system specific paths?"}], "answers": [{"tags": [], "owner": {"reputation": 6761, "user_id": 664345, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/34de936228acd10be7665e5c73c53d92?s=128&d=identicon&r=PG", "display_name": "Liyan Chang", "link": "https://stackoverflow.com/users/664345/liyan-chang"}, "is_accepted": false, "score": 1, "last_activity_date": 1530268623, "creation_date": 1530268623, "answer_id": 51099827, "question_id": 44294363, "link": "https://stackoverflow.com/questions/44294363/what-is-the-idiomatic-way-to-read-urls-with-a-file-scheme-as-filenames-for-readf/51099827#51099827", "title": "What is the idiomatic way to read urls with a file scheme as filenames for ReadFile?", "body": "<p>Using <code>net/url</code>, the solution that you were using, is the correct one.</p>\n\n<p>It's properly deals with hostnames and paths across platforms and also gives you a chance to check the url scheme is the file scheme.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n)\n\nfunc main() {\n\n    for _, path := range []string{\n        \"file:///path/to/file.json\",\n        \"file:///c:/WINDOWS/clock.json\",\n        \"file://localhost/path/to/file.json\",\n        \"file://localhost/c:/WINDOWS/clock.avi\",\n\n        // A case that you probably don't need to handle given the rarity,\n        // but is a known legacy win32 issue when translating \\\\remotehost\\share\\dir\\file.txt \n        \"file:////remotehost/share/dir/file.txt\",\n\n    } {\n        u, _ := url.ParseRequestURI(path)\n        fmt.Printf(\"url:%v\\nscheme:%v host:%v Path:%v\\n\\n\", u, u.Scheme, u.Host, u.Path)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1590, "user_id": 113332, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ef675220129f6d019ba08674030f4e2d?s=128&d=identicon&r=PG", "display_name": "Jon Bristow", "link": "https://stackoverflow.com/users/113332/jon-bristow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1222, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1530268623, "creation_date": 1496263499, "last_edit_date": 1496264214, "question_id": 44294363, "link": "https://stackoverflow.com/questions/44294363/what-is-the-idiomatic-way-to-read-urls-with-a-file-scheme-as-filenames-for-readf", "title": "What is the idiomatic way to read urls with a file scheme as filenames for ReadFile?", "body": "<p>Is there an idiomatic way to read a file from the system starting from a (file scheme) url and not a path?</p>\n\n<p>I tried this first:</p>\n\n<pre><code>fileUrlStr := \"file:///path/to/file.json\"\njsonBuffer, _ := ioutil.ReadFile(fileUrlStr)\n</code></pre>\n\n<p>This is my current (mostly working version) but I'm concerned there are some gotchas that I'm missing, so I'm hoping there's a more tried and true way to do it:</p>\n\n<pre><code>fileUrlStr := \"file:///path/to/file.json\"\nfileUrl, _ := url.Parse(fileUrlStr)\njsonBuffer, _ := ioutil.ReadFile(fileUrl.Path)\n</code></pre>\n\n<p>(Bonus if I can support both <code>file:///Users/jdoe/temp.json</code> and <code>file:///c:/WINDOWS/clock.json</code> without having to add code-paths accounting for them)</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8094132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa08d943ac511e016bc21baf74c383e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/8094132/ray"}, "edited": false, "score": 0, "creation_date": 1496265418, "post_id": 44293739, "comment_id": 75595923, "body": "Oh, I see.  Thanks for taking the time; much appreciated."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1496260974, "creation_date": 1496260974, "answer_id": 44293739, "question_id": 44293693, "link": "https://stackoverflow.com/questions/44293693/syntax-assist-for-method-type-definition/44293739#44293739", "title": "Syntax assist for method type definition?", "body": "<p>The syntax is</p>\n\n<pre><code>type SampleFunc func (ctx *Context, arg int) (err error)\n</code></pre>\n\n<p>Assign the <code>Sample</code> method to a variable of type <code>SampleFunc</code> like this:</p>\n\n<pre><code>var f SampleFunc = (*Context).Sample\n</code></pre>\n\n<p>The <code>(*)</code> part is required for pointer receiver methods. Call it like this:</p>\n\n<pre><code> f(ctx, 1)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/08D0DQK_8P\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 11, "user_id": 8094132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa08d943ac511e016bc21baf74c383e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/8094132/ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496260974, "creation_date": 1496260764, "last_edit_date": 1496260928, "question_id": 44293693, "link": "https://stackoverflow.com/questions/44293693/syntax-assist-for-method-type-definition", "title": "Syntax assist for method type definition?", "body": "<p>Apologies if this is obvious; relatively new to Golang.</p>\n\n<p>I need to pass a function with a pointer receiver as an argument to a method, and to store that function pointer in other structs, etc.</p>\n\n<p>Without a receiver, this is straightforward.  For a function such as...</p>\n\n<pre><code>func Sample(ctx *Context, arg int) (err error)\n</code></pre>\n\n<p>...I can create a function type by using the syntax...</p>\n\n<pre><code>type SampleFunc func (ctx *Context, arg int) (err error)\n</code></pre>\n\n<p>...but for a function with a receiver such as...</p>\n\n<pre><code>func (ctx *Context) Sample(arg int) (err error)\n</code></pre>\n\n<p>...what's the syntax for the type definition?  I tried...</p>\n\n<pre><code>type SampleFunc func (ctx *Context) (arg int) (err error)\n</code></pre>\n\n<p>...but that just yields <code>syntax error: unexpected ( after top level declaration</code></p>\n\n<p>Thanks for your advice.</p>\n"}, {"tags": ["mysql", "go", "aws-lambda"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496259313, "post_id": 44292787, "comment_id": 75593020, "body": "Not familiar with Apex - does <code>HandleFunc</code> return immediately? If so, your program exits right after, which might explain the error."}, {"owner": {"reputation": 476, "user_id": 144411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6fbd05e123ff2bb1d34de48424ddc1?s=128&d=identicon&r=PG", "display_name": "ivanjovanovic", "link": "https://stackoverflow.com/users/144411/ivanjovanovic"}, "edited": false, "score": 1, "creation_date": 1496259885, "post_id": 44292787, "comment_id": 75593354, "body": "From apex docs &quot;you must use stderr for logging&quot; fmt.Println would print to Stdout by default. Maybe that is the issue? Have no knowledge of apex or how you run this :)"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496257331, "creation_date": 1496257331, "question_id": 44292787, "link": "https://stackoverflow.com/questions/44292787/apex-process-exited-before-completing-request-when-with-golang", "title": "Apex Process exited before completing request when with Golang", "body": "<p>All the answers for something like this are in Javascript, and I'm not sure if it applies in Go.</p>\n\n<p>I've done this</p>\n\n<pre><code>func main() {\n  db, err := sql.Open(\"mysql\", \"db_details\")\n  err = db.Ping()\n  if err != nil {\n    fmt.Println(\"Failed to prepare connection to database\")\n    // log.Fatal(\"Error:\", err.Error())\n  }\n    apex.HandleFunc(func(event json.RawMessage, ctx *apex.Context) (interface{}, error) {\n      fmt.Println(ctx)\n      return map[string]string{\"hello\": \"world\"}, nil\n    })\n}\n</code></pre>\n\n<p>So I'm trying to hit my Amazon RDS MySql db using golang's sql driver.</p>\n\n<p>I get this error</p>\n\n<pre><code>Error: function response: Response Id: &lt;some_id&gt; Process exited before completing request\n</code></pre>\n\n<p>From looking around, there are two causes - 1. I need Go's equivalent of <code>context.done</code>, or 2. I need to raise the timeout.</p>\n\n<p>As I'm using Apex, I raised the timeout to be 300s, which is the maximum. No luck there.</p>\n\n<p>I then tried going through the Apex code to see if there was a <code>Context.Done</code> defined or used anywhere - there isn't.</p>\n\n<p>How do I get around this? </p>\n"}, {"tags": ["go", "proxy", "http-proxy"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1496252994, "post_id": 44291191, "comment_id": 75589587, "body": "Just don&#39;t use the http.DefaultTransport: See <a href=\"https://golang.org/pkg/net/http/#RoundTripper\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#RoundTripper</a>"}, {"owner": {"reputation": 235, "user_id": 3150658, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b0ca3f224ea92e94b941d2d4e83aff2?s=128&d=identicon&r=PG&f=1", "display_name": "artofabhishek", "link": "https://stackoverflow.com/users/3150658/artofabhishek"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1496265023, "post_id": 44291191, "comment_id": 75595769, "body": "awesome thanks Volker."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 4, "last_activity_date": 1496253231, "creation_date": 1496253231, "answer_id": 44291622, "question_id": 44291191, "link": "https://stackoverflow.com/questions/44291191/bypassing-http-proxy-in-golang/44291622#44291622", "title": "Bypassing http_proxy in Golang", "body": "<p>As @Volker mentioned, you can either:</p>\n\n<ul>\n<li>Use your own <a href=\"https://golang.org/pkg/net/http/#RoundTripper\" rel=\"nofollow noreferrer\"><code>RoundTripper</code></a> instead of the <code>DefaultTransport</code></li>\n<li>Modify <a href=\"https://golang.org/pkg/net/http/#RoundTripper\" rel=\"nofollow noreferrer\"><code>DefaultTransport.Proxy</code></a> to return nil for the request in question</li>\n<li>If the call you want to ignore proxies with is to a specific host, and you always want to ignore proxy for calls to that host, add the host to the <a href=\"https://golang.org/pkg/net/http/#ProxyFromEnvironment\" rel=\"nofollow noreferrer\"><code>NO_PROXY</code></a> environment variable</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 235, "user_id": 3150658, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b0ca3f224ea92e94b941d2d4e83aff2?s=128&d=identicon&r=PG&f=1", "display_name": "artofabhishek", "link": "https://stackoverflow.com/users/3150658/artofabhishek"}, "is_accepted": false, "score": 2, "last_activity_date": 1496265123, "creation_date": 1496265123, "answer_id": 44294753, "question_id": 44291191, "link": "https://stackoverflow.com/questions/44291191/bypassing-http-proxy-in-golang/44294753#44294753", "title": "Bypassing http_proxy in Golang", "body": "<p>this is what I did: </p>\n\n<pre><code>var defaultTransport http.RoundTripper = &amp;http.Transport{\n    Proxy: nil,\n    DialContext: (&amp;net.Dialer{\n        Timeout:   10 * time.Second,\n        KeepAlive: 30 * time.Second,\n        DualStack: true,\n    }).DialContext,\n    MaxIdleConns:          30,\n    IdleConnTimeout:       90 * time.Second,\n    TLSHandshakeTimeout:   15 * time.Second,\n    ExpectContinueTimeout: 1 * time.Second,\n}\n\nclient := &amp;http.Client{Transport: defaultTransport}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 6632434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1481512a19a0095274db12c6a7f8f764?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/6632434/luis"}, "is_accepted": false, "score": 1, "last_activity_date": 1573543838, "creation_date": 1573543838, "answer_id": 58813916, "question_id": 44291191, "link": "https://stackoverflow.com/questions/44291191/bypassing-http-proxy-in-golang/58813916#58813916", "title": "Bypassing http_proxy in Golang", "body": "<p>I had that problem with a corporate proxy, even disabled the proxy url it was using it\nthis was my solution</p>\n\n<pre><code>var defaultTtransport http.RoundTripper = &amp;http.Transport{Proxy: nil}\nclient := &amp;http.Client{Transport: defaultTtransport}\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 3150658, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b0ca3f224ea92e94b941d2d4e83aff2?s=128&d=identicon&r=PG&f=1", "display_name": "artofabhishek", "link": "https://stackoverflow.com/users/3150658/artofabhishek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2817, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1573543838, "creation_date": 1496251643, "question_id": 44291191, "link": "https://stackoverflow.com/questions/44291191/bypassing-http-proxy-in-golang", "title": "Bypassing http_proxy in Golang", "body": "<p>I have env variable set for http_proxy, but with another call, I like to bypass proxy and use direct connection to destination server instead.</p>\n\n<p>Is there any way I can do that in Go lang? </p>\n\n<p>Thanks.  </p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1496252303, "post_id": 44290770, "comment_id": 75589213, "body": "The code in the question writes the message to the network.  To debug, add a <code>time.Sleep(time.Second)</code> before the call to close. Perhaps that might give some insight into where the message is going."}, {"owner": {"reputation": 4705, "user_id": 562465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f01d5241604fe5419279afc0d11e739d?s=128&d=identicon&r=PG", "display_name": "Rob Fox", "link": "https://stackoverflow.com/users/562465/rob-fox"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1496254620, "post_id": 44290770, "comment_id": 75590405, "body": "I will try it out tomorrow. The thing is that the correct string message reaches the client."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1496259706, "post_id": 44290770, "comment_id": 75593248, "body": "The content of <code>cm</code> is written to the network as is. If the client receives the message in <code>cm</code>, then the incorrect code is probably a client issue."}], "answers": [{"tags": [], "owner": {"reputation": 4705, "user_id": 562465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f01d5241604fe5419279afc0d11e739d?s=128&d=identicon&r=PG", "display_name": "Rob Fox", "link": "https://stackoverflow.com/users/562465/rob-fox"}, "is_accepted": true, "score": 0, "last_activity_date": 1496509265, "last_edit_date": 1496509265, "creation_date": 1496490617, "answer_id": 44343600, "question_id": 44290770, "link": "https://stackoverflow.com/questions/44290770/using-gorilla-formatclosemessage-client-receives-wrong-code/44343600#44343600", "title": "Using Gorilla FormatCloseMessage client receives wrong code", "body": "<p>As the connection is instantly closed after sending the message the close handshake is not completed. One way to fix it is by adding a <code>sleep</code> call. Though it would be better to implement the close handshake correctly.</p>\n"}], "owner": {"reputation": 4705, "user_id": 562465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f01d5241604fe5419279afc0d11e739d?s=128&d=identicon&r=PG", "display_name": "Rob Fox", "link": "https://stackoverflow.com/users/562465/rob-fox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 44343600, "answer_count": 1, "score": 0, "last_activity_date": 1496509265, "creation_date": 1496250222, "last_edit_date": 1496253197, "question_id": 44290770, "link": "https://stackoverflow.com/questions/44290770/using-gorilla-formatclosemessage-client-receives-wrong-code", "title": "Using Gorilla FormatCloseMessage client receives wrong code", "body": "<p>I am closing a WS connection with the code 1008.</p>\n\n<pre><code>cm := websocket.FormatCloseMessage(websocket.ClosePolicyViolation, msg)\nif err := c.conn.WriteMessage(websocket.CloseMessage, cm); err != nil {\n    log.Error(err)\n}\nerr = c.conn.Close()\n</code></pre>\n\n<p>However when receiving the message with <a href=\"https://github.com/websockets/ws\" rel=\"nofollow noreferrer\">WS</a> library, it says the code is 1006. What am I doing wrong?</p>\n"}, {"tags": ["go", "encoder", "decoder", "gob"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1496252285, "post_id": 44290639, "comment_id": 75589204, "body": "Println/Scanln aren&#39;t meant to be used for serialization. You could probably implement <code>fmt.Scanner</code>, but you might as well do it directly in the Marshal methods you have."}], "answers": [{"comments": [{"owner": {"reputation": 442, "user_id": 5935455, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/LKtm8.jpg?s=128&g=1", "display_name": "Adrien Luxey", "link": "https://stackoverflow.com/users/5935455/adrien-luxey"}, "edited": false, "score": 0, "creation_date": 1549903035, "post_id": 44310992, "comment_id": 96062377, "body": "It is very nice to have a working [Un]MarshalBinary code like that. I was afraid of doing nonsense with such an approach, but your safeguards make it look robust enough. Thanks!"}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": false, "score": 5, "last_activity_date": 1496329134, "creation_date": 1496329134, "answer_id": 44310992, "question_id": 44290639, "link": "https://stackoverflow.com/questions/44290639/how-to-marshal-array-to-binary-and-unmarshal-binary-to-array-in-golang/44310992#44310992", "title": "How to marshal array to binary and unmarshal binary to array in golang?", "body": "<p>If you can change the visibility of <code>transProp</code> fields to public, e.g. </p>\n\n<pre><code>type transProp struct {\n    A []int\n    B []float64\n}\n</code></pre>\n\n<p>then you don't need to implement custom binary marshaller/unmarshaller. You can use default <code>gob</code> decoder/encoder. </p>\n\n<p>However, if you can't, there are many options. </p>\n\n<ol>\n<li><p>The simplest one, define another <code>wrapper struct</code> that export related fields, wrap <code>transProp</code>, then use default <code>gob</code> encoder/decoder, e.g.</p>\n\n<pre><code>type wrapTransProp struct {\n    A []int\n    B []float64\n}\n\nfunc (p transProp) MarshalBinary() ([]byte, error) {\n    //Wrap struct\n    w := wrapTransProp{p.a, p.b}\n\n    //use default gob encoder\n    var buf bytes.Buffer\n    enc := gob.NewEncoder(&amp;buf)\n    if err := enc.Encode(w); err != nil {\n        return nil, err\n    }\n    return buf.Bytes(), nil\n}\nfunc (p *transProp) UnmarshalBinary(data []byte) error {\n    w := wrapTransProp{}\n\n    //Use default gob decoder\n    reader := bytes.NewReader(data)\n    dec := gob.NewDecoder(reader)\n    if err := dec.Decode(&amp;w); err != nil {\n        return err\n    }\n\n    p.a = w.A\n    p.b = w.B\n    return nil\n}\n</code></pre></li>\n<li><p>Custom marshaller/unmarshaller with custom data layout. There are many implementation possibilities. Several considerations:</p>\n\n<ul>\n<li>Byte order, little/big endian?</li>\n<li>Packet/stream layout?</li>\n</ul>\n\n<p>An example implementation of <code>big-endian</code> with stream format:</p>\n\n<pre><code>// Big-Endian\n// Size  : 4,         4,      1,        n,     4,       n\n// Types : uint32,    uint32, uint8,    []int, uint32,  []float64\n// Data  : #numbytes, #nInt,  #intSize, p.a,   #nFloat, p.b\n</code></pre>\n\n<p>The challenge is in how to represent <code>int</code> since it's architecture dependent. Sample implementation will be:</p>\n\n<pre><code>func (p transProp) MarshalBinary() ([]byte, error) {\n    //Get sizeof int (in bits) from strconv package\n    szInt := strconv.IntSize / 8\n    nInt := len(p.a)\n    nFloat := len(p.b)\n\n    nStream := 4 + 4 + 1 + nInt*szInt + 4 + nFloat*8\n    stream := make([]byte, nStream)\n    pos := 0\n\n    //total number of bytes\n    binary.BigEndian.PutUint32(stream, uint32(nStream))\n    pos += 4\n\n    //num of items in p.a\n    binary.BigEndian.PutUint32(stream[pos:], uint32(nInt))\n    pos += 4\n\n    //int size\n    stream[pos] = uint8(szInt)\n    pos++\n\n    //items in a\n    switch szInt {\n    case 1:\n        for _, v := range p.a {\n            stream[pos] = uint8(v)\n            pos++\n        }\n    case 2: //16-bit\n        for _, v := range p.a {\n            binary.BigEndian.PutUint16(stream[pos:], uint16(v))\n            pos += 2\n        }\n    case 4: //32-bit\n        for _, v := range p.a {\n            binary.BigEndian.PutUint32(stream[pos:], uint32(v))\n            pos += 4\n        }\n    case 8: //64-bit\n        for _, v := range p.a {\n            binary.BigEndian.PutUint64(stream[pos:], uint64(v))\n            pos += 8\n        }\n    }\n\n    //number of items in p.b\n    binary.BigEndian.PutUint32(stream[pos:], uint32(nFloat))\n    pos += 4\n\n    //items in b\n    s := stream[pos:pos] //slice len=0, capacity=nFloat\n    buf := bytes.NewBuffer(s)\n    if err := binary.Write(buf, binary.BigEndian, p.b); err != nil {\n        return nil, err\n    }\n\n    return stream, nil\n}\n\nfunc (p *transProp) UnmarshalBinary(data []byte) error {\n    buf := bytes.NewBuffer(data)\n\n    var intSize uint8\n    var k, nBytes, nInt, nFloat uint32\n\n    //num bytes\n    if err := binary.Read(buf, binary.BigEndian, &amp;nBytes); err != nil {\n        return err\n    }\n    if len(data) &lt; int(nBytes) {\n        return errors.New(\"len(data) &lt; #Bytes\")\n    }\n\n    //num of int items\n    if err := binary.Read(buf, binary.BigEndian, &amp;nInt); err != nil {\n        return err\n    }\n\n    //int size\n    if err := binary.Read(buf, binary.BigEndian, &amp;intSize); err != nil {\n        return err\n    }\n\n    //read int into p.a\n    pos := 0\n    stream := buf.Bytes()\n    p.a = make([]int, nInt)\n    switch intSize {\n    case 1:\n        for pos = 0; pos &lt; int(nInt); pos++ {\n            p.a[pos] = int(stream[pos])\n        }\n    case 2:\n        for k = 0; k &lt; nInt; k++ {\n            p.a[k] = int(binary.BigEndian.Uint16(stream[pos:]))\n            pos += 2\n        }\n    case 4:\n        for k = 0; k &lt; nInt; k++ {\n            p.a[k] = int(binary.BigEndian.Uint32(stream[pos:]))\n            pos += 4\n        }\n    case 8:\n        for k = 0; k &lt; nInt; k++ {\n            p.a[k] = int(binary.BigEndian.Uint64(stream[pos:]))\n            pos += 8\n        }\n    }\n\n    //advance buffer\n    buf.Next(pos)\n\n    //num of float64 items\n    if err := binary.Read(buf, binary.BigEndian, &amp;nFloat); err != nil {\n        return err\n    }\n\n    //items in b\n    p.b = make([]float64, nFloat)\n    if err := binary.Read(buf, binary.BigEndian, p.b); err != nil {\n        return err\n    }\n\n    return nil\n}\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 6317, "user_id": 2849157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/81de56159f8a6f58c78e3e7d88d7fbe5?s=128&d=identicon&r=PG&f=1", "display_name": "roger", "link": "https://stackoverflow.com/users/2849157/roger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7385, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1496329134, "creation_date": 1496249795, "question_id": 44290639, "link": "https://stackoverflow.com/questions/44290639/how-to-marshal-array-to-binary-and-unmarshal-binary-to-array-in-golang", "title": "How to marshal array to binary and unmarshal binary to array in golang?", "body": "<p>I want to use <code>gob</code> to <code>encode</code> and <code>decode</code> object, I do it like this:</p>\n\n<pre><code>type transProp struct {\n    a []int\n    b []float64\n}\n\nfunc (p transProp) MarshalBinary() ([]byte, error) {\n    // A simple encoding: plain text.\n    var b bytes.Buffer\n    fmt.Fprintln(&amp;b, p.a, p.b)\n    return b.Bytes(), nil\n}\n\n// UnmarshalBinary modifies the receiver so it must take a pointer receiver.\nfunc (p *transProp) UnmarshalBinary(data []byte) error {\n    // A simple encoding: plain text.\n    b := bytes.NewBuffer(data)\n    _, err := fmt.Fscanln(b, &amp;p.a, &amp;p.b)\n    return err\n}\n\nfunc TestGobEncode(t *testing.T) {\n    p := transProp{\n        a: []int{3, 4, 5},\n        b: []float64{1.0, 2.0},\n    }\n\n    var network bytes.Buffer\n    enc := gob.NewEncoder(&amp;network)\n    err := enc.Encode(p)\n    if err != nil {\n        log.Fatal(\"encode:\", err)\n    }\n    dec := gob.NewDecoder(&amp;network)\n    var p1 transProp\n    err = dec.Decode(&amp;p1)\n    if err != nil {\n        log.Fatal(\"decode:\", err)\n    }\n    fmt.Println(p1)\n}\n</code></pre>\n\n<p>But, this report error like this:</p>\n\n<pre><code>decode:can't scan type: *[]int\n</code></pre>\n"}, {"tags": ["go", "timer"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1496247152, "creation_date": 1496247152, "answer_id": 44289780, "question_id": 44289704, "link": "https://stackoverflow.com/questions/44289704/trigger-timer-prematurely/44289780#44289780", "title": "Trigger timer prematurely", "body": "<p>You can use a cancellation channel:</p>\n\n<pre><code>cancel := make(chan struct{})\nfor {\n    timer = time.NewTimer(30 * time.Second)\n    select {\n    case &lt;- timer.C:\n        doSomething()\n    case &lt;- cancel:\n        doSomething()\n    }\n}\n</code></pre>\n\n<p>When you want to ignore the timer and execute immediately, just send a message on the <code>cancel</code> channel:</p>\n\n<pre><code>cancel &lt;- struct{}{}\n</code></pre>\n"}], "owner": {"reputation": 1313, "user_id": 2278623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/rna82.jpg?s=128&g=1", "display_name": "Alex Parker", "link": "https://stackoverflow.com/users/2278623/alex-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 44289780, "answer_count": 1, "score": 2, "last_activity_date": 1496247152, "creation_date": 1496246935, "question_id": 44289704, "link": "https://stackoverflow.com/questions/44289704/trigger-timer-prematurely", "title": "Trigger timer prematurely", "body": "<p>I have a loop that is sleeping for some period of time. However, elsewhere in my code I might need to end that sleep time prematurely so that the succeeding logic can be executed sooner.</p>\n\n<pre><code>for {\n    timer = time.NewTimer(30 * time.Second)\n    &lt;-timer.C\n    // Do something\n}\n</code></pre>\n\n<p>Elsewhere\u2026</p>\n\n<pre><code>// Trigger timer\n// timer.Trigger() ??\n</code></pre>\n\n<p>Naturally, <code>timer.Stop()</code> will stop the timer, but it will then cause the program to hang and not drop down to <code>// Do something</code>. Currently, I am resetting the timer to a very small duration so that the timer will expire basically immediately.</p>\n\n<pre><code>timer.Reset(time.Millisecond)\n</code></pre>\n\n<p>Is there a better way to do this?</p>\n"}, {"tags": ["pointers", "go", "switch-statement"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1496238660, "post_id": 44286540, "comment_id": 75580025, "body": "<code>r</code> points to <code>a</code>, because you passed a pointer to <code>a</code>. Can you explain why you would expect the pointer to somehow change value when you passed it to the Test function?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496239475, "post_id": 44286540, "comment_id": 75580605, "body": "Jim covered the questions in the body. To answer the question in the title, type assertions return the input value as the given type, as outlined in the spec: <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Type_assertions</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496240530, "post_id": 44286540, "comment_id": 75581414, "body": "You didn&#39;t assign a pointer to <code>b</code> to <code>r</code>, you assigned a pointer to <code>a</code> to <code>r</code>. See also the &quot;Type switches&quot; specification under <a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Switch_statements</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1496241907, "post_id": 44286540, "comment_id": 75582482, "body": "&quot;I expect that <code>r := result.(type)</code> gives me the type of the result.&quot; Don&#39;t expect things which are not true. The language works according to the spec and not to your expectations. The spec has nice examples on type switches <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Type_switches</a>."}], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 8018505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b91738cee0a49bbbf95faf11cf9bc5a?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Coleman", "link": "https://stackoverflow.com/users/8018505/paul-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1496241553, "last_edit_date": 1496241553, "creation_date": 1496240304, "answer_id": 44287260, "question_id": 44286540, "link": "https://stackoverflow.com/questions/44286540/what-does-myvariable-type-return-exactly/44287260#44287260", "title": "What does &#39;myVariable.(type)&#39; return exactly?", "body": "<p>See information on type assertions <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>There is a good description of pointers in go <a href=\"https://www.golang-book.com/books/intro/8\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>In your code &amp;a means the address of a and b returns a pointer to an int (*int).</p>\n\n<p>In the Test function you are saying store the value 10 in the memory location pointed to by r.</p>\n"}], "owner": {"reputation": 7265, "user_id": 3457177, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bae2e85ed6794ece744ee124d9ac7842?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalii", "link": "https://stackoverflow.com/users/3457177/vitalii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1496323682, "creation_date": 1496238376, "last_edit_date": 1496323682, "question_id": 44286540, "link": "https://stackoverflow.com/questions/44286540/what-does-myvariable-type-return-exactly", "title": "What does &#39;myVariable.(type)&#39; return exactly?", "body": "<p>I created a simple code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    a := 5\n    b := &amp;a\n\n    Test(b)\n\n    fmt.Println(a)\n    fmt.Println(*b)\n}\n\nfunc Test(result interface{}){\n\n    switch r := result.(type) {\n        case *int:\n            *r = 10\n    }\n}\n</code></pre>\n\n<p>You can run it <a href=\"https://play.golang.org/p/fFoeMl2gDj\" rel=\"nofollow noreferrer\">here</a> </p>\n\n<p>In Test method inside switch statement I create new variable that is a type of my parameter. \nWhy does my variable 'b' update after update of this pointer. Why does this new variable points to the old one?</p>\n\n<p>The result of program execution is </p>\n\n<pre><code>10\n10\n</code></pre>\n\n<p>But expected</p>\n\n<pre><code>5\n5\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I'd like to precise the question. I did not assign my pointer to 'b' to variable 'r' in Test.\nI expect that </p>\n\n<pre><code> r := result.(type)\n</code></pre>\n\n<p>gives me the type of the result. But why if I change value of a pointer of a new variable result is changed too</p>\n\n<p><strong>UPDATE 2</strong></p>\n\n<p>As suggested I checked again a specification and didn't found an answer. In the next construction </p>\n\n<pre><code>switch r := result.(type) {\n    case *int:\n        *r = 10\n}\n</code></pre>\n\n<p>What does <code>result.(type)</code> return exactly?</p>\n\n<blockquote>\n  <p>A type switch compares types rather than values. It is otherwise similar > to an expression switch. It is marked by a special switch expression that > has the form of a type assertion using the reserved word type rather than > an actual type:</p>\n  \n  <p>switch x.(type) {\n  // cases\n  }</p>\n</blockquote>\n"}, {"tags": ["go", "time"], "comments": [{"owner": {"reputation": 452, "user_id": 1816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s2A1k.jpg?s=128&g=1", "display_name": "Fabio Petrillo", "link": "https://stackoverflow.com/users/1816536/fabio-petrillo"}, "edited": false, "score": 0, "creation_date": 1496234330, "post_id": 44284754, "comment_id": 75576728, "body": "The answer is at <a href=\"https://stackoverflow.com/questions/24122821/go-golang-time-now-unixnano-convert-to-milliseconds\" title=\"go golang time now unixnano convert to milliseconds\">stackoverflow.com/questions/24122821/&hellip;</a> ."}], "answers": [{"tags": [], "owner": {"reputation": 1425, "user_id": 293581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d96c8822fa6bd112a3df4e45c16ea786?s=128&d=identicon&r=PG", "display_name": "Machiel", "link": "https://stackoverflow.com/users/293581/machiel"}, "is_accepted": true, "score": 6, "last_activity_date": 1496233806, "creation_date": 1496233806, "answer_id": 44284873, "question_id": 44284754, "link": "https://stackoverflow.com/questions/44284754/how-to-get-current-time-in-milliseconds-using-go-language/44284873#44284873", "title": "How to get current time in milliseconds using Go language?", "body": "<p>It seems like you're running this on the Go playground (play.golang.org). The time is fixed on the Go playground, try running it locally instead.</p>\n"}], "owner": {"reputation": 7436, "user_id": 632467, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/b024066cc072c45f3f5b810925ae9ce4?s=128&d=identicon&r=PG", "display_name": "Anshul", "link": "https://stackoverflow.com/users/632467/anshul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5868, "favorite_count": 0, "closed_date": 1496234249, "accepted_answer_id": 44284873, "answer_count": 1, "score": -1, "last_activity_date": 1498128954, "creation_date": 1496233450, "last_edit_date": 1498128954, "question_id": 44284754, "link": "https://stackoverflow.com/questions/44284754/how-to-get-current-time-in-milliseconds-using-go-language", "closed_reason": "Duplicate", "title": "How to get current time in milliseconds using Go language?", "body": "<p>I am trying to get the current time in millisecond using Go language <a href=\"https://golang.org/#\" rel=\"nofollow noreferrer\">https://golang.org/#</a> </p>\n\n<pre><code>package main\nimport \"fmt\"\nimport \"time\"\nfunc main() {\n\n    now := time.Now()\n    secs := now.Unix()\n    nanos := now.UnixNano()\n    fmt.Println(now)\n\n    millis := nanos / 1000000\n    fmt.Println(millis)\n\n}\n</code></pre>\n\n<p>When I run the above code using the mentioned website the output I get is following:</p>\n\n<pre><code>2009-11-10 23:00:00 +0000 UTC\n1257894000000\n</code></pre>\n\n<p>I am not able to understand why I am not getting current date as result? I tried the same code on another website <a href=\"https://www.epochconverter.com/\" rel=\"nofollow noreferrer\">https://www.epochconverter.com/</a> and got the correct result which is following :</p>\n\n<pre><code>Time Now is : \n1496230018\n</code></pre>\n\n<p>Can someone confirm if the problem is related to my code or is the website that's showing the wrong result?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["bash", "mongodb", "ubuntu", "go"], "comments": [{"owner": {"reputation": 498, "user_id": 2174359, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf06579ee8856206e0dc3d83f9bb5c43?s=128&d=identicon&r=PG", "display_name": "FrankTheTank_12345", "link": "https://stackoverflow.com/users/2174359/frankthetank-12345"}, "edited": false, "score": 0, "creation_date": 1496231343, "post_id": 44283880, "comment_id": 75574429, "body": "Here you find an start_stop_restart skript for mongodb with bash. There is also an very short command :) <a href=\"https://github.com/patrick0585/Mongo_Start_Stop/blob/master/mongo_start_stop.sh\" rel=\"nofollow noreferrer\">github.com/patrick0585/Mongo_Start_Stop/blob/master/&hellip;</a> Your command can be ps -ef | awk /[m]ongodb/"}, {"owner": {"reputation": 498, "user_id": 2174359, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf06579ee8856206e0dc3d83f9bb5c43?s=128&d=identicon&r=PG", "display_name": "FrankTheTank_12345", "link": "https://stackoverflow.com/users/2174359/frankthetank-12345"}, "edited": false, "score": 0, "creation_date": 1496231396, "post_id": 44283880, "comment_id": 75574474, "body": "And maybe this post will help you how to check with golang how process is running. <a href=\"https://stackoverflow.com/questions/15204162/check-if-a-process-exists-in-go-way\" title=\"check if a process exists in go way\">stackoverflow.com/questions/15204162/&hellip;</a>"}, {"owner": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "reply_to_user": {"reputation": 498, "user_id": 2174359, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf06579ee8856206e0dc3d83f9bb5c43?s=128&d=identicon&r=PG", "display_name": "FrankTheTank_12345", "link": "https://stackoverflow.com/users/2174359/frankthetank-12345"}, "edited": false, "score": 0, "creation_date": 1496232005, "post_id": 44283880, "comment_id": 75574988, "body": "@Patrick85 But how to get that PID with go script as it still returns same error with short command as well.."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1496232264, "post_id": 44283880, "comment_id": 75575194, "body": "You can not pipe several commands like that. Please refer to <a href=\"https://stackoverflow.com/questions/10781516/how-to-pipe-several-commands-in-go\"><i>How to pipe several commands in Go?</i></a> for correct answer."}, {"owner": {"reputation": 498, "user_id": 2174359, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf06579ee8856206e0dc3d83f9bb5c43?s=128&d=identicon&r=PG", "display_name": "FrankTheTank_12345", "link": "https://stackoverflow.com/users/2174359/frankthetank-12345"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496232414, "post_id": 44283880, "comment_id": 75575308, "body": "@putu Yes you&#39;re right. Your link is great."}, {"owner": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "reply_to_user": {"reputation": 498, "user_id": 2174359, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf06579ee8856206e0dc3d83f9bb5c43?s=128&d=identicon&r=PG", "display_name": "FrankTheTank_12345", "link": "https://stackoverflow.com/users/2174359/frankthetank-12345"}, "edited": false, "score": 0, "creation_date": 1496233105, "post_id": 44283880, "comment_id": 75575836, "body": "@Patrick85 Thanks to you both. Your comments helps me a lot. :)"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1496237525, "post_id": 44283880, "comment_id": 75579146, "body": "That&#39;s not a good-practice approach even in bash. Much better to integrate with your init system -- for instance, <code>exec.Command(&quot;systemctl&quot;, &quot;is-active&quot;, &quot;mongod&quot;)</code> (adjusted for actual service name and init system) is both simpler (only need to check the exit status, not parse output at all) and more robust (can&#39;t be thrown off by other programs with similar names -- <code>vim mongod.conf</code> matches <code>grep mongod</code>, after all); can&#39;t be spoofed by non-root users; etc."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "reply_to_user": {"reputation": 498, "user_id": 2174359, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf06579ee8856206e0dc3d83f9bb5c43?s=128&d=identicon&r=PG", "display_name": "FrankTheTank_12345", "link": "https://stackoverflow.com/users/2174359/frankthetank-12345"}, "edited": false, "score": 0, "creation_date": 1496237794, "post_id": 44283880, "comment_id": 75579365, "body": "@Patrick85, that <code>ps | awk</code> approach has almost all the same bugs -- it&#39;ll still treat an existing process <code>vim mongod.conf</code> as a match -- and it doesn&#39;t tell the OP how to use a pipeline in a process started from Go (which is their most immediate issue)."}], "answers": [{"comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1496237684, "post_id": 44286169, "comment_id": 75579264, "body": "I believe you intended to put in a link here?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1496237911, "post_id": 44286169, "comment_id": 75579463, "body": "Good catch. I&#39;m experiencing a caffeine deficiency this morning."}, {"owner": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "edited": false, "score": 0, "creation_date": 1496306097, "post_id": 44286169, "comment_id": 75610125, "body": "@Adrian Actually my aim is to restart mongo server, if it&#39;s down. And I think I can&#39;t achieve this with mgo library. Is it possible?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496323638, "post_id": 44286169, "comment_id": 75622951, "body": "No, mgo is used for connecting to and interacting with MongoDB. You can use it to test connectivity but not to do anything with Mongo when it&#39;s down."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1496237895, "last_edit_date": 1496237895, "creation_date": 1496237358, "answer_id": 44286169, "question_id": 44283880, "link": "https://stackoverflow.com/questions/44283880/golang-check-whether-mongodb-is-running/44286169#44286169", "title": "GOLANG check whether mongodb is running", "body": "<p>If you want to go beyond porting a bash script to Go (which is often more trouble than it's worth), you can use the <a href=\"https://godoc.org/gopkg.in/mgo.v2\" rel=\"nofollow noreferrer\">mgo library</a> to actually connect to a MongoDB instance and check if it is healthy:</p>\n\n<pre><code>package main\n\nimport (\n    \"gopkg.in/mgo.v2\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    sess, err := mgo.Dial(\"localhost\")\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n    defer sess.Close()\n    err = sess.Ping()\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n    fmt.Println(\"MongoDB server is healthy.\")\n    os.Exit(0)\n}\n</code></pre>\n"}], "owner": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1803, "favorite_count": 0, "accepted_answer_id": 44286169, "answer_count": 1, "score": 0, "last_activity_date": 1496237895, "creation_date": 1496231072, "question_id": 44283880, "link": "https://stackoverflow.com/questions/44283880/golang-check-whether-mongodb-is-running", "title": "GOLANG check whether mongodb is running", "body": "<p>I am writing a GO script to check whether Mongo server is running. My code is as, </p>\n\n<pre><code>import \"bytes\"\nimport \"os/exec\"\nimport \"fmt\"\n\nfunc main() {\n    cmd := exec.Command(\"ps\", \"-ef\", \"|\", \"grep\", \"mongod\", \"|\", \"grep\", \"-v\", \"grep\", \"|\", \"wc\", \"-l\", \"|\", \"tr\", \"-d\", \"'\", \"'\")\n\n    fmt.Println(cmd)\n    var out bytes.Buffer\n    var stderr bytes.Buffer\n    cmd.Stdout = &amp;out\n    cmd.Stderr = &amp;stderr\n    err := cmd.Run()\n    if err != nil {\n        fmt.Println(fmt.Sprint(err) + \": \" + stderr.String())\n        return\n    }\n    fmt.Println(\"Result: \" + out.String())\n}\n</code></pre>\n\n<p>But Getting Error as , \"exit status 1: error: garbage option\" .\nIs there other way to check this with GOLANG? Please let me know.</p>\n"}, {"tags": ["go", "apache-kafka", "sarama"], "comments": [{"owner": {"reputation": 3638, "user_id": 2884309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/T1Mo3.jpg?s=128&g=1", "display_name": "Ivan Aracki", "link": "https://stackoverflow.com/users/2884309/ivan-aracki"}, "edited": false, "score": 0, "creation_date": 1523485570, "post_id": 44279935, "comment_id": 86585977, "body": "no update on this? @Rishabh"}], "answers": [{"tags": [], "owner": {"reputation": 138, "user_id": 6336864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ca97c7aa1df650433a81e16dc9d097?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6336864/simon"}, "is_accepted": false, "score": 3, "last_activity_date": 1535436818, "creation_date": 1535436818, "answer_id": 52051229, "question_id": 44279935, "link": "https://stackoverflow.com/questions/44279935/why-partition-is-needed-in-shopify-sarama-consumer-to-consume-messages/52051229#52051229", "title": "Why partition is needed in Shopify Sarama consumer to consume messages", "body": "<p>I use <a href=\"https://github.com/bsm/sarama-cluster\" rel=\"nofollow noreferrer\">sarama-cluster</a> which is an open source extension for Sarama (also recommended by <a href=\"https://godoc.org/github.com/Shopify/sarama#Consumer\" rel=\"nofollow noreferrer\">Shopify Sarama</a>).<br>\nWith Sarama cluster you can create a consumer using this API:</p>\n\n<pre><code>cluster.NewConsumer(brokers, consumerGroup, topics, kafkaConfig)\n</code></pre>\n\n<p>so no partition is needed. You should only provide the addresses of your Kafka <code>brokers</code>, the name of your <code>consumer group</code> and which <code>topics</code> you wish to consume. </p>\n\n<hr>\n\n<p><a href=\"https://cwiki.apache.org/confluence/display/KAFKA/Consumer+Group+Example\" rel=\"nofollow noreferrer\">Consumers handling</a></p>\n\n<p>To maintain order you should assign to each partition only one consumer.<br>\nSo in case you have 3 consumers in your consumer group and you want them to consume 2 topics having 2 partitions each, you should assign as follows:  </p>\n\n<pre><code>partitions 1,2 -&gt; consumer A  \npartition 3 -&gt; consumer B  \npartition 4 -&gt; consumer C \n</code></pre>\n\n<p>You might end up with one of the consumers advancing faster (one of the topics have higher throughput) and you will need to re-balance.<br>\nUsing a library (like sarama-cluster) that handles this for you is recommended.</p>\n"}], "owner": {"reputation": 75, "user_id": 1080398, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6a14f80451557f07bdaa8fec0c9b4bd1?s=128&d=identicon&r=PG", "display_name": "Rishabh", "link": "https://stackoverflow.com/users/1080398/rishabh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1452, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535436818, "creation_date": 1496220448, "last_edit_date": 1523450029, "question_id": 44279935, "link": "https://stackoverflow.com/questions/44279935/why-partition-is-needed-in-shopify-sarama-consumer-to-consume-messages", "title": "Why partition is needed in Shopify Sarama consumer to consume messages", "body": "<p>I am sorry for posting a question related to a Kafka Library as not many people are interested in Library specific questions. But this library is one of the most used library for golang-Kafka implementations.</p>\n\n<p>I want to create a simple consumer using Sarama library which listens to a topic. Now as far as I know, in the high-level Kafka API's, by default a consumer listens to all the topics partitions if a specific partition is not specified. However, in this Library, the Consumer interface has only ConsumePartition function where the partition is required param. The signature of function is:</p>\n\n<pre><code>ConsumePartition(topic string, partition int32, offset int64) (PartitionConsumer, error) \n</code></pre>\n\n<p>This confuses me a bit. Anyone who has worked on it? </p>\n\n<p>Also, I have a basic question regarding Kafka. If I have a consumer group consisting of 3 consumer instances and they are listening to let's say 2 topics each having 2 partitions, then do I need to specifically mention which consumer instance will consume to which partition or Kafka Fetch API will take care of it on its own based on load?</p>\n"}, {"tags": ["regex", "dictionary", "go"], "comments": [{"owner": {"reputation": 37822, "user_id": 1231450, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b9c98b4ce12bf9fd925d8c35c8861bb2?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/1231450/jan"}, "edited": false, "score": 2, "creation_date": 1496212126, "post_id": 44277222, "comment_id": 75561532, "body": "Use a real parser instead."}, {"owner": {"reputation": 37822, "user_id": 1231450, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b9c98b4ce12bf9fd925d8c35c8861bb2?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/1231450/jan"}, "edited": false, "score": 0, "creation_date": 1496212277, "post_id": 44277222, "comment_id": 75561611, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags\">RegEx match open tags except XHTML self-contained tags</a>"}], "answers": [{"tags": [], "owner": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "is_accepted": false, "score": 4, "last_activity_date": 1496212537, "creation_date": 1496212537, "answer_id": 44277351, "question_id": 44277222, "link": "https://stackoverflow.com/questions/44277222/golang-regular-expression-for-parsing-key-value-pair-into-a-string-map/44277351#44277351", "title": "Golang regular expression for parsing key value pair into a string map", "body": "<p>Instead of writing regex of your own, you could simply use the <a href=\"https://godoc.org/github.com/kr/logfmt\" rel=\"nofollow noreferrer\"><code>github.com/kr/logfmt</code> package</a>.</p>\n\n<blockquote>\n  <p>Package implements the decoding of logfmt key-value pairs. </p>\n  \n  <p>Example logfmt message: </p>\n\n<pre><code>foo=bar a=14 baz=\"hello kitty\" cool%story=bro f %^asdf\n</code></pre>\n  \n  <p>Example result in JSON: </p>\n\n<pre><code>{ \n    \"foo\": \"bar\", \n    \"a\": 14, \n    \"baz\": \"hello kitty\", \n    \"cool%story\": \"bro\", \n    \"f\": true, \n    \"%^asdf\": true \n}\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 2854211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YetLB.jpg?s=128&g=1", "display_name": "tivio", "link": "https://stackoverflow.com/users/2854211/tivio"}, "is_accepted": false, "score": 1, "last_activity_date": 1497006357, "last_edit_date": 1497006357, "creation_date": 1496217286, "answer_id": 44278850, "question_id": 44277222, "link": "https://stackoverflow.com/questions/44277222/golang-regular-expression-for-parsing-key-value-pair-into-a-string-map/44278850#44278850", "title": "Golang regular expression for parsing key value pair into a string map", "body": "<p>Use named capturing groups in your regular expression and the FindStringSubmatch and SubexpNames functions. E.g.:</p>\n\n<pre><code>s := `time=\"2017-05-30T19:02:08-05:00\" level=info msg=\"some log message\" app=sample size=10`\nre := regexp.MustCompile(`time=\"(?P&lt;time&gt;.*?)\"\\slevel=(?P&lt;level&gt;.*?)\\s`)\nvalues := re.FindStringSubmatch(s)\nkeys := re.SubexpNames()\n\n// create map\nd := make(map[string]string)\nfor i := 1; i &lt; len(keys); i++ {\n    d[keys[i]] = values[i]\n}\nfmt.Println(d)\n// OUTPUT: map[time:2017-05-30T19:02:08-05:00 level:info]\n</code></pre>\n\n<p><code>values</code> is a list containing all submatches. The first submatch is the whole expression that matches the regexp, followed by a submatch for each capturing group.</p>\n\n<p>You can wrap the code into a function if you need this more frequently (i.e. if you need something like pythons <code>match.groupdict</code>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc groupmap(s string, r *regexp.Regexp) map[string]string {\n    values := r.FindStringSubmatch(s)\n    keys := r.SubexpNames()\n\n    // create map\n    d := make(map[string]string)\n    for i := 1; i &lt; len(keys); i++ {\n        d[keys[i]] = values[i]\n    }\n\n    return d\n}\n\nfunc main() {\n    s := `time=\"2017-05-30T19:02:08-05:00\" level=info msg=\"some log message\" app=sample size=10`\n    re := regexp.MustCompile(`time=\"(?P&lt;time&gt;.*?)\"\\slevel=(?P&lt;level&gt;.*?)\\s`)\n\n    fmt.Println(groupmap(s, re))\n    // OUTPUT: map[time:2017-05-30T19:02:08-05:00 level:info]\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 321, "user_id": 1084228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb477c044c3923fe1d965613ee328b6?s=128&d=identicon&r=PG", "display_name": "Xeaz", "link": "https://stackoverflow.com/users/1084228/xeaz"}, "edited": false, "score": 0, "creation_date": 1496279523, "post_id": 44282136, "comment_id": 75599929, "body": "This is what I ended up using but @kennytm &#39;s solution is just as good provided you&#39;re fine with taking an additional dependency."}], "tags": [], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "is_accepted": true, "score": 5, "last_activity_date": 1496226103, "creation_date": 1496226103, "answer_id": 44282136, "question_id": 44277222, "link": "https://stackoverflow.com/questions/44277222/golang-regular-expression-for-parsing-key-value-pair-into-a-string-map/44282136#44282136", "title": "Golang regular expression for parsing key value pair into a string map", "body": "<p>This is not using regex but is just an example of how to achieve the same by using <a href=\"https://golang.org/pkg/strings/#FieldsFunc\" rel=\"noreferrer\">strings.FieldsFunc</a>.</p>\n\n<p><a href=\"https://play.golang.org/p/rr6U8xTJZT\" rel=\"noreferrer\">https://play.golang.org/p/rr6U8xTJZT</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"unicode\"\n)\n\nconst foo = `time=\"2017-05-30T19:02:08-05:00\" level=info msg=\"some log message\" app=sample size=10`\n\nfunc main() {\n    lastQuote := rune(0)\n    f := func(c rune) bool {\n        switch {\n        case c == lastQuote:\n            lastQuote = rune(0)\n            return false\n        case lastQuote != rune(0):\n            return false\n        case unicode.In(c, unicode.Quotation_Mark):\n            lastQuote = c\n            return false\n        default:\n            return unicode.IsSpace(c)\n\n        }\n    }\n\n    // splitting string by space but considering quoted section\n    items := strings.FieldsFunc(foo, f)\n\n    // create and fill the map\n    m := make(map[string]string)\n    for _, item := range items {\n        x := strings.Split(item, \"=\")\n        m[x[0]] = x[1]\n    }\n\n    // print the map\n    for k, v := range m {\n        fmt.Printf(\"%s: %s\\n\", k, v)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 1084228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb477c044c3923fe1d965613ee328b6?s=128&d=identicon&r=PG", "display_name": "Xeaz", "link": "https://stackoverflow.com/users/1084228/xeaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5318, "favorite_count": 1, "accepted_answer_id": 44282136, "answer_count": 3, "score": 2, "last_activity_date": 1497006357, "creation_date": 1496212035, "question_id": 44277222, "link": "https://stackoverflow.com/questions/44277222/golang-regular-expression-for-parsing-key-value-pair-into-a-string-map", "title": "Golang regular expression for parsing key value pair into a string map", "body": "<p>I'm looking to parse the following string into a <code>map[string]string</code> using a regular expression:</p>\n\n<pre><code>time=\"2017-05-30T19:02:08-05:00\" level=info msg=\"some log message\" app=sample size=10\n</code></pre>\n\n<p>I'm trying to create a map that would have</p>\n\n<pre><code>m[\"time\"] = \"2017-05-30T19:02:08-05:00\"\nm[\"level\"] = \"info\"\n</code></pre>\n\n<p>etc</p>\n\n<p>I have tried using <code>regex.FindAllStringIndex</code> but can't quite come up with an appropriate regex? Is this the correct way to go?</p>\n"}, {"tags": ["html", "go", "angular2-forms"], "comments": [{"owner": {"reputation": 10834, "user_id": 1278987, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ebccaa3ee07a3fd6e76a5ec86965950?s=128&d=identicon&r=PG", "display_name": "David R", "link": "https://stackoverflow.com/users/1278987/david-r"}, "edited": false, "score": 0, "creation_date": 1496210937, "post_id": 44276831, "comment_id": 75560939, "body": "What is the issue?"}, {"owner": {"reputation": 1, "user_id": 7769012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ab8bca76d465c2cc222a578aa6e6b3?s=128&d=identicon&r=PG&f=1", "display_name": "Vadim Korobka", "link": "https://stackoverflow.com/users/7769012/vadim-korobka"}, "reply_to_user": {"reputation": 10834, "user_id": 1278987, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ebccaa3ee07a3fd6e76a5ec86965950?s=128&d=identicon&r=PG", "display_name": "David R", "link": "https://stackoverflow.com/users/1278987/david-r"}, "edited": false, "score": 0, "creation_date": 1496211250, "post_id": 44276831, "comment_id": 75561060, "body": "Don`t upload text and image."}, {"owner": {"reputation": 1, "user_id": 7769012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ab8bca76d465c2cc222a578aa6e6b3?s=128&d=identicon&r=PG&f=1", "display_name": "Vadim Korobka", "link": "https://stackoverflow.com/users/7769012/vadim-korobka"}, "reply_to_user": {"reputation": 10834, "user_id": 1278987, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ebccaa3ee07a3fd6e76a5ec86965950?s=128&d=identicon&r=PG", "display_name": "David R", "link": "https://stackoverflow.com/users/1278987/david-r"}, "edited": false, "score": 0, "creation_date": 1496211316, "post_id": 44276831, "comment_id": 75561106, "body": "I`m Junior)) Plese more deteils."}, {"owner": {"reputation": 10834, "user_id": 1278987, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ebccaa3ee07a3fd6e76a5ec86965950?s=128&d=identicon&r=PG", "display_name": "David R", "link": "https://stackoverflow.com/users/1278987/david-r"}, "edited": false, "score": 0, "creation_date": 1496211566, "post_id": 44276831, "comment_id": 75561248, "body": "I guess you are missing <code>enctype=multipart&#47;form-data</code> in your <code>&lt;form&gt;</code> tag"}], "owner": {"reputation": 1, "user_id": 7769012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ab8bca76d465c2cc222a578aa6e6b3?s=128&d=identicon&r=PG&f=1", "display_name": "Vadim Korobka", "link": "https://stackoverflow.com/users/7769012/vadim-korobka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496210566, "creation_date": 1496210566, "question_id": 44276831, "link": "https://stackoverflow.com/questions/44276831/post-http-angular-2", "title": "POST HTTP Angular 2", "body": "<p>I have problem with POST. I wanna upload text and image on Golang Server. \nThis repository of project: <a href=\"https://github.com/KorobkaVadim/Family-Tree\" rel=\"nofollow noreferrer\">https://github.com/KorobkaVadim/Family-Tree</a>\nThis form <a href=\"https://github.com/KorobkaVadim/Family-Tree/tree/master/Angular/app/todo-form\" rel=\"nofollow noreferrer\">https://github.com/KorobkaVadim/Family-Tree/tree/master/Angular/app/todo-form</a></p>\n"}, {"tags": ["go", "path"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 4, "creation_date": 1496208031, "post_id": 44275403, "comment_id": 75559659, "body": "<code>os.Getwd</code> returns a rooted path name corresponding to the current directory at runtime. It does no matter with the source path which only work in compile-time. Maybe tell us what problem you need resolving."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1496209713, "post_id": 44275403, "comment_id": 75560316, "body": "See <a href=\"https://stackoverflow.com/questions/32163425/golang-how-to-get-the-directory-of-the-package-the-file-is-in-not-the-current-w\" title=\"golang how to get the directory of the package the file is in not the current w\">stackoverflow.com/questions/32163425/&hellip;</a>."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1496215644, "post_id": 44275403, "comment_id": 75563638, "body": "@JiangYD &quot;Maybe tell us what problem you need resolving&quot;, basically I create some application which contains sub applications inside which have different package each other. If I can get the name of the subfolder, it&#39;ll make me easier to maintain the routes"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1496215712, "post_id": 44275403, "comment_id": 75563679, "body": "@JiangYD nevermind, david answer solve my problem"}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 10, "last_activity_date": 1496209903, "creation_date": 1496209903, "answer_id": 44276686, "question_id": 44275403, "link": "https://stackoverflow.com/questions/44275403/how-to-get-path-of-imported-package/44276686#44276686", "title": "How to get path of imported package", "body": "<p>If you can get a reference to something in the package, you can use reflect to get the import path.</p>\n\n<p>Here's an example on <a href=\"https://play.golang.org/p/Ug3RkqLtBT\" rel=\"noreferrer\">Play</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    var b bytes.Buffer\n    fmt.Println(reflect.TypeOf(b).PkgPath())\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 9122077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a349c1f476414fea4904cb3392299?s=128&d=identicon&r=PG&f=1", "display_name": "iman tung", "link": "https://stackoverflow.com/users/9122077/iman-tung"}, "is_accepted": false, "score": 2, "last_activity_date": 1585130640, "last_edit_date": 1585130640, "creation_date": 1585129213, "answer_id": 60846213, "question_id": 44275403, "link": "https://stackoverflow.com/questions/44275403/how-to-get-path-of-imported-package/60846213#60846213", "title": "How to get path of imported package", "body": "<p><code>PkgPath()</code> only can retrieve the package path for non-pointer</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// If the type was predeclared (string, error) or not defined (*T, struct{},\n// []int, or A where A is an alias for a non-defined type), the package path\n// will be the empty string.\nfunc packageName(v interface{}) string {\n    if v == nil {\n        return \"\"\n    }\n\n    val := reflect.ValueOf(v)\n    if val.Kind() == reflect.Ptr {\n        return val.Elem().Type().PkgPath()\n    }\n    return val.Type().PkgPath()\n}\n</code></pre>\n"}], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4517, "favorite_count": 4, "accepted_answer_id": 44276686, "answer_count": 2, "score": 2, "last_activity_date": 1585130640, "creation_date": 1496203303, "last_edit_date": 1592644375, "question_id": 44275403, "link": "https://stackoverflow.com/questions/44275403/how-to-get-path-of-imported-package", "title": "How to get path of imported package", "body": "<p>I'm having difficulty when trying to get path of imported package. When I print result of <code>os.Getwd()</code> inside imported package, it's showing same path like on <code>main</code> package.</p>\n<p>This what I did.</p>\n<h3>Project structure</h3>\n<p><a href=\"https://i.stack.imgur.com/t5WoU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t5WoU.png\" alt=\"enter image description here\" /></a></p>\n<h3>lib/lib.go</h3>\n<pre><code>package lib\n\nimport &quot;os&quot;\nimport &quot;fmt&quot;\n\nfunc init() {\n    dir, _ := os.Getwd()\n    fmt.Println(&quot;lib.init() :&quot;, dir)\n}\n\nfunc GetPath() {\n    dir, _ := os.Getwd()\n    fmt.Println(&quot;lib.GetPath() :&quot;, dir)\n}\n</code></pre>\n<h3>main.go</h3>\n<pre><code>package main\n\nimport &quot;os&quot;\nimport &quot;fmt&quot;\nimport &quot;test-import/lib&quot;\n\nfunc main() {\n    dir, _ := os.Getwd()\n    fmt.Println(&quot;main :&quot;, dir)\n    lib.GetPath()\n}\n</code></pre>\n<h3>Result</h3>\n<pre><code>lib.init() : /Users/novalagung/Documents/go/src/test-import\nmain : /Users/novalagung/Documents/go/src/test-import\nlib.GetPath() : /Users/novalagung/Documents/go/src/test-import\n</code></pre>\n<p>The result of <code>os.Getwd()</code> from <code>lib/lib.go</code> is still same path like on main. What I want is the real path of the package which is <code>/Users/novalagung/Documents/go/src/test-import/lib/</code></p>\n<p>What should I do? Is it possible?</p>\n"}, {"tags": ["c", "go", "openssl", "blowfish"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1496194382, "post_id": 44274221, "comment_id": 75556165, "body": "Interesting.  Try PHP for a tie-breaker  :)  .  I&#39;ve used one C++ blowfish source (Jim Conger&#39;s) that used a different byte order in its output than everyone else&#39;s, but that isn&#39;t the issue here."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1496194612, "post_id": 44274221, "comment_id": 75556226, "body": "You should probably find some <a href=\"https://www.google.com/search?q=blowfish+test+vectors\" rel=\"nofollow noreferrer\">Blowfish test vectors</a> and see which (if any) arrives at the correct result."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1496211155, "post_id": 44274221, "comment_id": 75561024, "body": "According to the <a href=\"https://linux.die.net/man/3/bf_encrypt\" rel=\"nofollow noreferrer\"><code>BF_encrypt</code> man page</a>: <i>&quot;BF_encrypt() and BF_decrypt() are the lowest level functions for Blowfish encryption. They encrypt/decrypt the first 64 bits of the vector pointed by data, using the key key. These functions should not be used unless you implement &#39;modes&#39; of Blowfish. The alternative is to use BF_ecb_encrypt(). If you still want to use these functions, you should be aware that they take each 32-bit chunk in host-byte order, which is little-endian on little-endian platforms and big-endian on big-endian ones&quot;</i>."}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 3, "last_activity_date": 1496211174, "creation_date": 1496211174, "answer_id": 44276988, "question_id": 44274221, "link": "https://stackoverflow.com/questions/44274221/blowfish-results-are-different-between-openssl-and-golang/44276988#44276988", "title": "Blowfish results are different between OpenSSL and Golang", "body": "<p>The problem is in the endianness of variable <code>data</code> and <code>encrypted</code>. In the C code, <code>data</code> (8-bytes) is converted from byte array to <code>unsigned int</code>(32-bit little-endian), then being encrypted in place. It affects the endianness of both input and encrypted result. To get same result in Golang, you must perform endian conversion, e.g.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n\n    \"encoding/binary\"\n\n    \"golang.org/x/crypto/blowfish\"\n)\n\nfunc convertEndian(in []byte) ([]byte, error) {\n    //Read byte array as uint32 (little-endian)\n    var v1, v2 uint32\n    buf := bytes.NewReader(in)\n    if err := binary.Read(buf, binary.LittleEndian, &amp;v1); err != nil {\n        return nil, err\n    }\n    if err := binary.Read(buf, binary.LittleEndian, &amp;v2); err != nil {\n        return nil, err\n    }\n\n    //convert uint32 to byte array\n    out := make([]byte, 8)\n    binary.BigEndian.PutUint32(out, v1)\n    binary.BigEndian.PutUint32(out[4:], v2)\n\n    return out, nil\n}\n\nfunc main() {\n    key := []byte{0xc9, 0x04, 0xa7, 0xa8, 0x5b, 0xbd, 0x97, 0x53, 0x24, 0xc5, 0x08, 0x3e, 0xd9, 0x6f, 0xf0, 0x22, 0xf2, 0x5e, 0x06, 0x2d, 0xa1, 0xd5, 0x75, 0xb2, 0x46, 0x2c, 0x2c, 0x98, 0xd8, 0xd6, 0x4d, 0x9d}\n    data := []byte{0x53, 0x8b, 0x77, 0x59, 0x83, 0x4d, 0x34, 0x18}\n\n    //Add: This is equal to: (unsigned int *)data in C\n    cdata, _ := convertEndian(data)\n\n    cipher, err := blowfish.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"key: %x\\n\", key)\n    fmt.Printf(\"data: %x\\n\", cdata)\n\n    encrypted := make([]byte, 8)\n    cipher.Encrypt(encrypted, cdata)\n    fmt.Printf(\"encrypted-1: %x\\n\", encrypted)\n\n    //Add: This is equal to {uint32, uint32} --&gt; byte array\n    ce, _ := convertEndian(encrypted)\n    fmt.Printf(\"encrypted-2: %02x\\n\", ce)\n}\n</code></pre>\n"}], "owner": {"reputation": 11891, "user_id": 1930219, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5ae618e4950c81bf0d83d17c2c2ddaab?s=128&d=identicon&r=PG", "display_name": "Alex Netkachov", "link": "https://stackoverflow.com/users/1930219/alex-netkachov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 44276988, "answer_count": 1, "score": 1, "last_activity_date": 1496211174, "creation_date": 1496193876, "last_edit_date": 1496196024, "question_id": 44274221, "link": "https://stackoverflow.com/questions/44274221/blowfish-results-are-different-between-openssl-and-golang", "title": "Blowfish results are different between OpenSSL and Golang", "body": "<p>I want to read VIM encoded files in Go. <a href=\"https://gist.github.com/grafi-tt/94015cc8c8f656420fb019a9c1e22f0f\" rel=\"nofollow noreferrer\">This code</a> works good enough for small file so I've decided to convert it to Go. Key generation works fine, but Blowfish encoding does not. I've traced the problem to different outcome from BF_encrypt and cipher.Encrypt(...).</p>\n\n<p><em>Input</em></p>\n\n<pre><code>key: c904a7a85bbd975324c5083ed96ff022f25e062da1d575b2462c2c98d8d64d9d\ndata: 538b7759834d3418\n</code></pre>\n\n<p><em>Output</em></p>\n\n<pre><code>Golang: b5cf33144acbc794\nC:      90baa70ec3e44867\n</code></pre>\n\n<p>Golang code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/crypto/blowfish\"\n)\n\nfunc main() {\n    key := []byte{0xc9, 0x04, 0xa7, 0xa8, 0x5b, 0xbd, 0x97, 0x53, 0x24, 0xc5, 0x08, 0x3e, 0xd9, 0x6f, 0xf0, 0x22, 0xf2, 0x5e, 0x06, 0x2d, 0xa1, 0xd5, 0x75, 0xb2, 0x46, 0x2c, 0x2c, 0x98, 0xd8, 0xd6, 0x4d, 0x9d}\n    data := []byte{0x53, 0x8b, 0x77, 0x59, 0x83, 0x4d, 0x34, 0x18}\n\n    cipher, err := blowfish.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"key: %x\\n\", key)\n    fmt.Printf(\"data: %x\\n\", data)\n\n    encrypted := make([]byte, 8)\n    cipher.Encrypt(encrypted, data)\n    fmt.Printf(\"encrypted: %x\\n\", encrypted)\n}\n</code></pre>\n\n<p>C code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;openssl/blowfish.h&gt;\n#include &lt;openssl/sha.h&gt;\n\n/*\nclang test1.c -o test1 \\\n-I/usr/local/Cellar/openssl/1.0.2k/include \\\n-L/usr/local/Cellar/openssl/1.0.2k/lib \\\n-lcrypto\n./test1\n*/\n\nint main(int argc, char *argv[]) {\n    unsigned char key[32] = {0xc9, 0x04, 0xa7, 0xa8, 0x5b, 0xbd, 0x97, 0x53, 0x24, 0xc5, 0x08, 0x3e, 0xd9, 0x6f, 0xf0, 0x22, 0xf2, 0x5e, 0x06, 0x2d, 0xa1, 0xd5, 0x75, 0xb2, 0x46, 0x2c, 0x2c, 0x98, 0xd8, 0xd6, 0x4d, 0x9d};\n    unsigned char data[8] = {0x53, 0x8b, 0x77, 0x59, 0x83, 0x4d, 0x34, 0x18};\n\n    BF_KEY bf_key;\n    BF_set_key(&amp;bf_key, 32, key);\n\n    printf(\"key: \");\n    for (int j = 0; j &lt; 32; j++) printf(\"%02x\", key[j]);\n    printf(\"\\n\");\n    printf(\"data: \");\n    for (int j = 0; j &lt; 8; j++) printf(\"%02x\", data[j]);\n    printf(\"\\n\");\n\n    BF_encrypt((unsigned int*)data, &amp;bf_key);\n\n    printf(\"encrypted: \");\n    for (int j = 0; j &lt; 8; j++) printf(\"%02x\", data[j]);\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Can you see where the problem is?</p>\n"}, {"tags": ["python-3.x", "go", "concurrency", "python-asyncio", "coroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1496184049, "post_id": 44272954, "comment_id": 75553809, "body": "&quot;any CPU-bound task is routed to its own thread&quot; that&#39;s not how goroutines work, so I&#39;m not sure what to make of that part of the question."}, {"owner": {"reputation": 40406, "user_id": 336527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a57f523157ebdf6e5a9662d2e8754b9?s=128&d=identicon&r=PG", "display_name": "max", "link": "https://stackoverflow.com/users/336527/max"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496184289, "post_id": 44272954, "comment_id": 75553873, "body": "I thought go runtime dynamically changes the number of threads to ensure that goroutines don&#39;t block each other. Since an event loop can already deal with I/O-bound tasks without blocking, but cannot handle CPU-bound tasks, I concluded that an equivalent treatment would be to put CPU-bound tasks in their own threads. Perhaps I should have said &quot;routed to a thread pool&quot; instead of &quot;routed to its own thread&quot;? I edited the question to say that."}], "answers": [{"tags": [], "owner": {"reputation": 40406, "user_id": 336527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a57f523157ebdf6e5a9662d2e8754b9?s=128&d=identicon&r=PG", "display_name": "max", "link": "https://stackoverflow.com/users/336527/max"}, "is_accepted": false, "score": 10, "last_activity_date": 1496289355, "last_edit_date": 1496289355, "creation_date": 1496289050, "answer_id": 44298225, "question_id": 44272954, "link": "https://stackoverflow.com/questions/44272954/goroutines-vs-asyncio-tasks-thread-pool-for-cpu-bound-calls/44298225#44298225", "title": "Goroutines vs asyncio tasks + thread pool for CPU-bound calls", "body": "<p>I think I know part of the answer. I tried to summarize my understanding of the differences, in order of importance, between <code>asyncio</code> tasks and goroutines:</p>\n\n<p>1) Unlike under <code>asyncio</code>, one rarely needs to worry that their goroutine will block for too long. OTOH, memory sharing across goroutines is akin to memory sharing across threads rather than <code>asyncio</code> tasks since goroutine execution order guarantees are much weaker (even if the hardware has only a single core).</p>\n\n<p><code>asyncio</code> will only switch context on explicit <code>await</code>, <code>yield</code> and certain event loop methods, while Go runtime may switch on far more subtle triggers (such as certain function calls). So <code>asyncio</code> is perfectly cooperative, while goroutines are only mostly cooperative (and the roadmap suggests they will become even less cooperative over time). </p>\n\n<p>A really tight loop (such as with numeric computation) could still block Go runtime (well, the thread it's running on). If it happens, it's going to have less of an impact than in python - unless it occurs in mutliple threads.</p>\n\n<p>2) Goroutines are have off-the-shelf support for parallel computation, which would require a more sophisticated approach under <code>asyncio</code>.</p>\n\n<p>Go runtime can run threads in parallel (if multiple cores are available), and so it's somewhat similar to running multiple <code>asyncio</code> event loops in a thread pool under a GIL-less python runtime, with a language-aware load balancer in front.</p>\n\n<p>3) Go runtime will automatically handle blocking syscalls in a separate thread; this needs to be done explicitly under <code>asyncio</code> (e.g., using  <code>run_in_executor</code>).</p>\n\n<p>That said, in terms of memory cost, goroutines are very much like <code>asyncio</code> tasks rather than threads.</p>\n"}, {"comments": [{"owner": {"reputation": 40406, "user_id": 336527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a57f523157ebdf6e5a9662d2e8754b9?s=128&d=identicon&r=PG", "display_name": "max", "link": "https://stackoverflow.com/users/336527/max"}, "edited": false, "score": 0, "creation_date": 1496289574, "post_id": 44298289, "comment_id": 75602246, "body": "Thx! Does my self-answer have any significant misunderstandings?   And yes, in python you either need to use an asynchronous IO library, or if it&#39;s not available, you need to explicitly send the IO operations to a thread pool (this can be streamlined by getting back a future so that it doesn&#39;t break the asynchronous code style). A naive call to synchronous blocking IO would hang the event loop."}, {"owner": {"reputation": 251, "user_id": 2774002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ntpn9.gif?s=128&g=1", "display_name": "Ian Lance Taylor", "link": "https://stackoverflow.com/users/2774002/ian-lance-taylor"}, "reply_to_user": {"reputation": 40406, "user_id": 336527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a57f523157ebdf6e5a9662d2e8754b9?s=128&d=identicon&r=PG", "display_name": "max", "link": "https://stackoverflow.com/users/336527/max"}, "edited": false, "score": 0, "creation_date": 1496378806, "post_id": 44298289, "comment_id": 75646984, "body": "It&#39;s true that the Go runtime spins up new threads as needed.  I&#39;m not sure quite what to say when comparing goroutines with async I/O functions.  They are really different, so when you say that the two approaches are equivalent, I would say that that is only true under a very loose interpretation."}, {"owner": {"reputation": 5523, "user_id": 2594812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc8f4767c6d139bb824167fa04b992e0?s=128&d=identicon&r=PG", "display_name": "Sam Hartman", "link": "https://stackoverflow.com/users/2594812/sam-hartman"}, "edited": false, "score": 0, "creation_date": 1496417540, "post_id": 44298289, "comment_id": 75668958, "body": "No, in python asyncio you can do something like <code>await stream_reader.read(num_bytes)</code> which really isn&#39;t very different from <code>file.read(num_bytes</code> in the blocking world"}], "tags": [], "owner": {"reputation": 251, "user_id": 2774002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ntpn9.gif?s=128&g=1", "display_name": "Ian Lance Taylor", "link": "https://stackoverflow.com/users/2774002/ian-lance-taylor"}, "is_accepted": false, "score": 1, "last_activity_date": 1496289403, "creation_date": 1496289403, "answer_id": 44298289, "question_id": 44272954, "link": "https://stackoverflow.com/questions/44272954/goroutines-vs-asyncio-tasks-thread-pool-for-cpu-bound-calls/44298289#44298289", "title": "Goroutines vs asyncio tasks + thread pool for CPU-bound calls", "body": "<p>I suppose you could think of it working that way underneath, sure.  It's not really accurate, but, close enough.</p>\n\n<p>But there is a big difference: in Go you can write straight line code, and all the I/O blocking is handled for you automatically.  You can call Read, then Write, then Read, in simple straight line code.  With Python asyncio, as I understand it, you need to queue up a function to handle the reads, rather than just calling Read.</p>\n"}], "owner": {"reputation": 40406, "user_id": 336527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a57f523157ebdf6e5a9662d2e8754b9?s=128&d=identicon&r=PG", "display_name": "max", "link": "https://stackoverflow.com/users/336527/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2247, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1496289403, "creation_date": 1496183673, "last_edit_date": 1496184329, "question_id": 44272954, "link": "https://stackoverflow.com/questions/44272954/goroutines-vs-asyncio-tasks-thread-pool-for-cpu-bound-calls", "title": "Goroutines vs asyncio tasks + thread pool for CPU-bound calls", "body": "<p>Are goroutines roughly equivalent to python's <code>asyncio</code> tasks, with an additional feature that any CPU-bound task is routed to a <code>ThreadPoolExecutor</code> instead of being added to the event loop (of course, with the assumption that we use a python interpreter without GIL)?</p>\n\n<p>Is there any substantial difference between the two approaches that I'm missing? Of course, apart from the efficiencies and code clarity that result from the concurrency being an integral part of Go.</p>\n"}, {"tags": ["go", "ssh"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "edited": false, "score": 0, "creation_date": 1496178166, "post_id": 44271230, "comment_id": 75551724, "body": "If possible could you tell me how to do any/each of those ? I am very new to golang and network programming and I&#39;d appreciate any help. Thank YOU"}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 2, "last_activity_date": 1496175592, "creation_date": 1496175592, "answer_id": 44271230, "question_id": 44271041, "link": "https://stackoverflow.com/questions/44271041/golang-no-common-algorithm-for-key-exchange-error/44271230#44271230", "title": "GoLang : &quot;No common algorithm for key exchange&quot; error", "body": "<p>Well, like the error says, the client and the server don't have any algorithms they're willing to agree on, so they can't talk. The six that Go is offering are all the ones it supports (out of the 12 that openssh does); the server is only offering <em>one</em> that isn't any of those. Your options:</p>\n\n<ol>\n<li>Convince the server to accept more KEX algorithms; it's possible that it supports more, and someone just configured it super restrictively.</li>\n<li>Implement <a href=\"https://www.ietf.org/rfc/rfc4419.txt\" rel=\"nofollow noreferrer\">DH Group Exchange</a> for x/crypto/ssh yourself, and send the patch upstream.</li>\n<li>Find a different client.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 11864483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4921c64cb23557e2bd2540bbc6e829?s=128&d=identicon&r=PG&f=1", "display_name": "happygopher", "link": "https://stackoverflow.com/users/11864483/happygopher"}, "is_accepted": false, "score": 0, "last_activity_date": 1571661065, "creation_date": 1571661065, "answer_id": 58486380, "question_id": 44271041, "link": "https://stackoverflow.com/questions/44271041/golang-no-common-algorithm-for-key-exchange-error/58486380#58486380", "title": "GoLang : &quot;No common algorithm for key exchange&quot; error", "body": "<p>take a look at this <a href=\"https://stackoverflow.com/questions/58459755/error-while-trying-to-connect-via-ssh-to-remote-host/58461799#58461799\">question</a></p>\n\n<p>I'm still working on that but <a href=\"https://stackoverflow.com/a/58460545/1256452\">VonC</a> put some interesting tips in order to resolve it.</p>\n\n<p>hope it helps.</p>\n"}], "owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1571661065, "creation_date": 1496174942, "question_id": 44271041, "link": "https://stackoverflow.com/questions/44271041/golang-no-common-algorithm-for-key-exchange-error", "title": "GoLang : &quot;No common algorithm for key exchange&quot; error", "body": "<p>I am new to GoLang and I am trying to connect to a remote server using go. But I keep getting the following error</p>\n\n<pre><code>Failed to dial: ssh: handshake failed: ssh: no common algorithm for key exchange; client offered: [curve2****-sh****@libssh.org ****-sha*-nis****ecdh-sha2-nistp384 ecdh-sha2-nistp**** diffie-hellman-group14-sha1 diffie-hellman-group1-sha1], server offered: [diffie-hellman-group-exchange-sha***]\n</code></pre>\n\n<p>below is the config that I use to connect</p>\n\n<pre><code> config := &amp;ssh.ClientConfig{\n\n    User: user,\n\n    HostKeyCallback: nil,\n\n    Auth: []ssh.AuthMethod{\n\n    publicKey,\n    },\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496175122, "post_id": 44270803, "comment_id": 75550189, "body": "Parsing the output for some sequence that indicates it&#39;s the user&#39;s turn to provide input seems like the more &quot;correct&quot; approach - operating based on timeout is also fragile, in that it a) means your program can&#39;t operate faster than timeout; and b) may behave incorrectly when the program it&#39;s forking operates slower than expected."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1496175123, "post_id": 44270803, "comment_id": 75550190, "body": "Are you doing anything else after <code>loginCmd</code> exits? If not, you can just exit from your Go program instead of canceling the context and waiting for your goroutine to finish."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1496175732, "post_id": 44270803, "comment_id": 75550492, "body": "@AndySchweig unfortunately yes, this method is one small part of a larger function"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496176686, "post_id": 44270803, "comment_id": 75551001, "body": "You can&#39;t cancel a Read from Stdin, just leave the goroutine running and make sure it can&#39;t effect the program if it completes later on."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496177234, "post_id": 44270803, "comment_id": 75551271, "body": "@JimB what about if I opened up a <code>bufio.NewWriter(os.Stdin)</code> and wrote a newline character, would that technically unblock the read to stdin?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1496179682, "post_id": 44270803, "comment_id": 75552369, "body": "@sreya: no, because stdin is a tty. The only real way around this is to not use a Read directly, and use the syscall package to select (or equiv) on the fd and either poll or pair it with a pipe which you can use to signal an exit (i.e. the &quot;self-pipe trick&quot;). There generally no reason to go through the hassle, when you can just leave the goroutine and not worry about it."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496219903, "post_id": 44270803, "comment_id": 75566328, "body": "@JimB: Why don&#39;t you turn your comment into an answer?"}], "owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 803, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1496173971, "creation_date": 1496173971, "question_id": 44270803, "link": "https://stackoverflow.com/questions/44270803/is-there-a-good-way-to-cancel-a-blocking-read", "title": "Is there a good way to cancel a blocking read?", "body": "<p>I've got a command I have to run via the OS, let's call it 'login', that is interactive and therefore requires me to read from the stdin and pass it to the command's stdin pipe in order for it to work correctly. The only problem is the goroutine blocks on a read from stdin and I haven't been able to find a way to cancel a Reader in Go in order to get it to not hang on the blocking call. For example, from the perspective of the user, after the command looks as if it completed, you still have the opportunity to write to stdin once more (then the goroutine will move past the blocking read and exit)</p>\n\n<p>Ideally I would like to avoid having to parse output from the command's StdoutPipe as that makes my code frail and prone to error if the strings of the <code>login</code> command were to change.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>loginCmd := exec.Command(\"login\")\nstdin , err := loginCmd.StdinPipe()\nif err != nil {\n    return err\n}\n\nout, err := loginCmd.StdoutPipe()\n\nif err != nil {\n    return err\n}\n\nif err := loginCmd.Start(); err != nil {\n    return err\n}\n\nctx, cancel := context.WithCancel(context.TODO())\nvar done sync.WaitGroup\ndone.Add(1)\nready := make(chan bool, 1)\ndefer cancel()\ngo func(ctx context.Context) {\n    reader := bufio.NewReader(os.Stdin)\n    for {\n        select {\n        case &lt;- ctx.Done():\n            done.Done()\n            return\n        default:\n            //blocks on this line, if a close can unblock the read, then it should exit normally via the ctx.Done() case\n            line, err :=reader.ReadString('\\n')\n            if err != nil {\n                fmt.Println(\"Error: \", err.Error())\n            }\n            stdin.Write([]byte(line))\n        }\n    }\n}(ctx)\n\nvar bytesRead = 4096\noutput := make([]byte, bytesRead)\nreader := bufio.NewReader(out)\nfor err == nil {\n    bytesRead, err = reader.Read(output)\n    if err != nil &amp;&amp; err != io.EOF {\n        return err\n    }\n    fmt.Printf(\"%s\", output[:bytesRead])\n}\n\nif err := loginCmd.Wait(); err != nil {\n    return err\n}\ncancel()\ndone.Wait()\n</code></pre>\n"}, {"tags": ["go", "websocket"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496173452, "post_id": 44270234, "comment_id": 75549322, "body": "I don&#39;t see where you are using TCP connections directly anywhere in your code. You also have global maps with no synchronization, which will give you undefined results even when the program doesn&#39;t crash."}, {"owner": {"reputation": 280, "user_id": 2966577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b8553752d98c22d0dd653dad15765c?s=128&d=identicon&r=PG", "display_name": "peeyushsrj", "link": "https://stackoverflow.com/users/2966577/peeyushsrj"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496173859, "post_id": 44270234, "comment_id": 75549559, "body": "@JimB The web uses tcp sockets in default, to frame the question better I used to term TCP sockets. If neccesary, please do suggest edit. I am using mongodb database to sync them, at the init of the program and at the end of execution of <code>processHandler()</code> and it&#39;s working fine. Have a look <a href=\"http://peeyushsrj.me:8890/stats\" rel=\"nofollow noreferrer\">peeyushsrj.me:8890/stats</a> (without websockets)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496175126, "post_id": 44270234, "comment_id": 75550193, "body": "Your handlers are writing to the global ActiveRequestCount and reqLog maps, and you can&#39;t do that without synchronization. I don&#39;t know what you mean by synchronizing them in mongo, but that has nothing to do with your code having no way to prevent concurrent access in your handlers. The phrase &quot;trigger websocket connection&quot; is very vague; can you better describe what exactly the expected operations are supposed to be?"}, {"owner": {"reputation": 280, "user_id": 2966577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b8553752d98c22d0dd653dad15765c?s=128&d=identicon&r=PG", "display_name": "peeyushsrj", "link": "https://stackoverflow.com/users/2966577/peeyushsrj"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496175890, "post_id": 44270234, "comment_id": 75550591, "body": "@JimB I misunderstood <code>sync</code>, the code won&#39;t prevent concurrent access. Well, I expect the websocket message will be sent after updation of global variables, to the <code>&#47;stats</code> endpoint."}], "owner": {"reputation": 280, "user_id": 2966577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b8553752d98c22d0dd653dad15765c?s=128&d=identicon&r=PG", "display_name": "peeyushsrj", "link": "https://stackoverflow.com/users/2966577/peeyushsrj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496171820, "creation_date": 1496171820, "question_id": 44270234, "link": "https://stackoverflow.com/questions/44270234/trigger-a-websocket-connectionmutiple-times-from-tcp-connections", "title": "Trigger a websocket connection(mutiple times) from tcp connections", "body": "<p>I am trying to build an API Dashboard using websockets using golang. Due to lack of resources up there for Go or lack of my knowlege in websockets, I am posting here. </p>\n\n<p>I already build an api dashboard without websockets. Now I am trying to use websockets. \nMy question is more of conceptual one. <strong>How can I trigger websocket connection (multiple times) in between a tcp connection.</strong></p>\n\n<p><strong>In Detail:</strong> \nI have two endpoints for my API. <code>/process</code> for doing some computation. And <code>/stats</code> for showing result of those computations. \nI do understand that <code>/stats</code> should be client and <code>/process</code> as a server for websockets.</p>\n\n<p>Sincer Handler function for <code>/process</code> uses tcp sockets. And In between I have to send websocket messages to the client (in the begining &amp; end of computation). So how can this be achievable? </p>\n\n<p>Since, I can't conceptually do this. I am doing trial and error still no success. I guess I am missing some big chunk of information, so please do suggest some concepts or ideas to make it work. <em>(Programming language no barrier)</em></p>\n\n<p>For reference regarding those handler function for endpoints <a href=\"https://play.golang.org/p/EXNbj-v_Xq\" rel=\"nofollow noreferrer\">https://play.golang.org/p/EXNbj-v_Xq</a> </p>\n"}, {"tags": ["go", "ssh"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "edited": false, "score": 0, "creation_date": 1496169080, "post_id": 44269276, "comment_id": 75546922, "body": "Thank You for your answer. But upon doing that, I see the following error,      ssh: no common algorithm for key exchange; client offered: [xxxxxxxxxxx], server offered: [xxxxxxxx]"}, {"owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "reply_to_user": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "edited": false, "score": 0, "creation_date": 1496170647, "post_id": 44269276, "comment_id": 75547795, "body": "You may have to specify <code>KeyExchanges</code> documented here <a href=\"https://godoc.org/golang.org/x/crypto/ssh#Config\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/crypto/ssh#Config</a> the defaults it is using may not include any of the ones the server wants to use."}], "tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": true, "score": 18, "last_activity_date": 1496168401, "creation_date": 1496168401, "answer_id": 44269276, "question_id": 44269142, "link": "https://stackoverflow.com/questions/44269142/golang-ssh-getting-must-specify-hoskeycallback-error-despite-setting-it-to-n/44269276#44269276", "title": "GoLang ssh : Getting &quot;Must specify HosKeyCallback&quot; error despite setting it to nil", "body": "<p>The behavior of nil for HostKeyCallback was changed: <a href=\"https://github.com/golang/go/issues/19767\" rel=\"noreferrer\">https://github.com/golang/go/issues/19767</a></p>\n\n<p>If you want to allow any host:</p>\n\n<pre><code>HostKeyCallback: ssh.InsecureIgnoreHostKey()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 2, "last_activity_date": 1596829226, "creation_date": 1596829226, "answer_id": 63308243, "question_id": 44269142, "link": "https://stackoverflow.com/questions/44269142/golang-ssh-getting-must-specify-hoskeycallback-error-despite-setting-it-to-n/63308243#63308243", "title": "GoLang ssh : Getting &quot;Must specify HosKeyCallback&quot; error despite setting it to nil", "body": "<p>Please heed the warning that comes with <a href=\"https://github.com/golang/crypto/blob/master/ssh/client.go#L240\" rel=\"nofollow noreferrer\">ssh.InsecureIgnoreHostKey</a>:</p>\n<blockquote>\n<p>... It should not be used for production code.</p>\n</blockquote>\n<p>So instead, consider enforcing SSH-key verification. It's actually not that difficult to implement:</p>\n<pre><code>// create human-readable SSH-key strings\nfunc keyString(k ssh.PublicKey) string {\n    return k.Type() + &quot; &quot; + base64.StdEncoding.EncodeToString(k.Marshal()) // e.g. &quot;ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTY....&quot;\n}\n\n\nfunc trustedHostKeyCallback(trustedKey string) ssh.HostKeyCallback {\n\n    if trustedKey == &quot;&quot; {\n        return func(_ string, _ net.Addr, k ssh.PublicKey) error {\n            log.Printf(&quot;WARNING: SSH-key verification is *NOT* in effect: to fix, add this trustedKey: %q&quot;, keyString(k))\n            return nil\n        }\n    }\n\n    return func(_ string, _ net.Addr, k ssh.PublicKey) error {\n        ks := keyString(k)\n        if trustedKey != ks {\n            return fmt.Errorf(&quot;SSH-key verification: expected %q but got %q&quot;, trustedKey, ks)\n        }\n\n        return nil\n    }\n}\n</code></pre>\n<p>And to use:</p>\n<pre><code>// where `conf` is the main app config\nsc := &amp;ssh.ClientConfig{\n    User:            conf.Username,\n    Auth:            []ssh.AuthMethod{ssh.Password(conf.Password)},\n    HostKeyCallback: trustedHostKeyCallback(conf.HostKey), // &lt;- server-key goes here\n    Timeout:         conf.Timeout,\n}\n</code></pre>\n<p>if <code>conf.HostKey</code> is blank - it will still work - but will log a warning with the key-string to fill in to enable SSH-key verification.</p>\n"}], "owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8105, "favorite_count": 2, "accepted_answer_id": 44269276, "answer_count": 2, "score": 7, "last_activity_date": 1596829226, "creation_date": 1496167924, "question_id": 44269142, "link": "https://stackoverflow.com/questions/44269142/golang-ssh-getting-must-specify-hoskeycallback-error-despite-setting-it-to-n", "title": "GoLang ssh : Getting &quot;Must specify HosKeyCallback&quot; error despite setting it to nil", "body": "<p>I am trying to connect to a remote server using GoLang. In the client configuration, apart from user and password, I set HostKeyCallback to nil so that it accepts every host</p>\n\n<pre><code>config := &amp;ssh.ClientConfig{\n\n        User: user,\n\n        HostKeyCallback: nil,\n\n        Auth: []ssh.AuthMethod{\n\n        publicKey,\n    },\n}\n</code></pre>\n\n<p>But I keep getting this error. </p>\n\n<pre><code>Failed to dial: ssh: must specify HostKeyCallback\n</code></pre>\n\n<p>How do I solve this ?</p>\n"}, {"tags": ["email", "go", "smtp"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496158519, "post_id": 44265966, "comment_id": 75540980, "body": "See <a href=\"http://nemesis.lonestar.org/site/mail_trouble.html\" rel=\"nofollow noreferrer\">http://nemesis.lonestar.org/site/mail_trouble.html</a>."}, {"owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496171362, "post_id": 44265966, "comment_id": 75548164, "body": "Thank you very much for your help. I looked through the provided site. However, I don&#39;t think that this is that sort of problem. I can send mails to multiple users (by calling the Rcpt function multiple times) but I can&#39;t have a &quot;To&quot; string consisting of multiple addresses in the email header. I have to use a single email address eventhough I send to more than one recipient."}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 2, "creation_date": 1496179598, "post_id": 44265966, "comment_id": 75552332, "body": "That error comes from the MTA you&#39;re connecting to (the server you&#39;re specifying in <code>SMTPServer{&quot;host&quot;, &quot;port&quot;}</code>). Check your MTA&#39;s settings (e.g. IP limits, recipient limits, etc.) and/or <a href=\"https://duckduckgo.com/lite?q=%22550%20Administrative%20prohibition%22\" rel=\"nofollow noreferrer\">teh interwebz</a>. Either way, it doesn&#39;t look related to your Go code as such."}], "owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496157220, "creation_date": 1496157220, "question_id": 44265966, "link": "https://stackoverflow.com/questions/44265966/go-error-550-when-trying-to-set-multiple-recipients-in-smtp-header", "title": "Go: Error 550 when trying to set multiple recipients in SMTP header", "body": "<p>I'm currently trying to send emails using the go net/smtp package. Everything but one detail works fine. I can't set multiple recipients in the email header. The Quit command returns a \"550 Administrative prohibition\" error. Here is my code:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"net/smtp\"\n    \"strings\"\n)\n\ntype Mail struct {\n    from    string\n    to      []string\n    subject string\n    body    string\n}\n\ntype SMTPServer struct {\n    host string\n    port string\n}\n\nfunc (s *SMTPServer) serverName() string {\n    return s.host + \":\" + s.port\n}\n\nfunc (mail *Mail) buildMessage() string {\n    message := \"\"\n    message += fmt.Sprintf(\"From: %s\\r\\n\", mail.from)\n    if len(mail.to) &gt; 0 {\n        message += fmt.Sprintf(\"To: %s\\r\\n\", strings.Join(mail.to, \";\"))\n    }\n\n    message += fmt.Sprintf(\"Subject: %s\\r\\n\", mail.subject)\n    message += \"\\r\\n\" + mail.body\n\n    return message\n}\n\nfunc Send(mail Mail, server SMTPServer) (err error) {\n\n\n    // Connect to SMTP server\n    c, err := smtp.Dial(server.serverName())\n    if err != nil {\n        return\n    }\n\n    // Set the sender and recipients\n    if err = c.Mail(mail.from); err != nil {\n        return\n    }\n\n    for _, t := range mail.to {\n        if err = c.Rcpt(t); err != nil {\n            return\n        }\n    }\n\n    // Send the email body.\n    wc, err := c.Data()\n    if err != nil {\n        return\n    }\n\n    if _, err = wc.Write([]byte(mail.buildMessage())); err != nil {\n        return\n    }\n\n    if err = wc.Close(); err != nil {\n        return\n    }\n\n    if err = c.Quit(); err != nil {\n        fmt.Printf(\"%s\", err)\n        return\n    }\n\n    return nil\n\n}\n\n\nfunc main() {\n\n    mail := Mail{\"a@test.com\", []string {\"b@test.com\", \"c@test.com\"}, \"subject\", \"body\"}\n    server := SMTPServer{\"host\", \"port\"}\n\n    err := Send(mail, server)\n    fmt.Printf(\"%s\", err)\n\n\n}\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1496156805, "post_id": 44265752, "comment_id": 75539815, "body": "From the time documentation: <code>Do not use == with Time values</code>. You must use the Equal method"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1496158373, "post_id": 44265752, "comment_id": 75540898, "body": "The Location is stored as a pointer in the time struct, so you are comparing 2 different pointer values to Location structs which is why they&#39;re different. UTC just happens to be the default which uses a nil pointer value, and therefor are equal. This is an implementation detail, there&#39;s no reason to ever use the == with time values, and the behavior may change again with go1.9 which uses monotonic time."}, {"owner": {"reputation": 3220, "user_id": 102940, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e342eb049bb0f2d5a21ce2408c67dd25?s=128&d=identicon&r=PG", "display_name": "Soe Moe", "link": "https://stackoverflow.com/users/102940/soe-moe"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496160597, "post_id": 44265752, "comment_id": 75542276, "body": "@JimB thank you. Can u pls put it as answer so that I can accept?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1496172574, "post_id": 44265752, "comment_id": 75548794, "body": "Related / possible duplicate of <a href=\"https://stackoverflow.com/questions/36614921/why-do-2-time-structs-with-the-same-date-and-time-return-false-when-compared-wit/36615458#36615458\">Why do 2 time structs with the same date and time return false when compared with ==?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1496156818, "creation_date": 1496156818, "answer_id": 44265825, "question_id": 44265752, "link": "https://stackoverflow.com/questions/44265752/why-these-two-time-time-instances-are-same-for-utc-and-different-for-another-loc/44265825#44265825", "title": "Why these two time.Time instances are same for UTC and different for another location?", "body": "<p><code>LoadLocation</code> seems to return a pointer to a new value every time.</p>\n\n<p>Anyway, the <em>good</em> way to compare dates is <code>Equal</code>:</p>\n\n<pre><code>fmt.Println(dt2.Equal(dt))\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/9GW-LSF0wg\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9GW-LSF0wg</a>.</p>\n"}], "owner": {"reputation": 3220, "user_id": 102940, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e342eb049bb0f2d5a21ce2408c67dd25?s=128&d=identicon&r=PG", "display_name": "Soe Moe", "link": "https://stackoverflow.com/users/102940/soe-moe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1496172580, "creation_date": 1496156583, "last_edit_date": 1496157450, "question_id": 44265752, "link": "https://stackoverflow.com/questions/44265752/why-these-two-time-time-instances-are-same-for-utc-and-different-for-another-loc", "title": "Why these two time.Time instances are same for UTC and different for another location?", "body": "<p>I'm expecting these two <code>time.Time</code> instances are the same. But, I'm not sure why I got the compare result is false.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    t := int64(1497029400000)\n\n    locYangon, _ := time.LoadLocation(\"Asia/Yangon\")\n    dt := fromEpoch(t).In(locYangon)\n\n    locYangon2, _ := time.LoadLocation(\"Asia/Yangon\")\n    dt2 := fromEpoch(t).In(locYangon2)\n\n    fmt.Println(dt2 == dt)\n}\n\nfunc fromEpoch(jsDate int64) time.Time {\n    return time.Unix(0, jsDate*int64(time.Millisecond))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/EOrW8lWz73\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<p>If I change <code>\"Asia/Yangon\"</code> to <code>\"UTC\"</code>, they are the same.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    t := int64(1497029400000)\n\n    locYangon, _ := time.LoadLocation(\"UTC\")\n    dt := fromEpoch(t).In(locYangon)\n\n    locYangon2, _ := time.LoadLocation(\"UTC\")\n    dt2 := fromEpoch(t).In(locYangon2)\n\n    fmt.Println(dt2 == dt)\n\n}\n\nfunc fromEpoch(jsDate int64) time.Time {\n    return time.Unix(0, jsDate*int64(time.Millisecond))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Nn3MzmiXoH\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<p>Note:  I'm aware of <code>Equal</code> method (in fact, I fixed with <code>Equal</code> method.) But after more testing, I found some interesting case which is \"UTC\" location vs \"Asia/Yangon\" location. I'm expecting either both equal or both not equal.</p>\n\n<p><strong>Update</strong>: Add another code snippet with \"UTC\".\n<strong>Update2</strong>: Update title to be more precise (I hope it will help to avoid duplication)</p>\n"}, {"tags": ["go", "multipart"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496156296, "post_id": 44265546, "comment_id": 75539426, "body": "I don&#39;t think form data is the correct content type for arbitrary binary data. I believe it should be application/octet-stream. See <a href=\"https://stackoverflow.com/questions/14962592/whats-content-type-value-within-a-http-request-when-uploading-content\" title=\"whats content type value within a http request when uploading content\">stackoverflow.com/questions/14962592/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5984506, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eb918222a39da1751cd688c36dab8f41?s=128&d=identicon&r=PG", "display_name": "pseudonym", "link": "https://stackoverflow.com/users/5984506/pseudonym"}, "edited": false, "score": 0, "creation_date": 1496168502, "post_id": 44266223, "comment_id": 75546598, "body": "If I send a large file, will that be sent as a single HTTP request ?"}], "tags": [], "owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "is_accepted": false, "score": 1, "last_activity_date": 1496157931, "creation_date": 1496157931, "answer_id": 44266223, "question_id": 44265546, "link": "https://stackoverflow.com/questions/44265546/unable-to-send-data-in-chunks-to-server-in-golang/44266223#44266223", "title": "Unable to send data in chunks to server in Golang", "body": "<p>You are dividing buffer with the file into separate chunks and sending each of them as separate HTTP message. This is not how <code>multipart</code> is intended to be used.</p>\n\n<p><code>multipart</code> MIME means that a <em>single</em> HTTP message may contain one or more entities, quoting <a href=\"https://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.7.2\" rel=\"nofollow noreferrer\">HTTP RFC</a>:</p>\n\n<blockquote>\n  <p>MIME provides for a number of \"multipart\" types -- encapsulations of\n  one or more entities within a single message-body. All multipart types\n  share a common syntax, as defined in section 5.1.1 of RFC 2046</p>\n</blockquote>\n\n<p>You should send the whole file and send it in a single HTTP message (file contents should be a single entity). The HTTP protocol will take care of the rest but you may consider using FTP if the files you are planning to transfer are large (like <code>&gt; 2GB</code>). </p>\n"}, {"tags": [], "owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "is_accepted": false, "score": 0, "last_activity_date": 1496159430, "creation_date": 1496159430, "answer_id": 44266738, "question_id": 44265546, "link": "https://stackoverflow.com/questions/44265546/unable-to-send-data-in-chunks-to-server-in-golang/44266738#44266738", "title": "Unable to send data in chunks to server in Golang", "body": "<p>If you are using a multipart/form-data, then it is expected to take the entire file and send it up as a single byte stream.  Go can handle multi-gigabyte files easily this way.  But your code needs to be smart about this.</p>\n\n<ul>\n<li><code>ioutil.ReadAll(r.Body)</code> is out of the question unless you know for sure that the file will be very small.  Please don't do this.</li>\n<li><code>multipartReader, err := r.MultipartReader()</code> use a multipart reader.  This will iterate over uploading files, in the order they are included in the encoding.  This is important, because you can keep the file entirely out of memory, and do a <code>Copy</code> from one filehandle to another.  This is how large files are handled easily.</li>\n<li>You will have issues with middle-boxes and reverse proxies.  We have to change defaults in Nginx so that it will not cut off large files.  Nginx (or whatever reverse-proxy you might use) will need to cooperate, as they often are going to default to some really tiny file size max like 300MB.</li>\n<li>Even if you think you dealt with this issue on upload with some file part trick, you will then need to deal with large files on download.  Go can do single large files very efficiently by doing a <code>Copy</code> from filehandle to filehandle.  You will also end up needing to support partial content (http 206) and not modified (304) if you want great performance for downloading files that you uploaded.  Some browsers will ignore your pleas to not ask for partial content when things like large video is involved.  So, if you don't support this, then some content will fail to download.</li>\n</ul>\n\n<p>If you want to use some tricks to cut up files and send them in parts, then you will end up needing to use a particular Javascript library.  This is going to be quite harmful to interoperability if you are going for programmatic access from any client to your Go server.  But maybe you can't fix middle-boxes that impose size limits, and you really want to cut files up into chunks.  You will have a lot of work to handle downloading the files that you managed to upload in chunks.</p>\n"}, {"tags": [], "owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "is_accepted": false, "score": -1, "last_activity_date": 1496163265, "creation_date": 1496163265, "answer_id": 44267878, "question_id": 44265546, "link": "https://stackoverflow.com/questions/44265546/unable-to-send-data-in-chunks-to-server-in-golang/44267878#44267878", "title": "Unable to send data in chunks to server in Golang", "body": "<p>What you are trying to do is the typical code that is written with a tcp connection with most other languages, in GO you can use tcp too with net.Listen and eventually accept on the listener object. Then this should be fine.</p>\n"}], "owner": {"reputation": 31, "user_id": 5984506, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eb918222a39da1751cd688c36dab8f41?s=128&d=identicon&r=PG", "display_name": "pseudonym", "link": "https://stackoverflow.com/users/5984506/pseudonym"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1155, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1496163265, "creation_date": 1496155982, "question_id": 44265546, "link": "https://stackoverflow.com/questions/44265546/unable-to-send-data-in-chunks-to-server-in-golang", "title": "Unable to send data in chunks to server in Golang", "body": "<p>I'm completely new to Golang. I am trying to send a file from the client to the server. The client should split it into smaller chunks and send it to the rest end point exposed by the server. The server should combine those chunks and save it.</p>\n\n<p>This is the <a href=\"https://play.golang.org/p/5P2VTJR9AA\" rel=\"nofollow noreferrer\">client</a> and <a href=\"https://play.golang.org/p/qZEuZuhcqE\" rel=\"nofollow noreferrer\">server</a> code I have written so far. When I run this to copy a file of size 39 bytes, the client is sending two requests to the server. But the server is displaying the following errors.</p>\n\n<pre><code>2017/05/30 20:19:28 Was not able to access the uploaded file: unexpected EOF\n2017/05/30 20:19:28 Was not able to access the uploaded file: multipart: NextPart: EOF\n</code></pre>\n"}, {"tags": ["file", "go", "io", "reader"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1496151902, "post_id": 44263835, "comment_id": 75536054, "body": "I don&#39;t think the base64 decoder is stateless, so <code>Seek</code>ing the underlying reader between reads from the base64 reader may have unpredictable results."}, {"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1496155463, "post_id": 44263835, "comment_id": 75538808, "body": "the intent of this code is extremely unclear.  i had to go back to the original challenge to understand what is going on with iterating over block size (which looks strange because it&#39;s not using an accumulated n to ensure that it eventually reads blocksize bytes).  Just <code>asBytes, err := ioutil.ReadAll(base64.NewDecoder(base64.StdEncoding, f))</code>, and proceed to work on the data asBytes.  (ie: the distance calculations between block lengths, etc.)"}, {"owner": {"reputation": 23, "user_id": 3461506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460f19cc9c90e851ec4eea987c6ebfaa?s=128&d=identicon&r=PG&f=1", "display_name": "tomatopeel", "link": "https://stackoverflow.com/users/3461506/tomatopeel"}, "reply_to_user": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1496156756, "post_id": 44263835, "comment_id": 75539783, "body": "@Rob The only intent of the code here was as a demo for the question. It&#39;s a modified excerpt from some obviously buggy code for the given challenge. I just continued to use the file from the challenge, I suppose out of laziness. I will look into using an accumulated n though, thank you, I&#39;m new to golang."}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 0, "last_activity_date": 1496156794, "last_edit_date": 1496156794, "creation_date": 1496154486, "answer_id": 44265022, "question_id": 44263835, "link": "https://stackoverflow.com/questions/44263835/base64-decoder-io-reader-implementation-misbehaviour/44265022#44265022", "title": "base64 decoder (io.Reader implementation) misbehaviour", "body": "<p>It is not the problem of <code>encoding/base64</code>. When using <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a>, it's not guaranteed that number of bytes read exactly equal to the buffer size (i.e. <code>blocksize</code> in your example code). The documentation states:</p>\n\n<blockquote>\n  <p>Read reads up to len(p) bytes into p. It returns the number of bytes read (0 &lt;= n &lt;= len(p)) and any error encountered. Even if Read returns n &lt; len(p), it may use all of p as scratch space during the call. If some data is available but not len(p) bytes, Read conventionally returns what is available instead of waiting for more. </p>\n</blockquote>\n\n<p>In your example, change <code>PrintBytes</code> to </p>\n\n<pre><code>func PrintBytes(reader io.Reader, blocksize int) {\n    block := make([]byte, blocksize)\n    for {\n        n, err := reader.Read(block)\n        //Process the data if n &gt; 0, even when err != nil\n        if n &gt; 0 {\n            log.Printf(\"%x\\tblocksize=%d\", block[:n], blocksize)\n        }\n\n        //Check for error\n        if err != nil {\n            if err != io.EOF {\n                log.Fatal(err)\n            } else if err == io.EOF {\n                break\n            }\n        } else if n == 0 {\n            //Considered as nothing happened\n            log.Printf(\"WARNING: read return 0,nil\")\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>Correct usage of <code>io.Reader</code>, modify code to always process the data if <code>n &gt; 0</code> even when error occurs. </p>\n"}], "owner": {"reputation": 23, "user_id": 3461506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460f19cc9c90e851ec4eea987c6ebfaa?s=128&d=identicon&r=PG&f=1", "display_name": "tomatopeel", "link": "https://stackoverflow.com/users/3461506/tomatopeel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 44265022, "answer_count": 1, "score": 1, "last_activity_date": 1496156794, "creation_date": 1496151391, "question_id": 44263835, "link": "https://stackoverflow.com/questions/44263835/base64-decoder-io-reader-implementation-misbehaviour", "title": "base64 decoder (io.Reader implementation) misbehaviour", "body": "<p>I have tried, within a for loop, to re-declare/assign a base64 decoder and used the os.Seek function to go back to the beginning of the file at the end of the loop before this, in order for the called function (in this test case PrintBytes) to be able to process the file from beginning to end time and time again throughout the for loop.</p>\n\n<p>Here is my (I'm sure terribly un-idiomatic) code, which fails to read the 2nd byte into the []byte of length 2 and capacity 2 during the second iteration of the main for loop in main():</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"io\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n)\n\nvar (\n    remote_file string = \"http://cryptopals.com/static/challenge-data/6.txt\"\n    local_file  string = \"secrets_01_06.txt\"\n)\n\nfunc main() {\n    f, err := os.Open(local_file)\n    if err != nil {\n        DownloadFile(local_file, remote_file)\n        f, err = os.Open(local_file)\n        if err != nil {\n            log.Fatal(err)\n        }\n    }\n    defer f.Close()\n\n    for blocksize := 1; blocksize &lt;= 5; blocksize++ {\n        decoder := base64.NewDecoder(base64.StdEncoding, f)\n        PrintBytes(decoder, blocksize)\n        _, err := f.Seek(0, 0)\n        if err != nil {\n            log.Fatal(err)\n        }\n    }\n}\n\nfunc PrintBytes(reader io.Reader, blocksize int) {\n    block := make([]byte, blocksize)\n    for {\n        n, err := reader.Read(block)\n        if err != nil &amp;&amp; err != io.EOF {\n            log.Fatal(err)\n        }\n        if n != blocksize {\n            log.Printf(\"n=%d\\tblocksize=%d\\tbreaking...\", n, blocksize)\n            break\n        }\n        log.Printf(\"%x\\tblocksize=%d\", block, blocksize)\n    }\n}\n\nfunc DownloadFile(local string, url string) {\n    f, err := os.Create(local)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer f.Close()\n\n    resp, err := http.Get(url)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer resp.Body.Close()\n\n    _, err = io.Copy(f, resp.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>The output from this code can be viewed here <a href=\"https://gist.github.com/tomatopeel/b8e2f04179c7613e2a8c8973a72ec085\" rel=\"nofollow noreferrer\">https://gist.github.com/tomatopeel/b8e2f04179c7613e2a8c8973a72ec085</a></p>\n\n<p>It is this behaviour that I don't understand:\n<a href=\"https://gist.github.com/tomatopeel/b8e2f04179c7613e2a8c8973a72ec085#file-bad_reader_log-L5758\" rel=\"nofollow noreferrer\">https://gist.github.com/tomatopeel/b8e2f04179c7613e2a8c8973a72ec085#file-bad_reader_log-L5758</a></p>\n\n<p>I was expecting it to simply read the file 2 bytes at a time into the 2-byte slice, from beginning to end. For what reason does it only read 1 byte here?</p>\n"}, {"tags": ["go", "cron"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1496151444, "post_id": 44263796, "comment_id": 75535700, "body": "How do you know the file is not created. Maybe it actually <i>is</i> created, but not where you think..."}, {"owner": {"reputation": 27, "user_id": 3526651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ad6efc5a25c0bee5199a0f59a68021?s=128&d=identicon&r=PG&f=1", "display_name": "Lotoras", "link": "https://stackoverflow.com/users/3526651/lotoras"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1496152502, "post_id": 44263796, "comment_id": 75536498, "body": "man you&#39;re right - thanks a lot Everything has been created under \u201e/root/&quot; I thougt making the path absolut would help (adjusted the actual code)"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496154027, "post_id": 44264614, "comment_id": 75537623, "body": "Go doesn&#39;t &quot;adjust&quot; anything, it starts in the working directory provided."}], "tags": [], "owner": {"reputation": 27, "user_id": 3526651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ad6efc5a25c0bee5199a0f59a68021?s=128&d=identicon&r=PG&f=1", "display_name": "Lotoras", "link": "https://stackoverflow.com/users/3526651/lotoras"}, "is_accepted": false, "score": 0, "last_activity_date": 1496153423, "creation_date": 1496153423, "answer_id": 44264614, "question_id": 44263796, "link": "https://stackoverflow.com/questions/44263796/code-doesnt-create-files-when-run-in-cronjob/44264614#44264614", "title": "Code doesn&#39;t create files when run in CronJob", "body": "<p>So go adjusts the current directory to the directory of crontab when being executed in a Cronjob or the other way round regardingly</p>\n"}], "owner": {"reputation": 27, "user_id": 3526651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ad6efc5a25c0bee5199a0f59a68021?s=128&d=identicon&r=PG&f=1", "display_name": "Lotoras", "link": "https://stackoverflow.com/users/3526651/lotoras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1496153423, "creation_date": 1496151308, "last_edit_date": 1496152907, "question_id": 44263796, "link": "https://stackoverflow.com/questions/44263796/code-doesnt-create-files-when-run-in-cronjob", "title": "Code doesn&#39;t create files when run in CronJob", "body": "<p>I'm trying to create a CronJob that is creating a file and writing some string to it. The Code does work when run as normal go code. Also the code itself is executed when run as a Cronjob (I checked /var/log/syslog and let Print something with \u201efmt.Print(\"some string\"))\nThe Problem is that the file I want to create is not created when the Cronjob is executed (I'm root on my Server so \u201ecrontab -e\u201d should have enough permissions shouldn't it?)</p>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"path/filepath\"\n    \"fmt\"   \n    \"github.com/Sirupsen/logrus\"\n</code></pre>\n\n<p>)</p>\n\n<pre><code>func main() {\n\nabsPath, err := filepath.Abs(\"loggy.txt\")\nif err != nil {\n    fmt.Print(\"Error\\n\")\n}\n\n\nfile, err := os.OpenFile(absPath, os.O_RDWR | os.O_CREATE | os.O_APPEND, 0666)\nif err != nil {\n    fmt.Print(\"Error\\n\")\n}\n\n\nvar loggy logrus.Logger\nloggy.Out = file\nloggy.Level = logrus.DebugLevel\nformatter := &amp;logrus.TextFormatter{}\nformatter.ForceColors = true\nformatter.FullTimestamp = true\nloggy.Formatter = formatter\n\nloggy.Warn(\"Test\")\n\n}\n</code></pre>\n\n<p>crontab -e:</p>\n\n<pre><code>*/01   *  *  *  * /root/PathToFile/CronJob/./CronJob\n</code></pre>\n\n<p>Any help is appreciated</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 11, "creation_date": 1496150461, "post_id": 44263450, "comment_id": 75534937, "body": "it&#39;s like running any binary file... make it executable <code>chmod +x</code> and run it <code>.&#47;binary</code>"}, {"owner": {"reputation": 131, "user_id": 7685124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/693f633f4b1a77ce567a75d4d1229f30?s=128&d=identicon&r=PG&f=1", "display_name": "Yordan Yordanov", "link": "https://stackoverflow.com/users/7685124/yordan-yordanov"}, "reply_to_user": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1496151532, "post_id": 44263450, "comment_id": 75535785, "body": "Thanks a lot. So the problem was lack of Ubintu knowledge :)"}], "answers": [{"tags": [], "owner": {"reputation": 9581, "user_id": 807239, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/fcjpR.jpg?s=128&g=1", "display_name": "Daniel Ribeiro", "link": "https://stackoverflow.com/users/807239/daniel-ribeiro"}, "is_accepted": false, "score": 17, "last_activity_date": 1496215021, "creation_date": 1496215021, "answer_id": 44278127, "question_id": 44263450, "link": "https://stackoverflow.com/questions/44263450/how-to-run-go-binary-files/44278127#44278127", "title": "How to run Go binary files?", "body": "<p>The application should be executed just like any other binary can be executed in the given OS. In your case, running on Ubuntu, you must first compile the application for that particular architecture:</p>\n\n<pre><code>env GOOS=linux GOARCH=arm go build\n</code></pre>\n\n<p>Then you can modify the permissions of the binary to be executable:</p>\n\n<pre><code>chmod +x my-app\n</code></pre>\n\n<p>And simply execute it:</p>\n\n<pre><code>./my-app\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 5285732, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206841923263165/picture?type=large", "display_name": "Meir Gabay", "link": "https://stackoverflow.com/users/5285732/meir-gabay"}, "is_accepted": false, "score": 4, "last_activity_date": 1594915345, "last_edit_date": 1594915345, "creation_date": 1591272203, "answer_id": 62194134, "question_id": 44263450, "link": "https://stackoverflow.com/questions/44263450/how-to-run-go-binary-files/62194134#62194134", "title": "How to run Go binary files?", "body": "<p>To avoid using <code>./</code> or any other path to the binary, you can copy the binary file to your <code>/usr/local/bin/</code> path.</p>\n<p>For example-</p>\n<ol>\n<li>Download a binary file that was compiled with Go, for example <code>app</code></li>\n<li>Provide execution permission - <code>chmod +x ~/Downloads/app</code></li>\n<li>Copy binary file to <code>/usr/local/bin</code> - <code>cp ~/Downloads/app /usr/local/bin/app</code></li>\n<li>Execute the application from anywhere - <code>app</code></li>\n</ol>\n"}], "owner": {"reputation": 131, "user_id": 7685124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/693f633f4b1a77ce567a75d4d1229f30?s=128&d=identicon&r=PG&f=1", "display_name": "Yordan Yordanov", "link": "https://stackoverflow.com/users/7685124/yordan-yordanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22456, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1594915345, "creation_date": 1496150364, "last_edit_date": 1504369069, "question_id": 44263450, "link": "https://stackoverflow.com/questions/44263450/how-to-run-go-binary-files", "title": "How to run Go binary files?", "body": "<p>So I read a lot about \"You can run go program from binaries without even having go installed on your machine\" and etc. My question is how exactly should I execute the app.</p>\n\n<p>In my case I have a console app which sends emails if a certain event occurs. There also Is a toml file for configuring it. How should I run the app on a PC which does not have golang installed and is running 14.04.1-Ubuntu 64bit OS?</p>\n"}, {"tags": ["go", "protocol-buffers", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "edited": false, "score": 0, "creation_date": 1496152376, "post_id": 44263573, "comment_id": 75536406, "body": "Learn something everyday. Thank You"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "edited": false, "score": 0, "creation_date": 1496154799, "post_id": 44263573, "comment_id": 75538290, "body": "We both learned this today, it was just a wild guess that I confirmed in the playground before posting. Not what I would have expected either but it kind of makes sense. The types of literals are not always clear."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 4, "last_activity_date": 1496150698, "creation_date": 1496150698, "answer_id": 44263573, "question_id": 44263381, "link": "https://stackoverflow.com/questions/44263381/golang-if-statement-not-seeing-0-for-int32/44263573#44263573", "title": "Golang if statement not seeing 0 for int32", "body": "<p>Because the literal <code>0</code> is not the same type. If you do:</p>\n\n<pre><code>if v != int32(0) {\n</code></pre>\n\n<p>When the value is an <code>int32</code>, it works as expected. Unfortunately, you're combining all the int types in a single case, which will make this difficult/unwieldy to handle correctly. You could probably work something out using reflection to compare the value against the zero value for its type at runtime, using <a href=\"https://golang.org/pkg/reflect/#Zero\" rel=\"nofollow noreferrer\">reflect.Zero</a>.</p>\n"}], "owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 44263573, "answer_count": 1, "score": 1, "last_activity_date": 1496150698, "creation_date": 1496150193, "question_id": 44263381, "link": "https://stackoverflow.com/questions/44263381/golang-if-statement-not-seeing-0-for-int32", "title": "Golang if statement not seeing 0 for int32", "body": "<p>I have proto3/grpc function written in golang. There is a if statement written in a switch that does't see an int32 as a value of 0 when the value is a 0. I print the value before and it's a 0 but the if statement runs anyway. In my code below I have the output in a comment. I know for a int the nil value is a 0. If I place a value for the lname, fname they work as it should. Any help appreciated.  Here is my output:</p>\n\n<pre><code>map[fname: lname: email: id:0]\n0\nid = $1\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>func (s *server) GetUsers(ctx context.Context, in *userspb.User) (*userspb.Users, error) {\n    flds := make(map[string]interface{})\n    flds[\"id\"] = in.Id // 0\n    flds[\"fname\"] = in.Fname // \"\" (empty)\n    flds[\"lname\"] = in.Lname // \"\" (empty)\n    flds[\"email\"] = in.Email // \"\" (empty)\n\n    fmt.Println(flds) //map[lname: email: id:0 fname:]\n\n    var where bytes.Buffer\n\n    n := 0\n    for _, v := range flds {\n        switch v.(type) {\n        case string:\n            if v != \"\" {\n                n++\n            }\n        case int, int32, int64:\n            if v != 0 {\n                n++\n            }\n        }\n    }\n\n    calledvariables := make([]interface{}, 0)\n\n    i := 1\n    for k, v := range flds {\n\n        switch v.(type) {\n        case string:\n            if v != \"\" {\n                if i != 1 {\n                    where.WriteString(\" AND \")\n                }\n                ist := strconv.Itoa(i)\n                where.WriteString(k + \" = $\" + ist)\n                calledvariables = append(calledvariables, v)\n                i++\n            }\n        case int, int32, int64, uint32, uint64:\n            /////// THIS IF STATMENT IS THE ISSUE the ( v is printing the value of 0 and it's in the if statement )\n            if v != 0 {\n                fmt.Println(v) // 0\n                if i != 1 {\n                    where.WriteString(\" AND \")\n                }\n                ist := strconv.Itoa(i)\n                where.WriteString(k + \" = $\" + ist)\n                calledvariables = append(calledvariables, v)\n                i++\n            }\n        }\n    }\n\n    fmt.Println(where.String()) // id = $1\n    ...\n</code></pre>\n"}, {"tags": ["postgresql", "csv", "go"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496150167, "post_id": 44262711, "comment_id": 75534690, "body": "To figure out the error, instead of <code>Run</code>, use <a href=\"https://golang.org/pkg/os/exec/#Cmd.CombinedOutput\" rel=\"nofollow noreferrer\"><code>Cmd.CombinedOutput</code></a>, then printout/observe the combined-output message."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1496150189, "post_id": 44262711, "comment_id": 75534711, "body": "args should be a slice of strings with each arg in its own entry. I have to wonder - why write a Go app that just forks out to psql? Just write a bash script, or if you&#39;re doing it in Go, do it in Go using psql driver."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496150250, "post_id": 44262711, "comment_id": 75534759, "body": "Also your pasted error is not from your pasted source; the error references line 21 which doesn&#39;t exist in your sample source, making this difficult for anyone else to reason about."}, {"owner": {"reputation": 248, "user_id": 6073838, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1530379783927023/picture?type=large", "display_name": "\u0410\u043d\u0434\u0440\u0435\u0439 \u0410\u043d\u0442\u043e\u043d\u043e\u0432", "link": "https://stackoverflow.com/users/6073838/%d0%90%d0%bd%d0%b4%d1%80%d0%b5%d0%b9-%d0%90%d0%bd%d1%82%d0%be%d0%bd%d0%be%d0%b2"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496150819, "post_id": 44262711, "comment_id": 75535208, "body": "@Adrian because psql driver too slow.  Thanks, replace args to slice solved error."}], "answers": [{"tags": [], "owner": {"reputation": 248, "user_id": 6073838, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1530379783927023/picture?type=large", "display_name": "\u0410\u043d\u0434\u0440\u0435\u0439 \u0410\u043d\u0442\u043e\u043d\u043e\u0432", "link": "https://stackoverflow.com/users/6073838/%d0%90%d0%bd%d0%b4%d1%80%d0%b5%d0%b9-%d0%90%d0%bd%d1%82%d0%be%d0%bd%d0%be%d0%b2"}, "is_accepted": false, "score": -1, "last_activity_date": 1496150897, "creation_date": 1496150897, "answer_id": 44263653, "question_id": 44262711, "link": "https://stackoverflow.com/questions/44262711/how-to-copy-from-csv-to-postgres-with-go/44263653#44263653", "title": "How to copy from csv to postgres with Go?", "body": "<pre><code>func main() {\n    cmd := \"psql\"\n    args := []string{\"-U\", \"postgres\", \"-d\", \"test\", \"-c\", fmt.Sprintf(`\\copy doe from '%s' delimiter '|' csv header;`, os.Args[1])}\n    v, err := exec.Command(cmd, args...).CombinedOutput()\n    if err != nil {\n        panic(string(v))\n    }\n    println(\"Ok\")\n}\n</code></pre>\n"}], "owner": {"reputation": 248, "user_id": 6073838, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1530379783927023/picture?type=large", "display_name": "\u0410\u043d\u0434\u0440\u0435\u0439 \u0410\u043d\u0442\u043e\u043d\u043e\u0432", "link": "https://stackoverflow.com/users/6073838/%d0%90%d0%bd%d0%b4%d1%80%d0%b5%d0%b9-%d0%90%d0%bd%d1%82%d0%be%d0%bd%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1152, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1496150897, "creation_date": 1496148411, "question_id": 44262711, "link": "https://stackoverflow.com/questions/44262711/how-to-copy-from-csv-to-postgres-with-go", "title": "How to copy from csv to postgres with Go?", "body": "<p>I want copy my large csv-file to Postgres. Schema <code>create table doe(firstname text, lastname text, phone text);</code></p>\n\n<p>CSV-file </p>\n\n<p><code>Firstname|LastName|Phone\nJohn|Doe|55-55-555\nJane|Doe|66-66-666\n</code></p>\n\n<p>Go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := \"psql\"\n    args := fmt.Sprintf(\"-U postgres -d test -c \\\"\\\\copy doe from '%s' delimiter '|' csv header;\\\"\", os.Args[1])\n    if err := exec.Command(cmd, args).Run(); err != nil {\n        panic(err)\n    }\n    println(\"Ok\")\n}\n</code></pre>\n\n<p>And now a have error </p>\n\n<blockquote>\n  <p>./copy /tmp/test.csv panic: exit status 2</p>\n  \n  <p>goroutine 1 [running]: main.main()    /tmp/copy.go:21 +0x16b</p>\n</blockquote>\n\n<p>What I do wrong? If run in console </p>\n\n<blockquote>\n  <p>psql -U postgres -d test -c \"\\copy doe from '/tmp/test.csv' delimiter '|' csv header;\"</p>\n  \n  <p>COPY 2</p>\n</blockquote>\n"}, {"tags": ["java", "mysql", "go", "entity", "spring-data-jpa"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 4, "creation_date": 1496147757, "post_id": 44261952, "comment_id": 75532799, "body": "<a href=\"https://www.google.com/search?q=golang+orm+mysql\" rel=\"nofollow noreferrer\">google.com/search?q=golang+orm+mysql</a>"}, {"owner": {"reputation": 345, "user_id": 6718081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c8307e8eea93f9fcbe7af81b6be7256?s=128&d=identicon&r=PG&f=1", "display_name": "jasiuuu", "link": "https://stackoverflow.com/users/6718081/jasiuuu"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1496155514, "post_id": 44261952, "comment_id": 75538849, "body": "orm - i missed that word, and i learn something, i wish to know why sb do not like this question, i am stupid, please be more tolerant, i am learning"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1496156184, "post_id": 44261952, "comment_id": 75539337, "body": "SO is indeed quite intolerant towards questions that are vague or open like yours. Often with reason, but it can be annoying when you really cannot make it more specific."}], "answers": [{"tags": [], "owner": {"reputation": 629, "user_id": 5279383, "user_type": "registered", "profile_image": "https://graph.facebook.com/961771140556632/picture?type=large", "display_name": "Cezary Butler", "link": "https://stackoverflow.com/users/5279383/cezary-butler"}, "is_accepted": false, "score": 2, "last_activity_date": 1595325772, "creation_date": 1595325772, "answer_id": 63012067, "question_id": 44261952, "link": "https://stackoverflow.com/questions/44261952/framework-similar-to-spring-data-jpa-in-golang/63012067#63012067", "title": "Framework similar to Spring Data JPA in Golang", "body": "<p>GORM is the most popular ORM for golang. However featurewise it is not even close to JPA or spring-data-jpa.\nThere are also many gotchas you will have to manage in order to produce a good solution using GORM.\nThere are many other ORMs, none coming close to spring-data-jpa.</p>\n<p>The advised solution will depend on whether simple queries will be sufficient for you.\nIf you have to write more complex queries, the best way would be to use sqlx for that.</p>\n"}], "owner": {"reputation": 345, "user_id": 6718081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c8307e8eea93f9fcbe7af81b6be7256?s=128&d=identicon&r=PG&f=1", "display_name": "jasiuuu", "link": "https://stackoverflow.com/users/6718081/jasiuuu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1173, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1595325772, "creation_date": 1496146404, "question_id": 44261952, "link": "https://stackoverflow.com/questions/44261952/framework-similar-to-spring-data-jpa-in-golang", "title": "Framework similar to Spring Data JPA in Golang", "body": "<p>Do you know some frameworks written in Golang similar to Spring Data JPA? I am looking for something which allow me to easy work between Golang structs and MySQL database tables. I was looking for it in Google, not found. Cheers.</p>\n"}, {"tags": ["go", "gorilla"], "owner": {"reputation": 159, "user_id": 1183632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qs8EG.jpg?s=128&g=1", "display_name": "Danilo", "link": "https://stackoverflow.com/users/1183632/danilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1496138703, "creation_date": 1496138703, "question_id": 44259237, "link": "https://stackoverflow.com/questions/44259237/go-bindata-assetfs-and-gorilla-mux", "title": "go-bindata-assetfs and gorilla mux", "body": "<p>I'm working on my first go web app and trying to embed files using <a href=\"https://github.com/elazarl/go-bindata-assetfs\" rel=\"nofollow noreferrer\">https://github.com/elazarl/go-bindata-assetfs</a></p>\n\n<p>This is my project structure:</p>\n\n<pre><code>project_dir\n\u251c\u2500\u2500\u2500common\n\u251c\u2500\u2500\u2500routers\n\u2514\u2500\u2500\u2500templates\n    \u251c\u2500\u2500\u2500images\n    \u2514\u2500\u2500\u2500css\n</code></pre>\n\n<p>generated a source file:</p>\n\n<pre><code>go-bindata-assetfs -pkg common -prefix \"templates/\" templates/css/ templates/ templates/images/\n</code></pre>\n\n<p>now I have the old routes to static files:</p>\n\n<pre><code>package routers\nimport (\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n)\n\nfunc SetTemplatesRoutes(router *mux.Router) *mux.Router {\n    fs := http.FileServer(http.Dir(\"templates\"))\n\n    router.Handle(\"/templates/\", fs)\n    router.PathPrefix(\"/css/\").Handler(\n        http.StripPrefix(\"/css/\",\n            http.FileServer(http.Dir(\"templates/css\")),\n        ))\n\n    router.PathPrefix(\"/dist/\").Handler(\n        http.StripPrefix(\"/dist/\",\n            http.FileServer(http.Dir(\"templates/dist\")),\n        ))\n\n    router.PathPrefix(\"/images/\").Handler(\n        http.StripPrefix(\"/images/\",\n            http.FileServer(http.Dir(\"templates/images\")),\n        ))\n\n    return router\n}\n</code></pre>\n\n<p>that I'd like replace with the embedded files just to make the html templates bind the css and image files. This is my attempt:</p>\n\n<pre><code>    fs := http.FileServer(\n        &amp;assetfs.AssetFS{Asset: common.Asset, AssetDir: common.AssetDir, AssetInfo: common.AssetInfo})\n    //\n    router.Handle(\"/\", fs)\n    router.PathPrefix(\"/css/\").Handler(\n        http.StripPrefix(\"/css/\",\n            fs,\n        ))\n\n    router.PathPrefix(\"/dist/\").Handler(\n        http.StripPrefix(\"/dist/\",\n            fs,\n        ))\n\n    router.PathPrefix(\"/images/\").Handler(\n        http.StripPrefix(\"/images/\",\n            fs,\n        )) \n</code></pre>\n\n<p>that doesn't work.</p>\n\n<p>Any suggestion to solve it?</p>\n"}, {"tags": ["inheritance", "go", "module", "architecture", "structure"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1496135321, "post_id": 44257729, "comment_id": 75523980, "body": "You are mixing up different types from different packages: The <code>Block</code> from one package is totaly unrelated to the one from the other package: You&#39;ll have to decide whether you want a chain of chain.Block or consensus.Block. You cannot magically convert between them."}, {"owner": {"reputation": 136, "user_id": 4706966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87783d48f814a3408b91c481cce250e8?s=128&d=identicon&r=PG&f=1", "display_name": "very", "link": "https://stackoverflow.com/users/4706966/very"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1496136419, "post_id": 44257729, "comment_id": 75524801, "body": "In Java I could. I could have an array of the super class containing instances of the subclass. When I want to access a method of the subclass I could convert the object from the array to an object of subclass and access the subclasses methods / fields. Maybe there is no way to do this in go without putting both structs in the same module like in \u0394\u03bb\u041bs answer."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1496137157, "post_id": 44257729, "comment_id": 75525381, "body": "Given that there is no super-/sub-class relation in Go it is pretty obvious that a solution based on super-sub-class behaviour cannot work."}, {"owner": {"reputation": 136, "user_id": 4706966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87783d48f814a3408b91c481cce250e8?s=128&d=identicon&r=PG&f=1", "display_name": "very", "link": "https://stackoverflow.com/users/4706966/very"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1496138442, "post_id": 44257729, "comment_id": 75526253, "body": "In the end for me this is about separation of concerns. I thought I could solve this using modules and struct embedding. I&#39;m open to any other solution, though."}, {"owner": {"reputation": 136, "user_id": 4706966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87783d48f814a3408b91c481cce250e8?s=128&d=identicon&r=PG&f=1", "display_name": "very", "link": "https://stackoverflow.com/users/4706966/very"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1496147996, "post_id": 44257729, "comment_id": 75532975, "body": "@Volker sorry that my question wasn&#39;t clear. I edited it, so that it asks in a more general way about where to keep my data instead of insisting on struct embedding or inheritance equivalents."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1496151123, "post_id": 44257729, "comment_id": 75535436, "body": "If you want interchangeability in Go, use interfaces. Embedding gives you composition <i>only</i>, not polymorphism."}], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 4706966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87783d48f814a3408b91c481cce250e8?s=128&d=identicon&r=PG&f=1", "display_name": "very", "link": "https://stackoverflow.com/users/4706966/very"}, "edited": false, "score": 0, "creation_date": 1496136534, "post_id": 44257987, "comment_id": 75524900, "body": "This way the two structs can&#39;t be in separate modules. Is my assumption wrong that a part of a program that should be completely interchangeable should be a separate module?"}, {"owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "reply_to_user": {"reputation": 136, "user_id": 4706966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87783d48f814a3408b91c481cce250e8?s=128&d=identicon&r=PG&f=1", "display_name": "very", "link": "https://stackoverflow.com/users/4706966/very"}, "edited": false, "score": 0, "creation_date": 1496139226, "post_id": 44257987, "comment_id": 75526806, "body": "I think that in this case the assumption is wrong - I would create two files (chain.go, consensus.go) in a same package."}, {"owner": {"reputation": 136, "user_id": 4706966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87783d48f814a3408b91c481cce250e8?s=128&d=identicon&r=PG&f=1", "display_name": "very", "link": "https://stackoverflow.com/users/4706966/very"}, "edited": false, "score": 2, "creation_date": 1496145204, "post_id": 44257987, "comment_id": 75530834, "body": "Thanks, this is definitely a viable approach. From <a href=\"https://blog.golang.org/organizing-go-code\" rel=\"nofollow noreferrer\">organizing go code</a>: &quot;The http package comprises 17 go source files (excluding tests) and exports 109 identifiers, and the hash package consists of one file that exports just three declarations. There is no hard and fast rule; both approaches are appropriate given their context.&quot;"}], "tags": [], "owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "is_accepted": true, "score": 3, "last_activity_date": 1496135299, "creation_date": 1496135299, "answer_id": 44257987, "question_id": 44257729, "link": "https://stackoverflow.com/questions/44257729/golang-separation-of-concerns-vs-usability/44257987#44257987", "title": "golang separation of concerns vs usability", "body": "<p><code>consensus.Block</code> and <code>chain.Block</code> are two separate types but since you are embeddding <code>chain.Block</code> in <code>consensus.Block</code>, you can access one from another.</p>\n\n<p>Just pass <code>consensus.Block</code> in <code>AddBlockToChain()</code>:</p>\n\n<pre><code>`func AddBlockToChain(block consensus.Block)`\n</code></pre>\n\n<p>and then access it by: <code>block.Block</code></p>\n\n<p>Example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype ChainBlock struct {\n    id int\n}\n\ntype ConsensusBlock struct {\n    ChainBlock\n    idCons int\n}\n\nfunc printChainBlockId(consBlock ConsensusBlock) {\n    fmt.Println(consBlock.ChainBlock.id)\n}\n\nfunc main() {\n    test := ConsensusBlock{\n        ChainBlock: ChainBlock{\n            id: 42,\n        },\n        idCons: 44,\n    }\n\n    printChainBlockId(admin)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 4706966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87783d48f814a3408b91c481cce250e8?s=128&d=identicon&r=PG&f=1", "display_name": "very", "link": "https://stackoverflow.com/users/4706966/very"}, "is_accepted": false, "score": -1, "last_activity_date": 1496753297, "creation_date": 1496753297, "answer_id": 44390453, "question_id": 44257729, "link": "https://stackoverflow.com/questions/44257729/golang-separation-of-concerns-vs-usability/44390453#44390453", "title": "golang separation of concerns vs usability", "body": "<p>For completeness I want to add a solution that keeps the code and data of the consensus algorithm in a different package than the block and chain code:</p>\n\n<p>Add an extra field to the block like this: </p>\n\n<pre><code>Extra []byte\n</code></pre>\n\n<p>Then keep the extra data needed for a consensus algorithm in that algorithms package in a struct and encode it to json or some other format to store it in the extra field. </p>\n\n<p>This solution keeps separate concerns separate. The chain would not make sense without a consensus algorithm, but they can look very different and might need different data. This way different algorithms can store different data.</p>\n\n<p>I did not go with this solution however, because it just seemed simpler to keep all the code in one package as @syntagma suggested.</p>\n"}], "owner": {"reputation": 136, "user_id": 4706966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87783d48f814a3408b91c481cce250e8?s=128&d=identicon&r=PG&f=1", "display_name": "very", "link": "https://stackoverflow.com/users/4706966/very"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 44257987, "answer_count": 2, "score": 0, "last_activity_date": 1496753297, "creation_date": 1496134545, "last_edit_date": 1496147842, "question_id": 44257729, "link": "https://stackoverflow.com/questions/44257729/golang-separation-of-concerns-vs-usability", "title": "golang separation of concerns vs usability", "body": "<p>I have always struggled keeping go modules neatly separated and avoiding cyclic dependencies. </p>\n\n<p>Right now I have code like this: </p>\n\n<pre><code>    package chain\n\n\ntype Block struct{\n    Content []byte\n    Number int\n}\n\nvar Chain []Block = make([]Block, 10)\n\nfunc AddBlockToChain(block Block){\n    // do some checks\n    //...\n    // add to chain\n    Chain[block.Number] = block\n}\n\nfunc GetBlock(number int) Block {\n    // do some checks\n    //  ...\n    // get from chain\n    return Chain[number]\n}\n</code></pre>\n\n<p>To achieve consensus I need some extra info on the block. The info may be different depending on which consensus algorithm I use. I want the consensus algorithm to be interchangeable (e.g. by flag on start up). </p>\n\n<p>It would be convenient to store the info as fields in the block, so that when I call GetBlock(3) or get a block from anywhere else I can not only access the block but also the info on what state of consensus this block is in at the moment.  </p>\n\n<p>On the other hand I wanted to keep data that is only relevant for a certain consensus algorithm separate from basic block data - maybe even in a separate package.</p>\n\n<p><strong>How should I design my program? Where should I keep data relevant for a certain consensus algorithm?</strong></p>\n\n<p>Some background info: </p>\n\n<p>I am trying to build a block chain application from scratch. I have a \"chain\" module responsible for storing blocks of data and a \"consensus\" module responsible for creating consensus between multiple peers running an instance of my program on what that data is. </p>\n"}, {"tags": ["dictionary", "go", "memory", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1496135510, "post_id": 44257522, "comment_id": 75524108, "body": "There is no <i>need</i> to do this as you can calculate the space needed: Multiply cap of the slice with the size of each element. For maps it is more difficult as some interna are not accessible (e.g. hash collisions) but it is basically the same."}], "answers": [{"comments": [{"owner": {"reputation": 6317, "user_id": 2849157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/81de56159f8a6f58c78e3e7d88d7fbe5?s=128&d=identicon&r=PG&f=1", "display_name": "roger", "link": "https://stackoverflow.com/users/2849157/roger"}, "edited": false, "score": 0, "creation_date": 1496134954, "post_id": 44257767, "comment_id": 75523734, "body": "so how can I get the real size in my situation?"}, {"owner": {"reputation": 1041, "user_id": 4233629, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-afuW4zm4V5Q/AAAAAAAAAAI/AAAAAAAAHR4/K4nGzVl8rsM/photo.jpg?sz=128", "display_name": "Sush", "link": "https://stackoverflow.com/users/4233629/sush"}, "edited": false, "score": 0, "creation_date": 1559375223, "post_id": 44257767, "comment_id": 99407519, "body": "This would incur the marshalling overhead. Wonder if there&#39;s a way to do it without marshalling."}], "tags": [], "owner": {"reputation": 6749, "user_id": 3042856, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/aDWs9.jpg?s=128&g=1", "display_name": "Damaged Organic", "link": "https://stackoverflow.com/users/3042856/damaged-organic"}, "is_accepted": false, "score": 0, "last_activity_date": 1496135380, "last_edit_date": 1496135380, "creation_date": 1496134702, "answer_id": 44257767, "question_id": 44257522, "link": "https://stackoverflow.com/questions/44257522/how-to-get-memory-size-of-variable-in-go/44257767#44257767", "title": "How to get memory size of variable in Go?", "body": "<p>This is the correct way, using <code>unsafe.Sizeof(s)</code>. It's just that result will remain the same for a given type - integer, string, etc., disregarding the exact value.</p>\n\n<blockquote>\n  <p>Sizeof takes an expression x of any type and returns the size in bytes of a hypothetical variable v as if v was declared via var v = x. The size does not include any memory possibly referenced by x. For instance, if x is a slice, Sizeof returns the size of the slice descriptor, not the size of the memory referenced by the slice.</p>\n</blockquote>\n\n<p>Reference <a href=\"https://golang.org/pkg/unsafe/#Sizeof\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>You can use marshalling and then compare values representations in bytes with <code>Size()</code>. It's only matter of converting a data to a byte string.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 19, "last_activity_date": 1549707120, "last_edit_date": 1549707120, "creation_date": 1496135748, "answer_id": 44258164, "question_id": 44257522, "link": "https://stackoverflow.com/questions/44257522/how-to-get-memory-size-of-variable-in-go/44258164#44258164", "title": "How to get memory size of variable in Go?", "body": "<p><a href=\"https://golang.org/pkg/unsafe/#Sizeof\" rel=\"noreferrer\"><code>unsafe.SizeOf()</code></a> and <code>reflect.Type.Size()</code> only return the size of the passed value without recursively traversing the data structure and adding sizes of pointed values.</p>\n\n<p>The slice is relatively a simple struct: <a href=\"https://golang.org/pkg/reflect/#SliceHeader\" rel=\"noreferrer\"><code>reflect.SliceHeader</code></a>, and since we know it references a backing array, we can easily compute its size \"manually\", e.g.:</p>\n\n<pre><code>s := make([]int32, 1000)\n\nfmt.Println(\"Size of []int32:\", unsafe.Sizeof(s))\nfmt.Println(\"Size of [1000]int32:\", unsafe.Sizeof([1000]int32{}))\nfmt.Println(\"Real size of s:\", unsafe.Sizeof(s)+unsafe.Sizeof([1000]int32{}))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/r2ejk8JPx2\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Size of []int32: 12\nSize of [1000]int32: 4000\nReal size of s: 4012\n</code></pre>\n\n<p>Maps are a lot more complex data structures, I won't go into details, but check out this question+answer: <a href=\"https://stackoverflow.com/questions/31847549/golang-computing-the-memory-footprint-or-byte-length-of-a-map\">Golang: computing the memory footprint (or byte length) of a map</a></p>\n\n<h2>Calculating size of any variable or structure (recursively)</h2>\n\n<p>If you want \"real\" numbers, you may take advantage of the testing tool of Go, which can also perform memory benchmarking. Pass the <code>-benchmem</code> argument, and inside the benchmark function allocate only whose memory you want to measure:</p>\n\n<pre><code>func BenchmarkSlice100(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ { getSlice(100) }\n}\nfunc BenchmarkSlice1000(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ { getSlice(1000) }\n}\nfunc BenchmarkSlice10000(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ { getSlice(10000) }\n}\nfunc BenchmarkMap100(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ { getMap(100) }\n}\nfunc BenchmarkMap1000(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ { getMap(1000) }\n}\nfunc BenchmarkMap10000(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ { getMap(10000) }\n}\n</code></pre>\n\n<p>(Remove the timing and printing calls from <code>getSlice()</code> and <code>getMap()</code> of course.)</p>\n\n<p>Running with</p>\n\n<pre><code>go test -bench . -benchmem\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>BenchmarkSlice100-4    3000000        471 ns/op        1792 B/op      1 allocs/op\nBenchmarkSlice1000-4    300000       3944 ns/op       16384 B/op      1 allocs/op\nBenchmarkSlice10000-4    50000      39293 ns/op      163840 B/op      1 allocs/op\nBenchmarkMap100-4       200000      11651 ns/op        2843 B/op      9 allocs/op\nBenchmarkMap1000-4       10000     111040 ns/op       41823 B/op     12 allocs/op\nBenchmarkMap10000-4       1000    1152011 ns/op      315450 B/op    135 allocs/op\n</code></pre>\n\n<p><code>B/op</code> values tell you how many bytes were allocated per op. <code>allocs/op</code> tells how many (distinct) memory allocations occurred per op.</p>\n\n<p>On my 64-bit architecture (where the size of <code>int</code> is 8 bytes) it tells that the size of a slice having 2000 elements is roughly 16 KB (in line with 2000 * 8 bytes). A map with 1000 <code>int-int</code> pairs required approximately to allocate 42 KB.</p>\n"}, {"tags": [], "owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "is_accepted": false, "score": 5, "last_activity_date": 1583244086, "creation_date": 1583244086, "answer_id": 60508928, "question_id": 44257522, "link": "https://stackoverflow.com/questions/44257522/how-to-get-memory-size-of-variable-in-go/60508928#60508928", "title": "How to get memory size of variable in Go?", "body": "<p>This incurs some marshaling overhead but I've found it's the simplest way during runtime to get the size of a value in go. For my needs the marshaling overhead wasn't a big issue so I went this route.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func getRealSizeOf(v interface{}) (int, error) {\n    b := new(bytes.Buffer)\n    if err := gob.NewEncoder(b).Encode(v); err != nil {\n        return 0, err\n    }\n    return b.Len(), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 6317, "user_id": 2849157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/81de56159f8a6f58c78e3e7d88d7fbe5?s=128&d=identicon&r=PG&f=1", "display_name": "roger", "link": "https://stackoverflow.com/users/2849157/roger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14454, "favorite_count": 7, "accepted_answer_id": 44258164, "answer_count": 3, "score": 13, "last_activity_date": 1583244086, "creation_date": 1496133872, "last_edit_date": 1565008088, "question_id": 44257522, "link": "https://stackoverflow.com/questions/44257522/how-to-get-memory-size-of-variable-in-go", "title": "How to get memory size of variable in Go?", "body": "<p>I am curious about the memory cost of <code>map</code> and <code>slice</code>, so I wrote a program to compare the sizes. I get the memory size by <code>unsafe.Sizeof(s)</code>, but obviously it is wrong, because when I change the size, the output is the same.</p>\n\n<pre><code>func getSlice(size int) []int {\n    t := time.Now()\n    s := make([]int, size*2)\n    for i := 0; i &lt; size; i++ {\n        index := i &lt;&lt; 1\n        s[index] = i\n        s[index+1] = i\n    }\n    fmt.Println(\"slice time cost: \", time.Since(t))\n    return s\n}\n\nfunc getMap(size int) map[int]int {\n    t := time.Now()\n    m := make(map[int]int, size)\n    for i := 0; i &lt; size; i++ {\n        m[i] = i\n    }\n    fmt.Println(\"map time cost: \", time.Since(t))\n    return m\n}\n\nfunc TestMem(t *testing.T) {\n    size := 1000\n    s := getSlice(size)\n    m := getMap(size)\n    fmt.Printf(\"slice size: %d\\n\", unsafe.Sizeof(s))\n    fmt.Printf(\"map size: %d\\n\", unsafe.Sizeof(m))\n}\n</code></pre>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 1722, "user_id": 5151792, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/463805ba3eae4866f5b40151249db4e4?s=128&d=identicon&r=PG&f=1", "display_name": "aicastell", "link": "https://stackoverflow.com/users/5151792/aicastell"}, "edited": false, "score": 0, "creation_date": 1496131329, "post_id": 44256618, "comment_id": 75521569, "body": "It works, thank you very much, Mr. Adam! :) Then, It is supposed you need to include the field name in the JSON being decoded to use this useful pattern referenced in documentation? I though you could do that in a more generic way."}, {"owner": {"reputation": 2696, "user_id": 14019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e4654adc0a8cf62d437e014fd9f8435?s=128&d=identicon&r=PG", "display_name": "Adam Straughan", "link": "https://stackoverflow.com/users/14019/adam-straughan"}, "reply_to_user": {"reputation": 1722, "user_id": 5151792, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/463805ba3eae4866f5b40151249db4e4?s=128&d=identicon&r=PG&f=1", "display_name": "aicastell", "link": "https://stackoverflow.com/users/5151792/aicastell"}, "edited": false, "score": 0, "creation_date": 1496159121, "post_id": 44256618, "comment_id": 75541406, "body": "@aicastell, this is how all JSON deserializers work. It is just standard JSON to concrete type mapping"}, {"owner": {"reputation": 1722, "user_id": 5151792, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/463805ba3eae4866f5b40151249db4e4?s=128&d=identicon&r=PG&f=1", "display_name": "aicastell", "link": "https://stackoverflow.com/users/5151792/aicastell"}, "edited": false, "score": 0, "creation_date": 1496213196, "post_id": 44256618, "comment_id": 75562083, "body": "Not all of them use this suggested pattern, I am familiarized with C development and after using cJSON, jasmine and other C based deserializers, this feature was completely new for me."}], "tags": [], "owner": {"reputation": 2696, "user_id": 14019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e4654adc0a8cf62d437e014fd9f8435?s=128&d=identicon&r=PG", "display_name": "Adam Straughan", "link": "https://stackoverflow.com/users/14019/adam-straughan"}, "is_accepted": true, "score": 3, "last_activity_date": 1496130943, "creation_date": 1496130943, "answer_id": 44256618, "question_id": 44256484, "link": "https://stackoverflow.com/questions/44256484/unmarshall-json-reference-types/44256618#44256618", "title": "Unmarshall json reference types", "body": "<p>The json you have posted in your example looks like it is missing <code>F1</code> in the body?</p>\n\n<p><a href=\"https://play.golang.org/p/Fl-lhH2y3X\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Fl-lhH2y3X</a></p>\n\n<p><code>\nb := []byte(`{\"F1\":{\"Val\":13}}`)\n</code></p>\n"}], "owner": {"reputation": 1722, "user_id": 5151792, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/463805ba3eae4866f5b40151249db4e4?s=128&d=identicon&r=PG&f=1", "display_name": "aicastell", "link": "https://stackoverflow.com/users/5151792/aicastell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 44256618, "answer_count": 1, "score": -1, "last_activity_date": 1496131903, "creation_date": 1496130525, "last_edit_date": 1496131903, "question_id": 44256484, "link": "https://stackoverflow.com/questions/44256484/unmarshall-json-reference-types", "title": "Unmarshall json reference types", "body": "<p>I'm trying to write a working example to test \"Reference Types\" section of <a href=\"https://blog.golang.org/json-and-go\" rel=\"nofollow noreferrer\">this link</a>.</p>\n\n<p>But I'm unable to understand how this should work. The example I'm trying to write without success is provided below, just for reference:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"encoding/json\"\n)\n\ntype Foo1 struct {\n    Val     int\n}\n\ntype Foo2 struct {\n    Name    string\n}\n\ntype IncomingMsg struct {\n    F1 *Foo1\n    F2 *Foo2\n}\n\nfunc main() {\n    b := []byte(`{\"F1\" : {\"Val\":13}}`)\n//  b := []byte(`{\"F2\" : {\"Name\":\"Hello\"}}`)\n\n    var msg IncomingMsg\n\n    err := json.Unmarshal(b, &amp;msg)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    if msg.F1 != nil {\n        fmt.Println(msg.F1.Val)\n    }\n\n    if msg.F2 != nil {\n        fmt.Println(msg.F2.Name)\n    }\n}\n</code></pre>\n\n<p>Can some of you with more experience with Go help with this issue?</p>\n\n<p>EDIT: The provided test has been updated, now is working as expected. Thank you Mr Adam for the answer provided, it helped me a lot to understand this issue! :)</p>\n"}, {"tags": ["go", "file-io", "concurrency", "parallel-processing", "filesystems"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1496129650, "post_id": 44255814, "comment_id": 75520546, "body": "Creating a goroutine for each file will not help you at all, I recommend you create a worker goroutines to process only directories, links: <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">blog.golang.org/pipelines</a> , <a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">gobyexample.com/worker-pools</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4223, "user_id": 710955, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GvorM.png?s=128&g=1", "display_name": "LeMoussel", "link": "https://stackoverflow.com/users/710955/lemoussel"}, "edited": false, "score": 0, "creation_date": 1496140586, "post_id": 44256314, "comment_id": 75527662, "body": "I don&#39;t master well producer-consumer pattern.  <code>producer()</code> send subfolders to walking &amp; <code>consumer()</code> print it in mycase. Number of goroutines walking folders is limited with the number of <code>consumer</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 4223, "user_id": 710955, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GvorM.png?s=128&g=1", "display_name": "LeMoussel", "link": "https://stackoverflow.com/users/710955/lemoussel"}, "edited": false, "score": 0, "creation_date": 1496140756, "post_id": 44256314, "comment_id": 75527768, "body": "@LeMoussel Yes, something like that. In my example instead of launching a new goroutine with <code>go</code>, you would just send the <code>path</code> on a channel &quot;monitored&quot; by consumers to take out paths to &quot;walk&quot; (by executing <code>walkDir()</code>)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 11, "last_activity_date": 1496130741, "last_edit_date": 1496130741, "creation_date": 1496130019, "answer_id": 44256314, "question_id": 44255814, "link": "https://stackoverflow.com/questions/44255814/concurrent-filesystem-scanning/44256314#44256314", "title": "Concurrent filesystem scanning", "body": "<p>You may do concurrent processing by modifying your <code>visit()</code> function to not go into subfolders, but launch a new goroutine for each subfolder.</p>\n\n<p>In order to do that, return the special <code>filepath.SkipDir</code> error from your <code>visit()</code> function if the entry is a directory. Don't forget to check if the <code>path</code> inside <code>visit()</code> is the subfolder the goroutine is ought to process, because that is also passed to <code>visit()</code>, and without this check you would launch goroutines endlessly for the initial folder.</p>\n\n<p>Also you will need some kind of \"counter\" of how many goroutines are still working in the background, for that you may use <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\"><code>sync.WaitGroup</code></a>.</p>\n\n<p>Here's a simple implementation of this:</p>\n\n<pre><code>var wg sync.WaitGroup\n\nfunc walkDir(dir string) {\n    defer wg.Done()\n\n    visit := func(path string, f os.FileInfo, err error) error {\n        if f.IsDir() &amp;&amp; path != dir {\n            wg.Add(1)\n            go walkDir(path)\n            return filepath.SkipDir\n        }\n        if f.Mode().IsRegular() {\n            fmt.Printf(\"Visited: %s File name: %s Size: %d bytes\\n\",\n                path, f.Name(), f.Size())\n        }\n        return nil\n    }\n\n    filepath.Walk(dir, visit)\n}\n\nfunc main() {\n    flag.Parse()\n    root := \"folder/to/walk\" //flag.Arg(0)\n\n    wg.Add(1)\n    walkDir(root)\n    wg.Wait()\n}\n</code></pre>\n\n<p><strong>Some notes:</strong></p>\n\n<p>Depending on the \"distribution\" of files among subfolders, this may not fully utilize your CPU / storage, as if for example 99% of all the files are in one subfolder, that goroutine will still take the majority of time.</p>\n\n<p>Also note that <code>fmt.Printf()</code> calls are serialized, so that will also slow down the process. I assume this was just an example, and in reality you will do some kind of processing / statistics in-memory. Don't forget to also protect concurrent access to variables accessed from your <code>visit()</code> function.</p>\n\n<p>Don't worry about the high number of subfolders. It is normal and the Go runtime is capable of handling even hundreds of thousands of goroutines.</p>\n\n<p>Also note that most likely the performance bottleneck will be your storage / hard disk speed, so you may not gain the performance you wish. After a certain point (your hard disk limit), you won't be able to improve performance.</p>\n\n<p>Also launching a new goroutine for each subfolder may not be optimal, it may be that you get better performance by limiting the number of goroutines walking your folders. For that, check out and use a worker pool:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/38170852/is-this-an-idiomatic-worker-thread-pool-in-go/38172204#38172204\">Is this an idiomatic worker thread pool in Go?</a></p>\n"}], "owner": {"reputation": 4223, "user_id": 710955, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GvorM.png?s=128&g=1", "display_name": "LeMoussel", "link": "https://stackoverflow.com/users/710955/lemoussel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2034, "favorite_count": 3, "accepted_answer_id": 44256314, "answer_count": 1, "score": 6, "last_activity_date": 1496131192, "creation_date": 1496128409, "last_edit_date": 1496131192, "question_id": 44255814, "link": "https://stackoverflow.com/questions/44255814/concurrent-filesystem-scanning", "title": "Concurrent filesystem scanning", "body": "<p>I want to obtain file information (file name &amp; size in bytes) for the files in a directory.  But there are a lot of sub-directory (~ 1000) and files (~40 000).</p>\n\n<p>Actually my solution is to use <a href=\"https://golang.org/src/path/filepath/path.go?s=9626:9671#L331\" rel=\"nofollow noreferrer\">filepath.Walk()</a> to obtain file information for each file. But this is quite long.</p>\n\n<pre><code>func visit(path string, f os.FileInfo, err error) error {\n    if f.Mode().IsRegular() {\n        fmt.Printf(\"Visited: %s File name: %s Size: %d bytes\\n\", path, f.Name(), f.Size())\n    }\n    return nil\n}\nfunc main() {\n    flag.Parse()\n    root := \"C:/Users/HERNOUX-06523/go/src/boilerpipe\" //flag.Arg(0)\n    filepath.Walk(root, visit)\n}\n</code></pre>\n\n<p>Is it possible to do parallel/concurrent processing using <a href=\"https://golang.org/src/path/filepath/path.go?s=9626:9671#L331\" rel=\"nofollow noreferrer\">filepath.Walk()</a>?</p>\n"}, {"tags": ["string", "go", "reflection", "struct"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8073826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0aa197f815a8513783196daf161185c?s=128&d=identicon&r=PG&f=1", "display_name": "Davide", "link": "https://stackoverflow.com/users/8073826/davide"}, "edited": false, "score": 0, "creation_date": 1496134191, "post_id": 44255582, "comment_id": 75523227, "body": "Thank you for tips Icza. I know there was errors during assegnation because i tried to create &quot;dummy&quot; code for example and I did it in a very short time :) . BTW I got where my erorrs were. Thank you"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1496127943, "last_edit_date": 1496127943, "creation_date": 1496127629, "answer_id": 44255582, "question_id": 44255344, "link": "https://stackoverflow.com/questions/44255344/using-reflection-setstring/44255582#44255582", "title": "Using reflection SetString", "body": "<p>Multiple errors. Let's iterate over them.</p>\n\n<p>First, you pass a value of <code>ProductionInfo</code> and not a value of <code>Entry</code> whose field you want to modify, so first change it to:</p>\n\n<pre><code>SetField(source.StructA[0], \"Field1\", \"NEW_VALUE\")\n</code></pre>\n\n<p>Next, you are passing a (non-pointer) value. You can't modify the fields of a non-pointer struct with reflection, because that would only modify a copy which would be discarded. In order to avoid this (and further confusion), this is not allowed (<code>CanSet()</code> returns <code>false</code>). So you have to pass a pointer to the struct:</p>\n\n<pre><code>SetField(&amp;source.StructA[0], \"Field1\", \"NEW_VALUE\")\n</code></pre>\n\n<p>Now inside <code>SetField()</code> the <code>reflect.ValueOf(source)</code> will describe the passed pointer. You may use <a href=\"https://golang.org/pkg/reflect/#Value.Elem\" rel=\"nofollow noreferrer\"><code>Value.Elem()</code></a> to navigate to the <a href=\"https://golang.org/pkg/reflect/#Value\" rel=\"nofollow noreferrer\"><code>reflect.Value</code></a> of the pointed object (the struct value):</p>\n\n<pre><code>v := reflect.ValueOf(source).Elem()\n</code></pre>\n\n<p>And now it works. Modified code:</p>\n\n<pre><code>func SetField(source interface{}, fieldName string, fieldValue string) {\n    v := reflect.ValueOf(source).Elem()\n\n    fmt.Println(v.FieldByName(fieldName).CanSet())\n\n    if v.FieldByName(fieldName).CanSet() {\n        v.FieldByName(fieldName).SetString(fieldValue)\n    }\n}\n\nfunc main() {\n    source := ProductionInfo{}\n    source.StructA = append(source.StructA, Entry{Field1: \"A\", Field2: 2})\n\n    fmt.Println(\"Before: \", source.StructA[0])\n    SetField(&amp;source.StructA[0], \"Field1\", \"NEW_VALUE\")\n    fmt.Println(\"After: \", source.StructA[0])\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/L-Uvxdg8sy\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Before:  {A 2}\ntrue\nAfter:  {NEW_VALUE 2}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8073826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0aa197f815a8513783196daf161185c?s=128&d=identicon&r=PG&f=1", "display_name": "Davide", "link": "https://stackoverflow.com/users/8073826/davide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1470, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1496128083, "creation_date": 1496126883, "last_edit_date": 1496128083, "question_id": 44255344, "link": "https://stackoverflow.com/questions/44255344/using-reflection-setstring", "title": "Using reflection SetString", "body": "<p>I have a struct like this one:</p>\n\n<pre><code>type ProductionInfo struct {\n    StructA []Entry\n}\n\ntype Entry struct {\n    Field1 string\n    Field2 int\n}\n</code></pre>\n\n<p>I would like to change the value of <code>Field1</code> using reflection but the reflect object returned always <code>CanSet() = false</code>. What can I do? See playground example.</p>\n\n<p><a href=\"https://play.golang.org/p/eM_KHC3kQ5\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eM_KHC3kQ5</a></p>\n\n<p>Here is the code:</p>\n\n<pre><code>func SetField(source interface{}, fieldName string, fieldValue string) {\n    v := reflect.ValueOf(source)\n    tt := reflect.TypeOf(source)\n\n    for k := 0; k &lt; tt.NumField(); k++ {\n        fieldValue := reflect.ValueOf(v.Field(k))\n\n        fmt.Println(fieldValue.CanSet())\n        if fieldValue.CanSet() {\n            fieldValue.SetString(fieldValue.String())\n        }\n    }\n}\n\nfunc main() {\n    source := ProductionInfo{}\n    source.StructA = append(source.StructA, Entry{Field1: \"A\", Field2: 2})\n\n    SetField(source, \"Field1\", \"NEW_VALUE\")\n}\n</code></pre>\n"}, {"tags": ["spring", "go"], "comments": [{"owner": {"reputation": 6480, "user_id": 1267140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UOHte.jpg?s=128&g=1", "display_name": "Havelock", "link": "https://stackoverflow.com/users/1267140/havelock"}, "edited": false, "score": 1, "creation_date": 1496128396, "post_id": 44254619, "comment_id": 75519689, "body": "There&#39;s facebook&#39;s <a href=\"https://github.com/facebookgo/inject\" rel=\"nofollow noreferrer\">dependency injection lib</a>, but I&#39;m still not very keen on dep injection to be honest, since it&#39;s prone to runtime (nil pointer type of) errors, where I&#39;d prefer compile time errors."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496151429, "post_id": 44254619, "comment_id": 75535688, "body": "Runtime-configured dependency injection seems very un-Go-like to me, it completely abandons the compile-time safety and intentional simplicity that are foundational to Go."}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": false, "score": 3, "last_activity_date": 1496146381, "last_edit_date": 1496146381, "creation_date": 1496145129, "answer_id": 44261509, "question_id": 44254619, "link": "https://stackoverflow.com/questions/44254619/in-golang-how-to-get-an-instance-of-interface-by-name-in-config-file/44261509#44261509", "title": "In golang how to get an instance of interface by name in config file", "body": "<p>I think your approach is correct, since you can not instantiate a type if it's not defined during compilation. Otherwise, you need to use <a href=\"https://golang.org/pkg/plugin/\" rel=\"nofollow noreferrer\"><code>plugin</code></a>. </p>\n\n<p>I'm not sure whether it's <em>easier</em> or not, but if you want the custom structs being organized in different packages, you can use similar approach as <code>database/sql</code>. </p>\n\n<ol>\n<li><p>Define a factory package which consists of <code>Factory</code> interface and manage known factories. This package should export <code>Register</code> function for registering custom factory, and <code>New</code> function for creating instance of a given type. For example:</p>\n\n<pre><code>package factory\n\nimport (\n    \"strings\"\n    \"sync\"\n)\n\ntype Factory interface {\n    New(name string) (interface{}, bool)\n}\n\nvar (\n    mu        sync.RWMutex\n    factories = make(map[string]Factory)\n)\n\nfunc Register(pkgName string, f Factory) {\n    mu.Lock()\n    defer mu.Unlock()\n\n    if f == nil {\n        panic(\"Factory is nil\")\n    }\n    if _, exist := factories[pkgName]; exist {\n        panic(\"Factory already registered\")\n    }\n\n    factories[pkgName] = f\n}\n\nfunc New(typeName string) (interface{}, bool) {\n    items := strings.Split(typeName, \".\")\n    if len(items) &gt;= 2 {\n        mu.RLock()\n        defer mu.RUnlock()\n        if f, exist := factories[items[0]]; exist {\n            return f.New(items[1])\n        }\n    }\n    return nil, false\n}\n</code></pre></li>\n<li><p>Create package which consists of your custom struct and implementing the <code>Factory</code> interface. Register the factory during initalization i.e. in <code>init()</code> function, e.g</p>\n\n<pre><code>package pkga\n\nimport \"path/to/your/factory\"\n\ntype thisFactory struct {\n}\n\ntype Alpha struct{}\ntype Beta struct{}\ntype Gamma struct{}\n\nfunc (f *thisFactory) New(name string) (interface{}, bool) {\n    switch name {\n    case \"Alpha\":\n        return &amp;Alpha{}, true\n    case \"Beta\":\n        return &amp;Beta{}, true\n    case \"Gamma\":\n        return &amp;Gamma{}, true\n    }\n    return nil, false\n}\n\nfunc init() {\n    factory.Register(\"pkga\", &amp;thisFactory{})\n}\n</code></pre></li>\n<li><p>Repeat step (2) as you need.</p></li>\n<li><p>Finally, in your main package, you can create an instance as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"path/to/your/factory\"\n    _ \"path/to/custom/pkga\"\n    _ \"path/to/custom/pkgb\"\n    //add more packages ...\n)\n\nfunc main() {\n    a, _ := factory.New(\"pkga.Alpha\")\n    b, _ := factory.New(\"pkgb.Beta\")\n    c, _ := factory.New(\"pkga.Gamma\")\n\n    fmt.Printf(\"%T %T %T\\n\", a, b, c)\n}\n</code></pre></li>\n</ol>\n\n<p>Update: a working example is available <a href=\"https://github.com/ipsusila/so/tree/master/inject\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 7912363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d808fa3e4c79c719aa591de11de431dc?s=128&d=identicon&r=PG&f=1", "display_name": "jason", "link": "https://stackoverflow.com/users/7912363/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1433, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496146381, "creation_date": 1496124258, "question_id": 44254619, "link": "https://stackoverflow.com/questions/44254619/in-golang-how-to-get-an-instance-of-interface-by-name-in-config-file", "title": "In golang how to get an instance of interface by name in config file", "body": "<p>I want to know how can I inject dependency flexibly in golang just like java spring, Which is if I want to change a instance of an interface all I have to do is just to change some config file.</p>\n\n<p>First I want to find some function like <strong>getTypeByName()</strong>, so I can just give a struct name like \"mypkg.structName\" in config file and load that struct by the function, but it seems that there is no such function in golang.</p>\n\n<p>And now the most doable way i can think is to create a loader model to generate a <a href=\"https://play.golang.org/p/igmssSD9k2\" rel=\"nofollow noreferrer\">struct register file</a> to load all custom struct.</p>\n\n<p>But I want to know is there have a easier way to do that, all is there some golang-style way to implement this flexibility? </p>\n"}, {"tags": ["go", "maps", "channels"], "comments": [{"owner": {"reputation": 1757, "user_id": 4544967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DOtWk.jpg?s=128&g=1", "display_name": "Hamza Anis", "link": "https://stackoverflow.com/users/4544967/hamza-anis"}, "edited": false, "score": 0, "creation_date": 1496114987, "post_id": 44252852, "comment_id": 75514234, "body": "To ensure synchronous access you can use <a href=\"https://github.com/kamilsk/semaphore\" rel=\"nofollow noreferrer\">Semaphore package in Go</a>"}, {"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "reply_to_user": {"reputation": 1757, "user_id": 4544967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DOtWk.jpg?s=128&g=1", "display_name": "Hamza Anis", "link": "https://stackoverflow.com/users/4544967/hamza-anis"}, "edited": false, "score": 0, "creation_date": 1496116956, "post_id": 44252852, "comment_id": 75514725, "body": "@Hamza Thanks for the suggestion. In my case a general purpose semaphore sacrifices the ability communicate (send and receive typed data over the channel). As a desirable side effect, the channel blocks access to the map, assuring async access . None of the access functions qualify as &quot;heavy lifting&quot;. The code is working, My only concern is the repetition required to check that a new entry was added to the map."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "edited": false, "score": 0, "creation_date": 1496159441, "post_id": 44253556, "comment_id": 75541587, "body": "Thanks for this. I had started out planning to use a mutex for syncing. Then I read that for higher level applications using channels are better, especially when sharing a data value. I clearly misunderstood. Back to plan A."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1496157555, "last_edit_date": 1496157555, "creation_date": 1496119258, "answer_id": 44253556, "question_id": 44252852, "link": "https://stackoverflow.com/questions/44252852/is-there-a-better-way-to-use-channels-to-ensure-synchronous-access-to-the-map/44253556#44253556", "title": "Is there a better way to use channels to ensure synchronous access to the map?", "body": "<p>Use a <a href=\"http://godoc.org/sync#Mutex\" rel=\"nofollow noreferrer\">mutex</a> to protect the map. A mutex is often simpler than using channels &amp; goroutines to protect a resource.</p>\n\n<pre><code>var (\n  mu sync.Mutex\n  cache = make(map[string]*SessionData)\n)\n\nfunc GetSessionFromCache(sessTkn string) *SessionData {\n  mu.Lock()\n  defer mu.Unlock()\n  sd := cache[sessTkn]\n  if sd != nil {\n      return sd\n  }\n  sd := &amp;SessionData{\n     // initialize new value here\n  }\n  cache[sessTkn] = sd\n  return sd\n}\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>sd := session.GetSessionFromCache(sessTkn) \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "edited": false, "score": 0, "creation_date": 1496159544, "post_id": 44256399, "comment_id": 75541667, "body": "Thanks for the added information as to why channels are not the way to go. I need to do some more study to fully understand exactly what channels do and when their use is appropriate."}], "tags": [], "owner": {"reputation": 3172, "user_id": 1290581, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/22cb75bc69d807d5597d7b9922a3775c?s=128&d=identicon&r=PG", "display_name": "garbagecollector", "link": "https://stackoverflow.com/users/1290581/garbagecollector"}, "is_accepted": false, "score": 1, "last_activity_date": 1496130242, "creation_date": 1496130242, "answer_id": 44256399, "question_id": 44252852, "link": "https://stackoverflow.com/questions/44252852/is-there-a-better-way-to-use-channels-to-ensure-synchronous-access-to-the-map/44256399#44256399", "title": "Is there a better way to use channels to ensure synchronous access to the map?", "body": "<p>Using channels for this particular case have no additional benefit.  If you think about it, even with creating new channels, you can still only have one goroutine that can access the map. Since there is no concurrency benefit here, just use <code>sync.Mutex</code>.</p>\n\n<pre><code>package session\n\nimport \"sync\"\n\nvar cache = struct {\n  sync.Mutex\n  list map[string]*SessionData\n}{\n  list: make(map[string]*SessionData),\n}\n\nfunc GetSessionFromCache(token string) *SessionData {\n  cache.Lock()\n  defer cache.Unlock()\n  return cache.list[token]\n}\n</code></pre>\n\n<p>Then, no need for a new goroutine.  Just call it directly.</p>\n\n<pre><code>sd := session.GetSessionFromCache(sessTkn) \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 44253556, "answer_count": 2, "score": 0, "last_activity_date": 1496157555, "creation_date": 1496114206, "last_edit_date": 1496115529, "question_id": 44252852, "link": "https://stackoverflow.com/questions/44252852/is-there-a-better-way-to-use-channels-to-ensure-synchronous-access-to-the-map", "title": "Is there a better way to use channels to ensure synchronous access to the map?", "body": "<p>I'm using Go maps as an in memory cache and channels to ensure synchronous access.</p>\n\n<p>My \"session\" package defines the cache as: map[string]*SessionData</p>\n\n<p>SessionData is a struct also defined in the package, along with other access functions as seen in the code.</p>\n\n<pre><code>GetWebPage(rw http.ResponseWriter, req *http.Request) {\nvar sd *session.SessionData\nvar sessTkn string\n\ncookie, err := req.Cookie(\"sesstoken\")\n\nif err == nil { // cookie found\n    sessTkn = cookie.Value\n    // Check for cache entry for this token,\n    // using a channel to protect the map and return\n    // a pointer to the cached data if it exists\n    sdc := make(chan *session.SessionData, 1)\n    go session.GetSessionFromCache(sessTkn, sdc)\n    sd = &lt;-sdc\n\n    if sd == nil { // sessTkn not in the cache\n\n        // This is test data to simplify example \n        sv := make([]string, 4)\n        sv[0] = sessTkn\n        iv := make([]int, 3)\n        iv[0] = 100\n        iv[1] = 1000\n\n        sdc := make(chan *session.SessionData, 1)\n        go session.NewSessionData(sv, iv, false, false, sdc)\n        session.SC[sessTkn] = &lt;-sdc\n    }\n\n// Is this necessary? Is there a better way?\n// ---------------------------------------      \n    if sd == nil {\n        sdc = make(chan *session.SessionData, 1)\n        go session.GetSessionFromCache(sessTkn, sdc)\n        sd = &lt;-sdc      \n    }\n// ---------------------------------------      \n\n    fmt.Println(sd) // just to prove that it works in both cases\n}   \n// The rest of the handler code follows\n</code></pre>\n"}, {"tags": ["xml", "go", "marshalling"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1496097915, "last_edit_date": 1496097915, "creation_date": 1496097627, "answer_id": 44251058, "question_id": 44250935, "link": "https://stackoverflow.com/questions/44250935/xml-marshal-not-working-in-this-go-example/44251058#44251058", "title": "XML Marshal not working in this Go example", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">Exported identifiers</a></p>\n  \n  <p>An identifier may be exported to permit access to it from another\n  package. An identifier is exported if both:</p>\n  \n  <ol>\n  <li>the first character of the identifier's name is a Unicode upper case letter (Unicode class \"Lu\"); and</li>\n  <li>the identifier is declared in the package block or it is a field name or method name.</li>\n  </ol>\n  \n  <p>All other identifiers are not exported.</p>\n</blockquote>\n\n<p>Export your <code>Record</code> struct field names (first character upper case) to permit access to them from the <code>xml</code> package. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/xml\"\n\ntype Record struct {\n    A int64 `xml:\"a,omitempty\"`\n    B int64 `xml:\"b,omitempty\"`\n    C int64 `xml:\"c,omitempty\"`\n}\n\nfunc main() {\n    candiateXML := &amp;Record{1, 2, 3}\n    fmt.Printf(\"%v\\n\", candiateXML.A)\n    fmt.Printf(\"%v\\n\", candiateXML.B)\n    fmt.Printf(\"%v\\n\", candiateXML.C)\n\n    x, err := xml.MarshalIndent(candiateXML, \"\", \"  \")\n    if err != nil {\n        return\n    }\n    fmt.Printf(\"%s\\n\", x)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1\n2\n3\n&lt;Record&gt;\n  &lt;a&gt;1&lt;/a&gt;\n  &lt;b&gt;2&lt;/b&gt;\n  &lt;c&gt;3&lt;/c&gt;\n&lt;/Record&gt;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8083507, "user_type": "registered", "profile_image": "https://graph.facebook.com/1397725116933187/picture?type=large", "display_name": "Ankit Agarwal", "link": "https://stackoverflow.com/users/8083507/ankit-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 1, "accepted_answer_id": 44251058, "answer_count": 1, "score": 0, "last_activity_date": 1496098358, "creation_date": 1496096684, "last_edit_date": 1496098358, "question_id": 44250935, "link": "https://stackoverflow.com/questions/44250935/xml-marshal-not-working-in-this-go-example", "title": "XML Marshal not working in this Go example", "body": "<p>In this code the returned element x does not have body - I believe the MarshalIndent is not working properly.\nI will not be able the struct Record.\nIs there any work around so that this can return the value as expected.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/xml\"\nimport \"time\"\n\ntype Record struct {\n    a int64     `xml:\"a,omitempty\"`\n    b int64     `xml:\"b,omitempty\"`\n    c int64     `xml:\"c,omitempty\"`\n    d int64     `xml:\"d,omitempty\"`\n    e int64     `xml:\"e,omitempty\"`\n    f string    `xml:\"f,omitempty\"`\n    g string    `xml:\"g,omitempty\"`\n    h string    `xml:\"h,omitempty\"`\n    i string    `xml:\"i,omitempty\"`\n    j string    `xml:\"j,omitempty\"`\n    k time.Time `xml:\"k,omitempty\"`\n    l time.Time `xml:\"l,omitempty\"`\n    m string    `xml:\"m,omitempty\"`\n    n string    `xml:\"n,omitempty\"`\n    o string    `xml:\"o,omitempty\"`\n    p int64     `xml:\"p,omitempty\"`\n}\n\nfunc main() {\n    temp, _ := time.Parse(time.RFC3339, \"\")\n    candiateXML := &amp;Record{1, 2, 3, 4, 5, \"6\", \"7\", \"8\", \"9\", \"10\", temp, temp, \"13\", \"14\", \"15\", 16}\n    fmt.Printf(\"%v\\n\", candiateXML.a)\n    fmt.Printf(\"%v\\n\", candiateXML.b)\n    fmt.Printf(\"%v\\n\", candiateXML.c)\n    fmt.Printf(\"%v\\n\", candiateXML.d)\n    fmt.Printf(\"%v\\n\", candiateXML.e)\n    fmt.Printf(\"%s\\n\", candiateXML.f)\n    fmt.Printf(\"%s\\n\", candiateXML.g)\n    fmt.Printf(\"%s\\n\", candiateXML.h)\n    fmt.Printf(\"%s\\n\", candiateXML.i)\n    fmt.Printf(\"%s\\n\", candiateXML.j)\n    fmt.Printf(\"%d\\n\", candiateXML.k)\n    fmt.Printf(\"%d\\n\", candiateXML.l)\n    fmt.Printf(\"%s\\n\", candiateXML.m)\n    fmt.Printf(\"%s\\n\", candiateXML.n)\n    fmt.Printf(\"%s\\n\", candiateXML.o)\n    fmt.Printf(\"%v\\n\", candiateXML.p)\n\n    x, err := xml.MarshalIndent(candiateXML, \"\", \"  \")\n    if err != nil {\n        return\n    }\n    //why this is not printing properly\n    fmt.Printf(\"%s\\n\", x)\n}\n</code></pre>\n\n<p>The MarshalIndent does not return the expected result.</p>\n"}, {"tags": ["go", "clojure"], "comments": [{"owner": {"reputation": 24733, "user_id": 1822379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/lrflF.jpg?s=128&g=1", "display_name": "Alan Thompson", "link": "https://stackoverflow.com/users/1822379/alan-thompson"}, "edited": false, "score": 1, "creation_date": 1496095879, "post_id": 44250700, "comment_id": 75510269, "body": "Unless you have a very unusual use-case, you don&#39;t need to worry about the cost of thread and/or pseudo-thread switching.  Your own code will normally be consuming 90-99% of the cpu time."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1496099430, "post_id": 44250700, "comment_id": 75511098, "body": "&quot;The runtime&quot; isn&#39;t a magical place where performance comes for free. The fact that Clojure does this in Clojure is not terribly impactful: it can similar JVM bytecode to that produced by javac, when performance matters."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1496106763, "post_id": 44250700, "comment_id": 75512485, "body": "If you&#39;re curious about the performance of these constructs, I&#39;d suggest building some toy programs to explore it. The two environments work so differently that whether two things are &#39;equivalent&#39; is a question of definitions as much as anything, and it&#39;s hard to guess what&#39;s faster (or, as Alan Thompson notes, whether either will cost enough to really matter to you)."}], "answers": [{"tags": [], "owner": {"reputation": 10209, "user_id": 63009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55878d0196b91803f9cb2c372b0551d3?s=128&d=identicon&r=PG", "display_name": "Stuart Sierra", "link": "https://stackoverflow.com/users/63009/stuart-sierra"}, "is_accepted": true, "score": 2, "last_activity_date": 1497039281, "creation_date": 1497039281, "answer_id": 44466040, "question_id": 44250700, "link": "https://stackoverflow.com/questions/44250700/comparing-usage-of-clojures-go-blocks-vs-gos-goroutines/44466040#44466040", "title": "Comparing usage of Clojure&#39;s go-blocks vs. Go&#39;s goroutines", "body": "<p>Broadly speaking, yes, the behavior of Clojure's <code>go</code> macro is similar to \"goroutines\" when using the \"parking\" <code>&lt;!</code> and <code>&gt;!</code>.</p>\n\n<p>However, any performance effects are likely to be highly-specific to both the workload and the environment: operating system, number of cores, heap size, etc.</p>\n\n<p>Clojure's <code>go</code> macro compiles its contents into a state machine composed of lots of little functions, which are <a href=\"https://github.com/clojure/core.async/blob/105acd5b40a66b6d1c80271a30ae273c6933c5bd/src/main/clojure/clojure/core/async/impl/dispatch.clj#L18\" rel=\"nofollow noreferrer\">dispatched</a> through a standard Java <a href=\"https://github.com/clojure/core.async/blob/105acd5b40a66b6d1c80271a30ae273c6933c5bd/src/main/clojure/clojure/core/async/impl/exec/threadpool.clj#L24\" rel=\"nofollow noreferrer\">thread pool</a>. There isn't any other scheduling implemented in the Clojure implementation right now.</p>\n\n<p>The Go language has its own internal scheduler for \"goroutines,\" which may be able to do more sophisticated scheduling based on internal runtime knowledge. It also provides runtime inspection of \"goroutines\" which is not possible with Clojure's <code>go</code> macro.</p>\n"}], "owner": {"reputation": 715, "user_id": 3076234, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2ea4ede4673ba2e3e7d9b34de3ebd063?s=128&d=identicon&r=PG&f=1", "display_name": "zlatanski", "link": "https://stackoverflow.com/users/3076234/zlatanski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 44466040, "answer_count": 1, "score": 1, "last_activity_date": 1497039281, "creation_date": 1496094658, "question_id": 44250700, "link": "https://stackoverflow.com/questions/44250700/comparing-usage-of-clojures-go-blocks-vs-gos-goroutines", "title": "Comparing usage of Clojure&#39;s go-blocks vs. Go&#39;s goroutines", "body": "<p>I'm trying to understand the implementation characteristics and the resulting performance of Clojure's go-blocks vs. Go's goroutines.</p>\n\n<p>In Clojure <code>&gt;!!</code> and <code>&lt;!!</code> block the current thread, meaning that they can only be used when threads are created explicitly (otherwise the \"only\" main thread is blocked). <code>&gt;!</code> and <code>&lt;!</code> are parking because the <code>go</code> macro manages an implicit state machine that juggles multiple \"processes\".</p>\n\n<p>However, in Go this is all hidden in the runtime, where goroutines play both roles. </p>\n\n<p>So is this correct to say that Clojure code would be equivalent to Go when only using the parking versions? Since there's a thread-pool in the <code>go</code> macro, this is kind-of like Go's thread pool underlying goroutines. Except that performance will be worse, because Go does this in the runtime while Clojure manages it explicitly in Clojure code?</p>\n"}, {"tags": ["arrays", "csv", "matrix", "go"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1496093953, "post_id": 44250414, "comment_id": 75509674, "body": "The error saying that you can&#39;t create an integer from empty data. That means that at some point this line <code>valInt, err := strconv.Atoi(val)</code> the value in <code>val</code> is equal to &quot;&quot;.  What integer would <code>&quot;&quot;</code> be converted to?  Either make sure all the cells are correct, add an if statement above <code>if val != &quot;&quot; {do something}</code>, or don&#39;t <code>log.Fatal</code> instead make <code>valInt = 0</code> or <code>-1</code> to indicate an issue."}], "answers": [{"tags": [], "owner": {"reputation": 309, "user_id": 7227903, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf4ba9ae8e465802dc5162e9ce386aa0?s=128&d=identicon&r=PG&f=1", "display_name": "benjano", "link": "https://stackoverflow.com/users/7227903/benjano"}, "is_accepted": false, "score": 0, "last_activity_date": 1496093991, "creation_date": 1496093991, "answer_id": 44250610, "question_id": 44250414, "link": "https://stackoverflow.com/questions/44250414/loading-matrix-in-from-csv-file-golang/44250610#44250610", "title": "Loading matrix in from csv file - golang", "body": "<p>As mentions in the comments above the error was due to a missing value in my csv file. </p>\n\n<p>Once the file was amended the error is now gone.</p>\n"}, {"comments": [{"owner": {"reputation": 309, "user_id": 7227903, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf4ba9ae8e465802dc5162e9ce386aa0?s=128&d=identicon&r=PG&f=1", "display_name": "benjano", "link": "https://stackoverflow.com/users/7227903/benjano"}, "edited": false, "score": 0, "creation_date": 1496095255, "post_id": 44250628, "comment_id": 75510092, "body": "Hi, thanks for the answer. I&#39;ve added a little more to my question regarding outputting the resulting matrix."}, {"owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "reply_to_user": {"reputation": 309, "user_id": 7227903, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf4ba9ae8e465802dc5162e9ce386aa0?s=128&d=identicon&r=PG&f=1", "display_name": "benjano", "link": "https://stackoverflow.com/users/7227903/benjano"}, "edited": false, "score": 0, "creation_date": 1496100956, "post_id": 44250628, "comment_id": 75511432, "body": "@benjano In the case of the CSV Writer method, it takes a <code>[]string</code> and currently you are attempting to pass a <code>string. Eliminate the inner loop, and replace it with </code>writer.Write(line2)`"}, {"owner": {"reputation": 309, "user_id": 7227903, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf4ba9ae8e465802dc5162e9ce386aa0?s=128&d=identicon&r=PG&f=1", "display_name": "benjano", "link": "https://stackoverflow.com/users/7227903/benjano"}, "edited": false, "score": 0, "creation_date": 1496101488, "post_id": 44250628, "comment_id": 75511545, "body": "Hi, I&#39;ve done what I believe you have suggested but an error is still given. Any further tips?"}, {"owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "reply_to_user": {"reputation": 309, "user_id": 7227903, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf4ba9ae8e465802dc5162e9ce386aa0?s=128&d=identicon&r=PG&f=1", "display_name": "benjano", "link": "https://stackoverflow.com/users/7227903/benjano"}, "edited": false, "score": 0, "creation_date": 1496101733, "post_id": 44250628, "comment_id": 75511585, "body": "<code>for _, line2</code> instead of <code>for line2</code> learn more about that here: <a href=\"https://golang.org/doc/effective_go.html#for\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#for</a>"}, {"owner": {"reputation": 309, "user_id": 7227903, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf4ba9ae8e465802dc5162e9ce386aa0?s=128&d=identicon&r=PG&f=1", "display_name": "benjano", "link": "https://stackoverflow.com/users/7227903/benjano"}, "edited": false, "score": 0, "creation_date": 1496101917, "post_id": 44250628, "comment_id": 75511625, "body": "cannot use line2 (type [1500]int) as type []string in argument to writer.Write - The following error is given now, is it right that my range is blank, blank is a global matrix variable which my resulting answers are written too. I will go through the golang doc now to understand it better."}, {"owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "reply_to_user": {"reputation": 309, "user_id": 7227903, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf4ba9ae8e465802dc5162e9ce386aa0?s=128&d=identicon&r=PG&f=1", "display_name": "benjano", "link": "https://stackoverflow.com/users/7227903/benjano"}, "edited": false, "score": 0, "creation_date": 1496129021, "post_id": 44250628, "comment_id": 75520097, "body": "Looks like that is a slice of <code>int</code> so you need to convert that into a slice of <code>string</code> before you can pass it to the <code>Write</code> method. You can use <code>strconv.FormatInt</code> for that"}, {"owner": {"reputation": 309, "user_id": 7227903, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf4ba9ae8e465802dc5162e9ce386aa0?s=128&d=identicon&r=PG&f=1", "display_name": "benjano", "link": "https://stackoverflow.com/users/7227903/benjano"}, "edited": false, "score": 0, "creation_date": 1496156767, "post_id": 44250628, "comment_id": 75539791, "body": "FormatInt requires a int64 to be passed into it, my matrix is a 2D array of type int with a size of constant n. Is FormatInt what I require, looking at the documentation it doesn&#39;t seem correct?"}, {"owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "reply_to_user": {"reputation": 309, "user_id": 7227903, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf4ba9ae8e465802dc5162e9ce386aa0?s=128&d=identicon&r=PG&f=1", "display_name": "benjano", "link": "https://stackoverflow.com/users/7227903/benjano"}, "edited": false, "score": 0, "creation_date": 1496166088, "post_id": 44250628, "comment_id": 75545240, "body": "You can cast from int to int64, assuming x is some int: <code>newx := int64(x)</code>"}], "tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": true, "score": 1, "last_activity_date": 1496094147, "creation_date": 1496094147, "answer_id": 44250628, "question_id": 44250414, "link": "https://stackoverflow.com/questions/44250414/loading-matrix-in-from-csv-file-golang/44250628#44250628", "title": "Loading matrix in from csv file - golang", "body": "<p>This means one of the cells of your CSV is blank, I reproduced the error with this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/csv\"\n    \"log\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    matrix1 := [5][5]int{}\n\n    file := strings.NewReader(\"1,2,3,4,5\\n6,7,8,,0\")\n    lines, _ := csv.NewReader(file).ReadAll()\n    for i, line := range lines {\n        for j, val := range line {\n            valInt, err := strconv.Atoi(val)\n            if err != nil {\n                log.Fatal(err)\n            }\n            matrix1[i][j] = valInt\n        }\n    }\n}\n</code></pre>\n\n<p>If you are ok with treating blank cells as 0 this will get you past the error:</p>\n\n<pre><code>func main() {\n    matrix1 := [5][5]int{}\n\n    file := strings.NewReader(\"1,2,3,4,5\\n6,7,8,,0\")\n    lines, _ := csv.NewReader(file).ReadAll()\n    for i, line := range lines {\n        for j, val := range line {\n            var valInt int\n            var err error\n            if val == \"\" {\n                valInt = 0\n            } else {\n                valInt, err = strconv.Atoi(val)\n            }\n            if err != nil {\n                log.Fatal(err)\n            }\n            matrix1[i][j] = valInt\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 7227903, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf4ba9ae8e465802dc5162e9ce386aa0?s=128&d=identicon&r=PG&f=1", "display_name": "benjano", "link": "https://stackoverflow.com/users/7227903/benjano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1079, "favorite_count": 0, "accepted_answer_id": 44250628, "answer_count": 2, "score": 1, "last_activity_date": 1496101460, "creation_date": 1496092739, "last_edit_date": 1496101460, "question_id": 44250414, "link": "https://stackoverflow.com/questions/44250414/loading-matrix-in-from-csv-file-golang", "title": "Loading matrix in from csv file - golang", "body": "<p>I'm writing a program that performs math on matrixes. I want to load them in from a csv file and have the following code:</p>\n\n<pre><code>    file, err := os.Open(\"matrix1.csv\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer file.Close()\nlines, _ := csv.NewReader(file).ReadAll()\nfor i, line := range lines {\n    for j, val := range line {\n        valInt, err := strconv.Atoi(val)\n        if err != nil {\n            log.Fatal(err)\n        }\n        matrix1[i][j] = valInt\n    }\n}\n</code></pre>\n\n<p>However the strconv code is throwing an error:</p>\n\n<pre><code>strconv.ParseInt: parsing \"\": invalid syntax\n</code></pre>\n\n<p>It appears that everything else in the code is correct, does anyone have any ideas on how to solve this error?</p>\n\n<p>EDIT: I'm now trying to work on outputting my result to a new csv file.</p>\n\n<p>I have the following code:</p>\n\n<pre><code>    file2, err := os.Create(\"result.csv\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer file1.Close()\n\nwriter := csv.NewWriter(file2)\nfor line2 := range blank {\n    writer.Write(line2)\n}\n\n}\n</code></pre>\n\n<p>}</p>\n\n<p>This gives the following error:</p>\n\n<pre><code> cannot use line2 (type int) as type []string in argument to writer.Write\n</code></pre>\n\n<p>Updated with the suggestions from comments however the above error is now seen.</p>\n"}, {"tags": ["unit-testing", "go", "dependency-injection"], "answers": [{"tags": [], "owner": {"reputation": 14127, "user_id": 641627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEgWh.jpg?s=128&g=1", "display_name": "alexbt", "link": "https://stackoverflow.com/users/641627/alexbt"}, "is_accepted": false, "score": 4, "last_activity_date": 1496158000, "last_edit_date": 1496158000, "creation_date": 1496103703, "answer_id": 44251740, "question_id": 44249410, "link": "https://stackoverflow.com/questions/44249410/unit-testing-http-handlers-in-golang-mocking-dependencies/44251740#44251740", "title": "Unit testing http handlers in golang mocking dependencies", "body": "<p>I personally changed my Router function into a method with a Receiver, so I can create Mock receivers:</p>\n\n<h3>Production code:</h3>\n\n<pre><code>func main(){\n    router := mux.NewRouter()\n    version.AddRouter(router, contextRoot)\n    someStruct := SomeStruct{SomeDependency{}}\n    router.HandleFunc(contextRoot, someStruct.HandleRequests).\n           Methods(http.MethodGet)\n}\n\nfunc (s SomeStruct) HandleRequests(writer http.ResponseWriter, reader *http.Request) {\n    ...\n}\n\nfunc (s SomeDependency) SomeFunctionCalledFromHandler(...) SomeReturnStruct {\n    ...\n    return SomeReturnStruct{}\n}\n</code></pre>\n\n<h3>Unit test:</h3>\n\n<pre><code>type mockWriter struct {}\ntype someMockDependency struct {}\nfunc Test_HandleRequest1(t *testing.T) {\n\n    someStructMockDeps := SomeStruct{someMockDependency{}}\n    someStructMockDeps.HandleRequests(mockWriter{}, &amp;http.Request{URL: &amp;url.URL{RawQuery:\"http://dummy-query.com\"}});\n\n    assert.Equal(...)\n}\nfunc (someMockDependency) SomeFunctionCalledFromHandler(...) SomeReturnStruct {\n    ...\n    return SomeReturnStruct{}\n}\n</code></pre>\n\n<h3>Integration test:</h3>\n\n<pre><code>func TestHandlerFuncIntg(t *testing.T) {\n    if testing.Short() {\n        println(\"skipping\")\n        t.Skip()\n     }\n\n    req, err := http.NewRequest(\"GET\", \"/hello?param=value\", nil)\n    if err != nil {\n        t.Fatal(err)\n    }\n\n    rr := httptest.NewRecorder()\n    someStructMockDeps := SomeStruct{someMockDependency{}}\n    handler :=   http.HandlerFunc(someStructMockDeps.HandleRequests)\n\n    handler.ServeHTTP(rr, req)\n\n    assert.Equal(t, http.StatusOK, rr.Code)\n    assert.Equal(t, \"This is my result\", rr.Body.String())\n}\n\nfunc (someMockDependency) SomeFunctionCalledFromHandler(...) SomeReturnStruct {\n    ...\n    return SomeReturnStruct{}\n}\n</code></pre>\n\n<p><code>SomeStruct</code> declares the dependencies (as Dependency Injection) so they can be overridden for tests.</p>\n"}], "owner": {"reputation": 1747, "user_id": 1223777, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e5d57bacf254409375e9d7b28f2ee952?s=128&d=identicon&r=PG", "display_name": "Subby", "link": "https://stackoverflow.com/users/1223777/subby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1813, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1496158000, "creation_date": 1496086537, "question_id": 44249410, "link": "https://stackoverflow.com/questions/44249410/unit-testing-http-handlers-in-golang-mocking-dependencies", "title": "Unit testing http handlers in golang mocking dependencies", "body": "<p>At the moment I try to establish best practices for unit testing go handlers.\nI need to mock dependencies, but therefore I have to be able to access / mock these dependencies.</p>\n\n<p>There I some solutions I do not want to consider like for example global variables / application state. Or having all handlers as functions of a struct holding the dependencies member variables.</p>\n\n<p>I was kind of satisfied with a solution where I injected the needed dependencies of a handler in the following way:</p>\n\n\n\n<pre class=\"lang-golang prettyprint-override\"><code>func helloHandler(db *DbService) http.HandlerFunc {\n  return func(w http.ResponseWriter, r *httpRequest) {\n    // handler code goes here\n  }\n}\n</code></pre>\n\n<p>Then I am able to provide this handler for routing:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>http.HandleFunc(\"/hello\", helloHander(myDbService))\n</code></pre>\n\n<p>I can also test it easily:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>helloHandler(myDbService)(req, respRecorder)\n</code></pre>\n\n<p>But when I use for example gorilla mux (what I haven't considered from the beginning) I get another problem.</p>\n\n<p>Gorilla/mux adds extra semantics like filtering by Method (GET / POST), providing path parameters etc.</p>\n\n<p>So I should need to test the resulting gorilla router.\nBut then I am again not able to inject my mock dependencies anymore.</p>\n\n<p>When I get the router back everything (dependencies) is already set up.</p>\n\n<p>But I also don't want to rebuild my Router in my tests because of DRY!</p>\n\n<p>So for now I don't really have a good solution for the problem of conveniently setting up my routes but also being able to mock the dependencies.</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["go", "viper-go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 1, "creation_date": 1496081042, "post_id": 44247901, "comment_id": 75504837, "body": "I guess that makes sense but then again it doesn&#39;t."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1496081447, "post_id": 44247901, "comment_id": 75505026, "body": "@kristen Might be worth reporting as a bug/misfeature. Smells like a quirk of the implementation rather than a feature."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 0, "last_activity_date": 1496079452, "creation_date": 1496079452, "answer_id": 44247901, "question_id": 44247616, "link": "https://stackoverflow.com/questions/44247616/replace-viper-map-key-without-replacing-entire-map/44247901#44247901", "title": "Replace viper map key without replacing entire map", "body": "<p>I'm going to guess it's because of this, from the docs on <a href=\"https://github.com/spf13/viper#accessing-nested-keys\" rel=\"nofollow noreferrer\">Accessing nested keys</a>.</p>\n\n<blockquote>\n  <p>However, if datastore.metric was overridden (by a flag, an environment variable, the Set() method, \u2026) with an immediate value, then all sub-keys of datastore.metric become undefined, they are \u201cshadowed\u201d by the higher-priority configuration level.</p>\n</blockquote>\n\n<p>So as soon as <code>people.bob</code> is set, <code>people</code> springs into existence and <code>people.*</code> are no longer considered unpopulated.</p>\n\n<p>I don't know how to work around it.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 44247901, "answer_count": 1, "score": 0, "last_activity_date": 1496079452, "creation_date": 1496078247, "question_id": 44247616, "link": "https://stackoverflow.com/questions/44247616/replace-viper-map-key-without-replacing-entire-map", "title": "Replace viper map key without replacing entire map", "body": "<p>I am using viper for my config. How do I replace a key without replacing the entire map?</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/spf13/viper\"\n)\n\ntype person struct {\n    First string\n    Last  string\n}\n\nfunc main() {\n    v := viper.New()\n    v.SetEnvPrefix(\"mememe\")\n    v.AutomaticEnv()\n\n    bob := person{\n        First: \"Bob\",\n        Last:  \"Smith\",\n    }\n\n    john := person{\n        First: \"John\",\n        Last:  \"Boothe\",\n    }\n\n    v.SetDefault(\"people.bob\", bob)\n    v.SetDefault(\"people.john\", john)\n    log.Println(v.Get(\"people\")) // map[bob:{Bob Smith} john:{John Boothe}]\n\n    bob.Last = \"Hope\"\n    v.Set(\"people.bob\", bob)\n    log.Println(v.Get(\"people\")) // map[bob:{Bob Hope}]\n\n}\n</code></pre>\n\n<p>Upon setting the new Bob I lose John completely. If I change \"SetDefault\" to simply \"Set\" then it seems to work but I am wondering why \"SetDefault\" doesn't work.</p>\n"}, {"tags": ["http", "go", "tcp"], "answers": [{"tags": [], "owner": {"reputation": 360, "user_id": 872021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a2b75e707790b653b9cde7dba18e2c?s=128&d=identicon&r=PG", "display_name": "smoe", "link": "https://stackoverflow.com/users/872021/smoe"}, "is_accepted": false, "score": 0, "last_activity_date": 1496075004, "creation_date": 1496075004, "answer_id": 44246855, "question_id": 44246728, "link": "https://stackoverflow.com/questions/44246728/is-tcp-the-best-method-for-communication-between-go-programs-in-the-same-host/44246855#44246855", "title": "Is TCP the best method for communication between Go programs in the same host?", "body": "<p>It would work and give additional freedom to have the two programs run on different computers. But it is not the best in terms of performance.</p>\n\n<p>For good performance, shared memory comes to mind.\n<a href=\"https://en.wikipedia.org/wiki/Shared_memory\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Shared_memory</a>\nMaybe you could describe a bit more what exactly you want to do.</p>\n"}, {"comments": [{"owner": {"reputation": 1550, "user_id": 3281900, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/100000487316008/picture?type=large", "display_name": "Pig", "link": "https://stackoverflow.com/users/3281900/pig"}, "edited": false, "score": 0, "creation_date": 1496080705, "post_id": 44246864, "comment_id": 75504691, "body": "Would the shared memory method be using channels? I would like to decouple the program so that if one part fails, the other parts can still function, which was why I didn&#39;t consider using channels."}, {"owner": {"reputation": 12722, "user_id": 393157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PiD4P.png?s=128&g=1", "display_name": "svenwltr", "link": "https://stackoverflow.com/users/393157/svenwltr"}, "edited": false, "score": 0, "creation_date": 1496087336, "post_id": 44246864, "comment_id": 75507334, "body": "It might be worth a mention, that UDP isn&#39;t reliable. TCP cares about retransmission of packages which got lost, but UDP don&#39;t. However, this <i>probably</i> won&#39;t happen on the same host."}, {"owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "reply_to_user": {"reputation": 1550, "user_id": 3281900, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/100000487316008/picture?type=large", "display_name": "Pig", "link": "https://stackoverflow.com/users/3281900/pig"}, "edited": false, "score": 0, "creation_date": 1496131858, "post_id": 44246864, "comment_id": 75521855, "body": "@Pig no, shared memory is just a memory that may be simultaneously accessed by multiple programs. The whole burden of organizing and synchronizing the access to this memory is on the programmer, but that is the fastest way of IPC on the same host. There are a variety of techniques for that. Usually you just create a (lockless) queue of &quot;messages&quot; in this shared memory. If one part of the communication fails, your queue is just empty. Once the other part is up, there are new messages in the queue..."}], "tags": [], "owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "is_accepted": false, "score": 1, "last_activity_date": 1496086562, "last_edit_date": 1496086562, "creation_date": 1496075039, "answer_id": 44246864, "question_id": 44246728, "link": "https://stackoverflow.com/questions/44246728/is-tcp-the-best-method-for-communication-between-go-programs-in-the-same-host/44246864#44246864", "title": "Is TCP the best method for communication between Go programs in the same host?", "body": "<p>The short answer is no. The TCP/IP stack is slow, especially the TCP part. So in terms of performance you better use local inter-process communication methods, like a shared memory between your applications or Unix sockets.</p>\n\n<p>If you MUST use a network stack to communicate (say, you plan to move applications between hosts), then UDP or raw sockets are the best options in terms of performance.</p>\n\n<p>And only if you: </p>\n\n<ol>\n<li>must use a network and </li>\n<li>you need a reliable communication channel, then TCP is a good option.</li>\n</ol>\n\n<p>So just walk through your requirements and decide if it is a best method <em>for you.</em></p>\n"}], "owner": {"reputation": 1550, "user_id": 3281900, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/100000487316008/picture?type=large", "display_name": "Pig", "link": "https://stackoverflow.com/users/3281900/pig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1496086562, "creation_date": 1496074471, "question_id": 44246728, "link": "https://stackoverflow.com/questions/44246728/is-tcp-the-best-method-for-communication-between-go-programs-in-the-same-host", "title": "Is TCP the best method for communication between Go programs in the same host?", "body": "<p>Suppose I have two separated Go programs running in my localhost, is TCP the best method for transferring data between the two programs in terms of performance?</p>\n"}, {"tags": ["go", "intellij-idea"], "comments": [{"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1496069952, "post_id": 44245289, "comment_id": 75499636, "body": "Check the run configuration. You are probably running a single file, and you should be running the whole package"}], "answers": [{"tags": [], "owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "is_accepted": false, "score": 0, "last_activity_date": 1496069830, "creation_date": 1496069830, "answer_id": 44245434, "question_id": 44245289, "link": "https://stackoverflow.com/questions/44245289/intellij-cannot-load-file-go-same-package/44245434#44245434", "title": "Intellij cannot load file .go same package", "body": "<p>You are executing <code>go run main.go</code> from IntelliJ, so it doesn't look for <code>showMsg()</code> in other files.</p>\n\n<p>You should execute <code>go build</code> instead, so that all of the files in the <code>main</code> package would be compiled into a single binary.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 3826289, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4962ec16c9b3f3a0598b107a89b1494d?s=128&d=identicon&r=PG&f=1", "display_name": "Cuong Huy", "link": "https://stackoverflow.com/users/3826289/cuong-huy"}, "edited": false, "score": 0, "creation_date": 1496070853, "post_id": 44245504, "comment_id": 75500129, "body": "I change Run kind to Package and Package is main. But have error Cannot find package &#39;main&#39;"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 41, "user_id": 3826289, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4962ec16c9b3f3a0598b107a89b1494d?s=128&d=identicon&r=PG&f=1", "display_name": "Cuong Huy", "link": "https://stackoverflow.com/users/3826289/cuong-huy"}, "edited": false, "score": 0, "creation_date": 1496071312, "post_id": 44245504, "comment_id": 75500384, "body": "You don&#39;t need the package &quot;main&quot;. As in the video, the package name should be the fully qualified package name. For example, if your main is under github.com/dlsniper/demo then that&#39;s the package you need to use, github.com/dlsniper/demo, not main."}, {"owner": {"reputation": 41, "user_id": 3826289, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4962ec16c9b3f3a0598b107a89b1494d?s=128&d=identicon&r=PG&f=1", "display_name": "Cuong Huy", "link": "https://stackoverflow.com/users/3826289/cuong-huy"}, "edited": false, "score": 0, "creation_date": 1496071642, "post_id": 44245504, "comment_id": 75500528, "body": "If don&#39;t setting Package Run Configuration error &quot;Package is not specified&quot;. It can still save but can not run"}, {"owner": {"reputation": 41, "user_id": 3826289, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4962ec16c9b3f3a0598b107a89b1494d?s=128&d=identicon&r=PG&f=1", "display_name": "Cuong Huy", "link": "https://stackoverflow.com/users/3826289/cuong-huy"}, "edited": false, "score": 0, "creation_date": 1496072051, "post_id": 44245504, "comment_id": 75500739, "body": "Sorry, I tried again, although there are errors of Run Configuration but successful Run successful. Thanks @dlsniper"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 41, "user_id": 3826289, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4962ec16c9b3f3a0598b107a89b1494d?s=128&d=identicon&r=PG&f=1", "display_name": "Cuong Huy", "link": "https://stackoverflow.com/users/3826289/cuong-huy"}, "edited": false, "score": 0, "creation_date": 1496074177, "post_id": 44245504, "comment_id": 75501773, "body": "If you pause the video at exactly [this frame][1] it should show you how to configure the run configuration exactly so that you don&#39;t see any error in the run configuration itself      [1]: <a href=\"https://youtu.be/ko-wKntCLjg?t=50\" rel=\"nofollow noreferrer\">youtu.be/ko-wKntCLjg?t=50</a>"}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 2, "last_activity_date": 1496070064, "creation_date": 1496070064, "answer_id": 44245504, "question_id": 44245289, "link": "https://stackoverflow.com/questions/44245289/intellij-cannot-load-file-go-same-package/44245504#44245504", "title": "Intellij cannot load file .go same package", "body": "<p><a href=\"https://www.youtube.com/watch?v=ko-wKntCLjg\" rel=\"nofollow noreferrer\">This video</a> should show you how to solve the problem. You basically need to use a Run Configuration of type Go Application and use a Package kind not File kind.</p>\n"}], "owner": {"reputation": 41, "user_id": 3826289, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4962ec16c9b3f3a0598b107a89b1494d?s=128&d=identicon&r=PG&f=1", "display_name": "Cuong Huy", "link": "https://stackoverflow.com/users/3826289/cuong-huy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1496070064, "creation_date": 1496069367, "last_edit_date": 1496069669, "question_id": 44245289, "link": "https://stackoverflow.com/questions/44245289/intellij-cannot-load-file-go-same-package", "title": "Intellij cannot load file .go same package", "body": "<p>I have the problem running file main.go in Intellij.</p>\n\n<p><a href=\"https://i.stack.imgur.com/wYTZc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wYTZc.png\" alt=\"My structure project\"></a></p>\n\n<p>Main.go and Common.go same package main. I run Main.go in Intellij then consle log display message error: \".\\Main.go:9: undefined: showMsg\".\nshowMsg is a function of Common.go</p>\n"}, {"tags": ["go", "channel"], "answers": [{"tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": false, "score": 1, "last_activity_date": 1496069036, "creation_date": 1496069036, "answer_id": 44245189, "question_id": 44244881, "link": "https://stackoverflow.com/questions/44244881/channel-deadlock-on-workerpool/44245189#44245189", "title": "Channel deadlock on workerpool", "body": "<p>The following code:</p>\n\n<pre><code>    for j := 1; j &lt; 1000000; j++ {\n        jobs &lt;- j\n    }\n</code></pre>\n\n<p>should run in a separate goroutine, since all the workers will block waiting for the main gorourine to receive on the results channel, while the main goroutine is stuck in the loop.</p>\n"}, {"comments": [{"owner": {"reputation": 1501, "user_id": 6414477, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6a2c251e715864f098ebf4b4057848b1?s=128&d=identicon&r=PG&f=1", "display_name": "rhillhouse", "link": "https://stackoverflow.com/users/6414477/rhillhouse"}, "edited": false, "score": 0, "creation_date": 1496070500, "post_id": 44245241, "comment_id": 75499934, "body": "Currently both channels are buffered at 100. Why does it still happen if I remove the buffer?"}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "reply_to_user": {"reputation": 1501, "user_id": 6414477, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6a2c251e715864f098ebf4b4057848b1?s=128&d=identicon&r=PG&f=1", "display_name": "rhillhouse", "link": "https://stackoverflow.com/users/6414477/rhillhouse"}, "edited": false, "score": 0, "creation_date": 1496077890, "post_id": 44245241, "comment_id": 75503493, "body": "If you don&#39;t specify a channel size, you get a buffer size of 0, which means that writes into the channel will block until a reader is available. You can&#39;t create a channel of unlimited size, by design (because this could, for example, lead to unconstrained memory usage in servers)."}], "tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1496069195, "creation_date": 1496069195, "answer_id": 44245241, "question_id": 44244881, "link": "https://stackoverflow.com/questions/44244881/channel-deadlock-on-workerpool/44245241#44245241", "title": "Channel deadlock on workerpool", "body": "<p>The problem is that your channels are filling up. The <code>main()</code> routine tries to put all jobs into the <code>jobs</code> channel before reading any results. But the <code>results</code> channel only has space for 100 results before any write to the channel will block, so all the workers will eventually block waiting for space in this channel \u2013 space that will never come, because <code>main()</code> has not started reading from <code>results</code> yet.</p>\n\n<p>To quickly fix this, you can either make <code>jobs</code> big enough to hold all jobs, so the <code>main()</code> function can continue to the reading phase; or you can make <code>results</code> big enough to hold all results, so the workers can output their results without blocking.</p>\n\n<p>A nicer approach is to make another goroutine to fill up the <code>jobs</code> queue, so <code>main()</code> can go straight to reading results:</p>\n\n<pre><code>func main() {\n    jobs := make(chan int, 100)\n    results := make(chan int, 100)\n\n    for w := 1; w &lt;= 1000; w++ {\n        go worker(w, jobs, results)\n    }\n\n    go func() {\n        for j := 1; j &lt; 1000000; j++ {\n            jobs &lt;- j\n        }\n        close(jobs)\n        fmt.Println(\"==========CLOSED==============\")\n    }\n\n    for i := 1; i &lt; 1000000; i++ {\n        &lt;-results\n    }\n}\n</code></pre>\n\n<p>Note that I had to change the final <code>for</code> loop to a fixed number of iterations, otherwise it might terminate before all the results have been read.</p>\n"}, {"tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": false, "score": 3, "last_activity_date": 1549190319, "last_edit_date": 1549190319, "creation_date": 1496070833, "answer_id": 44245748, "question_id": 44244881, "link": "https://stackoverflow.com/questions/44244881/channel-deadlock-on-workerpool/44245748#44245748", "title": "Channel deadlock on workerpool", "body": "<p>While Thomas' answer is basically correct, I post my version which is IMO better Go and also works with unbuffered channels:</p>\n\n<pre><code>func main() {\n    jobs := make(chan int)\n    results := make(chan int)\n\n    var wg sync.WaitGroup\n\n    // you could init the WaitGroup's count here with one call but this is error\n    // prone - if you change the loop's size you could forget to change the\n    // WG's count. So call wg.Add in loop\n    //wg.Add(1000)\n    for w := 1; w &lt;= 1000; w++ {\n        wg.Add(1)\n        go func() {\n            defer wg.Done()\n            worker(w, jobs, results)\n        }()\n    }\n\n    go func() {\n        for j := 1; j &lt; 2000; j++ {\n            jobs &lt;- j\n        }\n        close(jobs)\n        fmt.Println(\"==========CLOSED==============\")\n    }()\n\n    // in this gorutine we wait until all \"producer\" routines are done\n    // then close the results channel so that the consumer loop stops\n    go func() {\n        wg.Wait()\n        close(results)\n    }()\n\n    for i := range results {\n        fmt.Print(i, \" \")\n    }\n    fmt.Println(\"==========DONE==============\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3319093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SZ3N0.jpg?s=128&g=1", "display_name": "ambitioner", "link": "https://stackoverflow.com/users/3319093/ambitioner"}, "is_accepted": false, "score": 0, "last_activity_date": 1559634645, "creation_date": 1559634645, "answer_id": 56439557, "question_id": 44244881, "link": "https://stackoverflow.com/questions/44244881/channel-deadlock-on-workerpool/56439557#56439557", "title": "Channel deadlock on workerpool", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc worker(id int, jobs &lt;-chan int, results chan&lt;- int, wg *sync.WaitGroup) {\n    defer wg.Done()\n\n    for j := range jobs {\n        fmt.Println(\"worker\", id, \"started  job\", j)\n        time.Sleep(time.Millisecond * time.Duration(10))\n        fmt.Println(\"worker\", id, \"finished job\", j)\n        results &lt;- j * 2\n    }\n}\n\nfunc main() {\n    jobs := make(chan int, 100)\n    results := make(chan int, 100)\n\n    wg := new(sync.WaitGroup)\n    wg.Add(1000)\n\n    for w := 1; w &lt;= 1000; w++ {\n        go worker(w, jobs, results, wg)\n    }\n\n    go func() {\n        wg.Wait()\n        close(results)\n    }()\n\n    go func() {\n        for j := 1; j &lt; 1000000; j++ {\n            jobs &lt;- j\n        }\n        close(jobs)\n    }()\n\n    sum := 0\n    for v := range results {\n        sum += v\n    }\n\n    fmt.Println(\"==========CLOSED==============\")\n    fmt.Println(\"sum\", sum)\n}\n</code></pre>\n"}], "owner": {"reputation": 1501, "user_id": 6414477, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6a2c251e715864f098ebf4b4057848b1?s=128&d=identicon&r=PG&f=1", "display_name": "rhillhouse", "link": "https://stackoverflow.com/users/6414477/rhillhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 44245241, "answer_count": 4, "score": 2, "last_activity_date": 1559634645, "creation_date": 1496068007, "question_id": 44244881, "link": "https://stackoverflow.com/questions/44244881/channel-deadlock-on-workerpool", "title": "Channel deadlock on workerpool", "body": "<p>I am playing around with channels by making a workerpool of a 1000 workers. Currently I am getting the following error:</p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\n\nfunc worker(id int, jobs &lt;-chan int, results chan&lt;- int) {\n    for j := range jobs {\n        fmt.Println(\"worker\", id, \"started  job\", j)\n        time.Sleep(time.Second)\n        fmt.Println(\"worker\", id, \"finished job\", j)\n        results &lt;- j * 2\n    }\n}\n\nfunc main() {\n    jobs := make(chan int, 100)\n    results := make(chan int, 100)\n\n    for w := 1; w &lt;= 1000; w++ {\n        go worker(w, jobs, results)\n    }\n\n    for j := 1; j &lt; 1000000; j++ {\n        jobs &lt;- j\n    }\n    close(jobs)\n    fmt.Println(\"==========CLOSED==============\")\n\n    for i:=0;i&lt;len(results);i++ {\n        &lt;-results\n    }\n}\n</code></pre>\n\n<p>Why is this happening? I am still new to go and I am hoping to make sense of this.</p>\n"}, {"tags": ["arrays", "node.js", "string", "performance", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1496067807, "post_id": 44244636, "comment_id": 75498409, "body": "But <code>strings.Split(str, &quot; &quot;)</code> does work: <a href=\"https://play.golang.org/p/E7VaBxY_iT\" rel=\"nofollow noreferrer\">Go Playground</a>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1496067866, "post_id": 44244636, "comment_id": 75498434, "body": "How did you measure performance?"}, {"owner": {"reputation": 2810, "user_id": 5808504, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/821bb6654d488185345d86bde0a586ef?s=128&d=identicon&r=PG&f=1", "display_name": "twharmon", "link": "https://stackoverflow.com/users/5808504/twharmon"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1496068945, "post_id": 44244636, "comment_id": 75499040, "body": "@peterSO I edited the question"}, {"owner": {"reputation": 2810, "user_id": 5808504, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/821bb6654d488185345d86bde0a586ef?s=128&d=identicon&r=PG&f=1", "display_name": "twharmon", "link": "https://stackoverflow.com/users/5808504/twharmon"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1496068969, "post_id": 44244636, "comment_id": 75499053, "body": "@icza I edited the question for you"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1496069191, "post_id": 44244636, "comment_id": 75499173, "body": "This is not how you measure / benchmark execution times in Go. Check out this answer: <a href=\"https://stackoverflow.com/questions/41608578/order-of-the-code-and-performance/41608707#41608707\">Order of the code and performance</a>"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1496072831, "post_id": 44244636, "comment_id": 75501186, "body": "something about comparing apples with pears comes to mind."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1496090372, "post_id": 44244636, "comment_id": 75508486, "body": "I wouldn&#39;t use strings.Split for this kind of tasks, I could use a Scanner <a href=\"https://golang.org/pkg/bufio/#Scanner.Scan\" rel=\"nofollow noreferrer\">golang.org/pkg/bufio/#Scanner.Scan</a>"}, {"owner": {"reputation": 2810, "user_id": 5808504, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/821bb6654d488185345d86bde0a586ef?s=128&d=identicon&r=PG&f=1", "display_name": "twharmon", "link": "https://stackoverflow.com/users/5808504/twharmon"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1496110470, "post_id": 44244636, "comment_id": 75513248, "body": "@YandryPozo How can I do it with Scanner?"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1496119501, "post_id": 44244636, "comment_id": 75515443, "body": "@Travis using a Scanner with <a href=\"https://golang.org/pkg/bufio/#ScanWords\" rel=\"nofollow noreferrer\">ScanWords()</a>, but it shouldn&#39;t improve the Big O time, after all who wants to scan the same strings over and over"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1496078093, "last_edit_date": 1496078093, "creation_date": 1496071747, "answer_id": 44246008, "question_id": 44244636, "link": "https://stackoverflow.com/questions/44244636/why-are-gos-strings-fieldsstr-and-strings-splitstr-so-slow/44246008#44246008", "title": "Why are Go&#39;s strings.Fields(str) and strings.Split(str, &quot; &quot;) so slow?", "body": "<p>First, let's run your tests.</p>\n\n<pre><code>$ go run travis.go\n5.892531292s\n$ node travis.js\n4065ms\n$\n</code></pre>\n\n<p>Go 5.89 seconds versus Node.js 4.07 seconds.</p>\n\n<p>Second, let's run a Go benchmark and see what you are really doing. It's a lot more than the <code>strings.Fields(str)</code> or <code>strings.Split(str, \" \")</code> that you said in your original post.</p>\n\n<p><code>travis_test.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"strings\"\n    \"testing\"\n)\n\nvar str = \"asd asjhfa lsjdhalsdjhfa dhfald hfaljdh faldhfasjdhfalsdh asd alsdh alksdh alksdh alksd alkjsd fadlkj dalkjdh asdhfef afa d6a 5a85dfa s5da5d ad a6sd58ad5a8sd5f 8as5f as5 a8s5 8as6d5 8asd65f8as6d58 a5sd 8a5ds8f7 a6s5d\"\n\nfunc Travis() {\n    var newWords []string\n    for j := 0; j &lt; 1000000; j++ {\n        words := strings.Split(str, \" \")\n        wordsLen := len(words)\n        newWords = nil\n        for i := 0; i &lt; wordsLen; i++ {\n            if words[i][:1] != \"s\" {\n                newWords = append(newWords, words[i])\n            }\n        }\n    }\n}\n\nfunc BenchmarkTravis(b *testing.B) {\n    b.ReportAllocs()\n    b.ResetTimer()\n    for i := 0; i &lt; b.N; i++ {\n        Travis()\n    }\n    b.StopTimer()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go test -run=! -bench=Travis travis_test.go \ngoos: linux\ngoarch: amd64\nBenchmarkTravis-4   1   5832192616 ns/op   1488002816 B/op   7000015 allocs/op\nPASS\nok      command-line-arguments  5.838s\n$\n</code></pre>\n"}], "owner": {"reputation": 2810, "user_id": 5808504, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/821bb6654d488185345d86bde0a586ef?s=128&d=identicon&r=PG&f=1", "display_name": "twharmon", "link": "https://stackoverflow.com/users/5808504/twharmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 823, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1496078093, "creation_date": 1496067245, "last_edit_date": 1496068995, "question_id": 44244636, "link": "https://stackoverflow.com/questions/44244636/why-are-gos-strings-fieldsstr-and-strings-splitstr-so-slow", "title": "Why are Go&#39;s strings.Fields(str) and strings.Split(str, &quot; &quot;) so slow?", "body": "<p>I have been testing functions in Node and Go to compare their performance. In almost every test, Go is much faster than Node, except when <code>strings.Fields()</code> or <code>strings.Split()</code> is used, then Node is 2-3 times as fast.</p>\n\n<p>Go (2.14s):</p>\n\n<pre><code>start := time.Now()\nvar newWords []string\nstr := \"asd asjhfa lsjdhalsdjhfa dhfald hfaljdh faldhfasjdhfalsdh asd alsdh alksdh alksdh alksd alkjsd fadlkj dalkjdh asdhfef afa d6a 5a85dfa s5da5d ad a6sd58ad5a8sd5f 8as5f as5 a8s5 8as6d5 8asd65f8as6d58 a5sd 8a5ds8f7 a6s5d\"\n\nfor j := 0; j &lt; 1000000; j++ {\n    words := strings.Split(str, \" \")\n    wordsLen := len(words)\n    newWords = nil\n    for i := 0; i &lt; wordsLen; i++ {\n        if words[i][:1] != \"s\" {\n            newWords = append(newWords, words[i])\n        }\n    }\n}\ndur := time.Since(start)\n\nfmt.Println(newWords)\nfmt.Println(dur)\n</code></pre>\n\n<p>Node (847ms):</p>\n\n<pre><code>let start = new Date()\nlet newWords = []\nlet str = \"asd asjhfa lsjdhalsdjhfa dhfald hfaljdh faldhfasjdhfalsdh asd alsdh alksdh alksdh alksd alkjsd fadlkj dalkjdh asdhfef afa d6a 5a85dfa s5da5d ad a6sd58ad5a8sd5f 8as5f as5 a8s5 8as6d5 8asd65f8as6d58 a5sd 8a5ds8f7 a6s5d\"\n\nfor (let j = 0; j &lt; 1000000; j++) {\n    let words = str.split(' ')\n    let wordsLen = words.length\n    newWords = []\n    for (let i = wordsLen - 1; i &gt;= 0; i--) {\n        if (words[i].substr(0, 1) !== 's') {\n            newWords.push(words[i])\n        }\n    }\n}\n\nconsole.log((new Date() - start) + 'ms')\n</code></pre>\n"}, {"tags": ["go", "time", "daemon", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "edited": false, "score": 0, "creation_date": 1496133335, "post_id": 44252811, "comment_id": 75522719, "body": "Now the function <code>Writer()</code> works, but when I type <code>sdaemon -s quit</code> to do a graceful shutdown, it does not work, before it worked; You know what&#39;s the problem? Thank you so much for your first anwser @johlo"}, {"owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "edited": false, "score": 0, "creation_date": 1496134333, "post_id": 44252811, "comment_id": 75523331, "body": "I have the answer, <code>sdaemon -s quit</code> works but we have to wait time.Sleep() to get the graceful shutdown. I need to change that."}, {"owner": {"reputation": 5182, "user_id": 1366533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cqijr.png?s=128&g=1", "display_name": "johlo", "link": "https://stackoverflow.com/users/1366533/johlo"}, "reply_to_user": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "edited": false, "score": 1, "creation_date": 1496135657, "post_id": 44252811, "comment_id": 75524210, "body": "@icvallejo You probablly want to use a <code>Ticker</code> instead of sleeping, see <a href=\"https://gobyexample.com/tickers\" rel=\"nofollow noreferrer\">gobyexample.com/tickers</a>. You can stop the ticker when the SIGQUIT signal comes."}], "tags": [], "owner": {"reputation": 5182, "user_id": 1366533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cqijr.png?s=128&g=1", "display_name": "johlo", "link": "https://stackoverflow.com/users/1366533/johlo"}, "is_accepted": true, "score": 1, "last_activity_date": 1496113830, "creation_date": 1496113830, "answer_id": 44252811, "question_id": 44244223, "link": "https://stackoverflow.com/questions/44244223/daemon-executes-only-one-time-a-goroutine/44252811#44252811", "title": "Daemon executes only one time a goroutine", "body": "<p>The problem is in the <code>Worker</code> function, when you try to check if you have any data in the <code>done</code> channel. The <code>receive</code>call will block until there is a value to be read, so that call will block until you send a signal to the process.</p>\n\n<p>The second value returned from the receive operator, <code>ok</code>, does not indicate whether a value was succesfully read or not. It just indicates if the channel was closed when trying to receive a value (if so the <code>zero value</code> is returned, see <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"nofollow noreferrer\">the specification</a>).</p>\n\n<p>To check if there is a value in the channel you need to use a <code>select</code> statement, like this:</p>\n\n<pre><code>select {\n        case v, ok &lt;- stop:\n            // We could read a value from the channel\n        default:\n            // No value could be read, but we didn't block\n}\n</code></pre>\n\n<p>So your <code>Worker</code> function should look something like:</p>\n\n<pre><code>func Worker() {\n    for {\n        time.Sleep(time.Minute)\n        select {\n        case &lt;- stop:\n            // Got a stop signal, stopping\n            done &lt;- struct{}{}\n            return\n        default:\n            // No stop signal, continuing loop\n        }\n\n        go Writer()\n    }\n}\n</code></pre>\n\n<p>Note that I have moved the <code>Sleep</code> from the <code>Writer</code> function to the <code>Worker</code>, otherwise you would end up with thousands of concurrent <code>Writer</code> go-routines...</p>\n"}], "owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 44252811, "answer_count": 1, "score": 1, "last_activity_date": 1496113830, "creation_date": 1496066056, "question_id": 44244223, "link": "https://stackoverflow.com/questions/44244223/daemon-executes-only-one-time-a-goroutine", "title": "Daemon executes only one time a goroutine", "body": "<p>I try to add the necessary code to execute my app like a daemon. I used the next project:</p>\n\n<ul>\n<li>github.com/sevlyar/go-daemon</li>\n</ul>\n\n<p>I rewrote the sample go code that it's done:\n<a href=\"https://github.com/sevlyar/go-daemon/blob/master/sample/sample.go\" rel=\"nofollow noreferrer\">https://github.com/sevlyar/go-daemon/blob/master/sample/sample.go</a></p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"flag\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n    \"syscall\"\n    \"time\"\n\n    \"github.com/sevlyar/go-daemon\"\n)\n\nvar (\n    signal = flag.String(\"s\", \"\", `sdaemon -s ...\n        quit -- graceful shutdown`)\n)\n\nvar (\n    stop = make(chan struct{})\n    done = make(chan struct{})\n)\n\nfunc main() {\n    flag.Parse()\n    daemon.AddCommand(daemon.StringFlag(signal, \"quit\"), syscall.SIGQUIT, TermHandler)\n\n    cntxt := &amp;daemon.Context{\n        PidFileName: \"/var/run/sdaemon.pid\",\n        PidFilePerm: 0644,\n        WorkDir:     \"./\",\n        Umask:       027,\n        Args:        []string{\"[sdaemon]\"},\n    }\n    if len(daemon.ActiveFlags()) &gt; 0 {\n        d, _ := cntxt.Search()\n        daemon.SendCommands(d)\n        return\n    }\n    d, err := cntxt.Reborn()\n    if d != nil {\n        return\n    }\n    if err != nil {\n        os.Exit(1)\n    }\n    defer cntxt.Release()\n\n    // Start daemon\n    go Worker()\n\n    err = daemon.ServeSignals()\n    if err != nil {\n        fmt.Printf(\"STOPPED!\\n\")\n        return\n    }\n}\n\nfunc Worker() {\n    for {\n        go Writer()\n        if _, ok := &lt;-stop; ok {\n            break\n        }\n    }\n    done &lt;- struct{}{}\n}\n\nfunc TermHandler(sig os.Signal) error {\n    stop &lt;- struct{}{}\n    if sig == syscall.SIGQUIT {\n        &lt;-done\n    }\n    return daemon.ErrStop\n}\n</code></pre>\n\n<p>I have added a function <code>Writer()</code> that read a file, keep the text like a string and create a new file with this string.</p>\n\n<pre><code>func Writer() error {\n    time.Sleep(time.Minute)\n\n    f, _ := ioutil.ReadFile(\"$HOME/test\")\n    contents := string(f)\n\n    fileHandle, _ := os.Create(\"$HOME/stest\")\n    writer := bufio.NewWriter(fileHandle)\n    defer fileHandle.Close()\n    fmt.Fprintln(writer, contents)\n    writer.Flush()\n\n    return nil\n}\n</code></pre>\n\n<p>I don't handle so good the channels in golang and I don't know why the infinite loop for in <code>Worker()</code> function is executed only once...</p>\n\n<p>Can you help me please?</p>\n"}, {"tags": ["xml", "go", "marshalling"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1496069784, "post_id": 44244103, "comment_id": 75499560, "body": "Currently not possible. Long &quot;wanted&quot; feature, never got to production. Related github issues: <a href=\"https://github.com/golang/go/issues/3688\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/3688</a>, <a href=\"https://github.com/ivankravchenko/go/pull/1\" rel=\"nofollow noreferrer\">github.com/ivankravchenko/go/pull/1</a>"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1496070135, "post_id": 44244103, "comment_id": 75499754, "body": "@icza, thanks for response - at least I can put this to bed for now. Agreed duplicate - a fair bit of searching didn&#39;t turn out that particular answer for me."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1496070286, "post_id": 44244103, "comment_id": 75499819, "body": "Anoter related github issue: <a href=\"https://github.com/golang/go/issues/3633#issuecomment-66067258\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/3633#issuecomment-66067258</a>"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1496071029, "post_id": 44244103, "comment_id": 75500230, "body": "thanks again @icza - Following through on that link it looks like there may be some movement on this, I might not drop the bone just yet - looks like a mainline commit providing a new way to pick up attributes - I don&#39;t think its quite what I was envisioning but might be useful. I will poke a bit further and report back"}], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1496069723, "answer_count": 0, "score": 0, "last_activity_date": 1496066016, "creation_date": 1496065680, "last_edit_date": 1496066016, "question_id": 44244103, "link": "https://stackoverflow.com/questions/44244103/go-xml-marshalling-of-attribute-without-excess-struct", "closed_reason": "Duplicate", "title": "go xml marshalling of attribute without excess struct", "body": "<p>I'm working on an client to talk to an XML API. Everything is working just fine but I feel the encoder (or my failure to grok it) is forcing me to use additional structs I don't really need. </p>\n\n<p>An example of the kind of request I need to send is something like this:</p>\n\n<pre><code>&lt;command_name&gt;\n    &lt;prop_1&gt;p1&lt;/prop_1&gt;\n    &lt;prop_2&gt;p2&lt;/prop_2&gt;\n    &lt;prop_3 id=\"prop_3_id\"&gt;&lt;/prop_3&gt;\n&lt;/command_name&gt;\n</code></pre>\n\n<p>It is worth noting that prop_3 will never have any content within the node and id will be the only attribute present</p>\n\n<p>In order to Marshall this response I am currently using the following two structs:</p>\n\n<pre><code>type RefID struct {\n    ID string `xml:\"id,attr,omitempty\"`\n}\n\ntype CommandName struct {\n    XMLName       xml.Name `xml:\"command_name\"`\n    Prop1         string   `xml:\"prop_1\"`\n    Prop2         bool     `xml:\"prop_2,omitempty\"`\n    Prop3         RefID    `xml:\"prop_3,omitempty\"`\n}\n</code></pre>\n\n<p>What I want is to be able to pass in the prop_3 id to requests without having to use the RefID struct. I tried something like this, but it doesn't seem to work with attributes:</p>\n\n<pre><code>Prop3  string `xml:\"prop_3&gt;id,attr,omitempty\"`\n</code></pre>\n\n<p>I know this seems minor but it would just make life easier for anyone consuming my client, if someone can confirm definitively this is not possible then at least I can move on and remove the dirty @TODO next to my code.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1496086577, "post_id": 44244728, "comment_id": 75507049, "body": "hi, I have been thinking about using <code>go generate</code>  and use a <code>Makefile</code> to generate and later build maybe could work any thoughts?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1496101193, "post_id": 44244728, "comment_id": 75511490, "body": "@nbari Yeah, if you&#39;re fine with pre-processing, go generate can be useful, but it won&#39;t be dynamic as you requested in the first sentence of your question."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1496074364, "last_edit_date": 1496074364, "creation_date": 1496067516, "answer_id": 44244728, "question_id": 44243967, "link": "https://stackoverflow.com/questions/44243967/how-to-dynamically-add-imports/44244728#44244728", "title": "How to dynamically add imports", "body": "<p>Go is a statically linked language. This means if a package is not referenced at compile time (from your <code>.go</code> source files), that package will not be linked / compiled into the executable binary, which implies it will not be availabe at runtime.</p>\n\n<p>So the easiest is to just use imports.</p>\n\n<p>If you want truly dynamic configuration, <a href=\"https://golang.org/pkg/plugin/\" rel=\"nofollow noreferrer\">plugins</a> introduced in Go 1.8 may be an option for you, but using plugins complicates things and I would only use that as a last resort. Also note that plugins currently only work on linux.</p>\n\n<p>Related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/30097451/dynamic-loading-in-golang/30102141#30102141\">Dynamic loading in Golang?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/43181410/go-plugin-variable-initialization/43181795#43181795\">Go Plugin variable initialization</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/42388090/go-1-8-plugin-use-custom-interface/42389345#42389345\">go 1.8 plugin use custom interface</a></p>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 44244728, "answer_count": 1, "score": 1, "last_activity_date": 1496074364, "creation_date": 1496065255, "question_id": 44243967, "link": "https://stackoverflow.com/questions/44243967/how-to-dynamically-add-imports", "title": "How to dynamically add imports", "body": "<p>I want to dynamically create an HTTP router using custom <a href=\"https://violetear.org/post/middleware/\" rel=\"nofollow noreferrer\">plugins/middleware</a>, currently, I am using a <code>config.yml</code> for example:</p>\n\n<pre><code>plugins:\n  - waf\n  - jwt \n  - cors\n</code></pre>\n\n<p>After parsing the <code>yml</code> file  I create the routes like this:</p>\n\n<pre><code>route := violetear.New()\nchain := middleware.New() \nfor _, plugin := range Plugins {\n    chain := chain.Append(plugin)       \n}\nrouter.Handle(\"/test\", chain.Then(myHandler))\nlog.Fatal(http.ListenAndServe(\":8080\", router))\n</code></pre>\n\n<p>For this to work, I would have to include all the plugins in the import section, something like:</p>\n\n<pre><code>import (\n   \"net/http\"\n\n   \"github.com/nbari/violetear\"\n   \"github.com/nbari/violetear/midleware\"\n\n   // How to deal with this\n   \"github.com/example/waf\"\n   \"github.com/example/jwt\"\n   \"github.com/example/cors\"\n)\n</code></pre>\n\n<p>I would need to change the current config format to be something more useful/generic probably something like:</p>\n\n<pre><code>plugins:\n  - [github.com/foo, foo]\n  - [github.com/bar, bar]\n</code></pre>\n\n<p>But besides that what could be the best approach to \"dynamically\" create the imports or to generate the code the one later could be compiled?</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 23, "user_id": 4359749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/485ab54325aa572b14ab31523f3b779e?s=128&d=identicon&r=PG&f=1", "display_name": "user214259", "link": "https://stackoverflow.com/users/4359749/user214259"}, "edited": false, "score": 0, "creation_date": 1496064944, "post_id": 44243492, "comment_id": 75496590, "body": "Can anybody tell me why this is being voted down? It&#39;s a straightforward question."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1496075076, "post_id": 44243492, "comment_id": 75502221, "body": "jq is a cl tool, go is the language to write such a tool."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4359749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/485ab54325aa572b14ab31523f3b779e?s=128&d=identicon&r=PG&f=1", "display_name": "user214259", "link": "https://stackoverflow.com/users/4359749/user214259"}, "edited": false, "score": 0, "creation_date": 1496068195, "post_id": 44244445, "comment_id": 75498603, "body": "Fair enough. Thanks."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 0, "last_activity_date": 1496066725, "creation_date": 1496066725, "answer_id": 44244445, "question_id": 44243492, "link": "https://stackoverflow.com/questions/44243492/golang-equivalent-of-jq-stream-c/44244445#44244445", "title": "Golang equivalent of `jq --stream -c`", "body": "<blockquote>\n  <p>I've looked through the Golang documentation for JSON but couldn't find anything similar. Is there such a function that I've missed?</p>\n</blockquote>\n\n<p>No, you haven't missed anything. The current JSON library doesn't support what you described \"out of the box\".</p>\n\n<p>If you want this to work, you'll need to find a package that offers the flexibility you need or satisfy <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow noreferrer\"><code>json.Marshaler</code></a> with a custom type yourself.</p>\n"}], "owner": {"reputation": 23, "user_id": 4359749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/485ab54325aa572b14ab31523f3b779e?s=128&d=identicon&r=PG&f=1", "display_name": "user214259", "link": "https://stackoverflow.com/users/4359749/user214259"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496066725, "creation_date": 1496063851, "last_edit_date": 1496064761, "question_id": 44243492, "link": "https://stackoverflow.com/questions/44243492/golang-equivalent-of-jq-stream-c", "title": "Golang equivalent of `jq --stream -c`", "body": "<p>Using <code>jq --stream -c</code> on the command line, I can format pretty JSON like this:</p>\n\n<pre><code>{\n  \"object\": {\n    \"something\": {\n      \"key1\": 123,\n      \"key2\": 456\n    },\n    \"something_else\": {\n      \"key1\": [\n        \"value1\",\n        \"value2\"\n      ]\n    }\n  }\n}\n</code></pre>\n\n<p>into this:</p>\n\n<pre><code>[[\"object\",\"something\",\"key1\"],123]\n[[\"object\",\"something\",\"key2\"],456]\n[[\"object\",\"something\",\"key2\"]]\n[[\"object\",\"something_else\",\"key1\",0],\"value1\"]\n[[\"object\",\"something_else\",\"key1\",1],\"value2\"]\n[[\"object\",\"something_else\",\"key1\",1]]\n[[\"object\",\"something_else\",\"key1\"]]\n[[\"object\",\"something_else\"]]\n[[\"object\"]]\n</code></pre>\n\n<p>I've looked through the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\">Golang documentation for JSON</a> but couldn't find anything similar. Is there such a function that I've missed?</p>\n\n<p>More precisely I'd like to print the above JSON like so:</p>\n\n<pre><code>object.something.key1=123\nobject.something.key2=345\nobject.something_else.key1.0=value1\nobject.something_else.key1.1=value2\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1496061864, "post_id": 44242803, "comment_id": 75494574, "body": "You can do <code>defer</code> but it would be ugly."}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1496063074, "post_id": 44242803, "comment_id": 75495346, "body": "Check out the <a href=\"https://play.golang.org/p/A0nH96VB4S\" rel=\"nofollow noreferrer\">example</a> from golang.org"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1496065106, "post_id": 44242803, "comment_id": 75496698, "body": "What you have done is pretty good. There is another way of Fibonacci calculation. You can do it using matrix. It is less elegant from programming view but it is much more elegant from mathematical view. I have an example of implementation on Python  <a href=\"https://gist.github.com/I159/ab818dfe0415d415d7314c57e17f0460#file-matrix_fibo-py-L62-L106\" rel=\"nofollow noreferrer\">gist.github.com/I159/&hellip;</a> . If it seems an interesting for you, I could translate it to Go."}, {"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1601455295, "post_id": 44242803, "comment_id": 113410550, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/a/64133793/12817546\">stackoverflow.com/a/64133793/12817546</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "is_accepted": true, "score": 3, "last_activity_date": 1496061877, "creation_date": 1496061877, "answer_id": 44242845, "question_id": 44242803, "link": "https://stackoverflow.com/questions/44242803/how-do-i-make-this-fibonacci-sequence-generator-more-elegant/44242845#44242845", "title": "How do I make this Fibonacci sequence generator more elegant?", "body": "<p>You may want to take a look at <code>defer</code>:</p>\n\n<pre><code>func fib_seq() func() int {\n    n0, n1 := 0, 1\n\n    return func() int {\n        defer func() {\n            n0, n1 = n1, n0 + n1\n        }()\n\n        return n0\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 2, "last_activity_date": 1496062624, "creation_date": 1496062624, "answer_id": 44243090, "question_id": 44242803, "link": "https://stackoverflow.com/questions/44242803/how-do-i-make-this-fibonacci-sequence-generator-more-elegant/44243090#44243090", "title": "How do I make this Fibonacci sequence generator more elegant?", "body": "<p>Named return. But what you have is already readable enough.</p>\n\n<pre><code>func fib_seq() func() int {\n    n0, n1 := 0, 1\n\n    return func() (r int) {\n        r, n0, n1 = n0, n1, n0 + n1\n        return\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14127, "user_id": 641627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEgWh.jpg?s=128&g=1", "display_name": "alexbt", "link": "https://stackoverflow.com/users/641627/alexbt"}, "is_accepted": false, "score": 1, "last_activity_date": 1504660116, "last_edit_date": 1504660116, "creation_date": 1496090407, "answer_id": 44250034, "question_id": 44242803, "link": "https://stackoverflow.com/questions/44242803/how-do-i-make-this-fibonacci-sequence-generator-more-elegant/44250034#44250034", "title": "How do I make this Fibonacci sequence generator more elegant?", "body": "<p>Personally, I'd prefer the following (for readability):</p>\n\n<pre><code>type fib struct{ n0, n1 int }\n\nfunc (f *fib) next() int {\n    defer func() { \n        f.n0, f.n1 = f.n1, f.n0+f.n1 \n    }()\n    return f.n0\n}\n\nfunc main() {\n    fib := &amp;fib{0, 1}\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(fib.next())\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14127, "user_id": 641627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEgWh.jpg?s=128&g=1", "display_name": "alexbt", "link": "https://stackoverflow.com/users/641627/alexbt"}, "edited": false, "score": 0, "creation_date": 1502472498, "post_id": 44355422, "comment_id": 78240994, "body": "I agree with you... you just didn&#39;t do it in <code>Go</code> :)"}], "tags": [], "owner": {"reputation": 494, "user_id": 2242047, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EBfpz.png?s=128&g=1", "display_name": "Ebony Maw", "link": "https://stackoverflow.com/users/2242047/ebony-maw"}, "is_accepted": false, "score": 0, "last_activity_date": 1496588237, "creation_date": 1496588237, "answer_id": 44355422, "question_id": 44242803, "link": "https://stackoverflow.com/questions/44242803/how-do-i-make-this-fibonacci-sequence-generator-more-elegant/44355422#44355422", "title": "How do I make this Fibonacci sequence generator more elegant?", "body": "<p>\"Elegant\" means different things to different people. To some it may mean \"conciseness,\" and to others it may mean \"simplicity,\" or \"readability.\"</p>\n\n<p>Here is my take on it:</p>\n\n<pre><code>public class Fibonacci {\n\n    private static int x;\n    private static int y;\n    private static int z;\n\n    public static void main(String[] args) {\n        x = 0;\n        y = 1;\n        z = 0;\n\n        System.out.println(x);\n        System.out.println(y);\n        while (z &lt; 100) {\n            z = x + y;\n            System.out.println(z);\n            x = y;\n            y = z;\n        }\n\n    }\n}\n</code></pre>\n\n<p>As you can see, I favor readability over sophistication :)</p>\n"}], "owner": {"reputation": 43, "user_id": 8078015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9382bcedc2da35e4168dff5e7dd20dd?s=128&d=identicon&r=PG&f=1", "display_name": "zentoo", "link": "https://stackoverflow.com/users/8078015/zentoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 44242845, "answer_count": 4, "score": 4, "last_activity_date": 1539047620, "creation_date": 1496061758, "last_edit_date": 1539047620, "question_id": 44242803, "link": "https://stackoverflow.com/questions/44242803/how-do-i-make-this-fibonacci-sequence-generator-more-elegant", "title": "How do I make this Fibonacci sequence generator more elegant?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc fib_seq() func() int {\n    n0, n1 := 0, 1\n\n    return func() int {\n        result := n0\n        n0, n1 = n1, n0 + n1\n        return result\n    }\n}\n\nfunc main() {\n    f := fib_seq()\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(f())\n    }\n}\n</code></pre>\n\n<p>This is my Fibonacci sequence generator. The definition of <code>result</code> is unwanted (but necessary).</p>\n\n<p>I wonder is there a way to execute <code>x, y = y, x + y</code> after <code>return</code>?</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1496058905, "post_id": 44241836, "comment_id": 75492799, "body": "Preprocessor macros is a pure compile-time construct, in fact the preprocessor runs <i>before</i> the compilation proper takes place. Once a C source file have been compiled there is no traces of macros left in the code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 2, "creation_date": 1496060292, "post_id": 44241836, "comment_id": 75493632, "body": "Macros are strictly for the C code. There is no way to use them in Go code."}], "owner": {"reputation": 104, "user_id": 1869838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80197b326fd974c23a42e54696bc5fa7?s=128&d=identicon&r=PG", "display_name": "Utkarsh Naiknaware", "link": "https://stackoverflow.com/users/1869838/utkarsh-naiknaware"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1797, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1507855467, "creation_date": 1496058701, "question_id": 44241836, "link": "https://stackoverflow.com/questions/44241836/c-macro-definitions-in-cgo", "title": "C macro definitions in Cgo", "body": "<p>I want to use existing macro values from C code in go. Using import \"C\" pseudo package we can import enums defined in C. Is there a way to import C macros?</p>\n\n<pre><code>package main\n\n/*\nenum levels {\n    low1,\n    medium,\n    high\n};\n#define CMA 30\ntypedef enum {\n    LOW = 0,\n    MEDIUM = 1,\n    HIGH = 2\n} security;\n\n*/\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n\n    cc := new(C.enum_levels)\n    //cm := new(C._*someliteral*_CMA)\n    fmt.Println(*cc)\n\n    fmt.Println(C.MEDIUM)\n\n}\n</code></pre>\n"}, {"tags": ["go", "initialization", "slice", "literals"], "comments": [{"owner": {"reputation": 2536, "user_id": 383568, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0750cfa9c0ec3ff9ef024be62569ac77?s=128&d=identicon&r=PG", "display_name": "JayK", "link": "https://stackoverflow.com/users/383568/jayk"}, "edited": false, "score": 4, "creation_date": 1496056922, "post_id": 44241014, "comment_id": 75491533, "body": "I am not experienced in Go, but I had a quick look at the language spec. Have you tried <code>var ilist []int = []int{1, 2, 3}</code>? A composite literal like one for a slice requires a type, in contrast to a basic literal, such as a number or a string. You may also omit the type after the var name: <code>var ilist = []int{1, 2, 3}</code>."}, {"owner": {"reputation": 1139, "user_id": 746694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AnVrG.png?s=128&g=1", "display_name": "iyasar", "link": "https://stackoverflow.com/users/746694/iyasar"}, "reply_to_user": {"reputation": 2536, "user_id": 383568, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0750cfa9c0ec3ff9ef024be62569ac77?s=128&d=identicon&r=PG", "display_name": "JayK", "link": "https://stackoverflow.com/users/383568/jayk"}, "edited": false, "score": 0, "creation_date": 1496057510, "post_id": 44241014, "comment_id": 75491896, "body": "yes you right but still weird, because i give the all information to create composite literal on left side of declaration (var ilist [] int ) ."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 7, "last_activity_date": 1496061756, "last_edit_date": 1496061756, "creation_date": 1496058585, "answer_id": 44241794, "question_id": 44241014, "link": "https://stackoverflow.com/questions/44241014/initializing-a-slice-by-using-the-var-keyword/44241794#44241794", "title": "Initializing a slice by using the var keyword", "body": "<blockquote>\n  <p>i give the all information to create composite literal</p>\n</blockquote>\n\n<p>That's the thing: you <strong>did not</strong> give all the required information to create a composite literal. Check out the <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">Spec: Composite literals</a> section to see what is required.</p>\n\n<p>This literal:</p>\n\n<pre><code>{1, 2, 3, 4, 5}\n</code></pre>\n\n<p>This literal misses the <em>type</em> information. It could be a part of an <code>[]int{}</code> literal, it could be a part of a <code>[]float32{}</code> literal, it could even be a part of a struct literal, where the struct type has <code>int</code> fields (e.g. <code>type Ints struct{a,b,c,d,e int}</code>).</p>\n\n<p>Yes, in this variable declaration</p>\n\n<pre><code>var ilist [] int = {1, 2, 3, 4, 5}  //error\n</code></pre>\n\n<p>Only <code>[]int{}</code> literal makes sense, but that is not how Go works. Just because there is only a single type that would make this line valid, it doesn't mean you can omit it.</p>\n\n<p>Note that however you may omit the type from the declaration if it can be inferred from the initialization expression, so both of these forms are valid:</p>\n\n<pre><code>var ilist1 []int = []int{1, 2, 3, 4, 5}\n\nvar ilist2 = []int{1, 2, 3, 4, 5}\n</code></pre>\n\n<p>But the type of <code>{1, 2, 3, 4, 5}</code> would be ambiguous (if it would be valid).</p>\n\n<p>Also note that if you're specifying a composite literal for a type like <code>[][]int</code>, you <em>may</em> omit the type from the (sub)literals of the elements, because it is known from the type of the composite literal, so this is also valid:</p>\n\n<pre><code>var iilist = [][]int{\n    {1, 2, 3},\n    {4, 5, 6},\n}\n</code></pre>\n\n<p>Same goes for map literals, this is valid (was added in <a href=\"https://golang.org/doc/go1.5#map_literals\" rel=\"nofollow noreferrer\">Go 1.5</a>):</p>\n\n<pre><code>var imap = map[int][]int{\n    1: {1, 2, 3},\n    2: {4, 5, 6},\n}\n</code></pre>\n\n<p>Try these on the <a href=\"https://play.golang.org/p/bFTAfUBs4u\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6251204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69bfee4bd89205dc355ec4372554f6f6?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/6251204/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1496114598, "creation_date": 1496114598, "answer_id": 44252896, "question_id": 44241014, "link": "https://stackoverflow.com/questions/44241014/initializing-a-slice-by-using-the-var-keyword/44252896#44252896", "title": "Initializing a slice by using the var keyword", "body": "<p>In go, <code>different names mean different types</code>. So when you define a variable, you must specify its type. That means, you need make sure that your assignment is a concrete type. \"{}\" can be more than one type, so the compilier can not find <code>ilist</code> type. BTW, some friends rise a discussion about <a href=\"https://github.com/golang/go/issues/16339#issuecomment-258527920\" rel=\"nofollow noreferrer\">Proposal: Alias declarations for Go</a></p>\n"}], "owner": {"reputation": 1139, "user_id": 746694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AnVrG.png?s=128&g=1", "display_name": "iyasar", "link": "https://stackoverflow.com/users/746694/iyasar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1496114598, "creation_date": 1496056017, "last_edit_date": 1496059234, "question_id": 44241014, "link": "https://stackoverflow.com/questions/44241014/initializing-a-slice-by-using-the-var-keyword", "title": "Initializing a slice by using the var keyword", "body": "<p>Nowadays I am learning Golang and don't understand a situation how Golang behaves.</p>\n\n<p>Here it is a declaration and initialization of a slice by short hand:</p>\n\n<pre><code>ilist := []int{1, 2, 3}  //it works\n</code></pre>\n\n<p>on the other hand if I try to declare and initialize it with the <code>var</code> keyword, it gives an error:</p>\n\n<pre><code>var ilist [] int = {1, 2, 3, 4, 5}  //error\n</code></pre>\n\n<p>If I initialize just a variable (not a slice) it works fine:</p>\n\n<pre><code>var i int = 5 // works fine\n</code></pre>\n\n<p>Why does Golang behave like this, is there any specific reason?</p>\n"}, {"tags": ["go", "snmp", "gosnmp"], "comments": [{"owner": {"reputation": 2502, "user_id": 501739, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6b8fa3bc7278508dd85dc6090608f26c?s=128&d=identicon&r=PG", "display_name": "Jolta", "link": "https://stackoverflow.com/users/501739/jolta"}, "edited": false, "score": 0, "creation_date": 1532348649, "post_id": 44240806, "comment_id": 89925757, "body": "Your value {0x46, 0x61, 0x30, 0x2f, 0x31} does decode to &quot;Fa0/1&quot; if you decide it as ASCII characters. You probably just need to do a type conversion to get it into String."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 7427574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29d9eeaa5f9f37d562fcefbc0807e52?s=128&d=identicon&r=PG", "display_name": "jens", "link": "https://stackoverflow.com/users/7427574/jens"}, "is_accepted": false, "score": 1, "last_activity_date": 1496092875, "creation_date": 1496092875, "answer_id": 44250438, "question_id": 44240806, "link": "https://stackoverflow.com/questions/44240806/gosnmp-get-octetstring-from-snmp-pdu/44250438#44250438", "title": "gosnmp get octetstring from SNMP PDU", "body": "<p>this is ASCII. You need to convert your HEX output. \nI don't have any knowledge of GO.\n<a href=\"https://en.wikipedia.org/wiki/ASCII\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/ASCII</a></p>\n"}], "owner": {"reputation": 1501, "user_id": 6414477, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6a2c251e715864f098ebf4b4057848b1?s=128&d=identicon&r=PG&f=1", "display_name": "rhillhouse", "link": "https://stackoverflow.com/users/6414477/rhillhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496092875, "creation_date": 1496055411, "question_id": 44240806, "link": "https://stackoverflow.com/questions/44240806/gosnmp-get-octetstring-from-snmp-pdu", "title": "gosnmp get octetstring from SNMP PDU", "body": "<p>I am trying to get the <code>OctetString</code> value from an SNMP PDU returned by the <code>gosnmp</code> package. Even the bytes would suffice.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>package snmp_abstract\n\nimport (\n    \"github.com/soniah/gosnmp\"\n    \"time\"\n    \"log\"\n    \"os\"\n    \"strings\"\n)\n\ntype Switch struct {\n    Hostname string\n    Connection gosnmp.GoSNMP\n}\n\n\nvar ConnectionParams = &amp;gosnmp.GoSNMP{\n    Target: \"\",\n    Port: 161,\n    Community: \"community\",\n    Version: gosnmp.Version2c,\n    Timeout: time.Duration(5) * time.Second,\n    Logger: log.New(os.Stdout, \"\", 0),\n}\n\ntype Mibs struct {\n    VtpVlanState,\n    Dot1dBasePortIfIndex string\n}\n\nvar Default = &amp;Mibs{\n    VtpVlanState: \"1.3.6.1.4.1.9.9.46.1.3.1.1.2\",\n    Dot1dBasePortIfIndex: \"1.3.6.1.2.1.17.1.4.1.2\",\n}\n\n\nfunc SNMPGet(conn *gosnmp.GoSNMP, host string, mib []string) {\n    conn.Target = host\n    log.Println(conn)\n    err := conn.Connect()\n    if err != nil {\n        log.Printf(\"Unable to connect to %s\\n\", host)\n    }\n    defer conn.Conn.Close()\n    res, err := conn.Get(mib)\n    if err != nil {\n        log.Println(\"GET error\")\n        log.Print(err)\n    }\n    log.Println(res)\n}\n\n\nfunc SNMPWalk(conn *gosnmp.GoSNMP, host string, mib string) []gosnmp.SnmpPDU {\n    conn.Target = host\n    log.Println(conn)\n    err := conn.Connect()\n    if err != nil {\n        log.Printf(\"Unable to connect to %s\\n\", host)\n    }\n    defer conn.Conn.Close()\n    res, err := conn.BulkWalkAll(mib)\n    if err != nil {\n        log.Println(\"GET error\")\n        log.Print(err)\n    }\n    return res\n}\n\nfunc (sw *Switch) Vlans() []string {\n\n    res := SNMPWalk(&amp;sw.Connection, sw.Hostname, Default.VtpVlanState)\n    var vlans = make([]string, len(res))\n    for i, vlan := range res {\n        oidSlice := strings.Split(vlan.Name, \".\")\n        v := oidSlice[len(oidSlice)-1]\n        vlans[i] = v\n    }\n    return vlans\n}\n\nfunc (sw *Switch) MapBPIIfindex(vlan string)  {\n    log.Println(vlan)\n    s := *sw\n    s.Connection.Community += \"@\" + vlan\n    log.Println(s.Connection.Community)\n    res := SNMPWalk(&amp;s.Connection, s.Hostname, Default.Dot1dBasePortIfIndex)\n    for _, p := range res {\n        log.Println(p.Name)\n        log.Println(p.Value)\n    }\n}\n</code></pre>\n\n<p>When I use the <code>MapBPIIfindex</code> method I get the following output:</p>\n\n<pre><code>OID: [.1.3.6.1.2.1.31.1.1.1.1.10001]\n[decodeValue: type is OctetString]\ndecodeValue: value is []interface {}{[]uint8{0x46, 0x61, 0x30, 0x2f, 0x31}}\n</code></pre>\n\n<p>Now, this should contain an <code>OctetString</code>. The uint8 bytes should decode to <code>Fa0/1</code>, but I am not able to do this.</p>\n\n<p>When I change <code>log.Println(p.Value)</code> to <code>log.Println(p.Value.([]uint8))</code>, I get the following error:</p>\n\n<pre><code>2017/05/29 12:54:59 .1.3.6.1.2.1.17.1.4.1.2\npanic: interface conversion: interface {} is nil, not []uint8\n</code></pre>\n\n<p>How can I get this value? The documentation is not so clear on this.</p>\n"}, {"tags": ["go", "ibm-cloud", "ibm-cloud-tools", "devops-services"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7737819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c06731bb8263bb294686528504bdd75d?s=128&d=identicon&r=PG&f=1", "display_name": "Yuktesh", "link": "https://stackoverflow.com/users/7737819/yuktesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1496055228, "creation_date": 1496055228, "answer_id": 44240741, "question_id": 44240516, "link": "https://stackoverflow.com/questions/44240516/server-unable-to-start-after-deploying-go-app-to-bluemix/44240741#44240741", "title": "Server Unable to Start after deploying go app to Bluemix", "body": "<p>May be this link can help you out there are some Q&amp;A are available on using go with Bluemix </p>\n\n<p><a href=\"https://developer.ibm.com/answers/questions/13591/about-using-go-with-bluemix.html\" rel=\"nofollow noreferrer\">https://developer.ibm.com/answers/questions/13591/about-using-go-with-bluemix.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 1305448, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5283addc63dffc6eee241d2fe6d20e66?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadeep Bose", "link": "https://stackoverflow.com/users/1305448/subhadeep-bose"}, "edited": false, "score": 0, "creation_date": 1496056688, "post_id": 44240778, "comment_id": 75491376, "body": "Thanks. It Worked"}], "tags": [], "owner": {"reputation": 14264, "user_id": 4923755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1sCUT.jpg?s=128&g=1", "display_name": "data_henrik", "link": "https://stackoverflow.com/users/4923755/data-henrik"}, "is_accepted": true, "score": 3, "last_activity_date": 1496055330, "creation_date": 1496055330, "answer_id": 44240778, "question_id": 44240516, "link": "https://stackoverflow.com/questions/44240516/server-unable-to-start-after-deploying-go-app-to-bluemix/44240778#44240778", "title": "Server Unable to Start after deploying go app to Bluemix", "body": "<p>Your code is listening on the hardcoded port \"8081\", not on the one provided by the Bluemix/Cloud Foundry environment. Try something like the following in your <code>Main</code> function:</p>\n\n<pre><code>err := http.ListenAndServe(\":\"+os.Getenv(\"PORT\"), nil)\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 1305448, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5283addc63dffc6eee241d2fe6d20e66?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadeep Bose", "link": "https://stackoverflow.com/users/1305448/subhadeep-bose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 44240778, "answer_count": 2, "score": 0, "last_activity_date": 1496055330, "creation_date": 1496054551, "question_id": 44240516, "link": "https://stackoverflow.com/questions/44240516/server-unable-to-start-after-deploying-go-app-to-bluemix", "title": "Server Unable to Start after deploying go app to Bluemix", "body": "<p>We are unable to deploy our sample go web program to Bluemix. Server is trying to start and finally crashing without any error. Please let me know if any files needs modification. </p>\n\n<p><a href=\"https://github.com/tatai1987/JoinSplit\" rel=\"nofollow noreferrer\">View Our Code In GitHub</a></p>\n\n<pre><code>Build Log:-\n\nPreparing to start the job...\nDownloading build artifacts...\nTarget: https://api.ng.bluemix.net\nUsing manifest file /home/pipeline/4095d817-6887-4f7e-b317-c58c97c5afd7/manifest.yml\n\nCreating app JoinSplit-20170529103009108 in org Subhadeep / space dev as subhadeep.bose@in.ibm.com...\nOK\n\nCreating route joinsplit-20170529103009108-anecdotal-menorah.mybluemix.net...\nOK\n\nBinding joinsplit-20170529103009108-anecdotal-menorah.mybluemix.net to JoinSplit-20170529103009108...\nOK\n\nUploading JoinSplit-20170529103009108...\nUploading app files from: /home/pipeline/4095d817-6887-4f7e-b317-c58c97c5afd7\nUploading 165.2K, 34 files\n\n\nDone uploading\nOK\n\nStarting app JoinSplit-20170529103009108 in org Subhadeep / space dev as subhadeep.bose@in.ibm.com...\nCreating container\nSuccessfully created container\nDownloaded app package (437.8K)\n-----&gt; Download go 1.8.3\n-----&gt; Checking Godeps/Godeps.json file\n-----&gt; Installing godep v79\n       Download [https://buildpacks.cloudfoundry.org/dependencies/godep/godep-v79-linux-x64-9e37ce0f.tgz]\n-----&gt; Installing glide v0.12.3\n       Download [https://buildpacks.cloudfoundry.org/dependencies/glide/glide-v0.12.3-linux-x64-aa256363.tgz]\n-----&gt; Installing go 1.8.3\n       Download [https://buildpacks.cloudfoundry.org/dependencies/go/go1.8.3.linux-amd64-32ec5ac6.tar.gz]\n-----&gt; Running go build finalize\n       [31;1m**WARNING**[0m vendor/ directory does not exist.\n       [31;1m**WARNING**[0m Installing package '.' (default)\n-----&gt; Running: go install -tags cloudfoundry -buildmode pie .\nExit status 0\nStaging complete\nUploading droplet, build artifacts cache...\nUploading build artifacts cache...\nUploading droplet...\nUploaded build artifacts cache (194B)\nUploaded droplet (2.7M)\nUploading complete\nSuccessfully destroyed container\n\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 starting\n0 of 1 instances running, 1 crashed\nFAILED\nError restarting application: Start unsuccessful\n\nTIP: use 'cf logs JoinSplit-20170529103009108 --recent' for more information\n\nFinished: FAILED\n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 179, "user_id": 5802278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a94f4299dfac69693bd99b9d9fa66f59?s=128&d=identicon&r=PG", "display_name": "Ralph Juhnke", "link": "https://stackoverflow.com/users/5802278/ralph-juhnke"}, "is_accepted": false, "score": 2, "last_activity_date": 1498331935, "creation_date": 1498331935, "answer_id": 44740094, "question_id": 44240133, "link": "https://stackoverflow.com/questions/44240133/cant-get-gorm-associations-to-work-as-expected/44740094#44740094", "title": "Can&#39;t get GORM associations to work as expected", "body": "<p>I could not reproduce your problem. I have a working solution here. I suspected that it would not work with the entities in a separate models package, but that worked as well.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/sqlite\"\n    _ \"github.com/mattn/go-sqlite3\"\n)\n\ntype Business struct {\n    ID     uint\n    Name   string `gorm:\"not null\"`\n    Tables Tables `gorm:\"ForeignKey:BusinessID\"`\n}\n\ntype Table struct {\n    ID         uint\n    Ref        string `gorm:\"not null\"`\n    Business   Business\n    BusinessID uint\n}\n\ntype Tables []Table\ntype Businesses []Business\n\nfunc main() {\n    var err error\n    var db *gorm.DB\n\n    db, err = gorm.Open(\"sqlite3\", \"test.db\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer db.Close()\n\n    db.LogMode(true)\n    db.AutoMigrate(&amp;Business{})\n    db.AutoMigrate(&amp;Table{})\n\n    bus := Business{\n        Name: \"Test\",\n        Tables: Tables{\n            Table{Ref: \"A1\"},\n        },\n    }\n    db.Create(&amp;bus)\n    var businesses Businesses\n    db.Preload(\"Tables\").Find(&amp;businesses)\n    log.Println(businesses)\n}\n</code></pre>\n"}], "owner": {"reputation": 1185, "user_id": 4495663, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c964625d8b1b0af294b1fcb2dc197f2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Mason", "link": "https://stackoverflow.com/users/4495663/jacob-mason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2029, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1527757440, "creation_date": 1496053347, "last_edit_date": 1527757440, "question_id": 44240133, "link": "https://stackoverflow.com/questions/44240133/cant-get-gorm-associations-to-work-as-expected", "title": "Can&#39;t get GORM associations to work as expected", "body": "<p>My two models are </p>\n\n<pre><code>package models\n\n// Business ...\ntype Business struct {\n    ID     uint\n    Name   string `gorm:\"not null\"`\n    Tables Tables `gorm:\"ForeignKey:BusinessID\"`\n}\n\n// Businesses ...\ntype Businesses []Business\n</code></pre>\n\n<p>and</p>\n\n<pre><code>package models\n\n// Table ...\ntype Table struct {\n    ID         uint\n    Ref        string `gorm:\"not null\"`\n    Business   Business\n    BusinessID uint\n}\n\n// Tables ...\ntype Tables []Table\n</code></pre>\n\n<p>It may be obvious from the code, but the association should be that one 'business' has many 'tables' and a 'table' belong to a 'business'. However, when the database is created there are no foreign keys created (I am using sqlite3) and when I return the business which has been created with</p>\n\n<pre><code> bus := models.Business{\n        Name: \"Test\",\n        Tables: models.Tables{\n        models.Table{Ref: \"A1\"},\n    },\n}\ndb.Create(&amp;bus)\n</code></pre>\n\n<p>the businesses array is empty, and when the table is returned although the business_id is correct, there is business struct is empty also.</p>\n"}, {"tags": ["templates", "go"], "comments": [{"owner": {"reputation": 585, "user_id": 1154184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/l09s8.png?s=128&g=1", "display_name": "Reyno", "link": "https://stackoverflow.com/users/1154184/reyno"}, "edited": false, "score": 0, "creation_date": 1496053598, "post_id": 44240003, "comment_id": 75489500, "body": "Have a look at <a href=\"https://stackoverflow.com/questions/23193208/how-to-initialize-error-type-in-if-else\">this SO question</a> and from the <a href=\"https://golang.org/doc/effective_go.html#if\" rel=\"nofollow noreferrer\">golang</a> website to get started"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8080863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5roeW.png?s=128&g=1", "display_name": "Nguy\u1ec5n D\u0169ng", "link": "https://stackoverflow.com/users/8080863/nguy%e1%bb%85n-d%c5%a9ng"}, "edited": false, "score": 0, "creation_date": 1496106521, "post_id": 44240174, "comment_id": 75512447, "body": "Thanks, It&#39;s helpful :))"}, {"owner": {"reputation": 324, "user_id": 5208185, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tCjX1.png?s=128&g=1", "display_name": "Pajri Aprilio", "link": "https://stackoverflow.com/users/5208185/pajri-aprilio"}, "edited": false, "score": 0, "creation_date": 1555161009, "post_id": 44240174, "comment_id": 98018287, "body": "hi jussius, could you provide the documentation link for this ?"}], "tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": false, "score": 7, "last_activity_date": 1496053507, "creation_date": 1496053507, "answer_id": 44240174, "question_id": 44240003, "link": "https://stackoverflow.com/questions/44240003/how-to-add-conditional-sentences-in-template/44240174#44240174", "title": "How to add conditional sentences in template", "body": "<p>Templates don't have operators, but they have function <code>eq</code>, which takes two arguments and returns true if they are equal, and function <code>and</code> which also takes two arguments and returns true if they're both true. So you could write the first line in your code as:</p>\n\n<pre><code>{{if (and (eq var1 \"\") (eq var2 \"\"))}}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8080863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5roeW.png?s=128&g=1", "display_name": "Nguy\u1ec5n D\u0169ng", "link": "https://stackoverflow.com/users/8080863/nguy%e1%bb%85n-d%c5%a9ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3548, "favorite_count": 3, "answer_count": 1, "score": 3, "last_activity_date": 1496053507, "creation_date": 1496052945, "last_edit_date": 1496053230, "question_id": 44240003, "link": "https://stackoverflow.com/questions/44240003/how-to-add-conditional-sentences-in-template", "title": "How to add conditional sentences in template", "body": "<p>How to write a conditional in Go Lang like this: </p>\n\n<p><strong>File: view.html</strong></p>\n\n<pre><code>{{ if(var1 ==\"\" &amp;&amp; var2 ==\"\" }}\nALL EMPTY\n{{else}}\nDISPLAY \n{{END}}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1496091897, "post_id": 44238153, "comment_id": 75509006, "body": "Have you tried seeing if the items timeout when you don&#39;t run ListenAndServe inside a goroutine? To test comment out ListenAndServeTLS, run ListenAndServe without launching a separate routine."}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": false, "score": 0, "last_activity_date": 1496117747, "creation_date": 1496117747, "answer_id": 44253322, "question_id": 44238153, "link": "https://stackoverflow.com/questions/44238153/golang1-8-1-timeouthandler-doesnt-affect-multiplexer/44253322#44253322", "title": "Golang1.8.1: TimeoutHandler doesn&#39;t affect multiplexer", "body": "<p>The <code>http.TimeoutHandler</code> is not for making session expired after a certain time. Instead, it's used to limit execution time of a handler, i.e. if given time is elapsed, it will return <code>503 Service Unavailable</code> to HTTP client. Below is an example of such usage:</p>\n\n<pre><code>func handlerNoTimeout(w http.ResponseWriter, r *http.Request) {\n    //This handler takes 1 second to finished, won't timeout\n    time.Sleep(1 * time.Second)\n    w.Write([]byte(\"Handler OK\"))\n}\n\nfunc handlerTimeout(w http.ResponseWriter, r *http.Request) {\n    //This handler takes 4 seconds to finished.\n    //Before finished, it will timeout, \n    //503 response will be sent to client + given message (i.e. Timeout!)\n    time.Sleep(4 * time.Second)\n    w.Write([]byte(\"Handler timeout (never executed)\"))\n}\n\nfunc main() {\n\n    mux := http.NewServeMux()\n    rh := http.RedirectHandler(\"http://10.130.0.10:820/login\", 307)\n    mux.Handle(\"/\", rh)\n    mux.HandleFunc(\"/timeout\", handlerTimeout)\n    mux.HandleFunc(\"/notimeout\", handlerNoTimeout)\n    tmux := http.TimeoutHandler(mux, time.Second*3, \"Timeout!\")\n    go http.ListenAndServe(\":818\", tmux)\n    go http.ListenAndServeTLS(\":821\", \"server.pem\", \"server.key\", tmux)\n    var input string\n    fmt.Scanln(&amp;input)\n    fmt.Println(\"done\")\n}\n</code></pre>\n\n<p>If your access <code>/timeout</code>, you will get <code>503</code> with timeout message, but if you access <code>/notimeout</code>, the http response will be <code>200 OK</code>. </p>\n\n<p>A session is <strong>a state stored</strong> by the server, not <strong>a processing steps/task/job</strong> which may needs time to finish. A session won't expired unless you define a function/method/handler in background, watch the session creation time regularly, and if given time elapsed, mark it as expired. </p>\n\n<p>In your code, it will timeout if redirect handler (i.e. login handler) needs more than 3 seconds.  </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4367986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7920996e38563698fe2e83d0fddfb102?s=128&d=identicon&r=PG&f=1", "display_name": "scroveez", "link": "https://stackoverflow.com/users/4367986/scroveez"}, "is_accepted": false, "score": 0, "last_activity_date": 1496133386, "creation_date": 1496133386, "answer_id": 44257356, "question_id": 44238153, "link": "https://stackoverflow.com/questions/44238153/golang1-8-1-timeouthandler-doesnt-affect-multiplexer/44257356#44257356", "title": "Golang1.8.1: TimeoutHandler doesn&#39;t affect multiplexer", "body": "<p>I figured it out, I had to use ReadTimeout and WriteTimeout instead, here is a working example. </p>\n\n<pre><code>func main(){\n        mux := http.NewServeMux()\n        rh := http.RedirectHandler(\"http://10.103.0.10:8020/login\", 307)\n        mux.Handle(\"/\", rh)\n        s := &amp;http.Server{\n            Addr:       \"10.103.0.10:818\",\n            Handler:        mux,\n            ReadTimeout:    5 * time.Second,\n            WriteTimeout:   5 * time.Second,\n        }\n        ss := &amp;http.Server{\n            Addr:       \"10.103.0.10:821\",\n            Handler:        mux,\n            ReadTimeout:    5 * time.Second,\n            WriteTimeout:   5 * time.Second,\n        }\n        go s.ListenAndServe()\n        go ss.ListenAndServeTLS(\"server.pem\", \"server.key\")\n\n        var input string\n        fmt.Scanln(&amp;input)\n        fmt.Println(\"done\")\n    }\n</code></pre>\n\n<p>Thank you.</p>\n"}], "owner": {"reputation": 11, "user_id": 4367986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7920996e38563698fe2e83d0fddfb102?s=128&d=identicon&r=PG&f=1", "display_name": "scroveez", "link": "https://stackoverflow.com/users/4367986/scroveez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496133386, "creation_date": 1496047416, "question_id": 44238153, "link": "https://stackoverflow.com/questions/44238153/golang1-8-1-timeouthandler-doesnt-affect-multiplexer", "title": "Golang1.8.1: TimeoutHandler doesn&#39;t affect multiplexer", "body": "<p>I have this code which redirect http/s requests to login page, it works except TimeoutHandler has no effect, I mean the sessions don't timeout after 3 seconds:</p>\n\n<pre><code>func main(){\n\n        mux := http.NewServeMux()\n        rh := http.RedirectHandler(\"http://10.130.0.10:820/login\", 307)\n        mux.Handle(\"/\", rh)\n        tmux := http.TimeoutHandler(mux, time.Second*3, \"Timeout!\")\n        go http.ListenAndServe(\"10.130.0.10:818\", tmux)\n        go http.ListenAndServeTLS(\"10.130.0.10:821\", \"server.pem\", \"server.key\", tmux)\n        var input string\n        fmt.Scanln(&amp;input)\n        fmt.Println(\"done\")\n}\n</code></pre>\n\n<p>any advice will be appreciated.</p>\n"}, {"tags": ["go", "revel"], "answers": [{"tags": [], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "is_accepted": true, "score": 0, "last_activity_date": 1496045919, "creation_date": 1496045919, "answer_id": 44237697, "question_id": 44237297, "link": "https://stackoverflow.com/questions/44237297/how-to-run-a-function-before-app-start-in-revel-go-web-framework/44237697#44237697", "title": "How to run a function before App start in Revel Go Web Framework", "body": "<p>I got the answer from community support...<strong>revel.OnAppStart</strong> runs as expected...but only when the environment is PROD not on DEV...because in testing the app is only started by the proxy when there's a request. </p>\n"}], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 44237697, "answer_count": 1, "score": 0, "last_activity_date": 1496045919, "creation_date": 1496044473, "question_id": 44237297, "link": "https://stackoverflow.com/questions/44237297/how-to-run-a-function-before-app-start-in-revel-go-web-framework", "title": "How to run a function before App start in Revel Go Web Framework", "body": "<p>I am using <a href=\"https://revel.github.io/\" rel=\"nofollow noreferrer\">Revel</a> for developing a Go application, I was wondering how can I run a function just before App Loads or something like that. I know <a href=\"https://revel.github.io/\" rel=\"nofollow noreferrer\">Revel</a> provides <strong>revel.OnAppStart</strong> but it runs only when we hit any URL. What I want is to call the function as soon as I run the command <strong>revel run myApp</strong> without any extra things to do.</p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1496042797, "post_id": 44235969, "comment_id": 75483275, "body": "Also related / interesting uncommon (edge) case: <a href=\"https://stackoverflow.com/questions/33859066/slicing-out-of-bounds-error-in-go/33859638#33859638\">Slicing: Out of bounds error in Go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 4, "last_activity_date": 1496040953, "last_edit_date": 1496040953, "creation_date": 1496040650, "answer_id": 44236182, "question_id": 44235969, "link": "https://stackoverflow.com/questions/44235969/in-go-why-does-a1-not-give-an-index-out-of-bounds-error-for-a-capacity-1-s/44236182#44236182", "title": "In Go, why does a[1:] not give an index out of bounds error for a capacity = 1 slice?", "body": "<p>Because <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">the Go specification for slice expressions</a> states:</p>\n\n<blockquote>\n  <p>For a string, array, pointer to array, or slice a, the primary expression</p>\n  \n  <p>a[low : high]</p>\n  \n  <p>constructs a substring or slice.</p>\n  \n  <p>...</p>\n  \n  <p>For convenience, any of the indices may be omitted. A missing low index defaults to zero; a missing high index defaults to the length of the sliced operand:</p>\n  \n  <p>a[2:]  // same as a[2 : len(a)]</p>\n  \n  <p>...</p>\n  \n  <p>For arrays or strings, the indices are in range if 0 &lt;= low &lt;= high &lt;= len(a), otherwise they are out of range.</p>\n</blockquote>\n\n<p>In your case, <code>len(a)</code> is 1, and <code>a[1:]</code> is the same as <code>a[1:1]</code>, which means it is within range.</p>\n"}], "owner": {"reputation": 3, "user_id": 4577129, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102594589129408/picture?type=large", "display_name": "w.g.l.", "link": "https://stackoverflow.com/users/4577129/w-g-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "closed_date": 1496042724, "accepted_answer_id": 44236182, "answer_count": 1, "score": 0, "last_activity_date": 1496040953, "creation_date": 1496039706, "question_id": 44235969, "link": "https://stackoverflow.com/questions/44235969/in-go-why-does-a1-not-give-an-index-out-of-bounds-error-for-a-capacity-1-s", "closed_reason": "Duplicate", "title": "In Go, why does a[1:] not give an index out of bounds error for a capacity = 1 slice?", "body": "<p>Why does the following code <em>not</em> give a \"slice bounds out of range\" error?</p>\n\n<pre><code>a := []int{0}\na = a[1:]\nfmt.Println(a) // []\n</code></pre>\n"}, {"tags": ["api", "selenium", "go", "robotframework"], "comments": [{"owner": {"reputation": 14553, "user_id": 3446126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I37Df.png?s=128&g=1", "display_name": "Todor Minakov", "link": "https://stackoverflow.com/users/3446126/todor-minakov"}, "edited": false, "score": 2, "creation_date": 1496044134, "post_id": 44234834, "comment_id": 75483996, "body": "What kind of API is it? And if it&#39;s an API, not html UI, what does selenium has to do with it?"}], "answers": [{"tags": [], "owner": {"reputation": 1020, "user_id": 4269725, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/931860b057bebbe7cb926856f0fb4684?s=128&d=identicon&r=PG&f=1", "display_name": "Sarada Akurathi", "link": "https://stackoverflow.com/users/4269725/sarada-akurathi"}, "is_accepted": false, "score": 0, "last_activity_date": 1496054845, "creation_date": 1496054845, "answer_id": 44240613, "question_id": 44234834, "link": "https://stackoverflow.com/questions/44234834/can-i-use-go-lang-for-automation-test-instead-of-robot-framework-test/44240613#44240613", "title": "Can I use Go lang for automation test instead of robot framework test?", "body": "<p>If it is REST APIs then, <a href=\"http://rest-assured.io/\" rel=\"nofollow noreferrer\">rest-assured</a>, will be the good option to automate.</p>\n"}], "owner": {"reputation": 1, "user_id": 8079535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba0f9815f63d4bf12cedc03c6f049e5?s=128&d=identicon&r=PG&f=1", "display_name": "Nopsompong Nilchan", "link": "https://stackoverflow.com/users/8079535/nopsompong-nilchan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1053, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1496054845, "creation_date": 1496033687, "question_id": 44234834, "link": "https://stackoverflow.com/questions/44234834/can-i-use-go-lang-for-automation-test-instead-of-robot-framework-test", "title": "Can I use Go lang for automation test instead of robot framework test?", "body": "<p>I want to test API, the program was developed by Golang.\nIf I want to create the automation test, Should I use Go for API test or use go selenium for API testing? Who have any ideas?</p>\n"}, {"tags": ["rest", "go", "cgo"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496040221, "post_id": 44233566, "comment_id": 75481939, "body": "What is the type of the camera? In what platform do you run the go application? According to <a href=\"http://www.gphoto.org/doc/api/gphoto2-camera_8h.html#a8fa6903e3bf0ab26edc4e915512aa44f\" rel=\"nofollow noreferrer\">the manual</a>, the resulting file of <code>gp_camera_capture</code> will be stored in the camera. Maybe it will affect the performance. To assist debugging, measure <a href=\"https://play.golang.org/p/yj1-F8KxX7\" rel=\"nofollow noreferrer\">execution time of a function call</a> in the server so you know exactly which function takes long execution time."}, {"owner": {"reputation": 129, "user_id": 2646996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a1436c327b2d45dd868d514a6662864?s=128&d=identicon&r=PG", "display_name": "gochuck", "link": "https://stackoverflow.com/users/2646996/gochuck"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496156235, "post_id": 44233566, "comment_id": 75539383, "body": "It&#39;s a Nikon D90 and I&#39;m running it on a Raspberrypi2.  What&#39;s interesting is that the call to gp_camera_capture does not place the file on the camera for the D90.  At least not on the SDcard, it puts the file somewhere but I don&#39;t really understand where it goes.  Just /capture001.jpg by what the debug is telling me.  Looking on the camera that file does not exist.  I think it might be a resource issue with the camera itself now, I wrote a function that releases the camera back to the OS and inits it every request and that seems better.  There&#39;s just a problem with occasional failure now."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496157458, "post_id": 44233566, "comment_id": 75540243, "body": "Make sure you lock the <code>&#47;shot</code> handler (e.g. using <code>sync.Mutex</code>) until you finish using the camera to capture one image, since in a web application, handler (<code>&#47;shot</code>) may be called by different client concurrently."}, {"owner": {"reputation": 129, "user_id": 2646996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a1436c327b2d45dd868d514a6662864?s=128&d=identicon&r=PG", "display_name": "gochuck", "link": "https://stackoverflow.com/users/2646996/gochuck"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496336056, "post_id": 44233566, "comment_id": 75631848, "body": "Good thinking, I added that too.  I&#39;d still like to understand why the requests get progressively slower.  I think it&#39;s related to the issue where <code>gp_camera_capture</code> is not actually saving the image to the camera and instead is saving it to some other location."}], "owner": {"reputation": 129, "user_id": 2646996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a1436c327b2d45dd868d514a6662864?s=128&d=identicon&r=PG", "display_name": "gochuck", "link": "https://stackoverflow.com/users/2646996/gochuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496022144, "creation_date": 1496021387, "last_edit_date": 1496022144, "question_id": 44233566, "link": "https://stackoverflow.com/questions/44233566/golang-gphoto2-slow-response", "title": "Golang Gphoto2 slow response", "body": "<p>I'm having a somewhat strange issue with a Go program I wrote that I think may be related to the C library that I'm calling.  The longer the program runs the longer the response time becomes for retrieving a picture.  I'm not what would even be considered a passable C programmer and I'm still new to load C from Go.  I wrote a simple REST interface around a gphoto2 library that allow me to remotely trigger a camera and retrieve the photo.  Ideally I'm going to use it to create a timelapse so I need it to run very long term.  Here's the wrapper:</p>\n\n<pre><code>camera := new(gphoto2go.Camera)\nerr := camera.Init()\nif err &gt; 0 {\n    log.Println(err)\n}\nr := gin.Default()\nr.GET(\"/ping\", func(c *gin.Context) {\n    c.JSON(200, gin.H{\n        \"message\": \"pong\",\n    })\n})\n\nr.GET(\"/shot\", func(c *gin.Context) {\n    //camera.Interrupt()\n    cameraFilePath, err := camera.TriggerCaptureToFile()\n    if err == 0 {\n\n        cameraFileReader := camera.FileReader(cameraFilePath.Folder, cameraFilePath.Name)\n        defer cameraFileReader.Close()\n        buf := new(bytes.Buffer)\n        buf.ReadFrom(cameraFileReader)\n\n        //camera.DeleteFile(cameraFilePath.Folder, cameraFilePath.Name)\n        encodedImage := base64.StdEncoding.EncodeToString(buf.Bytes())\n        c.JSON(200, gin.H{\n            \"image\": encodedImage,\n        })\n        buf.Reset()\n        //c.Data(200, \"image/jpeg\", buf.Bytes())\n\n    } else {\n        log.Println(gphoto2go.CameraResultToString(err))\n        c.Error(errors.New(gphoto2go.CameraResultToString(err)))\n        c.JSON(http.StatusInternalServerError, gphoto2go.CameraResultToString(err))\n        return\n    }\n\n})\nr.Run()\n</code></pre>\n\n<p>Here's the C function from libgphoto2-dev that it's calling:</p>\n\n<pre><code>func (c *Camera) TriggerCaptureToFile() (CameraFilePath, int) {\nvar path CameraFilePath\nvar _path C.CameraFilePath\nerr := C.gp_camera_capture(c.camera, CAPTURE_IMAGE, &amp;_path, c.context)\npath.Name = C.GoString(&amp;_path.name[0])\npath.Folder = C.GoString(&amp;_path.folder[0])\nlog.Println(path.Name)\nlog.Println(path.Folder)\nreturn path, int(err)\n</code></pre>\n\n<p>}</p>\n\n<p>Finally, here's the output.  When I first start the program it takes just a few seconds to retrieve the picture, after a couple of hours it's north of 2 mintues.</p>\n\n<pre><code>Response Status: 200 OK\n2017/05/28 15:50:35 \nResponse Time: 3.217692348s\n2017/05/28 15:50:35 \n\n\nResponse Status: 200 OK\n2017/05/28 19:27:04 \nResponse Time: 2m5.010491487s\n2017/05/28 19:27:04 \n</code></pre>\n"}, {"tags": ["regex", "svg", "go", "re2"], "answers": [{"comments": [{"owner": {"reputation": 1115, "user_id": 1177125, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/wIbfZ.gif?s=128&g=1", "display_name": "buckaroo1177125", "link": "https://stackoverflow.com/users/1177125/buckaroo1177125"}, "edited": false, "score": 0, "creation_date": 1497027533, "post_id": 44233692, "comment_id": 75922837, "body": "Would this mean that replacements are more costly than comparisons? The comparisons for of \\s{2,} would seem more costly than \\s{1,} - unless they were consuming 2 byte/runes instead of 1 based on the pattern."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 1115, "user_id": 1177125, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/wIbfZ.gif?s=128&g=1", "display_name": "buckaroo1177125", "link": "https://stackoverflow.com/users/1177125/buckaroo1177125"}, "edited": false, "score": 0, "creation_date": 1497041503, "post_id": 44233692, "comment_id": 75929831, "body": "@jpj That depends on the text you&#39;re replacing. In the case of XML, <code>\\s{1,}</code> will almost always find and replace something, potentially resulting in devastating performance. <code>\\s{2,}</code> may or may not find anything to replace, so it won&#39;t be quite so harmful to performance as most of the time comparisons, not replacements, will be the primary factor."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 0, "last_activity_date": 1496022846, "creation_date": 1496022846, "answer_id": 44233692, "question_id": 44233520, "link": "https://stackoverflow.com/questions/44233520/regexp-one-or-more-vs-n1-matching/44233692#44233692", "title": "Regexp one or more vs n+1 matching", "body": "<p><code>X+</code> means \"every instance of X that occurs once or more\", which means it's equivalent to <code>{1,}</code>. You're replacing <code></code> (a single blank) as well as <code>&#x00a0; &#x00a0; &#x00a0;</code> when using <code>\\s+</code>.</p>\n\n<p>For an SVG document, or any XML document for that matter, using <code>\\s+</code> is bound to be slow. The following document would require 5 replacements, ignoring newline sequences:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;element attr1=\"value\" attr2=\"value\" attr3=\"value\"/&gt;\n</code></pre>\n\n<p>Now imagine an SVG document that is so much more complex, and it's reasonable that something like <code>\\s{2,}</code> would be a lot faster than <code>\\s+</code> (a.k.a. <code>\\s{1,}</code>)! There'd be 0 replacements in the document above if you used <code>\\s{2,}</code>!</p>\n"}], "owner": {"reputation": 1115, "user_id": 1177125, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/wIbfZ.gif?s=128&g=1", "display_name": "buckaroo1177125", "link": "https://stackoverflow.com/users/1177125/buckaroo1177125"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496022846, "creation_date": 1496020834, "question_id": 44233520, "link": "https://stackoverflow.com/questions/44233520/regexp-one-or-more-vs-n1-matching", "title": "Regexp one or more vs n+1 matching", "body": "<p>I found a regexp replacement in my go project was incredibly slow, \\s+ was being replaced with a single space using regexp.ReplaceAllLiteralString (re2).</p>\n\n<p>It was apparently put there to collapse whitespace in an SVG, regardless of if that's a good idea, when changed to ' {2,}' the operation is 1 tenth the time.</p>\n\n<p>While using \\s vs ' ' is a fair difference - but that makes sense, it's 5x the comparisons. But why when using a single space and +, it is 9x slower than with {2,}?</p>\n"}, {"tags": ["go", "cryptography", "rsa", "private-key", "pem"], "comments": [{"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 0, "creation_date": 1496002906, "post_id": 44230634, "comment_id": 75473161, "body": "Is this a dup of <a href=\"https://stackoverflow.com/q/13555085/714501\">stackoverflow.com/q/13555085/714501</a> ?"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7326777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3f75c8fa57cef50a0d6603dce4317e?s=128&d=identicon&r=PG&f=1", "display_name": "Ed S.", "link": "https://stackoverflow.com/users/7326777/ed-s"}, "edited": false, "score": 4, "creation_date": 1496004567, "post_id": 44231740, "comment_id": 75473614, "body": "Wow, this is intensely helpful.  I did a lot of searching and there was absolutely zero information on this topic.  You&#39;ve helped me immensely and I hope this helps some other cluebirds out there like myself."}, {"owner": {"reputation": 85, "user_id": 72120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f794645d231f7cdcc9ed43e1f1a95129?s=128&d=identicon&r=PG", "display_name": "recurser", "link": "https://stackoverflow.com/users/72120/recurser"}, "edited": false, "score": 0, "creation_date": 1612367147, "post_id": 44231740, "comment_id": 116745875, "body": "Works perfectly!"}, {"owner": {"reputation": 327, "user_id": 499845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pIHEX.jpg?s=128&g=1", "display_name": "Sami Fouad", "link": "https://stackoverflow.com/users/499845/sami-fouad"}, "edited": false, "score": 0, "creation_date": 1617905030, "post_id": 44231740, "comment_id": 118447194, "body": "I was curious about the type assertion here, and it turns out <code>x509.ParsePKCS1PrivateKey</code> only returns <code>*rsa.PrivateKey</code>. But <code>x509.ParsePKCS8PrivateKey</code> returns <code>interface{}</code> because it actually returns <code>*rsa.PrivateKey</code>, a <code>*ecdsa.PrivateKey</code>, or a <code>ed25519.PrivateKey</code> type depending on input. Thanks for your code examples. Literally makes no sense why simple examples like this are so hard to find with Go."}], "tags": [], "owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "is_accepted": true, "score": 44, "last_activity_date": 1496003932, "last_edit_date": 1496003932, "creation_date": 1496003361, "answer_id": 44231740, "question_id": 44230634, "link": "https://stackoverflow.com/questions/44230634/how-to-read-an-rsa-key-from-file/44231740#44231740", "title": "How to read an RSA key from file", "body": "<p>A combination of <a href=\"https://golang.org/pkg/encoding/pem/#Decode\" rel=\"noreferrer\"><code>pem.Decode</code></a> and <a href=\"https://golang.org/pkg/crypto/x509/#ParsePKCS1PrivateKey\" rel=\"noreferrer\"><code>x509.ParsePKCS1PrivateKey</code></a> should do the trick:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/x509\"\n    \"encoding/pem\"\n    \"fmt\"\n)\n\nfunc main() {\n    pemString := `-----BEGIN RSA PRIVATE KEY-----\nMIICXQIBAAKBgQDLets8+7M+iAQAqN/5BVyCIjhTQ4cmXulL+gm3v0oGMWzLupUS\nv8KPA+Tp7dgC/DZPfMLaNH1obBBhJ9DhS6RdS3AS3kzeFrdu8zFHLWF53DUBhS92\n5dCAEuJpDnNizdEhxTfoHrhuCmz8l2nt1pe5eUK2XWgd08Uc93h5ij098wIDAQAB\nAoGAHLaZeWGLSaen6O/rqxg2laZ+jEFbMO7zvOTruiIkL/uJfrY1kw+8RLIn+1q0\nwLcWcuEIHgKKL9IP/aXAtAoYh1FBvRPLkovF1NZB0Je/+CSGka6wvc3TGdvppZJe\nrKNcUvuOYLxkmLy4g9zuY5qrxFyhtIn2qZzXEtLaVOHzPQECQQDvN0mSajpU7dTB\nw4jwx7IRXGSSx65c+AsHSc1Rj++9qtPC6WsFgAfFN2CEmqhMbEUVGPv/aPjdyWk9\npyLE9xR/AkEA2cGwyIunijE5v2rlZAD7C4vRgdcMyCf3uuPcgzFtsR6ZhyQSgLZ8\nYRPuvwm4cdPJMmO3YwBfxT6XGuSc2k8MjQJBAI0+b8prvpV2+DCQa8L/pjxp+VhR\nXrq2GozrHrgR7NRokTB88hwFRJFF6U9iogy9wOx8HA7qxEbwLZuhm/4AhbECQC2a\nd8h4Ht09E+f3nhTEc87mODkl7WJZpHL6V2sORfeq/eIkds+H6CJ4hy5w/bSw8tjf\nsz9Di8sGIaUbLZI2rd0CQQCzlVwEtRtoNCyMJTTrkgUuNufLP19RZ5FpyXxBO5/u\nQastnN77KfUwdj3SJt44U/uh1jAIv4oSLBr8HYUkbnI8\n-----END RSA PRIVATE KEY-----`\n\n    block, _ := pem.Decode([]byte(pemString))\n    key, _ := x509.ParsePKCS1PrivateKey(block.Bytes)\n    fmt.Println(key.N)\n}\n</code></pre>\n\n<p>If what you are sitting on is a PKCS#8 encoded key, instead you would do something like the following:</p>\n\n<pre><code>func main() {\n    pemString := `-----BEGIN PRIVATE KEY-----\nMIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAKhPSTDs4cpKfnMc\np86fCkpnuER7bGc+mGkhkw6bE+BnROfrDCFBSjrENLS5JcsenANQ1kYGt9iVW2fd\nZAWUdDoj+t7g6+fDpzY1BzPSUls421Dmu7joDPY8jSdMzFCeg7Lyj0I36bJJ7ooD\nVPW6Q0XQcb8FfBiFPAKuY4elj/YDAgMBAAECgYBo2GMWmCmbM0aL/KjH/KiTawMN\nnfkMY6DbtK9/5LjADHSPKAt5V8ueygSvI7rYSiwToLKqEptJztiO3gnls/GmFzj1\nV/QEvFs6Ux3b0hD2SGpGy1m6NWWoAFlMISRkNiAxo+AMdCi4I1hpk4+bHr9VO2Bv\nV0zKFxmgn1R8qAR+4QJBANqKxJ/qJ5+lyPuDYf5s+gkZWjCLTC7hPxIJQByDLICw\niEnqcn0n9Gslk5ngJIGQcKBXIp5i0jWSdKN/hLxwgHECQQDFKGmo8niLzEJ5sa1r\nspww8Hc2aJM0pBwceshT8ZgVPnpgmITU1ENsKpJ+y1RTjZD6N0aj9gS9UB/UXdTr\nHBezAkEAqkDRTYOtusH9AXQpM3zSjaQijw72Gs9/wx1RxOSsFtVwV6U97CLkV1S+\n2HG1/vn3w/IeFiYGfZXLKFR/pA5BAQJAbFeu6IaGM9yFUzaOZDZ8mnAqMp349t6Q\nDB5045xJxLLWsSpfJE2Y12H1qvO1XUzYNIgXq5ZQOHBFbYA6txBy/QJBAKDRQN47\n6YClq9652X+1lYIY/h8MxKiXpVZVncXRgY6pbj4pmWEAM88jra9Wq6R77ocyECzi\nXCqi18A/sl6ymWc=\n-----END PRIVATE KEY-----`\n\n    block, _ := pem.Decode([]byte(pemString))\n    parseResult, _ := x509.ParsePKCS8PrivateKey(block.Bytes)\n    key := parseResult.(*rsa.PrivateKey)\n    fmt.Println(key.N)\n}\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7326777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3f75c8fa57cef50a0d6603dce4317e?s=128&d=identicon&r=PG&f=1", "display_name": "Ed S.", "link": "https://stackoverflow.com/users/7326777/ed-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11159, "favorite_count": 4, "accepted_answer_id": 44231740, "answer_count": 1, "score": 9, "last_activity_date": 1496035236, "creation_date": 1495996112, "last_edit_date": 1496035236, "question_id": 44230634, "link": "https://stackoverflow.com/questions/44230634/how-to-read-an-rsa-key-from-file", "title": "How to read an RSA key from file", "body": "<p>I need to read in an RSA private key from a file to sign a JWT.  I have found some examples on how to save a generated RSA key to disk but nothing showing how to build a key struct based on a pre-generated key from a file.</p>\n\n<p>The key is generated like this:</p>\n\n<pre>\nopenssl genrsa 2048 | openssl pkcs8 -topk8 -nocrypt\n</pre>\n\n<p>Example key:</p>\n\n<pre>\n-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQClHYNDPVSF\u200c\u200bFmWF \noKGTqd/n7Dt2+tGXh97KJjVLAqCBZZHlQJ534v2OzFjTgzuMNehD9Y6HnkYF\u200c\u200bdkRb \nQzYi2YDROOzRl1bhyyWPA35OGf50r7LiNvSvNPNtswsCuK7ywOcH0yEMKSiW\u200c\u200b4q5R \nGKYi42w961EcTQQPrfihavY+c2FYPv4+pXymzaIz9hGBPLHwaHq/QTAyHxPC\u200c\u200bfkOo \ns/x3mxUVd7Ni2bz1VJGlyqcNEeU88wTAYMmv8oQ3y2NfKExtYn+W6TCDiq/+\u200c\u200bZkOp \nwacuAU0J7tCNgcXvkq39KH5uza2uSiTniye6uhlkvYWD3s9riIIiekTEiHk/\u200c\u200bkkc6 \njMg8HN/7AgMBAAECggEBAJ12u8vQHV6esUrymaTdCG+BVmRtZpyA ... \n-----END RSA PRIVATE KEY-----\n</pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 490, "user_id": 2406734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pfWwf.jpg?s=128&g=1", "display_name": "Brian Cragun", "link": "https://stackoverflow.com/users/2406734/brian-cragun"}, "edited": false, "score": 0, "creation_date": 1612447703, "post_id": 44230145, "comment_id": 116773921, "body": "@Darian311 Something you seem to be asking, but could be more clearly explained: The reason you can&#39;t pass the parameters <code>pic.Show(Pic(10,10))</code> is that <code>pic.Show</code> expects a  function as parameter.  Thus <code>pic.Show(Pic)</code> You can still call <code>Pic</code> directly.   Try <code>fmt.Println(Pic(3,3))</code> in <code>main</code> and it will print a slice of slices.  e.g. <code>[[0 5 10] [5 0 15] [10 15 0]]</code>"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1495995021, "last_edit_date": 1495995021, "creation_date": 1495992845, "answer_id": 44230145, "question_id": 44230022, "link": "https://stackoverflow.com/questions/44230022/go-tour-18-how-do-i-pass-in-integers-to-pic/44230145#44230145", "title": "Go tour #18. How do I pass in integers to Pic?", "body": "<p>You don't. The Go Tour program will pass <code>Pic</code> test values to your program. Your problem is in your code: <code>panic: runtime error: index out of range</code>. <code>[][]uint8{}</code> and <code>[]uint8{}</code> allocate zero <code>y</code> and zero <code>x</code> slice elements. Use <code>make</code> to allocate your <code>y</code> and <code>x</code> slices. For example,</p>\n\n<pre><code>package main\n\nimport \"golang.org/x/tour/pic\"\n\nfunc Pic(dx, dy int) [][]uint8 {\n    pixels := make([][]uint8, dy)\n    for y := 0; y &lt; dy; y++ {\n        pixels[y] = make([]uint8, dx)\n        for x := 0; x &lt; dx; x++ {\n            pixels[y][x] = uint8((x + y) / 2)\n        }\n    }\n    return pixels\n}\n\nfunc main() {\n    pic.Show(Pic)\n}\n</code></pre>\n\n<p>Reference: <a href=\"https://golang.org/ref/spec#Making_slices_maps_and_channels\" rel=\"nofollow noreferrer\">Making slices, maps and channels, The Go Programming Language Specification</a></p>\n"}], "owner": {"reputation": 764, "user_id": 1405725, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/85157a97c87155b8ec2671e86aef1087?s=128&d=identicon&r=PG", "display_name": "Darian311", "link": "https://stackoverflow.com/users/1405725/darian311"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 1, "accepted_answer_id": 44230145, "answer_count": 1, "score": 2, "last_activity_date": 1495995021, "creation_date": 1495992019, "question_id": 44230022, "link": "https://stackoverflow.com/questions/44230022/go-tour-18-how-do-i-pass-in-integers-to-pic", "title": "Go tour #18. How do I pass in integers to Pic?", "body": "<p>The following code errors with index out of range. I tried modifying main to \npic.Show(Pic(500, 500)) but that changes the argument from function to the return type and it fails to compile.  How do I pass in integers if the pic.Show is expecting a function as an argument.</p>\n\n<pre><code>package main\n\nimport \"golang.org/x/tour/pic\"\n\nfunc Pic(dx, dy int) [][]uint8 {\n\n    mypic := [][]uint8{}\n    for y := 0; y &lt; dy; y++ {\n        mypic[y] = []uint8{}\n        for x := 0; x &lt; dx; x++ {\n            mypic[y][x] = uint8((x + y) / 2)\n        }\n    }\n    return mypic\n}\n\nfunc main() {\n    pic.Show(Pic)\n}\n</code></pre>\n"}, {"tags": ["networking", "go"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1495992841, "post_id": 44225678, "comment_id": 75470193, "body": "you should copy the entire stack trace and error messages, so people can help you"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496034752, "post_id": 44225678, "comment_id": 75479609, "body": "How if you remove fields <code>nFileOffset</code> and <code>hFile</code> from <code>TransmitPacketsElement</code> struct? These fields will share their address with <code>pBuffer</code>."}, {"owner": {"reputation": 267, "user_id": 3142398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-IvPGTvqHRnQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oj_LM08CHikNlfbLewdR2yCc6P6g/mo/photo.jpg?sz=128", "display_name": "Amit Shani", "link": "https://stackoverflow.com/users/3142398/amit-shani"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496124649, "post_id": 44225678, "comment_id": 75517451, "body": "@putu hi thanks for actually taking the time to look at this. I tried removing those fields but still got the same error. any other idea?"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496138226, "post_id": 44225678, "comment_id": 75526112, "body": "How if you remove only <code>nFileOffset</code> not <code>hFile</code>? I didn&#39;t notice that union inside <code>TRANSMIT_PACKETS_ELEMENT</code> takes 16-bytes (I thought it was 8-bytes)."}, {"owner": {"reputation": 267, "user_id": 3142398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-IvPGTvqHRnQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oj_LM08CHikNlfbLewdR2yCc6P6g/mo/photo.jpg?sz=128", "display_name": "Amit Shani", "link": "https://stackoverflow.com/users/3142398/amit-shani"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496138728, "post_id": 44225678, "comment_id": 75526477, "body": "@putu still no luck :( maybe i&#39;m not passing the array pointer right?"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496139262, "post_id": 44225678, "comment_id": 75526833, "body": "One more thing, inside the <code>for</code> loop, you must use <code>tpElements[i]</code> instead of <code>tpElement</code>, because <code>tpElement</code> is just a copy of an item. So the original element array is left uninitialized. So the loop should be <code>for i, _ := range tpElements { ... }</code>"}, {"owner": {"reputation": 267, "user_id": 3142398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-IvPGTvqHRnQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oj_LM08CHikNlfbLewdR2yCc6P6g/mo/photo.jpg?sz=128", "display_name": "Amit Shani", "link": "https://stackoverflow.com/users/3142398/amit-shani"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496139991, "post_id": 44225678, "comment_id": 75527291, "body": "@putu brilliant! can&#39;t believe I missed that. thank you very much it works now!"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1496146580, "post_id": 44225678, "comment_id": 75531884, "body": "You&#39;re welcome. Glad it was helpful."}], "owner": {"reputation": 267, "user_id": 3142398, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-IvPGTvqHRnQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oj_LM08CHikNlfbLewdR2yCc6P6g/mo/photo.jpg?sz=128", "display_name": "Amit Shani", "link": "https://stackoverflow.com/users/3142398/amit-shani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496124812, "creation_date": 1495963249, "last_edit_date": 1496124812, "question_id": 44225678, "link": "https://stackoverflow.com/questions/44225678/calling-winapi-function-in-golang-with-struct-union", "title": "Calling winapi function in golang with struct union", "body": "<p>I am trying to call the TransmitPackets function on windows using GO.<br>\nThe goal is to be able to send multiple packets with one syscall (can't be achieved with WSASend [it'll send fragmented IP packets]).  </p>\n\n<p>My code panics </p>\n\n<pre><code>panic: write udp 192.168.1.26:51817-&gt;8.8.8.8:8000: transmitpackets: An invalid argument was supplied.\ngoroutine 1 [running]:\nmain.main()\n    c:/Users/amit/dev/go/src/rio/main.go:26 +0x210\nexit status 2\nProcess exiting with code: 1\n</code></pre>\n\n<p>Here's my test code</p>\n\n<pre><code>package main\n\nimport (\n    \"math/rand\"\n    \"net\"\n)\n\nfunc main() {\n    raddr, err := net.ResolveUDPAddr(\"udp\", \"8.8.8.8:8000\")\n    if err != nil {\n        panic(err)\n    }\n    con, err := net.DialUDP(\"udp\", nil, raddr)\n    if err != nil {\n        panic(err)\n    }\n\n    packets := make(net.Buffers, 10)\n    for i := 0; i &lt; len(packets); i++ {\n        packets[i] = make([]byte, 1400)\n        rand.Read(packets[i])\n    }\n\n    _, err = con.WriteMultiple(packets)\n    if err != nil {\n        panic(err)\n    }\n\n}\n</code></pre>\n\n<p>and Here's my call to TransmitPackets:  </p>\n\n<pre><code>type TransmitPacketsElement struct {\n    dwElFlags   uint32\n    cLength     uint32\n    pBuffer     unsafe.Pointer\n    nFileOffset uint64\n    hFile       uintptr\n}\n\nfunc transmitPackets(s Handle, bufs [][]byte, overlapped *Overlapped) (err error) {\n    var maxPacketLen = 0\n    tpElements := make([]TransmitPacketsElement, len(bufs))\n    for i, tpElement := range tpElements {\n        buffer := bufs[i]\n        if len(buffer) &gt; maxPacketLen {\n            maxPacketLen = len(buffer)\n        }\n        tpElement.cLength = uint32(len(buffer))\n        tpElement.dwElFlags = uint32(uint32(TP_ELEMENT_MEMORY) | uint32(TP_ELEMENT_EOP))\n        tpElement.pBuffer = unsafe.Pointer(&amp;buffer[0])\n    }\n    r1, _, e1 := Syscall6(transmitPacketsFunc.addr, 6, uintptr(s), uintptr(unsafe.Pointer(&amp;tpElements[0])), uintptr(uint32(len(tpElements))), uintptr(uint32(maxPacketLen)), uintptr(unsafe.Pointer(overlapped)), 0)\n    if r1 == 0 {\n        if e1 != 0 {\n            err = error(e1)\n        } else {\n            err = EINVAL\n        }\n    }\n    return\n}\n</code></pre>\n\n<p>You can see the full implementation in my modified go 1.8.3 source on <a href=\"https://github.com/amits1995/golang1.8.3-transmitpackets\" rel=\"nofollow noreferrer\">github</a></p>\n"}, {"tags": ["github", "go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1495965225, "last_edit_date": 1495965225, "creation_date": 1495964529, "answer_id": 44225874, "question_id": 44224955, "link": "https://stackoverflow.com/questions/44224955/why-can-not-build-godef-go/44225874#44225874", "title": "why can not build godef.go?", "body": "<p>Building a single Go file from a multi-file Go package or command makes no sense. Build all the files. For example,</p>\n\n<pre><code>$ go build godef.go acme.go doc.go\n</code></pre>\n\n<p>or </p>\n\n<pre><code>$ go build *.go\n</code></pre>\n\n<p>Or, simply build the package or command</p>\n\n<pre><code>$ go build github.com/rogpeppe/godef\n</code></pre>\n\n<p>Why are you using <code>go build</code> instead of <code>go install</code>?</p>\n\n<p>Why did you \"pull the soure [sic] code or zipfile\"? Use <code>go get</code>, which does a <code>go install</code> for you, for example,</p>\n\n<pre><code>$ go get -v -u github.com/rogpeppe/godef\ngithub.com/rogpeppe/godef (download)\ngithub.com/rogpeppe/godef/vendor/9fans.net/go/plan9\ngithub.com/rogpeppe/godef/go/token\ngithub.com/rogpeppe/godef/go/scanner\ngithub.com/rogpeppe/godef/go/ast\ngithub.com/rogpeppe/godef/vendor/9fans.net/go/plan9/client\ngithub.com/rogpeppe/godef/vendor/9fans.net/go/acme\ngithub.com/rogpeppe/godef/go/parser\ngithub.com/rogpeppe/godef/go/printer\ngithub.com/rogpeppe/godef/go/types\ngithub.com/rogpeppe/godef\n</code></pre>\n\n<p>Reference:</p>\n\n<p><a href=\"https://golang.org/cmd/go/\" rel=\"nofollow noreferrer\">Command go</a></p>\n"}], "owner": {"reputation": 369, "user_id": 7319013, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/931c0e615c3a4e9ceadb4e70fa0fae34?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7319013/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1495965225, "creation_date": 1495957595, "last_edit_date": 1495963261, "question_id": 44224955, "link": "https://stackoverflow.com/questions/44224955/why-can-not-build-godef-go", "title": "why can not build godef.go?", "body": "<blockquote>\n  <p>first I pull the soure code or zipfile, They both show the same error log like this when I go build godef.go.</p>\n</blockquote>\n\n<pre><code>go build godef.go\n# command-line-arguments\n.\\godef.go:55: undefined: acmeFile\n.\\godef.go:59: undefined: acmeCurrentFile\n</code></pre>\n"}, {"tags": ["go", "webassembly"], "comments": [{"owner": {"reputation": 2115, "user_id": 1934349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LyNoA.jpg?s=128&g=1", "display_name": "paulotorrens", "link": "https://stackoverflow.com/users/1934349/paulotorrens"}, "edited": false, "score": 2, "creation_date": 1495952570, "post_id": 44224311, "comment_id": 75458994, "body": "I&#39;m not sure you understood what WebAssembly is. It has an interface to JavaScript because it is meant to work on web browsers, where JavaScript is the only native language available. Browsers run only JavaScript, so, in order to make WebAssembly work there, they needed to inferface with JavaScript as well. If you&#39;re not making a program that is supposed to work on web browser, you won&#39;t be using WebAssembly as well."}, {"owner": {"reputation": 449, "user_id": 7623709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3b869731c724b20a6dd447a3f87121e6?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/7623709/mike"}, "reply_to_user": {"reputation": 2115, "user_id": 1934349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LyNoA.jpg?s=128&g=1", "display_name": "paulotorrens", "link": "https://stackoverflow.com/users/1934349/paulotorrens"}, "edited": false, "score": 0, "creation_date": 1495953636, "post_id": 44224311, "comment_id": 75459211, "body": "@paulotorrens I think you actually got it wrong. As far as I understood  webassembly is not designed to work on web browsers only. It actually targets IoT/embedded environments too. <a href=\"http://webassembly.org/docs/non-web/\" rel=\"nofollow noreferrer\">webassembly.org/docs/non-web</a>  . To quote the important bits: <code>WebAssembly could be used as a portable binary format on many platforms, bringing great benefits in portability, tooling and language-agnosticity</code>"}, {"owner": {"reputation": 2115, "user_id": 1934349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LyNoA.jpg?s=128&g=1", "display_name": "paulotorrens", "link": "https://stackoverflow.com/users/1934349/paulotorrens"}, "edited": false, "score": 0, "creation_date": 1495954049, "post_id": 44224311, "comment_id": 75459294, "body": "Fair enough; but it&#39;s been designed for the web, and, even on the web environment, it&#39;s still a new technology. Also, the JavaScript interface is surely meant for the web, even if WebAssembly could be used elsewhere. As of now, it won&#39;t be so simple to interface to anything else. Do you <i>need</i> to interpret it? Because, if you&#39;re simply trying to use a C++ library in a Go program, there are certainly easier ways, since you can compile them together using your native compiler. Could you give more details of what you&#39;re trying to achieve?"}, {"owner": {"reputation": 449, "user_id": 7623709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3b869731c724b20a6dd447a3f87121e6?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/7623709/mike"}, "reply_to_user": {"reputation": 2115, "user_id": 1934349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LyNoA.jpg?s=128&g=1", "display_name": "paulotorrens", "link": "https://stackoverflow.com/users/1934349/paulotorrens"}, "edited": false, "score": 0, "creation_date": 1495962309, "post_id": 44224311, "comment_id": 75461089, "body": "I assume that just like JavaScript can access WASM modules any other language should be able to do so. How exactly does JS call wasm?  My use case is a Go applications that needs to execute/load WASM modules on demand just like JS does in a kind of &#39;plugin&#39; architecture. The application is accessing the DOM (and thus discovers the wasm links)  through the webkit API. Simply said think that instead to use JS I use Go bindings to the webkit objective-C API ( <a href=\"https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/DisplayWebContent/DisplayWebContent.htmli\" rel=\"nofollow noreferrer\">developer.apple.com/library/content/documentation/Cocoa/&hellip;</a>)"}, {"owner": {"reputation": 2115, "user_id": 1934349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LyNoA.jpg?s=128&g=1", "display_name": "paulotorrens", "link": "https://stackoverflow.com/users/1934349/paulotorrens"}, "edited": false, "score": 1, "creation_date": 1495963401, "post_id": 44224311, "comment_id": 75461380, "body": "To the best of my knowledge, the only implementations of WebAssembly that currently exist are the ones within JavaScript engines like V8. JavaScript may call and load WebAssembly because the same virtual machine implements both, and, by design, knows how to bridge them. So, if you want to embed WebAssembly in your Go program, you would need to either use a JavaScript engine or implement your own virtual machine to interpret WebAssembly (and thus add an interface to your Go code on it). WebKit uses JavaScriptCore as its virtual machine, which seems to support WebAssembly; you could use it."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1495982178, "post_id": 44224311, "comment_id": 75466926, "body": "If you have WA, you can interface to it in Go by either running a JS interpreter in Go, or by using <a href=\"https://github.com/gopherjs/gopherjs\" rel=\"nofollow noreferrer\">GopherJS</a> to <i>also</i> compile your Go to JS. Likely a better solution in your case is to use cgo to interface directly with the C++. I don&#39;t think WA gives you any advantage--it just adds another unnecessary (and possibly insurmountable) abstraction layer."}, {"owner": {"reputation": 6045, "user_id": 3983557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/01A0D.jpg?s=128&g=1", "display_name": "JF Bastien", "link": "https://stackoverflow.com/users/3983557/jf-bastien"}, "edited": false, "score": 0, "creation_date": 1496024647, "post_id": 44224311, "comment_id": 75477472, "body": "There are non-browser implementation of WebAssembly, e.g. <a href=\"https://github.com/AndrewScheidecker/WAVM\" rel=\"nofollow noreferrer\">github.com/AndrewScheidecker/WAVM</a>, but AFAIK nobody has made it easy to call to / from Go. It&#39;s definitely possible, simply hasn&#39;t been done yet."}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 7623709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3b869731c724b20a6dd447a3f87121e6?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/7623709/mike"}, "edited": false, "score": 0, "creation_date": 1537933433, "post_id": 52490172, "comment_id": 91959315, "body": "How can I do that?(obviously, without using javascript)"}], "tags": [], "owner": {"reputation": 4554, "user_id": 192221, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/38504ff52422b72b239a7b05ef0ccaae?s=128&d=identicon&r=PG", "display_name": "kristianp", "link": "https://stackoverflow.com/users/192221/kristianp"}, "is_accepted": false, "score": 0, "last_activity_date": 1537846150, "creation_date": 1537846150, "answer_id": 52490172, "question_id": 44224311, "link": "https://stackoverflow.com/questions/44224311/is-it-possible-to-call-webassembly-functions-from-go/52490172#52490172", "title": "Is it possible to call WebAssembly functions from Go?", "body": "<p>Recently WebAssembly compilation support has landed for go.  So it should be possible to call other modules from go code that has been compiled to WebAssembly.</p>\n"}], "owner": {"reputation": 449, "user_id": 7623709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3b869731c724b20a6dd447a3f87121e6?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/7623709/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 616, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1537846150, "creation_date": 1495951224, "question_id": 44224311, "link": "https://stackoverflow.com/questions/44224311/is-it-possible-to-call-webassembly-functions-from-go", "title": "Is it possible to call WebAssembly functions from Go?", "body": "<p>I would like to compile a C++ library to webassembly and then use the webassembly library from a Go program. Is it possible? I'm aware of cgo but unfortunately I'm running the code in a restricted environment so I can't use cgo. WebAssembly seems to have a kind of interface for JavaScript so I assume any other language should be able to use the same interface.</p>\n"}, {"tags": ["json", "list", "go"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8076465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f673428ed39bc4de30351f2a3d557e?s=128&d=identicon&r=PG&f=1", "display_name": "Zonda", "link": "https://stackoverflow.com/users/8076465/zonda"}, "edited": false, "score": 0, "creation_date": 1495954147, "post_id": 44224322, "comment_id": 75459314, "body": "sorry\uff0cyour answer is great, but i do not care the button for down. i  agree your idea."}, {"owner": {"reputation": 29, "user_id": 8076465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f673428ed39bc4de30351f2a3d557e?s=128&d=identicon&r=PG&f=1", "display_name": "Zonda", "link": "https://stackoverflow.com/users/8076465/zonda"}, "edited": false, "score": 0, "creation_date": 1495954388, "post_id": 44224322, "comment_id": 75459357, "body": "i just start use this stackoverflow,    i should Adopt your suggestion\uff0cbut now  for my negligence\uff0c the  administrator help me cancel my error elect"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1495951314, "creation_date": 1495951314, "answer_id": 44224322, "question_id": 44224133, "link": "https://stackoverflow.com/questions/44224133/why-do-i-convert-map-to-json-map-includes-list-values-which-is-nothing-after-co/44224322#44224322", "title": "Why do I convert map to json, map includes list values which is nothing after converting to json", "body": "<p>Because the <a href=\"https://godoc.org/container/list#List\" rel=\"nofollow noreferrer\">List</a> type has no exported fields and the type does not implement the <a href=\"https://godoc.org/encoding/json#Marshaler\" rel=\"nofollow noreferrer\">Marshaler</a>interface, List values always marshal to the text <code>{}</code>.</p>\n\n<p>A simple fix is to use a slice instead of a list:</p>\n\n<pre><code>var phoneList []string\nphoneList = append(phoneList, \"18513622928\")\nfmt.Println(\"phoneList=======\", len(phoneList)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gUrxjn27_D\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 29, "user_id": 8076465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f673428ed39bc4de30351f2a3d557e?s=128&d=identicon&r=PG&f=1", "display_name": "Zonda", "link": "https://stackoverflow.com/users/8076465/zonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1495964586, "creation_date": 1495949365, "last_edit_date": 1495964586, "question_id": 44224133, "link": "https://stackoverflow.com/questions/44224133/why-do-i-convert-map-to-json-map-includes-list-values-which-is-nothing-after-co", "title": "Why do I convert map to json, map includes list values which is nothing after converting to json", "body": "<pre><code>func Test_JsonTtransfer(t *testing.T) {\n\n    uid := \"306\"\n    phoneList := list.New()\n    phoneList.PushBack(\"18513622928\")\n    fmt.Println(\"phoneList=======\", phoneList.Len())\n\n\n    jsonPhoneList, err := json.Marshal(phoneList)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    fmt.Println(\"jsonPhoneList=======\", string(jsonPhoneList))\n\n    idCardList := list.New()\n    idCardList.PushBack(\"230405197608040640\")\n\n    request := make(map[string]interface{})\n    request[\"uid\"] = uid\n\n    request[\"phones\"] = phoneList\n\n    request[\"id_cards\"] = idCardList\n\n    json, err := json.Marshal(request)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n\n    fmt.Println(\"json=======\", json)\n    fmt.Println(\"json=======\", string(json))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>D:/Sys/server/Go\\bin\\go.exe test -v golang-test/com/http/test -run ^Test_JsonTtransfer$\n  phoneList======= 1\n  jsonPhoneList======= {}\n  json======= [123 34 105 100 95 99 97 114 100 115 34 58 123 125 44 34 112 104 111 110 101 115 34 58 123 125 44 34 117 105 100 34 58 34 51 48 54 34 125]\n  json======= {\"id_cards\":{},\"phones\":{},\"uid\":\"306\"}\n  ok     golang-test/com/http/test   0.482s</p>\n</blockquote>\n\n<p>Phones should be list values, but nothing. Help me.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 33, "last_activity_date": 1495930574, "last_edit_date": 1495930574, "creation_date": 1495929393, "answer_id": 44222606, "question_id": 44222554, "link": "https://stackoverflow.com/questions/44222554/how-to-remove-quotes-from-around-a-string-in-golang/44222606#44222606", "title": "How to remove quotes from around a string in Golang", "body": "<p>Use a <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"noreferrer\">slice expression</a>:</p>\n\n<pre><code>s = s[1 : len(s)-1]\n</code></pre>\n\n<p>If there's a possibility that the quotes are not present, then use this:</p>\n\n<pre><code>if len(s) &gt; 0 &amp;&amp; s[0] == '\"' {\n    s = s[1:]\n}\nif len(s) &gt; 0 &amp;&amp; s[len(s)-1] == '\"' {\n    s = s[:len(s)-1]\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/x_DG9vHvzY\" rel=\"noreferrer\">playground example</a></p>\n"}, {"comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1495945375, "post_id": 44222648, "comment_id": 75457899, "body": "@CeriseLim&#243;n Thanks, I&#39;m still learning the relationship between string and []byte. I had a page that explained when a copy would happen and when it wouldn&#39;t, but I&#39;ve misplaced it. Do you have a resource?"}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 2, "last_activity_date": 1495945728, "last_edit_date": 1495945728, "creation_date": 1495929933, "answer_id": 44222648, "question_id": 44222554, "link": "https://stackoverflow.com/questions/44222554/how-to-remove-quotes-from-around-a-string-in-golang/44222648#44222648", "title": "How to remove quotes from around a string in Golang", "body": "<p>You can take advantage of slices to remove the first and last element of the slice.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    str := `\"hello\"\"world\"`\n\n    if str[0] == '\"' {\n        str = str[1:]\n    }\n    if i := len(str)-1; str[i] == '\"' {\n        str = str[:i]\n    }\n\n    fmt.Println( str )\n}\n</code></pre>\n\n<p>Since a slice shares the underlying memory, this does not copy the string. It just changes the <code>str</code> slice to start one character over, and end one character sooner.</p>\n\n<p>This is how <a href=\"https://golang.org/src/bytes/bytes.go\" rel=\"nofollow noreferrer\">the various bytes.Trim functions</a> work.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1495933381, "creation_date": 1495933381, "answer_id": 44222891, "question_id": 44222554, "link": "https://stackoverflow.com/questions/44222554/how-to-remove-quotes-from-around-a-string-in-golang/44222891#44222891", "title": "How to remove quotes from around a string in Golang", "body": "<p>Use <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">slice expressions</a>. You should write robust code that provides correct output for imperfect input. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc trimQuotes(s string) string {\n    if len(s) &gt;= 2 {\n        if s[0] == '\"' &amp;&amp; s[len(s)-1] == '\"' {\n            return s[1 : len(s)-1]\n        }\n    }\n    return s\n}\n\nfunc main() {\n    tests := []string{\n        `\"hello\"\"world\"`,\n        `\"\"\"hello\"\"\"`,\n        `\"`,\n        `\"\"`,\n        `\"\"\"`,\n        `goodbye\"`,\n        `\"goodbye\"`,\n        `goodbye\"`,\n        `good\"bye`,\n    }\n\n    for _, test := range tests {\n        fmt.Printf(\"`%s` -&gt; `%s`\\n\", test, trimQuotes(test))\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>`\"hello\"\"world\"` -&gt; `hello\"\"world`\n`\"\"\"hello\"\"\"` -&gt; `\"\"hello\"\"`\n`\"` -&gt; `\"`\n`\"\"` -&gt; ``\n`\"\"\"` -&gt; `\"`\n`goodbye\"` -&gt; `goodbye\"`\n`\"goodbye\"` -&gt; `goodbye`\n`goodbye\"` -&gt; `goodbye\"`\n`good\"bye` -&gt; `good\"bye`\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "is_accepted": false, "score": 0, "last_activity_date": 1575349231, "creation_date": 1575349231, "answer_id": 59150432, "question_id": 44222554, "link": "https://stackoverflow.com/questions/44222554/how-to-remove-quotes-from-around-a-string-in-golang/59150432#59150432", "title": "How to remove quotes from around a string in Golang", "body": "<p>A one-liner using regular expressions...</p>\n\n<pre><code>quoted = regexp.MustCompile(`^\"(.*)\"$`).ReplaceAllString(quoted,`$1`)\n</code></pre>\n\n<p>But it doesn't necessarily handle escaped quotes they way you might want.</p>\n\n<p><a href=\"https://play.golang.org/p/vqtzieLdt3H\" rel=\"nofollow noreferrer\">The Go Playground</a></p>\n\n<p><em>Translated from <a href=\"https://stackoverflow.com/a/19156525/86967\">here</a>.</em></p>\n"}, {"comments": [{"owner": {"reputation": 1591, "user_id": 622121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb5b05a7391cfa97fc9016ce95471ee?s=128&d=identicon&r=PG", "display_name": "Kenji Noguchi", "link": "https://stackoverflow.com/users/622121/kenji-noguchi"}, "edited": false, "score": 1, "creation_date": 1585793507, "post_id": 59561207, "comment_id": 107890477, "body": "<code>Trim</code> is handy if I know the format of the input string."}], "tags": [], "owner": {"reputation": 1383, "user_id": 4457831, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-yRdAUOMzpcU/AAAAAAAAAAI/AAAAAAAAAHQ/1fFS--Cdp-k/photo.jpg?sz=128", "display_name": "Rahul Satal", "link": "https://stackoverflow.com/users/4457831/rahul-satal"}, "is_accepted": false, "score": 4, "last_activity_date": 1614816805, "last_edit_date": 1614816805, "creation_date": 1577958336, "answer_id": 59561207, "question_id": 44222554, "link": "https://stackoverflow.com/questions/44222554/how-to-remove-quotes-from-around-a-string-in-golang/59561207#59561207", "title": "How to remove quotes from around a string in Golang", "body": "<p><code>strings.Trim()</code> can be used to remove the leading and trailing whitespace from a string. It won't work if the double quotes are in between the string.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;strings&quot;\n)\n\nfunc main() {\n\n    // strings.Trim() will work in this case\n    \n    s := `&quot;hello&quot;`\n    fmt.Println(&quot;Without trim: &quot; + s)               // Without trim: &quot;  hello&quot;\n    fmt.Println(&quot;Trim double quotes: &quot; + strings.Trim(s, &quot;\\&quot;&quot;)) // Trim double quotes:   hello\n    \n    \n    // strings.Trim() will not work in this case\n    \n    s2 := `&quot;Hello&quot; &quot;World&quot;`\n    fmt.Println(&quot;Without trim: &quot; + s2)              // Without trim: &quot;  hello&quot;\n    fmt.Println(&quot;Trim double quotes: &quot; + strings.Trim(s2, &quot;\\&quot;&quot;))    // Trim double quotes:   hello\n}\n</code></pre>\n<p>Playground link - <a href=\"https://play.golang.org/p/x_DG9vHvzY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/x_DG9vHvzY</a></p>\n"}], "owner": {"reputation": 309, "user_id": 7978209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-0tS3hTugsBA/AAAAAAAAAAI/AAAAAAAAAAo/vDTNdiOMIXM/photo.jpg?sz=128", "display_name": "RamaRaunt", "link": "https://stackoverflow.com/users/7978209/ramaraunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16203, "favorite_count": 2, "accepted_answer_id": 44222606, "answer_count": 5, "score": 17, "last_activity_date": 1614816805, "creation_date": 1495928788, "question_id": 44222554, "link": "https://stackoverflow.com/questions/44222554/how-to-remove-quotes-from-around-a-string-in-golang", "title": "How to remove quotes from around a string in Golang", "body": "<p>I have a string in Golang that is surrounded by quote marks. My goal is to remove all quote marks on the sides, but to ignore all quote marks in the interior of the string. How should I go about doing this? My instinct tells me to use a RemoveAt function like in C#, but I don't see anything like that in Go.</p>\n\n<p>For instance:</p>\n\n<pre><code>\"hello\"\"world\"\n</code></pre>\n\n<p>should be converted to:</p>\n\n<pre><code>hello\"\"world\n</code></pre>\n\n<p>For further clarification, this:</p>\n\n<pre><code>\"\"\"hello\"\"\"\n</code></pre>\n\n<p>would become this:</p>\n\n<pre><code>\"\"hello\"\"\n</code></pre>\n\n<p>because the outer ones should be removed ONLY.</p>\n"}, {"tags": ["google-app-engine", "go", "gcloud"], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 1257207, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/19b10d10a2677081cae12713d5f21b48?s=128&d=identicon&r=PG", "display_name": "Belgikoi", "link": "https://stackoverflow.com/users/1257207/belgikoi"}, "edited": false, "score": 0, "creation_date": 1495934920, "post_id": 44222346, "comment_id": 75456469, "body": "Thanks for your answer.  It created me 2 folders Godeps and vendor (which contains the content of my dependencies); but I still receive the same error from App Engine : main.go:4: can&#39;t find import: &quot;github.com/julienschmidt/httprouter&quot;"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 365, "user_id": 1257207, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/19b10d10a2677081cae12713d5f21b48?s=128&d=identicon&r=PG", "display_name": "Belgikoi", "link": "https://stackoverflow.com/users/1257207/belgikoi"}, "edited": false, "score": 0, "creation_date": 1495946192, "post_id": 44222346, "comment_id": 75457994, "body": "are you including everything in the app.yaml ?"}, {"owner": {"reputation": 365, "user_id": 1257207, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/19b10d10a2677081cae12713d5f21b48?s=128&d=identicon&r=PG", "display_name": "Belgikoi", "link": "https://stackoverflow.com/users/1257207/belgikoi"}, "edited": false, "score": 0, "creation_date": 1495973082, "post_id": 44222346, "comment_id": 75464135, "body": "Hi, I added the content of my app.yaml in edit :) Reading the response of @Ain, it&#39;s seems that GoDeps can&#39;t help me. Is it true ?"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 365, "user_id": 1257207, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/19b10d10a2677081cae12713d5f21b48?s=128&d=identicon&r=PG", "display_name": "Belgikoi", "link": "https://stackoverflow.com/users/1257207/belgikoi"}, "edited": false, "score": 0, "creation_date": 1495993328, "post_id": 44222346, "comment_id": 75470319, "body": "not sure what&#39;s the exact Go version of app engine, but in case of an old one you should try to <code>export GO15VENDOREXPERIMENT=1</code>, also the problem looks like a app engine problem, try to find how to include all files and sub-folders"}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 1, "last_activity_date": 1495926288, "creation_date": 1495926288, "answer_id": 44222346, "question_id": 44222046, "link": "https://stackoverflow.com/questions/44222046/app-engine-deploy-with-go-libraries/44222346#44222346", "title": "App Engine deploy with Go libraries", "body": "<p>App Engine environment doesn't contain your dependencies, you can add an script to do a go get ... for each one but it's too hacky and Go has a solution for that, we can save our dependencies in a <strong>vendor</strong> folder on the root of our project.</p>\n\n<p><strong>Quick solution</strong>:</p>\n\n<pre><code># Instal godep:\ngo get -v -u github.com/tools/godep\n\ncd your/project/path\ngodep save\n</code></pre>\n\n<p>Now try to deploy again, you'll see a <strong>vendor</strong> folder in your project, don't remove it and add it to your git source, that folder contains all your third party dependencies like your httprouter (it's my favorite :) )</p>\n\n<p>Note You can use other tools to save your dependencies </p>\n"}, {"tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": false, "score": 0, "last_activity_date": 1495956514, "creation_date": 1495956514, "answer_id": 44224839, "question_id": 44222046, "link": "https://stackoverflow.com/questions/44222046/app-engine-deploy-with-go-libraries/44224839#44224839", "title": "App Engine deploy with Go libraries", "body": "<p>I haven't used the <code>gcloud</code> tool, but back in the day when <code>goapp</code> was the tool you had to create <code>github.com/julienschmidt/httprouter</code> (with the lib's source in it, of course) directly under you'r <code>main</code> and then deploy.</p>\n\n<p>AFAIK the App Engine's go version is currently 1.6 which means that while the vendoring is on by default, it can be switched off - perhaps thats the case and thats why @Yandry Pozo's suggestion doesn't work.</p>\n"}], "owner": {"reputation": 365, "user_id": 1257207, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/19b10d10a2677081cae12713d5f21b48?s=128&d=identicon&r=PG", "display_name": "Belgikoi", "link": "https://stackoverflow.com/users/1257207/belgikoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495973012, "creation_date": 1495923063, "last_edit_date": 1495973012, "question_id": 44222046, "link": "https://stackoverflow.com/questions/44222046/app-engine-deploy-with-go-libraries", "title": "App Engine deploy with Go libraries", "body": "<p>I'm new on Google App Engine. And, I'm getting an issue that I can't solve.</p>\n\n<p>I've a very simple app (developped in Go) like this :</p>\n\n<pre><code>main/\n|   model/\n|   |   user.go\n|   main.go\n|   app.yaml\n</code></pre>\n\n<p>These are the imports of main.go :</p>\n\n<pre><code>import (\n    \"github.com/julienschmidt/httprouter\"\n    \"log\"\n    \"net/http\"\n)\n</code></pre>\n\n<p>My code works well when I run it locally.</p>\n\n<p>But, when I try to publish it on my Google App Engine instance, I receive this error :</p>\n\n<pre><code>$ gcloud app deploy\n\nYou are about to deploy the following services:\n - &lt;MY_APP_ENGINE_URL&gt; (from [&lt;MY_LOCAL_YAML_PATH&gt;])\n Deploying to URL: [&lt;MY_APP_ENGINE_URL&gt;]\n\nDo you want to continue (Y/n)?  Y\n\nBeginning deployment of service [default]...\nSome files were skipped. Pass `--verbosity=info` to see which ones.\nYou may also view the gcloud log file, found at\n[&lt;LOCAL_APP_ENGINE_LOG&gt;].\nFile upload done.\nUpdating service [default]...failed.                                                                                                                                                             \nERROR: (gcloud.app.deploy) Error Response: [9] Deployment contains files that cannot be compiled: Compile failed:\n2017/05/27 14:48:24 go-app-builder: build timing: 5\u00d7compile (301ms total), 0\u00d7link (0s total)\n2017/05/27 14:48:24 go-app-builder: failed running compile: exit status 2\n\nmain.go:4: can't find import: \"github.com/julienschmidt/httprouter\"\n</code></pre>\n\n<p>What did I do wrong ?</p>\n\n<p><strong>EDIT :</strong>\nThis is the content of my app.yaml file :</p>\n\n<pre><code>runtime: go\napi_version: go1\n\nhandlers:\n- url: /.*\n  script: _go_app\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "edited": false, "score": 0, "creation_date": 1495917333, "post_id": 44221360, "comment_id": 75453163, "body": "uhhhh thank you @Flimzy I was also trying <code>&amp;time.Now()</code> but now I see my error"}, {"owner": {"reputation": 1362, "user_id": 5699570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-fRpOyxCifSQ/AAAAAAAAAAI/AAAAAAAAAWA/NtmKw1pR05c/photo.jpg?sz=128", "display_name": "kien bui", "link": "https://stackoverflow.com/users/5699570/kien-bui"}, "edited": false, "score": 1, "creation_date": 1495936781, "post_id": 44221360, "comment_id": 75456756, "body": "you must use a var to get address memory of time.Now"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 6, "last_activity_date": 1495917109, "creation_date": 1495917109, "answer_id": 44221360, "question_id": 44221345, "link": "https://stackoverflow.com/questions/44221345/assign-pointer-to-variable-in-golang/44221360#44221360", "title": "Assign pointer to variable in Golang", "body": "<pre><code>t := time.Now()\ncontact.Deleted_At = &amp;t\n</code></pre>\n\n<p>And BTW, you should not use <code>_</code> in variable names. <code>DeletedAt</code> would be the recommended name.</p>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1973, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1495917109, "creation_date": 1495916985, "last_edit_date": 1495917074, "question_id": 44221345, "link": "https://stackoverflow.com/questions/44221345/assign-pointer-to-variable-in-golang", "title": "Assign pointer to variable in Golang", "body": "<p>I am working in Golang, I have a Struct that contains some fields, one of them is a <code>time.Time</code> field to save the <code>Delete_At</code>so it can be null, basically I have defined it as:</p>\n\n<pre><code>type Contact struct {\n     Delete_At *time.Time\n}\n</code></pre>\n\n<p>So, with the pointer it can be null. Then, I have a method when this value is assigned, I have something like:</p>\n\n<pre><code>contact := Contact{}\ncontact.Deleted_At = time.Now() \n</code></pre>\n\n<p>But with it, I get:</p>\n\n<pre><code>cannot use time.Now() (type time.Time) as type *time.Time in assignment\n</code></pre>\n\n<p>I totally understand that is a bad assignment, but, how should I do it? how the conversion should be done?</p>\n"}, {"tags": ["go", "raspberry-pi", "gtk"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1495913084, "post_id": 44217852, "comment_id": 75452088, "body": "Did you install a raspberry pi-native version of GTK+ somewhere and set your <code>$PKG_CONFIG_PATH</code> properly to point to it? If you don&#39;t do that, you won&#39;t be able to cross-compile GTK+ programs, and it looks like you&#39;re trying to use the system-native GTK+ there."}, {"owner": {"reputation": 197, "user_id": 7995484, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bc8536b73ceadb9415a083decb90ce09?s=128&d=identicon&r=PG&f=1", "display_name": "JosephCenk", "link": "https://stackoverflow.com/users/7995484/josephcenk"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1495950601, "post_id": 44217852, "comment_id": 75458613, "body": "@andlabs , please advise how do I install GTK+ version of RaspberryPi on Ubuntu and set $PKG_CONFIG_PATH."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1495990879, "post_id": 44217852, "comment_id": 75469652, "body": "I don&#39;t know; sorry. You&#39;ll have to consult the documentation for the distro you&#39;re running on your Raspberry Pi. Your <code>go env</code> output says you already have the compiler set up, at least \u2014 look up the docs that talked about using <code>arm-linux-gnueabi-gcc</code>..."}], "answers": [{"tags": [], "owner": {"reputation": 197, "user_id": 7995484, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bc8536b73ceadb9415a083decb90ce09?s=128&d=identicon&r=PG&f=1", "display_name": "JosephCenk", "link": "https://stackoverflow.com/users/7995484/josephcenk"}, "is_accepted": false, "score": 1, "last_activity_date": 1496064402, "creation_date": 1496064402, "answer_id": 44243665, "question_id": 44217852, "link": "https://stackoverflow.com/questions/44217852/go-gtk-cross-compilation-for-raspberrypi/44243665#44243665", "title": "GO-GTK Cross Compilation for RaspberryPi", "body": "<p>After removing amd64 gtk libraries and reinstalling 32bit libraries it works fine.   </p>\n"}], "owner": {"reputation": 197, "user_id": 7995484, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bc8536b73ceadb9415a083decb90ce09?s=128&d=identicon&r=PG&f=1", "display_name": "JosephCenk", "link": "https://stackoverflow.com/users/7995484/josephcenk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496064402, "creation_date": 1495894217, "question_id": 44217852, "link": "https://stackoverflow.com/questions/44217852/go-gtk-cross-compilation-for-raspberrypi", "title": "GO-GTK Cross Compilation for RaspberryPi", "body": "<p>I am using GO-GTK to display images, the project is working fine on amd64 but when I try to cross compile it for arm (RaspberryPi), it gives me below error.\nPlease advise how to cross-compile go-gtk from amd64 to arm (Raspberrypi3).</p>\n\n<p>Compiler Output given below</p>\n\n<pre><code>    github.com/mattn/go-gtk/glib\n# github.com/mattn/go-gtk/glib\nIn file included from /usr/lib/x86_64-linux-gnu/glib-2.0/include/glibconfig.h:9:0,\n                 from /usr/include/glib-2.0/glib/gtypes.h:32,\n                 from /usr/include/glib-2.0/glib/galloca.h:32,\n                 from /usr/include/glib-2.0/glib.h:30,\n                 from ./glib.go.h:4,\n                 from src/github.com/mattn/go-gtk/glib/glib.go:5:\n/usr/include/glib-2.0/glib/gtypes.h: In function '_GLIB_CHECKED_ADD_U64':\n/usr/include/glib-2.0/glib/gmacros.h:232:53: error: size of array '_GStaticAssertCompileTimeAssertion_0' is negative\n #define G_STATIC_ASSERT(expr) typedef char G_PASTE (_GStaticAssertCompileTimeAssertion_, __COUNTER__)[(expr) ? 1 : -1] G_GNUC_UNUSED\n                                                     ^\n/usr/include/glib-2.0/glib/gmacros.h:229:47: note: in definition of macro 'G_PASTE_ARGS'\n #define G_PASTE_ARGS(identifier1,identifier2) identifier1 ## identifier2\n                                               ^\n/usr/include/glib-2.0/glib/gmacros.h:232:44: note: in expansion of macro 'G_PASTE'\n #define G_STATIC_ASSERT(expr) typedef char G_PASTE (_GStaticAssertCompileTimeAssertion_, __COUNTER__)[(expr) ? 1 : -1] G_GNUC_UNUSED\n                                            ^\n/usr/include/glib-2.0/glib/gtypes.h:422:3: note: in expansion of macro 'G_STATIC_ASSERT'\n   G_STATIC_ASSERT(sizeof (unsigned long long) == sizeof (guint64));\n   ^\ngithub.com/mattn/go-gtk/pango\n# github.com/mattn/go-gtk/pango\nIn file included from /usr/lib/x86_64-linux-gnu/glib-2.0/include/glibconfig.h:9:0,\n                 from /usr/include/glib-2.0/glib/gtypes.h:32,\n                 from /usr/include/glib-2.0/glib/galloca.h:32,\n                 from /usr/include/glib-2.0/glib.h:30,\n                 from /usr/include/pango-1.0/pango/pango-coverage.h:25,\n                 from /usr/include/pango-1.0/pango/pango-font.h:25,\n                 from /usr/include/pango-1.0/pango/pango-attributes.h:25,\n                 from /usr/include/pango-1.0/pango/pango.h:25,\n                 from ./pango.go.h:7,\n                 from src/github.com/mattn/go-gtk/pango/pango.go:5:\n/usr/include/glib-2.0/glib/gtypes.h: In function '_GLIB_CHECKED_ADD_U64':\n/usr/include/glib-2.0/glib/gmacros.h:232:53: error: size of array '_GStaticAssertCompileTimeAssertion_0' is negative\n #define G_STATIC_ASSERT(expr) typedef char G_PASTE (_GStaticAssertCompileTimeAssertion_, __COUNTER__)[(expr) ? 1 : -1] G_GNUC_UNUSED\n                                                     ^\n/usr/include/glib-2.0/glib/gmacros.h:229:47: note: in definition of macro 'G_PASTE_ARGS'\n #define G_PASTE_ARGS(identifier1,identifier2) identifier1 ## identifier2\n                                               ^\n/usr/include/glib-2.0/glib/gmacros.h:232:44: note: in expansion of macro 'G_PASTE'\n #define G_STATIC_ASSERT(expr) typedef char G_PASTE (_GStaticAssertCompileTimeAssertion_, __COUNTER__)[(expr) ? 1 : -1] G_GNUC_UNUSED\n                                            ^\n/usr/include/glib-2.0/glib/gtypes.h:422:3: note: in expansion of macro 'G_STATIC_ASSERT'\n   G_STATIC_ASSERT(sizeof (unsigned long long) == sizeof (guint64));\n</code></pre>\n\n<p><strong>ENVIRONMENT VARIABLES</strong></p>\n\n<pre><code>    GOARCH=\"arm\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/minhaj/GoLang\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nGOARM=\"\"\nCC=\"arm-linux-gnueabi-gcc\"\nGOGCCFLAGS=\"-fPIC -marm -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build977266484=/tmp/go-build -gno-record-gcc-switches\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nPKG_CONFIG=\"pkg-config\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 2, "creation_date": 1495886101, "post_id": 44216442, "comment_id": 75443853, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37439776/why-is-my-golang-channel-write-blocking-forever\">Why is my Golang Channel Write Blocking Forever?</a>"}, {"owner": {"reputation": 7484, "user_id": 51782, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6383e7bd5cda4af93903ba10aef2038?s=128&d=identicon&r=PG", "display_name": "Sri Sankaran", "link": "https://stackoverflow.com/users/51782/sri-sankaran"}, "reply_to_user": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 0, "creation_date": 1495893430, "post_id": 44216442, "comment_id": 75446053, "body": "@MichaelHausenblas True. Didn&#39;t spot it.  Sorry."}], "answers": [{"comments": [{"owner": {"reputation": 7484, "user_id": 51782, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6383e7bd5cda4af93903ba10aef2038?s=128&d=identicon&r=PG", "display_name": "Sri Sankaran", "link": "https://stackoverflow.com/users/51782/sri-sankaran"}, "edited": false, "score": 1, "creation_date": 1495893310, "post_id": 44216515, "comment_id": 75446012, "body": "Aha!  Even though I quoted it, I didn&#39;t <i>get it</i> until I re-read after reading your reply.  The <i>send</i> is blocked because no one is waiting to receive.  And it is blocked for ever since the receiver won&#39;t be reached.  Ergo deadlock.  Thanks."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1495948358, "post_id": 44216515, "comment_id": 75458270, "body": "Or use a buffered channel."}, {"owner": {"reputation": 7484, "user_id": 51782, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6383e7bd5cda4af93903ba10aef2038?s=128&d=identicon&r=PG", "display_name": "Sri Sankaran", "link": "https://stackoverflow.com/users/51782/sri-sankaran"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1495975404, "post_id": 44216515, "comment_id": 75464800, "body": "@Adrian Yes, I am aware of that &quot;workaround.  It was my oversight in not stating clearly in my question that I was trying to understand the behavior of <i>unbuffered</i> channels."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1495981434, "post_id": 44216515, "comment_id": 75466688, "body": "In an unbuffered channel, there is nowhere for the value to go until another routine reads it. In your single threaded, unbuffered example in the question, where would that 17 be between when it&#39;s written to the channel and when it&#39;s read? With no buffer, there isn&#39;t anywhere to hold that value until the next line executes."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 8, "last_activity_date": 1495895177, "last_edit_date": 1495895177, "creation_date": 1495885973, "answer_id": 44216515, "question_id": 44216442, "link": "https://stackoverflow.com/questions/44216442/why-does-a-channel-in-golang-require-a-go-routine/44216515#44216515", "title": "Why does a channel in golang require a go-routine?", "body": "<blockquote>\n  <p>By default, sends and receives block until the other side is ready.</p>\n</blockquote>\n\n<p>Exactly: since no go routine is waiting to receive, the send is blocked, and your program deadlocks. The send operation does not get skipped over because no one is waiting to receive.</p>\n\n<p>If you want to do a non-blocking send, you would use the send operator in a select statement with a default case:</p>\n\n<pre><code>select {\ncase c &lt;- 17:\ndefault:\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7484, "user_id": 51782, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6383e7bd5cda4af93903ba10aef2038?s=128&d=identicon&r=PG", "display_name": "Sri Sankaran", "link": "https://stackoverflow.com/users/51782/sri-sankaran"}, "edited": false, "score": 0, "creation_date": 1495975269, "post_id": 44220908, "comment_id": 75464752, "body": "Fair enough.  I was aware of the difference between buffered &amp; unbuffered channels.  My oversight in not stating that in the question.  I accepted TimCooper&#39;s response because a) at the time it was the only response &amp; b) it forced me to re-read the documentation."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 10, "last_activity_date": 1495913820, "creation_date": 1495913820, "answer_id": 44220908, "question_id": 44216442, "link": "https://stackoverflow.com/questions/44216442/why-does-a-channel-in-golang-require-a-go-routine/44220908#44220908", "title": "Why does a channel in golang require a go-routine?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language\n  Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"noreferrer\">Channel types</a></p>\n  \n  <p>A channel provides a mechanism for concurrently executing functions to\n  communicate by sending and receiving values of a specified element\n  type.</p>\n  \n  <p>A new, initialized channel value can be made using the built-in\n  function make, which takes the channel type and an optional capacity\n  as arguments:</p>\n\n<pre><code>make(chan int, 100)\n</code></pre>\n  \n  <p>The capacity, in number of elements, sets the size of the buffer in\n  the channel. If the capacity is zero or absent, the channel is\n  unbuffered and communication succeeds only when both a sender and\n  receiver are ready. Otherwise, the channel is buffered and\n  communication succeeds without blocking if the buffer is not full\n  (sends) or not empty (receives). A nil channel is never ready for\n  communication.</p>\n</blockquote>\n\n<hr>\n\n<p>You ask: Why does a channel in golang require a go-routine?</p>\n\n<p>A Go channel does not require a goroutine. A successful send merely requires a ready receiver or a buffer that is not full. For example, using a buffered channel,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    c := make(chan int, 1)\n    c &lt;- 17\n    fmt.Println(&lt;-c)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>17\n</code></pre>\n\n<p>Your example fails because it tries to send on an unbuffered channel that does not have a ready receiver.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    c := make(chan int)\n    c &lt;- 17\n    fmt.Println(&lt;-c)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\ngoroutine 1 [chan send]:\nmain.main()\n    /home/peter/gopath/src/sri.go:7 +0x59\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/44216515/221700\">@Tim Cooper's proposed solution</a> has the same error.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    c := make(chan int)\n    select {\n    case c &lt;- 17:\n    default:\n    }\n    fmt.Println(&lt;-c)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\ngoroutine 1 [chan receive]:\nmain.main()\n    /home/peter/gopath/src/tim.go:11 +0x8a\n</code></pre>\n"}], "owner": {"reputation": 7484, "user_id": 51782, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6383e7bd5cda4af93903ba10aef2038?s=128&d=identicon&r=PG", "display_name": "Sri Sankaran", "link": "https://stackoverflow.com/users/51782/sri-sankaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1813, "favorite_count": 2, "accepted_answer_id": 44216515, "answer_count": 2, "score": 7, "last_activity_date": 1495913820, "creation_date": 1495885464, "question_id": 44216442, "link": "https://stackoverflow.com/questions/44216442/why-does-a-channel-in-golang-require-a-go-routine", "title": "Why does a channel in golang require a go-routine?", "body": "<p>I am coming upto speed on channels in golang.  Per its <a href=\"https://tour.golang.org/concurrency/2\" rel=\"noreferrer\">documentation</a>, </p>\n\n<blockquote>\n  <p>Channels are a typed conduit through which you can send and receive\n  values with the channel operator, &lt;-.</p>\n</blockquote>\n\n<p>I get that.  I understand how it is used from examples that utilize go routines.  I tried an extremely trivial example.  It results in a deadlocked program.  Ignoring the pointlessness of this program can you please tell me why this is deadlocked?</p>\n\n<pre><code>package main\nimport  \"fmt\"\nfunc main() {\n    c := make(chan int)\n    c &lt;- 17\n    fmt.Println(&lt;- c)\n}\n</code></pre>\n\n<p>The referenced documentation adds that </p>\n\n<blockquote>\n  <p>By default, sends and receives block until the other side is ready.</p>\n</blockquote>\n\n<p>OK, in the above example, the sender (the main routine) <em>is</em> ready to send when <code>c &lt;- 17</code> is encountered.  So shouldn't that execute. Subsequently the <code>Println</code> should be able to drain the channel.</p>\n\n<p>I realize everything works fine if <code>c &lt;- 17</code>  is replaced by </p>\n\n<pre><code>go func() { c &lt;- 17 } ()\n</code></pre>\n\n<p>Just trying to understand why that's necessary.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1495920188, "post_id": 44215799, "comment_id": 75453869, "body": "welcome to StackOverflow, I recommend you take a look at Go tour <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">tour.golang.org/welcome/1</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7689654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed0955d0b3f8692800fa43b9d40a3e15?s=128&d=identicon&r=PG&f=1", "display_name": "dibbidabbi", "link": "https://stackoverflow.com/users/7689654/dibbidabbi"}, "edited": false, "score": 0, "creation_date": 1495905594, "post_id": 44216213, "comment_id": 75449936, "body": "ok so the panic happens because of accessing a struct member w of the RWMutex struct. For this the pointer to this struct, which is nil, must be dereferenced. Strange default of Go, why not initializing like with the new() operator, which also gives back a pointer?"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 31, "user_id": 7689654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed0955d0b3f8692800fa43b9d40a3e15?s=128&d=identicon&r=PG&f=1", "display_name": "dibbidabbi", "link": "https://stackoverflow.com/users/7689654/dibbidabbi"}, "edited": false, "score": 0, "creation_date": 1495909692, "post_id": 44216213, "comment_id": 75451166, "body": "Because <code>new</code> initializes a type completely and then returns a pointer to it. <code>var</code> without initialization simply creates a type set to that type&#39;s zero value. Changing your original code to <code>var foo = new(sync.RWMutex)</code> also fixes the error because <code>foo</code> is a pointer to fully initialized mutex."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 3, "last_activity_date": 1495884566, "last_edit_date": 1495884566, "creation_date": 1495883976, "answer_id": 44216213, "question_id": 44215799, "link": "https://stackoverflow.com/questions/44215799/initializing-a-rwmutex-crashes-in-golang/44216213#44216213", "title": "Initializing a RWMutex crashes in golang?", "body": "<p>The mutexes are generally designed to work without any type of initialization. That is, a zero valued mutex is all you need to use them. To fix your program, declare <code>foo</code> as a value. Not a pointer to a mutex:</p>\n\n<pre><code>var foo sync.RWMutex\n\nfunc main() {\n    foo.Lock()\n}\n</code></pre>\n\n<p>When you declare <code>foo</code> as a pointer:</p>\n\n<pre><code>var foo *sync.RWMutex\n</code></pre>\n\n<p><code>foo</code> is a zero valued <em>pointer (to type <code>sync.RWMutex</code>)</em>, i.e. it does not point to a valid mutex value. <code>foo</code> is <code>nil</code>. That's why you get the nil pointer exception when calling a method.</p>\n\n<p>However, note that to share the mutex between goroutines/functions, you're going to have to pass them as pointers, after they have been initialized (like above), or they'll not be shared.</p>\n\n<p>From the docs:</p>\n\n<blockquote>\n  <p>An RWMutex must not be copied after first use.</p>\n</blockquote>\n\n<p>Docs: <a href=\"https://golang.org/pkg/sync/#RWMutex\" rel=\"nofollow noreferrer\">https://golang.org/pkg/sync/#RWMutex</a></p>\n"}], "owner": {"reputation": 31, "user_id": 7689654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed0955d0b3f8692800fa43b9d40a3e15?s=128&d=identicon&r=PG&f=1", "display_name": "dibbidabbi", "link": "https://stackoverflow.com/users/7689654/dibbidabbi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1888, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495884566, "creation_date": 1495881360, "question_id": 44215799, "link": "https://stackoverflow.com/questions/44215799/initializing-a-rwmutex-crashes-in-golang", "title": "Initializing a RWMutex crashes in golang?", "body": "<p>The following code crashes with the following error, why??</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n\n)\n\nvar foo *sync.RWMutex\n\nfunc main() {\n    foo.Lock()\n}\n</code></pre>\n\n<p>outputs:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0xffffffff addr=0x0 pc=0x8125c]\n\ngoroutine 1 [running]:\nsync.(*RWMutex).Lock(0x0, 0x104000f0)\n    /usr/local/go/src/sync/rwmutex.go:86 +0x1c\nmain.main()\n    /tmp/sandbox093456788/main.go:11 +0x20\n\nProgram exited.\n</code></pre>\n\n<p>it will not happen, when you use one of the following lines</p>\n\n<pre><code>var foo = new(sync.RWMutex)\nvar foo sync.RWMutex\n</code></pre>\n\n<p>for the initialization of the foo variable.</p>\n"}, {"tags": ["node.js", "encryption", "go"], "comments": [{"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 2, "creation_date": 1495881021, "post_id": 44215014, "comment_id": 75442468, "body": "You need to specify the same <a href=\"https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation\" rel=\"nofollow noreferrer\">mode of operation</a>. Have you tried to change <code>aes-128-cbc</code> to <code>aes-128-cfb</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 2259, "user_id": 2101525, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04455ce77bcdb356791c40fa4de10cc4?s=128&d=identicon&r=PG", "display_name": "L.T", "link": "https://stackoverflow.com/users/2101525/l-t"}, "is_accepted": false, "score": 1, "last_activity_date": 1496224619, "creation_date": 1496224619, "answer_id": 44281572, "question_id": 44215014, "link": "https://stackoverflow.com/questions/44215014/how-to-transform-encrypt-function-from-golang-to-nodejs/44281572#44281572", "title": "how to transform encrypt function from golang to nodejs", "body": "<pre><code>var fs = require('fs');\nvar crypto = require('crypto');\n\nfunction decrypt(aseKey, inputFile){\n    var fileBody = fs.readFileSync(inputFile)\n    var  decipher =  crypto.createDecipheriv(\"aes-128-cfb\",new Buffer(aseKey) , fileBody.slice(0,16))\n    var recv = decipher.update(fileBody.slice(16))\n\n    fs.writeFileSync(inputFile + \".n.ts\", recv)\n}\n</code></pre>\n"}], "owner": {"reputation": 2259, "user_id": 2101525, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04455ce77bcdb356791c40fa4de10cc4?s=128&d=identicon&r=PG", "display_name": "L.T", "link": "https://stackoverflow.com/users/2101525/l-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496224619, "creation_date": 1495876112, "question_id": 44215014, "link": "https://stackoverflow.com/questions/44215014/how-to-transform-encrypt-function-from-golang-to-nodejs", "title": "how to transform encrypt function from golang to nodejs", "body": "<p>I write a encrypt file function use golang, but I don't how to implement it use nodejs</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"crypto/rand\"\n    \"io\"\n    \"io/ioutil\"\n    \"os\"\n)\n\nfunc encrypt(aeskey string, filename string) {\n    plaintext, err := ioutil.ReadFile(filename)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    // Byte array of the string\n    key := []byte(aeskey)\n\n    // Create the AES cipher\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    // The IV needs to be unique, but not secure. Therefore it's common to\n    // include it at the beginning of the ciphertext.\n    ciphertext := make([]byte, aes.BlockSize+len(plaintext))\n    iv := ciphertext[:aes.BlockSize]\n    if _, err := io.ReadFull(rand.Reader, iv); err != nil {\n        panic(err)\n    }\n\n    stream := cipher.NewCFBEncrypter(block, iv)\n    stream.XORKeyStream(ciphertext[aes.BlockSize:], plaintext)\n\n    // create a new file for saving the encrypted data.\n    f, err := os.Create(filename + \".aes\")\n    if err != nil {\n        panic(err.Error())\n    }\n    _, err = io.Copy(f, bytes.NewReader(ciphertext))\n    if err != nil {\n        panic(err.Error())\n    }\n}\n\nfunc decrypt(aesKey string, inputFile string) {\n\n    ciphertext, err := ioutil.ReadFile(inputFile)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    // Key\n    key := []byte(aesKey)\n\n    // Create the AES cipher\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    // Before even testing the decryption,\n    // if the text is too small, then it is incorrect\n    if len(ciphertext) &lt; aes.BlockSize {\n        panic(\"Text is too short\")\n    }\n\n    // Get the 16 byte IV\n    iv := ciphertext[:aes.BlockSize]\n\n    // Remove the IV from the ciphertext\n    ciphertext = ciphertext[aes.BlockSize:]\n\n    // Return a decrypted stream\n    stream := cipher.NewCFBDecrypter(block, iv)\n    // Decrypt bytes from ciphertext\n    stream.XORKeyStream(ciphertext, ciphertext)\n    // create a new file for saving the encrypted data.\n    f, err := os.Create(inputFile + \".ts\")\n    if err != nil {\n        panic(err.Error())\n    }\n    _, err = io.Copy(f, bytes.NewReader(ciphertext))\n    if err != nil {\n        panic(err.Error())\n    }\n}\n\nfunc main() {\n    key := \"0123456789123456\"\n    encrypt(key, \"1.ts\")\n    decrypt(key, \"1.ts.aes\")\n}\n</code></pre>\n\n<p>In fact, I just have some confuse about  </p>\n\n<pre><code> ciphertext := make([]byte, aes.BlockSize+len(plaintext))\n iv := ciphertext[:aes.BlockSize]\n</code></pre>\n\n<p>I write a decrypt function use node ,but it don't work well:</p>\n\n<pre><code>var fs = require('fs');\nvar crypto = require('crypto');\n\nfunction decrypt(aseKey, inputFile){\n    var buffer = fs.readFileSync(inputFile)\n    var arr = Array.prototype.slice.call(buffer, 0)\n    var iv = arr.slice(0, 16)\n    var bodyBytes = arr.slice(16)\n    var cipher = crypto.createCipheriv('aes-128-cbc', aseKey, new Buffer(iv));\n    buffer = cipher.update(new Buffer(bodyBytes));\n    fs.writeFile(inputFile + \".node.ts\", buffer)\n}\n\ndecrypt(\"0123456789123456\", \"1.ts.aes\")\n</code></pre>\n\n<p>thanks for you help</p>\n"}, {"tags": ["go", "reflection", "struct"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8073826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0aa197f815a8513783196daf161185c?s=128&d=identicon&r=PG&f=1", "display_name": "Davide", "link": "https://stackoverflow.com/users/8073826/davide"}, "edited": false, "score": 0, "creation_date": 1496042485, "post_id": 44219729, "comment_id": 75483110, "body": "Cerise you&#39;re the man.. thank you. I was already using the reflection but didn&#39;t use the FieldByName. Many thanks"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1495905839, "creation_date": 1495905839, "answer_id": 44219729, "question_id": 44214809, "link": "https://stackoverflow.com/questions/44214809/golang-reflect-getting-struct-members-in-a-slice/44219729#44219729", "title": "Golang reflect getting struct members in a slice", "body": "<p>Use the reflect package:</p>\n\n<pre><code>f, _ := reflect.TypeOf(ProductionInfo{}).FieldByName(\"StructA\")\nt := f.Type.Elem()\nfor i := 0; i &lt; t.NumField(); i++ {\n    f := t.Field(i)\n    fmt.Println(f.Name, f.Type)\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8073826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0aa197f815a8513783196daf161185c?s=128&d=identicon&r=PG&f=1", "display_name": "Davide", "link": "https://stackoverflow.com/users/8073826/davide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 591, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495905839, "creation_date": 1495874791, "question_id": 44214809, "link": "https://stackoverflow.com/questions/44214809/golang-reflect-getting-struct-members-in-a-slice", "title": "Golang reflect getting struct members in a slice", "body": "<p>I've the following structure:</p>\n\n<pre><code>type ProductionInfo struct {\nStructA []struct {\n    Field1            string\n    Field2            int\n}\n</code></pre>\n\n<p>I would extract fields name and type from StructA in the ProductionInfo type. But I cannot understand how. Can anybody help me?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1495927132, "post_id": 44213947, "comment_id": 75455264, "body": "empty interfaces says nothing <a href=\"http://go-proverbs.github.io/\" rel=\"nofollow noreferrer\">go-proverbs.github.io</a> I recommend you trying to find your own concrete interface to define some common behavior"}], "answers": [{"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1495868558, "creation_date": 1495868558, "answer_id": 44213989, "question_id": 44213947, "link": "https://stackoverflow.com/questions/44213947/how-can-i-define-a-function-type-adapted-to-any-function-in-golang/44213989#44213989", "title": "How can I define a function type adapted to any function in golang", "body": "<p>There is no function type that's compatible with any function.</p>\n\n<p>The best you can do is <code>interface{}</code> to which any value is assignable to, including functions.</p>\n"}], "owner": {"reputation": 361, "user_id": 7229120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5af5b05b1499d40493fb6ed087bf12b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/7229120/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 910, "favorite_count": 0, "accepted_answer_id": 44213989, "answer_count": 1, "score": 0, "last_activity_date": 1495868558, "creation_date": 1495868248, "question_id": 44213947, "link": "https://stackoverflow.com/questions/44213947/how-can-i-define-a-function-type-adapted-to-any-function-in-golang", "title": "How can I define a function type adapted to any function in golang", "body": "<p>I just want to define a function type which will match all functions and I have tried this:</p>\n\n<p>type funcType func(...interface{}) ...interface{}\nbut failed</p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["go", "ubuntu-16.04", "hyperledger", "hyperledger-fabric"], "owner": {"reputation": 19, "user_id": 8072775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22fa177fbceb171ce4ba982a409fcf52?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Qiu", "link": "https://stackoverflow.com/users/8072775/joshua-qiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 452, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1501863435, "creation_date": 1495847785, "last_edit_date": 1501863435, "question_id": 44211996, "link": "https://stackoverflow.com/questions/44211996/make-fabric-error-fatal-error-stdlib-h-no-such-file-or-directory", "title": "make fabric error: fatal error: stdlib.h: No such file or directory", "body": "<pre><code>root@qukuai4:~/gopath/src/github.com/hyperledger/fabric# make peer\nbuild/bin/peer\nCGO_CFLAGS=\" \" GOBIN=/root/gopath/src/github.com/hyperledger/fabric/build/bin go install -tags \"\" -ldflags \"-X github.com/hyperledger/fabric/common/metadata.Version=1.0.0-snapshot-f3c61e6 -X github.com/hyperledger/fabric/common/metadata.BaseVersion=0.3.0 -X github.com/hyperledger/fabric/common/metadata.BaseDockerLabel=org.hyperledger.fabric -X github.com/hyperledger/fabric/common/metadata.DockerNamespace=hyperledger -X github.com/hyperledger/fabric/common/metadata.BaseDockerNamespace=hyperledger\" github.com/hyperledger/fabric/peer\n# github.com/hyperledger/fabric/vendor/github.com/miekg/pkcs11\nvendor/github.com/miekg/pkcs11/pkcs11.go:27:20: fatal error: stdlib.h: No such file or directory\ncompilation terminated.\nMakefile:202: recipe for target 'build/bin/peer' failed\nmake: *** [build/bin/peer] Error 2\n</code></pre>\n\n<p>error occurs when i built fabric</p>\n\n<p>I have installed libltdl-dev</p>\n\n<p>4.8.0-46-generic #49-Ubuntu SMP Fri Mar 31 13:57:14 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1495836620, "post_id": 44210731, "comment_id": 75433865, "body": "See <code>${SRCDIR}</code> in the <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">cgo documentation</a>"}, {"owner": {"reputation": 627, "user_id": 4384879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NpW7Lo-JCr4/AAAAAAAAAAI/AAAAAAAAAB4/uVBIF-SncBs/photo.jpg?sz=128", "display_name": "Francesco Cina", "link": "https://stackoverflow.com/users/4384879/francesco-cina"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1495836943, "post_id": 44210731, "comment_id": 75433956, "body": "@JimB I tried it and it does not work. Exactly the same error is thrown at runtime."}], "answers": [{"comments": [{"owner": {"reputation": 627, "user_id": 4384879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NpW7Lo-JCr4/AAAAAAAAAAI/AAAAAAAAAB4/uVBIF-SncBs/photo.jpg?sz=128", "display_name": "Francesco Cina", "link": "https://stackoverflow.com/users/4384879/francesco-cina"}, "edited": false, "score": 0, "creation_date": 1495871410, "post_id": 44211476, "comment_id": 75440191, "body": "Actually my objective is to completely avoid full paths and to avoid the use of environment variables. I need a portable solution, something that I copy from my system to another one and it works out of the box."}], "tags": [], "owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "is_accepted": false, "score": -1, "last_activity_date": 1495842016, "creation_date": 1495842016, "answer_id": 44211476, "question_id": 44210731, "link": "https://stackoverflow.com/questions/44210731/how-to-use-a-dynamically-linked-library-from-relative-path/44211476#44211476", "title": "How to use a dynamically linked library from relative path", "body": "<p>Add CURRENT_PATH/lib to /etc/ld.so.conf or /etc/ld.so.conf.d/mylib.conf and run <code>sudo ldconfig</code></p>\n\n<p>Also use the full path for -I and -L in CFLAGS &amp; LDFLAGS, respectively.</p>\n"}, {"comments": [{"owner": {"reputation": 1649, "user_id": 884502, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f4a1119fab3984edda7b7809dc1e639?s=128&d=identicon&r=PG", "display_name": "M_M", "link": "https://stackoverflow.com/users/884502/m-m"}, "edited": false, "score": 0, "creation_date": 1591948370, "post_id": 44214486, "comment_id": 110253444, "body": "That did the trick for me - it&#39;s worth pointing out that, because the linker is invoked via the gcc front end, you need to use the <code>-Wl,-rpath=</code> version rather than <code>ld</code>&#39;s own <code>-R</code> or <code>-rpath</code> option - it won&#39;t work without <code>-Wl,</code> on the beginning as CGO will reject it."}], "tags": [], "owner": {"reputation": 627, "user_id": 4384879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NpW7Lo-JCr4/AAAAAAAAAAI/AAAAAAAAAB4/uVBIF-SncBs/photo.jpg?sz=128", "display_name": "Francesco Cina", "link": "https://stackoverflow.com/users/4384879/francesco-cina"}, "is_accepted": true, "score": 2, "last_activity_date": 1495872309, "creation_date": 1495872309, "answer_id": 44214486, "question_id": 44210731, "link": "https://stackoverflow.com/questions/44210731/how-to-use-a-dynamically-linked-library-from-relative-path/44214486#44214486", "title": "How to use a dynamically linked library from relative path", "body": "<p>I was able to solve the issue adding the <code>-Wl,-rpath=\\$ORIGIN/lib</code> linker flag to LDFLAGS options in the main.go file:</p>\n\n<pre><code>package main\n/*\n#cgo CFLAGS: -I${SRCDIR}/lib\n#cgo LDFLAGS: -L${SRCDIR}/lib -Wl,-rpath=\\$ORIGIN/lib -luiohook\n#include &lt;uiohook.h&gt;\n*/\nimport \"C\"\n\nfunc main() {\n    C.hook_run()\n}\n</code></pre>\n\n<p>Now when the application is executed, it uses also the CURRENT_FOLDER/lib to search for dynamic libraries (CURRENT_FOLDER is the directory where the application executable is executed).</p>\n\n<p>For linux users only:\nIf the error is still thrown, you need to create a symlink or to rename the XXX.so library to XXX.so.0. In my case it was:</p>\n\n<pre><code>src/ctest/\n  |- lib/\n  |    |- libmylib.so\n  |    |- libmylib.so.0 &lt;- symlink to ./libmylib.so\n  |    |- libmylib.h\n  |- main.go\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 4384879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NpW7Lo-JCr4/AAAAAAAAAAI/AAAAAAAAAB4/uVBIF-SncBs/photo.jpg?sz=128", "display_name": "Francesco Cina", "link": "https://stackoverflow.com/users/4384879/francesco-cina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2578, "favorite_count": 1, "accepted_answer_id": 44214486, "answer_count": 2, "score": 3, "last_activity_date": 1519498425, "creation_date": 1495836443, "last_edit_date": 1519498425, "question_id": 44210731, "link": "https://stackoverflow.com/questions/44210731/how-to-use-a-dynamically-linked-library-from-relative-path", "title": "How to use a dynamically linked library from relative path", "body": "<p>I would like to use a dynamic C library from a go application, I can build the application but the library is not found at runtime.\nHere the structure of my project:</p>\n\n<pre><code>src/ctest/\n      |- lib/\n      |    |- libmylib.so\n      |    |- libmylib.h\n      |- main.go\n</code></pre>\n\n<p>in main.go I import the .h and .so files:</p>\n\n<pre><code>/*\n#cgo CFLAGS: -I./lib\n#cgo LDFLAGS: -L./lib -lmylib\n#include &lt;mylib.h&gt;\n*/\nimport \"C\"\n\nfunc main() {\n    C.testMyLib()\n}\n</code></pre>\n\n<p>I can build the application successfully, but when launched it throws this error:</p>\n\n<pre><code>error while loading shared libraries: libmylib.so.0: cannot open shared object file: No such file or directory\n</code></pre>\n\n<p>If I copy the libmylib.so file in /usr/lib then everything works as expected; however, I would like that my application automatically searches  for the needed library in CURRENT_PATH/lib at runtime without setting environment variables. How can I achieve it?</p>\n"}, {"tags": ["docker", "go", "docker-compose", "govendor"], "answers": [{"comments": [{"owner": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "edited": false, "score": 0, "creation_date": 1495882876, "post_id": 44210612, "comment_id": 75442943, "body": "I did it but it doesn&#39;t work, the error message now is this: test_server | ers/users.go:4:3: cannot find package &quot;github.com/gin-gonic/gin&quot; in any of: test_server |   /usr/local/go/src/github.com/gin-gonic/gin (from $GOROOT) test_server |   /go/src/test_server/src/github.com/gin-gonic/gin (from $GOPATH)  I tried with Dockerfile as well because I though it&#39;s a more elegant solution, but everytime I build it, I get the error:   This is the Dockerfile content: FROM golang:1.8-alpine RUN go get github.com/gin-gonic/gin EXPOSE 8085"}], "tags": [], "owner": {"reputation": 24981, "user_id": 1094246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda38b3b4f0bd9b57759601a3652e520?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1094246/robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1495836319, "last_edit_date": 1495836319, "creation_date": 1495835746, "answer_id": 44210612, "question_id": 44210502, "link": "https://stackoverflow.com/questions/44210502/docker-compose-cannot-find-package/44210612#44210612", "title": "docker-compose cannot find package", "body": "<p>You need to tell go where find the packages:</p>\n\n<pre><code>api:\n  ...\n  environment:\n    - GOPATH=/go/src/test_server\n</code></pre>\n\n<p>Or have a Dockerfile with the proper packages installed (recommended)</p>\n"}, {"comments": [{"owner": {"reputation": 314, "user_id": 4115776, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-3Gk5yx6_Z78/AAAAAAAAAAI/AAAAAAAAABg/mHIiTNN0ack/photo.jpg?sz=128", "display_name": "Nirmal Vatsyayan", "link": "https://stackoverflow.com/users/4115776/nirmal-vatsyayan"}, "edited": false, "score": 0, "creation_date": 1533380811, "post_id": 44220348, "comment_id": 90331990, "body": "It gives error : go: missing Git command. See <a href=\"https://golang.org/s/gogetcmd\" rel=\"nofollow noreferrer\">golang.org/s/gogetcmd</a>, do you have any idea how to solve this too ?"}], "tags": [], "owner": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "is_accepted": false, "score": 3, "last_activity_date": 1495909848, "creation_date": 1495909848, "answer_id": 44220348, "question_id": 44210502, "link": "https://stackoverflow.com/questions/44210502/docker-compose-cannot-find-package/44220348#44220348", "title": "docker-compose cannot find package", "body": "<p>After many hours I finally could fix it.\nResulted that I was using a docker golang version that it doesn't have git included. I should use golang:1.8</p>\n\n<p>I modified my Dockerfile like this and now it works like a charm</p>\n\n<pre><code>FROM golang:1.8\n\nRUN go get github.com/gin-gonic/gin\n\nWORKDIR /go/src/app\nCOPY . .\n\nRUN go install -v\n\nCMD [\"app\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 325, "user_id": 2160823, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/02786e2af32973cbd1a9355cdae776f9?s=128&d=identicon&r=PG", "display_name": "vandekerkoff", "link": "https://stackoverflow.com/users/2160823/vandekerkoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1495915156, "creation_date": 1495915156, "answer_id": 44221094, "question_id": 44210502, "link": "https://stackoverflow.com/questions/44210502/docker-compose-cannot-find-package/44221094#44221094", "title": "docker-compose cannot find package", "body": "<p>I think it's because your updated code is running go install, not go run which your old code was running.</p>\n\n<p>You needed to install the extra golang packages into the vendor directory that you are calling from your app.</p>\n"}], "owner": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3691, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1546412574, "creation_date": 1495834987, "last_edit_date": 1546412574, "question_id": 44210502, "link": "https://stackoverflow.com/questions/44210502/docker-compose-cannot-find-package", "title": "docker-compose cannot find package", "body": "<p>I'm writing a simple app in GO and I have this folder structure</p>\n\n<p><a href=\"https://i.stack.imgur.com/9bxVd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9bxVd.png\" alt=\"enter image description here\"></a></p>\n\n<p>The docker-compose.yml file content is:</p>\n\n<pre><code>version: '2'\nservices:\n  db:\n    image: rethinkdb:latest\n    ports:\n      - \"38080:8080\"\n      - \"38015:28015\"\n      - \"39015:29015\"\n  api:\n    image: golang:1.8-alpine\n    volumes:\n      - .:/go/src/test_server/\n    working_dir: /go/src/test_server\n    command: go run server.go\n    container_name: test_server\n    ports:\n      - \"8085:8085\"\n    links:\n      - db\n    tty: true\n</code></pre>\n\n<p>Everytime I run docker-compose up I receive this error message:</p>\n\n<blockquote>\n  <p>test_server | controllers/users.go:4:3: cannot find package\n  \"_/go/src/test_server/vendor/github.com/gin-gonic/gin\" in any of:\n  test_server |<br>\n  /usr/local/go/src/_/go/src/test_server/vendor/github.com/gin-gonic/gin\n  (from $GOROOT) test_server |<br>\n  /go/src/_/go/src/test_server/vendor/github.com/gin-gonic/gin (from\n  $GOPATH)</p>\n</blockquote>\n\n<p>It's referring to the controllers package. I'm using github.com/kardianos/govendor to vendor my packages. Do you know what's going on?</p>\n"}, {"tags": ["networking", "go", "nonblocking"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1495828483, "post_id": 44209241, "comment_id": 75430970, "body": "You don&#39;t. That&#39;s sort of the point of goroutines. What are you trying to do?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1495829804, "post_id": 44209241, "comment_id": 75431549, "body": "Also that deadline is far in the past, so it times out immediately. Did you mean <code>time.Now().Add(1 * time.Second)</code>?"}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496240468, "post_id": 44209241, "comment_id": 75581372, "body": "@JimB: Non-blocking writes in a one-thread-at-a-time (bytecode-like) interpreter.  If the write would block I will either inform or suspend the thread (and allow another to run).  I can do non-blocking writes to a channel, so I can achieve what I want indirectly by having a dedicated goroutine for each socket to schlep the bytes from a channel to the socket, but that seems like a stupid amount of extra overhead (and complexity) to do something that ought to be very straight forward."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496240703, "post_id": 44209241, "comment_id": 75581550, "body": "@cpcallen: goroutines are not threads, and a blocked write to a network does not block an entire thread. I don&#39;t know what the &quot;stupid amount of extra overhead&quot; you&#39;re referring to is."}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496241790, "post_id": 44209241, "comment_id": 75582385, "body": "@Adrian: No; stopping the world for one second is not acceptable - and attempting to tune the timeout to be as small as possible risks having writes that would not block fail unnecessarily."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496242093, "post_id": 44209241, "comment_id": 75582645, "body": "It doesn&#39;t stop the world, only the current goroutine."}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1496242579, "post_id": 44209241, "comment_id": 75583023, "body": "@JimB: I am aware that blocked goroutines do not tie up OS threads; the threads I refer to are threads of execution in the language I am implementing.  Re: overhead: there are two kinds: the conceptual complexity of managing the per-socket goroutines and reporting back to the interpreted code which writes ultimately succeeded/failed;  additionally the performance hit of otherwise unnecessary channel reads/writes + associated data copying and scheduling.  (Performance is likely a non-issue for my use case, but were I writing some kind of high-performance web server I might think otherwise.)"}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496243034, "post_id": 44209241, "comment_id": 75583359, "body": "@Adrian: The language I&#39;m implementing has a co-operative multitasking model, with only a single thread running at a time.  The interpreter runs in a single goroutine; if this blocks it cannot run another thread instead.  (I could have a goroutine per interpreted-language thread, but this would require extensive synchronisation to ensure that only one such interpreter goroutine could run at a time, to avoid violating language semantics.  This would also require some non-trivial changes to the overall architecture of the interpreter.)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1496243402, "post_id": 44209241, "comment_id": 75583624, "body": "In trying to write an interpreter in Go for a language that behaves very unlike Go, you&#39;re likely to run into these kinds of obstacles on a regular basis; the mismatch will cause things like this, which are trivial in Go, to become bigger headaches. And if you were writing a high-performance web server, I&#39;d hope you would learn from Node&#39;s mistakes and not make it single-threaded!"}], "answers": [{"comments": [{"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 0, "creation_date": 1496239916, "post_id": 44210548, "comment_id": 75580956, "body": "I need to be able to write to a socket in such a way that I can be certain that the thread performing the write does not block."}, {"owner": {"reputation": 29080, "user_id": 1242778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AKoAV.jpg?s=128&g=1", "display_name": "Agis", "link": "https://stackoverflow.com/users/1242778/agis"}, "reply_to_user": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 0, "creation_date": 1496243840, "post_id": 44210548, "comment_id": 75583931, "body": "@cpcallen Updated my answer addressing your comment."}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 0, "creation_date": 1496272476, "post_id": 44210548, "comment_id": 75598297, "body": "yes: in my comment I said thread but meant goroutine.  Good spot with issues/15735, but I think that&#39;s blocking without reading, rather than writing without blocking..."}, {"owner": {"reputation": 77, "user_id": 5023130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e54bd8d2ad4cfe1b20ab09af12e5873?s=128&d=identicon&r=PG&f=1", "display_name": "Amin Paydar", "link": "https://stackoverflow.com/users/5023130/amin-paydar"}, "edited": false, "score": 0, "creation_date": 1581875338, "post_id": 44210548, "comment_id": 106574217, "body": "@Agis referred to <a href=\"https://stackoverflow.com/questions/39685437/if-goroutines-involve-userspace-threads-can-a-blocking-operation-leads-to-conte\">this</a> when you call a blocking syscall the goroutine and os-level thread blocked."}], "tags": [], "owner": {"reputation": 29080, "user_id": 1242778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AKoAV.jpg?s=128&g=1", "display_name": "Agis", "link": "https://stackoverflow.com/users/1242778/agis"}, "is_accepted": false, "score": 3, "last_activity_date": 1496267134, "last_edit_date": 1496267134, "creation_date": 1495835339, "answer_id": 44210548, "question_id": 44209241, "link": "https://stackoverflow.com/questions/44209241/how-can-i-perform-a-non-blocking-write-on-a-net-conn/44210548#44210548", "title": "How can I perform a non-blocking write on a net.Conn?", "body": "<p>In Go you use blocking I/O and the runtime \"converts\" it to non-blocking I/O: a goroutine blocked while reading from a socket, will be swapped by the scheduler with another goroutine ready to continue its execution.</p>\n\n<p>Thus, you get the best of both worlds: code that's easier to follow (eg. no callback hell) <em>and</em> the efficiency of non-blocking I/O (ie. epoll, kqueue, completion ports).</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<blockquote>\n  <p>@cpcallen <em>I need to be able to write to a socket in such a way that I can be certain that the thread performing the write does not block.</em></p>\n</blockquote>\n\n<p>If by \"thread\" you refer the OS-level thread, it is not blocked. If by \"thread\" you refer to the goroutine performing the write, that's not yet possible but there's a proposal: <a href=\"https://github.com/golang/go/issues/15735\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/15735</a></p>\n"}], "owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1293, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496267134, "creation_date": 1495828416, "last_edit_date": 1495839344, "question_id": 44209241, "link": "https://stackoverflow.com/questions/44209241/how-can-i-perform-a-non-blocking-write-on-a-net-conn", "title": "How can I perform a non-blocking write on a net.Conn?", "body": "<p>How can I perform a non-blocking write on a network connection in Go?</p>\n\n<p>I thought it might be possible to do so by setting the deadline in the past:</p>\n\n<pre><code>conn.SetWriteDeadline(time.Date(0, 0, 0, 0, 0, 0, 1, time.UTC))\nn, err := conn.Write(buffer)\n</code></pre>\n\n<p>... but this just fails with an 'i/o timeout' error without actually writing any bytes to the connection.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1495825466, "post_id": 44208305, "comment_id": 75429595, "body": "My guess is that the dev server monitors all .go files in GOPATH in addition to those in the app directory.  By default <code>go get</code> does not download if the package is already on GOPATH.  Use <code>go get -u</code> to force update from the source."}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1495830471, "post_id": 44208305, "comment_id": 75431826, "body": "So does that mean my GOPATH ( /Users/Bryan/go ) is wrong?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1495831234, "post_id": 44208305, "comment_id": 75432135, "body": "I don&#39;t think the GOPATH is wrong.  Also, this is just a warning about auto recompilation.  Everything else should work."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1496439326, "post_id": 44208305, "comment_id": 75679433, "body": "You didn&#39;t follow my instructions in your other question when installing <code>google-cloud-sdk</code>. The SDK itself goes in your <code>home</code> directory, NOT your <code>$GOPATH</code>. Technically it doesn&#39;t matter where the SDK resides as long as it is in your <code>$PATH</code>, but it should definitely NOT be in your <code>$GOPATH</code>. <a href=\"https://stackoverflow.com/questions/43591772/where-does-go-look-for-google-cloud-sdk-what-should-gopath-be/43641355#43641355\" title=\"where does go look for google cloud sdk what should gopath be\">stackoverflow.com/questions/43591772/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1496240321, "post_id": 44285400, "comment_id": 75581260, "body": "I thought google-cloud-sdk was expected to be @ ~/go/src    Should ~/go/src only contain my code and dependencies AND exclude google-cloud-sdk?"}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1496256832, "post_id": 44285400, "comment_id": 75591629, "body": "go get seems to require $GOPATH:   go get google.golang.org/appengine"}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1496256835, "post_id": 44285400, "comment_id": 75591634, "body": "package google.golang.org/appengine: cannot download, $GOPATH not set. For more details see: go help gopath"}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "reply_to_user": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 1, "creation_date": 1496258241, "post_id": 44285400, "comment_id": 75592452, "body": "Most 3d party sdk or libraries in go are packaged as a go package and you would &quot;go get&quot; them into your src folder. But google-cloud-sdk is not just go package, but full blown sdk. So, it does not need to be in your GOPATH. Think of GOPATH as a project folder in other languages. google-cloud-sdk is rather akin to Platform SDK in Windows or JDK for Java. Neither need to have a copy in each project folder."}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "reply_to_user": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 1, "creation_date": 1496259165, "post_id": 44285400, "comment_id": 75592940, "body": "$GOPATH is just an environment variable. Just set it to be your project folder. E.g. <code>export GOPATH=&#47;Users&#47;Bryan&#47;go</code> in your example, if you&#39;re using command line (such as Terminal). Then just run <code>go get</code> commands from the same Terminal window."}, {"owner": {"reputation": 637, "user_id": 1532791, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ec90903d94b483528e5f0caa63603d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dewey", "link": "https://stackoverflow.com/users/1532791/dewey"}, "edited": false, "score": 0, "creation_date": 1506029532, "post_id": 44285400, "comment_id": 79667060, "body": "This post is confusing....isn&#39;t running: go get google.golang.org/appengine going to put app engine under go/src/ and doesn&#39;t that contradict what you are advising??"}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "reply_to_user": {"reputation": 637, "user_id": 1532791, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ec90903d94b483528e5f0caa63603d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dewey", "link": "https://stackoverflow.com/users/1532791/dewey"}, "edited": false, "score": 0, "creation_date": 1506153501, "post_id": 44285400, "comment_id": 79713414, "body": "@Dewey Please see comments above. Google App Engine SDK for Go is an SDK, not just a package. See (and follow) installation instructions in App Engine SDK documentation. However, google.golang.org/appengine is a package. It might be actually provided by newer versions of SDK, but at least at the time of writing it wasn&#39;t. Thus needed to be fetched into GOPATH using <code>go get</code>."}], "tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": true, "score": 3, "last_activity_date": 1496235231, "creation_date": 1496235231, "answer_id": 44285400, "question_id": 44208305, "link": "https://stackoverflow.com/questions/44208305/how-to-fix-google-cloud-sdk-156-0-0-there-are-too-many-files-in-your-applicatio/44285400#44285400", "title": "How to fix Google-cloud-sdk 156.0.0 &quot;There are too many files in your application for changes in all of them to be monitored.&quot;?", "body": "<p>I only used an older version of appengine sdk, but I believe below is still true.</p>\n\n<p>The main issue is that you have google-cloud-sdk inside your GOPATH. This should not be necessary. I have it installed in my path. But even if not installed it should be resolving it's location relative to the executable or script you are running and should find all required sdk files properly. At the same time SDK is roughly 7500 files and you only need to have more than 10000 (approx) in your GOPATH to get that \"to many files\" warning. So, if you have another (e.g. older) copy of SDK or other big project inside same GOPATH, you are pretty much guaranteed to exceed the threshold. Just locate /Users/Bryan/go in Finder and use \"Get Info\" to count files.</p>\n\n<p>So, either move appengine SDK outside of your GOPATH. Or make a new folder, export it as your new GOPATH and move your project files (but not SDK) to that new folder. This should fix the \"too many files issue\".</p>\n\n<p>The other issue is that your app actually fails to build. And as you have already figured out yourself the (immediate) issue is missing appengine package.</p>\n\n<p>But the correct way of getting google.golang.org/appengine is as follows:\n<code>\ngo get google.golang.org/appengine\n</code></p>\n\n<p>Though keep in mind that GOPATH must be set correctly <em>before</em> running the above command. It will fetch google.golang.org/appengine and all it's dependencies.</p>\n\n<p>Once you have retrieved all required packages (and fixed errors, if any) it should compile and run without issues.</p>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 8181815, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf817e25694843bbee3b913731ff36fd?s=128&d=identicon&r=PG&f=1", "display_name": "kajaptz", "link": "https://stackoverflow.com/users/8181815/kajaptz"}, "is_accepted": false, "score": 0, "last_activity_date": 1498296938, "creation_date": 1498296938, "answer_id": 44734979, "question_id": 44208305, "link": "https://stackoverflow.com/questions/44208305/how-to-fix-google-cloud-sdk-156-0-0-there-are-too-many-files-in-your-applicatio/44734979#44734979", "title": "How to fix Google-cloud-sdk 156.0.0 &quot;There are too many files in your application for changes in all of them to be monitored.&quot;?", "body": "<p>I'm using just the App Engine SDK for Go (1.9.54), not the Cloud SDK, but have the same problem [<a href=\"https://stackoverflow.com/q/44703952/8181815]\">Goapp serve - Warning: There are too many files</a>.  </p>\n\n<p>I solved it by moving large packages and repositories to <code>vendor/</code> dir.</p>\n"}, {"tags": [], "owner": {"reputation": 3087, "user_id": 856142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5bfb729f6ac07e17c2326a7335a3f3be?s=128&d=identicon&r=PG", "display_name": "yageek", "link": "https://stackoverflow.com/users/856142/yageek"}, "is_accepted": false, "score": 3, "last_activity_date": 1505400433, "creation_date": 1505400433, "answer_id": 46222130, "question_id": 44208305, "link": "https://stackoverflow.com/questions/44208305/how-to-fix-google-cloud-sdk-156-0-0-there-are-too-many-files-in-your-applicatio/46222130#46222130", "title": "How to fix Google-cloud-sdk 156.0.0 &quot;There are too many files in your application for changes in all of them to be monitored.&quot;?", "body": "<p>With my current sdk version (<code>Google Cloud SDK 171.0.0</code>) <code>dev_appserver.py</code> has one option named <code>enable_watching_go_path</code>.</p>\n\n<p>Setting it to <code>False</code> removed the warning.</p>\n\n<p>The command I use is:\n<code>dev_appserver.py --enable_watching_go_path=False server/app.yml</code> </p>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 8522152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4d2890561489533101b153f549c752?s=128&d=identicon&r=PG&f=1", "display_name": "dchiba", "link": "https://stackoverflow.com/users/8522152/dchiba"}, "is_accepted": false, "score": 2, "last_activity_date": 1513659425, "creation_date": 1513659425, "answer_id": 47880257, "question_id": 44208305, "link": "https://stackoverflow.com/questions/44208305/how-to-fix-google-cloud-sdk-156-0-0-there-are-too-many-files-in-your-applicatio/47880257#47880257", "title": "How to fix Google-cloud-sdk 156.0.0 &quot;There are too many files in your application for changes in all of them to be monitored.&quot;?", "body": "<p>The corresponding error occurs when mtime_file_watcher.py tries to monitor all files under \"GOPATH\" but has too many files, so use the skip_files option of app.yaml to check vendor, node_modules and arbitrary number of files Can be avoided by excluding many projects to be monitored.</p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/standard/python/config/appref#skip_files\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/standard/python/config/appref#skip_files</a></p>\n\n<pre><code>skip_files:\n- .*node_modules\n- .*vendor\n- .*project-name-having-too-many-files\n</code></pre>\n"}], "owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1391, "favorite_count": 2, "accepted_answer_id": 44285400, "answer_count": 4, "score": 12, "last_activity_date": 1513659425, "creation_date": 1495824335, "last_edit_date": 1496183925, "question_id": 44208305, "link": "https://stackoverflow.com/questions/44208305/how-to-fix-google-cloud-sdk-156-0-0-there-are-too-many-files-in-your-applicatio", "title": "How to fix Google-cloud-sdk 156.0.0 &quot;There are too many files in your application for changes in all of them to be monitored.&quot;?", "body": "<p>I just installed Go 1.6.4 and google-cloud-sdk 1.56.0.0 on osX.</p>\n\n<p>When I attempt to run the local dev_server I get the following warning.</p>\n\n<p>/Users/Bryan/go/src/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/mtime_file_watcher.py:156: UserWarning: There are too many files in your application for changes in all of them to be monitored. You may have to restart the development server to see some changes to your files.</p>\n\n<p>How do I fix this?</p>\n\n<p>Here is the project, there are only 4 files:    </p>\n\n<pre><code>$ ls\ntotal 32\ndrwxrwxrwx   6 Bryan  staff   204 May 23 15:57 .\ndrwxr-xr-x  10 Bryan  staff   340 May 25 18:39 ..\n-rwxrwxrwx@  1 Bryan  staff    69 Mar 22 09:40 app.yaml\n-rw-r--r--   1 Bryan  staff   554 Mar 28 09:26 index.yaml\n-rwxrwxrwx@  1 Bryan  staff  3015 May 25 18:36 skincare.go\n-rw-r--r--   1 Bryan  staff   870 May  3 09:18 skincare_test.go\n</code></pre>\n\n<p>I'm also having a problem that \"go get\" attempts to compile the code instead of downloading the remote packages \"google.golang.org/appengine\".</p>\n\n<p>$ go get</p>\n\n<pre><code># import \"google.golang.org/appengine\" is ignored and \"go get\" yields this error:\n./skincare.go:31: undefined: appengine.Context\n</code></pre>\n\n<p>EDIT additional info: \nI attempted to to force the update with the -u flag:<br>\n$ go get -u</p>\n\n<pre><code>package skincarereview: directory \"/Users/Bryan/go/src/skincarereview\" is not using a known version control system\n</code></pre>\n\n<p>This is the error output when I attempt to run the local server:  </p>\n\n<pre><code>$  /Users/Bryan/go/src/google-cloud-sdk/bin/dev_appserver.py app.yaml\nINFO     2017-05-30 14:27:31,722 devappserver2.py:692] Skipping SDK update check.\nINFO     2017-05-30 14:27:31,785 api_server.py:272] Starting API server at: http://localhost:60703\nINFO     2017-05-30 14:27:31,789 dispatcher.py:205] Starting module \"default\" running at: http://localhost:8080\nINFO     2017-05-30 14:27:31,793 admin_server.py:116] Starting admin server at: http://localhost:8000\n/Users/Bryan/go/src/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/mtime_file_watcher.py:156: UserWarning: There are too many files in your application for changes in all of them to be monitored. You may have to restart the development server to see some changes to your files.\n  'There are too many files in your application for '\nERROR    2017-05-30 14:27:36,123 go_runtime.py:182] Failed to build Go application: (Executed command: /Users/Bryan/go/src/google-cloud-sdk/platform/google_appengine/goroot/bin/go-app-builder -app_base /Users/Bryan/go/src/skincarereview -arch 6 -dynamic -goroot /Users/Bryan/go/src/google-cloud-sdk/platform/google_appengine/goroot -gopath /Users/Bryan/go -nobuild_files ^^$ -incremental_rebuild -unsafe -binary_name _go_app -extra_imports appengine_internal/init -work_dir /var/folders/mw/0y88j8_54bjc93d_lg3120qw0000gp/T/tmpEOVMVuappengine-go-bin -gcflags -I,/Users/Bryan/go/src/google-cloud-sdk/platform/google_appengine/goroot/pkg/darwin_amd64_appengine -ldflags -L,/Users/Bryan/go/src/google-cloud-sdk/platform/google_appengine/goroot/pkg/darwin_amd64_appengine skincare.go skincare_test.go)\n/var/folders/mw/0y88j8_54bjc93d_lg3120qw0000gp/T/tmpEOVMVuappengine-go-bin/skincare.go:31: undefined: \"google.golang.org/appengine\".Context\n\n2017/05/30 10:27:36 go-app-builder: build timing: 0\u00d7skip (5ms total), 11\u00d7compile (2.128s total), 0\u00d7link (0 total)\n2017/05/30 10:27:36 go-app-builder: failed running compile: exit status 2\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 6, "creation_date": 1495820361, "post_id": 44207299, "comment_id": 75427079, "body": "It&#39;s just in stdlib: <a href=\"https://golang.org/pkg/go/\" rel=\"nofollow noreferrer\"><code>go</code></a>"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1495820362, "post_id": 44207299, "comment_id": 75427080, "body": "I imagine there&#39;s a lexer in the Go compiler."}], "answers": [{"comments": [{"owner": {"reputation": 3372, "user_id": 2325702, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11bd86061e8fcade1299dbfc80b16493?s=128&d=identicon&r=PG", "display_name": "dmg", "link": "https://stackoverflow.com/users/2325702/dmg"}, "edited": false, "score": 1, "creation_date": 1495829577, "post_id": 44207668, "comment_id": 75431453, "body": "Thank you very much. This was enough for me to solve the problem I had."}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 3, "last_activity_date": 1495821733, "creation_date": 1495821733, "answer_id": 44207668, "question_id": 44207299, "link": "https://stackoverflow.com/questions/44207299/is-there-an-open-source-lexer-parser-for-the-go-language/44207668#44207668", "title": "Is there an open source lexer (parser) for the go language?", "body": "<p>Standard Lib:</p>\n\n<p><a href=\"https://golang.org/pkg/go/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/go/</a></p>\n\n<p>You can start with the <a href=\"https://golang.org/pkg/go/scanner/\" rel=\"nofollow noreferrer\">scanner</a> package, it will tokenize Go source code.</p>\n\n<p><a href=\"https://golang.org/pkg/go/scanner/#example_Scanner_Scan\" rel=\"nofollow noreferrer\">Example</a></p>\n"}], "owner": {"reputation": 3372, "user_id": 2325702, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11bd86061e8fcade1299dbfc80b16493?s=128&d=identicon&r=PG", "display_name": "dmg", "link": "https://stackoverflow.com/users/2325702/dmg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 44207668, "answer_count": 1, "score": 1, "last_activity_date": 1495821733, "creation_date": 1495820277, "question_id": 44207299, "link": "https://stackoverflow.com/questions/44207299/is-there-an-open-source-lexer-parser-for-the-go-language", "title": "Is there an open source lexer (parser) for the go language?", "body": "<p>For the go language, is there a tool that would parse it into lexical elements? I am looking for a filter that would take go source code and output a tokenized version of it. It does not need to do full semantic compilation.</p>\n\n<p>thank you in advance,</p>\n"}, {"tags": ["go", "exec"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 4, "creation_date": 1495819715, "post_id": 44206940, "comment_id": 75426761, "body": "It would be helpful to others if you shared your code."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 3, "last_activity_date": 1495820117, "creation_date": 1495820117, "answer_id": 44207256, "question_id": 44206940, "link": "https://stackoverflow.com/questions/44206940/execute-the-cd-command-for-cmd-in-go/44207256#44207256", "title": "Execute the &#39;cd&#39; command for CMD in Go", "body": "<p>You specify the initial working directory to run the command in the <code>Cmd</code> object:</p>\n\n<pre><code>cmd.Dir = \"C:\\\\\"\n</code></pre>\n\n<p>See the <a href=\"https://golang.org/pkg/os/exec/#Cmd\" rel=\"nofollow noreferrer\">documentation on the Cmd</a> struct for more details.</p>\n"}, {"tags": [], "owner": {"reputation": 12675, "user_id": 636009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IIQJV.jpg?s=128&g=1", "display_name": "David Conrad", "link": "https://stackoverflow.com/users/636009/david-conrad"}, "is_accepted": true, "score": 7, "last_activity_date": 1495823003, "creation_date": 1495823003, "answer_id": 44207974, "question_id": 44206940, "link": "https://stackoverflow.com/questions/44206940/execute-the-cd-command-for-cmd-in-go/44207974#44207974", "title": "Execute the &#39;cd&#39; command for CMD in Go", "body": "<p>The <code>cd</code> command is a builtin of your shell, whether bash, cmd.exe, PowerShell, or otherwise. You would not exec a <code>cd</code> command and then exec the program you want to run. Instead, you want to set the <code>Dir</code> of the <code>Cmd</code> you're going to run to the directory containing the program:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"program\") // or whatever the program is\n    cmd.Dir = \"C:/usr/bin\"         // or whatever directory it's in\n    out, err := cmd.Output()\n    if err != nil {\n        log.Fatal(err)\n    } else {\n        fmt.Printf(\"%s\", out);\n    }\n}\n</code></pre>\n\n<p>See the <a href=\"https://golang.org/pkg/os/exec/#Cmd\" rel=\"noreferrer\">Cmd documentation</a> for more information. Alternatively, you could use <a href=\"https://golang.org/pkg/os/#Chdir\" rel=\"noreferrer\">os/Chdir</a> to change the working directory before running the program.</p>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 3600771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z3758.jpg?s=128&g=1", "display_name": "Jason M.", "link": "https://stackoverflow.com/users/3600771/jason-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1611941340, "creation_date": 1611941340, "answer_id": 65959105, "question_id": 44206940, "link": "https://stackoverflow.com/questions/44206940/execute-the-cd-command-for-cmd-in-go/65959105#65959105", "title": "Execute the &#39;cd&#39; command for CMD in Go", "body": "<p>Depending if the command needs to operate in the &quot;root&quot; of the directory, you can use <a href=\"https://pkg.go.dev/os#Chdir\" rel=\"nofollow noreferrer\"><code>os.Chdir(dir)</code></a> to change Go programs directory. All of the subsequent commands and paths will then be relative to the value of the <code>dir</code> provided to <code>os.Chdir</code>.</p>\n"}], "owner": {"reputation": 89, "user_id": 5124032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b593302405409d5b2f916309d962e0?s=128&d=identicon&r=PG&f=1", "display_name": "Jilan", "link": "https://stackoverflow.com/users/5124032/jilan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7971, "favorite_count": 1, "accepted_answer_id": 44207974, "answer_count": 3, "score": 2, "last_activity_date": 1611941340, "creation_date": 1495818845, "last_edit_date": 1601070954, "question_id": 44206940, "link": "https://stackoverflow.com/questions/44206940/execute-the-cd-command-for-cmd-in-go", "title": "Execute the &#39;cd&#39; command for CMD in Go", "body": "<p>I want to use Go and the exec library to go to a certain path, <em>&quot;c:&quot;</em>, and run a .exe file.</p>\n<p>When I run my Go code, it gives me:</p>\n<blockquote>\n<p>exec: &quot;cd:/&quot;: file does not exist</p>\n</blockquote>\n"}, {"tags": ["go", "hugo"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1495830280, "post_id": 44206274, "comment_id": 75431754, "body": "Find <code>max id</code> in posts table?"}, {"owner": {"reputation": 527, "user_id": 7496806, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fsK1X.png?s=128&g=1", "display_name": "Asqiir", "link": "https://stackoverflow.com/users/7496806/asqiir"}, "reply_to_user": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1495875673, "post_id": 44206274, "comment_id": 75441197, "body": "hugo don&#39;t use any tables. These are .md files."}, {"owner": {"reputation": 3415, "user_id": 5287638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AzeH8.png?s=128&g=1", "display_name": "Jack Taylor", "link": "https://stackoverflow.com/users/5287638/jack-taylor"}, "edited": false, "score": 0, "creation_date": 1496102564, "post_id": 44206274, "comment_id": 75511744, "body": "Am I right in assuming that these are &quot;first&quot; and &quot;last&quot; as organised by date? As in the earliest post and the latest post?"}], "answers": [{"tags": [], "owner": {"reputation": 474, "user_id": 3912031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/794c64825656b1f0e468aa3f5b5240b9?s=128&d=identicon&r=PG", "display_name": "Bud Parr", "link": "https://stackoverflow.com/users/3912031/bud-parr"}, "is_accepted": false, "score": 1, "last_activity_date": 1582549994, "last_edit_date": 1582549994, "creation_date": 1495889577, "answer_id": 44217086, "question_id": 44206274, "link": "https://stackoverflow.com/questions/44206274/link-to-first-last-post/44217086#44217086", "title": "Link to first/last post", "body": "<p>Hugo has a <code>first</code> and <code>last</code> function:\n<a href=\"https://gohugo.io/functions/first/\" rel=\"nofollow noreferrer\">https://gohugo.io/functions/first/</a> \n<a href=\"https://gohugo.io/functions/last/\" rel=\"nofollow noreferrer\">https://gohugo.io/functions/last/</a> </p>\n\n<p>and you'll have much better luck with questions, and in fact, this question has already been asked,  at the official Hugo forum: <a href=\"https://discuss.gohugo.io/\" rel=\"nofollow noreferrer\">https://discuss.gohugo.io/</a></p>\n"}, {"tags": [], "owner": {"reputation": 3415, "user_id": 5287638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AzeH8.png?s=128&g=1", "display_name": "Jack Taylor", "link": "https://stackoverflow.com/users/5287638/jack-taylor"}, "is_accepted": false, "score": 1, "last_activity_date": 1496103296, "creation_date": 1496103296, "answer_id": 44251705, "question_id": 44206274, "link": "https://stackoverflow.com/questions/44206274/link-to-first-last-post/44251705#44251705", "title": "Link to first/last post", "body": "<p>You can do this by filtering the array of all the pages on your site by section, and then choosing the first and last pages in the array. You don't have to sort the list of pages, because they are already sorted by date. Give the following a try (although be warned, I haven't tested it).</p>\n\n<pre><code>{{ $sectionPages := where .Site.Pages \"Section\" .Section }}\n{{ range first 1 $sectionPages }}\n  First page title: {{ .Title }}\n}}\n{{ range last 1 $sectionPages }}\n  Last page title: {{ .Title }}\n}}\n</code></pre>\n"}], "owner": {"reputation": 527, "user_id": 7496806, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fsK1X.png?s=128&g=1", "display_name": "Asqiir", "link": "https://stackoverflow.com/users/7496806/asqiir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1582551420, "creation_date": 1495816388, "last_edit_date": 1582551420, "question_id": 44206274, "link": "https://stackoverflow.com/questions/44206274/link-to-first-last-post", "title": "Link to first/last post", "body": "<p>Within a Hugo partial I want to have a link to the <em>first</em> and the <em>last</em> post of the section. (Let's call it <code>post</code>)</p>\n\n<p>While I can use an obvious workaround for the first post (just link to <code>/post/000</code>, but that's not satiscfating) the link to the last post is much harder because the current last post changes every time I add a new post.</p>\n\n<p>So: how to do this?</p>\n"}, {"tags": ["csv", "go", "channel"], "comments": [{"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 1, "creation_date": 1495805724, "post_id": 44202925, "comment_id": 75418580, "body": "It won&#39;t work this way. It could work like myChan would be &quot;chan interface{}&quot;. But even better is create not to use channel of interface{}, but channel of interfaces, that have some specific method. And please, tell us why you need something like that, because I&#39;ve never need to create a channel of something, that I don&#39;t know what is it."}, {"owner": {"reputation": 31, "user_id": 5311809, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T0aW3EobRbw/AAAAAAAAAAI/AAAAAAAAARM/KX0LXA0FO0M/photo.jpg?sz=128", "display_name": "Johann Weich", "link": "https://stackoverflow.com/users/5311809/johann-weich"}, "reply_to_user": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1495806417, "post_id": 44202925, "comment_id": 75419060, "body": "I receive a csv filename. Different files will have different structures inside. I then send it to go gocsv.UnmarshalToChan(clientsFile, &amp;myChan). gocsv is \t&quot;github.com/gocarina/gocsv&quot;  Inside the range will also not just be println, I will do some processing and write it to a db."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1495809827, "post_id": 44202925, "comment_id": 75421308, "body": "Can you include that processing and write-to-db code in as methods of the types?  Like <code>Two.Process()</code> and <code>Two.WriteDB(dbHandle)</code>?  If you can isolate their behavior like that, you can make the channel be of an interface with those methods on it, and the range loop can simply accept anything that fulfills it, calling those methods as they get the items from the channel.  That would also open the code up to dependency injection testing, as hard-coded concrete types can make proper unit testing difficult or impossible."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5311809, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T0aW3EobRbw/AAAAAAAAAAI/AAAAAAAAARM/KX0LXA0FO0M/photo.jpg?sz=128", "display_name": "Johann Weich", "link": "https://stackoverflow.com/users/5311809/johann-weich"}, "edited": false, "score": 0, "creation_date": 1496043495, "post_id": 44222545, "comment_id": 75483648, "body": "Sorry, my question was not clear enough. I have updated it. If I make a &quot;chan interface{}&quot; then I cannot do &quot;myChan = make(chan One)&quot; in the switch statement"}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 1, "last_activity_date": 1495928660, "creation_date": 1495928660, "answer_id": 44222545, "question_id": 44202925, "link": "https://stackoverflow.com/questions/44202925/how-can-i-range-over-a-channel-of-unknown-types-in-golang/44222545#44222545", "title": "How can I range over a channel of unknown types in golang", "body": "<p><strong>myChan</strong> variable isn't a channel, a type channel is created in this way: <strong>chan</strong> interface{}</p>\n\n<p>for example if you want a channel to pass any type you can use this:</p>\n\n<pre><code>func main() {\n    c := make(chan interface{}, 1)\n\n    go func() {\n        for a := range c {\n            fmt.Println(a)\n        }\n    }()\n\n    c &lt;- 21\n    c &lt;- \"jazz\"\n    c &lt;- person{\"Chet\", 88}\n\n    time.Sleep(time.Second)\n}\n\ntype person struct {\n    Name string\n    Age int\n}\n</code></pre>\n\n<p>full example: <a href=\"https://play.golang.org/p/BJrAHiSAaw\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BJrAHiSAaw</a></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5311809, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T0aW3EobRbw/AAAAAAAAAAI/AAAAAAAAARM/KX0LXA0FO0M/photo.jpg?sz=128", "display_name": "Johann Weich", "link": "https://stackoverflow.com/users/5311809/johann-weich"}, "edited": false, "score": 0, "creation_date": 1496139456, "post_id": 44250375, "comment_id": 75526955, "body": "This is kind of what I am doing now. I moved the doStuff which is actually gocsv.UnmarshalToChan(clientsFile, &amp;myChan) and the <b>range</b> into the first switch statement. It is a bad solution for me because there can be 15 to 20 different csv files and I have to do almost the same thing with all of them, so it means 20 blocks of duplicate code in the switch statement. I will accept your answer - I have kind of given up on finding the <i>correct</i> way, but I think it might involve <b>reflect</b>"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 31, "user_id": 5311809, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T0aW3EobRbw/AAAAAAAAAAI/AAAAAAAAARM/KX0LXA0FO0M/photo.jpg?sz=128", "display_name": "Johann Weich", "link": "https://stackoverflow.com/users/5311809/johann-weich"}, "edited": false, "score": 1, "creation_date": 1496158020, "post_id": 44250375, "comment_id": 75540639, "body": "Yeah this would be a pain to use with 20 cases to check for.. and each csv has completely different structures.. youd have to defined 20 different structs. If you can programmically nornalize the csvs then you wouldnt need as many structs. Or since they are csvs, they are 1 dimensional.  Use a  []map[string]string and forget the channels. Where the key in the map is equal csv header."}], "tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": true, "score": 0, "last_activity_date": 1496093304, "last_edit_date": 1496093304, "creation_date": 1496092483, "answer_id": 44250375, "question_id": 44202925, "link": "https://stackoverflow.com/questions/44202925/how-can-i-range-over-a-channel-of-unknown-types-in-golang/44250375#44250375", "title": "How can I range over a channel of unknown types in golang", "body": "<p>I'm not 100% sure I understand the question, but looking at the code you've written, this is how I would get resolve the cannot range issue. This is going to deadlock, because not everything is defined...but ranging isn't an issue or shouldn't be. Also the doStuff code, should signal when the channel should be closed, maybe passed in a wait group, keep track with a counter, etc.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n)\n\n// One ...\ntype One struct{}\n\n// Two ...\ntype Two struct{}\n\nfunc doStuff(*interface{}) {}\n\nfunc myFunc(input string) {\n    var myChan interface{}\n    switch input {\n    case \"one\":\n        myChan = make(chan One)\n    case \"two\":\n        myChan = make(chan Two)\n    }\n    // might have to move this line of code into the switch block below...\n    // see commented example\n    go doStuff(&amp;myChan)\n\n    switch myChan.(type) {\n    case chan One:\n        // in this way you're not passing an interface{} but a chan or type One or Two\n        // go doStuff(&amp;myChan.(chan One))\n        for item := range myChan.(chan One) {\n            fmt.Println(item)\n        }\n    case chan Two:\n        // go doStuff(&amp;myChan.(chan One))\n        for item := range myChan.(chan Two) {\n            fmt.Println(item)\n        }\n    default:\n        log.Fatalln(\"Unknown type entered\")\n    }\n\n}\n\nfunc main() {\n    myFunc(\"one\")\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5311809, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T0aW3EobRbw/AAAAAAAAAAI/AAAAAAAAARM/KX0LXA0FO0M/photo.jpg?sz=128", "display_name": "Johann Weich", "link": "https://stackoverflow.com/users/5311809/johann-weich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 44250375, "answer_count": 2, "score": 0, "last_activity_date": 1496093304, "creation_date": 1495805458, "last_edit_date": 1496056596, "question_id": 44202925, "link": "https://stackoverflow.com/questions/44202925/how-can-i-range-over-a-channel-of-unknown-types-in-golang", "title": "How can I range over a channel of unknown types in golang", "body": "<p>I have a function which receives a string and based on that it creates a channel of a type based on the string value. This channel is then sent off to be populated in another thread. </p>\n\n<p>In this function, I then want to <strong>range</strong> over the populated values and use them.</p>\n\n<p>However, I get an error: <strong>\"cannot range over myChan (type interface {})\"</strong></p>\n\n<p>Here is an example of my code:</p>\n\n<pre><code>func myFunc(input string) {\n    var myChan interface{}\n\n    switch input {\n    case \"one\":\n        myChan = make(chan One)\n    case \"two\":\n        myChan = make(chan Two)\n    }\n\n    go doStuff(&amp;myChan)\n\n    for _, item := range myChan {\n        fmt.Println(item)\n    }\n}\n</code></pre>\n\n<p>Please help me understand how to accomplish this?</p>\n\n<p>Edit: I'm sorry my question was not clear enough. The line go doStuff(&amp;myChan) is actually this:</p>\n\n<pre><code>go gocsv.UnmarshalToChan(clientsFile, &amp;myChan)\n</code></pre>\n\n<p>According to the documentation of gocsv UnmarshalToChan \"The channel must have a concrete type.\" That is why I cannot have a <strong>chan interface{}</strong></p>\n"}, {"tags": ["go", "xss"], "comments": [{"owner": {"reputation": 1162, "user_id": 1586797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e19c16130bbfb34d0f8cdb414780e50?s=128&d=identicon&r=PG", "display_name": "bronze man", "link": "https://stackoverflow.com/users/1586797/bronze-man"}, "edited": false, "score": 0, "creation_date": 1537176487, "post_id": 44202894, "comment_id": 91673318, "body": "The best way to prevent xss is escape the value with correct escape function when the value is add to the html or javascript.Escape string in the input process will get wrong result when it output to other place like android."}], "answers": [{"tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": true, "score": 1, "last_activity_date": 1542291399, "last_edit_date": 1542291399, "creation_date": 1495808688, "answer_id": 44204022, "question_id": 44202894, "link": "https://stackoverflow.com/questions/44202894/implement-xss-protection-in-golang/44204022#44204022", "title": "Implement XSS protection in Golang", "body": "<p>You can use reflection to loop over the fields and escape the string fields.\nFor example:</p>\n\n<pre><code>myStruct := struct {\n        IntField int\n        StringField string\n    } {\n        IntField: 42,\n        StringField: \"&lt;script&gt;alert('foo');&lt;/script&gt;\",\n    }\n\n    value := reflect.ValueOf(&amp;myStruct).Elem()\n\n    // loop over the struct\n    for i := 0; i &lt; value.NumField(); i++ {\n        field := value.Field(i)\n\n        // check if the field is a string\n        if field.Type() != reflect.TypeOf(\"\") {\n            continue\n        }\n\n        str := field.Interface().(string)\n        // set field to escaped version of the string\n        field.SetString(html.EscapeString(str))\n    }\n\n    fmt.Printf(\"%#v\", myStruct)\n    // prints: struct { IntField int; StringField string }{IntField:42, StringField:\"&amp;lt;script&amp;gt;alert(&amp;#39;foo&amp;#39;);&amp;lt;/script&amp;gt;\"}\n</code></pre>\n\n<p>Note that there's an <a href=\"https://golang.org/pkg/html/#EscapeString\" rel=\"nofollow noreferrer\"><code>EscapeString</code></a> function in the html package. No need to implement your own.</p>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3539, "favorite_count": 1, "accepted_answer_id": 44204022, "answer_count": 1, "score": 0, "last_activity_date": 1542291399, "creation_date": 1495805360, "question_id": 44202894, "link": "https://stackoverflow.com/questions/44202894/implement-xss-protection-in-golang", "title": "Implement XSS protection in Golang", "body": "<p>I am using Golang to construct an API Rest. I have a struct with a lot of fields (more than 100), so I assign the values that comes from the client side to the struct using <code>gorilla/schema</code> that's working pretty nice.</p>\n\n<p>Now, I want to avoid the users to insert Javascript code in any of the strings fields, in the struct I have defined bool, strings, byte[] and int values. So, now I am wondering what is the best way to validate that.</p>\n\n<p>I am thinking in interate over the struct only in the strings fields and make something like:</p>\n\n<pre><code>Loop over the struct {\n     myProperty := JSEscapeString(myProperty)\n}\n</code></pre>\n\n<p>Is it ok? in that case, how can I loop over the struct but only the string fields?</p>\n"}, {"tags": ["go", "google-api", "google-sites"], "answers": [{"comments": [{"owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "edited": false, "score": 0, "creation_date": 1495801484, "post_id": 44201267, "comment_id": 75415580, "body": "are there are anywhich way i can get contents from latest googlesites"}, {"owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "reply_to_user": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "edited": false, "score": 0, "creation_date": 1495801563, "post_id": 44201267, "comment_id": 75415646, "body": "I am not aware of any, consider using a web scraping library."}], "tags": [], "owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "is_accepted": false, "score": 2, "last_activity_date": 1495800599, "creation_date": 1495800599, "answer_id": 44201267, "question_id": 44201190, "link": "https://stackoverflow.com/questions/44201190/are-there-are-any-go-clients-for-google-sites/44201267#44201267", "title": "Are there are any go clients for Google sites", "body": "<p>There is no Go client for Google Sites.</p>\n\n<p>There is a general <a href=\"https://developers.google.com/google-apps/sites/code?hl=pl\" rel=\"nofollow noreferrer\">Google Sites API</a> but it only works with an old version of Google Sites.</p>\n"}], "owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1498198680, "answer_count": 1, "score": 0, "last_activity_date": 1495800599, "creation_date": 1495800358, "question_id": 44201190, "link": "https://stackoverflow.com/questions/44201190/are-there-are-any-go-clients-for-google-sites", "closed_reason": "Not suitable for this site", "title": "Are there are any go clients for Google sites", "body": "<p>are there are any golang clients to get all the contents from google sites as we have </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>\"google.golang.org/api/googleapi\"</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>for google drive,any suggestions on how to get all the contents of googlesites using golang</p>\n"}, {"tags": ["docker", "go", "blockchain", "hyperledger", "hyperledger-fabric"], "comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1495796782, "post_id": 44199052, "comment_id": 75412651, "body": "It says: <code>(https fetch: Get https:&#47;&#47;golang.org&#47;x&#47;tools&#47;go&#47;gcexportdata?go-get=1: net&#47;http: TLS handshake timeout)</code> ... This seems to work fine for me, so check your internet connection (or maybe just try again, could be a temporary error on the server)."}, {"owner": {"reputation": 1, "user_id": 8069347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839a460c1107f70a13d10e97035db26c?s=128&d=identicon&r=PG&f=1", "display_name": "dingding", "link": "https://stackoverflow.com/users/8069347/dingding"}, "reply_to_user": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1495870002, "post_id": 44199052, "comment_id": 75439865, "body": "Thank you!  I tried many times, still unable to access &#39;<a href=\"https://go.googlesource.com/tools/\" rel=\"nofollow noreferrer\">go.googlesource.com/tools</a>&#39;. Now I&#39;m trying the docker method, though it seems very slow."}, {"owner": {"reputation": 1, "user_id": 8069347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839a460c1107f70a13d10e97035db26c?s=128&d=identicon&r=PG&f=1", "display_name": "dingding", "link": "https://stackoverflow.com/users/8069347/dingding"}, "reply_to_user": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1495870424, "post_id": 44199052, "comment_id": 75439953, "body": "but it is strange that my computer actually can access or ping to this address"}], "answers": [{"tags": [], "owner": {"reputation": 1855, "user_id": 1339495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fnPSu.jpg?s=128&g=1", "display_name": "malajisi", "link": "https://stackoverflow.com/users/1339495/malajisi"}, "is_accepted": false, "score": 1, "last_activity_date": 1516979184, "last_edit_date": 1516979184, "creation_date": 1516954363, "answer_id": 48457727, "question_id": 44199052, "link": "https://stackoverflow.com/questions/44199052/error-hyperledger-fabricmake-gotools-unrecognized-import-path-golang-org-x-t/48457727#48457727", "title": "ERROR: hyperledger/fabric:make gotools: unrecognized import path &quot;golang.org/x/tools/go/gcexportdata&quot;", "body": "<p>Try to following the steps:</p>\n\n<pre><code>#mkdir -p gotools/build/gopath/src/golang.org/x/\n\n#cd gotools/build/gopath/src/golang.org/x/\n\n#git clone https://github.com/golang/tools.git\n\n#cd $GOPATH/src/github.com/hyperledger/fabric/\n</code></pre>\n\n<p>Then make again </p>\n\n<pre><code>#make gotools\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8069347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839a460c1107f70a13d10e97035db26c?s=128&d=identicon&r=PG&f=1", "display_name": "dingding", "link": "https://stackoverflow.com/users/8069347/dingding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 923, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1516979184, "creation_date": 1495793867, "last_edit_date": 1495796857, "question_id": 44199052, "link": "https://stackoverflow.com/questions/44199052/error-hyperledger-fabricmake-gotools-unrecognized-import-path-golang-org-x-t", "title": "ERROR: hyperledger/fabric:make gotools: unrecognized import path &quot;golang.org/x/tools/go/gcexportdata&quot;", "body": "<p>When make peer, it can't access build/docker/gotools/bin/protoc-gen-go, so I make gotools, but fail, here is the log:</p>\n\n<pre><code>mkdir -p build/bin\ncd gotools &amp;&amp; make install BINDIR=/root/gocode/bin\nmake[1]: Entering directory '/root/gocode/src/github.com/hyperledger/fabric/gotools'\nmake[2]: Entering directory '/root/gocode/src/github.com/hyperledger/fabric/gotools'\nBuilding github.com/golang/lint/golint -&gt; golint\npackage golang.org/x/tools/go/gcexportdata: unrecognized import path \"golang.org/x/tools/go/gcexportdata\" (https fetch: Get https://golang.org/x/tools/go/gcexportdata?go-get=1: net/http: TLS handshake timeout)\nMakefile:47: recipe for target 'gotool.golint' failed\n</code></pre>\n\n<p>How to solve this issue? Please help me, thank you!</p>\n"}, {"tags": ["postgresql", "go", "go-gorm", "pq"], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 1061320, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/c4dda74a5b7436a5387f09dfd9dd5783?s=128&d=identicon&r=PG", "display_name": "Saurav Haloi", "link": "https://stackoverflow.com/users/1061320/saurav-haloi"}, "is_accepted": false, "score": 0, "last_activity_date": 1495799293, "creation_date": 1495799293, "answer_id": 44200868, "question_id": 44198789, "link": "https://stackoverflow.com/questions/44198789/does-go-gorm-support-insert-with-auto-incremented-id-for-partitioned-tables-in-p/44200868#44200868", "title": "Does Go-Gorm support insert with auto incremented ID for partitioned tables in PostgreSQL?", "body": "<p>I got the answer. It was not an issue with GORM or Go-PQ. I was doing some goof up in my trigger function while returning the inserted values from the child table.</p>\n"}], "owner": {"reputation": 193, "user_id": 1061320, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/c4dda74a5b7436a5387f09dfd9dd5783?s=128&d=identicon&r=PG", "display_name": "Saurav Haloi", "link": "https://stackoverflow.com/users/1061320/saurav-haloi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1047, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495800862, "creation_date": 1495793043, "last_edit_date": 1495800862, "question_id": 44198789, "link": "https://stackoverflow.com/questions/44198789/does-go-gorm-support-insert-with-auto-incremented-id-for-partitioned-tables-in-p", "title": "Does Go-Gorm support insert with auto incremented ID for partitioned tables in PostgreSQL?", "body": "<p>I have a table in PostgreSQL represented as the following Go struct:</p>\n\n<pre><code>type AppLog struct {\n    ID int // set to auto increment in DB, also a primary key\n    event string\n    createTime time.Time \n}\n</code></pre>\n\n<p>I configured monthly table partitioning with the above as the base table and a insert trigger to route the data into the child table for the current month using the dateTime values as the partition key.</p>\n\n<p>[the trigger function etc are omitted for brevity]</p>\n\n<p>When I try to insert into AppLog table, Postgres routes the operation to the appropriate child table, say AppLog_2017-05 (current month table), but the insert fails with the following error:</p>\n\n<pre><code>INSERT INTO \"app_logs\" (\"event\", \"create_time\") \nVALUES ('device /dev/sdc is now ready','2017-05-26T15:04:30+05:30') \nRETURNING \"app_logs\".\"id\"\n</code></pre>\n\n<blockquote>\n  <p>ERROR: sql: no rows in result set</p>\n</blockquote>\n\n<p>When the same query is run in the Postgres Shell, it runs fine.</p>\n\n<p>Can someone help me understand how to do inserts using GORM in PostgreSQL where table partitioning is configured behind the scene? I am not sure if this is a problem with GORM or the Go PostgreSQL driver or Go Database/SQL package. Or, if I am missing anything.</p>\n\n<p>Any help will be highly appreciated.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "is_accepted": true, "score": 8, "last_activity_date": 1559821743, "last_edit_date": 1559821743, "creation_date": 1495791664, "answer_id": 44198345, "question_id": 44197951, "link": "https://stackoverflow.com/questions/44197951/golang-reflect-value-kind-of-slice/44198345#44198345", "title": "golang reflect value kind of slice", "body": "<p>To start, we need to ensure that the we're dealing with a slice by testing: <code>reflect.TypeOf(&lt;var&gt;).Kind() == reflect.Slice</code>  </p>\n\n<p>Without that check, you risk a runtime panic.  So, now that we know we're working with a slice, finding the element type is as simple as: <code>typ := reflect.TypeOf(&lt;var&gt;).Elem()</code></p>\n\n<p>Since we're likely expecting many different element types, we can use a switch statement to differentiate: </p>\n\n<pre><code>t := reflect.TypeOf(&lt;var&gt;)\nif t.Kind() != reflect.Slice {\n    // handle non-slice vars\n}\nswitch t.Elem().Kind() {  // type of the slice element\n    case reflect.Int:\n        // Handle int case\n    case reflect.String:\n        // Handle string case\n    ...\n    default:\n        // custom types or structs must be explicitly typed\n        // using calls to reflect.TypeOf on the defined type.\n}\n</code></pre>\n"}], "owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3430, "favorite_count": 1, "accepted_answer_id": 44198345, "answer_count": 1, "score": 4, "last_activity_date": 1559821743, "creation_date": 1495790418, "question_id": 44197951, "link": "https://stackoverflow.com/questions/44197951/golang-reflect-value-kind-of-slice", "title": "golang reflect value kind of slice", "body": "<pre><code>fmt.Println(v.Kind())\nfmt.Println(reflect.TypeOf(v))\n</code></pre>\n\n<p>How can I find out the type of the reflect value of a slice?</p>\n\n<p>The above results in</p>\n\n<pre><code>v.Kind = slice\ntypeof = reflect.Value\n</code></pre>\n\n<p>When i try to <code>Set</code> it will crash if i create the wrong slice</p>\n\n<pre><code>t := reflect.TypeOf([]int{})\ns := reflect.MakeSlice(t, 0, 0)\nv.Set(s)\n</code></pre>\n\n<p>For example <code>[]int{}</code> instead of <code>[]string{}</code> so I need to know the exact slice type of the reflect value before I create one.</p>\n"}, {"tags": ["html", "email", "go", "websocket"], "comments": [{"owner": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "edited": false, "score": 0, "creation_date": 1495795026, "post_id": 44196343, "comment_id": 75411627, "body": "This isn&#39;t Go specific. You need to check the batch email status after any page navigation has occurred. Whether that&#39;s just polling the web server or using sockets, that&#39;s entirely up to you."}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1495797990, "post_id": 44196343, "comment_id": 75413371, "body": "You can use the very rudimentary approach of writing the results of the response to a particular file continuously, and read that file whenever you want to show the current status to the user. You can have the file named with something you can identity the client with. I would not recommend websocket usage just for this one case."}, {"owner": {"reputation": 232, "user_id": 7590816, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8e7262f8d0422f90bb77ac563ca9ad15?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh kumar", "link": "https://stackoverflow.com/users/7590816/rajesh-kumar"}, "reply_to_user": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "edited": false, "score": 0, "creation_date": 1495854033, "post_id": 44196343, "comment_id": 75437075, "body": "@WiredPrairie I tried to use sockets but the connection gets closed when the user traverses to another page.Am I missing something here?????.Thanks"}, {"owner": {"reputation": 232, "user_id": 7590816, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8e7262f8d0422f90bb77ac563ca9ad15?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh kumar", "link": "https://stackoverflow.com/users/7590816/rajesh-kumar"}, "reply_to_user": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1495854506, "post_id": 44196343, "comment_id": 75437148, "body": "@Gaurav Ojha .The problem is i dont know how to get the result as the response already comes back as i am using go-routine,the response don&#39;t wait till the completion of the email function.Unless i store the result in the server and call back server here and there to retrieve it back to the client.Is it what u r suggesting.But this will make lot of calls to server.Thanks"}, {"owner": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "edited": false, "score": 0, "creation_date": 1496023952, "post_id": 44196343, "comment_id": 75477363, "body": "Yes, you&#39;ll need to store the result and then check for the result if the page is navigated."}], "answers": [{"comments": [{"owner": {"reputation": 232, "user_id": 7590816, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8e7262f8d0422f90bb77ac563ca9ad15?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh kumar", "link": "https://stackoverflow.com/users/7590816/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1495853866, "post_id": 44196611, "comment_id": 75437051, "body": "yes.I tried using sockets but when the user traverses to another page the existing socket connection get closed...."}], "tags": [], "owner": {"reputation": 259, "user_id": 6398020, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2fc9cc1619a0b712df3032f6b9772c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio", "link": "https://stackoverflow.com/users/6398020/mauricio"}, "is_accepted": false, "score": 0, "last_activity_date": 1495790025, "last_edit_date": 1495790025, "creation_date": 1495785917, "answer_id": 44196611, "question_id": 44196343, "link": "https://stackoverflow.com/questions/44196343/need-to-notify-the-email-send-status-after-the-http-response-is-launched/44196611#44196611", "title": "Need to notify the email send status after the http response is launched", "body": "<p>I believe that if the user navigates away from the site then there is no way to send them any information. Browser specifically won't accept things that they themselves haven't requested. Now if the user is still on your site, then you can probably write up some javascript in the html page that asks the server every now and then for an update on those emails, then just pops up a little alert box when its done. Hope this puts you on the right path  </p>\n\n<p>EDIT: just read about sockets in go, may be what you're looking for. </p>\n"}], "owner": {"reputation": 232, "user_id": 7590816, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8e7262f8d0422f90bb77ac563ca9ad15?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh kumar", "link": "https://stackoverflow.com/users/7590816/rajesh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495790025, "creation_date": 1495784988, "question_id": 44196343, "link": "https://stackoverflow.com/questions/44196343/need-to-notify-the-email-send-status-after-the-http-response-is-launched", "title": "Need to notify the email send status after the http response is launched", "body": "<p>I am creating a web app.(Front-End:html,Back-End: golang)</p>\n\n<p>In one of the pages the app needs to send email to lots of people.Since it takes huge amount of time and i dont want to user to wait,i use go-routine for the function which sends the email.So before the function ends, the response is launched.</p>\n\n<p>The problem is i need to show the result of these emails(Email Send Success or Failure) on the page where the user is currently visiting like a notification.</p>\n\n<p>I tried web socket but since the user will be traversing different pages the socket is closing automatically.\nAny idea how to do this.\nThanks....</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1495784666, "post_id": 44196113, "comment_id": 75405677, "body": "Of course. All drivers are built on the basic principle of sending a &quot;command structure&quot; to the database. For mgo it is <a href=\"https://godoc.org/gopkg.in/mgo.v2#Database.Run\" rel=\"nofollow noreferrer\"><code>Run()</code></a>, and the full list of <a href=\"https://docs.mongodb.com/manual/reference/command/\" rel=\"nofollow noreferrer\">Database Commands</a> is listed in the core documentation."}, {"owner": {"reputation": 1923, "user_id": 1351876, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8028d0785748380250974c5424b07af2?s=128&d=identicon&r=PG", "display_name": "Nithin", "link": "https://stackoverflow.com/users/1351876/nithin"}, "reply_to_user": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1495785175, "post_id": 44196113, "comment_id": 75405929, "body": "@NeilLunn can you give me an example of how to run <code>rs,initiate()</code> and <code>rs.add()</code> commands?"}], "answers": [{"tags": [], "owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "is_accepted": false, "score": 4, "last_activity_date": 1495791477, "creation_date": 1495791477, "answer_id": 44198283, "question_id": 44196113, "link": "https://stackoverflow.com/questions/44196113/is-it-possible-to-run-mongo-replicaset-commands-using-mgo-driver/44198283#44198283", "title": "Is it possible to run mongo replicaset commands using mgo driver?", "body": "<p>An example for <a href=\"https://docs.mongodb.com/manual/reference/command/replSetInitiate/#dbcmd.replSetInitiate\" rel=\"nofollow noreferrer\">rs.initiate</a> command:</p>\n\n<pre><code>session, err := mgo.Dial(\"rs1.example.net\")\nif err != nil {\n    panic(err)\n}\ndefer session.Close()\n\nconfig := bson.M{\n    \"_id\": \"my_replica_set\",\n    \"members\": []bson.M{\n        {\"_id\": 0, \"host\": \"rs1.example.net:27017\"},\n        {\"_id\": 1, \"host\": \"rs2.example.net:27017\", \"priority\": 2},\n        {\"_id\": 2, \"host\": \"rs3.example.net\", \"arbiterOnly\": true},\n    },\n}\nresult := bson.M{}\nif err := session.DB(\"admin\").Run(bson.M{\"replSetInitiate\": config}, &amp;result); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Same for <a href=\"https://docs.mongodb.com/manual/reference/command/replSetReconfig/#dbcmd.replSetReconfig\" rel=\"nofollow noreferrer\">rs.add</a> and any other rs.* helpers. </p>\n"}, {"tags": [], "owner": {"reputation": 1923, "user_id": 1351876, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8028d0785748380250974c5424b07af2?s=128&d=identicon&r=PG", "display_name": "Nithin", "link": "https://stackoverflow.com/users/1351876/nithin"}, "is_accepted": true, "score": 5, "last_activity_date": 1496481646, "creation_date": 1496481646, "answer_id": 44342358, "question_id": 44196113, "link": "https://stackoverflow.com/questions/44196113/is-it-possible-to-run-mongo-replicaset-commands-using-mgo-driver/44342358#44342358", "title": "Is it possible to run mongo replicaset commands using mgo driver?", "body": "<p>Thanks to @alex-blex's answer which gave me the start. But this is what finally worked for me:</p>\n\n<pre><code>session, err := mgo.Dial(\"rs1.example.net?connect=direct\")\nif err != nil {\n    panic(err)\n}\ndefer session.Close()\nsession.SetMode(mgo.Monotonic, true)\n\nconfig := bson.M{\n    \"_id\": \"my_replica_set\",\n    \"members\": []bson.M{\n        {\"_id\": 0, \"host\": \"rs1.example.net:27017\"},\n        {\"_id\": 1, \"host\": \"rs2.example.net:27017\", \"priority\": 2},\n        {\"_id\": 2, \"host\": \"rs3.example.net\", \"arbiterOnly\": true},\n    },\n}\nresult := bson.M{}\nif err := session.Run(bson.M{\"replSetInitiate\": config}, &amp;result); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Notice the following:</p>\n\n<ol>\n<li><p><code>?connect=direct</code> in the connection string. </p>\n\n<p>If not specified, the connection will timeout, probably because the replica set has not been initialized yet.</p></li>\n<li><p><code>session.SetMode(mgo.Monotonic, true)</code> </p>\n\n<p>Session mode should be <code>monotonic</code> as the default session used by mgo is <code>primary</code> which performs all operations on primary. Since the replica set has not been initialized yet, there wont be a primary and the operation (in this case, <code>replSetInitiate</code>) will just timeout</p></li>\n<li><p><code>\"_id\": \"my_replica_set\"</code> in the config</p>\n\n<p>For this to work, the mongo servers will have to be started with the replica set name <code>my_replica_set</code>. One way of doing that would be:</p>\n\n<pre><code>mongod --replSet my_replica_set\n</code></pre></li>\n<li>As per <a href=\"https://godoc.org/gopkg.in/mgo.v2#Session.Run\" rel=\"noreferrer\">Mgo docs</a> use session.Run() for commands on the \"admin\" database</li>\n</ol>\n"}], "owner": {"reputation": 1923, "user_id": 1351876, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8028d0785748380250974c5424b07af2?s=128&d=identicon&r=PG", "display_name": "Nithin", "link": "https://stackoverflow.com/users/1351876/nithin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1128, "favorite_count": 1, "accepted_answer_id": 44342358, "answer_count": 2, "score": 0, "last_activity_date": 1496481646, "creation_date": 1495784164, "question_id": 44196113, "link": "https://stackoverflow.com/questions/44196113/is-it-possible-to-run-mongo-replicaset-commands-using-mgo-driver", "title": "Is it possible to run mongo replicaset commands using mgo driver?", "body": "<p>Is it possible to run replica set commands like <code>rs.initiate()</code> and <code>rs.add()</code> using mgo driver from a golang application?</p>\n\n<p>If yes, how??</p>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 176, "user_id": 6243470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/335981a22c1733a215e5d47f9efd8ff6?s=128&d=identicon&r=PG&f=1", "display_name": "Ami", "link": "https://stackoverflow.com/users/6243470/ami"}, "edited": false, "score": 0, "creation_date": 1495783525, "post_id": 44195872, "comment_id": 75405074, "body": "Check this out <a href=\"https://stackoverflow.com/questions/36803999/golang-alphabetic-representation-of-a-number\" title=\"golang alphabetic representation of a number\">stackoverflow.com/questions/36803999/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 259, "user_id": 6398020, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2fc9cc1619a0b712df3032f6b9772c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio", "link": "https://stackoverflow.com/users/6398020/mauricio"}, "is_accepted": false, "score": 2, "last_activity_date": 1495783808, "creation_date": 1495783808, "answer_id": 44196017, "question_id": 44195872, "link": "https://stackoverflow.com/questions/44195872/how-to-find-the-next-greater-string-in-alphabetical-order-in-golang/44196017#44196017", "title": "How to find the next greater string in alphabetical order in Golang?", "body": "<p>Logically: \nLook at the last letter. If its not z, increment it by one. If it is z, set it to a, then look at the second to last letter. If its not z, increment it by 1. If it is z, set it to a and look at the third to last letter.... and so on  </p>\n\n<p>Try and figure out the code your self, this ones actually kind of fun. If you want the code just reply and I'll work it out</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6298626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tkW1a.jpg?s=128&g=1", "display_name": "Vignesh", "link": "https://stackoverflow.com/users/6298626/vignesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1496061307, "last_edit_date": 1496061307, "creation_date": 1495811925, "answer_id": 44205035, "question_id": 44195872, "link": "https://stackoverflow.com/questions/44195872/how-to-find-the-next-greater-string-in-alphabetical-order-in-golang/44205035#44205035", "title": "How to find the next greater string in alphabetical order in Golang?", "body": "<p>as @Mauricio said,parse characters in reverse order.increment a character if it is not 'z'.if all characters are 'z' then replace the first 'z' with 'aa'.</p>\n\n<p><a href=\"https://play.golang.org/p/A7rIp9Kx7B\" rel=\"nofollow noreferrer\">go playground link</a></p>\n"}], "owner": {"reputation": 81, "user_id": 5685288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/dJpfk.jpg?s=128&g=1", "display_name": "Kushagra Aggarwal", "link": "https://stackoverflow.com/users/5685288/kushagra-aggarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496061307, "creation_date": 1495783284, "question_id": 44195872, "link": "https://stackoverflow.com/questions/44195872/how-to-find-the-next-greater-string-in-alphabetical-order-in-golang", "title": "How to find the next greater string in alphabetical order in Golang?", "body": "<p>eg: abc<strong>d</strong> -> abc<strong>e</strong> ,  qwe<strong>r</strong> -> qwe<strong>s</strong> etc</p>\n\n<p>my_string := \"abcd\"</p>\n\n<p>How can I get my_string to have \"abce\" ?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "is_accepted": true, "score": 0, "last_activity_date": 1495847744, "creation_date": 1495847744, "answer_id": 44211989, "question_id": 44194886, "link": "https://stackoverflow.com/questions/44194886/gae-go-hang-up-on-local-development-server/44211989#44211989", "title": "GAE/Go hang up on local development server", "body": "<p>Self resolved.</p>\n\n<p>I set <code>gin</code> to <code>release mode</code> and my app works fine.</p>\n\n<pre><code>gin.SetMode(gin.ReleaseMode)\n</code></pre>\n"}], "owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 44211989, "answer_count": 1, "score": 1, "last_activity_date": 1495847744, "creation_date": 1495779535, "last_edit_date": 1495812211, "question_id": 44194886, "link": "https://stackoverflow.com/questions/44194886/gae-go-hang-up-on-local-development-server", "title": "GAE/Go hang up on local development server", "body": "<p>I am developing GAE/Go + gin application.</p>\n\n<p>We have now about 25 handlers like this.</p>\n\n<pre><code>func init() {\n    r := gin.New()\n    r.POST(\"/path/to/some1\", func1)   //  ^\n    r.POST(\"/path/to/some2\", func2)   //  |\n            :                         //  | about 25 handlers\n    r.POST(\"/path/to/someX\", funcX)   //  v\n}\n</code></pre>\n\n<p>I added another handler <code>funcY</code> to above code. and I invoked local development server, but it hangs up during start up.</p>\n\n<pre><code>func init() {                         // Hang up during start up.\n    r := gin.New()\n    r.POST(\"/path/to/some1\", func1)   \n    r.POST(\"/path/to/some2\", func2)   \n            :                         \n    r.POST(\"/path/to/someX\", funcX)   \n    r.POST(\"/path/to/someY\", funcY)   \n}\n</code></pre>\n\n<p>The console log is as below. No message after this.</p>\n\n<pre><code>\"C:\\Program Files (x86)\\JetBrains\\Gogland 171.3780.106\\bin\\runnerw.exe\" C:/go_appengine\\goapp.bat serve C:/path/to/app.yaml\nINFO     2017-05-26 15:03:02,552 devappserver2.py:764] Skipping SDK update check.\nINFO     2017-05-26 15:03:02,996 api_server.py:268] Starting API server at: http://localhost:56094\nINFO     2017-05-26 15:03:03,000 dispatcher.py:199] Starting module \"default\" running at: http://localhost:8080\nINFO     2017-05-26 15:03:03,000 admin_server.py:116] Starting admin server at: http://localhost:8000\n</code></pre>\n\n<p><code>funcY</code> has no problem because when I remove <code>func1</code>, it starts up normally.</p>\n\n<pre><code>func init() {                         // This works without problem.\n    r := gin.New()\n    r.POST(\"/path/to/some2\", func2)   \n            :                         \n    r.POST(\"/path/to/someX\", funcX)   \n    r.POST(\"/path/to/someY\", funcY)   \n}\n</code></pre>\n\n<p>Does gin have maximum number of handler? If so, how can I raise it? Or do I have another way to solve this?</p>\n\n<p><strong>[UPDATE]</strong>\nThis looks to be the local development server problem. When I deployed to the actual GAE, my app works without problem. How can I solve this problem in the local development server?</p>\n"}, {"tags": ["go", "client", "kubernetes"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1496000279, "post_id": 44194842, "comment_id": 75472377, "body": "This other client looks pretty good <a href=\"https://godoc.org/bitbucket.org/amdatulabs/amdatu-kubernetes-go/client#Client.WatchPodsWithLabel\" rel=\"nofollow noreferrer\">godoc.org/bitbucket.org/amdatulabs/amdatu-kubernetes-go/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 164, "user_id": 5001345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ec5b08273299a474cf709353d289f0f?s=128&d=identicon&r=PG&f=1", "display_name": "Iris Ding", "link": "https://stackoverflow.com/users/5001345/iris-ding"}, "edited": false, "score": 0, "creation_date": 1496218043, "post_id": 44200791, "comment_id": 75565139, "body": "Thanks for this info. However I want to get all types of events for the kube clusters. Is there any sample for using kube event api?"}, {"owner": {"reputation": 1015, "user_id": 1773216, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/cvbyd.jpg?s=128&g=1", "display_name": "nmurthy", "link": "https://stackoverflow.com/users/1773216/nmurthy"}, "edited": false, "score": 0, "creation_date": 1502647739, "post_id": 44200791, "comment_id": 78284424, "body": "This does not build as <code>k8s.io&#47;kubernetes&#47;pkg</code> appears to have been significantly refactored. Do you have a work around with updated dependencies that compiles?"}, {"owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "reply_to_user": {"reputation": 1015, "user_id": 1773216, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/cvbyd.jpg?s=128&g=1", "display_name": "nmurthy", "link": "https://stackoverflow.com/users/1773216/nmurthy"}, "edited": false, "score": 0, "creation_date": 1502696673, "post_id": 44200791, "comment_id": 78296608, "body": "@nmurthy, no, I haven&#39;t done anything similar recently."}], "tags": [], "owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "is_accepted": false, "score": 0, "last_activity_date": 1495799067, "creation_date": 1495799067, "answer_id": 44200791, "question_id": 44194842, "link": "https://stackoverflow.com/questions/44194842/how-to-watch-kubernetes-event-details-using-its-go-client/44200791#44200791", "title": "How to watch kubernetes event details using it&#39;s go client?", "body": "<p>Use the <a href=\"https://github.com/kubernetes/client-go/blob/450baa5d60f8d6a251c7682cb6f86e939b750b2d/tools/cache/controller.go#L276\" rel=\"nofollow noreferrer\"><code>NewInformer()</code></a> function to create a notifications for specific type events.</p>\n\n<p>Here is a minimum example (<a href=\"https://solinea.com/blog/tapping-kubernetes-events\" rel=\"nofollow noreferrer\">source</a>):</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n\n    \"k8s.io/kubernetes/pkg/api\"\n    \"k8s.io/kubernetes/pkg/client/cache\"\n    \"k8s.io/kubernetes/pkg/client/restclient\"\n    client \"k8s.io/kubernetes/pkg/client/unversioned\"\n    \"k8s.io/kubernetes/pkg/fields\"\n    \"k8s.io/kubernetes/pkg/util/wait\"\n)\n\nfunc podCreated(obj interface{}) {\n    pod := obj.(*api.Pod)\n    fmt.Println(\"Pod created: \" + pod.ObjectMeta.Name)\n}\nfunc podDeleted(obj interface{}) {\n    pod := obj.(*api.Pod)\n    fmt.Println(\"Pod deleted: \" + pod.ObjectMeta.Name)\n}\nfunc watchPods(client *client.Client, store cache.Store) cache.Store {\n    //Define what we want to look for (Pods)\n    watchlist := cache.NewListWatchFromClient(client, \"pods\", api.NamespaceAll, fields.Everything())\n    resyncPeriod := 30 * time.Minute\n    //Setup an informer to call functions when the watchlist changes\n    eStore, eController := framework.NewInformer(\n        watchlist,\n        &amp;api.Pod{},\n        resyncPeriod,\n        framework.ResourceEventHandlerFuncs{\n            AddFunc:    podCreated,\n            DeleteFunc: podDeleted,\n        },\n    )\n    //Run the controller as a goroutine\n    go eController.Run(wait.NeverStop)\n    return eStore\n}\nfunc main() {\n    //Configure cluster info\n    config := &amp;amp\n    restclient.Config{\n        Host:     \"https://xxx.yyy.zzz:443\",\n        Username: \"kube\",\n        Password: \"supersecretpw\",\n        Insecure: true,\n    }\n    //Create a new client to interact with cluster and freak if it doesn't work\n    kubeClient, err := client.New(config)\n    if err != nil {\n        log.Fatalln(\"Client not created sucessfully:\", err)\n    }\n    //Create a cache to store Pods\n    var podsStore cache.Store\n    //Watch for Pods\n    podsStore = watchPods(kubeClient, podsStore)\n    //Keep alive\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n"}], "owner": {"reputation": 164, "user_id": 5001345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ec5b08273299a474cf709353d289f0f?s=128&d=identicon&r=PG&f=1", "display_name": "Iris Ding", "link": "https://stackoverflow.com/users/5001345/iris-ding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4485, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1563362077, "creation_date": 1495779362, "last_edit_date": 1495783331, "question_id": 44194842, "link": "https://stackoverflow.com/questions/44194842/how-to-watch-kubernetes-event-details-using-its-go-client", "title": "How to watch kubernetes event details using it&#39;s go client?", "body": "<p>In kubernetes dashboard, you can view events for a namespace: eg\"\npulling image \"hello-world\",Successfully pulled image \"hello-world\",etc. </p>\n\n<p>Is there a way to get all these events using the it's go client?</p>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1495768124, "post_id": 44192689, "comment_id": 75399651, "body": "Figuring out if anyone has a shared folder open might depend on how that folder is shared. How is it shared?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1495772969, "post_id": 44192689, "comment_id": 75400743, "body": "More to what @Schwern said, one must keep in mind that all operations related to filesystems (including networked) are inherently prone to races: by the time you figured out your folder is not open by anyone, it well may be already open."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1495773146, "post_id": 44192689, "comment_id": 75400805, "body": "If you&#39;re talking about Windows and its SMB (CIFS) protocol then you can use the WMI layer to ask the server about what its shares it has open by users. I guess there were packages to work with WMI; as a last resort, working with Win32 API calls in Go is relatively straightforward."}, {"owner": {"reputation": 23, "user_id": 4330232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKPzj.jpg?s=128&g=1", "display_name": "DCantacesso", "link": "https://stackoverflow.com/users/4330232/dcantacesso"}, "edited": false, "score": 0, "creation_date": 1495809526, "post_id": 44192689, "comment_id": 75421127, "body": "This is just a standard windows network share.  &quot;Everyone&quot; has full control"}, {"owner": {"reputation": 23, "user_id": 4330232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKPzj.jpg?s=128&g=1", "display_name": "DCantacesso", "link": "https://stackoverflow.com/users/4330232/dcantacesso"}, "edited": false, "score": 0, "creation_date": 1495850012, "post_id": 44192689, "comment_id": 75436517, "body": "Thanks everyone, I actually was able to call psfile,exe with go.command"}, {"owner": {"reputation": 23, "user_id": 4330232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKPzj.jpg?s=128&g=1", "display_name": "DCantacesso", "link": "https://stackoverflow.com/users/4330232/dcantacesso"}, "edited": false, "score": 0, "creation_date": 1495850057, "post_id": 44192689, "comment_id": 75436526, "body": "cmd := exec.Command(<code>psfile</code>, serverName, localPath, &quot;-c&quot;) err := cmd.Start() //error handling"}], "owner": {"reputation": 23, "user_id": 4330232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKPzj.jpg?s=128&g=1", "display_name": "DCantacesso", "link": "https://stackoverflow.com/users/4330232/dcantacesso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1495772820, "creation_date": 1495765930, "last_edit_date": 1495772820, "question_id": 44192689, "link": "https://stackoverflow.com/questions/44192689/closing-a-foreign-network-shared-folder-session", "title": "Closing a foreign network shared folder session", "body": "<p>I'm fairly new to programming and I am learning with Go.  I want to rename a shared folder on my network, which I can do, but before doing so I want to ensure that no one has it open.  If anyone has the folder open I want to be able to close that session in my Go program. I combed through the Go packages and wasn't able to find anything.  Is it even possible with Go or will I need to call some plugin from my program?  Thanks!</p>\n"}]