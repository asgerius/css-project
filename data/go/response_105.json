[{"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1484177115, "post_id": 41602230, "comment_id": 70407703, "body": "No, Go is not Scala. How is <code>s take n</code> &quot;cleaner&quot; than <code>firstN(s, n)</code>?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1484178409, "post_id": 41602230, "comment_id": 70408125, "body": "When you say char, do you mean byte or rune? The code in the question looks good to me if the goal is to return the first N bytes.  A loop is required to return the first N runes."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7352105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/daTqY.jpg?s=128&g=1", "display_name": "mariolasagna", "link": "https://stackoverflow.com/users/7352105/mariolasagna"}, "is_accepted": false, "score": -4, "last_activity_date": 1484176478, "creation_date": 1484176478, "answer_id": 41602499, "question_id": 41602230, "link": "https://stackoverflow.com/questions/41602230/return-first-n-chars-of-a-string/41602499#41602499", "title": "Return first n chars of a string", "body": "<p>That looks pretty clean for me. I would do the same thing.</p>\n"}, {"tags": [], "owner": {"reputation": 1837, "user_id": 381849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d44bcf5700e4fcb934221db2dab496?s=128&d=identicon&r=PG", "display_name": "KAdot", "link": "https://stackoverflow.com/users/381849/kadot"}, "is_accepted": false, "score": 2, "last_activity_date": 1484279993, "last_edit_date": 1484279993, "creation_date": 1484190909, "answer_id": 41604514, "question_id": 41602230, "link": "https://stackoverflow.com/questions/41602230/return-first-n-chars-of-a-string/41604514#41604514", "title": "Return first n chars of a string", "body": "<p>Your code is fine unless you want to work with unicode:</p>\n\n<pre><code>fmt.Println(firstN(\"\u4e16\u754c Hello\", 1)) // \ufffd\n</code></pre>\n\n<p>To make it work with unicode you can modify the function in the following way:</p>\n\n<pre><code>// allocation free version\nfunc firstN(s string, n int) string {\n    i := 0\n    for j := range s {\n        if i == n {\n            return s[:j]\n        }\n        i++\n    }\n    return s\n}\nfmt.Println(firstN(\"\u4e16\u754c Hello\", 1)) // \u4e16\n\n// you can also convert a string to a slice of runes, but it will require additional memory allocations\nfunc firstN2(s string, n int) string {\n    r := []rune(s)\n    if len(r) &gt; n {\n        return string(r[:n])\n    }\n    return s\n}\nfmt.Println(firstN2(\"\u4e16\u754c Hello\", 1)) // \u4e16\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 8764773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uS6qnYd1HqQ/AAAAAAAAAAI/AAAAAAAAABA/J5y-sPWjotc/photo.jpg?sz=128", "display_name": "Maria Efimenko", "link": "https://stackoverflow.com/users/8764773/maria-efimenko"}, "edited": false, "score": 1, "creation_date": 1616659679, "post_id": 63370957, "comment_id": 118073390, "body": "I wouldn&#39;t do that if I were you) if college consisted of 2 symbols, your code would panic."}, {"owner": {"reputation": 1491, "user_id": 6696684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0ATU9.jpg?s=128&g=1", "display_name": "Sumer", "link": "https://stackoverflow.com/users/6696684/sumer"}, "reply_to_user": {"reputation": 51, "user_id": 8764773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uS6qnYd1HqQ/AAAAAAAAAAI/AAAAAAAAABA/J5y-sPWjotc/photo.jpg?sz=128", "display_name": "Maria Efimenko", "link": "https://stackoverflow.com/users/8764773/maria-efimenko"}, "edited": false, "score": 0, "creation_date": 1616818708, "post_id": 63370957, "comment_id": 118129299, "body": "Agree @MariaEfimenko , better to put checks comparing length of string and max bound"}], "tags": [], "owner": {"reputation": 1491, "user_id": 6696684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0ATU9.jpg?s=128&g=1", "display_name": "Sumer", "link": "https://stackoverflow.com/users/6696684/sumer"}, "is_accepted": false, "score": 1, "last_activity_date": 1609533413, "last_edit_date": 1609533413, "creation_date": 1597213541, "answer_id": 63370957, "question_id": 41602230, "link": "https://stackoverflow.com/questions/41602230/return-first-n-chars-of-a-string/63370957#63370957", "title": "Return first n chars of a string", "body": "<pre><code>  college := &quot;ARMY INSTITUTE OF TECHNOLOGY PUNE&quot;\n  fmt.Println(college)\n \n  name :=  college[0:4]\n  fmt.Println(name)\n</code></pre>\n"}], "owner": {"reputation": 894, "user_id": 6078917, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/HRZj4.jpg?s=128&g=1", "display_name": "ryan", "link": "https://stackoverflow.com/users/6078917/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3853, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1609533413, "creation_date": 1484175302, "question_id": 41602230, "link": "https://stackoverflow.com/questions/41602230/return-first-n-chars-of-a-string", "title": "Return first n chars of a string", "body": "<p>What is the best way to return first n chars as substring of a string, when there isn't n chars in the string, just return the string itself.</p>\n\n<p>I can do the following:</p>\n\n<pre><code>func firstN(s string, n int) string {\n     if len(s) &gt; n {\n          return s[:n]\n     }\n     return s\n}\n</code></pre>\n\n<p>but is there a cleaner way?</p>\n\n<p>BTW, in Scala, I can just do <code>s take n</code>.</p>\n"}, {"tags": ["go", "config"], "answers": [{"comments": [{"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 2, "creation_date": 1484182639, "post_id": 41599443, "comment_id": 70409279, "body": "It would be really cool if you added a little example of how the implementation works."}], "tags": [], "owner": {"reputation": 391, "user_id": 3417424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d24e88f34a0b011d6372be3f78b924?s=128&d=identicon&r=PG", "display_name": "Kare Nuorteva", "link": "https://stackoverflow.com/users/3417424/kare-nuorteva"}, "is_accepted": false, "score": 1, "last_activity_date": 1484249086, "last_edit_date": 1484249086, "creation_date": 1484163936, "answer_id": 41599443, "question_id": 41599244, "link": "https://stackoverflow.com/questions/41599244/can-i-add-commands-with-go-flags/41599443#41599443", "title": "Can I add commands with Go flags?", "body": "<p>Yes, you can.</p>\n\n<p>Take a look at <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/flag/</a> for FlagSet documentation.</p>\n\n<p>And for a working example: <a href=\"https://github.com/constabulary/gb/blob/master/cmd/gb/main.go\" rel=\"nofollow noreferrer\">https://github.com/constabulary/gb/blob/master/cmd/gb/main.go</a></p>\n\n<p>And an example as requested by miltonb:</p>\n\n<pre><code>% go run flagset.go init --filename=foo.json foo bar\ninit foo.json [foo bar]\n% go run flagset.go check --filename=bar.json 1 2 3\ncheck bar.json [1 2 3]\n% go run flagset.go run\nrun\n% cat flagset.go\npackage main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    init := flag.NewFlagSet(\"init\", flag.ExitOnError)\n    initFile := init.String(\"filename\", \"myconfig.json\", \"configuration file\")\n\n    check := flag.NewFlagSet(\"check\", flag.ExitOnError)\n    checkFile := check.String(\"filename\", \"myconfig.json\", \"configuration file\")\n\n    if len(os.Args) &lt;= 1 {\n        flag.Usage()\n        os.Exit(1)\n    }\n\n    switch os.Args[1] {\n    case \"init\":\n        if err := init.Parse(os.Args[2:]); err == nil {\n            fmt.Println(\"init\", *initFile, init.Args())\n        }\n    case \"check\":\n        if err := check.Parse(os.Args[2:]); err == nil {\n            fmt.Println(\"check\", *checkFile, check.Args())\n        }\n    case \"run\":\n        fmt.Println(\"run\")\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1484205613, "post_id": 41605704, "comment_id": 70416199, "body": "Note that there are reserved flags you cannot overwrite.  If I recall, &quot;build&quot; and &quot;help&quot; are two such flags.  &quot;Run&quot; may be another one."}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": false, "score": 1, "last_activity_date": 1484217338, "last_edit_date": 1495535364, "creation_date": 1484198813, "answer_id": 41605704, "question_id": 41599244, "link": "https://stackoverflow.com/questions/41599244/can-i-add-commands-with-go-flags/41605704#41605704", "title": "Can I add commands with Go flags?", "body": "<p>You can do that using a combination of <a href=\"https://gobyexample.com/command-line-arguments\" rel=\"nofollow noreferrer\">command line arguments</a> and <a href=\"https://gobyexample.com/command-line-flags\" rel=\"nofollow noreferrer\">flags</a>.</p>\n\n<p>Eg.</p>\n\n<pre><code>configFilePtr := flag.String(\"filename\", \"\", \"Config Filename\")\nflag.Parse()\n\nn := len(os.Args)\nif n &gt; 1 {\n    switch os.Args[1] {\n        case \"init\":\n            initApp(*configFilePtr)\n        case \"check\":\n            checkApp(*configFilePtr)\n        case \"run\":\n            runApp()\n    }\n}\n</code></pre>\n\n<p>Another option is using something like <a href=\"https://github.com/spf13/cobra\" rel=\"nofollow noreferrer\"><code>spf13's cobra</code></a>.</p>\n\n<p>Update :</p>\n\n<p>If you require the use of different flags as per command you can use a <a href=\"https://golang.org/pkg/flag/#FlagSet\" rel=\"nofollow noreferrer\">FlagSet</a> as mentioned in <code>Kare Nuorteva</code>'s answer.</p>\n\n<p>Eg.</p>\n\n<pre><code>f1 := flag.NewFlagSet(\"f1\", flag.ContinueOnError)\nsilent := f1.Bool(\"silent\", false, \"\")\nf2 := flag.NewFlagSet(\"f2\", flag.ContinueOnError)\nloud := f2.Bool(\"loud\", false, \"\")\n\nswitch os.Args[1] {\n  case \"apply\":\n    if err := f1.Parse(os.Args[2:]); err == nil {\n      fmt.Println(\"apply\", *silent)\n    }\n  case \"reset\":\n    if err := f2.Parse(os.Args[2:]); err == nil {\n      fmt.Println(\"reset\", *loud)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/24510031/2285935\">Reference</a></p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1484249086, "creation_date": 1484163176, "last_edit_date": 1484164092, "question_id": 41599244, "link": "https://stackoverflow.com/questions/41599244/can-i-add-commands-with-go-flags", "title": "Can I add commands with Go flags?", "body": "<p>I know I can define flags like this:</p>\n\n<pre><code>initPtr := flag.String(\"init\", \"config.json\", \"Initialize with config filename\")\n</code></pre>\n\n<p>Which I will call like this:</p>\n\n<pre><code>myapp --init=myconfig.json\n</code></pre>\n\n<p>I wonder though if I can define something like commands so that to call the app like this?</p>\n\n<pre><code>myapp init --filename=myconfig.json\nmyapp check --filename=myconfig.json\nmyapp run\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 1338765, "user_type": "registered", "accept_rate": 8, "profile_image": "https://graph.facebook.com/520538811/picture?type=large", "display_name": "asaf000", "link": "https://stackoverflow.com/users/1338765/asaf000"}, "edited": false, "score": 0, "creation_date": 1484162337, "post_id": 41598811, "comment_id": 70400651, "body": "thanks, still can&#39;t change map&#39;s content though ? <a href=\"https://play.golang.org/p/wXbVdcykZf\" rel=\"nofollow noreferrer\">play.golang.org/p/wXbVdcykZf</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 586, "user_id": 1338765, "user_type": "registered", "accept_rate": 8, "profile_image": "https://graph.facebook.com/520538811/picture?type=large", "display_name": "asaf000", "link": "https://stackoverflow.com/users/1338765/asaf000"}, "edited": false, "score": 0, "creation_date": 1484162741, "post_id": 41598811, "comment_id": 70400880, "body": "@asaf000: if you want to modify <code>aa</code>, then you need to set it&#39;s value. <code>aa</code> is nil, so there&#39;s nothing there to modify.  <a href=\"https://play.golang.org/p/XWcx5gDPu7\" rel=\"nofollow noreferrer\">play.golang.org/p/XWcx5gDPu7</a>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1484163006, "last_edit_date": 1484163006, "creation_date": 1484161652, "answer_id": 41598811, "question_id": 41598695, "link": "https://stackoverflow.com/questions/41598695/creating-then-modifying-a-map-by-reflection/41598811#41598811", "title": "Creating then modifying a map by reflection", "body": "<p>Go maps (and slices) are created via <code>make</code>. The equivalent function in <code>reflect</code> is <a href=\"https://golang.org/pkg/reflect/#MakeMap\" rel=\"nofollow noreferrer\"><code>reflect.MakeMap</code></a></p>\n\n<pre><code>out := reflect.ValueOf(&amp;aa).Elem()\nout.Set(reflect.MakeMap(out.Type()))\ns := out.Interface().(Setter)\ns.Set()\n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 1338765, "user_type": "registered", "accept_rate": 8, "profile_image": "https://graph.facebook.com/520538811/picture?type=large", "display_name": "asaf000", "link": "https://stackoverflow.com/users/1338765/asaf000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1338, "favorite_count": 0, "accepted_answer_id": 41598811, "answer_count": 1, "score": 0, "last_activity_date": 1484163006, "creation_date": 1484161281, "question_id": 41598695, "link": "https://stackoverflow.com/questions/41598695/creating-then-modifying-a-map-by-reflection", "title": "Creating then modifying a map by reflection", "body": "<p>I have a new type derived from map such:</p>\n\n<pre><code>type mapp map[string]interface{}\n</code></pre>\n\n<p>with a small function on it</p>\n\n<pre><code>func (c mapp) Set() error {\n    // c is nil\n    c[\"a\"] = \"b\"\n    return nil\n}\n\ntype Setter interface {\n  Set() error\n}\n\nfunc main() {\n    var aa mapp\n    out := reflect.ValueOf(&amp;aa)\n    s := out.Interface().(Setter)\n    s.Set()\n}\n</code></pre>\n\n<p>This code works on a struct, why this code fails when it comes to a type of a map?</p>\n\n<p>Here's a playground: <a href=\"https://play.golang.org/p/Z1LFqb6kF7\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Z1LFqb6kF7</a></p>\n\n<p>Many thanks,</p>\n\n<p>Asaf.</p>\n"}, {"tags": ["go", "gif"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484234462, "post_id": 41598238, "comment_id": 70434870, "body": "What do you mean by &quot;corrupted&quot;? What version of Go are you using? Can you provide a sample of a file that doesn&#39;t work?"}, {"owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484237227, "post_id": 41598238, "comment_id": 70437003, "body": "I have editted the question"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484237536, "post_id": 41598238, "comment_id": 70437238, "body": "Are you certain that this is the <i>exact</i> code and image you&#39;re using? The image you provided is 9.2MB, not 3.4. This should work correctly with go1.7 and go1.8. (side note, always check the error <i>before</i> deferring a Close, or you can get panics)"}, {"owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484237813, "post_id": 41598238, "comment_id": 70437439, "body": "Damn I was checking a lot of gifs and must have overwritten the one i mentioned earlier. But this one does not work as well. I will try to find the old gif. 100\u2105 sure it is the same code"}, {"owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484237999, "post_id": 41598238, "comment_id": 70437575, "body": "Should be this one: <a href=\"http://vader.joemonster.org/upload/rwu/1539970c1d48acceLw7m.gif\" rel=\"nofollow noreferrer\">vader.joemonster.org/upload/rwu/1539970c1d48acceLw7m.gif</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1484239597, "post_id": 41598238, "comment_id": 70438638, "body": "This gif is <i>technically</i> corrupt to start (LZW string table overflow), which is likely what&#39;s causing problems. Most decoders ignore this, but some will error out. Having Go decode and encode the gif however seems to &quot;fix&quot; this issue, so I&#39;m note sure what problem you&#39;re seeing. As for the size discrepancy, it&#39;s a different encoder, so the size isn&#39;t guaranteed to be exactly the same."}, {"owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484239811, "post_id": 41598238, "comment_id": 70438776, "body": "So my code does produce a correct, readable GIF on your pc?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484240154, "post_id": 41598238, "comment_id": 70439040, "body": "yes, with go1.7 and go1.8, but only on amd64. Not sure if i386 causes the overflow to be handled differently."}, {"owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484243479, "post_id": 41598238, "comment_id": 70440978, "body": "Well, I&#39;ve just discovered that the problem here is Ubuntu&#39;s default image viewer. Chrome/Firefox deal with those GIFs just fine. Thank you very much for your time. Now I need to read more about this whole GIF encoding, because I wonder what caused the image viewer to malfunction. Is it encoding used by Go ?"}], "answers": [{"comments": [{"owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "edited": false, "score": 1, "creation_date": 1484207197, "post_id": 41603572, "comment_id": 70416960, "body": "According to this : <a href=\"http://stackoverflow.com/questions/25677235/golang-create-a-io-reader-from-a-local-file\" title=\"golang create a io reader from a local file\">stackoverflow.com/questions/25677235/&hellip;</a> os.Open returns and io.Reader. (otherwise it would not compile I think ? ) Moreover i changed the code to your version and it still produces a corrupted gif. Thanks for help though !"}, {"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "reply_to_user": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "edited": false, "score": 0, "creation_date": 1484208511, "post_id": 41603572, "comment_id": 70417602, "body": "Cheers. You could be right.  I did try with a gif I had around on my PC and it did read and write back a valid gif.  But I did not test your origional code which was a mistake in hind-sight.  However - it leads me to wonder if there is something at play outside of your code, like a corrupt origional Gif?"}, {"owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "edited": false, "score": 0, "creation_date": 1484208793, "post_id": 41603572, "comment_id": 70417751, "body": "I thought about it as well, but I tried a couple of GIFs and every one of them gave a corrupted result ."}], "tags": [], "owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "is_accepted": false, "score": 0, "last_activity_date": 1484186159, "last_edit_date": 1484186159, "creation_date": 1484183712, "answer_id": 41603572, "question_id": 41598238, "link": "https://stackoverflow.com/questions/41598238/encoding-decoding-a-gif/41603572#41603572", "title": "Encoding/Decoding a Gif", "body": "<p>The problem is you are passing a <code>File*</code> to <code>DecodeAll</code> rather than something that supports the <code>io.Reader</code> interface.</p>\n\n<p>I have adapted your code so that it creates a <code>bufio.Reader</code> from the file and then hands that to <code>DecodeAll</code> as below:</p>\n\n<pre><code>import (\n    \"bufio\"\n    \"os\"\n    \"image/gif\"\n)\nfunc main() {\n    inputFile , err := os.Open(\"travolta.gif\")\n    defer inputFile.Close()\n    if err != nil {\n        panic(err)\n    }\n\n    r := bufio.NewReader(inputFile)\n\n    g, err := gif.DecodeAll(r)\n    if err != nil {\n        panic(err)\n    }\n\n    // ... remaining code\n}\n</code></pre>\n"}], "owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1439, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1491976742, "creation_date": 1484159689, "last_edit_date": 1491976742, "question_id": 41598238, "link": "https://stackoverflow.com/questions/41598238/encoding-decoding-a-gif", "title": "Encoding/Decoding a Gif", "body": "<p>I will be working on a project connected with GIF images and I tried to do some basic operations on them in Go (such as retrieving frames or creating GIF from a bunch of images). But for now let's do a  simple example in which I am only trying to decode a GIF and then to encode it again. I tried to use <code>\"image/gif\"</code> package, but I am unable to get it to do what I want.<br>\nHere is the code :</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"image/gif\"\n)\n\n\nfunc main() {\n    inputFile , err := os.Open(\"travolta.gif\")\n    defer inputFile.Close()\n    if err != nil {\n        panic(err)\n    }\n\n    g, err := gif.DecodeAll(inputFile)\n    if err != nil {\n        panic(err)\n    }\n\n    outputFile, err := os.OpenFile(\"travolta2.gif\", os.O_WRONLY|os.O_CREATE, 0777)\n    defer outputFile.Close()\n    if err != nil {\n        panic(err)\n    }\n\n    err = gif.EncodeAll(outputFile, g)\n    if err != nil {\n        panic(err)\n    }\n} \n</code></pre>\n\n<p>When I run the code it does not panic and another gif is indeed created. Unfortunetely it is corrupted. Moreover the gif's size changes from 3,4MB to 4,4MB. Is it not a way to save/read a gif? What mistake do I make? </p>\n\n<p><strong>EDIT:</strong>\nBy corrupted I mean that when I try to open it an error occurs- screnshot here : <a href=\"http://www.filedropper.com/obrazekpociety\" rel=\"nofollow noreferrer\">http://www.filedropper.com/obrazekpociety</a>.  </p>\n\n<p>GIF: \n<a href=\"http://vader.joemonster.org/upload/rwu/1539970c1d48acceLw7m.gif\" rel=\"nofollow noreferrer\">http://vader.joemonster.org/upload/rwu/1539970c1d48acceLw7m.gif</a></p>\n\n<p>Go version 1.7.4</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1484159234, "post_id": 41598062, "comment_id": 70398939, "body": "Go uses <a href=\"https://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"nofollow noreferrer\"><code>append</code></a> to <i>append</i> to a slice. Is that what you&#39;re looking for?"}, {"owner": {"reputation": 573, "user_id": 1623984, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12naH.jpg?s=128&g=1", "display_name": "ThatsAMorais", "link": "https://stackoverflow.com/users/1623984/thatsamorais"}, "edited": false, "score": 0, "creation_date": 1524845077, "post_id": 41598062, "comment_id": 87149059, "body": "This question, which is actually basic Go, would benefit from a more concise code black that consists of only your attempt to append to a slice in a loop. The answer could then be something much simpler. The details about opening files are unrelated to the question as stated."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 6761708, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a2b1133a4ead92c41c860b248c59332?s=128&d=identicon&r=PG&f=1", "display_name": "Arkham Angel", "link": "https://stackoverflow.com/users/6761708/arkham-angel"}, "edited": false, "score": 0, "creation_date": 1484166636, "post_id": 41598307, "comment_id": 70403036, "body": "I have a idea here of what you&#39;ve done.  I assume now that I can work with fileList in a while or a for each loop to pull each string out and do something with them.  I would like a reference (for dummies like me) document or an example if you would be so kind."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 111, "user_id": 6761708, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a2b1133a4ead92c41c860b248c59332?s=128&d=identicon&r=PG&f=1", "display_name": "Arkham Angel", "link": "https://stackoverflow.com/users/6761708/arkham-angel"}, "edited": false, "score": 3, "creation_date": 1484174597, "post_id": 41598307, "comment_id": 70406815, "body": "@ArkhamAngel: The best reference is the <a href=\"https://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"nofollow noreferrer\">documentation on appending slices</a>, or even the <a href=\"https://golang.org/doc/effective_go.html#append\" rel=\"nofollow noreferrer\">append section of Effective Go</a>. I would encourage you to go through the <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">Tour Of Go</a>, which cover all these basic Go concepts."}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "edited": false, "score": 1, "creation_date": 1484176676, "post_id": 41598307, "comment_id": 70407552, "body": "Here is an additional resource on <a href=\"http://www.golangbootcamp.com/book/collection_types#uid67\" rel=\"nofollow noreferrer\">appending to a slice</a> for your reference"}], "tags": [], "owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "is_accepted": true, "score": 2, "last_activity_date": 1484159939, "creation_date": 1484159939, "answer_id": 41598307, "question_id": 41598062, "link": "https://stackoverflow.com/questions/41598062/in-golang-how-to-add-results-from-a-loop-into-a-dynamic-array-of-unknown-size/41598307#41598307", "title": "In Golang, how to add results from a loop into a dynamic array of unknown size?", "body": "<p>I tweaked your code so that it will put each filename into a slice of strings and then print the slice at the end. Also, keep in mind that you already have a file list in the 'files' variable.</p>\n\n<pre><code>package main\n\nimport (\n  \"bufio\"\n  \"fmt\"\n  \"os\"\n  \"path/filepath\"\n  //\"bytes\"\n  //\"io/ioutil\"\n)\n\nfunc main() {\n\n  lineScan := bufio.NewScanner(os.Stdin)\n  var inputText string\n\n  fmt.Print(\"Enter file extension to search for: .extension \\n\")\n  lineScan.Scan()\n  inputText = lineScan.Text()\n\n  dirname := \".\" + string(filepath.Separator)\n\n  d, err := os.Open(dirname)\n  if err != nil {\n    fmt.Println(err)\n    os.Exit(1)\n  }\n  defer d.Close()\n\n  files, err := d.Readdir(-1)\n  if err != nil {\n    fmt.Println(err)\n    os.Exit(1)\n  }\n\n  fileList := make([]string, 0)\n  for _, file := range files { \n    if file.Mode().IsRegular() {\n\n      if filepath.Ext(file.Name()) == inputText {\n\n        fmt.Println(file.Name())\n        fileList = append(fileList, file.Name())\n      }\n    }\n  }\n\n  fmt.Println(\"File List: \", fileList)\n}\n</code></pre>\n\n<p>I hope this works for you.</p>\n"}], "owner": {"reputation": 111, "user_id": 6761708, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a2b1133a4ead92c41c860b248c59332?s=128&d=identicon&r=PG&f=1", "display_name": "Arkham Angel", "link": "https://stackoverflow.com/users/6761708/arkham-angel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2886, "favorite_count": 0, "accepted_answer_id": 41598307, "answer_count": 1, "score": 0, "last_activity_date": 1484237615, "creation_date": 1484159130, "last_edit_date": 1484237615, "question_id": 41598062, "link": "https://stackoverflow.com/questions/41598062/in-golang-how-to-add-results-from-a-loop-into-a-dynamic-array-of-unknown-size", "title": "In Golang, how to add results from a loop into a dynamic array of unknown size?", "body": "<p>The example I'm working with right now takes input from console asking for a file extension, say .txt .  It searches the current directory for files and then does a Println which returns all the files with the .txt onto the screen.  </p>\n\n<p><strong>For each result returned, how can I put each filename into an array (or a slice?) and then access each value later in the program to manipulate each file.</strong>  </p>\n\n<p>It doesn't need to be sequential.  </p>\n\n<p>This is the working code (modified from Adam Ng, I think)</p>\n\n<pre><code>     package main\n\n  import (\n      \"fmt\"\n      \"os\"\n      \"path/filepath\"\n    \"bufio\"\n    //\"bytes\"\n    //\"io/ioutil\"\n\n  )\n\n  func main() {\n\n\n    lineScan := bufio.NewScanner(os.Stdin)\n    var inputText string\n\n    fmt.Print(\"Enter file extension to search for: .extension \\n\")     \n    lineScan.Scan()\n    inputText = lineScan.Text()\n\n      dirname := \".\" + string(filepath.Separator)\n\n      d, err := os.Open(dirname)\n      if err != nil {\n          fmt.Println(err)\n          os.Exit(1)\n      }\n      defer d.Close()\n\n      files, err := d.Readdir(-1)\n      if err != nil {\n          fmt.Println(err)\n          os.Exit(1)\n      }\n\n      for _, file := range files {\n          if file.Mode().IsRegular() {\n\n              if filepath.Ext(file.Name()) == inputText {\n\n                fmt.Println(file.Name())\n              }\n          }\n      }\n  }\n</code></pre>\n"}, {"tags": ["security", "go"], "comments": [{"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "edited": false, "score": 1, "creation_date": 1484156529, "post_id": 41597321, "comment_id": 70397492, "body": "Ok, and what code made you get that, and what did you expect to get?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1484156616, "post_id": 41597321, "comment_id": 70397556, "body": "The output is the hexadecimal representation of the ascii character values that comprise the string (f = 66, q = 71 ...).  This is unanswerable without more detail."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484156630, "post_id": 41597321, "comment_id": 70397563, "body": "What exactly is the problem?"}, {"owner": {"reputation": 19, "user_id": 7206599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e73e559f95801374b61c50ee7bbd17a6?s=128&d=identicon&r=PG&f=1", "display_name": "Santiago Uma&#241;a Villada", "link": "https://stackoverflow.com/users/7206599/santiago-uma%c3%b1a-villada"}, "edited": false, "score": 0, "creation_date": 1484158123, "post_id": 41597321, "comment_id": 70398361, "body": "I want to print that string but the output is that"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484174432, "post_id": 41597321, "comment_id": 70406743, "body": "@SantiagoUma&#241;aVillada: no, it&#39;s not: <a href=\"https://play.golang.org/p/UudsDlRNul\" rel=\"nofollow noreferrer\">play.golang.org/p/UudsDlRNul</a>.  Please show a complete example, including what you expect to happen."}], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1484193249, "creation_date": 1484193249, "answer_id": 41604845, "question_id": 41597321, "link": "https://stackoverflow.com/questions/41597321/trying-to-print-a-big-string-in-go/41604845#41604845", "title": "Trying to print a big string in go", "body": "<p>As mentioned in a comment, you just need to hex encode your string and will will match:</p>\n\n<p><a href=\"https://play.golang.org/p/p4XLYd0smZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/p4XLYd0smZ</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/hex\"\n)\n\nfunc main() {\n    salt := \"fqm0vp02103inkmvb18cgqbv0s9v7o43o12hj0nhj9jqit8nh327re7iup2imdtedepch8alam8340u4rcd923g9nuubh3a4jbdonr67phej9fp9oitudnp3dabi09nr\"\n    fmt.Println(hex.EncodeToString([]byte(salt)))\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7206599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e73e559f95801374b61c50ee7bbd17a6?s=128&d=identicon&r=PG&f=1", "display_name": "Santiago Uma&#241;a Villada", "link": "https://stackoverflow.com/users/7206599/santiago-uma%c3%b1a-villada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1484193249, "creation_date": 1484156430, "last_edit_date": 1484157025, "question_id": 41597321, "link": "https://stackoverflow.com/questions/41597321/trying-to-print-a-big-string-in-go", "title": "Trying to print a big string in go", "body": "<p>I'm trying to print a java secure integer saved in a database, this is an example:\ni have this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>salt := \"fqm0vp02103inkmvb18cgqbv0s9v7o43o12hj0nhj9jqit8nh327re7iup2imdtedepch8alam8340u4rcd923g9nuubh3a4jbdonr67phej9fp9oitudnp3dabi09nr\"\nfmt.Printf(salt)\n</code></pre>\n\n<p>this is what i got in go, but i need the string as it is in the database:</p>\n\n<pre><code>66716d3076703032313033696e6b6d76623138636771627630733976376f34336f3132686a306e686a396a716974386e6833323772653769757032696d647465646570636838616c616d38333430753472636439323367396e757562683361346a62646f6e7236377068656a396670396f697475646e70336461626930396e72\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484156444, "post_id": 41596936, "comment_id": 70397435, "body": "The <code>src&#47;</code> directory in GOPATH is where all go packages are found. That&#39;s how the <code>go</code> tool works. You can add multiple entries to GOPATH if you want, but that will only complicate your environment for little benefit. <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How To Write Go Code</a>"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 1532153, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1BkQR.jpg?s=128&g=1", "display_name": "Lafriakh", "link": "https://stackoverflow.com/users/1532153/lafriakh"}, "is_accepted": true, "score": 0, "last_activity_date": 1484342018, "creation_date": 1484342018, "answer_id": 41643522, "question_id": 41596936, "link": "https://stackoverflow.com/questions/41596936/golang-downloaded-packages-outside-of-src-folder/41643522#41643522", "title": "golang downloaded packages outside of src folder", "body": "<p>The solution of my problem, is to create a vendor folder in your project directory,like so:</p>\n\n<pre><code>src:\n  - vendor:\n    - packages...\n</code></pre>\n\n<p>its like an npm or any package manager.</p>\n\n<p>there also tools like:\n<a href=\"https://github.com/govend/govend\" rel=\"nofollow noreferrer\">govend</a> and trash.</p>\n"}], "owner": {"reputation": 46, "user_id": 1532153, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1BkQR.jpg?s=128&g=1", "display_name": "Lafriakh", "link": "https://stackoverflow.com/users/1532153/lafriakh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "accepted_answer_id": 41643522, "answer_count": 1, "score": 0, "last_activity_date": 1484342018, "creation_date": 1484155247, "question_id": 41596936, "link": "https://stackoverflow.com/questions/41596936/golang-downloaded-packages-outside-of-src-folder", "title": "golang downloaded packages outside of src folder", "body": "<p>When i install package like this:</p>\n\n<pre><code>go get github.com/go-zoo/bone\n</code></pre>\n\n<p>it's create a folder in src folder like this:</p>\n\n<pre><code>src/github.com/go-zoo/bone\n</code></pre>\n\n<p>I want to keep src folder only for my own code.</p>\n"}, {"tags": ["arrays", "go", "struct", "marshalling"], "comments": [{"owner": {"reputation": 5903, "user_id": 1387612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3ybF.png?s=128&g=1", "display_name": "janisz", "link": "https://stackoverflow.com/users/1387612/janisz"}, "edited": false, "score": 0, "creation_date": 1484154643, "post_id": 41596613, "comment_id": 70396275, "body": "Can you embed sample SubscribeRequest and how you want it to be serialised and how it differ from what you get now. Best if you can share some funable code that could be past into <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">play.golang.org</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 1257602, "user_type": "registered", "profile_image": "https://graph.facebook.com/24008286/picture?type=large", "display_name": "Derek Wall", "link": "https://stackoverflow.com/users/1257602/derek-wall"}, "edited": false, "score": 0, "creation_date": 1484158784, "post_id": 41597628, "comment_id": 70398719, "body": "That did it. Thanks for the quick response!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 0, "last_activity_date": 1484157545, "creation_date": 1484157545, "answer_id": 41597628, "question_id": 41596613, "link": "https://stackoverflow.com/questions/41596613/how-to-marshal-an-empty-struct-as-an-empty-array/41597628#41597628", "title": "How to marshal an empty struct as an empty array", "body": "<p>If you want an empty array, you have to provide an empty slice.</p>\n\n<pre><code>StatisticKey{\n    StatisticIdentifier: \"id.string\",\n    ParameterValueItems: []Parameter{},\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 1257602, "user_type": "registered", "profile_image": "https://graph.facebook.com/24008286/picture?type=large", "display_name": "Derek Wall", "link": "https://stackoverflow.com/users/1257602/derek-wall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 41597628, "answer_count": 1, "score": 1, "last_activity_date": 1484157545, "creation_date": 1484154184, "question_id": 41596613, "link": "https://stackoverflow.com/questions/41596613/how-to-marshal-an-empty-struct-as-an-empty-array", "title": "How to marshal an empty struct as an empty array", "body": "<p>I'm not sure if the title accurately explains what I'm looking to do so I'll try to give as many details as I can.</p>\n\n<p>I have a struct with nested structs that I am marshalling and sending out to an API. There are some requests that require my lowest level struct to be empty and I need its parent parameter to equal an empty array instead of null. If I use omitempty on the parameter, it will completely remove it from my request and the request will fail. If I use omitempty on the parameter's parameters, it causes the value to be null and the request will fail.</p>\n\n<p>Here are the structs I am using for the request:</p>\n\n<pre><code>// SubscribeRequest is the top level wrapper for ICWS request bodies\nSubscribeRequest struct {\n    ClientStateIsFresh bool           `json:\"clientStateIsFresh\"`\n    StatisticKeys      []StatisticKey `json:\"statisticKeys\"`\n}\n\n// StatisticKey is a value we want to pull from ICWS reporting\nStatisticKey struct {\n    StatisticIdentifier string       `json:\"statisticIdentifier\"`\n    ParameterValueItems []Parameter `json:\"parameterValueItems\"`\n}\n\n// Parameter is a filter applied when pulling statistics\nParameter struct {\n    ParameterTypeID string `json:\"parameterTypeId\"`\n    Value           string `json:\"value\"`\n}\n</code></pre>\n\n<p>And I need the marshalled JSON to look like this:</p>\n\n<pre><code>{\n    \"clientStateIsFresh\":true,\n    \"statisticKeys\":\n    [\n        {\n            \"statisticIdentifier\":\"inin.system.interaction:ActiveCalls\",\n            \"parameterValueItems\":\n            [\n\n            ]\n        }\n    ]\n}\n</code></pre>\n\n<p>If I have anything other than this, the request fails. I don't get any errors, but it doesn't return any usable data. Any suggestions on how to accomplish this? </p>\n\n<p>*Note: I did try using []*Parameter instead of []Parameter, but it gave me the same result. </p>\n"}, {"tags": ["mongodb", "go", "bson", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 344, "user_id": 1737644, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/E2Vgq.jpg?s=128&g=1", "display_name": "shful", "link": "https://stackoverflow.com/users/1737644/shful"}, "edited": false, "score": 0, "creation_date": 1484156187, "post_id": 41596169, "comment_id": 70397256, "body": "With the embedding, I see the drawback that Foo must know the CustomId requires to be inlined. Still clever, and works well."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1484156411, "last_edit_date": 1484156411, "creation_date": 1484152899, "answer_id": 41596169, "question_id": 41595577, "link": "https://stackoverflow.com/questions/41595577/enforce-a-type-mapping-with-mgo/41596169#41596169", "title": "Enforce a type mapping with mgo", "body": "<p>When you do this:</p>\n\n<pre><code>type CustomId bson.ObjectId\n</code></pre>\n\n<p>You are creating a new type and the <code>mgo</code> package will not see / recognize it as <code>bson.ObjectId</code> anymore (the type <code>bson.ObjectId</code> is \"hardcoded\" in the bson package). The new type will have 0 methods.</p>\n\n<p>I would just stick to <code>bson.ObjectId</code>. But if you still want a custom ID type, you may use embedding when creating your <code>CustomId</code>: embed a value of type <code>bson.ObjectId</code>, and use the <code>inline</code> bson flag for the <code>ID1</code> field:</p>\n\n<pre><code>type CustomId struct {\n    bson.ObjectId `bson:\"_id\"`\n}\n\ntype Foo struct {\n    ID1 CustomId      `bson:\",inline\"`\n    ID2 bson.ObjectId \n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>doc := Foo{\n    CustomId{bson.NewObjectId()},\n    bson.NewObjectId(),\n}\n</code></pre>\n\n<p>This has the advantage that <code>CustomId</code> will have all the methods <code>bson.ObjectId</code> has, and you can add new ones and \"override\" existing methods.</p>\n\n<p>Another option would be to use an interface type (e.g. <code>interface{}</code>) for your <code>CustomId</code>, using it would be a lot \"simpler\":</p>\n\n<pre><code>type CustomId interface{}\n\ntype Foo struct {\n    ID1 CustomId      `bson:\"_id\"`\n    ID2 bson.ObjectId // mapped as expected\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>doc := Foo{\n    bson.NewObjectId(),\n    bson.NewObjectId(),\n}\n</code></pre>\n\n<p>Of course, going down this road, you have to use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>, should you need to access the wrapped <code>bson.ObjectId</code> of the <code>CustomId</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1484154818, "post_id": 41596556, "comment_id": 70396378, "body": "Nice. Edited to make it compilable."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1484154779, "last_edit_date": 1484154779, "creation_date": 1484154002, "answer_id": 41596556, "question_id": 41595577, "link": "https://stackoverflow.com/questions/41595577/enforce-a-type-mapping-with-mgo/41596556#41596556", "title": "Enforce a type mapping with mgo", "body": "<p>Use the <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#Setter\" rel=\"nofollow noreferrer\">Setter</a> and <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#Getter\" rel=\"nofollow noreferrer\">Getter</a> interfaces to control the representation in mongo:</p>\n\n<pre><code>type CustomId bson.ObjectId\n\nfunc (id *CustomId) SetBSON(raw bson.Raw) error {\n   var v bson.ObjectId\n   err := raw.Unmarshal(&amp;v)\n   *id = CustomId(v)\n   return err\n}\nfunc (id CustomId) GetBSON() (interface{}, error) {\n   return bson.ObjectId(id), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 344, "user_id": 1737644, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/E2Vgq.jpg?s=128&g=1", "display_name": "shful", "link": "https://stackoverflow.com/users/1737644/shful"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 41596556, "answer_count": 2, "score": 2, "last_activity_date": 1484156411, "creation_date": 1484151061, "question_id": 41595577, "link": "https://stackoverflow.com/questions/41595577/enforce-a-type-mapping-with-mgo", "title": "Enforce a type mapping with mgo", "body": "<p>An _id member is not mapped to type ObjectId anymore, when its type is only derived from bson.ObjectId:</p>\n\n<pre><code>import (\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\ntype CustomId bson.ObjectId\n\ntype Foo struct {\n    ID1    CustomId `bson:\"_id\"` // broken\n    ID2    bson.ObjectId         // mapped as expected\n}\n\n\nfunc main() {\n    session, _ := mgo.Dial(\"127.0.0.1\")\n    coll := session.DB(\"mgodemo\").C(\"foocoll\")\n\n    doc := Foo{\n        CustomId(bson.NewObjectId()),\n        bson.NewObjectId(),\n    }\n\n    coll.Insert(doc)\n}\n</code></pre>\n\n<p>The _id should have been an <em>ObjectId</em> in Mongo.\nBut it turns out that <em>string</em> was choosen:</p>\n\n<p><em>Mongo Shell:</em></p>\n\n<pre><code>&gt; db.foocoll.findOne()\n{ \"_id\" : \"XvMn]K\ufffd \ufffd\\f:\ufffd\", \"id2\" : ObjectId(\"58764d6e5d4be120fa0c3ab1\") }  // id2 is OK ...\n\n&gt; typeof db.foocoll.findOne()._id\nstring  // OOps. Should be ObjectId !\n</code></pre>\n\n<p>This may be intended, since <em>bson.ObjectId</em> itself is derived from <em>string</em>. But here, it's bad for us.</p>\n\n<p>Can we tell mgo to map the _id to ObjectId in the Database ?</p>\n"}, {"tags": ["pointers", "go", "machine-learning", "liblinear"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1484149391, "post_id": 41594855, "comment_id": 70392851, "body": "If new to Go: Take the tour of Go. Once taken play around with packages which do use neither cgo nor unsafe. Do such stuff once you really know Go."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484150371, "post_id": 41594855, "comment_id": 70393477, "body": "It looks like <code>github.com&#47;sjwhitworth&#47;golearn&#47;linear_models</code> isn&#39;t correctly using cgo. It&#39;s unsafely passing Go memory to a C library, and I wouldn&#39;t use it."}, {"owner": {"reputation": 143, "user_id": 2046161, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/fuOmC.jpg?s=128&g=1", "display_name": "SZMER", "link": "https://stackoverflow.com/users/2046161/szmer"}, "edited": false, "score": 0, "creation_date": 1484210942, "post_id": 41594855, "comment_id": 70418927, "body": "I used following workaround and code works fine <code>export GODEBUG=cgocheck=0</code>"}, {"owner": {"reputation": 143, "user_id": 2046161, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/fuOmC.jpg?s=128&g=1", "display_name": "SZMER", "link": "https://stackoverflow.com/users/2046161/szmer"}, "edited": false, "score": 0, "creation_date": 1484308345, "post_id": 41594855, "comment_id": 70467580, "body": "Finally i replaced <code>golearn</code> with <code>github.com&#47;lazywei&#47;lineargo</code>. Thanks for feedback."}], "owner": {"reputation": 143, "user_id": 2046161, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/fuOmC.jpg?s=128&g=1", "display_name": "SZMER", "link": "https://stackoverflow.com/users/2046161/szmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 516, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484148888, "creation_date": 1484148888, "question_id": 41594855, "link": "https://stackoverflow.com/questions/41594855/golearn-runtime-error-cgo-argument-has-go-pointer-to-go-pointer", "title": "golearn - runtime error: cgo argument has Go pointer to Go pointer", "body": "<p>I'm new in go but I found <a href=\"https://github.com/sjwhitworth\" rel=\"nofollow noreferrer\">golearn</a> project which has lot of stars on github so I decided to give it a try with simple categorization problem. But with first attempt pointer problem appeared in <code>Train</code> method and I'm not sure if it's a bug in golearn bindings or is it related with wrong setup.</p>\n\n<p>This is simplified version of code:</p>\n\n<pre><code>package main\n\nimport (\n  _ \"github.com/sjwhitworth/golearn/base\"\n  liblinear \"github.com/sjwhitworth/golearn/linear_models\"\n)\n\nfunc main() {\n  labels, features := getFeatures()\n  vocabulary := createVocabulary(features)\n  words_matrix := countedMatrix(features, vocabulary)\n\n  fmt.Println(\"labels:\", labels)\n  fmt.Println(\"words matrix:\", words_matrix)\n\n  solver_type := liblinear.L2R_LR_DUAL\n  C := 10.0 \n  eps := 0.01 \n  bias := -1.0 \n\n  parameter := liblinear.NewParameter(solver_type, C, eps)\n  problem := liblinear.NewProblem(words_matrix, categories, bias)\n\n  model := liblinear.Train(problem, parameter)\n\n  prediction_vector := countedVector(tokenize(\"something to predict here\"), vocabulary)\n  fmt.Println(\"prediction vector:\", prediction_vector)\n\n  prediction := liblinear.Predict(model, prediction_vector)\n  fmt.Println(\"prediction:\", prediction)\n}\n</code></pre>\n\n<p>And this is output i get:</p>\n\n<pre><code>labels: [6 8 9 10 11 12 14 15 16 17]\nwords matrix: [[0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 0 0] [0 1 0 0 0 1 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0] [0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 1 0 0 0 0] [0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0] [0 0 0 0 0 0 0 0 1 0 0 1 1 0 0 1 0 0 0 0 1] [1 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0] [0 0 0 1 0 0 0 1 0 0 0 0 0 1 1 1 1 0 0 1 1] [0 1 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0] [0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0] [0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 1 1 0 0 1]]\npanic: runtime error: cgo argument has Go pointer to Go pointer\n\ngoroutine 1 [running]:\npanic(0x83d620, 0xc8200d7510)\n    /usr/lib/go-1.6/src/runtime/panic.go:481 +0x3e6\ngithub.com/sjwhitworth/golearn/linear_models.Train(0xc820102420, 0xc820015e80, 0xa)\n    /home/me/gocode/src/github.com/sjwhitworth/golearn/linear_models/liblinear.go:61 +0x11d\nmain.main()\n    /home/me/gocode/src/mlservice/main.go:144 +0x62b\nexit status 2\n</code></pre>\n\n<p>Should I report issue or fix code (please help me if fix is possible)</p>\n"}, {"tags": ["windows", "eclipse", "go", "configure", "goclipse"], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 644592, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/20e5dfdc04c8ef51cf4e48505c8646bc?s=128&d=identicon&r=PG", "display_name": "ventayol", "link": "https://stackoverflow.com/users/644592/ventayol"}, "edited": false, "score": 0, "creation_date": 1484891383, "post_id": 41655929, "comment_id": 70705726, "body": "We tried IntelliJ before switching to Visual Studio Code with the go plugin, maybe you can give it a try and answer which one you like more. Our experience using Visual Studio Code is that it works really good while IntelliJ had a lot of problem some months ago."}, {"owner": {"reputation": 293, "user_id": 3997991, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4acd506b7267eade68ce2a18028b1771?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Murphy", "link": "https://stackoverflow.com/users/3997991/steve-murphy"}, "reply_to_user": {"reputation": 505, "user_id": 644592, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/20e5dfdc04c8ef51cf4e48505c8646bc?s=128&d=identicon&r=PG", "display_name": "ventayol", "link": "https://stackoverflow.com/users/644592/ventayol"}, "edited": false, "score": 0, "creation_date": 1484920703, "post_id": 41655929, "comment_id": 70721991, "body": "Thanks, ventayol. I&#39;ll give that a try."}], "tags": [], "owner": {"reputation": 293, "user_id": 3997991, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4acd506b7267eade68ce2a18028b1771?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Murphy", "link": "https://stackoverflow.com/users/3997991/steve-murphy"}, "is_accepted": false, "score": 0, "last_activity_date": 1484434622, "creation_date": 1484434622, "answer_id": 41655929, "question_id": 41594163, "link": "https://stackoverflow.com/questions/41594163/configure-eclipse-as-go-ide/41655929#41655929", "title": "Configure Eclipse as Go IDE", "body": "<p>I could not find an answer to this question. I've decided to use IntelliJ with the golang plugin and this solution works wonderfully.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7897947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gMAAd.jpg?s=128&g=1", "display_name": "Khedr0n", "link": "https://stackoverflow.com/users/7897947/khedr0n"}, "is_accepted": false, "score": 2, "last_activity_date": 1492719398, "creation_date": 1492719398, "answer_id": 43529108, "question_id": 41594163, "link": "https://stackoverflow.com/questions/41594163/configure-eclipse-as-go-ide/43529108#43529108", "title": "Configure Eclipse as Go IDE", "body": "<p>Ok, you already decided to go for IntelliJ but maybe someone else might be interested in an answer though ...</p>\n\n<p>I also had some fights with GoClipse but finally I got it working. The solution is to input the whole path (including the project name). So for example your GOPATH is (on Linux) /home/username/go and you want to create a project named \"gopro\" and want to place it in \"/home/username/go/src/github.com/user\" you need to type in the Eclipse window: \"/home/username/go/src/github.com/user/gopro\". Everything should work without any problems afterwards.</p>\n"}], "owner": {"reputation": 293, "user_id": 3997991, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4acd506b7267eade68ce2a18028b1771?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Murphy", "link": "https://stackoverflow.com/users/3997991/steve-murphy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1309, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492719398, "creation_date": 1484146955, "question_id": 41594163, "link": "https://stackoverflow.com/questions/41594163/configure-eclipse-as-go-ide", "title": "Configure Eclipse as Go IDE", "body": "<p>I've decided to use Eclipse (with the goClipse plugin) as my editor for go projects.\nI already had go installed and (before choosing Eclipse) I had designated c:\\go-workspace as my workspace.</p>\n\n<p>I now want to configure Eclipse to use that workspace as my location for go work.\nI plan to import various projects from github and create my own github account where I can commit changes, etc. All those imports will be under the src/directory, and this is in accordance with this article that seems to indicate it is best to have one go workspace with everything under the src/ directory: <a href=\"https://talks.golang.org/2014/organizeio.slide#9\" rel=\"nofollow noreferrer\">https://talks.golang.org/2014/organizeio.slide#9</a>.</p>\n\n<p>I'm having issues creating a go project in Eclipse. \nI choose File > New Go Project and browse to c:\\go-workspace.\nI enter a project name in the dialog but I get a message saying that a directory already exists at the specified location and my only choice is to cancel.</p>\n\n<p>I then tried creating a new Eclipse workspace but when Eclipse was finished it indicated it is a Java project.</p>\n\n<p>How do I accomplish what I want to do? Or perhaps the \"best practice\" for what I want to do is something else.</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1484146921, "post_id": 41594137, "comment_id": 70391250, "body": "ListenAndServe blocks. <code>defer</code> is only executed if the function returns."}, {"owner": {"reputation": 23850, "user_id": 196679, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fXUzE.jpg?s=128&g=1", "display_name": "Bazzz", "link": "https://stackoverflow.com/users/196679/bazzz"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484385050, "post_id": 41594137, "comment_id": 70495889, "body": "JimB, I believe you are describing the same problem, but in other words."}], "answers": [{"comments": [{"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "edited": false, "score": 0, "creation_date": 1484147925, "post_id": 41594291, "comment_id": 70391900, "body": "Alternatively, have a look at this solution <a href=\"http://stackoverflow.com/questions/41432193/how-to-delete-a-file-using-golang-on-program-exit/41455960#41455960\" title=\"how to delete a file using golang on program exit\">stackoverflow.com/questions/41432193/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "is_accepted": true, "score": 3, "last_activity_date": 1484147338, "creation_date": 1484147338, "answer_id": 41594291, "question_id": 41594137, "link": "https://stackoverflow.com/questions/41594137/how-to-use-defer-in-combination-with-http-listenandserve/41594291#41594291", "title": "How to use defer in combination with http.ListenAndServe?", "body": "<p><code>defer</code> statements get executed only when the function enclosing them returns. Your main function is not returning when you kill it. So you need to use signals and channels. </p>\n\n<p>This is a good link explaining the same <a href=\"https://www.socketloop.com/tutorials/golang-intercept-ctrl-c-interrupt-or-kill-signal-and-determine-the-signal-type\" rel=\"nofollow noreferrer\">https://www.socketloop.com/tutorials/golang-intercept-ctrl-c-interrupt-or-kill-signal-and-determine-the-signal-type</a> .</p>\n\n<p>I faced the same problem with my last project. I implemented a similar solution in my project <a href=\"https://github.com/Krashcan/wshare/blob/master/main.go\" rel=\"nofollow noreferrer\">wshare</a> .</p>\n\n<p>In your case, you can try something like</p>\n\n<pre><code>     ch := make(chan os.Signal, 3)\n\n     signal.Notify(ch, os.Interrupt,syscall.SIGTERM,syscall.SIGINT)\n\n\n     go func() {\n             signalType := &lt;-ch\n             signal.Stop(ch)\n             log.Println(\"Exit command received. Exiting...\")\n\n             // this is a good place to flush everything to disk\n             // before terminating.\n             db.Close()\n             log.Println(\"Signal type : \", signalType)\n\n             os.Exit(0)\n\n     }()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 2687264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4114e403f9a3e9812b4e7179ad4d7003?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Fendrich", "link": "https://stackoverflow.com/users/2687264/peter-fendrich"}, "is_accepted": false, "score": 3, "last_activity_date": 1484212131, "creation_date": 1484212131, "answer_id": 41609014, "question_id": 41594137, "link": "https://stackoverflow.com/questions/41594137/how-to-use-defer-in-combination-with-http-listenandserve/41609014#41609014", "title": "How to use defer in combination with http.ListenAndServe?", "body": "<p>The HTTP package in the next go release 1.8 will have a new Shutdown function that gracefully shuts down the server . <a href=\"https://beta.golang.org/pkg/net/http/#Server.Shutdown\" rel=\"nofollow noreferrer\">https://beta.golang.org/pkg/net/http/#Server.Shutdown</a>\nI suppose that defer will work then.</p>\n"}], "owner": {"reputation": 23850, "user_id": 196679, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fXUzE.jpg?s=128&g=1", "display_name": "Bazzz", "link": "https://stackoverflow.com/users/196679/bazzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "accepted_answer_id": 41594291, "answer_count": 2, "score": 1, "last_activity_date": 1484212131, "creation_date": 1484146870, "question_id": 41594137, "link": "https://stackoverflow.com/questions/41594137/how-to-use-defer-in-combination-with-http-listenandserve", "title": "How to use defer in combination with http.ListenAndServe?", "body": "<p>When using <code>http.ListenAndServe()</code> in Go, this results in a blocking situation where the application, apparently, can only be stopped by killing it. This seems to skip processing my <code>defer</code> statements. Please see the code below. When I kill the application the db is not closed. How can I make sure my <code>defer</code> statement will be run?</p>\n\n<pre><code>func main() {\n  db := NewDB(DBFILENAME)\n  defer db.Close()\n  http.HandleFunc(\"/\", handler)\n  http.ListenAndServe(\":80\", nil)\n}\n</code></pre>\n"}, {"tags": ["json", "go", "timestamp", "marshalling", "decode"], "answers": [{"tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": true, "score": 3, "last_activity_date": 1484148268, "creation_date": 1484148268, "answer_id": 41594648, "question_id": 41593301, "link": "https://stackoverflow.com/questions/41593301/unmarshaling-epoch-timestamp-into-time-time/41594648#41594648", "title": "Unmarshaling epoch timestamp into time.Time", "body": "<p>If you're okay to have the timestamp as unix time (I assume that what it is) just declare the field as <code>int64</code>, ie</p>\n\n<pre><code>type Metrics struct {\n    ...\n    Timestamp   int64   `orm:\"column(timestamp);type(datetime)\" json:\"timestamp;omitempty\"`\n}\n</code></pre>\n\n<p>You can then convert it to Go's <code>Time</code> type with</p>\n\n<pre><code>var m Metrics \n...\nWhen := time.Unix(m.Timestamp, 0)\n</code></pre>\n\n<p>Another option is to write custom <code>UnmarshalJSON</code> handler for the Metrics type:</p>\n\n<pre><code>func (this *Metrics) UnmarshalJSON(data []byte) error {\n    var f interface{}\n    err := json.Unmarshal(data, &amp;f)\n    if err != nil { return err; }\n    m := f.(map[string]interface{})\n    for k, v := range m {\n        switch k {\n        case \"metric_name\": this.Name  = v.(string)\n        case \"timestamp\": this.Timestamp = time.Unix(int64(v.(float64)), 0)\n        ...\n        }\n    }\n}\n</code></pre>\n\n<p>Then you have proper time.Time value in struct which makes working with it easier.</p>\n"}], "owner": {"reputation": 2789, "user_id": 664160, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0c7dfdfb981d63a230619d0962c4d91?s=128&d=identicon&r=PG", "display_name": "kambi", "link": "https://stackoverflow.com/users/664160/kambi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3389, "favorite_count": 0, "accepted_answer_id": 41594648, "answer_count": 1, "score": 1, "last_activity_date": 1484148268, "creation_date": 1484144407, "question_id": 41593301, "link": "https://stackoverflow.com/questions/41593301/unmarshaling-epoch-timestamp-into-time-time", "title": "Unmarshaling epoch timestamp into time.Time", "body": "<p>Running Decode() with this struct produces an error with the 'timestamp' column:</p>\n\n<pre><code>type Metrics struct {\n        Id        int       `orm:\"column(id);auto\"`\n        Name      string    `orm:\"column(name);size(255);null\" json:\"metric_name\"`\njson:\"lon\"`\n        Timestamp time.Time `orm:\"column(timestamp);type(datetime)\" json:\"timestamp;omitempty\"`\n\n}\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code> parsing time \"1352289160\" as \"\"2006-01-02T15:04:05Z07:00\"\": cannot parse \"1352289160\" as \"\"\"\n</code></pre>\n\n<p>How can I parse it into a time.Time value?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["json", "rest", "go", "paypal"], "comments": [{"owner": {"reputation": 5581, "user_id": 395773, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/14a93048c4fc7fa14a61bb15719233a1?s=128&d=identicon&r=PG", "display_name": "Max Favilli", "link": "https://stackoverflow.com/users/395773/max-favilli"}, "edited": false, "score": 0, "creation_date": 1490291598, "post_id": 41593030, "comment_id": 73058994, "body": "I am having the same problem, removing reference_id from the object it works, have you solved it?"}, {"owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "reply_to_user": {"reputation": 5581, "user_id": 395773, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/14a93048c4fc7fa14a61bb15719233a1?s=128&d=identicon&r=PG", "display_name": "Max Favilli", "link": "https://stackoverflow.com/users/395773/max-favilli"}, "edited": false, "score": 0, "creation_date": 1490314014, "post_id": 41593030, "comment_id": 73069889, "body": "I fixed it using <code>omitempty</code> for all fields, apparently paypal doesnt like empty fields"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484143584, "creation_date": 1484143584, "question_id": 41593030, "link": "https://stackoverflow.com/questions/41593030/go-paypal-rest-api-malformed-request", "title": "Go PayPal REST API Malformed request", "body": "<p>I am trying to create a payment using the REST API. I am generating a valid JSON however PayPal responds to my request with </p>\n\n<pre><code>{\"name\":\"MALFORMED_REQUEST\",\"message\":\"Incoming JSON request does not map to API request\",\"information_link\":\"https://developer.paypal.com/webapps/developer/docs/api/#MALFORMED_REQUEST\",\"debug_id\":\"2cfe09ef6f5db\"}\n</code></pre>\n\n<p>This is the JSON request</p>\n\n<pre><code>{\n   \"intent\":\"sale\",\n   \"payer\":{\n      \"payment_method\":\"paypal\"\n   },\n   \"transactions\":[\n      {\n         \"reference_id\":\"\",\n         \"amount\":{\n            \"currency\":\"EUR\",\n            \"total\":\"10\",\n            \"details\":{\n               \"subtotal\":\"\",\n               \"shipping\":\"\",\n               \"tax\":\"\",\n               \"handling_fee\":\"\",\n               \"shipping_discount\":\"\",\n               \"insurance\":\"\",\n               \"gift_wrap\":\"\"\n            }\n         },\n         \"description\":\"gopaypal create payment test\",\n         \"note_to_payee\":\"\",\n         \"custom\":\"gopaypal-test\",\n         \"invoice_number\":\"\",\n         \"soft_descriptor\":\"\",\n         \"payment_options\":{\n            \"allowed_payment_method\":\"\"\n         },\n         \"item_list\":{\n            \"items\":[\n               {\n                  \"sku\":\"\",\n                  \"name\":\"Item test\",\n                  \"description\":\"\",\n                  \"quantity\":\"\",\n                  \"price\":\"10\",\n                  \"currency\":\"EUR\",\n                  \"tax\":\"\",\n                  \"url\":\"\"\n               }\n            ],\n            \"shipping_method\":\"\",\n            \"shipping_phone_number\":\"\"\n         },\n         \"notify_url\":\"\",\n         \"order_url\":\"\"\n      }\n   ],\n   \"redirect_urls\":{\n      \"return_url\":\"http://dev.tudescontento.es/paypal/return\",\n      \"cancel_url\":\"http://dev.tudescontento.es/paypal/return\"\n   }\n}\n</code></pre>\n\n<p>The request is made without problems. My problem is the JSON I am passing to my request.</p>\n\n<p>Looking at the docs my request seems to fit perfectly what PayPal expects</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-ec2", "amazon-elb", "http2"], "comments": [{"owner": {"reputation": 658, "user_id": 4462462, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t13D1.jpg?s=128&g=1", "display_name": "Thomas Darvik", "link": "https://stackoverflow.com/users/4462462/thomas-darvik"}, "edited": false, "score": 0, "creation_date": 1484143580, "post_id": 41592929, "comment_id": 70388944, "body": "You might want to add a question or somehow explain a little bit more what the problem is."}, {"owner": {"reputation": 2525, "user_id": 5348625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ZmmTJ3H92Hw/AAAAAAAAAAI/AAAAAAAAJ8Q/IUFehy2FN_M/photo.jpg?sz=128", "display_name": "bfallik", "link": "https://stackoverflow.com/users/5348625/bfallik"}, "reply_to_user": {"reputation": 658, "user_id": 4462462, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t13D1.jpg?s=128&g=1", "display_name": "Thomas Darvik", "link": "https://stackoverflow.com/users/4462462/thomas-darvik"}, "edited": false, "score": 0, "creation_date": 1484144656, "post_id": 41592929, "comment_id": 70389674, "body": "@thomasdarvik - done, thx"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484147940, "post_id": 41592929, "comment_id": 70391917, "body": "What is the the manifestation of the GOAWAY frame at the client? Are the clients actively doing something which is interrupted, or is this just being logged?"}, {"owner": {"reputation": 2525, "user_id": 5348625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ZmmTJ3H92Hw/AAAAAAAAAAI/AAAAAAAAJ8Q/IUFehy2FN_M/photo.jpg?sz=128", "display_name": "bfallik", "link": "https://stackoverflow.com/users/5348625/bfallik"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484149076, "post_id": 41592929, "comment_id": 70392639, "body": "@JimB - currently our go HTTP client code handles all errors equivalently, they are logged as errors and the request is aborted. This code predates our moved from ELBs to ALBs, when using ELBs (and http/1.1) all protocol errors were actual errors. The client is looping over the same web request with 1s between request. Each request takes about 5s."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484150194, "post_id": 41592929, "comment_id": 70393373, "body": "@BrianF: I thought GOAWAY was something handled more transparently by the client, like <code>Connection: close</code>, but it&#39;s possible the ALB is doing things wrong too. Regardless, you need to handle it, and I think you can still handle it like any other protocol or network error. If you would retry when the dial or connection fails, I would do the same in this instance."}, {"owner": {"reputation": 2525, "user_id": 5348625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ZmmTJ3H92Hw/AAAAAAAAAAI/AAAAAAAAJ8Q/IUFehy2FN_M/photo.jpg?sz=128", "display_name": "bfallik", "link": "https://stackoverflow.com/users/5348625/bfallik"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484150398, "post_id": 41592929, "comment_id": 70393500, "body": "@JimB - sure, though that implies that the http.Client component within the Go standard library should, at a minimum, better document the expectations around handling the GOAWAY."}], "answers": [{"comments": [{"owner": {"reputation": 2525, "user_id": 5348625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ZmmTJ3H92Hw/AAAAAAAAAAI/AAAAAAAAJ8Q/IUFehy2FN_M/photo.jpg?sz=128", "display_name": "bfallik", "link": "https://stackoverflow.com/users/5348625/bfallik"}, "edited": false, "score": 0, "creation_date": 1484152686, "post_id": 41595873, "comment_id": 70395014, "body": "I&#39;ve edited my question to include more log information which shows the Last-Stream-ID and debug info."}, {"owner": {"reputation": 3753, "user_id": 451641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811b28e7b085e2e493fd32c5913a1ae8?s=128&d=identicon&r=PG", "display_name": "Frederik Deweerdt", "link": "https://stackoverflow.com/users/451641/frederik-deweerdt"}, "reply_to_user": {"reputation": 2525, "user_id": 5348625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ZmmTJ3H92Hw/AAAAAAAAAAI/AAAAAAAAJ8Q/IUFehy2FN_M/photo.jpg?sz=128", "display_name": "bfallik", "link": "https://stackoverflow.com/users/5348625/bfallik"}, "edited": false, "score": 0, "creation_date": 1484153974, "post_id": 41595873, "comment_id": 70395826, "body": "Edited the question to address the additional info, thanks!"}], "tags": [], "owner": {"reputation": 3753, "user_id": 451641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811b28e7b085e2e493fd32c5913a1ae8?s=128&d=identicon&r=PG", "display_name": "Frederik Deweerdt", "link": "https://stackoverflow.com/users/451641/frederik-deweerdt"}, "is_accepted": false, "score": 4, "last_activity_date": 1484153958, "last_edit_date": 1484153958, "creation_date": 1484151932, "answer_id": 41595873, "question_id": 41592929, "link": "https://stackoverflow.com/questions/41592929/aws-alb-http-2-and-goaway/41595873#41595873", "title": "AWS/ALB, http/2, and GOAWAY", "body": "<h2>About GOAWAY</h2>\n\n<p>The <code>GOAWAY</code> frame carries three pieces of information that could help you troubleshooting the issue:</p>\n\n<pre><code> +-+-------------------------------------------------------------+\n |R|                  Last-Stream-ID (31)                        |\n +-+-------------------------------------------------------------+\n |                      Error Code (32)                          |\n +---------------------------------------------------------------+\n |                  Additional Debug Data (*)                    |\n +---------------------------------------------------------------+\n</code></pre>\n\n<ul>\n<li>Last-stream-ID is the last ID that was correctly processed. This might help understand what's going on: the RFC has some advice on how to achieve a graceful shutdown: First send a <code>GOAWAY</code> frame with <code>Last-Stream-ID</code> with <code>NO_ERROR</code>, to let the client know that a shutdown is about to come, then after some time, send another <code>GOAWAY</code> frame with <code>Last-Stream-ID</code> set to the actually last processed ID. So that the client knows what's been passed on. Here's the relevant extract, from <a href=\"https://http2.github.io/http2-spec/#GOAWAY\" rel=\"nofollow noreferrer\">RFC7540, 6.8 GOAWAY</a></li>\n</ul>\n\n<blockquote>\n  <p>A server that is attempting to gracefully shut down a    connection\n  SHOULD send an initial GOAWAY frame with the last stream    identifier\n  set to 2^31-1 and a NO_ERROR code.  This signals to the    client that\n  a shutdown is imminent and that initiating further    requests is\n  prohibited.  After allowing time for any in-flight stream    creation\n  (at least one round-trip time), the server can send another    GOAWAY\n  frame with an updated last stream identifier.  This ensures    that a\n  connection can be cleanly shut down without losing requests.</p>\n</blockquote>\n\n<ul>\n<li>The error code and the additional debug data (a string), will contain additional information that explain what's going on. <a href=\"https://tools.ietf.org/html/rfc7540#section-7\" rel=\"nofollow noreferrer\">RFC 7540, 7. Error Codes</a> has the list of possible error codes. Then depending on the server implementation you might have a string narrowing down the error. <a href=\"https://github.com/h2o/h2o/blob/aebae6c70fbb6cd5c4179ee3b5589488c82c9b8c/lib/http2/hpack.c#L87\" rel=\"nofollow noreferrer\">For example in H2O, the server sends</a> <code>found an upper-case letter in header name</code> when an upper case letter was found in a header name.</li>\n</ul>\n\n<h2>This particular GOAWAY</h2>\n\n<p><code>http2: server sent GOAWAY and closed the connection; LastStreamID=1, ErrCode=NO_ERROR, debug=\"\"</code></p>\n\n<p>Since the server is sending <code>NO_ERROR</code>, your client should simply try to reconnect, and not treat the message as an error.</p>\n\n<p>As to <em>why</em> the ALB is sending GOAWAYs... I'm not sure, can you give us more details about that?</p>\n"}, {"comments": [{"owner": {"reputation": 2525, "user_id": 5348625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ZmmTJ3H92Hw/AAAAAAAAAAI/AAAAAAAAJ8Q/IUFehy2FN_M/photo.jpg?sz=128", "display_name": "bfallik", "link": "https://stackoverflow.com/users/5348625/bfallik"}, "edited": false, "score": 0, "creation_date": 1489096586, "post_id": 42682185, "comment_id": 72534307, "body": "Hi Jon, I logged that forum thread as well. It&#39;s worth noting that the interesting content on this issue came from the Go developers directly in  <a href=\"https://github.com/golang/go/issues/18639\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/18639</a>. I&#39;m not an http2 expert but you should read that Issue to understand a bit more about the details."}], "tags": [], "owner": {"reputation": 21, "user_id": 1401766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68ceb69eeff9b401daf705c8bc6a5f46?s=128&d=identicon&r=PG", "display_name": "Jon Zobrist", "link": "https://stackoverflow.com/users/1401766/jon-zobrist"}, "is_accepted": false, "score": 0, "last_activity_date": 1489008335, "creation_date": 1489008335, "answer_id": 42682185, "question_id": 41592929, "link": "https://stackoverflow.com/questions/41592929/aws-alb-http-2-and-goaway/42682185#42682185", "title": "AWS/ALB, http/2, and GOAWAY", "body": "<p>@frederik-deweerdt answer should be accepted as the answer, regarding Application Load Balancers specifically, here is the answer from an AWS Forums post for similar question, <a href=\"https://forums.aws.amazon.com/thread.jspa?messageID=771883&amp;#771883\" rel=\"nofollow noreferrer\">https://forums.aws.amazon.com/thread.jspa?messageID=771883&amp;#771883</a></p>\n\n<p>The HTTP/2 GOAWAY response your clients are receiving are connections that are being closed gracefully by the Application Load Balancer. Application Load Balancers will generally allow idle connections to last until the configured idle timeout, which has a default of 60 seconds. However, there are some conditions which can trigger closing of idle connections. On an HTTP/1.1 connection, an outstanding request is allowed to complete, and then the TCP connection is torn down normally. On an HTTP/2 connection, the load balancer initiates a close of these connections gracefully by sending an HTTP/2 GOAWAY. Per RFC 7540 \"GOAWAY allows an endpoint to gracefully stop accepting new streams while still finishing processing of previously established streams\". The client should respond by completing in progress requests, closing the connection and reconnecting if needed. Application Load Balancer will log the HTTP status for each request in the access log, and not the connection state closing signal.</p>\n\n<p>Clients experiencing errors due to having received an HTTP/2 GOAWAY should be checked to ensure they are fully compliant with HTTP/2 RFCs.</p>\n\n<p>You can read more about HTTP/2 GOAWAY method in section 6.8 of RFC 7540.\n<a href=\"https://tools.ietf.org/html/rfc7540#section-6.8\" rel=\"nofollow noreferrer\">https://tools.ietf.org/html/rfc7540#section-6.8</a></p>\n\n<p>Please let us know if you have any further questions about this or other behavior of Elastic Load Balancers.</p>\n"}], "owner": {"reputation": 2525, "user_id": 5348625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ZmmTJ3H92Hw/AAAAAAAAAAI/AAAAAAAAJ8Q/IUFehy2FN_M/photo.jpg?sz=128", "display_name": "bfallik", "link": "https://stackoverflow.com/users/5348625/bfallik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2247, "favorite_count": 3, "answer_count": 2, "score": 3, "last_activity_date": 1489008335, "creation_date": 1484143322, "last_edit_date": 1484168380, "question_id": 41592929, "link": "https://stackoverflow.com/questions/41592929/aws-alb-http-2-and-goaway", "title": "AWS/ALB, http/2, and GOAWAY", "body": "<p>We recently switched from ELB to ELB2/ALBs and occasionally our go http/2 clients are seeing <a href=\"https://http2.github.io/http2-spec/#GOAWAY\" rel=\"nofollow noreferrer\">GOAWAY</a> messages from our Application Load Balancers which I'm unable to explain. The target group servers only support http/1.1 and our load balancers should always have at least one healthy server in rotation.</p>\n\n<p>I can reliably reproduce the GOAWAY when registering a new instance in the ALB. The ALB returns GOAWAY when the target is in the \"Initial\" state. Further, even though the ALB responds with GOAWAY the request successfully makes it to the other instance registered in the target group. So, given instances web0 and web1, if I deregister web0 and re-register that target I can reliably reproduce the GOAWAY if I make a request while web0 is in \"Initial\". However our logs show that web1 successfully handled the request.</p>\n\n<p>Our client is a Go program using <a href=\"https://golang.org/pkg/net/http/#pkg-variables\" rel=\"nofollow noreferrer\">http.DefaultClient</a>. I can reproduce this behavior using both Go 1.7 and 1.8beta2.</p>\n\n<p>When this occurs our client logs more details about the HTTP/2 response:</p>\n\n<pre><code>http2: server sent GOAWAY and closed the connection; LastStreamID=1, ErrCode=NO_ERROR, debug=\"\"\n</code></pre>\n\n<p>I'd like to better understand what's going on here. Should either the go http2 package or our code automatically handle the GOAWAY by retrying the request? I'm not familiar enough with http2 to know if GOAWAY is expected, which implies that our Go client shouldn't handle it as an error condition, or if this indicates that something is going wrong at the ALB.</p>\n"}, {"tags": ["debugging", "go", "ide", "goland"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484146855, "post_id": 41592892, "comment_id": 70391211, "body": "The debugger looks like it  &quot;just works&quot;. What problem are you having?"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 1, "creation_date": 1484174842, "post_id": 41592892, "comment_id": 70406888, "body": "@zoyd I&#39;m sorry you have issues with debugging. Could you please share more details about your project / setup? What&#39;s the OS that you are running and which Go version? And if the project is open-source then a link to it would be great. Also it would help to have a way to reproduce this.  Also Gogland uses Delve under the hood as a debugging backend and depending on you Go version things might be broken or not."}, {"owner": {"reputation": 143, "user_id": 166427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd01f4b38f133e19c094e32d237ffdd?s=128&d=identicon&r=PG", "display_name": "Steve Butler", "link": "https://stackoverflow.com/users/166427/steve-butler"}, "edited": false, "score": 0, "creation_date": 1485230467, "post_id": 41592892, "comment_id": 70827532, "body": "Setting up the Go structure is good information for the newbies to Gogland."}, {"owner": {"reputation": 2592, "user_id": 137511, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d702459532d5966695d276d761a77c0?s=128&d=identicon&r=PG", "display_name": "Vincent", "link": "https://stackoverflow.com/users/137511/vincent"}, "edited": false, "score": 0, "creation_date": 1485445470, "post_id": 41592892, "comment_id": 70936567, "body": "I&#39;m able to run but I&#39;m not able to debug yet. I got this message: Error running Build hello.go and run: Cannot find runner for Build hello.go and run"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "reply_to_user": {"reputation": 2592, "user_id": 137511, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d702459532d5966695d276d761a77c0?s=128&d=identicon&r=PG", "display_name": "Vincent", "link": "https://stackoverflow.com/users/137511/vincent"}, "edited": false, "score": 0, "creation_date": 1485765515, "post_id": 41592892, "comment_id": 71043630, "body": "@Vincent I suggest you open a new question for your particular problem."}, {"owner": {"reputation": 5153, "user_id": 804713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/454ce0be068cbbf25ee685af20dc7cd6?s=128&d=identicon&r=PG", "display_name": "stephenbez", "link": "https://stackoverflow.com/users/804713/stephenbez"}, "edited": false, "score": 0, "creation_date": 1485820425, "post_id": 41592892, "comment_id": 71075323, "body": "I noticed the same behavior.  The first time I debugged an application, the breakpoints didn&#39;t work, but then after running it 2 or 3 times it seemed to work fine.  Using OSX 10.10.5, go 1.7.4, Gogland 1.0 EAP, project is not open source."}, {"owner": {"reputation": 1823, "user_id": 635573, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/V5ih0.jpg?s=128&g=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/635573/ricardo"}, "edited": false, "score": 0, "creation_date": 1487961647, "post_id": 41592892, "comment_id": 72035592, "body": "Hey,  Can you share your code or your repo?  Do you have a delvet installed?"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1487962508, "post_id": 41592892, "comment_id": 72036094, "body": "Thanks for your interest, but again, it now works. It may have been a temporary problem in that (now outdated) version of Gogland."}, {"owner": {"reputation": 315, "user_id": 2855881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/033c0a20e4d0a29e71be93febdf073a1?s=128&d=identicon&r=PG&f=1", "display_name": "cvigo", "link": "https://stackoverflow.com/users/2855881/cvigo"}, "edited": false, "score": 1, "creation_date": 1497215041, "post_id": 41592892, "comment_id": 75971600, "body": "Just updated to the June 9th version: debugger in Gogland is just a joke. I understand that it is an early bird version but, seriously JB guys... even the Hello Word fails."}], "answers": [{"comments": [{"owner": {"reputation": 35424, "user_id": 81071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a0cc4d1c55ee3ae48437c4e7774355b7?s=128&d=identicon&r=PG", "display_name": "Koraktor", "link": "https://stackoverflow.com/users/81071/koraktor"}, "edited": false, "score": 2, "creation_date": 1489219408, "post_id": 42027481, "comment_id": 72584327, "body": "This does not explain why &quot;Debug\u2026&quot; might be unavailable."}, {"owner": {"reputation": 779, "user_id": 2822280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5dfa4b2d28e288bf36740fd0e98355c?s=128&d=identicon&r=PG&f=1", "display_name": "Ed Pike", "link": "https://stackoverflow.com/users/2822280/ed-pike"}, "edited": false, "score": 0, "creation_date": 1496878302, "post_id": 42027481, "comment_id": 75847162, "body": "I inherited a project with main.go in the top folder, not src. Was having same problem and right clicking like this works."}], "tags": [], "owner": {"reputation": 15, "user_id": 1793301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc6042bf407892caf58b77ac7a8c749?s=128&d=identicon&r=PG", "display_name": "user1793301", "link": "https://stackoverflow.com/users/1793301/user1793301"}, "is_accepted": false, "score": -2, "last_activity_date": 1592549212, "last_edit_date": 1592549212, "creation_date": 1486135194, "answer_id": 42027481, "question_id": 41592892, "link": "https://stackoverflow.com/questions/41592892/how-to-set-up-debugging-in-goland/42027481#42027481", "title": "How to set up debugging in GoLand?", "body": "<p>I right click on project (main.go inside) and choose \"Debug ...\" and it work</p>\n\n<p><a href=\"https://i.stack.imgur.com/YNtgM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YNtgM.png\" alt=\"\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 572, "user_id": 2461476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a46kg.gif?s=128&g=1", "display_name": "iamtheddrman", "link": "https://stackoverflow.com/users/2461476/iamtheddrman"}, "edited": false, "score": 1, "creation_date": 1490733807, "post_id": 42732874, "comment_id": 73242389, "body": "That is one of the most inane and pointless requirements I&#39;ve seen in quite some time. Why is an IDE (or the language itself) forcing a particular folder name on me? Thank you for the answer, but it&#39;s frustrating that I&#39;m now going to own our entire server code if/when I check in the folder name change..."}, {"owner": {"reputation": 35424, "user_id": 81071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a0cc4d1c55ee3ae48437c4e7774355b7?s=128&d=identicon&r=PG", "display_name": "Koraktor", "link": "https://stackoverflow.com/users/81071/koraktor"}, "reply_to_user": {"reputation": 572, "user_id": 2461476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a46kg.gif?s=128&g=1", "display_name": "iamtheddrman", "link": "https://stackoverflow.com/users/2461476/iamtheddrman"}, "edited": false, "score": 0, "creation_date": 1490734171, "post_id": 42732874, "comment_id": 73242569, "body": "It&#39;s still an EAP, so there might already be a bug report about this. But even worse, it seems that a \u2019src\u2019 directory doesn&#39;t always work. There seems to be another requirement, but I still have to find out which one."}, {"owner": {"reputation": 572, "user_id": 2461476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a46kg.gif?s=128&g=1", "display_name": "iamtheddrman", "link": "https://stackoverflow.com/users/2461476/iamtheddrman"}, "edited": false, "score": 2, "creation_date": 1490794251, "post_id": 42732874, "comment_id": 73271080, "body": "After doing some additional research, it appears that it&#39;s actually the language that demands your source code be in a src folder. It can technically work without it, but you have to jump through additional hoops. Given that there&#39;s no real package management, it seems like a ridiculous design decision to have all of the code you ever work on in a single folder hierarchy. Working on multiple branches of the same repos becomes next to impossible, and that&#39;s a reality at every company I&#39;ve ever worked for."}], "tags": [], "owner": {"reputation": 35424, "user_id": 81071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a0cc4d1c55ee3ae48437c4e7774355b7?s=128&d=identicon&r=PG", "display_name": "Koraktor", "link": "https://stackoverflow.com/users/81071/koraktor"}, "is_accepted": false, "score": 11, "last_activity_date": 1598550250, "last_edit_date": 1598550250, "creation_date": 1489219435, "answer_id": 42732874, "question_id": 41592892, "link": "https://stackoverflow.com/questions/41592892/how-to-set-up-debugging-in-goland/42732874#42732874", "title": "How to set up debugging in GoLand?", "body": "<p>GoLand will not enable the debug action (although run is available) if your code does not reside inside <code>src</code>. There is no warning about this, so it might be really a pain to solve this.</p>\n<p>Additionally, depending on your project\u2019s structure it might be possible, that debugging is still not working. In that case, it might help to remove all run configurations and create a new one. There\u2019s is a <a href=\"https://youtrack.jetbrains.com/issue/GO-3035\" rel=\"nofollow noreferrer\">bug report</a> about this behavior.</p>\n<p>PS: Although the OP mentions the first part in an edit of the question, but it think it\u2019s worth mentioning in an answer.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4209880, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0vYoO6PP2Xw/AAAAAAAAAAI/AAAAAAAAEkU/9rl7CQI-Y9w/photo.jpg?sz=128", "display_name": "Larsern", "link": "https://stackoverflow.com/users/4209880/larsern"}, "is_accepted": false, "score": 1, "last_activity_date": 1491132530, "creation_date": 1491132530, "answer_id": 43167783, "question_id": 41592892, "link": "https://stackoverflow.com/questions/41592892/how-to-set-up-debugging-in-goland/43167783#43167783", "title": "How to set up debugging in GoLand?", "body": "<p>I had this exact problem. </p>\n\n<p>Deleted and recreated the Debug run configuration. Debugging then worked perfectly.</p>\n"}, {"comments": [{"owner": {"reputation": 2539, "user_id": 1014632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eDDiq.jpg?s=128&g=1", "display_name": "ECH", "link": "https://stackoverflow.com/users/1014632/ech"}, "edited": false, "score": 1, "creation_date": 1605699897, "post_id": 45577231, "comment_id": 114729974, "body": "I&#39;m using GoLand 2020.2.3, and &quot;Go Application&quot; is not an option for a template :("}], "tags": [], "owner": {"reputation": 961, "user_id": 1775688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2f0b.png?s=128&g=1", "display_name": "Jota Santos", "link": "https://stackoverflow.com/users/1775688/jota-santos"}, "is_accepted": false, "score": 5, "last_activity_date": 1502222933, "creation_date": 1502222933, "answer_id": 45577231, "question_id": 41592892, "link": "https://stackoverflow.com/questions/41592892/how-to-set-up-debugging-in-goland/45577231#45577231", "title": "How to set up debugging in GoLand?", "body": "<p>I was facing this same issue and I solved by using the \"Go Application\" configuration (at the Run/Debug Configurations window), instead of the \"Go Single File\" configuration.</p>\n\n<p>So, go to the upper right corner of the Gogland and \"Edit configurations\". </p>\n\n<p><a href=\"https://i.stack.imgur.com/5phkP.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/5phkP.png\" alt=\"Opening the Run/Debug Configurations\"></a></p>\n\n<p>Then, add a new configuration using the \"Go Application\" profile.</p>\n\n<p><a href=\"https://i.stack.imgur.com/D6NWW.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/D6NWW.png\" alt=\"Run/Debug Configurations window\"></a></p>\n\n<p>After saving, you should be able to debug your code. o/</p>\n\n<p>An easy way to enable this configuration is to use the <em>@user1793301</em> method and right click on the file you want to run and select \"Debug 'go run .go'\".</p>\n\n<hr>\n\n<h1>POSSIBLE EXPLANATION</h1>\n\n<p>NOTICE: I did not look any further details about it.</p>\n\n<p><strong>Fact</strong>: \"Go Application\" configuration does build the binary executable before running it.</p>\n\n<p><strong>Fact</strong>: I could see looking at the console output (inside of the Goglang) is that the IDE uses the <a href=\"https://github.com/derekparker/delve\" rel=\"noreferrer\">DLV</a> as debugging tool.</p>\n\n<p><strong>Fact</strong>: I found a <code>dlv debug</code> at the <a href=\"https://github.com/derekparker/delve/blob/master/Documentation/usage/dlv_debug.md\" rel=\"noreferrer\">DLV documentation</a> and it seems to compile and debug the code.</p>\n\n<p><strong>Hypothesis</strong>: The guys from Jetbrains did not implement it. Or at least not <strong>YET</strong>.</p>\n"}, {"comments": [{"owner": {"reputation": 314, "user_id": 5579463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b605f30fa77cd9f62b99fd74c2ce8cf2?s=128&d=identicon&r=PG&f=1", "display_name": "MrR", "link": "https://stackoverflow.com/users/5579463/mrr"}, "edited": false, "score": 0, "creation_date": 1600092056, "post_id": 53853504, "comment_id": 112970759, "body": "Getting &quot;Compiled binary cannot be executed&quot;"}], "tags": [], "owner": {"reputation": 1947, "user_id": 1156067, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/TUkXl.jpg?s=128&g=1", "display_name": "Elad Tabak", "link": "https://stackoverflow.com/users/1156067/elad-tabak"}, "is_accepted": false, "score": 4, "last_activity_date": 1545230338, "creation_date": 1545230338, "answer_id": 53853504, "question_id": 41592892, "link": "https://stackoverflow.com/questions/41592892/how-to-set-up-debugging-in-goland/53853504#53853504", "title": "How to set up debugging in GoLand?", "body": "<p>Things changed in goland since @Jamillo Santos added his reply.</p>\n\n<p>To start with, there's no more \"Go Application\".</p>\n\n<p>The easiest way is to locate the file containing the main() function.\nThere should be a small triangle pointing to it, like in the attached screenshot:\n<a href=\"https://i.stack.imgur.com/bgLrY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bgLrY.png\" alt=\"main function declaration\"></a></p>\n\n<p>When you click on the small green triangle, you get a menu with Run/Debug options.\nEach will create a <code>go build</code> configuration.</p>\n\n<p>You can edit that <code>go build</code> configuration and add the program arguments for your application.\nFor example, if your program have a command line argument of <code>--arg=value</code> you can add it like this:\n<a href=\"https://i.stack.imgur.com/czmye.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/czmye.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 4957, "user_id": 1430394, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/k0jEL.jpg?s=128&g=1", "display_name": "Milkncookiez", "link": "https://stackoverflow.com/users/1430394/milkncookiez"}, "is_accepted": false, "score": 2, "last_activity_date": 1557781654, "creation_date": 1557781654, "answer_id": 56119889, "question_id": 41592892, "link": "https://stackoverflow.com/questions/41592892/how-to-set-up-debugging-in-goland/56119889#56119889", "title": "How to set up debugging in GoLand?", "body": "<p>On version <code>2019.1.1</code> there's no more <em>Go Application</em>. Use <em>Go Build</em> instead. Here I am debugging a single script file, but if you have a server app or smth, just point to the main app file:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pnzqe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pnzqe.png\" alt=\"enter image description here\"></a></p>\n\n<p>Notice that in the <strong>Files</strong> field you have to specify the actual file path. You can put more files (if you want to have more starting points) by separating them with a pipe <code>|</code>. For each file you want to be able to debug, you need to specify the full path.</p>\n\n<p>Again, if you are debugging a server app or something else, that has a single starting point, you only need the startup file specified in the config. :)</p>\n"}], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20473, "favorite_count": 4, "protected_date": 1561992667, "answer_count": 6, "score": 19, "last_activity_date": 1598550250, "creation_date": 1484143199, "last_edit_date": 1537995038, "question_id": 41592892, "link": "https://stackoverflow.com/questions/41592892/how-to-set-up-debugging-in-goland", "title": "How to set up debugging in GoLand?", "body": "<p>I am trying out <a href=\"https://www.jetbrains.com/go/\" rel=\"nofollow noreferrer\">GoLand</a> and hear that the debugger is supposedly awesome, but I can\u2019t find any documentation explaining how to set it up (GoLand is in preview stage, so that\u2019s not really surprising). My use case: I am writing a REST API to which I send requests using curl. Could someone please tell me, step by step, how to get started with the debugger ?</p>\n\n<p>[edit 1] (moved from comment) When I click Run/Debug (or Run/Run), a window is displayed, asking me to edit configurations. I am given a choice of several kinds of configurations, I try to choose \"Go application\" but the Debug button never is grayed and I can't get it to become clickable. I am very new to GoLand, I may be missing something obvious, but I can\u2019t find whatever settings are missing.</p>\n\n<p>[edit 2] It turns out that my workspace did not conform to the Go specifications : my code was not in a directory named src. Now that it is the case, I can click Run/Debug and GoLand seems to be doing the right thing, except it doesn\u2019t stop at breakpoints or otherwise behave like a debugger, my code just runs.</p>\n\n<p>[edit 3] Tried again, and it works. Sort of. I have no idea why it works now, even though it didn\u2019t previously and I didn\u2019t change anything. Now breakpoints work at some lines, and not at others. Or the debugger stops at the breakpoint, but I wait forever for the list of variables to be loaded. Well, it <em>is</em> a preview, after all...</p>\n\n<p>[edit 4] I was notified just today that a new version of GoLand was available. I upgraded, and debugging is working well for me now.</p>\n"}, {"tags": ["html", "file", "go", "download"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484143339, "post_id": 41592848, "comment_id": 70388800, "body": "Please show what you mean by &quot;html is being downloaded instead of file&quot;. What is the case that works?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1484143398, "post_id": 41592848, "comment_id": 70388831, "body": "There is nothing in your code that would send the file content, you only have a single handler which serves an HTML document. See this answer how to serve file content: <a href=\"http://stackoverflow.com/questions/28899675/include-js-file-in-go-template/28899786#28899786\">Include js file in Go template</a>."}, {"owner": {"reputation": 603, "user_id": 3782306, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d2502e2aa71d69d257c0990afd018ff5?s=128&d=identicon&r=PG&f=1", "display_name": "Ezio", "link": "https://stackoverflow.com/users/3782306/ezio"}, "edited": false, "score": 0, "creation_date": 1484143465, "post_id": 41592848, "comment_id": 70388871, "body": "when i am using html and clicking on the link then the file doc.txt is being dowloaded , but when i am serving html from the golang server the file is being downloaded but instead of having the content of the file , it is having the html code which was written to the response writer"}, {"owner": {"reputation": 603, "user_id": 3782306, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d2502e2aa71d69d257c0990afd018ff5?s=128&d=identicon&r=PG&f=1", "display_name": "Ezio", "link": "https://stackoverflow.com/users/3782306/ezio"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1484143572, "post_id": 41592848, "comment_id": 70388937, "body": "@icza when i am using the html file which i provided in the end of the post , in that case i am getting the file, if a particular html is able to send the file , then why not the same html being fed from response writer is doing so ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1484143660, "post_id": 41592848, "comment_id": 70388995, "body": "@Ezio Please read my previous comment carefully. You don&#39;t get file content because nothing in your posted code serves file content. I don&#39;t know the code where you claim you get some, but what you posted should never return any file content."}, {"owner": {"reputation": 603, "user_id": 3782306, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d2502e2aa71d69d257c0990afd018ff5?s=128&d=identicon&r=PG&f=1", "display_name": "Ezio", "link": "https://stackoverflow.com/users/3782306/ezio"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1484143973, "post_id": 41592848, "comment_id": 70389183, "body": "@icza if i am doing &lt;a href=&quot;./publicFolder/doc.txt&quot; download&gt;file&lt;/a&gt; , from html file the file is being downloaded WITH ACTUAL CONTENT OF FILE,   but the same html if i am writing to response writer , then the file is downloaded BUT IT DOESNOT CONTAINS THE CONTENT OF THE FILE but it contains the html code , my main Question is if an html file is doing something correctly , then how come same html written to response writer not doing the same thing"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1484144149, "post_id": 41592848, "comment_id": 70389326, "body": "@Ezio Please show me the part of your code which opens <code>doc.txt</code> and sends its content, because I only see a handler in your code which sends an html document. There isn&#39;t, that&#39;s why it never happens."}, {"owner": {"reputation": 603, "user_id": 3782306, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d2502e2aa71d69d257c0990afd018ff5?s=128&d=identicon&r=PG&f=1", "display_name": "Ezio", "link": "https://stackoverflow.com/users/3782306/ezio"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1484144368, "post_id": 41592848, "comment_id": 70389479, "body": "@icza i have added the doc.txt content for both cases"}, {"owner": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "edited": false, "score": 0, "creation_date": 1484144948, "post_id": 41592848, "comment_id": 70389873, "body": "Programming languages do exactly what you tell them to do. If you want Go to send <code>doc.txt</code>, you <i>must</i> tell it to send <code>doc.txt</code>."}, {"owner": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "edited": false, "score": 0, "creation_date": 1484146146, "post_id": 41592848, "comment_id": 70390715, "body": "<code>http.Dir</code> is a path relative to the current working directory. To avoid problems, use an absolute path."}, {"owner": {"reputation": 603, "user_id": 3782306, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d2502e2aa71d69d257c0990afd018ff5?s=128&d=identicon&r=PG&f=1", "display_name": "Ezio", "link": "https://stackoverflow.com/users/3782306/ezio"}, "reply_to_user": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "edited": false, "score": 0, "creation_date": 1484146312, "post_id": 41592848, "comment_id": 70390827, "body": "@noisypixy the folder publicFolder is inside the current directory only where the server program is stored"}, {"owner": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "edited": false, "score": 0, "creation_date": 1484146632, "post_id": 41592848, "comment_id": 70391050, "body": "@Ezio <code>http.Dir(&quot;.&#47;publicFolder&quot;)</code>"}, {"owner": {"reputation": 603, "user_id": 3782306, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d2502e2aa71d69d257c0990afd018ff5?s=128&d=identicon&r=PG&f=1", "display_name": "Ezio", "link": "https://stackoverflow.com/users/3782306/ezio"}, "reply_to_user": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "edited": false, "score": 0, "creation_date": 1484146794, "post_id": 41592848, "comment_id": 70391169, "body": "@noisypixy i forgot to add that , thank you its worked now :)"}], "answers": [{"comments": [{"owner": {"reputation": 603, "user_id": 3782306, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d2502e2aa71d69d257c0990afd018ff5?s=128&d=identicon&r=PG&f=1", "display_name": "Ezio", "link": "https://stackoverflow.com/users/3782306/ezio"}, "edited": false, "score": 0, "creation_date": 1484145124, "post_id": 41593420, "comment_id": 70390017, "body": "thank you for the answer, i understand what you are saying , so i have added the FileServer but still nothing is happening. i think i am missing something. It would real nice of you if you could please demonstrate what changes to do in my code in order to make the link in html to download the file from server"}, {"owner": {"reputation": 603, "user_id": 3782306, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d2502e2aa71d69d257c0990afd018ff5?s=128&d=identicon&r=PG&f=1", "display_name": "Ezio", "link": "https://stackoverflow.com/users/3782306/ezio"}, "edited": false, "score": 0, "creation_date": 1484145793, "post_id": 41593420, "comment_id": 70390432, "body": "please see the edit, it is having the file server that i have added"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1484146961, "last_edit_date": 1495542831, "creation_date": 1484144786, "answer_id": 41593420, "question_id": 41592848, "link": "https://stackoverflow.com/questions/41592848/what-is-the-difference-between-writing-html-through-response-writer-and-directly/41593420#41593420", "title": "What is the difference between writing html through response writer and directly serving file in golang?", "body": "<p>When you open a <strong>local</strong> HTML file in your browser, then the browser will read the HTML file locally, from your disk. You will see a URL and protocol something like <code>file:///home/bob/test.html</code>. In this case your Go web server is not called (it's excluded from the \"loop\"). Since you use relative paths in the <code>href</code> attributes of your <code>&lt;a&gt;</code> tags, they will also point to local files (<code>file:///</code> protocol), so the browser will also read the linked files <strong>directly</strong>, \"avoiding\" your Go web server.</p>\n\n<p>If you serve the HTML from Go (HTTP handler as in your example), and you access it from the browser, then the browser <strong>will not</strong> read the file, it will perform another HTTP <code>GET</code> as your link <code>&lt;a&gt;</code> dictates. <strong>Your Go server has to read it and send it.</strong></p>\n\n<p>Again, check out this answer how you can serve files from Go: <a href=\"https://stackoverflow.com/questions/28899675/include-js-file-in-go-template/28899786#28899786\">Include js file in Go template</a></p>\n"}, {"tags": [], "owner": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "is_accepted": false, "score": 1, "last_activity_date": 1484146857, "last_edit_date": 1495542831, "creation_date": 1484146857, "answer_id": 41594131, "question_id": 41592848, "link": "https://stackoverflow.com/questions/41592848/what-is-the-difference-between-writing-html-through-response-writer-and-directly/41594131#41594131", "title": "What is the difference between writing html through response writer and directly serving file in golang?", "body": "<p>While <a href=\"https://stackoverflow.com/a/41593420/4475267\">icza's answer</a> is right, let me explain some things.</p>\n\n<blockquote>\n  <p>What is the difference between writing html through response writer and directly serving file in golang?</p>\n</blockquote>\n\n<p>None. You'll be writing to an <a href=\"https://golang.org/src/io/io.go#L90\" rel=\"nofollow noreferrer\"><code>io.Writer</code></a> either way.</p>\n\n<blockquote>\n  <p>i have created links of the file so that when it is clicked , then the file is downloaded</p>\n  \n  <p>But this is not happening , instead the html is being downloaded instead of file</p>\n</blockquote>\n\n<p>This is roughly what is happening under the hood:</p>\n\n<ol>\n<li>You open <code>http://localhost:8008/getFile/</code> in your browser.</li>\n<li>Your browser makes an HTTP request to <code>http://localhost:8008/getFile/</code>.</li>\n<li>Your Go server receives the request. Since it begins with <code>/getFile/</code>, it runs the <code>getFile</code> handler.</li>\n<li>The <code>getFile</code> handler writes HTML back to the browser.</li>\n<li>The browser receives that HTML (the list of files).</li>\n<li>You click in the link for <code>doc.txt</code>.</li>\n<li>The browser makes an HTTP request to <code>http://localhost:8008/getFile/publicFolder/doc.txt</code></li>\n<li>(Same as step 3)</li>\n<li>(Same as step 4)</li>\n<li>(Same as step 5)</li>\n</ol>\n\n<p>You're <strong>never</strong> telling your Go server how to send those files. The <em>only</em> thing you're telling it to do is:</p>\n\n<ul>\n<li>If you get a request, and its path starts with <code>/getFile/</code>, reply with this HTML.</li>\n</ul>\n\n<p>That's the only thing it's doing, and it's doing it fine.</p>\n"}], "owner": {"reputation": 603, "user_id": 3782306, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d2502e2aa71d69d257c0990afd018ff5?s=128&d=identicon&r=PG&f=1", "display_name": "Ezio", "link": "https://stackoverflow.com/users/3782306/ezio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 1, "accepted_answer_id": 41593420, "answer_count": 2, "score": 0, "last_activity_date": 1484146961, "creation_date": 1484143087, "last_edit_date": 1484145767, "question_id": 41592848, "link": "https://stackoverflow.com/questions/41592848/what-is-the-difference-between-writing-html-through-response-writer-and-directly", "title": "What is the difference between writing html through response writer and directly serving file in golang?", "body": "<p>I am new to golang and i am trying to make a server which will fetch the list of files and create an html and write it to the response</p>\n\n<p>i have created links of the file so that when it is clicked , then the file is downloaded</p>\n\n<p>But this is not happening , instead the html is being downloaded instead of file</p>\n\n<p>here is what i am doing</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"io\"\n)\n\nfunc getFile(res http.ResponseWriter, req *http.Request) {\n\n    files, _ := ioutil.ReadDir(\"./publicFolder/\")\n    res.Header().Set(\"Content-Type\", \"text/html; charset=utf-8\")\n\n    myHtml := `\n           &lt;!DOCTYPE html&gt;\n           &lt;html&gt;\n           &lt;head&gt;\n             &lt;title&gt;Home Network&lt;/title&gt;\n           &lt;/head&gt;\n           &lt;body&gt;\n              &lt;ul&gt;`\n    for _, f := range files {\n    fmt.Println(f.Name())\n    myHtml += (`\n        &lt;a href=\"./publicFolder/` + f.Name() + `\" download=\"`+f.Name()+`\" &gt;` + f.Name() + `&lt;/a&gt;`)\n\n    }\n    myHtml += (\n    `\n    &lt;/ul&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;\n    `)  \n    io.WriteString(res, myHtml)\n}\n\nfunc main() {\n    http.HandleFunc(\"/getFile/\", getFile)\n    http.ListenAndServe(\":8008\", nil)\n}\n</code></pre>\n\n<p>i have added download attribute to the html in  tag\nBut the html is being downloaded instead of file</p>\n\n<p>i tried creating an html file and running it , in that case the file is being downloaded</p>\n\n<p>here is the html which i created to test</p>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n       &lt;ul&gt;\n            &lt;li&gt;&lt;a href=\"./publicFolder/doc.txt\" download=\"doc.txt\"&gt;file1&lt;/a&gt;&lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>the content of doc.txt when downloading using the golang server</p>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;\n    &lt;title&gt;\n        Home Network\n    &lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;ul&gt;\n        &lt;li&gt;\n          &lt;a href=\"./publicFolder/GAMES.cpp\" download=\"GAMES.cpp\"&gt;GAMES.cpp&lt;/a&gt;\n        &lt;/li&gt;\n        &lt;li&gt;\n          &lt;a href=\"./publicFolder/doc.txt\" download=\"doc.txt\"&gt;doc.txt&lt;/a&gt;\n        &lt;/li&gt;\n        &lt;li&gt;\n          &lt;a href=\"./publicFolder/erlang\" download=\"erlang\"&gt;erlang&lt;/a&gt;\n        &lt;/li&gt;\n    &lt;/ul&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;\n</code></pre>\n\n<p>Content of doc.txt when downloading from html file(and this is the actual content )</p>\n\n<pre><code>this is a test file doct.txt\n</code></pre>\n\n<p><strong>EDIT</strong>\ni have added this FileServer</p>\n\n<pre><code>http.Handle(\"/getFile/publicFolder/\", http.StripPrefix(\"/getFile/publicFolder/\", http.FileServer(http.Dir(\"/publicFolder\"))))\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1484143094, "post_id": 41592731, "comment_id": 70388674, "body": "File names are relative to the current working directory, not the .go file where the filename is used."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1484143751, "post_id": 41592731, "comment_id": 70389063, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31059023/how-to-reference-a-relative-file-from-code-and-tests/31059125#31059125\">how to reference a relative file from code and tests</a>; and <a href=\"http://stackoverflow.com/questions/38320920/how-to-specify-path-of-template-for-app-engine-with-go-for-unit-testing/38322844#38322844\">How to Specify Path of Template for App Engine with Go for Unit Testing?</a>"}], "owner": {"reputation": 31, "user_id": 3444158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845c5bafc5fb62a29baf929e7220386b?s=128&d=identicon&r=PG&f=1", "display_name": "xcentric", "link": "https://stackoverflow.com/users/3444158/xcentric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1165, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484142698, "creation_date": 1484142698, "question_id": 41592731, "link": "https://stackoverflow.com/questions/41592731/go-template-the-system-cannot-find-the-path-specified", "title": "Go template &quot;The system cannot find the path specified&quot;", "body": "<p>I have a weird problem with Go html template package. I'm getting template parsing error (system can't find the path specified) but it seems that path is ok relative to main.go file (template/base.html).</p>\n\n<p>You can see my project folder structure on this screenshot, and also error that I'm talking about.</p>\n\n<p><a href=\"http://image.prntscr.com/image/42e8e8a6a31c4fe8af11cdc05890636f.png\" rel=\"nofollow noreferrer\">http://image.prntscr.com/image/42e8e8a6a31c4fe8af11cdc05890636f.png</a></p>\n"}, {"tags": ["go", "command-line"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1484141473, "post_id": 41592185, "comment_id": 70387631, "body": "Show the code where you define the flags."}, {"owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "edited": false, "score": 0, "creation_date": 1484141488, "post_id": 41592185, "comment_id": 70387642, "body": "What does the code look like? Do you use the standard flag library? Please provide the code of user.go stripped down to have a working repro"}, {"owner": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "edited": false, "score": 0, "creation_date": 1484141579, "post_id": 41592185, "comment_id": 70387705, "body": "I have added my code in the question, please review. Thanks for the response."}], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "edited": false, "score": 0, "creation_date": 1484141903, "post_id": 41592376, "comment_id": 70387921, "body": "Tried the code. But it is not working. I need to run with the hyphen <code>go run user.go -version</code> like <code>--help</code>."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "edited": false, "score": 0, "creation_date": 1484142105, "post_id": 41592376, "comment_id": 70388055, "body": "I added the complete main function to the answer. Give the exact command that you are running and the output you expect."}, {"owner": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "edited": false, "score": 0, "creation_date": 1484142532, "post_id": 41592376, "comment_id": 70388334, "body": "Yes it&#39;s working. I cannot get the arguments. My  <code>flag.Args()</code> is empty array."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1484141996, "last_edit_date": 1484141996, "creation_date": 1484141673, "answer_id": 41592376, "question_id": 41592185, "link": "https://stackoverflow.com/questions/41592185/how-to-access-command-line-arguments-with-hyphens-but-without-value-in-go-lang/41592376#41592376", "title": "How to access command line arguments with hyphens but without value in Go Lang", "body": "<p>Use a bool. Do not include the \"-\" in the flag definition.</p>\n\n<pre><code>func main() {\n    var version bool\n    flag.BoolVar(&amp;version, \"version\", false, \"prints current version and exits\")\n    flag.Parse()\n    if version {\n        fmt.Println(\"hello\")\n        return\n    }\n    fmt.Println(flag.Args())\n}\n</code></pre>\n"}], "owner": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1177, "favorite_count": 0, "accepted_answer_id": 41592376, "answer_count": 1, "score": 0, "last_activity_date": 1484141996, "creation_date": 1484141176, "last_edit_date": 1484141692, "question_id": 41592185, "link": "https://stackoverflow.com/questions/41592185/how-to-access-command-line-arguments-with-hyphens-but-without-value-in-go-lang", "title": "How to access command line arguments with hyphens but without value in Go Lang", "body": "<p>I want to access command line arguments with hyphens for example:</p>\n\n<pre><code>go run user.go -version\n</code></pre>\n\n<p>or</p>\n\n<pre><code>go run user.go --version\n</code></pre>\n\n<p>When I executing like this, I received the below error:</p>\n\n<pre><code>flag provided but not defined: -version\nUsage of /tmp/go-build354377460/command-line-arguments/_obj/exe/user:\n  --version string\n        prints current version and exits\nexit status 2\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code> package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n)\n\nfunc main() {\n    var version string\n    flag.StringVar(&amp;version, \"-version\", \"\", \"prints current version and exits\")\n\n    // Parse the flags\n    flag.Parse()\n\n    fmt.Println(flag.Args())\n}\n</code></pre>\n\n<p>Any help is greatly appreciated. Thanks in advance.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 3721292, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/64ad8586eb0d834812870a940c1c869f?s=128&d=identicon&r=PG&f=1", "display_name": "yskyj", "link": "https://stackoverflow.com/users/3721292/yskyj"}, "edited": false, "score": 0, "creation_date": 1484412181, "post_id": 41591305, "comment_id": 70503412, "body": "Thanks a lot~ It&#39;s strange that length of slice b is 4 while capacity of this slice is 0."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 141, "user_id": 3721292, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/64ad8586eb0d834812870a940c1c869f?s=128&d=identicon&r=PG&f=1", "display_name": "yskyj", "link": "https://stackoverflow.com/users/3721292/yskyj"}, "edited": false, "score": 0, "creation_date": 1484449781, "post_id": 41591305, "comment_id": 70513477, "body": "The code in the question creates a slice with capacity less than length. Such a slice is not normally allowed, but there are no guarantees of correctness when the unsafe package is used."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 4, "last_activity_date": 1484139062, "last_edit_date": 1484139062, "creation_date": 1484138618, "answer_id": 41591305, "question_id": 41591097, "link": "https://stackoverflow.com/questions/41591097/slice-bounds-out-of-range-when-using-unsafe-pointer/41591305#41591305", "title": "slice bounds out of range when using unsafe.Pointer", "body": "<p>The <a href=\"https://godoc.org/reflect#SliceHeader.Cap\" rel=\"nofollow noreferrer\">capacity</a> of the slice created by <code>StringToBytes</code> is zero.</p>\n\n<p>The for loop does not panic because <a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"nofollow noreferrer\">index expressions</a> check <code>len(b)</code>.</p>\n\n<p>The expression <code>b[1:2]</code> panics because <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">slice expressions</a> check <code>cap(b)</code>.</p>\n\n<p>One fix is to set capacity to the length of the string:</p>\n\n<pre><code>func StringToBytes(s string) []byte {\n    sh := (*reflect.StringHeader)(unsafe.Pointer(&amp;s))\n    bh := reflect.SliceHeader{sh.Data, sh.Len, sh.Len}\n    return *(*[]byte)(unsafe.Pointer(&amp;bh))\n}\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 3721292, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/64ad8586eb0d834812870a940c1c869f?s=128&d=identicon&r=PG&f=1", "display_name": "yskyj", "link": "https://stackoverflow.com/users/3721292/yskyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484139062, "creation_date": 1484138027, "question_id": 41591097, "link": "https://stackoverflow.com/questions/41591097/slice-bounds-out-of-range-when-using-unsafe-pointer", "title": "slice bounds out of range when using unsafe.Pointer", "body": "<p>I am faced up with a curious panic when I trim a byte array using syntax like b[1:2] which is converted from []byte to string and then back to []byte.</p>\n\n<p>My go version is go1.7.3 darwin/amd64. What belows is the detail code.</p>\n\n<pre><code>package main\n\nimport (\n            \"reflect\"\n            \"unsafe\"\n            \"fmt\"\n\n)\n\nfunc BytesToString(b []byte) string {\n    bh := (*reflect.SliceHeader)(unsafe.Pointer(&amp;b))\n    sh := reflect.StringHeader{bh.Data, bh.Len}\n    return *(*string)(unsafe.Pointer(&amp;sh))\n}\n\nfunc StringToBytes(s string) []byte {\n    sh := (*reflect.StringHeader)(unsafe.Pointer(&amp;s))\n    bh := reflect.SliceHeader{sh.Data, sh.Len, 0}\n    return *(*[]byte)(unsafe.Pointer(&amp;bh))\n}\n\nfunc main() {\nb := []byte{'b', 'y', 't', 'e'}\n\n// No1  here you can trim []byte using b[1:2]\n_ = b[1:2]\nfmt.Println(\"No1\")\n\n// convert []byte to string\ns := BytesToString(b)\n\n// convert string to []byte\nb = StringToBytes(s)\n\n// create new []byte variant using content of b\nbb := make([]byte, len(b))\nfor i := 0; i &lt; len(b); i++ {\n    bb[i] = b[i]\n}\n\n// No2 here you also can trim []byte using bb[1:2]\n_ = bb[1:2]\nfmt.Println(\"No2\")\n\n// No3 here you can not trim []byte. I don't know why. why?\n_ = b[1:2]\nfmt.Println(\"No3\")\n\n}\n</code></pre>\n\n<p>Run this code, and get error as follows:</p>\n\n<pre><code> No1\n No2\n panic: runtime error: slice bounds out of range\n\n goroutine 1 [running]:\n panic(0x8f060, 0xc42000a100)\n /usr/local/Cellar/go/1.7.3/libexec/src/runtime/panic.go:500 +0x1a1\n main.main()\n /tmp/unsafe.go:45 +0x274\n exit status 2\n</code></pre>\n\n<p>I'm curious about what caused this panic?   </p>\n"}, {"tags": ["go", "struct", "orm", "dto"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1484136870, "last_edit_date": 1495541336, "creation_date": 1484136870, "answer_id": 41590705, "question_id": 41590571, "link": "https://stackoverflow.com/questions/41590571/structs-with-multiple-mapping-notations/41590705#41590705", "title": "structs with multiple mapping notations", "body": "<p>As mentioned in the documentation of <a href=\"http://golang.org/pkg/reflect/#StructTag\" rel=\"nofollow noreferrer\"><code>reflect.StructTag</code></a>, by convention the value of a tag string is a space-separated <code>key:\"value\"</code> pairs, so simply:</p>\n\n<pre><code>type DriverJson struct {\n    ID   int    `json:\"id\" orm:\"column(id);auto\"`\n    Name string `json:\"name\" orm:\"column(name);size(255);null`\n}\n</code></pre>\n\n<p>For details, see <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">What are the use(s) for tags in Go?</a></p>\n"}], "owner": {"reputation": 2789, "user_id": 664160, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0c7dfdfb981d63a230619d0962c4d91?s=128&d=identicon&r=PG", "display_name": "kambi", "link": "https://stackoverflow.com/users/664160/kambi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 41590705, "answer_count": 1, "score": 1, "last_activity_date": 1484136870, "creation_date": 1484136474, "question_id": 41590571, "link": "https://stackoverflow.com/questions/41590571/structs-with-multiple-mapping-notations", "title": "structs with multiple mapping notations", "body": "<p>I have these two structs which represent the same entities (one comes from a Json file and the other from a DB)</p>\n\n<pre><code>type DriverJson struct {\n    ID            int    `json:\"id\"`\n    Name          string `json:\"name\"`\n}\n\ntype DriverOrm struct {\n    ID            int       `orm:\"column(id);auto\"`\n    Name          string    `orm:\"column(name);size(255);null\"`\n}\n</code></pre>\n\n<p>I want to merge them into one Driver struct, how do I merge the mapping notations (orm:, json:)?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484143063, "post_id": 41589384, "comment_id": 70388659, "body": "I think you have packages in <code>vendor&#47;</code> that don&#39;t have all their dependencies, but you weren&#39;t building them before. Don&#39;t use <code>.&#47;...</code>, install just the packages you want to build."}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484147085, "post_id": 41589384, "comment_id": 70391346, "body": "But everything was working fine when I had all the dependencies under <code>_lib</code>. Also are you saying that I shouldn&#39;t be using <code>go install .&#47;...</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1484147312, "post_id": 41589384, "comment_id": 70391520, "body": "The reason you prefixed <code>_lib</code> with a leading underscore is to make it ignored by the go tools (unless you just happened to do that by sheer luck), which is why it worked before. No, you shouldn&#39;t be using <code>go install .&#47;...</code> in this case. Install just the specific main packages you want built."}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484150621, "post_id": 41589384, "comment_id": 70393655, "body": "Yeah you are right I added <code>_</code> in front of <code>lib</code> for go tools to ignore it.  I have added <code>_lib</code> in <code>$GOPATH</code> in the <code>Makefile</code> so that the dependencies are found during the build. If I get you correctly then since I am doing <code>go install .&#47;...</code> so it is building <code>vendor</code> also that is why it is failing but in case of <code>_libs</code>    these were not getting build. Since I have added all dependencies under <code>vendor</code> can you let me know if is there a way I can build all packages and exclude <code>vendor</code> from getting build?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484151386, "post_id": 41589384, "comment_id": 70394182, "body": "How many main packages do you have? Can you just list the package names? If that&#39;s unreasonable for some reason, you could do something like <code>go install $(go list .&#47;... | grep -v &#47;vendor&#47;)</code>"}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484155316, "post_id": 41589384, "comment_id": 70396710, "body": "I have updated the question with all the package names. I don&#39;t want to add the package names in <code>go install</code> because overtime this will increase and each time a new package is created then this also has to be added in <code>Makefile</code>. I modified my <code>Makefile</code> as you suggested - <code>@go build $(go list .&#47;... | grep -v &#47;vendor&#47;)</code>. But on doing <code>make build</code>  this is giving me the error - <code>can&#39;t load package: package bitbucket.org&#47;myntra&#47;session-service: no buildable Go source files in &#47;Users&#47;debraj&#47;golang&#47;src&#47;bitbucket.org&#47;myntra&#47;session-servic&zwnj;&#8203;e make: *** [build] Error 1</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484156021, "post_id": 41589384, "comment_id": 70397138, "body": "How many &quot;main&quot; packages do you have? Running <code>go install</code> installs all dependencies too, so you don&#39;t need to run it on <i>every</i> possible package.  I don&#39;t know what is causing that error without seeing the contents of that directory. Look at the list of packages you&#39;re installing; look at their contents; make sure you only have what you need vendored, and you don&#39;t have a nested vendor directories (a tool like <code>govendor</code> will help with that)."}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484162969, "post_id": 41589384, "comment_id": 70401008, "body": "The newlines in the output of <code>$(go list .&#47;... | grep -v &#47;vendor&#47;)</code> was causing the problem. So to resolve this I introduced a variable in <code>Makefile</code> <code>PKG = $(shell go list .&#47;... | grep -v &#47;vendor&#47; | tr  &quot;\\n&quot; &quot; &quot;)</code> and then used that variable in <code>go install</code> &amp; <code>go build</code> like <code>@go build $(GOFLAGS) $(PKG)</code>."}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484163009, "post_id": 41589384, "comment_id": 70401031, "body": "@JimB - Can you post all your comments as answer so that I can accept it?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484163795, "post_id": 41589384, "comment_id": 70401464, "body": "I&#39;m not sure why you need to trim that though -- maybe it has to do with the Makefile which I didn&#39;t try (I usually have the Makefile call a shell script for more detailed builds though)"}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484163960, "post_id": 41589384, "comment_id": 70401555, "body": "Without <code>tr</code> all packages are coming in different lines as they are separated by newline causing problem with <code>go install</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484164403, "post_id": 41589384, "comment_id": 70401803, "body": "I&#39;ve also used <code>$$(go list .&#47;... | grep -v vendor&#47;)</code> (in a Makefile), not sure if that makes a difference . Never seen the newline problem though."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1484163613, "creation_date": 1484163613, "answer_id": 41599354, "question_id": 41589384, "link": "https://stackoverflow.com/questions/41589384/resolving-cannot-find-package-error-with-vendor-in-go-1-7/41599354#41599354", "title": "Resolving &#39;cannot find package&#39; error with vendor in go 1.7", "body": "<p>The <code>_libs</code> directory starts with <code>_</code>, and is ignored by the <code>go</code> tool. When you move the packages to <code>vendor/</code>, the <code>./...</code> wildcard now includes all packages in the vendor directory. </p>\n\n<p>You should explicitly list the package you want to install, rather than rely on the <code>./...</code> wildcard. If you still want the wildcard behavior, you can use <code>go list ./...</code> and filter any package containing a <code>vendor/</code> directory in their path. Depending on your specific needs, this could be as simple as:</p>\n\n<pre><code>go install $(go list ./... | grep -v vendor/)\n</code></pre>\n"}], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2474, "favorite_count": 0, "accepted_answer_id": 41599354, "answer_count": 1, "score": 1, "last_activity_date": 1484221861, "creation_date": 1484133150, "last_edit_date": 1484221861, "question_id": 41589384, "link": "https://stackoverflow.com/questions/41589384/resolving-cannot-find-package-error-with-vendor-in-go-1-7", "title": "Resolving &#39;cannot find package&#39; error with vendor in go 1.7", "body": "<p>I have a project structure which looks like below:-</p>\n\n<pre><code>session-service\n    _libs   //Contains all the external dependencies\n    api\n    constants\n    exceptions\n    idgen\n    jsonDecoder\n    log\n    model\n    monitor\n    persistence\n    redis\n    routes\n    src/bddtest/servicetest\n    util\n</code></pre>\n\n<p>Content of <code>_libs</code> looks like below:-</p>\n\n<pre><code>github.com \ngolang.org \n    x\n        net\ngopkg.in\n</code></pre>\n\n<p>My <code>Makefile</code> looks like below:-</p>\n\n<pre><code>.PHONY: deploy\n\nLOGLEVEL ?= 1\nCONFIGFILE ?= 2\nGOFLAGS ?= $(GOFLAGS:)\n\nPWD = $(shell pwd)\nexport GOPATH = $(shell echo $$GOPATH):$(PWD)/_libs:$(PWD)\nexport GOBIN = $(PWD)/bin\nexport GOROOT = $(shell echo $$GOROOT)\n\ndeploy: clean build install \n\nbuild:\n    @rm -rf pkg/ 2&gt;/dev/null\n    @rm -rf _libs/pkg/ 2&gt;/dev/null\n    @go build $(GOFLAGS) ./...\n\ninstall:\n    @go install ./...\n\nclean:\n    @go clean $(GOFLAGS) -i ./...\n\n\n## EOF\n</code></pre>\n\n<p>Everything is working fine. Now I am thinking of moving to <code>vendor</code>. So I renamed my <code>_libs</code> to <code>vendor</code> and modified my <code>Makefile</code> like below:-</p>\n\n<pre><code>export GOPATH = $(shell echo $$GOPATH):$(PWD)\n</code></pre>\n\n<p>But after this I started getting the following error:-</p>\n\n<pre><code>vendor/golang.org/x/net/html/charset/charset.go:20:2: cannot find package \"golang.org/x/text/encoding\" in any of:\n        /Users/debraj/golang/src/b/m/session-service/vendor/golang.org/x/text/encoding (vendor tree)\n        /usr/local/go/src/golang.org/x/text/encoding (from $GOROOT)\n        /Users/debraj/golang/src/golang.org/x/text/encoding (from $GOPATH)\n        /Users/debraj/golang/src/b/m/session-service/src/golang.org/x/text/encoding\n    vendor/golang.org/x/net/html/charset/charset.go:21:2: cannot find package \"golang.org/x/text/encoding/charmap\" in any of:\n        /Users/debraj/golang/src/b/m/session-service/vendor/golang.org/x/text/encoding/charmap (vendor tree)\n        /usr/local/go/src/golang.org/x/text/encoding/charmap (from $GOROOT)\n        /Users/debraj/golang/src/golang.org/x/text/encoding/charmap (from $GOPATH)\n        /Users/debraj/golang/src/b/m/session-service/src/golang.org/x/text/encoding/charmap\n    vendor/golang.org/x/net/html/charset/charset.go:22:2: cannot find package \"golang.org/x/text/encoding/htmlindex\" in any of:\n        /Users/debraj/golang/src/b/m/session-service/vendor/golang.org/x/text/encoding/htmlindex (vendor tree)\n        /usr/local/go/src/golang.org/x/text/encoding/htmlindex (from $GOROOT)\n        /Users/debraj/golang/src/golang.org/x/text/encoding/htmlindex (from $GOPATH)\n        /Users/debraj/golang/src/b/m/session-service/src/golang.org/x/text/encoding/htmlindex\n    vendor/golang.org/x/net/html/charset/charset.go:23:2: cannot find package \"golang.org/x/text/transform\" in any of:\n        /Users/debraj/golang/src/b/m/session-service/vendor/golang.org/x/text/transform (vendor tree)\n        /usr/local/go/src/golang.org/x/text/transform (from $GOROOT)\n        /Users/debraj/golang/src/golang.org/x/text/transform (from $GOPATH)\n        /Users/debraj/golang/src/b/m/session-service/src/golang.org/x/text/transform\n    vendor/golang.org/x/net/http2/h2i/h2i.go:38:2: cannot find package \"golang.org/x/crypto/ssh/terminal\" in any of:\n        /Users/debraj/golang/src/b/m/session-service/vendor/golang.org/x/crypto/ssh/terminal (vendor tree)\n        /usr/local/go/src/golang.org/x/crypto/ssh/terminal (from $GOROOT)\n        /Users/debraj/golang/src/golang.org/x/crypto/ssh/terminal (from $GOPATH)\n        /Users/debraj/golang/src/b/m/session-service/src/golang.org/x/crypto/ssh/terminal\n</code></pre>\n\n<p>Environment:-</p>\n\n<ul>\n<li>go version go1.7.3 darwin/amd64</li>\n<li>Mac OS X 10.11.6 </li>\n</ul>\n\n<p>Can someone let me know why I am getting the above errors with <code>vendor</code> but everything works fine with <code>_libs</code>?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>In my local the newlines in the output of <code>$(go list ./... | grep -v /vendor/)</code> was causing some problem. So to resolve this I had to modify the <code>jimb</code> 's solution a bit. I introduced a variable in <code>Makefile</code> <code>PKG = $(shell go list ./... | grep -v /vendor/ | tr \"\\n\" \" \")</code> and then used that variable in <code>go install</code> &amp; <code>go build</code> like <code>@go build $(GOFLAGS) $(PKG)</code></p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1484133390, "post_id": 41589055, "comment_id": 70382340, "body": "How could that possibly be?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1484133328, "last_edit_date": 1484133328, "creation_date": 1484132980, "answer_id": 41589322, "question_id": 41589055, "link": "https://stackoverflow.com/questions/41589055/how-we-can-know-what-kind-of-struct-is-on-byte-array/41589322#41589322", "title": "How we can know what kind of struct is on byte array", "body": "<p>Since the <a href=\"https://golang.org/pkg/encoding/binary/\" rel=\"nofollow noreferrer\"><code>encoding/binary</code></a> package does not write out type information, it is not possible to tell what type was written / serialized.</p>\n\n<p>And you're in a worse position that you might originally think: even trying to decode into a value of different type might succeed without errors, so there isn't even a reliable way to tell the type.</p>\n\n<p>For example if you serialize a value of this type:</p>\n\n<pre><code>type T struct {\n    A int64\n    B float64\n}\n</code></pre>\n\n<p>You can read it into a value of this type:</p>\n\n<pre><code>type T2 struct {\n    B float64\n    A int64\n}\n</code></pre>\n\n<p>It will give no errors because the size of both structs is the same, but obviously you will get different numbers in the fields.</p>\n\n<p>You are in a little better position if you use <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\"><code>encoding/gob</code></a>, as the <code>gob</code> package does transmit type information, and encoding a value of type <code>T</code> and then decoding it into a value of type <code>T2</code> would work: order of fields does not matter, and extra or missing fields also do not cause trouble.</p>\n\n<p>See this example:</p>\n\n<pre><code>// Create a struct and write it.\nt := T{A: 0xEEFFEEFF, B: 3.14}\nfmt.Println(\"Encoding:\", t)\nbuf := &amp;bytes.Buffer{}\nfmt.Println(binary.Write(buf, binary.BigEndian, t))\nfmt.Println(buf.Bytes())\n\nfmt.Println(gob.NewEncoder(buf).Encode(t))\n\nt2 := T2{}\nfmt.Println(binary.Read(buf, binary.BigEndian, &amp;t2))\nfmt.Println(t2)\n\nt2 = T2{}\nfmt.Println(gob.NewDecoder(buf).Decode(&amp;t2))\nfmt.Println(t2)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/GL3eM9mvqN\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Encoding: {4009750271 3.14}\n&lt;nil&gt;\n[0 0 0 0 238 255 238 255 64 9 30 184 81 235 133 31]\n&lt;nil&gt;\n&lt;nil&gt;\n{1.9810798573e-314 4614253070214989087}\n&lt;nil&gt;\n{3.14 4009750271}\n</code></pre>\n\n<p>If you want to be able to detect the type before reading it, you have to take care of it yourself: you have to transmit type information (e.g. name of the type). Or even better, use a serialization method that already does this, for example <a href=\"https://developers.google.com/protocol-buffers/\" rel=\"nofollow noreferrer\">Google's protocol buffers</a>, and here is the Go implementation for it: <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow noreferrer\">github.com/golang/protobuf</a>.</p>\n"}], "owner": {"reputation": 76, "user_id": 3569115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBnyQ.jpg?s=128&g=1", "display_name": "dferreira", "link": "https://stackoverflow.com/users/3569115/dferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 41589322, "answer_count": 1, "score": 0, "last_activity_date": 1484133328, "creation_date": 1484132365, "question_id": 41589055, "link": "https://stackoverflow.com/questions/41589055/how-we-can-know-what-kind-of-struct-is-on-byte-array", "title": "How we can know what kind of struct is on byte array", "body": "<p>I'm looking for some solution to know whats the struct type of the hash. It is possible to do that without try an error method (casting to a specific type and see the cast is successfully)? </p>\n\n<p>Please check the code:</p>\n\n<pre><code>import (\n    \"bytes\"\n    \"encoding/binary\"\n    \"fmt\"\n    \"reflect\"\n)\n\ntype T struct {\n    A int64\n    B float64\n}\n\ntype D struct {\n    A int64\n    B float64\n    C string\n}\n\n\nfunc main() {\n    // Create a struct and write it.\n    t := T{A: 0xEEFFEEFF, B: 3.14}\n    buf := &amp;bytes.Buffer{}\n    err := binary.Write(buf, binary.BigEndian, t)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(buf.Bytes())\n\n    out := getType(buf)\n    fmt.Println(out)\n}\n\nfunc getType(v interface{})(r string){\n    fmt.Println(reflect.TypeOf(v))\n    switch t := v.(type) {\n        case T:\n            return \"Is type T\"\n        case D:\n            return \"Is type D\"\n        default:\n            _ = t\n            return \"unknown\"\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 295, "user_id": 5808696, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8c890a9b7033dcd196b0e007cb9aa854?s=128&d=identicon&r=PG&f=1", "display_name": "caibirdme", "link": "https://stackoverflow.com/users/5808696/caibirdme"}, "edited": false, "score": 0, "creation_date": 1484136696, "post_id": 41588662, "comment_id": 70384501, "body": "What will u do if u are asked to develop a software which is used to complie other&#39;s project?Maybe what u received is only a <code>main.go</code>,what should u do next?Analyze this source code yourself and fetch the dependencies remotely one by one?I just want to know if there&#39;s a simple way to get the missing dependencies or I need to do it my own"}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "reply_to_user": {"reputation": 295, "user_id": 5808696, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8c890a9b7033dcd196b0e007cb9aa854?s=128&d=identicon&r=PG&f=1", "display_name": "caibirdme", "link": "https://stackoverflow.com/users/5808696/caibirdme"}, "edited": false, "score": 0, "creation_date": 1484406811, "post_id": 41588662, "comment_id": 70501677, "body": "@caibirdme if you like the job patience and hard work is the key, otherwise quit as soon as possible."}], "tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 1, "last_activity_date": 1484131330, "creation_date": 1484131330, "answer_id": 41588662, "question_id": 41588508, "link": "https://stackoverflow.com/questions/41588508/how-to-check-the-missing-dependencies-in-golang/41588662#41588662", "title": "how to check the missing dependencies in golang", "body": "<p>Since Go is compiled language so in order to see if your code has an error or missing dependencies is by compiling your code. <br>\nYou can use <code>go get</code> as an alternative of <code>go build</code> to see your missing dependencies.</p>\n\n<p>some reference from <a href=\"https://golang.org/doc/\" rel=\"nofollow noreferrer\">doc</a></p>\n\n<blockquote>\n  <p>Go compiles quickly to machine code yet has the convenience of garbage\n  collection and the power of run-time reflection. It's a fast,\n  statically typed, compiled language that feels like a dynamically\n  typed, interpreted language.</p>\n</blockquote>\n"}], "owner": {"reputation": 295, "user_id": 5808696, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8c890a9b7033dcd196b0e007cb9aa854?s=128&d=identicon&r=PG&f=1", "display_name": "caibirdme", "link": "https://stackoverflow.com/users/5808696/caibirdme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1484131330, "creation_date": 1484130961, "question_id": 41588508, "link": "https://stackoverflow.com/questions/41588508/how-to-check-the-missing-dependencies-in-golang", "title": "how to check the missing dependencies in golang", "body": "<p>How can I know what are the missing dependencies in a go project?\nNow the only way I know is to run the <code>go build</code> command and follow the error messages.</p>\n\n<p>But is there any more efficient way to do that such as:</p>\n\n<p><code>\n./a.out proj\n</code></p>\n\n<p>and the return maybe like:</p>\n\n<p><code>\nmissing dependencies:\ngithub.com/go-sql-driver/mysql\ngithub.com/foo/bar\n....\n</code>\nDoes <code>go build</code> support this function?</p>\n"}, {"tags": ["go", "deployment", "installation"], "answers": [{"comments": [{"owner": {"reputation": 338, "user_id": 4142018, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b54734016ab9dcf104695a6a749dd690?s=128&d=identicon&r=PG&f=1", "display_name": "user4142018", "link": "https://stackoverflow.com/users/4142018/user4142018"}, "edited": false, "score": 0, "creation_date": 1484129624, "post_id": 41587880, "comment_id": 70379775, "body": "Do you know how to run the binary using OpanStack for clients ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 338, "user_id": 4142018, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b54734016ab9dcf104695a6a749dd690?s=128&d=identicon&r=PG&f=1", "display_name": "user4142018", "link": "https://stackoverflow.com/users/4142018/user4142018"}, "edited": false, "score": 0, "creation_date": 1484129973, "post_id": 41587880, "comment_id": 70380024, "body": "@user4142018 No. That may be posted as a new question. Or it may be more suitable to ask on their forum."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1484132192, "last_edit_date": 1495540373, "creation_date": 1484129199, "answer_id": 41587880, "question_id": 41587816, "link": "https://stackoverflow.com/questions/41587816/how-to-run-a-go-file-on-client-machine/41587880#41587880", "title": "How to run a Go file on client machine?", "body": "<p>Go is a <a href=\"https://en.wikipedia.org/wiki/Compiled_language\" rel=\"nofollow noreferrer\">compiled language</a>. You can use the Go tools to compile your Go app to an executable binary. Once you have the executable binary, you can run it as-is, the Go installation is not needed / used anymore. Since Go is <a href=\"https://en.wikipedia.org/wiki/Static_library\" rel=\"nofollow noreferrer\">statically linked</a>, all the dependencies will be compiled / linked into the executable.</p>\n\n<p>More specifically:</p>\n\n<ul>\n<li>use <code>go install</code> to compile your app and \"install\" the executable binary to your <code>$GOPATH/bin</code> folder</li>\n<li>or use <code>go build</code> to compile your app and get the executable binary in the <em>current working directory</em></li>\n</ul>\n\n<p>Read <a href=\"https://stackoverflow.com/questions/30612611/what-does-go-build-build\">What does go build build?</a> for more details.</p>\n\n<p>All you need is to pass on the executable binary to your customer. If your app uses static files, of course you have to pass them too, preferably packed into one compressed file.</p>\n\n<p>Note that an executable binary targets a specific platform. You have to consult your customer about what platform he intends to run your app on, and compile your app to that specific platform.</p>\n\n<p>The target OS and platform can be set using the <code>GOOS</code> and <code>GOARCH</code> environment variables. For example, if your customer wants to run your app on Windows amd64, you can produce a Windows amd64 executable like this:</p>\n\n<pre><code>GOOS=windows GOARCH=amd64 go build\n</code></pre>\n\n<p>For a list of valid <code>GOOS</code> and <code>GOARCH</code> values, see <a href=\"https://stackoverflow.com/questions/37302211/how-can-i-build-for-linux-32-bit-with-go1-6-2/37302937#37302937\">How can I build for linux 32-bit with go1.6.2</a>.</p>\n"}], "owner": {"reputation": 338, "user_id": 4142018, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b54734016ab9dcf104695a6a749dd690?s=128&d=identicon&r=PG&f=1", "display_name": "user4142018", "link": "https://stackoverflow.com/users/4142018/user4142018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484132192, "creation_date": 1484129036, "last_edit_date": 1484131087, "question_id": 41587816, "link": "https://stackoverflow.com/questions/41587816/how-to-run-a-go-file-on-client-machine", "title": "How to run a Go file on client machine?", "body": "<p>I have a Go file and I would like to give it to the customers. The customers should be able to execute using a command in terminal. They will not install Go lang in their system.</p>\n\n<p>How to do run this binary file in clients machine? Please help me.</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 5, "creation_date": 1484106244, "post_id": 41582210, "comment_id": 70369227, "body": "why do you need an infinite loop to store one url ? and the same for LoadUrl? have you tried this code in your local machine ?"}, {"owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1484106352, "post_id": 41582210, "comment_id": 70369269, "body": "Yes I tried this code in my local machine, I took it largely froom a SO question, <a href=\"http://stackoverflow.com/a/38140573/132728\">stackoverflow.com/a/38140573/132728</a>"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1484113744, "post_id": 41582210, "comment_id": 70371506, "body": "@Max Both the infinite loops are unnecessary. They will cause <a href=\"https://dave.cheney.net/2016/12/22/never-start-a-goroutine-without-knowing-how-it-will-stop\" rel=\"nofollow noreferrer\">goroutine leakage</a>."}], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "edited": false, "score": 0, "creation_date": 1484109431, "post_id": 41582742, "comment_id": 70370052, "body": "What about replacing the sleep instruction for runtime.Gosched()? it would yield the processor and would be more meaningful than just sleeping <a href=\"https://godoc.org/runtime#Gosched\" rel=\"nofollow noreferrer\">godoc.org/runtime#Gosched</a>"}, {"owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "edited": false, "score": 0, "creation_date": 1485158466, "post_id": 41582742, "comment_id": 70790839, "body": "What&#39;s the difference between this code and my code w/r to the infinite loops? Dont they also cause &quot;goroutine leakage&quot;, as some dude commented?"}], "tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": true, "score": 1, "last_activity_date": 1484109773, "last_edit_date": 1484109773, "creation_date": 1484109116, "answer_id": 41582742, "question_id": 41582210, "link": "https://stackoverflow.com/questions/41582210/reading-from-map-with-locks-doesnt-return-value-via-channel/41582742#41582742", "title": "Reading from map with locks doesn&#39;t return value via channel", "body": "<p>Infinite loops without sleep or some kind of IO are always bad idea.</p>\n\n<p>In your code if you put a print statement at the start of <code>StoreUrl</code>, you will find that it never gets printed i.e the go routine was never started, the go call is setting putting the info about this new go routine in some run queue of the go scheduler but the scheduler hasn't ran yet to schedule that task. How do you run the scheduler? Do sleep/IO/channel reading/writing.</p>\n\n<p>Another problem is that your infinite loop is taking lock and trying to take the lock again, which will cause it to deadlock. Defer only run after function exit and that function will never exit because of infinite loop.</p>\n\n<p>Below is modified code that uses sleep to make sure every execution thread gets time to do its job.</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"fmt\"\n    \"time\"\n)\n\nvar m = map[int]string{}\nvar lock = sync.RWMutex{}\n\nfunc StoreUrl(id int, url string) {\n        for {\n                lock.Lock()\n                m[id] = url\n                lock.Unlock()\n                time.Sleep(1)\n        }\n}\n\nfunc LoadUrl(id int, ch chan string) {\n    for {\n            lock.RLock()\n            r := m[id]\n            lock.RUnlock()\n            ch &lt;- r\n\n    }\n}\n\nfunc main() {\n    go StoreUrl(125, \"www.google.com\")\n    time.Sleep(1)\n    chb := make(chan string)\n    go LoadUrl(125, chb);\n\n    C := &lt;-chb\n    fmt.Println(\"Result:\", C)\n}\n</code></pre>\n\n<p><strong>Edit:</strong> As @Jaun mentioned in the comment, you can also use <code>runtime.Gosched()</code> instead of sleep.</p>\n"}, {"comments": [{"owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "edited": false, "score": 0, "creation_date": 1484116662, "post_id": 41582759, "comment_id": 70372653, "body": "I don&#39;t know why but your solution caused hanging of the applicatin when used in a server application."}, {"owner": {"reputation": 11, "user_id": 7235244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uChTk.png?s=128&g=1", "display_name": "blue-white", "link": "https://stackoverflow.com/users/7235244/blue-white"}, "reply_to_user": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "edited": false, "score": 0, "creation_date": 1484117992, "post_id": 41582759, "comment_id": 70373228, "body": "add time.Sleep() in every for statement(<a href=\"https://play.golang.org/p/-zzDfFIq-S\" rel=\"nofollow noreferrer\">play.golang.org/p/-zzDfFIq-S</a>) or run in your own machine"}], "tags": [], "owner": {"reputation": 11, "user_id": 7235244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uChTk.png?s=128&g=1", "display_name": "blue-white", "link": "https://stackoverflow.com/users/7235244/blue-white"}, "is_accepted": false, "score": 1, "last_activity_date": 1484109217, "creation_date": 1484109217, "answer_id": 41582759, "question_id": 41582210, "link": "https://stackoverflow.com/questions/41582210/reading-from-map-with-locks-doesnt-return-value-via-channel/41582759#41582759", "title": "Reading from map with locks doesn&#39;t return value via channel", "body": "<p>Usage of defer incorrect, defer execute at end of function, not for statement.</p>\n\n<pre><code>func StoreUrl(id int, url string) {\n    for {\n        func() {\n            lock.Lock()\n            defer lock.Unlock()\n            m[id] = url\n        }()\n    }\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>func StoreUrl(id int, url string) {\n    for {\n        lock.Lock()\n        m[id] = url\n        lock.Unlock()\n    }\n}\n</code></pre>\n\n<p>We can't control the order of go routine, so add time.Sleep() to control the order.</p>\n\n<p>code here:</p>\n\n<p><a href=\"https://play.golang.org/p/Bu8Lo46SA2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Bu8Lo46SA2</a></p>\n"}], "owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 41582742, "answer_count": 2, "score": -1, "last_activity_date": 1484134093, "creation_date": 1484105261, "last_edit_date": 1484134093, "question_id": 41582210, "link": "https://stackoverflow.com/questions/41582210/reading-from-map-with-locks-doesnt-return-value-via-channel", "title": "Reading from map with locks doesn&#39;t return value via channel", "body": "<p>I tried to implement a locking version of reading/writing from a map in golang, but it doesn't return the desired result. </p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"sync\"\n    \"fmt\"\n)\n\nvar m = map[int]string{}\nvar lock = sync.RWMutex{}\n\nfunc StoreUrl(id int, url string) {\n        for {\n                lock.Lock()\n                defer lock.Unlock()\n\n                m[id] = url\n        }\n}\n\nfunc LoadUrl(id int, ch chan string) {\n    for {\n        lock.RLock()\n        defer lock.RUnlock()\n\n        r := m[id]\n        ch &lt;- r\n    }\n}\n\nfunc main() {\n    go StoreUrl(125, \"www.google.com\")\n\n    chb := make(chan string)\n    go LoadUrl(125, chb);\n\n    C := &lt;-chb\n    fmt.Println(\"Result:\", C)                           \n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Result: \n</code></pre>\n\n<p>Meaning the value is not returned via the channel, which I don't get. Without the locking/goroutines it seems to work fine. What did I do wrong?</p>\n\n<p>The code can also be found here:</p>\n\n<p><a href=\"https://play.golang.org/p/-WmRcMty5B\" rel=\"nofollow noreferrer\">https://play.golang.org/p/-WmRcMty5B</a></p>\n"}, {"tags": ["go", "interface"], "answers": [{"tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 1, "last_activity_date": 1484100500, "creation_date": 1484100500, "answer_id": 41581606, "question_id": 41581309, "link": "https://stackoverflow.com/questions/41581309/golang-method-receiver/41581606#41581606", "title": "Golang method receiver", "body": "<p>if you wanted to use a method that has pointer receiver. It means you have to pass the address value. </p>\n\n<p>here is the example : </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Modifiable interface {\n    modify()\n}\n\ntype Test struct {\n    a int\n}\n\nfunc (test *Test) modify() {\n    test.a++\n}\n\nfunc main() {\n    test := Test{10}\n    fmt.Println(test)\n    test.modify()\n    fmt.Println(test)\n\n    var a Modifiable\n\n    a = &amp;test\n    a.modify()\n    fmt.Println(a)\n}\n</code></pre>\n\n<p>In conclusion an interface will accept the address value whenever you create a pointer receiver in the method.</p>\n"}, {"comments": [{"owner": {"reputation": 990, "user_id": 3994063, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Q2t9Z.jpg?s=128&g=1", "display_name": "KIDJourney", "link": "https://stackoverflow.com/users/3994063/kidjourney"}, "edited": false, "score": 0, "creation_date": 1484111606, "post_id": 41582818, "comment_id": 70370766, "body": "But the <code>test</code> variable do have a method called <code>modify</code> and i can call by <code>test.modify()</code>, why it said <code>Test does not implement Modifiable</code>?"}, {"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "reply_to_user": {"reputation": 990, "user_id": 3994063, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Q2t9Z.jpg?s=128&g=1", "display_name": "KIDJourney", "link": "https://stackoverflow.com/users/3994063/kidjourney"}, "edited": false, "score": 0, "creation_date": 1484112229, "post_id": 41582818, "comment_id": 70370984, "body": "Because you implemented the interface on <code>*Test</code> and not <code>Test</code>. The <code>modify</code> method is defined for <code>*Test</code> and not for <code>Test</code> type. When you are calling <code>test.modify</code> the compiler will automatically pass a <code>*Test</code> but from interface implementation point of view you need to explicitly use <code>*Test</code>"}, {"owner": {"reputation": 990, "user_id": 3994063, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Q2t9Z.jpg?s=128&g=1", "display_name": "KIDJourney", "link": "https://stackoverflow.com/users/3994063/kidjourney"}, "edited": false, "score": 0, "creation_date": 1484118423, "post_id": 41582818, "comment_id": 70373409, "body": "So the answer in given link is wrong , the method for <code>Test</code> is not generated ? What compiler really do is pass the pointer to <code>pointer-method</code> instead of calling the non-exist generating method ."}, {"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "reply_to_user": {"reputation": 990, "user_id": 3994063, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Q2t9Z.jpg?s=128&g=1", "display_name": "KIDJourney", "link": "https://stackoverflow.com/users/3994063/kidjourney"}, "edited": false, "score": 1, "creation_date": 1484118649, "post_id": 41582818, "comment_id": 70373500, "body": "Yes, no method is generated. Check out <a href=\"https://tour.golang.org/methods/6\" rel=\"nofollow noreferrer\">tour.golang.org/methods/6</a> and <a href=\"https://tour.golang.org/methods/7\" rel=\"nofollow noreferrer\">tour.golang.org/methods/7</a>"}, {"owner": {"reputation": 990, "user_id": 3994063, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Q2t9Z.jpg?s=128&g=1", "display_name": "KIDJourney", "link": "https://stackoverflow.com/users/3994063/kidjourney"}, "edited": false, "score": 0, "creation_date": 1484123740, "post_id": 41582818, "comment_id": 70375984, "body": "Thanks a lot. @Ankur"}], "tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": true, "score": 1, "last_activity_date": 1484109604, "creation_date": 1484109604, "answer_id": 41582818, "question_id": 41581309, "link": "https://stackoverflow.com/questions/41581309/golang-method-receiver/41582818#41582818", "title": "Golang method receiver", "body": "<p>When you said:</p>\n\n<pre><code>func (test *Test) modify() {\n    test.a++\n}\n</code></pre>\n\n<p>It means the interface <code>Modifiable</code> is implemented by the type <code>*Test</code> aka the <em>Pointer to Test</em></p>\n\n<p>Where as </p>\n\n<pre><code>func (test Test) modify() {\n        test.a++\n}\n</code></pre>\n\n<p>means that the interface is implemented by the type <code>Test</code></p>\n\n<p>Conclusion is: A type and a pointer to that type are 2 different types.</p>\n"}], "owner": {"reputation": 990, "user_id": 3994063, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Q2t9Z.jpg?s=128&g=1", "display_name": "KIDJourney", "link": "https://stackoverflow.com/users/3994063/kidjourney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1414, "favorite_count": 0, "accepted_answer_id": 41582818, "answer_count": 2, "score": 2, "last_activity_date": 1484120597, "creation_date": 1484098056, "last_edit_date": 1495541239, "question_id": 41581309, "link": "https://stackoverflow.com/questions/41581309/golang-method-receiver", "title": "Golang method receiver", "body": "<p>According <a href=\"https://stackoverflow.com/questions/15096329/golang-pointers\">this question</a>, golang will generate both <code>type-receiver method</code> and <code>point-receiver method</code>, which means the code below will work correctly and the value will change unexpectedly.</p>\n\n<pre><code>func (test *Test) modify() {\n    test.a++\n}\n\nfunc main() {\n    test := Test{10}\n    fmt.Println(test)\n    test.modify()\n    fmt.Println(test)\n}\n</code></pre>\n\n<p>I think it's acceptable to me. But when this mixes with interface, thing goes wrong. </p>\n\n<pre><code>type Modifiable interface {\n    modify()\n}\n\ntype Test struct {\n    a int\n}\n\nfunc (test *Test) modify() {\n    test.a++\n}\n\nfunc main() {\n    test := Test{10}\n    fmt.Println(test)\n    test.modify()\n    fmt.Println(test)\n\n    var a Modifiable\n\n    a = test\n}\n</code></pre>\n\n<p>it said:</p>\n\n<pre><code>Test does not implement Modifiable (modify method has pointer receiver)\n</code></pre>\n\n<p>Why will this happen ?</p>\n\n<p>And how golang actually handle method call ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 2932773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eae6fb56fdc606e2075abe985131bc1?s=128&d=identicon&r=PG&f=1", "display_name": "abMyn", "link": "https://stackoverflow.com/users/2932773/abmyn"}, "edited": false, "score": 0, "creation_date": 1484788347, "post_id": 41580134, "comment_id": 70658596, "body": "Hi Niko, Thanks for your reply. All methods of instance ws (path, consumes, produces, Route, POST, To, Param, BodyParameter, DataType) are not being recognized however there was no error while creating ws. Same issue with the req. All methods are not being recognized. What could be the issue"}, {"owner": {"reputation": 33, "user_id": 2932773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eae6fb56fdc606e2075abe985131bc1?s=128&d=identicon&r=PG&f=1", "display_name": "abMyn", "link": "https://stackoverflow.com/users/2932773/abmyn"}, "edited": false, "score": 0, "creation_date": 1484853561, "post_id": 41580134, "comment_id": 70692204, "body": "No issues after restarting IDE."}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "reply_to_user": {"reputation": 33, "user_id": 2932773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eae6fb56fdc606e2075abe985131bc1?s=128&d=identicon&r=PG&f=1", "display_name": "abMyn", "link": "https://stackoverflow.com/users/2932773/abmyn"}, "edited": false, "score": 0, "creation_date": 1484936541, "post_id": 41580134, "comment_id": 70731483, "body": "Good to hear. Which IDE are you using?"}], "tags": [], "owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "is_accepted": false, "score": 0, "last_activity_date": 1484091147, "last_edit_date": 1484091147, "creation_date": 1484090164, "answer_id": 41580134, "question_id": 41579963, "link": "https://stackoverflow.com/questions/41579963/exposing-webapi-to-thirdparty-which-accepts-json-and-or-parameters-using-golang/41580134#41580134", "title": "exposing webapi to thirdparty which accepts json and/or parameters using Golang", "body": "<p>An http package that wraps \"net/http\" will be helpful. Examples:</p>\n\n<p><a href=\"https://github.com/emicklei/go-restful\" rel=\"nofollow noreferrer\">https://github.com/emicklei/go-restful</a></p>\n\n<p><a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\">https://github.com/gin-gonic/gin</a></p>\n\n<p>Here is a simple service to get you started:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/emicklei/go-restful\"\n    \"log\"\n    \"net/http\"\n)\n\ntype User struct {\n    Name string\n}\n\nfunc postOne(req *restful.Request, resp *restful.Response) {\n    newUser := new(User)\n    err := req.ReadEntity(newUser)\n    if err != nil {\n        resp.WriteErrorString(http.StatusBadRequest, err.Error())\n        return\n    }\n\n    log.Printf(\"new user: '%v'\", newUser)\n}\n\nfunc main() {\n    ws := new(restful.WebService)\n    ws.Path(\"/users\")\n    ws.Consumes(restful.MIME_JSON)\n    ws.Produces(restful.MIME_JSON)\n\n    ws.Route(ws.POST(\"\").To(postOne).\n        Param(ws.BodyParameter(\"User\", \"A User\").DataType(\"main.User\")))\n\n   restful.Add(ws)\n\n  http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Here is a curl to test the service by posting a single user:</p>\n\n<pre><code>curl -v -H \"Content-Type: application/json\" -XPOST \"localhost:8080/users\" -d '{\"name\": \"Joe\"}'\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 2932773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eae6fb56fdc606e2075abe985131bc1?s=128&d=identicon&r=PG&f=1", "display_name": "abMyn", "link": "https://stackoverflow.com/users/2932773/abmyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484091147, "creation_date": 1484089239, "question_id": 41579963, "link": "https://stackoverflow.com/questions/41579963/exposing-webapi-to-thirdparty-which-accepts-json-and-or-parameters-using-golang", "title": "exposing webapi to thirdparty which accepts json and/or parameters using Golang", "body": "<p>I started learning GoLang recently. My aim is to expose a webapi. This should be able to accept a json object and should respond with another json object. I am not finding enough resources to learn how to get this working. I really appreciate any help in this regard. A piece of my code is like below.</p>\n\n<pre><code>func HelloService(res http.ResponseWriter, req *http.Request){\nio.WriteString(res,\"Welcome to service\")\n}\n\nfunc main(){\n    http.HandleFunc(\"/\", HelloService)\n    http.ListenAndServe(\":8080\",nil)\n    http.HandleFunc(\"/saveuser\", saveUser)\n}\n\nfunc saveUser(res http.ResponseWriter, req *http.Request){\n    ConfigurationRepository.SaveUser(User) //I want to receive an User    object when this service is being consumed\n}\n</code></pre>\n"}, {"tags": ["go", "base64", "des", "pkcs#7", "cbc-mode"], "comments": [{"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1484087909, "post_id": 41579325, "comment_id": 70364431, "body": "1. Do not use DES, it is not secure and has been superseded by AES whioch is no harder to use. 2. Do use a random IV, just prefix theIV to the encrypted data for use on decryption (the IV does not need to be secret). It is important to use a different IV when the same encryption key is used for multiple messages. 3. Consider, the point of encryption is generally to create security, improperly used encryption will not provide secure."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 1, "creation_date": 1484088082, "post_id": 41579325, "comment_id": 70364511, "body": "It is not clear that you want to decrypt a 12 character encrypted string and specify a unique key and a unique IV. The same key and IV that was used for encryption must be used for decryption. The question could be made more clear and provide more information on exactly what you are trying to accomplish."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484088146, "post_id": 41579325, "comment_id": 70364537, "body": "For starters you&#39;re not decoding the base64 when decrypting, which is why the data size is wrong."}, {"owner": {"reputation": 376, "user_id": 4021006, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/TV7qH.jpg?s=128&g=1", "display_name": "phil o.O", "link": "https://stackoverflow.com/users/4021006/phil-o-o"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1484159882, "post_id": 41579325, "comment_id": 70399321, "body": "@zaph Thanks for your feedback and insight. My code is a local prototype and not production code."}, {"owner": {"reputation": 376, "user_id": 4021006, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/TV7qH.jpg?s=128&g=1", "display_name": "phil o.O", "link": "https://stackoverflow.com/users/4021006/phil-o-o"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484159887, "post_id": 41579325, "comment_id": 70399325, "body": "@JimB Whoops! Thank you for catching that."}], "answers": [{"comments": [{"owner": {"reputation": 376, "user_id": 4021006, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/TV7qH.jpg?s=128&g=1", "display_name": "phil o.O", "link": "https://stackoverflow.com/users/4021006/phil-o-o"}, "edited": false, "score": 0, "creation_date": 1484159275, "post_id": 41595640, "comment_id": 70398960, "body": "yep! Thanks! I just changed one line in main. I changed <code>fmt.Println(string(cryptoText))</code> to <code>fmt.Println(base64.URLEncoding.EncodeToString(cryptoText))</code>."}, {"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1492190287, "post_id": 41595640, "comment_id": 73891107, "body": "It&#39;s better to use this padding/unpadding code: <a href=\"https://github.com/go-web/tokenizer/blob/master/pkcs7.go\" rel=\"nofollow noreferrer\">github.com/go-web/tokenizer/blob/master/pkcs7.go</a>"}], "tags": [], "owner": {"reputation": 1157, "user_id": 5154802, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZqLky3QxN2E/AAAAAAAAAAI/AAAAAAAAAEE/MyYiHfmqVe0/photo.jpg?sz=128", "display_name": "shivendra pratap singh", "link": "https://stackoverflow.com/users/5154802/shivendra-pratap-singh"}, "is_accepted": true, "score": 5, "last_activity_date": 1484151226, "creation_date": 1484151226, "answer_id": 41595640, "question_id": 41579325, "link": "https://stackoverflow.com/questions/41579325/golang-how-do-i-decrypt-with-des-cbc-and-pkcs7/41595640#41595640", "title": "Golang: How do I decrypt with DES, CBC, and PKCS7?", "body": "<p>Buddy it's work completely fine. </p>\n\n<pre><code>package main\n\n    import (\n        \"bytes\"\n        \"crypto/des\"\n        \"crypto/cipher\"\n        \"fmt\"\n    )\n\n    func DesEncryption(key, iv, plainText []byte) ([]byte, error) {\n\n        block, err := des.NewCipher(key)\n\n        if err != nil {\n            return nil, err\n        }\n\n        blockSize := block.BlockSize()\n        origData := PKCS5Padding(plainText, blockSize)\n        blockMode := cipher.NewCBCEncrypter(block, iv)\n        cryted := make([]byte, len(origData))\n        blockMode.CryptBlocks(cryted, origData)\n        return cryted, nil\n    }\n\n    func DesDecryption(key, iv, cipherText []byte) ([]byte, error) {\n\n        block, err := des.NewCipher(key)\n\n        if err != nil {\n            return nil, err\n        }\n\n        blockMode := cipher.NewCBCDecrypter(block, iv)\n        origData := make([]byte, len(cipherText))\n        blockMode.CryptBlocks(origData, cipherText)\n        origData = PKCS5UnPadding(origData)\n        return origData, nil\n    }\n\n    func PKCS5Padding(src []byte, blockSize int) []byte {\n        padding := blockSize - len(src)%blockSize\n        padtext := bytes.Repeat([]byte{byte(padding)}, padding)\n        return append(src, padtext...)\n    }\n\n    func PKCS5UnPadding(src []byte) []byte {\n        length := len(src)\n        unpadding := int(src[length-1])\n        return src[:(length - unpadding)]\n    }\n\n\n    func main() {\n        originalText := \"sysys\"\n        fmt.Println(originalText)\n        mytext := []byte(originalText)\n\n        key := []byte{0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC }\n        iv := []byte{0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC }\n\n\n        cryptoText,_ := DesEncryption(key, iv, mytext)\n        fmt.Println(string(cryptoText))\n        decryptedText,_ := DesDecryption(key, iv, cryptoText)\n        fmt.Println(string(decryptedText))\n\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 13951167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fb1577cbadd3ebcd25f1ffa1d5a313?s=128&d=identicon&r=PG&f=1", "display_name": "xucongco", "link": "https://stackoverflow.com/users/13951167/xucongco"}, "is_accepted": false, "score": 0, "last_activity_date": 1601036853, "creation_date": 1601036853, "answer_id": 64064149, "question_id": 41579325, "link": "https://stackoverflow.com/questions/41579325/golang-how-do-i-decrypt-with-des-cbc-and-pkcs7/64064149#64064149", "title": "Golang: How do I decrypt with DES, CBC, and PKCS7?", "body": "<p>you can do like this</p>\n<pre><code>package controllers\n\nimport (\n    &quot;bytes&quot;\n    &quot;crypto/aes&quot;\n    &quot;crypto/cipher&quot;\n    &quot;encoding/hex&quot;\n    &quot;fmt&quot;\n)\n\nfunc PKCS7Padding(ciphertext []byte) []byte {\n    padding := aes.BlockSize - len(ciphertext) % aes.BlockSize\n    padtext := bytes.Repeat([]byte{byte(padding)}, padding)\n    return append(ciphertext, padtext...)\n}\n\nfunc PKCS7UnPadding(plantText []byte) []byte {\n    length   := len(plantText)\n    unpadding := int(plantText[length-1])\n    return plantText[:(length - unpadding)]\n}\n\nfunc OpensslDecrypt(keyStr string, ivStr string, text string) string{\n\n    key, _ := hex.DecodeString(keyStr);\n    iv, _ := hex.DecodeString(ivStr);\n    ciphertext, _ := hex.DecodeString(text);\n\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n    plaintext := make([]byte,len(ciphertext))\n    mode := cipher.NewCBCDecrypter(block, iv)\n    mode.CryptBlocks(plaintext, ciphertext)\n\n    plaintext = PKCS7UnPadding(plaintext)\n    return fmt.Sprintf(&quot;%s\\n&quot;, plaintext)\n}\n\nfunc OpensslEncrypt(keyStr string, ivStr string, text string) string{\n\n    plaintext := []byte(text)\n    key, _ := hex.DecodeString(keyStr);\n    iv, _ := hex.DecodeString(ivStr);\n\n    plaintext = PKCS7Padding(plaintext);\n    ciphertext := make([]byte,len(plaintext))\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    mode := cipher.NewCBCEncrypter(block, iv)\n    mode.CryptBlocks(ciphertext, plaintext)\n\n    return fmt.Sprintf(&quot;%x\\n&quot;, ciphertext)\n}\n</code></pre>\n"}], "owner": {"reputation": 376, "user_id": 4021006, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/TV7qH.jpg?s=128&g=1", "display_name": "phil o.O", "link": "https://stackoverflow.com/users/4021006/phil-o-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6853, "favorite_count": 2, "accepted_answer_id": 41595640, "answer_count": 2, "score": 4, "last_activity_date": 1601036853, "creation_date": 1484086239, "last_edit_date": 1484149130, "question_id": 41579325, "link": "https://stackoverflow.com/questions/41579325/golang-how-do-i-decrypt-with-des-cbc-and-pkcs7", "title": "Golang: How do I decrypt with DES, CBC, and PKCS7?", "body": "<p>Currently trying to figure out why my decryption method is not working. I used DES, CBC, and PKCS7Padding to encrypt my string. My current <a href=\"https://play.golang.org/p/FZN6POxqU8\" rel=\"noreferrer\">code</a> outputs <code>panic: crypto/cipher: input not full blocks</code> during decryption. </p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 0, "creation_date": 1484100017, "post_id": 41579222, "comment_id": 70367795, "body": "did you resolve your problem?"}, {"owner": {"reputation": 876, "user_id": 137196, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/244e6196a79d2f18d873577f0d6459f7?s=128&d=identicon&r=PG", "display_name": "Louie Miranda", "link": "https://stackoverflow.com/users/137196/louie-miranda"}, "edited": false, "score": 0, "creation_date": 1575556446, "post_id": 41579222, "comment_id": 104612872, "body": "Looking for a good answer as well"}], "answers": [{"comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 1, "creation_date": 1484111964, "post_id": 41579651, "comment_id": 70370899, "body": "<code>DB</code> is considered a better naming convention as compared to <code>Db</code> since it&#39;s an abbreviation."}], "tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": true, "score": 0, "last_activity_date": 1484087745, "creation_date": 1484087745, "answer_id": 41579651, "question_id": 41579222, "link": "https://stackoverflow.com/questions/41579222/how-to-share-globally-the-mysql-driver-on-different-handlers-on-golang/41579651#41579651", "title": "How to share globally the MySQL driver on different handlers on GoLang", "body": "<p>You need to write your db var like this : </p>\n\n<pre><code>package common\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nvar Db *sql.DB\nvar Err error\n</code></pre>\n\n<p>In Golang Capital letter means exporting it to outside of the package.you can learn more about this <a href=\"https://www.goinggo.net/2014/03/exportedunexported-identifiers-in-go.html\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 19, "user_id": 7206599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e73e559f95801374b61c50ee7bbd17a6?s=128&d=identicon&r=PG&f=1", "display_name": "Santiago Uma&#241;a Villada", "link": "https://stackoverflow.com/users/7206599/santiago-uma%c3%b1a-villada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 1, "accepted_answer_id": 41579651, "answer_count": 1, "score": 2, "last_activity_date": 1489234256, "creation_date": 1484085714, "last_edit_date": 1489234256, "question_id": 41579222, "link": "https://stackoverflow.com/questions/41579222/how-to-share-globally-the-mysql-driver-on-different-handlers-on-golang", "title": "How to share globally the MySQL driver on different handlers on GoLang", "body": "<p>I want to call db from the different handlers, This is my mysql.go:\npackage common</p>\n\n<pre><code>import (\n    \"database/sql\"\n    \"fmt\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nvar db *sql.DB\nvar err error\n\n//db connection\nfunc connectDB() {\n    db, err = sql.Open(\"mysql\", \"root@tcp(localhost:3306)/mysqlapi\")\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n    defer db.Close()\n\n    //test connection\n    err = db.Ping()\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n\n    //table migration\n    stmt, err := db.Prepare(\"CREATE TABLE person (id int NOT NULL AUTO_INCREMENT, first_name varchar(40), last_name varchar(40), PRIMARY KEY (id));\")\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n    _, err = stmt.Exec()\n    if err != nil {\n        fmt.Println(err.Error())\n    } else {\n        fmt.Println(\"Person Table successfully migrated....\")\n    }\n\n}\n</code></pre>\n\n<p>this is what i want to do, but i don't know how i call db from common package into a different package (i tried common.db but it doesn't works):</p>\n\n<p>package models</p>\n\n<pre><code>import (\n    \"github.com/colombia9503/RESTful-Mysql/common\"\n)\n\ntype User struct {\n    Id         int\n    First_Name string\n    Last_Name  string\n}\n\nvar Users = new(users)\n\ntype users struct{}\n\nfunc (users) SelectAll() ([]*User, error) {\n    var users []*User\n    rows, err := common.db.Query(\"select id, first_name, last_name from person;\")\n    if err != nil {\n        panic(err)\n    }\n\n    for rows.Next() {\n        some code..\n    }\n    return users, err\n}\n\nfunc (users) SelectOne(id string) (*User, error) {\n    some code..\n}\n\nfunc (users) Insert(name, last_name string) (*User, error) {\n    some code..\n}\n\nfunc (users) Update(id, name, last_name string) error {\n    some code..\n}\n\nfunc (users) Delete(id string) error {\n    some code..\n}\n</code></pre>\n"}, {"tags": ["go", "goquery"], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 2, "last_activity_date": 1484084138, "creation_date": 1484084138, "answer_id": 41578855, "question_id": 41578768, "link": "https://stackoverflow.com/questions/41578768/goquery-stop-parsing-when-another-element-is-reached/41578855#41578855", "title": "goquery: stop parsing when another element is reached", "body": "<p>Yes, actually pretty easy:</p>\n\n<pre><code>doc.Find(\".h1-class\").First().NextUntil(\".h1-class\")\n</code></pre>\n\n<p>I would recommend you read through the godoc: <a href=\"https://godoc.org/github.com/PuerkitoBio/goquery\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/PuerkitoBio/goquery</a> </p>\n\n<p>It explains all of the different ways you can manipulate the selection.</p>\n"}], "owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 41578855, "answer_count": 1, "score": 1, "last_activity_date": 1484084138, "creation_date": 1484083781, "question_id": 41578768, "link": "https://stackoverflow.com/questions/41578768/goquery-stop-parsing-when-another-element-is-reached", "title": "goquery: stop parsing when another element is reached", "body": "<p>Suppose I have this HTML page. I want to parse it using <a href=\"https://golang.org/\" rel=\"nofollow noreferrer\">Go</a> and <a href=\"https://github.com/PuerkitoBio/goquery\" rel=\"nofollow noreferrer\">goquery</a>:</p>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;&lt;!--Page header stuff--&gt;&lt;/head&gt;\n    &lt;body&gt;\n         &lt;h1 class=\"h1-class\"&gt;Heading 1&lt;/h1&gt;\n             &lt;div class=\"div-class\"&gt;Stuff1&lt;/div&gt;\n             &lt;div class=\"div-class\"&gt;Stuff2&lt;/div&gt;\n         &lt;h1 class=\"h1-class\"&gt;Heading 2&lt;/h1&gt;\n             &lt;div class=\"div-class\"&gt;Stuff3&lt;/div&gt;\n             &lt;div class=\"div-class\"&gt;Stuff4&lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>As it happens, I'd like only to get those DIVs before Heading 2 and skip the rest. This code works great to get <em>all</em> DIVs:</p>\n\n<pre><code> doc := GetGoQueryDocument(url) //Defined elsewhere\n doc.Find(\"div.div-class\").Each(func(_ int, theDiv *goquery.Selection){\n     //do stuff with each theDiv\n     //The problem is that it finds div.div-class elements below Heading 2.\n     //I want to skip those.\n })\n</code></pre>\n\n<p>Is there any way to tell goquery to skip elements located beneath a certain tag and classname? Thanks for any tips!</p>\n"}, {"tags": ["go", "viper-go", "go-cobra"], "comments": [{"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1484123628, "post_id": 41578264, "comment_id": 70375932, "body": "Sorry, I am unable to reproduce your problem: I tried with my yaml config file in /tmp and your code, and the bind param was correctly found and set to its config value. However, I noticed that the bind param must not be nested to be found, is that the case in your config ?"}, {"owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "reply_to_user": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1484132533, "post_id": 41578264, "comment_id": 70381719, "body": "@T.Claverie I have currently the second version ( not nested ). I have pasted it at <a href=\"http://pastebin.com/7TcqrdgV\" rel=\"nofollow noreferrer\">pastebin.com/7TcqrdgV</a>. Updated question with link to the complete source"}, {"owner": {"reputation": 2541, "user_id": 371970, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/35122322d66164b170ef5c1b20ef99d1?s=128&d=identicon&r=PG", "display_name": "WGH", "link": "https://stackoverflow.com/users/371970/wgh"}, "edited": false, "score": 1, "creation_date": 1530917427, "post_id": 41578264, "comment_id": 89418039, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/43847791/why-is-cobra-not-reading-my-config-file\">why is cobra not reading my config file</a>"}, {"owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "reply_to_user": {"reputation": 2541, "user_id": 371970, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/35122322d66164b170ef5c1b20ef99d1?s=128&d=identicon&r=PG", "display_name": "WGH", "link": "https://stackoverflow.com/users/371970/wgh"}, "edited": false, "score": 1, "creation_date": 1531127319, "post_id": 41578264, "comment_id": 89462331, "body": "@WGH for your reference: this is 1 year 5 months old, the other one 1 year 2 months, no need to vote for close here"}, {"owner": {"reputation": 2541, "user_id": 371970, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/35122322d66164b170ef5c1b20ef99d1?s=128&d=identicon&r=PG", "display_name": "WGH", "link": "https://stackoverflow.com/users/371970/wgh"}, "edited": false, "score": 1, "creation_date": 1531149772, "post_id": 41578264, "comment_id": 89476795, "body": "@Sascha I know, but the other question is slightly more understandable, as it includes the problematic part - using variable bound to pflag instead of <code>viper.GetString()</code> - and this question only has a link to repository which no longer has the code in question."}], "answers": [{"tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": true, "score": 7, "last_activity_date": 1484137922, "creation_date": 1484137922, "answer_id": 41591070, "question_id": 41578264, "link": "https://stackoverflow.com/questions/41578264/config-file-with-cobra-and-viper/41591070#41591070", "title": "Config file with cobra and viper", "body": "<p>Ok, thanks for the additional information, It helped a lot !</p>\n\n<h2>Problem</h2>\n\n<p>The problem arises from the way you're retrieving the value of the flag. Here is what you currently have:</p>\n\n<pre><code>bind := cmd.Flag(\"bind\").Value.String()\nfmt.Printf(\"Binding definition provided: %s\\n\", bind)\nserver.Listen(bind)\n</code></pre>\n\n<p>When binding a flag with viper, it's actually viper that will hold the final value, according to this priorities:</p>\n\n<pre><code>1. If present, use the flag value\n2. Else, use the value from the config file\n3. Else, use the default flag value\n</code></pre>\n\n<p>Your problem is that you retrieve the flag value from the flag set of the command, and not from viper.</p>\n\n<h2>Behavior</h2>\n\n<p>Here is the code I tested:</p>\n\n<pre><code>bind := cmd.Flag(\"bind\").Value.String()\nfmt.Printf(\"Binding definition provided: %s\\n\", bind)\nfmt.Printf(\"Binding definition provided from viper: %s\\n\", viper.GetString(\"bind\"))\n</code></pre>\n\n<p>Without the bind config param:</p>\n\n<pre><code>$ go-logsink listen\nUsing config file: /xxx/.go-logsink.yaml\nBinding definition provided: :50051\nBinding definition provided from viper: :50051\n</code></pre>\n\n<p>With the bind config param set to \"bla\" (not nested, second config file):</p>\n\n<pre><code>$ go-logsink listen\nUsing config file: /xxx/.go-logsink.yaml\nBinding definition provided: :50051\nBinding definition provided from viper: bla\n</code></pre>\n\n<p>With the bind config param set to \"bla\" (not nested, second config file) and an explicit flag:</p>\n\n<pre><code>$ go-logsink listen --bind \":3333\"\nUsing config file: /xxx/.go-logsink.yaml\nBinding definition provided: :3333\nBinding definition provided from viper: :3333\n</code></pre>\n\n<p><strong>Bottomline</strong> : when binding your flags with viper, use viper to retrieve them.</p>\n\n<p><strong>Additional note</strong> : In your README, the proper way to generate grpc compatible code is by adding the grpc plugin to protobuf generation: <code>protoc --go_out=plugins=grpc:. *.proto</code></p>\n"}], "owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4910, "favorite_count": 0, "accepted_answer_id": 41591070, "answer_count": 1, "score": 6, "last_activity_date": 1530917101, "creation_date": 1484081810, "last_edit_date": 1497251576, "question_id": 41578264, "link": "https://stackoverflow.com/questions/41578264/config-file-with-cobra-and-viper", "title": "Config file with cobra and viper", "body": "<p><strong>Basic information:</strong> I have created a go application and used Cobra for it. Cobra uses Viper for command line parameters and flags.</p>\n\n<p>I have a command listen with a flag bind and I want to configure it in a yaml file.</p>\n\n<p><strong>Code:</strong></p>\n\n<p>The init function of the listen command looks like this:</p>\n\n<pre><code>func init() {\n    RootCmd.AddCommand(listenCmd)\n    listenCmd.Flags().StringP(\"bind\", \"b\", \":50051\", \"Provide bind definition\")\n    viper.BindPFlag(\"bind\", listenCmd.Flags().Lookup(\"bind\"))\n}\n</code></pre>\n\n<p>Code of my application is at <a href=\"https://github.com/sascha-andres/go-logsink\" rel=\"nofollow noreferrer\">https://github.com/sascha-andres/go-logsink</a></p>\n\n<p><strong>Problem:</strong> </p>\n\n<p>When I call the app with <code>listen --bind \"bla\"</code> the flag is set correctly to <code>bla</code>, but I have not found a way to achieve this using a YAML file located in my home directory.</p>\n\n<p><strong>Config files tried:</strong></p>\n\n<pre><code>---\n\nconnect:\n  bind: \"bla\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>---\n\nbind: \"bla\"\n</code></pre>\n\n<p>In both cases the config file was found but the flag had not the expected value but the default value.</p>\n\n<p>How do I have to write the config file to have the flag populated correctly?</p>\n"}, {"tags": ["go", "webserver", "response"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484072516, "post_id": 41575634, "comment_id": 70356136, "body": "Why do you have a conn (I&#39;m guessing a <code>net.Conn</code>?) instead of an <code>http.ResponseWriter</code>?"}, {"owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484072686, "post_id": 41575634, "comment_id": 70356233, "body": "the conn is the connection that i receive from the method Accept(). It has a method Write where I can write data and send to the client. I receive a response and a need to send it to the client (that the infos is in the connection)"}, {"owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484072728, "post_id": 41575634, "comment_id": 70356258, "body": "my question is: how can i send the response to the client (I mean, put in the browser the response)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484072817, "post_id": 41575634, "comment_id": 70356309, "body": "If you&#39;re making a &quot;web server&quot;, and the client is a browser, I don&#39;t understand why you don&#39;t just use an http.Server? The http package already knows how to properly format an http response."}, {"owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484073078, "post_id": 41575634, "comment_id": 70356466, "body": "because my server can receive others connections. I need to response a specific connection."}, {"owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484073118, "post_id": 41575634, "comment_id": 70356491, "body": "the infos about the client are in the net.Conn"}], "answers": [{"comments": [{"owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "edited": false, "score": 0, "creation_date": 1484074317, "post_id": 41575993, "comment_id": 70357190, "body": "I tried but the http.response doesn&#39;t have this method. The http.ResponseWrite has but I think it doens&#39;t make the same thing."}, {"owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "edited": false, "score": 0, "creation_date": 1484074427, "post_id": 41575993, "comment_id": 70357256, "body": "I saw in the documentation that it has this method but i can&#39;t call it. func (r *Response) Write(w io.Writer) error"}, {"owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "edited": false, "score": 0, "creation_date": 1484074545, "post_id": 41575993, "comment_id": 70357313, "body": "It works! It was another error in the last case, Thanks very much!!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1484073474, "creation_date": 1484073474, "answer_id": 41575993, "question_id": 41575634, "link": "https://stackoverflow.com/questions/41575634/how-to-write-a-response-type-response-in-a-conn-in-go/41575993#41575993", "title": "How to write a response (type Response) in a Conn in GO?", "body": "<p>The <code>http.Response</code> has a <a href=\"https://golang.org/pkg/net/http/#Response.Write\" rel=\"nofollow noreferrer\"><code>Write</code></a> method, which writes the contents of the response to an <code>io.Writer</code> in HTTP/1.X format. </p>\n\n<p>This will write everything in the response verbatim, so you may need to remove/modify headers first to suit your needs.</p>\n\n<pre><code>err = resp.Write(conn)\n</code></pre>\n"}], "owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 993, "favorite_count": 0, "accepted_answer_id": 41575993, "answer_count": 1, "score": 0, "last_activity_date": 1484073474, "creation_date": 1484072177, "question_id": 41575634, "link": "https://stackoverflow.com/questions/41575634/how-to-write-a-response-type-response-in-a-conn-in-go", "title": "How to write a response (type Response) in a Conn in GO?", "body": "<p>I'm making a webserver in go and I need to give the response form the website to the client.\nthis in the part of my code where i receive the response:</p>\n\n<pre><code>            client := http.Client{}\n            resp, err := client.Do(request)\n            defer resp.Body.Close()\n\n            if err != nil {\n                log.Fatalln(err.Error())\n            }\n</code></pre>\n\n<p>The Do(request) returns a Response type and I need to send this response to the client (conn). I saw a method in conn type the writes data in the connection but it only accept bytes and i couldn't convert the response in bytes. I need to send the body, status and headers,can the conn.Write([]bytes) do that? How can I send this response to my client?</p>\n"}, {"tags": ["go", "raspbian"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484069375, "post_id": 41574521, "comment_id": 70354352, "body": "You install it like anything else for your system, there&#39;s nothing special about it being written in Go. That page has prebuilt packages for mac and Linux."}, {"owner": {"reputation": 41280, "user_id": 344286, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3827b2facd01ed6a64a96df00d4b877a?s=128&d=identicon&r=PG", "display_name": "Wayne Werner", "link": "https://stackoverflow.com/users/344286/wayne-werner"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484069992, "post_id": 41574521, "comment_id": 70354741, "body": "amd32 and 64 linux, not ARM"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484071291, "post_id": 41574521, "comment_id": 70355521, "body": "Ah, didn&#39;t see the tiny print about Raspbian. Just copy the binary to a system PATH."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484071719, "post_id": 41575031, "comment_id": 70355738, "body": "If you set your GOBIN to a directory where you don&#39;t have write permission, you are going to have problems with root owned files in your GOPATH after using <code>sudo</code> to build and install."}, {"owner": {"reputation": 81, "user_id": 1387923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99889b83ffed6a5a5f70e0a33bae95b?s=128&d=identicon&r=PG", "display_name": "Roeften", "link": "https://stackoverflow.com/users/1387923/roeften"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484078746, "post_id": 41575031, "comment_id": 70359636, "body": "Maybe I misunderstood the question. I tried in a VM and got a single keybase executable in my $GOBIN which I can run as any user."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484079124, "post_id": 41575031, "comment_id": 70359826, "body": "The default system bin directories are only writable by root. If you ran <code>sudo go install</code>, you now have root owned files in your GOAPTH. You shouldn&#39;t be building software as root."}, {"owner": {"reputation": 41280, "user_id": 344286, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3827b2facd01ed6a64a96df00d4b877a?s=128&d=identicon&r=PG", "display_name": "Wayne Werner", "link": "https://stackoverflow.com/users/344286/wayne-werner"}, "edited": false, "score": 0, "creation_date": 1484079429, "post_id": 41575031, "comment_id": 70359983, "body": "That <i>appears</i> to be exactly what I want, though. I mean, I don&#39;t <i>really</i> care who&#39;s doing the building, but I do want the executables to be... well, for me it appears that <code>&#47;usr&#47;local&#47;go&#47;bin</code> works fine."}, {"owner": {"reputation": 81, "user_id": 1387923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99889b83ffed6a5a5f70e0a33bae95b?s=128&d=identicon&r=PG", "display_name": "Roeften", "link": "https://stackoverflow.com/users/1387923/roeften"}, "edited": false, "score": 0, "creation_date": 1484080201, "post_id": 41575031, "comment_id": 70360377, "body": "I run build as user and then install as root. No root files after in GOPATH."}, {"owner": {"reputation": 81, "user_id": 1387923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99889b83ffed6a5a5f70e0a33bae95b?s=128&d=identicon&r=PG", "display_name": "Roeften", "link": "https://stackoverflow.com/users/1387923/roeften"}, "reply_to_user": {"reputation": 41280, "user_id": 344286, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3827b2facd01ed6a64a96df00d4b877a?s=128&d=identicon&r=PG", "display_name": "Wayne Werner", "link": "https://stackoverflow.com/users/344286/wayne-werner"}, "edited": false, "score": 0, "creation_date": 1484081062, "post_id": 41575031, "comment_id": 70360852, "body": "@WayneWerner Sorry can&#39;t comment on your answer, Update the PATH for all users permanently, for example in /etc/profile."}, {"owner": {"reputation": 41280, "user_id": 344286, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3827b2facd01ed6a64a96df00d4b877a?s=128&d=identicon&r=PG", "display_name": "Wayne Werner", "link": "https://stackoverflow.com/users/344286/wayne-werner"}, "edited": false, "score": 0, "creation_date": 1484081341, "post_id": 41575031, "comment_id": 70360987, "body": "@Roeften That&#39;s exactly what I&#39;ve done. Any user that wants to set their own GOPATH is more than welcome. I might be able to run the build command as nobody."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484081402, "post_id": 41575031, "comment_id": 70361016, "body": "@Roeften: <code>go build</code> doesn&#39;t save the binary artifacts in GOPATH, <code>go install</code> does. <code>sudo go install</code> will leave those root owned artifacts in your GOPATH (unless they were previously installed by your regular user, and don&#39;t need to be updated), possibly causing later builds to fail."}, {"owner": {"reputation": 81, "user_id": 1387923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99889b83ffed6a5a5f70e0a33bae95b?s=128&d=identicon&r=PG", "display_name": "Roeften", "link": "https://stackoverflow.com/users/1387923/roeften"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484082290, "post_id": 41575031, "comment_id": 70361511, "body": "@JimB Used go once in my life so no experience. I simply ran find $GOPATH -group root and got no hits. Tbh i was after the points in order to be able to comment in SO ;-)"}], "tags": [], "owner": {"reputation": 81, "user_id": 1387923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99889b83ffed6a5a5f70e0a33bae95b?s=128&d=identicon&r=PG", "display_name": "Roeften", "link": "https://stackoverflow.com/users/1387923/roeften"}, "is_accepted": false, "score": 0, "last_activity_date": 1484070100, "creation_date": 1484070100, "answer_id": 41575031, "question_id": 41574521, "link": "https://stackoverflow.com/questions/41574521/whats-the-proper-way-to-install-a-go-package-to-the-system-path/41575031#41575031", "title": "What&#39;s the proper way to install a go package to the system path?", "body": "<p>Have you tried setting $GOBIN like:</p>\n\n<p>GOBIN=/usr/local/bin/ or GOBIN=/usr/bin/ or any directory in the PATH?</p>\n\n<p>and then:</p>\n\n<p>export GOBIN</p>\n\n<p>and then install the app?</p>\n\n<p>According to the manual the default $GOBIN is $GOROOT/bin so I guess those users set GOROOT to /usr/local/go</p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484082108, "post_id": 41577630, "comment_id": 70361400, "body": "I would recommend against setting <code>GOPATH=&#47;usr&#47;local&#47;go</code>, since that&#39;s the default GOROOT, and you never want to accidentally clobber something in GOROOT. (You did ask for the &quot;proper&quot; way, and that is still to install the resulting binary to a system path <i>after</i> you build, like any other binary.)"}], "tags": [], "owner": {"reputation": 41280, "user_id": 344286, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3827b2facd01ed6a64a96df00d4b877a?s=128&d=identicon&r=PG", "display_name": "Wayne Werner", "link": "https://stackoverflow.com/users/344286/wayne-werner"}, "is_accepted": true, "score": 0, "last_activity_date": 1484079529, "creation_date": 1484079529, "answer_id": 41577630, "question_id": 41574521, "link": "https://stackoverflow.com/questions/41574521/whats-the-proper-way-to-install-a-go-package-to-the-system-path/41577630#41577630", "title": "What&#39;s the proper way to install a go package to the system path?", "body": "<p>The approach that I've taken is this:</p>\n\n<pre><code>PATH=\"$PATH:/usr/local/go/bin\" GOPATH=/usr/local/go/ go get github.com/keybase/client/go/keybase\nPATH=\"$PATH:/usr/local/go/bin\" GOPATH=/usr/local/go/ go install -tags production github.com/keybase/client/go/keybase\n</code></pre>\n\n<p>Which ends out installing <code>keybase</code> to <code>/usr/local/go/bin/keybase</code>. It's possible that there's a better way, but so far I haven't seen one.</p>\n"}], "owner": {"reputation": 41280, "user_id": 344286, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3827b2facd01ed6a64a96df00d4b877a?s=128&d=identicon&r=PG", "display_name": "Wayne Werner", "link": "https://stackoverflow.com/users/344286/wayne-werner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 41577630, "answer_count": 2, "score": 1, "last_activity_date": 1484079529, "creation_date": 1484068538, "last_edit_date": 1484076680, "question_id": 41574521, "link": "https://stackoverflow.com/questions/41574521/whats-the-proper-way-to-install-a-go-package-to-the-system-path", "title": "What&#39;s the proper way to install a go package to the system path?", "body": "<p>I'm trying to install a <code>go</code> project (<a href=\"https://github.com/keybase/client/blob/master/go/README.md#building\" rel=\"nofollow noreferrer\">the keybase client, in particular</a>), but I want to install it globally for all the users on my system.</p>\n\n<p>I've searched around and found a few people who accidentally install things to <code>/usr/local/go/bin</code> or something to that effect, but no instructions on how I actually <em>should</em> be installing things to such locations.</p>\n\n<p>But that's what I want to do - globally install the application. How should I be doing that with go?</p>\n\n<p><sub><sup>I'm not using any of the pre-built packages because none exist for Raspbian Jesse</sup></sub>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 2, "creation_date": 1484067067, "post_id": 41574028, "comment_id": 70352819, "body": "In the second example there&#39;s a new variable <code>b</code>. It&#39;s a bit strange but it&#39;s how Go works... IIRC this should be explained at <i>some point</i> in The Go Programming Language book, so keep reading :-)"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1484069745, "post_id": 41574028, "comment_id": 70354589, "body": "I get into the habit of just putting a <code>var err error</code> at the top of the function since it gets used so often. Avoids the hassle of remembering which assignment gets the <code>:=</code>."}, {"owner": {"reputation": 71, "user_id": 6408396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c704027e2787c39cb40a6a54195d553?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn", "link": "https://stackoverflow.com/users/6408396/shawn"}, "edited": false, "score": 0, "creation_date": 1484115076, "post_id": 41574028, "comment_id": 70372016, "body": "Thanks for your help:-)"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6408396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c704027e2787c39cb40a6a54195d553?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn", "link": "https://stackoverflow.com/users/6408396/shawn"}, "edited": false, "score": 0, "creation_date": 1484115108, "post_id": 41574085, "comment_id": 70372030, "body": "Thanks! It&#39;s very helpful."}], "tags": [], "owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "is_accepted": false, "score": 11, "last_activity_date": 1484067720, "last_edit_date": 1484067720, "creation_date": 1484067107, "answer_id": 41574085, "question_id": 41574028, "link": "https://stackoverflow.com/questions/41574028/golang-no-new-variables-on-left-side-of-while-a-similar-one-didnt-occur-th/41574085#41574085", "title": "Golang: no new variables on left side of :=, while a similar one didn&#39;t occur this error", "body": "<p>If there are any new variables in the assignment (e.g. <code>b</code>) then := will create it. If all variables are not new then you get the error you're getting. <code>_</code> is not a new variable.</p>\n\n<p>Since you have all existing variables you can just use = for your io line:</p>\n\n<pre><code>_, err = io.Copy(os.Stdout, resp.Body)\n</code></pre>\n\n<p>When you used <code>b</code> instead of <code>_</code> then := declared <code>b</code> but treated <code>err</code> like a standard assignment (i.e. just as if a = was used)</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 6408396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c704027e2787c39cb40a6a54195d553?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn", "link": "https://stackoverflow.com/users/6408396/shawn"}, "edited": false, "score": 0, "creation_date": 1484115249, "post_id": 41574460, "comment_id": 70372083, "body": "Got it! Thanks you for your answer and helpful link."}], "tags": [], "owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "is_accepted": false, "score": 4, "last_activity_date": 1484068318, "creation_date": 1484068318, "answer_id": 41574460, "question_id": 41574028, "link": "https://stackoverflow.com/questions/41574028/golang-no-new-variables-on-left-side-of-while-a-similar-one-didnt-occur-th/41574460#41574460", "title": "Golang: no new variables on left side of :=, while a similar one didn&#39;t occur this error", "body": "<p><strong>It did not</strong>  </p>\n\n<p>You can use the <code>:=</code> as long as there is at least one new variable at the left side and the other variables have already been declared in the same block with the same type. Already declared variables will just have their values changed. It's basically for convenience.</p>\n\n<p>It is all described here : <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Short_variable_declarations</a></p>\n"}], "owner": {"reputation": 71, "user_id": 6408396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c704027e2787c39cb40a6a54195d553?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn", "link": "https://stackoverflow.com/users/6408396/shawn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6999, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1484068318, "creation_date": 1484066957, "last_edit_date": 1484067292, "question_id": 41574028, "link": "https://stackoverflow.com/questions/41574028/golang-no-new-variables-on-left-side-of-while-a-similar-one-didnt-occur-th", "title": "Golang: no new variables on left side of :=, while a similar one didn&#39;t occur this error", "body": "<p>I have written some code to prints the content found at a URL following the guide of a book named <em>The Go Programming Language</em>. The compiler complained about the following code that <strong><code>no new variables on left side of :=</code></strong>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"os\"\n    \"io\"\n)\n\nfunc main() {\n    for _, url := range os.Args[1:] {\n        resp, err := http.Get(url)\n        if err != nil {\n            fmt.Fprintf(os.Stderr, \"fetch: %v\\n\", err)\n            os.Exit(1)\n        }\n        _, err := io.Copy(os.Stdout, resp.Body)\n        resp.Body.Close()\n        if err != nil {\n            fmt.Fprintf(os.Stderr, \"fetch: reading %s: %v\\n\", url, err)\n            os.Exit(1)\n        }\n    }\n}\n</code></pre>\n\n<p>And I have known that this was caused by re-declaration of certain variables. While the following one passed the compilation.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n)\n\nfunc main() {\n    for _, url := range os.Args[1:] {\n        resp, err := http.Get(url)\n        if err != nil {\n            fmt.Fprintf(os.Stderr, \"fetch: %v\\n\", err)\n            os.Exit(1)\n        }\n        b, err := ioutil.ReadAll(resp.Body)\n        resp.Body.Close()\n        if err != nil {\n            fmt.Fprintf(os.Stderr, \"fetch: reading %s: %v\\n\", url, err)\n            os.Exit(1)\n        }\n        fmt.Printf(\"%s\", b)\n    }\n}\n</code></pre>\n\n<p>Didn't it re-declare the variable <code>err</code>? Then how could it pass the compilation?</p>\n"}, {"tags": ["ubuntu", "go", "docker"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484061620, "post_id": 41572132, "comment_id": 70349055, "body": "Does it work if you build it on the host machine?"}, {"owner": {"reputation": 7035, "user_id": 2105103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/083cffabdc0b6ec7175df80d5d1a5f60?s=128&d=identicon&r=PG", "display_name": "user2105103", "link": "https://stackoverflow.com/users/2105103/user2105103"}, "edited": false, "score": 0, "creation_date": 1484063307, "post_id": 41572132, "comment_id": 70350183, "body": "Looks like your DNS resolution works better inside docker than it does on your host.    Docker by default uses Google DNS (8.8.8.8).   Check your host."}], "answers": [{"tags": [], "owner": {"reputation": 6670, "user_id": 3625317, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/sTfWL.png?s=128&g=1", "display_name": "Eugen Mayer", "link": "https://stackoverflow.com/users/3625317/eugen-mayer"}, "is_accepted": false, "score": 0, "last_activity_date": 1484072665, "creation_date": 1484072665, "answer_id": 41575780, "question_id": 41572132, "link": "https://stackoverflow.com/questions/41572132/error-when-running-a-compiled-golang-script/41575780#41575780", "title": "error when running a compiled golang script", "body": "<p>Your DNS resolution seems to have been compiled into your go-executable a mad way: 127.0.0.1:33891->127.0.1.1:53</p>\n\n<p>What you see here is a port-binding of docker to your local host-dns server. This will not work on the host, but it does also make no sense having this \"route\" compiled into the go-executable.</p>\n\n<p>Probably, you are compiling a static connection string into the APP, for the connection to the DNS server, i really cannot guess here.</p>\n"}], "owner": {"reputation": 155, "user_id": 1544258, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PR4kJ.jpg?s=128&g=1", "display_name": "hustas88", "link": "https://stackoverflow.com/users/1544258/hustas88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484072665, "creation_date": 1484061379, "question_id": 41572132, "link": "https://stackoverflow.com/questions/41572132/error-when-running-a-compiled-golang-script", "title": "error when running a compiled golang script", "body": "<p>I use <a href=\"http://github.com/sideshow/apns2\" rel=\"nofollow noreferrer\">github.com/sideshow/apns2</a> of specified revision in my project to send IOS push notifications. The <strong>go 1.7.4</strong> is inside of a docker container and I have compiled the app there and pulled the binary to the host machine. When I run the binary on the host it throws the next error:</p>\n\n<pre><code>Error Message: Post https://api.push.apple.com/3/device/{device_token}: dial tcp: lookup api.push.apple.com on 127.0.1.1:53: read udp 127.0.0.1:33891-&gt;127.0.1.1:53: i/o timeout\n</code></pre>\n\n<p>but running inside of a docker works as expected.</p>\n\n<p>here is a part of code:</p>\n\n<pre><code>import (\n    \"os\"\n    \"strings\"\n    apns \"github.com/sideshow/apns2\"\n    \"github.com/sideshow/apns2/token\"\n)\n\nvar ApnsClient *apns.Client\n\nauthKey, err := token.AuthKeyFromBytes([]byte(strings.Replace(os.Getenv(\"APNS_AUTH_KEY\"), \"\\\\n\", \"\\n\", -1)))\nif err != nil {\n    return err\n}\n\nToken := &amp;token.Token{\n    AuthKey: authKey,\n    KeyID:   os.Getenv(\"APNS_KEY_ID\"),\n    TeamID:  os.Getenv(\"APNS_TEAM_ID\"),\n}\n\nif os.Getenv(\"APNS_PRODUCTION\") == \"1\" {\n    ApnsClient = apns.NewTokenClient(Token).Production()\n} else {\n    ApnsClient = apns.NewTokenClient(Token).Development()\n}\n\nnotification := &amp;apns.Notification{\n    Payload: {payload},\n    Topic: {bundle id},\n    DeviceToken: {device_token}\n}\n\nres, err := ApnsClient.Push(notification)\n</code></pre>\n\n<p>HTTP status in <strong>res</strong> is 200</p>\n\n<p>any ideas how to fix this?</p>\n"}, {"tags": ["go", "import", "package"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484061391, "post_id": 41571946, "comment_id": 70348868, "body": "You don&#39;t. They&#39;re internal packages, which mean they can only be <i>internally</i>. <a href=\"https://golang.org/cmd/go/#hdr-Internal_Directories\" rel=\"nofollow noreferrer\">golang.org/cmd/go/#hdr-Internal_Directories</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1484061461, "post_id": 41571946, "comment_id": 70348913, "body": "Well, what do you think why these packages are &quot;internal&quot;? These are &quot;internal&quot; because the may not be imported from different packages. Dead simple. So the answer is: &quot;You can not.&quot;"}, {"owner": {"reputation": 10306, "user_id": 658497, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AiHJI.jpg?s=128&g=1", "display_name": "Noam Manos", "link": "https://stackoverflow.com/users/658497/noam-manos"}, "edited": false, "score": 0, "creation_date": 1568627623, "post_id": 41571946, "comment_id": 102320703, "body": "Make sure to set <a href=\"https://github.com/golang/go/wiki/SettingGOPATH\" rel=\"nofollow noreferrer\">go import path</a>. See also: <a href=\"https://stackoverflow.com/a/57953217/658497\">stackoverflow.com/a/57953217/658497</a>"}], "answers": [{"comments": [{"owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "edited": false, "score": 2, "creation_date": 1548669514, "post_id": 41572137, "comment_id": 95609544, "body": "First part of this answer copied verbatim from :<a href=\"https://docs.google.com/document/d/1e8kOo3r51b2BWtTs_1uADIA5djfXhPT36s6eHVRIvaU\" rel=\"nofollow noreferrer\">docs.google.com/document/d/&hellip;</a>. (Useful doc for more background)."}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 21, "last_activity_date": 1548679323, "last_edit_date": 1592644375, "creation_date": 1484061404, "answer_id": 41572137, "question_id": 41571946, "link": "https://stackoverflow.com/questions/41571946/internal-packages-in-go/41572137#41572137", "title": "Internal packages in Go", "body": "<h3><a href=\"https://docs.google.com/document/d/1e8kOo3r51b2BWtTs_1uADIA5djfXhPT36s6eHVRIvaU/edit\" rel=\"noreferrer\">Background</a></h3>\n<blockquote>\n<p>Go encourages structuring a program as a collection of packages interacting using exported APIs. However, all packages can be imported. This creates a tension when implementing a library or command: it may grow large enough to structure as multiple packages, but splitting it would export the API used in those additional packages to the world. Being able to create packages with restricted visibility would eliminate this tension.</p>\n</blockquote>\n<h3>A rule proposed to Go 1.4</h3>\n<p>An import of a path containing the element \u201cinternal\u201d is disallowed if the importing code is outside the tree rooted at the parent of the \u201cinternal\u201d directory.</p>\n<h3>Short answer</h3>\n<p>You can't (at least easily) and you shouldn't.</p>\n"}, {"tags": [], "owner": {"reputation": 3121, "user_id": 521957, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5eb7181541d7455a128b552072225521?s=128&d=identicon&r=PG", "display_name": "ilyaigpetrov", "link": "https://stackoverflow.com/users/521957/ilyaigpetrov"}, "is_accepted": false, "score": 4, "last_activity_date": 1513771905, "last_edit_date": 1513771905, "creation_date": 1513671910, "answer_id": 47882723, "question_id": 41571946, "link": "https://stackoverflow.com/questions/41571946/internal-packages-in-go/47882723#47882723", "title": "Internal packages in Go", "body": "<p>I will show you how I use internal <a href=\"https://godoc.org/golang.org/x/net/internal/nettest\" rel=\"nofollow noreferrer\">nettest</a> package:</p>\n\n<pre><code>// I copied nettest to vendor with `dep ensure` I think. Then:\nmkdir vendor-local\ncp -r vendor/golang.org/x/net/internal/nettest ./vendor-local/nettest\nvim ./vendor-local/nettest/stack.go and remove import comment // import \"foo\" [1]\n// Use full import in your go file:\nimport \"github.com/foo-user/bar-project/vendor-local/nettest\"\n</code></pre>\n\n<p>[1]: <a href=\"https://github.com/golang/net/blob/a8b9294777976932365dabb6640cf1468d95c70f/internal/nettest/stack.go#L6\" rel=\"nofollow noreferrer\">https://github.com/golang/net/blob/a8b9294777976932365dabb6640cf1468d95c70f/internal/nettest/stack.go#L6</a></p>\n\n<p><a href=\"https://golang.org/pkg/cmd/go/#hdr-Import_path_checking\" rel=\"nofollow noreferrer\">Docs about import comments</a></p>\n\n<p>You may find all import comments in your internal package with <code>grep -r \"// import\" ./vendor-local/nettest</code></p>\n\n<h3>Why can't I copy nettest to ./vendor and use shorter import</h3>\n\n<p>You can, but utils like <code>dep ensure</code> that don't support local packages will purge your copy.</p>\n"}], "owner": {"reputation": 167, "user_id": 2413915, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/mLiG5.jpg?s=128&g=1", "display_name": "fvarj", "link": "https://stackoverflow.com/users/2413915/fvarj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10699, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1548679323, "creation_date": 1484060749, "last_edit_date": 1513803446, "question_id": 41571946, "link": "https://stackoverflow.com/questions/41571946/internal-packages-in-go", "title": "Internal packages in Go", "body": "<p>How to import internals packages in Go ?</p>\n\n<pre><code>import (\n\n    \"runtime/internal/atomic\"\n    \"runtime/internal/sys\"\n)\n</code></pre>\n\n<p>Like this without get a error:</p>\n\n<blockquote>\n  <p>imports runtime/internal/atomic: use of internal package not allowed</p>\n</blockquote>\n\n<p>And use internal funcs in a main package ?</p>\n"}, {"tags": ["go", "aerospike"], "comments": [{"owner": {"reputation": 433, "user_id": 925156, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b6f3b79ba04110500983bb126c2dcb45?s=128&d=identicon&r=PG", "display_name": "Raaghu", "link": "https://stackoverflow.com/users/925156/raaghu"}, "reply_to_user": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1484107320, "post_id": 41567767, "comment_id": 70369489, "body": "added the full main function now...."}], "answers": [{"tags": [], "owner": {"reputation": 3372, "user_id": 762649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21acc9d59af609a140703b8c2c2aca1?s=128&d=identicon&r=PG", "display_name": "sunil", "link": "https://stackoverflow.com/users/762649/sunil"}, "is_accepted": true, "score": 2, "last_activity_date": 1484128198, "creation_date": 1484128198, "answer_id": 41587493, "question_id": 41567767, "link": "https://stackoverflow.com/questions/41567767/aerospike-golang-get-all-bin-names-for-all-records/41587493#41587493", "title": "aerospike, golang -- get all bin names for all records", "body": "<p>If you only want the list of bins of a namespace, there is a much less expensive way. You do not need to do a query/scan which is very expensive. One catch is that you cannot get it per set. There is an info command <code>\"bins/nsname\"</code> (replace \"nsname\" with your desired namespace name) to get all the bins in that namespace.</p>\n\n<p>If you do not care about a programmatic way of getting the binlist, you can get it using the <code>asinfo</code> tool provided with <code>aerospike-tools</code> package. You can issue the following command. The output is reasonably self explanatory. (Replace \"127.0.0.1\" with the proper IP address of the node)</p>\n\n<blockquote>\n  <p>asinfo -v \"bins/nsname\" -h 127.0.0.1</p>\n</blockquote>\n\n<p>If you want to get the list programmatically, You can use the <code>RequestInfo()</code> API as given in <a href=\"https://github.com/aerospike/aerospike-client-go/blob/master/examples/info.go\" rel=\"nofollow noreferrer\">this example</a> and send the above command . You should write parser to extract the desirable fields. </p>\n"}], "owner": {"reputation": 433, "user_id": 925156, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b6f3b79ba04110500983bb126c2dcb45?s=128&d=identicon&r=PG", "display_name": "Raaghu", "link": "https://stackoverflow.com/users/925156/raaghu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "accepted_answer_id": 41587493, "answer_count": 1, "score": 1, "last_activity_date": 1484857527, "creation_date": 1484047838, "last_edit_date": 1484857527, "question_id": 41567767, "link": "https://stackoverflow.com/questions/41567767/aerospike-golang-get-all-bin-names-for-all-records", "title": "aerospike, golang -- get all bin names for all records", "body": "<p>Just wanted to check, if there is a way to get all bin names for every record ?</p>\n\n<p>I know we can get the <code>binmap</code> using the following code. But I want to read all the keys and create a <code>map[string]interface{}</code> and then convert that map to byte array.</p>\n\n<p>This is my code to get all the bins , add them to an array, convert array to byte array :</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/gob\"\n    \"fmt\"\n    as \"github.com/aerospike/aerospike-client-go\"\n    \"strconv\"\n    \"time\"\n)\n\nvar client *as.Client\n\n\nfunc main() {\n    stmt := as.NewStatement(\"txn\", \"user\")\n    stmt.Addfilter(as.NewEqualFilter(\"p\", \"param\"))\n    rs, err := GetAerospikeClient().Query(nil, stmt)\n    if err == nil {\n\n        //Conv to byte array\n        var ret []interface{}\n        for res := range rs.Results() {\n            if res.Err != nil {\n                // handle error here\n                // if you want to exit, cancel the recordset to release the resources\n                fmt.Println(\"Err------\", res.Err)\n\n            } else {\n                // process record here\n                fmt.Printf(\"Success------%#v\\n\", res.Record.Bins)\n                ret = append(ret, res.Record.Bins)\n            }\n        }\n\n        b, _ := GetBytes(ret)\n        fmt.Println(\"Len of byte array \", len(b))\n\n\n\n    }\n\n}\n\nfunc GetAerospikeClient() *as.Client {\n    var err error\n    port, _ := strconv.Atoi(\"3000\")\n    maxconn, _ := strconv.Atoi(\"10\")\n    host := \"172.28.128.3\"\n    timeout, _ := strconv.Atoi(\"50\")\n    idletimeout, _ := strconv.Atoi(\"3600\")\n    clientPolicy := as.NewClientPolicy()\n    clientPolicy.ConnectionQueueSize = maxconn\n    clientPolicy.LimitConnectionsToQueueSize = true\n    clientPolicy.Timeout = time.Duration(timeout) * time.Millisecond\n    clientPolicy.IdleTimeout = time.Duration(idletimeout) * time.Second\n    client, err = as.NewClientWithPolicy(clientPolicy, host, port)\n    if err != nil {\n        panic(err)\n    }\n    return client\n}   \n\nfunc GetBytes(key []interface{}) ([]byte, error) {\n    var buf bytes.Buffer\n    gob.Register(as.BinMap{})\n    gob.Register([]interface{}{})\n    enc := gob.NewEncoder(&amp;buf)\n    err := enc.Encode(key)\n    if err != nil {\n        panic(err)\n        return nil, err\n    }\n    return buf.Bytes(), nil\n}\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["linux", "go", "gcc", "cross-compiling"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 4114691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/357893d67a7f26a9af02ee41a6f4f6f6?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/4114691/dan"}, "edited": false, "score": 0, "creation_date": 1616084026, "post_id": 41572593, "comment_id": 117898276, "body": "Just wanted to clarify that (at least now) you only need to specify GOOS, the GOARCH can be the same as what you&#39;re using.  That said, it&#39;s worth noting that GOOS is case-sensitive, I&#39;d initially tried setting <code>GOOS=Windows</code> and that did not have any impact, until I noticed you had it as <code>GOOS=windows</code>."}, {"owner": {"reputation": 1036, "user_id": 5647659, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh6.googleusercontent.com/-7FQBxsH9yws/AAAAAAAAAAI/AAAAAAAAABk/R3uBF5DmtC4/photo.jpg?sz=128", "display_name": "Elie G.", "link": "https://stackoverflow.com/users/5647659/elie-g"}, "edited": false, "score": 0, "creation_date": 1617833929, "post_id": 41572593, "comment_id": 118421748, "body": "Why with <code>CGO</code> the GOARCH is <code>386</code>? What if I want to build it for <code>amd64</code>?"}], "tags": [], "owner": {"reputation": 411, "user_id": 7389047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd324529ad838ee757e0262f700534bf?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Miller", "link": "https://stackoverflow.com/users/7389047/michael-miller"}, "is_accepted": false, "score": 38, "last_activity_date": 1537469735, "last_edit_date": 1537469735, "creation_date": 1484062712, "answer_id": 41572593, "question_id": 41566495, "link": "https://stackoverflow.com/questions/41566495/golang-how-to-cross-compile-on-linux-for-windows/41572593#41572593", "title": "Golang: How to cross compile on Linux for Windows", "body": "<p>To build from Linux to Windows, you need to set the environment variables <code>GOOS</code> to <code>Windows</code> and <code>GOARCH</code> to <code>amd64</code>.</p>\n\n<p>On Bash or ZSH:</p>\n\n<pre><code>% GOOS=windows GOARCH=amd64 go build\n</code></pre>\n\n<ul>\n<li>For more details see: <a href=\"https://dave.cheney.net/2015/08/22/cross-compilation-with-go-1-5\" rel=\"noreferrer\">https://dave.cheney.net/2015/08/22/cross-compilation-with-go-1-5</a></li>\n<li>A description of possible values for GOOS and GOARCH is available here: <a href=\"https://golang.org/doc/install/source#environment\" rel=\"noreferrer\">https://golang.org/doc/install/source#environment</a></li>\n</ul>\n\n<p>If your package requires <code>CGO</code> then you need to use the mingw-w64 compiler:</p>\n\n<pre><code>sudo apt-get install gcc-multilib\nsudo apt-get install gcc-mingw-w64\n\nGOOS=windows GOARCH=386 \\\n  CGO_ENABLED=1 CXX=i686-w64-mingw32-g++ CC=i686-w64-mingw32-gcc \\\n  go build\n</code></pre>\n"}], "owner": {"reputation": 399, "user_id": 6926514, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c42d56e0e17ee20ffaa03a0c89c0d17?s=128&d=identicon&r=PG&f=1", "display_name": "shagul", "link": "https://stackoverflow.com/users/6926514/shagul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16997, "favorite_count": 7, "answer_count": 1, "score": 21, "last_activity_date": 1537470066, "creation_date": 1484043743, "last_edit_date": 1537470066, "question_id": 41566495, "link": "https://stackoverflow.com/questions/41566495/golang-how-to-cross-compile-on-linux-for-windows", "title": "Golang: How to cross compile on Linux for Windows", "body": "<p>How do I cross compile a Go project on Linux to generate an executable for running on Windows?</p>\n"}, {"tags": ["git", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1616238"}, "edited": false, "score": 0, "creation_date": 1484042022, "post_id": 41565764, "comment_id": 70335740, "body": "what&#39;s yout $GOPATH ?"}, {"owner": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "edited": false, "score": 0, "creation_date": 1484042713, "post_id": 41565764, "comment_id": 70336227, "body": "export GOPATH=/testapp"}, {"owner": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "edited": false, "score": 0, "creation_date": 1484043306, "post_id": 41565764, "comment_id": 70336642, "body": "when i try to delete package manullay and do go get all is working but not with fresh cloned project"}], "answers": [{"comments": [{"owner": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "edited": false, "score": 0, "creation_date": 1484047124, "post_id": 41567490, "comment_id": 70339065, "body": "GO version output is  go version go1.7.4 darwin/amd64"}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "reply_to_user": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "edited": false, "score": 0, "creation_date": 1484047157, "post_id": 41567490, "comment_id": 70339090, "body": "what os are you using, windows?"}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "reply_to_user": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "edited": false, "score": 0, "creation_date": 1484047244, "post_id": 41567490, "comment_id": 70339154, "body": "I&#39;m using linux/amd64. if your issue still exist then you need to create issue in go repository"}, {"owner": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "edited": false, "score": 0, "creation_date": 1484047335, "post_id": 41567490, "comment_id": 70339208, "body": "My Os is macSierra"}, {"owner": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "edited": false, "score": 0, "creation_date": 1484047378, "post_id": 41567490, "comment_id": 70339244, "body": "i am not able to get what the solution can you please help me here."}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "reply_to_user": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "edited": false, "score": 0, "creation_date": 1484060569, "post_id": 41567490, "comment_id": 70348316, "body": "@sector11 please try the step 3. maybe it could help you"}], "tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1484060541, "last_edit_date": 1484060541, "creation_date": 1484046951, "answer_id": 41567490, "question_id": 41565764, "link": "https://stackoverflow.com/questions/41565764/cant-access-go-libraries/41567490#41567490", "title": "Can&#39;t access Go libraries", "body": "<p>There are couple things you can do.</p>\n\n<ol>\n<li>Check your version of your GO if not the latest version then update your GO to version  <code>1.7</code> </li>\n<li>Delete the repo and clone again after updating GO.</li>\n<li>You could try to create new export for Golang directory with the following step : </li>\n</ol>\n\n<blockquote>\n<pre><code>export GOPATH=/home/golang/    =&gt; try to modify your golang dir here\n~$ mkdir -p $GOPATH\n~$ go get github.com/jinzhu/gorm\n</code></pre>\n</blockquote>\n\n<p>this kind of problem mention in these link : </p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/issues/6175\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/6175</a></li>\n<li><a href=\"https://go-review.googlesource.com/#/c/21342/\" rel=\"nofollow noreferrer\">https://go-review.googlesource.com/#/c/21342/</a></li>\n</ul>\n\n<p>I think the latest version has fix this issue. Hope it </p>\n"}, {"tags": [], "owner": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "is_accepted": true, "score": 1, "last_activity_date": 1484151642, "last_edit_date": 1484151642, "creation_date": 1484151298, "answer_id": 41595657, "question_id": 41565764, "link": "https://stackoverflow.com/questions/41565764/cant-access-go-libraries/41595657#41595657", "title": "Can&#39;t access Go libraries", "body": "<p>I tried this approach and it worked as this was the only work around i was left with:</p>\n\n<p>Fresh clone the project and navigate inside it;\nCreated <code>install.sh</code> which would set GOPATH, remove libraries and then re download it.</p>\n\n<pre><code>#!/bin/sh\n\n#GET current working directory\nCURRENT_DIR=`pwd`\necho \"GOPATH is pointing to ${CURRENT_DIR}\"\n#Export GOPATH for current working directory\nexport GOPATH=${CURRENT_DIR}\n\n#Change Directory permission to executable\nchmod +x ${GOPATH}\n\n#Delete github dependency so that they can be reinstalled\n#Github Issue: https://github.com/golang/go/issues/18591\n\n#Modify this script if you are adding any other packages\nrm -rf ${GOPATH}/src/github.com\n\n#dependencies.txt contain list of go get -u (repo path)\n#dependencies in new line add any new dependency and execute install.sh again\nsh dependencies.txt\n</code></pre>\n\n<p>File dependencies.txt</p>\n\n<pre><code>go get -u -v github.com/gorilla/mux\ngo get -u -v github.com/gorilla/handlers\ngo get -u -v github.com/dgrijalva/jwt-go\n</code></pre>\n\n<p>Then finally run script which would boot my application\n<code>run.sh</code></p>\n\n<pre><code>#!/bin/sh\n\n#GET current working directory\nCURRENT_DIR=`pwd`\necho \"GOPATH is pointing to ${CURRENT_DIR}\"\n\n#Export GOPATH for current working directory\nexport GOPATH=${CURRENT_DIR}\n\necho \"Starting server at http://localhost:9096\"\n#Run server instance\ngo run ${GOPATH}/path/to/main/file/Main.go\n</code></pre>\n\n<p>All this hold true with following directory structure:</p>\n\n<p><code>Project Root\n-----bin\n-----pkg\n-----src\n-----src/github.com/\n-----src/github.com/gorilla/mux\n-----src/github.com/gorilla/handlers\n-----src/yours/project/code</code></p>\n"}, {"comments": [{"owner": {"reputation": 349, "user_id": 7157204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be9a579276141bae5f9c8531dd720c23?s=128&d=identicon&r=PG&f=1", "display_name": "learning2learn", "link": "https://stackoverflow.com/users/7157204/learning2learn"}, "edited": false, "score": 1, "creation_date": 1582035922, "post_id": 52235993, "comment_id": 106632390, "body": "Thanks, this worked for me, using go 1.12 on a MacBook."}], "tags": [], "owner": {"reputation": 2932, "user_id": 7212809, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VlOyJEUeeSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jExBae7iJ2ALFtcMj_6BCoHGTMgw/mo/photo.jpg?sz=128", "display_name": "nz_21", "link": "https://stackoverflow.com/users/7212809/nz-21"}, "is_accepted": false, "score": 2, "last_activity_date": 1536414940, "creation_date": 1536414940, "answer_id": 52235993, "question_id": 41565764, "link": "https://stackoverflow.com/questions/41565764/cant-access-go-libraries/52235993#52235993", "title": "Can&#39;t access Go libraries", "body": "<p>I ran into the same issue just today and I fixed it by initializing a <code>.git</code> repo inside the local dependency. So inside <code>github.com/jinzhu/gorm</code> run:</p>\n\n<pre><code>git init \n\ngit add . \ngit commit -m \"first commit\"\n</code></pre>\n"}], "owner": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1737, "favorite_count": 0, "accepted_answer_id": 41595657, "answer_count": 3, "score": 3, "last_activity_date": 1536414940, "creation_date": 1484041648, "last_edit_date": 1484044310, "question_id": 41565764, "link": "https://stackoverflow.com/questions/41565764/cant-access-go-libraries", "title": "Can&#39;t access Go libraries", "body": "<p>I had a working go project and I added some libraries to it.\nAll was working fine till this step. Then I pushed my code to server. Again I tried to take fresh clone the repository and I am getting following error.</p>\n\n<p><strong><em>go file not find error</em></strong></p>\n\n<p>When I try to do <strong><em>go get</em></strong> - (repo again) I get </p>\n\n<pre><code>go get -u github.com/jinzhu/gorm\npackage github.com/jinzhu/gorm: directory \"/testapp/src/github.com/jinzhu/gorm\" is not using a known version control system\n</code></pre>\n\n<p>What is wrong in this approach??</p>\n\n<p>And When I am checking repository I can see git library repository point to some other repository commit.\n<a href=\"https://i.stack.imgur.com/icTkx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/icTkx.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 1, "creation_date": 1484040628, "post_id": 41565192, "comment_id": 70334811, "body": "What does appear when you run the <code>umask</code> command ?"}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "reply_to_user": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1484040730, "post_id": 41565192, "comment_id": 70334882, "body": "0022 is what it says"}, {"owner": {"reputation": 1893, "user_id": 4900669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pTcS6.jpg?s=128&g=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4900669/ivan"}, "edited": false, "score": 0, "creation_date": 1484041457, "post_id": 41565192, "comment_id": 70335337, "body": "with umask 0022 works for me when after create file add permision <code>os.Chmod(&quot;testdir&quot;, 0777)</code>, but I&#39;m not sure if it&#39;s good solution."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1484043813, "post_id": 41565192, "comment_id": 70336997, "body": "Yes, that&#39;s about interaction with the <code>umask</code> value of the current process and hence has nothing to do with neither Go nor StackOverflow in general. Please read a good introductory book on working in a Unix environment."}], "answers": [{"comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1484041109, "post_id": 41565509, "comment_id": 70335111, "body": "Thank you for your reply, however in my Go program I specify that I want 0775 permissions for the created file, and it is not working. Maybe it doesn&#39;t work and I have to change it later but it seems awkward to have that non-functional option."}, {"owner": {"reputation": 1893, "user_id": 4900669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pTcS6.jpg?s=128&g=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4900669/ivan"}, "edited": false, "score": 0, "creation_date": 1484041388, "post_id": 41565509, "comment_id": 70335278, "body": "<code>os.Mkdir</code> can&#39;t create files with permision greater than mask, but <code>os.Chmod</code> can?"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 1, "creation_date": 1484041463, "post_id": 41565509, "comment_id": 70335341, "body": "@siritinga And that&#39;s exactly your problem : The OS prevents you from creating a directory with permissions 0775. I just tried modifying the umask from 0022 to 0002 (running <code>umask 0002</code>) on my laptop and I assure you it works. This is a Unix thing, not Go&#39;s fault."}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 1893, "user_id": 4900669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pTcS6.jpg?s=128&g=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4900669/ivan"}, "edited": false, "score": 0, "creation_date": 1484041571, "post_id": 41565509, "comment_id": 70335422, "body": "@Iwan <code>os.Chmod</code> modifies permissions on an existing file, <code>os.Mkdir</code> creates a new file. The <code>umask</code> applies only on the creation operation (hopefully), that&#39;s why chmoding after creating works."}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 1893, "user_id": 4900669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pTcS6.jpg?s=128&g=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4900669/ivan"}, "edited": false, "score": 0, "creation_date": 1484041917, "post_id": 41565509, "comment_id": 70335668, "body": "@Iwan Glad I could help :)"}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1484055779, "post_id": 41565509, "comment_id": 70344813, "body": "@T.Claverie I understand what you say, and I suppose I have to use Chmod, but then maybe it is a problem in Go because it says that &quot;Mkdir creates a new directory with the specified name and permission bits&quot;, so if it isn&#39;t setting the bits nor returning an error, it is not what the documentation says. If Mkdir always creates the directories based on the umask, why you can give the file permissions to Mkdir?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 2, "creation_date": 1484080713, "post_id": 41565509, "comment_id": 70360649, "body": "@siritinga: Go is doing exactly what it says it&#39;s doing here, and is requesting the file creating with the permissions you set. Your OS is &quot;masking&quot; the permissions with the umask outside of Go&#39;s control. That&#39;s just how POSIX systems work, and you can&#39;t get by for long without understanding the underlying systems you&#39;re using."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1484376652, "post_id": 41565509, "comment_id": 70494234, "body": "@siritinga, see <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/utilities/umask.html\" rel=\"nofollow noreferrer\">this</a> and <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/umask.html\" rel=\"nofollow noreferrer\">that</a> documents which define <code>umask</code> behaviour in POSIX."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": true, "score": 4, "last_activity_date": 1484081288, "last_edit_date": 1484081288, "creation_date": 1484040921, "answer_id": 41565509, "question_id": 41565192, "link": "https://stackoverflow.com/questions/41565192/setting-os-mkdir-permissions/41565509#41565509", "title": "Setting os.Mkdir permissions", "body": "<p>When creating a file, Unix-like system use a permission mask (umask) to create the default permissions.</p>\n\n<p>With a <code>umask</code> value of <code>0022</code>, new directories will be created with permissions <code>0755</code> at most. New files will have permissions <code>0644</code> at most.</p>\n\n<p>If you want to create a new directory with permissions <code>0775</code>, then you have to set your umask value to <code>0002</code>.</p>\n\n<p>An other way of working this around is to modify the permissions after creating the file : Create it with default permissions with <code>os.Mkdir</code>, then modify those permissions with <code>os.Chmod</code>.</p>\n"}], "owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 870, "favorite_count": 0, "accepted_answer_id": 41565509, "answer_count": 1, "score": 2, "last_activity_date": 1523713633, "creation_date": 1484039910, "last_edit_date": 1523713633, "question_id": 41565192, "link": "https://stackoverflow.com/questions/41565192/setting-os-mkdir-permissions", "title": "Setting os.Mkdir permissions", "body": "<p>I'm trying to create directories with certain permissions using os.Mkdir but I cannot make it work, for some reason.</p>\n\n<p>My test program is:</p>\n\n<pre><code>package main\n\nimport (\n        \"log\"\n        \"os\"\n)\n\nfunc main() {                 \n    err := os.Mkdir(\"testdir\", 0775)\n    if err != nil {              \n        log.Print(err)\n    }\n}\n</code></pre>\n\n<p>However, the created directory has the default 0755 permissions:</p>\n\n<pre><code>drwxr-xr-x 2 user user 4096 Jan 10 10:14 testdir\n</code></pre>\n\n<p>A chmod from the shell works just fine, so I'm not sure why the Go program is not working.</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1484061039, "post_id": 41563392, "comment_id": 70348635, "body": "At least for now it looks like a bug. I think you should discuss it with Beego maintainers."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484061170, "post_id": 41563392, "comment_id": 70348725, "body": "Are you certain that you need to process the request as a stream? Can you just use the <code>Context.Request</code> directly instead of the convenience methods on BeegoInput?"}, {"owner": {"reputation": 21, "user_id": 7295110, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_mYT59gR2Ow/AAAAAAAAAAI/AAAAAAAABE0/kdsWoFfJ17w/photo.jpg?sz=128", "display_name": "Won Seok Ahn", "link": "https://stackoverflow.com/users/7295110/won-seok-ahn"}, "edited": false, "score": 0, "creation_date": 1484090057, "post_id": 41563392, "comment_id": 70365234, "body": "I need it because &quot;jQuery-file-upload&quot; requires it."}], "owner": {"reputation": 21, "user_id": 7295110, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_mYT59gR2Ow/AAAAAAAAAAI/AAAAAAAABE0/kdsWoFfJ17w/photo.jpg?sz=128", "display_name": "Won Seok Ahn", "link": "https://stackoverflow.com/users/7295110/won-seok-ahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484052409, "creation_date": 1484033316, "last_edit_date": 1484052409, "question_id": 41563392, "link": "https://stackoverflow.com/questions/41563392/beego-uses-func-request-parsemultipartform-function-on-input-go-however-go-does", "title": "Beego uses func Request.ParseMultipartForm function on input.go; however Go does not recommend it", "body": "<p>Because of <code>ParseFormOrMulitForm</code> function in Beego, I got an ERROR:</p>\n\n<blockquote>\n  <p>Handler crashed with error http: multipart handled by ParseMultipartForm</p>\n</blockquote>\n\n<p>Beego uses <code>Request.ParseMultipartForm</code> function in <a href=\"https://github.com/astaxie/beego/blob/master/context/input.go#L390\" rel=\"nofollow noreferrer\">input.go</a>.</p>\n\n<pre><code>// ParseFormOrMulitForm parseForm or parseMultiForm based on Content-type\nfunc (input *BeegoInput) ParseFormOrMulitForm(maxMemory int64) error {\n    // Parse the body depending on the content type.\n    if strings.Contains(input.Header(\"Content-Type\"), \"multipart/form-data\") {\n        if err := input.Context.Request.ParseMultipartForm(maxMemory); err != nil {\n            return errors.New(\"Error parsing request body:\" + err.Error())\n        }\n    } else if err := input.Context.Request.ParseForm(); err != nil {\n        return errors.New(\"Error parsing request body:\" + err.Error())\n    }\n    return nil\n}\n</code></pre>\n\n<p>However, I found that Go does not recommend to use <code>Request.ParseMultipartForm</code> for stream processing.</p>\n\n<p><a href=\"https://golang.org/src/net/http/request.go\" rel=\"nofollow noreferrer\">https://golang.org/src/net/http/request.go</a>:</p>\n\n<blockquote>\n  <p>Use MultipartReader function instead of ParseMultipartForm to process the request body as a stream.</p>\n</blockquote>\n\n<pre><code>362 // MultipartReader returns a MIME multipart reader if this is a\n363 // multipart/form-data POST request, else returns nil and an error.\n364 // Use this function instead of ParseMultipartForm to\n365 // process the request body as a stream.\n366 func (r *Request) MultipartReader() (*multipart.Reader, error) {\n367     if r.MultipartForm == multipartByReader {\n368         return nil, errors.New(\"http: MultipartReader called twice\")\n369     }\n370     if r.MultipartForm != nil {\n371         return nil, errors.New(\"http: multipart handled by ParseMultipartForm\")\n372     }\n373     r.MultipartForm = multipartByReader\n374     return r.multipartReader()\n375 }\n376 \n</code></pre>\n\n<p>How to fix it?</p>\n"}, {"tags": ["go", "atomic"], "comments": [{"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 1, "creation_date": 1484038258, "post_id": 41563290, "comment_id": 70333450, "body": "Which Go version are you using?"}, {"owner": {"reputation": 361, "user_id": 7229120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5af5b05b1499d40493fb6ed087bf12b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/7229120/aaron"}, "reply_to_user": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484041516, "post_id": 41563290, "comment_id": 70335381, "body": "I&#39;m using go version go1.5.3 linux/amd64"}, {"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 1, "creation_date": 1484043664, "post_id": 41563290, "comment_id": 70336884, "body": "Can you paste the exact error you get when run the program?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1484059100, "post_id": 41563290, "comment_id": 70347293, "body": "The program access the maps concurrently. Run your application with the <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">race detector</a>."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1484065538, "post_id": 41563290, "comment_id": 70351807, "body": "To expand on the previous comment, maps are not goroutine-safe. If you are doing concurrent access to a map and one or more goroutines might be changing it, you need to protect it with a mutex (or equivalent)."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1484066650, "post_id": 41563290, "comment_id": 70352520, "body": "Worth noting that atomic doesn&#39;t really buy you much here.  Your <code>B</code> struct is can be stored atomically, but maps are reference types, which means the changes in <code>WriteB</code> are visible in <code>WriteA</code> as they are run.  This shouldn&#39;t cause pointer errors (deleting a key from a map doesn&#39;t delete what the actual object that was stored there), but it does rather invalidate what you&#39;re trying to do here."}, {"owner": {"reputation": 361, "user_id": 7229120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5af5b05b1499d40493fb6ed087bf12b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/7229120/aaron"}, "reply_to_user": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484185489, "post_id": 41563290, "comment_id": 70409963, "body": "@Ankur I&#39;ve edited this question and the errors is there."}, {"owner": {"reputation": 361, "user_id": 7229120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5af5b05b1499d40493fb6ed087bf12b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/7229120/aaron"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1484185821, "post_id": 41563290, "comment_id": 70410053, "body": "@Kaedys thanks. So if the map is a reference type, how can we explain the effect of the &quot;b := store.Load().(B)&quot;?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1484236937, "post_id": 41563290, "comment_id": 70436775, "body": "@\u5f20\u5f20\u5f6a You&#39;re loading the structure which contains the map into the variable b.  The store still holds the value properly, and via the atomic Load and Store operations, the <i>structure</i> storage and loads are atomic.  The structure, however, contains a reference, and that reference doesn&#39;t inherit the atomic storage and retrieval, because other processes can change the object being referenced, even if they can&#39;t change the structure itself."}], "answers": [{"tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": true, "score": 1, "last_activity_date": 1484197055, "creation_date": 1484197055, "answer_id": 41605396, "question_id": 41563290, "link": "https://stackoverflow.com/questions/41563290/how-to-use-load-and-store-of-atomic-in-golang/41605396#41605396", "title": "How to use Load and Store of atomic in golang", "body": "<p>When you comment out <code>b := store.Load().(B)</code> the variable <code>b</code> used in the function is the global <code>b</code> which is of type <code>*B</code> and when you do <code>store.Store(b)</code> you get the error because you are trying to store <code>*B</code> type value in the store which has value of type <code>B</code>. That's why the error talks about inconsistent type. You can change <code>store.Store(b)</code> to <code>store.Store(*b)</code> and the code will work without error.</p>\n"}], "owner": {"reputation": 361, "user_id": 7229120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5af5b05b1499d40493fb6ed087bf12b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/7229120/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2057, "favorite_count": 0, "accepted_answer_id": 41605396, "answer_count": 1, "score": 1, "last_activity_date": 1484197055, "creation_date": 1484032913, "last_edit_date": 1484185289, "question_id": 41563290, "link": "https://stackoverflow.com/questions/41563290/how-to-use-load-and-store-of-atomic-in-golang", "title": "How to use Load and Store of atomic in golang", "body": "<p>Here are the piece of code to test the mutual access of write and read of a struct B using atomic.Value, but I've got some error indicating invalid pointer access. So what should I do? And what is the idiomatic of doing this?</p>\n\n<pre><code>type A struct {\n    numMap map[string]int\n}\n\ntype B struct {\n    numMap map[string]*A\n}\n\nvar store atomic.Value\n\nvar chanA chan bool = make(chan bool, 100)\nvar chanB chan bool = make(chan bool, 100)\n\nvar b *B = &amp;B{}\n\nfunc fetchB() {\n    for i := 0; i &lt; 10000; i++ {\n        c := store.Load().(B)\n        for k, v := range c.numMap {\n            fmt.Println(k, v)\n            for k2, v2 := range v.numMap {\n                fmt.Println(k2, v2)\n            }\n        }\n    }\n    chanA &lt;- true\n}\n\nfunc writeB() {\n    for i := 0; i &lt; 10000; i++ {\n        //b := store.Load().(B)\n        a := new(A)\n        a.numMap = make(map[string]int)\n        a.numMap[\"AMap\"] = i\n        b.numMap = make(map[string]*A)\n        b.numMap[\"str\"] = a\n        b.numMap[\"strA\"] = a\n        delete(b.numMap, \"str\")\n        delete(b.numMap[\"strA\"].numMap, \"AMap\")\n        store.Store(b)\n    }\n    chanB &lt;- true\n}\nfunc main() {\n    store.Store(*b)\n    for i := 0; i &lt; 100; i++ {\n        go writeB()\n        go fetchB()\n    }\n    for i := 0; i &lt; 100; i++ {\n        &lt;-chanA\n        &lt;-chanB\n    }\n}\n</code></pre>\n\n<p>I'm sorry I've missed something in the first post of the question. If I comment b := store.Load().(B) the error raises, and it is gone if i leave it visible. So why would this happen?</p>\n\n<p>the error I've got is something like this:</p>\n\n<pre><code>panic: sync/atomic: store of inconsistently typed value into Value\n\ngoroutine 5 [running]: sync/atomic.(*Value).Store(0x597310, 0x4b7f40, 0x597198)\n    /usr/local/go/src/sync/atomic/value.go:76 +0x1e9 main.writeB()\n    /home/bzhang/devCode/common/src/go/src/audience_service/test.go:47 +0x2cc created by main.main\n    /home/bzhang/devCode/common/src/go/src/audience_service/test.go:54 +0x71\n\ngoroutine 1 [chan receive]: main.main()\n    /home/bzhang/devCode/common/src/go/src/audience_service/test.go:59 +0xf3\n\ngoroutine 6 [runnable]: main.fetchB()\n    /home/bzhang/devCode/common/src/go/src/audience_service/test.go:23 created by main.main\n    /home/bzhang/devCode/common/src/go/src/audience_service/test.go:55 +0x89\n\ngoroutine 7 [runnable]: main.writeB()\n    /home/bzhang/devCode/common/src/go/src/audience_service/test.go:36 created by main.main\n    /home/bzhang/devCode/common/src/go/src/audience_service/test.go:54 +0x71\n\ngoroutine 8 [runnable]: main.fetchB()\n    /home/bzhang/devCode/common/src/go/src/audience_service/test.go:23 created by main.main\n    /home/bzhang/devCode/common/src/go/src/audience_service/test.go:55 +0x89\n\ngoroutine 9 [runnable]: main.writeB()\n    /home/bzhang/devCode/common/src/go/src/audience_service/test.go:36 created by main.main\n    /home/bzhang/devCode/common/src/go/src/audience_service/test.go:54 +0x7\n</code></pre>\n"}, {"tags": ["go", "compilation"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484062534, "post_id": 41561819, "comment_id": 70349689, "body": "Why not use the tests to check the build?"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1484026958, "last_edit_date": 1495540373, "creation_date": 1484026958, "answer_id": 41561880, "question_id": 41561819, "link": "https://stackoverflow.com/questions/41561819/how-to-check-if-a-go-app-is-buildable/41561880#41561880", "title": "How to check if a go app is buildable?", "body": "<p>One way would be <a href=\"https://stackoverflow.com/a/16863226/6309\"><code>gofmt -e my_file.go</code></a> on all files, but:</p>\n\n<ul>\n<li>that would not scale well</li>\n<li>This doesn't actually report all errors that <code>go build</code> might.</li>\n</ul>\n\n<p>Meaning: <code>go build -o /dev/null</code> might still be the more thorough approach.</p>\n\n<p>For just validating syntax and structure: <a href=\"https://godoc.org/golang.org/x/tools/cmd/gotype\" rel=\"nofollow noreferrer\">see <code>gotype</code></a></p>\n"}, {"tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 1, "last_activity_date": 1484029063, "last_edit_date": 1484029063, "creation_date": 1484028647, "answer_id": 41562203, "question_id": 41561819, "link": "https://stackoverflow.com/questions/41561819/how-to-check-if-a-go-app-is-buildable/41562203#41562203", "title": "How to check if a go app is buildable?", "body": "<blockquote>\n  <p>How to check if a go app is buildable?</p>\n</blockquote>\n\n<p>As I understand your question, you wanted to see if the file you're editing has no error.</p>\n\n<p>then you can use <a href=\"https://github.com/fatih/vim-go\" rel=\"nofollow noreferrer\">vim-go plugin</a> for vim.</p>\n\n<p>And then setup your .vimrc for creating the shortcut : </p>\n\n<pre><code>\"shortcut for vim-go\nau FileType go nmap &lt;leader&gt;r &lt;Plug&gt;(go-run)\nau FileType go nmap &lt;leader&gt;b &lt;Plug&gt;(go-build)\nau FileType go nmap &lt;leader&gt;t &lt;Plug&gt;(go-test)\nau FileType go nmap &lt;leader&gt;c &lt;Plug&gt;(go-coverage)\n</code></pre>\n\n<p>I use this as my daily work life when I want to see my file has no error I just type <code>\\+b</code>. and then it will output the error without typing <code>go build</code> in the terminal.</p>\n\n<p>hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "is_accepted": false, "score": 0, "last_activity_date": 1484036994, "last_edit_date": 1484036994, "creation_date": 1484036577, "answer_id": 41564237, "question_id": 41561819, "link": "https://stackoverflow.com/questions/41561819/how-to-check-if-a-go-app-is-buildable/41564237#41564237", "title": "How to check if a go app is buildable?", "body": "<p>I use <a href=\"https://code.visualstudio.com/\" rel=\"nofollow noreferrer\">VSCode</a> and I've found it to be the better than Sublime when it comes to Go with <a href=\"https://github.com/Microsoft/vscode-go\" rel=\"nofollow noreferrer\">this</a> extension.\nWhen I save the document, it formats it well. It shows the the errors as I write code with the help of <a href=\"https://github.com/golang/lint\" rel=\"nofollow noreferrer\">golint</a> making development very manageable.</p>\n\n<p>You can also use golint separately just like gofmt.\nYou can also try go vet. There are debates going on around what to use when but I'd just advise to use both if you can.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1484048831, "last_edit_date": 1495541637, "creation_date": 1484048831, "answer_id": 41568105, "question_id": 41561819, "link": "https://stackoverflow.com/questions/41561819/how-to-check-if-a-go-app-is-buildable/41568105#41568105", "title": "How to check if a go app is buildable?", "body": "<p>To check if a package or app is buildable, <code>go build</code> is the \"official\" way.</p>\n\n<p>What you did is the easiest way. In my opinion, you should stick to it. Alternatively you may do:</p>\n\n<pre><code>go build -o delme &amp;&amp; rm delme\n</code></pre>\n\n<p>But it's somewhat slower as it has to write the result which is then deleted, but this solution is platform independent (as <code>/dev/null</code> does not exist on windows).</p>\n\n<p>When building a command (<code>main</code> package), by definition <code>go build</code> will create and leave the result in the <em>current working directory</em>. If you build a \"normal\" package (non-<code>main</code>), the results will be <em>discarded</em>. See details here: <a href=\"https://stackoverflow.com/questions/30612611/what-does-go-build-build\">What does go build build?</a></p>\n\n<p>So if it bothers you that you have to use the <code>-o /dev/null</code> param or manually delete the result, you may \"transform\" your <code>main</code> package to a non-<code>main</code>, let's call it <code>main2</code>. And add a new <code>main</code> package which should do nothing else but import and call <code>main2.Main()</code>. Building the <code>main2</code> package will not leave any files behind.</p>\n\n<p>E.g. <code>myapp/main.go</code>:</p>\n\n<pre><code>package main\n\nimport \"myapp/main2\"\n\nfunc main() { main2.Main() }\n</code></pre>\n\n<p><code>myapp/main2/main2.go</code>:</p>\n\n<pre><code>// Every content you originally had in main.go\n\npackage main2\n\nfunc Main() {\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1484048831, "creation_date": 1484026649, "last_edit_date": 1484026954, "question_id": 41561819, "link": "https://stackoverflow.com/questions/41561819/how-to-check-if-a-go-app-is-buildable", "title": "How to check if a go app is buildable?", "body": "<p>I write some code then build the app to an output file, but sometimes I just want to check if the app is buildable, i.e. has no errors and produces a compiled output, but without actually writing the output file.</p>\n\n<p>I tried this variant and it seemed to work:</p>\n\n<pre><code>go build -o /dev/null myapp\n</code></pre>\n\n<p>But I suspect there must be a more \"official\" Go way to check if it can build.</p>\n\n<p>Please advise!</p>\n"}, {"tags": ["go", "error-handling"], "comments": [{"owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "edited": false, "score": 2, "creation_date": 1484016354, "post_id": 41560241, "comment_id": 70325561, "body": "according to to the <a href=\"https://golang.org/src/errors/errors.go\" rel=\"nofollow noreferrer\">source</a> , <code>Error()</code> method returns the message, so you can do <code>some_err.Error()</code> to get the message."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1484020531, "post_id": 41560241, "comment_id": 70326476, "body": "<a href=\"https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully\" rel=\"nofollow noreferrer\">dave.cheney.net/2016/04/27/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "edited": false, "score": 0, "creation_date": 1484016716, "post_id": 41560303, "comment_id": 70325644, "body": "Is it possible to make the <code>var erros.New</code> a <code>const</code>?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1484066907, "post_id": 41560303, "comment_id": 70352711, "body": "This won&#39;t work if the underlying error is a different type, even if it has the same output from <code>err.Error()</code>.  Example: <a href=\"https://play.golang.org/p/uujqxa3Qdq\" rel=\"nofollow noreferrer\">play.golang.org/p/uujqxa3Qdq</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1484067370, "post_id": 41560303, "comment_id": 70353025, "body": "@Kaedys Errors values are not equal just because they have the same string representation.  The function <code>errors.New()</code> is explicitly designed to return a unique value that will not compare == to any other error value. For example the expression <code>errors.New(&quot;x&quot;) == errors.New(&quot;x&quot;)</code> evaluates to false.  The playground example is working as designed.  It may be OK to compare string representations in Java, but it&#39;s not the practice in Go."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1484067453, "post_id": 41560303, "comment_id": 70353074, "body": "Yes, that was my point, Cerise.  Defining your own package constant that has an <code>Error()</code> output equal to what you&#39;re checking for won&#39;t always work, because comparing errors does NOT compare just the <code>Error()</code> output.  You have to either do a string comparison (brittle) or the package the error came from needs to define exported error constants you can compare to."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1484068000, "post_id": 41560303, "comment_id": 70353466, "body": "...I literally just said that."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1484068167, "post_id": 41560303, "comment_id": 70353587, "body": "Sorry, my &quot;just&quot; in that case wasn&#39;t meant to indicate that they were compared, but that such a check wouldn&#39;t be sufficient even if they were compared.  My point is, if you&#39;re getting an error back <i>from another package</i>, the <i>only</i> ways to check that error for a particular value are to check the <code>Error()</code> output (which is brittle), or to compare it against an exported error defined by the originating package.  If the package didn&#39;t export any error values, defining your own with the same message for comparison <i>won&#39;t work</i>."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 10, "last_activity_date": 1484067588, "last_edit_date": 1484067588, "creation_date": 1484016270, "answer_id": 41560303, "question_id": 41560241, "link": "https://stackoverflow.com/questions/41560241/compare-error-message-in-golang/41560303#41560303", "title": "Compare error message in golang", "body": "<p>Declare a package level variable with the error:</p>\n\n<pre><code>var errExample = errors.New(\"this is an example\")\n</code></pre>\n\n<p>Use this value when returning errors. Compare against this value to check for the specific error:</p>\n\n<pre><code>if err == errExample {\n    // handle it\n}\n</code></pre>\n\n<p>Export the variable if code outside the package needs to access the error:</p>\n\n<pre><code>var ErrExample = errors.New(\"this is an example\")\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>if err == somepackage.ErrExample {\n    // handle it\n}\n</code></pre>\n\n<p><a href=\"https://godoc.org/net/http#ErrBodyNotAllowed\" rel=\"noreferrer\">Here are some examples</a>.</p>\n\n<p>Avoid comparing against the string returned from the error's <a href=\"https://godoc.org/builtin#error.Error\" rel=\"noreferrer\">Error()</a> method. It can make your code brittle.</p>\n"}, {"tags": [], "owner": {"reputation": 894, "user_id": 1947741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3zyB.png?s=128&g=1", "display_name": "amku91", "link": "https://stackoverflow.com/users/1947741/amku91"}, "is_accepted": false, "score": 4, "last_activity_date": 1537538025, "creation_date": 1537538025, "answer_id": 52445274, "question_id": 41560241, "link": "https://stackoverflow.com/questions/41560241/compare-error-message-in-golang/52445274#52445274", "title": "Compare error message in golang", "body": "<p>we can also compare errors like that:</p>\n\n<ol>\n<li>If you creating error like this [Error Code Based]</li>\n</ol>\n\n<p>_</p>\n\n<pre><code>var errExample = errors.New(\"ERROR_CODE\")\n</code></pre>\n\n<p>then you can directly check error like this</p>\n\n<pre><code>if err.Error() == \"ERROR_CODE\" {\n//Do something error caught\n}\n</code></pre>\n\n<ol start=\"2\">\n<li>If you creating error like this [Error Code Based]</li>\n</ol>\n\n<p>package mypackage</p>\n\n<pre><code>var NoMoreData = errors.New(\"No more data\")\n</code></pre>\n\n<p>Now you can check anywhere like this</p>\n\n<pre><code>if err != mypackage.NoMoreData{\n//Do something error caught\n}\n</code></pre>\n\n<p>If you want to compare two errors at a time then you can do like this:</p>\n\n<pre><code>err1 := errors.New(\"Error Caught\")\nerr2 := errors.New(\"Error Caught\")\n\nfmt.Println(err1 == err2) // false | Never do like this\n\nfmt.Println(err1.Error() == err2.Error()) // true | Do like this\n</code></pre>\n\n<p>That's All.</p>\n"}], "owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4989, "favorite_count": 0, "accepted_answer_id": 41560303, "answer_count": 2, "score": 5, "last_activity_date": 1537538025, "creation_date": 1484015887, "question_id": 41560241, "link": "https://stackoverflow.com/questions/41560241/compare-error-message-in-golang", "title": "Compare error message in golang", "body": "<p>Let's say I create a new error in golang like so</p>\n\n<pre><code>err := errors.New(\"SOME_COMMON_ERROR_CODE\")\n</code></pre>\n\n<p>In java, I'm used to being able to get Exception with <code>GetMessage()</code> messages. How would I compare that error if returned?</p>\n\n<pre><code>if some_err := some_package.DoSomething(); some_err != nil {\n    if some_err.GetMessage() == \"SOME_COMMON_ERROR_CODE\" {\n        // handle it however.\n    }\n}\n</code></pre>\n\n<p>How is this done in golang?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1484016237, "post_id": 41560218, "comment_id": 70325539, "body": "I&#39;m not sure what you&#39;re asking (although others might be). Can you give more details about what you&#39;re trying to do? Also, there are no classes in Go."}, {"owner": {"reputation": 1041, "user_id": 2577326, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a271c324eda7467ebd83e03b290eb671?s=128&d=identicon&r=PG", "display_name": "michaelAdam", "link": "https://stackoverflow.com/users/2577326/michaeladam"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1484016357, "post_id": 41560218, "comment_id": 70325562, "body": "Im trying to understand how to store binary data, of unknown length. I mean class in the informal sense (I know you use the keyword &quot;type&quot; in Go). If I have 65 bits, how do I store them contiguously?"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1484016715, "post_id": 41560218, "comment_id": 70325643, "body": "I guess it depends on how you need to operate on it. You could certainly use a slice (or array) of 9 bytes to store 65 bits. You can think about creating an interface that allows you to operate on that 65-bit value in whatever way you need to operate on it. That may give you a better idea of how you should represent it internally. If you&#39;re going to have several of these 65-bit values that represent some stream of bits, you&#39;d probably want to do it some more efficient way than wasting a whole byte to store one bit."}, {"owner": {"reputation": 1041, "user_id": 2577326, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a271c324eda7467ebd83e03b290eb671?s=128&d=identicon&r=PG", "display_name": "michaelAdam", "link": "https://stackoverflow.com/users/2577326/michaeladam"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1484017723, "post_id": 41560218, "comment_id": 70325841, "body": "I think this will be very helpful. <a href=\"https://github.com/32bitkid/bitreader\" rel=\"nofollow noreferrer\">github.com/32bitkid/bitreader</a>"}], "answers": [{"tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": false, "score": 0, "last_activity_date": 1484021736, "creation_date": 1484021736, "answer_id": 41561043, "question_id": 41560218, "link": "https://stackoverflow.com/questions/41560218/what-is-the-best-way-to-read-and-write-purely-binary-information-in-go/41561043#41561043", "title": "What is the best way to read and write purely binary information in Go?", "body": "<p>You could probably use bitarray data structure for this. Check out this <a href=\"https://godoc.org/github.com/golang-collections/go-datastructures/bitarray\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/golang-collections/go-datastructures/bitarray</a></p>\n"}], "owner": {"reputation": 1041, "user_id": 2577326, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a271c324eda7467ebd83e03b290eb671?s=128&d=identicon&r=PG", "display_name": "michaelAdam", "link": "https://stackoverflow.com/users/2577326/michaeladam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484021736, "creation_date": 1484015654, "question_id": 41560218, "link": "https://stackoverflow.com/questions/41560218/what-is-the-best-way-to-read-and-write-purely-binary-information-in-go", "title": "What is the best way to read and write purely binary information in Go?", "body": "<p>I want to implement Huffman coding by hand for a personal project. The part I am stuck on is how to store the coding. Say my input can be encoded using 65 bits. Do I make a class which wraps a byte slice of 9 bytes, and treats the elements as one continuous piece of memory? Or is there a way to do what I want more directly?</p>\n"}, {"tags": ["pointers", "go", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1484027360, "post_id": 41559987, "comment_id": 70328433, "body": "&quot;Why are pointers used in the first one?&quot; Because the author choose to do so."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1484028511, "post_id": 41559987, "comment_id": 70328831, "body": "I dont see any particular reasoning"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1484029354, "post_id": 41559987, "comment_id": 70329149, "body": "All i can see here is a slight advntage with respect to cache coherence . Using the struct as such in the slice would be good as there would be required data in sequence. Spatial locality is important in optimising cache usage,  this refers to placing related data close to eachother."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1484067316, "post_id": 41559987, "comment_id": 70352991, "body": "One thing that he isn&#39;t doing, but <i>could</i> do, that would require a pointer in the first example is updating the struct fields.  You can&#39;t alter the struct fields of objects stored in a map without an intermediate variable (because they are not addressable), but you <i>can</i> if the struct is stored in the map by pointer instead: <a href=\"http://devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-golang/index.html#map_value_field_update\" rel=\"nofollow noreferrer\">devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-gol&zwnj;&#8203;ang/&hellip;</a>.  This restriction does not apply to slices."}], "answers": [{"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1484028525, "post_id": 41561118, "comment_id": 70328837, "body": "Not answering the question"}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1484028950, "post_id": 41561118, "comment_id": 70328991, "body": "I wanted to help him to understand the usage of pointer in slice. and why we need to use it in map. maybe this is just an opinion. but I hope my answer help him"}], "tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1484022597, "last_edit_date": 1495535449, "creation_date": 1484022240, "answer_id": 41561118, "question_id": 41559987, "link": "https://stackoverflow.com/questions/41559987/why-are-pointers-used-for-struct-instances-in-this-golang-tutorial/41561118#41561118", "title": "Why are pointers used for struct instances in this golang tutorial?", "body": "<p>First of all you need to understand what pointer is used for. When you want to <strong>share</strong> the value use Pointer as the <a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow noreferrer\">Tour of Go</a> </p>\n\n<blockquote>\n  <p>A pointer holds the memory address of a value</p>\n</blockquote>\n\n<p>As the first tutorial because they wanted to create variable that share value so it uses less memory.</p>\n\n<p>As the second tutorial you don't need to add pointer variable to a slice.\nBecause Slice it self is a reference type.</p>\n\n<blockquote>\n  <p>Slices hold references to an underlying array, and if you assign one\n  slice to another, both refer to the same array.</p>\n</blockquote>\n\n<p>some reference : \n<a href=\"https://golang.org/doc/effective_go.html#slices\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#slices</a><br>\n<a href=\"https://stackoverflow.com/a/2441112/2652524\">https://stackoverflow.com/a/2441112/2652524</a></p>\n"}, {"tags": [], "owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "is_accepted": false, "score": 0, "last_activity_date": 1484030381, "creation_date": 1484030381, "answer_id": 41562605, "question_id": 41559987, "link": "https://stackoverflow.com/questions/41559987/why-are-pointers-used-for-struct-instances-in-this-golang-tutorial/41562605#41562605", "title": "Why are pointers used for struct instances in this golang tutorial?", "body": "<p>I glanced through the article and I can't see any particular reason. Perhaps he's implemented something that wasn't covered in that post like a method receiver for *Movie.</p>\n\n<p>Consider this example: <a href=\"https://play.golang.org/p/SZb47MKIr3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/SZb47MKIr3</a></p>\n\n<p>It'll fail to compile because the \"Print\" function has a <strong>Pointer Receiver</strong>, but the instances in the map are not pointers.</p>\n\n<p>Whereas this example: <a href=\"https://play.golang.org/p/g0aXXcze5d\" rel=\"nofollow noreferrer\">https://play.golang.org/p/g0aXXcze5d</a> Runs fine.</p>\n\n<p>This is a good post explaining the difference: <a href=\"https://nathanleclaire.com/blog/2014/08/09/dont-get-bitten-by-pointer-vs-non-pointer-method-receivers-in-golang/\" rel=\"nofollow noreferrer\">https://nathanleclaire.com/blog/2014/08/09/dont-get-bitten-by-pointer-vs-non-pointer-method-receivers-in-golang/</a></p>\n"}], "owner": {"reputation": 1585, "user_id": 5025679, "user_type": "registered", "accept_rate": 7, "profile_image": "https://graph.facebook.com/10102218283349199/picture?type=large", "display_name": "Bobby Battista", "link": "https://stackoverflow.com/users/5025679/bobby-battista"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "closed_date": 1491993929, "answer_count": 2, "score": 3, "last_activity_date": 1484030381, "creation_date": 1484013588, "question_id": 41559987, "link": "https://stackoverflow.com/questions/41559987/why-are-pointers-used-for-struct-instances-in-this-golang-tutorial", "closed_reason": "Opinion-based", "title": "Why are pointers used for struct instances in this golang tutorial?", "body": "<p>Making a simple api in golang, why does <a href=\"http://www.giantflyingsaucer.com/blog/?p=5635\" rel=\"nofollow noreferrer\">this</a> tutorial use</p>\n\n<pre><code>var movies = map[string]*Movie{\n    \"tt0076759\": &amp;Movie{Title: \"Star Wars: A New Hope\", Rating: \"8.7\", Year: \"1977\"},\n    \"tt0082971\": &amp;Movie{Title: \"Indiana Jones: Raiders of the Lost Ark\", Rating: \"8.6\", Year: \"1981\"},\n}\n</code></pre>\n\n<p>while <a href=\"http://thenewstack.io/make-a-restful-json-api-go/\" rel=\"nofollow noreferrer\">this other tutorial</a> uses something more like:</p>\n\n<pre><code>type Movies []Movie\nvar movies Movies\nmovies = append(movies, Movie{id: \"tt0076759\", Title: \"Star Wars: A New Hope\", Rating: \"8.7\", Year: \"1977\"})\n</code></pre>\n\n<p>It seems like the first one gives me a map containing key value pairs where the value is a pointer to a movie. And the second one gives me an array(slice?) of movies where the id serves as the key for lookup. Why are pointers used in the first one?</p>\n"}, {"tags": ["jquery", "ajax", "go"], "comments": [{"owner": {"reputation": 75, "user_id": 7389512, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10208271644889050/picture?type=large", "display_name": "Matt Morrow", "link": "https://stackoverflow.com/users/7389512/matt-morrow"}, "edited": false, "score": 0, "creation_date": 1484013862, "post_id": 41559937, "comment_id": 70325025, "body": "Update. For some odd reason other items on the page fail to respond after the page is loaded, until at least one of them is clicked 2 times. After one element (a button, dropdown, etc) is clicked twice, everything else begins to respond."}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 7389512, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10208271644889050/picture?type=large", "display_name": "Matt Morrow", "link": "https://stackoverflow.com/users/7389512/matt-morrow"}, "is_accepted": false, "score": 1, "last_activity_date": 1484014081, "creation_date": 1484014081, "answer_id": 41560041, "question_id": 41559937, "link": "https://stackoverflow.com/questions/41559937/golang-ajax-post-data/41560041#41560041", "title": "Golang + ajax post data", "body": "<p>I found the bug. Earlier I was experimenting with not allowing clicks outside of a modal dialog, and was using $(document).click(function () { ... } wrapped around all my jscript code. Once I removed that, everything else fixed itself.</p>\n"}], "owner": {"reputation": 75, "user_id": 7389512, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10208271644889050/picture?type=large", "display_name": "Matt Morrow", "link": "https://stackoverflow.com/users/7389512/matt-morrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2335, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484091861, "creation_date": 1484013151, "last_edit_date": 1484091861, "question_id": 41559937, "link": "https://stackoverflow.com/questions/41559937/golang-ajax-post-data", "title": "Golang + ajax post data", "body": "<p>I've got a page with a number of fields, not in a form setup because I wanna be able to act on them individually and post with ajax. I am using Go to process the post data. However, it seems to post multiple times because in my Go code I am outputting a post variable to the console to test, and it dumps the output 5 times, which represents the number of variables in the post data. I also had this type of behavior when I just used a jquery alert to show the post data. Am I misunderstanding something about how ajax posts, or is there some other bug going on?</p>\n\n<h2>Go code</h2>\n\n<pre><code>func addProduct(w http.ResponseWriter, r *http.Request, p httprouter.Params) {\n\n              frmCategory:=r.PostFormValue(\"category\")\n              fmt.Println(frmCategory)\n}\n\nfunc main() {\n\n          router:=httprouter.New()\n          router.POST(\"/addProduct\",addProduct)\n\n}\n</code></pre>\n\n<h2>AJAX code</h2>\n\n<pre><code>&lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\" type=\"text/css\"&gt;\n    &lt;script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js\"&gt;&lt;/script&gt;\n\n    &lt;script src=\"//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n\n    &lt;!-- &lt;script src=\"http://code.jquery.com/jquery-1.4.1.min.js\"&gt;&lt;/script&gt; --&gt;\n\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"//netdna.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css\"&gt;\n    &lt;link href=\"//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css\" rel='stylesheet' type='text/css'&gt;\n\nvar postData=\"bcode\\=\"+ $('#bCodeID').val()+\"&amp;category\\=\"+$(\"#selected_category\").val()+\"&amp;price\\=\"+priceModifier+\"&amp;description\\=\"+$('#itemDescription').val()+\"&amp;colorcode\\=\"+$('#SelectedColorCode').val();\n\n$.ajax({\n\n        url: '/addProduct',\n        type: 'post',\n        dataType: 'text',\n        data : postData,\n        success : function(data) {\n              $('#warningBox').modal({\n                  show: false\n              });\n        }\n});\n</code></pre>\n\n<h2>Console output</h2>\n\n<pre><code>Toys\n\nToys\n\nToys\n\nToys\n\nToys\n\nToys\n\nToys\n</code></pre>\n"}, {"tags": ["ssl", "go", "docker", "certificate", "openshift-origin"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1484026559, "last_edit_date": 1484026559, "creation_date": 1484026219, "answer_id": 41561744, "question_id": 41559601, "link": "https://stackoverflow.com/questions/41559601/tls-self-signed-certificate-for-auth-url-for-docker/41561744#41561744", "title": "TLS self-signed certificate for auth URL for Docker", "body": "<p>You could <em>test</em> an <a href=\"https://docs.docker.com/registry/insecure/\" rel=\"nofollow noreferrer\">insecure registry</a> by adding </p>\n\n<pre><code>DOCKER_OPTS=\"--insecure-registry myregistrydomain.com:5000\"\n</code></pre>\n\n<p>to your  <code>/etc/default/docker</code> file or <code>/etc/sysconfig/docker</code> file</p>\n\n<p>But it is best to <a href=\"https://docs.docker.com/registry/insecure/#/using-self-signed-certificates\" rel=\"nofollow noreferrer\">add your self-signed certificate</a> to <code>/etc/docker/certs.d/myregistrydomain.com:5000/ca.crt</code>. And restart your Docker daemon.<br>\nThat way, it will trust your certificate.  </p>\n\n<p>Note that Openshift origin has a <a href=\"https://github.com/openshift/origin/issues/1753\" rel=\"nofollow noreferrer\">currently open issue 1753</a> \"Need mechanism for registering certs for private docker registries\"\nSee also \"<a href=\"https://github.com/openshift/origin/issues/6228\" rel=\"nofollow noreferrer\">Can not pull image from remote node #6228</a>\" referring to the Openshift official documentation \"<a href=\"https://docs.openshift.org/latest/install_config/registry/securing_and_exposing_registry.html\" rel=\"nofollow noreferrer\">Securing and Exposing the Registry</a>\".</p>\n"}], "owner": {"reputation": 195, "user_id": 1587925, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lln0t.jpg?s=128&g=1", "display_name": "Jeffrey Poore", "link": "https://stackoverflow.com/users/1587925/jeffrey-poore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 759, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1484026559, "creation_date": 1484010189, "question_id": 41559601, "link": "https://stackoverflow.com/questions/41559601/tls-self-signed-certificate-for-auth-url-for-docker", "title": "TLS self-signed certificate for auth URL for Docker", "body": "<p>I am trying to log in to the Docker registry you build with the oadm tool. I attempt to log in using a token:</p>\n\n<pre><code># docker login -u $(oc whoami) -e 'xxxx' -p $(oc whoami -t) 172.30.10.52:5000\nError response from daemon: no successful auth challenge for   \nhttps://172.30.10.52:5000/v2/ - errors: [basic auth attempt to \nhttps://172.30.10.52:5000/v2/ realm \"openshift\" failed with status: 400 Bad \nRequest]\n</code></pre>\n\n<p>Looking in the logs, I can see that the problem is because my instance uses a self-signed certificate:</p>\n\n<pre><code>time=\"2017-01-10T00:58:42.913539516Z\" level=error msg=\"error authorizing context: \nGet https://ld7-zko8s6q-ws:8443/oapi/v1/users/~: x509: \ncertificate signed by unknown authority\" \ngo.version=go1.4.2 http.request.host=\"172.30.10.52:5000\" \nhttp.request.id=3fa81975-3aa9-44d8-a6a8-c00ad360009c \nhttp.request.method=GET http.request.remoteaddr=\"10.1.0.1:49316\" \nhttp.request.uri=\"/v2/\" http.request.useragent=\"docker/1.10.3 go/go1.6.2 \ngit-commit/429be27-unsupported kernel/3.10.0-514.2.2.el7.x86_64 \nos/linux arch/amd64\" instance.id=2a23b229-2a0e-4734-83c4-38cb9c8a0e00 \n</code></pre>\n\n<p>How can I either get my certificate to be trusted or to turn off TLS verification?</p>\n"}, {"tags": ["windows", "go"], "answers": [{"comments": [{"owner": {"reputation": 1310, "user_id": 2266428, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/W8K6m.png?s=128&g=1", "display_name": "J E Carter II", "link": "https://stackoverflow.com/users/2266428/j-e-carter-ii"}, "edited": false, "score": 0, "creation_date": 1559309820, "post_id": 41560947, "comment_id": 99390782, "body": "Thanks for the example.  I&#39;m trying this out with go1.12.5 and get a missing return error on the WINEVENTPROC func.  You say you forced a return value type of uintptr, but how is a value assigned in your code?  Did a previous version of go implicitly return a 0 or some other value without a return statement?"}], "tags": [], "owner": {"reputation": 5609, "user_id": 1226748, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/RfDKy.jpg?s=128&g=1", "display_name": "Jimmy Obonyo Abor", "link": "https://stackoverflow.com/users/1226748/jimmy-obonyo-abor"}, "is_accepted": true, "score": 2, "last_activity_date": 1484021060, "creation_date": 1484021060, "answer_id": 41560947, "question_id": 41559026, "link": "https://stackoverflow.com/questions/41559026/go-lang-set-windows-events-hooks/41560947#41560947", "title": "Go lang set windows events hooks", "body": "<p>So after research i noticed that </p>\n\n<p><code>syscall.NewCallback()</code> required an output value , for <code>WinEventProc</code> however from MSDN , the callback <code>WinEventProc</code> didn't return any value , so a \"forced\" a return value of type <code>uintptr</code> and worked perfectly.Like below code :</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"syscall\"\n    \"unsafe\"\n    \"log\"\n    \"golang.org/x/sys/windows\"\n)\n\nvar(\n    user32 = windows.NewLazyDLL(\"user32.dll\")\n    modkernel32 = windows.NewLazyDLL(\"kernel32.dll\")\n\n    procSetWinEventHook     = user32.NewProc(\"SetWinEventHook\")\n    procUnhookWinEvent      = user32.NewProc(\"UnhookWinEvent\")\n    procGetMessage = user32.NewProc(\"GetMessageW\")\n    procTranslateMessage = user32.NewProc(\"TranslateMessage\")\n    procDispatchMessage = user32.NewProc(\"DispatchMessageW\")\n\n    procGetModuleHandle            = modkernel32.NewProc(\"GetModuleHandleW\")\n\n    ActiveWinEventHook WINEVENTPROC = func (hWinEventHook HWINEVENTHOOK, event uint32, hwnd HWND, idObject int32, idChild int32, idEventThread uint32, dwmsEventTime uint32) uintptr  {\n        log.Println(\"fond\")\n\n    }\n\n)\n\ntype WINEVENTPROC func(hWinEventHook HWINEVENTHOOK, event uint32, hwnd HWND, idObject int32, idChild int32, idEventThread uint32, dwmsEventTime uint32) uintptr\n\ntype (\n    HANDLE          uintptr\n    HINSTANCE       HANDLE\n    HHOOK       HANDLE\n    HMODULE     HANDLE\n    HWINEVENTHOOK HANDLE\n    DWORD           uint32\n    INT           int\n    WPARAM           uintptr\n    LPARAM uintptr\n    LRESULT uintptr\n    HWND HANDLE\n    UINT uint32\n    BOOL int32\n    ULONG_PTR uintptr\n    LONG                  int32\n    LPWSTR                *WCHAR\n    WCHAR                 uint16\n)\n\ntype POINT struct {\n    X, Y int32\n}\n\ntype MSG struct {\n    Hwnd    HWND\n    Message uint32\n    WParam  uintptr\n    LParam  uintptr\n    Time    uint32\n    Pt      POINT\n}\n\n\nconst (\n    //~ EVENT_SYSTEM_FOREGROUND DWORD = 0x0003\n    //~ WINEVENT_OUTOFCONTEXT  DWORD = 0x0000\n    //~ WINEVENT_INCONTEXT   = 0x0004\n    EVENT_SYSTEM_FOREGROUND  = 3\n    WINEVENT_OUTOFCONTEXT   = 0\n    WINEVENT_INCONTEXT   = 4\n    WINEVENT_SKIPOWNPROCESS   = 2\n    WINEVENT_SKIPOWNTHREAD   = 1\n)\n\nfunc main() {\n\n    log.Println(\"starting\")\n    hinst := GetModuleHandle(\"\")\n    fmt.Println(hinst)\n\n    winEvHook := SetWinEventHook(EVENT_SYSTEM_FOREGROUND, EVENT_SYSTEM_FOREGROUND, 0 , ActiveWinEventHook, 0, 0, WINEVENT_OUTOFCONTEXT|WINEVENT_SKIPOWNPROCESS )\n    log.Println(\"Windows Event Hook: \")\n    log.Println(\"Windows Event Hook: \", winEvHook)\n\n    for {\n\n        var msg MSG\n        if m := GetMessage(&amp;msg, 0, 0, 0); m != 0 {\n            TranslateMessage(&amp;msg)\n            DispatchMessage(&amp;msg)\n       }\n    }\n    UnhookWinEvent(winEvHook)\n    return\n\n}\n\n\nfunc SetWinEventHook(eventMin DWORD, eventMax DWORD, hmodWinEventProc HMODULE, pfnWinEventProc WINEVENTPROC, idProcess DWORD, idThread DWORD, dwFlags DWORD) HWINEVENTHOOK {\n    log.Println(\"procSetWinEventHook S\")\n    pfnWinEventProcCallback := syscall.NewCallback(pfnWinEventProc)\n    ret, ret2 , err := procSetWinEventHook.Call(\n        uintptr(eventMin),\n        uintptr(eventMax),\n        uintptr(hmodWinEventProc),\n        pfnWinEventProcCallback,\n        uintptr(idProcess),\n        uintptr(idThread),\n        uintptr(dwFlags),\n    )\n\n    log.Printf(\"%#v\", err)\n    log.Printf(\"%#v\", ret)\n    log.Printf(\"%#v\", ret2)\n    log.Println(\"procSetWinEventHook E\")\n    return HWINEVENTHOOK(ret)\n}\n\nfunc UnhookWinEvent(hWinEventHook HWINEVENTHOOK) bool {\n    ret, _, _ := procUnhookWinEvent.Call(\n        uintptr(hWinEventHook),\n    )\n    return ret != 0\n}\n\nfunc GetModuleHandle(modulename string) HINSTANCE {\n    var mn uintptr\n    if modulename == \"\" {\n        mn = 0\n    } else {\n        mn = uintptr(unsafe.Pointer(syscall.StringToUTF16Ptr(modulename)))\n    }\n    ret, _, _ := procGetModuleHandle.Call(mn)\n    return HINSTANCE(ret)\n}\n\nfunc GetMessage(msg *MSG, hwnd HWND, msgFilterMin UINT, msgFilterMax UINT) int {\n    ret, _, _ := procGetMessage.Call(\n        uintptr(unsafe.Pointer(msg)),\n        uintptr(hwnd),\n        uintptr(msgFilterMin),\n        uintptr(msgFilterMax))\n\n    return int(ret)\n}\n\nfunc TranslateMessage(msg *MSG) bool {\n    ret, _, _ := procTranslateMessage.Call(\n        uintptr(unsafe.Pointer(msg)))\n    return ret != 0\n}\n\nfunc DispatchMessage(msg *MSG) uintptr {\n    ret, _, _ := procDispatchMessage.Call(\n        uintptr(unsafe.Pointer(msg)))\n    return ret\n}\n</code></pre>\n"}], "owner": {"reputation": 5609, "user_id": 1226748, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/RfDKy.jpg?s=128&g=1", "display_name": "Jimmy Obonyo Abor", "link": "https://stackoverflow.com/users/1226748/jimmy-obonyo-abor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1478, "favorite_count": 2, "accepted_answer_id": 41560947, "answer_count": 1, "score": 2, "last_activity_date": 1484021060, "creation_date": 1484006305, "last_edit_date": 1484020412, "question_id": 41559026, "link": "https://stackoverflow.com/questions/41559026/go-lang-set-windows-events-hooks", "title": "Go lang set windows events hooks", "body": "<p>Hi am trying to set a global event hook in go but i dont get the event handle or any error message , kindly help , below is code , from my code below i expected to get error message from <code>SetWinEventHook</code> if any but it just blocks at <code>Logger.Println(\"procSetWinEventHook S\")</code> please not that i have not included my custo <code>Logger</code> but thats not a blocker.</p>\n\n<pre><code>  package main\n\nimport(\n    \"fmt\"\n    \"syscall\"\n    \"unsafe\"\n    \"log\"\n    \"golang.org/x/sys/windows\"\n)\n\nvar(\n    user32 = windows.NewLazyDLL(\"user32.dll\")\n    modkernel32 = windows.NewLazyDLL(\"kernel32.dll\")\n\n    procSetWinEventHook     = user32.NewProc(\"SetWinEventHook\")\n    procUnhookWinEvent      = user32.NewProc(\"UnhookWinEvent\")\n    procGetMessage = user32.NewProc(\"GetMessageW\")\n    procTranslateMessage = user32.NewProc(\"TranslateMessage\")\n    procDispatchMessage = user32.NewProc(\"DispatchMessageW\")\n\n    procGetModuleHandle            = modkernel32.NewProc(\"GetModuleHandleW\")\n\n    ActiveWinEventHook WINEVENTPROC = func (hWinEventHook HWINEVENTHOOK, event uint32, hwnd HWND, idObject int32, idChild int32, idEventThread uint32, dwmsEventTime uint32)  {\n        log.Println(\"fond\")\n\n    }\n\n)\n\ntype WINEVENTPROC func(hWinEventHook HWINEVENTHOOK, event uint32, hwnd HWND, idObject int32, idChild int32, idEventThread uint32, dwmsEventTime uint32) uintptr\n\ntype (\n    HANDLE          uintptr\n    HINSTANCE       HANDLE\n    HHOOK       HANDLE\n    HMODULE     HANDLE\n    HWINEVENTHOOK HANDLE\n    DWORD           uint32\n    INT           int\n    WPARAM           uintptr\n    LPARAM uintptr\n    LRESULT uintptr\n    HWND HANDLE\n    UINT uint32\n    BOOL int32\n    ULONG_PTR uintptr\n    LONG                  int32\n    LPWSTR                *WCHAR\n    WCHAR                 uint16\n)\n\ntype POINT struct {\n    X, Y int32\n}\n\ntype MSG struct {\n    Hwnd    HWND\n    Message uint32\n    WParam  uintptr\n    LParam  uintptr\n    Time    uint32\n    Pt      POINT\n}\n\n\nconst (\n    //~ EVENT_SYSTEM_FOREGROUND DWORD = 0x0003\n    //~ WINEVENT_OUTOFCONTEXT  DWORD = 0x0000\n    //~ WINEVENT_INCONTEXT   = 0x0004\n    EVENT_SYSTEM_FOREGROUND  = 3\n    WINEVENT_OUTOFCONTEXT   = 0\n    WINEVENT_INCONTEXT   = 4\n    WINEVENT_SKIPOWNPROCESS   = 2\n    WINEVENT_SKIPOWNTHREAD   = 1\n)\n\nfunc main() {\n\n    log.Println(\"starting\")\n    hinst := GetModuleHandle(\"\")\n    fmt.Println(hinst)\n\n    winEvHook := SetWinEventHook(EVENT_SYSTEM_FOREGROUND, EVENT_SYSTEM_FOREGROUND, 0 , ActiveWinEventHook, 0, 0, WINEVENT_OUTOFCONTEXT|WINEVENT_SKIPOWNPROCESS )\n    log.Println(\"Windows Event Hook: \")\n    log.Println(\"Windows Event Hook: \", winEvHook)\n\n    for {\n\n        var msg MSG\n        if m := GetMessage(&amp;msg, 0, 0, 0); m != 0 {\n            TranslateMessage(&amp;msg)\n            DispatchMessage(&amp;msg)\n       }\n    }\n    UnhookWinEvent(winEvHook)\n    return\n\n}\n\n\nfunc SetWinEventHook(eventMin DWORD, eventMax DWORD, hmodWinEventProc HMODULE, pfnWinEventProc WINEVENTPROC, idProcess DWORD, idThread DWORD, dwFlags DWORD) HWINEVENTHOOK {\n    log.Println(\"procSetWinEventHook S\")\n    ret, ret2 , err := procSetWinEventHook.Call(\n        uintptr(eventMin),\n        uintptr(eventMax),\n        uintptr(hmodWinEventProc),\n        pfnWinEventProcCallback,\n        uintptr(idProcess),\n        uintptr(idThread),\n        uintptr(dwFlags),\n    )\n\n    log.Printf(\"%#v\", err)\n    log.Printf(\"%#v\", ret)\n    log.Printf(\"%#v\", ret2)\n    log.Println(\"procSetWinEventHook E\")\n    return HWINEVENTHOOK(ret)\n}\n\nfunc UnhookWinEvent(hWinEventHook HWINEVENTHOOK) bool {\n    ret, _, _ := procUnhookWinEvent.Call(\n        uintptr(hWinEventHook),\n    )\n    return ret != 0\n}\n\nfunc GetModuleHandle(modulename string) HINSTANCE {\n    var mn uintptr\n    if modulename == \"\" {\n        mn = 0\n    } else {\n        mn = uintptr(unsafe.Pointer(syscall.StringToUTF16Ptr(modulename)))\n    }\n    ret, _, _ := procGetModuleHandle.Call(mn)\n    return HINSTANCE(ret)\n}\n\nfunc GetMessage(msg *MSG, hwnd HWND, msgFilterMin UINT, msgFilterMax UINT) int {\n    ret, _, _ := procGetMessage.Call(\n        uintptr(unsafe.Pointer(msg)),\n        uintptr(hwnd),\n        uintptr(msgFilterMin),\n        uintptr(msgFilterMax))\n\n    return int(ret)\n}\n\nfunc TranslateMessage(msg *MSG) bool {\n    ret, _, _ := procTranslateMessage.Call(\n        uintptr(unsafe.Pointer(msg)))\n    return ret != 0\n}\n\nfunc DispatchMessage(msg *MSG) uintptr {\n    ret, _, _ := procDispatchMessage.Call(\n        uintptr(unsafe.Pointer(msg)))\n    return ret\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483996099, "post_id": 41556903, "comment_id": 70319272, "body": "How many things do you have to repeat?  If you don&#39;t have too many types making multiple structs is probably easier."}, {"owner": {"reputation": 43, "user_id": 5306254, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Yxde8XVfdo/AAAAAAAAAAI/AAAAAAAAAHg/xUhv1vDyd-A/photo.jpg?sz=128", "display_name": "multiversed", "link": "https://stackoverflow.com/users/5306254/multiversed"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483996507, "post_id": 41556903, "comment_id": 70319468, "body": "It&#39;s way too much. I&#39;ve considered it, but can&#39;t fathom the tediousness of that (and maintenance nightmare). Hence, I need help from people smarter than I am."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483997963, "post_id": 41556903, "comment_id": 70320216, "body": "Computers are good at tedious things -- I would probably generate the code for the translated types. I unfortunately can&#39;t think of a clean, generic solution off the top of my head."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1484011226, "last_edit_date": 1484011226, "creation_date": 1483999271, "answer_id": 41557705, "question_id": 41556903, "link": "https://stackoverflow.com/questions/41556903/go-decoding-json-with-one-set-of-json-tags-and-encoding-to-a-different-set-of/41557705#41557705", "title": "Go: decoding json with one set of json tags, and encoding to a different set of json tags", "body": "<p>If it's acceptable to take another round trip through <code>json.Unmarshal</code> and <code>json.Marshal</code>, and you don't have any ambiguous field names within your various types, you could translate all the json keys in one pass by unmarshaling into the generic structures used by the <code>json</code> package:</p>\n\n<pre><code>// map incoming to outgoing json identifiers\nvar translation = map[string]string{\n    \"accountStartDate\": \"openDate\",\n    \"cancelDate\":       \"closeDate\",\n}\n\nfunc translateJS(js []byte) ([]byte, error) {\n    var m map[string]interface{}\n    if err := json.Unmarshal(js, &amp;m); err != nil {\n        return nil, err\n    }\n\n    translateKeys(m)\n    return json.MarshalIndent(m, \"\", \"  \")\n}\n\nfunc translateKeys(m map[string]interface{}) {\n    for _, v := range m {\n        if v, ok := v.(map[string]interface{}); ok {\n            translateKeys(v)\n        }\n    }\n\n    keys := make([]string, 0, len(m))\n    for k := range m {\n        keys = append(keys, k)\n    }\n\n    for _, k := range keys {\n        if newKey, ok := translation[k]; ok {\n            m[newKey] = m[k]\n            delete(m, k)\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/nXmWlj7qH9\" rel=\"nofollow noreferrer\">https://play.golang.org/p/nXmWlj7qH9</a></p>\n"}, {"tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": false, "score": 3, "last_activity_date": 1484001113, "creation_date": 1484001113, "answer_id": 41558076, "question_id": 41556903, "link": "https://stackoverflow.com/questions/41556903/go-decoding-json-with-one-set-of-json-tags-and-encoding-to-a-different-set-of/41558076#41558076", "title": "Go: decoding json with one set of json tags, and encoding to a different set of json tags", "body": "<p>A bit an uncommon but probably quite well working method would be to use a intermediate format so u can use different readers and writers and therefore different tags. For example <a href=\"https://github.com/mitchellh/mapstructure\" rel=\"nofollow noreferrer\">https://github.com/mitchellh/mapstructure</a> which allows to convert a nested map structure into struct \ntypes. Pretty similar like json unmarshal, just from a map.</p>\n\n<pre><code>// incoming \"schema\" field names\ntype AccountIn struct {\n    OpenDate string `mapstructure:\"accountStartDate\" json:\"openDate\"`\n    CloseDate string `mapstructure:\"cancelDate\" json:\"closeDate\"`\n}\n\n// from json to map with no name changes\ntemporaryMap := map[string]interface{}{}\nerr := json.Unmarshal(jsonBlob, &amp;temporaryMap)\n\n// from map to structs using mapstructure tags\naccountIn := &amp;AccountIn{}\nmapstructure.Decode(temporaryMap, accountIn)\n</code></pre>\n\n<p>Later when writing (or reading) u will use directly the json functions which will then use the json tags.</p>\n"}, {"comments": [{"owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "edited": false, "score": 1, "creation_date": 1484024647, "post_id": 41560898, "comment_id": 70327560, "body": "The language specification change is described here <a href=\"https://tip.golang.org/doc/go1.8#language\" rel=\"nofollow noreferrer\">tip.golang.org/doc/go1.8#language</a>"}], "tags": [], "owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "is_accepted": true, "score": 2, "last_activity_date": 1484020771, "creation_date": 1484020771, "answer_id": 41560898, "question_id": 41556903, "link": "https://stackoverflow.com/questions/41556903/go-decoding-json-with-one-set-of-json-tags-and-encoding-to-a-different-set-of/41560898#41560898", "title": "Go: decoding json with one set of json tags, and encoding to a different set of json tags", "body": "<p>Maybe the coming change on Go 1.8 would help you, it will allow to 'cast' types even if its JSON tags definition is different: This <a href=\"https://play.golang.org/p/Xbsoa8SsEk\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Xbsoa8SsEk</a> works as expected on 1.8beta, I guess this would simplify your current solution</p>\n"}, {"tags": [], "owner": {"reputation": 709, "user_id": 3494590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4f84aa8fd828d0d8d5306bd577f2d94f?s=128&d=identicon&r=PG&f=1", "display_name": "Dhumil Agarwal", "link": "https://stackoverflow.com/users/3494590/dhumil-agarwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1484044486, "last_edit_date": 1484044486, "creation_date": 1484022914, "answer_id": 41561204, "question_id": 41556903, "link": "https://stackoverflow.com/questions/41556903/go-decoding-json-with-one-set-of-json-tags-and-encoding-to-a-different-set-of/41561204#41561204", "title": "Go: decoding json with one set of json tags, and encoding to a different set of json tags", "body": "<p>This might be a Naive Approach but is fairly easy to implement:- </p>\n\n<pre><code>func ConvertAccountInToAccountOut(AccountIn incoming) (AccountOut outcoming){\n    var outcoming AccountOut\n    outcoming.OpenDate = incoming.OpenDate\n    outcoming.CloseDate = incoming.CloseDate\n\n    return outcoming\n}\n\nvar IncomingJSONData AccountIn\nresp := getJSONDataFromSource()  // Some method that gives you the Input JSON\nerr1 := json.UnMarshall(resp,&amp;IncomingJSONData)\nOutGoingJSONData := ConvertAccountInToAccountOut(IncomingJSONData)\n\nif err1 != nil {\n    fmt.Println(\"Error in UnMarshalling JSON \",err1)\n}\n\nfmt.Println(\"Outgoing JSON Data: \",OutGoingJSONData)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5306254, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Yxde8XVfdo/AAAAAAAAAAI/AAAAAAAAAHg/xUhv1vDyd-A/photo.jpg?sz=128", "display_name": "multiversed", "link": "https://stackoverflow.com/users/5306254/multiversed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1085, "favorite_count": 0, "accepted_answer_id": 41560898, "answer_count": 4, "score": 0, "last_activity_date": 1484044486, "creation_date": 1483995880, "question_id": 41556903, "link": "https://stackoverflow.com/questions/41556903/go-decoding-json-with-one-set-of-json-tags-and-encoding-to-a-different-set-of", "title": "Go: decoding json with one set of json tags, and encoding to a different set of json tags", "body": "<p>I have an application that consumes data from a third-party api. I need to decode the json into a struct, which requires the struct to have json tags of the \"incoming\" json fields. The outgoing json fields have a different naming convention, so I need different json tags for the encoding. </p>\n\n<p>I will have to do this with many different structs, and each struct might have many fields. </p>\n\n<p><strong>What is the best way to accomplish this without repeating a lot of code?</strong></p>\n\n<p>Example Structs:</p>\n\n<pre><code>// incoming \"schema\" field names\ntype AccountIn struct {\n    OpenDate string `json:\"accountStartDate\"`\n    CloseDate string `json:\"cancelDate\"`\n}\n\n\n// outgoing \"schema\" field names\ntype AccountOut struct {\n    OpenDate string `json:\"openDate\"`\n    CloseDate string `json:\"closeDate\"`\n} \n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1483996300, "post_id": 41556858, "comment_id": 70319372, "body": "If you don&#39;t want to hard-code your path prefix, then it must be configurable. You can use either way you want, like an environment variable, a configuration file, a user input, whatever suits your use-case."}], "answers": [{"tags": [], "owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "is_accepted": false, "score": 0, "last_activity_date": 1484043760, "last_edit_date": 1484043760, "creation_date": 1483996390, "answer_id": 41557038, "question_id": 41556858, "link": "https://stackoverflow.com/questions/41556858/golang-path-to-image-and-uploading-getting-mixed-results/41557038#41557038", "title": "Golang path to image and uploading getting mixed results", "body": "<p>The \"os/user\" package allows you to determine the directory of the current user like so:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os/user\"\n)\n\nfunc main() {\n    usr, err := user.Current()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(usr.HomeDir)\n}\n</code></pre>\n"}], "owner": {"reputation": 1195, "user_id": 1949387, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/07aecc3a985b916b35133da1d5b5634c?s=128&d=identicon&r=PG", "display_name": "user1949387", "link": "https://stackoverflow.com/users/1949387/user1949387"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 496, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484050185, "creation_date": 1483995675, "last_edit_date": 1484050185, "question_id": 41556858, "link": "https://stackoverflow.com/questions/41556858/golang-path-to-image-and-uploading-getting-mixed-results", "title": "Golang path to image and uploading getting mixed results", "body": "<p>I have successfully been able to upload images to my ImageStore account however I have had to hardcode each file path . My issue is that my images reside outside of my GoPath are there any way that I can get the actual directory to my images without hardcoding it ? For instance</p>\n\n<p><strong>GoPath</strong> = \"/Users/IH/Documents/go\"</p>\n\n<p><strong>Actual Image Path</strong> = \"/Users/IH/Documents/pictures/horse_PNG2538.png\"</p>\n\n<p><strong>Path I'm getting</strong> = \"/Users/IH/Documents/go/src\"</p>\n\n<p>I need to get the correct path of an image because user's will be able to Upload their images and obviously they are all going to have different paths to their images . This is the code I have </p>\n\n<pre><code>myfile, handler, err := r.FormFile(\"uploadImage\")\nif err != nil {\n    fmt.Println(err)\n\n    return\n}\ndefer myfile.Close()\n\n\npwd, err := os.Getwd()\nif err != nil {\n    fmt.Println(err)\n    os.Exit(1)\n}\nfmt.Println(pwd)\n\nfile,err := os.Open(pwd + handler.Filename)\n\ndefer file.Close()\nif err != nil {\n    fmt.Printf(\"err opening file: %s\", err)\n}\n</code></pre>\n\n<p>The pwd gives me the path <strong>/Users/IH/Documents/go/src</strong> which offcourse gives me an error because the image is not found there . If I for instance hard code the correct image address then it uploads such as </p>\n\n<pre><code>file,err := os.Open(\"/Users/IH/Documents/pictures/horse_PNG2538.png\")\n</code></pre>\n\n<p>then the image gets uploaded . Again this image is coming from this directory <strong>/Users/IH/Documents/pictures/</strong> how can I spot that directory on image upload without hardcoding it ? any suggestions would be great</p>\n"}, {"tags": ["go", "sqlite"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1483995505, "post_id": 41556675, "comment_id": 70318972, "body": "Executing all of the <code>INSERT</code>s inside of a transaction will significantly reduce the processing time."}, {"owner": {"reputation": 33, "user_id": 7068692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c245502887c50cd18a9fb5908371d5e?s=128&d=identicon&r=PG&f=1", "display_name": "plosxh", "link": "https://stackoverflow.com/users/7068692/plosxh"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1483996015, "post_id": 41556675, "comment_id": 70319232, "body": "that&#39;s the only way I know to insert data in my database, i&#39;ve done some research to find if there is a ay to do like a bulk update in sqlite3, but it seems like there is none...  Feel free to give me some keys to find out how to optimize it and reduce the cost of all those inserts if you have the knowledge.  I&#39;m fairly new to programmation and I know that doing inserts in a loop is costly but this is the only way I know..."}], "owner": {"reputation": 33, "user_id": 7068692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c245502887c50cd18a9fb5908371d5e?s=128&d=identicon&r=PG&f=1", "display_name": "plosxh", "link": "https://stackoverflow.com/users/7068692/plosxh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 630, "favorite_count": 0, "closed_date": 1483997193, "answer_count": 0, "score": 0, "last_activity_date": 1483995330, "creation_date": 1483994917, "last_edit_date": 1483995330, "question_id": 41556675, "link": "https://stackoverflow.com/questions/41556675/golang-sqlite3-insert-or-update-multiple-line", "closed_reason": "Duplicate", "title": "Golang Sqlite3 Insert or Update multiple line", "body": "<p>I'm trying to load about 20k items in a sqlite3 database using a little Golang program.</p>\n\n<p>But, it takes a lot of time... Like 45mins...</p>\n\n<p>I've try doing :</p>\n\n<pre><code>_,errExec:=db.Exec(\"Insert into ...\")\n</code></pre>\n\n<p>Is there any solution the reduce the update or insert (of about 20k items) in under 5mins ? and if yes, how can I do ?</p>\n\n<p>Thank you for your answer.</p>\n\n<p>EDIT : The full function :</p>\n\n<pre><code>func updateDB(){\n\nfile, err := ioutil.ReadFile(\"./database/id.json\")\n  if err != nil {\n    fmt.Printf(\"File error: %v\\n\", err)\n    os.Exit(1)\n}\n\nvar ids []int\njson.Unmarshal(file, &amp;ids)\n\ndb, err := sql.Open(\"sqlite3\",\"./database/gwitem.db\")\nif err != nil {\n  log.Fatal(err.Error())\n}\n\ndefer db.Close()\n\nvar prix price\nfor i :=0; i &lt; len(ids); i++{\n    //getJson(\"https://api.guildwars2.com/v2/commerce/prices/\"+strconv.Itoa(ids[i]),&amp;prix)\n    url := \"https://api.guildwars2.com/v2/commerce/prices/\"+strconv.Itoa(ids[i])\n    getJson(url,&amp;prix)\n\n    _,errExec:=db.Exec(\"Insert into trade values(null,\"+strconv.FormatInt(prix.Id,10)+\",\"+strconv.FormatInt(prix.Buys.Quantity,10)+\",\"+strconv.FormatInt(prix.Buys.Unit_price,10)+\",\"+strconv.FormatInt(prix.Sells.Quantity,10)+\",\"+strconv.FormatInt(prix.Sells.Unit_price,10)+\",0)\")\n    if errExec != nil{\n      fmt.Println(err.Error())\n      log.Fatal(err)\n    }\n }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1484067880, "post_id": 41556320, "comment_id": 70353384, "body": "<code>rows.Next()</code> advances the result set index, if it can.  It then returns true if it succeeded, and false if it failed to (ie. there&#39;s no more data).  There&#39;s no way of checking if there&#39;s more data without advancing that index, so your first call to <code>rows.Next()</code> advances that index in addition to checking if there&#39;s data.  If you only got one row back, your conditional will be false (there was data), but your loop won&#39;t occur (there&#39;s no more data after the first row, which the conditional advanced past in its check)."}], "answers": [{"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": true, "score": 0, "last_activity_date": 1484002142, "creation_date": 1484002142, "answer_id": 41558292, "question_id": 41556320, "link": "https://stackoverflow.com/questions/41556320/golang-sqldatabase-rows-next/41558292#41558292", "title": "Golang sqldatabase rows.Next", "body": "<p>You probably want something like this:</p>\n\n<pre><code>rows, err := db.Query(query)\nif err != nil {\n    Error.Printf(\"error querying: %v\", err)\n}\nshouldinsert := true\nfor rows.Next() {\n    shouldinsert = false\n    fmt.Println(\"-----\")\n    // do update\n}\nif shouldinsert {\n    // insert new data\n}\n</code></pre>\n"}], "owner": {"reputation": 25076, "user_id": 207524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7204a1f9d3a10e3b044e2e8ca58c877?s=128&d=identicon&r=PG", "display_name": "Crystal", "link": "https://stackoverflow.com/users/207524/crystal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2000, "favorite_count": 0, "accepted_answer_id": 41558292, "answer_count": 1, "score": 0, "last_activity_date": 1602923890, "creation_date": 1483993484, "last_edit_date": 1602923890, "question_id": 41556320, "link": "https://stackoverflow.com/questions/41556320/golang-sqldatabase-rows-next", "title": "Golang sqldatabase rows.Next", "body": "<p>Does rows.Next go to the end of the list and not let you go back to the beginning?  I want to run a query that checks if there is data for a specific object in a database.  If there is that object, I want to update it.  If it's not there, i want to insert a new row.</p>\n<p>So I do this:</p>\n<pre><code>    rows, err := db.Query(query)\n    if err != nil {\n        Error.Printf(&quot;error querying: %v&quot;, err)\n    }\n\n    if !rows.Next() {\n        // insert new data\n    }\n</code></pre>\n<p>that works on it's own like I expect.  But if I do this instead and at more logic to the end of the snippet:</p>\n<pre><code>    rows, err := db.Query(query)\n    if err != nil {\n        Error.Printf(&quot;error querying: %v&quot;, err)\n    }\n\n    if !rows.Next() {\n        // insert new data\n    }\n    for rows.Next() {\n        fmt.Println(&quot;-----&quot;)\n        // do update\n    }\n</code></pre>\n<p>My for rows.Next() never gets entered.  If I move the <code>for rows.Next()</code> block above the <code>if !rows.Next()</code> block, it does work as expected.  So is there something that happens when you call Next() that you have to do to read from the query again?</p>\n"}, {"tags": ["http", "go", "ip", "webserver"], "answers": [{"tags": [], "owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "is_accepted": true, "score": 1, "last_activity_date": 1483992711, "creation_date": 1483992711, "answer_id": 41556121, "question_id": 41556060, "link": "https://stackoverflow.com/questions/41556060/how-to-get-the-localaddress-in-go/41556121#41556121", "title": "How to get the LocalAddress in GO?", "body": "<p>You are not calling the function, in your <code>local</code> variable you are storing the function itself.</p>\n\n<p>Try this:</p>\n\n<pre><code>local := conn.LocalAddr()\nremote := conn.RemoteAddr()\n</code></pre>\n"}], "owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 41556121, "answer_count": 1, "score": -1, "last_activity_date": 1483992769, "creation_date": 1483992471, "question_id": 41556060, "link": "https://stackoverflow.com/questions/41556060/how-to-get-the-localaddress-in-go", "title": "How to get the LocalAddress in GO?", "body": "<p>I'm making a webserver in go that act like a proxy. I need to get the infos about the client to give its response.\nHere is my code:</p>\n\n<pre><code>func main(){\n\n    li, err := net.Listen(\"tcp\", \":8000\")\n    if err != nil{\n        log.Fatalln(err.Error())\n    }\n    defer li.Close()\n\n    for{\n\n        conn, err := li.Accept()\n        if err != nil {\n            log.Fatalln(err.Error())\n        }\n        local := conn.LocalAddr\n        remote := conn.RemoteAddr\n        fmt.Println(string(local.Network))\n        fmt.Println(string(remote.String))\n\n        go handleConn(conn)\n    }\n}\n</code></pre>\n\n<p>The problem is when i run i receive this message:</p>\n\n<pre><code>local.Network undefined (type func() net.Addr has no field or method Network)\n</code></pre>\n\n<p>but the documentation says the Addr type has this methods</p>\n\n<p><a href=\"https://golang.org/pkg/net/#Conn\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/#Conn</a></p>\n\n<p><a href=\"https://golang.org/pkg/net/#Addr\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/#Addr</a></p>\n"}, {"tags": ["http", "go", "request", "webserver", "response"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1483986229, "post_id": 41554423, "comment_id": 70314104, "body": "The response body is an <a href=\"https://godoc.org/io#ReadCloser\" rel=\"nofollow noreferrer\">io.ReadCloser</a>. Show the code that you use to <a href=\"https://godoc.org/io#Reader.Read\" rel=\"nofollow noreferrer\">read</a> the body."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483986299, "post_id": 41554423, "comment_id": 70314129, "body": "You haven&#39;t tried to read the body, you&#39;ve just printed the Response.Body structure."}, {"owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "edited": false, "score": 0, "creation_date": 1483986423, "post_id": 41554423, "comment_id": 70314196, "body": "Yes, I thought the body content was in the Response.Body structure. So how do I get the body?"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483987144, "post_id": 41554483, "comment_id": 70314569, "body": "you can <i>use</i> <code>ioutil</code> to read an <code>io.Reader</code>, but you don&#39;t <i>need</i> it."}, {"owner": {"reputation": 303, "user_id": 204204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5474ac01095dc18e731eddf9a17b204a?s=128&d=identicon&r=PG", "display_name": "selden", "link": "https://stackoverflow.com/users/204204/selden"}, "edited": false, "score": 0, "creation_date": 1599156371, "post_id": 41554483, "comment_id": 112694405, "body": "Read can block though."}], "tags": [], "owner": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "is_accepted": true, "score": 8, "last_activity_date": 1503307561, "last_edit_date": 1503307561, "creation_date": 1483986353, "answer_id": 41554483, "question_id": 41554423, "link": "https://stackoverflow.com/questions/41554423/how-to-get-the-body-response-in-a-request/41554483#41554483", "title": "How to get the body response in a request", "body": "<p>From the documentation <a href=\"https://golang.org/pkg/net/http/\" rel=\"noreferrer\">https://golang.org/pkg/net/http/</a> to read the body response you can use the package ioutil </p>\n\n<p>Like :</p>\n\n<pre><code> resp, err := http.Get(\"http://example.com/\")\n    if err != nil {\n        // handle error\n    }\n    defer resp.Body.Close()\n    body, err := ioutil.ReadAll(resp.Body)\n</code></pre>\n"}], "owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9671, "favorite_count": 0, "accepted_answer_id": 41554483, "answer_count": 1, "score": 2, "last_activity_date": 1595517052, "creation_date": 1483986153, "last_edit_date": 1595517052, "question_id": 41554423, "link": "https://stackoverflow.com/questions/41554423/how-to-get-the-body-response-in-a-request", "title": "How to get the body response in a request", "body": "<p>I'm trying to make a webserver that will work like a proxy. My server make requests (POST, GET ...) for the client to an specific site, receive the response from this site and give it to the client. As i said, like a proxy. The problem is: in the response from google.com for example (or any other site) i can't read the body. The status code is 200 but when i tried to read the body content i receive weird things. </p>\n\n<p>This is the part of my code that i make the request    </p>\n\n<pre><code>request, err := http.NewRequest(method, url, nil)\nfor k, v := range m {\n    request.Header.Set(k, v)\n}\nif err != nil {\n    log.Fatalln(err.Error())\n}\n\nclient := http.Client{}\nresp, err := client.Do(request)\n\nif err != nil {\n    log.Fatalln(err.Error())\n}else{\n\nfmt.Println(\"=======================\")\nfmt.Println(resp)\nfmt.Println(\"=======================\")\nfmt.Println(resp.Body)\n</code></pre>\n\n<p>And i receive this:</p>\n\n<pre><code>=======================\n&amp;{200 OK 200 HTTP/1.1 1 1 map[Date:[Mon, 09 Jan 2017 18:07:49 GMT]\nCache-Control:[private, max-age=0] Content-Type:[text/html; \ncharset=ISO-8859-1] P3p:[CP=\"This is not a P3P policy! See \nhttps://www.google.com/support/accounts/answer/151657?hl=en for more \ninfo.\"] Server:[gws] X-Xss-Protection:[1; mode=block] Expires:[-1] X-\nFrame-Options:[SAMEORIGIN] Set-Cookie:[NID=94=i5qZWuqYtrLAkc-amGHbmDnqx3Wg8mGx0kuk6s-\ngKWYMSNXbScl0Cb5GldDzGdfrIrJvHC3151JzHB2s3XLdmFN82-\n_gSxu07xwPNbVlzKiZgE9dJf7vXeXSaYQhWowv; expires=Tue, 11-Jul-2017 \n18:07:49 GMT; path=/; domain=.google.com.br; HttpOnly]] 0xc4200cac20 \n-1 [] false true map[] 0xc420126000 &lt;nil&gt;}\n=======================\n&amp;{0xc420014700 &lt;nil&gt; &lt;nil&gt;}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1483987226, "post_id": 41551456, "comment_id": 70314604, "body": "That said, probably not a good idea to use <code>MustCompile</code> here.  It panics if the regex doesn&#39;t compile.  Should probably either return an error, or simply false, if that&#39;s the case.  &quot;Must&quot; type methods are best used for globals (which are run when the program starts, and panics at program launch are fine.  It&#39;s the ones during operation that suck) or for tests."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1483987457, "post_id": 41551456, "comment_id": 70314726, "body": "Also agree with JimB here.  There&#39;s not much difference between calling <code>IsMatchingRegex(s, r)</code> and <code>regexp.MustCompile(r).MatchString(s)</code>.  No need to be a function.  That change would also let you define the date regex as a global, instead of it being an input string, which avoids accidental mistypes or copy-paste errors."}, {"owner": {"reputation": 51, "user_id": 4955223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e7771f948780e193bf9ce77c77c54264?s=128&d=identicon&r=PG&f=1", "display_name": "NuLLByt3", "link": "https://stackoverflow.com/users/4955223/nullbyt3"}, "edited": false, "score": 0, "creation_date": 1483992798, "post_id": 41551456, "comment_id": 70317494, "body": "I see your point, thank you. Reason we are using a function here for usability. we have multiple regex validations in model."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1483976810, "last_edit_date": 1483976810, "creation_date": 1483976098, "answer_id": 41551456, "question_id": 41551361, "link": "https://stackoverflow.com/questions/41551361/boolean-functions-in-go/41551456#41551456", "title": "Boolean functions in Go", "body": "<p>Your test isn't failing, it can't compile because <code>validFormat</code> is a <code>Regexp</code> not a <code>bool</code>. </p>\n\n<p>Your bool is <code>matched</code>, but you could simply return the result of <code>MatchString</code> (or not use a separate function at all since it's a single line)</p>\n\n<pre><code>func IsMatchingRegex(s string, regex string) bool {\n    return regexp.MustCompile(regex).MatchString(s)\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4955223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e7771f948780e193bf9ce77c77c54264?s=128&d=identicon&r=PG&f=1", "display_name": "NuLLByt3", "link": "https://stackoverflow.com/users/4955223/nullbyt3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2975, "favorite_count": 0, "accepted_answer_id": 41551456, "answer_count": 1, "score": 1, "last_activity_date": 1483976810, "creation_date": 1483975814, "question_id": 41551361, "link": "https://stackoverflow.com/questions/41551361/boolean-functions-in-go", "title": "Boolean functions in Go", "body": "<p>Please help, I'm new with Go. I wrote function passing a string a regex and return boolan. my test keeps failing when validating correct format of  Date of birth. </p>\n\n<p>My test: </p>\n\n<pre><code>func TestIsMatchingRegex(t *testing.T) {\nt.Parallel()\nvar tests = []struct {\n        dob      string\n        reg      string\n        expected bool\n        desc     string\n    }{\n        {dob: \"1928-06-05\", reg: `[12][0-9]{3}-[01][0-9]-[0-3][0-9]`, expected: true, desc: \"test1\"},\n        {dob: \"1928/06/05\", reg: `[12][0-9]{3}-[01][0-9]-[0-3][0-9]`, expected: false, desc: \"test2\"},\n    }\n    for _, test := range tests {\n        actual := IsMatchingRegex(test.dob, test.reg)\n        assert.Equal(t, actual, test.expected, test.desc)\n    }\n\n}\n</code></pre>\n\n<p>Matching function boolean </p>\n\n<pre><code>func IsMatchingRegex(s string, regex string) bool {\nvalidFormat := regexp.MustCompile(regex)\nmatched := validFormat.MatchString(s)\nif validFormat {\n    return false\n}\n\nreturn true\n}\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1483969545, "post_id": 41549429, "comment_id": 70303795, "body": "Prepend the pattern with <code>(?s)</code>: <code>`(?s)^.*token`</code>"}, {"owner": {"reputation": 895, "user_id": 2267906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d6cc33808d8a17c988b597dc7a19ef8f?s=128&d=identicon&r=PG", "display_name": "Nico", "link": "https://stackoverflow.com/users/2267906/nico"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1483970047, "post_id": 41549429, "comment_id": 70304126, "body": "That&#39;s it. Thanks!"}], "owner": {"reputation": 895, "user_id": 2267906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d6cc33808d8a17c988b597dc7a19ef8f?s=128&d=identicon&r=PG", "display_name": "Nico", "link": "https://stackoverflow.com/users/2267906/nico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "closed_date": 1483969697, "answer_count": 0, "score": 0, "last_activity_date": 1483969402, "creation_date": 1483969402, "last_edit_date": 1592644375, "question_id": 41549429, "link": "https://stackoverflow.com/questions/41549429/golang-regexp-not-greedy-when-multiline", "closed_reason": "Duplicate", "title": "Golang regexp not greedy when multiline", "body": "<p>In the following code <a href=\"https://play.golang.org/p/jkoaYnnKRB\" rel=\"nofollow noreferrer\">playground</a>:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;regexp&quot;\n)\n\nfunc main() {\n    s := `aaa\n    token\n    token\n    bbb` \n    R := regexp.MustCompile(`.*token`)\n    m := R.FindStringSubmatch(s)\n    fmt.Println(len(m)) // 1\n    for _, v := range m {\n        fmt.Println(v) //    token\n    }\n\n    R = regexp.MustCompile(`^.*token`)\n    m = R.FindStringSubmatch(s)\n    fmt.Println(len(m)) // 0\n}\n</code></pre>\n<p>I expect the first regex to match</p>\n<pre><code>aaa\n    token\n    token\n</code></pre>\n<p>And in the second case it should be the same. However in the first case I'm only getting <code>    token</code> and int the second case nothing at all.</p>\n"}, {"tags": ["go", "panic"], "answers": [{"tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": true, "score": 5, "last_activity_date": 1592808605, "last_edit_date": 1592808605, "creation_date": 1483962124, "answer_id": 41547292, "question_id": 41547112, "link": "https://stackoverflow.com/questions/41547112/golang-panic-on-call-of-nil-objects-method/41547292#41547292", "title": "GoLang: panic on call of nil object&#39;s method", "body": "<p>I assume your question is why the resp.GetResult() call does not panic itself because it's called on a nil instance.</p>\n<p>This is how Go works. The method can be called also on types where the instance is nil. As long as the method itself does not access the instance, it will work and behavior for nil instances can be implemented.</p>\n<p>This has nothing to do with deferred functions. It can also be simulated in other contexts: <a href=\"https://play.golang.org/p/qQanhQnIcL\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qQanhQnIcL</a></p>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 1, "last_activity_date": 1483980376, "creation_date": 1483980376, "answer_id": 41552828, "question_id": 41547112, "link": "https://stackoverflow.com/questions/41547112/golang-panic-on-call-of-nil-objects-method/41552828#41552828", "title": "GoLang: panic on call of nil object&#39;s method", "body": "<p>Your <code>proto.PingResponse</code> is not just <code>nil</code> but in some manner a typed <code>nil</code>. In Go terms it is <em>zero value</em>:</p>\n\n<blockquote>\n  <p>Variables declared without an explicit initial value are given their zero value.</p>\n</blockquote>\n\n<p>It is ok to have access to a method of zero value of type and not panic if the method doesn't do nothing which could cause panic on a zero value.</p>\n"}], "owner": {"reputation": 520, "user_id": 898431, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/lpwjU.png?s=128&g=1", "display_name": "Alex.Li", "link": "https://stackoverflow.com/users/898431/alex-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 41547292, "answer_count": 2, "score": 0, "last_activity_date": 1592808605, "creation_date": 1483961603, "last_edit_date": 1483980586, "question_id": 41547112, "link": "https://stackoverflow.com/questions/41547112/golang-panic-on-call-of-nil-objects-method", "title": "GoLang: panic on call of nil object&#39;s method", "body": "<p>Deferred function:</p>\n\n<pre><code>func PrintPing(req *proto.PingRequest, resp *proto.PingResponse) {\n    fmt.Println(\"resp:\", resp)\n    fmt.Println(\"resp.GetResult():\", resp.GetResult())\n}\n</code></pre>\n\n<p>When this function is called <strong>after a panic</strong>, the <code>resp</code> and <code>resp.GetResult()</code> is nil. </p>\n\n<p>But why <code>resp.GetResult()</code> is nil too? The console output:</p>\n\n<pre><code>resp: &lt;nil&gt;\nresp.GetResult(): &lt;nil&gt;\n</code></pre>\n\n<p>Is there any official definition for this case?</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-sdk", "aws-sdk-go"], "answers": [{"comments": [{"owner": {"reputation": 3312, "user_id": 4175960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QbvYc.png?s=128&g=1", "display_name": "Eddy Hernandez", "link": "https://stackoverflow.com/users/4175960/eddy-hernandez"}, "edited": false, "score": 2, "creation_date": 1509028926, "post_id": 41549011, "comment_id": 80861929, "body": "I got <code>InvalidToken: The provided token is malformed or otherwise invalid.</code> I think we should generate the token first, is it correct? @dave-maple"}, {"owner": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "edited": false, "score": 1, "creation_date": 1580983413, "post_id": 41549011, "comment_id": 106280280, "body": "Didn&#39;t realize NewStaticCredentials third argument could be an empty string! Nor, if I indeed needed to provide a &#39;token&#39;, what that actually means in the context of that method or how to acquire a token. The docs leave <i>a lot</i> to be desired."}], "tags": [], "owner": {"reputation": 6932, "user_id": 620237, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/yzN9F.jpg?s=128&g=1", "display_name": "Dave Maple", "link": "https://stackoverflow.com/users/620237/dave-maple"}, "is_accepted": true, "score": 33, "last_activity_date": 1550883298, "last_edit_date": 1550883298, "creation_date": 1483967997, "answer_id": 41549011, "question_id": 41544554, "link": "https://stackoverflow.com/questions/41544554/how-to-run-aws-sdk-with-credentials-from-variables/41549011#41549011", "title": "How to run AWS SDK with credentials from variables?", "body": "<p>Try re-ordering your args so that ACCESS_KEY is the 1st param and SECRET_KEY is the second:</p>\n\n<pre><code>creds := credentials.NewStaticCredentials(conf.AWS_ACCESS_KEY_ID, conf.AWS_SECRET_ACCESS_KEY, \"\")\n</code></pre>\n\n<p>Try adding the region as well:</p>\n\n<pre><code>sess, err := session.NewSession(&amp;aws.Config{\n    Region:      aws.String(\"us-west-2\"),\n    Credentials: credentials.NewStaticCredentials(conf.AWS_ACCESS_KEY_ID, conf.AWS_SECRET_ACCESS_KEY, \"\"),\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 318, "user_id": 1579459, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/pnV0I.jpg?s=128&g=1", "display_name": "Xibz", "link": "https://stackoverflow.com/users/1579459/xibz"}, "is_accepted": false, "score": 2, "last_activity_date": 1484882357, "creation_date": 1484882357, "answer_id": 41755525, "question_id": 41544554, "link": "https://stackoverflow.com/questions/41544554/how-to-run-aws-sdk-with-credentials-from-variables/41755525#41755525", "title": "How to run AWS SDK with credentials from variables?", "body": "<p>Additionally, if you hadn't known, the SDK allows for the use of the shared config under <code>.aws/config</code>. You can put your values in there and then set the environment variable <code>AWS_SDK_LOAD_CONFIG</code> to a truthy value to load the shared config. An example shared config would look like this:</p>\n\n<pre><code>[default]\naws_access_key_id = AKID\naws_secret_access_key = SECRET\n</code></pre>\n\n<p>Then running:</p>\n\n<pre><code>AWS_SDK_LOAD_CONFIG=true go run main.go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 897, "user_id": 1661323, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/eb19dcd642e4d6c6ee5e08cc2b30f342?s=128&d=identicon&r=PG", "display_name": "greenif", "link": "https://stackoverflow.com/users/1661323/greenif"}, "is_accepted": false, "score": 3, "last_activity_date": 1534896660, "creation_date": 1534896660, "answer_id": 51958262, "question_id": 41544554, "link": "https://stackoverflow.com/questions/41544554/how-to-run-aws-sdk-with-credentials-from-variables/51958262#51958262", "title": "How to run AWS SDK with credentials from variables?", "body": "<p>Or you can just temporaly set Environment variables.</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"os\"\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/s3/s3manager\"\n)\n\nconst (\n    AccessKeyId     = \"XXXXXXXXXXXXXXXXXX\"\n    SecretAccessKey = \"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\"\n    Region          = \"eu-west-1\"\n    Bucket          = \"XXXXX-XXXX-XXX\"\n)\n\nfunc main() {\n    os.Setenv(\"AWS_ACCESS_KEY_ID\",     AccessKeyId)\n    os.Setenv(\"AWS_SECRET_ACCESS_KEY\", SecretAccessKey)\n\n    filename := os.Args[1]\n\n    file, err := os.Open(filename)\n    if err != nil {\n        fmt.Println(\"Failed to open file\", filename, err)\n        os.Exit(1)\n    }\n    defer file.Close()\n\n    conf := aws.Config{Region: aws.String(Region)}\n    sess := session.New(&amp;conf)\n\n    svc := s3manager.NewUploader(sess)\n\n    fmt.Println(\"Uploading file to S3...\")\n    result, err := svc.Upload(&amp;s3manager.UploadInput{\n        Bucket: aws.String(Bucket),\n        Key:    aws.String(filepath.Base(filename)),\n        Body:   file,\n    })\n    if err != nil {\n        fmt.Println(\"error\", err)\n        os.Exit(1)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 776, "user_id": 10187244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VklC4.jpg?s=128&g=1", "display_name": "Deep Nirmal", "link": "https://stackoverflow.com/users/10187244/deep-nirmal"}, "is_accepted": false, "score": 0, "last_activity_date": 1583992973, "creation_date": 1583992973, "answer_id": 60648404, "question_id": 41544554, "link": "https://stackoverflow.com/questions/41544554/how-to-run-aws-sdk-with-credentials-from-variables/60648404#60648404", "title": "How to run AWS SDK with credentials from variables?", "body": "<p>Connect your sdk client using this generic service  </p>\n\n<pre><code>var awsSession *session.Session\n\nfunc init() {\n    initializeAwsSession()\n}\n\n\nfunc initializeAwsSession() {\n    awsSession = session.Must(session.NewSession(&amp;aws.Config{\n        Region:      aws.String(\"ap-southeast-1\"),\n        Credentials: credentials.NewStaticCredentials(\"YOUR_ACCESS_KEY\",\"YOUR SECRET_KEY\", \"\"),\n    }))\n}\n</code></pre>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10814, "favorite_count": 2, "accepted_answer_id": 41549011, "answer_count": 4, "score": 16, "last_activity_date": 1583992973, "creation_date": 1483953497, "last_edit_date": 1485889479, "question_id": 41544554, "link": "https://stackoverflow.com/questions/41544554/how-to-run-aws-sdk-with-credentials-from-variables", "title": "How to run AWS SDK with credentials from variables?", "body": "<p>I used environment variables before and it worked fine.</p>\n\n<p>Now I am migrating my config variables into a single file and I have AWS_SECRET_ACCESS_KEY and AWS_ACCESS_KEY_ID variables containing respective values that are loaded from this file.</p>\n\n<p>I tried this code but receiving an error:</p>\n\n<pre><code>creds := credentials.NewStaticCredentials(\"123\", conf.AWS_SECRET_ACCESS_KEY, conf.AWS_ACCESS_KEY_ID)\nsess, err := session.NewSession(&amp;aws.Config{Credentials: creds})\n</code></pre>\n\n<p>Here is the error</p>\n\n<blockquote>\n  <p>InvalidClientTokenId: The security token included in the request is invalid.</p>\n</blockquote>\n\n<p>How do I properly inject my keys into the aws sdk calls?</p>\n"}, {"tags": ["go", "redigo"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7392690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbeef633f1a5a2686225431e9812cdf6?s=128&d=identicon&r=PG&f=1", "display_name": "jian.zhai", "link": "https://stackoverflow.com/users/7392690/jian-zhai"}, "edited": false, "score": 0, "creation_date": 1484020983, "post_id": 41550255, "comment_id": 70326585, "body": "the Close() will discard all pending responses.but the flush won&#39;t?               i use flush int the loop because the total is very large and it consume a large amount of memory.thank you!"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 3, "user_id": 7392690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbeef633f1a5a2686225431e9812cdf6?s=128&d=identicon&r=PG&f=1", "display_name": "jian.zhai", "link": "https://stackoverflow.com/users/7392690/jian-zhai"}, "edited": false, "score": 0, "creation_date": 1484031264, "post_id": 41550255, "comment_id": 70329992, "body": "Flush writes the data to the network. Flush does not read responses.  The pooled connecton&#39;s Close method attempts to return the connection to a &quot;neutral&quot; state before returning the underlying connection to the pool.  This includes flushing any commands written by the application and reading all responses that the application has not yet read."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 3, "user_id": 7392690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbeef633f1a5a2686225431e9812cdf6?s=128&d=identicon&r=PG&f=1", "display_name": "jian.zhai", "link": "https://stackoverflow.com/users/7392690/jian-zhai"}, "edited": false, "score": 0, "creation_date": 1484031519, "post_id": 41550255, "comment_id": 70330090, "body": "The connection buffers data using a <a href=\"https://godoc.org/bufio#Writer\" rel=\"nofollow noreferrer\">bufio.Writer</a>.  A bufio.Writer uses a fixed size buffer."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1483983129, "last_edit_date": 1483983129, "creation_date": 1483972297, "answer_id": 41550255, "question_id": 41543210, "link": "https://stackoverflow.com/questions/41543210/conn-flush-will-not-flush-all-record-to-redis/41550255#41550255", "title": "conn.flush() will not flush all record to redis", "body": "<p>The reason that the program works when Close() is called after the loop is that the pooled connection's Close() method reads and discards all pending responses.</p>\n\n<p>The application should <a href=\"https://godoc.org/github.com/garyburd/redigo/redis#Conn.Receive\" rel=\"nofollow noreferrer\">Receive</a> the responses for all commands instead of letting the respones backup and consume memory on the server. There's no need to flush in the loop. </p>\n\n<pre><code>go func() {\n  for i = 0; i &lt; *total; i++ {\n     r := time.Now().Unix() - rand.Int63n(60*60*24*31*12)\n     score, _ := strconv.Atoi(time.Unix(r, 0).Format(\"2006010215\"))\n     id := utee.PlainMd5(uuid.NewUUID().String())\n     c.Send(\"ZADD\", \"app_a_5512\", score, id)\n  }\n  c.Flush()\n}\n\nfor i = 0; i &lt; *total; i++ {\n   c.Receive()\n}\nc.Close()\n</code></pre>\n\n<p>Also, the application should check and handle the errors returns from Send, Flush and Receive.</p>\n"}], "owner": {"reputation": 3, "user_id": 7392690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbeef633f1a5a2686225431e9812cdf6?s=128&d=identicon&r=PG&f=1", "display_name": "jian.zhai", "link": "https://stackoverflow.com/users/7392690/jian-zhai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 41550255, "answer_count": 1, "score": 0, "last_activity_date": 1483983129, "creation_date": 1483948034, "question_id": 41543210, "link": "https://stackoverflow.com/questions/41543210/conn-flush-will-not-flush-all-record-to-redis", "title": "conn.flush() will not flush all record to redis", "body": "<p>this is code </p>\n\n<pre><code> func main() {\n   ...\n   pool := createPool(*redis_server, *redis_pass)\n   defer pool.Close()\n   c := pool.Get() \n   var i int64\n   st := tickSec()\n   for i = 0; i &lt; *total; i++ {\n      r := time.Now().Unix() - rand.Int63n(60*60*24*31*12)\n      score, _ := strconv.Atoi(time.Unix(r, 0).Format(\"2006010215\"))\n      id := utee.PlainMd5(uuid.NewUUID().String())\n      c.Send(\"ZADD\", \"app_a_5512\", score, id)\n      if i%10000 == 0 {\n          c.Flush()\n          log.Println(\"current sync to redis\", i)\n      }\n  }\n  //c.Flush()\n  c.Close()\n  ...\n}\n</code></pre>\n\n<p>if i use c.Close(),the total set 100000,the real sortedset count 100000.\nbut if i use c.Flush(),the total also set 100000, the real sortedset count less than 100000(96932);if i use time.Sleep() in the end of the main func,the total is 100000 too.</p>\n\n<p>when main func exit,the flush func is not complete?and why? thank you!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 5, "creation_date": 1483947028, "post_id": 41542941, "comment_id": 70290581, "body": "nop, go is compiled language, and that s great."}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 6, "creation_date": 1483947035, "post_id": 41542941, "comment_id": 70290584, "body": "Is <code>go run main.go</code> what you&#39;re looking for ? However, the code is still compiled under a temporary folder."}, {"owner": {"reputation": 12424, "user_id": 345859, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cdb711788e4473ecd856108533787144?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/345859/jas"}, "edited": false, "score": 0, "creation_date": 1483950063, "post_id": 41542941, "comment_id": 70291918, "body": "update question with motivation"}, {"owner": {"reputation": 12424, "user_id": 345859, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cdb711788e4473ecd856108533787144?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/345859/jas"}, "reply_to_user": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1483950209, "post_id": 41542941, "comment_id": 70291985, "body": "@T.Claverie yes, this is what i was looking for, i&#39;m cool with it that its compiled, i like static typing and compiling, was just wanted to have the ability to have the original scripts on target unix system to be run and not just compiled code, so people can look at the source, hopefully it would be possible to run <code>.go</code> files with imports and fully blown scripts.  this would now enable me i think at least to replace other unix scripts such as <code>Unix shell (Bourne Shell, Bash), Perl, PHP, Ruby</code> with go scripts, what do you think?"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1483988898, "post_id": 41542941, "comment_id": 70315461, "body": "<code>so people can look at the source</code>, as a good developer, and not just a sysadmin with a bunch of scripts within some folder, i suspect you ll version your success with a vcs ? Won t you ? That will be a great way to share and let co workers checkout then study the source. Note that to <code>go run</code> means that the running system has a version of go installed, which may be heavy for some environments in comparison to the deployment of a compiled binary."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": -4, "last_activity_date": 1483948017, "creation_date": 1483948017, "answer_id": 41543204, "question_id": 41542941, "link": "https://stackoverflow.com/questions/41542941/is-it-possible-to-run-go-code-as-a-script/41543204#41543204", "title": "Is it possible to run Go code as a script?", "body": "<p>No this is neither possible nor desirable.</p>\n"}, {"comments": [{"owner": {"reputation": 12424, "user_id": 345859, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cdb711788e4473ecd856108533787144?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/345859/jas"}, "edited": false, "score": 0, "creation_date": 1483950769, "post_id": 41543300, "comment_id": 70292255, "body": "I wonder how much I can &quot;abuse&quot; <code>go run</code> to be able to have much <code>go</code> code running as <code>scripts</code> though compiled (which I like that its compiled) but it looks like <code>go run</code> can give me the opportunity to replace <code>scripting</code> my main interest is to manage <code>sources</code> on servers and not compiled code.  (compilation is a huge benefit, static typing, ...) but still i want to deploy sources and run them as scripts."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1514924275, "post_id": 41543300, "comment_id": 83107936, "body": "It&#39;s very easy (and very common) in a *nix environment. <a href=\"https://stackoverflow.com/questions/42865472/run-golang-script-from-shell-script/42865595#42865595\" title=\"run golang script from shell script\">stackoverflow.com/questions/42865472/&hellip;</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1514972974, "post_id": 41543300, "comment_id": 83123307, "body": "@KavehShahbazian It &quot;feels&quot; like scripting, but in fact it&#39;s nothing more that automating / hiding the process of compiling the Go source into an executable binary and running it."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1514997503, "post_id": 41543300, "comment_id": 83137228, "body": "IMHO same thing applies when one uses Elixir or Clojure for scripting (they have JIT). Even strongly typed, compiled languages like Haskell and F# provide a REPL and in fact F# is used this way in many occasions. Though this is common only on *nix environments and not used by Windows folks."}, {"owner": {"reputation": 15417, "user_id": 805284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9799d7defe74d115e49df39f61388b2?s=128&d=identicon&r=PG", "display_name": "sjas", "link": "https://stackoverflow.com/users/805284/sjas"}, "reply_to_user": {"reputation": 12424, "user_id": 345859, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cdb711788e4473ecd856108533787144?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/345859/jas"}, "edited": false, "score": 0, "creation_date": 1529437565, "post_id": 41543300, "comment_id": 88870361, "body": "@Jas compile + run time of golang is orders of magnitude smaller than running all the interpreter languages from what i&#39;ve seen"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 6, "last_activity_date": 1516351599, "last_edit_date": 1516351599, "creation_date": 1483948399, "answer_id": 41543300, "question_id": 41542941, "link": "https://stackoverflow.com/questions/41542941/is-it-possible-to-run-go-code-as-a-script/41543300#41543300", "title": "Is it possible to run Go code as a script?", "body": "<p>As others noted, Go is a <a href=\"https://en.wikipedia.org/wiki/Compiled_language\" rel=\"nofollow noreferrer\">compiled language</a>. Programs written in the Go language rely on the Go runtime which is added to the executable binary.</p>\n\n<p>The Go runtime provides certain vital features such as garbage collection, goroutine scheduling, runtime reflection etc. Without them a Go app cannot work as guaranteed by the language spec.</p>\n\n<p>A <em>theoretical</em> Go interpreter would have to simulate those features, which would essentially mean to include a Go runtime and a Go compiler.  There is no such thing, and there is no need for that.<br>\nAlso note that if the code is not yet compiled, that means the Go interpreter would have to contain <em>all</em> the standard library, because a Go \"script\" could legally refer to anything from the standard library (when a Go app is compiled, only things that it uses / refers to gets compiled into the executable binary).</p>\n\n<p>To quickly test something, just use <code>go run</code>, which also compiles your app and builds an executable binary in a temporary folder, launches that temp file and cleans it when your app exits.</p>\n\n<p>\"Solutions\" posted by others may \"feel\" like scripting, but they are nothing more than automating / hiding the process of compiling the Go source to an executable binary and then launching that binary. This is exactly what <code>go run</code> does (which also cleans up the temporary binary).</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 837736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20393a91d8907f69772c511acc1f3371?s=128&d=identicon&r=PG", "display_name": "Grauwolf", "link": "https://stackoverflow.com/users/837736/grauwolf"}, "edited": false, "score": 1, "creation_date": 1511301877, "post_id": 43954643, "comment_id": 81801762, "body": "To make this POSIX compliant the following would work.  <code>&#47;&#47; 2&gt;&#47;dev&#47;null||&#47;usr&#47;bin&#47;go run $0 $@; exit $?</code>.  <code>&#47;&#47;</code> is not necessarily equal to <code>&#47;</code> in all spots of a path. POSIX allows the root of <code>&#47;&#47;</code> to be interpreted in an implementation-defined manner (cygwin uses this for example). Three or more slashes would be considered equal to <code>&#47;</code> again, though."}, {"owner": {"reputation": 7294, "user_id": 136796, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f6d569508d3f79fd2d9390a56935d0?s=128&d=identicon&r=PG", "display_name": "S&#248;ren L&#248;vborg", "link": "https://stackoverflow.com/users/136796/s%c3%b8ren-l%c3%b8vborg"}, "edited": false, "score": 0, "creation_date": 1576595324, "post_id": 43954643, "comment_id": 104946304, "body": "It&#39;s worth noting that this relies on a <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_09_01_01\" rel=\"nofollow noreferrer\">POSIX shell feature</a>, rather than the kernel (which would require a <code>#!</code> she-bang line, and isn&#39;t compatible with &quot;multi-word&quot; commands like <code>go run</code>). As such, the script will only work when invoked by a shell (or shell script), not if invoked directly by a native app using <code>exec*</code>."}], "tags": [], "owner": {"reputation": 3731, "user_id": 3438276, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d936bbca4445305c07f2292689d271c1?s=128&d=identicon&r=PG", "display_name": "vikas027", "link": "https://stackoverflow.com/users/3438276/vikas027"}, "is_accepted": true, "score": 12, "last_activity_date": 1494688030, "creation_date": 1494688030, "answer_id": 43954643, "question_id": 41542941, "link": "https://stackoverflow.com/questions/41542941/is-it-possible-to-run-go-code-as-a-script/43954643#43954643", "title": "Is it possible to run Go code as a script?", "body": "<p>I am not an expert in go, but you can do something like this. I know this is not elegant, but may be something to start with :)</p>\n\n<pre><code>~$ cat vikas.go\n//usr/bin/env go run \"$0\" \"$@\"; exit\n\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Printf(\"Hello World\\n\")\n}\n~$\n\n~$ ./vikas.go\nHello World\n~$\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15417, "user_id": 805284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9799d7defe74d115e49df39f61388b2?s=128&d=identicon&r=PG", "display_name": "sjas", "link": "https://stackoverflow.com/users/805284/sjas"}, "edited": false, "score": 0, "creation_date": 1576777676, "post_id": 47108019, "comment_id": 105016621, "body": "neugram looks pretty dead, according to the github commits."}, {"owner": {"reputation": 1609, "user_id": 1461607, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/deeaecb70d013f156b76587e1b62a59f?s=128&d=identicon&r=PG", "display_name": "user1461607", "link": "https://stackoverflow.com/users/1461607/user1461607"}, "edited": false, "score": 0, "creation_date": 1608898862, "post_id": 47108019, "comment_id": 115709020, "body": "This project died in March 2018."}], "tags": [], "owner": {"reputation": 5847, "user_id": 2793141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/426763c6bea798018f97e9a11192a139?s=128&d=identicon&r=PG&f=1", "display_name": "Tomer Ben David", "link": "https://stackoverflow.com/users/2793141/tomer-ben-david"}, "is_accepted": false, "score": 4, "last_activity_date": 1509775808, "creation_date": 1509775808, "answer_id": 47108019, "question_id": 41542941, "link": "https://stackoverflow.com/questions/41542941/is-it-possible-to-run-go-code-as-a-script/47108019#47108019", "title": "Is it possible to run Go code as a script?", "body": "<p>see <a href=\"https://neugram.io\" rel=\"nofollow noreferrer\">Neugram, Go scripting</a> .  From it's documentation:</p>\n\n<pre><code>#!/usr/bin/ng\n\n// Start a web server to serve files.\nimport \"net/http\"\npwd := $$ echo $PWD $$\nh := http.FileServer(http.Dir(pwd))\nhttp.ListenAndServe(\":8080\", h)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 339, "user_id": 2896857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tjpGI.jpg?s=128&g=1", "display_name": "quietContest", "link": "https://stackoverflow.com/users/2896857/quietcontest"}, "edited": false, "score": 0, "creation_date": 1553414797, "post_id": 50935818, "comment_id": 97370097, "body": "this is the right answer, and you&#39;ll note it&#39;s newer than the others, I suppose that&#39;s why it&#39;s not at the top just yet..."}], "tags": [], "owner": {"reputation": 15417, "user_id": 805284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9799d7defe74d115e49df39f61388b2?s=128&d=identicon&r=PG", "display_name": "sjas", "link": "https://stackoverflow.com/users/805284/sjas"}, "is_accepted": false, "score": 4, "last_activity_date": 1529437302, "creation_date": 1529437302, "answer_id": 50935818, "question_id": 41542941, "link": "https://stackoverflow.com/questions/41542941/is-it-possible-to-run-go-code-as-a-script/50935818#50935818", "title": "Is it possible to run Go code as a script?", "body": "<p>Absolutely possible on linux, props to cf: <a href=\"https://blog.cloudflare.com/using-go-as-a-scripting-language-in-linux\" rel=\"nofollow noreferrer\">https://blog.cloudflare.com/using-go-as-a-scripting-language-in-linux</a></p>\n\n<p>In case you don't want to use the already mentioned 'shebang' which may have limitations:</p>\n\n<pre><code>//usr/bin/env go run \"$0\" \"$@\"; exit \"$?\"\n</code></pre>\n\n<p>Do this instead:</p>\n\n<pre><code># check if binfmt_misc is already active \n# (should already be done through systemd)\nmount | grep binfmt_misc\n\n# if not already mounted\nsudo mount binfmt_misc -t binfmt_misc /proc/sys/fs/binfmt_misc\n\n# get gorun and place it so it will work\ngo get github.com/erning/gorun\nsudo mv $GOPATH/bin/gorun /usr/local/bin\n\n# make .go scripts being run with `gorun` wrapper script\necho ':golang:E::go::/usr/local/bin/gorun:OC' | sudo tee /proc/sys/fs/binfmt_misc/register\n</code></pre>\n\n<p>This is just for one-off testing. To make this persistant, I have this as the second last line in my <code>/etc/rc.local</code>'s:</p>\n\n<pre><code>echo ':golang:E::go::/usr/local/bin/gorun:OC' | tee /proc/sys/fs/binfmt_misc/register 1&gt;/dev/null\n</code></pre>\n\n<p>If you experience something like 'caching' issues during developing scripts, have a look at <code>/tmp/gorun-$(hostname)-USERID</code>. </p>\n\n<p>I love <code>bash</code>, but as soon as you need a proper datastructures (bash arrays and associative arrays don't count due to unusability) you need another language.\nGolang is faster to write for me than is python, and any golang setup as depicted above will do for me. No battling python 2 vs 3, its libs and pip horrors, have a distributable binary at will, and just instantly be able to change the source for small one-off scripts is why this approach has definitely its upsides.</p>\n"}], "owner": {"reputation": 12424, "user_id": 345859, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cdb711788e4473ecd856108533787144?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/345859/jas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11517, "favorite_count": 6, "accepted_answer_id": 43954643, "answer_count": 5, "score": 14, "last_activity_date": 1573560378, "creation_date": 1483946830, "last_edit_date": 1573560378, "question_id": 41542941, "link": "https://stackoverflow.com/questions/41542941/is-it-possible-to-run-go-code-as-a-script", "title": "Is it possible to run Go code as a script?", "body": "<p>As Go is becoming the language of the \"system\".  I wonder if it's possible to run Go code as a script, without compiling it, is there any possibility to do that?</p>\n\n<p>The motivation (as there were questions as for motivation), taken from <a href=\"http://alvinalexander.com/scala/how-to-write-scala-shell-scripts-scripting-language-examples\" rel=\"nofollow noreferrer\">How to use Scala as a scripting language</a></p>\n\n<blockquote>\n  <p>Problem You want to use Scala as a scripting language on Unix systems,\n  replacing other scripts you\u2019ve written in a Unix shell (Bourne Shell,\n  Bash), Perl, PHP, Ruby, etc.</p>\n</blockquote>\n\n<p>UPDATE:\nI wonder how much I can \"abuse\" <code>go run</code> to be able to have much Go code running as <code>scripts</code> though compiled (which I like that its compiled) but it looks like <code>go run</code> can give me the opportunity to replace <code>scripting</code>, that is have source files on servers and run them as source while getting compiled by the <code>go run</code> but I still manage sources and not executables.</p>\n\n<p>UPDATE:\nin addition saw <a href=\"https://gist.github.com/mattn/1932487\" rel=\"nofollow noreferrer\">gorun</a></p>\n\n<blockquote>\n  <p>gorun - Script-like runner for Go source files.</p>\n</blockquote>\n\n<p>Though there is a motivation and tools which tried to workaround not being able to run as script, I will not go for it, +I've been told it's not production ready and was advised not to use it in production because it's not production ready, it's out of it's purpose and would need dump the scripting convenience in favour of Go.  (I don't have anything against compiling, static typing, I'm a big fan of it, but wanted something similar to scripting convenience).</p>\n"}, {"tags": ["debugging", "go", "garbage-collection", "heap-dump"], "comments": [{"owner": {"reputation": 669, "user_id": 7406508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8vnaf.jpg?s=128&g=1", "display_name": "Jeandey Boris", "link": "https://stackoverflow.com/users/7406508/jeandey-boris"}, "edited": false, "score": 0, "creation_date": 1484427955, "post_id": 41542775, "comment_id": 70508617, "body": "Could this link help you in your Go memory analysis? <a href=\"https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs\" rel=\"nofollow noreferrer\">software.intel.com/en-us/blogs/2014/05/10/&hellip;</a>"}, {"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "reply_to_user": {"reputation": 669, "user_id": 7406508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8vnaf.jpg?s=128&g=1", "display_name": "Jeandey Boris", "link": "https://stackoverflow.com/users/7406508/jeandey-boris"}, "edited": false, "score": 0, "creation_date": 1484905726, "post_id": 41542775, "comment_id": 70712637, "body": "@JeandeyBoris, I have already tried those tricks. But, none of them actually helps. Only information that will help is Heap Dump which I couldn&#39;t understand."}], "answers": [{"tags": [], "owner": {"reputation": 9594, "user_id": 448734, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94ccfc629c6862b5950de3512742bcae?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/448734/bryan"}, "is_accepted": false, "score": 2, "last_activity_date": 1491054971, "creation_date": 1491054971, "answer_id": 43157769, "question_id": 41542775, "link": "https://stackoverflow.com/questions/41542775/how-to-visualize-heapdump/43157769#43157769", "title": "How to visualize heapdump?", "body": "<p>There is, currently, no complete solution to your problem. The <a href=\"https://github.com/golang/go/wiki/heapdump15\" rel=\"nofollow noreferrer\">newest heap dump format</a> explains that some information previously available is no longer tracked by the runtime.</p>\n\n<p><a href=\"https://github.com/golang/go/issues/16410\" rel=\"nofollow noreferrer\">Go Issue 16410</a> has lots of details and information on work in progress.</p>\n\n<p>One tool - a work in progress - that may help is <a href=\"https://github.com/tombergan/goheapdump\" rel=\"nofollow noreferrer\">goheapdump</a></p>\n"}, {"comments": [{"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1537003916, "post_id": 46400219, "comment_id": 91632953, "body": "Can you explain how profiling will help me to find the object which are not garbage collected?"}, {"owner": {"reputation": 50, "user_id": 1109167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b6236efa4fd7dfd2b6c4a7c20bb8c83?s=128&d=identicon&r=PG", "display_name": "ibigbug", "link": "https://stackoverflow.com/users/1109167/ibigbug"}, "reply_to_user": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1537016769, "post_id": 46400219, "comment_id": 91635788, "body": "@Spartan Wasn&#39;t the original question is to look at the heapdump? Since you&#39;ve already be able to visualize the heap, you can find out what is exactly in taking the heap space. And usually the objects in the heap taking lots of spaces is considered not garbage collected, which gives you the way to find out whether it&#39;s due to cycle reference or not."}], "tags": [], "owner": {"reputation": 50, "user_id": 1109167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b6236efa4fd7dfd2b6c4a7c20bb8c83?s=128&d=identicon&r=PG", "display_name": "ibigbug", "link": "https://stackoverflow.com/users/1109167/ibigbug"}, "is_accepted": false, "score": -3, "last_activity_date": 1506328306, "last_edit_date": 1506328306, "creation_date": 1506326410, "answer_id": 46400219, "question_id": 41542775, "link": "https://stackoverflow.com/questions/41542775/how-to-visualize-heapdump/46400219#46400219", "title": "How to visualize heapdump?", "body": "<p>You can use <code>net/pprof</code> package. Just follow the steps in <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">https://blog.golang.org/profiling-go-programs</a> to dump heap/cpu profile.</p>\n\n<p>And you can use <code>go tool pprof binary dumpfile</code> to analyse a dumpfile. Type <code>web</code> in the interactive analysis tool, you can see the call graph in your web browser.</p>\n"}], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2915, "favorite_count": 1, "answer_count": 2, "score": 8, "last_activity_date": 1506328306, "creation_date": 1483945998, "question_id": 41542775, "link": "https://stackoverflow.com/questions/41542775/how-to-visualize-heapdump", "title": "How to visualize heapdump?", "body": "<p>We have developed a server using golang which will receive concurrent request and process the request(creates big object - a tree) and then send back reply. But the objects are not garbage collected. So I decided to analyze the objects that live in the memory. To start with, I wrote a simple program </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n    \"runtime/debug\"\n)\n\nfunc main() {\n    var i_am_a int = 10\n    _ = i_am_a\n    func() {\n        f, err := os.Create(\"dump\")\n        defer f.Close()\n        if err != nil {\n            panic(err)\n        }\n        debug.WriteHeapDump(f.Fd())\n    }()\n\n    b, err := ioutil.ReadFile(\"dump\")\n    if err != nil {\n        panic(err)\n    }\n    fmt.Print(string(b))\n\n}\n</code></pre>\n\n<p>But I couldn't understand the representaion(<a href=\"https://github.com/golang/go/wiki/heapdump13\" rel=\"noreferrer\">https://github.com/golang/go/wiki/heapdump13</a> - this didn't help). All I wanted is to trace back from the memory(big object) to the place(variable in go app code) which holds the root address of the object. So that I can release the reference and let GC to collect it in it's cycle. Is there a latest tool to visualize heapdump? or Is there a better approach to this problem? </p>\n"}, {"tags": ["authentication", "go"], "comments": [{"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1483957032, "post_id": 41541511, "comment_id": 70295788, "body": "I&#39;ve met strange problems connecting to Jira API. Sometimes you need to allow API connections explicitly. Sometimes you have to make an OpenAPI dance to get a credentials. Not all packages work well with it. So I recommend getting sure problem not in API itself, e.g. with CURL or another handy http debugging tool like <code>httpie</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 5, "last_activity_date": 1483940259, "creation_date": 1483940259, "answer_id": 41541619, "question_id": 41541511, "link": "https://stackoverflow.com/questions/41541511/golang-http-basic-auth/41541619#41541619", "title": "Golang HTTP Basic Auth", "body": "<p>As seen in <a href=\"https://github.com/Netflix-Skunkworks/go-jira/blob/5a71939a27c978a8e7d19968dc23908197484827/cli.go#L221\" rel=\"noreferrer\"><code>Netflix-Skunkworks/go-jira/cli.go</code></a>, you might need to login first, then request your jira ticket.</p>\n\n<pre><code>func (c *Cli) makeRequest(req *http.Request) (resp *http.Response, err error) {\n    req.Header.Set(\"Accept\", \"application/json\")\n    req.Header.Set(\"Content-Type\", \"application/json\")\n\n    if source, ok := c.opts[\"password-source\"]; ok &amp;&amp; !strings.HasSuffix(req.URL.Path, \"/rest/auth/1/session\") {\n        user, _ := c.opts[\"user\"].(string)\n        password := c.GetPass(user)\n        if password == \"\" {\n            log.Warning(\"No password for user %s in %s, please run the 'login' command first\", user, source)\n        } else {\n            req.SetBasicAuth(user, password)\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 790, "user_id": 1986072, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9h0Up.jpg?s=128&g=1", "display_name": "rahulb", "link": "https://stackoverflow.com/users/1986072/rahulb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7270, "favorite_count": 2, "accepted_answer_id": 41541619, "answer_count": 1, "score": 5, "last_activity_date": 1483940509, "creation_date": 1483939545, "last_edit_date": 1483940509, "question_id": 41541511, "link": "https://stackoverflow.com/questions/41541511/golang-http-basic-auth", "title": "Golang HTTP Basic Auth", "body": "<p>I am new in golang.</p>\n\n<p>I am trying to call JIRA rest api with basic auth, but getting following error</p>\n\n<pre><code>&amp;{401 Unauthorized 401 HTTP/2.0 2 0\nmap[X-Content-Type-Options:[nosniff]\nSet-Cookie:[JSESSIONID=E08620; Path=/;\nSecure; HttpOnly studio.crowd.tokenkey=\"\";\nDomain=.test.atlassian.net; Expires=Thu, 01-Jan-1970 00:00:10\nGMT; Path=/; Secure; HttpOnly studio.crowd.tokenkey=\"\";\nDomain=.test.atlassian.net; Expires=Thu, 01-Jan-1970 00:00:10\nGMT; Path=/; Secure; HttpOnly] Server:[nginx] Date:[Mon, 09 Jan 2017\n05:18:29 GMT] Content-Type:[text/html;charset=UTF-8]\nX-Arequestid:[648x20759x1] X-Seraph-Loginreason:[AUTHENTICATED_FAILED]\nWww-Authenticate:[OAuth\nrealm=\"https%3A%2F%2Ftest.atlassian.net\"]] {0xc42039b900} -1 []\nfalse false map[] 0xc4200ce0f0 0xc4202b0420}\n</code></pre>\n\n<p>My code is </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\nconst (\n    USERNAME = \"\"\n    PASSWORD = \"\"\n    URL      = \"https://test.atlassian.net/rest/api/2/issue/SLUB-7194\"\n)\n\nfunc main() {\n    req, err := http.NewRequest(\"GET\", URL, nil)\n    req.SetBasicAuth(USERNAME, PASSWORD)\n\n    req.Header.Set(\"Accept\", \"application/json\")\n    req.Header.Set(\"Content-Type\", \"application/json\")\n\n    cli := &amp;http.Client{}\n    resp, err := cli.Do(req)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(resp);\n}\n</code></pre>\n\n<p>Am I doing something wrong?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["postgresql", "go", "go-pg"], "comments": [{"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1483941817, "post_id": 41541267, "comment_id": 70288639, "body": "AFAIK go-pg doesn&#39;t have a way to insert with <code>cascade</code>"}, {"owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "reply_to_user": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1483978951, "post_id": 41541267, "comment_id": 70309895, "body": "@Motakjuq that breaks my heart"}, {"owner": {"reputation": 10520, "user_id": 1901272, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/jYdbs.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1901272/rob"}, "edited": false, "score": 0, "creation_date": 1583084506, "post_id": 41541267, "comment_id": 106989109, "body": "Three years later... I&#39;m also looking for a way to do this. What did you do, did you find a solution?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3939196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4570b3029cbe2f947ba66ab6d608697d?s=128&d=identicon&r=PG&f=1", "display_name": "user3939196", "link": "https://stackoverflow.com/users/3939196/user3939196"}, "is_accepted": false, "score": 1, "last_activity_date": 1499528859, "creation_date": 1499528859, "answer_id": 44987953, "question_id": 41541267, "link": "https://stackoverflow.com/questions/41541267/inserting-relationships-go-pg-postgresql/44987953#44987953", "title": "inserting relationships go-pg PostgreSQL", "body": "<p>Rodrigo, same problem statement is being discussed here: <a href=\"https://github.com/go-pg/pg/issues/478\" rel=\"nofollow noreferrer\">https://github.com/go-pg/pg/issues/478</a></p>\n\n<p>This functionality is not supported in go-pg at this time and you might want to try a db prepare approach to insert with relationships.</p>\n"}], "owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1941, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1499528859, "creation_date": 1483937905, "question_id": 41541267, "link": "https://stackoverflow.com/questions/41541267/inserting-relationships-go-pg-postgresql", "title": "inserting relationships go-pg PostgreSQL", "body": "<p>I've got 2 structs to represent a <code>ManyToMany</code> relationship. User and Note</p>\n\n<pre><code>type User struct {\n    ID int\n    Name string\n    Notes []*Note\n}\n\ntype Note struct {\n    TableName struct{} `sql:\"user_notes\"`\n    ID int\n    Text string\n}\n</code></pre>\n\n<p>Now let's say I want to insert a new user and also at the same time add a few notes.</p>\n\n<p>I would expect this to insert a user and its note(s):</p>\n\n<pre><code>note := Note{\n    Text: \"alohaa dude\",\n}\n\nuser := User{\n    Name:  \"peter\",\n    Notes: []Note{no},\n}\n\ns.DB.Insert(&amp;user)\n</code></pre>\n\n<p>However this only saves the user and not the user and the note. In go-pg do I have to do this manually or is there an automated way through the ORM?</p>\n"}, {"tags": ["go", "go-flag"], "owner": {"reputation": 112, "user_id": 7389325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UaKF.jpg?s=128&g=1", "display_name": "Cassey", "link": "https://stackoverflow.com/users/7389325/cassey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1483943050, "creation_date": 1483937536, "last_edit_date": 1483943050, "question_id": 41541216, "link": "https://stackoverflow.com/questions/41541216/global-go-flag-addcommand-clarification-and-or-example", "title": "Global go-flag AddCommand clarification and/or example", "body": "<p>In my early days of learning Go and trying to use package <code>github.com/jessevdk/go-flags</code>.  I checked the Fly example referenced in another <code>go-flags</code> thread, but it apparently does not use <code>AddCommand</code> (at least per my grep).</p>\n\n<p>The godoc article recommends defining a global parser instance and to implement each command in a separate file.  Each of those command files should define a go init function which calls AddCommand on the global parser.</p>\n\n<p>Making my parser global was easy enough.  Confused on the <code>init()</code> setups:</p>\n\n<p>1)  My understanding is that <code>init()</code> order execution is random, other than your main's init running last.</p>\n\n<p>2)  If so, I can't ensure that my <code>NewParser()</code> call in my configuration code has been called prior my AddCommand() calls.</p>\n\n<p>3)  My code compiles, but a --help doesn't show any defined commands, making me think that indeed, the <code>AddCommand()</code> was called before the <code>NewParser()</code> \n/* Just a guess */</p>\n\n<p>4)  QED I'm confused!</p>\n\n<p>Does anybody have a recommended example I could go learn from?</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1483948203, "post_id": 41541040, "comment_id": 70291065, "body": "Well, that one is simple: You read the documentation of <code>foo</code>! I know this sound strange to many people, but yes, that&#39;s how you do it! If <code>foo</code> comes without clear documentation you should not call it anyway."}], "answers": [{"comments": [{"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1483937231, "post_id": 41541152, "comment_id": 70287253, "body": "I actually came across that myself before the question. Perhaps I should have been more specific in my question, but I meant that without checking the source code is there any way?"}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1483937302, "post_id": 41541152, "comment_id": 70287280, "body": "Atleast you should check the docs: <a href=\"https://golang.org/pkg/encoding/xml/#Decoder.DecodeElement\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/xml/#Decoder.DecodeElement</a>"}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1483937505, "post_id": 41541152, "comment_id": 70287335, "body": "Its clearly mentioned in the docs: <code>DecodeElement works like Unmarshal except that it takes a pointer to the start XML element to decode into v</code>"}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1483937676, "post_id": 41541152, "comment_id": 70287370, "body": "James would you prefer that I change the function signature in my original question? I&#39;m not talking specifically about <code>DecodeElement</code>, but any function with <code>interface{}</code> as a parameter type"}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1483937718, "post_id": 41541152, "comment_id": 70287377, "body": "Ah ok if that the case then interface{} could be anything and its entirely depend on the person who write the method or function."}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1483937806, "post_id": 41541152, "comment_id": 70287397, "body": "Ah ok, thanks. Also as a side note you misread the docs lol... when it says <b>pointer to the start XML element</b>, it&#39;s referring to <code>*StartElement</code> not <code>v</code>"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1483937849, "post_id": 41541152, "comment_id": 70287409, "body": "OP is asking about the first argument to <code>DecodeElement()</code> (formal <code>v</code>), not the second (formal <code>start</code>).   The fact that the function takes a pointer to the second argument doesn&#39;t answer his question."}], "tags": [], "owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "is_accepted": true, "score": 3, "last_activity_date": 1483938813, "last_edit_date": 1495541238, "creation_date": 1483937090, "answer_id": 41541152, "question_id": 41541040, "link": "https://stackoverflow.com/questions/41541040/if-the-type-of-a-parameter-is-interface-how-do-you-know-whether-you-pass-by-po/41541152#41541152", "title": "If the type of a parameter is interface{} how do you know whether you pass by pointer or by value?", "body": "<p>Here is the snippet from the source:</p>\n\n<pre><code>// DecodeElement works like Unmarshal except that it takes\n// a pointer to the start XML element to decode into v.\n// It is useful when a client reads some raw XML tokens itself\n// but also wants to defer to Unmarshal for some elements.\n\nfunc (d *Decoder) DecodeElement(v interface{}, start *StartElement) error {\n    val := reflect.ValueOf(v)\n    if val.Kind() != reflect.Ptr {\n        return errors.New(\"non-pointer passed to Unmarshal\")\n    }\n    return d.unmarshal(val.Elem(), start)\n}\n</code></pre>\n\n<p>It is checking <code>val.Kind() != reflect.Ptr</code> Which means you have to pass the pointer i.e &amp;v.</p>\n\n<p>Its entirely depend on the person who wrote the method or function, so <code>interface{}</code> could be either *ptr or anything but u ve to check that inside your function using <code>reflect.ValueOf(v).Kind()</code> whether the value is a pointer or not and proceeds accordingly.</p>\n\n<p><strong><a href=\"https://tour.golang.org/methods/14\" rel=\"nofollow noreferrer\">And little bit about empty interface:</a></strong></p>\n\n<p>The interface type that specifies zero methods is known as the empty interface:</p>\n\n<p><code>interface{}</code></p>\n\n<p>An empty interface may hold values of any type. (Every type implements at least zero methods.)</p>\n\n<p>Empty interfaces are used by code that handles values of unknown type. For example, fmt.Print takes any number of arguments of type <code>interface{}</code>.</p>\n\n<p>Another useful discussion: <a href=\"https://stackoverflow.com/questions/23148812/go-whats-the-meaning-of-interface\">docs</a></p>\n"}, {"comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1483938660, "post_id": 41541298, "comment_id": 70287656, "body": "aaaaand of course as James points out in his (edited) answer you can of course totally use reflection to assess if the value in question is in fact a pointer to struct - and you could subsequently in fact indirect with &amp; just fine.   So, I suppose my answer is &quot;literally&quot; incorrect!"}], "tags": [], "owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "is_accepted": false, "score": 1, "last_activity_date": 1483938471, "last_edit_date": 1483938471, "creation_date": 1483938152, "answer_id": 41541298, "question_id": 41541040, "link": "https://stackoverflow.com/questions/41541040/if-the-type-of-a-parameter-is-interface-how-do-you-know-whether-you-pass-by-po/41541298#41541298", "title": "If the type of a parameter is interface{} how do you know whether you pass by pointer or by value?", "body": "<p><code>DecodeElement()</code> and friends have a formal <code>v interface{}</code> whose type is documented in the <code>Unmarshal()</code> function <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>Unmarshal parses the XML-encoded data and stores the result  in the\n  value pointed to by v, which must be an arbitrary struct, slice, or\n  string.</p>\n</blockquote>\n\n<p>So to literally answer your question, no, you cannot know without reading the source - if the value you want to pass is a struct proper, you need to indirect.   If it is already a pointer to that struct, you do not.</p>\n\n<p>For example:</p>\n\n<pre><code>type Result struct {\n    XMLName xml.Name `xml:\"Person\"`\n    Name    string   `xml:\"FullName\"`\n    Phone   string\n    Email   []Email\n    Groups  []string `xml:\"Group&gt;Value\"`\n    Address\n}\n\nvar (\n    a Result\n    b *Result\n    c string\n)\n\nxmlDecoder.DecodeElement(&amp;a, startElement)\nxmlDecoder.DecodeElement(&amp;c, startElement)\n</code></pre>\n\n<p>but</p>\n\n<pre><code>xmlDecoder.DecodeElement(b, startElement)\n</code></pre>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 41541152, "answer_count": 2, "score": 0, "last_activity_date": 1483938813, "creation_date": 1483936067, "last_edit_date": 1483938233, "question_id": 41541040, "link": "https://stackoverflow.com/questions/41541040/if-the-type-of-a-parameter-is-interface-how-do-you-know-whether-you-pass-by-po", "title": "If the type of a parameter is interface{} how do you know whether you pass by pointer or by value?", "body": "<p>Given any function that takes a parameter of type <code>interface{}</code> how would I know whether or not to pass that parameter with or without <code>&amp;</code> without navigating the source code of the function.</p>\n\n<p>For example if I had a function with this type signature given to me:</p>\n\n<pre><code>func foo(x interface{}, y int) int\n</code></pre>\n\n<p>Would there be any way to figure out if x was supposed to be passed by value or by pointer?</p>\n"}, {"tags": ["postgresql", "go", "go-pg"], "answers": [{"comments": [{"owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "edited": false, "score": 0, "creation_date": 1487891125, "post_id": 41540860, "comment_id": 72001213, "body": "which of the two would you say is more efficient?"}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "reply_to_user": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "edited": false, "score": 0, "creation_date": 1487924995, "post_id": 41540860, "comment_id": 72012330, "body": "@Rodrigo if you&#39;re looking for efficiency, the first option is better, because you only perform one query, but you have to write the join yourself."}], "tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 4, "last_activity_date": 1483934469, "creation_date": 1483934469, "answer_id": 41540860, "question_id": 41540051, "link": "https://stackoverflow.com/questions/41540051/building-go-pg-orm-query-for-many-to-many-relationship/41540860#41540860", "title": "Building go-pg ORM query for many to many relationship", "body": "<p>In this particular case, you can do some workaround to perform this specific query, I suppose you have theses structures:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Company struct {\n    TableName struct{} `sql:\"companies\"`\n    ID        int64\n    Name      string\n    Customers []*Customer `pg:\",many2many:companies_customers\"`\n}\n\ntype Customer struct {\n    TableName struct{} `sql:\"customers\"`\n    ID        int64\n    Username  string\n    Companies []*Company `pg:\",many2many:companies_customers\"`\n}\n</code></pre>\n\n<p>If you only need to perform the query with the <code>JOIN</code>, you can do</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var customers []*Customer\nerr := conn.Model(&amp;customers).Column(\"customer.*\").Join(\"inner join companies_customers cc on customer.id = cc.customer_id\").Where(\"cc.company_id = ?\", companyID).Select()\nif err != nil {\n    // Error Handler\n} else {\n    for _, customer := range customers {\n        fmt.Printf(\"Customer -&gt; id: %d, username:%s \\n\", customer.ID, customer.Username)\n    }\n}\n</code></pre>\n\n<p>This generate:</p>\n\n<pre><code>SELECT \"customer\".* FROM customers AS \"customer\" inner join companies_customers cc on customer.id = cc.customer_id WHERE (cc.company_id = 1)\n</code></pre>\n\n<p>But, you also can do the following:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var customers []*Customer\nvar company Company\nerr = conn.Model(&amp;company).Column(\"Customers\").Where(\"company.id = ?\", companyID).Select()\nif err != nil {\n    // error handler\n} else {\n    customers = company.Customers\n    for _, customer := range company.Customers {\n        fmt.Printf(\"Customer -&gt; id: %d, username:%s \\n\", customer.ID, customer.Username)\n    }\n}\n</code></pre>\n\n<p>This code perform two queries:</p>\n\n<pre><code>SELECT \"company\".\"id\", \"company\".\"name\" FROM companies AS \"company\" WHERE (company.id = 1)\nSELECT companies_customers.*, \"customer\".* FROM customers AS \"customer\" JOIN companies_customers ON (companies_customers.\"company_id\") IN ((1)) WHERE (\"customer\".\"id\" = companies_customers.\"customer_id\")\n</code></pre>\n\n<p>First create a query to fetch the data from <code>company</code>, after that, fetch all the customers for that company.</p>\n"}], "owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4589, "favorite_count": 3, "accepted_answer_id": 41540860, "answer_count": 1, "score": 2, "last_activity_date": 1483934469, "creation_date": 1483927923, "question_id": 41540051, "link": "https://stackoverflow.com/questions/41540051/building-go-pg-orm-query-for-many-to-many-relationship", "title": "Building go-pg ORM query for many to many relationship", "body": "<p>I've got 3 tables to represent my many to many relationship. customers, companies, companies_customers. </p>\n\n<pre><code>companies:\n - id\n - name\n\ncustomers:\n - id\n - username\n\ncompanies_customers:\n - id\n - customer_id\n - company_id\n</code></pre>\n\n<p>Now the query I want to run is to select all the customers with a company_id of 1. A raw SQL query could/might look something like this:</p>\n\n<pre><code>SELECT * FROM customers c INNER JOIN customers_companies cc ON c.id = cc.customer_id WHERE cc.company_id = 1\n</code></pre>\n\n<p>I've tried doing something like this in go-pg:</p>\n\n<pre><code>var customers []*Customer\n\ns.DB.Model(&amp;customers).Relation(\"Companies\", func(q *orm.Query) (*orm.Query, error) {\n    return q.Where(\"company_id = ?\", companyID), nil\n}).Select()\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 4, "creation_date": 1483927125, "post_id": 41539909, "comment_id": 70285134, "body": "try <code>go get -v -u github.com&#47;gorilla&#47;mux</code>"}, {"owner": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1483932690, "post_id": 41539909, "comment_id": 70286227, "body": "@YandryPozo It is same..."}, {"owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "edited": false, "score": 1, "creation_date": 1483932984, "post_id": 41539909, "comment_id": 70286297, "body": "The error message says <code>($GOPATH not set)</code>."}, {"owner": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483933120, "post_id": 41539909, "comment_id": 70286332, "body": "My <code>$GOPATH</code> is <code>&#47;User&#47;imac&#47;go</code>. Is it problem?"}], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483932962, "post_id": 41540455, "comment_id": 70286289, "body": "gorilla folder is not here. <code>&#47;Users&#47;imac&#47;go&#47;src&#47;github.com</code> &lt; in here..."}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483934978, "post_id": 41540455, "comment_id": 70286744, "body": "You may need to install it. please do step 3. and let me know the output."}, {"owner": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483936693, "post_id": 41540455, "comment_id": 70287145, "body": "In 1 step, I see message <code>ls: &#47;usr&#47;local&#47;go&#47;src&#47;github.com: No such file or directory</code>. In 2 step, I see path <code>github.com&#47;gorilla&#47;mux</code>. In 3 step, I install it but program is still show same error."}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483937646, "post_id": 41540455, "comment_id": 70287361, "body": "can u see by <code>go list ... | grep gorilla</code>"}, {"owner": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483938050, "post_id": 41540455, "comment_id": 70287470, "body": "Yes. I can see path <code>github.com&#47;gorilla&#47;mux</code>."}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483938352, "post_id": 41540455, "comment_id": 70287549, "body": "export PATH=$PATH:$GOPATH/bin"}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483938378, "post_id": 41540455, "comment_id": 70287555, "body": "i din&#39;t see $PATH in ur env var."}, {"owner": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483940425, "post_id": 41540455, "comment_id": 70288199, "body": "I have to store <code>export PATH=$PATH:$GOPATH&#47;bin</code> in bash_profile?"}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483940880, "post_id": 41540455, "comment_id": 70288329, "body": "just execute that command in cli and check if that works, if yes you can include into your .profile or .bash_profile"}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483942536, "post_id": 41540455, "comment_id": 70288895, "body": "could you please paste the output of this cmd <code>echo $PATH $GOPATH</code>"}, {"owner": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483942611, "post_id": 41540455, "comment_id": 70288928, "body": "<code>&#47;usr&#47;local&#47;bin:&#47;usr&#47;bin:&#47;bin:&#47;usr&#47;sbin:&#47;sbin:&#47;usr&#47;local&#47;go&#47;b&zwnj;&#8203;in:&#47;usr&#47;local&#47;go&#47;bin&zwnj;&#8203;:&#47;Users&#47;imac&#47;go&#47;bin:&zwnj;&#8203;&#47;Users&#47;imac&#47;go&#47;bin &#47;Users&#47;imac&#47;go</code>"}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483942697, "post_id": 41540455, "comment_id": 70288960, "body": "Can u execute <code>go run main.go</code> from ur main script location ?"}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483943280, "post_id": 41540455, "comment_id": 70289155, "body": "you can do <code>go build</code> or <code>go install</code> from the same path in terminal. Not sure about IDE part."}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483944364, "post_id": 41540455, "comment_id": 70289515, "body": "1. cd to the path where your main script is <code>cd &#47;path_to_main&#47;script</code>                      2. <code>go build main.go</code> : this will create binaries into the same current directory.                                                                                                              3. If you want to install it <code>go install main.go</code>."}], "tags": [], "owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "is_accepted": true, "score": 14, "last_activity_date": 1555980967, "last_edit_date": 1555980967, "creation_date": 1483931271, "answer_id": 41540455, "question_id": 41539909, "link": "https://stackoverflow.com/questions/41539909/cannot-find-package-github-com-gorilla-mux-in-any-of/41540455#41540455", "title": "cannot find package &quot;github.com/gorilla/mux&quot; in any of:", "body": "<p>Could you try this steps to debug it:</p>\n\n<ol>\n<li><code>ls -l /usr/local/go/src/github.com | grep gorilla</code></li>\n<li><p><code>cd $GOPATH</code></p>\n\n<p><code>go list ... | grep gorilla</code></p></li>\n<li><p>if you din't see gorilla in the above two command, then you need to install it:\n<code>go get -v -u github.com/gorilla/mux</code></p></li>\n</ol>\n\n<p>Please run this: <code>export PATH=$PATH:$GOPATH/bin</code></p>\n\n<p>How about running <code>go run main.go</code> ? is that working, if yes you should be able to do <code>go build</code> from your project path.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 4394954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4604fcb6843da829e6b969fb0225846?s=128&d=identicon&r=PG&f=1", "display_name": "No_20", "link": "https://stackoverflow.com/users/4394954/no-20"}, "reply_to_user": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483933079, "post_id": 41540554, "comment_id": 70286323, "body": "Can you find <code>github.com&#47;gorilla&#47;mux</code> in $GOPATH/pkg subdirectory.    If not. Try <code>go install github.com&#47;gorilla&#47;mux</code>."}, {"owner": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "edited": false, "score": 0, "creation_date": 1483934104, "post_id": 41540554, "comment_id": 70286539, "body": "I try this but not working... <code>github.com&#47;gorilla&#47;mux</code> is in <code>$GOPATH&#47;pkg&#47;darwin_amd64</code>."}], "tags": [], "owner": {"reputation": 71, "user_id": 4394954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4604fcb6843da829e6b969fb0225846?s=128&d=identicon&r=PG&f=1", "display_name": "No_20", "link": "https://stackoverflow.com/users/4394954/no-20"}, "is_accepted": false, "score": 3, "last_activity_date": 1483947645, "last_edit_date": 1483947645, "creation_date": 1483932183, "answer_id": 41540554, "question_id": 41539909, "link": "https://stackoverflow.com/questions/41539909/cannot-find-package-github-com-gorilla-mux-in-any-of/41540554#41540554", "title": "cannot find package &quot;github.com/gorilla/mux&quot; in any of:", "body": "<p>Just remove quotes like this:</p>\n\n<pre><code>go get github.com/gorilla/mux\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 241, "user_id": 5427367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56416b1e446e56c0c715732c918191c?s=128&d=identicon&r=PG&f=1", "display_name": "M-AbdalRahman", "link": "https://stackoverflow.com/users/5427367/m-abdalrahman"}, "is_accepted": false, "score": 0, "last_activity_date": 1483941824, "creation_date": 1483941824, "answer_id": 41541878, "question_id": 41539909, "link": "https://stackoverflow.com/questions/41539909/cannot-find-package-github-com-gorilla-mux-in-any-of/41541878#41541878", "title": "cannot find package &quot;github.com/gorilla/mux&quot; in any of:", "body": "<p>Try <code>go build /Users/imac/go/src/project</code> </p>\n\n<p>because  I see you try to use <code>go build</code> under <code>/Users/imac/go/src</code></p>\n"}, {"comments": [{"owner": {"reputation": 450, "user_id": 530728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZVIYj.jpg?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/530728/jan"}, "edited": false, "score": 1, "creation_date": 1553530579, "post_id": 51175238, "comment_id": 97409185, "body": "Solved my problem. Thanks."}], "tags": [], "owner": {"reputation": 696, "user_id": 8644572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3ca46005447073c39d14d15724f829d?s=128&d=identicon&r=PG", "display_name": "David Joos", "link": "https://stackoverflow.com/users/8644572/david-joos"}, "is_accepted": false, "score": 4, "last_activity_date": 1530712085, "creation_date": 1530712085, "answer_id": 51175238, "question_id": 41539909, "link": "https://stackoverflow.com/questions/41539909/cannot-find-package-github-com-gorilla-mux-in-any-of/51175238#51175238", "title": "cannot find package &quot;github.com/gorilla/mux&quot; in any of:", "body": "<p>If you are using <strong>VS Code</strong> as your IDE and facing this problem:</p>\n\n<p>VS Code uses <code>$HOME/go</code> as your default <code>GOPATH</code> - if you export another <code>GOPATH</code> you running into this trouble.</p>\n\n<p><strong>How to solve:</strong></p>\n\n<ol>\n<li>Use the VS Code internal terminal and navigate to your project folder: <code>cd prjectFolder</code>. Type <code>go env</code> and check if the <code>GOPATH</code> entry is the same as you get when you use <code>cmd+t</code> and then <code>&gt;Go: Current GOPATH</code></li>\n<li>If it doesn't fit, add in your user settings:\n<code>\n\"go.gopath\": \"/some/path\"\n</code>\nwhere <code>/some/path</code> is the same path you export in you shell, zsh and so on. </li>\n</ol>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 2942405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BBQkB.png?s=128&g=1", "display_name": "Mark Simon", "link": "https://stackoverflow.com/users/2942405/mark-simon"}, "is_accepted": false, "score": 2, "last_activity_date": 1539159951, "last_edit_date": 1539159951, "creation_date": 1539159496, "answer_id": 52735640, "question_id": 41539909, "link": "https://stackoverflow.com/questions/41539909/cannot-find-package-github-com-gorilla-mux-in-any-of/52735640#52735640", "title": "cannot find package &quot;github.com/gorilla/mux&quot; in any of:", "body": "<p>I try to remove <code>github.com/gorilla</code> and <code>github.com/peterbourgon</code> directory, then, retry: <code>make</code>, it works.</p>\n\n<p><a href=\"https://i.stack.imgur.com/i4bnt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i4bnt.png\" alt=\"enter image description here\"></a></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;pre&gt;\r\nfail log:\r\n\r\n\r\nmac@user:~/TempPlace/temp/ngrok% make\r\ngo fmt ngrok/...\r\ngo get github.com/jteeuwen/go-bindata\r\nGOOS=\"\" GOARCH=\"\" go install github.com/jteeuwen/go-bindata/go-bindata\r\nbin/go-bindata -nomemcopy -pkg=assets -tags=debug \\\r\n\t\t-debug=true \\\r\n\t\t-o=src/ngrok/client/assets/assets_debug.go \\\r\n\t\tassets/client/...\r\ngo get github.com/jteeuwen/go-bindata\r\nGOOS=\"\" GOARCH=\"\" go install github.com/jteeuwen/go-bindata/go-bindata\r\nbin/go-bindata -nomemcopy -pkg=assets -tags=debug \\\r\n\t\t-debug=true \\\r\n\t\t-o=src/ngrok/server/assets/assets_debug.go \\\r\n\t\tassets/server/...\r\ngo get -tags 'debug' -d -v ngrok/...\r\nsrc/ngrok/server/config.go:16:2: no Go files in /Users/apple/TempPlace/temp/ngrok/src/github.com/gorilla/mux\r\nsrc/ngrok/server/config.go:17:2: no Go files in /Users/apple/TempPlace/temp/ngrok/src/github.com/peterbourgon/diskv\r\nmake: *** [deps] Error 1\r\n\r\n\r\nsuccess log:\r\n\r\n\r\nmac@user:~/TempPlace/temp/ngrok% make\r\ngo fmt ngrok/...\r\ngo get github.com/jteeuwen/go-bindata\r\nGOOS=\"\" GOARCH=\"\" go install github.com/jteeuwen/go-bindata/go-bindata\r\nbin/go-bindata -nomemcopy -pkg=assets -tags=debug \\\r\n\t\t-debug=true \\\r\n\t\t-o=src/ngrok/client/assets/assets_debug.go \\\r\n\t\tassets/client/...\r\ngo get github.com/jteeuwen/go-bindata\r\nGOOS=\"\" GOARCH=\"\" go install github.com/jteeuwen/go-bindata/go-bindata\r\nbin/go-bindata -nomemcopy -pkg=assets -tags=debug \\\r\n\t\t-debug=true \\\r\n\t\t-o=src/ngrok/server/assets/assets_debug.go \\\r\n\t\tassets/server/...\r\ngo get -tags 'debug' -d -v ngrok/...\r\ngithub.com/gorilla/websocket (download)\r\ngithub.com/gorilla/mux (download)\r\nsrc/ngrok/server/config.go:17:2: no Go files in /Users/apple/TempPlace/temp/ngrok/src/github.com/peterbourgon/diskv\r\nmake: *** [deps] Error 1\r\nmac@user:~/TempPlace/temp/ngrok% make\r\ngo fmt ngrok/...\r\ngo get github.com/jteeuwen/go-bindata\r\nGOOS=\"\" GOARCH=\"\" go install github.com/jteeuwen/go-bindata/go-bindata\r\nbin/go-bindata -nomemcopy -pkg=assets -tags=debug \\\r\n\t\t-debug=true \\\r\n\t\t-o=src/ngrok/client/assets/assets_debug.go \\\r\n\t\tassets/client/...\r\ngo get github.com/jteeuwen/go-bindata\r\nGOOS=\"\" GOARCH=\"\" go install github.com/jteeuwen/go-bindata/go-bindata\r\nbin/go-bindata -nomemcopy -pkg=assets -tags=debug \\\r\n\t\t-debug=true \\\r\n\t\t-o=src/ngrok/server/assets/assets_debug.go \\\r\n\t\tassets/server/...\r\ngo get -tags 'debug' -d -v ngrok/...\r\ngithub.com/peterbourgon/diskv (download)\r\ngithub.com/google/btree (download)\r\ngo install -tags 'debug' ngrok/main/ngrok\r\ngo install -ldflags \"-s\" -tags 'debug' ngrok/main/ngrokd\r\n\r\n&lt;/pre&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 10823534, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Pm_4qOysLCo/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZ3Xw5dAMwMUCEE6GXUOC4khpJU3Q/mo/photo.jpg?sz=128", "display_name": "Rishabh", "link": "https://stackoverflow.com/users/10823534/rishabh"}, "edited": false, "score": 0, "creation_date": 1619193012, "post_id": 59915428, "comment_id": 118839637, "body": "Great, this works for me. The reason it wasn&#39;t working for me is that gorilla was being downloaded in the mod folder and not the src folder as expected."}], "tags": [], "owner": {"reputation": 131, "user_id": 4209207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dSvHy.png?s=128&g=1", "display_name": "August Gong", "link": "https://stackoverflow.com/users/4209207/august-gong"}, "is_accepted": false, "score": 1, "last_activity_date": 1580010791, "creation_date": 1580010791, "answer_id": 59915428, "question_id": 41539909, "link": "https://stackoverflow.com/questions/41539909/cannot-find-package-github-com-gorilla-mux-in-any-of/59915428#59915428", "title": "cannot find package &quot;github.com/gorilla/mux&quot; in any of:", "body": "<p>I wish this helpful.\nYou may off the 'mod'.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ export GO111MODULE=off\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29389, "favorite_count": 3, "accepted_answer_id": 41540455, "answer_count": 6, "score": 15, "last_activity_date": 1580010791, "creation_date": 1483926668, "last_edit_date": 1483932619, "question_id": 41539909, "link": "https://stackoverflow.com/questions/41539909/cannot-find-package-github-com-gorilla-mux-in-any-of", "title": "cannot find package &quot;github.com/gorilla/mux&quot; in any of:", "body": "<p>I use command <code>go get github.com/gorilla/mux</code>. I made http server using Golang, and I run this program : </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html\"\n    \"log\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n\n    router := mux.NewRouter().StrictSlash(true)\n    router.HandleFunc(\"/\", Index)\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n}\n\nfunc Index(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hello, %q\", html.EscapeString(r.URL.Path))\n</code></pre>\n\n<p>But I conflict this error : </p>\n\n<pre><code>/usr/local/go/bin/go build -i [/Users/imac/go/src]\nhttp.go:9:5: cannot find package \"github.com/gorilla/mux\" in any of:\n    /usr/local/go/src/github.com/gorilla/mux (from $GOROOT)\n    ($GOPATH not set)\nError: process exited with code 1.\n</code></pre>\n\n<p>My Go environment is here : </p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/imac/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/darwin_amd64\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/v9/fkc_t97s5v1g9sr938zzvxvh0000gn/T/go-build096571864=/tmp/go-build -gno-record-gcc-switches -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>I fight with this error for a week, But I can't find out solution. Please help me.</p>\n"}, {"tags": ["image", "go"], "comments": [{"owner": {"reputation": 3761, "user_id": 142020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vKJEv.png?s=128&g=1", "display_name": "T0xicCode", "link": "https://stackoverflow.com/users/142020/t0xiccode"}, "edited": false, "score": 0, "creation_date": 1483921268, "post_id": 41539276, "comment_id": 70284024, "body": "Have you looked at <a href=\"https://github.com/rakyll/statik\" rel=\"nofollow noreferrer\">github.com/rakyll/statik</a> or <a href=\"https://github.com/mjibson/esc\" rel=\"nofollow noreferrer\">github.com/mjibson/esc</a>? They compile assets into a source file, which gets compiled into the binary, and also provide an implementation of a <code>FileSystem</code> so that you can access these files as if they were on the actual filesystem."}], "answers": [{"comments": [{"owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "edited": false, "score": 0, "creation_date": 1483936095, "post_id": 41539425, "comment_id": 70287025, "body": "Actually, super impressed with ESC. Only took a few minutes to setup, and running perfectly"}, {"owner": {"reputation": 345, "user_id": 2675828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fac71269ae48603e95a37d43b04044c?s=128&d=identicon&r=PG", "display_name": "Patty P", "link": "https://stackoverflow.com/users/2675828/patty-p"}, "edited": false, "score": 0, "creation_date": 1484076196, "post_id": 41539425, "comment_id": 70358300, "body": "I&#39;ve used go-bindata for exactly this use case to package everything into a single binary to run on a docker base container. Good stuff!"}], "tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": true, "score": 3, "last_activity_date": 1483921549, "creation_date": 1483921549, "answer_id": 41539425, "question_id": 41539276, "link": "https://stackoverflow.com/questions/41539276/packing-multiple-images-into-a-golang-binary/41539425#41539425", "title": "Packing multiple images into a GOLANG binary", "body": "<p>You could use the same tools you used for HTML files... I'm assuming you used something like:</p>\n\n<ul>\n<li><a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">https://github.com/jteeuwen/go-bindata</a></li>\n<li><a href=\"https://github.com/GeertJohan/go.rice\" rel=\"nofollow noreferrer\">https://github.com/GeertJohan/go.rice</a></li>\n<li><a href=\"https://github.com/mjibson/esc\" rel=\"nofollow noreferrer\">https://github.com/mjibson/esc</a></li>\n<li><a href=\"https://github.com/rakyll/statik\" rel=\"nofollow noreferrer\">https://github.com/rakyll/statik</a></li>\n<li>etc.</li>\n</ul>\n\n<p>Which essentially transform your files in go source code and the expose an http.FileSystem-like API for reading your data.</p>\n"}], "owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 41539425, "answer_count": 1, "score": 0, "last_activity_date": 1483923918, "creation_date": 1483920157, "question_id": 41539276, "link": "https://stackoverflow.com/questions/41539276/packing-multiple-images-into-a-golang-binary", "title": "Packing multiple images into a GOLANG binary", "body": "<p>GOLANG gurus:</p>\n\n<p>I know this might seem illogical, but here it goes.</p>\n\n<p>I have to distribute a binary (which in this case would be a webserver) to other engineers for testing. To keep it simple, because they might not be developers, I wanted to see if there might be some automated way to pack images into a GOLANG binary ? I've done this static HTML pages in the past, and it works great.</p>\n\n<p>Obviously, at first run I could unzip to the file system, but to keep things clean I was trying to see if anyone has any thoughts how I could stuff them into a binary.</p>\n\n<p>Any Ideas ?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 37598, "user_id": 153407, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zoFYE.png?s=128&g=1", "display_name": "Dan McGrath", "link": "https://stackoverflow.com/users/153407/dan-mcgrath"}, "edited": false, "score": 0, "creation_date": 1483910690, "post_id": 41536786, "comment_id": 70281317, "body": "Can you rephrase or clarify your question? There&#39;s a lot of ancillary information in there and I&#39;ve found it hard to determine precisely what your looking for?"}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 37598, "user_id": 153407, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zoFYE.png?s=128&g=1", "display_name": "Dan McGrath", "link": "https://stackoverflow.com/users/153407/dan-mcgrath"}, "edited": false, "score": 0, "creation_date": 1483911416, "post_id": 41536786, "comment_id": 70281564, "body": "Not even if you eliminate everything but the title and the question in bold?"}, {"owner": {"reputation": 37598, "user_id": 153407, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zoFYE.png?s=128&g=1", "display_name": "Dan McGrath", "link": "https://stackoverflow.com/users/153407/dan-mcgrath"}, "edited": false, "score": 0, "creation_date": 1483977476, "post_id": 41536786, "comment_id": 70308935, "body": "not really. What are you trying to achieve and why do they need to be globally unique (rather than the current auto id which ensures the whole key is unique, just not the ID by itself)?. Generally GUIDs are used because you don&#39;t need to preallocate (and you can&#39;t really) - given this - are you really concerned about auto allocated ID collisions? In otherwords - why are you concerned about using your own IDs <i>AND</i> auto ids - you probably shouldn&#39;t use both at the same time."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 6833150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8db93b2a96131203123db885b3e4e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Melcon", "link": "https://stackoverflow.com/users/6833150/joshua-melcon"}, "is_accepted": false, "score": 0, "last_activity_date": 1483911043, "last_edit_date": 1483911043, "creation_date": 1483910719, "answer_id": 41538068, "question_id": 41536786, "link": "https://stackoverflow.com/questions/41536786/appengine-datastore-preallocating-normally-distributed-ids-not-monotonicall/41538068#41538068", "title": "AppEngine, DataStore: Preallocating normally-distributed IDs (*not* monotonically incrementing)", "body": "<p>The simple solution is to do the following:</p>\n\n<p>When trying to allocate a new ID for an entity:</p>\n\n<p>Repeat the following: </p>\n\n<ul>\n<li>Generate a random <em>K</em> bit integer. Use it for the entity ID field. <em>[Use a uniform random distribution]</em>.</li>\n<li>Create a Cloud Datastore transaction. </li>\n<li>Insert the new entity.  <em>[If the transaction aborts because the entity already exists try again with a new random number]</em>.</li>\n</ul>\n\n<p>If you make <em>K</em> big enough (for example 128) and have a properly seeded random number generator, then it is statistically impossible to generate an ID collision and you can remove the retry loop. </p>\n\n<p>If you make <em>K</em> big enough stop using the integer id field in the entity key and instead use the string one.  Base64 URL encode random number as a string. </p>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1483911043, "creation_date": 1483903273, "last_edit_date": 1483910700, "question_id": 41536786, "link": "https://stackoverflow.com/questions/41536786/appengine-datastore-preallocating-normally-distributed-ids-not-monotonicall", "title": "AppEngine, DataStore: Preallocating normally-distributed IDs (*not* monotonically incrementing)", "body": "<p>There are three schemes to set IDs on datastore entities:</p>\n\n<ol>\n<li>Provide your own string or <code>int64</code> ID.</li>\n<li>Don't provide them and let AE allocate <code>int64</code> IDs for you.</li>\n<li>Pre-allocate a block of <code>int64</code> IDs.</li>\n</ol>\n\n<p>The <a href=\"https://cloud.google.com/appengine/docs/go/datastore/entities\" rel=\"nofollow noreferrer\">documentation</a> has this to say about ID generation:</p>\n\n<p>This (1):</p>\n\n<blockquote>\n  <p>Cloud Datastore can be configured to generate auto IDs using two\n  different auto id policies:</p>\n  \n  <ol>\n  <li><p>The default policy generates a random sequence of unused IDs that are approximately uniformly distributed. Each ID can be up to 16\n  decimal digits long.</p></li>\n  <li><p>The legacy policy creates a sequence of non-consecutive smaller integer IDs.</p></li>\n  </ol>\n  \n  <p>If you want to display the entity IDs to the user, and/or depend upon\n  their order, the best thing to do is use manual allocation.</p>\n</blockquote>\n\n<p>and this (2):</p>\n\n<blockquote>\n  <p>Note: Instead of using key name strings or generating numeric IDs\n  automatically, advanced applications may sometimes wish to assign\n  their own numeric IDs manually to the entities they create. Be aware,\n  however, that there is nothing to prevent Cloud Datastore from\n  assigning one of your manual numeric IDs to another entity. The only\n  way to avoid such conflicts is to have your application obtain a block\n  of IDs with the datastore.AllocateIDs function. Cloud Datastore's\n  automatic ID generator will keep track of IDs that have been allocated\n  with this function and will avoid reusing them for another entity, so\n  you can safely use such IDs without conflict.</p>\n</blockquote>\n\n<p>and this (3):</p>\n\n<blockquote>\n  <p>Cloud Datastore generates a random sequence of unused IDs that are\n  approximately uniformly distributed. Each ID can be up to 16 decimal\n  digits long.</p>\n  \n  <p>System-allocated ID values are guaranteed unique to the entity group.\n  If you copy an entity from one entity group or namespace to another\n  and wish to preserve the ID part of the key, be sure to allocate the\n  ID first to prevent Cloud Datastore from selecting that ID for a\n  future assignment.</p>\n</blockquote>\n\n<p>I have a particular entity-type that is stored with an ancestor. However, I'd like to have globally-unique IDs and AE's IDs (allocated via <em>datastore.AllocateIDs</em> with Go) will not be globally unique when stored under an ancestor (in an entity-group). So, pre-allocation would solve this (they're ancestor-agnostic). However, you are obviously given an interval in response... a continuous range of IDs that have been reserved.</p>\n\n<p><strong>Isn't there some way to preallocate those nice, opaque, uniformally-distributed IDs?</strong></p>\n\n<p>While we're on the subject, I had assumed that the opaque IDs from AE were the result of some pseudorandom number generator with a persisted-state for each entity-type, but the word \"track\" in (2) seems to imply that there is a cost to optimistically generating and buffering IDs that might not be used. It's be great if someone can clarify this.</p>\n"}, {"tags": ["json", "go", "struct", "unmarshalling"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1483901511, "post_id": 41536383, "comment_id": 70278169, "body": "Your tags are completely wrong. If the JSON field name matches the fieldname of your struct there is no need for a tag. And what should <code>&quot;environment:mode&quot;</code> do? why the &quot;environment:&quot;? Just drop all your tags, read the documentation and the examples once more."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 619703, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c671aa3843418207daa4907a4da08e73?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/619703/ben"}, "edited": false, "score": 1, "creation_date": 1483903908, "post_id": 41536520, "comment_id": 70279015, "body": "Thanks! :D That saved my sanity"}], "tags": [], "owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "is_accepted": true, "score": 5, "last_activity_date": 1483938662, "last_edit_date": 1483938662, "creation_date": 1483901632, "answer_id": 41536520, "question_id": 41536383, "link": "https://stackoverflow.com/questions/41536383/go-json-unmarshal-returns-false-struct/41536520#41536520", "title": "Go json.Unmarshal returns false struct", "body": "<p>Can you try by changing like this:</p>\n\n<pre><code>type App struct {\n    Name string `json:\"name\"`\n}\n\ntype Database struct {\n    Type     string `json:\"type\"`\n    Name     string `json:\"name\"`\n    User     string `json:\"user\"`\n    Password string `json:\"password\"`\n}\n\ntype Environment struct {\n    Mode  string `json:\"mode\"`\n    Debug bool   `json:\"debug\"`\n}\n</code></pre>\n\n<p>Here is the output:</p>\n\n<pre><code>{{development true} {My_Project} {postgres my_project_db_name my_project_db_user secret}}\n</code></pre>\n\n<p>Here is a little docs for handy reference:</p>\n\n<pre><code>// Field is ignored by this package.\nField int `json:\"-\"`\n\n// Field appears in JSON as key \"myName\".\nField int `json:\"myName\"`\n\n// Field appears in JSON as key \"myName\" and\n// the field is omitted from the object if its value is empty,\n// as defined above.\nField int `json:\"myName,omitempty\"`\n\n// Field appears in JSON as key \"Field\" (the default), but\n// the field is skipped if empty.\n// Note the leading comma.\nField int `json:\",omitempty\"`\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 619703, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c671aa3843418207daa4907a4da08e73?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/619703/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1155, "favorite_count": 0, "accepted_answer_id": 41536520, "answer_count": 1, "score": 0, "last_activity_date": 1483938662, "creation_date": 1483900841, "question_id": 41536383, "link": "https://stackoverflow.com/questions/41536383/go-json-unmarshal-returns-false-struct", "title": "Go json.Unmarshal returns false struct", "body": "<p>Golang newbie here</p>\n\n<p>I'm trying to parse from a .json file (in the same directory as the Go code) into a struct holding other structs and the closest I can get to success is a struct containing boolean false, which sounds broken to me.</p>\n\n<p>Here's what I have in my Go code so far</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n\n    \"io/ioutil\"\n)\n\ntype App struct {\n    Name string `json:\"app:name\"`\n}\n\ntype Database struct {\n    Type     string `json:\"database:type\"`\n    Name     string `json:\"database:name\"`\n    User     string `json:\"database:user\"`\n    Password string `json:\"database:password\"`\n}\n\ntype Environment struct {\n    Mode  string `json:\"environment:mode\"`\n    Debug bool   `json:\"environment:debug\"`\n}\n\ntype Config struct {\n    Environment Environment\n    App         App\n    Database    Database\n}\n\nfunc main() {\n    config, err := ioutil.ReadFile(\"config.json\")\n    if err != nil {\n        fmt.Errorf(\"Error reading config file: %s\", err)\n    }\n\n    var appSettings Config\n    json.Unmarshal(config, &amp;appSettings)\n\n    fmt.Print(appSettings)\n}\n</code></pre>\n\n<p>and here's the contents of my .json file</p>\n\n<pre><code>{\n  \"App\": {\n    \"Name\": \"My_Project\"\n  },\n  \"Database\": {\n    \"Type\": \"postgres\",\n    \"Name\": \"my_project_db_name\",\n    \"User\": \"my_project_db_user\",\n    \"Password\": \"secret\"\n  },\n  \"Environment\": {\n    \"Mode\": \"development\",\n    \"Debug\": true\n  }\n}\n</code></pre>\n\n<p>EDIT:\nHere's the result of the print at the end of <code>main()</code></p>\n\n<p><code>{{ false} {} {   }}</code></p>\n\n<p>I have already validated the json content which is fine. The struct names and properties are being exported. Can you see what I'm doing wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 1, "creation_date": 1483896453, "post_id": 41535292, "comment_id": 70276137, "body": "Do you have your gopath setup? <a href=\"https://github.com/golang/go/wiki/GOPATH\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/GOPATH</a>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1483904263, "post_id": 41535292, "comment_id": 70279128, "body": "shell-basic is just an example of how you could script automated tasks using go. As a package (ie <code>go get goroutines.com&#47;shell-basic</code>), it is really pointless."}], "answers": [{"comments": [{"owner": {"reputation": 12424, "user_id": 345859, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cdb711788e4473ecd856108533787144?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/345859/jas"}, "edited": false, "score": 0, "creation_date": 1483946671, "post_id": 41535674, "comment_id": 70290425, "body": "many thanks, this indeed worked.  I see that <code>$GOPATH&#47;bin&#47;shell-basic</code> is a binary.  So i don&#39;t understand what is <code>http:&#47;&#47;goroutines.com&#47;shell</code> it says: <code>Write Shell Scripts in Go</code> but we have just created a <code>binary</code> as i understand a <code>script</code> is something which is not compiled, its just a script, so why does it claim it&#39;s possible to write shell scripts in <code>go</code>?"}], "tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": true, "score": 1, "last_activity_date": 1483897060, "creation_date": 1483897060, "answer_id": 41535674, "question_id": 41535292, "link": "https://stackoverflow.com/questions/41535292/go-newbie-how-to-run-goroutines-shell/41535674#41535674", "title": "Go newbie: how to run goroutines shell?", "body": "<p><code>go get</code> will fetch the source and put it in your <strong>Go path</strong>, try <code>echo $GOPATH</code> in the shell. This is what happens if <code>go get</code> finishes silently.</p>\n\n<p>Then you want to go to that source:</p>\n\n<blockquote>\n  <p><code>cd $GOPATH/src/goroutines.com/shell-basic</code></p>\n</blockquote>\n\n<p><strong>aftwards</strong>, you must <strong>run</strong> <code>go install</code> inside the repo. (or you can run <code>go install /path/to/the/code</code>.</p>\n\n<p>The source will then be put in <code>$GOPATH/bin</code>, and be executable.</p>\n\n<p>Of course none of this will work if you don't have you <code>GOPATH</code> set up.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 4394954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4604fcb6843da829e6b969fb0225846?s=128&d=identicon&r=PG&f=1", "display_name": "No_20", "link": "https://stackoverflow.com/users/4394954/no-20"}, "is_accepted": false, "score": 0, "last_activity_date": 1483933335, "creation_date": 1483933335, "answer_id": 41540716, "question_id": 41535292, "link": "https://stackoverflow.com/questions/41535292/go-newbie-how-to-run-goroutines-shell/41540716#41540716", "title": "Go newbie: how to run goroutines shell?", "body": "<p>I think you not set <code>GOBIN</code>.</p>\n\n<p>You can follow\uff1a</p>\n\n<pre><code>export PATH=$PATH:$GOPATH/bin\n</code></pre>\n\n<p>Or, try run <code>$GOPATH/bin/shell-basic</code>.Use your gopath replace <code>$GOPATH</code>.</p>\n"}], "owner": {"reputation": 12424, "user_id": 345859, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cdb711788e4473ecd856108533787144?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/345859/jas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 41535674, "answer_count": 2, "score": -2, "last_activity_date": 1483933335, "creation_date": 1483894930, "question_id": 41535292, "link": "https://stackoverflow.com/questions/41535292/go-newbie-how-to-run-goroutines-shell", "title": "Go newbie: how to run goroutines shell?", "body": "<p>I tried running <a href=\"http://goroutines.com/shell\" rel=\"nofollow noreferrer\"><code>shell-basic</code></a> but nothing happens.  Here is what I tried:</p>\n\n<blockquote>\n  <p>To run this example, download and install it with go get:</p>\n</blockquote>\n\n<pre><code>go get goroutines.com/shell-basic\n</code></pre>\n\n<p>which finishes silently and I see it downloaded the shell basic script but when i execute <code>shell-basic</code> i get:</p>\n\n<pre><code>$ shell-basic\n-bash: shell-basic: command not found\n</code></pre>\n\n<p>did I do something wrong, or am i missing something?</p>\n\n<p>what i'm interested in is running <code>go</code> as <code>scripts</code>..  </p>\n"}, {"tags": ["go", "go-templates", "template-variables"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483899615, "post_id": 41534192, "comment_id": 70277454, "body": "You can not use it like $.$ID, it wount evaluate it as you expected . You might have to struture it differently"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483901121, "post_id": 41534192, "comment_id": 70278028, "body": "You my use a global map and use ID as key"}, {"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "edited": false, "score": 0, "creation_date": 1483915744, "post_id": 41534192, "comment_id": 70282784, "body": "@Acidic, please add the line of code showing how you Execute(...) the template."}], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1483942718, "post_id": 41538828, "comment_id": 70288968, "body": "Yes I&#39;ve managed to do this, but my problem is, I need to add some data to each issue in the []issue but I cannot change the issue struct type. So for example, you have issue.author = &quot;Pepe&quot;, what if I need to add a new piece of information to each issue, that&#39;s what I&#39;m having trouble with."}, {"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1483999443, "post_id": 41538828, "comment_id": 70320876, "body": "If you need to add statically known data to each item (issue), the most idiomatic and straightforward way would be to simply define a new Issue struct, say &quot;RichIssue&quot; which can contain all data you would like to expose to templates and then transforming the []Issue to []RichIssue and using the result for executing the template against it."}, {"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1483999655, "post_id": 41538828, "comment_id": 70320968, "body": "If you need to add dynamic data you should add a map[string]interface{} member to RichIssue so when you transform the Issue to RichIssue you can add the extra data to that member (I would try to avoid this for all statically known data to be exposed)."}, {"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1484074190, "post_id": 41538828, "comment_id": 70357111, "body": "@Acidic have you got a chance to see my updated answer?"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 1, "creation_date": 1484118222, "post_id": 41538828, "comment_id": 70373344, "body": "Yes I saw it but it wasn&#39;t quite the answer I was looking for. My question was just really complicated and I&#39;m faily sure what I was attempting was impossible. I managed to find another solution instead but I appreciate the answer. :)"}], "tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": true, "score": 0, "last_activity_date": 1484001373, "last_edit_date": 1484001373, "creation_date": 1483916440, "answer_id": 41538828, "question_id": 41534192, "link": "https://stackoverflow.com/questions/41534192/golang-template-use-template-variable-as-global-variable-from-within-range-loo/41538828#41538828", "title": "Golang Template - Use Template Variable As Global Variable From Within Range Loop", "body": "<p>You should simply make a map[string]interface{} containing the issues array and then use that as the template execution data.</p>\n\n<p>Then you can loop over the issues and directly access its' members from the template.</p>\n\n<p>Here's a small complete example:</p>\n\n<pre><code>const t = `\n{{ range .issues }}\nissue: {{ .ID }}\n    author: {{ .Author }}\n{{ end }}\n`\n\ntype Issue struct {\n    ID     int\n    Author string\n}\n\nfunc main() {\n    issues := []Issue{{1, \"Pepe\"}, {2, \"Cholo\"}}\n    data := map[string]interface{}{\"issues\": issues}\n    tpl := template.Must(template.New(\"bla\").Parse(t))\n    tpl.Execute(os.Stdout, data)\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>issue: 1\n        author: Pepe\n\nissue: 2\n        author: Cholo\n</code></pre>\n\n<p>Additionally if you want/need to add data specific to the template rendering process you should define a \"rich\" issue struct for this purpose and transform your model before passing it to template execution. This could be done for both statically known extra data (as simple members of RichIssue) and for dynamically loaded data (as key/values of a map).</p>\n\n<p>Here's an extended example showing the above suggestions:</p>\n\n<pre><code>const t = `\n{{ range .issues }}\nissue: {{ .ID }}\n    author: {{ .Author }}\n    static1: {{ .Static1 }}\n    dyn1: {{ .Data.dyn1 }}\n{{ end }}\n`\n\ntype Issue struct {\n    ID     int\n    Author string\n}\n\ntype RichIssue struct {\n    Issue\n    Static1 string                 // some statically known additional data for rendering\n    Data    map[string]interface{} // container for dynamic data (if needed)\n}\n\nfunc GetIssueStatic1(i Issue) string {\n    return strconv.Itoa(i.ID) + i.Author // whatever\n}\n\nfunc GetIssueDyn1(i Issue) string {\n    return strconv.Itoa(len(i.Author)) // whatever\n}\n\nfunc EnrichIssue(issue Issue) RichIssue {\n    return RichIssue{\n        Issue:   issue,\n        Static1: GetIssueStatic1(issue),\n        // in this contrived example I build \"dynamic\" members from static\n        // hardcoded strings but these fields (names and data) should come from\n        // some kind of configuration or query result to be actually dynamic\n        // (and justify being set in a map instead of being simple static\n        // members as Static1)\n        Data: map[string]interface{}{\n            \"dyn1\": GetIssueDyn1(issue),\n            \"dyn2\": 2,\n            \"dyn3\": \"blabla\",\n        },\n    }\n}\n\nfunc EnrichIssues(issues []Issue) []RichIssue {\n    r := make([]RichIssue, len(issues))\n    for i, issue := range issues {\n        r[i] = EnrichIssue(issue)\n    }\n    return r\n}\n\nfunc main() {\n    issues := []Issue{{1, \"Pepe\"}, {2, \"Cholo\"}}\n    data := map[string]interface{}{\"issues\": EnrichIssues(issues)}\n    tpl := template.Must(template.New(\"bla\").Parse(t))\n    tpl.Execute(os.Stdout, data)\n}\n</code></pre>\n\n<p>Which produces the following output:</p>\n\n<pre><code>issue: 1\n    author: Pepe\n    static1: 1Pepe\n    dyn1: 4\n\nissue: 2\n    author: Cholo\n    static1: 2Cholo\n    dyn1: 5\n</code></pre>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1668, "favorite_count": 0, "accepted_answer_id": 41538828, "answer_count": 1, "score": 0, "last_activity_date": 1484001373, "creation_date": 1483888384, "question_id": 41534192, "link": "https://stackoverflow.com/questions/41534192/golang-template-use-template-variable-as-global-variable-from-within-range-loo", "title": "Golang Template - Use Template Variable As Global Variable From Within Range Loop", "body": "<p>I will try to make this as simple as possible.\nI have two variables in Golang which are parsed to the template file.</p>\n\n<p>Here is my Golang code which declares the variables:</p>\n\n<pre><code>for _, issue := range issues {\n    issueIDStr := strconv.Itoa(*issue.ID)\n    parse[*issue.ID] = issueIDStr \n    parse[issueIDStr+\"-label\"] = \"blah blah\"\n}\n</code></pre>\n\n<p>Then in my HTML file:</p>\n\n<pre><code>{{ range .issues }}\n    &lt;!-- Here I want to use the current issue's ID as a global variable which is outside the range loop --&gt;\n    &lt;!-- According to the Golang doc which says the following:\n             When execution begins, $ is set to the data argument passed to Execute, that is, to the starting value of dot.\n         I can use $.Something to access a variable outside my range loop right...\n         but how can I use a template variable as a global variable? I tried the following which doesn't work.\n    {{ $ID := .ID }}\n    &lt;p&gt;{{ index $.$ID \"author\" }}&lt;/p&gt;\n{{ end }}\n</code></pre>\n\n<p>After running this code, I get the error: <code>bad character U+0024 '$'</code> along with a panic thrown.</p>\n\n<p>Is what I am attempting completely impossible currently, or is there some trick I am missing?</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "edited": false, "score": 0, "creation_date": 1483888462, "post_id": 41533906, "comment_id": 70273433, "body": "This may help - <a href=\"http://stackoverflow.com/questions/15049903/how-to-use-custom-packages-in-golang\" title=\"how to use custom packages in golang\">stackoverflow.com/questions/15049903/&hellip;</a>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1483904429, "post_id": 41533906, "comment_id": 70279188, "body": "don t use relative import paths, use ~~ <code>absolute_path_to_module.substr(len($GOPATH&#47;src))</code> as your import path. May <a href=\"https://github.com/mh-cbon/go-get-started\" rel=\"nofollow noreferrer\">this</a> helps somehow as its not based on windows."}], "answers": [{"tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 3, "last_activity_date": 1483887340, "creation_date": 1483887340, "answer_id": 41534022, "question_id": 41533906, "link": "https://stackoverflow.com/questions/41533906/how-do-you-import-relative-module-paths-in-windows-for-golang/41534022#41534022", "title": "How do you import relative module paths in windows for golang?", "body": "<blockquote>\n  <p>How do you import relative module paths in windows for golang?</p>\n</blockquote>\n\n<p>The simplest answer is don't use relative paths. These will cause you trouble in the long run and are frowned upon in general.  The are only used is very special cases normally.</p>\n\n<blockquote>\n  <p>How do I write multi-module applications with Go on windows?</p>\n</blockquote>\n\n<p>You need to set your <a href=\"https://github.com/golang/go/wiki/GOPATH\" rel=\"nofollow noreferrer\">GOPATH</a> if you are writing multi module projects.</p>\n\n<p>It seems like a pain at first, but it will enable your code to be <code>go get</code>-able if you want.</p>\n\n<p>You can't use quite a few features of Go unless you are working in a GOPATH (like vendoring).</p>\n"}], "owner": {"reputation": 7671, "user_id": 515279, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c5ea3b30be6f62c5a96ccb58320e7f1f?s=128&d=identicon&r=PG", "display_name": "jz87", "link": "https://stackoverflow.com/users/515279/jz87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483887340, "creation_date": 1483886670, "question_id": 41533906, "link": "https://stackoverflow.com/questions/41533906/how-do-you-import-relative-module-paths-in-windows-for-golang", "title": "How do you import relative module paths in windows for golang?", "body": "<p>I'm trying to write a webapp with Go/App Engine and I'm using windows for my dev machine. When I try to break my app into modules (main, models, ...), and try to use relative path imports like</p>\n\n<pre><code>import './models'\n</code></pre>\n\n<p>I get an error saying that ':' is an illegal character in path. Windows uses Drive:\\Path syntax for path, and the golang team seem to have refused to add ':' to the set of allowed characters in go path.</p>\n\n<p>How do I write multi-module applications with Go on windows?</p>\n"}, {"tags": ["go", "structure", "organization"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1483885417, "post_id": 41533693, "comment_id": 70272416, "body": "What is defined in <code>config.go</code>? Does it really warrant its own package? Could you not just have unexported  config types/functions/variables in your <code>github.com&#47;myusername&#47;project</code> package?"}, {"owner": {"reputation": 6320, "user_id": 1870253, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/322c901287818397bee1fea580bc3bd1?s=128&d=identicon&r=PG", "display_name": "sge", "link": "https://stackoverflow.com/users/1870253/sge"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1483885677, "post_id": 41533693, "comment_id": 70272506, "body": "Isn&#39;t that possible with all functionality provided by packages? But yes, in this example i could just put the two functions and the config type into the <code>project</code> package. I&#39;m actually more interested in the general idea of when to use internal packages, or if I should do so at all. Furthermore, is there any disavantage in creating tiny packages?"}, {"owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "edited": false, "score": 1, "creation_date": 1483889105, "post_id": 41533693, "comment_id": 70273657, "body": "Barely any Go project has an <code>internal</code> package. If you aren&#39;t sure put <code>config</code> in your root and document your project well so users know they should not or must not use it. I personally think it&#39;s better not to think what to put where, but just write everything in one place and extract to a package/module whenever it makes sense."}, {"owner": {"reputation": 6320, "user_id": 1870253, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/322c901287818397bee1fea580bc3bd1?s=128&d=identicon&r=PG", "display_name": "sge", "link": "https://stackoverflow.com/users/1870253/sge"}, "edited": false, "score": 0, "creation_date": 1483890500, "post_id": 41533693, "comment_id": 70274142, "body": "So i should probably rephrase my question: Should I only use packages if the code is reusable project independent and just put everything into the <code>main</code> package otherwise?"}], "answers": [{"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1483920965, "creation_date": 1483920965, "answer_id": 41539368, "question_id": 41533693, "link": "https://stackoverflow.com/questions/41533693/proper-folder-structure-for-go-packages-used-by-a-single-go-project/41539368#41539368", "title": "Proper folder structure for go packages used by a single go project", "body": "<p>If your project produces one single program then the most common structure is the one you mentioned.</p>\n\n<p>If your project produces more than one program the common practice is using a structure like this:</p>\n\n<pre><code>&lt;project&gt;/\n  cmd/\n    prog1/\n      main.go\n    prog2/\n      main.go\n</code></pre>\n\n<p>If your project exposes go code as library for third party consumption the most common structure is using the project's root dir to expose the domain model and API.</p>\n\n<pre><code>&lt;project&gt;/\n  model.go\n  api.go\n</code></pre>\n\n<p>This is for third party code to just import \"github.com/user/project\"  and have the model and api available.</p>\n\n<p>Is common to see second and third options combined.</p>\n\n<p>Also is considered good practice to have packages for encapsulating dependencies usage. E.g. suppose your project uses the elastic search client</p>\n\n<pre><code>&lt;project&gt;/\n  cmd/\n    prog1/\n      main.go\n  elastic/\n    impl.go\n  dao.go\n  model.go\n</code></pre>\n\n<p>So in dao.go you define the dao's API and then in elastic/impl.go you (import elastic library, domain modal and) define the implementation of DAO in terms of elastic. Finally you import everything from main.go which produces the actual program.</p>\n\n<p>See <a href=\"https://codeandtalk.com/v/gophercon-denver-2016/gophercon-2016-lightning-talk-ben-johnson\" rel=\"nofollow noreferrer\">this</a> great and short presentation about this issue.</p>\n"}], "owner": {"reputation": 6320, "user_id": 1870253, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/322c901287818397bee1fea580bc3bd1?s=128&d=identicon&r=PG", "display_name": "sge", "link": "https://stackoverflow.com/users/1870253/sge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 448, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483920965, "creation_date": 1483885314, "question_id": 41533693, "link": "https://stackoverflow.com/questions/41533693/proper-folder-structure-for-go-packages-used-by-a-single-go-project", "title": "Proper folder structure for go packages used by a single go project", "body": "<p>I am currently starting with Go and have already dug into the dos and don'ts regarding package naming and workspace folder structure.</p>\n\n<p>Nevertheless, I am not quite sure how to properly organize my code according to the Go paradigm.</p>\n\n<p>Here is my current structure example as it resides in <code>$GOPATH/src</code>:</p>\n\n<pre><code>github.com/myusername/project\n|-- main.go\n+-- internal\n+---- config\n|------ config.go\n</code></pre>\n\n<p>So i have the project called <code>project</code> which uses the <code>config</code> package which, in turn, is specialized in a way that it should only be used by <code>project</code>. Hence, I do not want it under <code>github.com/myusername/config</code>, right?</p>\n\n<p>The question now is, is it \"good\" to use the internal package structure or should I instead put my project specific packages under <code>github.com/myusername/$pkgname</code> and indicate somehow that it belongs to <code>project</code> (e.g. name it <code>projectconfig</code>)?</p>\n"}, {"tags": ["go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 862, "user_id": 4780378, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/952ea857b33c627ee944e6e34871d211?s=128&d=identicon&r=PG&f=1", "display_name": "DevAndroid", "link": "https://stackoverflow.com/users/4780378/devandroid"}, "edited": false, "score": 0, "creation_date": 1546099305, "post_id": 41534579, "comment_id": 94779690, "body": "got a unrecognized pipeline stage name $inc... Which driver mongo were you using ?"}], "tags": [], "owner": {"reputation": 1358, "user_id": 5275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8bbb1e2df58ceebc9bbb5596bf823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Kishore", "link": "https://stackoverflow.com/users/5275376/shiva-kishore"}, "is_accepted": true, "score": 1, "last_activity_date": 1483890873, "creation_date": 1483890873, "answer_id": 41534579, "question_id": 41533245, "link": "https://stackoverflow.com/questions/41533245/mgo-inc-update-not-working/41534579#41534579", "title": "mgo $inc update not working", "body": "<p>I found the answer, \nso even though the model had 'Views'. In the collection it was 'views' so it kept incrementing the 'Views', which never showed up because golang was looking for 'views'.</p>\n\n<p>so the working code is</p>\n\n<p><code>change := bson.M{\"$inc\": bson.M{\"views\": 1}}</code></p>\n"}], "owner": {"reputation": 1358, "user_id": 5275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8bbb1e2df58ceebc9bbb5596bf823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Kishore", "link": "https://stackoverflow.com/users/5275376/shiva-kishore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1095, "favorite_count": 0, "accepted_answer_id": 41534579, "answer_count": 1, "score": 2, "last_activity_date": 1483890873, "creation_date": 1483882355, "question_id": 41533245, "link": "https://stackoverflow.com/questions/41533245/mgo-inc-update-not-working", "title": "mgo $inc update not working", "body": "<p>Am trying to update the view count each time a particular blog is visited</p>\n\n<pre><code>type Blog struct {\n    ID          bson.ObjectId `bson:\"_id,omitempty\"`\n    Topic       string\n    TimeCreated string\n    Views       int\n    Sections    []Section\n}\ntype Section struct {\n    Name    string\n    Content string\n}\n</code></pre>\n\n<p>and contoller</p>\n\n<pre><code>func Blogs(w http.ResponseWriter, r *http.Request) {\n    id := r.FormValue(\"id\")\n    if id != \"\" {\n        blog := model.Blog{}\n        colQuerier := bson.M{\"_id\": bson.ObjectIdHex(id)}\n\n        e := mCollection.Find(colQuerier).One(&amp;blog)\n        if e != nil {\n            console.PrintError(e)\n            return\n        }\n        views := blog.Views\n        fmt.Println(views)\n        change := bson.M{\"$inc\": bson.M{\"Views\": 1}}\n\n        e = mCollection.Update(colQuerier, change)\n        if e != nil {\n            console.PrintError(e)\n        }\n\n        jsonData, _ := json.Marshal(blog)\n        fmt.Fprintf(w, string(jsonData))\n     }\n}\n</code></pre>\n\n<p>//console is an internal package</p>\n\n<p>the code fetches the content but doesn't increment the Views</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1483874223, "post_id": 41531838, "comment_id": 70269276, "body": "Also related / possible duplicate of <a href=\"http://stackoverflow.com/questions/31932822/why-should-constructor-of-go-return-address/31934189#31934189\">Why should constructor of Go return address?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1483874403, "post_id": 41532036, "comment_id": 70269328, "body": "Passing around pointers make them escape to the heap. For small structs that can be inexpensively passed around (pass by value) in the stack, this could over time build unnecessary GC pressure. It&#39;s always a tradeoff."}], "tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1483874116, "last_edit_date": 1483874116, "creation_date": 1483873705, "answer_id": 41532036, "question_id": 41531838, "link": "https://stackoverflow.com/questions/41531838/when-to-use-pointer-in-methods-and-return-pointers-to-structs/41532036#41532036", "title": "When to use pointer in methods and return pointers to structs?", "body": "<p>This is one think cool about go, that we can use pointer to save memory usage. </p>\n\n<p>from my case I use pointers whenever I get the data from database and  wanted to change something from it. therefor I use pointer to save memory usage.</p>\n\n<p>example : </p>\n\n<pre><code>func GetUserShopInfo(w http.ResponseWriter, r *http.Request, params httprouter.Params) {\n    //....\n    shop_data, err := shop.GetUserShopInfo(user_id)\n    // manipulate shop_data \n    shop.ChangeValue(&amp;shop_data)\n    // you will get the result here without creating new variable\n\n}\n</code></pre>\n\n<p>And then I use pointer whenever I want to share the value, and changing them without having to create new variable to get the result.</p>\n\n<p>example : </p>\n\n<pre><code>func main(){\n    a := 10\n    ChangeValue(&amp;a)\n    // a will change here\n}    \n\n\nfunc ChangeValue(a *int){\n   // do something to a\n}\n</code></pre>\n\n<p>the same thing about struct. I used pointer so that I can pass and modify value in variable </p>\n\n<p>example : </p>\n\n<pre><code>type Student struct {\n    Human\n    Schoool string\n    Loan    float32\n}\n\n// use pointer so that we can modify the Loan value from previous\nfunc (s *Student) BorrowMoney(amount float32) {\n    s.Loan += amount\n}\n</code></pre>\n\n<p>In conclusion I used pointer in every cases whenever I feel like to share the value.</p>\n"}], "owner": {"reputation": 445, "user_id": 6929224, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8afbfc37b02501e3143696a1b8407c79?s=128&d=identicon&r=PG&f=1", "display_name": "HorusCoding", "link": "https://stackoverflow.com/users/6929224/horuscoding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 693, "favorite_count": 0, "closed_date": 1483874155, "answer_count": 1, "score": 1, "last_activity_date": 1483874116, "creation_date": 1483872324, "last_edit_date": 1483872666, "question_id": 41531838, "link": "https://stackoverflow.com/questions/41531838/when-to-use-pointer-in-methods-and-return-pointers-to-structs", "closed_reason": "Duplicate", "title": "When to use pointer in methods and return pointers to structs?", "body": "<p>I'm trying to learn Go. I learned that structs and arrays are copied by value (when passing them to functions or assigning them to variables). So we use pointers to allow modifying them and to save memory.</p>\n\n<p>The thing is, in some situations I always find them use pointers to structs. </p>\n\n<p>For instance, in <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow noreferrer\">an official web application tutorial</a> they used the code</p>\n\n<pre><code> func (p *Page) save() error {\n  filename := p.Title + \".txt\"\n  return ioutil.WriteFile(filename, p.Body, 0600)\n }\n</code></pre>\n\n<p>Here it no data change occurs to the struct. This happens in may other places in official packages and 3rd party ones.</p>\n\n<p>Another case is when they return a &amp;struct{}. An example from the same link above:</p>\n\n<pre><code> func loadPage(title string) *Page {\n   filename := title + \".txt\"\n   body, _ := ioutil.ReadFile(filename)\n   return &amp;Page{Title: title, Body: body}\n }\n</code></pre>\n\n<p>So, in which cases and places the pointer should be used? </p>\n"}, {"tags": ["curl", "go"], "answers": [{"comments": [{"owner": {"reputation": 1938, "user_id": 1647948, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c783321ed0fe4760714a09de60da4f95?s=128&d=identicon&r=PG", "display_name": "Dubby", "link": "https://stackoverflow.com/users/1647948/dubby"}, "edited": false, "score": 0, "creation_date": 1483876189, "post_id": 41531911, "comment_id": 70269770, "body": "Thanks, Howl. That&#39;s exactly what I was looking for."}], "tags": [], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1483872917, "creation_date": 1483872917, "answer_id": 41531911, "question_id": 41531831, "link": "https://stackoverflow.com/questions/41531831/function-basics-in-golang/41531911#41531911", "title": "Function basics in Golang", "body": "<p>Generally speaking in Go there's the concept of <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">\"Zero values\"</a>, so what you'll most likely want to do is to set body to <code>nil</code> if data is an empty string, or the opposite logic:</p>\n\n<pre><code>var body io.Reader // Zero value of interfaces is always nil\nif data != \"\" {\n    body = strings.NewReader(data)\n}\nreq, err := http.NewRequest(method, \"http://domain.com\", body)\n</code></pre>\n\n<p>If you need to have an option to set the request's body to be an empty string, then just use <code>*string</code> and check if it's nil.</p>\n"}], "owner": {"reputation": 1938, "user_id": 1647948, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c783321ed0fe4760714a09de60da4f95?s=128&d=identicon&r=PG", "display_name": "Dubby", "link": "https://stackoverflow.com/users/1647948/dubby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 41531911, "answer_count": 1, "score": 0, "last_activity_date": 1483872917, "creation_date": 1483872281, "last_edit_date": 1483872352, "question_id": 41531831, "link": "https://stackoverflow.com/questions/41531831/function-basics-in-golang", "title": "Function basics in Golang", "body": "<p>I am just starting out learning Go and I thought it would be fun to create a simple Curl type function to handle different types of requests. However, I'm not sure on what the best approach should be and I'm not having much luck with Google searches.</p>\n\n<p>With a curl like request, there may and may not be a data payload and I'm unsure how best to handle this situation. Ideally in the function declaration (in the example below) I would like to have <code>data</code> default to <code>nil</code> and an if clause check whether to prepare the <code>body</code> variable.</p>\n\n<pre><code>connect(\"POST\", `{\"name\":\"bob\",\"age\":123}`)\n\nfunc connect(method string, data string) {\n    body := strings.NewReader(data)\n    req, err := http.NewRequest(method, \"http://domain.com\", body)\n}\n</code></pre>\n\n<p>When calling the function, I could set data to string <code>false</code> and check for that, but that seems way too hacky. What would the best approach be?</p>\n\n<p>I would like to keep the line of code calling the function as brief as possible and the function itself to be clean and minimilistic. All attempts have become a little too big with many control statements.</p>\n"}, {"tags": ["multithreading", "go", "atomicity"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483875623, "post_id": 41531337, "comment_id": 70269605, "body": "No. The only atomic operations are through <code>sync&#47;atomic</code>. You always need to synchronize reads and writes."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1483889287, "post_id": 41531337, "comment_id": 70273716, "body": "<a href=\"http://stackoverflow.com/q/41406501/720999\">See also</a>."}], "owner": {"reputation": 381, "user_id": 3020840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WJ5pc.png?s=128&g=1", "display_name": "ncubrian", "link": "https://stackoverflow.com/users/3020840/ncubrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1192, "favorite_count": 0, "closed_date": 1595137067, "answer_count": 0, "score": 4, "last_activity_date": 1483885021, "creation_date": 1483868470, "last_edit_date": 1483880312, "question_id": 41531337, "link": "https://stackoverflow.com/questions/41531337/is-a-read-or-write-operation-on-a-pointer-value-atomic-in-golang", "closed_reason": "Duplicate", "title": "is a read or write operation on a pointer value atomic in golang?", "body": "<p>Is the size of a pointer value 32 bits or 64 bits in golang when building with <code>GOARCH=amd64</code> option specified and running on 64-bit OS?</p>\n\n<p>If it's 64-bit size, is a global pointer value 8-byte aligned in memory so that a read or write operation of that pointer value is carried out atomically?</p>\n\n<p>For example, in the following code, is it possible that the global pointer p is only partially updated when the read goroutine read the pointer?</p>\n\n<pre><code>var p *int\n\nvoid main() {\n    i := 1\n    p = &amp;i\n    go func() {\n        fmt.Println(*p)\n    }()\n}\n</code></pre>\n\n<p>The scenario I'm concerning is that there is only one write but multiple reads on a global pointer value, and reading of an old value of the pointer is not important. Thanks in advance!</p>\n"}, {"tags": ["python", "sockets", "go", "proxy"], "comments": [{"owner": {"reputation": 6547, "user_id": 4522780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa0b7f88da44e626b9f09934afcad97?s=128&d=identicon&r=PG&f=1", "display_name": "Nizam Mohamed", "link": "https://stackoverflow.com/users/4522780/nizam-mohamed"}, "edited": false, "score": 0, "creation_date": 1483859821, "post_id": 41530272, "comment_id": 70266165, "body": "<code>shutil.copyfileobj</code> with <code>socket.socket.makefile</code>."}, {"owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "reply_to_user": {"reputation": 6547, "user_id": 4522780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa0b7f88da44e626b9f09934afcad97?s=128&d=identicon&r=PG&f=1", "display_name": "Nizam Mohamed", "link": "https://stackoverflow.com/users/4522780/nizam-mohamed"}, "edited": false, "score": 0, "creation_date": 1483860296, "post_id": 41530272, "comment_id": 70266240, "body": "@NizamMohamed can you provide an example?"}, {"owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "reply_to_user": {"reputation": 6547, "user_id": 4522780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa0b7f88da44e626b9f09934afcad97?s=128&d=identicon&r=PG&f=1", "display_name": "Nizam Mohamed", "link": "https://stackoverflow.com/users/4522780/nizam-mohamed"}, "edited": false, "score": 0, "creation_date": 1483861709, "post_id": 41530272, "comment_id": 70266529, "body": "@NizamMohamed does not work for me, <code>shutil.copyfileobj(sock1.makefile(), sock2.makefile())</code>"}, {"owner": {"reputation": 6547, "user_id": 4522780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa0b7f88da44e626b9f09934afcad97?s=128&d=identicon&r=PG&f=1", "display_name": "Nizam Mohamed", "link": "https://stackoverflow.com/users/4522780/nizam-mohamed"}, "edited": false, "score": 0, "creation_date": 1483864018, "post_id": 41530272, "comment_id": 70266989, "body": "clarify what a &quot;tcp proxy&quot; is and where it fits in. In TCP one end initiates a connection (client) and another end receives (server). which end you&#39;re talking about?"}], "answers": [{"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 2, "last_activity_date": 1483864521, "creation_date": 1483864521, "answer_id": 41530898, "question_id": 41530272, "link": "https://stackoverflow.com/questions/41530272/python-equivalent-of-io-copy/41530898#41530898", "title": "Python equivalent of `io.Copy`", "body": "<p>You may use function like this:</p>\n\n<pre><code>def CopyProxy(conn1, conn2):    \n    while True:        \n        data = conn2.recv(BUFFER_SIZE)        \n        try:            \n            conn1.send(data)            \n            if not data:                \n              conn1.close()              \n              conn2.close()                \n              break        \n        except Exception:            \n              break\n</code></pre>\n\n<p>Then launch them in separate threads:</p>\n\n<pre><code># conn1 and conn2 - previously opened connections \"to\" and \"from\"\nt1 = threading.Thread(target=CopyProxy, args=[conn1, conn2])\nt2 = threading.Thread(target=CopyProxy, args=[conn2, conn1])   \nt1.start() \nt2.start()\n</code></pre>\n"}], "owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 1, "accepted_answer_id": 41530898, "answer_count": 1, "score": 2, "last_activity_date": 1483864521, "creation_date": 1483858418, "question_id": 41530272, "link": "https://stackoverflow.com/questions/41530272/python-equivalent-of-io-copy", "title": "Python equivalent of `io.Copy`", "body": "<p>I'm trying to implement a tcp proxy with python,</p>\n\n<p>So I need to connect two sockets directly, passing input and output in between.</p>\n\n<p>In golang, I simply do a <code>io.Copy</code>, what's the equivalent in Python 2.6?</p>\n\n<pre><code>go func() {\n    defer conn1.Close()\n    defer conn2.Close()\n    io.Copy(conn1, conn2)\n}()\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 373, "user_id": 2719586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8h5EJ.jpg?s=128&g=1", "display_name": "Alex Re\u0161atniak", "link": "https://stackoverflow.com/users/2719586/alex-re%c5%a1atniak"}, "edited": false, "score": 0, "creation_date": 1483856961, "post_id": 41529197, "comment_id": 70265662, "body": "This is the first way I&#39;ve described in the question. In this case I need to define two separate functions to be used for A and for B. But does any option exist in Go to define a single function that will work for both structures like method in classic OOP?"}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "reply_to_user": {"reputation": 373, "user_id": 2719586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8h5EJ.jpg?s=128&g=1", "display_name": "Alex Re\u0161atniak", "link": "https://stackoverflow.com/users/2719586/alex-re%c5%a1atniak"}, "edited": false, "score": 0, "creation_date": 1483858814, "post_id": 41529197, "comment_id": 70265969, "body": "I don&#39;t think you could do that in Go,  because here Go doesn&#39;t have inheritance but embedding. you can see the docs about embedding here  <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#embedding</a>. just like Andy Answer"}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "reply_to_user": {"reputation": 373, "user_id": 2719586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8h5EJ.jpg?s=128&g=1", "display_name": "Alex Re\u0161atniak", "link": "https://stackoverflow.com/users/2719586/alex-re%c5%a1atniak"}, "edited": false, "score": 0, "creation_date": 1483858986, "post_id": 41529197, "comment_id": 70266005, "body": "<a href=\"https://www.youtube.com/watch?v=7YcLIbG1ekM&amp;feature=youtu.be\" rel=\"nofollow noreferrer\">youtube.com/watch?v=7YcLIbG1ekM&amp;feature=youtu.be</a> and this video explain all about the concept how to write Go. hope it helps"}], "tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": true, "score": 4, "last_activity_date": 1483846188, "creation_date": 1483846188, "answer_id": 41529197, "question_id": 41528850, "link": "https://stackoverflow.com/questions/41528850/inheritance-json-in-golang/41529197#41529197", "title": "Inheritance &amp; Json in Golang", "body": "<p>Your methodn toJson() is from A struct. change it to struct B then  you will get your expected result. </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype A struct {\n    Foo string `json:\"foo\"`\n}\n\ntype B struct {\n    A\n    Bar string `json:\"bar\"`\n}\n\nfunc (object *B) toJson() []byte {\n    res, _ := json.Marshal(&amp;object)\n    return res\n}\n\nfunc main() {\n    c := B{}\n    fmt.Println(string(c.toJson()))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 2, "last_activity_date": 1483846285, "creation_date": 1483846285, "answer_id": 41529213, "question_id": 41528850, "link": "https://stackoverflow.com/questions/41528850/inheritance-json-in-golang/41529213#41529213", "title": "Inheritance &amp; Json in Golang", "body": "<p>Since <code>toJson</code> is defined for <code>A</code>, it operates on <code>b.A</code>. Embedding a type in Go is not the same as subclassing in other languages. See <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#embedding</a>.</p>\n"}], "owner": {"reputation": 373, "user_id": 2719586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8h5EJ.jpg?s=128&g=1", "display_name": "Alex Re\u0161atniak", "link": "https://stackoverflow.com/users/2719586/alex-re%c5%a1atniak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2606, "favorite_count": 0, "accepted_answer_id": 41529197, "answer_count": 2, "score": 4, "last_activity_date": 1483857006, "creation_date": 1483842575, "last_edit_date": 1483857006, "question_id": 41528850, "link": "https://stackoverflow.com/questions/41528850/inheritance-json-in-golang", "title": "Inheritance &amp; Json in Golang", "body": "<p>There are two structures A &amp; B. B includes A. Also there is a function attached to A. It returns json of the parent object. I expect to see all object fields in json when I call the fonction on instance of B, but I get only fields of A. Please look at the code:</p>\n\n<pre><code>type A struct {\n    Foo string\n}\n\ntype B struct {\n    A\n    Bar string\n}\n\nfunc (object *A) toJson() []byte {\n    res, _ := json.Marshal(&amp;object)\n    return res\n}\n\n\nfunc main() {\n    b := B{}\n    fmt.Println(string(b.toJson()))\n}\n</code></pre>\n\n<p>I expect to get <strong>{\"Foo\":\"\", \"Bar\":\"\"}</strong> but the result is <strong>{\"Foo\":\"\"}</strong>. The first way is to define two separate functions for both of structures. But is there the second solution with one function? Thank you in advance.</p>\n"}, {"tags": ["go", "go-flag"], "answers": [{"tags": [], "owner": {"reputation": 112, "user_id": 7389325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UaKF.jpg?s=128&g=1", "display_name": "Cassey", "link": "https://stackoverflow.com/users/7389325/cassey"}, "is_accepted": false, "score": 3, "last_activity_date": 1484014872, "creation_date": 1484014872, "answer_id": 41560123, "question_id": 41528341, "link": "https://stackoverflow.com/questions/41528341/how-to-reference-go-flag-isset-functional-code-example-needed/41560123#41560123", "title": "How to reference go-flag IsSet, functional code example needed", "body": "<p>Figured this out:</p>\n\n<p><code>parser := flags.NewParser(&amp;opts, flags.Default)\no := parser.FindOptionByLongName(\"Port)\nif o.IsSet() {}</code></p>\n\n<p>Problme is that <code>IsSet()</code> is true if the flag was used on the command line OR if it was set via the default.</p>\n\n<p>So solved the surface problem of referencing <code>IsSet()</code> but still hunting for an ability to tell which occured, since I want the flag defaults to show in --help.</p>\n"}, {"tags": [], "owner": {"reputation": 3590, "user_id": 1194266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66d8eb14479d56d246735dac6ec66148?s=128&d=identicon&r=PG", "display_name": "n1ghtm4n4g3r", "link": "https://stackoverflow.com/users/1194266/n1ghtm4n4g3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1607266539, "creation_date": 1607266539, "answer_id": 65169425, "question_id": 41528341, "link": "https://stackoverflow.com/questions/41528341/how-to-reference-go-flag-isset-functional-code-example-needed/65169425#65169425", "title": "How to reference go-flag IsSet, functional code example needed", "body": "<p>Go newbie here as well. <code>IsSetDefault()</code> is also available. (Perhaps, it was added since you asked and answered your question.)</p>\n"}], "owner": {"reputation": 112, "user_id": 7389325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UaKF.jpg?s=128&g=1", "display_name": "Cassey", "link": "https://stackoverflow.com/users/7389325/cassey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1607266539, "creation_date": 1483837104, "last_edit_date": 1483837418, "question_id": 41528341, "link": "https://stackoverflow.com/questions/41528341/how-to-reference-go-flag-isset-functional-code-example-needed", "title": "How to reference go-flag IsSet, functional code example needed", "body": "<p>New to Go, and having a basic conceptual problem (I think)...</p>\n\n<p>Trying to use github.com/jessevdk/go-flags and have it mostly working.  --help and whatnot are working fine, flags are being passed, etc.</p>\n\n<p>I need to understand if a option was set via a flag or via go-flags parser using the provided default value.  It appears go-flags has an \"IsSet\" function, but I'm clueless how to reference it.  Presume:</p>\n\n<pre><code>var opts struct {\n    Port int `short:\"p\" long:\"Port\" description:\"IP port\" default:\"1111\"\n}\n_, err := flags.Parse(&amp;opts) \n</code></pre>\n\n<p>I can reference the value via \"opts.Port\", but how can I find out if the option was set via a flag or default?   Many thanks in advance!</p>\n"}, {"tags": ["performance", "csv", "go", "profiling", "usleep"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1483828004, "post_id": 41527104, "comment_id": 70260516, "body": "You have too much contention. You can&#39;t parallelize reading a file, so the goroutines probably aren&#39;t running concurrently. Without an complete example we can&#39;t say for sure what is going on."}, {"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1483886647, "post_id": 41527104, "comment_id": 70272822, "body": "It sounds like your program is I/O-bound, meaning it sleeps while waiting for the next I/O event. You don&#39;t sleep, but the I/O routines could."}, {"owner": {"reputation": 411, "user_id": 7389047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd324529ad838ee757e0262f700534bf?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Miller", "link": "https://stackoverflow.com/users/7389047/michael-miller"}, "edited": false, "score": 0, "creation_date": 1483968721, "post_id": 41527104, "comment_id": 70303228, "body": "i have modified the code to have no go-routines. the usleep is now gone, performance is still bad: reading a 300MB csv file takes 8-9 seconds ... thats only 33mb/s - reading from nvme/ssd ..."}], "owner": {"reputation": 411, "user_id": 7389047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd324529ad838ee757e0262f700534bf?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Miller", "link": "https://stackoverflow.com/users/7389047/michael-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1090, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1483874108, "creation_date": 1483826795, "last_edit_date": 1483874108, "question_id": 41527104, "link": "https://stackoverflow.com/questions/41527104/golang-profile-runtime-usleep-at-70", "title": "golang profile runtime.usleep at 70%", "body": "<p>I am writing a small tool in golang that reads in CSV file and passes each row to a channel. There is a receiver go-routine for every row.\nSomehow that is very slow - using profiling I found that the program is 68% on runtime.usleep. I have no 'sleeps' in my code.</p>\n\n<p>Can someone point me to where this could come from, what it means and how to get rid of it?</p>\n\n<pre><code>(pprof) top10\n28.98s of 30.12s total (96.22%)\nDropped 64 nodes (cum &lt;= 0.15s)\nShowing top 10 nodes out of 44 (cum &gt;= 19.38s)\n  flat  flat%   sum%        cum   cum%\n20.53s 68.16% 68.16%     20.53s 68.16%  runtime.usleep\n 6.86s 22.78% 90.94%      6.86s 22.78%  syscall.Syscall\n 0.30s     1% 91.93%      0.30s     1%  runtime/internal/atomic.Cas64\n 0.28s  0.93% 92.86%      0.28s  0.93%  runtime.mach_semaphore_signal\n 0.26s  0.86% 93.73%     19.15s 63.58%  runtime.findrunnable\n 0.24s   0.8% 94.52%      0.24s   0.8%  runtime.mach_semaphore_wait\n 0.21s   0.7% 95.22%     17.11s 56.81%  runtime.runqgrab\n 0.13s  0.43% 95.65%      0.23s  0.76%  runtime.runqempty\n 0.12s   0.4% 96.05%      4.17s 13.84%  runtime.lock\n 0.05s  0.17% 96.22%     19.38s 64.34%  runtime.schedule\n(pprof)\n</code></pre>\n\n<p>relevant source code:</p>\n\n<pre><code>[...snip from main...]\nvar wg_p sync.WaitGroup\nvar wg_w sync.WaitGroup\n\nfor i := 0; i &lt; workercount; i++ {\n    wg_p.Add(1)\n    go func(i int) {\n        processor(i, chn_read, chn_write)\n        wg_p.Done()\n    }(i)\n}\n\nwg_w.Add(1)\ngo func() {\n    writer(chn_write)\n    wg_w.Done()\n}()\n\n// read headers/1st line from csv\nheaders, _ := csvf.Read()\ng_fieldnames = headers\nchn_write &lt;- g_fieldnames\n\n// read 'n feed linewise\nfor {\n    chunk, _ := csvf.Read()\n    if chunk == nil {\n        close(chn_read)\n        break\n    }\n    chn_read &lt;- chunk\n}\n[...snip end from main...]\n</code></pre>\n\n<p>and the go-routines</p>\n\n<pre><code>func processor(num_p int, chn_read chan []string, chn_write chan []string) {\n    for msg := range chn_read {\n        // snipped working on 'msg'\n        chn_write &lt;- msg\n    }\n}\n\nfunc writer(chn_write chan []string) {\n    fout, _ := os.Create(\"./out.csv\")\n    defer fout.Close()\n    w := csv.NewWriter(fout)\n    counter := 0\n    for msg := range chn_write {\n        w.Write(msg)\n        counter++\n    }\n    w.Flush()\n}\n</code></pre>\n"}, {"tags": ["go", "apache-zookeeper"], "comments": [{"owner": {"reputation": 2875, "user_id": 4012073, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1hzGn.jpg?s=128&g=1", "display_name": "Imesha Sudasingha", "link": "https://stackoverflow.com/users/4012073/imesha-sudasingha"}, "edited": false, "score": 0, "creation_date": 1483877339, "post_id": 41525907, "comment_id": 70270061, "body": "Did you check if <code>err != nil</code>. There can be an error occurred."}, {"owner": {"reputation": 673, "user_id": 689527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2df1ee807f389ec59c4f520d79b32134?s=128&d=identicon&r=PG", "display_name": "silentnights", "link": "https://stackoverflow.com/users/689527/silentnights"}, "reply_to_user": {"reputation": 2875, "user_id": 4012073, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1hzGn.jpg?s=128&g=1", "display_name": "Imesha Sudasingha", "link": "https://stackoverflow.com/users/4012073/imesha-sudasingha"}, "edited": false, "score": 0, "creation_date": 1483879452, "post_id": 41525907, "comment_id": 70270614, "body": "@ImeshaSudasingha Yes I have checked it and there is no error. Now I assume that connect just return a connection object which might be not connected. Similar to the zookeeper constructor in the java API. But I am not sure if my assumptions are right."}, {"owner": {"reputation": 2875, "user_id": 4012073, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1hzGn.jpg?s=128&g=1", "display_name": "Imesha Sudasingha", "link": "https://stackoverflow.com/users/4012073/imesha-sudasingha"}, "edited": false, "score": 1, "creation_date": 1483879798, "post_id": 41525907, "comment_id": 70270711, "body": "Ahh... yes. The constructor returns immediately. You have to add a Watcher and check for  the synConnected event"}, {"owner": {"reputation": 673, "user_id": 689527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2df1ee807f389ec59c4f520d79b32134?s=128&d=identicon&r=PG", "display_name": "silentnights", "link": "https://stackoverflow.com/users/689527/silentnights"}, "reply_to_user": {"reputation": 2875, "user_id": 4012073, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1hzGn.jpg?s=128&g=1", "display_name": "Imesha Sudasingha", "link": "https://stackoverflow.com/users/4012073/imesha-sudasingha"}, "edited": false, "score": 0, "creation_date": 1483882291, "post_id": 41525907, "comment_id": 70271427, "body": "@ImeshaSudasingha I am new to both go and zookeeper, if you have an example code, it would be great. The go-zookeeper documentation does not clarify much. I have found this function func WithEventCallback(cb EventCallback) connOption I assume this is what you mean but not sure how to use it."}, {"owner": {"reputation": 2875, "user_id": 4012073, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1hzGn.jpg?s=128&g=1", "display_name": "Imesha Sudasingha", "link": "https://stackoverflow.com/users/4012073/imesha-sudasingha"}, "edited": false, "score": 0, "creation_date": 1483931230, "post_id": 41525907, "comment_id": 70285932, "body": "I couldn&#39;t find a proper example, but if you use <a href=\"https://github.com/flier/curator.go\" rel=\"nofollow noreferrer\">this</a> go client, you can use <a href=\"https://github.com/flier/curator.go/blob/master/client.go#L128\" rel=\"nofollow noreferrer\">this</a> constructor to  achieve what you need."}, {"owner": {"reputation": 673, "user_id": 689527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2df1ee807f389ec59c4f520d79b32134?s=128&d=identicon&r=PG", "display_name": "silentnights", "link": "https://stackoverflow.com/users/689527/silentnights"}, "reply_to_user": {"reputation": 2875, "user_id": 4012073, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1hzGn.jpg?s=128&g=1", "display_name": "Imesha Sudasingha", "link": "https://stackoverflow.com/users/4012073/imesha-sudasingha"}, "edited": false, "score": 0, "creation_date": 1483947304, "post_id": 41525907, "comment_id": 70290699, "body": "@ImeshaSudasingha Thank for the link. It seems like they are also using go-zookeeper as well. I will try to dif into the code to understand how things are implemented. In the meanwhile I figured out how to do what I wanted using channels. I will post the code as answer, maybe to help someone else who had the same issue."}, {"owner": {"reputation": 2875, "user_id": 4012073, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1hzGn.jpg?s=128&g=1", "display_name": "Imesha Sudasingha", "link": "https://stackoverflow.com/users/4012073/imesha-sudasingha"}, "edited": false, "score": 0, "creation_date": 1483948154, "post_id": 41525907, "comment_id": 70291039, "body": "Yes, but they are providing more high level functionalities like apache-curator for zookeeper. All you have to do is registering a watcher. Then check for the events being received"}, {"owner": {"reputation": 673, "user_id": 689527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2df1ee807f389ec59c4f520d79b32134?s=128&d=identicon&r=PG", "display_name": "silentnights", "link": "https://stackoverflow.com/users/689527/silentnights"}, "reply_to_user": {"reputation": 2875, "user_id": 4012073, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1hzGn.jpg?s=128&g=1", "display_name": "Imesha Sudasingha", "link": "https://stackoverflow.com/users/4012073/imesha-sudasingha"}, "edited": false, "score": 0, "creation_date": 1484077244, "post_id": 41525907, "comment_id": 70358848, "body": "I am trying to learn the basics of zookeeper, so this is why I try to implement this with as low primitives as possible."}], "answers": [{"tags": [], "owner": {"reputation": 673, "user_id": 689527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2df1ee807f389ec59c4f520d79b32134?s=128&d=identicon&r=PG", "display_name": "silentnights", "link": "https://stackoverflow.com/users/689527/silentnights"}, "is_accepted": true, "score": 3, "last_activity_date": 1484077986, "creation_date": 1484077986, "answer_id": 41577230, "question_id": 41525907, "link": "https://stackoverflow.com/questions/41525907/go-zookeeper-connect-returns-without-a-valid-connection/41577230#41577230", "title": "go-zookeeper Connect returns without a valid connection", "body": "<p>After trying several things, and thanks to the suggestion from Imesha, I can achieve what I wanted using channels. Below is my sample code.</p>\n\n<pre><code>func zk_connect(zk_server string) (*zk.Conn, error) {\n    zoo_keeper, session, err := zk.Connect([]string{zk_server}, time.Second)\n    if err != nil {\n        return nil, err\n    }\n    for event := range session {\n        if event.State == zk.StateConnected {\n            log.Printf(\"zookeeper State: %s\\n\", event.State)\n            break\n        }\n    }\n    return zoo_keeper, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 673, "user_id": 689527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2df1ee807f389ec59c4f520d79b32134?s=128&d=identicon&r=PG", "display_name": "silentnights", "link": "https://stackoverflow.com/users/689527/silentnights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 41577230, "answer_count": 1, "score": 0, "last_activity_date": 1484077986, "creation_date": 1483819393, "question_id": 41525907, "link": "https://stackoverflow.com/questions/41525907/go-zookeeper-connect-returns-without-a-valid-connection", "title": "go-zookeeper Connect returns without a valid connection", "body": "<p>I have a question regarding zookeeper, I am trying to implement simple service discovery with zookeeper in go, I am using go-zookeeper: <a href=\"https://github.com/samuel/go-zookeeper\" rel=\"nofollow noreferrer\">https://github.com/samuel/go-zookeeper</a></p>\n\n<p>My question is whenever I connect to zookeeper using for example:</p>\n\n<pre><code>zoo_keeper, _, err := zk.Connect(s, time.Second)\n</code></pre>\n\n<p>the function returns immediately and no error is reported, but there is no actual valid connection yet. Now for example if I want to create znodes, what do I need to check to make sure I have a valid connection before doing so?</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1483805536, "post_id": 41523384, "comment_id": 70252793, "body": "Print the capacity of the slice in each situation and you&#39;ll see why."}], "answers": [{"comments": [{"owner": {"reputation": 604, "user_id": 2265106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IKHQK.png?s=128&g=1", "display_name": "xrfang", "link": "https://stackoverflow.com/users/2265106/xrfang"}, "edited": false, "score": 0, "creation_date": 1483834351, "post_id": 41524541, "comment_id": 70261986, "body": "That&#39;s correct. thanks!"}, {"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "reply_to_user": {"reputation": 604, "user_id": 2265106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IKHQK.png?s=128&g=1", "display_name": "xrfang", "link": "https://stackoverflow.com/users/2265106/xrfang"}, "edited": false, "score": 0, "creation_date": 1483915375, "post_id": 41524541, "comment_id": 70282706, "body": "@xrfang, you are welcome!"}], "tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": true, "score": 2, "last_activity_date": 1483811300, "creation_date": 1483811300, "answer_id": 41524541, "question_id": 41523384, "link": "https://stackoverflow.com/questions/41523384/golang-why-the-following-code-does-not-panic-with-slice-index-out-of-range-er/41524541#41524541", "title": "golang: Why the following code does NOT panic with &quot;slice index out of range&quot; error", "body": "<p>Because when you use append() to add elements to a slice which has no more room for adding the new elements it creates a new one doubling its capacity copying the old elements as well as the new you're asking to add and returning a reference to that. Further down when you use slice syntax to ask for elements past the apparent end of the slice the length is actually applied to the underlying array created &amp; returned by append.</p>\n\n<p>As @JimB suggested in the comments, you can add a statement to print the capacity at every step in the append loop to see this happening:</p>\n\n<pre><code>fmt.Println(cap(data.P))\n</code></pre>\n\n<p>Should generate something like:</p>\n\n<pre><code>2\n2\n4\n4\n8\n8\n8\n8\n16\n16\n</code></pre>\n"}], "owner": {"reputation": 604, "user_id": 2265106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IKHQK.png?s=128&g=1", "display_name": "xrfang", "link": "https://stackoverflow.com/users/2265106/xrfang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "closed_date": 1483834447, "accepted_answer_id": 41524541, "answer_count": 1, "score": 2, "last_activity_date": 1483811300, "creation_date": 1483804978, "question_id": 41523384, "link": "https://stackoverflow.com/questions/41523384/golang-why-the-following-code-does-not-panic-with-slice-index-out-of-range-er", "closed_reason": "Duplicate", "title": "golang: Why the following code does NOT panic with &quot;slice index out of range&quot; error", "body": "<pre><code>package main\n\nimport \"fmt\"\n\ntype Point struct {\n        X int\n        Y int\n}\n\ntype Points struct {\n    P []Point\n}\n\nfunc main() {\n    data := Points{}\n    for i := 0; i &lt; 10; i++ {\n        data.P = append(data.P, Point{\n            X: i,\n            Y: i*2,\n        })\n    }\n    fmt.Printf(\"%+v\\n\", data.P[5:11]);\n}\n</code></pre>\n\n<p>While the above program is run, it printed out:</p>\n\n<p>[{X:5 Y:10} {X:6 Y:12} {X:7 Y:14} {X:8 Y:16} {X:9 Y:18} {X:0 Y:0}]</p>\n\n<p>Why there are {X:0, Y:0} which seems to be automatically generated as the slice's length is 10 but I try to get 5:11?</p>\n\n<p>I found the problem in my code and test with \"raw\" slice such as:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    v := []int{0,1,2,3,4,5,6,7,8,9}\n    fmt.Printf(\"%v\\n\", v[5:11])\n}\n</code></pre>\n\n<p>This simple program generates errors (as expected):</p>\n\n<pre><code>panic: runtime error: slice bounds out of range\n\ngoroutine 1 [running]:\npanic(0x47a8e0, 0xc42000a130)\n        /usr/local/go/src/runtime/panic.go:500 +0x1a1\nmain.main()\n        /home/fxr/go/src/cmhwc/test2.go:7 +0x53\nexit status 2\n</code></pre>\n\n<p>Why the first program does not panic?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483809364, "post_id": 41523148, "comment_id": 70254128, "body": "First, you shouldn&#39;t use <code>go run</code> for your project, use <code>go install</code> or <code>go build</code>  If you need a binary included you will need to provide that externally somehow, like any other dependency."}, {"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483809993, "post_id": 41523148, "comment_id": 70254353, "body": "@JimB, I am aware how to build and package my application. The issue is I need to DEBUG with this binary included. All debuggers I can see are using <code>go run</code>, thus the question."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483810297, "post_id": 41523148, "comment_id": 70254465, "body": "Oh, then just make sure the executable is in your PATH, or provide a full path the the executable. You shouldn&#39;t rely on a relative path in a binary."}, {"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483810533, "post_id": 41523148, "comment_id": 70254559, "body": "@JimB that&#39;s what I am doing now. However this is a <code>coupled</code> software so debugging it with go app would be so much easier if I can just rebuild and include this external binary automagically on every debugger process restart."}, {"owner": {"reputation": 63890, "user_id": 151312, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a8b345ddcfc5401f578c850442f1e1b?s=128&d=identicon&r=PG", "display_name": "coolaj86", "link": "https://stackoverflow.com/users/151312/coolaj86"}, "edited": false, "score": 0, "creation_date": 1553541079, "post_id": 41523148, "comment_id": 97414517, "body": "You can do some trickery to get other things to be included with your source. You may go generate to be helpful, along with something like fileb0x, as mentioned below ( <a href=\"https://stackoverflow.com/a/54028731/151312\">stackoverflow.com/a/54028731/151312</a> )"}], "answers": [{"comments": [{"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "edited": false, "score": 0, "creation_date": 1483865169, "post_id": 41530956, "comment_id": 70267230, "body": "That could be an option. Though not for my case because that executable should be ran with different permissions (suid)"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "edited": false, "score": 0, "creation_date": 1483865618, "post_id": 41530956, "comment_id": 70267328, "body": "@AlexKey And this would not help? <a href=\"http://stackoverflow.com/a/21706757/6309\">stackoverflow.com/a/21706757/6309</a>"}, {"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "edited": false, "score": 0, "creation_date": 1483866069, "post_id": 41530956, "comment_id": 70267418, "body": "Not unless I run it as root, then it makes no sense for my case as I could have embedded this functionality into main app from the start. And that would not solve more general case of having some resource files with the application (like images not converted into []bytes but as a plain files etc). It is rather rare to see application that has no resource files with it..."}, {"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "edited": false, "score": 0, "creation_date": 1483866230, "post_id": 41530956, "comment_id": 70267450, "body": "To elaborate on <code>suid</code>, the app is ran by user, but some actions shuold be perfromed with root privileges, so this <code>external binary</code> is a helper tool that has <code>suid</code> bit set to allow privilege escalation. That is a recommended and common way of implementing such cases. I have no problem distributing my app this way, but testability suffers a lot as I cannot use any debugger to test these functions as ALL debuggers I&#39;ve seen use <code>go run</code> which means tmp directory and missing resource files"}, {"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "edited": false, "score": 0, "creation_date": 1483866525, "post_id": 41530956, "comment_id": 70267514, "body": "Also in the comments to the question it was mentioned to load those resources by absolute path, which would work for testing (and that&#39;s what I do now), but then packaging the app I have to change resources path to relative since I have no knowledge where user will install the application. And that also affects collaboration since other devs cannot just clone this project and start working, they have to first &quot;setup environemnt&quot; which means copying those files to hardcoded location matching with everyone else."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "edited": false, "score": 0, "creation_date": 1483866842, "post_id": 41530956, "comment_id": 70267591, "body": "@AlexKey could you change the resource path relative to an environment variable? That way, the only environment setup required from other devs would be to set that unique environment variable."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "edited": false, "score": 0, "creation_date": 1483866863, "post_id": 41530956, "comment_id": 70267594, "body": "@AlexKey Or: could you setup your path relative to the execution path of your executable? Then no setup required."}, {"owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "edited": false, "score": 0, "creation_date": 1483867044, "post_id": 41530956, "comment_id": 70267636, "body": "envvar - and then I need to instruct user to configure environment variable? relative path - then <code>go run</code> will have resources missing, that is exactly the issue. Go run executes build, but under tmp directory, and it only cares about <code>.go</code> files, which literally means there will be executable under /tmp.., but it won&#39;t copy resource files to the same location."}, {"owner": {"reputation": 157, "user_id": 1678115, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/26dae8246029492e42e6d5df84602974?s=128&d=identicon&r=PG", "display_name": "Puneri", "link": "https://stackoverflow.com/users/1678115/puneri"}, "reply_to_user": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "edited": false, "score": 0, "creation_date": 1576899142, "post_id": 41530956, "comment_id": 105052149, "body": "@AlexeyKamenskiy could you please share example/gist of getting handle to executable bundled inside go program and executing that as next step? All I see is read/write file which returns byte[]? I tried both go-bindata and unnoted/fileb0x. Thank you"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 3, "last_activity_date": 1483865059, "creation_date": 1483865059, "answer_id": 41530956, "question_id": 41523148, "link": "https://stackoverflow.com/questions/41523148/how-do-i-add-external-executable-to-go-project/41530956#41530956", "title": "How do I add external executable to Go project", "body": "<p>One alternative would be to embed your executable in your application build.</p>\n\n<p>This is done with <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\"><code>go-bindata</code></a> or its more recent successor <a href=\"https://github.com/unnoted/fileb0x\" rel=\"nofollow noreferrer\"><code>unnoted/fileb0x</code></a>.<br>\nThere, you would have access to your embedded executable within an in-memory filesystem.</p>\n"}], "owner": {"reputation": 2560, "user_id": 1297136, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3578b5a1d2c108abcfe6ab20de0d6dea?s=128&d=identicon&r=PG", "display_name": "Alexey Kamenskiy", "link": "https://stackoverflow.com/users/1297136/alexey-kamenskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1165, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1483865059, "creation_date": 1483803621, "question_id": 41523148, "link": "https://stackoverflow.com/questions/41523148/how-do-i-add-external-executable-to-go-project", "title": "How do I add external executable to Go project", "body": "<p>I am writing an application in Go. However on every platform my code will utilize external program compiled from another project in another language (e.g. C++ in Windows, Objective-C for Mac etc). This external executable is called with <code>os/exec</code> <code>exec.Command</code> function.</p>\n\n<p>I can package my software with no problem, however one issue persists is that using <code>go run</code> will result in this file missing.</p>\n\n<p><strong>Is there a way to tell <code>go</code> that it should include external file (and preferably also build it from source) whenever I do <code>$ go run myproj</code>?</strong></p>\n\n<p>AFAIK, <code>go run</code> simply builds binary under a tmp directory, however it won't include any external files such as images etc. So for example when you have two files: <code>$GOPATH/src/main/main.go</code> and <code>$GOPATH/ext-tool.bin</code> and <code>main.go</code> content is:</p>\n\n<pre><code>package main\n\nimport \"os/exec\"\n\nfunc main() {\n    cmd := exec.Command(\"./ext-tool.bin\")\n    err := cmd.Run()\n    if err != nil {\n        os.Exit(1)\n    }\n}\n</code></pre>\n"}, {"tags": ["javascript", "encryption", "go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2312578"}, "edited": false, "score": 0, "creation_date": 1483823268, "post_id": 41522547, "comment_id": 70259102, "body": "I removed the prefix, which turned out to be 16 bytes long. Getting audio to play is a different story tho. You were right, a hex output would&#39;ve showed that it&#39;s always 16 bytes of iv prefix."}], "tags": [], "owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "is_accepted": true, "score": 0, "last_activity_date": 1483799688, "creation_date": 1483799688, "answer_id": 41522547, "question_id": 41521671, "link": "https://stackoverflow.com/questions/41521671/aes-cfb-from-go-to-js-forge/41522547#41522547", "title": "AES-CFB from Go to JS forge", "body": "<p>You're forgetting to remove the IV. This means the IV gets \"decrypted\" as well, resulting in nonsense.</p>\n\n<p>The nonsense seems to be interpreted as UTF-8, where a character may have a multi-byte encoding, so the size of the IV you print out may differ somewhat.</p>\n\n<p>So remove the IV, and try printing out hexadecimals when debugging binary values.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2312578"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 41522547, "answer_count": 1, "score": 0, "last_activity_date": 1483799688, "creation_date": 1483793734, "question_id": 41521671, "link": "https://stackoverflow.com/questions/41521671/aes-cfb-from-go-to-js-forge", "title": "AES-CFB from Go to JS forge", "body": "<p>I'm trying to write a little something that is not secure. The purpose is to encrypt server-side mp3s so they can't be just downloaded with wget or \"save as\" and used by the average Joe.</p>\n\n<p>The idea is on the server side, load the mp3, aes-cfb encrypt it, send the key in the header, send the encrypted mp3 in the response body.</p>\n\n<p>Server side is using Go's stdlib and AES-CFB encryption. As first with base64 encoding, then just plain output of the encrypted []byte-s.</p>\n\n<p>Client side I'm using forge to decrypt. I send a xhr, read the arraybuffer, decrypt using forge and write output to the console.</p>\n\n<p>The content of test.txt is \"this is just a test and maybe it's working maybe not.\"</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"io\"\n    \"crypto/rand\"\n    \"os\"\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"fmt\"\n)\n\nvar (\n    key = \"1234567890123456\"\n    fn = \"test.txt\"\n)\n\nfunc main() {\n\n    http.Handle(\"/file/\", http.HandlerFunc(serveFile))\n    http.Handle(\"/\", http.FileServer(http.Dir(\"public\")))\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc serveFile(w http.ResponseWriter, r *http.Request) {\n    file, e := os.Open(fn)\n    if e != nil {\n        fmt.Println(e.Error())\n        return\n    }\n    defer file.Close()\n    fi, _ := file.Stat()\n    b := make([]byte, fi.Size())\n    io.ReadFull(file, b)\n    o := AESencrypt([]byte(key), b)\n    w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n    //w.Header().Set(\"Key\", key)\n    fmt.Println(o)\n    fmt.Println(len(o))\n    w.Write(o)\n}\n\nfunc AESencrypt(key []byte, content []byte) []byte {\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n    ciphertext := make([]byte, aes.BlockSize + len(content))\n    iv := ciphertext[:aes.BlockSize]\n    if _, err := io.ReadFull(rand.Reader, iv); err != nil {\n        panic(err)\n    }\n    stream := cipher.NewCFBEncrypter(block, iv)\n    stream.XORKeyStream(ciphertext[aes.BlockSize:], content)\n    return ciphertext\n}\n</code></pre>\n\n<p>index.html</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;MP3 Player Demo&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;button onclick=\"loadFile('1')\"&gt;Load&lt;/button&gt;\n\n&lt;script src=\"node_modules/node-forge/js/forge.bundle.js\"&gt;&lt;/script&gt;\n&lt;script src=\"assets/reader.js\"&gt;&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>reader.js</p>\n\n<pre><code>function loadFile(filename) {\n    //var context = new AudioContext || new webkitAudioContext();\n    var request = new XMLHttpRequest();\n    var url = \"http://localhost:8080/file/\";\n    request.open(\"GET\", url + filename, true);\n    request.responseType = \"arraybuffer\";\n    request.onload = function () {\n        var rt = request.response;\n        console.log(rt);\n        var decipher = forge.cipher.createDecipher('AES-CFB', forge.util.createBuffer('1234567890123456'));\n        decipher.start({iv: forge.util.createBuffer('1234567890123456')});\n        decipher.update(forge.util.createBuffer(rt));\n        decipher.finish();\n        console.log(decipher.output);\n        console.log(decipher.output.bytes());\n        console.log('--------------');\n    };\n\n    request.send();\n}\n</code></pre>\n\n<p>The result is weird.</p>\n\n<p>It is \"properly\" decrypted however there's a prefix or garbage of random length with each decrypted result.</p>\n\n<p>3 outputs:</p>\n\n<pre><code>ArrayBuffer { byteLength: 69 }  reader.js:10:9\nObject { data: \"3~\u00e6\u00ffK\u00a5=\u00ae\u00aa\u00ff\u00c2\u00dfthis is just a test\u2026\", read: 0, _constructedStringLength: 69 }  reader.js:16:9\n3~\u00e6\u00ffK\u00a5=\u00ae\u00aa\u00ff\u00c2\u00dfthis is just a test and maybe it's working maybe not.  reader.js:17:9\n--------------  reader.js:18:9\nArrayBuffer { byteLength: 69 }  reader.js:10:9\nObject { data: \"\u00c5J\u00c79\u00cb54\u00ab\u00daV\u00abthis is just a test\u2026\", read: 0, _constructedStringLength: 69 }  reader.js:16:9\n\u00c5J\u00c79\u00cb54\u00ab\u00daV\u00abthis is just a test and maybe it's working maybe not.  reader.js:17:9\n--------------  reader.js:18:9\nArrayBuffer { byteLength: 69 }  reader.js:10:9\nObject { data: \"\u00aa\u00d5x\u00ef\u00c2`zqA   \\c\u00fdx#this is just a test\u2026\", read: 0, _constructedStringLength: 69 }  reader.js:16:9\n\u00aa\u00d5x\u00ef\u00c2`zqA   \\c\u00fdx#this is just a test and maybe it's working maybe not.  reader.js:17:9\n--------------  reader.js:18:9\n</code></pre>\n\n<p>The output here is truncated but it's the same is the test.txt . As you can see it's always prefixed with random garbage.</p>\n\n<p>What am I doing wrong? Is the forge implementation of AES-CFB wrong or Go's? Why are they incompatible? Or why is it that the decryption differs? And if AES-CFB is a standard why are there different implementations?</p>\n\n<p>I also tried gopherjs as an alternative and that works just fine but a) the code size is too big (~3.7MB) and b) I wouldn't know how to play back the decrypted audio using gopherjs. But that's just as an aside.</p>\n"}, {"tags": ["javascript", "go", "cryptojs"], "answers": [{"tags": [], "owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "is_accepted": true, "score": 0, "last_activity_date": 1484010728, "creation_date": 1484010728, "answer_id": 41559665, "question_id": 41521245, "link": "https://stackoverflow.com/questions/41521245/how-can-convert-this-code-from-golang-to-reactjs-in-crypto-hmac-sha256-hex/41559665#41559665", "title": "How can convert this code from golang to reactjs in crypto hmac sha256 hex", "body": "<p>Go code: <a href=\"https://play.golang.org/p/7pXgn5GPQm\" rel=\"nofollow noreferrer\">https://play.golang.org/p/7pXgn5GPQm</a></p>\n\n<p>React:</p>\n\n<ul>\n<li>Package used: \"crypto-js\": \"^3.1.9-1\"</li>\n<li>React v15.4.2</li>\n</ul>\n\n<p>Inside a React Component, a function:</p>\n\n<pre><code>    generateClientToken(secret, user, timestamp, info) {\n      let hmac = CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256, secret);\n\n      hmac.update(user);\n      hmac.update(timestamp);\n      hmac.update(info);\n\n      let hash = hmac.finalize();\n\n      console.log(\"hmac: \", hash.toString(CryptoJS.enc.Hex))\n  }\n</code></pre>\n\n<p>Inside render()</p>\n\n<pre><code>const secret = \"test\";\nconst user = \"Dennis\";\nconst timestamp = \"1\";\nconst info = \"qwerty\";\nthis.generateClientToken(secret, user, timestamp, info);\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6524871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9530839e00adf798a20f27e917cf093d?s=128&d=identicon&r=PG", "display_name": "DaGe Tian", "link": "https://stackoverflow.com/users/6524871/dage-tian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 2, "accepted_answer_id": 41559665, "answer_count": 1, "score": 0, "last_activity_date": 1484010728, "creation_date": 1483790673, "question_id": 41521245, "link": "https://stackoverflow.com/questions/41521245/how-can-convert-this-code-from-golang-to-reactjs-in-crypto-hmac-sha256-hex", "title": "How can convert this code from golang to reactjs in crypto hmac sha256 hex", "body": "<p>Golang code is as below</p>\n\n<pre><code>func GenerateClientToken(secret, user, timestamp, info string) string {\n    token := hmac.New(sha256.New, []byte(secret))\n    token.Write([]byte(user))\n    token.Write([]byte(timestamp))\n    token.Write([]byte(info))\n    return hex.EncodeToString(token.Sum(nil))\n}\n</code></pre>\n\n<p>How can I convert from this to reactjs code.\nI am trying like this</p>\n\n<pre><code>import CryptoJS from 'crypto-js'\n\ngenerateClientToken(secret, user, timestamp, info) {\n        var hmac = CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256, secret);\n\n        hmac.update(user);\n        hmac.update(timestamp);\n        hmac.update(info);\n\n        var hash = hmac.finalize();\n        console.log(\"hmac: \", hash.toString(CryptoJS.enc.Base64))\n        console.log(\"hmac: \", hash.toString(CryptoJS.enc.Hex))\n    }\n</code></pre>\n\n<p>but result is not same with golang result. What am I wrong? and How will I do?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 251344, "user_id": 438154, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/827d86026ddc062f449ccedece1c52da?s=128&d=identicon&r=PG&f=1", "display_name": "Sotirios Delimanolis", "link": "https://stackoverflow.com/users/438154/sotirios-delimanolis"}, "edited": false, "score": 3, "creation_date": 1483752132, "post_id": 41516797, "comment_id": 70240045, "body": "I don&#39;t understand. Variables appear in source code, they are verified at compile time. There&#39;s no such thing as a dynamic variable (or variables of dynamic types). Why does the variable type even matter? What are you trying to do downstream?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1483759045, "last_edit_date": 1483759045, "creation_date": 1483753220, "answer_id": 41516957, "question_id": 41516797, "link": "https://stackoverflow.com/questions/41516797/assert-type-based-on-a-string/41516957#41516957", "title": "Assert type based on a string?", "body": "<p>The Go runtime does not provide a way to create a value given the name of a type, but that's something you can implement in the application:</p>\n\n<pre><code>var types = map[string]reflect.Type{\n    \"main.T\": reflect.TypeOf((*T)(nil)).Elem(),\n}\n</code></pre>\n\n<p>You can create a new value given the name using:</p>\n\n<pre><code>v := reflect.New(types[name]).Interface()\n</code></pre>\n\n<p>This assumes that name is a valid name. You may want to check for the case where types[name] == nil.</p>\n\n<p><a href=\"https://play.golang.org/p/mnSMgc4GVR\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>You can also do this without reflection:</p>\n\n<pre><code>var types = map[string]func() interface{} {\n    \"main.T\": func() interface{} { return &amp;T{} }\n}\n\nv := types[name]()\n</code></pre>\n"}], "owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1483759045, "creation_date": 1483751686, "question_id": 41516797, "link": "https://stackoverflow.com/questions/41516797/assert-type-based-on-a-string", "title": "Assert type based on a string?", "body": "<p>Suppose I have the following:</p>\n\n<pre><code>type T struct { Name string }\n</code></pre>\n\n<p>Then I create a var of type T:</p>\n\n<pre><code>thing := T{\"Hello World\"}\n</code></pre>\n\n<p>I then reflect the type:</p>\n\n<pre><code>t := reflect.TypeOf(thing) // main.T\n</code></pre>\n\n<p>Then I pass <code>t</code> in to a method that accepts an interface, is there any way I can then say, in that method, that the accepted <code>interface{}</code> is of type <code>main.T</code> if I have that string?</p>\n\n<p>The use case is I have a json string that fits a type. I have a string of that type (<code>main.T</code>) and I want to be able to create a new variable that is of type <code>main.t</code> when I only know of the string, <code>main.T</code> then marshal the data to that new variable.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "edited": false, "score": 0, "creation_date": 1483737834, "post_id": 41514498, "comment_id": 70235264, "body": "You might want to look into using a map or struct, which can use variables, then marshaling/encoding to JSON instead of typing out the JSON manually."}], "answers": [{"comments": [{"owner": {"reputation": 14178, "user_id": 534755, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8e455adc8d9f6ce6b8bf850f0d918d6?s=128&d=identicon&r=PG", "display_name": "Nikola", "link": "https://stackoverflow.com/users/534755/nikola"}, "edited": false, "score": 0, "creation_date": 1483738196, "post_id": 41514572, "comment_id": 70235409, "body": "Thank you, that did it. To be honest, this feels weird but then again it&#39;s all matter of getting used to I guess."}], "tags": [], "owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "is_accepted": true, "score": 4, "last_activity_date": 1483737822, "creation_date": 1483737822, "answer_id": 41514572, "question_id": 41514498, "link": "https://stackoverflow.com/questions/41514498/how-to-use-a-variable-in-byte-slice-in-go/41514572#41514572", "title": "How to use a variable in byte slice in Go", "body": "<p>That is because it is a string literal. I suggest trying to serialize your type using <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a>.</p>\n\n<pre><code>type MyPostBody struct {\n    SomeVar string `json:\"someVar\"`\n}\n\npb := &amp;MyPostBody{SomeVar: \"someValue\"}\njsonStr, err := json.Marshal(pb)\nif err != nil {\n    log.Fatalf(\"could not marshal JSON: %s\", err)\n}\n\nreq, err := http.NewRequest(\"POST\", APIURL, bytes.NewBuffer(jsonStr))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1837, "user_id": 381849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d44bcf5700e4fcb934221db2dab496?s=128&d=identicon&r=PG", "display_name": "KAdot", "link": "https://stackoverflow.com/users/381849/kadot"}, "edited": false, "score": 0, "creation_date": 1483742098, "post_id": 41515236, "comment_id": 70236922, "body": "If someValue string contains &quot; character it will break the JSON."}], "tags": [], "owner": {"reputation": 119, "user_id": 2707807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8CyS.jpg?s=128&g=1", "display_name": "wgoudsbloem", "link": "https://stackoverflow.com/users/2707807/wgoudsbloem"}, "is_accepted": false, "score": 3, "last_activity_date": 1483740970, "creation_date": 1483740970, "answer_id": 41515236, "question_id": 41514498, "link": "https://stackoverflow.com/questions/41514498/how-to-use-a-variable-in-byte-slice-in-go/41515236#41515236", "title": "How to use a variable in byte slice in Go", "body": "<p>or format the string</p>\n\n<pre><code>someValue := \"SomeValue\"\nvar jsonStr = []byte(fmt.Sprintf(`{\"someVar\":\"%v\"}`, someValue))\n</code></pre>\n"}], "owner": {"reputation": 14178, "user_id": 534755, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8e455adc8d9f6ce6b8bf850f0d918d6?s=128&d=identicon&r=PG", "display_name": "Nikola", "link": "https://stackoverflow.com/users/534755/nikola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 916, "favorite_count": 0, "accepted_answer_id": 41514572, "answer_count": 2, "score": 0, "last_activity_date": 1483740970, "creation_date": 1483737451, "question_id": 41514498, "link": "https://stackoverflow.com/questions/41514498/how-to-use-a-variable-in-byte-slice-in-go", "title": "How to use a variable in byte slice in Go", "body": "<p><em>Probably a big noob question here, so please bear with me.</em></p>\n\n<p>To send an HTTP POST request in Go with some body, I can do this:</p>\n\n<pre><code>var jsonStr = []byte(`{\"someVar\":\"someValue\"}`)\nreq, err := http.NewRequest(\"POST\", APIURL, bytes.NewBuffer(jsonStr))\n</code></pre>\n\n<p>However, it seems that I can't use a variable instead of \"someValue\", like this:</p>\n\n<pre><code>someValue := \"SomeValue\"\nvar jsonStr = []byte(`{\"someVar\":someValue}`)\n</code></pre>\n\n<p>Can someone point me in the right direction?</p>\n"}, {"tags": ["html", "css", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1483736406, "post_id": 41514180, "comment_id": 70234549, "body": "How are you executing the code? Please show a complete example."}, {"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "edited": false, "score": 0, "creation_date": 1483736743, "post_id": 41514180, "comment_id": 70234713, "body": "Where is the mentioned css located and how is it accessed successfuly from the browser?"}], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1483737425, "creation_date": 1483737425, "answer_id": 41514490, "question_id": 41514180, "link": "https://stackoverflow.com/questions/41514180/html-code-displays-without-css-when-i-execute-this-go-code-but-it-shows-both-ht/41514490#41514490", "title": "html code displays without css when i execute this go code, but it shows both html and css fine when i open it directly in a browser", "body": "<p>This is partially a total guess, but it seems like your html probably has something like:</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" href=\"css/stylesheet.css\"&gt;\n</code></pre>\n\n<p>When you open your html file directly in the browser, the browser is accessing a url like:</p>\n\n<pre><code>file:///path/to/your/html\n</code></pre>\n\n<p>and so it then is able to load:</p>\n\n<pre><code>file:///path/to/your/css/stylesheet.css\n</code></pre>\n\n<p>But when you do it in the browser, it tries to access</p>\n\n<pre><code>http://localhost/css/stylesheet.css\n</code></pre>\n\n<p>And you have no route to handle it in your app.  So of course it doesn't find it.  You probably need to set up a handler for serving your static files.</p>\n\n<p>So I would move all of your static assets into a folder \"assets\", and then do:</p>\n\n<pre><code>func main() {\n    templates := template.Must(template.ParseFiles(\"templates/index.html\"))\n\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        if err := templates.ExecuteTemplate(w, \"index.html\", nil); err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n        }\n\n    })\n    fs := http.FileServer(http.Dir(\"assets\"))\n    http.Handle(\"/assets/\", http.StripPrefix(\"/assets/\", fs))\n    log.Println(\"Listening...\")\n    fmt.Println(http.ListenAndServe(\":8080\", nil))\n\n}\n</code></pre>\n\n<p>http.HandleFunc(\"/\", serveTemplate)</p>\n"}], "owner": {"reputation": 91, "user_id": 4123029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02fdd675fbbba7afa0da9b259ac7aa67?s=128&d=identicon&r=PG&f=1", "display_name": "nytro04", "link": "https://stackoverflow.com/users/4123029/nytro04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1483737425, "creation_date": 1483736087, "last_edit_date": 1483736341, "question_id": 41514180, "link": "https://stackoverflow.com/questions/41514180/html-code-displays-without-css-when-i-execute-this-go-code-but-it-shows-both-ht", "title": "html code displays without css when i execute this go code, but it shows both html and css fine when i open it directly in a browser", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    templates := template.Must(template.ParseFiles(\"templates/index.html\"))\n\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        if err := templates.ExecuteTemplate(w, \"index.html\", nil); err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n        }\n\n    })\n    log.Println(\"Listening...\")\n    fmt.Println(http.ListenAndServe(\":8080\", nil))\n\n}\n</code></pre>\n"}, {"tags": ["database", "testing", "go", "mocking", "go-gorm"], "comments": [{"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1483723494, "post_id": 41510003, "comment_id": 70227857, "body": "You can set up a net conn in your test case to respond to specific test queries. Also it doesn&#39;t appear that the tolenIntrospectionHandler uses the DB at all so Im not sure how to guide you on writing a test case."}, {"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 1, "creation_date": 1483726602, "post_id": 41510003, "comment_id": 70229576, "body": "I&#39;m not familiar with gorm and directly use golang&#39;s &quot;sql&quot; package. But to test my database facing code, I have introduced interfaces which are naturally implemented by the concrete types declared in the &quot;sql&quot; package and then implemented my own mock objects that implement those interfaces. Everywhere else in the code I use those interfaces instead of concrete types. I&#39;d then inject the mocks during testing."}], "answers": [{"tags": [], "owner": {"reputation": 425, "user_id": 660895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa31c749a35126c0755251ebd79b8ef?s=128&d=identicon&r=PG", "display_name": "Selvatico", "link": "https://stackoverflow.com/users/660895/selvatico"}, "is_accepted": true, "score": 5, "last_activity_date": 1496778476, "creation_date": 1496778476, "answer_id": 44398628, "question_id": 41510003, "link": "https://stackoverflow.com/questions/41510003/golang-gorm-mocking/44398628#44398628", "title": "Golang gorm mocking", "body": "<p>Please check my self-invented bicycle to mock Gorm for tests here <a href=\"https://github.com/Selvatico/go-mocket\" rel=\"noreferrer\">go-mocket</a></p>\n"}, {"tags": [], "owner": {"reputation": 548, "user_id": 1971120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914a557fed3d8a353e2f7fcb376e2356?s=128&d=identicon&r=PG", "display_name": "germanio", "link": "https://stackoverflow.com/users/1971120/germanio"}, "is_accepted": false, "score": 4, "last_activity_date": 1585868355, "creation_date": 1585868355, "answer_id": 61002509, "question_id": 41510003, "link": "https://stackoverflow.com/questions/41510003/golang-gorm-mocking/61002509#61002509", "title": "Golang gorm mocking", "body": "<p>for unit tests, this looks pretty good to mock <code>gorm.DB</code>: <a href=\"https://github.com/DATA-DOG/go-sqlmock\" rel=\"nofollow noreferrer\">https://github.com/DATA-DOG/go-sqlmock</a></p>\n\n<p>Here's an example from their site. You just creates the mock, then the DB, sets the expectations for the method calls, then run your code under testing and finally check if the expectations are met.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\n// a successful case\nfunc TestShouldUpdateStats(t *testing.T) {\n    db, mock, err := sqlmock.New()\n    if err != nil {\n        t.Fatalf(\"an error '%s' was not expected when opening a stub database connection\", err)\n    }\n    defer db.Close()\n\n    mock.ExpectBegin()\n    mock.ExpectExec(\"UPDATE products\").WillReturnResult(sqlmock.NewResult(1, 1))\n    mock.ExpectExec(\"INSERT INTO product_viewers\").WithArgs(2, 3).WillReturnResult(sqlmock.NewResult(1, 1))\n    mock.ExpectCommit()\n\n    // now we execute our method\n    if err = recordStats(db, 2, 3); err != nil {\n        t.Errorf(\"error was not expected while updating stats: %s\", err)\n    }\n\n    // we make sure that all expectations were met\n    if err := mock.ExpectationsWereMet(); err != nil {\n        t.Errorf(\"there were unfulfilled expectations: %s\", err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10790, "favorite_count": 1, "accepted_answer_id": 44398628, "answer_count": 2, "score": 7, "last_activity_date": 1585868355, "creation_date": 1483720305, "question_id": 41510003, "link": "https://stackoverflow.com/questions/41510003/golang-gorm-mocking", "title": "Golang gorm mocking", "body": "<p>I am using <a href=\"https://github.com/jinzhu/gorm\" rel=\"noreferrer\">gorm</a> in my projects. Can I mock this database orm for testing without database connection? The problem we have CI tools where I don't have database or database with enough data for testing. The other way, I don't want to setup a database for every time I'm testing, because in these cases the CI tool create every time a container just for run the tests. </p>\n\n<p>Whet is the best way for testing database related methods? I am using dependency injection in my solutions so it is easy to replace the database with a mocked database. But the gorm have many orm related function. </p>\n\n<p>This is a handler for example:</p>\n\n<pre><code>func tokenIntrospectionHandler(db *gorm.DB) http.HandlerFunc {\n    return http.HandlerFunc(func(w http.ResponseWriter, req *http.Request) {\n        defer req.Body.Close()\n        token := req.FormValue(\"token\")\n        var resp Response\n        json.NewEncoder(w).Encode(resp)\n    })\n}\n</code></pre>\n"}, {"tags": ["go", "timer"], "comments": [{"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1483713101, "post_id": 41507805, "comment_id": 70221294, "body": "One thing I realised after this is that I set the timeout around the <code>cmd.Process.Kill()</code> call, so I did that to get it working, however I&#39;d still like to figure out the <i>right</i> way of doing this"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1483717704, "last_edit_date": 1483717704, "creation_date": 1483713917, "answer_id": 41508064, "question_id": 41507805, "link": "https://stackoverflow.com/questions/41507805/optional-timeouts-in-golang/41508064#41508064", "title": "Optional timeouts in golang", "body": "<p>While you could replace the timer func with a noop if there's no duration, the usual solution is to simply defer the <code>timer.Stop</code> call when you create the timer:</p>\n\n<pre><code>timer := time.AfterFunc(time.Second*time.Duration(timeout), func() {\n    err := cmd.Process.Kill()\n    if err != nil {\n        panic(err)\n    }\n})\ndefer timer.Stop()\n</code></pre>\n\n<p>Otherwise, you can declare <code>timer</code> at the function scope and check if it was assigned before calling <code>timer.Stop()</code></p>\n\n<pre><code>if timer != nil {\n    timer.Stop()\n}\n</code></pre>\n\n<p>You should also note that an <code>exec.Cmd</code> already makes use of a <a href=\"https://golang.org/pkg/context/#Context\" rel=\"nofollow noreferrer\"><code>Context</code></a> for timeouts, which is exposed via <a href=\"https://golang.org/pkg/os/exec/#CommandContext\" rel=\"nofollow noreferrer\"><code>exec.CommandContext</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 1, "last_activity_date": 1483713989, "creation_date": 1483713989, "answer_id": 41508092, "question_id": 41507805, "link": "https://stackoverflow.com/questions/41507805/optional-timeouts-in-golang/41508092#41508092", "title": "Optional timeouts in golang", "body": "<p>Simply define the timer variable before the first if timeout > 0 block and assign the timer to it using = instead of :=.</p>\n\n<pre><code>var timer *time.Timer\nif timeout &gt; 0 {\n  timer = time.AfterFunc(time.Second*time.Duration(timeout), func() {\n    err := cmd.Process.Kill()\n    if err != nil {\n      panic(err)\n    }\n  })\n}\n</code></pre>\n\n<p>The check for timeout > 0 before timer.Stop() will still be necessary, or, to diminish dependencies, changed to timer != nil.</p>\n\n<pre><code>if timer != nil {\n  timer.Stop()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2907, "user_id": 7357841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RJs6M9j2t9Q/AAAAAAAAAAI/AAAAAAAAAAA/f77YfS3xpcs/photo.jpg?sz=128", "display_name": "minamijoyo", "link": "https://stackoverflow.com/users/7357841/minamijoyo"}, "is_accepted": true, "score": 4, "last_activity_date": 1483716738, "creation_date": 1483716738, "answer_id": 41508875, "question_id": 41507805, "link": "https://stackoverflow.com/questions/41507805/optional-timeouts-in-golang/41508875#41508875", "title": "Optional timeouts in golang", "body": "<p>Using the <code>context</code> package makes it easy to handle timeouts.\n<code>golang.org/x/net/context</code> has become a standard library since Go 1.7.\nThe following is an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"os\"\n    \"os/exec\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc main() {\n    timeout, err := strconv.Atoi(os.Args[1])\n    if err != nil {\n        panic(err)\n    }\n\n    ctx := context.Background()\n    if timeout &gt; 0 {\n        var cancel context.CancelFunc\n        ctx, cancel = context.WithTimeout(context.Background(), time.Duration(timeout)*time.Second)\n        defer cancel()\n    }\n\n    cmd := exec.CommandContext(ctx, \"sleep\", \"5\")\n\n    if err := cmd.Run(); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>When timeout is set to 3 seconds, and run <code>sleep 5</code>:</p>\n\n<pre><code>$ go run main.go 3\npanic: signal: killed\n\ngoroutine 1 [running]:\npanic(0xc7040, 0xc42008c020)\n        /usr/local/Cellar/go/1.7.4_1/libexec/src/runtime/panic.go:500 +0x1a1\nmain.main()\n        /Users/m-morita/work/tmp/20170106/main.go:27 +0x11c\nexit status 2\n</code></pre>\n\n<p>When it is set to 10 seconds or 0(= never timeout), it ends normally:</p>\n\n<pre><code>$ go run main.go 10 \n$ go run main.go 0\n</code></pre>\n"}], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1906, "favorite_count": 0, "accepted_answer_id": 41508875, "answer_count": 3, "score": 1, "last_activity_date": 1483717704, "creation_date": 1483712934, "question_id": 41507805, "link": "https://stackoverflow.com/questions/41507805/optional-timeouts-in-golang", "title": "Optional timeouts in golang", "body": "<p>I have a function which runs a command with a timeout. It looks like this:</p>\n\n<pre><code>func run_command(cmdName string, cmdArgs []string, timeout int) (int, string) {\n\n  // the command we're going to run\n  cmd := exec.Command(cmdName, cmdArgs...)\n\n  // assign vars for output and stderr\n  var output bytes.Buffer\n  var stderr bytes.Buffer\n\n  // get the stdout and stderr and assign to pointers\n  cmd.Stderr = &amp;stderr\n  cmd.Stdout = &amp;output\n\n  // Start the command\n  if err := cmd.Start(); err != nil {\n    log.Fatalf(\"Command not found: %s\", cmdName)\n  }\n\n  timer := time.AfterFunc(time.Second*time.Duration(timeout), func() {\n    err := cmd.Process.Kill()\n    if err != nil {\n      panic(err)\n    }\n  })\n\n  // Here's the good stuff\n  if err := cmd.Wait(); err != nil {\n    if exiterr, ok := err.(*exec.ExitError); ok {\n      // Command ! exit 0, capture it\n      if status, ok := exiterr.Sys().(syscall.WaitStatus); ok {\n        // Check it's nagios compliant\n        if status.ExitStatus() == 1 || status.ExitStatus() == 2 || status.ExitStatus() == 3 {\n          return status.ExitStatus(), stderr.String()\n        } else {\n          // If not, force an exit code 2\n          return 2, stderr.String()\n        }\n      }\n    } else {\n      log.Fatalf(\"cmd.Wait: %v\", err)\n    }\n    timer.Stop()\n  }\n  // We didn't get captured, continue!\n  return 0, output.String()\n}\n</code></pre>\n\n<p>Now I want to be able to make the timeout optional. In order to fudge this a bit, I tried simply allowing timeout to be set to <code>0</code> and then having an if statement around the timer. It ended up looking like this.</p>\n\n<pre><code>if timeout &gt; 0 {\n  timer := time.AfterFunc(time.Second*time.Duration(timeout), func() {\n    err := cmd.Process.Kill()\n    if err != nil {\n      panic(err)\n    }\n  })\n}\n</code></pre>\n\n<p>Of course, this failed because timer is no longer defined <code>timer.Stop()</code> isn't defined now.</p>\n\n<p>So I wrapped the <code>timer.Stop()</code> with the if statement as well.</p>\n\n<pre><code>if timeout &gt; 0 {\n  timer.Stop()\n}\n</code></pre>\n\n<p>This also didn't work.</p>\n\n<p>What is the correct way to do something like this? Golangs strict typing is new to me, so I'm struggling to get my head around it</p>\n"}, {"tags": ["go", "router"], "comments": [{"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 1, "creation_date": 1483713325, "post_id": 41507728, "comment_id": 70221432, "body": "Can you look at the Browser dev tools to see what request is sent?"}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 0, "creation_date": 1483713384, "post_id": 41507728, "comment_id": 70221461, "body": "I have used method=&quot;get&quot; in my form. Shouldn&#39;t that be enough to ensure a get?"}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 0, "creation_date": 1483713528, "post_id": 41507728, "comment_id": 70221535, "body": "I checked it. Request method is get for the page which comes after the form submit."}, {"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 1, "creation_date": 1483713560, "post_id": 41507728, "comment_id": 70221547, "body": "It&#39;s not clear from <a href=\"https://github.com/julienschmidt/httprouter\" rel=\"nofollow noreferrer\">github.com/julienschmidt/httprouter</a> documentation that query parameters are supported. You may want to do  <code>router.GET(&quot;&#47;search&quot;,GrabQuestions)</code> and handle the query parameter in GrabQuestion."}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 0, "creation_date": 1483714827, "post_id": 41507728, "comment_id": 70222381, "body": "thank you for pointing out the problem."}], "answers": [{"comments": [{"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "edited": false, "score": 0, "creation_date": 1483714850, "post_id": 41508251, "comment_id": 70222399, "body": "Thank you for the response."}], "tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": true, "score": 0, "last_activity_date": 1483714507, "creation_date": 1483714507, "answer_id": 41508251, "question_id": 41507728, "link": "https://stackoverflow.com/questions/41507728/httprouter-get-not-working/41508251#41508251", "title": "httprouter.GET not working", "body": "<p>As Frank pointed out in his comment, httprouter doesn't support routing by \"query parameters\" so you should change your search route definition to something like this:</p>\n\n<pre><code>router.GET(\"/search\", GrabQuestions)\n</code></pre>\n"}], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 41508251, "answer_count": 1, "score": 0, "last_activity_date": 1483714507, "creation_date": 1483712606, "question_id": 41507728, "link": "https://stackoverflow.com/questions/41507728/httprouter-get-not-working", "title": "httprouter.GET not working", "body": "<p>I have a html form which is submitting data using a get-method.</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Web Search&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form action=\"/search\" method=\"get\"&gt;\n        &lt;label for=\"tags\"&gt;Enter your tags(Comma separated)&lt;/label&gt;\n        &lt;br&gt;\n        &lt;input type=\"text\" name=\"tags\"&gt;\n        &lt;input type=\"submit\"&gt;\n    &lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>and this is my go code</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"log\"\n    \"html/template\"\n    \"fmt\"\n    \"github.com/julienschmidt/httprouter\"\n)\n\nfunc main() {\n    router := httprouter.New()\n    router.GET(\"/\",Search)\n    router.GET(\"/search?key=:tags\",GrabQuestions)\n    log.Fatal(http.ListenAndServe(\":8080\",router))\n}\n\nfunc Search(w http.ResponseWriter,r *http.Request,_ httprouter.Params){\n    t,err := template.ParseFiles(\"E:/work/src/github.com/krashcan/sos/template/index.html\")\n    if err!= nil{\n        log.Println(err)\n    }\n    t.Execute(w,nil)\n}\n\nfunc GrabQuestions(w http.ResponseWriter,r *http.Request,ps httprouter.Params){\n    fmt.Fprintf(w,\"Tags were %s\", ps.ByName(\"tags\"))\n}\n</code></pre>\n\n<p>I expected this code to simply print the tags when the submit button was pressed(func GrabQuestions will eventually serve a different task so an alternative way to print the search keys is not what I am looking for), but when I click the submit button, it gives a <code>404 page not found</code> error. I think there is some silly mistake on my part but I just dont see it. What am I missing?</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "edited": false, "score": 0, "creation_date": 1483714239, "post_id": 41506763, "comment_id": 70221997, "body": "Why would you want to do that?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1483741967, "post_id": 41506763, "comment_id": 70236884, "body": "Well: Do not use the empty interface."}], "answers": [{"tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 1, "last_activity_date": 1483709810, "creation_date": 1483709810, "answer_id": 41506939, "question_id": 41506763, "link": "https://stackoverflow.com/questions/41506763/how-to-resolve-whether-pass-objects-via-interface-have-not-initializated-field/41506939#41506939", "title": "How to resolve whether pass objects via interface{} have not initializated fields", "body": "<p>I don\u2019t think there is a good reason (in idiomatic Go) to do what you are trying to do. You need to design your structs so that default values (nil, empty string, 0, false, etc.) are valid and represent the initial state of your object. Look at the source of the standard library, there are lots of examples of that.\n<br>What you are suggesting is easily doable via Reflection but it will be slow and clunky.</p>\n"}, {"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": false, "score": 1, "last_activity_date": 1483711650, "creation_date": 1483711650, "answer_id": 41507466, "question_id": 41506763, "link": "https://stackoverflow.com/questions/41506763/how-to-resolve-whether-pass-objects-via-interface-have-not-initializated-field/41507466#41507466", "title": "How to resolve whether pass objects via interface{} have not initializated fields", "body": "<p>You could narrow the type which your function takes as an argement a little, not take an <code>interface{}</code> but accept one that allows you to check for non-zero values, say <code>type intercae{nonZero() bool}</code> as in the example code below. This will not tell you explicitly that it hasn't been <em>set</em> to the zero value, but that it is not zero.</p>\n\n<pre><code>type nonZeroed interface {\n    nonZero() bool\n}\n\ntype zero struct {\n    hasVals bool\n}\n\nfunc (z zero) nonZero() bool {\n    return z.hasVals\n}\n\ntype nonZero struct {\n    val int\n}\n\nfunc (nz nonZero) nonZero() bool {\n    return nz.val != 0\n}\n\ntype alsoZero float64\n\nfunc (az alsoZero) nonZero() bool {\n    return az != 0.0\n}\n\nfunc main() {\n    z := zero{}\n    nz := nonZero{\n        val: 1,\n    }\n    var az alsoZero\n    fmt.Println(\"z has values:\", initialized(z))\n    fmt.Println(\"nz has values:\", initialized(nz))\n    fmt.Println(\"az has values:\", initialized(az))\n}\n\nfunc initialized(a nonZeroed) bool {\n    return a.nonZero()\n}\n</code></pre>\n\n<p>Obviously as the type get more complex additional verification would need to be made that it was \"nonZero\". This type of pattern could be used to check any sort condition.</p>\n"}, {"tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 6, "last_activity_date": 1483711712, "creation_date": 1483711712, "answer_id": 41507492, "question_id": 41506763, "link": "https://stackoverflow.com/questions/41506763/how-to-resolve-whether-pass-objects-via-interface-have-not-initializated-field/41507492#41507492", "title": "How to resolve whether pass objects via interface{} have not initializated fields", "body": "<p>As Franck notes, this is likely a bad idea. Every value is always initialized in Go. Your actual question is whether the type equals its Zero value. Generally the Zero value should be designed such that it is valid. The better approach would generally be to create an interface along the lines of:</p>\n\n<pre><code>type ZeroChecker interface {\n    IsZero() bool\n}\n</code></pre>\n\n<p>And then attach that to whatever types you want to check. (Or possibly better: create an <code>IsValid()</code> test instead rather than doing your logic backwards.)</p>\n\n<p>That said, it is possible to check this with reflection, by comparing it to its Zero.</p>\n\n<pre><code>func resolveIsNotIntialized(v interface{}) bool {\n    t := reflect.TypeOf(v)\n    z := reflect.Zero(t).Interface()\n    return reflect.DeepEqual(v, z)\n}\n</code></pre>\n\n<p>(You might be able to get away with <code>return v == z</code> here; I haven't thought through all the possible cases.)</p>\n"}], "owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 41507492, "answer_count": 3, "score": 0, "last_activity_date": 1483711712, "creation_date": 1483709191, "question_id": 41506763, "link": "https://stackoverflow.com/questions/41506763/how-to-resolve-whether-pass-objects-via-interface-have-not-initializated-field", "title": "How to resolve whether pass objects via interface{} have not initializated fields", "body": "<p>I have problem with resolve whether object which was pass as interface to function hasn't initializated fields, like object which was defined as just <code>someObject{}</code> is a empty, because all fields, has value 0, or nil</p>\n\n<p>Problem becomes more complicated if I pass diffrent objects, because each object have diffrent type field value so on this moment I don't find universal way to this.</p>\n\n<p>Example</p>\n\n<pre><code>func main(){\n    oo := objectOne{}\n    ot := objectTwo{}\n    oth := objectThree{\"blah\" , \"balbal\" , \"blaal\"}\n    resolveIsNotIntialized(oo)\n    resolveIsNotIntialized(ot)\n    resolveIsNotIntialized(oth)\n}\n\nfunc resolveIsNotIntialized(v interface{}) bool{\n    // and below, how resolve that oo and ot is empty\n    if (v.SomeMethodWhichCanResolveThatAllFiledIsNotIntialized){\n        return true\n    }\n    return false\n}\n</code></pre>\n\n<p>I want to avoid usage <code>switch</code> statement like below, and additional function for each object, ofcorse if is possible.</p>\n\n<pre><code>func unsmartMethod(v interface{}) bool{\n    switch v.(type){\n    case objectOne:\n        if v == (objectOne{}) {\n          return true\n        }\n        // and next object, and next....\n    }\n    return false\n}\n</code></pre>\n"}, {"tags": ["mysql", "rest", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 951, "user_id": 6504152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://lh6.googleusercontent.com/-QGM0TRKgJxg/AAAAAAAAAAI/AAAAAAAAABw/-jeI8itRwUY/photo.jpg?sz=128", "display_name": "Johannes Gnadlinger", "link": "https://stackoverflow.com/users/6504152/johannes-gnadlinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1483908825, "creation_date": 1483908825, "answer_id": 41537783, "question_id": 41505884, "link": "https://stackoverflow.com/questions/41505884/one-to-many-relationship-with-gorm-in-golang-doesnt-work/41537783#41537783", "title": "One to many relationship with gorm in golang doesnt work", "body": "<p>Finally found the answer!!\nThe problem is my GET functions I have to use</p>\n\n<pre><code>db.Preload(\"Functions\").Find(&amp;[]models.Person{})\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>db.Find(&amp;[]models.Person{})\n</code></pre>\n"}], "owner": {"reputation": 951, "user_id": 6504152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://lh6.googleusercontent.com/-QGM0TRKgJxg/AAAAAAAAAAI/AAAAAAAAABw/-jeI8itRwUY/photo.jpg?sz=128", "display_name": "Johannes Gnadlinger", "link": "https://stackoverflow.com/users/6504152/johannes-gnadlinger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1931, "favorite_count": 0, "accepted_answer_id": 41537783, "answer_count": 1, "score": 3, "last_activity_date": 1580467698, "creation_date": 1483706132, "last_edit_date": 1580467698, "question_id": 41505884, "link": "https://stackoverflow.com/questions/41505884/one-to-many-relationship-with-gorm-in-golang-doesnt-work", "title": "One to many relationship with gorm in golang doesnt work", "body": "<p>I have two tables:</p>\n\n<pre><code>type Person struct {\n    ID int\n    FirstName string\n    LastName string\n    Functions []Function\n}\n\ntype Function struct {\n    gorm.Model\n    Info string\n    Person Person\n}\n</code></pre>\n\n<p>I create the tables like this:</p>\n\n<pre><code>db.AutoMigrate(&amp;models.Person{}, &amp;models.Function{})\n</code></pre>\n\n<p>I then initialize the database:</p>\n\n<pre><code>user := models.Person{\n    FirstName: \"Isa\",\n    LastName:  \"istcool\",\n    Functions: []models.Function{{Info: \"Trainer\"}, {Info: \"CEO\"}},\n}\ndb.Create(&amp;user)\n</code></pre>\n\n<p>Now the problem is that my <code>Person</code> table only got <code>Firstname</code> and <code>Lastname</code> columns and my <code>Function</code> table only got the <code>Info</code> column.\nBut when I start my <code>GET</code> request I get people with the column function which is always null.</p>\n\n<p><a href=\"https://imgur.com/74RU2Va\" rel=\"nofollow noreferrer\">Here is a screenshot from my GET request and my db</a></p>\n\n<p>To see the code visit my <a href=\"https://github.com/Gnadlinger/SpommunicateBackend.git\" rel=\"nofollow noreferrer\">GitHub repo</a></p>\n"}, {"tags": ["go", "go-templates", "prometheus"], "answers": [{"comments": [{"owner": {"reputation": 21211, "user_id": 492410, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/afa5f1047c1344242b2b876bc86e872c?s=128&d=identicon&r=PG", "display_name": "ddewaele", "link": "https://stackoverflow.com/users/492410/ddewaele"}, "edited": false, "score": 0, "creation_date": 1483712676, "post_id": 41506321, "comment_id": 70221044, "body": "I can definitely see this as a valid option. however the template is part of a configurable item in the framework, where the Go code that puts the objects into the template is not.  Is there a way to do it within the template or can&#39;t we access that functionality ?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1483713307, "last_edit_date": 1483713307, "creation_date": 1483707653, "answer_id": 41506321, "question_id": 41505689, "link": "https://stackoverflow.com/questions/41505689/sorting-alertmanager-email-templates-in-go-templating/41506321#41506321", "title": "Sorting Alertmanager email templates in Go templating", "body": "<p>Sort the alerts before you pass it to template execution. It's easier, also a template should not alter the data it's destined to display.</p>\n\n<p>Example:</p>\n\n<pre><code>type ByStart []*types.Alert\n\nfunc (a ByStart) Len() int           { return len(a) }\nfunc (a ByStart) Swap(i, j int)      { a[i], a[j] = a[j], a[i] }\nfunc (a ByStart) Less(i, j int) bool { return a[i].StartAt.Before(a[j].StartAt) }\n\nfunc (n *Email) Notify(ctx context.Context, as ...*types.Alert) (bool, error) {\n    ...\n    sort.Sort(ByStart(as))\n    data = n.tmpl.Data(receiverName(ctx), groupLabels(ctx), as...)\n    ...\n}\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>Sorting functionality is not available from templates by default. You can register custom functions that can be called from templates, but this must be done prior to parsing the templates, and from <em>Go</em> code (not from the template text; see <a href=\"https://golang.org/pkg/text/template/#Template.Funcs\" rel=\"nofollow noreferrer\"><code>Template.Funcs()</code></a>). This is so because templates must be statically analyzable, and knowing what custom functions are valid is key when parsing the template text.</p>\n\n<p>Just from the template text, without the help of custom functions, you can't achieve this.</p>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 2823964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15505f73b2284790ca83943aca3994c2?s=128&d=identicon&r=PG", "display_name": "Emmanuel", "link": "https://stackoverflow.com/users/2823964/emmanuel"}, "is_accepted": false, "score": -1, "last_activity_date": 1538053953, "creation_date": 1538053953, "answer_id": 52537845, "question_id": 41505689, "link": "https://stackoverflow.com/questions/41505689/sorting-alertmanager-email-templates-in-go-templating/52537845#52537845", "title": "Sorting Alertmanager email templates in Go templating", "body": "<p>In that alertmanager <a href=\"https://github.com/prometheus/alertmanager/blob/master/template/email.html\" rel=\"nofollow noreferrer\">email template</a> I noticed this line : </p>\n\n<pre><code>  {{ range .Annotations.SortedPairs }}{{ .Name }} = {{ .Value }}&lt;br /&gt;{{ end }}\n</code></pre>\n\n<p>So perhaps you could try: </p>\n\n<pre><code>{{ range .Alerts.Firing.Sorted }}\n</code></pre>\n"}], "owner": {"reputation": 21211, "user_id": 492410, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/afa5f1047c1344242b2b876bc86e872c?s=128&d=identicon&r=PG", "display_name": "ddewaele", "link": "https://stackoverflow.com/users/492410/ddewaele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1243, "favorite_count": 0, "accepted_answer_id": 41506321, "answer_count": 2, "score": 4, "last_activity_date": 1538053953, "creation_date": 1483705481, "question_id": 41505689, "link": "https://stackoverflow.com/questions/41505689/sorting-alertmanager-email-templates-in-go-templating", "title": "Sorting Alertmanager email templates in Go templating", "body": "<p>I'm trying to customize an Email template from <a href=\"http://github.com/prometheus/alertmanager\" rel=\"nofollow noreferrer\">AlertManager</a>  that uses a Go html template that prints a list of alerts using the following construct :</p>\n\n<pre><code>{{ range .Alerts.Firing }}\n</code></pre>\n\n<p>It gets inserted into the template like this :</p>\n\n<pre><code>func (n *Email) Notify(ctx context.Context, as ...*types.Alert) (bool, error) {\n   ...\n   data = n.tmpl.Data(receiverName(ctx), groupLabels(ctx), as...)\n   ...\n}\n</code></pre>\n\n<p>Alert being defined like this :</p>\n\n<pre><code>type Alert struct {\n    Labels LabelSet `json:\"labels\"`\n\n    Annotations LabelSet `json:\"annotations\"`\n\n    StartsAt     time.Time `json:\"startsAt,omitempty\"`\n    EndsAt       time.Time `json:\"endsAt,omitempty\"`\n    GeneratorURL string    `json:\"generatorURL\"`\n}\n</code></pre>\n\n<p>I would like to do the sorting on the StartsAt field.</p>\n\n<p>I tried using the sort function but it wasn't available in the email template.</p>\n\n<pre><code>{{ range sort .Alerts.Firing }}\n</code></pre>\n\n<p>I'm getting </p>\n\n<pre><code>function \\\"sort\\\" not defined\n</code></pre>\n\n<p>Any ideas on how I can get it to sort on StartsAt ?</p>\n"}, {"tags": ["go", "time"], "answers": [{"comments": [{"owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "edited": false, "score": 0, "creation_date": 1483702232, "post_id": 41503910, "comment_id": 70214697, "body": "I want to convert jitter to milliseconds which I am getting in microseconds. jitter is time.Duration type. And this is not working for it. I tried doing jitter = (stats.StdDevRtt/time.Nanosecond)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "edited": false, "score": 0, "creation_date": 1483702736, "post_id": 41503910, "comment_id": 70214994, "body": "@supriya It&#39;s the second half of my answer: to get it in milliseconds: <code>ms := int64(d2 &#47; time.Millisecond)</code>"}, {"owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "edited": false, "score": 0, "creation_date": 1483943983, "post_id": 41503910, "comment_id": 70289388, "body": "when I am doing ms := int64(d2 / time.Millisecond), it is giving jitter =0 which is right as jitter I am getting is 61 microseconds which will be 0.061 milliseconds and when rounded off with int, it will give 0 as jitter value, but this is not what I want... I want jitter value in decimal places i.e. 0.061.... Is there any way to do so?"}, {"owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "edited": false, "score": 0, "creation_date": 1483952674, "post_id": 41503910, "comment_id": 70293196, "body": "it worked.One more doubt I have. What it is printing now is &quot;0.061&quot;. Can I get it like &quot;0.061 ms&quot; ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "edited": false, "score": 0, "creation_date": 1483954749, "post_id": 41503910, "comment_id": 70294400, "body": "@supriya You can print it however you like: <code>fmt.Printf(&quot;%.3f ms&quot;, ms)</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 127, "last_activity_date": 1483948713, "last_edit_date": 1495541349, "creation_date": 1483699325, "answer_id": 41503910, "question_id": 41503758, "link": "https://stackoverflow.com/questions/41503758/conversion-of-time-duration-type-microseconds-value-to-milliseconds/41503910#41503910", "title": "Conversion of time.Duration type microseconds value to milliseconds", "body": "<h3>Number to <code>time.Duration</code></h3>\n\n<p><a href=\"https://golang.org/pkg/time/#Duration\" rel=\"noreferrer\"><code>time.Duration</code></a> is a type having <code>int64</code> as its <a href=\"https://golang.org/ref/spec#Types\" rel=\"noreferrer\">underlying type</a>, which stores the duration in nanoseconds.</p>\n\n<p>If you know the value but you want other than nanoseconds, simply multiply the unit you want, e.g.:</p>\n\n<pre><code>d := 100 * time.Microsecond\nfmt.Println(d) // Output: 100\u00b5s\n</code></pre>\n\n<p>The above works because <code>100</code> is an untyped <a href=\"https://golang.org/ref/spec#Constants\" rel=\"noreferrer\">constant</a>, and it can be converted automatically to <code>time.Duration</code> which has <code>int64</code> underlying type.</p>\n\n<p>Note that if you have the value as a typed value, you have to use explicit <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">type conversion</a>:</p>\n\n<pre><code>value := 100 // value is of type int\n\nd2 := time.Duration(value) * time.Millisecond\nfmt.Println(d2) // Output: 100ms\n</code></pre>\n\n<h3><code>time.Duration</code> to number</h3>\n\n<p>So <code>time.Duration</code> is always the nanoseconds. If you need it in milliseconds for example, all you need to do is divide the <code>time.Duration</code> value with the number of nanoseconds in a millisecond:</p>\n\n<pre><code>ms := int64(d2 / time.Millisecond)\nfmt.Println(\"ms:\", ms) // Output: ms: 100\n</code></pre>\n\n<p>Other examples:</p>\n\n<pre><code>fmt.Println(\"ns:\", int64(d2/time.Nanosecond))  // ns: 100000000\nfmt.Println(\"\u00b5s:\", int64(d2/time.Microsecond)) // \u00b5s: 100000\nfmt.Println(\"ms:\", int64(d2/time.Millisecond)) // ms: 100\n</code></pre>\n\n<p>Try the examples on the <a href=\"https://play.golang.org/p/xLmj_Qzb81\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>If your jitter (duration) is less than the unit you whish to convert it to, you need to use floating point division, else an integer division will be performed which cuts off the fraction part. For details see: <a href=\"https://stackoverflow.com/questions/39544571/golang-round-to-nearest-0-05/39544897#39544897\">Golang Round to Nearest 0.05</a>.</p>\n\n<p>Convert both the jitter and unit to <code>float64</code> before dividing:</p>\n\n<pre><code>d := 61 * time.Microsecond\nfmt.Println(d) // Output: 61\u00b5s\n\nms := float64(d) / float64(time.Millisecond)\nfmt.Println(\"ms:\", ms) // Output: ms: 0.061\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/mdB_JMw_zN\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>61\u00b5s\nms: 0.061\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "edited": false, "score": 0, "creation_date": 1483943586, "post_id": 41504591, "comment_id": 70289263, "body": "I tried doing jitterInMilliSeconds := (jitter / time.Microsecond) so what I am getting is jitter in nanoseconds now.... as you have written in your answer that while printing time.Duration type value, string method is called and it ensures that while printing , leading digit is non-zero. As jitter value I am getting is 64.6 microsecond so in miliseconds it will be 0.064 milliseconds which is less than zero. So is it the reason that I am getting it on nanoceconds when divided by time.Microsecond... Is there any way to do it?"}, {"owner": {"reputation": 4379, "user_id": 184176, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/811251725188ac87f9125177073c28d0?s=128&d=identicon&r=PG", "display_name": "sepehr", "link": "https://stackoverflow.com/users/184176/sepehr"}, "reply_to_user": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "edited": false, "score": 0, "creation_date": 1483955894, "post_id": 41504591, "comment_id": 70295127, "body": "@supriya sorry, <code>jitterInMilliSeconds</code> variable should be <code>latencyInMicroSeconds</code> (already fixed), maybe this sample helps to figure it out: <a href=\"https://gist.github.com/sepehrmm/0c46f3b6cc417c9db21c15f767197c4a\" rel=\"nofollow noreferrer\">gist.github.com/sepehrmm/0c46f3b6cc417c9db21c15f767197c4a</a>"}], "tags": [], "owner": {"reputation": 4379, "user_id": 184176, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/811251725188ac87f9125177073c28d0?s=128&d=identicon&r=PG", "display_name": "sepehr", "link": "https://stackoverflow.com/users/184176/sepehr"}, "is_accepted": false, "score": 4, "last_activity_date": 1483956089, "last_edit_date": 1483956089, "creation_date": 1483701628, "answer_id": 41504591, "question_id": 41503758, "link": "https://stackoverflow.com/questions/41503758/conversion-of-time-duration-type-microseconds-value-to-milliseconds/41504591#41504591", "title": "Conversion of time.Duration type microseconds value to milliseconds", "body": "<p>The type of <code>latency</code> and <code>jitter</code> variables is <code>time.Duration</code> which per <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"nofollow noreferrer\">definition</a> its base type is int64 and is expressed in nanosecond.</p>\n\n<p>When you use print functions the <a href=\"https://golang.org/src/time/time.go\" rel=\"nofollow noreferrer\"><code>String</code></a>\u200d\u200d\u200d\u200d \u200dmethod of type <code>time.Duration</code> is invoked and it use <code>h</code>, <code>s</code>, <code>m</code>, <code>\u00b5</code>, <code>n</code> notations when printing the duration, here is the documentation for <code>String</code> method:</p>\n\n<pre><code>// String returns a string representing the duration in the form \"72h3m0.5s\".\n// Leading zero units are omitted. As a special case, durations less than one\n// second format use a smaller unit (milli-, micro-, or nanoseconds) to ensure\n// that the leading digit is non-zero. The zero duration formats as 0s.\n</code></pre>\n\n<p>There are some pre defined <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"nofollow noreferrer\">constants</a> in time package which you can use to convert the duration variable to your preferred unit of time, like this:</p>\n\n<pre><code>latencyInMicroSeconds := int64(jitter / time.Microsecond)\n</code></pre>\n\n<p>Pay attention that we converted it to a <code>int</code> type because if you won't it would be still in <code>time.Duration</code> type and the value of that type is considered to be in nano second unit but now it's micro second which cause further problem in calculations if you're going to use time package functions.</p>\n"}, {"comments": [{"owner": {"reputation": 2916, "user_id": 1745432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de8eed2933662cd85e6a5eee3eb9f2fa?s=128&d=identicon&r=PG", "display_name": "Kpym", "link": "https://stackoverflow.com/users/1745432/kpym"}, "edited": false, "score": 1, "creation_date": 1606567735, "post_id": 58589912, "comment_id": 115001712, "body": "Remark : these methods truncate do not round. For example for 0.999\u03bcs we can see that  <code>time.Duration(999).Microseconds()</code> returns <code>0</code>."}], "tags": [], "owner": {"reputation": 396, "user_id": 4981063, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZUysyaPMZro/AAAAAAAAAAI/AAAAAAAAANI/JkDEDrXWL-o/photo.jpg?sz=128", "display_name": "Xesina", "link": "https://stackoverflow.com/users/4981063/xesina"}, "is_accepted": false, "score": 7, "last_activity_date": 1572261128, "creation_date": 1572261128, "answer_id": 58589912, "question_id": 41503758, "link": "https://stackoverflow.com/questions/41503758/conversion-of-time-duration-type-microseconds-value-to-milliseconds/58589912#58589912", "title": "Conversion of time.Duration type microseconds value to milliseconds", "body": "<p>As of Go 1.13, you can use new Duration methods <code>Microseconds</code> and <code>Milliseconds</code> which return the duration as an integer count of their respectively named units.</p>\n\n<p><a href=\"https://golang.org/doc/go1.13#time\" rel=\"noreferrer\">https://golang.org/doc/go1.13#time</a></p>\n"}], "owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97039, "favorite_count": 11, "accepted_answer_id": 41503910, "answer_count": 3, "score": 49, "last_activity_date": 1572261128, "creation_date": 1483698814, "last_edit_date": 1501586412, "question_id": 41503758, "link": "https://stackoverflow.com/questions/41503758/conversion-of-time-duration-type-microseconds-value-to-milliseconds", "title": "Conversion of time.Duration type microseconds value to milliseconds", "body": "<p>I am using go-ping ( <a href=\"https://github.com/sparrc/go-ping\" rel=\"noreferrer\">https://github.com/sparrc/go-ping</a> )library of golang for unprivileged ICMP ping.</p>\n\n<pre><code>timeout := time.Second*1000\ninterval := time.Second\ncount := 5\nhost := p.ipAddr\npinger, cmdErr := ping.NewPinger(host)\n\npinger.Count = count\npinger.Interval = interval\npinger.Timeout = timeout\npinger.SetPrivileged(false)\npinger.Run()\nstats := pinger.Statistics()\n\nlatency = stats.AvgRtt  // stats.AvgRtt is time.Duration type\njitter = stats.StdDevRtt// stats.StdDevRtt is time.Duration type\n</code></pre>\n\n<p>From running this, I am getting latency in milliseconds and jitter in microseconds. I want same unit for both let's say millisecond so when I am doing <code>jitter = stats.StdDevRtt/1000</code> or <code>jitter = jitter/1000</code> (to convert microseconds to milliseconds), what I am getting is jitter in nanoseconds :(. Is there any way to get same unit milliseconds for both latency and jitter.</p>\n"}, {"tags": ["json", "go", "struct", "nested"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1483696595, "post_id": 41502902, "comment_id": 70211432, "body": "What is the question? You can use <code>Children []locationNode</code> and it will work."}, {"owner": {"reputation": 270, "user_id": 7300777, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-kSxhRcDsF44/AAAAAAAAAAI/AAAAAAAAAIE/ip2W_GX5Kl4/photo.jpg?sz=128", "display_name": "Fandy Dharmawan", "link": "https://stackoverflow.com/users/7300777/fandy-dharmawan"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1483697295, "post_id": 41502902, "comment_id": 70211841, "body": "umm but i got an error {&quot;error&quot;:&quot;json: cannot unmarshal object into Go value of type []address.locationNode&quot;}"}], "answers": [{"comments": [{"owner": {"reputation": 270, "user_id": 7300777, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-kSxhRcDsF44/AAAAAAAAAAI/AAAAAAAAAIE/ip2W_GX5Kl4/photo.jpg?sz=128", "display_name": "Fandy Dharmawan", "link": "https://stackoverflow.com/users/7300777/fandy-dharmawan"}, "edited": false, "score": 0, "creation_date": 1483696838, "post_id": 41503056, "comment_id": 70211563, "body": "Thanks for your comment but this is not ideal bcoz technically the children could have children and so on.   &quot;children&quot;: [       {         &quot;id&quot;: 9,         &quot;title&quot;: &quot;Jakarta&quot;,         &quot;type&quot;: &quot;city&quot;,         &quot;attributes&quot;: {},         &quot;children&quot;: [{},{},{}]     },..."}, {"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "reply_to_user": {"reputation": 270, "user_id": 7300777, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-kSxhRcDsF44/AAAAAAAAAAI/AAAAAAAAAIE/ip2W_GX5Kl4/photo.jpg?sz=128", "display_name": "Fandy Dharmawan", "link": "https://stackoverflow.com/users/7300777/fandy-dharmawan"}, "edited": false, "score": 0, "creation_date": 1483697710, "post_id": 41503056, "comment_id": 70212109, "body": "It&#39;s important to know that the tool exists plus it should give you a head start in customizing it to your need."}], "tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 1, "last_activity_date": 1483707861, "last_edit_date": 1483707861, "creation_date": 1483696449, "answer_id": 41503056, "question_id": 41502902, "link": "https://stackoverflow.com/questions/41502902/json-nested-struct-to-itself-in-go-language/41503056#41503056", "title": "JSON nested struct to itself in Go Language", "body": "<p>Using <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">https://mholt.github.io/json-to-go/</a> your JSON converts to </p>\n\n<pre><code>type AutoGenerated struct {\n    ID int `json:\"id\"`\n    Title string `json:\"title\"`\n    Type string `json:\"type\"`\n    Attributes struct {\n        RegionCode string `json:\"regionCode\"`\n        Information struct {\n            Title string `json:\"title\"`\n            Content string `json:\"content\"`\n            Image string `json:\"image\"`\n        } `json:\"information\"`\n    } `json:\"attributes\"`\n    Children []struct {\n        ID int `json:\"id\"`\n        Title string `json:\"title\"`\n        Type string `json:\"type\"`\n        Attributes struct {\n            RegionCode string `json:\"regionCode\"`\n            Information struct {\n                Title string `json:\"title\"`\n                Content string `json:\"content\"`\n                Image string `json:\"image\"`\n            } `json:\"information\"`\n        } `json:\"attributes\"`\n    } `json:\"children\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1483698091, "last_edit_date": 1483698091, "creation_date": 1483697748, "answer_id": 41503443, "question_id": 41502902, "link": "https://stackoverflow.com/questions/41502902/json-nested-struct-to-itself-in-go-language/41503443#41503443", "title": "JSON nested struct to itself in Go Language", "body": "<p>Besides the fact that in the JSON text the <code>\"id\"</code> field is a number and not <code>string</code>, it works for me.</p>\n\n<p>Omitting the <code>\"attributes\"</code> to make the example shorter:</p>\n\n<pre><code>type locationNode struct {\n    ID       int            `json:\"id\"`\n    Title    string         `json:\"title\"`\n    Type     string         `json:\"type\"`\n    Children []locationNode `json:\"children\"`\n}\n\nfunc main() {\n    ln := locationNode{}\n\n    err := json.Unmarshal([]byte(src), &amp;ln)\n\n    fmt.Printf(\"%+v %v\\n\", ln, err)\n}\n\nconst src = `{\n  \"id\": 8,\n  \"title\": \"Indonesia\",\n  \"type\": \"country\",\n  \"attributes\": {\n    \"regionCode\": \"ID\",\n    \"information\": {\n      \"title\": \"Welcome to Indonesia\",\n      \"content\": \"We only serve selected areas in Indonesia.\",\n      \"image\": \"indo.png\"\n    }\n  },\n  \"children\": [\n    {\n      \"id\": 9,\n      \"title\": \"Jakarta\",\n      \"type\": \"city\",\n      \"attributes\": {\n        \"regionCode\": \"ID-JKT\",\n        \"information\": {\n          \"title\": \"Welcome to Capital City of Indonesia\",\n          \"content\": \"We only serve selected areas in Jabotabek\",\n          \"image\": \"jakarta.png\"\n        }\n      }       \n    },\n    {\n      \"id\": 10,\n      \"title\": \"Bali\",\n      \"type\": \"city\",\n      \"attributes\": {\n        \"regionCode\": \"ID-BAL\",\n        \"information\": {\n          \"title\": \"Welcome to the beach city Bali\",\n          \"content\": \"We only serve selected areas in Bali.\",\n          \"image\": \"bali.png\"\n        }   \n      }       \n    }\n  ]\n}`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/1_7ndrg9Ni\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{ID:8 Title:Indonesia Type:country Children:[{ID:9 Title:Jakarta Type:city Children:[]} {ID:10 Title:Bali Type:city Children:[]}]} &lt;nil&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 270, "user_id": 7300777, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-kSxhRcDsF44/AAAAAAAAAAI/AAAAAAAAAIE/ip2W_GX5Kl4/photo.jpg?sz=128", "display_name": "Fandy Dharmawan", "link": "https://stackoverflow.com/users/7300777/fandy-dharmawan"}, "is_accepted": true, "score": 0, "last_activity_date": 1483703309, "last_edit_date": 1483703309, "creation_date": 1483697960, "answer_id": 41503514, "question_id": 41502902, "link": "https://stackoverflow.com/questions/41502902/json-nested-struct-to-itself-in-go-language/41503514#41503514", "title": "JSON nested struct to itself in Go Language", "body": "<p>Okay I managed to resolve this - it's actually a silly careless mistake, since my struct is already an array I should NOT define the children as an array.</p>\n\n<p>So below definition works</p>\n\n<pre><code>type locationNode []struct {\n  ID         string             `json:\"id\"`\n  Title      string             `json:\"title\"`\n  Type       string             `json:\"type\"`\n  Attributes locationAttribute  `json:\"attributes\"`\n  Children   locationNode     `json:\"children\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": false, "score": 0, "last_activity_date": 1483698552, "creation_date": 1483698552, "answer_id": 41503685, "question_id": 41502902, "link": "https://stackoverflow.com/questions/41502902/json-nested-struct-to-itself-in-go-language/41503685#41503685", "title": "JSON nested struct to itself in Go Language", "body": "<p>It certainly looks like defining <code>Children</code> in the way you expect works fine. The following both marshals and unmarshals fine.</p>\n\n<pre><code>type Bob struct {\n    ID         string            `json:\"id\"`\n    Title      string            `json:\"title\"`\n    Type       string            `json:\"type\"`\n    Attributes int               `json:\"attributes\"`\n    Children   []Bob             `json:\"children\"`\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/KN5R3_RqoX\" rel=\"nofollow noreferrer\">Playground link</a></p>\n"}], "owner": {"reputation": 270, "user_id": 7300777, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-kSxhRcDsF44/AAAAAAAAAAI/AAAAAAAAAIE/ip2W_GX5Kl4/photo.jpg?sz=128", "display_name": "Fandy Dharmawan", "link": "https://stackoverflow.com/users/7300777/fandy-dharmawan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 41503514, "answer_count": 4, "score": 2, "last_activity_date": 1483707861, "creation_date": 1483695910, "last_edit_date": 1483697398, "question_id": 41502902, "link": "https://stackoverflow.com/questions/41502902/json-nested-struct-to-itself-in-go-language", "title": "JSON nested struct to itself in Go Language", "body": "<p>I have below JSON</p>\n\n<pre><code>[{\n  \"id\": 8,\n  \"title\": \"Indonesia\",\n  \"type\": \"country\",\n  \"attributes\": {\n    \"regionCode\": \"ID\",\n    \"information\": {\n      \"title\": \"Welcome to Indonesia\",\n      \"content\": \"We only serve selected areas in Indonesia.\",\n      \"image\": \"indo.png\"\n    }\n  },\n  \"children\": [\n    {\n      \"id\": 9,\n      \"title\": \"Jakarta\",\n      \"type\": \"city\",\n      \"attributes\": {\n        \"regionCode\": \"ID-JKT\",\n        \"information\": {\n          \"title\": \"Welcome to Capital City of Indonesia\",\n          \"content\": \"We only serve selected areas in Jabotabek\",\n          \"image\": \"jakarta.png\"\n        }\n      }       \n    },\n    {\n      \"id\": 10,\n      \"title\": \"Bali\",\n      \"type\": \"city\",\n      \"attributes\": {\n        \"regionCode\": \"ID-BAL\",\n        \"information\": {\n          \"title\": \"Welcome to the beach city Bali\",\n          \"content\": \"We only serve selected areas in Bali.\",\n          \"image\": \"bali.png\"\n        }   \n      }       \n    }\n  ]\n}]\n</code></pre>\n\n<p>Technically this is a nested structure to itself as the children node, and the children might have children as well. But i just couldnt get it right when im using unmarshal to decode this.</p>\n\n<p>The working one is like below <code>i have no problem defining the attribute as a separate struct so assuming i have locationAttribute struct</code></p>\n\n<pre><code>type locationNode []struct {\n    ID         string             `json:\"id\"`\n    Title      string             `json:\"title\"`\n    Type       string             `json:\"type\"`\n    Attributes locationAttribute `json:\"attributes\"`\n    Children   []struct {\n        ID         string             `json:\"id\"`\n        Title      string             `json:\"title\"`\n        Type       string             `json:\"type\"`\n        Attributes locationAttribute `json:\"attributes\"`\n        Children   []interface{}      `json:\"children\"`\n    } `json:\"children\"`\n}\n</code></pre>\n\n<p>However im expecting to be something like below</p>\n\n<pre><code>type locationNode []struct {\n    ID         string             `json:\"id\"`\n    Title      string             `json:\"title\"`\n    Type       string             `json:\"type\"`\n    Attributes locationAttribute `json:\"attributes\"`\n    Children   []locationNode `json:\"children\"`\n}\n</code></pre>\n\n<p>any help will be much appreciated</p>\n"}]