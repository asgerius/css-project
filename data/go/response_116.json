[{"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1490836357, "post_id": 43105676, "comment_id": 73294734, "body": "Update your dependency?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490851804, "post_id": 43105676, "comment_id": 73298807, "body": "Need more information. Post some code please."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490856998, "post_id": 43105676, "comment_id": 73301362, "body": "@Tokoshiro if you have the latest Revel version, try changing <code>RenderArgs</code> to <code>ViewArgs</code>."}], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490856460, "post_id": 43109259, "comment_id": 73301037, "body": "I think he&#39;s looking for this <a href=\"https://github.com/revel/revel/commit/a343bf7140d4f7059aebe0788c6d0e2c67e86295\" rel=\"nofollow noreferrer\">github.com/revel/revel/commit/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 0, "last_activity_date": 1490851757, "last_edit_date": 1592644375, "creation_date": 1490851757, "answer_id": 43109259, "question_id": 43105676, "link": "https://stackoverflow.com/questions/43105676/using-go-and-revel-getting-error-c-renderargs-is-undefined-possibly-outdated/43109259#43109259", "title": "Using Go and Revel, getting error c.RenderArgs is Undefined (possibly outdated?)", "body": "<p>Without posting more of your code, your question cannot be accurately answered, but here is what I found in the <a href=\"https://godoc.org/github.com/robfig/revel#Controller.Render\" rel=\"nofollow noreferrer\">Godocs for Revel</a>.</p>\n<blockquote>\n<p>func (c *Controller) Render(extraRenderArgs ...interface{}) Result</p>\n<p>Render a template corresponding to the calling Controller method. Arguments will be added to c.RenderArgs prior to rendering the template. They are keyed on their local identifier.</p>\n</blockquote>\n<p>I believe your code is either trying to modify a field that was changed to be no longer exported, or calling a method that has been changed to the one above.</p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 3828071, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001920148290/picture?type=large", "display_name": "Sunni Sun", "link": "https://stackoverflow.com/users/3828071/sunni-sun"}, "is_accepted": false, "score": 0, "last_activity_date": 1491452454, "creation_date": 1491452454, "answer_id": 43245647, "question_id": 43105676, "link": "https://stackoverflow.com/questions/43105676/using-go-and-revel-getting-error-c-renderargs-is-undefined-possibly-outdated/43245647#43245647", "title": "Using Go and Revel, getting error c.RenderArgs is Undefined (possibly outdated?)", "body": "<p>Tokoshiro</p>\n\n<p>Please check your revel version and you project dependence revel version.<br>\nDue to revel v0.14.1 released, some variables name are changed.</p>\n\n<p>Please check the release note. <a href=\"https://github.com/revel/revel/releases/tag/v0.14.0\" rel=\"nofollow noreferrer\">revel v0.14.1 release note</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6302974, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zz3yHNj6JB4/AAAAAAAAAAI/AAAAAAAAAKg/spC7Y-ASDrY/photo.jpg?sz=128", "display_name": "Keith", "link": "https://stackoverflow.com/users/6302974/keith"}, "is_accepted": false, "score": 1, "last_activity_date": 1492291636, "last_edit_date": 1492291636, "creation_date": 1492275561, "answer_id": 43428772, "question_id": 43105676, "link": "https://stackoverflow.com/questions/43105676/using-go-and-revel-getting-error-c-renderargs-is-undefined-possibly-outdated/43428772#43428772", "title": "Using Go and Revel, getting error c.RenderArgs is Undefined (possibly outdated?)", "body": "<p>Use <code>ViewArgs</code> instead of <code>RenderArgs</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 3859362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9926bc5c4dc221362b70d246ef44740?s=128&d=identicon&r=PG&f=1", "display_name": "Tokoshiro", "link": "https://stackoverflow.com/users/3859362/tokoshiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1492291636, "creation_date": 1490828467, "question_id": 43105676, "link": "https://stackoverflow.com/questions/43105676/using-go-and-revel-getting-error-c-renderargs-is-undefined-possibly-outdated", "title": "Using Go and Revel, getting error c.RenderArgs is Undefined (possibly outdated?)", "body": "<p>I have a script that has some Go code with outdated revel. I ran into an issue that says:</p>\n\n<pre><code> c.RenderArgs undefined (type *revel.Controller has no field or method RenderArgs)\n</code></pre>\n\n<p>And ive tried to search around, but can't figure out what to replace it with to fix the error. I'm not familiar with revel so its making things that much more difficult. </p>\n\n<p>If someone could help, or simply link me to a space that could help(if i missed it, and i am sorry) i would be greatful!</p>\n"}, {"tags": ["heroku", "go", "deployment"], "comments": [{"owner": {"reputation": 5178, "user_id": 2577840, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1520578334/picture?type=large", "display_name": "Micha\u0142 M\u0142o\u017aniak", "link": "https://stackoverflow.com/users/2577840/micha%c5%82-m%c5%82o%c5%baniak"}, "edited": false, "score": 0, "creation_date": 1490829006, "post_id": 43105594, "comment_id": 73292737, "body": "What is the exact error, because what you posted doesn&#39;t look like error. Heroku populates <code>PORT</code> automatically, you shouldn&#39;t set it yourself."}, {"owner": {"reputation": 14127, "user_id": 641627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEgWh.jpg?s=128&g=1", "display_name": "alexbt", "link": "https://stackoverflow.com/users/641627/alexbt"}, "reply_to_user": {"reputation": 5178, "user_id": 2577840, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1520578334/picture?type=large", "display_name": "Micha\u0142 M\u0142o\u017aniak", "link": "https://stackoverflow.com/users/2577840/micha%c5%82-m%c5%82o%c5%baniak"}, "edited": false, "score": 0, "creation_date": 1490841484, "post_id": 43105594, "comment_id": 73295946, "body": "Please post the lines before this &quot;error&quot;. You can see [<a href=\"https://devcenter.heroku.com/articles/error-codes#h10-app-crashed](on\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/error-codes#h10-app-crashed](&zwnj;&#8203;on</a> herolu), H10 means it crashed, but you need to look at the previous logs. Also @Micha\u0142M\u0142o\u017aniak is right, remove PORT from your variable, heroku is already providing you the PORT to use at runtime..."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490847531, "post_id": 43105594, "comment_id": 73297433, "body": "If you (or Heroku) set PORT to <code>:80</code> than <code>&quot;:&quot;+os.Getenv(&quot;PORT&quot;)</code> is one colon too much."}, {"owner": {"reputation": 873, "user_id": 5303460, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7370b6d79ff8a15cedc2c69fc9c71e3b?s=128&d=identicon&r=PG", "display_name": "Tural Asgar", "link": "https://stackoverflow.com/users/5303460/tural-asgar"}, "edited": false, "score": 0, "creation_date": 1490855123, "post_id": 43105594, "comment_id": 73300296, "body": "` Starting process with command <code>login</code> Process exited with status 1 login: Cannot possibly work without effective root`  here <code>login</code> is my root folder and my <code>Procfile</code> is like <code>web: login</code>"}], "owner": {"reputation": 873, "user_id": 5303460, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7370b6d79ff8a15cedc2c69fc9c71e3b?s=128&d=identicon&r=PG", "display_name": "Tural Asgar", "link": "https://stackoverflow.com/users/5303460/tural-asgar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490827965, "creation_date": 1490827965, "question_id": 43105594, "link": "https://stackoverflow.com/questions/43105594/why-do-i-get-this-error-at-error-code-h10-desc-app-crashed-on-heroku", "title": "Why do I get this error &#39; at=error code=H10 desc=&quot;App crashed&quot; &#39; on Heroku?", "body": "<p>I have deployed my application written with Go to Heroku. As soon as I open app it gives me error. I check logs it shows this error.\nPS. I am listening by calling <code>http.ListenAndServe(\":\"+os.Getenv(\"PORT\"), nil)</code>. I have set <code>PORT</code> environment variable to :80.</p>\n"}, {"tags": ["encryption", "go", "aes", "cryptojs"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1490819065, "post_id": 43103343, "comment_id": 73288494, "body": "Is it just missing the end <code>}</code> or am I not seeing something?"}, {"owner": {"reputation": 3278, "user_id": 6435651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b5799143f90155b74e518118a3d1b62?s=128&d=identicon&r=PG&f=1", "display_name": "Ivaylo Ivanov", "link": "https://stackoverflow.com/users/6435651/ivaylo-ivanov"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490819245, "post_id": 43103343, "comment_id": 73288595, "body": "space and }, 2 characters"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1490819772, "post_id": 43103343, "comment_id": 73288911, "body": "The variable names <code>decryptedText</code> and <code>decryptedIV</code> are not accurate and confusing, they are the decoded Base64 and actually the encrypted data and IV. It is also easier to debug if the decryption is no into the same buffer as the encrypted data."}, {"owner": {"reputation": 3278, "user_id": 6435651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b5799143f90155b74e518118a3d1b62?s=128&d=identicon&r=PG&f=1", "display_name": "Ivaylo Ivanov", "link": "https://stackoverflow.com/users/6435651/ivaylo-ivanov"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1490820036, "post_id": 43103343, "comment_id": 73289053, "body": "@zaph correct, edited. However I was not able to use another buffer"}, {"owner": {"reputation": 95, "user_id": 10438705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448ef964bc1090e2a49cc8b4fac6ca2f?s=128&d=identicon&r=PG&f=1", "display_name": "Neha", "link": "https://stackoverflow.com/users/10438705/neha"}, "edited": false, "score": 0, "creation_date": 1576690605, "post_id": 43103343, "comment_id": 104983920, "body": "@IvayloIvanov Hello, I have currently been working on encryption and I am in the same situation. I am encrypting the message in frontend using Cryptojs and decrypting it in Go. The code I have in Go decrypts the message but gives gibberish value in the end. I found your working solution and trying to replicate the same. Your code has a function called ParseHex(). Would you please share this function implementation or tell me what exactly the function is doing? Thank you in advance!"}, {"owner": {"reputation": 3278, "user_id": 6435651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b5799143f90155b74e518118a3d1b62?s=128&d=identicon&r=PG&f=1", "display_name": "Ivaylo Ivanov", "link": "https://stackoverflow.com/users/6435651/ivaylo-ivanov"}, "reply_to_user": {"reputation": 95, "user_id": 10438705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448ef964bc1090e2a49cc8b4fac6ca2f?s=128&d=identicon&r=PG&f=1", "display_name": "Neha", "link": "https://stackoverflow.com/users/10438705/neha"}, "edited": false, "score": 0, "creation_date": 1576854544, "post_id": 43103343, "comment_id": 105040877, "body": "Hello @Neha I&#39;ve tried to find the repository where I have the code.. I&#39;m not sure if that&#39;s the one, but looking at it, it might. I&#39;ve created a public gist. Hope that helps <a href=\"https://gist.github.com/ivaylopivanov/a1e27e7e1e3cc2263d5fa536ab66016b\" rel=\"nofollow noreferrer\">gist.github.com/ivaylopivanov/a1e27e7e1e3cc2263d5fa536ab6601&zwnj;&#8203;6b</a>"}, {"owner": {"reputation": 95, "user_id": 10438705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448ef964bc1090e2a49cc8b4fac6ca2f?s=128&d=identicon&r=PG&f=1", "display_name": "Neha", "link": "https://stackoverflow.com/users/10438705/neha"}, "edited": false, "score": 0, "creation_date": 1576859617, "post_id": 43103343, "comment_id": 105043062, "body": "@IvayloIvanov thanks a lot!"}], "answers": [{"comments": [{"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 2, "creation_date": 1490825636, "post_id": 43104371, "comment_id": 73291652, "body": "The <code>5</code> char is the PKCS7 block padding\u2014oddly the Go crypto libs don\u2019t include any padding code so you have to add padding when encrypting and remove padding when decrypting yourself. Another issue is that if the <code>=</code> characters are missing (which is the case in the example ciphertext) then there will be an error with the <code>StdEncoding</code> base64 decoder. This can be fixed by making sure the <code>=</code> characters are always included, or more robustly by using the <code>RawStdEncoding</code>: <a href=\"https://play.golang.org/p/-XLlPoMHDN\" rel=\"nofollow noreferrer\">play.golang.org/p/-XLlPoMHDN</a>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1490826341, "post_id": 43104371, "comment_id": 73291907, "body": "I tried <code>RawStdEncoding</code> and it still complained about the junk chars. I guess the best way to fix it is to remove all the <code>5</code>s and use <code>RawStdEncoding</code>. Thanks for the insight @matt"}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1490826664, "post_id": 43104371, "comment_id": 73292026, "body": "Yes, <code>RawStdEncoding</code> will work if the <code>=</code> chars are missing, but not if there are extra chars there such as the trailing padding bytes. (There are <i>two</i> problems here\u2014the missing <code>=</code> characters and the block padding not being stripped. It just happens that they both cause the same error (and confusingly they both involve \u201cpadding\u201d of some sort))."}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1490826854, "post_id": 43104371, "comment_id": 73292079, "body": "The <a href=\"https://en.wikipedia.org/wiki/Padding_(cryptography)#PKCS7\" rel=\"nofollow noreferrer\">PKCS7 padding</a> character isn\u2019t necessarily <code>5</code>, it depends on how much padding is needed. It could be 1\u201316."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1490827229, "post_id": 43104371, "comment_id": 73292199, "body": "So if the last char is out of base64 range, then remove that many chars? That is a lot easier, unless the PKCS7 byte size is large enough to need 43 chars of padding XD. Edited for this."}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1490827476, "post_id": 43104371, "comment_id": 73292299, "body": "Nearly\u2014you <i>always</i> remove padding. So just look at the last byte and remove that many bytes. (Ideally you should really also check that this number is less or equal to 16 (the block size), and that all the removed bytes have the same value)"}, {"owner": {"reputation": 3278, "user_id": 6435651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b5799143f90155b74e518118a3d1b62?s=128&d=identicon&r=PG&f=1", "display_name": "Ivaylo Ivanov", "link": "https://stackoverflow.com/users/6435651/ivaylo-ivanov"}, "edited": false, "score": 0, "creation_date": 1490869698, "post_id": 43104371, "comment_id": 73309798, "body": "I asked related question about the encryption <a href=\"http://stackoverflow.com/questions/43115160/go-aes-encrypt-decrypt\" title=\"go aes encrypt decrypt\">stackoverflow.com/questions/43115160/go-aes-encrypt-decrypt</a>"}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 2, "last_activity_date": 1490827570, "last_edit_date": 1490827570, "creation_date": 1490822474, "answer_id": 43104371, "question_id": 43103343, "link": "https://stackoverflow.com/questions/43103343/cryptojs-encrypt-go-decrypt/43104371#43104371", "title": "CryptoJS encrypt Go decrypt", "body": "<p>Check your errors please. ALWAYS</p>\n\n<p><code>illegal base64 data at input byte 75</code></p>\n\n<p><a href=\"https://play.golang.org/p/dRLIT51u4I\" rel=\"nofollow noreferrer\">https://play.golang.org/p/dRLIT51u4I</a></p>\n\n<p>More specifically, the value at byte 75 is <code>5</code>, which is out of the range of characters available to base64. In ascii, it is the ENQ (enquiry) character. As to why this ends up in your final base64 string is beyond me.</p>\n\n<p>EDIT: OK found the issue. For whatever reason, the base64 padding character <code>=</code> at the end is being decrypted as 5 consecutive bytes containing the value <code>5</code>. Here is a playground link that shows it fixed. <a href=\"https://play.golang.org/p/tf3OZ9XG1M\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tf3OZ9XG1M</a></p>\n\n<p>EDIT: As per matt's comments. I updated the fix function to simply remove all the PKCS7 block padding and use <code>RawStdEncoding</code> for the last base64 decode. This should now be a reasonable fix.</p>\n"}], "owner": {"reputation": 3278, "user_id": 6435651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b5799143f90155b74e518118a3d1b62?s=128&d=identicon&r=PG&f=1", "display_name": "Ivaylo Ivanov", "link": "https://stackoverflow.com/users/6435651/ivaylo-ivanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "accepted_answer_id": 43104371, "answer_count": 1, "score": 1, "last_activity_date": 1490827570, "creation_date": 1490818671, "last_edit_date": 1490819996, "question_id": 43103343, "link": "https://stackoverflow.com/questions/43103343/cryptojs-encrypt-go-decrypt", "title": "CryptoJS encrypt Go decrypt", "body": "<p>I have the following Go code</p>\n\n<pre><code>ciphertext := \"Zff9c+F3gZu/lsARvPhpMau50KUkMAie4j8MYfb12HMWhkLqZreTk8RPbtRB7RDG3QFw7Y0FXJsCq/EBEAz//XoeSZmqZXoyq2Cx8ZV+/Rw=\"\ndecodedText, _ := base64.StdEncoding.DecodeString(ciphertext)\ndecodedIv, _ := base64.StdEncoding.DecodeString(\"u9CV7oR2w+IIk8R0hppxaw==\")\nnewCipher, _ := aes.NewCipher([]byte(\"~NB8CcOL#J!H?|Yr\"))\ncfbdec := cipher.NewCBCDecrypter(newCipher, decodedIv)\ncfbdec.CryptBlocks(decodedText, decodedText)\ndata, _ := base64.StdEncoding.DecodeString(string(decodedText))\nprintln(string(data))\n</code></pre>\n\n<p>The output is <code>{\"data\":{\"value\":300}, \"SEQN\":700 , \"msg\":\"IT WORKS!!\"</code></p>\n\n<p>It's encrypted with the following CryptoJS    </p>\n\n<pre><code>function encrypt(message, key) {\n  let keyHex = CryptoJS.enc.Hex.parse(parseToHex(key))\n  let iv = CryptoJS.lib.WordArray.random(128 / 8);\n  let wordArray = CryptoJS.enc.Utf8.parse(message);\n  let base64 = CryptoJS.enc.Base64.stringify(wordArray);\n  let encrypted = CryptoJS.AES.encrypt(base64, keyHex, { iv: iv });\n  return {\n    cipher: encrypted.ciphertext.toString(CryptoJS.enc.Base64),\n    iv: CryptoJS.enc.Base64.stringify(iv),\n    length: base64.length,\n    size: encrypted.ciphertext.sigBytes,\n  }\n}\n</code></pre>\n\n<p>And can be decrypted with </p>\n\n<pre><code>function decrypt(message, key, iv) {\n  let ivEX = CryptoJS.enc.Hex.parse(decodeToHex(iv));\n  let keyEX = CryptoJS.enc.Hex.parse(parseToHex(key));\n  let bytes = CryptoJS.AES.decrypt(message, keyEX , { iv: ivEX});\n  let plaintext = bytes.toString(CryptoJS.enc.Base64);\n  return decodeToString(decodeToString(plaintext));\n}\n</code></pre>\n\n<p>The output is <code>{\"data\":{\"value\":300}, \"SEQN\":700 , \"msg\":\"IT WORKS!!\" }</code> - this is the correct output</p>\n\n<p>Why Go has different output?</p>\n"}, {"tags": ["go", "couchbase"], "comments": [{"owner": {"reputation": 1657, "user_id": 2864464, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c606da71fcfa488180a8d81c8fdcc7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kohler", "link": "https://stackoverflow.com/users/2864464/alexander-kohler"}, "edited": false, "score": 0, "creation_date": 1490817276, "post_id": 43101659, "comment_id": 73287568, "body": "What is the error you get when executing a query?"}, {"owner": {"reputation": 1794, "user_id": 2474098, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/511dff23b9073611ae2728779f2b3c85?s=128&d=identicon&r=PG", "display_name": "alknows", "link": "https://stackoverflow.com/users/2474098/alknows"}, "reply_to_user": {"reputation": 1657, "user_id": 2864464, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c606da71fcfa488180a8d81c8fdcc7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kohler", "link": "https://stackoverflow.com/users/2864464/alexander-kohler"}, "edited": false, "score": 0, "creation_date": 1490822215, "post_id": 43101659, "comment_id": 73290211, "body": "@AlexanderKohler it was opening a bucket. the error msg is &quot;failed to connect to any of the specified hosts&quot;"}, {"owner": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "edited": false, "score": 0, "creation_date": 1490828902, "post_id": 43101659, "comment_id": 73292698, "body": "don&#39;t you need to specify the port?"}, {"owner": {"reputation": 1794, "user_id": 2474098, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/511dff23b9073611ae2728779f2b3c85?s=128&d=identicon&r=PG", "display_name": "alknows", "link": "https://stackoverflow.com/users/2474098/alknows"}, "reply_to_user": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "edited": false, "score": 0, "creation_date": 1490860476, "post_id": 43101659, "comment_id": 73303541, "body": "@Alessio apparently not. i took the line from their official examples."}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 0, "creation_date": 1490886665, "post_id": 43101659, "comment_id": 73322770, "body": "too bad, you can&#39;t create issue on their github"}], "owner": {"reputation": 1794, "user_id": 2474098, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/511dff23b9073611ae2728779f2b3c85?s=128&d=identicon&r=PG", "display_name": "alknows", "link": "https://stackoverflow.com/users/2474098/alknows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490822140, "creation_date": 1490813005, "last_edit_date": 1490822140, "question_id": 43101659, "link": "https://stackoverflow.com/questions/43101659/couchbase-no-error-connecting-to-missing-db", "title": "Couchbase no error connecting to missing DB", "body": "<p><strong>Problem:</strong> when i try to connect to a missing db the returned cluster is set and no error is returned.</p>\n\n<pre><code>cluster, errCon := gocb.Connect(\"couchbase://127.0.0.1\")\n</code></pre>\n\n<p><strong>errCon</strong> is nil and <strong>cluster</strong> is initialized</p>\n\n<p>The first error occurs when i try to open a bucket. The error from opening the bucket is:</p>\n\n<blockquote>\n  <p>\"failed to connect to any of the specified hosts\"</p>\n</blockquote>\n\n<p>which one would expect when trying to connect. I have the latest sdk version from \"github.com/couchbase/gocb\"</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490815379, "post_id": 43101362, "comment_id": 73286431, "body": "Unrelated, but unless you are in complete control of what gets put in <code>%s</code>, you are prone to SQL injections."}, {"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490816231, "post_id": 43101362, "comment_id": 73286990, "body": "@RayfenWindspear database/sql escapes parameters"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1490816425, "post_id": 43101362, "comment_id": 73287100, "body": "@AmmarBandukwala when they are input via the <code>?</code> operator. I&#39;ve not seen, nor used <code>%s</code> in the driver though, so I assumed it was being assigned via <code>fmt.Sprintf()</code>."}, {"owner": {"reputation": 8811, "user_id": 6248528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076d6f693bbd13804362e8208009dbcb?s=128&d=identicon&r=PG", "display_name": "Solarflare", "link": "https://stackoverflow.com/users/6248528/solarflare"}, "edited": false, "score": 1, "creation_date": 1490816553, "post_id": 43101362, "comment_id": 73287174, "body": "I would suspect a different transaction that locks your table/row at that time. Do you have others sessions/users/apps that access your database?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490816616, "post_id": 43101362, "comment_id": 73287214, "body": "Is it real code or you made something up? <code>&quot;UPDATE conv SET %s WHERE id = ?&quot;</code> query does not look like it can be <code>db.Exec</code>d due to <code>%s</code>"}, {"owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490840705, "post_id": 43101362, "comment_id": 73295741, "body": "@RayfenWindspear you are right, I am using the <code>fmt.Sprintf()</code>"}, {"owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "reply_to_user": {"reputation": 8811, "user_id": 6248528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076d6f693bbd13804362e8208009dbcb?s=128&d=identicon&r=PG", "display_name": "Solarflare", "link": "https://stackoverflow.com/users/6248528/solarflare"}, "edited": false, "score": 0, "creation_date": 1490840816, "post_id": 43101362, "comment_id": 73295762, "body": "@Solarflare It is possible, but I didn&#39;t find any slow log from mysql slow_query_log, and no deadlock exception."}, {"owner": {"reputation": 8811, "user_id": 6248528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076d6f693bbd13804362e8208009dbcb?s=128&d=identicon&r=PG", "display_name": "Solarflare", "link": "https://stackoverflow.com/users/6248528/solarflare"}, "edited": false, "score": 1, "creation_date": 1490844870, "post_id": 43101362, "comment_id": 73296776, "body": "Waiting for another transaction doesn&#39;t (necessarily) put the query in the slow query log. I would enable the general query log (which logs every query that got sent to the server) and check what other queries got executed shortly before your effect happens; it might point you to some long running query/transaction. Or you find nothing and you can at least exclude this reason."}, {"owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "reply_to_user": {"reputation": 8811, "user_id": 6248528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076d6f693bbd13804362e8208009dbcb?s=128&d=identicon&r=PG", "display_name": "Solarflare", "link": "https://stackoverflow.com/users/6248528/solarflare"}, "edited": false, "score": 0, "creation_date": 1490870108, "post_id": 43101362, "comment_id": 73310044, "body": "@Solarflare Thanks a lot! big help! I enable the query log and find another transaction update the same row. I fix the issue and hope it works!"}, {"owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "reply_to_user": {"reputation": 8811, "user_id": 6248528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076d6f693bbd13804362e8208009dbcb?s=128&d=identicon&r=PG", "display_name": "Solarflare", "link": "https://stackoverflow.com/users/6248528/solarflare"}, "edited": false, "score": 0, "creation_date": 1490888688, "post_id": 43101362, "comment_id": 73324222, "body": "@Solarflare We have solved this problem. The reason is that we use a python ORM framework (Sqlalchemy) in another service, but it use the some db with current service, it trigger a unexpected update query, we have removed it , then everything is ok, I really appreciate your help\uff01"}, {"owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "reply_to_user": {"reputation": 8811, "user_id": 6248528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076d6f693bbd13804362e8208009dbcb?s=128&d=identicon&r=PG", "display_name": "Solarflare", "link": "https://stackoverflow.com/users/6248528/solarflare"}, "edited": false, "score": 0, "creation_date": 1490889555, "post_id": 43101362, "comment_id": 73324801, "body": "@Solarflare But I have a question: If transaction A want update record R,  a different transaction B locks the R at that time, if deadlock happened, I should found it by <code>show engine innodb status;</code> command, but didn&#39;t find any deadlock info, if no deadlock, transaction B is processed for a long time (more than 10s) impossible."}, {"owner": {"reputation": 8811, "user_id": 6248528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076d6f693bbd13804362e8208009dbcb?s=128&d=identicon&r=PG", "display_name": "Solarflare", "link": "https://stackoverflow.com/users/6248528/solarflare"}, "edited": false, "score": 0, "creation_date": 1490902439, "post_id": 43101362, "comment_id": 73332473, "body": "Glad you found it. It&#39;s sometimes not easy to find. About deadlocks: waiting is not a deadlock. A <a href=\"https://dev.mysql.com/doc/refman/5.7/en/innodb-deadlocks.html\" rel=\"nofollow noreferrer\">deadlock</a> is a situation where waiting will not help anymore. E.g. Trans1: update A, Trans2: update B, Trans1: wants to update B (is locked by Trans2-&gt;has to wait), Trans2: wants to update A (is locked by Trans1-&gt;has to wait). They both would wait forever for each other, so one transaction is rolled back, the other can go on. Your first transaction probably just needed some time and the other just waited, and none got rolled back."}], "owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490840400, "creation_date": 1490812149, "last_edit_date": 1490840400, "question_id": 43101362, "link": "https://stackoverflow.com/questions/43101362/update-query-is-extremely-slow-sometimes", "title": "update query is extremely slow sometimes", "body": "<p>I am using <a href=\"https://github.com/go-sql-driver\" rel=\"nofollow noreferrer\">go-sql-driver</a> in my go micro services, but I found a strange things that update query is extremely slow sometimes. The code as below:</p>\n\n<pre><code>......\ntimeCost1 := int64(time.Now().UnixNano())/int64(time.Millisecond)\nupdateSQL := \"updateSQL UPDATE conv SET  msg_count = ? , client_msg_count = ? , last_msg_content = ? , last_msg_created_on = ?  WHERE id = ?\"\n// args = [66 33 test 2017-03-29 17:28:29.45927 1489978968]\nresult, err := db.Exec(updateSQL, args...)\ntimeCost2 := int64(time.Now().UnixNano())/int64(time.Millisecond)\nexecuteTime = timeCost2 - timeCost1\n......\n</code></pre>\n\n<p>the output sql like this:</p>\n\n<pre><code>UPDATE conv SET  msg_num = 66 , agent_msg_num = 33 , last_msg_content = 'test' , last_msg_created_on = '2017-03-29 17:28:29.45927'  WHERE id = 1489978968\n</code></pre>\n\n<p>Sometimes, I found the <code>executeTime</code> is more than 10 seconds, but I cannot reproduce it, and don't find any slow query in mysql slow_query_log. So I cannot confirm it is mysql problem or go package issue, anyone can give me some good idea? Thanks in advance!</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1490812961, "post_id": 43100853, "comment_id": 73284887, "body": "Where does the <code>RESPONSE</code> come from? Is that another type that contains <code>compactData</code>? Or?"}, {"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490814857, "post_id": 43100853, "comment_id": 73286121, "body": "the RESPONSE tag is wrapped around the http response at the very end, the data can be formatted in different ways, so I am hoping to have the same       func Marshal(obj interface{}) ([]byte, error)  signature for the stuff I am doing here, then wrap it well after the data is formatted as http.response is sent out. But good eye."}], "answers": [{"comments": [{"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 0, "creation_date": 1490815043, "post_id": 43101503, "comment_id": 73286246, "body": "In this case, the response tag gets wrapped around the results of this func call afterwards, and I have other data generators that are treated similarly (i.e. json, plain-old xml), so would like to avoid this, but based on how I worded the question this is a good catch."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 0, "creation_date": 1490815265, "post_id": 43101503, "comment_id": 73286363, "body": "@Slabgorb in that case what about the example in the update, implementing <code>xml.Marshaler</code>, does that get closer to what you want to achieve?"}, {"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 0, "creation_date": 1490815470, "post_id": 43101503, "comment_id": 73286507, "body": "excellent thank you! Got stuck on the cuteness of the tags - been working with HUGE structs where that would be super annoying, but for this that works perfectly."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 4, "last_activity_date": 1490814686, "last_edit_date": 1490814686, "creation_date": 1490812506, "answer_id": 43101503, "question_id": 43100853, "link": "https://stackoverflow.com/questions/43100853/golang-omit-name-of-struct-in-xml-marshal/43101503#43101503", "title": "golang: Omit name of struct in xml.Marshal", "body": "<p>If <code>RESPONSE</code> is another <code>struct</code> you could embed <code>compactData</code> in it and let <code>encoding/xml</code> do what you want.</p>\n\n<pre><code>type RESPONSE struct {\n    compactData\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/hN1hDY7pnV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/hN1hDY7pnV</a></p>\n\n<p><strong>Update</strong>:\nActually you can do what you want, if I understood you correctly, by implementing the <code>xml.Marshaler</code> interface. E.g. something like this: <a href=\"https://play.golang.org/p/Uwm0pP1pWh\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Uwm0pP1pWh</a>.</p>\n"}], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1340, "favorite_count": 0, "accepted_answer_id": 43101503, "answer_count": 1, "score": 3, "last_activity_date": 1490815828, "creation_date": 1490810458, "last_edit_date": 1490815828, "question_id": 43100853, "link": "https://stackoverflow.com/questions/43100853/golang-omit-name-of-struct-in-xml-marshal", "title": "golang: Omit name of struct in xml.Marshal", "body": "<p>Trying to get a particular output for XML: </p>\n\n<pre><code>&lt;RESPONSE&gt;\n    &lt;DELIMITER value=\"09\"&gt;&lt;/DELIMITER&gt;\n    &lt;COLUMNS&gt;Id FirstName   LastName    Company Initials&lt;/COLUMNS&gt;\n     &lt;DATA&gt;87734    Some Guy    Keller Williams Realty Empire   &lt;/DATA&gt;\n     &lt;DATA&gt;87739    Another Guy Level Group, Inc.   &lt;/DATA&gt;\n     &lt;DATA&gt;87741    Some Gal    Kian Realty NYC, LLC    &lt;/DATA&gt;\n&lt;/RESPONSE&gt; \n</code></pre>\n\n<p>instead I am getting:</p>\n\n<pre><code>&lt;RESPONSE&gt;\n &lt;compactData&gt;\n        &lt;DELIMITER value=\"09\"&gt;&lt;/DELIMITER&gt;\n        &lt;COLUMNS&gt;Id FirstName   LastName    Company Initials&lt;/COLUMNS&gt;\n        &lt;DATA&gt;87734 Some Guy    Keller Williams Realty Empire   &lt;/DATA&gt;\n        &lt;DATA&gt;87739 Another Guy Level Group, Inc.   &lt;/DATA&gt;\n        &lt;DATA&gt;87741 Some Gal    Kian Realty NYC, LLC    &lt;/DATA&gt;\n &lt;/compactData&gt;\n&lt;/RESPONSE&gt; \n</code></pre>\n\n<p>I am trying not to output the &lt;compactData&gt; tag at all. (everything else is a-ok)</p>\n\n<p>my struct that I am marshal-ing looks like this: </p>\n\n<pre><code>type delimiter struct {\n    Value string `xml:\"value,attr\"`\n}\n\ntype innerData struct {\n    Data string `xml:\",innerxml\"`\n}\n\ntype compactData struct {\n    Delimiter delimiter    `xml:\"DELIMITER\"`\n    Columns   *innerData   `xml:\"COLUMNS\"`\n    Records   []*innerData `xml:\"DATA\"`\n}\n</code></pre>\n\n<p>I have tried putting in </p>\n\n<pre><code>XMLName   xml.Name\n</code></pre>\n\n<p>or </p>\n\n<pre><code>XMLName   xml.Name `xml:\"\"`\n</code></pre>\n\n<p>to no avail- the xml.MarshalIndent just says 'yeah that looks like crap taking the struct name instead'.</p>\n\n<p>I feel as though I just may need to reorganize the struct a bit, but I am stumped as to the magic structure needed.</p>\n\n<p>Thanks!</p>\n\n<p>Edit: the &lt;RESPONSE&gt; tag is added as the http.reponse is sent, after this formatting is done, trying to keep this signature the same as JSON and XML encoding...</p>\n\n<p>like so: </p>\n\n<pre><code>func createResponse(obj interface{}, format string) (*Response, error) {\n    var data []byte\n\n    var f func(interface{}, string, string) ([]byte, error)\n\n    switch format {\n    case FORMAT_JSON:\n        f = json.MarshalIndent\n    case FORMAT_COMPACT:\n        f = compact.MarshalIndent\n    default:\n        f = xml.MarshalIndent\n    }\n    data, err := f(obj, \" \", \"    \")\n    if err != nil {\n        log.Println(err)\n        return nil, err\n    }\n    return &amp;Response{Data: string(data)}, nil\n\n}\n</code></pre>\n"}, {"tags": ["go", "makefile"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490808684, "post_id": 43100127, "comment_id": 73282263, "body": "Maybe try running specific tests to figure out which one is causing a panic?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1490808842, "post_id": 43100127, "comment_id": 73282383, "body": "Does you project use cgo, and are you using Xcode8.3?"}, {"owner": {"reputation": 3188, "user_id": 387176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7f15382707eba1868cfcf1981771a4?s=128&d=identicon&r=PG", "display_name": "Russ Egan", "link": "https://stackoverflow.com/users/387176/russ-egan"}, "edited": false, "score": 2, "creation_date": 1490809179, "post_id": 43100127, "comment_id": 73282593, "body": "I&#39;m hitting this error, and yeah, using cgo with xcode cli tools 8.3.  Did that introduce a problem?"}, {"owner": {"reputation": 88, "user_id": 4418840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70afa765dd8fe54bccc5bd1a9878feba?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham Vadhera", "link": "https://stackoverflow.com/users/4418840/shubham-vadhera"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490809268, "post_id": 43100127, "comment_id": 73282656, "body": "Yes my project uses cgo. And I also have xcode 8.3 installed, but not using it in this project. @JimB"}, {"owner": {"reputation": 3188, "user_id": 387176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7f15382707eba1868cfcf1981771a4?s=128&d=identicon&r=PG", "display_name": "Russ Egan", "link": "https://stackoverflow.com/users/387176/russ-egan"}, "edited": false, "score": 1, "creation_date": 1490809570, "post_id": 43100127, "comment_id": 73282854, "body": "Seems to be a known issue: <a href=\"https://github.com/golang/go/issues/19734\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/19734</a>"}], "answers": [{"tags": [], "owner": {"reputation": 88, "user_id": 4418840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70afa765dd8fe54bccc5bd1a9878feba?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham Vadhera", "link": "https://stackoverflow.com/users/4418840/shubham-vadhera"}, "is_accepted": false, "score": 0, "last_activity_date": 1490809637, "creation_date": 1490809637, "answer_id": 43100619, "question_id": 43100127, "link": "https://stackoverflow.com/questions/43100127/golang-error-while-make-test-signal-killed/43100619#43100619", "title": "Golang: Error while make test: signal: killed", "body": "<p>Thanks a lot @JimB</p>\n\n<p>I uninstalled the Xcode and it runs fine now. Weird !</p>\n"}, {"tags": [], "owner": {"reputation": 2339, "user_id": 3081558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9ritS.jpg?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/3081558/patrick"}, "is_accepted": true, "score": 8, "last_activity_date": 1493311072, "last_edit_date": 1493311072, "creation_date": 1491407039, "answer_id": 43235869, "question_id": 43100127, "link": "https://stackoverflow.com/questions/43100127/golang-error-while-make-test-signal-killed/43235869#43235869", "title": "Golang: Error while make test: signal: killed", "body": "<p><strong>UPDATE on 04/27/2017:</strong> </p>\n\n<p>The new Go1.8.1 (released 2017/04/07) fixed this issue. Please download and install the latest version.</p>\n\n<p><strong>OLD ANSWER:</strong></p>\n\n<p>Mainly the reason was that Command Line Tool 8.3 is not compatible. </p>\n\n<p>According to the solutions from <a href=\"https://github.com/golang/go/issues/19734\" rel=\"noreferrer\">https://github.com/golang/go/issues/19734</a>: </p>\n\n<ul>\n<li>Remove <code>/Library/Developer/CommandLineTools</code> first, download and install Command Line Tool 8.2 from <a href=\"https://developer.apple.com/download/more/?name=Xcode\" rel=\"noreferrer\">https://developer.apple.com/download/more/?name=Xcode</a></li>\n</ul>\n\n<p>OR</p>\n\n<ul>\n<li>use <code>-ldflags -s</code> option for compilation or run</li>\n</ul>\n"}], "owner": {"reputation": 88, "user_id": 4418840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70afa765dd8fe54bccc5bd1a9878feba?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham Vadhera", "link": "https://stackoverflow.com/users/4418840/shubham-vadhera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3852, "favorite_count": 0, "accepted_answer_id": 43235869, "answer_count": 2, "score": 3, "last_activity_date": 1493311072, "creation_date": 1490808095, "question_id": 43100127, "link": "https://stackoverflow.com/questions/43100127/golang-error-while-make-test-signal-killed", "title": "Golang: Error while make test: signal: killed", "body": "<p>I am getting this error while running make test on a Golang project:</p>\n\n<pre><code>signal: killed\nFAIL &lt;package name&gt;\nmake: *** [test] Error 1\n</code></pre>\n\n<p>The same code was running perfectly fine until yesterday.\nNote: I tried doing make test on other branches also but same result.</p>\n"}, {"tags": ["json", "go", "routing", "mux", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 764, "user_id": 1969935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d6f6c9d8a6b99e363bf439c42280621?s=128&d=identicon&r=PG", "display_name": "Paul A.T. Wilson", "link": "https://stackoverflow.com/users/1969935/paul-a-t-wilson"}, "edited": false, "score": 0, "creation_date": 1490807946, "post_id": 43099909, "comment_id": 73281776, "body": "You got me over the line thank you. I have to change my map to:  var functions = map[string]http.HandlerFunc"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 764, "user_id": 1969935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d6f6c9d8a6b99e363bf439c42280621?s=128&d=identicon&r=PG", "display_name": "Paul A.T. Wilson", "link": "https://stackoverflow.com/users/1969935/paul-a-t-wilson"}, "edited": false, "score": 0, "creation_date": 1490808221, "post_id": 43099909, "comment_id": 73281969, "body": "I figured something would be off. Like I said, mine was specific to subdomains, hence the map of handlers. I actually modified the first line in the function from looking up the subdomain, to getting the path, so my code here probably doesn&#39;t even work as is :O. I&#39;ll edit it to use handleFuncs"}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 1, "last_activity_date": 1490808321, "last_edit_date": 1490808321, "creation_date": 1490807380, "answer_id": 43099909, "question_id": 43099629, "link": "https://stackoverflow.com/questions/43099629/golang-json-config-for-routes/43099909#43099909", "title": "Golang JSON config for routes", "body": "<p>I am using a mux for subdomains, so my examples may be a bit off. The map you are being told to use is done something like this:</p>\n\n<pre><code>type Handlers map[string]http.HandlerFunc\n\nfunc (handlers Handlers) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    path := r.URL.Path\n    if handle := handlers[path]; handle != nil {\n        handle.ServeHTTP(w, r)\n    } else {\n        http.Error(w, \"Not found\", 404)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 764, "user_id": 1969935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d6f6c9d8a6b99e363bf439c42280621?s=128&d=identicon&r=PG", "display_name": "Paul A.T. Wilson", "link": "https://stackoverflow.com/users/1969935/paul-a-t-wilson"}, "is_accepted": true, "score": 1, "last_activity_date": 1490808089, "last_edit_date": 1495539984, "creation_date": 1490808089, "answer_id": 43100121, "question_id": 43099629, "link": "https://stackoverflow.com/questions/43099629/golang-json-config-for-routes/43100121#43100121", "title": "Golang JSON config for routes", "body": "<p>Thanks to <a href=\"https://stackoverflow.com/users/1276480/rayfenwindspear\">RayenWindspear</a> I was able to fix the problem. It was very simple (like everything). The map code should look like this:</p>\n\n<pre><code>var functions = map[string]http.HandlerFunc{\n    \"HandleFunc1\": HandleFunc1,\n}\n</code></pre>\n"}], "owner": {"reputation": 764, "user_id": 1969935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d6f6c9d8a6b99e363bf439c42280621?s=128&d=identicon&r=PG", "display_name": "Paul A.T. Wilson", "link": "https://stackoverflow.com/users/1969935/paul-a-t-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 43100121, "answer_count": 2, "score": 1, "last_activity_date": 1490808321, "creation_date": 1490806438, "question_id": 43099629, "link": "https://stackoverflow.com/questions/43099629/golang-json-config-for-routes", "title": "Golang JSON config for routes", "body": "<p>I have been trying to setup a JSON config file to setup dynamic routes for my application. The idea is that I will be able to setup my own URL structure depending on who is using the service. I have a struct that takes in JSON and that works fine. I am using gorilla mux.</p>\n\n<pre><code> type CustomRoute struct {\n    Name string\n    Method string\n    Path string\n    HandleFunc string\n }\n</code></pre>\n\n<p>The JSON is basically identical to the struct and it goes in fine.</p>\n\n<p>The issue I have is getting the HandleFunc section.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>func NewRouter() *mux.Router {\n\nrouterInstance := mux.NewRouter().StrictSlash(true)\n\n    /*\n    All routes from the routing table\n    */\n\n    // r = []CustomRoute with the JSON data \n    r := loadRoute()\n    for _, route := range r {\n       var handler http.Handler\n\n       handler = route.HandlerFunc\n       handler = core.Logger(handler, route.Name)\n\n       routerInstance.\n           Methods(route.Method).\n           Path(route.Path).\n           Name(route.Name).\n           Handler(handler)\n\n    }\n\n    return routerInstance\n}\n</code></pre>\n\n<p>I always get the following error (as one would expect)</p>\n\n<blockquote>\n  <p>cannot use route.HandlerFunc (type string) as type http.Handler in assignment:\n          string does not implement http.Handler (missing ServeHTTP method)</p>\n</blockquote>\n\n<p>I was told to use something like:</p>\n\n<pre><code>var functions = map[string]interface{}{\n    \"HandleFunc1\": HandleFunc1,\n}\n</code></pre>\n\n<p>But I have no idea how to make this work</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490806822, "post_id": 43099593, "comment_id": 73281024, "body": "Do you need to verify a user exists at all, or that the current process is run by a specific user?"}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490807236, "post_id": 43099593, "comment_id": 73281312, "body": "@JimB good point, I need only to run the process on behalf a specific user, currently using <code>&amp;syscall.Credential{Uid: uint32(uid), Gid: uint32(gid)}</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1490807529, "post_id": 43099593, "comment_id": 73281504, "body": "Then no. Looking up uid/gid requires system specific calls, and libc calls on unix."}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490806300, "creation_date": 1490806300, "question_id": 43099593, "link": "https://stackoverflow.com/questions/43099593/user-lookup-requires-cgo", "title": "user: Lookup requires cgo", "body": "<p>After cross compiling and <a href=\"https://github.com/immortal/immortal/issues/10\" rel=\"nofollow noreferrer\">testing an app</a>, I got this error:</p>\n\n<pre><code>user: Lookup requires cgo\n</code></pre>\n\n<p>If I am right currently there is no way to fix this rather than compiling directly on the target architecture. </p>\n\n<p>Setting up multiple architectures is not a simple task, therefore wondering what could it be done as workaround to this.</p>\n\n<p>For my use case, I need to verify if a user exists on the system in order to run a command on behalf that user, before calling commands like <code>who</code>, <code>id</code> are there any <code>syscalls</code> or go native methods that could allow me to get this information not depending on <code>cgo</code>?</p>\n"}, {"tags": ["function", "dictionary", "go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1490797684, "post_id": 43095764, "comment_id": 73274087, "body": "It&#39;s not your question, but <code>return map[string]string{&quot;start&quot;: &quot;1&quot;, &quot;from&quot;: &quot;encrypted&quot;, &quot;to&quot;: &quot;loaded&quot;}</code> is easier (and more efficient) than creating a map and then assigning items one by one."}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1490854760, "post_id": 43095764, "comment_id": 73300120, "body": "If you know the size of map in advance, you can pass the size as the second parameter to make. <a href=\"https://golang.org/pkg/builtin/#make\" rel=\"nofollow noreferrer\">golang.org/pkg/builtin/#make</a>"}, {"owner": {"reputation": 43, "user_id": 7401607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/240df379b313571311d81967926f548a?s=128&d=identicon&r=PG", "display_name": "Rod Turnham", "link": "https://stackoverflow.com/users/7401607/rod-turnham"}, "edited": false, "score": 0, "creation_date": 1490965781, "post_id": 43095764, "comment_id": 73360171, "body": "Many thanks to all, both for your information and for your kindness to a newbie! I&#39;ve learned quite a lot about Go this week, and very much appreciate the boost you&#39;ve given me."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7401607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/240df379b313571311d81967926f548a?s=128&d=identicon&r=PG", "display_name": "Rod Turnham", "link": "https://stackoverflow.com/users/7401607/rod-turnham"}, "edited": false, "score": 0, "creation_date": 1490797228, "post_id": 43095855, "comment_id": 73273659, "body": "Got it! THANK YOU! Fixed my code and learned something ... definition of a good day!"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 2, "last_activity_date": 1490796329, "creation_date": 1490796329, "answer_id": 43095855, "question_id": 43095764, "link": "https://stackoverflow.com/questions/43095764/how-to-define-a-function-which-returns-a-map/43095855#43095855", "title": "How to define a function which returns a map", "body": "<p>You need to declare the whole type including key and value types.</p>\n\n<pre><code>func defaults() map[string]string {\n    \u2026\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58, "user_id": 7773206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04106e392cec3998975dc0b93ce852c5?s=128&d=identicon&r=PG&f=1", "display_name": "Roy Touw", "link": "https://stackoverflow.com/users/7773206/roy-touw"}, "is_accepted": true, "score": 0, "last_activity_date": 1490796438, "creation_date": 1490796438, "answer_id": 43095914, "question_id": 43095764, "link": "https://stackoverflow.com/questions/43095764/how-to-define-a-function-which-returns-a-map/43095914#43095914", "title": "How to define a function which returns a map", "body": "<pre><code>func defaults() map[string] string {\n    m := make(map[string]string)\n    m[\"start\"] = \"1\"\n    ...\n    return m\n}\n</code></pre>\n\n<p>The problem with your defaults function is the return type map has no types.</p>\n"}], "owner": {"reputation": 43, "user_id": 7401607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/240df379b313571311d81967926f548a?s=128&d=identicon&r=PG", "display_name": "Rod Turnham", "link": "https://stackoverflow.com/users/7401607/rod-turnham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 43095914, "answer_count": 2, "score": 1, "last_activity_date": 1490805807, "creation_date": 1490796097, "last_edit_date": 1490805807, "question_id": 43095764, "link": "https://stackoverflow.com/questions/43095764/how-to-define-a-function-which-returns-a-map", "title": "How to define a function which returns a map", "body": "<p>I am attempting to define a function which returns an initialized map:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"os\"\n\nfunc defaults() map {\n  m := make(map[string]string)\n  m[\"start\"] = \"1\"\n  m[\"from\"]  = \"encrypted\"\n  m[\"to\"]    = \"loaded\"\n  return m\n}\n\nfunc main() {\n  args := os.Args[1:]\n  fmt.Println(args)\n  runvals := defaults()\n  fmt.Println(runvals)\n}\n</code></pre>\n\n<p>Errors I'm getting:</p>\n\n<pre><code>Line 6 col 21 error| expected '[', found '{'\nLine 7 col 5 error| expected ']', found ':='\nLine 11 col 3 error| expected declaration, found 'return'\n</code></pre>\n\n<p>Can someone help me get the syntax right? Or am I trying to do something that Go doesn't do?</p>\n"}, {"tags": ["string", "go", "unicode"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1490795450, "post_id": 43094522, "comment_id": 73272111, "body": "I&#39;d note that <code>strconv.ParseInt()</code> returns a value of type <code>uint64</code> no matter which bit size was specified so in a less toy example one would probably need to type-convert the result to <code>rune</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1490795683, "post_id": 43094522, "comment_id": 73272331, "body": "@kostix: good point, that happens implicitly in the string conversion."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1490799173, "last_edit_date": 1490799173, "creation_date": 1490793032, "answer_id": 43094522, "question_id": 43094132, "link": "https://stackoverflow.com/questions/43094132/golang-convert-integer-to-unicode-character/43094522#43094522", "title": "Golang convert integer to unicode character", "body": "<p><code>2612</code> is not the integer value of the unicode rune, the integer value of <code>\\u2612</code> is <code>9746</code>. The string <code>\"2612\"</code> is the hex value of the rune, so parse it as a hex number and convert it to a <code>rune</code>.</p>\n\n<pre><code>i, err := strconv.ParseInt(strVal, 16, 32)\nif err != nil {\n    log.Fatal(err)\n}\nr := rune(i)\nfmt.Println(string(r))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/t_e6AfbKQq\" rel=\"nofollow noreferrer\">https://play.golang.org/p/t_e6AfbKQq</a></p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1490803728, "last_edit_date": 1490803728, "creation_date": 1490796728, "answer_id": 43096043, "question_id": 43094132, "link": "https://stackoverflow.com/questions/43094132/golang-convert-integer-to-unicode-character/43096043#43096043", "title": "Golang convert integer to unicode character", "body": "<p>This one works:</p>\n\n<pre><code>fmt.Println(\"\\u2612\")\n</code></pre>\n\n<p>Because an <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"nofollow noreferrer\">interpreted string literal</a> is specified in the source code, and the compiler will unquote (interpret) it. It is <strong>not</strong> the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code></a> package that processes this unquoting.</p>\n\n<p>This doesn't work:</p>\n\n<pre><code>fmt.Println(\"\\\\u\" + strVal)\n</code></pre>\n\n<p>Because again an interpreted string literal is used which will be resolved to a <code>string</code> value <code>\\u</code>, and then it will be concatenated with the value of the local variable <code>strVal</code> which is <code>2612</code>, so the final <code>string</code> value will be <code>\\u2612</code>. But this is not an interpreted string literal, this is the \"final\" result. This won't be processed / unquoted further.</p>\n\n<p>Alternatively to JimB's answer, you may also use <a href=\"https://golang.org/pkg/strconv/#Unquote\" rel=\"nofollow noreferrer\"><code>strconv.Unquote()</code></a> which does an unquoting similar to what the compiler does.</p>\n\n<p>See this example:</p>\n\n<pre><code>// The original that works:\ns := \"\\u2612\"\nfmt.Println(s, []byte(s))\n\n// Using strconv.Unquote():\nstrVal := \"2612\"\ns2, err := strconv.Unquote(`\"\\u` + strVal + `\"`)\nfmt.Println(s2, []byte(s2), err)\nfmt.Println(s == s2)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/P13LRCMJPz\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>\u2612 [226 152 146]\n\u2612 [226 152 146] &lt;nil&gt;\ntrue\n</code></pre>\n\n<p>Something to note here: We want to unquote the <code>\\u2612</code> text by <code>strconv.Unquote()</code>, but <code>Unquote()</code> requires that the string to be unquoted to be in quotes (<em>\"Unquote interprets s as a single-quoted, double-quoted, or backquoted Go string literal...\"</em>), that's why we pre- and postpended it with a quotation mark.</p>\n"}], "owner": {"reputation": 9, "user_id": 6954536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd39f276a0ffb5e40d5c5d148ba1b80c?s=128&d=identicon&r=PG", "display_name": "m3brown", "link": "https://stackoverflow.com/users/6954536/m3brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3055, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1490803728, "creation_date": 1490792056, "last_edit_date": 1490797135, "question_id": 43094132, "link": "https://stackoverflow.com/questions/43094132/golang-convert-integer-to-unicode-character", "title": "Golang convert integer to unicode character", "body": "<p>Given the following input:</p>\n\n<pre><code>intVal := 2612\nstrVal := \"2612\"\n</code></pre>\n\n<p>What is a mechanism for mapping to the associated unicode value as a string.</p>\n\n<p>For example, the following code prints \"\u2612\"</p>\n\n<pre><code>fmt.Println(\"\\u2612\")\n</code></pre>\n\n<p>But the following does not work:</p>\n\n<pre><code>fmt.Println(\"\\\\u\" + strVal)\n</code></pre>\n\n<p>I researched runes, <code>strconv</code>, and <code>unicode/utf8</code> but was unable to find a suitable conversion strategy.</p>\n"}, {"tags": ["go", "glide-golang"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490791401, "post_id": 43093010, "comment_id": 73268693, "body": "<code>$(...)</code> is a shell command substitution, you can&#39;t use that in windows cmd.exe."}, {"owner": {"reputation": 1294, "user_id": 637037, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b37a6d19aced262f0d6694b4aea3ce23?s=128&d=identicon&r=PG", "display_name": "azpublic", "link": "https://stackoverflow.com/users/637037/azpublic"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490792243, "post_id": 43093010, "comment_id": 73269355, "body": "@JimB thanks! What would you suggest I do on windows to make this work ? Thanks."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1490792460, "post_id": 43093010, "comment_id": 73269535, "body": "No idea, I don&#39;t use windows. Searching for <code>windows &quot;command substitution&quot;</code> seems to bring up some results."}], "answers": [{"tags": [], "owner": {"reputation": 575, "user_id": 607890, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b97d269046d146c01bdfa56a6155e520?s=128&d=identicon&r=PG&f=1", "display_name": "iknowitwasyoufredo", "link": "https://stackoverflow.com/users/607890/iknowitwasyoufredo"}, "is_accepted": false, "score": 0, "last_activity_date": 1505393674, "creation_date": 1505393674, "answer_id": 46219770, "question_id": 43093010, "link": "https://stackoverflow.com/questions/43093010/go-install-command-with-glide-on-windows/46219770#46219770", "title": "go install command with glide on windows", "body": "<p>It works on powershell. At the project directory run command:</p>\n\n<pre><code>go install $(glide nv)\n</code></pre>\n"}], "owner": {"reputation": 1294, "user_id": 637037, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b37a6d19aced262f0d6694b4aea3ce23?s=128&d=identicon&r=PG", "display_name": "azpublic", "link": "https://stackoverflow.com/users/637037/azpublic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1090, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553446629, "creation_date": 1490789042, "last_edit_date": 1553446629, "question_id": 43093010, "link": "https://stackoverflow.com/questions/43093010/go-install-command-with-glide-on-windows", "title": "go install command with glide on windows", "body": "<p>I'm having trouble running the go install $(glide nv) command.\nI run this command from within my project's folder within the src folder of the go workspace directoy </p>\n\n<p>so basically I do : </p>\n\n<pre><code>%GOPATH%/src/my/project/ go install $(glide nv)\n</code></pre>\n\n<p>The error message I get is as follow : </p>\n\n<pre><code>can't load package: package $(glide: cannot find package \"$(glide\" in any of:            \n        C:\\Go\\src\\$(glide (from $GOROOT)                                                 \n        W:\\GO_WORKSPACE\\src\\$(glide (from $GOPATH)                              \ncan't load package: package nv): cannot find package \"nv)\" in any of:                    \n        C:\\Go\\src\\nv) (from $GOROOT)                                                     \n        W:\\GO_WORKSPACE\\src\\nv) (from $GOPATH)                  \n</code></pre>\n\n<p>I had previously run glide install without a problem on that project. </p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["unit-testing", "go", "visual-studio-code"], "comments": [{"owner": {"reputation": 763, "user_id": 4934330, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e51efa148992a97fabf4e855a98c261f?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/4934330/bob"}, "edited": false, "score": 1, "creation_date": 1490804504, "post_id": 43092364, "comment_id": 73279518, "body": "Try to specify &#39;program&#39; property in configuration with executable file &#39;${workspaceRoot}/main_test.go&#39;"}, {"owner": {"reputation": 7265, "user_id": 3457177, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bae2e85ed6794ece744ee124d9ac7842?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalii", "link": "https://stackoverflow.com/users/3457177/vitalii"}, "reply_to_user": {"reputation": 763, "user_id": 4934330, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e51efa148992a97fabf4e855a98c261f?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/4934330/bob"}, "edited": false, "score": 0, "creation_date": 1490945570, "post_id": 43092364, "comment_id": 73347493, "body": "That&#39;s it, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 8315994, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-N2NbvCzFEMU/AAAAAAAAAAI/AAAAAAAABDE/EbsZdKHcGSs/photo.jpg?sz=128", "display_name": "Calvin Zhou", "link": "https://stackoverflow.com/users/8315994/calvin-zhou"}, "edited": false, "score": 0, "creation_date": 1570079485, "post_id": 43233176, "comment_id": 102802038, "body": "Mode test is the key thing here and you saved my life! Thanks a lot as it&#39;s so difficult to find proper solution when I tried to debug unit test in vscode, what a combination!"}, {"owner": {"reputation": 349, "user_id": 7157204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be9a579276141bae5f9c8531dd720c23?s=128&d=identicon&r=PG&f=1", "display_name": "learning2learn", "link": "https://stackoverflow.com/users/7157204/learning2learn"}, "edited": false, "score": 1, "creation_date": 1588609174, "post_id": 43233176, "comment_id": 108957976, "body": "Does anyone know what the change would be to debug a &quot;go test&quot; case remotely?"}], "tags": [], "owner": {"reputation": 7265, "user_id": 3457177, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bae2e85ed6794ece744ee124d9ac7842?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalii", "link": "https://stackoverflow.com/users/3457177/vitalii"}, "is_accepted": true, "score": 27, "last_activity_date": 1595941140, "last_edit_date": 1595941140, "creation_date": 1491400253, "answer_id": 43233176, "question_id": 43092364, "link": "https://stackoverflow.com/questions/43092364/debugging-go-tests-in-visual-studio-code/43233176#43233176", "title": "Debugging Go tests in Visual Studio Code", "body": "<p>To launch debugger for test I added one more configuration for launch.json</p>\n<pre><code>{\n    &quot;version&quot;: &quot;0.2.0&quot;,\n    &quot;configurations&quot;: [\n        {\n            &quot;name&quot;: &quot;Code&quot;,\n            &quot;type&quot;: &quot;go&quot;,\n            &quot;request&quot;: &quot;launch&quot;,\n            &quot;mode&quot;: &quot;debug&quot;,\n            &quot;remotePath&quot;: &quot;&quot;,\n            &quot;port&quot;: 2345,\n            &quot;host&quot;: &quot;127.0.0.1&quot;,\n            &quot;program&quot;: &quot;${workspaceRoot}&quot;,\n            &quot;env&quot;: {},\n            &quot;args&quot;: [],\n            &quot;showLog&quot;: true\n        },\n        {\n            &quot;name&quot;: &quot;Test Current File&quot;,\n            &quot;type&quot;: &quot;go&quot;,\n            &quot;request&quot;: &quot;launch&quot;,\n            &quot;mode&quot;: &quot;test&quot;,\n            &quot;remotePath&quot;: &quot;&quot;,\n            &quot;port&quot;: 2345,\n            &quot;host&quot;: &quot;127.0.0.1&quot;,\n            &quot;program&quot;: &quot;${file}&quot;,\n            &quot;env&quot;: {},\n            &quot;args&quot;: [],\n            &quot;showLog&quot;: true\n        }       \n    ]\n}\n</code></pre>\n<p>Also this configuration does not support tags. All tags in test files have to be disabled</p>\n<pre><code>// +build unit\n...\n</code></pre>\n"}], "owner": {"reputation": 7265, "user_id": 3457177, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bae2e85ed6794ece744ee124d9ac7842?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalii", "link": "https://stackoverflow.com/users/3457177/vitalii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12341, "favorite_count": 2, "accepted_answer_id": 43233176, "answer_count": 1, "score": 16, "last_activity_date": 1595941140, "creation_date": 1490787359, "last_edit_date": 1490791838, "question_id": 43092364, "link": "https://stackoverflow.com/questions/43092364/debugging-go-tests-in-visual-studio-code", "title": "Debugging Go tests in Visual Studio Code", "body": "<p>On my Windows machine, I have Visual Studio Code installed. To run tests manually, I go in console to projects folder and enter</p>\n\n<pre><code>go test main_test.go\n</code></pre>\n\n<p>It works perfectly.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZFZce.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/ZFZce.png\" alt=\"enter image description here\"></a></p>\n\n<p>But I have a situation in which I need to debug my test to understand what's going on.</p>\n\n<p>For this I open launch.json and add a configuration</p>\n\n<pre><code>  {\n        \"name\": \"Tests\",\n        \"type\": \"go\",\n        \"request\": \"launch\",\n        \"mode\": \"test\",\n        \"remotePath\": \"\",\n        \"port\": 2346,\n        \"host\": \"127.0.0.1\",\n        \"program\": \"${workspaceRoot}\",\n        \"env\": {},\n        \"args\": [\n           \"main_test.go\"\n            ],\n        \"showLog\": true\n    }\n</code></pre>\n\n<p>After I press F5 I have </p>\n\n<pre><code>2017/03/29 13:28:11 server.go:73: Using API v1\n2017/03/29 13:28:11 debugger.go:68: launching process with args: [./debug.test main_test.go main_go]\nnot an executable file\nProcess exiting with code: 1\n</code></pre>\n\n<p>Any ideas why this error occurs and what executable it's looking for? </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "edited": false, "score": 1, "creation_date": 1537876647, "post_id": 43091852, "comment_id": 91935580, "body": "you can use sql.NullString instead of string, that should not output an error."}, {"owner": {"reputation": 167, "user_id": 1011289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de227f341e1125c3baff291e857e461?s=128&d=identicon&r=PG", "display_name": "kmac.mcfarlane", "link": "https://stackoverflow.com/users/1011289/kmac-mcfarlane"}, "edited": false, "score": 1, "creation_date": 1561562124, "post_id": 43091852, "comment_id": 100107606, "body": "You can actually just omit the parameter passed to row.Scan() entirely."}, {"owner": {"reputation": 510, "user_id": 8966651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nhTYv.jpg?s=128&g=1", "display_name": "lewislbr", "link": "https://stackoverflow.com/users/8966651/lewislbr"}, "reply_to_user": {"reputation": 167, "user_id": 1011289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de227f341e1125c3baff291e857e461?s=128&d=identicon&r=PG", "display_name": "kmac.mcfarlane", "link": "https://stackoverflow.com/users/1011289/kmac-mcfarlane"}, "edited": false, "score": 0, "creation_date": 1617999271, "post_id": 43091852, "comment_id": 118478853, "body": "@kmac.mcfarlane I think that is no possible, at least now, as it causes <code>number of field descriptions must equal number of destinations</code>."}], "tags": [], "owner": {"reputation": 1657, "user_id": 2864464, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c606da71fcfa488180a8d81c8fdcc7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kohler", "link": "https://stackoverflow.com/users/2864464/alexander-kohler"}, "is_accepted": true, "score": 40, "last_activity_date": 1490785783, "creation_date": 1490785783, "answer_id": 43091852, "question_id": 43091774, "link": "https://stackoverflow.com/questions/43091774/queryrow-scan-returns-error-if-row-doesnt-exist/43091852#43091852", "title": "QueryRow().Scan() returns error if row doesn&#39;t exist", "body": "<p>Simply check for the error you don't want to log before logging: </p>\n\n<pre><code>var name string\nrow := db.Con().QueryRow(\"SELECT name FROM users WHERE id = 2;\")\nerr := row.Scan(&amp;name)\n\nif err != nil &amp;&amp; err != sql.ErrNoRows {\n    // log the error\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1205, "user_id": 2846068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kHfXv.jpg?s=128&g=1", "display_name": "MasterAler", "link": "https://stackoverflow.com/users/2846068/masteraler"}, "edited": false, "score": 0, "creation_date": 1592998383, "post_id": 62207098, "comment_id": 110624145, "body": "Eh, excessive:  <code>&#47;&#47; QueryRow executes a query that is expected to return at most one row. &#47;&#47; QueryRow always returns a non-nil value. Errors are deferred until &#47;&#47; Row&#39;s Scan method is called.</code>"}], "tags": [], "owner": {"reputation": 779, "user_id": 6484371, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9739ce20bf000c611ddf35e50443aadd?s=128&d=identicon&r=PG&f=1", "display_name": "ByteMe", "link": "https://stackoverflow.com/users/6484371/byteme"}, "is_accepted": false, "score": 0, "last_activity_date": 1592514526, "last_edit_date": 1592514526, "creation_date": 1591323738, "answer_id": 62207098, "question_id": 43091774, "link": "https://stackoverflow.com/questions/43091774/queryrow-scan-returns-error-if-row-doesnt-exist/62207098#62207098", "title": "QueryRow().Scan() returns error if row doesn&#39;t exist", "body": "<p>You can just scan the returned row, I check first that it is not nil.</p>\n\n<pre><code>if row != nil {\n  err := row.Scan()\n}\n</code></pre>\n\n<p>I think you can also use pgx v4 for your db driver and it doesn't return no rows as an error.</p>\n"}], "owner": {"reputation": 373, "user_id": 2719586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8h5EJ.jpg?s=128&g=1", "display_name": "Alex Re\u0161atniak", "link": "https://stackoverflow.com/users/2719586/alex-re%c5%a1atniak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26714, "favorite_count": 0, "accepted_answer_id": 43091852, "answer_count": 2, "score": 18, "last_activity_date": 1592514526, "creation_date": 1490785564, "last_edit_date": 1568880762, "question_id": 43091774, "link": "https://stackoverflow.com/questions/43091774/queryrow-scan-returns-error-if-row-doesnt-exist", "title": "QueryRow().Scan() returns error if row doesn&#39;t exist", "body": "<p>I want to fetch one row from an sql database. I use the following code:</p>\n\n<pre><code>var name string\nrow := db.Con().QueryRow(\"SELECT name FROM users WHERE id = 2;\")\nerr := row.Scan(&amp;name)\n\nif err != nil {\n    // log the error\n}\n</code></pre>\n\n<p>For example: if a user with <code>id=2</code> doesn't exist, then the method <code>Scan</code> returns an error. </p>\n\n<p><strong>Question:</strong></p>\n\n<p>Is there a way to avoid this error when a row doesn't exist? Because it's absolutely normal and I don't want to log such errors.</p>\n\n<p>The only way I found is to use <code>Query</code> instead of <code>QueryRow</code>, but it is not convenient because I have to add <code>for rows.Next() { ..</code> every time when I want to fetch single row.</p>\n"}, {"tags": ["go", "concurrency", "web-crawler"], "comments": [{"owner": {"reputation": 245, "user_id": 1496317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8aaed7a968f12467148e2a8a8c4ac2c0?s=128&d=identicon&r=PG", "display_name": "tsdtsdtsd", "link": "https://stackoverflow.com/users/1496317/tsdtsdtsd"}, "edited": false, "score": 0, "creation_date": 1490784848, "post_id": 43091005, "comment_id": 73264120, "body": "Check the returned errors from <code>url.Parse(uri)</code> and <code>ioutil.ReadAll(resp.Body)</code>."}, {"owner": {"reputation": 143, "user_id": 7109755, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh6.googleusercontent.com/-8zJJ60MhhBA/AAAAAAAAAAI/AAAAAAAACd0/_eiTaccvKqM/photo.jpg?sz=128", "display_name": "Yauheni Pozdnyakov", "link": "https://stackoverflow.com/users/7109755/yauheni-pozdnyakov"}, "reply_to_user": {"reputation": 245, "user_id": 1496317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8aaed7a968f12467148e2a8a8c4ac2c0?s=128&d=identicon&r=PG", "display_name": "tsdtsdtsd", "link": "https://stackoverflow.com/users/1496317/tsdtsdtsd"}, "edited": false, "score": 0, "creation_date": 1490785026, "post_id": 43091005, "comment_id": 73264257, "body": "but it&#39;s not the cause of the problem. it stucks on   writes &lt;- writer{fileName: fileName, body: body}  line"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1490804188, "post_id": 43091005, "comment_id": 73279303, "body": "Do it anyway! Never ignore errors"}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1490814912, "post_id": 43091793, "comment_id": 73286160, "body": "&quot;causing the send to writes to crash the program&quot; --- this does not sound right tbh."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490819351, "post_id": 43091793, "comment_id": 73288662, "body": "@zerkms You&#39;re right, I was way off with that answer, sorry about that and thanks for pointing it out. I&#39;ve now updated my answer, if I&#39;m still wrong please let me know."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490819483, "post_id": 43091793, "comment_id": 73288738, "body": "Yep, now it looks right. But OP needs to consider rewriting their code though, it looks too complicated for what it does."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490819628, "post_id": 43091793, "comment_id": 73288808, "body": "Thanks for the feedback, and I agree, it does look complicated for that"}, {"owner": {"reputation": 143, "user_id": 7109755, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh6.googleusercontent.com/-8zJJ60MhhBA/AAAAAAAAAAI/AAAAAAAACd0/_eiTaccvKqM/photo.jpg?sz=128", "display_name": "Yauheni Pozdnyakov", "link": "https://stackoverflow.com/users/7109755/yauheni-pozdnyakov"}, "edited": false, "score": 0, "creation_date": 1490860764, "post_id": 43091793, "comment_id": 73303725, "body": "Thank you so much))) I&#39;ve started playing with go yesterday, so I&#39;m really sorry for my code"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1490819144, "last_edit_date": 1490819144, "creation_date": 1490785617, "answer_id": 43091793, "question_id": 43091005, "link": "https://stackoverflow.com/questions/43091005/go-web-crawler-gets-stuck/43091793#43091793", "title": "Go web crawler gets stuck", "body": "<p><strike>Your <code>for</code> loop ends up calling <code>go enqueue</code> more than once before the <code>select</code> receives the data causing the send to <code>writes</code> to crash the program, I think, I'm not really that familiar with Go's concurrency.</strike></p>\n\n<p><strong>Update</strong>: I'm sorry for the previous answer, it was a poorly informed attempt at explaining something I have only limited knowledge about. After taking a closer look I am <em>almost</em> certain of two things. <strong>1.</strong> Your <code>writes</code> channel is not <code>nil</code>, you can rely on <code>make</code> to initilize your channels. <strong>2.</strong> A <code>range</code> loop over a channel will block until that channel is closed. So your</p>\n\n<pre><code>for uri := range filteredQueue {\n    go enqueue(uri, queue)\n}\n</code></pre>\n\n<p>is blocking, therefore your program never reaches the <code>select</code> and so is unable to receive from the <code>writes</code> channel. You can avoid this by executing the <code>range</code> loop in a new goroutine. </p>\n\n<pre><code>go func() {\n    for uri := range filteredQueue {\n        go enqueue(uri, queue)\n    }\n}()\n</code></pre>\n\n<p>Your program, as is, will still break for other reasons but you should be able to fix that with a little synchronization using a <code>sync.WaitGroup</code>.\nHere's a simplified example: <a href=\"https://play.golang.org/p/o2Oj4g8c2y\" rel=\"nofollow noreferrer\">https://play.golang.org/p/o2Oj4g8c2y</a>.</p>\n"}], "owner": {"reputation": 143, "user_id": 7109755, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh6.googleusercontent.com/-8zJJ60MhhBA/AAAAAAAAAAI/AAAAAAAACd0/_eiTaccvKqM/photo.jpg?sz=128", "display_name": "Yauheni Pozdnyakov", "link": "https://stackoverflow.com/users/7109755/yauheni-pozdnyakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1490819144, "creation_date": 1490783374, "last_edit_date": 1490794740, "question_id": 43091005, "link": "https://stackoverflow.com/questions/43091005/go-web-crawler-gets-stuck", "title": "Go web crawler gets stuck", "body": "<p>I'm new to Go and trying to implement a web crawler. It should asynchronously parse web pages and save their contents to files, one file per new page. But it gets stuck after I've added   </p>\n\n<pre><code>u, _ := url.Parse(uri)\nfileName := u.Host + u.RawQuery + \".html\"\nbody, err := ioutil.ReadAll(resp.Body)\nwrites &lt;- writer{fileName: fileName, body: body}\n</code></pre>\n\n<p>Can anyone help me fix this problem? Basically I want to get data from the response body, push it to the channel, and then get data from the channel and put it into a file. \nIt looks like the <code>writes</code> channel was not initialized, and sending on a nil channel blocks forever.</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"flag\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"net/url\"\n    \"os\"\n    \"runtime\"\n\n    \"./linksCollector\"\n)\n\ntype writer struct {\n    fileName string\n    body     []byte\n}\n\nvar writes = make(chan writer)\n\nfunc usage() {\n    fmt.Fprintf(os.Stderr, \"usage: crawl http://example.com/\")\n    flag.PrintDefaults()\n    os.Exit(2)\n}\n\nfunc check(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\n\nfunc main() {\n    runtime.GOMAXPROCS(8)\n    flag.Usage = usage\n    flag.Parse()\n\n    args := flag.Args()\n    fmt.Println(args)\n    if len(args) &lt; 1 {\n        usage()\n        fmt.Println(\"Please specify start page\")\n        os.Exit(1)\n    }\n\n    queue := make(chan string)\n    filteredQueue := make(chan string)\n\n    go func() { queue &lt;- args[0] }()\n    go filterQueue(queue, filteredQueue)\n\n    for uri := range filteredQueue {\n        go enqueue(uri, queue)\n    }\n\n    for {\n        select {\n        case data := &lt;-writes:\n            f, err := os.Create(data.fileName)\n            check(err)\n            defer f.Close()\n            _, err = f.Write(data.body)\n            check(err)\n        }\n    }\n}\n\nfunc filterQueue(in chan string, out chan string) {\n    var seen = make(map[string]bool)\n    for val := range in {\n        if !seen[val] {\n            seen[val] = true\n            out &lt;- val\n        }\n    }\n}\n\nfunc enqueue(uri string, queue chan string) {\n    fmt.Println(\"fetching\", uri)\n    transport := &amp;http.Transport{\n        TLSClientConfig: &amp;tls.Config{\n            InsecureSkipVerify: true,\n        },\n    }\n    client := http.Client{Transport: transport}\n    resp, err := client.Get(uri)\n    check(err)\n\n    defer resp.Body.Close()\n\n    u, _ := url.Parse(uri)\n    fileName := u.Host + u.RawQuery + \".html\"\n    body, err := ioutil.ReadAll(resp.Body)\n    writes &lt;- writer{fileName: fileName, body: body}\n\n    links := collectlinks.All(resp.Body)\n\n    for _, link := range links {\n        absolute := fixURL(link, uri)\n        if uri != \"\" {\n            go func() { queue &lt;- absolute }()\n        }\n    }\n}\n\nfunc fixURL(href, base string) string {\n    uri, err := url.Parse(href)\n    if err != nil {\n        return \"\"\n    }\n    baseURL, err := url.Parse(base)\n    if err != nil {\n        return \"\"\n    }\n    uri = baseURL.ResolveReference(uri)\n    return uri.String()\n}\n</code></pre>\n"}, {"tags": ["arrays", "sorting", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 1129, "user_id": 1882311, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WpUGi.png?s=128&g=1", "display_name": "Soufiaane", "link": "https://stackoverflow.com/users/1882311/soufiaane"}, "edited": false, "score": 0, "creation_date": 1490863055, "post_id": 43093017, "comment_id": 73305078, "body": "Thanks, i forgot to mention that i&#39;m using version 1.5. but i tried <code>slice.Duplicated[i].TotalScore</code> like you mentioned instead of  <code>slice[i].TotalScore</code> like i did, and it works"}], "tags": [], "owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "is_accepted": true, "score": 4, "last_activity_date": 1490789061, "creation_date": 1490789061, "answer_id": 43093017, "question_id": 43090918, "link": "https://stackoverflow.com/questions/43090918/sorting-array-of-structs-missing-len-method/43093017#43093017", "title": "Sorting array of structs (missing Len method)", "body": "<p>Starting from Go 1.8, you can use the following function to sort your slice:</p>\n\n<pre><code>sort.Slice(DuplicatedAds.Duplicated, func(i int, j int) bool {\n    return DuplicatedAds.Duplicated[i].TotalScore &lt; DuplicatedAds.Duplicated[j].TotalScore\n})\n</code></pre>\n\n<p>You don't need to define those three functions up there anymore (<code>Len</code>, <code>Less</code> and <code>Swap</code>). Notice how we used the same implementation of <code>Len</code> as a parameter of <code>sort.Slice</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 654, "user_id": 3508122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057c941dbec272576741ee1db60cdc2?s=128&d=identicon&r=PG&f=1", "display_name": "user3508122", "link": "https://stackoverflow.com/users/3508122/user3508122"}, "is_accepted": false, "score": 0, "last_activity_date": 1490800739, "creation_date": 1490800739, "answer_id": 43097653, "question_id": 43090918, "link": "https://stackoverflow.com/questions/43090918/sorting-array-of-structs-missing-len-method/43097653#43097653", "title": "Sorting array of structs (missing Len method)", "body": "<p>cd1 offers a good solution. As for the reason your methods aren't working, it's because they're operating on a single struct and not a slice of structs.</p>\n\n<p>You would want something more like this where each method works on the DuplicatedAdSlice type rather than the DuplicatedAd type.</p>\n\n<pre><code>type DuplicatedAdSlice []DuplicatedAd // Type alias\n\nfunc (slice DuplicatedAdSlice) Len() int {\n    return len(slice)\n}\n</code></pre>\n\n<p>And update the CpResponse struct to use the type alias</p>\n\n<pre><code>// The Doublet Ads to show\nDuplicated DuplicatedAdSlice `json:\"duplicated\"`\n</code></pre>\n"}], "owner": {"reputation": 1129, "user_id": 1882311, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WpUGi.png?s=128&g=1", "display_name": "Soufiaane", "link": "https://stackoverflow.com/users/1882311/soufiaane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "accepted_answer_id": 43093017, "answer_count": 2, "score": 0, "last_activity_date": 1490800739, "creation_date": 1490783140, "last_edit_date": 1490784317, "question_id": 43090918, "link": "https://stackoverflow.com/questions/43090918/sorting-array-of-structs-missing-len-method", "title": "Sorting array of structs (missing Len method)", "body": "<p>I have two structs defined as below:</p>\n\n<pre><code>// DuplicatedAd format\ntype DuplicatedAd struct {\n    // Ad Identifier\n    AdID int `form:\"ad_id\" json:\"ad_id,omitempty\" xml:\"ad_id\"`\n    // Parameters of an Ad, can be empty\n    AdParams string `form:\"ad_params\" json:\"ad_params,omitempty\" xml:\"ad_params\"`\n    // Body of the Ad\n    Body string `form:\"body\" json:\"body,omitempty\" xml:\"body\"`\n    // Body Duplicate Percentage\n    BodyScore float64 `form:\"body_score\" json:\"body_score,omitempty\" xml:\"body_score\"`\n    // Category of the Ad\n    Category int `form:\"category\" json:\"category,omitempty\" xml:\"category\"`\n    // The ad uploaded main image\n    Image string `form:\"image,omitempty\" json:\"image,omitempty\" xml:\"image,omitempty\"`\n    // Ad Listing ID\n    ListID int `form:\"list_id\" json:\"list_id,omitempty\" xml:\"list_id\"`\n    // Listing time for the ad\n    ListTime string `form:\"list_time\" json:\"list_time,omitempty\" xml:\"list_time\"`\n    // the ad Phone number\n    Phone string `form:\"phone,omitempty\" json:\"phone,omitempty\" xml:\"phone,omitempty\"`\n    // Region of the Ad\n    Region int `form:\"region\" json:\"region,omitempty\" xml:\"region\"`\n    // Ad Status\n    Status string `form:\"status\" json:\"status,omitempty\" xml:\"status\"`\n    // Subject of the Ad\n    Subject string `form:\"subject\" json:\"subject,omitempty\" xml:\"subject\"`\n    // Subject Duplicate Percentage\n    SubjectScore float64 `form:\"subject_score\" json:\"subject_score,omitempty\" xml:\"subject_score\"`\n    // Type of the Ad\n    Type string `form:\"type\" json:\"type,omitempty\" xml:\"type\"`\n    // Total Score\n    TotalScore float64 `form:\"total_score\" json:\"total_score,omitempty\" xml:\"total_score\"`\n}\n\n// CpResponse format\ntype CpResponse struct {\n    // Number of doublets\n    Count int `json:\"count\"`\n    // The Doublet Ads to show\n    Duplicated []DuplicatedAd `json:\"duplicated\"`\n}\n</code></pre>\n\n<p>i'm defining a variable <code>var DuplicatedAds = CpResponse{}</code>and in a loop i'm appending some results to it as follow:</p>\n\n<pre><code>DuplicatedAds.Duplicated = append(DuplicatedAds.Duplicated, t)\nDuplicatedAds.Count = len(DuplicatedAds.Duplicated)\n</code></pre>\n\n<p>i wish that the <code>DuplicatedAds.Duplicated</code> be sorted by <code>TotalScore</code>.</p>\n\n<p>i'm new to golang, so after a little research i found out that i must implement theses three functions before i can sort</p>\n\n<pre><code>func (slice DuplicatedAd) Len() int {\n    return len(slice)\n}\n\nfunc (slice DuplicatedAd) Less(i, j int) bool {\n    return slice[i].TotalScore &lt; slice[j].TotalScore\n}\n\nfunc (slice DuplicatedAd) Swap(i, j int) {\n    slice[i], slice[j] = slice[j], slice[i]\n}\n</code></pre>\n\n<p>but when i try to compile i get this errors:</p>\n\n<pre><code>./duplicates.go:165: cannot use DuplicatedAds.Duplicated (type []DuplicatedAd) as type sort.Interface in argument to sort.Sort:\n    []DuplicatedAd does not implement sort.Interface (missing Len method)\n./types.go:68: invalid argument slice (type DuplicatedAd) for len\n./types.go:72: invalid operation: slice[i] (type DuplicatedAd does not support indexing)\n./types.go:72: invalid operation: slice[j] (type DuplicatedAd does not support indexing)\n./types.go:76: invalid operation: slice[i] (type DuplicatedAd does not support indexing)\n./types.go:76: invalid operation: slice[j] (type DuplicatedAd does not support indexing)\n./types.go:76: invalid operation: slice[i] (type DuplicatedAd does not support indexing)\n</code></pre>\n\n<p>How could i have an <code>CpResponse</code> object which his <code>Duplicated</code> array is sorted by <code>DuplicatedAd.TotalScore</code> ? </p>\n"}, {"tags": ["json", "go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "is_accepted": true, "score": 1, "last_activity_date": 1490778976, "creation_date": 1490778976, "answer_id": 43089285, "question_id": 43089138, "link": "https://stackoverflow.com/questions/43089138/struct-for-json-response/43089285#43089285", "title": "Struct for JSON Response", "body": "<p>Here you go. You can put the result as <code>map[string][][]float64</code> also. But this is more readable I think.</p>\n\n<pre><code>type Result [][]float64\n\ntype Response struct {\n    Result    map[string]Result `json:\"result\"`\n    Allowance struct {\n        Cost      int `json:\"cost\"`\n        Remaining int `json:\"remaining\"`\n    } `json:\"allowance\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 529, "user_id": 914584, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/14a97f2fd7d2c80353e37d6278ad8f4f?s=128&d=identicon&r=PG", "display_name": "user914584", "link": "https://stackoverflow.com/users/914584/user914584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 43089285, "answer_count": 1, "score": -1, "last_activity_date": 1490778976, "creation_date": 1490778587, "question_id": 43089138, "link": "https://stackoverflow.com/questions/43089138/struct-for-json-response", "title": "Struct for JSON Response", "body": "<p>I'm trying to workout how the type-struct should be for this JSON response.\nfrom CryptoWatch <a href=\"https://api.cryptowat.ch/markets/kraken/btcusd/ohlc?periods=60\" rel=\"nofollow noreferrer\">https://api.cryptowat.ch/markets/kraken/btcusd/ohlc?periods=60</a></p>\n\n<pre><code>{\n  \"result\": {\n    \"60\": [\n      [\n        1490733900,\n        1027.001,\n        1027.001,\n        1027,\n        1027,\n        0.024999999\n      ],\n      [\n        1490733960,\n        1027,\n        1027,\n        1027,\n        1027,\n        12.61904\n      ],\n      [\n        1490778360,\n        1037.749,\n        1037.749,\n        1037.749,\n        1037.749,\n        0.0052474597\n      ]\n    ]\n  },\n  \"allowance\": {\n    \"cost\": 1234,\n    \"remaining\": 456677\n  }\n}\n</code></pre>\n\n<ol>\n<li><p>I've tried the JSON-TO-GoLang-Struct service.</p>\n\n<p>type AutoGenerated struct {\n    Result struct {\n        Num60 []struct {\n        Num0 int <code>json:\"0\"</code>\n        Num1 float64 <code>json:\"1\"</code>\n        Num2 float64 <code>json:\"2\"</code>\n        Num3 int <code>json:\"3\"</code>\n        Num4 int <code>json:\"4\"</code>\n        Num5 float64 <code>json:\"5\"</code>\n        } <code>json:\"60\"</code>\n} <code>json:\"result\"</code>\n        Allowance struct {\n            Cost int <code>json:\"cost\"</code>\n            Remaining int <code>json:\"remaining\"</code>\n        } <code>json:\"allowance\"</code>\n}</p>\n\n<p>code-formatting seems broken :/</p></li>\n</ol>\n\n<p>It seems to get stuck on array-to-struct error when i tried to decode it.</p>\n\n<ol start=\"2\">\n<li>I don't want to use the map+interface method for this struct.</li>\n</ol>\n"}, {"tags": ["node.js", "performance", "go", "multiprocessing", "cpu-usage"], "comments": [{"owner": {"reputation": 1438, "user_id": 1483927, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67162c81a0c88a1906521d757604cd44?s=128&d=identicon&r=PG", "display_name": "Ajax", "link": "https://stackoverflow.com/users/1483927/ajax"}, "edited": false, "score": 0, "creation_date": 1491681750, "post_id": 43087315, "comment_id": 73665096, "body": "You can use cluster module but it won&#39;t help you improve the request latency. Depends on what you are trying to achieve."}], "answers": [{"tags": [], "owner": {"reputation": 893, "user_id": 6560877, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36d2589e3de8d31298f8538ad48168dc?s=128&d=identicon&r=PG&f=1", "display_name": "AJS", "link": "https://stackoverflow.com/users/6560877/ajs"}, "is_accepted": false, "score": 0, "last_activity_date": 1490773777, "creation_date": 1490773777, "answer_id": 43087472, "question_id": 43087315, "link": "https://stackoverflow.com/questions/43087315/how-to-fix-nodejs-underutilizing-cpu-cores/43087472#43087472", "title": "How to fix NodeJS underutilizing CPU Cores?", "body": "<p>You need to install Cluster module of nodejs in order to take full advantage of CPU cores when running cpu-intensive code. </p>\n"}, {"tags": [], "owner": {"reputation": 50397, "user_id": 1318694, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/JPEVC.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1318694/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1490774059, "creation_date": 1490774059, "answer_id": 43087568, "question_id": 43087315, "link": "https://stackoverflow.com/questions/43087315/how-to-fix-nodejs-underutilizing-cpu-cores/43087568#43087568", "title": "How to fix NodeJS underutilizing CPU Cores?", "body": "<p>Multiple processes will do. For 4 cpus/threads you need 4 Node.js processes to make use of them. That requires a workload that can be split between processes though. </p>\n\n<p>Node.js provides the <a href=\"https://nodejs.org/api/cluster.html\" rel=\"nofollow noreferrer\">Cluster</a> module to distribute socket connections between multiple worker processes which may help in some workloads, but I doubt this would help any of the benchmark workloads. </p>\n"}, {"tags": [], "owner": {"reputation": 594, "user_id": 804721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h2ATF.jpg?s=128&g=1", "display_name": "Ankit Gomkale", "link": "https://stackoverflow.com/users/804721/ankit-gomkale"}, "is_accepted": false, "score": 0, "last_activity_date": 1490778107, "last_edit_date": 1592644375, "creation_date": 1490778107, "answer_id": 43088966, "question_id": 43087315, "link": "https://stackoverflow.com/questions/43087315/how-to-fix-nodejs-underutilizing-cpu-cores/43088966#43088966", "title": "How to fix NodeJS underutilizing CPU Cores?", "body": "<p>Node.js is indeed a single threaded process. However, you can make use of <a href=\"https://nodejs.org/api/cluster.html\" rel=\"nofollow noreferrer\">clustering</a> to spawn multiple workers on multiple cores.</p>\n<p>If you are not using <a href=\"https://github.com/Unitech/pm2\" rel=\"nofollow noreferrer\">PM2</a> for spawning the app, please consider using it. PM2 makes spawning workers on multiple cores super easy.</p>\n<blockquote>\n<p>pm2 start app.js -i max</p>\n</blockquote>\n<p>This command will spawn workers on each available core.</p>\n<p>Also, note that if you are using session/sockets then you might face some problems because of clustering.</p>\n"}], "owner": {"reputation": 996, "user_id": 5266767, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/852b19120d60f4852964889f5a6dc01e?s=128&d=identicon&r=PG&f=1", "display_name": "d9ngle", "link": "https://stackoverflow.com/users/5266767/d9ngle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1338, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1490778107, "creation_date": 1490773280, "question_id": 43087315, "link": "https://stackoverflow.com/questions/43087315/how-to-fix-nodejs-underutilizing-cpu-cores", "title": "How to fix NodeJS underutilizing CPU Cores?", "body": "<p>According to this page <a href=\"https://benchmarksgame.alioth.debian.org/u64q/compare.php?lang=go&amp;lang2=node\" rel=\"nofollow noreferrer\">Go vs Node.js</a>, Node.js is not showing to be taking full advantage of CPU cores when running cpu-intensive code.</p>\n\n<p>If I use virtualization and simply add more Node.js instances, will I achieve the same performance as Go? I suppose there still will be overheads and one won't be able to achieve the same performance.</p>\n"}, {"tags": ["go", "debian", "pbuilder", "govendor"], "answers": [{"comments": [{"owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1527427078, "post_id": 43086165, "comment_id": 88115871, "body": "From the author: <i>&quot;NOTE: goxc has long been in maintenance mode. Ever since Go1.5 supported simple cross-compilation, this tool lost much of its value. . . I&#39;m very much a go user, but I myself haven&#39;t had any need for goxc for a long while.&quot;</i> So, IMHO, don&#39;t waste your time checking into it, which I did following this answer. :-("}], "tags": [], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "is_accepted": false, "score": 0, "last_activity_date": 1490769711, "creation_date": 1490769711, "answer_id": 43086165, "question_id": 43084647, "link": "https://stackoverflow.com/questions/43084647/go-importing-vendor-dependencies-issue-when-building-a-go-1-7-project-using-gove/43086165#43086165", "title": "Go importing vendor dependencies issue when building a Go 1.7 project using govendor, dh-make-golang", "body": "<p>Take a look at <a href=\"https://github.com/laher/goxc\" rel=\"nofollow noreferrer\">goxc</a> - it can do this for you!</p>\n\n<p>You simply need to add a <code>.goxc.json</code> to the root of your directory, that looks like this</p>\n\n<pre><code>{\n    \"AppName\": \"my_app\",\n    \"ArtifactsDest\": \"downloads\",\n    \"Tasks\": [\n        \"interpolate-source\"\n        \"deb\",\n    ],\n    \"BuildConstraints\": \"linux,amd64 windows,amd64 darwin,amd64 linux,arm\",\n    \"ResourcesInclude\": \"INSTALL*,README*,LICENSE*,config/*,static/*,templates/*\",\n    \"PackageVersion\": \"0.9.3\",\n    \"TaskSettings\": {\n        \"deb\": {\n            \"metadata\": {\n                \"description\": \"my app\",\n                \"maintainer\": \"me\",\n                \"maintainer-email\": \"me@example.com\"\n            },\n            \"metadata-deb\": {\n                \"Homepage\": \"https://example.com\"\n            },\n            \"other-mapped-files\": {\n                \"/\": \"debian/\",\n                \"/usr/share/something/static\": \"static/\",\n                \"/usr/share/something/templates\": \"templates/\"\n            }\n        }\n    },\n    \"ConfigVersion\": \"0.9\"\n}\n</code></pre>\n\n<p>Then run <code>goxc</code> and it'll do all the work for you.</p>\n"}, {"tags": [], "owner": {"reputation": 354, "user_id": 5194666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g74e3.png?s=128&g=1", "display_name": "baisang", "link": "https://stackoverflow.com/users/5194666/baisang"}, "is_accepted": true, "score": 1, "last_activity_date": 1490826583, "creation_date": 1490826583, "answer_id": 43105330, "question_id": 43084647, "link": "https://stackoverflow.com/questions/43084647/go-importing-vendor-dependencies-issue-when-building-a-go-1-7-project-using-gove/43105330#43105330", "title": "Go importing vendor dependencies issue when building a Go 1.7 project using govendor, dh-make-golang", "body": "<p>Issue was a bug in <code>dh-make-golang</code> regarding importing vendor dependencies. It was just fixed today.</p>\n\n<p><a href=\"https://github.com/Debian/dh-make-golang/issues/46\" rel=\"nofollow noreferrer\">https://github.com/Debian/dh-make-golang/issues/46</a></p>\n"}], "owner": {"reputation": 354, "user_id": 5194666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g74e3.png?s=128&g=1", "display_name": "baisang", "link": "https://stackoverflow.com/users/5194666/baisang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 43105330, "answer_count": 2, "score": 1, "last_activity_date": 1527427225, "creation_date": 1490763160, "last_edit_date": 1527427225, "question_id": 43084647, "link": "https://stackoverflow.com/questions/43084647/go-importing-vendor-dependencies-issue-when-building-a-go-1-7-project-using-gove", "title": "Go importing vendor dependencies issue when building a Go 1.7 project using govendor, dh-make-golang", "body": "<p>I've been looking into building a go project into a debian package.</p>\n\n<p>I've looked into <a href=\"https://people.debian.org/~stapelberg/2015/07/27/dh-make-golang.html\" rel=\"nofollow noreferrer\">dh-make-golang</a> and I have a nice and shiny <code>debian</code> folder set up in my repository. When I try to use <code>gbp buildpackage --git-pbuilder</code> though it errors out due to all of my dependencies not being found. It seems that <code>dh-make-golang</code> ignores the <code>vendor</code> folder when it copies everything from my project's git repository, and I use <code>govendor</code> so all of my dependencies are in there.</p>\n\n<p>How can I resolve this dependency issue and build the project as a <code>.deb</code> package properly? For reference, the error I am getting is:</p>\n\n<p><code>src/github.com/project/project/project.go:15:2: cannot find package \"google.golang.org/grpc/grpclog\" in any of:\n    /usr/lib/go-1.7/src/google.golang.org/grpc/grpclog (from $GOROOT)\n    /tmp/project/obj-x86_64-linux-gnu/src/google.golang.org/grpc/grpclog (from $GOPATH)\n</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1490754594, "post_id": 43082936, "comment_id": 73249202, "body": "In broad strokes, the approach in the question is similar to how the database/sql and image packages handle this issue.  See the implementations of <a href=\"https://godoc.org/database/sql#Open\" rel=\"nofollow noreferrer\">Open</a> / <a href=\"https://godoc.org/database/sql#Register\" rel=\"nofollow noreferrer\">Register</a> in database/sql."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1490757716, "post_id": 43082936, "comment_id": 73250085, "body": "Related / similar question: <a href=\"http://stackoverflow.com/questions/29271440/registering-packages-in-go-without-cyclic-dependency\">Registering packages in Go without cyclic dependency</a>."}, {"owner": {"reputation": 297, "user_id": 7467314, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8c4715513d18c3b7c8c20346296c85da?s=128&d=identicon&r=PG&f=1", "display_name": "user7467314", "link": "https://stackoverflow.com/users/7467314/user7467314"}, "edited": false, "score": 0, "creation_date": 1490811974, "post_id": 43082936, "comment_id": 73284299, "body": "The problem originally arose because I had a cyclical dependency -very helpful links guys, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 297, "user_id": 7467314, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8c4715513d18c3b7c8c20346296c85da?s=128&d=identicon&r=PG&f=1", "display_name": "user7467314", "link": "https://stackoverflow.com/users/7467314/user7467314"}, "edited": false, "score": 0, "creation_date": 1490811903, "post_id": 43096173, "comment_id": 73284252, "body": "I think you&#39;re right, i&#39;m just overcomplicating things. It would make sense to have a registry/factory and dynamically configuration repos if this were a library, but since all supported backends are already &#39;baked in&#39; to the server as you say, there really is no point."}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1490797078, "creation_date": 1490797078, "answer_id": 43096173, "question_id": 43082936, "link": "https://stackoverflow.com/questions/43082936/instantiating-an-interface-implementation-based-on-a-dynamic-configuration-value/43096173#43096173", "title": "Instantiating an interface implementation based on a dynamic configuration value", "body": "<p>Do you need dynamic registration? It seems like the list of backends is already baked into your server because of the <code>AppConfig</code> type, so you may be better just writing the simplest possible factory code:</p>\n\n<pre><code>func getRepo(cfg *AppConfig) (Repository, error) {\n    switch cfg.DatabaseName {\n    case \"bolt\":\n        return bolt.New(cfg.BoltConfig), nil\n    case \"redis\":\n        return redis.New(cfg.RedisConfig), nil\n    }\n    return nil, fmt.Errorf(\"unknown database: %q\", cfg.DatabaseName)\n}\n\nfunc main() {\n    ...\n    var cfg AppConfig\n    if err := json.Unmarshal(data, &amp;cfg); err != nil {\n        log.Fatalf(\"failed to parse config: %s\", err)\n    }\n    repo, err := getRepo(&amp;cfg)\n    if err != nil {\n        log.Fatalln(\"repo construction failed: %s\", err)\n    }\n   ...\n</code></pre>\n\n<p>}</p>\n\n<p>Sure, you can replace this with generic reflection-based code. But while that saves a few lines of duplicated code and removes the need to update <code>getRepo</code> if you add a new backend, it introduces a whole mess of confusing abstraction, and you're going to have to edit code anyway if you introduce a new backend (for example, extending your <code>AppConfig</code> type), so saving a couple of lines in <code>getRepo</code> is hardly a saving.</p>\n\n<p>It might make sense to move <code>getRepo</code> and <code>AppConfig</code> into a <code>repos</code> package if this code is used by more than one program.</p>\n"}], "owner": {"reputation": 297, "user_id": 7467314, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8c4715513d18c3b7c8c20346296c85da?s=128&d=identicon&r=PG&f=1", "display_name": "user7467314", "link": "https://stackoverflow.com/users/7467314/user7467314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 43096173, "answer_count": 1, "score": 0, "last_activity_date": 1490797078, "creation_date": 1490752640, "question_id": 43082936, "link": "https://stackoverflow.com/questions/43082936/instantiating-an-interface-implementation-based-on-a-dynamic-configuration-value", "title": "Instantiating an interface implementation based on a dynamic configuration value", "body": "<p>New Gopher here, coming from Java land.</p>\n\n<p>Let's say I have a some generic storage interface:</p>\n\n<pre><code>package repositories\n\ntype Repository interface {\n  Get(key string) string\n  Save(key string) string\n}\n</code></pre>\n\n<p>I support multiple different backends (Redis, Boltdb, etc) by implementing this interface in separate packages. However, each implementation has unique configuration values that need to be passed in. So I define a constructor in each package, something like:</p>\n\n<pre><code>package redis \n\ntype Config struct {\n ...\n}\n\nfunc New(config *Config) *RedisRepository {\n  ...\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>package bolt\n\ntype Config struct {\n  ...\n}\n\nfunc New(config *Config) *BoltRepository {\n  ...\n}\n</code></pre>\n\n<p><code>main.go</code> reads a json configuration file that looks something like:</p>\n\n<pre><code>type AppConfig struct {\n  DatabaseName string,\n  BoltConfig *bolt.Config,\n  RedisConfig *redis.Config,\n}\n</code></pre>\n\n<p>Based on the value of <code>DatabaseName</code>, the app will instantiate the desired repository. What is the best way to do this? Where do I do it? Right now I'm doing some kind of horrible factoryfactory method which seems very much like a Go anti-pattern. </p>\n\n<p>in my main.go, I have a function that reads the above reflected configuration values, selecting the proper configuration (either <code>BoltConfig</code> or <code>RedisConfig</code>) based on the value of <code>DatabaseName</code>:</p>\n\n<pre><code>func newRepo(c reflect.Value, repoName string) (repositories.Repository, error) {\n    t := strings.Title(repoName)\n\n    repoConfig := c.FieldByName(t).Interface()\n\n    repoFactory, err := repositories.RepoFactory(t)\n    if err != nil {\n        return nil, err\n    }\n\n    return repoFactory(repoConfig)\n}\n</code></pre>\n\n<p>and in my <code>repositories</code> package, I have a factory that looks for the repository type and returns a factory function that produces an instantiated repository:</p>\n\n<pre><code>func RepoFactory(provider string) (RepoProviderFunc, error) {\n    r, ok := repositoryProviders[provider]\n    if !ok {\n        return nil, fmt.Errorf(\"repository does not exist for provider: %s\", r)\n    }\n    return r, nil\n}\n\ntype RepoProviderFunc func(config interface{}) (Repository, error)\n\nvar ErrBadConfigType = errors.New(\"wrong configuration type\")\n\nvar repositoryProviders = map[string]RepoProviderFunc{\n    redis: func(config interface{}) (Repository, error) {\n        c, ok := config.(*redis.Config)\n        if !ok {\n            return nil, ErrBadConfigType\n        }\n        return redis.New(c)\n    },\n    bolt: func(config interface{}) (Repository, error) {\n        c, ok := config.(*bolt.Config)\n        if !ok {\n            return nil, ErrBadConfigType\n        }\n        return bolt.New(c)\n    },\n}\n</code></pre>\n\n<p>bringing it all together, my <code>main.go</code> looks like:</p>\n\n<pre><code>cfg := &amp;AppConfig{}\nerr = json.Unmarshal(data, cfg)\nif err != nil {\n    log.Fatalln(err)\n}\n\nc := reflect.ValueOf(*cfg)\n\nrepo, err := newRepo(c, cfg.DatabaseName)\nif err != nil {\n    log.Fatalln(err)\n}\n</code></pre>\n\n<p>And yes, the second I was done typing this code I recoiled at the horror I had brought into this world. Can someone please help me escape this factory hell? What's a better way to do this type of thing -i.e selecting an interface implementation at runtime. </p>\n"}, {"tags": ["java", "performance", "go"], "comments": [{"owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "edited": false, "score": 2, "creation_date": 1490752119, "post_id": 43082115, "comment_id": 73248535, "body": "I think simply measuring the execution time of a program might not be good enough to interpret the results in any meaningful way. There are  heaps of unknowns on the path from your code down to the processor (-core) and back to your terminal window."}, {"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 2, "creation_date": 1490754101, "post_id": 43082115, "comment_id": 73249063, "body": "Micro-benchmarks like this are a fool&#39;s game. This comparison <a href=\"http://benchmarksgame.alioth.debian.org/u64q/go.html\" rel=\"nofollow noreferrer\">benchmarksgame.alioth.debian.org/u64q/go.html</a> shows one benchmark where Go has a 2.2 to 1 speed advantage, but several others where Java wins handily. Details of code generation and runtime environment easily have those kinds of effects."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1490761478, "post_id": 43082115, "comment_id": 73251175, "body": "You have a lot going on, maybe you can isolate parts and test them individually."}, {"owner": {"reputation": 849, "user_id": 62235, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb41b9603b602b0ed13c2d55837105fa?s=128&d=identicon&r=PG", "display_name": "Ben Boyter", "link": "https://stackoverflow.com/users/62235/ben-boyter"}, "edited": false, "score": 0, "creation_date": 1490762602, "post_id": 43082115, "comment_id": 73251461, "body": "So the performance critical areas for both are in playGames and game. If you look at them they are both almost 100% the same."}, {"owner": {"reputation": 42073, "user_id": 113632, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f0aa6977c75f54ca9033d4f4d0244023?s=128&d=identicon&r=PG", "display_name": "dimo414", "link": "https://stackoverflow.com/users/113632/dimo414"}, "edited": false, "score": 1, "creation_date": 1490770095, "post_id": 43082115, "comment_id": 73254571, "body": "Then either (a) your performance-critical analysis is flawed or (b) the issue as actually elsewhere. Either way the other comments about the conceptual issues involved in benchmarking or comparing two different languages are accurate. It&#39;s a bit like asking &quot;Why is a Chevy faster than a Honda?&quot; which - I hope you can appreciate - doesn&#39;t really make sense to ask."}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1490824472, "post_id": 43082115, "comment_id": 73291213, "body": "Do I have to do something special at compilation time to make the Go version run in parallel? Even with 16 workers defined, it&#39;s only running on one CPU for me."}, {"owner": {"reputation": 849, "user_id": 62235, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb41b9603b602b0ed13c2d55837105fa?s=128&d=identicon&r=PG", "display_name": "Ben Boyter", "link": "https://stackoverflow.com/users/62235/ben-boyter"}, "reply_to_user": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1490826508, "post_id": 43082115, "comment_id": 73291972, "body": "@Dolda2000 If you are running 1.7 it should do it for you. I ran it with a simple go run main.go and it maxed out all cores. Otherwise you need to set the number of cores for it."}], "answers": [{"comments": [{"owner": {"reputation": 849, "user_id": 62235, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb41b9603b602b0ed13c2d55837105fa?s=128&d=identicon&r=PG", "display_name": "Ben Boyter", "link": "https://stackoverflow.com/users/62235/ben-boyter"}, "edited": false, "score": 0, "creation_date": 1490833159, "post_id": 43105758, "comment_id": 73293967, "body": "Thank you so much! I was going crazy wondering about this and never even considered that it might just be doing more work."}], "tags": [], "owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "is_accepted": true, "score": 47, "last_activity_date": 1490829307, "last_edit_date": 1490829307, "creation_date": 1490828956, "answer_id": 43105758, "question_id": 43082115, "link": "https://stackoverflow.com/questions/43082115/why-is-this-golang-solution-faster-then-the-equivalent-java-solution/43105758#43105758", "title": "Why is this GoLang solution faster then the equivalent Java Solution?", "body": "<p>As it turns out, your programs aren't as equal as you believe them to be. I instrumented them to see how many games (that is, individual betting rounds) they simulated, and while the Go version simulated 1 612 629 805 games, the Java version simulated 12 323 903 502 games, almost an order of magnitude more.</p>\n\n<p>On my machine, turning off multithreading for more predictable results, the Java program clocked in on around 75 seconds, and the Go program on 12.5 seconds. Matching that against the total runtime, it appears that the Java program is actually slightly <em>faster</em> per simulated game, at about 6.1 ns, as compared to 7.8 ns for the Go program.</p>\n\n<p>Not sure yet why they simulate such vastly different numbers of games, though. Perhaps the way the Go version generates the rounds simply happens to find a lot more quicker terminations.</p>\n\n<p><strong>EDIT</strong>: Actually, that last guess makes a lot of sense. The Go version starts off by modulating the initial rounds of a game, while the Java version starts off by modulating the last rounds of a game (in other words, looking at the list of rounds as a list of increasing 11-digit base-3 numbers, the Go version is little-endian, while the Java version is big-endian, so to speak), so the Java version will have to simulate through a lot more identical starts to get to the variations that terminate. I haven't tried to verify this hypothesis, but I'm sure enough about it that I don't feel the need to.</p>\n"}], "owner": {"reputation": 849, "user_id": 62235, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb41b9603b602b0ed13c2d55837105fa?s=128&d=identicon&r=PG", "display_name": "Ben Boyter", "link": "https://stackoverflow.com/users/62235/ben-boyter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3972, "favorite_count": 6, "accepted_answer_id": 43105758, "answer_count": 1, "score": 38, "last_activity_date": 1491087085, "creation_date": 1490746653, "last_edit_date": 1491087085, "question_id": 43082115, "link": "https://stackoverflow.com/questions/43082115/why-is-this-golang-solution-faster-then-the-equivalent-java-solution", "title": "Why is this GoLang solution faster then the equivalent Java Solution?", "body": "<p>Recently at work we were playing around with the following quiz question asked by IBM <a href=\"https://www.research.ibm.com/haifa/ponderthis/challenges/May2015.html\" rel=\"noreferrer\">https://www.research.ibm.com/haifa/ponderthis/challenges/May2015.html</a> </p>\n\n<p>After a bit of effort a colleague and I have arrived at two solutions, one in GoLang <a href=\"https://gist.github.com/walesey/e2427c28a859c4f7bc920c9af2858492#file-main-go-L57\" rel=\"noreferrer\">https://gist.github.com/walesey/e2427c28a859c4f7bc920c9af2858492#file-main-go-L57</a> and the other in Java <a href=\"https://gist.github.com/boyter/42df7f203c0932e37980f7974c017ec5#file-puzzle-java-L63\" rel=\"noreferrer\">https://gist.github.com/boyter/42df7f203c0932e37980f7974c017ec5#file-puzzle-java-L63</a> with the performance critical method for both being playGames in Java and game in GoLang (both linked in above).</p>\n\n<p>The Go program is almost a literal copy of the Java one, and yet its runtime is ~6 seconds whereas the Java one is about ~26 seconds (on my local machine). Similar numbers were replicated on a few other machines with the Go program being about ~5x faster.</p>\n\n<p>The Go program is compiled using 1.7.5 and Java using version 1.8.0_65 both running on macOS Sierra 10.12.3 on a late 2013 retina Macbook Pro with 2.6GHz i5 CPU.</p>\n\n<p>Why is it that the Go program is 5x faster then the Java one when most benchmarks indicate that Java should about the same runtime? It is just basic math in a loop so it seems that they should run about the same time. I could understand a second or so for the JVM start time, but this seems off.</p>\n\n<p>Both programs use pretty much the same loop. All of the possible permutations of game results are created and iterated over for each starting amount of money. It just seems that for any number of looping operations in the main loop that Go is running rings around Java. </p>\n\n<p>I understand that this is a \"micro\" benchmark, but I am wondering why exactly the Go code is massively outperforming the Java code. Is it just that Go for simple loops/math is more efficient and hence faster? Is it able to unroll the loop perhaps (although this seems unlikely to produce such a massive difference)?</p>\n\n<p>If not how should you structure a Java program to get the most performance out of a simple loop and math operation?</p>\n\n<p><strong>EDIT</strong> - Thanks to Dolda2000 I have modified the Java version. It is now about the same speed as the GoLang version. Indeed the issue was the the games were created causing the Java version to have to simulate more games to determine if the game went long enough. With the changes it is running in about ~6 seconds now and has restored my faith in Java.</p>\n\n<p><strong>Update</strong> - Here is an <a href=\"http://www.boyter.org/2017/03/golang-solution-faster-equivalent-java-solution/\" rel=\"noreferrer\">expanded essay</a> which discusses the background of this question in further detail.</p>\n"}, {"tags": ["go", "benchmarking"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7292827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faacca74a006bc522b94bb8e99ba0a2b?s=128&d=identicon&r=PG&f=1", "display_name": "Wilder Galvao", "link": "https://stackoverflow.com/users/7292827/wilder-galvao"}, "edited": false, "score": 1, "creation_date": 1490755553, "post_id": 43082226, "comment_id": 73249444, "body": "Oh my God. I feel so stupid now. For some reason I thought that the benchmark function wouldn&#39;t produce the output of &quot;echo&quot;. Thank you very much!"}], "tags": [], "owner": {"reputation": 14127, "user_id": 641627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEgWh.jpg?s=128&g=1", "display_name": "alexbt", "link": "https://stackoverflow.com/users/641627/alexbt"}, "is_accepted": true, "score": 2, "last_activity_date": 1551918613, "last_edit_date": 1551918613, "creation_date": 1490747371, "answer_id": 43082226, "question_id": 43082006, "link": "https://stackoverflow.com/questions/43082006/strange-output-when-running-go-benchmark/43082226#43082226", "title": "Strange output when running Go Benchmark", "body": "<p>You understand that <code>b.N</code> has a really big value and thus Echo1 gets executed many many times ?\nThe only explanation is that Echo1 is printing the text you are seeing.</p>\n\n<p>Your <code>Echo1()</code> function probably contains something like this:</p>\n\n<pre><code>var s string\nfor i := 1; i &lt; len(os.Args); i++ {\n    s += os.Args[i]\n}\nfmt.Println(s)\n</code></pre>\n\n<ul>\n<li><a href=\"https://dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go\" rel=\"nofollow noreferrer\">https://dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go</a></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 7292827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faacca74a006bc522b94bb8e99ba0a2b?s=128&d=identicon&r=PG&f=1", "display_name": "Wilder Galvao", "link": "https://stackoverflow.com/users/7292827/wilder-galvao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 43082226, "answer_count": 1, "score": 0, "last_activity_date": 1551918613, "creation_date": 1490745878, "question_id": 43082006, "link": "https://stackoverflow.com/questions/43082006/strange-output-when-running-go-benchmark", "title": "Strange output when running Go Benchmark", "body": "<p>I'm trying to write a benchmark function for a simple echo program in Go (Exercise 1.3 from \"The Go Programming Language\" book). Here is the code:</p>\n\n<pre><code>package echo\n\nimport \"testing\"\n\nfunc BenchmarkEcho1(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        Echo1()\n    }\n}\n</code></pre>\n\n<p>When I run <code>go test -bench=.</code> the output is this:</p>\n\n<pre><code>PASS\nBenchmarkEcho1-4    -test.bench=Echo1\n-test.bench=Echo1\n-test.bench=Echo1\n-test.bench=Echo1\n[...]\n-test.bench=Echo1\n-test.bench=Echo1\n-test.bench=Echo1\n-test.bench=Echo1\n 1000000          1358 ns/op\nok      gopl.io/ch1/exercise1.3/echo    1.377s\n</code></pre>\n\n<p>There a lot of <code>-test.bench=Echo1</code> between the first and the last lines. Why is this happening? What can I do to omit these lines?</p>\n"}, {"tags": ["performance", "go", "benchmarking"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1490739219, "post_id": 43080851, "comment_id": 73244926, "body": "Your <code>binary</code> approaches don\u2019t do the same thing as the original. Does that mean the format is flexible and you just need to store two integers together in some number of bytes?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1490739292, "post_id": 43080851, "comment_id": 73244948, "body": "I was thinking the same thing. You started with a string output, then started packing bits. What exactly is it that you want this function to spit out?"}, {"owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "edited": false, "score": 0, "creation_date": 1490739434, "post_id": 43080851, "comment_id": 73244999, "body": "Sorry for being unclear. It&#39;s used for a data caching key that needs to store 2 integers as keys to identify their combined uniqueness. An older version was even <code>fmt.Sprintf(&quot;%d_%d&quot;)</code>, but that didn&#39;t seem necessary anymore."}, {"owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "edited": false, "score": 0, "creation_date": 1490739780, "post_id": 43080851, "comment_id": 73245132, "body": "For clarification. The cache-key is a <code>[]byte</code>, which is currently wrapped around the <code>fmt.Sprintf()</code>. I figured reserving the max of 2 int64 (Database Pkey Ints) and putting them in their own 8 bytes part would be just as valid. Please correct me if I&#39;m wrong tho."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490740294, "post_id": 43080851, "comment_id": 73245314, "body": "You&#39;ve made it all the way down to the smallest building blocks of the integers. I&#39;m not sure this can really run any quicker. It&#39;s cool to see how things evolved as they did. Thanks for sharing, but I don&#39;t think I can help :)"}, {"owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "edited": false, "score": 0, "creation_date": 1490740695, "post_id": 43080851, "comment_id": 73245446, "body": "That&#39;s ok :) Thanks for the response tho! Even tho this tweak seems small it upped my <code>wrk</code> <code>req&#47;sec</code> from <code>~43500</code> to ~<code>44250</code>. Because Go is so insanely fast, these tweaks that might look so small significantly contribute to lighter calls, making it easier and easier to run fast sites on light servers for small customers :)"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1490744615, "post_id": 43080851, "comment_id": 73246661, "body": "Well, good thing you\u2019re moving away from <code>%d%d</code> then, because that makes (1000, 10) and (10001, 0) produce the same result."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1490746262, "post_id": 43080851, "comment_id": 73247086, "body": "In your real code, are you writing to a global? Making <code>concatBuffStr</code> local might be faster."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490763316, "post_id": 43080851, "comment_id": 73251698, "body": "Try <a href=\"https://golang.org/pkg/strconv/#AppendInt\" rel=\"nofollow noreferrer\">golang.org/pkg/strconv/#AppendInt</a> on a empty buffer but with large enough <i>capacity</i> so that no allocations happen. This will probably be the fastest."}, {"owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "edited": false, "score": 0, "creation_date": 1490804642, "post_id": 43080851, "comment_id": 73279614, "body": "The buffer has to be local as it&#39;s unique per request of the web-app. The original code was with the underscore in between so that was safe. The actual stated <code>%d%d</code> was already when starting the optimisation :). strconv.AppendInt sadly doesn&#39;t work correctly as it won&#39;t reserve the correct bytes for both parts."}], "owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490741220, "creation_date": 1490738998, "last_edit_date": 1490741220, "question_id": 43080851, "link": "https://stackoverflow.com/questions/43080851/64-bit-unsigned-integer-concat-benchmarking", "title": "64-bit Unsigned Integer concat benchmarking", "body": "<p>I have a tweak question. I had some repetitive pieces of code in my web-app requests where simple things like <code>fmt.Sprintf(\"%d%d\", 01293123, 234993923)</code> happens.</p>\n\n<p>Now I did some benchmarks and tested a bytes writer, which was quite slow (~400 ns/op). The <code>sprintf</code> itself was about 240 ns/op. Then I did strings joining:</p>\n\n<pre><code>var concatBuffStr []byte\n\nfunc BenchmarkStringsJoin(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        concatBuffStr = []byte(strings.Join([]string{\n            strconv.Itoa(2),\n            strconv.Itoa(3),\n        }, \" \"))\n    }\n}\n\n152 ns/op\n</code></pre>\n\n<p>A big improvement already. But then I tried clunking 2 ints converted to bytes together</p>\n\n<pre><code>var concatBuffStr []byte\n\nfunc BenchmarkConcatIntsAsBytes(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        aBuf := make([]byte, 8)\n        bBuf := make([]byte, 8)\n        binary.BigEndian.PutUint64(aBuf, uint64(2))\n        binary.BigEndian.PutUint64(bBuf, uint64(3))\n        concatBuffStr = append(aBuf, bBuf...)\n    }\n}\n\n57.8 ns/op\n</code></pre>\n\n<p>Amazing! But I could just avoid glueing them together and already reserve the full 16 bytes for 2 maxed out 64 bit uints spaces:</p>\n\n<pre><code>var concatBuffStr []byte\n\nfunc BenchmarkCopyIntsAsBytes(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        concatBuffStr = make([]byte, 16)\n        bBuf := make([]byte, 8)\n        binary.BigEndian.PutUint64(concatBuffStr, uint64(123123))\n        binary.BigEndian.PutUint64(bBuf, uint64(3453455))\n        copy(concatBuffStr[8:], bBuf)\n    }\n}\n\n30.4 ns/op\n</code></pre>\n\n<p>By now we're 8 times faster than with the <code>fmt.Sprintf()</code> method.</p>\n\n<p>Was wondering if there is an even faster way than this. I want to avoid <code>unsafe</code> tho.</p>\n\n<p>I was also thinking of checking the max value of both 2 ints and if they are below the MAX of an <code>uint32</code> or <code>uint16</code> I could customize the logic. Benchmarking the <code>uint16</code> downgrade by hand is around <code>23 ns/op</code>, but that's not realistic as in the web-request itself it would still need to check the size of the ints and do extra logic, which will likely result in more overhead than that <code>7 ns/op</code> gain.</p>\n\n<p><strong>Update</strong></p>\n\n<p>I managed to simplify it a little bit more:</p>\n\n<pre><code>var concatBuffStr []byte\n\nfunc BenchmarkCopyIntsAsBytesShort(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        concatBuffStr = make([]byte, 16)\n        binary.BigEndian.PutUint64(concatBuffStr, uint64(123123))\n        binary.BigEndian.PutUint64(concatBuffStr[8:], uint64(3453455))\n    }\n}\n\n28.6 ns/op\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "admin"], "comments": [{"owner": {"reputation": 1544, "user_id": 4555367, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/kA6dj.jpg?s=128&g=1", "display_name": "Prasad", "link": "https://stackoverflow.com/users/4555367/prasad"}, "edited": false, "score": 1, "creation_date": 1490758424, "post_id": 43080487, "comment_id": 73250274, "body": "Welcome to Stack Overflow Pls Go through <a href=\"https://stackoverflow.com/help/how-to-ask\">How To Ask</a>"}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1490870300, "post_id": 43080487, "comment_id": 73310164, "body": "Would you add a link to your post in Google Groups? We tend to discourage cross-posting on the web, since it often results in duplication of volunteer effort."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6133984, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZZ-l7llqDD4/AAAAAAAAAAI/AAAAAAAAHIg/Eqmv2rZeHMA/photo.jpg?sz=128", "display_name": "Edwin Vinas", "link": "https://stackoverflow.com/users/6133984/edwin-vinas"}, "edited": false, "score": 0, "creation_date": 1490818953, "post_id": 43103233, "comment_id": 73288431, "body": "Thanks for the response. Although I was hoping the documentation would have been clearer about how to pass the permission required. As you can see in this REST API documentation in App Engine, it never mentioned about IAM which needs be setup. <a href=\"https://cloud.google.com/appengine/docs/admin-api/reference/rest/v1/apps/create\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/admin-api/reference/rest/v1/&zwnj;&#8203;&hellip;</a>  As for the account I used, yes I was able to set it up using IAM and Admin in the Console and tried different settings and even make the accounts as Appengine Admin role. Tried both for a billed and non-billed accounts but same issue."}, {"owner": {"reputation": 3493, "user_id": 4270992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZTDS.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4270992/nick"}, "reply_to_user": {"reputation": 21, "user_id": 6133984, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZZ-l7llqDD4/AAAAAAAAAAI/AAAAAAAAHIg/Eqmv2rZeHMA/photo.jpg?sz=128", "display_name": "Edwin Vinas", "link": "https://stackoverflow.com/users/6133984/edwin-vinas"}, "edited": false, "score": 0, "creation_date": 1491428094, "post_id": 43103233, "comment_id": 73554222, "body": "Hey @EdwinVinas, you should file a report in the <a href=\"http://issuetracker.google.com/\" rel=\"nofollow noreferrer\">Public Issue Tracker</a> under &quot;Public Trackers &gt; Cloud Platform &gt; Compute &gt; App Engine&quot;, and explain the steps you took, link the document you think needs changing, etc., and we&#39;ll be able to update the documentation or iron out any issues that might be occurring."}, {"owner": {"reputation": 21, "user_id": 6133984, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZZ-l7llqDD4/AAAAAAAAAAI/AAAAAAAAHIg/Eqmv2rZeHMA/photo.jpg?sz=128", "display_name": "Edwin Vinas", "link": "https://stackoverflow.com/users/6133984/edwin-vinas"}, "edited": false, "score": 0, "creation_date": 1491685758, "post_id": 43103233, "comment_id": 73666338, "body": "Hey @Nick, report has been filed in the said public issue tracker. Thanks!"}, {"owner": {"reputation": 1562, "user_id": 2116253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d18481602b26e29ba696feb3425ecbf?s=128&d=identicon&r=PG", "display_name": "Phil", "link": "https://stackoverflow.com/users/2116253/phil"}, "edited": false, "score": 0, "creation_date": 1515000348, "post_id": 43103233, "comment_id": 83138799, "body": "Any update? I think the problem is that the <b>Appengine Admin</b> role does NOT include the <b>appengine.applications.create</b> permission, which I find a bit strange.  Creating a custom role with that permission does not seem to work (for me) either.  Would be grateful to hear back from somebody that has managed to create an application in google cloud through the API."}], "tags": [], "owner": {"reputation": 3493, "user_id": 4270992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZTDS.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4270992/nick"}, "is_accepted": false, "score": 2, "last_activity_date": 1490818296, "creation_date": 1490818296, "answer_id": 43103233, "question_id": 43080487, "link": "https://stackoverflow.com/questions/43080487/app-engine-admin-api-error-the-appengine-applications-create-permission-is-r/43103233#43103233", "title": "App Engine Admin API Error - The &quot;appengine.applications.create&quot; permission is required", "body": "<p>It seems you've given no details about how you set up the account you're using to authorize the request. You'll need to make sure the <code>appengine.applications.create</code> permission is given to the account you're using, as mentioned in the error text. You can use the <a href=\"https://cloud.google.com/iam/reference/rest/\" rel=\"nofollow noreferrer\">Google Identity and Access Management (IAM) API</a> for this.</p>\n\n<p>(by the way, I'd given this answer in the original thread, although you didn't reply or seem to take action on it. check it out! this is likely the solution you need!)</p>\n"}], "owner": {"reputation": 21, "user_id": 6133984, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZZ-l7llqDD4/AAAAAAAAAAI/AAAAAAAAHIg/Eqmv2rZeHMA/photo.jpg?sz=128", "display_name": "Edwin Vinas", "link": "https://stackoverflow.com/users/6133984/edwin-vinas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1624, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490870258, "creation_date": 1490737374, "last_edit_date": 1490870258, "question_id": 43080487, "link": "https://stackoverflow.com/questions/43080487/app-engine-admin-api-error-the-appengine-applications-create-permission-is-r", "title": "App Engine Admin API Error - The &quot;appengine.applications.create&quot; permission is required", "body": "<p>We would like to automatically create a project ID and install our ULAPPH Cloud Desktop application using the App Engine Admin API (REST) and Golang.\n<a href=\"https://cloud.google.com/appengine/docs/admin-api/?hl=en_US&amp;_ga=1.265860687.1935695756.1490699302\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/admin-api/?hl=en_US&amp;_ga=1.265860687.1935695756.1490699302</a>\n<a href=\"https://ulapph-public-1.appspot.com/articles?TYPE=ARTICLE&amp;DOC_ID=3&amp;SID=TDSARTL-3\" rel=\"nofollow noreferrer\">https://ulapph-public-1.appspot.com/articles?TYPE=ARTICLE&amp;DOC_ID=3&amp;SID=TDSARTL-3</a></p>\n\n<p>We were able to get a token but when we tried to create a project ID, we get the error below.</p>\n\n<pre><code>[Response OK] Successful connection to Appengine Admin API.\n[Token] { \"access_token\" : \"TOKEN_HERE\", \"expires_in\" : 3599, \"token_type\" : \"Bearer\" }\n\n[Response Code] 403\n[Response Body] { \"error\": { \"code\": 403, \"message\": \"Operation not allowed\", \"status\": \"PERMISSION_DENIED\", \"details\": [ { \"@type\": \"type.googleapis.com/google.rpc.ResourceInfo\", \"resourceType\": \"gae.api\", \"description\": \"The \\\"appengine.applications.create\\\" permission is required.\" } ] } }\n</code></pre>\n\n<p>We are just using the REST API calls. Request for token was successful as you can see above and the scope is ok as well. Now, when we posted the request to create application, we are having the error that says <code>\"appengine.application.create\"</code> permission required. </p>\n\n<p>How do we specify the permission? </p>\n\n<p>What are the possible reasons why we are getting that error? Do we missed to send a field in JSON or in query?</p>\n\n<p>As per below link, we just need to pass the json containing the id and location. We also just need to pass the token in the Authorization header. The same logic I have used successfully in accessing Youtube, Drive APIs etc so not sure what needs to be done since I have followed the docs available.</p>\n\n<p>I have also posted the same issue in Google Groups and now waiting for their reply.</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490737717, "post_id": 43080315, "comment_id": 73244240, "body": "For starters, did you mean for your <code>func</code>s <code>F0</code> and <code>F1</code> to take a <code>*T0</code> as argument? Or did you mean to declare methods on <code>T0</code>? e.g. <code>func (t *T0) F0() error {}</code>."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1490737754, "post_id": 43080315, "comment_id": 73244257, "body": "The expression <code>(*error)(nil)</code> is a pointer to an <code>error</code> interface, with the pointer being nil.  A pointer to an interface does not implement the interface (ie. a <code>*error</code> does not implement the <code>error</code> interface), as Go eliminated automatic pointer dereferencing for interface pointers a few versions back (because pointers to interfaces are almost always incorrect or useless.)"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1490737862, "post_id": 43080315, "comment_id": 73244304, "body": "Also, what&#39;s the point of this check?  Are you trying to let the client pass in a callback function that takes <i>any</i> struct pointer as an argument and returns an error?  How are you planning to call that callback if your program doesn&#39;t know what type the function is?  If the callback must take a specific struct type (or pointer to it) as an argument, why not just use a type assertion instead of reflection, like <a href=\"https://play.golang.org/p/fYbB8qqM_m\" rel=\"nofollow noreferrer\">play.golang.org/p/fYbB8qqM_m</a>?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1490742672, "post_id": 43080315, "comment_id": 73246075, "body": "After fixing the compilation errors, the code works as I think you want  it to: <a href=\"https://play.golang.org/p/nqooMtkoQ-\" rel=\"nofollow noreferrer\">play.golang.org/p/nqooMtkoQ-</a>.  Depending on your requirements, you many want to use <code>tpFunc.Out(0) == errorInterface</code> instead checking to see if the return type implements the interface.  And as @Kaedys noted, reflect may not be needed here."}, {"owner": {"reputation": 83, "user_id": 3223171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69d75a797baf9fe9831ae1e1cb851d60?s=128&d=identicon&r=PG&f=1", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3223171/danilo"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1490794760, "post_id": 43080315, "comment_id": 73271513, "body": "I ways testing wrong . Actually my code worked as expected. @Kaedys,  yes, I want a funcion that receive and call a function that receive any struct and return any error.  I&#39;m calling it with the snippet added to my original  post."}], "owner": {"reputation": 83, "user_id": 3223171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69d75a797baf9fe9831ae1e1cb851d60?s=128&d=identicon&r=PG&f=1", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3223171/danilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 536, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490794928, "creation_date": 1490736672, "last_edit_date": 1490794928, "question_id": 43080315, "link": "https://stackoverflow.com/questions/43080315/check-if-a-reflect-type-does-implements-another-reflect-type", "title": "Check if a reflect.Type does implements another reflect.Type", "body": "<p>Heys guys,\nI'm creating a library in golang for my company. I want the client pass to us a callback with func(t ) error;\nSince there's no generics in Go, I'm trying to check the arguments and return type through reflection.</p>\n\n<p>But I'm failling right now. Any help?</p>\n\n<pre><code>func check(F interface{}) bool {\n    errorInterface  := reflect.TypeOf((*error)(nil)).Elem()\n    if tpFunc := reflect.TypeOf(Func); tpFunc.Kind() != reflect.Func {\n        return false\n    } else if tpFunc.NumIn() != 1 || tpFunc.NumOut() != 1 {\n        return false\n    } else if tpArg := tpFunc.In(0); tpArg.Kind() != reflect.Ptr || tpArg.Elem().Kind() != reflect.Struct {\n        return false\n    } else if tpRet := tpFunc.Out(0); tpRet.Implements(errorInterface)  {\n        return false\n    }\n    return true\n}\n\n\n\ntype T0 struct {\n   A int64\n   B float\n}\n\nfunc F0(t *T0) error {\n  ...\n}\n\nfunc F1(t *T0) int {\n  ...\n}\n</code></pre>\n\n<p>Fortunatelly my code actually works with syntax corrections, as pointed by @Cerise Lim\u00f3n. <a href=\"https://play.golang.org/p/nqooMtkoQ-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/nqooMtkoQ-</a></p>\n\n<p>As @Kaedys asked, I'm calling the F function by reflection.</p>\n\n<pre><code>        arg0 := reflect.New(tpArg.Elem()).Interface()\n        if err := json.Unmarshal(msg.Body, arg0); hadError(err) {\n            hadError(toErrorQueue(msg))\n        } else {\n            callback := reflect.ValueOf(Func)\n            args := []reflect.Value{reflect.ValueOf(arg0)}\n            if errInterface := callback.Call(args)[0].Interface(); errInterface != nil &amp;&amp; hadError(errInterface.(error)) {\n                hadError(toErrorQueue(msg))\n            }\n        }\n</code></pre>\n"}, {"tags": ["go", "intellij-idea", "makefile", "file-watcher"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1490737064, "post_id": 43080273, "comment_id": 73243976, "body": "Good to know, hadn&#39;t thought of adding this type of trigger (I only have a <code>goimports</code> one configured)."}], "tags": [], "owner": {"reputation": 5556, "user_id": 1549950, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4e1d79b0859761cf6de8f560784226cc?s=128&d=identicon&r=PG", "display_name": "Michael Lihs", "link": "https://stackoverflow.com/users/1549950/michael-lihs"}, "is_accepted": false, "score": 3, "last_activity_date": 1490736458, "creation_date": 1490736458, "answer_id": 43080273, "question_id": 43080232, "link": "https://stackoverflow.com/questions/43080232/use-file-watcher-in-intellij-to-run-makefile/43080273#43080273", "title": "Use File Watcher in IntelliJ to run Makefile", "body": "<p>Solution was that I had to specify the <em>Working Directory</em> in <em>Other Options</em>. When I set this to <code>$ContentRoot$</code>, everything works as expected.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Fysmg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Fysmg.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5556, "user_id": 1549950, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4e1d79b0859761cf6de8f560784226cc?s=128&d=identicon&r=PG", "display_name": "Michael Lihs", "link": "https://stackoverflow.com/users/1549950/michael-lihs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490889450, "creation_date": 1490736304, "last_edit_date": 1490889450, "question_id": 43080232, "link": "https://stackoverflow.com/questions/43080232/use-file-watcher-in-intellij-to-run-makefile", "title": "Use File Watcher in IntelliJ to run Makefile", "body": "<p>I would like to run a Makefile in IntelliJ whenever a source file changes. Therefore I installed the File Watcher plugin and added a new File Watcher for Go files. In the Watcher Settings I added <code>make</code> as the Program and <code>test</code> for the Arguments.</p>\n\n<p>When I now change a <code>.go</code> file, I get the following error message:</p>\n\n<pre><code>make test\nmake: *** No rule to make target `test'.  Stop.\n\nProcess finished with exit code 2\n</code></pre>\n\n<p>so I assume that the file watcher works in general but is somehow runs the make command in the wrong directory.</p>\n\n<p>When I run <code>make test</code> in a terminal from the root of my project, everything works as expected and I get:</p>\n\n<pre><code>Formatting all packages...\nCode analysis with go vet...\nExecute test with ginkgo...\n[1490735873] Cmd Suite - 1/1 specs \u2022 SUCCESS! 120.183\u00b5s PASS\n[1490735873] Test Helpers Suite - 4/4 specs \u2022\u2022\u2022\u2022 SUCCESS! 125.046\u00b5s PASS\n[1490735873] Models Suite - 5/5 specs \u2022\u2022\u2022\u2022\u2022 SUCCESS! 453.456\u00b5s PASS\n[1490735873] Services Suite - 16/16 specs \u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022 SUCCESS! 3.035275ms PASS\n\nGinkgo ran 4 suites in 855.886243ms\nTest Suite Passed\n</code></pre>\n\n<p>What am I doing wrong - or am I missing the point of using file watchers in IntelliJ?</p>\n"}, {"tags": ["json", "go", "marshalling"], "comments": [{"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1490729303, "post_id": 43077665, "comment_id": 73239823, "body": "If an answer by Brad Fitzpatrick is not enough for you, I don\u2019t know what is. <a href=\"https://github.com/golang/go/issues/6213\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/6213</a>"}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1490730863, "post_id": 43077665, "comment_id": 73240697, "body": "Also if you super want to you can use go generate to write the Marshall JSON functions"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1490775610, "last_edit_date": 1490775610, "creation_date": 1490749211, "answer_id": 43082469, "question_id": 43077665, "link": "https://stackoverflow.com/questions/43077665/how-do-i-inline-fields-when-marshalling-json/43082469#43082469", "title": "How do I inline fields when marshalling JSON?", "body": "<p>I know this is not the answer you wish to receive, but until inline support is added to the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a> package, you may use the following workaround:</p>\n\n<p>Make your <code>MonthYear</code> a struct, e.g.:</p>\n\n<pre><code>type MonthYear struct {\n    t     time.Time\n    Month int `json:\"month\"`\n    Year  int `json:\"year\"`\n}\n</code></pre>\n\n<p>An optional, constructor function for easy creation:</p>\n\n<pre><code>func NewMonthYear(t time.Time) MonthYear {\n    return MonthYear{\n        t:     t,\n        Month: int(t.Month()) - 1,\n        Year:  t.Year(),\n    }\n}\n</code></pre>\n\n<p>And use <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">embedding</a> (anonymous field) instead of a regular (named) field to get \"flattened\" / inlined in the JSON representation:</p>\n\n<pre><code>type Event struct {\n    Name string `json:\"name\"`\n    MonthYear\n}\n\ntype Item struct {\n    Category string `json:\"category\"`\n    MonthYear\n}\n</code></pre>\n\n<p>As an extra, you'll be able to refer to fields directly like <code>Event.Year</code> or <code>Event.Month</code> which is nice.</p>\n\n<p>Testing it:</p>\n\n<pre><code>evt := Event{Name: \"party\", MonthYear: NewMonthYear(time.Now())}\nfmt.Println(json.NewEncoder(os.Stdout).Encode(evt), evt.Year)\n\nitm := Item{Category: \"Tool\", MonthYear: NewMonthYear(time.Now())}\nfmt.Println(json.NewEncoder(os.Stdout).Encode(itm))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/ud7gLnrdmz\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{\"name\":\"party\",\"month\":10,\"year\":2009}\n&lt;nil&gt; 2009\n{\"category\":\"Tool\",\"month\":10,\"year\":2009}\n&lt;nil&gt;\n</code></pre>\n\n<p>Note: The <code>MonthYear.t</code> time field does not play a role here (it is not marshaled either). You can remove it if the original <code>time.Time</code> is not needed.</p>\n"}], "owner": {"reputation": 86, "user_id": 597260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a734b57900a075b08538714f183a201a?s=128&d=identicon&r=PG", "display_name": "yefim", "link": "https://stackoverflow.com/users/597260/yefim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6623, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1490775610, "creation_date": 1490727225, "question_id": 43077665, "link": "https://stackoverflow.com/questions/43077665/how-do-i-inline-fields-when-marshalling-json", "title": "How do I inline fields when marshalling JSON?", "body": "<p>I have a type <code>MonthYear</code> defined like</p>\n\n<pre><code>type MonthYear time.Time\n\nfunc (my *MonthYear) MarshalJSON() ([]byte, error) {\n    t := time.Time(*my)\n\n    return json.Marshal(&amp;struct {\n        Month int `json:\"month\"`\n        Year  int `json:\"year\"`\n    }{\n        Month: int(t.Month()) - 1,\n        Year:  t.Year(),\n    })\n}\n</code></pre>\n\n<p>I'm including it a lot of different structs like</p>\n\n<pre><code>type Event struct {\n    Name string `json:\"name\"`\n    Date MonthYear\n}\n\ntype Item struct {\n    Category string `json:\"category\"`\n    Date     MonthYear\n}\n</code></pre>\n\n<p>How do I inline the <code>MonthYear</code> type so that the resulting JSON does not have any embedded objects?</p>\n\n<p>I want the result to look like <code>{ \"name\": \"party\", \"month\": 2, \"year\": 2017 }</code> and <code>{ \"category\": \"art\", \"month\": 3, \"year\": 2016 }</code> without having to write the MarshalJSON for each of the structs.</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 5391763, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7c0ea35805214e297dbeb54c116e99c9?s=128&d=identicon&r=PG&f=1", "display_name": "Zozo", "link": "https://stackoverflow.com/users/5391763/zozo"}, "edited": false, "score": 0, "creation_date": 1490729358, "post_id": 43077722, "comment_id": 73239859, "body": "yeah but ,i cant manipulate with data because interface{} does not support indexing"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 97, "user_id": 5391763, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7c0ea35805214e297dbeb54c116e99c9?s=128&d=identicon&r=PG&f=1", "display_name": "Zozo", "link": "https://stackoverflow.com/users/5391763/zozo"}, "edited": false, "score": 0, "creation_date": 1490729559, "post_id": 43077722, "comment_id": 73239964, "body": "Then you have to use type conversions.. see updates above"}, {"owner": {"reputation": 97, "user_id": 5391763, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7c0ea35805214e297dbeb54c116e99c9?s=128&d=identicon&r=PG&f=1", "display_name": "Zozo", "link": "https://stackoverflow.com/users/5391763/zozo"}, "edited": false, "score": 0, "creation_date": 1490730785, "post_id": 43077722, "comment_id": 73240640, "body": "well i cant organize the json data better because this is what i get from a service.. Thanks for your answer"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 97, "user_id": 5391763, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7c0ea35805214e297dbeb54c116e99c9?s=128&d=identicon&r=PG&f=1", "display_name": "Zozo", "link": "https://stackoverflow.com/users/5391763/zozo"}, "edited": false, "score": 0, "creation_date": 1490731488, "post_id": 43077722, "comment_id": 73241099, "body": "Yes...but you could do it programmatically.  See above i&#39;ve done it for you so that you have an idea in the future."}], "tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": true, "score": 0, "last_activity_date": 1490731506, "last_edit_date": 1490731506, "creation_date": 1490727432, "answer_id": 43077722, "question_id": 43077124, "link": "https://stackoverflow.com/questions/43077124/how-to-unmarshal-nested-json-to-a-struct-if-the-outer-element-is-not-the-same-i/43077722#43077722", "title": "How to unmarshal nested json to a struct, if the outer element is not the same in GO", "body": "<p>given it's dynamic nature it might be easier use a map[string]interface as you'll not be able to define dynamic keys like asd123 and 2movie23123.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nconst j = `{\n    \"movies\": [\n        {\n            \"asd123\": {\n                \"actors\": [\n                    \"&lt;actorID1123123&gt;\",\n                    \"&lt;actorID1123123&gt;\",\n                    \"&lt;actorID1123123&gt;\",\n                    \"&lt;actorID1123123&gt;\",\n                    \"&lt;actorID1123123&gt;\",\n                    \"&lt;actorID1123123&gt;\"\n                ]\n            },\n            \"ID\": 99992,\n            \"length\": 120,\n            \"relaseDate\": \"2.10.2012\"\n        },\n        {\n            \"2movie23123\": {\n                \"actors\": [\n                    \"&lt;actorID1123123&gt;\",\n                    \"&lt;actorID1123123&gt;\",\n                    \"&lt;actorID1123123&gt;\",\n                    \"&lt;actorID1123123&gt;\",\n                    \"&lt;actorID1123123&gt;\",\n                    \"&lt;actorID1123123&gt;\"\n                ]\n            },\n            \"ID\": 123124,\n            \"length\": 90,\n            \"relaseDate\": \"10.10.2012\"\n        }\n    ]\n    }`\n\n// Movies ...\ntype Movies struct {\n    Name        string\n    ID          float64\n    Length      float64\n    ReleaseDate string\n    Actors      []interface{}\n}\n\nfunc main() {\n    data := map[string]interface{}{}\n    err := json.Unmarshal([]byte(j), &amp;data)\n    if err != nil {\n        panic(err)\n    }\n    // printing it out to show you it marshaled\n    // b, _ := json.MarshalIndent(data, \"\", \" \")\n    // fmt.Println(string(b))\n    //\n    var myMovies []Movies\n\n    for _, d := range data {\n        temp := Movies{}\n        converting := d.([]interface{})\n        for _, movie := range converting {\n            convertingMovie := movie.(map[string]interface{})\n            temp.Length = convertingMovie[\"length\"].(float64)\n            temp.ID = convertingMovie[\"ID\"].(float64)\n            temp.ReleaseDate = convertingMovie[\"relaseDate\"].(string)\n            // getting rid of these keys so the for loop below doesn't iterate on them\n            // need the for loop cuz I don't know what the key name is\n            delete(convertingMovie, \"length\")\n            delete(convertingMovie, \"ID\")\n            delete(convertingMovie, \"relaseDate\")\n            for key, val := range convertingMovie {\n                temp.Name = key\n                actors := val.(map[string]interface{})\n                temp.Actors = actors[\"actors\"].([]interface{})\n            }\n        }\n        myMovies = append(myMovies, temp)\n    }\n\n    b, _ := json.MarshalIndent(myMovies, \"\", \" \")\n    fmt.Println(string(b))\n\n}\n</code></pre>\n\n<p>Probably a better way to do it above, but I provided a quick example.  The best way would be to organize the json data better so that it fits into a struct better, otherwise the use reflection.  Without to much more work, I'd use the for loop above, and add it to a struct in a may that makes sense to me and so that it can access the data easier.  Consider above the start of the JSON parser, so now that you can access the json data, fit it into a struct then, change data around.</p>\n"}], "owner": {"reputation": 97, "user_id": 5391763, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7c0ea35805214e297dbeb54c116e99c9?s=128&d=identicon&r=PG&f=1", "display_name": "Zozo", "link": "https://stackoverflow.com/users/5391763/zozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 43077722, "answer_count": 1, "score": 0, "last_activity_date": 1490732573, "creation_date": 1490725304, "last_edit_date": 1490732573, "question_id": 43077124, "link": "https://stackoverflow.com/questions/43077124/how-to-unmarshal-nested-json-to-a-struct-if-the-outer-element-is-not-the-same-i", "title": "How to unmarshal nested json to a struct, if the outer element is not the same in GO", "body": "<p>Hi i wonder if it is possible to unmarshal this given json to a struct</p>\n\n<pre><code>type Movie struct {\n    Title string\n    Actors []string\n    ID int\n    Length int\n    RelaseDate string\n}\n</code></pre>\n\n<p>Here is an example of the json</p>\n\n<pre><code>{\n\"movies\": [\n    {\n        \"movie_title_A\": {\n            \"actors\": [\n                \"&lt;actorID1123123&gt;\",\n                \"&lt;actorID1123123&gt;\",\n                \"&lt;actorID1123123&gt;\",\n                \"&lt;actorID1123123&gt;\",\n                \"&lt;actorID1123123&gt;\",\n                \"&lt;actorID1123123&gt;....\"\n            ]\n        },\n        \"ID\": 99992,\n        \"length\": 120,\n        \"relaseDate\": \"2.10.2012\"\n    },\n    {\n        \"movie_title_B\": {\n            \"actors\": [\n                \"&lt;actorID1123123&gt;\",\n                \"&lt;actorID1123123&gt;\",\n                \"&lt;actorID1123123&gt;\",\n                \"&lt;actorID1123123&gt;\",\n                \"&lt;actorID1123123&gt;\",\n                \"&lt;actorID1123123&gt;....\"\n            ]\n        },\n        \"ID\": 123124,\n        \"length\": 90,\n        \"relaseDate\": \"10.10.2012\"\n    }\n]\n}\n</code></pre>\n\n<p>As you can see the Name field can take on any name, since it is the title of the movie. Is there an efficient way to put it into the struct above?\nAny help would be nice, thanks</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 2, "creation_date": 1490719107, "post_id": 43074939, "comment_id": 73233878, "body": "Works fine in the playground <a href=\"https://play.golang.org/p/fgnOdNRDA0\" rel=\"nofollow noreferrer\">play.golang.org/p/fgnOdNRDA0</a>"}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490719199, "post_id": 43074939, "comment_id": 73233939, "body": "Not for me... <a href=\"https://play.golang.org/p/bMCKdzFe0i\" rel=\"nofollow noreferrer\">play.golang.org/p/bMCKdzFe0i</a> A B &lt;invalid Value&gt;"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1490719316, "post_id": 43074939, "comment_id": 73234015, "body": "I edited the question -- it was confusing originally because working code was presented along with some slightly hard-to-understand changes described in prose that actually represent the problem."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1490719407, "post_id": 43074939, "comment_id": 73234080, "body": "PS: this appears to be a variant of code that I originally wrote in <a href=\"http://stackoverflow.com/questions/18930910/golang-access-struct-property-by-name/18931036#18931036\" title=\"golang access struct property by name\">stackoverflow.com/questions/18930910/&hellip;</a> . Some of the things I said there apply here too -- especially about avoiding reflection."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1490719444, "post_id": 43074939, "comment_id": 73234099, "body": "If you don&#39;t embed SubVertex, you&#39;re using reflection to find the field Z in a struct that has no field Z (it has a field sub.Z, but not Z).  If you need the sub field, you need to either look for the struct and then the field in that struct, or embed the struct."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1490719508, "post_id": 43074939, "comment_id": 73234130, "body": "I note also that the <code>reflect.Indirect</code> is redundant here -- in the original version of the code the Vertex was passed in via a pointer, but that&#39;s not the case here."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1490719670, "post_id": 43074939, "comment_id": 73234222, "body": "This works, but probably isn&#39;t what you want, but may give you an idea. You could maybe detect an invalid value and in that case, go deeper. <a href=\"https://play.golang.org/p/kgEDjYcovo\" rel=\"nofollow noreferrer\">play.golang.org/p/kgEDjYcovo</a>"}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1490719912, "post_id": 43074939, "comment_id": 73234365, "body": "yep, this gives me an idea, thnx. Using pointers does not change anything I think. search for &quot;SubVertex.Z&quot; in original version gives &lt;invalid value&gt; too. But now that get_subvertex_field makes it clearer for me"}], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 4, "last_activity_date": 1490721641, "last_edit_date": 1490721641, "creation_date": 1490721251, "answer_id": 43075851, "question_id": 43074939, "link": "https://stackoverflow.com/questions/43074939/getting-substruct-field-in-go/43075851#43075851", "title": "Getting substruct field in Go", "body": "<p>In this case, you have to use the reflect package in the same manner as you would accessing the values normally. So</p>\n\n<pre><code>v.X // a\nv.Y // b\nv.SubVertex.Z // c\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>r := reflect.ValueOf(v)\nx := reflect.Indirect(r).FieldByName(\"X\")\nx.String() // a\n...\nz := reflect.Indirect(r).FieldByName(\"SubVertex\").FieldByName(\"Z\")\nz.String() // c\n</code></pre>\n\n<p>Note that <code>FieldByName()</code> is called on a <code>Value</code> and returns a <code>Value</code>, so it works much the same as just accessing it regularly. Also note that as per the documentation:</p>\n\n<blockquote>\n  <p>Indirect returns the value that v points to. If v is a nil pointer, Indirect returns a zero Value. If v is not a pointer, Indirect returns v.</p>\n</blockquote>\n\n<p>So the call to <code>Indirect()</code> would be a No-op, but would protect it from having a meltdown if you decided to give it a pointer in the future.</p>\n\n<p>As for your function, this would work</p>\n\n<pre><code>func get_field(v Vertex, field string) string {\n    r := reflect.ValueOf(v)\n    if field == \"Z\" {\n        f := reflect.Indirect(r).FieldByName(\"SubVertex\").FieldByName(field)\n        return f.String()\n    }\n    f := reflect.Indirect(r).FieldByName(field)\n\n    return f.String()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/eZyTl8OSTZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eZyTl8OSTZ</a></p>\n"}], "owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 1, "accepted_answer_id": 43075851, "answer_count": 1, "score": 1, "last_activity_date": 1490721641, "creation_date": 1490718323, "last_edit_date": 1490719251, "question_id": 43074939, "link": "https://stackoverflow.com/questions/43074939/getting-substruct-field-in-go", "title": "Getting substruct field in Go", "body": "<p>I am trying to get fields from a <code>struct</code> value using reflection.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Vertex struct {\n    X         string\n    Y         string\n    SubVertex SubVertex\n}\ntype SubVertex struct {\n    Z string\n}\n\nfunc get_field(v Vertex, field string) string {\n    r := reflect.ValueOf(v)\n    f := reflect.Indirect(r).FieldByName(field)\n    return f.String()\n}\n\nfunc main() {\n    v := Vertex{\"a\", \"b\", SubVertex{\"c\"}}\n\n    fmt.Println(get_field(v, \"X\"))\n    fmt.Println(get_field(v, \"Y\"))\n    fmt.Println(get_field(v, \"Z\"))  // Invalid Value\n}\n</code></pre>\n\n<p>I get <strong>Invalid Value</strong> in the third case, when I try to get the value of the <code>Z</code> field. If <code>SubVertex</code> were an anonymous field, this would work, but I need to use a named field.</p>\n\n<p>How do I make this work?</p>\n"}, {"tags": ["mongodb", "go"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 3559801, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7b8996e43ec87f7e1fab8d548c7d2a58?s=128&d=identicon&r=PG&f=1", "display_name": "Mert Serin", "link": "https://stackoverflow.com/users/3559801/mert-serin"}, "edited": false, "score": 0, "creation_date": 1490735267, "post_id": 43077732, "comment_id": 73243120, "body": "hello there, thank you for your answer but I was looking something different, when I retrieve job from database instead of creator parent&#39;s ID, I want to get creatorParent&#39;s detail like you listed below. Like left join on SQL"}, {"owner": {"reputation": 273, "user_id": 3559801, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7b8996e43ec87f7e1fab8d548c7d2a58?s=128&d=identicon&r=PG&f=1", "display_name": "Mert Serin", "link": "https://stackoverflow.com/users/3559801/mert-serin"}, "edited": false, "score": 0, "creation_date": 1490748877, "post_id": 43077732, "comment_id": 73247681, "body": "I&#39;ve tried your code but I couldn&#39;t retrieve child detail"}, {"owner": {"reputation": 273, "user_id": 3559801, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7b8996e43ec87f7e1fab8d548c7d2a58?s=128&d=identicon&r=PG&f=1", "display_name": "Mert Serin", "link": "https://stackoverflow.com/users/3559801/mert-serin"}, "edited": false, "score": 0, "creation_date": 1490776857, "post_id": 43077732, "comment_id": 73258680, "body": "children field still returns empty array :("}, {"owner": {"reputation": 2379, "user_id": 7717350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f87f414396f1dcb7d786387ceb8673?s=128&d=identicon&r=PG&f=1", "display_name": "mgyongyosi", "link": "https://stackoverflow.com/users/7717350/mgyongyosi"}, "reply_to_user": {"reputation": 273, "user_id": 3559801, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7b8996e43ec87f7e1fab8d548c7d2a58?s=128&d=identicon&r=PG&f=1", "display_name": "Mert Serin", "link": "https://stackoverflow.com/users/3559801/mert-serin"}, "edited": false, "score": 0, "creation_date": 1490861689, "post_id": 43077732, "comment_id": 73304244, "body": "I replied in the other thread: <a href=\"http://stackoverflow.com/questions/43082266/mongodb-aggregation-retrieving-document-from-inside-of-document/43112085#43112085\" title=\"mongodb aggregation retrieving document from inside of document\">stackoverflow.com/questions/43082266/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2379, "user_id": 7717350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f87f414396f1dcb7d786387ceb8673?s=128&d=identicon&r=PG&f=1", "display_name": "mgyongyosi", "link": "https://stackoverflow.com/users/7717350/mgyongyosi"}, "is_accepted": false, "score": 0, "last_activity_date": 1490772938, "last_edit_date": 1490772938, "creation_date": 1490727459, "answer_id": 43077732, "question_id": 43074187, "link": "https://stackoverflow.com/questions/43074187/lookup-and-match-mongodb-golang/43077732#43077732", "title": "$lookup and $match Mongodb golang", "body": "<p>If I understood it correctly. A similar solution is achievable using MongoDB 3.4's $addFields and $lookup aggregation steps.</p>\n\n<p>Mongo aggregation:</p>\n\n<pre><code>[\n    {\n        $addFields: { \n            \"job\":\"$$ROOT\"\n        }\n    },\n    {\n        $unwind: {\n            path : \"$children\"\n        }\n    },\n    {\n        $lookup: {\n            \"from\" : \"users\",\n            \"localField\" : \"creatorParent\",\n            \"foreignField\" : \"_id\",\n            \"as\" : \"creatorParent\"\n        }\n    },\n    {\n        $lookup: {\n            \"from\" : \"users\",\n            \"localField\" : \"children\",\n            \"foreignField\" : \"_id\",\n            \"as\" : \"children\"\n        }\n    },\n    {\n        $group: {\n            \"_id\": \"$_id\",\n            \"job\": { \"$first\": \"$job\" },\n            \"creatorParent\" : { \"$first\" : \"$creatorParent\" },\n            \"children\": { \"$addToSet\": {  $arrayElemAt: [ \"$children\", 0 ]  } }\n        }\n    }\n]\n</code></pre>\n\n<p>The output will look like the following:</p>\n\n<pre><code>{ \"_id\" : ObjectId(\"58da9cb6340c630315348114\"), \n\"job\" : {\n    \"_id\" : ObjectId(\"58da9cb6340c630315348114\"), \n    \"name\" : \"Developer\", \n    \"creatorParent\" : ObjectId(\"58da9c79340c630315348113\"), \n    \"children\" : [\n        ObjectId(\"58da9c6d340c630315348112\"), \n        ObjectId(\"58da9c5f340c630315348111\")\n    ], \n    \"hourly_rate\" : 12.0, \n    \"additional_information\" : \"other infos\"\n}, \n\"creatorParent\" : [\n    {\n        \"_id\" : ObjectId(\"58da9c79340c630315348113\"), \n        \"name\" : \"The Boss\", \n        \"age\" : 40.0\n    }\n], \n\"children\" : [\n    {\n        \"_id\" : ObjectId(\"58da9c5f340c630315348111\"), \n        \"name\" : \"James\", \n        \"age\" : 28.0\n    }, \n    {\n        \"_id\" : ObjectId(\"58da9c6d340c630315348112\"), \n        \"name\" : \"Andrew\", \n        \"age\" : 26.0\n    }\n]}\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>If you substitute the last <code>$group</code> stage with this:</p>\n\n<pre><code>{\n    \"_id\": \"$_id\",\n    \"name\": { \"$first\": \"$name\" },\n    \"jobstatus\": { \"$first\": \"$jobstatus\" },\n    \"hourlyrate\": { \"$first\":\"$hourlyrate\" },\n    \"creatorparent\" : { \"$first\" : \"$creatorparent\" },\n    \"children\": { \"$addToSet\": {  $arrayElemAt: [ \"$children\", 0 ]  } }\n}\n</code></pre>\n\n<p>Then you can achieve what you would like to, but in this <code>$group</code> stage you have to specify every field of job one-by-one with the <code>$first</code> expression.</p>\n"}], "owner": {"reputation": 273, "user_id": 3559801, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7b8996e43ec87f7e1fab8d548c7d2a58?s=128&d=identicon&r=PG&f=1", "display_name": "Mert Serin", "link": "https://stackoverflow.com/users/3559801/mert-serin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 845, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490784526, "creation_date": 1490716148, "last_edit_date": 1490784526, "question_id": 43074187, "link": "https://stackoverflow.com/questions/43074187/lookup-and-match-mongodb-golang", "title": "$lookup and $match Mongodb golang", "body": "<p>I want to get document with foreign key by using $lookup and $match on MongoDB.</p>\n\n<p>There is a \"Jobs\" collection which stores Job document. In Job document there are two field using as foreing key \"creatorParent\" and \"Children\".\nCreatorParent is a foreign key for \"Users\" collection and Children array contains id for user's children.</p>\n\n<p>When I list the whole jobs, I want to retrieve detail from \"Users\" collection for both CreatorParent ID and ChildrenID. I want to marshall \"Job\" document with ParentDetail and ChildDetail. I don't want to write a custom method for that. Is it possible to handle it with MongoDB query?</p>\n\n<p><strong>By the way I'm beginner on MongoDB so should store needed details on Children and CreatorParent instead of storing ObjectId?</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/FMh99.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FMh99.png\" alt=\"Jobs Collection\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Rle13.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rle13.png\" alt=\"Users Collection\"></a></p>\n\n<p>Users document:</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"58daf84877733645eaa9b44f\"),\n    \"email\" : \"meto93@gmail.com\",\n    \"password\" : \"vpGl+Fjnef616cRgNbCkwaFDpSI=\",\n    \"passwordsalt\" : \"99397F4A9D3A499D96694547667E74595CE994D2E83345D6953EF866303E8B65\",\n    \"children\" : [ \n        {\n            \"_id\" : ObjectId(\"58daf84977733645eaa9b450\"),\n            \"name\" : \"Mert\",\n            \"age\" : 5,\n            \"additionalinformation\" : \"ilk cocuk\",\n            \"creationtime\" : ISODate(\"2017-03-28T23:56:56.952Z\"),\n            \"userid\" : ObjectId(\"58daf84877733645eaa9b44f\"),\n            \"gender\" : null\n        }, \n        {\n            \"_id\" : ObjectId(\"58daf84977733645eaa9b451\"),\n            \"name\" : \"Sencer\",\n            \"age\" : 7,\n            \"additionalinformation\" : \"ikinci cocuk\",\n            \"creationtime\" : ISODate(\"2017-03-28T23:56:56.952Z\"),\n            \"userid\" : ObjectId(\"58daf84877733645eaa9b44f\"),\n            \"gender\" : null\n        }\n    ]\n}\n</code></pre>\n\n<p>Job</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"58db0a2d77733645eaa9b453\"),\n    \"creationtime\" : ISODate(\"2017-03-29T01:13:17.509Z\"),\n    \"startingtime\" : ISODate(\"2017-04-03T13:00:00.000Z\"),\n    \"endingtime\" : ISODate(\"2017-04-03T17:00:00.000Z\"),\n    \"children\" : [ \n        ObjectId(\"58daf84977733645eaa9b450\"), \n        ObjectId(\"58daf84977733645eaa9b451\")\n    ],\n    \"creatorparent\" : ObjectId(\"58daf84877733645eaa9b44f\"),\n    \"applicants\" : []\n}\n</code></pre>\n"}, {"tags": ["go", "binary-search"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 1, "creation_date": 1490715878, "post_id": 43073681, "comment_id": 73231670, "body": "Why not to search something? <a href=\"https://github.com/ZachOrr/golang-algorithms/blob/master/searching/binary-search.go\" rel=\"nofollow noreferrer\">github.com/ZachOrr/golang-algorithms/blob/master/searching/&hellip;</a>"}, {"owner": {"reputation": 1641, "user_id": 1519937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XDdSU.jpg?s=128&g=1", "display_name": "Dovydas Bartkevi\u010dius", "link": "https://stackoverflow.com/users/1519937/dovydas-bartkevi%c4%8dius"}, "edited": false, "score": 1, "creation_date": 1490716436, "post_id": 43073681, "comment_id": 73232080, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/32664475/go-recursive-binary-search\">Go recursive binary search</a>"}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 6757551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6f817b964323633a387c6ee603915bbe?s=128&d=identicon&r=PG&f=1", "display_name": "as.beaulieu", "link": "https://stackoverflow.com/users/6757551/as-beaulieu"}, "edited": false, "score": 0, "creation_date": 1490718493, "post_id": 43074629, "comment_id": 73233472, "body": "I appreciate the explanation for the errors. Things I know now. Now can anyone explain why the colon (:) in the method call during the switch allows the value to be passed through?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 404, "user_id": 6757551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6f817b964323633a387c6ee603915bbe?s=128&d=identicon&r=PG&f=1", "display_name": "as.beaulieu", "link": "https://stackoverflow.com/users/6757551/as-beaulieu"}, "edited": false, "score": 1, "creation_date": 1490718941, "post_id": 43074629, "comment_id": 73233775, "body": "Hmm, ya, running it again, I neglected to add the mid to the result.  Corrected version: <a href=\"https://play.golang.org/p/4zLgX-_0ZS\" rel=\"nofollow noreferrer\">play.golang.org/p/4zLgX-_0ZS</a>"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 404, "user_id": 6757551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6f817b964323633a387c6ee603915bbe?s=128&d=identicon&r=PG&f=1", "display_name": "as.beaulieu", "link": "https://stackoverflow.com/users/6757551/as-beaulieu"}, "edited": false, "score": 1, "creation_date": 1490719127, "post_id": 43074629, "comment_id": 73233894, "body": "As for the colon, that&#39;s called sub-slicing.  The expression <code>s[a:]</code> means the the slice <code>s</code> from index <code>a</code> onward, while the expression <code>s[:a]</code> means the slice <code>s</code> up until (but not including) index <code>a</code>.  For example, if you have <code>s = int{0, 1, 2, 3}</code>, then the expression <code>s[2:]</code> would give you <code>{2, 3}</code>, while the expression <code>s[:2]</code> would give you <code>{0, 1}</code>.  You can also do ranges.  Example, <code>s[1:3]</code> would give you <code>{1, 2}</code>."}, {"owner": {"reputation": 404, "user_id": 6757551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6f817b964323633a387c6ee603915bbe?s=128&d=identicon&r=PG&f=1", "display_name": "as.beaulieu", "link": "https://stackoverflow.com/users/6757551/as-beaulieu"}, "edited": false, "score": 0, "creation_date": 1490719190, "post_id": 43074629, "comment_id": 73233932, "body": "Yes, that new version works. And the colon in the method call explanation is awesome. Thank you!"}, {"owner": {"reputation": 3934, "user_id": 916440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3f3495133a7d9411b0b4c04189ecf91?s=128&d=identicon&r=PG", "display_name": "Kamil Dziedzic", "link": "https://stackoverflow.com/users/916440/kamil-dziedzic"}, "edited": false, "score": 0, "creation_date": 1587722943, "post_id": 43074629, "comment_id": 108627387, "body": "This algorithm is invalid. In your data set check for example for 3, it will return 0 instead of -1. For values larger than last element in data set it also returns wrong value instead of -1."}, {"owner": {"reputation": 3934, "user_id": 916440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3f3495133a7d9411b0b4c04189ecf91?s=128&d=identicon&r=PG", "display_name": "Kamil Dziedzic", "link": "https://stackoverflow.com/users/916440/kamil-dziedzic"}, "edited": false, "score": 0, "creation_date": 1587723127, "post_id": 43074629, "comment_id": 108627465, "body": "The problem is that for <code>case a[mid] &lt; search:</code> you should first check if result is not -1 and only then add +mid+1"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 3934, "user_id": 916440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3f3495133a7d9411b0b4c04189ecf91?s=128&d=identicon&r=PG", "display_name": "Kamil Dziedzic", "link": "https://stackoverflow.com/users/916440/kamil-dziedzic"}, "edited": false, "score": 1, "creation_date": 1589574716, "post_id": 43074629, "comment_id": 109358853, "body": "Good catch, @KamilDziedzic.  Post updated with correction."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 8, "last_activity_date": 1589574709, "last_edit_date": 1589574709, "creation_date": 1490717395, "answer_id": 43074629, "question_id": 43073681, "link": "https://stackoverflow.com/questions/43073681/golang-binary-search/43074629#43074629", "title": "Golang Binary search", "body": "<p>You're not doing a binary search properly.  First off, your <code>for</code> loop is useless, since each branch in the conditional tree has a return statement in it, so it can never run more than one iteration.  It looks like you started to code it iteratively, then swapped to a recursive setup, but only kinda halfway converted it.</p>\n\n<p>The idea of a binary search is that you have a high and low index and search the midway point between them.  You're not doing that, you're just incrementing the <code>field</code> variable and trying again (which will cause you to search each index twice until you find the item or segfault by running past the end of the list).  In Go, though, you don't need to keep track of the high and low indexes, as you can simply subslice the search field as appropriate.</p>\n\n<p>Here's a more elegant recursive version:</p>\n\n<pre><code>func binarySearch(a []int, search int) (result int, searchCount int) {\n    mid := len(a) / 2\n    switch {\n    case len(a) == 0:\n        result = -1 // not found\n    case a[mid] &gt; search:\n        result, searchCount = binarySearch(a[:mid], search)\n    case a[mid] &lt; search:\n        result, searchCount = binarySearch(a[mid+1:], search)\n        if result &gt;= 0 { // if anything but the -1 \"not found\" result\n            result += mid + 1\n        }\n    default: // a[mid] == search\n        result = mid // found\n    }\n    searchCount++\n    return\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/4zLgX-_0ZS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/4zLgX-_0ZS</a></p>\n"}, {"tags": [], "owner": {"reputation": 3547, "user_id": 4359349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1552115417/picture?type=large", "display_name": "Michael Horojanski", "link": "https://stackoverflow.com/users/4359349/michael-horojanski"}, "is_accepted": false, "score": 2, "last_activity_date": 1575527385, "last_edit_date": 1575527385, "creation_date": 1575522062, "answer_id": 59188523, "question_id": 43073681, "link": "https://stackoverflow.com/questions/43073681/golang-binary-search/59188523#59188523", "title": "Golang Binary search", "body": "<pre><code>func BinarySearch(array []int, target int) int {\n  startIndex := 0\n  endIndex := len(array) - 1\n  midIndex := len(array) / 2\n  for startIndex &lt;= endIndex {\n\n    value := array[midIndex]\n\n    if value == target {\n        return midIndex\n    }\n\n    if value &gt; target {\n        endIndex = midIndex - 1\n        midIndex = (startIndex + endIndex) / 2\n        continue\n    }\n\n    startIndex = midIndex + 1\n    midIndex = (startIndex + endIndex) / 2\n}\n\n  return -1\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 552, "user_id": 6598265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s8atj.jpg?s=128&g=1", "display_name": "blues911", "link": "https://stackoverflow.com/users/6598265/blues911"}, "is_accepted": false, "score": 0, "last_activity_date": 1600595015, "creation_date": 1600595015, "answer_id": 63977554, "question_id": 43073681, "link": "https://stackoverflow.com/questions/43073681/golang-binary-search/63977554#63977554", "title": "Golang Binary search", "body": "<pre><code>func BinarySearch(a []int, x int) int {\n    r := -1 // not found\n    start := 0\n    end := len(a) - 1\n    for start &lt;= end {\n        mid := (start + end) / 2;\n        if a[mid] == x {\n            r = mid // found\n            break\n        } else if a[mid] &lt; x {\n            start = mid + 1\n        } else if a[mid] &gt; x {\n            end = mid - 1\n        }\n    }\n    return r\n}\n</code></pre>\n"}], "owner": {"reputation": 404, "user_id": 6757551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6f817b964323633a387c6ee603915bbe?s=128&d=identicon&r=PG&f=1", "display_name": "as.beaulieu", "link": "https://stackoverflow.com/users/6757551/as-beaulieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5501, "favorite_count": 1, "accepted_answer_id": 43074629, "answer_count": 3, "score": 2, "last_activity_date": 1600595015, "creation_date": 1490714821, "question_id": 43073681, "link": "https://stackoverflow.com/questions/43073681/golang-binary-search", "title": "Golang Binary search", "body": "<p>I'm practicing an interview algorithm, now coding it in Go. The purpose is to practice basic interview algorithms, and my skills in Go. I'm trying to perform a Binary search of an array of numbers.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    searchField := []int{2, 5, 8, 12, 16, 23, 38, 56, 72, 91}\n    searchNumber := 23\n\n    fmt.Println(\"Running Program\")\n    fmt.Println(\"Searching list of numbers: \", searchField)\n    fmt.Println(\"Searching for number: \", searchNumber)\n\n    numFound := false\n    //searchCount not working. Belongs in second returned field\n    result, _ := binarySearch2(searchField, len(searchField), searchNumber, numFound)\n    fmt.Println(\"Found! Your number is found in position: \", result)\n    //fmt.Println(\"Your search required \", searchCount, \" cycles with the Binary method.\")\n}\n\nfunc binarySearch2(a []int, field int, search int, numFound bool) (result int, searchCount int) {\n    //searchCount removed for now.\n    searchCount, i := 0, 0\n    for !numFound {\n        searchCount++\n        mid := i + (field-i)/2\n        if search == a[mid] {\n            numFound = true\n            result = mid\n            return result, searchCount\n        } else if search &gt; a[mid] {\n            field++\n            //i = mid + 1 causes a stack overflow\n            return binarySearch2(a, field, search, numFound)\n        }\n        field = mid\n        return binarySearch2(a, field, search, numFound)\n    }\n    return result, searchCount\n}\n</code></pre>\n\n<p>The main problems I'm coming across are: </p>\n\n<p>1) When the number is higher in the list than my mid search, am I truly continuing a binary search, or has it turned to a sequential? How can I fix that? The other option I've placed has been commented out because it causes a stack overflow.</p>\n\n<p>2) I wanted to add a step count to see how many steps it takes to finish the search. Something to use with other search methods as well. If I print out the search count as is, it always reads one. Is that because I need to return it (and therefore call for it in the header) in the method?</p>\n\n<p>I understand Go has methods that streamline this process. I'm trying to increase my knowledge and coding skills. I appreciate your input.</p>\n"}, {"tags": ["macos", "go", "xcode8"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490715307, "post_id": 43073636, "comment_id": 73231219, "body": "Can you determine which of those packages is specifically causing the issue? I would wager that <code>github.com&#47;shirou&#47;gopsutil&#47;host</code> is doing something unsupported"}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1490715916, "post_id": 43073636, "comment_id": 73231694, "body": "Please share a code that produces an error."}, {"owner": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "edited": false, "score": 1, "creation_date": 1490722619, "post_id": 43073636, "comment_id": 73235916, "body": "Of the two dependencies you mentioned, only <code>gopsutil</code> explicitly uses <a href=\"https://github.com/shirou/gopsutil/tree/d371ba1293cb48fedc6850526ea48b3846c54f2c/process\" rel=\"nofollow noreferrer\">methods that send signals</a>. Probably safe to start focusing on that library first."}, {"owner": {"reputation": 58, "user_id": 4202365, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/be85568ddc7c7745b083bc5db601124d?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/4202365/chris"}, "edited": false, "score": 0, "creation_date": 1490725607, "post_id": 43073636, "comment_id": 73237635, "body": "Yes, actually method Pids() in the process_darwin.go causes the problem. Unfortunately, even if I avoid using gopsutil dependency, i still got the problem with go-sqlcipher"}, {"owner": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "edited": false, "score": 0, "creation_date": 1490741648, "post_id": 43073636, "comment_id": 73245743, "body": "Ok, looks like <code>Pids()</code> really just ends up calling the bash command <code>ps -ax -o pid</code>. I think i need to see the traceback of this error and what you saw with <code>sqlcipher</code> to be any more help."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490756242, "post_id": 43073636, "comment_id": 73249630, "body": "See <a href=\"https://github.com/golang/go/issues/19734\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/19734</a>"}], "answers": [{"comments": [{"owner": {"reputation": 58, "user_id": 4202365, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/be85568ddc7c7745b083bc5db601124d?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/4202365/chris"}, "edited": false, "score": 0, "creation_date": 1490770163, "post_id": 43081442, "comment_id": 73254599, "body": "You are right! Actually, i downloaded previous version of the XCode and input command:  <code>sudo xcode-select -s &#47;Applications&#47;Xcode_821.app&#47;Contents&#47;Developer</code>. Now everything works fine."}], "tags": [], "owner": {"reputation": 36, "user_id": 7782731, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/cead0bef1fed249b63cd5c577c605b7d?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/7782731/steve"}, "is_accepted": true, "score": 2, "last_activity_date": 1490742233, "creation_date": 1490742233, "answer_id": 43081442, "question_id": 43073636, "link": "https://stackoverflow.com/questions/43073636/cannot-start-go-server-on-localhost/43081442#43081442", "title": "Cannot start Go server on localhost", "body": "<p>There seems to be some issue with the Sierra command line tools that were released today as part of xcode 8.3. Totally hosed my go project with immediate Killed: 9 upon running it. I had to revert back to command line tools from 8.2</p>\n"}], "owner": {"reputation": 58, "user_id": 4202365, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/be85568ddc7c7745b083bc5db601124d?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/4202365/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 43081442, "answer_count": 1, "score": 1, "last_activity_date": 1490870103, "creation_date": 1490714710, "last_edit_date": 1490870103, "question_id": 43073636, "link": "https://stackoverflow.com/questions/43073636/cannot-start-go-server-on-localhost", "title": "Cannot start Go server on localhost", "body": "<p>Today, i encountered a very strange problem concerning a local server in Go on MAC OS X 10.12.2. Suddenly, after a successful build, i cannot start my application. Every time i get a \"Killed 9\" message.</p>\n\n<p>This problem could be caused by two dependencies:</p>\n\n<ol>\n<li><code>github.com/xeodou/go-sqlcipher</code></li>\n<li><code>github.com/shirou/gopsutil/host</code></li>\n</ol>\n\n<p>Without them the application can start, but I need them.</p>\n\n<p>I  have been using those two dependencies for two months and I haven't had any problems with them. The problem happened suddenly after a successful build. I cloned the whole repository into two environments with Mac OS X 10.12.2 and Windows 8 and I didn't get any problems. The applications started on both machines.</p>\n\n<p>Probably due to constant application checks and dozens of local servers created, MAC OS blocks some processes, but I couldn't find out where the problem is.</p>\n"}, {"tags": ["pointers", "go", "reflection", "struct"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1490718304, "last_edit_date": 1490718304, "creation_date": 1490711871, "answer_id": 43072507, "question_id": 43072451, "link": "https://stackoverflow.com/questions/43072451/reflect-new-returns-nil-instead-of-initialized-struct/43072507#43072507", "title": "reflect.New returns &lt;nil&gt; instead of initialized struct", "body": "<p>You used the builtin <a href=\"https://golang.org/pkg/builtin/#new\" rel=\"nofollow noreferrer\"><code>new()</code></a> function when you created your <code>real</code> variable, which returns a pointer! Type of <code>real</code> is <code>*A</code>, not <code>A</code>! This is the source of the confusion.</p>\n\n<p><a href=\"https://golang.org/pkg/reflect/#New\" rel=\"nofollow noreferrer\"><code>reflect.New()</code></a> returns a pointer to the (zeroed) value of the given type (wrapped in a <a href=\"https://golang.org/pkg/reflect#Value\" rel=\"nofollow noreferrer\"><code>reflect.Value</code></a>). If you pass the type <code>A</code>, you get back a wrapped <code>*A</code>, <code>A</code> initialized / zeroed. If you pass the type <code>*A</code>, you get back a wrapped <code>**A</code>, <code>*A</code> initialized (zeroed), and the zero value for any pointer type is <code>nil</code>.</p>\n\n<p>You basically ask <code>reflect.New()</code> to create a new value of a pointer type (<code>*A</code>), and \u2013as mentioned\u2013 its zero value is <code>nil</code>.</p>\n\n<p>You have to pass the type <code>A</code> (and not the type <code>*A</code>). It works like this (try it on the <a href=\"https://play.golang.org/p/cB5GNPnXNW\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>real := new(A)\nreflected := reflect.New(reflect.TypeOf(real).Elem()).Elem().Interface()\nfmt.Println(real)\nfmt.Println(reflected)\n</code></pre>\n\n<p>Or like this (<a href=\"https://play.golang.org/p/m3e0TnICbo\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>real := A{}\nreflected := reflect.New(reflect.TypeOf(real)).Elem().Interface()\nfmt.Println(real)\nfmt.Println(reflected)\n</code></pre>\n"}], "owner": {"reputation": 2005, "user_id": 1871890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4359cdd9f14bbbe17c56f2fb2d2de25d?s=128&d=identicon&r=PG", "display_name": "Mathieu Nls", "link": "https://stackoverflow.com/users/1871890/mathieu-nls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 1, "accepted_answer_id": 43072507, "answer_count": 1, "score": 2, "last_activity_date": 1490718304, "creation_date": 1490711748, "last_edit_date": 1490712390, "question_id": 43072451, "link": "https://stackoverflow.com/questions/43072451/reflect-new-returns-nil-instead-of-initialized-struct", "title": "reflect.New returns &lt;nil&gt; instead of initialized struct", "body": "<p>I am using reflection for a library I'm building but there's something I don't understand about <code>reflect.New</code>.</p>\n\n<pre><code>type A struct {\n    A int\n    B string\n}\n\nfunc main() {\n\n    real := new(A)\n    reflected := reflect.New(reflect.TypeOf(real)).Elem().Interface()\n    fmt.Println(real)\n    fmt.Println(reflected)\n}\n</code></pre>\n\n<p>Gives:</p>\n\n<pre><code>$ go run *go\n&amp;{0 }\n&lt;nil&gt;\n</code></pre>\n\n<p>Isn't <code>reflect.New</code> supposed to return <code>&amp;{0 }</code> too? (<a href=\"https://play.golang.org/p/6sHPbEoY9m\" rel=\"nofollow noreferrer\">Runnable Version</a>)</p>\n\n<p>Ultimately, I wish to be able to iterate over the fields of the reflected struct (<code>reflected.NumField()</code> gives <code>reflected.NumField undefined (type interface {} is interface with no methods)</code>) and use <code>SetInt</code>, <code>SetString</code> and so on.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["string", "pointers", "go", "methods", "stack-overflow"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1490773860, "last_edit_date": 1495535459, "creation_date": 1490693903, "answer_id": 43065979, "question_id": 43065856, "link": "https://stackoverflow.com/questions/43065856/the-difference-between-t-and-t/43065979#43065979", "title": "The difference between t and *t", "body": "<p>Because the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code></a> package checks if the value being printed has a <code>String() string</code> method (or in other words: if it implements the <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow noreferrer\"><code>fmt.Stringer</code></a> interface), and if so, it will be called to get the <code>string</code> representation of the value.</p>\n\n<p>This is documented in the <code>fmt</code> package doc:</p>\n\n<blockquote>\n  <p>[...] If an operand implements method String() string, that method will be invoked to convert the object to a string, which will then be formatted as required by the verb (if any).</p>\n</blockquote>\n\n<p>Here:</p>\n\n<pre><code>return fmt.Sprintf(\"%+v\", *t)\n</code></pre>\n\n<p>You are passing a value <code>*t</code> of type <code>TT</code> to the <code>fmt</code> package. If the <code>TT.String()</code> method has a pointer receiver, then the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a> of the type <code>TT</code> <strong>does not include</strong> the <code>String()</code> method, so the <code>fmt</code> package will not call it (only the method set of <code>*TT</code> includes it).</p>\n\n<p>If you change the receiver to non-pointer type, then the method set of the type <code>TT</code> <strong>will include</strong> the <code>String()</code> method, so the <code>fmt</code> package will call that, but this is the method we're currently in, so that's an endless \"indirect recursion\".</p>\n\n<h3>Prevention / protection</h3>\n\n<p>If for some reason you do need to use the same receiver type as the type of the value you pass to the <code>fmt</code> package, an easy and common way to avoid this / protect from it is to create a new type with the <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow noreferrer\"><code>type</code></a> keyword, and use type <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">conversion</a> on the value being passed:</p>\n\n<pre><code>func (t TT) String() string {\n    type TT2 TT\n    return fmt.Sprintf(\"%+v\", TT2(t))\n}\n</code></pre>\n\n<p>Try this on the <a href=\"https://play.golang.org/p/C0hs9WroVt\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>But why does this work? Because the <code>type</code> keyword creates a new type, and the new type will have <strong>zero</strong> methods (it does not \"inherit\" the methods of the underlying type).</p>\n\n<p>Does this incur some run-time overhead? No. Quoting from <a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"nofollow noreferrer\">Spec: Type declarations</a>:</p>\n\n<blockquote>\n  <p>Specific rules apply to (non-constant) conversions between numeric types or to and from a string type. These conversions may change the representation of <code>x</code> and incur a run-time cost. <strong>All other conversions only change the type but not the representation of <code>x</code>.</strong></p>\n</blockquote>\n\n<p>Read more about this here: <a href=\"https://stackoverflow.com/questions/32253768/does-convertion-between-alias-types-in-go-create-copies/32253871#32253871\">Does convertion between alias types in Go create copies?</a></p>\n"}], "owner": {"reputation": 69, "user_id": 5867825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7b179968d54f7969578c9fb50b83cd3c?s=128&d=identicon&r=PG&f=1", "display_name": "\u5e38\u6653\u9f99", "link": "https://stackoverflow.com/users/5867825/%e5%b8%b8%e6%99%93%e9%be%99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 43065979, "answer_count": 1, "score": 1, "last_activity_date": 1490773860, "creation_date": 1490693589, "last_edit_date": 1490703907, "question_id": 43065856, "link": "https://stackoverflow.com/questions/43065856/the-difference-between-t-and-t", "title": "The difference between t and *t", "body": "<pre><code>package main\n\nimport \"fmt\"\n\ntype TT struct {\n    a int\n    b float32\n    c string\n}\n\nfunc (t *TT) String() string {\n    return fmt.Sprintf(\"%+v\", *t)\n}\n\nfunc main() {\n    tt := &amp;TT{3, 4, \"5\"}\n    fmt.Printf(tt.String())\n}\n</code></pre>\n\n<p>The code can work well. But if I change the <code>String</code> method as in the following, it will cause dead loop. The difference is that the <code>*t</code> is replaced with <code>t</code>. Why?</p>\n\n<pre><code>func (t *TT) String() string {\n    return fmt.Sprintf(\"%+v\", t)\n}\n</code></pre>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1490688919, "post_id": 43063444, "comment_id": 73212070, "body": "You pass a pointer to the same structure into multiple workers, and access to the structure is not syncrhonised. So after you have passed a pointer and between data was extracted from it you may have cleared the <code>.data</code> property and started filling it with new data."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1490689020, "post_id": 43063444, "comment_id": 73212133, "body": "If you move the <code>var d Data</code> declaration into the loop body it should work as expected. Alternatively you can use <code>chan Data</code> channel type, in that case the <code>Data</code> structure would copy every time implicitly."}, {"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1490690807, "post_id": 43063444, "comment_id": 73213298, "body": "@zerkms Thank you so much for your comments and support. I could understand the reason of this problem. I found that there are several methods for solving. I really appreciate. At this time, I would like to solve this by including <code>var d Data</code> in loop. By the way, this was solved. What should I do for this?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490692940, "post_id": 43063444, "comment_id": 73214750, "body": "I have posted slightly extended version as an answer, now you may check it using the green checkmark button on the left. And welcome to the stackoverflow :-)"}], "answers": [{"comments": [{"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "edited": false, "score": 0, "creation_date": 1490740376, "post_id": 43065581, "comment_id": 73245350, "body": "Thank you very much for your advices. I pushed the checkmark now. I wanted to push a vote of useful. But it wasn&#39;t reflected. It seems that I cannot use it yet. I&#39;m sorry."}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 0, "last_activity_date": 1490692861, "creation_date": 1490692861, "answer_id": 43065581, "question_id": 43063444, "link": "https://stackoverflow.com/questions/43063444/lack-of-data-using-golang-channel/43065581#43065581", "title": "Lack of data using golang channel", "body": "<p>What you observe is an example of \"data race\".</p>\n\n<p>It happens when you concurrently access the same piece of data (with at least one of those being a write).</p>\n\n<p>You put a reference to the same structure every time. And what may happen next is one of few possibilities:</p>\n\n<ol>\n<li><p>it was read on the other side of the channel before you mutated it (the \"expected\" scenario)</p></li>\n<li><p>you started mutating it before it was read. In this case the receiver may read any number of <code>Data.data</code> items, from 0 to 1000, depending on when exactly the read happened.</p></li>\n</ol>\n\n<p>There are multiple solutions for the problem:</p>\n\n<ol>\n<li><p>You may create the new instance of <code>Data</code> every iteration. For that simply move the <code>var d Data</code> declaration inside the loop body. In this case every iteration a new structure is created, so you may not mutate the previous one by mistake.</p></li>\n<li><p>You may declare channel of <code>Data</code> (the structures, not pointers to a structure): <code>chan Data</code>. In this case the <code>Data</code> instance is implicitly copied every time you send it to the channel (since everything in Go is passed by value, copied on assignment).</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1559653706, "post_id": 56443559, "comment_id": 99482610, "body": "Thank you for this code snippet, which might provide some limited short-term help.  A proper explanation <a href=\"//meta.stackexchange.com/q/114762\">would greatly improve</a> its long-term value by showing <i>why</i> this is a good solution to the problem, and would make it more useful to future readers with other, similar questions.  Please <a href=\"https://stackoverflow.com/posts/56443559/edit\">edit</a> your answer to add some explanation, including the assumptions you&#39;ve made."}], "tags": [], "owner": {"reputation": 11, "user_id": 3319093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SZ3N0.jpg?s=128&g=1", "display_name": "ambitioner", "link": "https://stackoverflow.com/users/3319093/ambitioner"}, "is_accepted": false, "score": 0, "last_activity_date": 1559649989, "creation_date": 1559649989, "answer_id": 56443559, "question_id": 43063444, "link": "https://stackoverflow.com/questions/43063444/lack-of-data-using-golang-channel/56443559#56443559", "title": "Lack of data using golang channel", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\n/*\n    \u4fe1\u53f7\u91cf\u7684\u8003\u5bdf\uff0cput \u4e4b\u540e\uff0c\u5fc5\u987b\u7b49\u5f85 get \u62ff\u5230\u4e4b\u540e\u624d\u80fd\u63a8\u51fa\u5faa\u73af\n*/\n\ntype Data struct {\n    data []int\n}\n\nfunc main() {\n    ws := 5\n    ch := make(chan *Data, ws)\n\n    sem := make(chan bool)\n\n    var wg sync.WaitGroup\n\n    for i := 0; i &lt; ws; i++ {\n        wg.Add(1)\n\n        go func(wg *sync.WaitGroup, ch chan *Data) {\n            defer wg.Done()\n\n            for {\n                char, ok := &lt;-ch\n                if !ok {\n                    return\n                }\n                fmt.Printf(\"Get: %d\\n\", len(char.data))\n                sem &lt;- true\n            }\n        }(&amp;wg, ch)\n    }\n\n    var d Data\n    ar := []int{1}\n\n    // ws = 5\n    for i := 0; i &lt; ws; i++ {\n        d.data = []int{}\n\n        for j := 0; j &lt; 1000; j++ {\n            d.data = append(d.data, ar[0])\n        }\n\n        ch &lt;- &amp;d\n\n        fmt.Printf(\"Put: %d\\n\", len(d.data))\n\n        &lt;-sem // \u4e00\u4e2a\u4fe1\u53f7\u91cf\uff0c\u5fc5\u987b\u7b49\u5f85 get \u5b8c\u6210\u4e4b\u540e\u624d\u80fd\u7ee7\u7eedput\n    }\n    close(ch)\n\n    wg.Wait()\n}\n\n</code></pre>\n"}], "owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 43065581, "answer_count": 2, "score": 2, "last_activity_date": 1559649989, "creation_date": 1490686832, "question_id": 43063444, "link": "https://stackoverflow.com/questions/43063444/lack-of-data-using-golang-channel", "title": "Lack of data using golang channel", "body": "<p>I encountered a strange problem. The script is below.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\ntype Data struct {\n    data []int\n}\n\nfunc main() {\n    ws := 5\n    ch := make(chan *Data, ws)\n    var wg sync.WaitGroup\n    for i := 0; i &lt; ws; i++ {\n        wg.Add(1)\n        go func(wg *sync.WaitGroup, ch chan *Data) {\n            defer wg.Done()\n            for {\n                char, ok := &lt;-ch\n                if !ok {\n                    return\n                }\n                fmt.Printf(\"Get: %d\\n\", len(char.data))\n            }\n        }(&amp;wg, ch)\n    }\n    var d Data\n    ar := []int{1}\n    for i := 0; i &lt; ws; i++ {\n        d.data = []int{}\n        for j := 0; j &lt; 1000; j++ {\n            d.data = append(d.data, ar[0])\n        }\n        ch &lt;- &amp;d\n        // time.Sleep(time.Second / 1000) // When this line is moved, a number of data by put and get becomes same.\n        fmt.Printf(\"Put: %d\\n\", len(d.data))\n    }\n    close(ch)\n    wg.Wait()\n}\n</code></pre>\n\n<p>This is run, a following result is expected. The number of data for \"Put\" and \"Get\" is same.</p>\n\n<pre><code>Put: 1000\nGet: 1000\nPut: 1000\nGet: 1000\nPut: 1000\nGet: 1000\nPut: 1000\nGet: 1000\nPut: 1000\nGet: 1000\n</code></pre>\n\n<p>But, this result cannot be got every time. The results are below. The number of data of \"Put\" and \"Get\" is different for every time.</p>\n\n<p><strong>Try 1</strong></p>\n\n<pre><code>Put: 1000\nGet: 1000\nPut: 1000\nGet: 1000\nPut: 1000\nGet: 1000\nPut: 1000\nGet: 1000\nPut: 1000\nGet: 1000\n</code></pre>\n\n<p><strong>Try 2</strong></p>\n\n<pre><code>Put: 1000\nGet: 1000\nPut: 1000\nGet: 1000\nPut: 1000\nGet: 1000\nPut: 1000\nGet: 16\nPut: 1000\nGet: 0\n</code></pre>\n\n<p><strong>Try 3</strong></p>\n\n<pre><code>Get: 1000\nPut: 1000\nPut: 1000\nGet: 1\nPut: 1000\nGet: 1000\nPut: 1000\nGet: 1\nPut: 1000\nGet: 1000\n</code></pre>\n\n<p>ALthough on my PC, the number of data of \"Put\" and \"Get\" is different for every time, at play.golang.org, the number of both data is always same. <a href=\"https://play.golang.org/p/QFSuZmZk7d\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QFSuZmZk7d</a> Why?</p>\n\n<p>If <code>time.Sleep(time.Second / 1000)</code> is used in the script, the number of both data becomes same. If you know about this problem, will you please teach me. Thank you so much for your time.</p>\n"}, {"tags": ["multithreading", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1490683022, "post_id": 43062111, "comment_id": 73208533, "body": "There are no &quot;threads&quot; in Go, so you simply cannot do this. But you can take e.g. 4 goroutines and lock each of them to a thread (hopefully 4 different) wit LockOSThread."}, {"owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1490687588, "post_id": 43062111, "comment_id": 73211229, "body": "@Volker LockOSThread prevents any other goroutine from using that same thread, so you&#39;re guaranteed they&#39;ll be on four different threads. <a href=\"https://golang.org/pkg/runtime/#LockOSThread\" rel=\"nofollow noreferrer\">golang.org/pkg/runtime/#LockOSThread</a>"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 3, "last_activity_date": 1490685694, "creation_date": 1490685694, "answer_id": 43063046, "question_id": 43062111, "link": "https://stackoverflow.com/questions/43062111/golang-how-to-bind-code-with-thread/43063046#43063046", "title": "golang: how to bind code with thread?", "body": "<p>You spawn <em>some number</em> of goroutines, run <code>runtime.LockOSThread()</code> in each\nand then initialize your graphical library in each.</p>\n\n<p>You then use regular Go communication primitives to send tasks to those\ngoroutines.  Usually, the most simple way is to have each goroutine read \"tasks\" from a channel and send the results back, like in</p>\n\n<pre><code>type Task struct {\n  Data DataTypeToContainRecognitionTask\n  Result chan&lt;- DataTypeToContainRecognitionResult\n}\n\nfunc GoroutineLoop(tasks &lt;-chan Task) {\n  for task := range tasks {\n    task.Result &lt;- recognize(Data)\n  }\n}\n\ntasks := make(chan Task)\nfor n := 4; n &gt; 0; n-- {\n  go GoroutineLoop(tasks)\n}\n\nfor {\n  res := make(chan DataTypeToContainRecognitionResult)\n  tasks &lt;- Task{\n    Data: makeRecognitionData(),\n    Result: res,\n  }\n\n  result &lt;- res\n  // Do something with the result\n}\n</code></pre>\n\n<p>As to figuring out how much goroutines to start, there exist different\nstrategies.\nThe simplest approach is probably to query <code>runtime.NumCPU()</code>\nand using this number.</p>\n"}], "owner": {"reputation": 465, "user_id": 2568593, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MEky8.jpg?s=128&g=1", "display_name": "Anthony Cooper", "link": "https://stackoverflow.com/users/2568593/anthony-cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1490685694, "creation_date": 1490682505, "question_id": 43062111, "link": "https://stackoverflow.com/questions/43062111/golang-how-to-bind-code-with-thread", "title": "golang: how to bind code with thread?", "body": "<p>I have nearly implemented a face recognition Go server. My face recognition algorithm uses <code>caffe</code>, <code>caffe</code> is a thread-binding graphical library, that means I have to init and call algorithm in same thread, so I checked <a href=\"https://github.com/golang/go/wiki/LockOSThread\" rel=\"nofollow noreferrer\">LockOSThread()</a>. </p>\n\n<p><code>LockOSThread</code> uses 1 thread, but my server owns 4 GPU.</p>\n\n<p>In <code>C/C++</code>, I could create 4 threads, initialize algorithm in each thread, use <code>sem_wait</code> and <code>sem_post</code> to assign task, 1 thread use 1 GPU.</p>\n\n<p>How to do the same thing in <code>Go</code>, how to bind code with thread?</p>\n"}, {"tags": ["testing", "go", "testify"], "answers": [{"tags": [], "owner": {"reputation": 1641, "user_id": 1519937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XDdSU.jpg?s=128&g=1", "display_name": "Dovydas Bartkevi\u010dius", "link": "https://stackoverflow.com/users/1519937/dovydas-bartkevi%c4%8dius"}, "is_accepted": true, "score": 8, "last_activity_date": 1490706865, "last_edit_date": 1490706865, "creation_date": 1490705913, "answer_id": 43070258, "question_id": 43061814, "link": "https://stackoverflow.com/questions/43061814/is-there-a-way-to-chain-asserts-with-testify/43070258#43070258", "title": "Is there a way to chain asserts with testify?", "body": "<p>You can use testify/require which has the exact same interface as assert, but it terminates the execution on failure. <a href=\"http://godoc.org/github.com/stretchr/testify/require\" rel=\"noreferrer\">http://godoc.org/github.com/stretchr/testify/require</a></p>\n\n<pre><code>import (\n    \"testing\"\n    \"github.com/stretchr/testify/require\"\n    \"github.com/stretchr/testify/assert\"\n)\n\nfunc TestWithRequire(t *testing.T) {\n    require.True(t, false) // fails and terminates\n    require.True(t, true) // never executed\n}\n\nfunc TestWithAssert(t *testing.T) {\n    assert.True(t, false) // fails\n    assert.True(t, false) // fails as well\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6467981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 43070258, "answer_count": 1, "score": 1, "last_activity_date": 1490706865, "creation_date": 1490681374, "question_id": 43061814, "link": "https://stackoverflow.com/questions/43061814/is-there-a-way-to-chain-asserts-with-testify", "title": "Is there a way to chain asserts with testify?", "body": "<p>I really like what testify brings to <code>go test</code>. However, I dug through the documentation and didn't see anything on how to handle multiple asserts. </p>\n\n<p>Does Go handle \"first failure\", in the sense it fails at the first bad assert, or will it only concern itself with the last assert in the test method? </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 498, "user_id": 3969934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7d1904880b54c69a1188076c4dd4de1?s=128&d=identicon&r=PG", "display_name": "Vijay", "link": "https://stackoverflow.com/users/3969934/vijay"}, "edited": false, "score": 0, "creation_date": 1490679300, "post_id": 43061252, "comment_id": 73206837, "body": "Hi, I have updated the question with the relevant code"}, {"owner": {"reputation": 498, "user_id": 3969934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7d1904880b54c69a1188076c4dd4de1?s=128&d=identicon&r=PG", "display_name": "Vijay", "link": "https://stackoverflow.com/users/3969934/vijay"}, "edited": false, "score": 0, "creation_date": 1490679514, "post_id": 43061252, "comment_id": 73206913, "body": "ok, issue solved I added a <code>strings.TrimSpace</code> before calling the <code>processServer</code> function. I guess it was sending the string variable with <code>\\r</code> as end of lines in windows will have them as well."}, {"owner": {"reputation": 2694, "user_id": 1280320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/922b107850370d90a2a8d7e6a0cfbd07?s=128&d=identicon&r=PG", "display_name": "RaviTezu", "link": "https://stackoverflow.com/users/1280320/ravitezu"}, "reply_to_user": {"reputation": 498, "user_id": 3969934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7d1904880b54c69a1188076c4dd4de1?s=128&d=identicon&r=PG", "display_name": "Vijay", "link": "https://stackoverflow.com/users/3969934/vijay"}, "edited": false, "score": 0, "creation_date": 1490679591, "post_id": 43061252, "comment_id": 73206941, "body": "Nice. I am happy that you figured it out."}], "tags": [], "owner": {"reputation": 2694, "user_id": 1280320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/922b107850370d90a2a8d7e6a0cfbd07?s=128&d=identicon&r=PG", "display_name": "RaviTezu", "link": "https://stackoverflow.com/users/1280320/ravitezu"}, "is_accepted": true, "score": 6, "last_activity_date": 1609309122, "last_edit_date": 1609309122, "creation_date": 1490678899, "answer_id": 43061252, "question_id": 43061069, "link": "https://stackoverflow.com/questions/43061069/passing-string-argument-in-golang/43061252#43061252", "title": "Passing string argument in golang", "body": "<p>Can you please provide the code, which defines the <code>serverList</code> variable?</p>\n<p>Or else, you can use the below snippet:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\n\nfunc processServer(s string) {\n   fmt.Println(s, &quot; : started processing&quot;)\n}\n\nfunc main() {\nserverList := [...]string{&quot;server1&quot;,&quot;server2&quot;,&quot;server3&quot;}\n\nfor _,server := range serverList {\n   fmt.Println(&quot;sending &quot;, server)\n   processServer(server)\n}\n}\n</code></pre>\n<p>You can run the script here: <a href=\"https://play.golang.org/p/EL9RgIO67n\" rel=\"nofollow noreferrer\">https://play.golang.org/p/EL9RgIO67n</a></p>\n"}], "owner": {"reputation": 498, "user_id": 3969934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7d1904880b54c69a1188076c4dd4de1?s=128&d=identicon&r=PG", "display_name": "Vijay", "link": "https://stackoverflow.com/users/3969934/vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14157, "favorite_count": 0, "accepted_answer_id": 43061252, "answer_count": 1, "score": 1, "last_activity_date": 1609309122, "creation_date": 1490677990, "last_edit_date": 1490679281, "question_id": 43061069, "link": "https://stackoverflow.com/questions/43061069/passing-string-argument-in-golang", "title": "Passing string argument in golang", "body": "<p>just starting with Go and having trouble with basic function call:</p>\n\n<pre><code>fileContentBytes := ioutil.ReadFile(\"serverList.txt\")\nfileContent := string(fileContentBytes)\nserverList := strings.Split(fileContent,\"\\n\")\n   /*\nserverList:\nserver1,\nserver2,\nserver3\n   */\nfor _,server := range serverList {\n   fmt.Println(\"sending \", server)\n   processServer(server)\n}\n\nfunc processServer(s string) {\n   fmt.Println(s, \" : started processing\")\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>sending server1\n : started processing\nsending server2\n : started processing\nsending server3\n server3: started processing\n</code></pre>\n\n<p>In the above code from the for loop I am able to print all the elements of array but <em>only the last element</em> gets passed properly to the function <code>processServer</code>.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Go Version: 1.8\nOS: Windows 7 x64</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1490675861, "post_id": 43060591, "comment_id": 73205640, "body": "1: Because the goroutine execute <i>concurrently</i>. Don&#39;t use goroutines. 2. See <a href=\"https://golang.org/doc/faq#closures_and_goroutines\" rel=\"nofollow noreferrer\">golang.org/doc/faq#closures_and_goroutines</a> for your problem. 3. No, not at all."}], "answers": [{"tags": [], "owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "is_accepted": false, "score": 2, "last_activity_date": 1490690890, "creation_date": 1490690890, "answer_id": 43064825, "question_id": 43060591, "link": "https://stackoverflow.com/questions/43060591/golang-buffer-channel-unexpected-result/43064825#43064825", "title": "golang buffer channel unexpected result", "body": "<p>Output is not constant because different goroutines share same local variable i. If you uncomment your line and move it right before the goruoutine call, you'll see constant output 0-29. The better way is to move i variable to goroutine function arguments.</p>\n\n<p>Wake up order is not specified in specs. You should consider it as a random one.</p>\n"}, {"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 0, "last_activity_date": 1490692722, "creation_date": 1490692722, "answer_id": 43065519, "question_id": 43060591, "link": "https://stackoverflow.com/questions/43060591/golang-buffer-channel-unexpected-result/43065519#43065519", "title": "golang buffer channel unexpected result", "body": "<p>3 It is FIFO</p>\n\n<p>1 Because the goroutines created inside the for loop will not necessarily execute sequentially. The underlying Go scheduler will start one randomly (it's how channels dispatch their values). Of-course all of them will get created, but they will (get scheduled to) start at the point <code>time.Sleep(...)</code> in <code>main</code> is called (Go scheduler is a cooperative one and does so on certain points like function calls, channel ops, etc - for example <a href=\"http://blog.nindalf.com/how-goroutines-work/\" rel=\"nofollow noreferrer\">this</a>)</p>\n\n<p>2 Use the channel directly:</p>\n\n<pre><code>var (\n    c  = make(chan int, 2)\n    wg = &amp;sync.WaitGroup{}\n)\n\nfunc main() {\n    wg.Add(1)\n    go worker(1)\n\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        for i := 0; i &lt; 30; i++ {\n            c &lt;- i\n        }\n        close(c)\n    }()\n    wg.Wait()\n}\n\nfunc worker(id int) {\n    defer wg.Done()\n    for a := range c {\n        println(a, runtime.NumGoroutine())\n        time.Sleep(time.Second)\n    }\n}\n</code></pre>\n\n<p>About passing a <code>for</code> loop variable; you've done it almost correctly. You just have to put the line to create the local closure, outside the goroutine:</p>\n\n<pre><code>var (\n    wg = &amp;sync.WaitGroup{}\n)\n\nfunc main() {\n    for i := 0; i &lt; 3; i++ {\n        localClosure := i // &lt;- this line\n\n        wg.Add(1)\n        go func() {\n            defer wg.Done()\n            println(localClosure)\n        }()\n    }\n\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 3682618, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/0403f397be9d39e5abc0371b8f69f208?s=128&d=identicon&r=PG&f=1", "display_name": "user3682618", "link": "https://stackoverflow.com/users/3682618/user3682618"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1490692722, "creation_date": 1490674883, "question_id": 43060591, "link": "https://stackoverflow.com/questions/43060591/golang-buffer-channel-unexpected-result", "title": "golang buffer channel unexpected result", "body": "<pre><code>package main\nimport (\n    \"time\"\n    \"runtime\"\n)\n\nvar c = make(chan int, 2)\n\nfunc main() {\n  go worker(1)\n  for i := 0; i &lt; 30; i++ {\n    go func() {\n            // k := i   make a local copy not make any difference\n            c &lt;- i\n    }()\n  }\n  time.Sleep(100* time.Second)\n}\n\nfunc worker(id int) {\n  for {\n    a := &lt;-c\n    println(a, runtime.NumGoroutine())\n    time.Sleep(time.Second)\n  }\n}\n</code></pre>\n\n<p>the output is unpredictable, sometimes like below.</p>\n\n<pre><code>7 9\n13 29\n13 28\n13 27\n13 26\n13 25\n13 24\n13 23\n16 22\n16 21\n17 20\n19 19\n21 18\n21 17\n23 16\n25 15\n26 14\n26 13\n26 12\n26 11\n26 10\n26 9\n26 8\n26 7\n27 6\n27 5\n13 4\n28 3\n30 2\n30 2\n</code></pre>\n\n<p>I know sender will block if the buffer channel is full, and when channel is available the sender can continue.</p>\n\n<ol>\n<li>why output is not constant output 0-29? how to make it??</li>\n<li>how variable/local variable store in goroutine?? </li>\n<li>if lots of senders are blocked, are they waked up by FIFO order??</li>\n</ol>\n"}, {"tags": ["go", "unicode", "case-folding"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490671393, "post_id": 43059909, "comment_id": 73204459, "body": "Given golang implements the capitalisation function as <code>func to(_case int, r rune, caseRange []CaseRange) rune {</code> is it even possible to return multiple rules at all."}, {"owner": {"reputation": 1353, "user_id": 1536242, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4d57fcd9437881455dbfd1921556d8b7?s=128&d=identicon&r=PG", "display_name": "Shawn Blakesley", "link": "https://stackoverflow.com/users/1536242/shawn-blakesley"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490671872, "post_id": 43059909, "comment_id": 73204578, "body": "Yeah, that&#39;s what I&#39;m trying to get at. There are languages where one &quot;rune&quot; can become two through case folding / capitalization, so there should be a way to handle such a thing in golang."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1490671934, "post_id": 43059909, "comment_id": 73204596, "body": "If you end up creating an issue could you please post a link here (since I don&#39;t think there is something there to properly convert it)"}, {"owner": {"reputation": 1353, "user_id": 1536242, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4d57fcd9437881455dbfd1921556d8b7?s=128&d=identicon&r=PG", "display_name": "Shawn Blakesley", "link": "https://stackoverflow.com/users/1536242/shawn-blakesley"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490672038, "post_id": 43059909, "comment_id": 73204620, "body": "Will do. I just didn&#39;t want to create an issue until I had done more research / reached out for help."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1490672409, "post_id": 43059909, "comment_id": 73204701, "body": "Interesting, and kinda relevant: <a href=\"http://www.unicode.org/Public/UCD/latest/ucd/CaseFolding.txt\" rel=\"nofollow noreferrer\">unicode.org/Public/UCD/latest/ucd/CaseFolding.txt</a> full case folding are the tricky unicode codepoints (and won&#39;t work in Go)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1490674631, "post_id": 43059909, "comment_id": 73205313, "body": "Not in the core: please look at what <a href=\"https://godoc.org/golang.org/x/text\" rel=\"nofollow noreferrer\">golang.org/x/text</a> can do for you."}, {"owner": {"reputation": 1353, "user_id": 1536242, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4d57fcd9437881455dbfd1921556d8b7?s=128&d=identicon&r=PG", "display_name": "Shawn Blakesley", "link": "https://stackoverflow.com/users/1536242/shawn-blakesley"}, "edited": false, "score": 0, "creation_date": 1490675529, "post_id": 43059909, "comment_id": 73205545, "body": "Awesome! Thanks kostix. If you turn that into an answer I will accept it. Basically using <code>import &quot;golang.org&#47;x&#47;text&#47;cases&quot;</code> I can do <code>c := cases.Fold()</code> then <code>c.String(&quot;gr&#252;&#223;en&quot;)</code> and it works."}], "answers": [{"comments": [{"owner": {"reputation": 1353, "user_id": 1536242, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4d57fcd9437881455dbfd1921556d8b7?s=128&d=identicon&r=PG", "display_name": "Shawn Blakesley", "link": "https://stackoverflow.com/users/1536242/shawn-blakesley"}, "edited": false, "score": 0, "creation_date": 1490716246, "post_id": 43063211, "comment_id": 73231928, "body": "c.String(&quot;gr&#252;&#223;en&quot;) actually returns gr&#252;ssen, not GR&#220;SSEN."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 8, "last_activity_date": 1490762069, "last_edit_date": 1490762069, "creation_date": 1490686134, "answer_id": 43063211, "question_id": 43059909, "link": "https://stackoverflow.com/questions/43059909/golang-complex-fold-gr%c3%bc%c3%9fen/43063211#43063211", "title": "Golang complex fold gr&#252;&#223;en", "body": "<p>Advanced (Unicode-enabled) text processing is not part of the Go stdlib,\u00b9\nand exists in the form of a host of (\"blessed\") third-party packages\nunder the <a href=\"http://godoc.org/golang.org/x/text\" rel=\"nofollow noreferrer\"><code>golang.org/x/text/</code> umbrella</a>.</p>\n\n<p>As Shawn figured out by himself, one can do</p>\n\n<pre><code>import (\n  \"golang.org/x/text/cases\"\n)\n\nc := cases.Fold()\nc.String(\"gr\u00fc\u00dfen\")\n</code></pre>\n\n<p>to get \"gr\u00fcssen\" back.</p>\n\n<hr>\n\n<p>\u00b9 That's because whatever is shipped in the stdlib is subject to the\n<a href=\"https://golang.org/doc/go1compat\" rel=\"nofollow noreferrer\">Go 1 compatibility promise</a>,\nand at the time Go 1 was shipped certain functionality wasn't available\nor was incomplete or its APIs were in flux etc, so such bits were kept out\nof the core to let them mature.</p>\n"}], "owner": {"reputation": 1353, "user_id": 1536242, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4d57fcd9437881455dbfd1921556d8b7?s=128&d=identicon&r=PG", "display_name": "Shawn Blakesley", "link": "https://stackoverflow.com/users/1536242/shawn-blakesley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 583, "favorite_count": 0, "accepted_answer_id": 43063211, "answer_count": 1, "score": 16, "last_activity_date": 1490762069, "creation_date": 1490669969, "question_id": 43059909, "link": "https://stackoverflow.com/questions/43059909/golang-complex-fold-gr%c3%bc%c3%9fen", "title": "Golang complex fold gr&#252;&#223;en", "body": "<p>I'm trying to get case folding to be consistent between three languages (C++, Python and Golang) because I need to be able to check if a string matches the one saved no matter the language.</p>\n\n<p>An example problematic word is the German word \"gr\u00fc\u00dfen\" which in uppercase is \"GR\u00dcSSEN\" (Note the '\u00df' becomes two characters as 'SS').</p>\n\n<ul>\n<li>C++ works well using boost::locale <a href=\"http://www.boost.org/doc/libs/1_63_0/libs/locale/doc/html/conversions.html\" rel=\"noreferrer\" title=\"boost locale gr\u00fc\u00dfen\">text conversion docs</a> </li>\n<li>Python 3 also works through str.casefold() <a href=\"https://docs.python.org/3/library/stdtypes.html#str.casefold\" rel=\"noreferrer\">casefold docs</a></li>\n<li>However, Golang doesn't seem to have a way to do proper case folding. <a href=\"https://play.golang.org/p/eYku0fCIpu\" rel=\"noreferrer\">golang\nplayground example</a></li>\n</ul>\n\n<p>Is there some way to do this that I'm missing, or does this bug at the end of <a href=\"https://golang.org/pkg/unicode/#pkg-note-BUG\" rel=\"noreferrer\">unicode's documentation</a> apply to all usages of text conversion in golang? If so, what are my options for case folding other than writing it in cgo? </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 14127, "user_id": 641627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEgWh.jpg?s=128&g=1", "display_name": "alexbt", "link": "https://stackoverflow.com/users/641627/alexbt"}, "edited": false, "score": 0, "creation_date": 1490669554, "post_id": 43059772, "comment_id": 73203978, "body": "Nice answer, did not know this. I have to say, I had a hard time understanding your explanation... You could quote the first two paragraphs from your link, it will add value to your answer!"}], "tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": true, "score": 19, "last_activity_date": 1490670286, "last_edit_date": 1592644375, "creation_date": 1490668997, "answer_id": 43059772, "question_id": 43059653, "link": "https://stackoverflow.com/questions/43059653/golang-interfacenil-is-nil-or-not/43059772#43059772", "title": "golang (*interface{})(nil) is nil or not?", "body": "<p>according to <a href=\"https://golang.org/doc/faq#nil_error\" rel=\"noreferrer\">golang faq</a></p>\n<blockquote>\n<p>Under the covers, interfaces are implemented as two elements, a type and a value. The value, called the interface's dynamic value, is an arbitrary concrete value and the type is that of the value. For the int value 3, an interface value contains, schematically, (int, 3).</p>\n<p>An interface value is nil only if the inner value and type are both unset, (nil, nil). In particular, a nil interface will always hold a nil type. If we store a nil pointer of type *int inside an interface value, the inner type will be *int regardless of the value of the pointer: (*int, nil). Such an interface value will therefore be non-nil even when the pointer inside is nil.</p>\n</blockquote>\n<p><code>a := (*interface{})(nil)</code> is equal with <code>var a *interface{} = nil</code>.</p>\n<p>but <code>var b interface{} = (*interface{})(nil)</code> , mean <code>b</code> is type <code>interface{}</code>, and <code>interface{}</code> variable only <code>nil</code> when it's type and value are both <code>nil</code>, obviously type <code>*interface{}</code> is not <code>nil</code>.</p>\n"}], "owner": {"reputation": 183, "user_id": 3868484, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8845181e3d0c229fb60538051bf0b70c?s=128&d=identicon&r=PG", "display_name": "LeoTao", "link": "https://stackoverflow.com/users/3868484/leotao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4010, "favorite_count": 7, "accepted_answer_id": 43059772, "answer_count": 1, "score": 8, "last_activity_date": 1528053357, "creation_date": 1490668119, "last_edit_date": 1528053357, "question_id": 43059653, "link": "https://stackoverflow.com/questions/43059653/golang-interfacenil-is-nil-or-not", "title": "golang (*interface{})(nil) is nil or not?", "body": "<p>the code snippet is the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    a := (*interface{})(nil)\n    fmt.Println(reflect.TypeOf(a), reflect.ValueOf(a))\n    var b interface{} = (*interface{})(nil)\n    fmt.Println(reflect.TypeOf(b), reflect.ValueOf(b))\n    fmt.Println(a == nil, b == nil)\n}\n</code></pre>\n\n<p>the output like below:</p>\n\n<pre><code>*interface {} &lt;nil&gt;\n*interface {} &lt;nil&gt;\ntrue false\n</code></pre>\n\n<p>so <code>var interface{}</code> is different from <code>:=</code>,why?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1490663523, "post_id": 43058841, "comment_id": 73202408, "body": "<a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">gobyexample.com/worker-pools</a>"}, {"owner": {"reputation": 1617, "user_id": 1478168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/2Fok1.jpg?s=128&g=1", "display_name": "thinkerou", "link": "https://stackoverflow.com/users/1478168/thinkerou"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1490664079, "post_id": 43058841, "comment_id": 73202560, "body": "@zerkms thanks a lot~~"}, {"owner": {"reputation": 1617, "user_id": 1478168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/2Fok1.jpg?s=128&g=1", "display_name": "thinkerou", "link": "https://stackoverflow.com/users/1478168/thinkerou"}, "reply_to_user": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1490744172, "post_id": 43058841, "comment_id": 73246520, "body": "@ScottStensland OK"}], "answers": [{"tags": [], "owner": {"reputation": 1617, "user_id": 1478168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/2Fok1.jpg?s=128&g=1", "display_name": "thinkerou", "link": "https://stackoverflow.com/users/1478168/thinkerou"}, "is_accepted": false, "score": 1, "last_activity_date": 1490744218, "creation_date": 1490744218, "answer_id": 43081753, "question_id": 43058841, "link": "https://stackoverflow.com/questions/43058841/how-should-i-write-goroutine/43081753#43081753", "title": "How should I write goroutine?", "body": "<p>Thanks @zerkms, I re-wrote the following code base on <a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">Go by Example: Worker Pools</a></p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/md5\"\n    \"encoding/hex\"\n    \"fmt\"\n    \"io\"\n    \"math\"\n    \"strconv\"\n)\n\nfunc Md5Str(str string) string {\n    m := md5.New()\n    io.WriteString(m, str)\n    return hex.EncodeToString(m.Sum(nil))\n}\n\nfunc compute(size int) int {\n    num := int(math.Floor(float64(size+256*1024-1)) / 256 / 1024)\n    return num\n}\n\nfunc out(s string, jobs &lt;-chan int, results chan&lt;- string) {\n    for j := range jobs {\n        fmt.Println(\"Hello: \" + s + strconv.Itoa(j))\n        results &lt;- s\n    }\n}\n\nfunc main() {\n    num := compute(4194304)\n    jobs := make(chan int, num)\n    results := make(chan string, num)\n\n    for i := 0; i &lt; num; i++ {\n        key := Md5Str(\"503969280ff8679135937ad7d23b06c5\" + \"_\" + strconv.Itoa(i))\n        go out(key+\"_\"+strconv.Itoa(i), jobs, results)\n    }\n\n    for j := 0; j &lt; num; j++ {\n        jobs &lt;- j\n    }\n    close(jobs)\n\n    for k := 0; k &lt; num; k++ {\n        &lt;-results\n    }\n}\n</code></pre>\n\n<p>It can run right.</p>\n"}], "owner": {"reputation": 1617, "user_id": 1478168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/2Fok1.jpg?s=128&g=1", "display_name": "thinkerou", "link": "https://stackoverflow.com/users/1478168/thinkerou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1490744218, "creation_date": 1490662335, "last_edit_date": 1490744196, "question_id": 43058841, "link": "https://stackoverflow.com/questions/43058841/how-should-i-write-goroutine", "title": "How should I write goroutine?", "body": "<p>Now I have the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/md5\"\n    \"encoding/hex\"\n    \"fmt\"\n    \"io\"\n    \"math\"\n    \"strconv\"\n)\n\nfunc Md5Str(str string) string {\n    m := md5.New()\n    io.WriteString(m, str)\n    return hex.EncodeToString(m.Sum(nil))\n}\n\nfunc compute(size int) int {\n    num := int(math.Floor(float64(size+256*1024-1)) / 256 / 1024)\n    return num\n}\n\nfunc out(s string) string {\n    return \"Hello: \" + s\n}\n\nfunc main() {\n    num := compute(4194304)\n    for i := 0; i &lt; num; i++ {\n        key := Md5Str(\"503969280ff8679135937ad7d23b06c5\" + \"_\" + strconv.Itoa(i))\n        res := out(key + \"_\" + strconv.Itoa(i))\n        fmt.Println(res)\n    }\n}\n</code></pre>\n\n<p>And it can run right.</p>\n\n<p>I want to concurrency run the code, because if the <code>out</code> function run long time and the concurrency run will save time.</p>\n"}, {"tags": ["go", "google-api", "gmail-api", "google-api-go-client"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490657086, "post_id": 43057478, "comment_id": 73200481, "body": "Probably TEST is reserved <a href=\"https://developers.google.com/gmail/api/guides/labels#types_of_labels\" rel=\"nofollow noreferrer\">developers.google.com/gmail/api/guides/labels#types_of_label&zwnj;&#8203;s</a>, read the note in blue at the bottom... If that&#39;s the case maybe, maybe not, changing the label to TESTING will work just fine."}], "answers": [{"tags": [], "owner": {"reputation": 100534, "user_id": 7108653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LH2EI.png?s=128&g=1", "display_name": "Tanaike", "link": "https://stackoverflow.com/users/7108653/tanaike"}, "is_accepted": true, "score": 4, "last_activity_date": 1490659954, "creation_date": 1490659954, "answer_id": 43058523, "question_id": 43057478, "link": "https://stackoverflow.com/questions/43057478/google-api-go-client-listing-messages-w-label-and-fetching-header-fields/43058523#43058523", "title": "Google-api-go-client: listing messages w/ label and fetching header fields", "body": "<p>The label name and ID of \"INBOX\" are the same. But, there is a case to differ between the label name and label ID. You have 2 methods for retrieving message list of the label. Following scripts suppose the use of <a href=\"https://developers.google.com/gmail/api/quickstart/go\" rel=\"nofollow noreferrer\">Go Quickstart</a> from google.</p>\n\n<h2>1. Check label IDs and retrieve message list</h2>\n\n<p><strong>Retrieve label names and IDs :</strong></p>\n\n<pre><code>mes, err := srv.Users.Labels.List(user).Do()\nif err != nil {\n    log.Fatalf(\"Error: %v\", err)\n}\nfor _, e := range mes.Labels {\n    fmt.Println(e.Name + \", \" + e.Id)\n}\n</code></pre>\n\n<p><strong>Retrieve message list using <code>labelID</code> :</strong></p>\n\n<pre><code>mes, err := srv.Users.Messages.List(user).LabelIds(labelID).Do()\nif err != nil {\n    log.Fatalf(\"Error: %v\", err)\n}\nfor _, e := range mes.Messages {\n    fmt.Println(e.Id)\n}\n</code></pre>\n\n<h2>2. Retrieve message list using \"Q\"</h2>\n\n<pre><code>mes, err := srv.Users.Messages.List(user).Q(\"label:labelname\").Do()\nif err != nil {\n    log.Fatalf(\"Error: %v\", err)\n}\nfor _, e := range mes.Messages {\n    fmt.Println(e.Id)\n}\n</code></pre>\n\n<p>This can be directly retrieved a message list for the label name. Parameters of \"Q\" are the same to the Gmail search box.</p>\n\n<p><strong>References :</strong></p>\n\n<ol>\n<li><p>Users.messages: list <a href=\"https://developers.google.com/gmail/api/v1/reference/users/messages/list\" rel=\"nofollow noreferrer\">https://developers.google.com/gmail/api/v1/reference/users/messages/list</a></p></li>\n<li><p>Users.labels: list <a href=\"https://developers.google.com/gmail/api/v1/reference/users/labels/list\" rel=\"nofollow noreferrer\">https://developers.google.com/gmail/api/v1/reference/users/labels/list</a></p></li>\n</ol>\n"}], "owner": {"reputation": 137, "user_id": 7080648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2901de4125a4228c4ae27ec4bdcba067?s=128&d=identicon&r=PG", "display_name": "user60589", "link": "https://stackoverflow.com/users/7080648/user60589"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 1, "accepted_answer_id": 43058523, "answer_count": 1, "score": 2, "last_activity_date": 1575369711, "creation_date": 1490653601, "last_edit_date": 1575369711, "question_id": 43057478, "link": "https://stackoverflow.com/questions/43057478/google-api-go-client-listing-messages-w-label-and-fetching-header-fields", "title": "Google-api-go-client: listing messages w/ label and fetching header fields", "body": "<p>I want to list messages with a specific label.  So I used the <a href=\"https://developers.google.com/gmail/api/quickstart/go\" rel=\"nofollow noreferrer\">Go Quickstart code from google</a> and set the scope to gmail.MailGoogleComScope.</p>\n\n<p>Getting a list of all messages with label \"INBOX\" works fine using this code</p>\n\n<pre><code>    mes, err := srv.Users.Messages.List(user).LabelIds(\"INBOX\").Do()\n</code></pre>\n\n<p>but when I replace \"INBOX\" with \"TEST\" I get the error:</p>\n\n<blockquote>\n  <p>nable to retrieve Messages. googleapi: Error 400: Invalid label: TEST,\n  invalidArgument exit status 1</p>\n</blockquote>\n\n<p>and there is a label with name TEST. What am I doing wrong?</p>\n"}, {"tags": ["c", "gcc", "go", "build"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1490656861, "post_id": 43057418, "comment_id": 73200399, "body": "Add the output of the <code>go version</code> and <code>go env</code> commands to your question."}, {"owner": {"reputation": 738, "user_id": 7572026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/340e7b48d6bfe006ce1b6f7161911df2?s=128&d=identicon&r=PG&f=1", "display_name": "Manav Dubey", "link": "https://stackoverflow.com/users/7572026/manav-dubey"}, "edited": false, "score": 0, "creation_date": 1490657673, "post_id": 43057418, "comment_id": 73200656, "body": "If don&#39;t like the compiler you have download, you should consider [Repl.it](repl.it). It&#39;s a good online C compiler."}], "answers": [{"comments": [{"owner": {"reputation": 602, "user_id": 2868984, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2f8d4e85b75ef5fadf30c9dc62bbee10?s=128&d=identicon&r=PG&f=1", "display_name": "Wildan Maulana Syahidillah", "link": "https://stackoverflow.com/users/2868984/wildan-maulana-syahidillah"}, "edited": false, "score": 2, "creation_date": 1490665273, "post_id": 43059005, "comment_id": 73202872, "body": "now I get an error:  <code>\\AppData\\Local\\Temp\\go-link-826517911\\go.o: file not recognized: File format not recognized</code>"}, {"owner": {"reputation": 409, "user_id": 3661748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc0e02aa0793fbb31142e13e2bfb5fc9?s=128&d=identicon&r=PG&f=1", "display_name": "cody.tv.weber", "link": "https://stackoverflow.com/users/3661748/cody-tv-weber"}, "edited": false, "score": 3, "creation_date": 1532542089, "post_id": 43059005, "comment_id": 90019183, "body": "How did you get it working?  I am having the same error for go.o not recognized.  Thanks!"}, {"owner": {"reputation": 86, "user_id": 3711318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0d46e8d763305f59082a9abaabe52a?s=128&d=identicon&r=PG&f=1", "display_name": "rhubarb_pie", "link": "https://stackoverflow.com/users/3711318/rhubarb-pie"}, "edited": false, "score": 0, "creation_date": 1617731599, "post_id": 43059005, "comment_id": 118385414, "body": "I am also getting the error &quot;go.o: file not recognized: File format not recognized&quot;. Was anybody able to resolve this?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1490663680, "creation_date": 1490663680, "answer_id": 43059005, "question_id": 43057418, "link": "https://stackoverflow.com/questions/43057418/running-gcc-failed-while-building-go-project-in-windows/43059005#43059005", "title": "Running gcc failed while building go project in windows", "body": "<blockquote>\n  <p>/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../x86_64-pc-cygwin/bin/ld:\n  cannot find -lmingw32 collect2</p>\n</blockquote>\n\n<p>You are using cygwin to look for mingw libraries. Don't use cygwin; use a mingw gcc compiler. I use <a href=\"http://tdm-gcc.tdragon.net/download\" rel=\"nofollow noreferrer\">TDM-GCC</a>.</p>\n"}], "owner": {"reputation": 602, "user_id": 2868984, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2f8d4e85b75ef5fadf30c9dc62bbee10?s=128&d=identicon&r=PG&f=1", "display_name": "Wildan Maulana Syahidillah", "link": "https://stackoverflow.com/users/2868984/wildan-maulana-syahidillah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2894, "favorite_count": 2, "accepted_answer_id": 43059005, "answer_count": 1, "score": 1, "last_activity_date": 1490663680, "creation_date": 1490653289, "last_edit_date": 1490660259, "question_id": 43057418, "link": "https://stackoverflow.com/questions/43057418/running-gcc-failed-while-building-go-project-in-windows", "title": "Running gcc failed while building go project in windows", "body": "<p>I tried compiling my project using <code>go build</code> and I get this error:</p>\n\n<blockquote>\n  <p>C:\\Go\\pkg\\tool\\windows_amd64\\link.exe: running gcc failed: exit status 1\n  /usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lmingwex\n  /usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lmingw32\n  collect2: error: ld returned 1 exit status</p>\n</blockquote>\n\n<p>I've read that linking files with gcc is a <a href=\"https://github.com/golang/go/issues/9510\" rel=\"nofollow noreferrer\" title=\"problem\">problem</a> in compiling go projects with Windows. But I have installed gcc in my Windows system but the error persists. I can see the error above references gcc as in a Linux sistem (/usr/lib) so how would the compiler detect my gcc installation?</p>\n\n<p>EDIT:</p>\n\n<p>My <code>go env</code></p>\n\n<pre><code>set GOARCH=amd64\nset GOBIN=\nset GOEXE=.exe\nset GOHOSTARCH=amd64\nset GOHOSTOS=windows\nset GOOS=windows\nset GOPATH=D:\\Go\nset GORACE=\nset GOROOT=C:\\Go\nset GOTOOLDIR=C:\\Go\\pkg\\tool\\windows_amd64\nset GCCGO=gccgo\nset CC=gcc\nset GOGCCFLAGS=-m64 -mthreads -fmessage-length=0 -fdebug-prefix-map=C:\\Users\\wildan\\AppData\\Loc\nal\\Temp\\go-build554990027=/tmp/go-build -gno-record-gcc-switches\nset CXX=g++\nset CGO_ENABLED=1\nset PKG_CONFIG=pkg-config\nset CGO_CFLAGS=-g -O2\nset CGO_CPPFLAGS=\nset CGO_CXXFLAGS=-g -O2\nset CGO_FFLAGS=-g -O2\nset CGO_LDFLAGS=-g -O2\n</code></pre>\n\n<p>Using go version 1.8</p>\n"}, {"tags": ["go", "atom-editor"], "comments": [{"owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "edited": false, "score": 0, "creation_date": 1490665612, "post_id": 43056909, "comment_id": 73202945, "body": "I don&#39;t understand <i>I have achieved this on vs code and intellij idea, somehow there is no easy way to do this</i>"}, {"owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "edited": false, "score": 0, "creation_date": 1490665835, "post_id": 43056909, "comment_id": 73203006, "body": "Out of interest: What&#39;s your use case for that requirement?"}, {"owner": {"reputation": 814, "user_id": 651948, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3f9e2a68d31d70e22a7240f5333212eb?s=128&d=identicon&r=PG", "display_name": "Charlires", "link": "https://stackoverflow.com/users/651948/charlires"}, "reply_to_user": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "edited": false, "score": 0, "creation_date": 1490666257, "post_id": 43056909, "comment_id": 73203111, "body": "The use case is that I need to set up a gopath per project and seems like go-plus package does not support it."}, {"owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "edited": false, "score": 0, "creation_date": 1490686788, "post_id": 43056909, "comment_id": 73210713, "body": "You might take a look at the package atomenv. However, it did not work for me."}, {"owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "edited": false, "score": 0, "creation_date": 1490688842, "post_id": 43056909, "comment_id": 73212028, "body": "I just read through the open issues for go-plus on Github. To me it looks like the author is working on the issue by adding support for a .go.json configuration file that will allow for a variety of scenarios at binary, library and project level."}], "answers": [{"tags": [], "owner": {"reputation": 804, "user_id": 1713737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e544d0c6d100d208baf0e757fd889fd?s=128&d=identicon&r=PG", "display_name": "Olivier", "link": "https://stackoverflow.com/users/1713737/olivier"}, "is_accepted": false, "score": 3, "last_activity_date": 1511346242, "creation_date": 1511346242, "answer_id": 47432201, "question_id": 43056909, "link": "https://stackoverflow.com/questions/43056909/add-gopath-by-project-in-go-plus-atom/47432201#47432201", "title": "Add gopath by project in go-plus atom", "body": "<p>In atom, you can install package <a href=\"https://atom.io/packages/atomenv\" rel=\"nofollow noreferrer\">atomenv</a>. Once installed, you need to add a file at the root of your project, named <code>.atomenv.json</code>. This will help you to set variable environments per project in atom. </p>\n\n<p>For GOPATH, edit the file <code>.atomenv.json</code>:</p>\n\n<pre><code>{\n  \"env\": {\n    \"GOPATH\": \"$HOME/go:$ATOM_PROJECT_PATH\"\n  }\n}\n</code></pre>\n\n<p>(<code>$HOME/go</code> is where your main gopath is, for example)</p>\n\n<p>Then you need to call <code>atomenv:load</code> (CTRL+SHIFT+P atomenv:load).</p>\n\n<p>If you use go-plus, the (i) go tab will now show your new GOPATH!</p>\n"}], "owner": {"reputation": 814, "user_id": 651948, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3f9e2a68d31d70e22a7240f5333212eb?s=128&d=identicon&r=PG", "display_name": "Charlires", "link": "https://stackoverflow.com/users/651948/charlires"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1660, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1511346242, "creation_date": 1490650710, "last_edit_date": 1490666196, "question_id": 43056909, "link": "https://stackoverflow.com/questions/43056909/add-gopath-by-project-in-go-plus-atom", "title": "Add gopath by project in go-plus atom", "body": "<p>Im trying to set a different <strong>GOPATH</strong> for every project, I have achieved this on vs code and intellij idea, somehow there is no easy way to do this is someone know I will appreciate some help.</p>\n\n<p>Use case: We use a gopath per project here at work, and seems like go-plus only support one afaik.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2005, "user_id": 1871890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4359cdd9f14bbbe17c56f2fb2d2de25d?s=128&d=identicon&r=PG", "display_name": "Mathieu Nls", "link": "https://stackoverflow.com/users/1871890/mathieu-nls"}, "edited": false, "score": 0, "creation_date": 1490631564, "post_id": 43051556, "comment_id": 73187291, "body": "Indeed... Thanks. I&#39;ll mark accepted in 10 min"}, {"owner": {"reputation": 1111, "user_id": 1131607, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xLKUc.jpg?s=128&g=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/1131607/arun"}, "edited": false, "score": 0, "creation_date": 1583163084, "post_id": 43051556, "comment_id": 107014065, "body": "For Detailed answer Refer : <a href=\"https://stackoverflow.com/questions/34846848/how-to-break-a-long-line-of-code-in-golang\" title=\"how to break a long line of code in golang\">stackoverflow.com/questions/34846848/&hellip;</a>"}], "tags": [], "owner": {"reputation": 14127, "user_id": 641627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEgWh.jpg?s=128&g=1", "display_name": "alexbt", "link": "https://stackoverflow.com/users/641627/alexbt"}, "is_accepted": true, "score": 7, "last_activity_date": 1503754944, "last_edit_date": 1503754944, "creation_date": 1490631518, "answer_id": 43051556, "question_id": 43051496, "link": "https://stackoverflow.com/questions/43051496/break-multi-line-function-call/43051556#43051556", "title": "Break multi line function call", "body": "<p>The dots must be at the end of line:</p>\n\n<pre><code>model.\n    Select(\"INTERNAL_ID\").\n    Select(\"EXTERNAL_ID\").\n    Find(1)\n</code></pre>\n"}], "owner": {"reputation": 2005, "user_id": 1871890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4359cdd9f14bbbe17c56f2fb2d2de25d?s=128&d=identicon&r=PG", "display_name": "Mathieu Nls", "link": "https://stackoverflow.com/users/1871890/mathieu-nls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1251, "favorite_count": 1, "closed_date": 1490631512, "accepted_answer_id": 43051556, "answer_count": 1, "score": 1, "last_activity_date": 1503754944, "creation_date": 1490631320, "question_id": 43051496, "link": "https://stackoverflow.com/questions/43051496/break-multi-line-function-call", "closed_reason": "Duplicate", "title": "Break multi line function call", "body": "<p>I am working on a library / wrapper for mysql in go. For usage of my API I imagined something like:</p>\n\n<pre><code>model\n    .Select(\"INTERNAL_ID\")\n    .Select(\"EXTERNAL_ID\")\n    .Find(1);\n</code></pre>\n\n<p>With, as example, the following functions:</p>\n\n<pre><code>func (model SQLModel) Select(selectString string) SQLModel \nfunc (model SQLModel) Find(id int) interface{}\n</code></pre>\n\n<p>The problem is that I can't break my function calls into multiple lines as go/fmt complains: <code>syntax error: unexpected ., expecting }</code> at every break.</p>\n\n<p>Now, I could go :</p>\n\n<pre><code>model.Select(\"INTERNAL_ID\").Select(\"EXTERNAL_ID\").Find(1)\n</code></pre>\n\n<p>But as the API grows (where, join, sum, etc, ...) it'll rapidly become hard to read.</p>\n\n<p>So, how can I split function calls in GO ? </p>\n\n<p>Thanks,</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 783, "user_id": 1015064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6e1e6578fdc658742314e89c70fe098?s=128&d=identicon&r=PG", "display_name": "cDecker32", "link": "https://stackoverflow.com/users/1015064/cdecker32"}, "edited": false, "score": 0, "creation_date": 1490637452, "post_id": 43050401, "comment_id": 73191039, "body": "Ahh perfect, exactly what I was looking for."}, {"owner": {"reputation": 783, "user_id": 1015064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6e1e6578fdc658742314e89c70fe098?s=128&d=identicon&r=PG", "display_name": "cDecker32", "link": "https://stackoverflow.com/users/1015064/cdecker32"}, "edited": false, "score": 0, "creation_date": 1490797188, "post_id": 43050401, "comment_id": 73273607, "body": "Quick follow up, when I serialize this object back into json, is there a way for me to change the field name? Like read from &#39;disc_firstname&#39; and then when serializing back into json, have it map to &#39;firstname&#39;?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 783, "user_id": 1015064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6e1e6578fdc658742314e89c70fe098?s=128&d=identicon&r=PG", "display_name": "cDecker32", "link": "https://stackoverflow.com/users/1015064/cdecker32"}, "edited": false, "score": 0, "creation_date": 1490797269, "post_id": 43050401, "comment_id": 73273692, "body": "@cDecker32 The names specified in the tags will be used both when marshaling and unmarshaling."}, {"owner": {"reputation": 783, "user_id": 1015064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6e1e6578fdc658742314e89c70fe098?s=128&d=identicon&r=PG", "display_name": "cDecker32", "link": "https://stackoverflow.com/users/1015064/cdecker32"}, "edited": false, "score": 0, "creation_date": 1490797341, "post_id": 43050401, "comment_id": 73273756, "body": "So no way to provide a value for mashalling and a different one for unmarshalling on the same struct?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 783, "user_id": 1015064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6e1e6578fdc658742314e89c70fe098?s=128&d=identicon&r=PG", "display_name": "cDecker32", "link": "https://stackoverflow.com/users/1015064/cdecker32"}, "edited": false, "score": 0, "creation_date": 1490797397, "post_id": 43050401, "comment_id": 73273815, "body": "@cDecker32 Not with tags. You may implement <code>json.Marshaler</code> and <code>json.Unmarshaler</code> to do custom conversion, doing whatever you want to in them."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1490628477, "last_edit_date": 1495542326, "creation_date": 1490628169, "answer_id": 43050401, "question_id": 43050246, "link": "https://stackoverflow.com/questions/43050246/custom-json-mapping-function-in-go/43050401#43050401", "title": "Custom JSON mapping function in Go", "body": "<p>Use <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">tags</a> to specify the field name in JSON. The JSON object you posted above can be modeled like this:</p>\n\n<pre><code>type Something struct {\n    Next    string        `json:\"_next\"`\n    Data    []interface{} `json:\"data\"`\n    Message string        `json:\"message\"`\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>func main() {\n    var sg Something\n    if err := json.Unmarshal([]byte(s), &amp;sg); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%+v\", sg)\n}\n\nconst s = `{\n    \"_next\": \"someValue\",\n    \"data\":  [\"one\", 2],\n    \"message\": \"success\"\n}`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/NJCkBpzdfn\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{Next:someValue Data:[one 2] Message:success}\n</code></pre>\n\n<p>Also note that you may also unmarshal into maps or <code>interface{}</code> values, so you don't even have to create structs, but it won't be as convenient using it as the structs:</p>\n\n<pre><code>func main() {\n    var m map[string]interface{}\n    if err := json.Unmarshal([]byte(s), &amp;m); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%+v\", m)\n}\n\nconst s = `{\n    \"_next\": \"someValue\",\n    \"data\":  [\"one\", 2],\n    \"message\": \"success\"\n}`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/cuKkKmlp5a\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>map[_next:someValue data:[one 2] message:success]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2694, "user_id": 1280320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/922b107850370d90a2a8d7e6a0cfbd07?s=128&d=identicon&r=PG", "display_name": "RaviTezu", "link": "https://stackoverflow.com/users/1280320/ravitezu"}, "is_accepted": false, "score": 0, "last_activity_date": 1490679499, "creation_date": 1490679499, "answer_id": 43061382, "question_id": 43050246, "link": "https://stackoverflow.com/questions/43050246/custom-json-mapping-function-in-go/43061382#43061382", "title": "Custom JSON mapping function in Go", "body": "<p>Tags will solve your problem.</p>\n\n<p>Hoping it may help others who come here, you can make use of <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">https://mholt.github.io/json-to-go/</a> to generate Go structs. Paste a JSON structure on the left and the equivalent Go type will be generated to the right, which you can paste into your program. </p>\n"}], "owner": {"reputation": 783, "user_id": 1015064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6e1e6578fdc658742314e89c70fe098?s=128&d=identicon&r=PG", "display_name": "cDecker32", "link": "https://stackoverflow.com/users/1015064/cdecker32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 43050401, "answer_count": 2, "score": 2, "last_activity_date": 1490679499, "creation_date": 1490627783, "last_edit_date": 1490628270, "question_id": 43050246, "link": "https://stackoverflow.com/questions/43050246/custom-json-mapping-function-in-go", "title": "Custom JSON mapping function in Go", "body": "<p>So I'm making a Go service that makes a call to a restful API, I have no control over the API I'm calling.</p>\n\n<p>I know that Go has a nice built in deserializer in NewDecoder->Decode, but it only works for struct fields that start with capital letters (aka public fields). Which poses a problem because the JSON I'm trying to consume looks like this:</p>\n\n<pre><code>{\n    \"_next\": \"someValue\",\n    \"data\":  [{/*a collection of objects*/}],\n    \"message\": \"success\"\n}\n</code></pre>\n\n<p>How the heck would I map <code>\"_next\"</code>?</p>\n"}, {"tags": ["go", "swagger", "swagger-ui"], "comments": [{"owner": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 1, "creation_date": 1490625798, "post_id": 43049122, "comment_id": 73183294, "body": "Like this <a href=\"https://github.com/yvasiyarov/swagger\" rel=\"nofollow noreferrer\">github.com/yvasiyarov/swagger</a>?"}, {"owner": {"reputation": 464, "user_id": 6135914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fnNc6.jpg?s=128&g=1", "display_name": "JT.", "link": "https://stackoverflow.com/users/6135914/jt"}, "reply_to_user": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1490625872, "post_id": 43049122, "comment_id": 73183347, "body": "@Helen I am shocked when I have been looking around I haven&#39;t ran across that.. That&#39;s perfect thank you!!"}, {"owner": {"reputation": 464, "user_id": 6135914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fnNc6.jpg?s=128&g=1", "display_name": "JT.", "link": "https://stackoverflow.com/users/6135914/jt"}, "reply_to_user": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1490626158, "post_id": 43049122, "comment_id": 73183556, "body": "@Helen it seemed to me that this was an option <a href=\"https://goswagger.io/generate/client.html\" rel=\"nofollow noreferrer\">goswagger.io/generate/client.html</a>. The docs just did not go much into depth about generating a client though."}, {"owner": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1490626366, "post_id": 43049122, "comment_id": 73183705, "body": "I used neither so I can&#39;t compare."}, {"owner": {"reputation": 464, "user_id": 6135914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fnNc6.jpg?s=128&g=1", "display_name": "JT.", "link": "https://stackoverflow.com/users/6135914/jt"}, "reply_to_user": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1490626398, "post_id": 43049122, "comment_id": 73183733, "body": "Thank you for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 3360, "user_id": 329463, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cc84f018e9d2d814cd7c1feffb6d624a?s=128&d=identicon&r=PG", "display_name": "vearutop", "link": "https://stackoverflow.com/users/329463/vearutop"}, "is_accepted": false, "score": 0, "last_activity_date": 1613212401, "creation_date": 1613212401, "answer_id": 66184116, "question_id": 43049122, "link": "https://stackoverflow.com/questions/43049122/integrating-swagger-with-existing-api/66184116#66184116", "title": "Integrating Swagger with existing API", "body": "<p>It can become possible once you have your HTTP service implementation compatible with a tool to collect documentation.</p>\n<p>For example you can add magic comments to your code and use <a href=\"https://goswagger.io/generate/spec.html\" rel=\"nofollow noreferrer\">https://goswagger.io/generate/spec.html</a>.</p>\n<p>Or alternatively you can refactor your http handlers and router setup to match conventions of <a href=\"https://github.com/swaggest/rest\" rel=\"nofollow noreferrer\">https://github.com/swaggest/rest</a> and have the spec reflected.</p>\n"}], "owner": {"reputation": 464, "user_id": 6135914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fnNc6.jpg?s=128&g=1", "display_name": "JT.", "link": "https://stackoverflow.com/users/6135914/jt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1613212401, "creation_date": 1490624798, "question_id": 43049122, "link": "https://stackoverflow.com/questions/43049122/integrating-swagger-with-existing-api", "title": "Integrating Swagger with existing API", "body": "<p>Is there a way to auto generate only the documentation and client UI to interact with an existing Go service I have already created?</p>\n\n<p>The only problem I have with auto generated code for the API service is because I have two types of supported transports (gRPC and http). I don't want to be confined to an auto generated Swagger server.</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1490621129, "post_id": 43047547, "comment_id": 73179450, "body": "operation2 would not compile since <code>index</code> is not declared. I assume you mean <code>for index, item := range original {</code>"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 4, "creation_date": 1490621423, "post_id": 43047547, "comment_id": 73179692, "body": "operation2 should is idiomatic, and should be the fasted. How many items does your <code>original</code> contain?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 2, "creation_date": 1490621453, "post_id": 43047547, "comment_id": 73179722, "body": "this is also a good read: <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">blog.golang.org/slices</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1490622361, "post_id": 43047547, "comment_id": 73180489, "body": "The first may even be more efficient at times because it&#39;s always allocating powers of two. In practice append amortizes so well it rarely matters, and I usually start from the first form since it doesn&#39;t allocate anything on a <code>nil</code> input and will return a <code>nil</code> slice."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 3, "creation_date": 1490623521, "post_id": 43047547, "comment_id": 73181464, "body": "you can reserve capacity in the first example by using <code>make([]string, 0, len(original))</code> and then use append. there really isn&#39;t much difference between the two. Both are perfectly fine."}, {"owner": {"reputation": 4671, "user_id": 4927751, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VwUAi.jpg?s=128&g=1", "display_name": "Kshitij Saraogi", "link": "https://stackoverflow.com/users/4927751/kshitij-saraogi"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1490623837, "post_id": 43047547, "comment_id": 73181704, "body": "@RickyA Yes, you are correct. Thanks for pointing out the typo. I have updated the question."}, {"owner": {"reputation": 4671, "user_id": 4927751, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VwUAi.jpg?s=128&g=1", "display_name": "Kshitij Saraogi", "link": "https://stackoverflow.com/users/4927751/kshitij-saraogi"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1490623876, "post_id": 43047547, "comment_id": 73181743, "body": "@RickyA I have made the comparison for sizes ranging from 2 to 10."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1490623967, "post_id": 43047547, "comment_id": 73181822, "body": "That is not enough to see a difference. If you keep in that range both methods are perfectly fine. The second one only gets faster with large slice sizes."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1490635111, "post_id": 43047547, "comment_id": 73189592, "body": "Not 100% related, but take a look at this article as well, it came in handy for me when I moved away from python. <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/SliceTricks</a>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1490675308, "post_id": 43047547, "comment_id": 73205496, "body": "A minor note: accessing a slice using indexing performs bounds checks at least for some accesses (that is, unless the compiler can prove otherwise) while accessing via <code>range</code> does not. Still, it&#39;s all micro optimizations. Don&#39;t think of them until required, then measure on realistic data."}], "owner": {"reputation": 4671, "user_id": 4927751, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VwUAi.jpg?s=128&g=1", "display_name": "Kshitij Saraogi", "link": "https://stackoverflow.com/users/4927751/kshitij-saraogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490623807, "creation_date": 1490620591, "last_edit_date": 1490623807, "question_id": 43047547, "link": "https://stackoverflow.com/questions/43047547/better-way-to-work-with-a-slice-in-go", "title": "Better way to work with a slice in go", "body": "<p>I have a conceptual question while working with <code>slice</code> in Go.</p>\n\n<p>Suppose, we want to write a function to perform an operation on a slice of strings and return the new slice.\nThe parameters for the above-said function are the original slice of strings and the operation to be performed on the items.</p>\n\n<p>Method-01: Declaring an empty slice and appending new values to it</p>\n\n<pre><code>func Operation1(original []string, converter func(string) string) []string { \n    var converted []string\n    for _, item := range original {\n        converted = append(converted, converter(item))\n    }\n    return converted\n}\n</code></pre>\n\n<p>Method-02: Allocating a definite-sized slice and indexing the values.</p>\n\n<pre><code>func Operation2(original []string, converter func(string) string) []string {\n     // since the operation on each item cannot lead to its deletion from the slice\n    converted := make([]string, len(original))\n\n    for index, item := range original {\n        converted[index] = converter(item)\n    }\n    return converted\n}\n</code></pre>\n\n<p>Q1. I would like to know which of the above functions/techniques for declaring and accessing elements of a slice is idiomatic in Go code.</p>\n\n<p>Q2. I tried both the functions on a bunch of tests and found that <code>Operation1</code> function performs slightly faster than <code>Operation2</code>. Any reasons behind this observation are welcomed.</p>\n\n<p>P.S: I am 3 days into learning Go and come from a Python background. I know it's off-topic, yet suggestions for helpful resources will be a plus.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 670, "user_id": 2267316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14ed5b8bc5c879e2c3742bbdc495ba5?s=128&d=identicon&r=PG", "display_name": "Paul I", "link": "https://stackoverflow.com/users/2267316/paul-i"}, "edited": false, "score": 0, "creation_date": 1490627871, "post_id": 43046036, "comment_id": 73184789, "body": "Appreciate the answer, unfortunately if I&#39;m reading it correctly, <code>net.Dialer</code> is defined as a struct and not an interface: <a href=\"https://golang.org/pkg/net/#Dialer\" rel=\"nofollow noreferrer\">golang.org/pkg/net/#Dialer</a> I also should mention that I have no control over object A, so I cannot modify it to say, use a new interface that could include Dialer&#39;s public methods, <code>Dial</code> and <code>DialContext</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 670, "user_id": 2267316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14ed5b8bc5c879e2c3742bbdc495ba5?s=128&d=identicon&r=PG", "display_name": "Paul I", "link": "https://stackoverflow.com/users/2267316/paul-i"}, "edited": false, "score": 2, "creation_date": 1490629346, "post_id": 43046036, "comment_id": 73185755, "body": "If you have no control over <code>A</code>, then you&#39;re right, you cannot assign the <code>Dialer</code> interface to it, and you cannot in Go assign anything else besides <code>net.Dialer</code> to a field of type <code>net.Dialer</code>... Next best thing is wrapping object <code>A</code> and doing whatever you need to do before calling <code>Dial</code>."}, {"owner": {"reputation": 670, "user_id": 2267316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14ed5b8bc5c879e2c3742bbdc495ba5?s=128&d=identicon&r=PG", "display_name": "Paul I", "link": "https://stackoverflow.com/users/2267316/paul-i"}, "edited": false, "score": 0, "creation_date": 1490633608, "post_id": 43046036, "comment_id": 73188654, "body": "Yes, I think you&#39;re right, wrapping A seems like my only option at the moment. Thanks for the feedback!"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 4, "last_activity_date": 1490619652, "last_edit_date": 1490619652, "creation_date": 1490616549, "answer_id": 43046036, "question_id": 43044224, "link": "https://stackoverflow.com/questions/43044224/extend-struct-in-go/43046036#43046036", "title": "Extend struct in Go", "body": "<p>You're getting the error because <code>customDialer</code> and <code>net.Dialer</code> are two different types and cannot be used interchangeably. Embedding in Go is not the same as class inheritance in other OO langauges so it won't help you with what you trying to do.</p>\n\n<p>What you can do instead in this case is to use Go interfaces which give you something like polymorphism/duck-typing, and since interfaces in Go are satified implicitly you can define a new interface that an existing type will implement by virtue of having a method with the same signature as the newly defined interface.</p>\n\n<pre><code>// already implemented by net.Dialer\ntype Dialer interface {\n    Dial(network, address string) (net.Conn, error)\n}\n\ntype customDialer struct {\n    *net.Dialer\n}\n\nfunc (cd *customDialer) Dial(network, address string) (net.Conn, error) {\n    conn, err := cd.Dialer.Dial(network, address)\n    if err != nil {\n        return nil, err\n    }\n    fmt.Printf(\"conn: %s\\n\", conn)\n    return conn, nil\n}\n\n// now the dialer field can be set to *customDialer and net.Dialer as well\ntype dialerConsumer struct {\n    dialer Dialer\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/i3Vpsh3wii\" rel=\"nofollow noreferrer\">https://play.golang.org/p/i3Vpsh3wii</a></p>\n"}], "owner": {"reputation": 670, "user_id": 2267316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14ed5b8bc5c879e2c3742bbdc495ba5?s=128&d=identicon&r=PG", "display_name": "Paul I", "link": "https://stackoverflow.com/users/2267316/paul-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13902, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1490619652, "creation_date": 1490611434, "question_id": 43044224, "link": "https://stackoverflow.com/questions/43044224/extend-struct-in-go", "title": "Extend struct in Go", "body": "<p>Suppose object A has a field of type <a href=\"https://golang.org/pkg/net/#Dialer\" rel=\"nofollow noreferrer\"><code>net.Dialer</code></a>. I'd like to provide object A with a custom implementation of <code>net.Dialer</code> that augments the <code>Dial</code> method. Is this doable in Go? I'm trying to use <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\"><em>embedded fields</em></a> like so:</p>\n\n<pre><code>package main\n\nimport (\n    \"net\"\n    \"fmt\"\n)\n\ntype dialerConsumer struct {\n    dialer net.Dialer\n}\n\nfunc (dc *dialerConsumer) use() error {\n    conn, e := dc.dialer.Dial(\"tcp\", \"golang.org:http\")\n    if e != nil {\n        return e\n    }\n\n    fmt.Printf(\"conn: %s\\n\", conn)\n    return nil\n}\n\ntype customDialer struct {\n    net.Dialer\n}\n\nfunc main() {\n    standardDialer := net.Dialer{}\n    consumer := &amp;dialerConsumer{\n        dialer: standardDialer,\n    }\n    consumer.use()\n\n\n    /*\n    customDialer := customDialer{\n        net.Dialer{},\n    }\n    consumer = &amp;dialerConsumer{\n        dialer: customDialer,\n    }\n    consumer.use()\n    */\n}\n</code></pre>\n\n<p>However, when I uncomment the commented-out code in <code>main</code>, I get the following compilation error:</p>\n\n<pre><code>src/test.go:38: cannot use customDialer (type customDialer) as type net.Dialer in field value\n</code></pre>\n"}, {"tags": ["go", "unicode"], "comments": [{"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1490618193, "post_id": 43044164, "comment_id": 73177308, "body": "It\u2019s unlikely given the lack of responses to this question: <a href=\"https://www.reddit.com/r/golang/comments/32bbqs/can_i_retrieve_the_name_and_other_properties_of_a/\" rel=\"nofollow noreferrer\">reddit.com/r/golang/comments/32bbqs/&hellip;</a> Also, I almost clicked Edit, but &quot;specail&quot; is their mistake."}, {"owner": {"reputation": 128, "user_id": 6280407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/338f3343f36eadd946cf688dd67b3b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan Neuhaus", "link": "https://stackoverflow.com/users/6280407/stephan-neuhaus"}, "reply_to_user": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1490618599, "post_id": 43044164, "comment_id": 73177617, "body": "Darn, I thought that would already exist, given that the opposite question is already answered. But yes, the link you gave shows pretty clearly that this problem has not been solved. Do you think that there would be general interest in such a package?"}, {"owner": {"reputation": 128, "user_id": 6280407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/338f3343f36eadd946cf688dd67b3b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan Neuhaus", "link": "https://stackoverflow.com/users/6280407/stephan-neuhaus"}, "reply_to_user": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1490618703, "post_id": 43044164, "comment_id": 73177687, "body": "And yes, &quot;specail&quot; is their mistake. I&#39;m always struggling: should I silently correct the mistake, add &quot;[sic!]&quot; or something similar, or leave it unedited?"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1490619634, "post_id": 43044164, "comment_id": 73178438, "body": "I wouldn\u2019t count on 1,000 stars on Github, but it would definitely be useful to some people out there. You could maybe get in touch with the Go Unicode library developers? (I tend to use [sic!] in this kind of situation, but that is by no means a rule.)"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 5, "last_activity_date": 1490631177, "last_edit_date": 1490631177, "creation_date": 1490630835, "answer_id": 43051337, "question_id": 43044164, "link": "https://stackoverflow.com/questions/43044164/go-how-to-find-out-a-runes-unicode-properties/43051337#43051337", "title": "Go: How to find out a rune&#39;s Unicode properties?", "body": "<p>The easiest and quickest solution is to write the function. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unicode\"\n)\n\nvar runeScript map[rune]string\n\nfunc init() {\n    const nChar = 128172 // Version 9.0.0\n    runeScript = make(map[rune]string, nChar*125/100)\n    for s, rt := range unicode.Scripts {\n        for _, r := range rt.R16 {\n            for i := r.Lo; i &lt;= r.Hi; i += r.Stride {\n                runeScript[rune(i)] = s\n            }\n        }\n        for _, r := range rt.R32 {\n            for i := r.Lo; i &lt;= r.Hi; i += r.Stride {\n                runeScript[rune(i)] = s\n            }\n        }\n    }\n}\n\nfunc script(r rune) string {\n    return runeScript[r]\n}\n\nfunc main() {\n    chars := []rune{' ', '0', 'a', '\u03b1', '\u0410', '\u3131'}\n    for _, c := range chars {\n        s := script(c)\n        fmt.Printf(\"%q %s\\n\", c, s)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run script.go\n' ' Common\n'0' Common\n'a' Latin\n'\u03b1' Greek\n'\u0410' Cyrillic\n'\u3131' Hangul\n$ \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1490656976, "last_edit_date": 1490656976, "creation_date": 1490655891, "answer_id": 43057871, "question_id": 43044164, "link": "https://stackoverflow.com/questions/43044164/go-how-to-find-out-a-runes-unicode-properties/43057871#43057871", "title": "Go: How to find out a rune&#39;s Unicode properties?", "body": "<h2>Improving PeterSO's answer</h2>\n\n<p>PeterSO's answer is nice and clear. It doesn't go easy on memory usage though, as it stores more than a hundred thousand entries in a map, values being of <code>string</code> type. Even though a <code>string</code> value is just a header storing a pointer and a length (see <a href=\"https://golang.org/pkg/reflect/#StringHeader\" rel=\"nofollow noreferrer\"><code>reflect.StringHeader</code></a>), having so many of them in a map is still multiple MB (like 6 MB)!</p>\n\n<p>Since the number of possible different <code>string</code> values (the different script names) is small (137), we may opt to use a value type <code>byte</code>, which will just be an index in a slice storing the real script names.</p>\n\n<p>This is how it could look like:</p>\n\n<pre><code>var runeScript map[rune]byte\n\nvar names = []string{\"\"}\n\nfunc init() {\n    const nChar = 128172 // Version 9.0.0\n    runeScript = make(map[rune]byte, nChar*125/100)\n    for s, rt := range unicode.Scripts {\n        idx := byte(len(names))\n        names = append(names, s)\n        for _, r := range rt.R16 {\n            for i := r.Lo; i &lt;= r.Hi; i += r.Stride {\n                runeScript[rune(i)] = idx\n            }\n        }\n        for _, r := range rt.R32 {\n            for i := r.Lo; i &lt;= r.Hi; i += r.Stride {\n                runeScript[rune(i)] = idx\n            }\n        }\n    }\n}\n\nfunc script(r rune) string {\n    return names[runeScript[r]]\n}\n\nfunc main() {\n    chars := []rune{' ', '0', 'a', '\u03b1', '\u0410', '\u3131'}\n    for _, c := range chars {\n        s := script(c)\n        fmt.Printf(\"%q %s\\n\", c, s)\n    }\n}\n</code></pre>\n\n<p>This simple improvement requires only one third of the memory compared to using <code>map[rune]string</code>. Output is the same (try it on the <a href=\"https://play.golang.org/p/mLZXdeIbjf\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>' ' Common\n'0' Common\n'a' Latin\n'\u03b1' Greek\n'\u0410' Cyrillic\n'\u3131' Hangul\n</code></pre>\n\n<h2>Building merged range slices</h2>\n\n<p>Using <code>map[rune]byte</code> will result in like 2 MB of RAM usage, and it takes \"some\" time to build this map, which may or may not be acceptable.</p>\n\n<p>There's another approach / solution. We may opt in to not build a map of \"all\" runes, but only store a slice of all ranges (actually 2 slices of ranges, one with 16-bit Unicode values, and another with 32-bit Unicode codepoints).</p>\n\n<p>The benefit of this originates from the fact that the number of ranges is much less than the number of runes: only 852 (compared to 100,000+ runes). Memory usage of 2 slices having a total of 852 elements will be negligible compared to solution #1.</p>\n\n<p>In our ranges we also store the script (name), so we can return this info. We could also store only a name index (as in solution #1), but since we only have 852 ranges, it's not worth it.</p>\n\n<p>We'll sort the range slices, so we can use binary search in it (~400 elements in a slice, binary search: we get the result in like 7 steps max, and worst case repeating binary search on both: 15 steps).</p>\n\n<p>Ok, so let's see. We're using these range wrappers:</p>\n\n<pre><code>type myR16 struct {\n    r16    unicode.Range16\n    script string\n}\n\ntype myR32 struct {\n    r32    unicode.Range32\n    script string\n}\n</code></pre>\n\n<p>And store them in:</p>\n\n<pre><code>var allR16 = []*myR16{}\nvar allR32 = []*myR32{}\n</code></pre>\n\n<p>We initialize / fill them like this:</p>\n\n<pre><code>func init() {\n    for script, rt := range unicode.Scripts {\n        for _, r16 := range rt.R16 {\n            allR16 = append(allR16, &amp;myR16{r16, script})\n        }\n        for _, r32 := range rt.R32 {\n            allR32 = append(allR32, &amp;myR32{r32, script})\n        }\n    }\n\n    // sort\n    sort.Slice(allR16, func(i int, j int) bool {\n        return allR16[i].r16.Lo &lt; allR16[j].r16.Lo\n    })\n    sort.Slice(allR32, func(i int, j int) bool {\n        return allR32[i].r32.Lo &lt; allR32[j].r32.Lo\n    })\n}\n</code></pre>\n\n<p>And finally the search in the sorted range slices:</p>\n\n<pre><code>func script(r rune) string {\n    // binary search over ranges\n    if r &lt;= 0xffff {\n        r16 := uint16(r)\n        i := sort.Search(len(allR16), func(i int) bool {\n            return allR16[i].r16.Hi &gt;= r16\n        })\n\n        if i &lt; len(allR16) &amp;&amp; allR16[i].r16.Lo &lt;= r16 &amp;&amp; r16 &lt;= allR16[i].r16.Hi {\n            return allR16[i].script\n        }\n    }\n\n    r32 := uint32(r)\n    i := sort.Search(len(allR32), func(i int) bool {\n        return allR32[i].r32.Hi &gt;= r32\n    })\n\n    if i &lt; len(allR32) &amp;&amp; allR32[i].r32.Lo &lt;= r32 &amp;&amp; r32 &lt;= allR32[i].r32.Hi {\n        return allR32[i].script\n    }\n\n    return \"\"\n}\n</code></pre>\n\n<p><em>Note: the <code>Stride</code> is always 1 in all scripts in the <code>unicode</code> package, which I took advantage of (and did not include it in the algorithm).</em></p>\n\n<p>Testing with the same code, we get the same output. Try it on the <a href=\"https://play.golang.org/p/2YY30dKH66\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 128, "user_id": 6280407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/338f3343f36eadd946cf688dd67b3b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan Neuhaus", "link": "https://stackoverflow.com/users/6280407/stephan-neuhaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1490656976, "creation_date": 1490611193, "last_edit_date": 1490631286, "question_id": 43044164, "link": "https://stackoverflow.com/questions/43044164/go-how-to-find-out-a-runes-unicode-properties", "title": "Go: How to find out a rune&#39;s Unicode properties?", "body": "<p>I want to find out a rune's Unicode properties, particularly the value of its script property. Unicode has this to say (in <a href=\"http://www.unicode.org/reports/tr24/\" rel=\"nofollow noreferrer\">http://www.unicode.org/reports/tr24/</a> Section 1.5):</p>\n\n<pre><code>The script property assigns a single value to each character, either\nexplicitly associating it with a particular script, or assigning one\nof several specail [sic] values.\n</code></pre>\n\n<p>Go's <code>unicode</code> package provides me with a way to ask, \"Is this rune in script x?\", but has no way for me to ask, \"In what script is this rune?\". I could obviously iterate over all scripts, but that would be wasteful. Is there a cleverer way to find out a rune's script? (I could always implement a self-organising list, but I'm looking for something in the standard go libraries that already does what I want, and that I have overlooked.)</p>\n\n<p>Thanks all!</p>\n"}, {"tags": ["go", "revel", "bunch"], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 1, "last_activity_date": 1490643090, "creation_date": 1490643090, "answer_id": 43054913, "question_id": 43043734, "link": "https://stackoverflow.com/questions/43043734/error-in-installing-revel-undefined-config-default-section/43054913#43054913", "title": "Error in installing revel: undefined: config.DEFAULT_SECTION", "body": "<p>Revel changed the CONFIG_DEFAULT variable name in <code>github.com/revel/config/config.go</code> a <a href=\"https://github.com/revel/config/commit/0f92ab2596a3f41d6b6dbb8c5f02054d626afd95#diff-b4bda758a2aef091432646c354b4dc59\" rel=\"nofollow noreferrer\">while ago</a></p>\n\n<p>You probably need to pin that repository at v0.13.0 also, presumably by adding this to your bunch file:</p>\n\n<p><code>github.com/revel/config v0.13.0</code></p>\n\n<p>You could also remove your pin of revel to v0.13.0 and get a more recent version.</p>\n"}], "owner": {"reputation": 795, "user_id": 1343961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cfdf749836ffbb6a2ea195402ada9ee?s=128&d=identicon&r=PG", "display_name": "archit gupta", "link": "https://stackoverflow.com/users/1343961/archit-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 43054913, "answer_count": 1, "score": 1, "last_activity_date": 1490643090, "creation_date": 1490609880, "question_id": 43043734, "link": "https://stackoverflow.com/questions/43043734/error-in-installing-revel-undefined-config-default-section", "title": "Error in installing revel: undefined: config.DEFAULT_SECTION", "body": "<p>I am installing revel using Bunch .\nI am getting below error:</p>\n\n<pre><code>installing github.com/revel/revel ... 2017/03/27 13:49:41 failed installing packages: failed building package github.com/revel/revel, error: # github.com/revel/revel\n./revel.go:180: undefined: config.DEFAULT_SECTION\n, output: %!s(MISSING): exit status 2 [exit status 2 github.com/dkulchenko/bunch/packages.go:234: failed building package github.com/revel/revel, error: # github.com/revel/revel\n./revel.go:180: undefined: config.DEFAULT_SECTION\n, output: %!s(MISSING) github.com/dkulchenko/bunch/packages.go:643: ]\n</code></pre>\n\n<p>Please help me with this and let me know how to resolve this problem.</p>\n\n<p>Below is how my BunchFile look:</p>\n\n<pre><code>github.com/dkulchenko/bunch !self\n\ngithub.com/robfig/config\ngithub.com/revel/revel v0.13.0\ngithub.com/revel/cmd/revel v0.13.0\ngithub.com/janekolszak/revmgo\ngithub.com/afex/hystrix-go/hystrix\ngithub.com/remind101/newrelic\n</code></pre>\n"}, {"tags": ["arrays", "json", "go", "marshalling"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490607329, "post_id": 43042422, "comment_id": 73169931, "body": "Well, <code>json.RawMessage</code> is exactly for what you want to do but you should really get your code straight: E.g. <code>getIt</code> is <b>not</b> valid JSON as it misses double quotes. Try json.RawMessage(<code>&quot;getIt&quot;</code>). And what do you think <code>json.RawMessage{200}</code> produces? Please read what json.RawMessage really is and then think what <code>json.RawMessage{200}</code> yields. Your code does not compile and if it would it would not produce the output you showed. Please fix your question."}, {"owner": {"reputation": 83, "user_id": 5292590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4836e028066241f79326cc253573bc?s=128&d=identicon&r=PG&f=1", "display_name": "SchCh", "link": "https://stackoverflow.com/users/5292590/schch"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490607981, "post_id": 43042422, "comment_id": 73170374, "body": "Mh.. This seems a bit strange. In JetBrains Gogland IDE the code compiles ans run without any errors. Whereas the same code fails at the Go Playground. So can I  use a raw message only for objects? Not for a single key/value pair?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490608391, "post_id": 43042422, "comment_id": 73170688, "body": "Of course you can use it for single values: <code>json.RawMessage([]byte(&quot;200&quot;))</code> or <code>json.RawMessage([]byte(&quot;true&quot;))</code>. Dead simple."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1490616387, "last_edit_date": 1490616387, "creation_date": 1490614363, "answer_id": 43045255, "question_id": 43042422, "link": "https://stackoverflow.com/questions/43042422/golang-generic-json-marshalling/43045255#43045255", "title": "Golang generic JSON marshalling", "body": "<p>The raw message must be valid JSON. </p>\n\n<p>Add quotes to the string to make it a valid JSON string.</p>\n\n<pre><code>serverResponse.Body[\"string\"] = json.RawMessage(\"\\\"getIt\\\"\")\n</code></pre>\n\n<p>JSON numbers are a sequence of decimal bytes. A number is not the value of a single byte as attempted in the question.</p>\n\n<pre><code>serverResponse.Body[\"integer\"] = json.RawMessage(\"200\")\n</code></pre>\n\n<p>This one works as you expected.</p>\n\n<pre><code>serverResponse.Body[\"array\"] = json.RawMessage(`[\"a\", \"b\", \"c\"]`)\n</code></pre>\n\n<p>The program in the question compiles and runs with errors. Examining those errors and fixing them leads to my suggestions above.</p>\n\n<p>An alternative approach is to replace the use of <code>json.RawMessage</code> with <code>interface{}</code>:</p>\n\n<pre><code>type ServerResponse struct {\n  Code int                    `json:\"code\" bson:\"code\"`\n  Type string                 `json:\"type\" bson:\"type\"`\n  Body map[string]interface{} `json:\"body\" bson:\"body\"`\n}\n</code></pre>\n\n<p>Set the response body like this:</p>\n\n<pre><code>serverResponse.Body[\"string\"] = \"getIt\"\nserverResponse.Body[\"integer\"] = 200\nserverResponse.Body[\"array\"] = []string{\"a\", \"b\", \"c\"}\n</code></pre>\n\n<p>You can use json.RawMessage values:</p>\n\n<pre><code>serverResponse.Body[\"array\"] = json.RawMessage(`[\"a\", \"b\", \"c\"]`)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Dpux6WFdB_\" rel=\"nofollow noreferrer\">Playground example</a></p>\n"}], "owner": {"reputation": 83, "user_id": 5292590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4836e028066241f79326cc253573bc?s=128&d=identicon&r=PG&f=1", "display_name": "SchCh", "link": "https://stackoverflow.com/users/5292590/schch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1942, "favorite_count": 0, "accepted_answer_id": 43045255, "answer_count": 1, "score": 0, "last_activity_date": 1490616387, "creation_date": 1490606267, "question_id": 43042422, "link": "https://stackoverflow.com/questions/43042422/golang-generic-json-marshalling", "title": "Golang generic JSON marshalling", "body": "<p>I'm working on s small server-client project based on JSON communication. But i run into issues. I'm trying to create a response struct with a generic message body. This means I have an map with a key as string and a json raw message as value. In the end the message body should work for any type (strings, integers, arrays)</p>\n\n<pre><code>package main\n\nimport (\n   \"encoding/json\"\n   \"fmt\"\n)\n\ntype ServerResponse struct {\n    Code int                    `json:\"code\" bson:\"code\"`\n    Type string                 `json:\"type\" bson:\"type\"`\n    Body map[string]json.RawMessage `json:\"body\" bson:\"body\"`\n}\n\nfunc NewServerResponse() *ServerResponse {\n    return &amp;ServerResponse{Body: make(map[string]json.RawMessage)}\n}\n\n\n\n\n\nfunc main(){\n    serverResponse := NewServerResponse()\n    serverResponse.Code = 100\n    serverResponse.Type = \"molly\"\n\n    serverResponse.Body[\"string\"] = json.RawMessage(\"getIt\")\n    serverResponse.Body[\"integer\"] = json.RawMessage{200}\n    serverResponse.Body[\"array\"] = json.RawMessage(`[\"a\", \"b\", \"c\"]`)\n\n\n    if d, err  := json.Marshal(&amp;serverResponse); err != nil{\n        fmt.Println(\"Error \" + err.Error())\n    }else{\n        fmt.Println(string(d))\n   }\n}\n</code></pre>\n\n<p>But the output is as follow.</p>\n\n<pre><code>{\n  \"code\":100,\n  \"type\":\"molly\",\n  \"body\":  {\n            \"array\":\"WyJhIiwgImIiLCAiYyJd\",\n            \"integer\":\"yA==\",\n            \"string\":\"Z2V0SXQ=\"\n           }\n}\n</code></pre>\n\n<p>It seems like the values are Base64 encoded and inside double quotes. Tihs should be the expected output</p>\n\n<pre><code>{\n  \"code\":100,\n  \"type\":\"molly\",\n  \"body\":  {\n            \"array\":[\"a\", \"b\", \"c\"],\n            \"integer\":200,\n            \"string\":\"getIt\"\n           }\n}\n</code></pre>\n\n<p>Is this even possible? Or do I have to write a specific struct type for every response?</p>\n"}, {"tags": ["go", "tfs", "tfsbuild"], "comments": [{"owner": {"reputation": 44433, "user_id": 5391065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b615692abd82961458da80dd640f3300?s=128&d=identicon&r=PG&f=1", "display_name": "PatrickLu-MSFT", "link": "https://stackoverflow.com/users/5391065/patricklu-msft"}, "edited": false, "score": 0, "creation_date": 1490695219, "post_id": 43040945, "comment_id": 73216427, "body": "How to define build, test, and deploy steps? Could you explain more clearly? And which test are you using? If you just want to show the test results in the team&#39;s web site? Take a  look at the dashboard, did this meet your needs\uff1f <a href=\"https://www.visualstudio.com/en-us/docs/report/overview\" rel=\"nofollow noreferrer\">visualstudio.com/en-us/docs/report/overview</a>"}, {"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "reply_to_user": {"reputation": 44433, "user_id": 5391065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b615692abd82961458da80dd640f3300?s=128&d=identicon&r=PG&f=1", "display_name": "PatrickLu-MSFT", "link": "https://stackoverflow.com/users/5391065/patricklu-msft"}, "edited": false, "score": 0, "creation_date": 1490762820, "post_id": 43040945, "comment_id": 73251547, "body": "@Patrick-MSFT:I mean how should I setup tfs to build my app and run my Unit/Integration tests and then how can I see the test results / successful or failed builds ...."}, {"owner": {"reputation": 28250, "user_id": 5475003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed59b990fdc2c28e25f954d1578ce70?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Chen - MSFT", "link": "https://stackoverflow.com/users/5475003/eddie-chen-msft"}, "edited": false, "score": 0, "creation_date": 1490772636, "post_id": 43040945, "comment_id": 73256160, "body": "How do you build and run the test on your local machine?"}, {"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "reply_to_user": {"reputation": 28250, "user_id": 5475003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed59b990fdc2c28e25f954d1578ce70?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Chen - MSFT", "link": "https://stackoverflow.com/users/5475003/eddie-chen-msft"}, "edited": false, "score": 0, "creation_date": 1490773010, "post_id": 43040945, "comment_id": 73256380, "body": "@Eddie: I use command line."}, {"owner": {"reputation": 28250, "user_id": 5475003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed59b990fdc2c28e25f954d1578ce70?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Chen - MSFT", "link": "https://stackoverflow.com/users/5475003/eddie-chen-msft"}, "edited": false, "score": 0, "creation_date": 1490773128, "post_id": 43040945, "comment_id": 73256460, "body": "What&#39;s the TFS version you use? TFS2015?"}, {"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "reply_to_user": {"reputation": 28250, "user_id": 5475003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed59b990fdc2c28e25f954d1578ce70?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Chen - MSFT", "link": "https://stackoverflow.com/users/5475003/eddie-chen-msft"}, "edited": false, "score": 0, "creation_date": 1490777772, "post_id": 43040945, "comment_id": 73259326, "body": "@Eddie: 2017 Update 1 x64"}], "answers": [{"comments": [{"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "edited": false, "score": 0, "creation_date": 1490778778, "post_id": 43089018, "comment_id": 73260041, "body": "Thank you I&#39;m trying it,but It&#39;s a pain in the neck to install all dependencies via a batch file. sometimes I might need to copy some dependencies from my local machine.Can I build the source and run tests in a docker file and publish the results !!??Or is there a more convenient tool for doing it?"}, {"owner": {"reputation": 28250, "user_id": 5475003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed59b990fdc2c28e25f954d1578ce70?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Chen - MSFT", "link": "https://stackoverflow.com/users/5475003/eddie-chen-msft"}, "reply_to_user": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "edited": false, "score": 0, "creation_date": 1490779211, "post_id": 43089018, "comment_id": 73260322, "body": "@Mohsen You can try with this extension: <a href=\"https://marketplace.visualstudio.com/items?itemName=ms-vscs-rm.docker\" rel=\"nofollow noreferrer\">marketplace.visualstudio.com/items?itemName=ms-vscs-rm.docke&zwnj;&#8203;r</a>"}], "tags": [], "owner": {"reputation": 28250, "user_id": 5475003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed59b990fdc2c28e25f954d1578ce70?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Chen - MSFT", "link": "https://stackoverflow.com/users/5475003/eddie-chen-msft"}, "is_accepted": true, "score": 1, "last_activity_date": 1490778232, "creation_date": 1490778232, "answer_id": 43089018, "question_id": 43040945, "link": "https://stackoverflow.com/questions/43040945/tfs-and-golang-continuous-integration/43089018#43089018", "title": "TFS and golang continuous Integration", "body": "<p>You can use the vNext build system in TFS2017 and add Command Line task in the build definition to run the build and test just like what you do on local machine:\n<a href=\"https://i.stack.imgur.com/khcst.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/khcst.png\" alt=\"enter image description here\"></a>\nAnd then add a \"Publish Test Result\" task to publish the test result to TFS so that you can check the test result from the TFS Website. A limitation is that \"Publish Test Result\" task only support four Test Result Format for now: JUnit, NUnit, VSTest and XUnit.</p>\n"}], "owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 687, "favorite_count": 3, "accepted_answer_id": 43089018, "answer_count": 1, "score": 3, "last_activity_date": 1490778232, "creation_date": 1490601834, "question_id": 43040945, "link": "https://stackoverflow.com/questions/43040945/tfs-and-golang-continuous-integration", "title": "TFS and golang continuous Integration", "body": "<p>I'm tracking the files of my <code>golang app</code> in a local <code>TFS server</code> integrated with <code>git</code>. I want to define <code>build</code>, <code>test</code>, and <code>deploy</code> steps but I can't find any tool for that.</p>\n\n<p>How can I define a <code>build</code> and <code>test</code> step for the project that shows the <code>test results</code> in the <code>Team's web site</code>? thank you.</p>\n"}, {"tags": ["docker", "go", "docker-compose"], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 1, "last_activity_date": 1490601198, "creation_date": 1490601198, "answer_id": 43040753, "question_id": 43039501, "link": "https://stackoverflow.com/questions/43039501/connection-refused-when-trying-to-connect-redis-using-docker-compose-file/43040753#43040753", "title": "connection refused when trying to connect redis using docker compose file", "body": "<p>There are several things to be aware of when using depends_on:</p>\n\n<ul>\n<li>depends_on will not wait for db and redis to be \u201cready\u201d before starting web - only until they have been started. If you need to wait for a service to be ready, see <a href=\"https://docs.docker.com/compose/startup-order/\" rel=\"nofollow noreferrer\">Controlling startup order</a> for more on this problem and strategies for solving it.\n\n<ul>\n<li>Version 3 no longer supports the condition form of depends_on.</li>\n</ul></li>\n<li>The depends_on option is ignored when <a href=\"https://docs.docker.com/engine/reference/commandline/stack_deploy/\" rel=\"nofollow noreferrer\">deploying a stack in swarm mode</a> with a version 3 Compose file.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": true, "score": 0, "last_activity_date": 1490606603, "creation_date": 1490606603, "answer_id": 43042558, "question_id": 43039501, "link": "https://stackoverflow.com/questions/43039501/connection-refused-when-trying-to-connect-redis-using-docker-compose-file/43042558#43042558", "title": "connection refused when trying to connect redis using docker compose file", "body": "<p>This is stupid I wrote the <code>depends_on</code> not in order I fix the issue writing the order like this : </p>\n\n<pre><code>depends_on:\n  - redis\n  - db\n</code></pre>\n\n<p>Before this I wrote it <code>db</code>first. and do not forget to change the host to appropriate name just like in the docker-compose.yml file. In this case is redis = <code>redis</code> and mongodb = <code>db</code>.</p>\n\n<p>I forget that in app.go I call redis first then mongodb.</p>\n"}], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1578, "favorite_count": 0, "accepted_answer_id": 43042558, "answer_count": 2, "score": 1, "last_activity_date": 1490606603, "creation_date": 1490596970, "question_id": 43039501, "link": "https://stackoverflow.com/questions/43039501/connection-refused-when-trying-to-connect-redis-using-docker-compose-file", "title": "connection refused when trying to connect redis using docker compose file", "body": "<p>I have a problem trying to connect to redis using <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow noreferrer\">redis-golang</a> driver.\nthis is my <code>docker-compose.yml</code> file : </p>\n\n<pre><code>version: \"3\"\n\nservices:\n  driver:\n    build: ./API-Golang\n    command: go run app.go\n    volumes:\n     - ./API-Golang:/app\n    ports:\n      - \"8080:8080\"\n    depends_on:\n      - db\n      - redis\n    links :\n      - redis\n      - db\n  redis:\n    image: redis\n    container_name: redis\n    ports: [\"6379:6379\"]\n  db:\n    image: mongo:3.4.2\n    container_name: mongodb\n    ports : [\"27017:27017\"]\n</code></pre>\n\n<p>and this the code where I try to connect to redis (API-Golang/database/allSystem.go):</p>\n\n<pre><code>redisConn := RedisHost{\n    Address:  \"localhost:6379\",\n    Password: \"\",\n    DB:       0,\n}\n\nredisConnection, err := redisConn.Connect()\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>I have tried to change <code>localhost</code> to <code>redis</code> for the host but still it doesn't work. Here is the error :</p>\n\n<pre><code>driver_1  | panic: dial tcp [::1]:6379: getsockopt: connection refused\ndriver_1  | \ndriver_1  | goroutine 1 [running]:\ndriver_1  | github.com/Gujarats/API-Golang/database.SystemConnection(0x48)\ndriver_1  |     /go/src/github.com/Gujarats/API-Golang/database/allSystem.go:32 +0x3d3\ndriver_1  | main.main()\ndriver_1  |     /go/src/github.com/Gujarats/API-Golang/app.go:24 +0x34\ndriver_1  | exit status 2\n</code></pre>\n\n<p>Any idea what's wrong?</p>\n\n<p><a href=\"https://github.com/Gujarats/Go-docker\" rel=\"nofollow noreferrer\">Source Code</a></p>\n"}, {"tags": ["rest", "go", "go-restful"], "answers": [{"tags": [], "owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "is_accepted": true, "score": 0, "last_activity_date": 1491561488, "last_edit_date": 1491561488, "creation_date": 1490595797, "answer_id": 43039209, "question_id": 43039131, "link": "https://stackoverflow.com/questions/43039131/how-to-bind-a-handler-in-go-restful/43039209#43039209", "title": "How to bind a handler in go-restful?", "body": "<p>Passing <code>nil</code> as a handler is a common practice in Go. As the <a href=\"https://golang.org/pkg/net/http/#ListenAndServe\" rel=\"nofollow noreferrer\">specs say</a>,</p>\n\n<blockquote>\n  <p>Handler is typically nil, in which case the DefaultServeMux is used.</p>\n</blockquote>\n\n<p><code>DefaultServeMux</code> is just a convenience global variable in <code>http</code>. So, go-restful just <a href=\"https://github.com/emicklei/go-restful/blob/7dd77babc0fbac18c02f6968b4dcf69e9c43bc73/web_service_container.go#L16\" rel=\"nofollow noreferrer\">uses it</a> by default.</p>\n"}], "owner": {"reputation": 203, "user_id": 7572938, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cfc24822ee199aa06fc0a6ee43159579?s=128&d=identicon&r=PG&f=1", "display_name": "fisafoer", "link": "https://stackoverflow.com/users/7572938/fisafoer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 43039209, "answer_count": 1, "score": 0, "last_activity_date": 1491561488, "creation_date": 1490595429, "last_edit_date": 1490610282, "question_id": 43039131, "link": "https://stackoverflow.com/questions/43039131/how-to-bind-a-handler-in-go-restful", "title": "How to bind a handler in go-restful?", "body": "<p>Go-restful is a good and easy to use Go RESTful style framework, but here is something i am wondering about (this is just a piece of code):</p>\n\n<hr>\n\n<pre><code>func main() {\n    service := new(restful.WebService)\n\n    service.Route(\n    service.GET(\"/{user-id}\").To(FindUser).\n    Returns(200, \"hello\", noMessageValue).\n    Returns(500, \"internal error\", noMessageValue))\n    restful.Add(service)\n    http.ListenAndServe(\":8080\", nil)\n} \n</code></pre>\n\n<p>This code can work well. Notice the last line <code>http.ListenAndServe(\":8080\", nil)</code>, it does not pass any handler to the ListenAndServe method (it passes a nil value instead), just the port string. Does anyone know how go-restful implements handler binding ?</p>\n"}, {"tags": ["postgresql", "go", "pq"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1490594489, "post_id": 43038711, "comment_id": 73162718, "body": "Which Postgres driver you&#39;re using?"}, {"owner": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1490595490, "post_id": 43038711, "comment_id": 73163114, "body": "@ain, &quot;github.com/lib/pq&quot;"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490620188, "post_id": 43038711, "comment_id": 73178800, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, we can&#39;t guess what you&#39;re doing."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1490630243, "post_id": 43038711, "comment_id": 73186387, "body": "the WithTimeout starts the clock at that point.  It does NOT give each query 10s.  You mentioned that each query is 50ms, but do all of them combined take more than 10s from when your controller kicks in?"}, {"owner": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1490630556, "post_id": 43038711, "comment_id": 73186634, "body": "@DavidBudworth, I added almost full code of my controller. I think that when new request comes, it creates different context."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1490630799, "post_id": 43038711, "comment_id": 73186818, "body": "This is basically your handler function? context gets created there?   ultimately, it kinda depends on what <code>model.GetProductByBarcode(ctx, request)</code> does with it.  by any chance is it holding on the ctx for some reason?"}, {"owner": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "edited": false, "score": 0, "creation_date": 1490630913, "post_id": 43038711, "comment_id": 73186890, "body": "This function makes several database requests and I use context in order to pass it to each database query like ExecContex, QueryContext and so on."}], "owner": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1061, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490630414, "creation_date": 1490593475, "last_edit_date": 1490630414, "question_id": 43038711, "link": "https://stackoverflow.com/questions/43038711/go-1-8-context-timeout-with-postgresql", "title": "Go 1.8 context timeout with Postgresql", "body": "<p>In the beginning of my controller I create a context with a timeout like this:</p>\n\n<pre><code>ctx, cancel := context.WithTimeout(context.Background(), time.Second * 10)\ndefer cancel()\n</code></pre>\n\n<p>And then I use this context in each database request like this:</p>\n\n<pre><code>QueryRowContext(ctx, query, ...args) // where ctx is context\n</code></pre>\n\n<p>However, when I load my test program, I notice that some of my requests return error <code>\"pq: canceling statement due to user request\"</code>. And the more requests I make, the more errors I get. </p>\n\n<p>But, if I don't use context with timeout, but rather use just <code>context.Background()</code>, I get no errors regardless of the amount of requests. </p>\n\n<p>Each request takes about 50ms, so timeout cannot occur. I tried context with cancel <code>context.WithCancel(context.Background())</code> and I also get these errors.</p>\n\n<p>What may be a reason that these errors occur?  </p>\n\n<pre><code>// create context to cancel working if 10 seconds passed\nctx, cancel := context.WithTimeout(context.Background(), time.Second * 10)\ndefer cancel()\n\n\n// parses queries\nvar response []byte\nrequest := model.GetProductByBarcodeRequest{}\nbarcode := r.URL.Query().Get(\"barcode\")\nstoreID := r.URL.Query().Get(\"store_id\")\ntransactionType := r.URL.Query().Get(\"type\")\n\n\nrequest.Barcode = &amp;barcode\nrequest.StoreID = &amp;storeID\nrequest.Type = &amp;transactionType\n\n// processing\nresult, err := model.GetProductByBarcode(ctx, request)\nresponse = controller.ToJson(result, err)\n\n// writing response to user\nw.Write(response)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490590279, "post_id": 43037933, "comment_id": 73161416, "body": "1. Lack of support for the, 2. Yes, 3. No."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1820956"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1492928823, "post_id": 43037933, "comment_id": 74186331, "body": "What I missed when asking this question was that specific versions of these two Linux distributions were not supported. My question was based on the incorrect interpretation that these two platforms are unsupported. Well, I will still leave this question here because others who also fall into this wrong interpretation like I did, may find it helpful to get the clarification."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1490589097, "creation_date": 1490589097, "answer_id": 43037994, "question_id": 43037933, "link": "https://stackoverflow.com/questions/43037933/golang-unsupported-platforms/43037994#43037994", "title": "Golang unsupported platforms", "body": "<p>These versions of Linux do not provide facilities used by the Go runtime.  See <a href=\"https://dave.cheney.net/2013/06/18/how-to-install-go-1-1-on-centos-5\" rel=\"nofollow noreferrer\">https://dave.cheney.net/2013/06/18/how-to-install-go-1-1-on-centos-5</a> for details.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1820956"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 43037994, "answer_count": 1, "score": -2, "last_activity_date": 1490589097, "creation_date": 1490588729, "question_id": 43037933, "link": "https://stackoverflow.com/questions/43037933/golang-unsupported-platforms", "title": "Golang unsupported platforms", "body": "<p>Golang's installation guide found at <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">https://golang.org/doc/install</a> has a section titled \"System requirements.\" In this section, one of the supported operating systems is \"Linux 2.6.23 or later with glibc\" but it includes the following note:</p>\n\n<blockquote>\n  <p>CentOS/RHEL 5.x not supported</p>\n</blockquote>\n\n<p>This raises the following questions:</p>\n\n<ol>\n<li>Why are these Linux distributions not supported? </li>\n<li>Does this prevent users of these systems from using systems or software developed in Go? </li>\n<li>Does this prevent users of these systems from developing software using Go?</li>\n</ol>\n"}, {"tags": ["file", "go", "watch", "inotify"], "answers": [{"tags": [], "owner": {"reputation": 4286, "user_id": 475536, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbc0cdb2a23ba3c7f68b51c075b70a5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/475536/alex"}, "is_accepted": true, "score": 0, "last_activity_date": 1490580490, "creation_date": 1490580490, "answer_id": 43036870, "question_id": 43036659, "link": "https://stackoverflow.com/questions/43036659/fsnotify-add-watch-directories-while-running/43036870#43036870", "title": "FSNotify add watch directories while running", "body": "<p>It was working just fine, but I got some variables wrong. Should have been <code>watcher.Add(event.Name)</code> instead of <code>watcher.Add(dest)</code>.</p>\n"}], "owner": {"reputation": 4286, "user_id": 475536, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbc0cdb2a23ba3c7f68b51c075b70a5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/475536/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 1, "accepted_answer_id": 43036870, "answer_count": 1, "score": 0, "last_activity_date": 1490580490, "creation_date": 1490578887, "question_id": 43036659, "link": "https://stackoverflow.com/questions/43036659/fsnotify-add-watch-directories-while-running", "title": "FSNotify add watch directories while running", "body": "<p>I don't really know how to formulate the question, but here it is. </p>\n\n<p>I'm using fsnotify to watch some directories for changes and when a file changes, I sync the change to another directory. But I want to add newly created directories to the watch too and it's not really working.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>func Watcher() {\n    watcher, err := fsnotify.NewWatcher()\n    defer watcher.Close()\n\n    done := make(chan bool)\n    go func() {\n        for {\n            select {\n            case event := &lt;-watcher.Events:\n\n                    if file.Mode().IsDir() {\n                    err = os.Mkdir(dest, 0755)\n                    err = watcher.Add(dest)\n\n            }\n        case err := &lt;-watcher.Errors:\n            log.Println(\"error:\", err)\n        }\n    }\n    }()\n\n    dirs, err := readLines(\"dirs\")\n    for _, el := range dirs {\n        err = watcher.Add(el)\n    }\n    check(err)\n    &lt;-done\n}\n</code></pre>\n\n<p>The function is much longer, but I've deleted the non-important parts. Everything works, except the <code>err = watcher.Add(dest)</code>.</p>\n\n<p>How can I make it watch more directories?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1490595033, "post_id": 43036010, "comment_id": 73162913, "body": "Example how it can be done is in this answer: <a href=\"http://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">What are the use(s) for tags in Go?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 2, "last_activity_date": 1490574215, "last_edit_date": 1495542326, "creation_date": 1490574094, "answer_id": 43036144, "question_id": 43036010, "link": "https://stackoverflow.com/questions/43036010/retrieve-annotations-on-structs-variables-using-reflection/43036144#43036144", "title": "Retrieve annotations on structs&#39; variables using reflection", "body": "<p>It is available as <code>StructField.Tag</code>, so</p>\n\n<pre><code>f.Tag\n</code></pre>\n\n<p>References:</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/reflect/#StructField\" rel=\"nofollow noreferrer\">reflect.StructField</a></li>\n<li><a href=\"https://golang.org/pkg/reflect/#StructTag\" rel=\"nofollow noreferrer\">reflect.StructTag</a></li>\n</ul>\n\n<p>A working example, credits <a href=\"https://stackoverflow.com/users/965900/mkopriva\">@mkopriva</a>: <a href=\"https://play.golang.org/p/reY-IDCyaq\" rel=\"nofollow noreferrer\">https://play.golang.org/p/reY-IDCyaq</a></p>\n"}], "owner": {"reputation": 2005, "user_id": 1871890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4359cdd9f14bbbe17c56f2fb2d2de25d?s=128&d=identicon&r=PG", "display_name": "Mathieu Nls", "link": "https://stackoverflow.com/users/1871890/mathieu-nls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 43036144, "answer_count": 1, "score": 0, "last_activity_date": 1490574215, "creation_date": 1490572707, "question_id": 43036010, "link": "https://stackoverflow.com/questions/43036010/retrieve-annotations-on-structs-variables-using-reflection", "title": "Retrieve annotations on structs&#39; variables using reflection", "body": "<p>In go, is it possible to retrieve structs' variable annotation? Considering the following struct:</p>\n\n<pre><code>type AType struct {\n    ID        string    `xml:\"my_id\"`\n    Date      string    `xml:\"creation_ts\"`\n}\n</code></pre>\n\n<p>How can I retrieve the <code>xml:\"my_id\"</code> part for the ID field using reflection ? The following will print the name, type and value of the variable but not the <em>annotation</em>.</p>\n\n<pre><code>s := reflect.ValueOf(&amp;aType).Elem()\ntypeOfT := s.Type()\nfor i := 0; i &lt; s.NumField(); i++ {\n    s.Field(i).\n    f := s.Field(i)\n    fmt.Printf(\"%d: %s %s = %v\\n\", i,\n        typeOfT.Field(i).Name, f.Type(), f.Interface())\n}\n</code></pre>\n\n<p>Thanks,</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1490567368, "post_id": 43035331, "comment_id": 73155931, "body": "Check the <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">contexts</a>. One of their aims is to provide a cancellation primitive."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490569165, "post_id": 43035331, "comment_id": 73156375, "body": "Ah sweet thanks, I&#39;ll look into that."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1490574888, "post_id": 43035331, "comment_id": 73157656, "body": "Can you add to the for loop something like <code>for startTime.Sub(time.Now()).Seconds() &gt; 60 {}</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": false, "score": 2, "last_activity_date": 1490585449, "creation_date": 1490585449, "answer_id": 43037517, "question_id": 43035331, "link": "https://stackoverflow.com/questions/43035331/how-to-cancel-goroutines-after-certain-amount-of-time/43037517#43037517", "title": "How to cancel goroutines after certain amount of time", "body": "<p>use package <code>golang.org/x/net/context</code>. Go 1.7 moves the <code>golang.org/x/net/context</code> package into the standard library as <code>context</code>.\nSo just <code>import context</code> if you use version 1.7+.</p>\n\n<p>the usage is straightforward:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"time\"\n)\n\nfunc test(ctx context.Context) {\n    t := time.Now()\n\n    select {\n    case &lt;-time.After(1 * time.Second):\n        fmt.Println(\"overslept\")\n    case &lt;-ctx.Done():\n    }\n    fmt.Println(\"used:\", time.Since(t))\n}\n\nfunc main() {\n    ctx, _ := context.WithTimeout(context.Background(), 50*time.Millisecond)\n    test(ctx)\n}\n</code></pre>\n"}], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 866, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1490585449, "creation_date": 1490567196, "last_edit_date": 1490567560, "question_id": 43035331, "link": "https://stackoverflow.com/questions/43035331/how-to-cancel-goroutines-after-certain-amount-of-time", "title": "How to cancel goroutines after certain amount of time", "body": "<p>I am making a load testing tool that makes multiple HTTP calls in goroutines, and it works, but now I am trying to allow it to run for only a specified duration.</p>\n\n<p>How can I cancel the goroutines when the sleep has finished?</p>\n\n<p>What I am currently attempting to do is to make a goroutine that does <code>time.Sleep()</code> for the specified duration, and when that is finished it will broadcast a message to the channel.</p>\n\n<p>In my infinite loop, I listen for the message in the switch statement, and when it is there I return. This works just as I want it to.</p>\n\n<p>The problem is, the goroutines from the <code>go httpPost()</code> line will continue making HTTP calls. I even attempt to pass the channel into that function and listen for the same <code>CALL_TIME_RAN_OUT</code> message there as well, but for whatever reason when I do that the goroutines only run once and then immediately return, as opposed to waiting for the message to be broadcasted by the end of the <code>Sleep</code>.</p>\n\n<p>Does anyone know a better approach I can take? This doesn't seem to be working.</p>\n\n<p>Here's the code (removed irrelevant parts):</p>\n\n<pre><code>func attack(cfg AttackConfig) {\n    // some code ...\n\n    var ar attackResponse\n    ch := make(chan uint8, 8)\n\n    go func() {\n        time.Sleep(cfg.Duration * time.Second)\n        ch &lt;- CALL_TIME_RAN_OUT\n    }()\n\n    for {\n        if atomic.LoadInt32(&amp;currConnections) &lt; atomic.LoadInt32(&amp;maxConnections) - 1 {\n            go httpPost(cfg, &amp;ar, ch)\n        }\n\n        switch &lt;-ch {\n        // some other cases ...\n        case CALL_TIME_RAN_OUT:\n            fmt.Printf(\"%d seconds have elapsed. Shutting down!\", cfg.Duration)\n            return\n        }\n    }\n}\n\nfunc httpPost(cfg AttackConfig, a *attackResponse, ch chan uint8) {\n    // some code here to create HTTP client ...\n\n    for {\n        // some code to make HTTP call ...\n\n        switch &lt;-ch {\n        case CALL_TIME_RAN_OUT:\n            return\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["file", "go", "io", "copy", "sparse-file"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1490588315, "post_id": 43035271, "comment_id": 73160868, "body": "No, at least not an easy one. Spares files are something which depends on the filesystem used and ad hoc you have no idea whether your sink supports sparse files."}], "answers": [{"comments": [{"owner": {"reputation": 4286, "user_id": 475536, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbc0cdb2a23ba3c7f68b51c075b70a5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/475536/alex"}, "edited": false, "score": 0, "creation_date": 1490618380, "post_id": 43040498, "comment_id": 73177465, "body": "I didn&#39;t expect such a comprehensive answer. Thanks a lot!"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 6, "last_activity_date": 1490603670, "last_edit_date": 1490603670, "creation_date": 1490600375, "answer_id": 43040498, "question_id": 43035271, "link": "https://stackoverflow.com/questions/43035271/sparse-files-are-huge-with-io-copy/43040498#43040498", "title": "Sparse files are huge with io.Copy()", "body": "<h3>Some background theory</h3>\n\n<p>Note that <code>io.Copy()</code> pipes raw bytes &ndash; which is sort of understandable once you consider that it pipes data from an <code>io.Reader</code> to an <code>io.Writer</code> which provide <code>Read([]byte)</code> and <code>Write([]byte)</code>, correspondingly.\nAs such, <code>io.Copy()</code> is able to deal with absolutely any source providing\nbytes and absolutely any sink consuming them.</p>\n\n<p>On the other hand, the location of the holes in a file is a \"side-channel\" information which \"classic\" syscalls such as <code>read(2)</code> hide from their users.\n<code>io.Copy()</code> is not able to convey such side-channel information in any way.</p>\n\n<p>IOW, initially, file sparseness was an idea to just have efficient storage of the data behind the user's back.</p>\n\n<p>So, no, there's no way <code>io.Copy()</code> could deal with sparse files in itself.</p>\n\n<h3>What to do about it</h3>\n\n<p>You'd need to go one level deeper and implement all this using the <code>syscall</code> package and some manual tinkering.</p>\n\n<p>To work with holes, you should use the <code>SEEK_HOLE</code> and <code>SEEK_DATA</code> special values for the <code>lseek(2)</code> syscall which are, while formally non-standard, are supported by <a href=\"https://manpages.debian.org/jump?q=lseek.2\" rel=\"noreferrer\">all</a> <a href=\"https://www.freebsd.org/cgi/man.cgi?query=lseek&amp;sektion=2\" rel=\"noreferrer\">major</a> <a href=\"https://docs.oracle.com/cd/E26502_01/html/E29032/lseek-2.html\" rel=\"noreferrer\">platforms</a>.</p>\n\n<p>Unfortunately, the support for those \"whence\" positions is not present\nneither in the stock <code>syscall</code> package (as of Go 1.8.1)\nnor in the <a href=\"https://github.com/golang/sys/\" rel=\"noreferrer\"><code>golang.org/x/sys</code></a> tree.</p>\n\n<p>But fear not, there are two easy steps:</p>\n\n<ol>\n<li><p>First, the stock <code>syscall.Seek()</code> is actually mapped to <code>lseek(2)</code>\non the relevant platforms.</p></li>\n<li><p>Next, you'd need to figure out the correct values for <code>SEEK_HOLE</code> and\n<code>SEEK_DATA</code> for the platforms you need to support.</p>\n\n<blockquote>\n  <p><em>Note that they are <strong>free to be different</strong> between different platforms!</em></p>\n</blockquote>\n\n<p>Say, on my Linux system I can do simple</p>\n\n<pre><code>$ grep -E 'SEEK_(HOLE|DATA)' &lt;/usr/include/unistd.h \n#  define SEEK_DATA     3       /* Seek to next data.  */\n#  define SEEK_HOLE     4       /* Seek to next hole.  */\n</code></pre>\n\n<p>&hellip;to figure out the values for these symbols.</p></li>\n</ol>\n\n<p>Now, say, you create a Linux-specific file in your package\ncontaining something like</p>\n\n<pre><code>// +build linux\n\nconst (\n    SEEK_DATA = 3\n    SEEK_HOLE = 4\n)\n</code></pre>\n\n<p>and then use these values with the <code>syscall.Seek()</code>.</p>\n\n<p>The file descriptor to pass to <code>syscall.Seek()</code> and friends\ncan be obtained from an opened file using the <code>Fd()</code> method\nof <code>os.File</code> values.</p>\n\n<p>The pattern to use when reading is to detect regions containing data, and read the data from them &ndash; see <a href=\"http://git.savannah.gnu.org/cgit/tar.git/tree/src/sparse.c?id=63f2e969ddc162da7ae49a955bba9c6a2a0e77dc#n287\" rel=\"noreferrer\">this</a> for one example.</p>\n\n<p>Note that this deals with reading sparse files; but if you'd want to actually <em>transfer</em> them as sparse &ndash; that is, with keeping this property of them, &ndash; the situation is more complicated: it appears to be even less portable, so some research and experimentation is due.</p>\n\n<p>On Linux, it appears you could try to use <a href=\"https://manpages.debian.org/jump?q=fallocate.2\" rel=\"noreferrer\"><code>fallocate(2)</code></a> with\n<code>FALLOC_FL_PUNCH_HOLE | FALLOC_FL_KEEP_SIZE</code> to try to punch a hole at the\nend of the file you're writing to; if that legitimately fails\n(with <code>syscall.EOPNOTSUPP</code>), you just shovel as many zeroed blocks to the destination file as covered by the hole you're reading &ndash; in the hope\nthe OS will do the right thing and will convert them to a hole by itself.</p>\n\n<p>Note that some filesystems do not support holes at all &ndash; as a concept.\nOne example is the filesystems in the FAT family.\nWhat I'm leading you to is that inability of creating a sparse file might\nactually be a property of the target filesystem in your case.</p>\n\n<p>You might find <a href=\"https://github.com/golang/go/issues/13548\" rel=\"noreferrer\">Go issue #13548 \"archive/tar: add support for writing tar containing sparse files\"</a> to be of interest.</p>\n\n<hr>\n\n<p>One more note: you might also consider checking whether the destination directory to copy a source file resides in the same filesystem as the source file, and if this holds true, use the <code>syscall.Rename()</code> (on POSIX systems)\nor <code>os.Rename()</code> to just move the file across different directories w/o\nactually copying its data.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8874673, "user_type": "registered", "profile_image": "https://graph.facebook.com/555388216/picture?type=large", "display_name": "Soren L. Hansen", "link": "https://stackoverflow.com/users/8874673/soren-l-hansen"}, "is_accepted": false, "score": 0, "last_activity_date": 1593090990, "last_edit_date": 1593090990, "creation_date": 1593088737, "answer_id": 62575549, "question_id": 43035271, "link": "https://stackoverflow.com/questions/43035271/sparse-files-are-huge-with-io-copy/62575549#62575549", "title": "Sparse files are huge with io.Copy()", "body": "<p>You don't need to resort to syscalls.</p>\n<pre><code>package main\n\nimport &quot;os&quot;\n\nfunc main() {\n    f, _ := os.Create(&quot;/tmp/sparse.dat&quot;)\n    f.Write([]byte(&quot;start&quot;))\n    f.Seek(1024*1024*10, 0)\n    f.Write([]byte(&quot;end&quot;))\n}\n</code></pre>\n<p>Then you'll see:</p>\n<pre><code>$ ls -l /tmp/sparse.dat\n-rw-rw-r-- 1 soren soren 10485763 Jun 25 14:29 /tmp/sparse.dat\n$ du /tmp/sparse.dat\n8   /tmp/sparse.dat\n</code></pre>\n<p>It's true you can't use <code>io.Copy</code> as is.  Instead you need to implement an alternative to <code>io.Copy</code> which reads a chunk from the <code>src</code>, checks if it's all <code>'\\0'</code>. If it is, just <code>dst.Seek(len(chunk), os.SEEK_CUR)</code> to skip past that part in <code>dst</code>. That particular implementation is left as an exercise to the reader :)</p>\n"}], "owner": {"reputation": 4286, "user_id": 475536, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ffbc0cdb2a23ba3c7f68b51c075b70a5?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/475536/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "accepted_answer_id": 43040498, "answer_count": 2, "score": 3, "last_activity_date": 1593090990, "creation_date": 1490566791, "question_id": 43035271, "link": "https://stackoverflow.com/questions/43035271/sparse-files-are-huge-with-io-copy", "title": "Sparse files are huge with io.Copy()", "body": "<p>I want to copy files from one place to another and the problem is I deal with a lot of sparse files. </p>\n\n<p>Is there any (easy) way of copying sparse files without becoming huge at the destination?</p>\n\n<p>My basic code:</p>\n\n<pre><code>out, err := os.Create(bricks[0] + \"/\" + fileName)\nin, err := os.Open(event.Name)\nio.Copy(out, in)\n</code></pre>\n"}, {"tags": ["go", "parameters", "interface", "slice", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7032683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb954121eceae3348b20fb211b100a9?s=128&d=identicon&r=PG", "display_name": "Vincento Law", "link": "https://stackoverflow.com/users/7032683/vincento-law"}, "edited": false, "score": 0, "creation_date": 1490568234, "post_id": 43035225, "comment_id": 73156141, "body": "Thanks alot! I should read more about interface convertions, can you advice me a resource for it? Thanks again!"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 1, "user_id": 7032683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb954121eceae3348b20fb211b100a9?s=128&d=identicon&r=PG", "display_name": "Vincento Law", "link": "https://stackoverflow.com/users/7032683/vincento-law"}, "edited": false, "score": 0, "creation_date": 1490568706, "post_id": 43035225, "comment_id": 73156263, "body": "For <code>json.Unmarshal</code>&#39;s conversion rules it&#39;s best to read the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">golang docs</a> and to better understand what <code>interface{}</code>s are a good article can be found <a href=\"https://research.swtch.com/interfaces\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 0, "last_activity_date": 1490566844, "last_edit_date": 1490566844, "creation_date": 1490566461, "answer_id": 43035225, "question_id": 43034937, "link": "https://stackoverflow.com/questions/43034937/pass-interface-slice-in-function-and-unmarshal-into-its-items/43035225#43035225", "title": "Pass interface slice in function and unmarshal into its items", "body": "<p>Since <code>p</code> is a slice of interfaces, on this line <code>json.Unmarshal(response.Value, &amp;p[0])</code> you're passing a pointer to an <code>interface{}</code> not to a <code>User</code> and since <code>json.Unmarshal</code> allows interfaces as the destination to which to unmarshal the data, it doesn't look under the <code>interface{}</code> for another type and just decodes the <code>json</code> into a <code>map</code>.</p>\n\n<p>What you can do is to have the <code>interface{}</code> already be a pointer to a concrete type e.g. <code>data[i] = &amp;users[i]</code> then you just pass the <code>interface{}</code> without <code>&amp;</code> to <code>json.Unmarshal</code>.</p>\n\n<pre><code>func loadDBRows(p []interface{}) {\n    var response DBResponse\n    someDataFromDB := []byte(\"{\\\"rows\\\":1, \\\"error\\\": \\\"\\\", \\\"value\\\": {\\\"name\\\":\\\"John\\\", \\\"id\\\":2}}\")\n    json.Unmarshal(someDataFromDB, &amp;response)\n    json.Unmarshal(response.Value, p[0]) // notice the missing &amp;\n    fmt.Println(p)\n}\n\nusers := make([]User, 5)\ndata := make([]interface{}, 5)\nfor i := range users {\n    data[i] = &amp;users[i] // notice the added &amp;\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/GEbIq9febY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/GEbIq9febY</a></p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1490567456, "creation_date": 1490567456, "answer_id": 43035373, "question_id": 43034937, "link": "https://stackoverflow.com/questions/43034937/pass-interface-slice-in-function-and-unmarshal-into-its-items/43035373#43035373", "title": "Pass interface slice in function and unmarshal into its items", "body": "<p>One option is to use the reflect package to access the slice elements.</p>\n\n<p>The function assumes that <code>p</code> is a slice:</p>\n\n<pre><code>func loadDBRows(p interface{}) {\n  var response DBResponse\n  someDataFromDB := []byte(\"{\\\"rows\\\":1, \\\"error\\\": \\\"\\\", \\\"value\\\": {\\\"name\\\":\\\"John\\\", \\\"id\\\":2}}\")\n  json.Unmarshal(someDataFromDB, &amp;response)\n  v := reflect.ValueOf(p). // get reflect.Value for argument\n               Index(0).   // get first element assuming that p is a slice\n               Addr().     // take address of the element\n               Interface() // get the pointer to element as an interface{}\n  json.Unmarshal(response.Value, v)\n}\n</code></pre>\n\n<p>Use <code>loadDBRows</code> like this. There's no need to create the <code>[]interface{}</code> as in the question:</p>\n\n<pre><code>func main() {\n  users := make([]User, 5)\n  loadDBRows(users)\n  fmt.Println(users)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/YDDYajbx1y\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7032683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb954121eceae3348b20fb211b100a9?s=128&d=identicon&r=PG", "display_name": "Vincento Law", "link": "https://stackoverflow.com/users/7032683/vincento-law"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "accepted_answer_id": 43035225, "answer_count": 2, "score": 0, "last_activity_date": 1490567456, "creation_date": 1490564728, "question_id": 43034937, "link": "https://stackoverflow.com/questions/43034937/pass-interface-slice-in-function-and-unmarshal-into-its-items", "title": "Pass interface slice in function and unmarshal into its items", "body": "<p>Can i pass into function a slice of structs, converted to <code>[]interface{}</code>, fill it and use after function end work? </p>\n\n<p>Here is full example of the problem <a href=\"https://play.golang.org/p/iPijsawEEg\" rel=\"nofollow noreferrer\">https://play.golang.org/p/iPijsawEEg</a></p>\n\n<p>Short describe:</p>\n\n<pre><code>type DBResponse struct {\n    Rows  int             `json:\"rows\"`\n    Error string          `json:\"error\"`\n    Value json.RawMessage `json:\"value\"`\n}\ntype User struct {\n    Id   int    `json:\"id\"`\n    Name string `json:\"name\"`\n}\n\nfunc loadDBRows(p []interface{}) {\n    var response DBResponse\n    someDataFromDB := []byte(\"{\\\"rows\\\":1, \\\"error\\\": \\\"\\\", \\\"value\\\": {\\\"name\\\":\\\"John\\\", \\\"id\\\":2}}\")\n    json.Unmarshal(someDataFromDB, &amp;response)\n    json.Unmarshal(response.Value, &amp;p[0])\n    fmt.Println(p)//p[0] filled with map, not object\n}\n\nfunc main() {\n    users := make([]User, 5)\n    data := make([]interface{}, 5)\n    for i := range users {\n        data[i] = users[i]\n    }\n    loadDBRows(data)\n}\n</code></pre>\n\n<p>This problem can be easily solved for single <code>interface{}</code>, u can test in at full example. Why i can't solve it for slice?</p>\n\n<p>I want to do it without reflect! Is there any \"true way\" to write universal json parser to selected data struct <strong>without reflect and map[string]interface{}?</strong> Don't want complicated code and extra operations</p>\n\n<p>Thank you for help!</p>\n"}, {"tags": ["go", "ide", "jetbrains-ide", "goland"], "answers": [{"comments": [{"owner": {"reputation": 412, "user_id": 6498438, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/OFuAw.png?s=128&g=1", "display_name": "trashgenerator", "link": "https://stackoverflow.com/users/6498438/trashgenerator"}, "edited": false, "score": 0, "creation_date": 1490638504, "post_id": 43034031, "comment_id": 73191668, "body": "Thanks a lot man. But in gogland you also need to call &quot;go get gotype&quot; - after that import &quot;FirstSteps/util&quot; works fine. And GOPATH for project in settings must be &quot;d:/go_projects&quot; in this case. It&#39;s not so easy to dive in - C++ was easier :)"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 9, "last_activity_date": 1490572406, "last_edit_date": 1490572406, "creation_date": 1490559391, "answer_id": 43034031, "question_id": 43033682, "link": "https://stackoverflow.com/questions/43033682/some-tips-with-go-and-gogland/43034031#43034031", "title": "Some tips with Go and Gogland", "body": "<p>First, the general structure of your Go <a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"noreferrer\">workspace</a> seems to be wrong. You need to make it look more like this:</p>\n\n<pre><code>D:\n|-- go_projects\n|    |-- bin\n|    |-- pkg\n|    |-- src \n|    |    |-- FirstSteps\n|    |    |    |-- main.go\n|    |    |    +-- util\n|    |    |         +-- myprinter.go\n|    |    |-- SecondProject\n|    |    |-- ThirdProject\n...\n</code></pre>\n\n<p>Second your <code>import</code> statement seems to be empty, I have no idea how goglang works but if you want to use whatever is in your <code>myprinter.go</code> file, you will need to import the <code>util</code> package, assuming that the <code>myprinter.go</code> file declares its <code>package</code> as <code>util</code> at the top.</p>\n\n<pre><code>// FirstSteps/main.go\npackage main\n\nimport (\n    \"FirstSteps/util\"\n)\n\nfunc main() {\n    util.MyPrinterFunc()\n}\n</code></pre>\n\n<p>And of course to be able to use anything from <code>util</code> there first must be something...</p>\n\n<pre><code>// FirstSteps/util/myprinter.go\npackage util\n\nfunc MyPrinterFunc() {\n    // do stuff...\n}\n</code></pre>\n\n<p><strong>Edit</strong>: I'm sorry, I didn't actually answer your question initially. You're getting the error <code>Cannot find package 'main'</code> because of the wrong workspace setup I already mentioned. The <code>Package path</code> tells Gogland where the package you want to run is <strong>relative</strong> to the <code>$GOPATH/src</code> directory. So after you've setup your wrokspace correctly, you should set the <code>Package path</code> to <code>FirstSteps</code> since that package's absolute path will be <code>$GOPATH/src/FirstSteps</code>. If, later, you want to run the <code>util</code> package you would specify <code>Package path</code> as <code>FirstSteps/util</code> for gogland to be able to find it.</p>\n"}], "owner": {"reputation": 412, "user_id": 6498438, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/OFuAw.png?s=128&g=1", "display_name": "trashgenerator", "link": "https://stackoverflow.com/users/6498438/trashgenerator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5158, "favorite_count": 0, "accepted_answer_id": 43034031, "answer_count": 1, "score": 4, "last_activity_date": 1490572406, "creation_date": 1490557587, "question_id": 43033682, "link": "https://stackoverflow.com/questions/43033682/some-tips-with-go-and-gogland", "title": "Some tips with Go and Gogland", "body": "<p>Hi all. I'm very new with Go and Gogland. I have a project\n<a href=\"https://i.stack.imgur.com/UUz7Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UUz7Z.png\" alt=\"Go project in Gogland\"></a></p>\n\n<ol>\n<li>I choose \"Run kind\" as Package - to run not only main file but a project. Why it cannot find main package??</li>\n<li>How to import util.myprinter package to main.go to use it??</li>\n</ol>\n\n<p>Please, help me</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1490545111, "post_id": 43031156, "comment_id": 73148029, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/37382600/golang-cannot-free-memory-once-occupied-by-bytes-buffer/37383604#37383604\">Golang - Cannot free memory once occupied by bytes.Buffer</a>."}, {"owner": {"reputation": 191, "user_id": 3956218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b4FrL.jpg?s=128&g=1", "display_name": "MarceloBoni", "link": "https://stackoverflow.com/users/3956218/marceloboni"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1490546089, "post_id": 43031156, "comment_id": 73148442, "body": "@icza after <code>http.ListenAndServe(&quot;:8080&quot;, nil)</code> I set it <code>defer debug.FreeOSMemory()</code> does not seem to work, I did a test, it was about 10 minutes ago and it looks like the garbage collector did not work =["}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1490546262, "post_id": 43031156, "comment_id": 73148506, "body": "What is the problem exactly? Your app uses like 10 MB of RAM, that&#39;s not much for a web server..."}, {"owner": {"reputation": 191, "user_id": 3956218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b4FrL.jpg?s=128&g=1", "display_name": "MarceloBoni", "link": "https://stackoverflow.com/users/3956218/marceloboni"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1490546450, "post_id": 43031156, "comment_id": 73148590, "body": "The idea is to free space when resource is no longer being used on the server, I am testing locally, but the service will run on a server that will have hundreds of access."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1490547348, "post_id": 43031156, "comment_id": 73148937, "body": "Just because in production you&#39;ll have a hundred times more requests it doesn&#39;t mean a hundred times more memory will be used. Go is a garbage collected language, you shouldn&#39;t worry about memory usage until it proves to be an issue."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1490547489, "post_id": 43031156, "comment_id": 73148989, "body": "One thing you should avoid is parsing templates in handlers (during serving requests). For details see <a href=\"http://stackoverflow.com/questions/28451675/it-takes-too-much-time-when-using-template-package-to-generate-a-dynamic-web-p/28453523#28453523\">It takes too much time when using &quot;template&quot; package to generate a dynamic web page to client in golang</a>."}], "owner": {"reputation": 191, "user_id": 3956218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b4FrL.jpg?s=128&g=1", "display_name": "MarceloBoni", "link": "https://stackoverflow.com/users/3956218/marceloboni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490544502, "creation_date": 1490544502, "question_id": 43031156, "link": "https://stackoverflow.com/questions/43031156/free-up-server-memory-space-when-idle", "title": "Free up server memory space when idle", "body": "<p>I have a code that has this structure:</p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"net/http\"\n    \"log\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\",myFunction)\n    http.HandleFunc(\"/route2\",mySecondFunction)\n    http.HandleFunc(\"/route3\",myThirdFunction)\n    http.ListenAndServe(\":8080\",nil)\n}\n\nfunc check(err error){\n    if err != nil{\n        log.Fatal(err)\n    }\n}\n\nfunc myFunction(w http.ResponseWriter, r *http.Request){\n    if r.Method == \"GET\"{\n        t,err := template.ParseFiles(\"request.html\")\n        check(err)\n        t.Execute(w,nil)\n    }\n}\n</code></pre>\n\n<p>This code simply creates a server with whatever it has in <code>request.html</code> file and it runs in <code>localhost: 8080</code>, see the routes I set in <code>http.HandleFunc(\"/\", myFunction)</code>.</p>\n\n<p>I could see that in task manager, even when the server was idle, memory usage never decreased, only increasing according to the amount of calls I made to the server.</p>\n\n<p>Init state:</p>\n\n<p><a href=\"https://i.stack.imgur.com/P7i6L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P7i6L.png\" alt=\"enter image description here\"></a></p>\n\n<p>After some requests:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NFxUw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NFxUw.png\" alt=\"enter image description here\"></a></p>\n\n<p>And this working set never decreased</p>\n\n<p>How can I do to free up the memory that has already been used and at the same time not disable the server?</p>\n"}, {"tags": ["go", "rpc", "gob"], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 10590810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ZitE.jpg?s=128&g=1", "display_name": "Chucky", "link": "https://stackoverflow.com/users/10590810/chucky"}, "is_accepted": false, "score": 0, "last_activity_date": 1541073929, "creation_date": 1541073929, "answer_id": 53100945, "question_id": 43030874, "link": "https://stackoverflow.com/questions/43030874/golang-rpc-encode-custom-function/53100945#53100945", "title": "Golang RPC encode custom function", "body": "<p>I'm not familiar with the library however, you could try converting the struct to a byte slice before transport. Late reply, might help others.... </p>\n\n<p>Simple conversion: returns a struct as bytes</p>\n\n<pre><code>func StructToBytes(s interface{}) (converted []byte, err error) {\n    var buff bytes.Buffer\n    encoder := gob.NewEncoder(&amp;buff)\n    if err = encoder.Encode(s); err != nil {\n        return\n    }\n    converted = buff.Bytes()\n    return\n}\n</code></pre>\n\n<p>Decoder: returns a wrapper to decode the bytes into</p>\n\n<pre><code>func Decoder(rawBytes []byte) (decoder *gob.Decoder) {\n    reader := bytes.NewReader(rawBytes)\n    decoder = gob.NewDecoder(reader)\n    return\n}\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>type MyStruct struct {\n    Name string\n}\n\ntoEncode := MyStruct{\"John Doe\"}\n\n// convert the struct to bytes\nstructBytes, err := StructToBytes(toEncode)\nif err != nil {\n    panic(err)\n}\n\n//-----------\n// send over RPC and decode on other side\n//-----------\n\n// create a new struct to decode into\nvar DecodeInto MyStruct\n\n// pass the bytes to the decoder\ndecoder := Decoder(structBytes)\n\n// Decode into the struct\ndecoder.Decode(&amp;DecodeInto)\n\nfmt.Println(DecodeInto.Name) // John Doe\n</code></pre>\n\n<p>Due to the use of the gob package you can swap types and typecast to a certain extent.</p>\n\n<p>For more see: <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/gob/</a></p>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 571, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541073929, "creation_date": 1490543208, "question_id": 43030874, "link": "https://stackoverflow.com/questions/43030874/golang-rpc-encode-custom-function", "title": "Golang RPC encode custom function", "body": "<p>I am trying to use <code>github.com/dullgiulio/pingo</code> and send my custom struct</p>\n\n<pre><code>type LuaPlugin struct {\n    Name string\n    List []PluginTable\n}\n\ntype PluginTable struct {\n    Name string\n    F lua.LGFunction\n}\n\n// LoadPlugins walks over the plugin directory loading all exported plugins\nfunc LoadPlugins() {\n    //\n    p := pingo.NewPlugin(\"tcp\", \"plugins/test\")\n    // Actually start the plugin\n    p.Start()\n    // Remember to stop the plugin when done using it\n    defer p.Stop()\n\n    gob.Register(&amp;LuaPlugin{})\n    gob.Register(&amp;PluginTable{})\n\n    var resp *LuaPlugin\n\n    // Call a function from the object we created previously\n    if err := p.Call(\"MyPlugin.SayHello\", \"Go developer\", &amp;resp); err != nil {\n        log.Print(err)\n    } else {\n        log.Print(resp.List[0])\n    }\n}\n</code></pre>\n\n<p>However I am always getting <code>nil</code> for the <code>F</code> field of ym struct. This is what I am sending on the client</p>\n\n<pre><code>// Create an object to be exported\ntype MyPlugin struct{}\n\n// Exported method, with a RPC signature\nfunc (p *MyPlugin) SayHello(name string, msg *util.LuaPlugin) error {\n    //\n\n    //\n    *msg = util.LuaPlugin{\n        Name: \"test\",\n        List: []util.PluginTable{\n            {\n                Name: \"hey\",\n                F: func(L *lua.LState) int {\n                    log.Println(L.ToString(2))\n                    return 0\n                },\n            },\n        },\n    }\n    return nil\n}\n</code></pre>\n\n<p>Is it not possible to send custom data types over RPC?</p>\n"}, {"tags": ["go", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": true, "score": 0, "last_activity_date": 1490541919, "creation_date": 1490541919, "answer_id": 43030636, "question_id": 43030443, "link": "https://stackoverflow.com/questions/43030443/scrape-html-drop-down-lists-with-go/43030636#43030636", "title": "Scrape HTML drop-down lists with Go?", "body": "<p>You absolutely can do it with \"net/html\":</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/net/html\"\n    \"strings\"\n)\n\nfunc main() {\n    s := \"html\"\n\n    result := make(map[string]string)\n    d := html.NewTokenizer(strings.NewReader(s))\n    currID := \"\"\n    for {\n        tokenType := d.Next()\n        if tokenType == html.ErrorToken {\n            break\n        }\n\n        token := d.Token()\n        switch tokenType {\n        case html.StartTagToken:\n            if token.Data == \"select\" {\n                for _, a := range token.Attr {\n                    if a.Key == \"id\" {\n                        currID = a.Val\n                    }\n                }\n            }\n            if token.Data == \"option\" {\n                isSelected := false\n                for _, a := range token.Attr {\n                    if a.Key == \"selected\" {\n                        isSelected = true\n                    }\n                }\n                if isSelected {\n                    for _, a := range token.Attr {\n                        if a.Key == \"value\" {\n                            result[currID] = a.Val\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    fmt.Printf(\"%v\\n\", result)\n}\n</code></pre>\n\n<p>P.S. this code can be improved.</p>\n"}, {"tags": [], "owner": {"reputation": 17034, "user_id": 858913, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b5015a60c08feee1d8116be3dd70878d?s=128&d=identicon&r=PG", "display_name": "eLRuLL", "link": "https://stackoverflow.com/users/858913/elrull"}, "is_accepted": false, "score": 0, "last_activity_date": 1490543630, "creation_date": 1490543630, "answer_id": 43030965, "question_id": 43030443, "link": "https://stackoverflow.com/questions/43030443/scrape-html-drop-down-lists-with-go/43030965#43030965", "title": "Scrape HTML drop-down lists with Go?", "body": "<p>Maybe use <a href=\"https://github.com/moovweb/gokogiri\" rel=\"nofollow noreferrer\"><code>gokogiri</code></a> for xpath selectors:</p>\n\n<pre><code>car, _ := doc.Search(\"//select[@id='car']/option[@selected]/text()\")\nanimal, _ := doc.Search(\"//select[@id='animal']/option[@selected]/text()\")\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "accepted_answer_id": 43030636, "answer_count": 2, "score": 0, "last_activity_date": 1490543630, "creation_date": 1490540858, "question_id": 43030443, "link": "https://stackoverflow.com/questions/43030443/scrape-html-drop-down-lists-with-go", "title": "Scrape HTML drop-down lists with Go?", "body": "<p>I'm using the package <code>golang.org/x/net/html</code> to scrape data out of HTML pages and this has been working fine so far. However, I don't know how to extract data from a drop-down list like this:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n\n&lt;select name=\"car\" size=\"1\" id=\"car\"&gt;\n  &lt;option value=\"volvo\"&gt;Volvo&lt;/option&gt;\n  &lt;option value=\"saab\"&gt;Saab&lt;/option&gt;\n  &lt;option value=\"vw\"&gt;VW&lt;/option&gt;\n  &lt;option value=\"audi\" selected&gt;Audi&lt;/option&gt;\n&lt;/select&gt;\n\n&lt;select name=\"animal\" size=\"1\" id=\"animal\"&gt;\n  &lt;option value=\"dog\"&gt;Dog&lt;/option&gt;\n  &lt;option value=\"cat\" selected&gt;Cat&lt;/option&gt;\n  &lt;option value=\"badger\"&gt;Badger&lt;/option&gt;\n  &lt;option value=\"mouse\"&gt;Mouse&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>\n</p>\n\n<p>I want to extract the pre-selected options, so the result becomes this:</p>\n\n<pre><code>car = audi\nanimal = cat\n</code></pre>\n\n<p>How can I accomplish this? In case <code>golang.org/x/net/html</code> is not capable of doing what I want, what else can I do to extract the data?</p>\n"}, {"tags": ["go", "concurrency"], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 6624190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27fec5518dc74ee7edb036b6490bb8b0?s=128&d=identicon&r=PG&f=1", "display_name": "dz00dz", "link": "https://stackoverflow.com/users/6624190/dz00dz"}, "edited": false, "score": 0, "creation_date": 1490542711, "post_id": 43030425, "comment_id": 73147125, "body": "Thank you, now I understand why :)"}, {"owner": {"reputation": 112, "user_id": 6624190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27fec5518dc74ee7edb036b6490bb8b0?s=128&d=identicon&r=PG&f=1", "display_name": "dz00dz", "link": "https://stackoverflow.com/users/6624190/dz00dz"}, "edited": false, "score": 0, "creation_date": 1490544176, "post_id": 43030425, "comment_id": 73147646, "body": "I have used i before I post this code, and when I post this code I forget to remove it"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 1, "last_activity_date": 1490540721, "creation_date": 1490540721, "answer_id": 43030425, "question_id": 43030245, "link": "https://stackoverflow.com/questions/43030245/concurrency-in-golang/43030425#43030425", "title": "Concurrency in golang", "body": "<p>You have a race condition here, try to test your code with:</p>\n\n<pre><code>go test -race\n</code></pre>\n\n<p>It means that <code>m++</code> is not thread-safe, try something like this:</p>\n\n<pre><code>var (\n    m int\n    mu *sync.RWMutex\n)\n\nfunc add(i int){\n    mu.Lock()\n    m++\n    mu.Unlock()\n}\n</code></pre>\n\n<p>Also I see this code is a bit dirty:\n1. Remove <code>m = 0</code>\n2. Replace <code>Sleep</code> with <code>WaitGroup</code>\n3. Why do you pass <code>i</code> but do not use it?</p>\n"}, {"comments": [{"owner": {"reputation": 112, "user_id": 6624190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27fec5518dc74ee7edb036b6490bb8b0?s=128&d=identicon&r=PG&f=1", "display_name": "dz00dz", "link": "https://stackoverflow.com/users/6624190/dz00dz"}, "edited": false, "score": 0, "creation_date": 1490542707, "post_id": 43030470, "comment_id": 73147123, "body": "Thank you, now I understand why :)"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1490541001, "creation_date": 1490541001, "answer_id": 43030470, "question_id": 43030245, "link": "https://stackoverflow.com/questions/43030245/concurrency-in-golang/43030470#43030470", "title": "Concurrency in golang", "body": "<p>No. For example, using your program,</p>\n\n<pre><code>$ go run -race dz00dz.go\n==================\nWARNING: DATA RACE\nRead at 0x000000595200 by goroutine 7:\n  main.add()\n     /home/peter/gopath/src/dz00dz.go:11 +0x3d\n\nPrevious write at 0x000000595200 by goroutine 6:\n  main.add()\n      /home/peter/gopath/src/dz00dz.go:11 +0x59\n\nGoroutine 7 (running) created at:\n  main.main()\n      /home/peter/gopath/src/dz00dz.go:17 +0x76\n\nGoroutine 6 (finished) created at:\n  main.main()\n      /home/peter/gopath/src/dz00dz.go:17 +0x76\n==================\n100\nFound 1 data race(s)\nexit status 66\n</code></pre>\n\n<p>References:</p>\n\n<p><a href=\"https://blog.golang.org/race-detector\" rel=\"noreferrer\">Introducing the Go Race Detector</a></p>\n"}, {"comments": [{"owner": {"reputation": 112, "user_id": 6624190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27fec5518dc74ee7edb036b6490bb8b0?s=128&d=identicon&r=PG&f=1", "display_name": "dz00dz", "link": "https://stackoverflow.com/users/6624190/dz00dz"}, "edited": false, "score": 0, "creation_date": 1490542701, "post_id": 43030496, "comment_id": 73147121, "body": "Thank you, now I understand why :)"}], "tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": false, "score": 3, "last_activity_date": 1490541112, "creation_date": 1490541112, "answer_id": 43030496, "question_id": 43030245, "link": "https://stackoverflow.com/questions/43030245/concurrency-in-golang/43030496#43030496", "title": "Concurrency in golang", "body": "<p>I am getting the same results here, but not if I replace</p>\n\n<pre><code>m++\n</code></pre>\n\n<p>with</p>\n\n<pre><code>func add(i int) {\n    for j := 0; j &lt; 100000; j++ {\n        m++\n    }\n}\n</code></pre>\n\n<p>In the latter case, I confirmed using <a href=\"https://www.goinggo.net/2015/02/scheduler-tracing-in-go.html\" rel=\"nofollow noreferrer\">scheduler tracing</a> that the Go runtime distributed the work on several processor cores, which explains the discrepancy because, indeed, <code>m</code> is not protected against race conditions. So why does it not happen in the former case ? Probably because a simple integer increment is too short for the Go scheduler to assign the goroutines to several threads, so they execute in sequence, in the same thread. And why does it happen in C : because you manually distribute the calculations on several threads, so the operating system scheduler may decide to execute them on several processor cores.</p>\n"}, {"tags": [], "owner": {"reputation": 729, "user_id": 5856523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63de4ccd018dba6a0ff19ef87674ebc?s=128&d=identicon&r=PG&f=1", "display_name": "pschilakanti", "link": "https://stackoverflow.com/users/5856523/pschilakanti"}, "is_accepted": false, "score": 0, "last_activity_date": 1492514327, "creation_date": 1492514327, "answer_id": 43470697, "question_id": 43030245, "link": "https://stackoverflow.com/questions/43030245/concurrency-in-golang/43470697#43470697", "title": "Concurrency in golang", "body": "<p>No, you cant get the same result.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nvar m int\n\nfunc add(i int) {\n    m++\n}\n\nfunc main() {\n    m = 0\n    for i := 0; i &lt; 10000; i++ {\n        go add(i)\n    }\n    time.Sleep(time.Millisecond * 1000)\n    fmt.Println(m)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8172373, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/904dfc2deb80d25e89484aa3af867e4f?s=128&d=identicon&r=PG", "display_name": "Amit Arora", "link": "https://stackoverflow.com/users/8172373/amit-arora"}, "is_accepted": false, "score": 0, "last_activity_date": 1497623756, "creation_date": 1497623756, "answer_id": 44591938, "question_id": 43030245, "link": "https://stackoverflow.com/questions/43030245/concurrency-in-golang/44591938#44591938", "title": "Concurrency in golang", "body": "<pre><code>// This sample program demonstrates how to create goroutines and\n// how the goroutine scheduler behaves with three logical processors.\n\npackage main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"sync\"\n)\n\nfunc main() {\n    // Allocate three logical processors for the scheduler to use.\n    runtime.GOMAXPROCS(3)\n\n    // processTest is used to wait for the program to finish.\n    var processTest sync.WaitGroup\n    // Add a count of three, one for each goroutine.\n    processTest.Add(3)\n\n    // Declaration of three anonymous function and create a goroutine.\n    go func() {\n        defer processTest.Done()\n        for i := 0; i &lt; 30; i++ {\n            for j := 51; j &lt;= 100; j++ {\n                fmt.Printf(\" %d\", j)\n                if j == 100{\n                    fmt.Println()\n                }\n            }\n        }\n    }()\n    go func() {\n        defer processTest.Done()\n        for j := 0; j &lt; 10; j++ {\n            for char := 'A'; char &lt; 'A'+26; char++ {\n                fmt.Printf(\"%c \", char)\n                if char == 'Z' {\n                    fmt.Println()\n                }\n\n            }\n        }\n    }()\n    go func() {\n        defer processTest.Done()\n        for i := 0; i &lt; 30; i++ {\n            for j := 0; j &lt;= 50; j++ {\n                fmt.Printf(\" %d\", j)\n                if j == 50 {\n                    fmt.Println()\n                }\n            }\n        }\n    }()\n\n    // Wait for the goroutines to finish.\n    processTest.Wait()  \n}\n</code></pre>\n\n<p>If we give the scheduler more than one logical processor to use, we\u2019ll see different behavior in the output of our example programs. If you run the program, you\u2019ll see that the goroutines are running in parallel. Multiple goroutines start running, and the letters and numbers in the display are mixed. The output is based on running the program on an eight-core machine, so each goroutine is running on its own core.\n<a href=\"http://www.golangprograms.com/this-sample-program-demonstrates-how-to-create-multiple-goroutines-and-how-the-goroutine-scheduler-behaves-with-three-logical-processors.html\" rel=\"nofollow noreferrer\">http://www.golangprograms.com/this-sample-program-demonstrates-how-to-create-multiple-goroutines-and-how-the-goroutine-scheduler-behaves-with-three-logical-processors.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12095094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/946815f53e322ef7a157608228d20097?s=128&d=identicon&r=PG&f=1", "display_name": "samarth", "link": "https://stackoverflow.com/users/12095094/samarth"}, "is_accepted": false, "score": 0, "last_activity_date": 1569141603, "creation_date": 1569141603, "answer_id": 58047489, "question_id": 43030245, "link": "https://stackoverflow.com/questions/43030245/concurrency-in-golang/58047489#58047489", "title": "Concurrency in golang", "body": "<p>Goroutines do not run in parallel. Go work scheduler manages all the goroutines such that all the goroutines are run effectively. Since, goroutines are not running in parallel, the answer would always be 100 for the above program. But, there is one setting GOMAXPROCS which is by default 1, but if you set it any number N > 1, the answer would be different everytime since N goroutines are running in parallel.</p>\n"}], "owner": {"reputation": 112, "user_id": 6624190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27fec5518dc74ee7edb036b6490bb8b0?s=128&d=identicon&r=PG&f=1", "display_name": "dz00dz", "link": "https://stackoverflow.com/users/6624190/dz00dz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 4, "accepted_answer_id": 43030470, "answer_count": 6, "score": 3, "last_activity_date": 1569141603, "creation_date": 1490539752, "question_id": 43030245, "link": "https://stackoverflow.com/questions/43030245/concurrency-in-golang", "title": "Concurrency in golang", "body": "<p>I have a question about concurrency in GoLang. Here is a sample code in GoLang</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"time\"\n)\n\nvar m int\nfunc add(i int){\n    m++\n}\n\nfunc main() {\n    m = 0\n    for i:=0;i&lt;100;i++{\n        go add(i)\n    }\n    time.Sleep(time.Millisecond * 1000)\n    fmt.Println(m)\n}\n</code></pre>\n\n<p>When I execute it I always have the same result 100, even if I execute it several times.</p>\n\n<p>If I do the same code in C (without mutex), sometimes I have different results.</p>\n\n<p>And my question, I would like to know if GoLang implicitly manages access to a shared variable using an internal mechanism ?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "struct", "slice"], "answers": [{"tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": false, "score": 1, "last_activity_date": 1490533246, "creation_date": 1490533246, "answer_id": 43029047, "question_id": 43028719, "link": "https://stackoverflow.com/questions/43028719/whats-the-better-way-to-put-struct-into-slice-in-go/43029047#43029047", "title": "What&#39;s the better way to put struct into slice in Go", "body": "<p>No.</p>\n\n<p>Why would there be? First, your function is only five lines of code, it is already short and simple. Second, converting a struct into a slice of strings is not a \"normal\" thing to do, at least not enough to mandate making it easier than it already is. As it stands, it is only slightly less convenient than in, say, Javascript or PHP, and that is already quite an achievement for a strongly typed compiled language.</p>\n"}, {"comments": [{"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1490548863, "post_id": 43029882, "comment_id": 73149520, "body": "excellent answer, really appreciate. For that TestStrings I got panic: reflect: call of reflect.Value.NumField on ptr Value [recovered] panic: reflect: call of reflect.Value.NumField on ptr Value"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "reply_to_user": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 1, "creation_date": 1490550326, "post_id": 43029882, "comment_id": 73150090, "body": "Yeah, sorry - I used a pointer receiver for <code>Strings()</code> whereas your code used the struct. I added the missing <code>reflect.Indirect</code>."}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1490550270, "last_edit_date": 1490550270, "creation_date": 1490537983, "answer_id": 43029882, "question_id": 43028719, "link": "https://stackoverflow.com/questions/43028719/whats-the-better-way-to-put-struct-into-slice-in-go/43029882#43029882", "title": "What&#39;s the better way to put struct into slice in Go", "body": "<p>One can construct a slice of the three strings directly -- there's no need for <code>reflect</code>.</p>\n\n<pre><code>func (ms *ManyStrings) Strings() []string {\n    return []string{ms.string1, ms.string2, ms.string3}\n}\n</code></pre>\n\n<p>You can define a method like this for each of the structs you have. That's simple, as fast as it can be, and easy to understand.</p>\n\n<p>If you're concerned about how manually-written methods like this could be inconsistent with the actual struct definitions, I'd probably use the reflection-based solution you have in the question in a unit test, to check that the <code>Strings()</code> methods are correct. Something like this:</p>\n\n<pre><code>func toStrings(x interface{}) []string {\n  v := reflect.Indirect(reflect.ValueOf(x))\n  var r []string\n    for i := 0; i &lt; v.NumField(); i++ {\n        r = append(r, v.Field(i).String())\n    }\n    return r\n}\n\nfunc TestStrings(t *testing.T) {\n  egs := []interface{Strings()[]string}{\n    &amp;ManyStrings{\"one\", \"two\", \"three\"},\n    &amp;ManyStrings{},\n    &amp;ManyStrings{\"a\", \"\", \"\"},\n    &amp;ManyStrings{\"\", \"b\", \"\"},\n    &amp;ManyStrings{\"\", \"\", \"c\"},\n    ... any other test cases\n  }\n  for _, ex := range egs {\n    got, want := ex.Strings(), toStrings(ex)\n    if !reflect.DeepEqual(got, want) {\n      t.Errorf(\"%v.Strings() = %v, want %v\", ex, got, want)\n    }\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 43029882, "answer_count": 2, "score": -3, "last_activity_date": 1490550270, "creation_date": 1490531486, "question_id": 43028719, "link": "https://stackoverflow.com/questions/43028719/whats-the-better-way-to-put-struct-into-slice-in-go", "title": "What&#39;s the better way to put struct into slice in Go", "body": "<p>I have func <strong><em>Struct2slice(somestruct Manystrings) []string</em></strong> to convert struct of strings into slice of strings. I believe there is better, quicker and simpler way to do it, without import reflect . Is there ?</p>\n\n<pre><code>   type Manystrings struct {\n        string1 string\n        string2 string\n        string3 string\n    }\n\nfunc Struct2slice(somestruct Manystrings) []string {\n\n    v := reflect.ValueOf(somestruct)\n    values := make([]string, v.NumField())\n    for i := 0; i &lt; v.NumField(); i++ {\n        values[i] = v.Field(i).String()\n    }\n    return values\n}\n</code></pre>\n"}, {"tags": ["go", "named-pipes"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490535177, "post_id": 43026773, "comment_id": 73144464, "body": "You need a new scanner, where would there be a race?"}, {"owner": {"reputation": 10551, "user_id": 124178, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/76b721ba4f9dcbfd2b5e90a939a63728?s=128&d=identicon&r=PG", "display_name": "carlpett", "link": "https://stackoverflow.com/users/124178/carlpett"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490774486, "post_id": 43026773, "comment_id": 73257224, "body": "@JimB My worry would be the case where the writer disconnects, I get an EOF and fall out of the loop to recreate the scanner. Before this has finished, the writer has restarted and resumed writing to the pipe. Possibly this would just lead to the writes being buffered though? I guess it depends if I need to also close the file handle."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1490557864, "post_id": 43030084, "comment_id": 73152823, "body": "Also from the docs: <code>Scanning stops unrecoverably at EOF</code> -- you can&#39;t just call Scan again."}], "tags": [], "owner": {"reputation": 23, "user_id": 2508953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457fa1c761d8511bafb1887bb1f50940?s=128&d=identicon&r=PG", "display_name": "frnklnd", "link": "https://stackoverflow.com/users/2508953/frnklnd"}, "is_accepted": false, "score": 0, "last_activity_date": 1490538941, "creation_date": 1490538941, "answer_id": 43030084, "question_id": 43026773, "link": "https://stackoverflow.com/questions/43026773/how-to-resume-reading-after-eof-in-named-pipe/43030084#43030084", "title": "How to resume reading after EOF in named pipe", "body": "<p>From the <a href=\"https://golang.org/pkg/bufio/#Scanner.Scan\" rel=\"nofollow noreferrer\">bufio GoDoc</a>:</p>\n\n<blockquote>\n  <p>Scan ... returns false when the scan stops, either by reaching the end of the input or an error. </p>\n</blockquote>\n\n<p>So you could possibly leave the file open and read until EOF, then trigger <code>scanner.Scan()</code> again when the file has changed or at a regular interval (i.e. make a goroutine), and make sure the <code>pipe</code> variable doesn't go out of scope so you can reference it again. </p>\n\n<p>If I understand your concern about a race condition correctly, this wouldn't be an issue (unless write and read operations must be synchronized) but when the scanner is re-initialized it will end up back at the beginning of the file.</p>\n"}], "owner": {"reputation": 10551, "user_id": 124178, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/76b721ba4f9dcbfd2b5e90a939a63728?s=128&d=identicon&r=PG", "display_name": "carlpett", "link": "https://stackoverflow.com/users/124178/carlpett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 447, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1490538941, "creation_date": 1490517866, "question_id": 43026773, "link": "https://stackoverflow.com/questions/43026773/how-to-resume-reading-after-eof-in-named-pipe", "title": "How to resume reading after EOF in named pipe", "body": "<p>I'm writing a program which opens a named pipe for reading, and then processes any lines written to this pipe:</p>\n\n<pre><code>err = syscall.Mkfifo(\"/tmp/myfifo\", 0666)\nif err != nil {\n    panic(err)\n}\n\npipe, err := os.OpenFile(\"/tmp/myfifo\", os.O_RDONLY, os.ModeNamedPipe)\nif err != nil {\n    panic(err)\n}\n\nreader := bufio.NewReader(pipe)\nscanner := bufio.NewScanner(reader)\n\nfor scanner.Scan() {\n    line := scanner.Text()\n    process(line)\n}\n</code></pre>\n\n<p>This works fine as long as the writing process does not restart or for other reasons send an EOF. When this happens, the loop terminates (as expected from the specifications of <code>Scanner</code>).</p>\n\n<p>However, I want to keep the pipe open to accept further writes. I <em>could</em> just reinitialize the scanner of course, but I believe this would create a race condition where the scanner might not be ready while a new process has begun writing to the pipe. </p>\n\n<p>Are there any other options? Do I need to work directly with the <code>File</code> type instead?</p>\n"}, {"tags": ["go", "protocol-buffers"], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "edited": false, "score": 0, "creation_date": 1490522129, "post_id": 43026959, "comment_id": 73140709, "body": "Relative path same error. The link to the issue you posted does not work for me."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "edited": false, "score": 0, "creation_date": 1490523362, "post_id": 43026959, "comment_id": 73141000, "body": "@user3017869  is GOPATH properly set? What version of Go are you using? Is the path and file <code>&#47;home&#47;abc&#47;src&#47;github.com&#47;gogo&#47;protobuf&#47;gogoproto&#47;gogo.proto</code> accessible and readable?"}, {"owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "edited": false, "score": 0, "creation_date": 1490523859, "post_id": 43026959, "comment_id": 73141120, "body": "<code>GOPATH</code> is set correctly. Go version is 1.8. gogo.proto is accessible and readable"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "edited": false, "score": 0, "creation_date": 1490524580, "post_id": 43026959, "comment_id": 73141313, "body": "In your Makefile, you you use GOPATH instead of releative path? (as in <a href=\"https://github.com/gogo/protobuf/pull/241/files\" rel=\"nofollow noreferrer\">github.com/gogo/protobuf/pull/241/files</a>)"}, {"owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "edited": false, "score": 0, "creation_date": 1490528284, "post_id": 43026959, "comment_id": 73142318, "body": "I was not. I changed it to no effect. Here is how the <code>Makefile</code> looks now.  <code>regenerate:                                                                                                            protoc-min-version --version=&quot;3.0.0&quot; --proto_path=$(GOPATH)&#47;src&#47;image:$(GOPATH)&#47;src&#47;github.com&#47;go&zwnj;&#8203;go&#47;protobuf&#47;protobuf&zwnj;&#8203;:$(GOPATH)&#47;src&#47;githu&zwnj;&#8203;b.com&#47;gogo&#47;protobuf&#47;&zwnj;&#8203;protobuf&#47;google&#47;prot&zwnj;&#8203;obuf:. --gogo_out=. *.proto</code> This guy here seems to have solved it, but he did not leave many clues on how. <a href=\"https://groups.google.com/forum/#!topic/gogoprotobuf/PuSSI8QvMjQ\" rel=\"nofollow noreferrer\">link</a>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1490528826, "last_edit_date": 1490528826, "creation_date": 1490519293, "answer_id": 43026959, "question_id": 43026449, "link": "https://stackoverflow.com/questions/43026449/gogo-proto-file-not-found/43026959#43026959", "title": "gogo.proto: File not found", "body": "<p>As <a href=\"http://protoc%20--gogofaster_out\" rel=\"nofollow noreferrer\">in this issue</a>, you could try and import only the relative path:</p>\n\n<pre><code>import \"github.com/gogo/protobuf/gogoproto/gogo.proto\";\n</code></pre>\n\n<p>Make sure that <code>GOPATH</code> is set to <code>/home/abc</code> first.</p>\n\n<p>I mention <a href=\"https://github.com/gogo/protobuf/pull/241/files\" rel=\"nofollow noreferrer\">protobuf PR 241</a>, where the makefile defines the PATH to use:</p>\n\n<pre><code>regenerate: \n  protoc-min-version --version=\"3.0.0\" \n    --proto_path=$(GOPATH)/src/image:\n                 $(GOPATH)/src/github.com/go\u200c\u200bgo/protobuf/protobuf\u200c\u200b:\n                 $(GOPATH)/src/githu\u200c\u200bb.com/gogo/protobuf/\u200c\u200bprotobuf/google/prot\u200c\u200bobuf:\n                 . --gogo_out=. *.proto \n</code></pre>\n\n<p>The OP mention <a href=\"https://groups.google.com/forum/#!topic/gogoprotobuf/PuSSI8QvMjQ\" rel=\"nofollow noreferrer\">this thread</a>, which points out:</p>\n\n<blockquote>\n  <p>The dependencies call other dependencies in \"<code>google/protobuf/</code>\", so these need to be in the path correctly also.<br>\n  The errors are pretty misleading</p>\n  \n  <p>Also when using gogoproto extensions you should use <code>gogofast_out</code>.<br>\n  <code>gofast_out</code> is only for when you are not using any extensions, but want some extra speed.<br>\n  <code>gogofast_out</code> / <code>gofast_out</code> has no side effects.<br>\n  <code>gogofaster_out</code> makes most fields <code>nullable=false</code>.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 6596840, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1LuQL-YBMFE/AAAAAAAAAAI/AAAAAAAAAI8/anrKejkVZj8/photo.jpg?sz=128", "display_name": "Long Tran", "link": "https://stackoverflow.com/users/6596840/long-tran"}, "is_accepted": false, "score": 0, "last_activity_date": 1611514023, "creation_date": 1611514023, "answer_id": 65874584, "question_id": 43026449, "link": "https://stackoverflow.com/questions/43026449/gogo-proto-file-not-found/65874584#65874584", "title": "gogo.proto: File not found", "body": "<ol>\n<li>Run <code>go get -u github.com/gogo/protobuf</code> to download the dependencies to local directory <code>$GOPATH/pkg/mod</code></li>\n<li>Run <code>go mod vendor</code> to packaging your module dependencies. After execute this cmd, there should be a directory &quot;vendor&quot; in your project and shall be referred in the Makefile.</li>\n</ol>\n<p>The Makefile command should be:</p>\n<pre><code>regenerate: \n    protoc-min-version --version=&quot;3.0.0&quot; \\\n    --proto_path=$(GOPATH)/src/image \\\n    -I vendor/github.com/go\u200c\u200bgo/protobuf/protobuf\u200c\u200b \\\n    -I vendor/githu\u200c\u200bb.com/gogo/protobuf/\u200c\u200bprotobuf/google/prot\u200c\u200bobuf \\\n    -I. --gogo_out=. *.proto \n</code></pre>\n<p>Here, --pro_path and -I are the same.<br>\nIn case the absolute path contains variable then the pattern should be:<br></p>\n<pre><code>-I=${path_variable}/a/sample \\\n-I=${path_variable}/b/sample \\\n</code></pre>\n<p>Hope this might help someone!</p>\n"}], "owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7969, "favorite_count": 2, "answer_count": 2, "score": 4, "last_activity_date": 1611514023, "creation_date": 1490515336, "last_edit_date": 1592644375, "question_id": 43026449, "link": "https://stackoverflow.com/questions/43026449/gogo-proto-file-not-found", "title": "gogo.proto: File not found", "body": "<p><code>protoc --gogofaster_out=. image.proto</code></p>\n<p>I get this error message</p>\n<blockquote>\n<p>/home/abc/src/github.com/gogo/protobuf/gogoproto/gogo.proto: File not found.</p>\n<p>image.proto: Import &quot;/home/abc/src/github.com/gogo/protobuf/gogoproto/gogo.proto&quot; was not found or had errors.</p>\n</blockquote>\n<p>The file is definitely there. I can reach it from the reported path in the error.</p>\n<p>My proto file looks like this:</p>\n<pre><code>package image;\n\nimport &quot;/home/abc/src/github.com/gogo/protobuf/gogoproto/gogo.proto&quot;;\n\nmessage Frame {\nrequired bool fragment = 1; \nrequired int32  fragmentID = 2; \nrequired bool lastFragment = 3; \nrequired bytes data = 4;\n}\n</code></pre>\n<p>I have a <code>Makefile</code> in the dir where the proto file is. Looks like this:</p>\n<pre><code>regenerate:\n--proto_path=../../github.com/gogo/protobuf/gogoproto:../../github.com/gogo/protobuf/protobuf/google/protobuf:. --gogofaster_out=. *.proto\n</code></pre>\n<p>What can I do to resolve the path error?</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 9441, "user_id": 1000254, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e1621f7d5eef73c430632061efdc97b0?s=128&d=identicon&r=PG", "display_name": "shizhz", "link": "https://stackoverflow.com/users/1000254/shizhz"}, "is_accepted": true, "score": 51, "last_activity_date": 1490517454, "last_edit_date": 1490517454, "creation_date": 1490516202, "answer_id": 43026557, "question_id": 43026379, "link": "https://stackoverflow.com/questions/43026379/multiple-conditions-in-if-statement-go-templates/43026557#43026557", "title": "multiple conditions in if statement Go templates", "body": "<p>You need to use <a href=\"https://golang.org/pkg/text/template/#hdr-Functions\" rel=\"noreferrer\">function <code>and</code></a>, like:</p>\n\n<pre><code>{{ if and .condition1 .condition2 }}\n&lt;!-- SHOW SOMETHING --&gt;\n{{ end }}\n</code></pre>\n\n<p>Here's an working example: <a href=\"https://play.golang.org/p/g_itE5ggCM\" rel=\"noreferrer\">https://play.golang.org/p/g_itE5ggCM</a></p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 10737950, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1DC8-yxdCaI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-ibXUh-TifqvKo2pYIjA-cTo3OJKw/mo/photo.jpg?sz=128", "display_name": "suchjs", "link": "https://stackoverflow.com/users/10737950/suchjs"}, "is_accepted": false, "score": -3, "last_activity_date": 1561544388, "creation_date": 1561544388, "answer_id": 56770452, "question_id": 43026379, "link": "https://stackoverflow.com/questions/43026379/multiple-conditions-in-if-statement-go-templates/56770452#56770452", "title": "multiple conditions in if statement Go templates", "body": "<p>You can also have a try with my go project <a href=\"https://github.com/fefit/fet\" rel=\"nofollow noreferrer\">the fet template engineer</a>, compile your \"smarty like\" code into <code>html/template</code> code, support expressions, improve your writing experience. </p>\n"}], "owner": {"reputation": 427, "user_id": 6295160, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/28ddf42297c37b26edb73d36e39bb1cb?s=128&d=identicon&r=PG&f=1", "display_name": "Berry Jones", "link": "https://stackoverflow.com/users/6295160/berry-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26961, "favorite_count": 3, "accepted_answer_id": 43026557, "answer_count": 2, "score": 28, "last_activity_date": 1561544388, "creation_date": 1490514744, "last_edit_date": 1490517298, "question_id": 43026379, "link": "https://stackoverflow.com/questions/43026379/multiple-conditions-in-if-statement-go-templates", "title": "multiple conditions in if statement Go templates", "body": "<p>how can I have multiple conditions in an if statement inside a template?</p>\n\n<p>I tried this code:</p>\n\n<pre><code>{{ if .condition1 &amp;&amp; .condition2 }}\n    &lt;!-- SHOW SOMETHING --&gt;\n{{ end }}\n</code></pre>\n\n<p>But it doesn't work. (in fact it panics)</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 563, "user_id": 4093473, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-bsbaM7Sy2tU/AAAAAAAAAAI/AAAAAAAAABU/QkjCVrm0kg0/photo.jpg?sz=128", "display_name": "swade", "link": "https://stackoverflow.com/users/4093473/swade"}, "edited": false, "score": 0, "creation_date": 1560899061, "post_id": 43024733, "comment_id": 99885903, "body": "Little do they tell you that parsing nanoseconds needs to be preceded by a period. <code>15-04-05-000</code> does not work but <code>15-05-05.000</code> does."}], "tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 4, "last_activity_date": 1490499591, "creation_date": 1490499591, "answer_id": 43024733, "question_id": 43024628, "link": "https://stackoverflow.com/questions/43024628/error-parsing-time-in-go-with-variable-number-of-microseconds/43024733#43024733", "title": "Error parsing time in Go with variable number of microseconds", "body": "<p>Use 9s instead of zeros in the subsecond format, <a href=\"https://play.golang.org/p/FnzPeOPcfQ\" rel=\"nofollow noreferrer\">for example</a>:</p>\n\n<pre><code>timeText := \"2017-03-25T10:01:02.1234567Z\"\nlayout := \"2006-01-02T15:04:05.99Z\"\nt, _ := time.Parse(layout, timeText)\nfmt.Println(t) //prints 2017-03-25 10:01:02.1234567 +0000 UTC\n</code></pre>\n\n<p>From the <a href=\"https://golang.org/pkg/time/#example_Time_Format\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<pre><code>// Fractional seconds can be printed by adding a run of 0s or 9s after\n// a decimal point in the seconds value in the layout string.\n// If the layout digits are 0s, the fractional second is of the specified\n// width. Note that the output has a trailing zero.\ndo(\"0s for fraction\", \"15:04:05.00000\", \"11:06:39.12340\")\n\n// If the fraction in the layout is 9s, trailing zeros are dropped.\ndo(\"9s for fraction\", \"15:04:05.99999999\", \"11:06:39.1234\")\n</code></pre>\n"}], "owner": {"reputation": 1159, "user_id": 989962, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/zMiu3.jpg?s=128&g=1", "display_name": "BlueSky", "link": "https://stackoverflow.com/users/989962/bluesky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 1, "accepted_answer_id": 43024733, "answer_count": 1, "score": 1, "last_activity_date": 1490499591, "creation_date": 1490498576, "question_id": 43024628, "link": "https://stackoverflow.com/questions/43024628/error-parsing-time-in-go-with-variable-number-of-microseconds", "title": "Error parsing time in Go with variable number of microseconds", "body": "<p>I'm trying to parse a string into a time object.  The issue is that the number of digits in the microseconds term changes, which breaks the parsing.  For example, this works fine:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    timeText := \"2017-03-25T10:01:02.1234567Z\"\n    layout := \"2006-01-02T15:04:05.0000000Z\"\n    t, _ := time.Parse(layout, timeText)\n    fmt.Println(t)\n}\n</code></pre>\n\n<p>But this causes an error, because the number of microseconds digits doesn't match the layout:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    timeText := \"2017-03-25T10:01:02.123Z\" // notice only 3 microseconds digits here\n    layout := \"2006-01-02T15:04:05.0000000Z\"\n    t, _ := time.Parse(layout, timeText)\n    fmt.Println(t)\n}\n</code></pre>\n\n<p>How do I fix this so that the microseconds term is still parsed, but it doesn't matter how many digits there are?</p>\n"}, {"tags": ["go", "goquery"], "comments": [{"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 1, "creation_date": 1490514882, "post_id": 43023935, "comment_id": 73139120, "body": "I don\u2019t understand your problem. I ran your code, and it looks like it is doing what you ask for. Could you give an example of what you get and how it differs from what you expect?"}, {"owner": {"reputation": 2975, "user_id": 400149, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/5DP00.jpg?s=128&g=1", "display_name": "Jet Basrawi", "link": "https://stackoverflow.com/users/400149/jet-basrawi"}, "reply_to_user": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1490563320, "post_id": 43023935, "comment_id": 73154708, "body": "You are quite correct. The html files that I am processing are quite large and it turns out they are not valid. They have unclosed elements that is causing the problems."}], "answers": [{"tags": [], "owner": {"reputation": 2975, "user_id": 400149, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/5DP00.jpg?s=128&g=1", "display_name": "Jet Basrawi", "link": "https://stackoverflow.com/users/400149/jet-basrawi"}, "is_accepted": false, "score": 0, "last_activity_date": 1490563498, "creation_date": 1490563498, "answer_id": 43034717, "question_id": 43023935, "link": "https://stackoverflow.com/questions/43023935/limit-the-scope-of-selector-find-to-the-selected-element/43034717#43034717", "title": "Limit the scope of selector.Find() to the selected element", "body": "<p>The problem was unclosed elements in the HTML files that I am processing. </p>\n"}], "owner": {"reputation": 2975, "user_id": 400149, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/5DP00.jpg?s=128&g=1", "display_name": "Jet Basrawi", "link": "https://stackoverflow.com/users/400149/jet-basrawi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490563498, "creation_date": 1490491510, "question_id": 43023935, "link": "https://stackoverflow.com/questions/43023935/limit-the-scope-of-selector-find-to-the-selected-element", "title": "Limit the scope of selector.Find() to the selected element", "body": "<p>I am trying to extract the date and text from HTML with the following structure. I am using goquery to do this.</p>\n\n<pre><code>&lt;body&gt;\n&lt;div class=\"wrap\"&gt;\n    &lt;div class=\"cont\"&gt;\n        &lt;div class=\"cont_block\"&gt;\n            &lt;p class=\"date\"&gt;\n                &lt;font&gt;\n                    &lt;font&gt;Saturday, Apr 16,2016&lt;/font&gt;\n                &lt;/font&gt;\n            &lt;/p&gt;\n            &lt;div class=\"block_table\"&gt;\n                &lt;table class=\"left\" width=\"auto\" height=\"auto\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\n                    &lt;tbody&gt;\n                        &lt;tr&gt;\n                            &lt;td class=\"left_top2\"&gt;&lt;/td&gt;\n                            &lt;td width=\"auto\" class=\"bg_color2\" height=\"12\"&gt;&lt;/td&gt;\n                            &lt;td class=\"right_top2\"&gt;&lt;/td&gt;\n                        &lt;/tr&gt;\n                        &lt;tr&gt;\n                            &lt;td height=\"auto\" class=\"right_mid2\"&gt;&lt;/td&gt;\n                            &lt;td class=\"bg_color2\"&gt;\n                                &lt;font&gt;\n                                    &lt;font&gt;Loerem ipsum dolor sit amet&lt;/font&gt;\n                                &lt;/font&gt;\n                            &lt;/td&gt;\n                            &lt;td class=\"bg_color2\" width=\"14\"&gt;&lt;/td&gt;\n                        &lt;/tr&gt;\n                        &lt;tr&gt;\n                            &lt;td class=\"left_bottom2\"&gt;&lt;/td&gt;\n                            &lt;td class=\"bg_color2\"&gt;&lt;/td&gt;\n                            &lt;td class=\"right_bottom2\"&gt;&lt;/td&gt;\n                        &lt;/tr&gt;\n                    &lt;/tbody&gt;\n                &lt;/table&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"cont_block\"&gt;\n            &lt;p class=\"date\"&gt;Friday,Dec 18,2015&lt;/p&gt;\n            &lt;div class=\"block_table\"&gt;\n                &lt;table class=\"right\" width=\"auto\" height=\"auto\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\n                    &lt;tbody&gt;\n                        &lt;tr&gt;\n                            &lt;td class=\"left_top3\"&gt;&lt;/td&gt;\n                            &lt;td width=\"auto\" class=\"bg_color3\" height=\"12\"&gt;&lt;/td&gt;\n                            &lt;td class=\"right_top3\"&gt;&lt;/td&gt;\n                        &lt;/tr&gt;\n                        &lt;tr&gt;\n                            &lt;td height=\"auto\" class=\"bg_color3\" width=\"14\"&gt;&amp;nbsp;&lt;/td&gt;\n                            &lt;td class=\"bg_color3\"&gt;Loerem ipsum dolor sit amet&lt;/td&gt;\n                            &lt;td class=\"right_mid3\"&gt;&lt;/td&gt;\n                        &lt;/tr&gt;\n                        &lt;tr&gt;\n                            &lt;td class=\"left_bottom3\"&gt;&lt;/td&gt;\n                            &lt;td class=\"bg_color3\"&gt;&lt;/td&gt;\n                            &lt;td class=\"right_bottom3\"&gt;&lt;/td&gt;\n                        &lt;/tr&gt;\n                    &lt;/tbody&gt;\n                &lt;/table&gt;\n            &lt;/div&gt;\n            &lt;div class=\"block_table\"&gt;\n                &lt;table class=\"right\" width=\"auto\" height=\"auto\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\n                    &lt;tbody&gt;\n                        &lt;tr&gt;\n                            &lt;td class=\"left_top3\"&gt;&lt;/td&gt;\n                            &lt;td width=\"auto\" class=\"bg_color3\" height=\"12\"&gt;&lt;/td&gt;\n                            &lt;td class=\"right_top3\"&gt;&lt;/td&gt;\n                        &lt;/tr&gt;\n                        &lt;tr&gt;\n                            &lt;td height=\"auto\" class=\"bg_color3\" width=\"14\"&gt;&amp;nbsp;&lt;/td&gt;\n                            &lt;td class=\"bg_color3\"&gt;Loerem ipsum dolor sit amet&lt;/td&gt;\n                            &lt;td class=\"right_mid3\"&gt;&lt;/td&gt;\n                        &lt;/tr&gt;\n                        &lt;tr&gt;\n                            &lt;td class=\"left_bottom3\"&gt;&lt;/td&gt;\n                            &lt;td class=\"bg_color3\"&gt;&lt;/td&gt;\n                            &lt;td class=\"right_bottom3\"&gt;&lt;/td&gt;\n                        &lt;/tr&gt;\n                    &lt;/tbody&gt;\n                &lt;/table&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p>I have tried many ways of doing this for example:</p>\n\n<pre><code>doc.Find(\".wrap .cont .cont_block\").Each(func(i int, s *goquery.Selection) {\n    fmt.Println(s.Find(\".date\").Text())\n    s.Find(\".block_table td\").Each(func(j int, c *goquery.Selection){\n        if c.Text() != \"\" {\n           fmt.Println(c.Text())\n        }\n    })\n})\n</code></pre>\n\n<p>The problem is that the results returned by the find for the dates and the text return results that are outside of the scope of the .cont_block. Basically it returns all of the dates and td from the document that are below the currently selected .cont_block on each iteration.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490489904, "post_id": 43023702, "comment_id": 73134579, "body": "It is slightly flaky to implement a function in such a way: now you rely on the caller to provide a large enough slice, and panic otherwise."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490490605, "post_id": 43023702, "comment_id": 73134721, "body": "I know, but how can I make it different, to make it work?"}], "answers": [{"comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1490495143, "post_id": 43024122, "comment_id": 73135532, "body": "Faster, but isn&#39;t it incorrect? I think your <code>append</code> should go before the assignment of <code>element</code> to <code>pre[index]</code>. <a href=\"https://play.golang.org/p/ng7dX2rLKm\" rel=\"nofollow noreferrer\">play.golang.org/p/ng7dX2rLKm</a>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1490495802, "post_id": 43024122, "comment_id": 73135667, "body": "You are right, it is still referencing the same elements of the slice. I fixed it now. A new one has to be allocated, which slows things down. Still, this trick is about twice as fast... unfortunate that it isn&#39;t as cool as I originally thought. <a href=\"https://play.golang.org/p/GywtiP3Lun\" rel=\"nofollow noreferrer\">play.golang.org/p/GywtiP3Lun</a>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1490496269, "post_id": 43024122, "comment_id": 73135761, "body": "@PaulHankin Ok, here, now it&#39;s super fast AND correct. <a href=\"https://play.golang.org/p/vdYQGXSZas\" rel=\"nofollow noreferrer\">play.golang.org/p/vdYQGXSZas</a>"}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490496411, "post_id": 43024122, "comment_id": 73135790, "body": "And what if I cannot use append (have to make about every algorithm by myself). And btw I checked your version, its faster, but the graph looks like this (should be aproximately a straight line) <a href=\"https://gyazo.com/ff670cd918aa89bbec8add2169ccf431\" rel=\"nofollow noreferrer\">gyazo.com/ff670cd918aa89bbec8add2169ccf431</a>"}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490497002, "post_id": 43024122, "comment_id": 73135886, "body": "I mean the data you got is fine enough I guess (times get bigger x2, x1.5, x1.33, x1.25), but in my case its not. Did you change the tests somehow?  @Edit, okay I tested it on Windows and it works really nice, I guess I will have to say goodbye to Linux on VM :("}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490497242, "post_id": 43024122, "comment_id": 73135925, "body": "Oh, well if that&#39;s a requirement, then Go tricks are probably out... my bad. That wasn&#39;t mentioned in the question. As far as why the bench results seem off, it&#39;s because I forgot that I added the <code>n % 1000</code> stuff in. The memory allocation in the <code>make</code> is taking longer than your <code>Insert</code> code. So as far as the original benchmarking question goes, yes you MUST limit the number of calls to <code>make</code> because its cost far outweighs your function."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490497824, "post_id": 43024122, "comment_id": 73136051, "body": "So by limiting the number of calls you mean what? :D"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490498132, "post_id": 43024122, "comment_id": 73136119, "body": "I&#39;ll add the benchmark function to show what I mean."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490498555, "post_id": 43024122, "comment_id": 73136194, "body": "Okay, now I see. But then for what array sizes do you measure?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490498888, "post_id": 43024122, "comment_id": 73136248, "body": "Turns out that tuning the value of <code>inserts</code> to 100 gives about the same results, which means that this 100 overhead in size is small enough to ignore when having your test sizes in the 10k+ range."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490498990, "post_id": 43024122, "comment_id": 73136263, "body": "But why would you add it?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490499108, "post_id": 43024122, "comment_id": 73136279, "body": "The way your insert function works requires there to be enough capacity in the slice or it will panic. It just creates the slice with 10k items, but it can grow to 10101 without having to reallocate a new one (which is what <code>append</code> will do for you automatically)."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490499675, "post_id": 43024122, "comment_id": 73136368, "body": "Okay, but I don&#39;t actually want <code>Insert()</code> to be universal. I did <code>make([]int, size, size+1</code> on purpose, that <code>+1</code> ensures that there will be no capacity problem. The program then gets 10k array (10k+1 capacity), adds 1 element, gets 20k array (20k+1 capacity), adds 1 element and so on"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490500952, "post_id": 43024122, "comment_id": 73136565, "body": "Finally came up with the best solution. <code>make</code> is called only once, and it does it on the exact size slice as you want it. I also cleaned up all the garbage in the answer so it&#39;s more clear."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490501233, "post_id": 43024122, "comment_id": 73136614, "body": "Okay, so <code>array = array[0:size]</code> is measured as well, but its not as much time-consuming, so it doesn&#39;t really matter, right?"}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490501512, "post_id": 43024122, "comment_id": 73136657, "body": "<code>BenchmarkInsert10k-4       50000             24307 ns&#47;op BenchmarkInsert20k-4       30000             45298 ns&#47;op BenchmarkInsert30k-4       10000            170921 ns&#47;op BenchmarkInsert40k-4        5000            232264 ns&#47;op BenchmarkInsert50k-4        5000            297310 ns&#47;op</code> -&gt; the first two are perfectly fine, but the other ones, ugh"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490501643, "post_id": 43024122, "comment_id": 73136686, "body": "Added explanation of why resizing is cheap. Along with documentation."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490501927, "post_id": 43024122, "comment_id": 73136741, "body": "Okay, I get this, thank you :D But as I wrote before, there is a strange jump between 200k and 300k. I tested it several times, always the same. Between 100k and 200k there should be 2x time - okay, Between 200 and 300 1.5x -  there is NOT. But then again 300 and 400 -&gt; 1.333333, and 400 and 500 -&gt; 1.25. Why does it have this strange behaviour between 200k and 300k?"}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490502201, "post_id": 43024122, "comment_id": 73136794, "body": "And I tested it for 10x smaller numbers (remove 0 for every one :D). And it works. The times are aproximately in a straight line. Is there maybe some type change, or something which appears on some number between 200k and 300k?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490502618, "post_id": 43024122, "comment_id": 73136854, "body": "It scales linearly on my machine, not sure what&#39;s up on yours. I edited with benchmarks and the entire go source I ran it on."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490502932, "post_id": 43024122, "comment_id": 73136907, "body": "Oh, it&#39;s because you are making the wrong assumption. Between those values you are not doubling, you will only get 2x time when you double, not go from 400 -&gt; 500 etc."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490504163, "post_id": 43024122, "comment_id": 73137106, "body": "Okay, I know. But from 100k to 200k I get the double. So from 200k to 300k I should get 1.5x, but I get like 4x, check the code I copied few comments ago"}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 1, "last_activity_date": 1490502563, "last_edit_date": 1490502563, "creation_date": 1490493373, "answer_id": 43024122, "question_id": 43023702, "link": "https://stackoverflow.com/questions/43023702/testing-a-function-in-golang/43024122#43024122", "title": "Testing a function in golang", "body": "<p>EDIT: The real answer you seek. (Finally)</p>\n\n<p>When you benchmark, actually benchmark what you want to benchmark. Your use case isn't going to be a make, then insert every time, so just make once, then test insert in the loop. The point is to test ONLY the chokepoint.</p>\n\n<p>What you want to do here is just test <code>Insert</code>. You can do this by simply resizing the array each time, the cost of which is basically nothing (at least in comparison to <code>make</code> or <code>Insert</code>). </p>\n\n<pre><code>func benchmarkInsert(size int, b *testing.B) { \n    array := make([]int, size, size+1) \n    b.ResetTimer()\n    for n := 0; n &lt; b.N; n++ {\n        array = Insert(array, 1, len(array)/2)\n        array = array[0:size]\n    }\n}\n</code></pre>\n\n<p>To explain why it is minimal, you have to realize that deep down, a slice is essentially a struct that looks something like this:</p>\n\n<pre><code>type Slice struct {\n    contents []interface{}\n    length   int\n    capacity int\n}\n</code></pre>\n\n<p>Performing the operation to resize it using <code>array = array[0:size]</code> is analogous to setting the struct's <code>length=size</code>. See <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-slices-usage-and-internals</a></p>\n\n<p>As far as writing the results to file, that depends on your operating system. On any Unix system, simply running the benchmark command with <code>&gt; file.txt</code> at the end will pipe the results to <code>file.txt</code>. Not sure about Windows.</p>\n\n<p>EDIT: Adding more tests shows this scales linearly.</p>\n\n<pre><code>BenchmarkInsert10k-8          200000          7889 ns/op\nBenchmarkInsert20k-8          100000         16131 ns/op\nBenchmarkInsert30k-8          100000         24184 ns/op\nBenchmarkInsert40k-8           50000         31767 ns/op\nBenchmarkInsert50k-8           50000         39721 ns/op\nBenchmarkInsert100k-8          20000         79711 ns/op\nBenchmarkInsert200k-8          10000        159411 ns/op\nBenchmarkInsert300k-8           5000        237188 ns/op\nBenchmarkInsert400k-8           5000        316270 ns/op\nBenchmarkInsert500k-8           3000        399146 ns/op\nBenchmarkInsert1000k-8          2000        793845 ns/op\n</code></pre>\n\n<p>Using this code: <a href=\"https://play.golang.org/p/6fWHwpzUJE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/6fWHwpzUJE</a></p>\n"}, {"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490556603, "post_id": 43029297, "comment_id": 73152346, "body": "One of my edits had a faster algorithm :P. Haha, sorry, just teasing. OP wasn&#39;t going for optimization anyway, so I removed the clutter from my answer."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1490536719, "last_edit_date": 1490536719, "creation_date": 1490534664, "answer_id": 43029297, "question_id": 43023702, "link": "https://stackoverflow.com/questions/43023702/testing-a-function-in-golang/43029297#43029297", "title": "Testing a function in golang", "body": "<p>For example (from Go 1.7 forward), using your <code>Insert</code> algorithm,</p>\n\n<pre><code>package sdizo\n\nimport (\n    \"strconv\"\n    \"testing\"\n)\n\nfunc Insert(slice []int, element int, index int) []int {\n    n := len(slice)\n    slice = slice[:(n + 1)]\n    for i := index; i &lt; n; i++ {\n        slice[i+1] = slice[i]\n    }\n    slice[index] = element\n    return slice\n}\n\nfunc BenchmarkInsert(b *testing.B) {\n    for size := 10000; size &lt;= 50000; size += 10000 {\n\n        b.Run(strconv.Itoa(size/1000)+\"k\",\n\n            func(b *testing.B) {\n                a := make([]int, size, size+1)\n                b.ReportAllocs()\n                b.ResetTimer()\n                for i := 0; i &lt; b.N; i++ {\n                    a = a[:size]\n                    a = Insert(a, 1, len(a)/2)\n                }\n                b.StopTimer()\n            },\n        )\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go test -bench=.\ngoos: linux\ngoarch: amd64\npkg: sdizo\nBenchmarkInsert/10k-4         50000      32502 ns/op       0 B/op      0 allocs/op\nBenchmarkInsert/20k-4         20000      64364 ns/op       0 B/op      0 allocs/op\nBenchmarkInsert/30k-4         20000      97310 ns/op       0 B/op      0 allocs/op\nBenchmarkInsert/40k-4         10000     129196 ns/op       0 B/op      0 allocs/op\nBenchmarkInsert/50k-4         10000     161427 ns/op       0 B/op      0 allocs/op\nPASS\nok      so/sdizo    9.778s\n$ \n</code></pre>\n\n<p>Now that we can benchmark your <code>Insert</code> algorithm, we can use that knowledge to improve the algorithm. For example,</p>\n\n<pre><code>package sdizo\n\nimport (\n    \"strconv\"\n    \"testing\"\n)\n\nfunc Insert(slice []int, element int, index int) []int {\n    slice = slice[:len(slice)+1]\n    copy(slice[index+1:], slice[index:])\n    slice[index] = element\n    return slice\n}\n\nfunc BenchmarkInsert(b *testing.B) {\n    for size := 10000; size &lt;= 50000; size += 10000 {\n\n        b.Run(strconv.Itoa(size/1000)+\"k\",\n\n            func(b *testing.B) {\n                a := make([]int, size, size+1)\n                b.ReportAllocs()\n                b.ResetTimer()\n                for i := 0; i &lt; b.N; i++ {\n                    a = a[:size]\n                    a = Insert(a, 1, len(a)/2)\n                }\n                b.StopTimer()\n            },\n        )\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go test -bench=.\ngoos: linux\ngoarch: amd64\npkg: sdizo\nBenchmarkInsert/10k-4        200000       7664 ns/op       0 B/op      0 allocs/op\nBenchmarkInsert/20k-4        100000      15208 ns/op       0 B/op      0 allocs/op\nBenchmarkInsert/30k-4        100000      22959 ns/op       0 B/op      0 allocs/op\nBenchmarkInsert/40k-4         50000      35181 ns/op       0 B/op      0 allocs/op\nBenchmarkInsert/50k-4         50000      39658 ns/op       0 B/op      0 allocs/op\nPASS\nok      so/sdizo    10.331s\n$\n</code></pre>\n"}], "owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1070, "favorite_count": 1, "accepted_answer_id": 43029297, "answer_count": 2, "score": 2, "last_activity_date": 1490536719, "creation_date": 1490489273, "question_id": 43023702, "link": "https://stackoverflow.com/questions/43023702/testing-a-function-in-golang", "title": "Testing a function in golang", "body": "<p>So I've decided to write test for my function in <code>golang</code>. The function itself looks like this:</p>\n\n<pre><code>func Insert(slice []int, element int, index int) []int {\n    n := len(slice)\n    slice = slice[:(n + 1)]\n    for i := index; i &lt; n; i++ {\n        slice[i+1] = slice[i]\n    }\n    slice[index] = element\n    return slice\n} \n</code></pre>\n\n<p>So it takes a slice, extends its length by 1 and inserts an element at given index. Now before I call it I have to do 2 things:</p>\n\n<pre><code>size := somevalue\narray := make([]int, size, size+1)\n</code></pre>\n\n<p>and then f.e <code>array = Insert(array, 1, len(array)/2</code>. Now I wrote <code>insert_test.go</code>:</p>\n\n<pre><code>package sdizo\n\nimport \"testing\"\n\nfunc benchmarkInsert(size int, b *testing.B) {  \n    b.ResetTimer()\n    for n := 0; n &lt; b.N; n++ {\n        array := make([]int, size, size+1)\n        array = Insert(array, 1, len(array)/2)\n    }\n}\nfunc BenchmarkInsert10k(b *testing.B) { benchmarkInsert(10000, b) }\nfunc BenchmarkInsert20k(b *testing.B) { benchmarkInsert(20000, b) }\nfunc BenchmarkInsert30k(b *testing.B) { benchmarkInsert(30000, b) }\nfunc BenchmarkInsert40k(b *testing.B) { benchmarkInsert(40000, b) }\nfunc BenchmarkInsert50k(b *testing.B) { benchmarkInsert(50000, b) }\n</code></pre>\n\n<p>The thing is, there are 2 operations in testing loop. I cannot move the <code>make()</code> above the loop, cuz it has to make a new array everytime it tries to insert something to it (don't want to mess with capacity). It works, it gives me output, but I am curious if this <code>make()</code> doesn't mess up with time measurement, and I would like to ask you if I can somehow measure the time only for <code>Insert()</code></p>\n\n<p>P.S Is there a convenient way to write down the results of benchmark test to a file?</p>\n"}, {"tags": ["xml", "go", "marshalling"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1490481991, "post_id": 43022817, "comment_id": 73132922, "body": "All your struct fields names need to be exported (i.e. start with an uppercase letter). You also have a missing <code>&quot;</code> in the status field tag: <a href=\"https://play.golang.org/p/Uf1jsEjlah\" rel=\"nofollow noreferrer\">play.golang.org/p/Uf1jsEjlah</a>"}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1490483153, "post_id": 43022817, "comment_id": 73133204, "body": "Yeah..it is good now, thnx, appreciate."}], "owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490481849, "creation_date": 1490481849, "question_id": 43022817, "link": "https://stackoverflow.com/questions/43022817/how-to-correctly-unmarshall-xml-into-go-struct", "title": "How to correctly unmarshall xml into Go struct", "body": "<p>I have xml which I want to unmarshal into Session struct </p>\n\n<pre><code>type Session struct {\n    XMLName xml.Name `xml:\"response\"`\n    status  string `xml:\"status,attr`\n    Result  Result `xml:\"result\"`\n}\ntype Result struct {\n    tmo_udp string `xml:\"tmo-udp\"`\n    tmo_tcp string `xml:\"tmo-tcp\"`\n    }\nvar session Session\n    xml.Unmarshal(htmlData, &amp;session)\n    fmt.Println(string(htmlData))\n    fmt.Println(\"-------------------------------------------------\")\n    fmt.Println(session)\n</code></pre>\n\n<p>but got nothing when trying to print it</p>\n\n<pre><code>&lt;response status=\"success\"&gt;&lt;result&gt;\n  &lt;tmo-udp&gt;30&lt;/tmo-udp&gt;\n  &lt;tmo-tcp&gt;3600&lt;/tmo-tcp&gt;\n&lt;/result&gt;&lt;/response&gt;\n-------------------------------------------------\n{{ response}  {                                }}\n</code></pre>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1490482595, "post_id": 43022769, "comment_id": 73133088, "body": "<i>WHY</i> would you want to implement a dynamic array in a language that has dynamic arrays already? In Go, use slices, they <i>are</i> dynamic arrays."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1490482617, "post_id": 43022769, "comment_id": 73133092, "body": "Seriously, it&#39;s like trying to write your own list implementation in Python."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1490482629, "post_id": 43022769, "comment_id": 73133094, "body": "Well I study at University, so what I have to do, I do"}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1490482634, "post_id": 43022769, "comment_id": 73133096, "body": "I don&#39;t think there is any benefit in implementing data types already available in the language like arrays, slices and maps. You will get into chicken and egg problems. Maybe try some more complicated data structures."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1490483569, "post_id": 43022769, "comment_id": 73133281, "body": "Go&#39;s testing package has benchmarking which is what you should use for timing tests."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1490483635, "post_id": 43022769, "comment_id": 73133301, "body": "The base type for implementing a dynamic array is a static array. If you really want to, use Go&#39;s basic array as the base type. That is what a Go slice does, after all. A Go slice is a pointer to the array, a capacity and a length."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1490484808, "post_id": 43022769, "comment_id": 73133588, "body": "Okay, thank you. But can I reallocate memory for a static array in Go (like with <code>new&#47;delete[]</code> in C++?"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1490560899, "post_id": 43022769, "comment_id": 73153918, "body": "Go is a garbage collected language.  Memory management is done for you. It even handles whats on the stack or the heap. Read Here  <a href=\"https://deferpanic.com/blog/manual-memory-management-in-go/\" rel=\"nofollow noreferrer\">deferpanic.com/blog/manual-memory-management-in-go</a>"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1490643928, "post_id": 43022769, "comment_id": 73194844, "body": "@Frynio: You declare a new, bigger array and then copy the old array into it. Just like you do in C++."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1490664835, "post_id": 43022769, "comment_id": 73202753, "body": "@ZanLynx, using <code>make()</code>?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1490690501, "post_id": 43022769, "comment_id": 73213072, "body": "@Frynio No, <code>make</code> creates a slice. Basic arrays are a part of the Go language and you just use <code>var arr [1024]byte</code>"}], "owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 622, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490482011, "creation_date": 1490481511, "last_edit_date": 1490482011, "question_id": 43022769, "link": "https://stackoverflow.com/questions/43022769/implementing-data-structures-in-golang", "title": "Implementing data structures in golang", "body": "<p>So I have to implement some data structures in a language compiled to native-code. I did that in C++, but now I wanted to try another language, that I didn't worked with before. I chose <code>golang</code>. First data structure would be an array (capable of dynamic append, removal, etc.) In C++ I got something like this:</p>\n\n<pre><code>class array{\n    int n;\n    int *t;\n    .\n    .\n    .\n}\n</code></pre>\n\n<p>So <code>n</code> is the number of elements and <code>*t</code> is a pointer to an array, which would be created in a constructor. I wrote <code>append</code>, <code>pop_back</code>, <code>remove</code>, <code>find</code> methods and so on. Now when I switch to golang, my first attempt was to create a <code>struct</code> something like this:</p>\n\n<pre><code>type array struct {\n    n int\n    ...\n}\n</code></pre>\n\n<p>and well I didn't know what should be here instead of dots. So I did some reading (got Brian W. Kernighan book) and I found about 2 data types : <code>arrays</code> and <code>slices</code>. I found a piece of code for appending to the array (take an array, resize it (n+1) and insert a value). I tested it, works (I tested it on a built-in <code>slice</code> type). Now when I would have my own array type I don't know if I should use <code>slice</code>, or maybe something else. I have this piece of code, which would measure the times for <code>Append()</code> operation, depending on the number of elements:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype array struct {\n    n int\n}\nfunc Append(slice []int, element int) []int {\n    n := len(slice)\n    total := len(slice) + 1\n    if total &gt; cap(slice) {\n        // Reallocate. Grow to 1.5 times the new size, so we can still grow.\n        newSize := total*3/2 + 1\n        newSlice := make([]int, total, newSize)\n        copy(newSlice, slice)\n        slice = newSlice\n    }\n    slice = slice[:total]\n    slice[n] = element\n    return slice\n}\n\nfunc main() {\n    var seconds int64 = 0\n    sizes := [5]int64{1000, 5000, 10000, 50000, 100000}\n    for i := 0; i &lt; 5; i++ {\n        var j int64\n        for j = 0; j &lt; 100; j++ {\n            array := make([]int, sizes[i], sizes[i]+1)\n            start := time.Now()\n            array = Append(array, 1)\n            elapsed := time.Since(start)\n            seconds += int64(elapsed)\n        }\n        seconds = seconds/100\n        fmt.Println(seconds)\n        seconds = 0\n    }\n    fmt.Println(\"The end\")\n}\n</code></pre>\n\n<p>I always do <code>array := make([]int, sizes[i], sizes[i]+1)</code> cuz I don't want to make capacity changing and copying be relevant here. As far as I know there should be no difference if array has 1000 elements or 100000 - the time should be approximately the same, but the results I've got are different : </p>\n\n<pre><code>1810\n1589\n46\n99\n244\nThe end\n</code></pre>\n\n<p>The times differ. Now my questions are:</p>\n\n<ol>\n<li>What basic type should I use in my own array type?</li>\n<li>Can I somehow reallocate the memory (increment/decrement the length) without operating on capacity?</li>\n<li>Is there a way to change this algorithm to make its computional complexity <code>O(1)</code>, so it doesn't matter how many arguments are there?</li>\n</ol>\n"}, {"tags": ["logging", "go"], "answers": [{"tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": false, "score": 1, "last_activity_date": 1490481772, "creation_date": 1490481772, "answer_id": 43022806, "question_id": 43022607, "link": "https://stackoverflow.com/questions/43022607/how-do-i-disable-field-name-in-logrus-while-logging-to-file/43022806#43022806", "title": "How do I disable field name in logrus while logging to file", "body": "<p>You need to write a custom formatter that emits only the fields you want to see.</p>\n\n<p>There is an example in the <a href=\"https://github.com/sirupsen/logrus#formatters\" rel=\"nofollow noreferrer\">logrus readme</a>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type MyJSONFormatter struct {\n}\n\nlog.SetFormatter(new(MyJSONFormatter))\n\nfunc (f *MyJSONFormatter) Format(entry *Entry) ([]byte, error) {\n  // Note this doesn't include Time, Level and Message which are available on\n  // the Entry. Consult `godoc` on information about those fields or read the\n  // source of the official loggers.\n  serialized, err := json.Marshal(entry.Data)\n    if err != nil {\n      return nil, fmt.Errorf(\"Failed to marshal fields to JSON, %v\", err)\n    }\n  return append(serialized, '\\n'), nil\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2302, "user_id": 2054434, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/e8f5c753d781ce498b857ec9b7ce366f?s=128&d=identicon&r=PG&f=1", "display_name": "PlayHardGoPro", "link": "https://stackoverflow.com/users/2054434/playhardgopro"}, "edited": false, "score": 0, "creation_date": 1585775357, "post_id": 44865886, "comment_id": 107885850, "body": "Thanks for this example. Is it possible to use it with <code>logrus.WithFields</code>? I tried but didn&#39;t sucess."}, {"owner": {"reputation": 2302, "user_id": 2054434, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/e8f5c753d781ce498b857ec9b7ce366f?s=128&d=identicon&r=PG&f=1", "display_name": "PlayHardGoPro", "link": "https://stackoverflow.com/users/2054434/playhardgopro"}, "edited": false, "score": 0, "creation_date": 1585778450, "post_id": 44865886, "comment_id": 107886966, "body": "Also, I don&#39;t get it how the &quot;Format&quot; function works if you never call it. I added one more field to <code>PLainFormatter</code> but it gave me an error. How may I add one more field to the log?"}], "tags": [], "owner": {"reputation": 27466, "user_id": 1978383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b04298947bce984ee6c441a44f9f862a?s=128&d=identicon&r=PG", "display_name": "l3x", "link": "https://stackoverflow.com/users/1978383/l3x"}, "is_accepted": false, "score": 3, "last_activity_date": 1510486964, "last_edit_date": 1510486964, "creation_date": 1498947846, "answer_id": 44865886, "question_id": 43022607, "link": "https://stackoverflow.com/questions/43022607/how-do-i-disable-field-name-in-logrus-while-logging-to-file/44865886#44865886", "title": "How do I disable field name in logrus while logging to file", "body": "<p>Here's how to get what you requested:</p>\n\n<pre><code>package main\n\nimport (\n    log \"github.com/sirupsen/logrus\"\n    \"fmt\"\n)\n\ntype PlainFormatter struct {\n    TimestampFormat string\n    LevelDesc []string\n}\n\nfunc (f *PlainFormatter) Format(entry *log.Entry) ([]byte, error) {\n    timestamp := fmt.Sprintf(entry.Time.Format(f.TimestampFormat))\n    return []byte(fmt.Sprintf(\"%s %s %s\\n\", f.LevelDesc[entry.Level], timestamp, entry.Message)), nil\n}\n\nfunc main() {\n    plainFormatter := new(PlainFormatter)\n    plainFormatter.TimestampFormat = \"2006-01-02 15:04:05\"\n    plainFormatter.LevelDesc = []string{\"PANC\", \"FATL\", \"ERRO\", \"WARN\", \"INFO\", \"DEBG\"}\n    log.SetFormatter(plainFormatter)\n    log.Errorln(\"Not fatal. An error. Won't stop execution\")\n    log.Infoln(\"Just some info\")\n}\n</code></pre>\n\n<ul>\n<li>Create the PlainFormatter struct (with timestamp format and level fields)</li>\n<li>Create a Format function/method (where your struct is the receiver)</li>\n<li>Set logrus to use your custom formatter</li>\n</ul>\n\n<p>Output:</p>\n\n<pre><code>ERRO 2017-07-01 18:22:21 Not fatal. An error. Won't stop execution\nINFO 2017-07-01 18:22:21 Just some info\n</code></pre>\n\n<p>In my book <a href=\"https://www.packtpub.com/application-development/learning-functional-programming-go\" rel=\"nofollow noreferrer\">Learn Functional Programming in Go</a> book you can see a more practical example of how you can manipulate your application logger in <em>Adding Functionality with Decoration</em> chapter.</p>\n"}], "owner": {"reputation": 165, "user_id": 4803862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883201011fa98b62e880be92611be238?s=128&d=identicon&r=PG&f=1", "display_name": "Root", "link": "https://stackoverflow.com/users/4803862/root"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3227, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1510486964, "creation_date": 1490480355, "question_id": 43022607, "link": "https://stackoverflow.com/questions/43022607/how-do-i-disable-field-name-in-logrus-while-logging-to-file", "title": "How do I disable field name in logrus while logging to file", "body": "<p>I am using logrus in golang to log to file. Right now, logrus is logging to file with field name. </p>\n\n<p>ie</p>\n\n<p><code>time=\"26-03-2017 03:37:58\" level=error msg=\"Not fatal. An error. Won't stop execution\"</code></p>\n\n<p>How do I remove the field names so that the log entry becomes</p>\n\n<p><code>ERRO 26-03-2017 03:37:58 Not fatal. An error. Won't stop execution</code></p>\n\n<p>like how it behaves in case of stderr?</p>\n"}, {"tags": ["http", "go", "server"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1490470780, "post_id": 43021058, "comment_id": 73129767, "body": "Assign body to a variable and use it?"}, {"owner": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "reply_to_user": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 1, "creation_date": 1490471991, "post_id": 43021058, "comment_id": 73130118, "body": "@u_mulder, If I do this, then this variable will point to the same reader"}], "answers": [{"comments": [{"owner": {"reputation": 5954, "user_id": 230392, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uwtL7.jpg?s=128&g=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/230392/jeff"}, "edited": false, "score": 1, "creation_date": 1545798273, "post_id": 43021236, "comment_id": 94696174, "body": "wouldn&#39;t you still want to close the initial body before reassigning it?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5954, "user_id": 230392, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uwtL7.jpg?s=128&g=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/230392/jeff"}, "edited": false, "score": 1, "creation_date": 1545847769, "post_id": 43021236, "comment_id": 94711146, "body": "@Jeff The request body does not need to be closed by the handler, it is closed by the server. See <a href=\"https://stackoverflow.com/questions/42525499/where-to-put-defer-req-body-close/42533540#42533540\">Where to put \u201cdefer req.Body.Close()\u201d?</a>"}, {"owner": {"reputation": 652, "user_id": 5832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19b439c1e34f1581b73afd07783e63a1?s=128&d=identicon&r=PG", "display_name": "sztanpet", "link": "https://stackoverflow.com/users/5832/sztanpet"}, "edited": false, "score": 1, "creation_date": 1550226438, "post_id": 43021236, "comment_id": 96200182, "body": "You should limit the amount you read from the body, otherwise it&#39;s just a DoS vector. Please use <a href=\"https://golang.org/pkg/net/http/#MaxBytesReader\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#MaxBytesReader</a> @icza"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 652, "user_id": 5832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19b439c1e34f1581b73afd07783e63a1?s=128&d=identicon&r=PG", "display_name": "sztanpet", "link": "https://stackoverflow.com/users/5832/sztanpet"}, "edited": false, "score": 3, "creation_date": 1550227553, "post_id": 43021236, "comment_id": 96200826, "body": "@sztanpet Yes, there are even more considerations, the answer is just the theory how inspecting the request and response bodies can be achieved. Protecting against malicious large request should be handled at the top level, not in every intermediate handler."}, {"owner": {"reputation": 2547, "user_id": 6387370, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/CpJXI.png?s=128&g=1", "display_name": "zakaria amine", "link": "https://stackoverflow.com/users/6387370/zakaria-amine"}, "edited": false, "score": 6, "creation_date": 1563789885, "post_id": 43021236, "comment_id": 100802205, "body": "<code>ioutil.ReadAll</code> is not recommended for http request body handling, especially for high loads servers. See: <a href=\"https://haisum.github.io/2017/09/11/golang-ioutil-readall/\" rel=\"nofollow noreferrer\">haisum.github.io/2017/09/11/golang-ioutil-readall</a>"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1602425214, "post_id": 43021236, "comment_id": 113709952, "body": "@icza I did not get this in your answer: &quot;You may use <code>bytes.NewBuffer()</code> to obtain an <code>io.Reader</code> from a byte slice.&quot;  Because... <code>bytes.NewBuffer(buf)</code> creates and initializes a new Buffer using <code>buf</code>([]byte) as its initial contents... Are you saying that, <code>bytes.Buffer</code> is <code>io.Reader</code> &amp; <code>io.Writer</code>?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 1, "creation_date": 1602426858, "post_id": 43021236, "comment_id": 113710363, "body": "@overexchange Yes, <code>bytes.Buffer</code> is both <code>io.Reader</code> and <code>io.Writer</code>. If you pass a slice to it, you can use it to read from that slice."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 125, "last_activity_date": 1521563313, "last_edit_date": 1521563313, "creation_date": 1490471660, "answer_id": 43021236, "question_id": 43021058, "link": "https://stackoverflow.com/questions/43021058/golang-read-request-body/43021236#43021236", "title": "Golang read request body", "body": "<h3>Inspecting and mocking request body</h3>\n\n<p>When you first read the body, you have to store it so once you're done with it, you can set a new <a href=\"https://golang.org/pkg/io/#ReadCloser\" rel=\"noreferrer\"><code>io.ReadCloser</code></a> as the request body constructed from the original data. So when you advance in the chain, the next handler can read the same body.</p>\n\n<p>One option is to read the whole body using <a href=\"https://golang.org/pkg/io/ioutil/#ReadAll\" rel=\"noreferrer\"><code>ioutil.ReadAll()</code></a>, which gives you the body as a byte slice.</p>\n\n<p>You may use <a href=\"https://golang.org/pkg/bytes/#NewBuffer\" rel=\"noreferrer\"><code>bytes.NewBuffer()</code></a> to obtain an <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"noreferrer\"><code>io.Reader</code></a> from a byte slice.</p>\n\n<p>The last missing piece is to make the <code>io.Reader</code> an <code>io.ReadCloser</code>, because <code>bytes.Buffer</code> does not have a <code>Close()</code> method. For this you may use <a href=\"https://golang.org/pkg/io/ioutil/#NopCloser\" rel=\"noreferrer\"><code>ioutil.NopCloser()</code></a> which wraps an <code>io.Reader</code>, and returns an <code>io.ReadCloser</code>, whose added <code>Close()</code> method will be a no-op (does nothing).</p>\n\n<p>Note that you may even modify the contents of the byte slice you use to create the \"new\" body. You have full control over it.</p>\n\n<p><sup>Care must be taken though, as there might be other HTTP fields like content-length and checksums which may become invalid if you modify only the data. If subsequent handlers check those, you would also need to modify those too!</sup></p>\n\n<h3>Inspecting / modifying response body</h3>\n\n<p>If you also want to read the response body, then you have to wrap the <a href=\"https://golang.org/pkg/net/http/#ResponseWriter\" rel=\"noreferrer\"><code>http.ResponseWriter</code></a> you get, and pass the wrapper on the chain. This wrapper may cache the data sent out, which you can inspect either after, on on-the-fly (as the subsequent handlers write to it).</p>\n\n<p>Here's a simple <code>ResponseWriter</code> wrapper, which just caches the data, so it'll be available after the subsequent handler returns:</p>\n\n<pre><code>type MyResponseWriter struct {\n    http.ResponseWriter\n    buf *bytes.Buffer\n}\n\nfunc (mrw *MyResponseWriter) Write(p []byte) (int, error) {\n    return mrw.buf.Write(p)\n}\n</code></pre>\n\n<p>Note that <code>MyResponseWriter.Write()</code> just writes the data to a buffer. You may also choose to inspect it on-the-fly (in the <code>Write()</code> method) and write the data immediately to the wrapped / embedded <code>ResponseWriter</code>. You may even modify the data. You have full control.</p>\n\n<p><sup>Care must be taken again though, as the subsequent handlers may also send HTTP response headers related to the response data \u2013such as length or checksums\u2013 which may also become invalid if you alter the response data.</sup></p>\n\n<h3>Full example</h3>\n\n<p>Putting the pieces together, here's a full working example:</p>\n\n<pre><code>func loginmw(handler http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        body, err := ioutil.ReadAll(r.Body)\n        if err != nil {\n            log.Printf(\"Error reading body: %v\", err)\n            http.Error(w, \"can't read body\", http.StatusBadRequest)\n            return\n        }\n\n        // Work / inspect body. You may even modify it!\n\n        // And now set a new body, which will simulate the same data we read:\n        r.Body = ioutil.NopCloser(bytes.NewBuffer(body))\n\n        // Create a response wrapper:\n        mrw := &amp;MyResponseWriter{\n            ResponseWriter: w,\n            buf:            &amp;bytes.Buffer{},\n        }\n\n        // Call next handler, passing the response wrapper:\n        handler.ServeHTTP(mrw, r)\n\n        // Now inspect response, and finally send it out:\n        // (You can also modify it before sending it out!)\n        if _, err := io.Copy(w, mrw.buf); err != nil {\n            log.Printf(\"Failed to send out response: %v\", err)\n        }\n    })\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 747, "user_id": 4162734, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh6.googleusercontent.com/-_9Xa479Vabs/AAAAAAAAAAI/AAAAAAAAABE/cIrae5Xtcss/photo.jpg?sz=128", "display_name": "seanlook", "link": "https://stackoverflow.com/users/4162734/seanlook"}, "edited": false, "score": 1, "creation_date": 1542253759, "post_id": 52079315, "comment_id": 93504924, "body": "** For server requests it is unused **, you can get the body from server side for copy purpose, or a panic <code>runtime error: invalid memory address or nil pointer dereference</code> will happen"}, {"owner": {"reputation": 61, "user_id": 2730746, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001472702023/picture?type=large", "display_name": "Yuri Giovani", "link": "https://stackoverflow.com/users/2730746/yuri-giovani"}, "reply_to_user": {"reputation": 747, "user_id": 4162734, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh6.googleusercontent.com/-_9Xa479Vabs/AAAAAAAAAAI/AAAAAAAAABE/cIrae5Xtcss/photo.jpg?sz=128", "display_name": "seanlook", "link": "https://stackoverflow.com/users/4162734/seanlook"}, "edited": false, "score": 0, "creation_date": 1542396538, "post_id": 52079315, "comment_id": 93567375, "body": "Hi @seanlook, my mistake. You need to check the error returned by getBody()  <code>getBody := request.GetBody copyBody, err := getBody()  if err != nil {     &#47;&#47; Do something     return err }  http.DefaultClient.Do(request)</code>"}, {"owner": {"reputation": 145, "user_id": 4644514, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119555257/picture?type=large", "display_name": "EdwinCab", "link": "https://stackoverflow.com/users/4644514/edwincab"}, "edited": false, "score": 0, "creation_date": 1598981499, "post_id": 52079315, "comment_id": 112629952, "body": "with golang 1.4 the func GetBody returns a nil, then copyBody fires an error"}], "tags": [], "owner": {"reputation": 61, "user_id": 2730746, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001472702023/picture?type=large", "display_name": "Yuri Giovani", "link": "https://stackoverflow.com/users/2730746/yuri-giovani"}, "is_accepted": false, "score": 1, "last_activity_date": 1554854275, "last_edit_date": 1554854275, "creation_date": 1535551336, "answer_id": 52079315, "question_id": 43021058, "link": "https://stackoverflow.com/questions/43021058/golang-read-request-body/52079315#52079315", "title": "Golang read request body", "body": "<p>I could use the <code>GetBody</code> from Request package.</p>\n\n<p>Look this comment in source code from <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">request.go</a> in net/http:</p>\n\n<blockquote>\n  <p>GetBody defines an optional func to return a new copy of\n  Body. It is used for client requests when a redirect requires\n  reading the body more than once. Use of GetBody still\n  requires setting Body.\n  For server requests it is unused.\"</p>\n</blockquote>\n\n<p><code>GetBody func() (io.ReadCloser, error)</code></p>\n\n<p>This way you can get the body request without make it empty.</p>\n\n<p>Sample:</p>\n\n<pre><code>getBody := request.GetBody\ncopyBody, err := getBody()\nif err != nil {\n    // Do something return err\n}\nhttp.DefaultClient.Do(request)\n</code></pre>\n"}], "owner": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135312, "favorite_count": 32, "closed_date": 1597292281, "accepted_answer_id": 43021236, "answer_count": 2, "score": 78, "last_activity_date": 1554854275, "creation_date": 1490470591, "question_id": 43021058, "link": "https://stackoverflow.com/questions/43021058/golang-read-request-body", "closed_reason": "Duplicate", "title": "Golang read request body", "body": "<p>I am writing my own logginMiddleware. Basically, I need to log body of the request and the response. The problem that I faced is that when I read body, it becomes empty and I cannot read it twice. \nI understand that it happens because it is of type ReadCloser. Is there a way to rewind body to the beginning? </p>\n"}, {"tags": ["mysql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1490473916, "post_id": 43020899, "comment_id": 73130714, "body": "Considering there&#39;s a max of around 21,000,000 BTC in circulation, a 60-digit field for those sorts of values is preposterous. Do try and pick types that have some basis in reality. It can have implications on your performance."}], "answers": [{"tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": false, "score": 0, "last_activity_date": 1490652689, "creation_date": 1490652689, "answer_id": 43057322, "question_id": 43020899, "link": "https://stackoverflow.com/questions/43020899/gorm-for-mysql-record-not-found/43057322#43057322", "title": "gorm for mysql: record not found", "body": "<p>It's hard to tell without actual data, but I would say it's most likely about precision and rounding. Your data type is double and will most likely be sent as sql type double to mysql. It will be converted to numeric for the comparison, but it's precision will be somewhere around 15-18 digits after comma and likely won't be exactly what you specified in the code (e.g. 0.1 will likely become something like 0.10000000000005).</p>\n\n<p>See more detailed explanations <a href=\"https://dev.mysql.com/doc/refman/5.7/en/type-conversion.html\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://dev.mysql.com/doc/refman/5.7/en/problems-with-float.html\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>You might be able to fix this by adding explicit gorm mapping for that fields as numeric (see gorm documentation for exact format). But I'd rather suggest using <code>github.com/shopspring/decimal</code> instead, so that you always know exact precision you're working with. Explicitly mapping those fields as numeric would be still a good idea.</p>\n"}, {"tags": [], "owner": {"reputation": 869, "user_id": 10912122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dstX1.jpg?s=128&g=1", "display_name": "Umar Hayat", "link": "https://stackoverflow.com/users/10912122/umar-hayat"}, "is_accepted": false, "score": 0, "last_activity_date": 1579607913, "creation_date": 1579607913, "answer_id": 59840653, "question_id": 43020899, "link": "https://stackoverflow.com/questions/43020899/gorm-for-mysql-record-not-found/59840653#59840653", "title": "gorm for mysql: record not found", "body": "<p>This is a known intentional issue of the gorm ORM. It returns error,<code>record not found</code>, when returned list by  <code>err:= db.Preload(\"UserDevices\").First(&amp;user, userID.ID).Error</code> is empty.\nfor further detail you can have a look at this <a href=\"https://github.com/jinzhu/gorm/issues/228\" rel=\"nofollow noreferrer\">github issue</a> </p>\n"}], "owner": {"reputation": 1, "user_id": 7767351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8d1ebab42c191add5eb8e4f6303352?s=128&d=identicon&r=PG&f=1", "display_name": "langyu_8BTC", "link": "https://stackoverflow.com/users/7767351/langyu-8btc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3089, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1579607913, "creation_date": 1490469809, "question_id": 43020899, "link": "https://stackoverflow.com/questions/43020899/gorm-for-mysql-record-not-found", "title": "gorm for mysql: record not found", "body": "<pre><code> // for trade_service\n type AmountConfig struct {\n    MaxCny float64 `thrift:\"max_cny,1\" json:\"max_cny\"`\n    MaxBtc float64 `thrift:\"max_btc,2\" json:\"max_btc\"`\n  }\n  //\n\ntype AmountConfig struct {\n     gorm.Model\n     trade_service.AmountConfig  //\n}\n\n\n\nfunc getAmountConfig() (amount_config *trade_service.AmountConfig, err error) {\n    db, err := getORMDB()\n    if err != nil {\n      logger.Errorln(err)\n      return\n    }\n\n    var amountConfig AmountConfig{}\n\n    if err = db.First(&amp;amountConfig).Error; err != nil {\n        logger.Errorln(\"getAmountConfig amount record does not exist:\", err)\n        return\n    }\n\n    amount_config = trade_service.NewAmountConfig()\n    amount_config.MaxCny = amountConfig.MaxCny\n    amount_config.MaxBtc = amountConfig.MaxBtc\n\n    logger.Infoln(\"get amountConfig ok\", amount_config)\n\n    return\n}\n</code></pre>\n\n<p>mysql table described as follow:  </p>\n\n<pre><code>CREATE TABLE `amount_config` ( \n `id` int(11) NOT NULL AUTO_INCREMENT,\n `max_cny` decimal(65,2) DEFAULT NULL,\n `max_btc` decimal(65,4) DEFAULT NULL,\n `created_at` datetime DEFAULT NULL,\n `deleted_at` datetime DEFAULT NULL, \n `updated_at` datetime DEFAULT NULL,\n  PRIMARY KEY (`id`), \n  KEY `updated_at` (`updated_at`),  \n  KEY `created_at` (`created_at`),\n  KEY `deleted_at` (`deleted_at`) \n  ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;\n</code></pre>\n\n<p>I had a record in talbe \"amount_config\", but error displayed \"record not found\" , after I run the code \"db.First(&amp;amountConfig)\".<br>\nIs there something wrong with my code ? </p>\n"}, {"tags": ["go", "web-applications"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 4, "last_activity_date": 1490467699, "last_edit_date": 1490467699, "creation_date": 1490466425, "answer_id": 43020257, "question_id": 43020241, "link": "https://stackoverflow.com/questions/43020241/how-do-you-execute-a-template-with-500-status-code-in-go/43020257#43020257", "title": "How do you execute a template with 500 status code in Go?", "body": "<p>Call <a href=\"https://godoc.org/net/http#ResponseWriter\" rel=\"nofollow noreferrer\"><code>ResponseWriter.WriteHeader</code></a> before you execute your template:</p>\n\n<blockquote>\n  <p>WriteHeader sends an HTTP response header with status code.<br>\n  If WriteHeader is not called explicitly, the first call to Write\n  will trigger an implicit WriteHeader(http.StatusOK).<br>\n  Thus explicit calls to WriteHeader are mainly used to send error codes.</p>\n</blockquote>\n\n<pre><code>t.ParseFiles(name)\nw.WriteHeader(http.StatusInternalServerError)\nt.Execute(w, page)\n</code></pre>\n\n<p>If you look at the <a href=\"https://golang.org/src/net/http/server.go#L1951\" rel=\"nofollow noreferrer\">source code of <code>http.Error</code></a>, you can see it's doing the same thing.</p>\n"}], "owner": {"reputation": 53, "user_id": 7427144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5033d6ea6fdfed44eb6e7865ed5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Apophis", "link": "https://stackoverflow.com/users/7427144/apophis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 43020257, "answer_count": 1, "score": 1, "last_activity_date": 1490467699, "creation_date": 1490466341, "question_id": 43020241, "link": "https://stackoverflow.com/questions/43020241/how-do-you-execute-a-template-with-500-status-code-in-go", "title": "How do you execute a template with 500 status code in Go?", "body": "<p>I know that I can execute template with:</p>\n\n<pre><code>t.ParseFiles(name)\nt.Execute(w, page)\n</code></pre>\n\n<p>And respond 500 with a message like this:</p>\n\n<pre><code>http.Error(w, err.Error(), http.StatusInternalServerError)\n</code></pre>\n\n<p>But how should I return 500 with a template that contains that message?</p>\n"}, {"tags": ["go", "reverse-proxy", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4453398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/STU1F.png?s=128&g=1", "display_name": "lean der", "link": "https://stackoverflow.com/users/4453398/lean-der"}, "edited": false, "score": 0, "creation_date": 1490470351, "post_id": 43020333, "comment_id": 73129654, "body": "Thank you for your answer! Could you give an example on how to implement that?"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "reply_to_user": {"reputation": 121, "user_id": 4453398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/STU1F.png?s=128&g=1", "display_name": "lean der", "link": "https://stackoverflow.com/users/4453398/lean-der"}, "edited": false, "score": 1, "creation_date": 1490472605, "post_id": 43020333, "comment_id": 73130298, "body": "I added an example."}, {"owner": {"reputation": 427, "user_id": 4494083, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-m2twe9v3jg8/AAAAAAAAAAI/AAAAAAAAALM/sZPxl5JIJa4/photo.jpg?sz=128", "display_name": "Zheeeng", "link": "https://stackoverflow.com/users/4494083/zheeeng"}, "edited": false, "score": 0, "creation_date": 1547774131, "post_id": 43020333, "comment_id": 95317499, "body": "How can we manipulate the response in the gin&#39; way? e.g. read from context, modify the response through context?"}], "tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": true, "score": 3, "last_activity_date": 1490472591, "last_edit_date": 1490472591, "creation_date": 1490466879, "answer_id": 43020333, "question_id": 43020079, "link": "https://stackoverflow.com/questions/43020079/go-proxy-middleware-and-modify-response/43020333#43020333", "title": "Go proxy middleware and modify response", "body": "<p>How about using <a href=\"https://golang.org/pkg/net/http/httputil/#ReverseProxy\" rel=\"nofollow noreferrer\">ReverseProxy</a>.ModifyResponse?</p>\n\n<p>For example, this will add a custom header to the response.</p>\n\n<pre><code>func addCustomHeader(r *http.Response) error {\n    r.Header[\"Hello\"] = []string{\"World\"}\n    return nil\n}\n\nproxy.ModifyResponse = addCustomHeader\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4453398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/STU1F.png?s=128&g=1", "display_name": "lean der", "link": "https://stackoverflow.com/users/4453398/lean-der"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2097, "favorite_count": 0, "accepted_answer_id": 43020333, "answer_count": 1, "score": 0, "last_activity_date": 1490472591, "creation_date": 1490465477, "last_edit_date": 1490468911, "question_id": 43020079, "link": "https://stackoverflow.com/questions/43020079/go-proxy-middleware-and-modify-response", "title": "Go proxy middleware and modify response", "body": "<p>I'm trying to proxy a request from a Go backend to a microservice and modify the response before it is sent to the client. The request chain is: Client -> Go backend -> microservice -> Go backend -> client</p>\n\n<p>I'm using the Go Gin framework. The working middleware:</p>\n\n<pre><code>func ReverseProxy(target string) gin.HandlerFunc {\n    log.Println(target)\n    url, err := url.Parse(target)\n    if err != nil {\n        log.Fatal(err)\n    }\n    proxy := httputil.NewSingleHostReverseProxy(url)\n    return func(c *gin.Context) {\n        proxy.ServeHTTP(c.Writer, c.Request)\n    }\n}\n</code></pre>\n\n<p>Now my question is: How can I receive and modify the response sent by the microservice?</p>\n"}, {"tags": ["windows", "go", "file-access"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 1, "creation_date": 1490464322, "post_id": 43019581, "comment_id": 73127701, "body": "<a href=\"https://github.com/fatih/vim-go/issues/153\" rel=\"nofollow noreferrer\">github.com/fatih/vim-go/issues/153</a>"}], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 7362537, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gCFm7Zh6ZjY/AAAAAAAAAAI/AAAAAAAABfM/P7twrFqGwm0/photo.jpg?sz=128", "display_name": "Gabriele Carioli", "link": "https://stackoverflow.com/users/7362537/gabriele-carioli"}, "is_accepted": false, "score": 2, "last_activity_date": 1490466337, "last_edit_date": 1490466337, "creation_date": 1490464793, "answer_id": 43019959, "question_id": 43019581, "link": "https://stackoverflow.com/questions/43019581/go-lang-access-denied/43019959#43019959", "title": "Go lang access denied", "body": "<p>Your code is correct.\nYou can run it via <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">https://play.golang.org/</a> and it will print \"1\"</p>\n\n<p>The error you're getting is not a Go error but a Windows error.\nIt looks like a permission problem (no idea why you're getting it)</p>\n"}, {"comments": [{"owner": {"reputation": 325, "user_id": 8840033, "user_type": "registered", "profile_image": "https://graph.facebook.com/1602298713141870/picture?type=large", "display_name": "Vasya Milovidov", "link": "https://stackoverflow.com/users/8840033/vasya-milovidov"}, "edited": false, "score": 1, "creation_date": 1561892066, "post_id": 51249856, "comment_id": 100201065, "body": "it helped me too."}], "tags": [], "owner": {"reputation": 2140, "user_id": 4570230, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/I2tMC.jpg?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/4570230/nicholas"}, "is_accepted": false, "score": 8, "last_activity_date": 1531152640, "creation_date": 1531152640, "answer_id": 51249856, "question_id": 43019581, "link": "https://stackoverflow.com/questions/43019581/go-lang-access-denied/51249856#51249856", "title": "Go lang access denied", "body": "<p>I can only speak for my own case. I ran into the similar error using Windows 10. After some experiments, it looks like the error came from Avira, the anti-virus software I was using. Basically, the .exe file is detected by Avira as containing the pattern of a type of virus (called HEUR/APC (Cloud) in my case), which prevents the program from executing.</p>\n\n<p>After I disabled my anti-virus software, everything went back to normal.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13040368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43fddc6356e9157a003ab89319c7fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Surabhi Priya", "link": "https://stackoverflow.com/users/13040368/surabhi-priya"}, "is_accepted": false, "score": 0, "last_activity_date": 1591772997, "creation_date": 1591772997, "answer_id": 62297752, "question_id": 43019581, "link": "https://stackoverflow.com/questions/43019581/go-lang-access-denied/62297752#62297752", "title": "Go lang access denied", "body": "<p>I am getting the same error  and its because of my Cylance Protect antivirus. Try disabling it. </p>\n"}, {"tags": [], "owner": {"reputation": 492, "user_id": 4579457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/loJJG.jpg?s=128&g=1", "display_name": "TheName", "link": "https://stackoverflow.com/users/4579457/thename"}, "is_accepted": true, "score": 0, "last_activity_date": 1591856711, "creation_date": 1591856711, "answer_id": 62318303, "question_id": 43019581, "link": "https://stackoverflow.com/questions/43019581/go-lang-access-denied/62318303#62318303", "title": "Go lang access denied", "body": "<p>so the trick here is that you need to run your application as Administrator in Windows</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4483910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8c5ca182e603f2ae0b980b08422238a?s=128&d=identicon&r=PG&f=1", "display_name": "adals", "link": "https://stackoverflow.com/users/4483910/adals"}, "is_accepted": false, "score": 1, "last_activity_date": 1600002697, "last_edit_date": 1600002697, "creation_date": 1599978182, "answer_id": 63867786, "question_id": 43019581, "link": "https://stackoverflow.com/questions/43019581/go-lang-access-denied/63867786#63867786", "title": "Go lang access denied", "body": "<p>for me I used avira just add <code>C:\\Users\\Computer\\AppData\\Local\\Temp</code> floder to exception folder for realtime-protection.</p>\n<p>Solved my problem</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13145684, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GiSBWZVe7LaHH4fIO8T2TuJuT53usWx7tzMZNtGfA=k-s128", "display_name": "Tech 4 Future", "link": "https://stackoverflow.com/users/13145684/tech-4-future"}, "is_accepted": false, "score": 0, "last_activity_date": 1609508543, "creation_date": 1609508543, "answer_id": 65530130, "question_id": 43019581, "link": "https://stackoverflow.com/questions/43019581/go-lang-access-denied/65530130#65530130", "title": "Go lang access denied", "body": "<p>**** Only Applies if you have avira antivirus installed on your pc ****</p>\n<p>The thing is that avira recognises the go interpreter similar to a certain virus(HEUR/APC).\nSo it blocks it and we get this error.</p>\n<p><a href=\"https://i.stack.imgur.com/hF60y.png\" rel=\"nofollow noreferrer\">see the first row</a></p>\n<p>Just go to settings in the same page and add a exception to a folder like i have done so.</p>\n<p><a href=\"https://i.stack.imgur.com/n35VL.png\" rel=\"nofollow noreferrer\">add this path to the exception : <strong>C:\\Users\\User\\AppData\\Local</strong></a></p>\n<p>Then press Ok and apply and you'll be good to go.</p>\n<p>P.S. - I see that someone else also pointed out that it's the avira antivirus but didn't give proper solution to the problem, so i thought to give a proper solution from my side.</p>\n"}], "owner": {"reputation": 492, "user_id": 4579457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/loJJG.jpg?s=128&g=1", "display_name": "TheName", "link": "https://stackoverflow.com/users/4579457/thename"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7168, "favorite_count": 0, "accepted_answer_id": 62318303, "answer_count": 6, "score": 4, "last_activity_date": 1609508543, "creation_date": 1490462895, "last_edit_date": 1490463679, "question_id": 43019581, "link": "https://stackoverflow.com/questions/43019581/go-lang-access-denied", "title": "Go lang access denied", "body": "<p>I'm new to the GO programming language, what I'm trying to do is to put some items into the map and then remove one of them, when I'm trying to remove one of the items from array I'm getting the error message:</p>\n\n<pre><code>C:/Go\\bin\\go.exe run C:/Users/Computer/IdeaProjects/untitled1/simple.go\nfork/exec C:\\Users\\Computer\\AppData\\Local\\Temp\\go-build143466426\\command-line-arguments\\_obj\\exe\\simple.exe: Access is denied.\n</code></pre>\n\n<p>the code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n    func main(){\n\n        presAge := make(map[string] int)\n\n        presAge[\"test\"] = 42\n        presAge[\"boom\"] = 421\n\n        delete(presAge,\"boom\")\n\n        fmt.Println(len(presAge))\n\n    }\n</code></pre>\n"}, {"tags": ["arrays", "go", "pass-by-reference", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1490459269, "post_id": 43018862, "comment_id": 73125797, "body": "If you want to modify a value, you need a pointer to that value, not a copy."}, {"owner": {"reputation": 43, "user_id": 2103321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f395b5f9e60e24045e822e0c2f50ebc0?s=128&d=identicon&r=PG", "display_name": "Daniel Rangel", "link": "https://stackoverflow.com/users/2103321/daniel-rangel"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490461539, "post_id": 43018862, "comment_id": 73126659, "body": "It worked almost de same way as the length and capacity of the slice changed but i still can&#39;t get rid of the blank spaces at the end of the array. <a href=\"https://play.golang.org/p/2zVBE7ZT-P\" rel=\"nofollow noreferrer\">play.golang.org/p/2zVBE7ZT-P</a>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 2103321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f395b5f9e60e24045e822e0c2f50ebc0?s=128&d=identicon&r=PG", "display_name": "Daniel Rangel", "link": "https://stackoverflow.com/users/2103321/daniel-rangel"}, "edited": false, "score": 0, "creation_date": 1490463324, "post_id": 43019269, "comment_id": 73127348, "body": "i meant in place without the function rmDup() having to return anything"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1490466366, "last_edit_date": 1490466366, "creation_date": 1490461261, "answer_id": 43019269, "question_id": 43018862, "link": "https://stackoverflow.com/questions/43018862/is-it-possible-for-a-function-to-change-the-size-of-a-slice-of-string-array-decl/43019269#43019269", "title": "Is it possible for a function to change the size of a slice of string array declared elsewhere? golang", "body": "<blockquote>\n  <p>Is there any way that <code>str</code> in <code>main</code> can return the size and capacity\n  defined in <code>rmDup()</code>?</p>\n</blockquote>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n//String remove adjacent duplicates from a string array\nfunc rmDup(str []string) []string {\n    for i := 1; i &lt; len(str); i++ {\n        if str[i] == str[i-1] {\n            copy(str[i:], str[i+1:])\n            str[len(str)-1] = \"\"\n            str = str[:len(str)-1]\n        }\n    }\n    return str\n}\n\nfunc main() {\n    str := []string{\"dog\", \"cat\", \"cat\", \"mouse\", \"mouse\", \"zebra\", \"zebra\"}\n    fmt.Println(len(str), cap(str), str)\n    str = rmDup(str)\n    fmt.Println(len(str), cap(str), str)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>7 7 [dog cat cat mouse mouse zebra zebra]\n4 7 [dog cat mouse zebra]\n</code></pre>\n\n<blockquote>\n  <p>i meant in place without the function <code>rmDup()</code> having to return\n  anything.</p>\n</blockquote>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n//String remove adjacent duplicates from a string array\nfunc rmDup(str *[]string) {\n    s := *str\n    for i := 1; i &lt; len(s); i++ {\n        if s[i] == s[i-1] {\n            copy(s[i:], s[i+1:])\n            s[len(s)-1] = \"\"\n            s = s[:len(s)-1]\n        }\n    }\n    *str = s\n}\n\nfunc main() {\n    str := []string{\"dog\", \"cat\", \"cat\", \"mouse\", \"mouse\", \"zebra\", \"zebra\"}\n    fmt.Println(len(str), cap(str), str)\n    rmDup(&amp;str)\n    fmt.Println(len(str), cap(str), str)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>7 7 [dog cat cat mouse mouse zebra zebra]\n4 7 [dog cat mouse zebra]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 2103321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f395b5f9e60e24045e822e0c2f50ebc0?s=128&d=identicon&r=PG", "display_name": "Daniel Rangel", "link": "https://stackoverflow.com/users/2103321/daniel-rangel"}, "is_accepted": true, "score": 2, "last_activity_date": 1490468007, "creation_date": 1490468007, "answer_id": 43020558, "question_id": 43018862, "link": "https://stackoverflow.com/questions/43018862/is-it-possible-for-a-function-to-change-the-size-of-a-slice-of-string-array-decl/43020558#43020558", "title": "Is it possible for a function to change the size of a slice of string array declared elsewhere? golang", "body": "<p>It turned out that I was able to find the answer myself. Since the Go language performs function calls by value it is impossible to change a slice declared in another scope, except using pointers.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n//String remove adjacent duplicates from a string array\nfunc rmDup(str *[]string) []string {\n var s = *str\n for i := 1; i &lt; len(s); i++ {\n    if s[i] == s[i-1] {\n        copy(s[i:], s[i+1:])\n        s[len(s)-1] = \"\"\n        s = s[:len(s)-1]\n    }\n}\n*str = s\nreturn s\n}\n\nfunc main() {\n\n  str := []string{\"dog\", \"cat\", \"cat\", \"mouse\", \"mouse\", \"zebra\", \n  \"zebra\"}\n\n  fmt.Println(str)\n  newstr := rmDup(&amp;str)\n  fmt.Println(str)\n  fmt.Println(newstr)\n  fmt.Println(len(str), cap(str), \"final\")\n  fmt.Println(len(newstr), cap(newstr), \"final\")\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[dog cat cat mouse mouse zebra zebra]\n[dog cat mouse zebra]\n[dog cat mouse zebra]\n4 7 final\n4 7 final\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 2103321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f395b5f9e60e24045e822e0c2f50ebc0?s=128&d=identicon&r=PG", "display_name": "Daniel Rangel", "link": "https://stackoverflow.com/users/2103321/daniel-rangel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 1, "accepted_answer_id": 43020558, "answer_count": 2, "score": 0, "last_activity_date": 1490468007, "creation_date": 1490459013, "question_id": 43018862, "link": "https://stackoverflow.com/questions/43018862/is-it-possible-for-a-function-to-change-the-size-of-a-slice-of-string-array-decl", "title": "Is it possible for a function to change the size of a slice of string array declared elsewhere? golang", "body": "<p>I would like to remove an element from the slice in place. But when I do this I end up producing two empty elements in the underlying array.\nI already searched <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">here</a>, <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">here</a> </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n//String remove adjacent duplicates from a string array\nfunc rmDup(str []string) []string {\n    for i := 1; i &lt; len(str); i++ {\n        if str[i] == str[i-1] {\n            copy(str[i:], str[i+1:])\n            str[len(str)-1] = \"\"\n            str = str[:len(str)-1]\n        }\n    }\n    return str\n}\n\nfunc main() {\n\n    str := []string{\"dog\", \"cat\", \"cat\", \"mouse\", \"mouse\", \"zebra\", \"zebra\"}\n\n    fmt.Println(str)\n    newstr := rmDup(str)\n    fmt.Println(str)\n    fmt.Println(newstr)\n    fmt.Println(len(str), cap(str), \"final\")\n    fmt.Println(len(newstr), cap(newstr), \"final\")\n}\n</code></pre>\n\n<p>Is there any way that <strong>str</strong> in main can return the <strong>size</strong> and <strong>capacity</strong> defined in rmDup()</p>\n"}, {"tags": ["go", "visual-studio-code"], "answers": [{"comments": [{"owner": {"reputation": 1303, "user_id": 5248987, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/37c875ebfaf39c6d9ff3476fc97f9a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Hey", "link": "https://stackoverflow.com/users/5248987/hey"}, "edited": false, "score": 1, "creation_date": 1490464966, "post_id": 43019530, "comment_id": 73127934, "body": "I removed everything in the <code>%GOPATH%\\*</code> dirs that was not a project of myself, relaunched VSCode and asked to &quot;Install all&quot; and the installation is going without problems. Thank you."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1562026078, "post_id": 43019530, "comment_id": 100239120, "body": "Probably caused by having used multiple versions of Go."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 11, "last_activity_date": 1490462583, "creation_date": 1490462583, "answer_id": 43019530, "question_id": 43018667, "link": "https://stackoverflow.com/questions/43018667/vs-code-cant-install-the-go-tools/43019530#43019530", "title": "VS Code can&#39;t install the Go tools", "body": "<p>It looks like it's complaining due to <code>C:\\Users\\user\\go\\src\\golang.org\\x\\tools</code> being not a git repo, so it can't update whatever is in it.</p>\n\n<p>Assuming you didn't put your own code in that dir, try removing it and then running again.</p>\n\n<p>If you look at the docs for the Go plugin, and scroll all the way to the bottom, it shows the commands to run if you want to manually install/upgrade the stuff the plugin needs.</p>\n\n<p>Specifically, taken from <a href=\"https://github.com/Microsoft/vscode-go#tools-this-extension-depends-on\" rel=\"noreferrer\">their github repo</a>, you can just run this from a cmd.exe prompt.   </p>\n\n<pre><code>go get -u -v github.com/nsf/gocode\ngo get -u -v github.com/rogpeppe/godef\ngo get -u -v github.com/zmb3/gogetdoc\ngo get -u -v github.com/golang/lint/golint\ngo get -u -v github.com/lukehoban/go-outline\ngo get -u -v sourcegraph.com/sqs/goreturns\ngo get -u -v golang.org/x/tools/cmd/gorename\ngo get -u -v github.com/tpng/gopkgs\ngo get -u -v github.com/newhook/go-symbols\ngo get -u -v golang.org/x/tools/cmd/guru\ngo get -u -v github.com/cweill/gotests/...\ngo get -u -v golang.org/x/tools/cmd/godoc\ngo get -u -v github.com/fatih/gomodifytags\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4945870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7HDCX.gif?s=128&g=1", "display_name": "HumbleBee", "link": "https://stackoverflow.com/users/4945870/humblebee"}, "is_accepted": false, "score": 2, "last_activity_date": 1531143175, "creation_date": 1531143175, "answer_id": 51246858, "question_id": 43018667, "link": "https://stackoverflow.com/questions/43018667/vs-code-cant-install-the-go-tools/51246858#51246858", "title": "VS Code can&#39;t install the Go tools", "body": "<p><strong>Solution:</strong>  Just Exit the app &amp; Restart the application as Admin (Run as Administrator). It'll work fine &amp; every module/dependency will be installed Successfully.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10789401, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/869e091f4a3aa514efd8da608e1e3bb3?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/10789401/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1544768831, "creation_date": 1544768831, "answer_id": 53774491, "question_id": 43018667, "link": "https://stackoverflow.com/questions/43018667/vs-code-cant-install-the-go-tools/53774491#53774491", "title": "VS Code can&#39;t install the Go tools", "body": "<p>You might be running an old version of Go.\nTry removing your version and install the latest version from Go's site.</p>\n"}], "owner": {"reputation": 1303, "user_id": 5248987, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/37c875ebfaf39c6d9ff3476fc97f9a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Hey", "link": "https://stackoverflow.com/users/5248987/hey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12036, "favorite_count": 4, "accepted_answer_id": 43019530, "answer_count": 3, "score": 4, "last_activity_date": 1551244234, "creation_date": 1490458007, "question_id": 43018667, "link": "https://stackoverflow.com/questions/43018667/vs-code-cant-install-the-go-tools", "title": "VS Code can&#39;t install the Go tools", "body": "<p>I try to start using Go in VSCode. I've installed Go as well as Git and created a project in Code, containing a single <code>.go</code> file.</p>\n\n<p>When I type something, VSCode warns me that tools like <code>golint</code> are missing and prompts me to install them. I click on \"Install all\".</p>\n\n<p>Then the console shows this :</p>\n\n<pre><code>Installing 10 tools\n  gocode\n  gopkgs\n  go-outline\n  go-symbols\n  guru\n  gorename\n  godef\n  goreturns\n  golint\n  gotests\n\nInstalling gocode SUCCEEDED\nInstalling gopkgs SUCCEEDED\nInstalling go-outline SUCCEEDED\nInstalling go-symbols FAILED\nInstalling guru FAILED\nInstalling gorename FAILED\nInstalling godef SUCCEEDED\nInstalling goreturns FAILED\nInstalling golint FAILED\nInstalling gotests FAILED\n\n6 tools failed to install.\n\ngo-symbols:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v github.com/newhook/go-symbols\ngithub.com/newhook/go-symbols (download)\nFetching https://golang.org/x/tools/go/buildutil?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/buildutil?go-get=1 (status code 200)\nget \"golang.org/x/tools/go/buildutil\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/go/buildutil?go-get=1\nget \"golang.org/x/tools/go/buildutil\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/go/buildutil: exit status 128\ngithub.com/newhook/go-symbols (download)\nFetching https://golang.org/x/tools/go/buildutil?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/buildutil?go-get=1 (status code 200)\nget \"golang.org/x/tools/go/buildutil\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/go/buildutil?go-get=1\nget \"golang.org/x/tools/go/buildutil\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/go/buildutil: exit status 128\n\nguru:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v golang.org/x/tools/cmd/guru\nFetching https://golang.org/x/tools/cmd/guru?go-get=1\nParsing meta tags from https://golang.org/x/tools/cmd/guru?go-get=1 (status code 200)\nget \"golang.org/x/tools/cmd/guru\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/cmd/guru?go-get=1\nget \"golang.org/x/tools/cmd/guru\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/cmd/guru: exit status 128\nFetching https://golang.org/x/tools/cmd/guru?go-get=1\nParsing meta tags from https://golang.org/x/tools/cmd/guru?go-get=1 (status code 200)\nget \"golang.org/x/tools/cmd/guru\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/cmd/guru?go-get=1\nget \"golang.org/x/tools/cmd/guru\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/cmd/guru: exit status 128\n\ngorename:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v golang.org/x/tools/cmd/gorename\nFetching https://golang.org/x/tools/cmd/gorename?go-get=1\nParsing meta tags from https://golang.org/x/tools/cmd/gorename?go-get=1 (status code 200)\nget \"golang.org/x/tools/cmd/gorename\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/cmd/gorename?go-get=1\nget \"golang.org/x/tools/cmd/gorename\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/cmd/gorename: exit status 128\nFetching https://golang.org/x/tools/cmd/gorename?go-get=1\nParsing meta tags from https://golang.org/x/tools/cmd/gorename?go-get=1 (status code 200)\nget \"golang.org/x/tools/cmd/gorename\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/cmd/gorename?go-get=1\nget \"golang.org/x/tools/cmd/gorename\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/cmd/gorename: exit status 128\n\ngoreturns:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v sourcegraph.com/sqs/goreturns\nFetching https://sourcegraph.com/sqs/goreturns?go-get=1\nParsing meta tags from https://sourcegraph.com/sqs/goreturns?go-get=1 (status code 200)\nget \"sourcegraph.com/sqs/goreturns\": found meta tag main.metaImport{Prefix:\"sourcegraph.com/sqs/goreturns\", VCS:\"git\", RepoRoot:\"https://github.com/sqs/goreturns\"} at https://sourcegraph.com/sqs/goreturns?go-get=1\nsourcegraph.com/sqs/goreturns (download)\ngithub.com/sqs/goreturns (download)\nFetching https://golang.org/x/tools/imports?go-get=1\nParsing meta tags from https://golang.org/x/tools/imports?go-get=1 (status code 200)\nget \"golang.org/x/tools/imports\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/imports?go-get=1\nget \"golang.org/x/tools/imports\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/imports: exit status 128\nFetching https://sourcegraph.com/sqs/goreturns?go-get=1\nParsing meta tags from https://sourcegraph.com/sqs/goreturns?go-get=1 (status code 200)\nget \"sourcegraph.com/sqs/goreturns\": found meta tag main.metaImport{Prefix:\"sourcegraph.com/sqs/goreturns\", VCS:\"git\", RepoRoot:\"https://github.com/sqs/goreturns\"} at https://sourcegraph.com/sqs/goreturns?go-get=1\nsourcegraph.com/sqs/goreturns (download)\ngithub.com/sqs/goreturns (download)\nFetching https://golang.org/x/tools/imports?go-get=1\nParsing meta tags from https://golang.org/x/tools/imports?go-get=1 (status code 200)\nget \"golang.org/x/tools/imports\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/imports?go-get=1\nget \"golang.org/x/tools/imports\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/imports: exit status 128\n\ngolint:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v github.com/golang/lint/golint\ngithub.com/golang/lint (download)\nFetching https://golang.org/x/tools/go/gcexportdata?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/gcexportdata?go-get=1 (status code 200)\nget \"golang.org/x/tools/go/gcexportdata\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/go/gcexportdata?go-get=1\nget \"golang.org/x/tools/go/gcexportdata\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/go/gcexportdata: exit status 128\ngithub.com/golang/lint (download)\nFetching https://golang.org/x/tools/go/gcexportdata?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/gcexportdata?go-get=1 (status code 200)\nget \"golang.org/x/tools/go/gcexportdata\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/go/gcexportdata?go-get=1\nget \"golang.org/x/tools/go/gcexportdata\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/go/gcexportdata: exit status 128\n\ngotests:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v github.com/cweill/gotests/...\ngithub.com/cweill/gotests (download)\nFetching https://golang.org/x/tools/imports?go-get=1\nParsing meta tags from https://golang.org/x/tools/imports?go-get=1 (status code 200)\nget \"golang.org/x/tools/imports\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/imports?go-get=1\nget \"golang.org/x/tools/imports\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/imports: exit status 128\ngithub.com/cweill/gotests (download)\nFetching https://golang.org/x/tools/imports?go-get=1\nParsing meta tags from https://golang.org/x/tools/imports?go-get=1 (status code 200)\nget \"golang.org/x/tools/imports\": found meta tag main.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/tools\"} at https://golang.org/x/tools/imports?go-get=1\nget \"golang.org/x/tools/imports\": verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\user\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nfatal: Not a git repository (or any of the parent directories): .git\npackage golang.org/x/tools/imports: exit status 128\n</code></pre>\n\n<p>Some tools are able to install, others are not. I can't do anything about the <code>Not a git repository</code> error because it's an automated process and I'm not the one typing the git commands.</p>\n\n<p>I tried installing the tools separately in PowerShell and I get the same errors. My go directory is created (in <code>%USERPROFILE%\\go</code>) and the <code>GOPATH</code> is set correctly.</p>\n\n<p>Any ideas ?</p>\n"}, {"tags": ["python", "go", "modulo"], "answers": [{"comments": [{"owner": {"reputation": 4671, "user_id": 4927751, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VwUAi.jpg?s=128&g=1", "display_name": "Kshitij Saraogi", "link": "https://stackoverflow.com/users/4927751/kshitij-saraogi"}, "edited": false, "score": 0, "creation_date": 1490456751, "post_id": 43018347, "comment_id": 73124888, "body": "Thank you for the reference. This issue slipped from me since it is closed. I will update my question to reflect this."}, {"owner": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "edited": false, "score": 0, "creation_date": 1490752960, "post_id": 43018347, "comment_id": 73248760, "body": "You can simplify your Go to Python Modulus code to just:  <code>(i % n) + n) % n</code>. Verified <a href=\"https://play.golang.org/p/QT5PA9fltU\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 11, "last_activity_date": 1490711072, "last_edit_date": 1592644375, "creation_date": 1490456357, "answer_id": 43018347, "question_id": 43018206, "link": "https://stackoverflow.com/questions/43018206/modulo-of-negative-integers-in-go/43018347#43018347", "title": "Modulo of negative integers in Go", "body": "<p>See <a href=\"https://github.com/golang/go/issues/448#issuecomment-66049769\" rel=\"nofollow noreferrer\">this comment by one of the language designers</a>:</p>\n<blockquote>\n<p>There are a several reasons for the current definition:</p>\n<ul>\n<li>the current semantics for % is directly available as a result from x86 architectures</li>\n<li>it would be confusing to change the meaning of the elementary operator % and not change its name</li>\n<li>it's fairly easy to compute another modulus from the % result</li>\n</ul>\n<p>Note that % computes the &quot;remainder&quot; as opposed to the &quot;modulus&quot;.</p>\n</blockquote>\n<p>There is not an operator or function in the standard library which replicates the modulus operation of Python.</p>\n<p>It is possible to write a function which replicates the modulus operation of Python:</p>\n<pre class=\"lang-go prettyprint-override\"><code>func modLikePython(d, m int) int {\n   var res int = d % m\n   if ((res &lt; 0 &amp;&amp; m &gt; 0) || (res &gt; 0 &amp;&amp; m &lt; 0)) {\n      return res + m\n   }\n   return res\n}\n</code></pre>\n<p>Note that in Python <code>5 % -3</code> is <code>-1</code> and this code replicates that behavior as well. If you don't want that, remove the second part after <code>||</code> in the <code>if</code> statement.</p>\n"}, {"comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1490498866, "post_id": 43019054, "comment_id": 73136244, "body": "I am not sure about idiosyncratic, <code>ruby</code> and <code>lua</code> act the same way."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1490460083, "creation_date": 1490460083, "answer_id": 43019054, "question_id": 43018206, "link": "https://stackoverflow.com/questions/43018206/modulo-of-negative-integers-in-go/43019054#43019054", "title": "Modulo of negative integers in Go", "body": "<p>Python is an idiosyncratic language with Guido Guido van Rossum as <a href=\"https://wiki.python.org/moin/BDFL\" rel=\"nofollow noreferrer\">BDFL</a>. Here's his explanation of why he decided to be different:</p>\n\n<p><a href=\"http://python-history.blogspot.com/2010/08/why-pythons-integer-division-floors.html\" rel=\"nofollow noreferrer\">The History of Python: Why Python's Integer Division Floors</a></p>\n"}, {"tags": [], "owner": {"reputation": 2042, "user_id": 11424673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26ecf0fd0aa656482af8bc20d0d22c88?s=128&d=identicon&r=PG&f=1", "display_name": "Hymns For Disco", "link": "https://stackoverflow.com/users/11424673/hymns-for-disco"}, "is_accepted": false, "score": 5, "last_activity_date": 1576190714, "last_edit_date": 1576190714, "creation_date": 1576136812, "answer_id": 59299881, "question_id": 43018206, "link": "https://stackoverflow.com/questions/43018206/modulo-of-negative-integers-in-go/59299881#59299881", "title": "Modulo of negative integers in Go", "body": "<p>Your Q2 </p>\n\n<blockquote>\n  <p>Is there an internal method for computing the \"modulus\" instead of the \"remainder\"?</p>\n</blockquote>\n\n<p>and the comment quoted by the top answer...</p>\n\n<blockquote>\n  <p>Note that % computes the \"remainder\" as opposed to the \"modulus\".</p>\n</blockquote>\n\n<p>are a bit misleading...</p>\n\n<p>Look up any definition of \"modulo\", by and large it will say that it is the remainder after division.  The problem is that when we say \"the remainder\", it implies that there is only one.  When negative numbers are involved, there can be more than 1 distinct remainder.  On the Wikipedia page for <a href=\"https://en.wikipedia.org/wiki/Remainder#Examples\" rel=\"noreferrer\">Remainder</a>, it differentiates between the <code>least positive remainder</code> and the <code>least absolute remainder</code>. You could also add a <code>least negative remainder</code> (least negative meaning negative but closest to 0).</p>\n\n<p>Generally for modulus operators, if it returned a positive value, it was the <code>least positive remainder</code> and if it returned a negative value, it was the <code>least negative remainder</code>.  The sign of the returned value can be determined in multiple ways.  For example given <code>c = a mod b</code>, you could define the sign of <code>c</code> to be</p>\n\n<ul>\n<li>The sign of a (what <code>%</code> does in Go)</li>\n<li>The sign of b (what <code>%</code> does in Python)</li>\n<li>Non-negative always</li>\n</ul>\n\n<p>Here's a list of programming languages and their modulo implementations defined in this way <a href=\"https://en.wikipedia.org/wiki/Modulo_operation#In_programming_languages\" rel=\"noreferrer\">https://en.wikipedia.org/wiki/Modulo_operation#In_programming_languages</a></p>\n\n<p>Anyways, here's a branchless way to replicate Python's <code>%</code> operator with a Go function</p>\n\n<pre><code>func mod(a, b int) int {\n    return (a % b + b) % b\n}\n</code></pre>\n\n<p>To reiterate, this follows the rule</p>\n\n<blockquote>\n  <p>given <code>c = a mod b</code>, the sign of <code>c</code> will be the sign of b.\n  Or in other words, the modulus result has the same sign as the divisor</p>\n</blockquote>\n"}], "owner": {"reputation": 4671, "user_id": 4927751, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VwUAi.jpg?s=128&g=1", "display_name": "Kshitij Saraogi", "link": "https://stackoverflow.com/users/4927751/kshitij-saraogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3674, "favorite_count": 4, "answer_count": 3, "score": 12, "last_activity_date": 1576190714, "creation_date": 1490455606, "last_edit_date": 1495541847, "question_id": 43018206, "link": "https://stackoverflow.com/questions/43018206/modulo-of-negative-integers-in-go", "title": "Modulo of negative integers in Go", "body": "<p>I am learning GoLang currently and I come from a Python background.</p>\n\n<p>Recently, I stumbled onto a behaviour of the <code>%</code>(modulo) operator which is different from the corresponding operator in Python. Quite contrary to the definition of <a href=\"https://en.wikipedia.org/wiki/Modulo_operation\" rel=\"noreferrer\">modular operation</a> and remainder, the modulus of negative integers by a positive integer returns a negative value.</p>\n\n<p>Example:</p>\n\n<h3>Python</h3>\n\n<pre><code>a, b, n = -5, 5, 3\nfor i in range(a, b):\n    print(i%n)    \n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1\n2\n0\n1\n2\n0\n1\n2\n0\n1\n</code></pre>\n\n<h3>Go</h3>\n\n<pre><code>a, b, n := -5, 5, 3\nfor i:=a; i&lt;b; i++ {\n    fmt.Println(i%n)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>-2\n-1\n0\n-2\n-1\n0\n1\n2\n0\n1\n</code></pre>\n\n<p>After reading about the <a href=\"https://math.stackexchange.com/questions/519845/modulo-of-a-negative-number\">Modulo operator</a> and few similar <a href=\"https://stackoverflow.com/questions/11630321/why-does-c-output-negative-numbers-when-using-modulo\">questions</a> asked about the reason behind these differences, I understand that these were due to design goals of the concerned languages. </p>\n\n<p>Q1. I would like to know why Go follows the protocol of C/C++ instead of Python here. Any links to relevant discussion will be helpful.</p>\n\n<p>Q2. Is there a built-in functionality in Go which replicates the modulus operation of Python?<br>\nAlternate: Is there an internal method for computing the \"modulus\" instead of the \"remainder\"?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore", "datastore"], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1490464974, "post_id": 43019217, "comment_id": 73127937, "body": "Wow, exactly what I needed.. thanks a lot &lt;3.. but I&#39;m really curious about why it&#39;s a waste, I mean in the above example, if you do Client.GetAll() on OrderDetails, then how can you get Orders and Products if you don&#39;t store any OrderID and ProductID?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1490465577, "post_id": 43019217, "comment_id": 73128167, "body": "@fisker You may use <code>datastore.IDKey()</code> to construct a <code>datastore.Key</code> from a numeric ID. See edited answer, added an example."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1490467464, "post_id": 43019217, "comment_id": 73128775, "body": "Ahh, I think I understand.. so if I want to keep having the ID field for Orders and Products (to display the ID in the web application) then I should add <code>datastore:&quot;-&quot;</code> so it doesn&#39;t waste datastore resources, and before returning the <code>var order Order</code> struct (after doing <code>client.Get(ctx, orderKey, &amp;order)</code>) I can set <code>order.ID = orderKey.ID</code>?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1490467574, "post_id": 43019217, "comment_id": 73128807, "body": "@fisker Exactly."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1490484665, "last_edit_date": 1495535410, "creation_date": 1490460988, "answer_id": 43019217, "question_id": 43017667, "link": "https://stackoverflow.com/questions/43017667/datastore-how-to-put-key-inside-struct-id-golang/43019217#43019217", "title": "Datastore - How to put Key inside Struct ID (golang)?", "body": "<p>One option is to allocate keys in advance, which you can set in your structs prior to calling <a href=\"https://godoc.org/cloud.google.com/go/datastore#Client.Put\" rel=\"nofollow noreferrer\"><code>Client.Put()</code></a>.</p>\n\n<p>You can allocate IDs with the <a href=\"https://godoc.org/cloud.google.com/go/datastore#Client.AllocateIDs\" rel=\"nofollow noreferrer\"><code>Client.AllocateIDs()</code></a>.  You can pass a slice of incomplete keys to it, and you get back a slice of complete <a href=\"https://godoc.org/cloud.google.com/go/datastore#Key\" rel=\"nofollow noreferrer\"><code>datastore.Key</code></a>s, which the datastore reserves for you (and thus guarantees not to \"give out\" to others or use when saving entities with incomplete keys). You can access the numeric IDs of the allocated keys in the <code>Key.ID</code> field.</p>\n\n<p>But storing the numeric Key ID in the entities is redundant, and I find it a waste (of resources). Whenever you load an entity e.g. with <a href=\"https://godoc.org/cloud.google.com/go/datastore#Client.Get\" rel=\"nofollow noreferrer\"><code>Client.Get()</code></a>, or multiple with <a href=\"https://godoc.org/cloud.google.com/go/datastore#Client.GetAll\" rel=\"nofollow noreferrer\"><code>Client.GetAll()</code></a>, you also get back the keys, and you can fill the numeric IDs in the structs \"manually\" as a post-processing step. You can also wrap this post-processing functionality in a function which does this for you whenever you get entities from the datastore.</p>\n\n<p>For example, if you have an <code>OrderDetails</code> entity loaded, which contains the <code>OrderID</code>, you may use <a href=\"https://godoc.org/cloud.google.com/go/datastore#IDKey\" rel=\"nofollow noreferrer\"><code>datastore.IDKey()</code></a> to construct the <code>datastore.Key</code> for the respective <code>Order</code> entity. Example doing it:</p>\n\n<pre><code>var orderDetails OrderDetails\n// Load orderDetails\n\norderKey := datastore.IDKey(\"order\", orderDetails.OrderID, nil)\n// Now you have the key for the Order entity\n\nvar order Order\nerr := client.Get(ctx, orderKey, &amp;order)\n</code></pre>\n\n<p>Which means you shouldn't store the \"self ID\" in the entities, you can construct <code>datastore.Key</code> values if the numeric ID is known.</p>\n\n<p>Also see related question: <a href=\"https://stackoverflow.com/questions/29567819/can-i-use-allocateids-as-string-datastore/29573089#29573089\">Can I use AllocateIDs as &quot;string&quot; ? datastore</a></p>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 0, "accepted_answer_id": 43019217, "answer_count": 1, "score": 3, "last_activity_date": 1490484665, "creation_date": 1490452566, "question_id": 43017667, "link": "https://stackoverflow.com/questions/43017667/datastore-how-to-put-key-inside-struct-id-golang", "title": "Datastore - How to put Key inside Struct ID (golang)?", "body": "<p>I'm trying to build a many to many relationship, so I have 3 structs:</p>\n\n<pre><code>type Orders struct {\n  ID int64\n  CustomerID string\n  etc\n}\n\ntype Products struct {\n  ID int64\n  Name string\n  Description string\n  etc\n}\n\ntype OrderDetails struct {\n  OrderID int64\n  ProductID string\n  Quantity int\n}\n</code></pre>\n\n<p>I believe this is the right way to do it, but my problem now is that I do not know how to put the datastore key inside the struct ID without making two client.Put requests because as far as I can tell, <code>datastore.IncompleteKey(\"Products\", nil)</code> will not return the new key value until after you put it..</p>\n\n<p>I guess some people would recommend using <code>key *datastore.Key</code> instead of <code>ID int64</code>, but I would prefer to convert the key to an ID</p>\n\n<p>Any help would be much appreciated</p>\n"}, {"tags": ["go", "type-assertion", "type-switch"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1490451276, "post_id": 43017440, "comment_id": 73123042, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/40575033/golang-multiple-case-in-type-switch\">golang multiple case in type switch</a>"}, {"owner": {"reputation": 1408, "user_id": 7658313, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d71486222cefe1935ac81e02fc0f2f51?s=128&d=identicon&r=PG", "display_name": "lnshi", "link": "https://stackoverflow.com/users/7658313/lnshi"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1490451857, "post_id": 43017440, "comment_id": 73123242, "body": "@timCooper Yea, then I know it would not work like above, but what is the elegant solutions for my case? I don&#39;t need to identify those two types, just want to range over the data. Tried to put the code in <code>default</code>, still compile error."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 2, "creation_date": 1490452535, "post_id": 43017440, "comment_id": 73123446, "body": "If you want to have the same code operate on different types, that usually means that you should define an interface to encapsulate the required functionality and then implement that interface for those types."}], "answers": [{"comments": [{"owner": {"reputation": 1408, "user_id": 7658313, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d71486222cefe1935ac81e02fc0f2f51?s=128&d=identicon&r=PG", "display_name": "lnshi", "link": "https://stackoverflow.com/users/7658313/lnshi"}, "edited": false, "score": 0, "creation_date": 1490506853, "post_id": 43020908, "comment_id": 73137533, "body": "Than u very much for this so detailed answer and awesome explanations. It turns out that at the end I need to <code>json.Marshal</code> the data, so even for those two types, I still need to clearly know the type, the underlying struct definitions. Thank u again."}, {"owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "reply_to_user": {"reputation": 1408, "user_id": 7658313, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d71486222cefe1935ac81e02fc0f2f51?s=128&d=identicon&r=PG", "display_name": "lnshi", "link": "https://stackoverflow.com/users/7658313/lnshi"}, "edited": false, "score": 0, "creation_date": 1490516319, "post_id": 43020908, "comment_id": 73139427, "body": "You don&#39;t need to have a typed variable to marshal it to json. If you look at the signature of <code>json.Marshal</code> (<a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#Marshal</a>) you&#39;ll find that it takes an <code>interface{}</code>. The <code>json</code> package uses reflection to figure out the struct definition."}], "tags": [], "owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "is_accepted": false, "score": 1, "last_activity_date": 1490470342, "last_edit_date": 1490470342, "creation_date": 1490469874, "answer_id": 43020908, "question_id": 43017440, "link": "https://stackoverflow.com/questions/43017440/go-what-is-wrong-with-this-multiple-case-conditions-in-type-switch-assertions/43020908#43020908", "title": "Go: what is wrong with this multiple case conditions in type switch assertions?", "body": "<p>If the case enumerates multiple types (like it does in your example), the variable's type won't be narrowed, so in your case it will be <code>interface{}</code>. This is what the question you link to says, and there is no way around it.</p>\n\n<p>To dispatch some generic code for two different type cases, you will need to introduce an interface somewhere inbetween. (This might change if Go at some point introduces generics, but from the looks of it, that won't happen soon if ever.) There are a few ways you could do this, here are three:</p>\n\n<h1>1 - Define types for your maps, and add a common interface</h1>\n\n<p>Don't use the maps directly, but define types that are maps, and add functions to them.</p>\n\n<pre><code>type SnapshotMap map[string]*model.SnapshotByConv\ntype UserSnapshotMap map[string]*model.UserSnapshotsMap\n\nfunc (sm *SnapshotMap) DoLogic() {/*...*/}\nfunc (usm *UserSnapshotMap) DoLogic() {/*...*/}\n\ntype LogicDoer interface {\n    DoLogic()\n}\n\n// ...\n\nswitch data := docs.(type) {\ncase LogicDoer:\n    data.DoLogic()\n// ...\n}\n</code></pre>\n\n<h1>2 - Make the maps hold a common interface</h1>\n\n<p>Don't create maps of pointers, but maps of interfaces that your snapshot types share.</p>\n\n<pre><code>type Snapshot interface {\n    LogicCommonToSnapshots()\n}\nvar doc interface{}\n\n// Somewhere else, this happens rather than a creating map[string]*Something\ndoc = make(map[string]Snapshot)\n\n// ...\n\nswitch data := doc.(type) {\ncase map[string]Snapshot:\n    for ver, _ := range data {\n        ver.LogicCommonToSnapshots()\n    }\n// ...\n}\n</code></pre>\n\n<h1>3 - Break out the logic and make it call back onto a common interface</h1>\n\n<p>Split the switch case into two separate cases, but break out the logic into a function that can operate on either snapshot type. That way, you won't have to duplicate the logic.</p>\n\n<pre><code>type Snapshot interface {\n    LogicCommonToSnapshots()\n}\n\nfunc ComplexLogic(s Snapshot) {/*...*/}\n\nswitch data := doc.(type) {\ncase map[string] *model.SnapshotByConv:\n    for ver, _ := range data\n        ComplexLogic(ver)\n    }\ncase map[string] *model.UserSnapshotsMap:\n    for ver, _ := range data {\n        ComplexLogic(ver)\n    }\n// ...\n}\n</code></pre>\n\n<p>Notice that in all three cases, there is an interface that separates the common logic from the object that logic acts on. You must <em>necessarily</em> introduce a dynamic binding between the logic and the object to accomplish what you describe, either through interfaces or by e.g. creating an anonymous function that captures the object gets passed to the logic.</p>\n"}], "owner": {"reputation": 1408, "user_id": 7658313, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d71486222cefe1935ac81e02fc0f2f51?s=128&d=identicon&r=PG", "display_name": "lnshi", "link": "https://stackoverflow.com/users/7658313/lnshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1463, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490470342, "creation_date": 1490451181, "last_edit_date": 1495541416, "question_id": 43017440, "link": "https://stackoverflow.com/questions/43017440/go-what-is-wrong-with-this-multiple-case-conditions-in-type-switch-assertions", "title": "Go: what is wrong with this multiple case conditions in type switch assertions?", "body": "<p>I have the code generally like this:</p>\n\n<pre><code>func BulkInsert(docs interface{}) {\n    switch data := docs.(type) {\n        case map[string] *model.SnapshotByConv, map[string] *model.UserSnapshotsMap:\n            for ver, _ := range data {\n                // other logics ...\n            }\n        case map[int64] map[string] *model.Delta:\n            for ver, _ := range data {\n                // other logics ...\n            }\n    }\n}\n</code></pre>\n\n<p>Then when compile I got the error:\n<code>cannot range over data (type interface {})</code>, it is raised by the first <code>range</code>.</p>\n\n<p>If I remove the multiple types in the first case, which means leave it as <code>case map[string] *model.SnapshotByConv:</code></p>\n\n<p>Then the compile error is gone, it is wried, I need to proceed the exactly same logics on those two types, so why I cannot put them in a same <code>case</code>?</p>\n\n<p>Pls help, thanks.</p>\n\n<p>I think the case here is not same with the one already had answer here: <a href=\"https://stackoverflow.com/questions/40575033/golang-multiple-case-in-type-switch\">golang multiple case in type switch</a>, which is trying to find a way to identify the types, but here is I just don't want to identify certain types and simply run some logics on it, I cannot find a elegant way to do this.</p>\n"}, {"tags": ["go", "jetbrains-ide", "goland"], "comments": [{"owner": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "edited": false, "score": 0, "creation_date": 1491559937, "post_id": 43017075, "comment_id": 73618747, "body": "It&#39;s a bug. It will be fixed next version. As a workaround remove <code>:</code> from Run configuration name."}], "answers": [{"comments": [{"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "edited": false, "score": 0, "creation_date": 1490501355, "post_id": 43022611, "comment_id": 73136633, "body": "Yes, I am working on Windows.  And the same working directory works fine to run the program, not tests."}], "tags": [], "owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "is_accepted": true, "score": 0, "last_activity_date": 1490480367, "creation_date": 1490480367, "answer_id": 43022611, "question_id": 43017075, "link": "https://stackoverflow.com/questions/43017075/cannot-create-temporary-ouput-file-while-running-tests/43022611#43022611", "title": "&#39;Cannot create temporary ouput file&#39; while running tests", "body": "<p>Are you sure your working directory is correct?</p>\n\n<p><code>D:</code> looks like Windows</p>\n\n<p><code>/development/gopath/</code>... is Linux</p>\n"}], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 43022611, "answer_count": 1, "score": 0, "last_activity_date": 1490480367, "creation_date": 1490449307, "question_id": 43017075, "link": "https://stackoverflow.com/questions/43017075/cannot-create-temporary-ouput-file-while-running-tests", "title": "&#39;Cannot create temporary ouput file&#39; while running tests", "body": "<p>Here is my configuration:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KfFjm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KfFjm.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I am trying to run the tests I get the error <code>Cannot create temporary ouput file</code>. As I see the is no setting for <code>Output directory</code> here.</p>\n\n<p>How can I run the tests in Gogland ?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 63390, "user_id": 2683814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16a4c2fb341c51388d5cdfcf0e956f6c?s=128&d=identicon&r=PG&f=1", "display_name": "s7vr", "link": "https://stackoverflow.com/users/2683814/s7vr"}, "edited": false, "score": 0, "creation_date": 1490450125, "post_id": 43016813, "comment_id": 73122684, "body": "You can try something like <code>collection.Find(bson.M{&quot;messages.text&quot;: &amp;bson.RegEx{Pattern: textToFind, Options: &quot;i&quot;}})</code>"}, {"owner": {"reputation": 532, "user_id": 5033823, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-5U-bEbVz9cY/AAAAAAAAAAI/AAAAAAAAABM/swSBgu7YT9I/photo.jpg?sz=128", "display_name": "Konstantin Chsherbakov", "link": "https://stackoverflow.com/users/5033823/konstantin-chsherbakov"}, "reply_to_user": {"reputation": 63390, "user_id": 2683814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16a4c2fb341c51388d5cdfcf0e956f6c?s=128&d=identicon&r=PG&f=1", "display_name": "s7vr", "link": "https://stackoverflow.com/users/2683814/s7vr"}, "edited": false, "score": 0, "creation_date": 1490451971, "post_id": 43016813, "comment_id": 73123279, "body": "@Veeram I&#39;ve tried but it does not work."}], "answers": [{"tags": [], "owner": {"reputation": 63390, "user_id": 2683814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16a4c2fb341c51388d5cdfcf0e956f6c?s=128&d=identicon&r=PG&f=1", "display_name": "s7vr", "link": "https://stackoverflow.com/users/2683814/s7vr"}, "is_accepted": true, "score": 1, "last_activity_date": 1490455735, "last_edit_date": 1490455735, "creation_date": 1490454958, "answer_id": 43018079, "question_id": 43016813, "link": "https://stackoverflow.com/questions/43016813/search-array-of-nested-objects-by-given-field/43018079#43018079", "title": "Search array of nested objects by given field", "body": "<p>You can try the below mongo shell aggregation pipeline.</p>\n\n<p><code>$match</code>es on some room attribute (ex <code>_id</code>).</p>\n\n<p><code>$unwind</code> messages( transform <code>messages</code> array into object ) in the room.</p>\n\n<p><code>$match</code>es on input regex against <code>text</code> field to filter <code>messages</code>.</p>\n\n<p><code>$group</code>s the message objects back into <code>messages</code> array.</p>\n\n<p><code>$project</code> to exclude <code>_id</code> and include only <code>messages</code> for output.</p>\n\n<pre><code>db.collection.aggregate(\n{$match:{\"_id\":roomid}}, \n{$unwind:\"$messages\"}, \n{$match:{\"messages.text\": { $regex: /textToFind/i } }},\n{$group:{_id:null,messages:{$push:\"$messages\"}}}, \n{$project:{_id:0, messages:1}})\n</code></pre>\n\n<p>Below is untested mgo equivalent.</p>\n\n<pre><code>match1 := bson.M{\n    \"$match\": bson.M{\n        \"_id\": roomid,\n    },\n}\n\nunwind := bson.M{\n    \"$unwind\": \"$messages\",\n}\n\nmatch2 := bson.M{\n    \"$match\": bson.M{\"messages.text\": &amp;bson.RegEx{Pattern: textToFind, Options: \"i\"}},\n}\n\ngroup := bson.M{\n    \"$group\": bson.M{\n        \"_id\": null,\n        \"messages\": bson.M{\n            \"$push\": \"$messages\",\n        },\n    },\n}\n\nproject := bson.M{\n    \"$project\":  bson.M{\n        \"_id\": 0, \n        \"messages\":1,\n    },\n}\n\nall := []bson.M{match1, unwind, match2, group, project}\npipe := collection.Pipe(all)\n\nresult := []bson.M{}\nerr := pipe.All(&amp;result)\n</code></pre>\n"}], "owner": {"reputation": 532, "user_id": 5033823, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-5U-bEbVz9cY/AAAAAAAAAAI/AAAAAAAAABM/swSBgu7YT9I/photo.jpg?sz=128", "display_name": "Konstantin Chsherbakov", "link": "https://stackoverflow.com/users/5033823/konstantin-chsherbakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 0, "accepted_answer_id": 43018079, "answer_count": 1, "score": 0, "last_activity_date": 1490455735, "creation_date": 1490447800, "last_edit_date": 1490452317, "question_id": 43016813, "link": "https://stackoverflow.com/questions/43016813/search-array-of-nested-objects-by-given-field", "title": "Search array of nested objects by given field", "body": "<p>I have the following structure of the Room object.</p>\n\n<pre><code>type Room struct {\nId          bson.ObjectId       `json:\"id\" bson:\"_id,omitempty\"`\nTitle       string              `json:\"title\" bson:\"title\"`\nDescription string              `json:\"description\" bson:\"description,omitempty\"`\nType        string              `json:\"type\" bson:\"type,omitempty\"`\nAdminId     bson.ObjectId       `json:\"admin_id\" bson:\"admin_id\"`\nCreatedOn   time.Time           `json:\"created_on\" bson:\"created_on\"`\nMessages    []Message           `json:\"messages\" bson:\"messages,omitempty\"`}\n</code></pre>\n\n<p>Where Messages is nested array of objects that has the following structure</p>\n\n<pre><code>type Message struct {\nId      bson.ObjectId   `json:\"id\" bson:\"_id,omitempty\"`\nText        string          `json:\"text\" bson:\"text\"`\nAuthor      Author          `json:\"author\" bson:\"author\"`\nCreatedOn   time.Time   `json:\"createdon\" bson:\"created_on\"`\nReply       []Message   `json:\"reply\" bson:\"reply,omitempty\"`}\n</code></pre>\n\n<p>I want to perform the search query by the messages in the collection of rooms. I tried using <code>\"$in\"</code> but I did not help me.</p>\n\n<p>Moreover, I have to search elements by matching values. I can do this using bson regular expressions.</p>\n\n<pre><code>&amp;bson.RegEx{Pattern: textToFind, Options: \"i\"}\n</code></pre>\n\n<p>Summing up I need to search messages by the <code>Text</code> field in the nested object in the Room document.</p>\n\n<p>P.S. Sorry for possible mistakes, English is not my native language. </p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Basically, I want to find all the messages in the given room that contains some substring. For example, search for all messages in the room (chat) 'A' that contains 'some text' substring. </p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "edited": false, "score": 0, "creation_date": 1490444304, "post_id": 43015662, "comment_id": 73120950, "body": "Thanks, I didn&#39;t know of that tool Tooling seems to be quite mature now after 10 years of go. One data race happens when I output the whole transfer object upon sending a log message to the status channel. I can avoid that. Another problem seems to be the summation at the very end. But I don&#39;t understand why this should be a problem, since all channels have already been closed by then."}, {"owner": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "edited": false, "score": 0, "creation_date": 1490445154, "post_id": 43015662, "comment_id": 73121214, "body": "Now I created a GetBalance() function/method that uses a mutex around the acces to Balance. The data race detecter now doesn&#39;t detect any more data races. But they still happen."}, {"owner": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "edited": false, "score": 0, "creation_date": 1490449743, "post_id": 43015662, "comment_id": 73122559, "body": "Thanks for pointing out the logging issue. But I don&#39;t just assume that the work of the goroutines is finished immediately. They write back through the status channel (which happens TRANSFERS times) as soon as they&#39;re all done. And then they must be done, right?"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "reply_to_user": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "edited": false, "score": 0, "creation_date": 1490450127, "post_id": 43015662, "comment_id": 73122685, "body": "When the message transfer is written to the status channel, you know that the last transfer message was written and received, not that is was processed. Trying to acquire a mutex allows the scheduler to move on to another thread, e.g. back to the routine that wrote the transfer, which then happily moves on. However, the transfer was not actually done. Note that I am not sure that this is <i>the</i> issue you are facing; I do think that it is <i>an</i> issue in your code."}], "tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": true, "score": 2, "last_activity_date": 1490460619, "last_edit_date": 1490460619, "creation_date": 1490440513, "answer_id": 43015662, "question_id": 43015259, "link": "https://stackoverflow.com/questions/43015259/go-bank-transfer-simulation-using-goroutines/43015662#43015662", "title": "Go: Bank Transfer Simulation using Goroutines", "body": "<p>Since this is homework (and thanks for saying so), here is a clue.</p>\n\n<blockquote>\n  <p>I really don't get at what other place synchronization might be an issue. </p>\n</blockquote>\n\n<p>Whenever you run into this question, use the <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">Go data race detector</a>. It has a few things to say about your code.</p>\n\n<p>[Edit]</p>\n\n<p>Another problem:</p>\n\n<pre><code>fmt.Printf(\"Start: foo: %4d, bar: %4d\\n\", fooStartBalance, fooStartBalance)\nfmt.Printf(\"  End: foo: %4d, bar: %4d\\n\", fooEndBalance, fooEndBalance)\n</code></pre>\n\n<p>You print foo twice, instead of foo and bar.</p>\n\n<p>The real problem is that you run your Execute goroutines, and assume that their work is finished immediately:</p>\n\n<pre><code>for i := 0; i &lt; ACCOUNTS; i++ {\n    go fooToBarTransfers[i].Execute(status)\n    go barToFooTransfers[i].Execute(status)\n}\n\nfor i := 0; i &lt; TRANSFERS; i++ {\n    fmt.Printf(\"%2d. %s\\n\", i+1, &lt;-status)\n}\nclose(status)\n</code></pre>\n\n<p>Here, you consider the job done and move on to printing the result:</p>\n\n<pre><code>fooEndBalance := 0\nbarEndBalance := 0\n...\n</code></pre>\n\n<p>However, the goroutines may not be done at this point. You need to wait for them to be over before being sure that the transfer is done. Can you find a way to do that by yourself?</p>\n"}, {"tags": [], "owner": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "is_accepted": false, "score": 0, "last_activity_date": 1490515469, "last_edit_date": 1490515469, "creation_date": 1490461032, "answer_id": 43019224, "question_id": 43015259, "link": "https://stackoverflow.com/questions/43015259/go-bank-transfer-simulation-using-goroutines/43019224#43019224", "title": "Go: Bank Transfer Simulation using Goroutines", "body": "<p>Thanks, Zoyd, you helped me to point out the issue. The issue is that the status is reported without having waited for both Listen methods. Here's what I'm doing now:</p>\n\n<pre><code>func (transfer Transfer) Execute(status chan&lt;- string) {\n    const PAYMENT = 1\n    sourceChannel := make(chan int)\n    targetChannel := make(chan int)\n    sourceControlChannel := make (chan bool) // new\n    targetControlChannel := make (chan bool) // new\n    go transfer.Source.Listen(sourceChannel, sourceControlChannel)\n    go transfer.Target.Listen(targetChannel, targetControlChannel)\n    for paid := 0; paid &lt; transfer.Amount; paid += PAYMENT {\n        sourceChannel &lt;- -PAYMENT\n        targetChannel &lt;- +PAYMENT\n    }\n    close(sourceChannel)\n    close(targetChannel)\n    // new condition\n    if &lt;- sourceControlChannel &amp;&amp; &lt;- targetControlChannel {\n        status &lt;- fmt.Sprintf(\"transfer done\" )\n    }\n}\n\nfunc (account *Account) Listen(channel &lt;-chan int, control chan&lt;- bool) {\n    for amount := range channel {\n        account.Lock()\n        account.Balance += amount\n        account.Unlock()\n    }\n    control &lt;- true // new\n}\n</code></pre>\n\n<p>It looks quite clumsy to me. I try to improve on that, but the issue now seems to be gone.</p>\n\n<p>Edit: I now tried to simplify the code a bit. It's now working and the data race detector doesn't complain anymore, even though I don't use methods to access the balance.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"sync\"\n)\n\ntype account struct {\n    owner string\n    number int\n    sync.Mutex\n    balance int\n}\n\nfunc (acc *account) listen(transfers &lt;-chan int, control chan&lt;- bool) {\n    for amount := range transfers {\n        acc.Lock()\n        acc.balance += amount\n        acc.Unlock()\n    }\n    control &lt;- true\n}\n\ntype transfer struct {\n    source *account\n    target *account\n    amount int\n}\n\nfunc (trans transfer) execute(status chan&lt;- string) {\n    const PAYMENT = 1\n    sourceChannel := make(chan int)\n    targetChannel := make(chan int)\n    controlChannel := make (chan bool)\n    go trans.source.listen(sourceChannel, controlChannel)\n    go trans.target.listen(targetChannel, controlChannel)\n    for paid := 0; paid &lt; trans.amount; paid += PAYMENT {\n        sourceChannel &lt;- -PAYMENT\n        targetChannel &lt;- +PAYMENT\n    }\n    close(sourceChannel)\n    close(targetChannel)\n    if &lt;- controlChannel &amp;&amp; &lt;- controlChannel {\n        status &lt;- \"transfer done\"\n    }\n}\n\nfunc main() {\n    const ACCOUNTS = 10\n    const TRANSFERS = ACCOUNTS * 2\n    const AMOUNT = 100\n    const BALANCE = 1000\n\n    fooBalance := 0\n    barBalance := 0\n    foo := [ACCOUNTS]*account{}\n    bar := [ACCOUNTS]*account{}\n    for i := 0; i &lt; ACCOUNTS; i++ {\n        foo[i] = &amp;account{owner: \"foo\", number: i, balance: BALANCE}\n        bar[i] = &amp;account{owner: \"bar\", number: i, balance: BALANCE}\n        fooBalance += foo[i].balance\n        barBalance += bar[i].balance\n    }\n\n    fooToBar := [ACCOUNTS]*transfer{}\n    barToFoo := [ACCOUNTS]*transfer{}\n    for i := 0; i &lt; ACCOUNTS; i++ {\n        fooToBar[i] = &amp;transfer{source: foo[i], target: bar[i], amount: AMOUNT}\n        barToFoo[i] = &amp;transfer{source: bar[i], target: foo[i], amount: AMOUNT}\n    }\n\n    status := make(chan string)\n    for i := 0; i &lt; ACCOUNTS; i++ {\n        go fooToBar[i].execute(status)\n        go barToFoo[i].execute(status)\n    }\n\n    for i := 0; i &lt; TRANSFERS; i++ {\n        fmt.Printf(\"%d. %s\\n\", i + 1, &lt;-status)\n    }\n    close(status)\n\n    for i := 0; i &lt; ACCOUNTS; i++ {\n        fooBalance -= foo[i].balance\n        barBalance -= bar[i].balance\n    }\n    if (fooBalance != 0 || barBalance != 0) {\n        difference := math.Abs(float64(fooBalance)) + math.Abs(float64(barBalance))\n        fmt.Println(\"Error: difference detected: \", difference)\n    } else {\n        fmt.Println(\"Success: no difference detected\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 43015662, "answer_count": 2, "score": 2, "last_activity_date": 1490515469, "creation_date": 1490437721, "last_edit_date": 1490447195, "question_id": 43015259, "link": "https://stackoverflow.com/questions/43015259/go-bank-transfer-simulation-using-goroutines", "title": "Go: Bank Transfer Simulation using Goroutines", "body": "<p>For university, I had to implement a bank transfer simulation in Java. Having done that, I wanted to implement it in Go, because I heard a lot about Go's concurrency capabilities and wanted to try them out.</p>\n\n<p>I have two parties, foo and bar. Each party has a list of bank accounts with a balance and a number for identification. Every of foo's accounts should transfer a certain amount to one of bar's accounts. Those transfers should be split up in smaller and less suspicious transfers, transferring one unit repeatedly  until the whole amount was transferred. At the same time, bar is  transferring the same amount back to foo, so that the sum of foo's and bar's accounts, respectively, should be the same at the beginning and at the end.</p>\n\n<p>Here's my Account struct:</p>\n\n<pre><code>type Account struct {\n    Owner string\n    Number int\n    Balance int\n}\n\nfunc NewAccount(owner string, number int, balance int) *Account {\n    account := &amp;Account{Owner: owner, Number: number, Balance: balance}\n    return account\n}\n\nfunc (account Account) String() string {\n    return fmt.Sprintf(\"%s-%04d\", account.Owner, account.Number)\n}\n</code></pre>\n\n<p>This is the function/method the account has to run in order to receive payments (I implemented outgoing payments as payments of negative amounts):</p>\n\n<pre><code>func (account *Account) Listen(channel &lt;-chan int) {\n    for amount := range channel {\n        account.Balance += amount\n    }\n}\n</code></pre>\n\n<p>And here's my Transfer struct:</p>\n\n<pre><code>type Transfer struct {\n    Source *Account\n    Target *Account\n    Amount int\n}\n\nfunc NewTransfer(source *Account, target *Account, amount int) *Transfer {\n    transfer := Transfer{Source: source, Target: target, Amount: amount}\n    return &amp;transfer\n}\n\nfunc (transfer Transfer) String() string {\n    return fmt.Sprintf(\"Transfer from [%s] to [%s] with amount CHF %4d.-\",\n        transfer.Source, transfer.Target, transfer.Amount)\n}\n</code></pre>\n\n<p>Here's the function/method that performs the payment in a bunch of micro payments over a channel to each account:</p>\n\n<pre><code>func (transfer Transfer) Execute(status chan&lt;- string) {\n    const PAYMENT = 1\n    sourceChannel := make(chan int)\n    targetChannel := make(chan int)\n    go transfer.Source.Listen(sourceChannel)\n    go transfer.Target.Listen(targetChannel)\n    for paid := 0; paid &lt; transfer.Amount; paid += PAYMENT {\n        sourceChannel &lt;- -PAYMENT\n        targetChannel &lt;- +PAYMENT\n    }\n    close(sourceChannel)\n    close(targetChannel)\n    status &lt;- fmt.Sprintf(\"transfer done: %s\", transfer)\n}\n</code></pre>\n\n<p>And, finally, here's the actual program:</p>\n\n<pre><code>func main() {\n    const ACCOUNTS = 25\n    const TRANSFERS = ACCOUNTS * 2\n    const AMOUNT = 5000\n    const BALANCE = 9000\n\n    fooStartBalance := 0\n    barStartBalance := 0\n    fooAccounts := [ACCOUNTS]*Account{}\n    barAccounts := [ACCOUNTS]*Account{}\n    for i := 0; i &lt; ACCOUNTS; i++ {\n        fooAccounts[i] = NewAccount(\"foo\", i + 1, BALANCE)\n        fooStartBalance += fooAccounts[i].Balance\n        barAccounts[i] = NewAccount(\"bar\", i + 1, BALANCE)\n        barStartBalance += barAccounts[i].Balance\n    }\n\n    fooToBarTransfers := [ACCOUNTS]*Transfer{}\n    barToFooTransfers := [ACCOUNTS]*Transfer{}\n    for i := 0; i &lt; ACCOUNTS; i++ {\n        fooToBarTransfers[i] = NewTransfer(fooAccounts[i], barAccounts[i], AMOUNT)\n        barToFooTransfers[i] = NewTransfer(barAccounts[i], fooAccounts[i], AMOUNT)\n    }\n\n    status := make(chan string)\n    for i := 0; i &lt; ACCOUNTS; i++ {\n        go fooToBarTransfers[i].Execute(status)\n        go barToFooTransfers[i].Execute(status)\n    }\n\n    for i := 0; i &lt; TRANSFERS; i++ {\n        fmt.Printf(\"%2d. %s\\n\", i + 1, &lt;-status)\n    }\n    close(status)\n    fooEndBalance := 0\n    barEndBalance := 0\n    for i := 0; i &lt; ACCOUNTS; i++ {\n        fooEndBalance += fooAccounts[i].Balance\n        barEndBalance += barAccounts[i].Balance\n    }\n\n    fmt.Printf(\"Start: foo: %4d, bar: %4d\\n\", fooStartBalance, fooStartBalance)\n    fmt.Printf(\"  End: foo: %4d, bar: %4d\\n\", fooEndBalance, fooEndBalance)\n}\n</code></pre>\n\n<p>As the stdout shows, all the transfers have been done at the end:</p>\n\n<pre><code> 1. transfer done: Transfer from [bar-0011] to [foo-0011] with amount CHF 5000.-\n[other 48 transfers omitted]\n50. transfer done: Transfer from [bar-0013] to [foo-0013] with amount CHF 5000.-\n</code></pre>\n\n<p>But money is either created:</p>\n\n<pre><code>Start: foo: 225000, bar: 225000\n  End: foo: 225053, bar: 225053\n</code></pre>\n\n<p>Or lost:</p>\n\n<pre><code>Start: foo: 225000, bar: 225000\n  End: foo: 225053, bar: 225053\n</code></pre>\n\n<p>So I thought (with my Java mindset) that the problem might be Account.Listen(): maybe Balance is read by Goroutine A, then comes Goroutine B, executing Account.Listen() completely, then Goroutine A goes ahead doing the calculation with the old value. A mutex might fix it:</p>\n\n<pre><code>type Account struct {\n    Owner string\n    Number int\n    Balance int\n    Mutex sync.Mutex\n}\n\nfunc (account *Account) Listen(channel &lt;-chan int) {\n    for amount := range channel {\n        account.Mutex.Lock()\n        account.Balance += amount\n        account.Mutex.Unlock()\n    }\n}\n</code></pre>\n\n<p>Which works great... nine ouf of ten times. But then:</p>\n\n<pre><code>Start: foo: 225000, bar: 225000\n  End: foo: 225001, bar: 225001\n</code></pre>\n\n<p>This is very strange. The mutex seems to help, because it works most of the time, and when it doesn't work, it's only off by one. I really don't get at what other place synchronization might be an issue. </p>\n\n<p>Update: I am no able to prevent data race warnings when I implement Account as follows:</p>\n\n<pre><code>type Account struct {\n    sync.Mutex\n    Owner string\n    Number int\n    Balance int\n}\n\nfunc NewAccount(owner string, number int, balance int) *Account {\n    account := &amp;Account{Owner: owner, Number: number, Balance: balance}\n    return account\n}\n\nfunc (account *Account) String() string {\n    return fmt.Sprintf(\"%s-%04d\", account.Owner, account.Number)\n}\n\nfunc (account *Account) Listen(channel &lt;-chan int) {\n    for amount := range channel {\n        account.Lock()\n        account.Balance += amount\n        account.Unlock()\n    }\n}\n\nfunc (account *Account) GetBalance() int {\n    account.Lock()\n    newBalance := account.Balance\n    defer account.Unlock()\n    return newBalance\n}\n</code></pre>\n\n<p>And I also access the Balance at the end like this:</p>\n\n<pre><code>fooEndBalance += fooAccounts[i].GetBalance()\nbarEndBalance += barAccounts[i].GetBalance()\n</code></pre>\n\n<p>As I said, the data race detecter now stays silent, but I still got some errors in roughly every 10th run:</p>\n\n<pre><code>Start: foo: 100000, bar: 100000\n  End: foo: 99999, bar: 99999\n</code></pre>\n\n<p>I really don't get what I'm doing wrong.</p>\n"}, {"tags": ["go", "intellij-idea", "jetbrains-ide", "goland"], "answers": [{"comments": [{"owner": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "edited": false, "score": 1, "creation_date": 1492503032, "post_id": 43014980, "comment_id": 73988893, "body": "1. Gogland&#39;s dlv is a signed binary for sure. 2. <code>Copy your dlv into gogland&#39;s bin dir.</code> is harmful. It breaks the sign of the Gogland application itself and it breaks patch update. Do not do this. 3. To replace dlv executable you should invoke Help | Edit Custom Properties\u2026 and add new line there: <code>dlv.path=&#47;path&#47;to&#47;custom&#47;delve</code>. 4. Invalidates caches doesn&#39;t affect debugging.  Please update your answer according to these notes."}, {"owner": {"reputation": 654, "user_id": 807695, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/8SKa7.jpg?s=128&g=1", "display_name": "simomo", "link": "https://stackoverflow.com/users/807695/simomo"}, "reply_to_user": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "edited": false, "score": 0, "creation_date": 1492504109, "post_id": 43014980, "comment_id": 73989542, "body": "@AlexanderZolotov but I do meet this issue, I googled everywhere, all solutions don&#39;t work for me, finally  the steps above resolved my issue.  And  I have ran Gogland&#39;s dlv in a shell, it raised the same error, that let me <b><i>guess</i></b> gogland&#39;s dlv binary doesn&#39;t be signed correctly, and I used the words <b><i>&quot;seems not&quot;</i></b> in my answer."}, {"owner": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "edited": false, "score": 0, "creation_date": 1492504160, "post_id": 43014980, "comment_id": 73989577, "body": "It might be just outdated and badly works on the new OS versions. It happened before. It&#39;s ok to guess the binary not signed propertly. I believe the third step deserve downvoting, it breaks user&#39;s installation."}, {"owner": {"reputation": 654, "user_id": 807695, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/8SKa7.jpg?s=128&g=1", "display_name": "simomo", "link": "https://stackoverflow.com/users/807695/simomo"}, "reply_to_user": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "edited": false, "score": 0, "creation_date": 1492504232, "post_id": 43014980, "comment_id": 73989630, "body": "Another pool man may meet &quot;outdated&quot; either :P I will update my answer per your comments. Thanks"}, {"owner": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "edited": false, "score": 0, "creation_date": 1492504446, "post_id": 43014980, "comment_id": 73989747, "body": "Sorry, I still can&#39;t get used to Enter&#39;s behavior. This is cool to have the instruction so anyone could update dlv in Gogland. So thanks a lot. it just should not break anything ;)"}, {"owner": {"reputation": 654, "user_id": 807695, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/8SKa7.jpg?s=128&g=1", "display_name": "simomo", "link": "https://stackoverflow.com/users/807695/simomo"}, "reply_to_user": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "edited": false, "score": 0, "creation_date": 1492504935, "post_id": 43014980, "comment_id": 73990064, "body": "Agree, <i>&quot;It breaks the sign of the Gogland application itself and it breaks patch update. &quot;</i> convince me, gogland may custom their own dlv binary. I&#39;ve updated my answer,"}, {"owner": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "edited": false, "score": 0, "creation_date": 1492505243, "post_id": 43014980, "comment_id": 73990262, "body": "Cool, thank you. Btw, restart is needed after updating custom properties"}, {"owner": {"reputation": 1072, "user_id": 1742474, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/3Gi1p.png?s=128&g=1", "display_name": "Vikash", "link": "https://stackoverflow.com/users/1742474/vikash"}, "edited": false, "score": 0, "creation_date": 1494610021, "post_id": 43014980, "comment_id": 74919216, "body": "After trying this, it started giving <code>Error: unknown flag: --backend</code> error."}, {"owner": {"reputation": 852, "user_id": 4715480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCjmn.jpg?s=128&g=1", "display_name": "WTIFS", "link": "https://stackoverflow.com/users/4715480/wtifs"}, "edited": false, "score": 0, "creation_date": 1554181453, "post_id": 43014980, "comment_id": 97645738, "body": "Not working for me. I have to degrade my go version to 1.10 to avoid the problem"}], "tags": [], "owner": {"reputation": 654, "user_id": 807695, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/8SKa7.jpg?s=128&g=1", "display_name": "simomo", "link": "https://stackoverflow.com/users/807695/simomo"}, "is_accepted": true, "score": 19, "last_activity_date": 1492505882, "last_edit_date": 1492505882, "creation_date": 1490435891, "answer_id": 43014980, "question_id": 43014884, "link": "https://stackoverflow.com/questions/43014884/mac-osx-jetbrains-gogland-delve-debugging-meet-could-not-launch-process-could/43014980#43014980", "title": "Mac OSX JetBrains Gogland: delve debugging meet &quot;could not launch process: could not fork/exec&quot;", "body": "<blockquote>\n  <p>Updated the anwser according to @Alexander's comment</p>\n</blockquote>\n\n<p>The truth is Gogland is using its own dlv binary, not the one you installed (manually or from <code>brew install</code>), and its own dlv binary seems not certificated or could be outdated in Mac's keychain, then it will cause the error above each time we run it.</p>\n\n<h1>To fix it:</h1>\n\n<h2>Install your own dlv</h2>\n\n<p>Installing it manually or using the brew both are ok <a href=\"https://github.com/derekparker/delve/blob/master/Documentation/installation/osx/install.md\" rel=\"noreferrer\">[official doc]</a>  and please make sure your cert have been set correctly </p>\n\n<h2>Setup gogland, point dlv path to your own dlv binary</h2>\n\n<h3>Step 1</h3>\n\n<p>Invoke <code>Help | Edit Custom Properties\u2026</code> and add new line there:</p>\n\n<pre><code>dlv.path=/path/to/custom/delve\n</code></pre>\n\n<h3>Step 2</h3>\n\n<p>Restart and try to debug again, it should fix the issue.</p>\n"}], "owner": {"reputation": 654, "user_id": 807695, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/8SKa7.jpg?s=128&g=1", "display_name": "simomo", "link": "https://stackoverflow.com/users/807695/simomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6037, "favorite_count": 3, "accepted_answer_id": 43014980, "answer_count": 1, "score": 2, "last_activity_date": 1576706927, "creation_date": 1490435180, "last_edit_date": 1491381965, "question_id": 43014884, "link": "https://stackoverflow.com/questions/43014884/mac-osx-jetbrains-gogland-delve-debugging-meet-could-not-launch-process-could", "title": "Mac OSX JetBrains Gogland: delve debugging meet &quot;could not launch process: could not fork/exec&quot;", "body": "<p>I'm using JetBrains Gogland 1.0 EAP on Mac OS, everything works good, but debugging (based on delve) will raise the error</p>\n\n<pre><code>could not launch process: could not fork/exec\n</code></pre>\n\n<p>How can I fix it?</p>\n"}, {"tags": ["arrays", "string", "go", "slice"], "comments": [{"owner": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "edited": false, "score": 4, "creation_date": 1490433496, "post_id": 43014592, "comment_id": 73118029, "body": "I&#39;m not sure I understand.  <code>[1]string{s}</code> is the array containing the string <code>s</code>.  Is that syntax all you&#39;re asking for?"}, {"owner": {"reputation": 61, "user_id": 4635458, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d91c63a4aa5941a1f27e4ae983207a7?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Gupta", "link": "https://stackoverflow.com/users/4635458/harshit-gupta"}, "reply_to_user": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "edited": false, "score": 0, "creation_date": 1490433663, "post_id": 43014592, "comment_id": 73118071, "body": "Nope doesn&#39;t work. Getting : <code>cannot use [1]string literal (type [1]string) as type []string in assignment</code>"}, {"owner": {"reputation": 35869, "user_id": 7512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d064a7aca29011d3246302b27c41f4d9?s=128&d=identicon&r=PG", "display_name": "slim", "link": "https://stackoverflow.com/users/7512/slim"}, "reply_to_user": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "edited": false, "score": 2, "creation_date": 1490433686, "post_id": 43014592, "comment_id": 73118080, "body": "I don&#39;t think &quot;effective&quot; means what you think it does. The method you&#39;ve described is effective. So is @DarshanRivkaWhittle &#39;s, but his is terser and more idiomatic."}, {"owner": {"reputation": 61, "user_id": 4635458, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d91c63a4aa5941a1f27e4ae983207a7?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Gupta", "link": "https://stackoverflow.com/users/4635458/harshit-gupta"}, "edited": false, "score": 0, "creation_date": 1490433728, "post_id": 43014592, "comment_id": 73118088, "body": "Basically I have a string array <code>message []string</code> so what I want to do is <code>message = [s]</code>"}, {"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 1, "creation_date": 1490441989, "post_id": 43014592, "comment_id": 73120286, "body": "What you want is not an array but a slice. Use <code>[]string(s)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 536, "user_id": 3991578, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7897364fd821ad568d266ee443da56f6?s=128&d=identicon&r=PG&f=1", "display_name": "Carsten Hagemann", "link": "https://stackoverflow.com/users/3991578/carsten-hagemann"}, "is_accepted": true, "score": 10, "last_activity_date": 1504181928, "last_edit_date": 1504181928, "creation_date": 1490433716, "answer_id": 43014662, "question_id": 43014592, "link": "https://stackoverflow.com/questions/43014592/how-to-convert-a-string-to-an-array-in-golang/43014662#43014662", "title": "How to convert a string to an array in Golang?", "body": "<p>To initialize a string slice in Go, you use <code>s := []string{\"This is a string\"}</code>.<br>\nTo initialize a string array in Go, you use <code>s := [1]string{\"This is a string\"}</code>.</p>\n\n<p>The only difference (in declaring each) lies in specifying the array length or not.</p>\n\n<p>To understand which structure you want to use, you should read more about the difference between <code>slices</code> and <code>arrays</code> <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"noreferrer\">on the Go Blog</a>.</p>\n"}], "owner": {"reputation": 61, "user_id": 4635458, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d91c63a4aa5941a1f27e4ae983207a7?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Gupta", "link": "https://stackoverflow.com/users/4635458/harshit-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19865, "favorite_count": 1, "accepted_answer_id": 43014662, "answer_count": 1, "score": 2, "last_activity_date": 1556560031, "creation_date": 1490433155, "last_edit_date": 1556560031, "question_id": 43014592, "link": "https://stackoverflow.com/questions/43014592/how-to-convert-a-string-to-an-array-in-golang", "title": "How to convert a string to an array in Golang?", "body": "<p>How to convert a string to an array of strings with one element (i.e. that string) in Go effectively. </p>\n\n<p>For example:</p>\n\n<pre><code>var s string\ns = \"This is a string\"\n</code></pre>\n\n<p>to </p>\n\n<pre><code>[\"This is a string\"]\n</code></pre>\n\n<p>Obviously, one way would be to make an array of strings and initialize the first element as that string but I am looking for an effective approach.</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 7169284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pvddMsO36IQ/AAAAAAAAAAI/AAAAAAAAABg/scyIWPDGtdY/photo.jpg?sz=128", "display_name": "Igni Serpens", "link": "https://stackoverflow.com/users/7169284/igni-serpens"}, "edited": false, "score": 0, "creation_date": 1490438356, "post_id": 43014923, "comment_id": 73119231, "body": "Ye, it works, thx. Not exactly like I want, but still. And still I am interested in code insertions be cause of avoiding of inner functions calls. In this case it&#39;s unnamed function in return func()."}], "tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1490435506, "creation_date": 1490435506, "answer_id": 43014923, "question_id": 43014528, "link": "https://stackoverflow.com/questions/43014528/golang-code-insert-substitute/43014923#43014923", "title": "golang code insert/substitute", "body": "<p>This trick might help: defer a call to a function returning a function enclosing the start time.</p>\n\n<pre><code>func elapsed() func() {\n    start := time.Now()\n    return func() {\n        fmt.Println(\"Duration was\", time.Since(start))\n    }\n}\n</code></pre>\n\n<p>Call it as follows:</p>\n\n<pre><code>defer elapsed()()\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/xpD3Pnb3Pk\" rel=\"nofollow noreferrer\">Have a play</a></p>\n\n<p>Having said that, benchmarking is the usual way to measure performance in Go. See <a href=\"https://dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go\" rel=\"nofollow noreferrer\">how to write benchmarks in Go</a>.</p>\n"}], "owner": {"reputation": 61, "user_id": 7169284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pvddMsO36IQ/AAAAAAAAAAI/AAAAAAAAABg/scyIWPDGtdY/photo.jpg?sz=128", "display_name": "Igni Serpens", "link": "https://stackoverflow.com/users/7169284/igni-serpens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490438224, "creation_date": 1490432716, "last_edit_date": 1490438224, "question_id": 43014528, "link": "https://stackoverflow.com/questions/43014528/golang-code-insert-substitute", "title": "golang code insert/substitute", "body": "<p>I like not to allow the code to repeat. But I have a situation, when I must repeat it in every function I want to measure execution time, and I can do nothing to it.\nFor example, a function:</p>\n\n<pre><code>func someFunc() {\n    start_time := time.Now()\n    defer fmt.Println(\"Execution time: %v\", time.Now().Sub(start_time))\n    &lt;... doing some bussiness ...&gt;\n}\n</code></pre>\n\n<p>Now I must repeat this two first strokes in every function (and in original they are more complicated because of calling a function name). So I cannot make a function which measures time, because i must use defer inside of it. I cannot make a function even for second stroke, cause in original it calls a function name in Println and that's why the resulting name will not be of needed function.\nIs there any way to insert this code by some label or a template, for example, like this:</p>\n\n<pre><code>func someFunc() {\n//go-insert measuretime.tmpl\n    &lt;... doing some bussiness ...&gt;\n}\n</code></pre>\n\n<p>And measuretime.tmpl is:</p>\n\n<pre><code>start_time := time.Now()\ndefer fmt.Println(\"Execution time: %v\", time.Now().Sub(start_time))\n</code></pre>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": true, "score": 3, "last_activity_date": 1490428010, "creation_date": 1490428010, "answer_id": 43013873, "question_id": 43013758, "link": "https://stackoverflow.com/questions/43013758/how-to-parse-array-json-in-go/43013873#43013873", "title": "How to parse array json in Go?", "body": "<p>Your Currency struct simply has to implement the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\">json.Unmarshaler</a> interface.</p>\n\n<pre><code>func (c *Currency) UnmarshalJSON(b []byte) error {\n    return json.Unmarshal(b, &amp;c.Result)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "is_accepted": false, "score": 2, "last_activity_date": 1490433928, "creation_date": 1490433928, "answer_id": 43014689, "question_id": 43013758, "link": "https://stackoverflow.com/questions/43013758/how-to-parse-array-json-in-go/43014689#43014689", "title": "How to parse array json in Go?", "body": "<p>You can also just change to <code>json.Unmarshal(body, &amp;v.Result)</code></p>\n"}], "owner": {"reputation": 959, "user_id": 4784553, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/KSIgw.jpg?s=128&g=1", "display_name": "Zept", "link": "https://stackoverflow.com/users/4784553/zept"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 43013873, "answer_count": 2, "score": 0, "last_activity_date": 1490438691, "creation_date": 1490427052, "last_edit_date": 1490438691, "question_id": 43013758, "link": "https://stackoverflow.com/questions/43013758/how-to-parse-array-json-in-go", "title": "How to parse array json in Go?", "body": "<p>I have the following JSON data:</p>\n\n<pre><code>[\n    {\n        \"id\": \"bitcoin\", \n        \"name\": \"Bitcoin\", \n        \"symbol\": \"BTC\", \n        \"rank\": \"1\", \n        \"price_usd\": \"960.094\", \n        \"price_btc\": \"1.0\", \n        \"24h_volume_usd\": \"438149000.0\", \n        \"market_cap_usd\": \"15587054083.0\", \n        \"available_supply\": \"16234925.0\", \n        \"total_supply\": \"16234925.0\", \n        \"percent_change_1h\": \"-0.76\", \n        \"percent_change_24h\": \"-7.78\", \n        \"percent_change_7d\": \"-14.39\", \n        \"last_updated\": \"1490393946\"\n    }\n]\n</code></pre>\n\n<p>And I have two struct:</p>\n\n<pre><code>type Valute struct {\n    Id     string `json:\"id\"`\n    Name   string `json:\"name\"`\n    Symbol string `json:\"symbol\"`\n}\n\ntype Currency struct {\n    Result []Valute\n}\n</code></pre>\n\n<p>I want to parse the array returned by this call:</p>\n\n<pre><code>resp, err := http.Get(\"https://api.coinmarketcap.com/v1/ticker/?limit=1\")\ndefer resp.Body.Close()\nv := Currency{}\nbody, err := ioutil.ReadAll(resp.Body)\njson.Unmarshal(body, &amp;v)\n</code></pre>\n\n<p>But it does not work for me. Currency is empty.</p>\n\n<p>It works with an array:</p>\n\n<pre><code>var valutes []Valute\njson.Unmarshal(body, &amp;valutes)\n</code></pre>\n\n<p>But I want to use a struct.</p>\n"}, {"tags": ["go", "trace", "grpc", "stackdriver"], "comments": [{"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1490425321, "post_id": 43012091, "comment_id": 73116069, "body": "What did you see and what did you expect to see? Your question is vague."}, {"owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "reply_to_user": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1490474242, "post_id": 43012091, "comment_id": 73130807, "body": "I expect to see traces on the stackdriver trace page of my project and I don&#39;t see traces."}, {"owner": {"reputation": 884, "user_id": 4271067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q0z9E.jpg?s=128&g=1", "display_name": "JL-HaiNan", "link": "https://stackoverflow.com/users/4271067/jl-hainan"}, "edited": false, "score": 0, "creation_date": 1493153175, "post_id": 43012091, "comment_id": 74290384, "body": "Are you able to fix it by the answer provided at the following?"}], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 1743844, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0b7f65a31f651365d53e05ea7e13e55?s=128&d=identicon&r=PG", "display_name": "stu", "link": "https://stackoverflow.com/users/1743844/stu"}, "is_accepted": false, "score": 0, "last_activity_date": 1492190454, "creation_date": 1492190454, "answer_id": 43416199, "question_id": 43012091, "link": "https://stackoverflow.com/questions/43012091/grpc-golang-stackdriver-tracer/43416199#43416199", "title": "gRPC - GoLang - Stackdriver tracer", "body": "<p>I followed those same tutorials and ran into similar problems.</p>\n\n<p>Header keys are converted to lowercase.  If you retrieve it on the server side with <code>header := strings.Join(md[\"x-cloud-trace-context\"], \"\")</code> you should be good.</p>\n\n<p>You can also define your metadata headers with:</p>\n\n<pre><code>span := trace.FromContext(ctx).NewChild(method)\ndefer span.Finish()\n\nmd := metadata.Pairs(\n    \"x-cloud-trace-context\", fmt.Sprintf(\"%s/%d;o=1\", span.TraceID(), 0),\n)\n\nctx = metadata.NewContext(ctx, md)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "is_accepted": true, "score": 1, "last_activity_date": 1493157185, "creation_date": 1493157185, "answer_id": 43621604, "question_id": 43012091, "link": "https://stackoverflow.com/questions/43012091/grpc-golang-stackdriver-tracer/43621604#43621604", "title": "gRPC - GoLang - Stackdriver tracer", "body": "<p>The issue was with:</p>\n\n<pre><code>defer span.Finish()\n</code></pre>\n\n<p>That call does not block so because I was just doing preliminary testing with one call my program was exiting before the traces could be uploaded. I contacted the author of <a href=\"https://rakyll.org/grpc-trace/\" rel=\"nofollow noreferrer\">https://rakyll.org/grpc-trace/</a> and she actually updated her post with the option of using:</p>\n\n<pre><code>defer span.FinishWait()\n</code></pre>\n\n<p>which blocks and that fixed it by allowing the traces to be successfully uploaded before the program exited. </p>\n\n<p>Also, with a long running webserver this wouldn't have been an issue because the process wouldn't have been terminated.</p>\n"}], "owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 1, "accepted_answer_id": 43621604, "answer_count": 2, "score": 1, "last_activity_date": 1493157185, "creation_date": 1490411498, "last_edit_date": 1490474421, "question_id": 43012091, "link": "https://stackoverflow.com/questions/43012091/grpc-golang-stackdriver-tracer", "title": "gRPC - GoLang - Stackdriver tracer", "body": "<p>I am trying to get the <a href=\"https://cloud.google.com/trace/\" rel=\"nofollow noreferrer\">stackdriver</a> tracer to work with <a href=\"http://www.grpc.io/\" rel=\"nofollow noreferrer\">gRPC</a> and I need some help. I have been looking at these two links for reference and I still can't get it to work:</p>\n\n<ul>\n<li><a href=\"https://medium.com/@harlow/tracing-grpc-calls-in-golang-with-google-stackdriver-b22495763a06#.81oa9q21v\" rel=\"nofollow noreferrer\">https://medium.com/@harlow/tracing-grpc-calls-in-golang-with-google-stackdriver-b22495763a06#.81oa9q21v</a></li>\n<li><a href=\"https://rakyll.org/grpc-trace/\" rel=\"nofollow noreferrer\">https://rakyll.org/grpc-trace/</a></li>\n</ul>\n\n<p>For simplicity, I am just working with the <a href=\"http://www.grpc.io/docs/quickstart/go.html\" rel=\"nofollow noreferrer\">hello world gRPC example</a>. Here's my client:</p>\n\n<pre><code>func main() {\n\n    // Set up a connection to the server.\n    conn, err := grpc.Dial(\"localhost:50051\", grpc.WithInsecure(), grpc.WithUnaryInterceptor(grpc.UnaryClientInterceptor(clientInterceptor)))\n    if err != nil {\n        log.Fatalf(\"did not connect: %v\", err)\n    }\n    defer conn.Close()\n    c := pb.NewGreeterClient(conn)\n\n    ctx := context.Background()\n\n    tc, err := trace.NewClient(ctx, \"{PROJECT-ID}\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    span := tc.NewSpan(\"/greeter/SayHello\")\n    defer span.Finish()\n\n    ctx = trace.NewContext(ctx, span)\n\n    r, err := c.SayHello(ctx, &amp;pb.HelloRequest{Name: \"world\"})\n    if err != nil {\n        log.Fatalf(\"could not greet: %v\", err)\n    }\n\n    println(\"Response:\", r.Message)\n}\n\nfunc clientInterceptor(ctx context.Context, method string, req, reply interface{}, cc *grpc.ClientConn, invoker grpc.UnaryInvoker, opts ...grpc.CallOption) error {\n    // trace current request w/ child span\n    span := trace.FromContext(ctx).NewChild(method)\n    defer span.Finish()\n\n    // new metadata, or copy of existing\n    md, ok := metadata.FromContext(ctx)\n    if !ok {\n        md = metadata.New(nil)\n    } else {\n        md = md.Copy()\n    }\n\n    // append trace header to context metadata\n    // header specification: https://cloud.google.com/trace/docs/faq\n    md[\"X-Cloud-Trace-Context\"] = append(\n        md[\"X-Cloud-Trace-Context\"], fmt.Sprintf(\"%s/%d;o=1\", span.TraceID(), 0),\n    )\n    ctx = metadata.NewContext(ctx, md)\n\n    return invoker(ctx, method, req, reply, cc, opts...)\n}\n</code></pre>\n\n<p>.. and my gRPC server:</p>\n\n<pre><code>// server is used to implement helloworld.GreeterServer.\ntype server struct{}\n\n// SayHello implements helloworld.GreeterServer\nfunc (s *server) SayHello(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) {\n    println(\"HERE\")\n    return &amp;pb.HelloReply{Message: \"Hello \" + in.Name}, nil\n}\n\nfunc main() {\n    lis, err := net.Listen(\"tcp\", \":50051\")\n    if err != nil {\n        log.Fatalf(\"failed to listen: %v\", err)\n    }\n\n    ctx := context.Background()\n    tc, err := trace.NewClient(ctx, \"{PROJECT-ID}\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    s := grpc.NewServer(EnableGRPCTracingServerOption(tc))\n    pb.RegisterGreeterServer(s, &amp;server{})\n\n    println(\"listening on :50051\")\n    if err := s.Serve(lis); err != nil {\n        log.Fatalf(\"failed to serve: %v\", err)\n    }\n}\n\n// EnableGRPCTracingServerOption enables parsing google trace header from metadata\n// and adds a new child span to the incoming request context.\nfunc EnableGRPCTracingServerOption(traceClient *trace.Client) grpc.ServerOption {\n    return grpc.UnaryInterceptor(serverInterceptor(traceClient))\n}\n\nfunc serverInterceptor(traceClient *trace.Client) grpc.UnaryServerInterceptor {\n    return func(ctx context.Context, req interface{}, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (resp interface{}, err error) {\n        // fetch metadata from request context\n        md, ok := metadata.FromContext(ctx)\n        if !ok {\n            md = metadata.New(nil)\n        }\n        header := strings.Join(md[\"X-Cloud-Trace-Context\"], \"\")\n\n        // create new child span from google trace header, add to\n        // current request context\n        span := traceClient.SpanFromHeader(info.FullMethod, header)\n        defer span.Finish()\n        ctx = trace.NewContext(ctx, span)\n\n        return handler(ctx, req)\n    }\n}\n</code></pre>\n\n<p>I when I run the client to initiate the trace, I get the error:</p>\n\n<pre><code>rpc error: code = 13 desc = stream terminated by RST_STREAM with error code: 1\n</code></pre>\n\n<p>I'm confused because I don't see anything else about authentication; only providing the project ID which can't be enough to initiate tracing for a specific project. What am I missing?</p>\n"}, {"tags": ["multithreading", "go", "channel"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490402895, "post_id": 43011220, "comment_id": 73112236, "body": "An unbuffered channel doesn&#39;t hold any values. How about adding the same value to a buffered channel multiple times?"}, {"owner": {"reputation": 113, "user_id": 7649953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8466e13f075d10ada940146d361dcd?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/7649953/bruce"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490403423, "post_id": 43011220, "comment_id": 73112338, "body": "That&#39;s a potential solution, but as I mentioned, I prefer not having to pump in multiple values. This is because a) I don&#39;t really know how many I will need. So I have to pump in extra; b) the data is rather large in size, don&#39;t want to duplicate as much:("}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490404496, "post_id": 43011220, "comment_id": 73112533, "body": "It sounds like you just want to use a channel as a mutex around a single value, why not then just use a mutex?"}, {"owner": {"reputation": 113, "user_id": 7649953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8466e13f075d10ada940146d361dcd?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/7649953/bruce"}, "edited": false, "score": 0, "creation_date": 1490406241, "post_id": 43011220, "comment_id": 73112842, "body": "JimB, I could use a mutex/global, but rather hard to manage because of the multiple source/target scenarios."}, {"owner": {"reputation": 113, "user_id": 7649953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8466e13f075d10ada940146d361dcd?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/7649953/bruce"}, "edited": false, "score": 0, "creation_date": 1490406310, "post_id": 43011220, "comment_id": 73112853, "body": "jfly, I checked on your link, but they all seem to deal with regular channel behaviors. Couldn&#39;t find what I&#39;m looking for here:("}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7649953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8466e13f075d10ada940146d361dcd?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/7649953/bruce"}, "edited": false, "score": 0, "creation_date": 1490406396, "post_id": 43011461, "comment_id": 73112868, "body": "I feel this is the best solution so far. A little duplication, but at least not extra duplication - I don&#39;t have to create more that what I need. Thanks!"}], "tags": [], "owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "is_accepted": true, "score": 1, "last_activity_date": 1490404482, "last_edit_date": 1495539978, "creation_date": 1490404482, "answer_id": 43011461, "question_id": 43011220, "link": "https://stackoverflow.com/questions/43011220/can-go-channel-keep-a-value-for-multiple-reads/43011461#43011461", "title": "Can go channel keep a value for multiple reads", "body": "<p>You may readd value back to the channel after reading, but then all your gouroutines will read shared value sequentially and also you'll need some synchronization primitives for last goroutine not to block.</p>\n\n<p>As far as I know the only case when you can use the single channel for broadcasting is closing it. In this case all readers will be notified.</p>\n\n<p>If you don't want to duplicate large data, maybe you'd better use some global variable. But use it carefully, because it violates golang rule: \"Don't communicate by sharing memory; share memory by communicating.\"</p>\n\n<p>Also look at this question <a href=\"https://stackoverflow.com/questions/36417199/how-to-broadcast-message-using-channel\">How to broadcast message using channel</a></p>\n"}], "owner": {"reputation": 113, "user_id": 7649953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8466e13f075d10ada940146d361dcd?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/7649953/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2774, "favorite_count": 0, "closed_date": 1490429149, "accepted_answer_id": 43011461, "answer_count": 1, "score": 0, "last_activity_date": 1490461999, "creation_date": 1490402267, "last_edit_date": 1490461999, "question_id": 43011220, "link": "https://stackoverflow.com/questions/43011220/can-go-channel-keep-a-value-for-multiple-reads", "closed_reason": "Duplicate", "title": "Can go channel keep a value for multiple reads", "body": "<p>I understand the regular behavior of a channel is that it empties after a read. Is there a way to keep an unbuffered channel value for multiple reads without the value been removed from the channel?</p>\n\n<p>For example, I have a goroutine that generates a single data for multiple down stream go routines to use. I don't want to have to create multiple channels or use a buffered channel which would require me to duplicate the source data (I don't even know how many copies I will need). Effectively, I want to be able to do something like the following:</p>\n\n<pre><code>main{\n   ch := make(ch chan dType)\n\n   ch &lt;- sourceDataGenerator()\n   for _,_ := range DynamicRange{\n      go TargetGoRoutine(ch)\n   }\n   close(ch)       // would want this to remove the value and the channel\n}\nfunc(ch chan dType) TargetGoRoutine{\n   targetCollection &lt;- ch    // want to keep the channel value after read\n}\n</code></pre>\n\n<p><strong>EDIT</strong>\nSome feel this is a duplicate question. Perhaps, but not sure. The solution here seems simple in the end as n-canter pointed out. All it needs is for every go routine to \"recycle\" the data by putting it back to the channel after use. None of the supposedly \"duplicates\" provided this solution. Here is a sample:</p>\n\n<pre><code>package main\nimport (\n  \"fmt\"\n  \"sync\"\n)\n\nfunc main() {\n c := make(chan string)\n var wg sync.WaitGroup\n    wg.Add(5)\n\n for i := 0; i &lt; 5; i++ {\n    go func(i int) {\n        wg.Done()\n        msg := &lt;-c\n        fmt.Printf(\"Data:%s, From go:%d\\n\", msg, i)\n        c &lt;-msg\n\n    }(i)\n}\n\n   c &lt;- \"Original\"\n   wg.Wait()\n   fmt.Println(&lt;-c)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/EXBbf1_icG\" rel=\"nofollow noreferrer\">https://play.golang.org/p/EXBbf1_icG</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1490400888, "post_id": 43010693, "comment_id": 73111797, "body": "Couldn&#39;t reproduce on my laptop (i5 5200u, ubuntu 16.04.2, go1.8). line 24 looks fine, unless there are some blocking operstions in jwt. It&#39;s very unlikely. Maybe you faced this problem because of scheduler. Try to reduce the number of parallel running goroutines and tune GOMAXPROCS."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "reply_to_user": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1490401064, "post_id": 43010693, "comment_id": 73111852, "body": "Once you run unit test you&#39;d notice that each log statement, the time it&#39;s take to run is increasing compared to last one. What&#39;s the behavior you&#39;re seeing?"}, {"owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1490401137, "post_id": 43010693, "comment_id": 73111870, "body": "no it doesn&#39;t, there is some deviation: from 20ms to 200ms, but looks like it has some kind of uniform distribution."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "reply_to_user": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1490401457, "post_id": 43010693, "comment_id": 73111942, "body": "In my actual project with database query, spawning 1000 http requests, each successive request increasing in time, leading to the the last one taking 19 sec to complete. If you see my code critically do you see any problem with the delegating part?"}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "reply_to_user": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1490401953, "post_id": 43010693, "comment_id": 73112058, "body": "Line 22 server.go, the function handler getting called by go runtime when a request comes in, is it a go routine itself?"}, {"owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1490402217, "post_id": 43010693, "comment_id": 73112108, "body": "I don&#39;t see any major issues with the delegation part. Are you sure that the problem is not on the side of your DB? Golang http server accepts incoming connections and spawns a new goroutine for each, as it&#39;s stated in documentation for http package."}, {"owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1490402384, "post_id": 43010693, "comment_id": 73112144, "body": "And I still suggest you to limit a number of parallel running goroutines. You may process less request in parallel. But you can spend less time on processing all the requests."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "reply_to_user": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1490402726, "post_id": 43010693, "comment_id": 73112200, "body": "It&#39;s quite possible that database is the bottleneck, your code review gave confidence though. I&#39;m going to create another test without using apparatus to see if database is the culprit."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "reply_to_user": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1490402874, "post_id": 43010693, "comment_id": 73112233, "body": "When you say limit number of parallel go routines, I didn&#39;t get that. My apparatus has no go routines and is completely synchronous, there&#39;s no need actually. My objective was to simulate how system behaves if 1000 users are making requests to the services. Is this methodology right or should I&#39;ve done in a different way?"}, {"owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1490403321, "post_id": 43010693, "comment_id": 73112313, "body": "Your apparatus uses goroutines implicitly when it handles http requests. When I suggested you to limit the number of parallel running goroutines, I was talking about token_test.go. I believe there is nothing wrong with your methodology."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "reply_to_user": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1490404930, "post_id": 43010693, "comment_id": 73112608, "body": "I ran a unit test directly on the database query function calling 1000 times, it&#39;s a remote database. 1st call took 600 ms and it increased gradually to 3.5 sec"}], "owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490397792, "creation_date": 1490397792, "question_id": 43010693, "link": "https://stackoverflow.com/questions/43010693/forwarding-incoming-http-requests-are-getting-queued-up", "title": "Forwarding incoming http requests are getting queued up", "body": "<p>Appreciate a response from a senior level architect who has a deep understanding of concurrency and experience in go language</p>\n\n<p>I've a custom apparatus to handle, process and respond to incoming client requests and server is simply wrapping all the incoming requests, the <code>request</code> and <code>responseWriter</code> in an object and delegating to the apparatus.</p>\n\n<p>The problem I'm observing based on my unit tests (spawning 1000 http request to localhost) is that all the requests are processed in sequence instead concurrently, it's like they are in </p>\n\n<p>Each request is taking more time than the previous one simply telling me it's a queue. If for example a database based request takes <code>200 ms</code>.</p>\n\n<pre><code>Request 1 -&gt; taking 200 ms\nRequest 2 -&gt; taking 400 ms\nRequest 3 -&gt; taking 600 ms\n</code></pre>\n\n<p>Each request is waiting for the previous request to finish, I'm not doing something right when it comes to delegating incoming requests to the apparatus so I've prepared a trimmed down version that simply decodes the JWT token and responds to the client, please run test/token_test.go. <a href=\"https://www.dropbox.com/s/merneoewwfzjrtx/apparatus.zip?dl=0\" rel=\"nofollow noreferrer\">Download Project</a></p>\n\n<p><strong>application.go</strong></p>\n\n<pre><code>func main() {\n        a := delegate.Apparatus{}\n        a.Run()\n}\n</code></pre>\n\n<p><strong>apparatus.go</strong></p>\n\n<pre><code>type Apparatus struct {}\n\nfunc (a *Apparatus) Run() { // initialize the server\n        server := Server{}\n        server.SetDelegate(a) // tell server to forward requests to itself\n        server.StartServer() // start the server\n}\n\nfunc (a *Apparatus) Handle(request *Request) { // interface impl\n        a.RenewToken(request) // delegate request to a time consuming func\n}\n</code></pre>\n\n<p><strong>server.go</strong></p>\n\n<pre><code>type Server struct {}\n\nfunc (s *Server) StartServer() {\n        http.HandleFunc(\"/\", handler)\n        fmt.Println(\"Server Listening at 8080\")\n        err := http.ListenAndServe(\":8080\", nil)\n        if err != nil {\n                    log.Fatal(err)\n        }\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) { // delegate to apparatus\n        delegate.Handle(&amp;Request{ResponseWriter: w, Request: r})\n}\n\nfunc (s *Server) SetDelegate(d IHandler) {\n        delegate = d\n}\n</code></pre>\n\n<p><strong>request.go</strong> wrapper for the <code>request</code> and <code>responseWriter</code></p>\n\n<pre><code>type Request struct {\n        ResponseWriter http.ResponseWriter\n        Request        *http.Request\n}\n</code></pre>\n\n<p><strong>ihandler.go</strong> interface for the apparatus</p>\n\n<pre><code>type IHandler interface {\n        Handle(request *Request)\n}\n</code></pre>\n\n<p><strong>test/token_test.go</strong> this will show each successive request is taking more and more time than the previous one</p>\n\n<pre><code>func MakeRequest(ch chan&lt;-int, index int) {\n        t0 := time.Now()\n        response, _ := http.Get(\"http://localhost:8080?authToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6Mjg4LCJuYmYiOjE0NDQ0Nzg0MDAsInJhbmQiOjAuOTI2OTg2ODAzNTc0NDE0Mn0.3HC8lEDGlui_sOtkeMn52Wnt9HUuH4lFbk7ubdUK_Z4&amp;index=\" + strconv.Itoa(index))\n        t1 := time.Now()\n        ch &lt;- response.StatusCode\n        fmt.Printf(\"The call took %v to run.\\n\", t1.Sub(t0))\n}\n\nfunc TestConcurrent(t *testing.T) {\n        start := time.Now()\n        ch := make(chan int)\n        max := 1000\n\n        for i:=0; i&lt;max; i++ {\n                    go MakeRequest(ch, i)\n        }\n\n        for i:=0; i&lt;max; i++ {\n                    if &lt;-ch != 200 {t.Error(\"Expecting status code 200\")}\n        }\n        fmt.Printf(\"%.2fs elapsed\", time.Since(start).Seconds())\n}\n</code></pre>\n\n<p>It's best to <a href=\"https://www.dropbox.com/s/merneoewwfzjrtx/apparatus.zip?dl=0\" rel=\"nofollow noreferrer\">download the project</a> and test. I suspect the problem is in the server.go (line 24). I'm not delegating the request in a right way and they are simply queuing up.</p>\n\n<p>Solution I'm looking for is how can I delegate/forward the incoming requests concurrently.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 2, "creation_date": 1490385727, "post_id": 43007957, "comment_id": 73105947, "body": "Follow the Go docs, not the Python docs...  <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/entities\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/standard/go/datastore/entiti&zwnj;&#8203;es</a>"}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1490388515, "post_id": 43007957, "comment_id": 73107300, "body": "I did not notice I had been redirected. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 1, "last_activity_date": 1490386008, "creation_date": 1490386008, "answer_id": 43008259, "question_id": 43007957, "link": "https://stackoverflow.com/questions/43007957/how-do-i-create-a-child-entity-in-golang-appengine/43008259#43008259", "title": "How do I create a child entity in Golang AppEngine?", "body": "<p>When using the App Engine docs and writing in Go, you constantly get redirected to the Python docs. It is the most annoying thing on the planet. Always check the URL you are at after navigation and clicking links. If you are in the right place, you should find \"go\" in the URL somewhere. If it shows python or java, replace it with go in the URL and hope it exists.</p>\n\n<p>So the page you really want is this: <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/entities\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/standard/go/datastore/entities</a></p>\n"}], "owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 43008259, "answer_count": 1, "score": 1, "last_activity_date": 1490386008, "creation_date": 1490384830, "question_id": 43007957, "link": "https://stackoverflow.com/questions/43007957/how-do-i-create-a-child-entity-in-golang-appengine", "title": "How do I create a child entity in Golang AppEngine?", "body": "<p>I'm attempting to create a Child entity based on the docs here: <a href=\"https://cloud.google.com/appengine/docs/standard/python/datastore/entities\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/standard/python/datastore/entities</a></p>\n\n<p>When I intiate the user instance, I'm getting an error \"issing ',' in argument list\" even though there is only one agument.</p>\n\n<p>When I attempt to assign the parent value to Prospect on initiation, I get this error:<br>\n    expected '==', found '='</p>\n\n<pre><code>func sign(w http.ResponseWriter, r *http.Request) {  \n    c := appengine.NewContext(r)  \n    zip, err := strconv.Atoi(r.FormValue(\"zip\"))  \n\n    //user := user.Current(c)  \n    user = Client(name: \"Bryan\")   \n    // error thrown \"missing ',' in argument list\"\n\n    p = Prospect(parent=user )\n    // error thrown: expected '==', found '='  \n    p := Prospect{  \n        Name:  r.FormValue(\"name\"),  \n        Zip:  zip,  \n        Date:  time.Now(),  \n    }  \n</code></pre>\n\n<p>It looks just like the examples in the documentation, what am I doing wrong?</p>\n"}, {"tags": ["email", "go", "mailjet"], "answers": [{"comments": [{"owner": {"reputation": 7639, "user_id": 3783693, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ySfy8.png?s=128&g=1", "display_name": "WebWanderer", "link": "https://stackoverflow.com/users/3783693/webwanderer"}, "edited": false, "score": 1, "creation_date": 1490632236, "post_id": 43008594, "comment_id": 73187744, "body": "Thank you! This worked perfectly! After analyzing my code, it appears that my message was missing a &quot;From: .&quot;"}, {"owner": {"reputation": 1894, "user_id": 1506051, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Tf7yR.jpg?s=128&g=1", "display_name": "arnaud.breton", "link": "https://stackoverflow.com/users/1506051/arnaud-breton"}, "reply_to_user": {"reputation": 7639, "user_id": 3783693, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ySfy8.png?s=128&g=1", "display_name": "WebWanderer", "link": "https://stackoverflow.com/users/3783693/webwanderer"}, "edited": false, "score": 0, "creation_date": 1490695803, "post_id": 43008594, "comment_id": 73216833, "body": "Glad to hear, happy it helped!"}, {"owner": {"reputation": 1387, "user_id": 712700, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ca81729295c14227d40dfb889dc8bc06?s=128&d=identicon&r=PG", "display_name": "goamn", "link": "https://stackoverflow.com/users/712700/goamn"}, "edited": false, "score": 0, "creation_date": 1534728058, "post_id": 43008594, "comment_id": 90795764, "body": "@arnaud.breton Can you please improve the Mailjet API, it should show some error or something when trying to set a &quot;From&quot; address that is not registered in the Sender&#39;s list on the Mailjet account. Otherwise the successful 200 will waste a lot of time (as it did with me) because it&#39;s not clear."}, {"owner": {"reputation": 1894, "user_id": 1506051, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Tf7yR.jpg?s=128&g=1", "display_name": "arnaud.breton", "link": "https://stackoverflow.com/users/1506051/arnaud-breton"}, "reply_to_user": {"reputation": 1387, "user_id": 712700, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ca81729295c14227d40dfb889dc8bc06?s=128&d=identicon&r=PG", "display_name": "goamn", "link": "https://stackoverflow.com/users/712700/goamn"}, "edited": false, "score": 1, "creation_date": 1534753537, "post_id": 43008594, "comment_id": 90802974, "body": "@goamn I left Mailjet a year ago. I would suggest you to reach out to Mailjet support directly moving forward. Sorry I can&#39;t help further."}], "tags": [], "owner": {"reputation": 1894, "user_id": 1506051, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Tf7yR.jpg?s=128&g=1", "display_name": "arnaud.breton", "link": "https://stackoverflow.com/users/1506051/arnaud-breton"}, "is_accepted": true, "score": 6, "last_activity_date": 1490387347, "creation_date": 1490387347, "answer_id": 43008594, "question_id": 43007840, "link": "https://stackoverflow.com/questions/43007840/golang-send-mailjet-email-without-mailjet-library/43008594#43008594", "title": "GoLang: Send Mailjet email without Mailjet library", "body": "<p>First of all, thanks for choosing Mailjet as your email service provider! I'm leading the API Product and Developers Relations at Mailjet.</p>\n\n<p>When it comes to send, you're right with SMTP. It's standard, widely supported and easy to switch (even if I don't hope we'll get there!). Our <a href=\"https://github.com/mailjet/mailjet-apiv3-go\" rel=\"noreferrer\">Go library</a> will become handy when it comes to deal with our API to manage business processes.</p>\n\n<p>I have several questions / feedback looking at your code:</p>\n\n<ul>\n<li>I guess the \"sender@example.com\" from address used is not the one you use in your real code? Anyway, this email must have been validated on Mailjet side beforehands. See our <a href=\"https://app.mailjet.com/support/am-i-limited-to-one-email-sending-address,96.htm\" rel=\"noreferrer\">dedicated guide</a></li>\n<li>Seems you try to set some SMTP headers like Subject within the message, when it should be handled separately </li>\n</ul>\n\n<p>Here's a working code I'm using to work with SMTP:</p>\n\n<pre><code>package main\n\nimport (\n  \"log\"\n  \"net/smtp\"\n  \"fmt\"\n)\n\nfunc main() {\n    auth := smtp.PlainAuth(\n        \"\",\n        \"MAILJET_API_KEY\",\n        \"MAILJET_API_SECRET\",\n        \"in-v3.mailjet.com\",\n    )\n\n    email := \"foobar@test.com\"\n\n    header := make(map[string]string)\n    header[\"From\"] = email\n    header[\"To\"] = email\n    header[\"Subject\"] = \"Hello Mailjet World!\"\n    header[\"X-Mailjet-Campaign\"] = \"test\"\n\n    message := \"\"\n    for k, v := range header {\n        message += fmt.Sprintf(\"%s: %s\\r\\n\", k, v)\n    }\n    message += \"\\r\\nHi! Thanks for using Mailjet.\"\n\n    err := smtp.SendMail(\n        \"in-v3.mailjet.com:587\",\n        auth,\n        email,\n        []string{email},\n        []byte(message),\n    )\n    if err != nil {\n      log.Printf(\"Error: %s\", err)\n    } else {\n      log.Printf(\"Mail sent!\")\n    }\n}\n</code></pre>\n\n<p>Hope it helps! hAPI sending with Mailjet</p>\n"}], "owner": {"reputation": 7639, "user_id": 3783693, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ySfy8.png?s=128&g=1", "display_name": "WebWanderer", "link": "https://stackoverflow.com/users/3783693/webwanderer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 43008594, "answer_count": 1, "score": 2, "last_activity_date": 1490387347, "creation_date": 1490384337, "question_id": 43007840, "link": "https://stackoverflow.com/questions/43007840/golang-send-mailjet-email-without-mailjet-library", "title": "GoLang: Send Mailjet email without Mailjet library", "body": "<p>I am trying to send emails from my golang application using my Mailjet credentials, but I am trying to do it the normal golang way (yes, I know that their library is highly encouraged).</p>\n\n<p>I have the emails working fine using the Mailjet library, but <strong>my boss made a really good point</strong> that we might not stay with Mailjet forever. If we switch to a different email solution, we don't want to have to rewrite all of our email code, we just want to change our hostname and credentials.</p>\n\n<p>My printer sends emails just find through Mailjet using the same hostname and credentials, but for some reason my golang app won't!</p>\n\n<p>My code was adopted from the <a href=\"https://golang.org/pkg/net/smtp/#SendMail\" rel=\"nofollow noreferrer\">golang smtp library SendEmail example</a>.</p>\n\n<p>Here it is (without my credentials, of course):</p>\n\n<pre><code>import (\n    \"bytes\"\n    \"fmt\"\n    \"net/smtp\"\n)\nfunc SendTestEmail() (bool, error) {\n    fmt.Println(\"Send Test Email: Enter\")\n    success := false\n    hostname := \"in-v3.mailjet.com\"\n    auth := smtp.PlainAuth(\"\", username, password, hostname)\n    to := []string{\"me@example.com\"}\n    msg := []byte(\"To: me@example.com\\r\\n\" +\n        \"Subject: discount Gophers!\\r\\n\" +\n        \"\\r\\n\" +\n        \"This is the email body.\\r\\n\")\n    fmt.Println(\"Send Test Email: Sending Email\")\n    err := smtp.SendMail(hostname+\":587\", auth, \"sender@example.com\", to, msg)\n    if err == nil {\n        fmt.Println(\"Send Test Email: Email successfully sent!\")\n        success = true\n    } else {\n        fmt.Println(\"Send Test Email: Email failed to send\", err)\n    }\n    fmt.Println(\"Send Test Email: Exit\")\n    return success, err\n}\n</code></pre>\n\n<p><em>Note that I am using port 587. I do not know if my printer is using 587 or 25, but it's working. I don't work when using port 25 either.</em></p>\n\n<p>What is really weird is that <code>smtp.SendEmail</code> isn't returning any errors, but I still do not get any emails (yes, I am checking my junk folder)!</p>\n\n<p>Also, when I log into Mailjet, I don't see that any emails were sent. I do see that an email was sent when I send something from the printer.</p>\n\n<p>So, where is my email?!</p>\n\n<p>Any help is greatly appreciated. Thanks!</p>\n"}]