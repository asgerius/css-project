[{"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 5778, "user_id": 5921693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104a78260ca097069cf8f8179e41acdd?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/5921693/nick"}, "edited": false, "score": 2, "creation_date": 1470257353, "post_id": 38753238, "comment_id": 64880576, "body": "Your <code>layout</code> and your <code>value</code> do not match AND you are not passing <code>layout</code> as a parameter: <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\">golang.org/pkg/time/#Parse</a>"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 5778, "user_id": 5921693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104a78260ca097069cf8f8179e41acdd?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/5921693/nick"}, "edited": false, "score": 0, "creation_date": 1470257533, "post_id": 38753238, "comment_id": 64880675, "body": "Do you happen to know which layout works for UTC? And how to then use the output to insert into Postgres? I&#39;ve tried a few and none work."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470257860, "post_id": 38753238, "comment_id": 64880816, "body": "<a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\"><code>time.Parse</code></a> takes 2 arguments, you&#39;re not passing in the layout. And like Nicarus said, you&#39;re layout doesn&#39;t match, you only need <code>2006-01-02</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470257959, "post_id": 38753238, "comment_id": 64880864, "body": "All layouts work for UTC. If you need to use another location, use ParseInLocation."}], "answers": [{"tags": [], "owner": {"reputation": 348, "user_id": 6634768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2WCdT.png?s=128&g=1", "display_name": "Pavel Kazhevets", "link": "https://stackoverflow.com/users/6634768/pavel-kazhevets"}, "is_accepted": true, "score": 4, "last_activity_date": 1470272315, "creation_date": 1470272315, "answer_id": 38755914, "question_id": 38753238, "link": "https://stackoverflow.com/questions/38753238/how-to-parse-date-from-string-in-golang-to-insert-into-postgres/38755914#38755914", "title": "How to parse date from string in Golang to insert into Postgres?", "body": "<p>To parse time in your example you'll need correct layout passed to <code>time.Parse</code>:</p>\n\n<pre><code>layout := \"2006-01-02\"\nupdatedAt, _ := time.Parse(layout, \"2016-06-10\")\nfmt.Println(updatedAt)\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>$ go run time.go\n2016-06-10 00:00:00 +0000 UTC\n</code></pre>\n\n<p>To insert time you have after parsing it you'll just need to pass <code>time.Time</code> object to <code>db.Exec</code>. For example:</p>\n\n<p><code>db.Exec(\"INSERT INTO tablename VALUES (time_column) (($1));\", time.Now())</code></p>\n"}, {"tags": [], "owner": {"reputation": 500, "user_id": 7101880, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209175470396691/picture?type=large", "display_name": "Adrien Parrochia", "link": "https://stackoverflow.com/users/7101880/adrien-parrochia"}, "is_accepted": false, "score": 0, "last_activity_date": 1605525996, "creation_date": 1605525996, "answer_id": 64857134, "question_id": 38753238, "link": "https://stackoverflow.com/questions/38753238/how-to-parse-date-from-string-in-golang-to-insert-into-postgres/64857134#64857134", "title": "How to parse date from string in Golang to insert into Postgres?", "body": "<p>If you want to insert a specific date and not time.Now() you can use date.Format(&quot;2006-01-02&quot;)</p>\n<pre><code>layout := &quot;2016-02-02T15:04:05.000Z&quot;\nupdatedAt, _ := time.Parse(time.RFC3339, layout)\n\nfmt.Println(updatedAt)\nfmt.Println(updatedAt.Format(&quot;2006-01-02&quot;))\nfmt.Println(updatedAt.Format(time.RFC3339))\n</code></pre>\n<p>return :</p>\n<pre><code>2016-02-02 15:04:05 +0000 UTC \n2016-02-02 \n2016-02-02T15:04:05Z\n</code></pre>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4991, "favorite_count": 0, "accepted_answer_id": 38755914, "answer_count": 2, "score": 2, "last_activity_date": 1605525996, "creation_date": 1470256906, "last_edit_date": 1470257305, "question_id": 38753238, "link": "https://stackoverflow.com/questions/38753238/how-to-parse-date-from-string-in-golang-to-insert-into-postgres", "title": "How to parse date from string in Golang to insert into Postgres?", "body": "<p>So I'm trying to parse a time from a string and then insert that time into Postgres. </p>\n\n<p>I have this so far-</p>\n\n<pre><code>layout := \"2006-01-02T15:04:05.000Z\"\nupdatedAt, _ := time.Parse(\"2016-06-10\")\nfmt.Println(updatedAt)\n</code></pre>\n\n<p>but this outputs</p>\n\n<p><code>0001-01-01 00:00:00 +0000 UTC</code>.</p>\n\n<p>I'm also not sure how to then use this to query in postgres (what format should the time have)?</p>\n"}, {"tags": ["go", "int", "int64"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "edited": false, "score": 0, "creation_date": 1470247044, "post_id": 38750602, "comment_id": 64875005, "body": "@pward, it&#39;s the same thing, but if you always convert to the larger type you don&#39;t have to worry about truncation."}, {"owner": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "edited": false, "score": 0, "creation_date": 1470247531, "post_id": 38750602, "comment_id": 64875238, "body": "thanks, I think I need to read up a bit on numeric types and possibly adjust my code if necessary. I think because Go&#39;s predeclared numeric types are a bit different from JavaScript&#39;s, I need to get used to programming in this style."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "edited": false, "score": 0, "creation_date": 1470248370, "post_id": 38750602, "comment_id": 64875689, "body": "@pward: Javascript uses <a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format\" rel=\"nofollow noreferrer\">double precision IEEE-754 floating point format</a> for all numbers. In go you have <code>float64</code> for that."}, {"owner": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "edited": false, "score": 0, "creation_date": 1470249339, "post_id": 38750602, "comment_id": 64876246, "body": "I am referring mainly to JavaScript&#39;s integer type, as that is the topic of my post."}, {"owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "reply_to_user": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "edited": false, "score": 2, "creation_date": 1470253093, "post_id": 38750602, "comment_id": 64878435, "body": "@pward There is no integer type in JavaScript. There&#39;s only one numeric data type, named Number, which is a double-precision floating point number, not an integer."}, {"owner": {"reputation": 122, "user_id": 4241670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/329e413106cac2bb6d6a281b40f8b8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Corbin", "link": "https://stackoverflow.com/users/4241670/corbin"}, "reply_to_user": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "edited": false, "score": 0, "creation_date": 1470263560, "post_id": 38750602, "comment_id": 64883182, "body": "@pward here&#39;s a starting point for number types in go that might help <a href=\"https://golang.org/ref/spec#Numeric_types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Numeric_types</a>"}, {"owner": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "edited": false, "score": 7, "creation_date": 1470335292, "post_id": 38750602, "comment_id": 64921105, "body": "It&#39;s important to note that, though this answer is checked, it does not technically solve the problem posed by the question, which is how to convert int64 to int."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "edited": false, "score": 0, "creation_date": 1470335674, "post_id": 38750602, "comment_id": 64921315, "body": "@pward, sure it does, you use a conversion exactly like it&#39;s shown in the answer. I&#39;ll make it more explicit if you want."}, {"owner": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "edited": false, "score": 1, "creation_date": 1470338326, "post_id": 38750602, "comment_id": 64922789, "body": "@JimB I am not saying what you put doesn&#39;t work and isn&#39;t easy to understand. I am saying it does the conversion backwards from how I wish to do it in my question. You&#39;re answer manipulates that desire by assuming I care about truncation."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "edited": false, "score": 1, "creation_date": 1470340543, "post_id": 38750602, "comment_id": 64924068, "body": "@pward: It also shows you <i>why</i> you should care about truncation with an example. You should understand how the integer types work,  just like you should know why in javascript <code>0.1 * 0.2 == 0.020000000000000004</code>. You have an <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">X Y problem</a> here -- what you want is for the code to work, but the solution you&#39;re asking for is the incorrect solution."}, {"owner": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "edited": false, "score": 2, "creation_date": 1470523767, "post_id": 38750602, "comment_id": 64986966, "body": "@JimB Hmm, that is an interesting theory about X Y Problems. In my opinion, I think it would be more reasonable to simply reply to a question like mine with &quot;You cannot do that,&quot; or, &quot;That problem is unsolvable&quot;, because at least that reply leaves the integrity of the question intact. I say your solution doesn&#39;t answer my problem because it assumes my desired answer is a proper effect, e.g. <i>&quot;what you want is for the code to work&quot;</i>. I do appreciate you pointing me in a better direction though!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 51, "last_activity_date": 1470340617, "last_edit_date": 1470340617, "creation_date": 1470246952, "answer_id": 38750602, "question_id": 38750545, "link": "https://stackoverflow.com/questions/38750545/how-to-convert-an-int64-to-int-in-go/38750602#38750602", "title": "How to convert an int64 to int in Go?", "body": "<p>You convert them with a type <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">\"conversion\"</a></p>\n\n<pre><code>var a int\nvar b int64\nint64(a) &lt; b\n</code></pre>\n\n<p>When comparing values, you always want to convert the smaller type to the larger. Converting the other way will possibly truncate the value:</p>\n\n<pre><code>var x int32 = 0\nvar y int64 = math.MaxInt32 + 1 // y == 2147483648\nif x &lt; int32(y) {\n// this evaluates to false, because int32(y) is -2147483648\n</code></pre>\n\n<p>Or in your case to convert the <code>maxInt</code> <code>int64</code> value to an <code>int</code>, you could use</p>\n\n<pre><code>for a := 2; a &lt; int(maxInt); a++ {\n</code></pre>\n\n<p>which would fail to execute correctly if <code>maxInt</code> overflows the max value of the <code>int</code> type on your system. </p>\n"}], "owner": {"reputation": 829, "user_id": 5853279, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb52cf1bbfd8c91d1df94ebb05e798c6?s=128&d=identicon&r=PG&f=1", "display_name": "pward", "link": "https://stackoverflow.com/users/5853279/pward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61796, "favorite_count": 4, "accepted_answer_id": 38750602, "answer_count": 1, "score": 30, "last_activity_date": 1470340617, "creation_date": 1470246759, "question_id": 38750545, "link": "https://stackoverflow.com/questions/38750545/how-to-convert-an-int64-to-int-in-go", "title": "How to convert an int64 to int in Go?", "body": "<p>In Go, what is the best strategy for converting <code>int64</code> to <code>int</code>? I am having difficulty comparing the two</p>\n\n<pre><code>package main \n\nimport (\n    \"math\"\n    \"strings\"\n    \"strconv\"\n)\n\ntype largestPrimeFactor struct {\n    N      int\n    Result int\n}\n\nfunc main() {\n    base := largestPrimeFactor{N:13195}\n    max := math.Sqrt(float64(base.N))\n\n    maxStr := strconv.FormatFloat(max, 'E', 'G', 64)\n    maxShift := strings.Split(maxStr, \".\")[0]\n    maxInt, err := strconv.ParseInt(maxShift, 10, 64)\n\n    if (err != nil) {\n        panic(err)\n    }\n</code></pre>\n\n<p>on this next line</p>\n\n<pre><code>    for a := 2; a &lt; maxInt; a++ {\n        if isPrime(a) {\n            if base.N % a == 0 {\n                base.Result = a\n            }\n        }\n    }\n\n    println(base)\n}\n\nfunc isPrime(n int) bool {\n    flag := false\n\n    max := math.Sqrt(float64(n))\n\n    maxStr := strconv.FormatFloat(max, 'E', 'G', 64)\n    maxShift := strings.Split(maxStr, \".\")[0]\n    maxInt, err := strconv.ParseInt(maxShift, 10, 64)\n\n    if (err != nil) {\n        panic(err)\n    }\n\n    for a := 2; a &lt; maxInt; a++ {\n        if (n % a == 0) {\n            flag := true\n        }\n    }\n    return flag\n}\n</code></pre>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470246458, "post_id": 38750390, "comment_id": 64874687, "body": "If there is no crossover between implementations, why not make them separate interfaces, like <code>TimeDistance</code>, <code>LocationDistance</code>?"}, {"owner": {"reputation": 278, "user_id": 3882761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de53bc6a417356dca44b12d601d0db28?s=128&d=identicon&r=PG&f=1", "display_name": "SAyotte", "link": "https://stackoverflow.com/users/3882761/sayotte"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470251801, "post_id": 38750390, "comment_id": 64877639, "body": "This is a contrived task given to me for learning. The requirement is that another part of the code accept any abstract &quot;coordinate&quot; type thing. Looking at how we&#39;re going to use it, the implementations will overlap on this Distance() method."}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1470253447, "post_id": 38750390, "comment_id": 64878638, "body": "I think you want  Distance(other Distancer) int not that this helps the original question"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1470253915, "post_id": 38750390, "comment_id": 64878852, "body": "I would say that&#39;s the incorrect interface definition if it doesn&#39;t apply to the correct set of types, and narrowing the scope of the interface is the only way to avoid type checking at runtime."}, {"owner": {"reputation": 278, "user_id": 3882761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de53bc6a417356dca44b12d601d0db28?s=128&d=identicon&r=PG&f=1", "display_name": "SAyotte", "link": "https://stackoverflow.com/users/3882761/sayotte"}, "edited": false, "score": 0, "creation_date": 1470254792, "post_id": 38750390, "comment_id": 64879297, "body": "Can you suggest a better definition?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1470258008, "post_id": 38750390, "comment_id": 64880883, "body": "If your method is required to accept an <code>interface{}</code> as it&#39;s argument the best you can do is a type assertion at the top of all the <code>Distancer</code> implementations. One thing you could do for compile time safety would be to create a couple more strict interfaces and then add checks like whats described here <a href=\"https://splice.com/blog/golang-verify-type-implements-interface-compile-time/\" rel=\"nofollow noreferrer\">splice.com/blog/&hellip;</a> to verify the type implements the more strict interface. If I have a more strict interface <code>DistancerA</code> and some type call it <code>TheDistancer</code> I could ensure that <code>TheDistancer</code> implements <code>DistancterA</code> at compile time"}], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 3, "last_activity_date": 1470298288, "last_edit_date": 1470298288, "creation_date": 1470259803, "answer_id": 38753965, "question_id": 38750390, "link": "https://stackoverflow.com/questions/38750390/refer-to-implementation-type-in-golang-interface-method/38753965#38753965", "title": "Refer to implementation-type in Golang interface method", "body": "<p>This is an homomorphism of the <a href=\"https://en.wikipedia.org/wiki/Expression_problem\" rel=\"nofollow\">expression problem</a>. Also relatively easy to generalize, if we assume <em>distance</em> to mean <a href=\"https://en.wikipedia.org/wiki/Euclidean_distance\" rel=\"nofollow\">euclidean distance</a>, which is a reasonable assumption for a broad range of applications. As Go does not support <a href=\"https://en.wikipedia.org/wiki/Dependent_type\" rel=\"nofollow\">dependent types</a> or anything that fancy, though, we will have to make a reasonable compromise in the amount of dimensions that we want to support, in favor of type-safety.</p>\n\n<p>Let's implement this for the first 3 dimensions.</p>\n\n<pre><code>type OneVectorer interface {\n    Vector() [1]float64\n}\n\ntype TwoVectorer interface {\n    Vector() [2]float64\n}\n\ntype ThreeVectorer interface {\n    Vector() [3]float64\n}\n</code></pre>\n\n<p>Then three type-safe methods:</p>\n\n<pre><code>func OneDimensionalDistance(a OneVectorer, b OneVectorer) float64 {\n    return euclideanDistance(a.Vector()[:], b.Vector()[:])\n}\n\nfunc TwoDimensionalDistance(a TwoVectorer, b TwoVectorer) float64 {\n    return euclideanDistance(a.Vector()[:], b.Vector()[:])\n}\n\nfunc ThreeDimensionalDistance(a ThreeVectorer, b ThreeVectorer) float64 {\n    return euclideanDistance(a.Vector()[:], b.Vector()[:])\n}\n\nfunc euclideanDistance(a, b []float64) float64 {\n    // invariant: a and b have same length\n    c := 0.0\n    for i, _ := range a {\n        c += math.Pow(b[i]-a[i], 2)\n    }\n    return math.Sqrt(c)\n}\n</code></pre>\n\n<p>So, a point in time can be a OneVectorer, a cartesian point a TwoVectorer, and so on...</p>\n\n<p>You can define further types to your convenience in order to make the program more expressive and in their methods map down to this vector arithmetic.</p>\n"}], "owner": {"reputation": 278, "user_id": 3882761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de53bc6a417356dca44b12d601d0db28?s=128&d=identicon&r=PG&f=1", "display_name": "SAyotte", "link": "https://stackoverflow.com/users/3882761/sayotte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470298288, "creation_date": 1470246190, "question_id": 38750390, "link": "https://stackoverflow.com/questions/38750390/refer-to-implementation-type-in-golang-interface-method", "title": "Refer to implementation-type in Golang interface method", "body": "<p>I want to define an interface for any coordinate-type-thing which implements a Distance() method that can be used to calculate distance (maybe cartesian, maybe chronological, whatever) from another coordinate-type-thing of the same type.</p>\n\n<p>This is the general idea:</p>\n\n<pre><code>    type Distancer interface {\n        Distance(other interface{}) int\n    }\n</code></pre>\n\n<p>This doesn't provide type-safety for the argument to Distance(), though, which must be of the same type. For example, I might have a ParticularTime struct that implements Distance(); passing another ParticularTime object as the argument makes sense, but passing a ParticularLocation doesn't make sense at all.</p>\n\n<p>I suspect this could be caught at compile-time at least in some cases, e.g. this is obviously wrong:</p>\n\n<pre><code>    x := ParticularLocation{}\n    y := ParticularTime{}\n    distance := x.Distance(y)\n</code></pre>\n\n<p>Is there any way to express this restriction? Or do I have to do runtime type-checking inside every implementation of Distance() ?</p>\n\n<p>Am I thinking about this problem the wrong way?</p>\n"}, {"tags": ["json", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 930, "user_id": 4328963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/505Lz.png?s=128&g=1", "display_name": "huygn", "link": "https://stackoverflow.com/users/4328963/huygn"}, "edited": false, "score": 0, "creation_date": 1470274587, "post_id": 38750027, "comment_id": 64886888, "body": "Can you provide examples of both json string?"}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1470282672, "post_id": 38750027, "comment_id": 64888764, "body": "By the way all of those json tags are unnecessary because they match the field names exactly. If there are no json tags on the type the field names will be used instead"}, {"owner": {"reputation": 579, "user_id": 6145303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cf09dbd6a1479eac38241085a0e64de?s=128&d=identicon&r=PG&f=1", "display_name": "arewm", "link": "https://stackoverflow.com/users/6145303/arewm"}, "edited": false, "score": 0, "creation_date": 1470317391, "post_id": 38750027, "comment_id": 64908560, "body": "I did not know if the json tags were required, but I guess they are only required if you want to name the fields differently in implementation."}], "answers": [{"tags": [], "owner": {"reputation": 930, "user_id": 4328963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/505Lz.png?s=128&g=1", "display_name": "huygn", "link": "https://stackoverflow.com/users/4328963/huygn"}, "is_accepted": false, "score": 1, "last_activity_date": 1470277427, "last_edit_date": 1470277427, "creation_date": 1470274220, "answer_id": 38757107, "question_id": 38750027, "link": "https://stackoverflow.com/questions/38750027/golang-structure-for-json-to-allow-a-value-to-optionally-be-an-array/38757107#38757107", "title": "Golang structure for json to allow a value to optionally be an array", "body": "<p>Use <code>interface{}</code> if the field's type you're going to parse is not guaranteed:</p>\n\n<pre><code>type Statement struct {\n    Sid       string    `json:\"Sid\"`\n    Effect    string    `json:\"Effect\"`\n    Principal Principal `json:\"Principal\"`\n\n    Action   interface{} `json:\"Action\"`\n    Resource interface{} `json:\"Resource\"`\n}\n</code></pre>\n\n<p>And access the underlying original datatype using a type switch:</p>\n\n<pre><code>//Example: Trying to access Action member of a statement myStatement.\nswitch a := myStatement.Action.(type) {\n    case []string:\n        //Action is a slice. Handle it accordingly.\n    case string:\n        //Action is a string. Handle it accordingly.\n    default:\n        //Some other datatype that can be returned by aws?\n}\n</code></pre>\n\n<hr>\n\n<p>Or you can have separate structs for both cases, if Unmarshaling one failed, Unmarshal it into the other struct, something like this:</p>\n\n<pre><code>err := json.Unmarshal(jsonStr, &amp;struct1)\nif err != nil {\n    fmt.Println(err)\n    err = json.Unmarshal(jsonStr, &amp;struct2)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 579, "user_id": 6145303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cf09dbd6a1479eac38241085a0e64de?s=128&d=identicon&r=PG&f=1", "display_name": "arewm", "link": "https://stackoverflow.com/users/6145303/arewm"}, "edited": false, "score": 0, "creation_date": 1470317331, "post_id": 38757780, "comment_id": 64908515, "body": "Worked just like I wanted, thanks! I started to get here on my own, but it would have taken me a little longer. :)"}], "tags": [], "owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "is_accepted": true, "score": 2, "last_activity_date": 1470281194, "last_edit_date": 1470281194, "creation_date": 1470279360, "answer_id": 38757780, "question_id": 38750027, "link": "https://stackoverflow.com/questions/38750027/golang-structure-for-json-to-allow-a-value-to-optionally-be-an-array/38757780#38757780", "title": "Golang structure for json to allow a value to optionally be an array", "body": "<p>As an alternative to <code>interface{}</code>, you can create a type called MaybeSlice and implement custom MarshalJSON and UnmarshalJSON methods on it. </p>\n\n<pre><code>type MaybeSlice []string\n\nfunc (ms *MaybeSlice) MarshalJSON() ([]byte, error) {\n    // Use normal json.Marshal for subtypes\n    if len(*ms) == 1 {\n        return json.Marshal(([]string)(*ms)[0])\n    }\n    return json.Marshal(*ms)\n}\n\nfunc (ms *MaybeSlice) UnmarshalJSON(data []byte) error {\n    // Use normal json.Unmarshal for subtypes\n    var s string\n    if err := json.Unmarshal(data, &amp;s); err != nil {\n        var v []string\n        if err := json.Unmarshal(data, &amp;v); err != nil {\n             return err\n        }\n        *ms = v\n        return nil\n    }\n    *ms = []string{s}\n    return nil\n}\n</code></pre>\n\n<p>By implementing these methods the MaybeSlice type will satisfy the interfaces expected by json.Marshal and json.Unmarshal so you won't need to implement custom marshallers for all your types, just this one.</p>\n\n<p>MaybeSlice is a terrible name but hopefully you get the idea.</p>\n\n<p>These custom methods are easier with struct types, but I think the above is correct. If I remember correctly you need to make <code>Action</code> a <code>*MaybeSlice</code> to use the above.</p>\n"}], "owner": {"reputation": 579, "user_id": 6145303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cf09dbd6a1479eac38241085a0e64de?s=128&d=identicon&r=PG&f=1", "display_name": "arewm", "link": "https://stackoverflow.com/users/6145303/arewm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1361, "favorite_count": 1, "accepted_answer_id": 38757780, "answer_count": 2, "score": 5, "last_activity_date": 1470317939, "creation_date": 1470244877, "last_edit_date": 1470317939, "question_id": 38750027, "link": "https://stackoverflow.com/questions/38750027/golang-structure-for-json-to-allow-a-value-to-optionally-be-an-array", "title": "Golang structure for json to allow a value to optionally be an array", "body": "<p>I am trying to change the policy for an s3 bucket on aws. I have created the following json structure for a policy:</p>\n\n<pre><code>type Policy struct {\n    Version     string  `json:\"Version\"`\n    Id          string  `json:\"Id\"`\n    Statement   []Statement `json:\"Statement\"`\n}\n\ntype Statement struct {\n    Sid         string      `json:\"Sid\"`\n    Effect      string      `json:\"Effect\"`\n    Principal   Principal   `json:\"Principal\"`\n    Action      []string    `json:\"Action\"`\n    Resource    []string    `json:\"Resource\"`\n}\n\ntype Principal struct {\n    AWS[]string `json:\"AWS\"`\n}\n</code></pre>\n\n<p>Which works fine for putting bucket policies in place. The issue comes when I try to get the current policy and modify it.</p>\n\n<p>If there is a statement that only has one AWS, Action, or Resource value, Amazon will convert it from an array to a simple value, causing my unmarshalling to fail.</p>\n\n<p>Is there any way that I can specify AWS/Action/Resource values to be either a string slice or just a string?</p>\n\n<hr>\n\n<p>I know that there are packages available that I could use to get around this to some extent (<code>github.com/Jeffail/gabs</code>, for example), but it would be cleaner to just create the JSON structure since it is fairly simple.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 28, "last_activity_date": 1470239513, "last_edit_date": 1470239513, "creation_date": 1470239060, "answer_id": 38748189, "question_id": 38748098, "link": "https://stackoverflow.com/questions/38748098/golang-type-switch-how-to-match-a-generic-slice-array-map-chan/38748189#38748189", "title": "Golang Type Switch: How to match a generic slice/array/map/chan?", "body": "<p>Type switches work with specific types.  If you cannot enumerate all of the types in the switch, then the only option is to use the reflect package.</p>\n\n<pre><code>v := reflect.ValueOf(x)\nswitch v.Kind() {\ncase reflect.Bool:\n    fmt.Printf(\"bool: %v\\n\", v.Bool())\ncase reflect.Int, reflect.Int8, reflect.Int32, reflect.Int64:\n    fmt.Printf(\"int: %v\\n\", v.Int())\ncase reflect.Uint, reflect.Uint8, reflect.Uint32, reflect.Uint64:\n    fmt.Printf(\"int: %v\\n\", v.Uint())\ncase reflect.Float32, reflect.Float64:\n    fmt.Printf(\"float: %v\\n\", v.Float())\ncase reflect.String:\n    fmt.Printf(\"string: %v\\n\", v.String())\ncase reflect.Slice:\n    fmt.Printf(\"slice: len=%d, %v\\n\", v.Len(), v.Interface())\ncase reflect.Map:\n    fmt.Printf(\"map: %v\\n\", v.Interface())\ncase reflect.Chan:\n    fmt.Printf(\"chan %v\\n\", v.Interface())\ndefault:\n    fmt.Println(x)\n}\n</code></pre>\n"}], "owner": {"reputation": 772, "user_id": 2177445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a2a5ad356c78484d79a3ad4b99209f?s=128&d=identicon&r=PG", "display_name": "likebike", "link": "https://stackoverflow.com/users/2177445/likebike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11490, "favorite_count": 2, "accepted_answer_id": 38748189, "answer_count": 1, "score": 15, "last_activity_date": 1470239513, "creation_date": 1470238797, "question_id": 38748098, "link": "https://stackoverflow.com/questions/38748098/golang-type-switch-how-to-match-a-generic-slice-array-map-chan", "title": "Golang Type Switch: How to match a generic slice/array/map/chan?", "body": "<p>How can I use a Go Type Switch to match a <strong>generic</strong> slice, array, map, or channel?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc WhatIsIt(x interface{}) {\n    switch X := x.(type) {\n        case bool:\n            fmt.Printf(\"Type Switch says %#v is a boolean.\\n\", X)\n        case int, int8, int16, int32, int64, uint, uint8, uint16, uint32, uint64:\n            fmt.Printf(\"Type Switch says %#v is an integer.\\n\", X)\n        case float32, float64, complex64, complex128:\n            fmt.Printf(\"Type Switch says %#v is a floating-point.\\n\", X)\n        case string:\n            fmt.Printf(\"Type Switch says %#v is a string.\\n\", X)\n        case []interface{}:\n            fmt.Printf(\"TypeSwitch says %#v is a slice.\\n\", X)\n        case map[interface{}]interface{}:\n            fmt.Printf(\"TypeSwitch says %#v is a map.\\n\", X)\n        case chan interface{}:\n            fmt.Printf(\"TypeSwitch says %#v is a channel.\\n\", X)\n        default:\n            switch reflect.TypeOf(x).Kind() {\n                case reflect.Slice, reflect.Array, reflect.Map, reflect.Chan:\n                    fmt.Printf(\"TypeSwitch was unable to identify this item.  Reflect says %#v is a slice, array, map, or channel.\\n\", X)\n                default:\n                    fmt.Printf(\"Type handler not implemented: %#v\\n\", X)\n            }\n    }\n}\n\nfunc main() {\n    WhatIsIt(true)\n    WhatIsIt(1)\n    WhatIsIt(1.5)\n    WhatIsIt(\"abc\")\n    WhatIsIt([]int{1,2,3})\n    WhatIsIt(map[int]int{1:1, 2:2, 3:3})\n    WhatIsIt(make(chan int))\n}\n</code></pre>\n\n<p>Here is the output:</p>\n\n<pre><code>Type Switch says true is a boolean.\nType Switch says 1 is an integer.\nType Switch says 1.5 is a floating-point.\nType Switch says \"abc\" is a string.\nTypeSwitch was unable to identify this item.  Reflect says []int{1, 2, 3} is a slice, array, map, or channel.\nTypeSwitch was unable to identify this item.  Reflect says map[int]int{1:1, 2:2, 3:3} is a slice, array, map, or channel.\nTypeSwitch was unable to identify this item.  Reflect says (chan int)(0x104320c0) is a slice, array, map, or channel.\n</code></pre>\n\n<p>As you can see from the output, the <code>case []interface{}</code> fails to match the slice that I send in.  I need to resort to using the <code>reflect</code> package instead.</p>\n\n<p>If I explicitly write <code>case []int</code>, then it works for my given example, but it's impossible to know all the input types ahead of time, so I need a more general solution.  I want to avoid using the <code>reflect</code> package if the Type Switch is able to handle this.</p>\n\n<p>Is there any way to use the Type Switch to determine if an object is a slice/array/map/chan/etc...?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": false, "score": 2, "last_activity_date": 1470263256, "last_edit_date": 1470263256, "creation_date": 1470262949, "answer_id": 38754624, "question_id": 38747478, "link": "https://stackoverflow.com/questions/38747478/how-to-do-partial-and-full-updates-on-a-document-using-mgo-in-go/38754624#38754624", "title": "How to do partial and full updates on a document using mgo in Go", "body": "<ol>\n<li><p>Yes, the partial update always requires <code>$set</code>. This is not about Go this is about Mongo <kbd><a href=\"https://docs.mongodb.com/manual/reference/operator/update/set/\" rel=\"nofollow\">$set operator</a></kbd> <code>bson.M</code> is just the shortcut for <code>map[string]interface{}</code> which allows us to build JSON-like structures in go without thinking about argument type. So, as you always need <code>$set</code> the update document always will have at least two levels of <code>bson.M</code>. Actually, there are more levels as your <code>Task</code> objects could be defined as <code>bson.M</code> objects too.</p></li>\n<li><p>Yes, the full document update (personally I think this process looks more like replace) requires only 2 <code>bson.M</code> objects - the query and the new document.</p>\n\n<p>In Mongo full update looks like</p>\n\n<p><code>db.collection.update({_id: \"id\"}, {name: \"name\", num: 1})</code></p>\n\n<p>And the same command in Go:</p>\n\n<p><code>c.Update(bson.M{\"_id\": \"id\"}, bson.M{\"name\": \"name\", \"num\": 1})</code></p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2423, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470263256, "creation_date": 1470237207, "question_id": 38747478, "link": "https://stackoverflow.com/questions/38747478/how-to-do-partial-and-full-updates-on-a-document-using-mgo-in-go", "title": "How to do partial and full updates on a document using mgo in Go", "body": "<p>From Web Development with Go by Shiju Varghese, about the update method in the MongoDB driver <code>mgo</code> in Go</p>\n\n<blockquote>\n  <p><strong>Updating Documents</strong> </p>\n  \n  <p>The Update method of the Collection type allows you\n  to update existing documents. Here is the method signature of the\n  Update method:</p>\n\n<pre><code>func (c *Collection) Update(selector interface{}, update interface{}) error\n</code></pre>\n  \n  <p>The Update method finds a single document from the collection, matches\n  it with the provided selector  document, and modifies it based on the\n  provided update document. A partial update can be done by using  the\n  keyword \"$set\" in the update document.</p>\n  \n  <p>Listing 8-14 updates an existing document.</p>\n\n<pre><code>err := c.Update(bson.M{\"_id\": id},\nbson.M{\"$set\": bson.M{\n\"description\": \"Create open-source projects\",\n\"tasks\": []Task{\nTask{\" Evaluate Negroni Project\", time.Date(2015, time.August, 15, 0, 0, 0, \n0, time.UTC)},\nTask{\" Explore mgo Project\", time.Date(2015, time.August, 10, 0, 0, 0, 0, \ntime.UTC)},\nTask{\" Explore Gorilla Toolkit\", time.Date(2015, time.August, 10, 0, 0, 0, 0, \ntime.UTC)},\n},\n}})\n</code></pre>\n  \n  <p>A partial update is performed for the fields\u2019 descriptions and tasks.\n  The Update method finds the  document with the provided _id value and\n  modifies the fields based on the provided document.</p>\n</blockquote>\n\n<p>The example is a partial update. It uses two-level nested <code>bson.M</code> to create <code>update interface{}</code>. Does a partial update always use such two-level nested <code>bson.M</code>? </p>\n\n<p>Does a full update use one-level <code>bson.M</code>, such as</p>\n\n<blockquote>\n<pre><code>err := c.Update(bson.M{\"_id\": id},\nbson.M{ \"description\": \"Create open-source projects\",\n\"tasks\": []Task{\nTask{\" Evaluate Negroni Project\", time.Date(2015, time.August, 15, 0, 0, 0, \n0, time.UTC)},\nTask{\" Explore mgo Project\", time.Date(2015, time.August, 10, 0, 0, 0, 0, \ntime.UTC)},\nTask{\" Explore Gorilla Toolkit\", time.Date(2015, time.August, 10, 0, 0, 0, 0, \ntime.UTC)},\n},\n})\n</code></pre>\n</blockquote>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "makefile", "make-install", "ipfs"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4952226, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oZ9MH4ViPKQ/AAAAAAAAAAI/AAAAAAAAAAA/BqnQ7PvS5Qc/photo.jpg?sz=128", "display_name": "mike", "link": "https://stackoverflow.com/users/4952226/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1531608990, "last_edit_date": 1531608990, "creation_date": 1531578936, "answer_id": 51340473, "question_id": 38747259, "link": "https://stackoverflow.com/questions/38747259/use-proxy-with-makefile/51340473#51340473", "title": "Use proxy with Makefile", "body": "<p>I use this in MINGW64, please try:</p>\n\n<p><code>export http_proxy=socks5://127.0.0.1:10011</code> <br>\n<code>export https_proxy=socks5://127.0.0.1:10011</code></p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1647, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1531608990, "creation_date": 1470236590, "question_id": 38747259, "link": "https://stackoverflow.com/questions/38747259/use-proxy-with-makefile", "title": "Use proxy with Makefile", "body": "<p>To install ipfs I use these steps :</p>\n\n<pre><code>$ go get -d github.com/ipfs/go-ipfs\n\n$ cd $GOPATH/src/github.com/ipfs/go-ipfs\nThen install go-ipfs and its dependencies, including gx and gx-go:\n\n$ make install\n</code></pre>\n\n<p>taken from <a href=\"https://github.com/ipfs/go-ipfs#build-from-source\" rel=\"nofollow\">https://github.com/ipfs/go-ipfs#build-from-source</a></p>\n\n<p>When I execute step <code>make install</code> I receive which appears to be a proxy issue : </p>\n\n<pre><code>ERROR: [1 / 32 ] parallel fetch: failed to fetch package: QmVCe3SNMjkcPgnpFhZs719dheq6xE7gJwjzV7aWcUM4Ms: Post http://v04x.ipfs.io/api/v0/get?arg=QmVCe3SNMjkcPgnpFhZs719dheq6xE7gJwjzV7aWcUM4Ms&amp;encodinERROR: from shell.Get(): &amp;url.Error{Op:\"Post\", URL:\"http://v04x.ipfs.io/api/v0/get?arg=QmeWQMDa5dSdP4n8WDeoY5z8L2EKVqF4ZvK4VEHsLqXsGu&amp;encoding=json&amp;stream-channels=true\", Err:(*net.OpError)(0xc820142e60)}\n</code></pre>\n\n<p>as the url <a href=\"http://v04x.ipfs.io/api/v0/get?arg=QmeWQMDa5dSdP4n8WDeoY5z8L2EKVqF4ZvK4VEHsLqXsGu&amp;encoding=json&amp;stream-channels=true\" rel=\"nofollow\">http://v04x.ipfs.io/api/v0/get?arg=QmeWQMDa5dSdP4n8WDeoY5z8L2EKVqF4ZvK4VEHsLqXsGu&amp;encoding=json&amp;stream-channels=true</a> is valid.</p>\n\n<p>The content of Makefile : </p>\n\n<pre><code># Minimum version numbers for software required to build IPFS\nIPFS_MIN_GO_VERSION = 1.5.2\nIPFS_MIN_GX_VERSION = 0.6\nIPFS_MIN_GX_GO_VERSION = 1.1\n\nifeq ($(TEST_NO_FUSE),1)\n  go_test=IPFS_REUSEPORT=false go test -tags nofuse\nelse\n  go_test=IPFS_REUSEPORT=false go test\nendif\n\nifeq ($(OS),Windows_NT)\n  GOPATH_DELIMITER = ;\nelse\n  GOPATH_DELIMITER = :\nendif\n\ndist_root=/ipfs/QmUnvqDuRyfe7HJuiMMHv77AMUFnjGyAU28LFPeTYwGmFF\ngx_bin=bin/gx-v0.8.0\ngx-go_bin=bin/gx-go-v1.2.1\n\n# use things in our bin before any other system binaries\nexport PATH := bin:$(PATH)\nexport IPFS_API ?= v04x.ipfs.io\n\nall: help\n\ngodep:\n    go get github.com/tools/godep\n\ngo_check:\n    @bin/check_go_version $(IPFS_MIN_GO_VERSION)\n\nbin/gx-v%:\n    @echo \"installing gx $(@:bin/gx-%=%)\"\n    @bin/dist_get ${dist_root} gx $@ $(@:bin/gx-%=%)\n    rm -f bin/gx\n    ln -s $(@:bin/%=%) bin/gx\n\nbin/gx-go-v%:\n    @echo \"installing gx-go $(@:bin/gx-go-%=%)\"\n    @bin/dist_get ${dist_root} gx-go $@ $(@:bin/gx-go-%=%)\n    rm -f bin/gx-go\n    ln -s $(@:bin/%=%) bin/gx-go\n\ngx_check: ${gx_bin} ${gx-go_bin}\n\npath_check:\n    @bin/check_go_path $(realpath $(shell pwd)) $(realpath $(addsuffix /src/github.com/ipfs/go-ipfs,$(subst $(GOPATH_DELIMITER), ,$(GOPATH))))\n\ndeps: go_check gx_check path_check\n    ${gx_bin} --verbose install --global\n\n# saves/vendors third-party dependencies to Godeps/_workspace\n# -r flag rewrites import paths to use the vendored path\n# ./... performs operation on all packages in tree\nvendor: godep\n    godep save -r ./...\n\ninstall: deps\n    make -C cmd/ipfs install\n\nbuild: deps\n    make -C cmd/ipfs build\n\nnofuse: deps\n    make -C cmd/ipfs nofuse\n\nclean:\n    make -C cmd/ipfs clean\n\nuninstall:\n    make -C cmd/ipfs uninstall\n\nPHONY += all help godep gx_check\nPHONY += go_check deps vendor install build nofuse clean uninstall\n\n##############################################################\n# tests targets\n\ntest: test_expensive\n\ntest_short: build test_go_short test_sharness_short\n\ntest_expensive: build test_go_expensive test_sharness_expensive windows_build_check\n\ntest_3node:\n    cd test/3nodetest &amp;&amp; make\n\ntest_go_short:\n    $(go_test) -test.short ./...\n\ntest_go_expensive:\n    $(go_test) ./...\n\ntest_go_race:\n    $(go_test) ./... -race\n\ntest_sharness_short:\n    make -C test/sharness/\n\ntest_sharness_expensive:\n    TEST_EXPENSIVE=1 make -C test/sharness/\n\ntest_all_commits:\n    @echo \"testing all commits between origin/master..HEAD\"\n    @echo \"WARNING: this will 'git rebase --exec'.\"\n    @test/bin/continueyn\n    GIT_EDITOR=true git rebase -i --exec \"make test\" origin/master\n\ntest_all_commits_travis:\n    # these are needed because travis.\n    # we don't use this yet because it takes way too long.\n    git config --global user.email \"nemo@ipfs.io\"\n    git config --global user.name \"IPFS BOT\"\n    git fetch origin master:master\n    GIT_EDITOR=true git rebase -i --exec \"make test\" master\n\n# since we have CI for osx and linux but not windows, this should help\nwindows_build_check:\n    GOOS=windows GOARCH=amd64 go build -o .test.ipfs.exe ./cmd/ipfs\n    rm .test.ipfs.exe\n\nPHONY += test test_short test_expensive\n\n##############################################################\n# A semi-helpful help message\n\nhelp:\n    @echo 'DEPENDENCY TARGETS:'\n    @echo ''\n    @echo '  gx_check        - Installs or upgrades gx and gx-go'\n    @echo '  deps            - Download dependencies using gx'\n    @echo '  vendor          - Create a Godep workspace of 3rd party dependencies'\n    @echo ''\n    @echo 'BUILD TARGETS:'\n    @echo ''\n    @echo '  all          - print this help message'\n    @echo '  build        - Build binary at ./cmd/ipfs/ipfs'\n    @echo '  nofuse       - Build binary with no fuse support'\n    @echo '  install      - Build binary and install into $$GOPATH/bin'\n#   @echo '  dist_install - TODO: c.f. ./cmd/ipfs/dist/README.md'\n    @echo ''\n    @echo 'CLEANING TARGETS:'\n    @echo ''\n    @echo '  clean        - Remove binary from build directory'\n    @echo '  uninstall    - Remove binary from $$GOPATH/bin'\n    @echo ''\n    @echo 'TESTING TARGETS:'\n    @echo ''\n    @echo '  test                    - Run expensive tests and Window$$ check'\n    @echo '  test_short              - Run short tests and sharness tests'\n    @echo '  test_expensive          - Run a few extras'\n    @echo '  test_3node'\n    @echo '  test_go_short'\n    @echo '  test_go_expensive'\n    @echo '  test_go_race'\n    @echo '  test_sharness_short'\n    @echo '  test_sharness_expensive'\n    @echo '  test_all_commits'\n    @echo \"  test_all_commits_travis - DON'T USE: takes way too long\"\n    @echo '  windows_build_check'\n    @echo ''\n\nPHONY += help\n\n.PHONY: $(PHONY)\n</code></pre>\n\n<p><code>go</code> and <code>git</code> proxies appear to be setup correctly as <code>go get -d github.com/ipfs/go-ipfs</code> downloads the go-ipfs repo. </p>\n\n<p>Do I need to set a proxy for <code>shell.Get()</code> ?</p>\n"}, {"tags": ["javascript", "go", "vue.js", "template-engine"], "comments": [{"owner": {"reputation": 7361, "user_id": 440237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f3c59b80a8829fb0dd3f80b5f3c98f4?s=128&d=identicon&r=PG", "display_name": "gurghet", "link": "https://stackoverflow.com/users/440237/gurghet"}, "edited": false, "score": 2, "creation_date": 1470230717, "post_id": 38744766, "comment_id": 64863662, "body": "Please make your question more specific"}, {"owner": {"reputation": 829, "user_id": 4667256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/860591147318225/picture?type=large", "display_name": "Gilbert Nwaiwu", "link": "https://stackoverflow.com/users/4667256/gilbert-nwaiwu"}, "reply_to_user": {"reputation": 7361, "user_id": 440237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f3c59b80a8829fb0dd3f80b5f3c98f4?s=128&d=identicon&r=PG", "display_name": "gurghet", "link": "https://stackoverflow.com/users/440237/gurghet"}, "edited": false, "score": 0, "creation_date": 1470235087, "post_id": 38744766, "comment_id": 64867069, "body": "Edited the original question"}], "answers": [{"comments": [{"owner": {"reputation": 829, "user_id": 4667256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/860591147318225/picture?type=large", "display_name": "Gilbert Nwaiwu", "link": "https://stackoverflow.com/users/4667256/gilbert-nwaiwu"}, "edited": false, "score": 2, "creation_date": 1470249813, "post_id": 38746823, "comment_id": 64876556, "body": "Quick question. If I use delimiters as you specified above is there a chance for the golang templates to be parsed wrongly? Like with ${{{.Field}}}, is it possible for the parser to parse the outer two curly brackets instead of the inner two?"}, {"owner": {"reputation": 7361, "user_id": 440237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f3c59b80a8829fb0dd3f80b5f3c98f4?s=128&d=identicon&r=PG", "display_name": "gurghet", "link": "https://stackoverflow.com/users/440237/gurghet"}, "reply_to_user": {"reputation": 829, "user_id": 4667256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/860591147318225/picture?type=large", "display_name": "Gilbert Nwaiwu", "link": "https://stackoverflow.com/users/4667256/gilbert-nwaiwu"}, "edited": false, "score": 1, "creation_date": 1470253721, "post_id": 38746823, "comment_id": 64878755, "body": "You mean go? No because it will look for <code>{{.</code> not <code>{{{</code>"}, {"owner": {"reputation": 829, "user_id": 4667256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/860591147318225/picture?type=large", "display_name": "Gilbert Nwaiwu", "link": "https://stackoverflow.com/users/4667256/gilbert-nwaiwu"}, "edited": false, "score": 0, "creation_date": 1470268356, "post_id": 38746823, "comment_id": 64884499, "body": "Ok. Got it. Thanks"}], "tags": [], "owner": {"reputation": 7361, "user_id": 440237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f3c59b80a8829fb0dd3f80b5f3c98f4?s=128&d=identicon&r=PG", "display_name": "gurghet", "link": "https://stackoverflow.com/users/440237/gurghet"}, "is_accepted": true, "score": 14, "last_activity_date": 1470235395, "creation_date": 1470235395, "answer_id": 38746823, "question_id": 38744766, "link": "https://stackoverflow.com/questions/38744766/using-vuejs-with-a-go-backend/38746823#38746823", "title": "Using VueJS with a Go backend", "body": "<p>If you are mixing Vue.js with another templating system you can choose to change the interpolating delimiters (by default<code>['{{','}}']</code>) with something else.</p>\n\n<pre><code>Vue.config.delimiters = ['${', '}']\n</code></pre>\n\n<p>Now you can use <code>{{.}}</code> with golang and <code>${}</code> with Vue</p>\n"}, {"tags": [], "owner": {"reputation": 1188, "user_id": 1308927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6c692ca1e6b1ad945b14b3a2f7e0850?s=128&d=identicon&r=PG", "display_name": "RdB", "link": "https://stackoverflow.com/users/1308927/rdb"}, "is_accepted": false, "score": 1, "last_activity_date": 1520167093, "creation_date": 1520167093, "answer_id": 49095471, "question_id": 38744766, "link": "https://stackoverflow.com/questions/38744766/using-vuejs-with-a-go-backend/49095471#49095471", "title": "Using VueJS with a Go backend", "body": "<p>At the Go's side you can define your own delimiters:\n<a href=\"https://golang.org/pkg/text/template/#Template.Delims\" rel=\"nofollow noreferrer\">https://golang.org/pkg/text/template/#Template.Delims</a></p>\n"}], "owner": {"reputation": 829, "user_id": 4667256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/860591147318225/picture?type=large", "display_name": "Gilbert Nwaiwu", "link": "https://stackoverflow.com/users/4667256/gilbert-nwaiwu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4280, "favorite_count": 3, "accepted_answer_id": 38746823, "answer_count": 2, "score": 7, "last_activity_date": 1520167093, "creation_date": 1470230169, "last_edit_date": 1519311781, "question_id": 38744766, "link": "https://stackoverflow.com/questions/38744766/using-vuejs-with-a-go-backend", "title": "Using VueJS with a Go backend", "body": "<p>I want to use Go templates as well as VueJS for data-binding. Has anyone integrated both before?</p>\n\n<p>I wish to use VueJS primarily for Ajax calls as doing it manually(or with jQuery) always leaves my code messy.</p>\n\n<p>To be more specific, if I have a simple<code>&lt;p&gt;</code> tag whose value is generated from a Go template like so:</p>\n\n<pre><code>{{.Color}}\n</code></pre>\n\n<p>Now I want to bind to the value in<br>\nlike so:</p>\n\n<pre><code>{{someVariable}} \n</code></pre>\n\n<p>Both are for the same tag.</p>\n"}, {"tags": ["mongodb", "authentication", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 0, "creation_date": 1470229923, "post_id": 38744643, "comment_id": 64863076, "body": "server returned error on SASL authentication step: Authentication failed. panic: runtime error: invalid memory address or nil pointer dereference \tpanic: runtime error: invalid memory address or nil pointer dereference"}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 1, "creation_date": 1470230324, "post_id": 38744643, "comment_id": 64863373, "body": "Yes this is correct way to implement connection. Here is working code <a href=\"https://gist.github.com/bearburger/718dec31746762684a7a512aed992a37\" rel=\"nofollow noreferrer\">gist.github.com/bearburger/718dec31746762684a7a512aed992a37</a> that connects demo DB."}], "tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": false, "score": 4, "last_activity_date": 1470229817, "creation_date": 1470229817, "answer_id": 38744643, "question_id": 38744131, "link": "https://stackoverflow.com/questions/38744131/server-returned-error-on-sasl-authentication-step-authentication-failed/38744643#38744643", "title": "server returned error on SASL authentication step: Authentication failed", "body": "<p><code>mgo</code> returns this error if <code>username</code>, <code>password</code> or <code>database</code> are wrong. Check your credentials twice. There are no other situations when you can see <code>Authentication failed</code> error message.</p>\n"}, {"comments": [{"owner": {"reputation": 639, "user_id": 2024780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gbjWi.png?s=128&g=1", "display_name": "rrw", "link": "https://stackoverflow.com/users/2024780/rrw"}, "edited": false, "score": 2, "creation_date": 1519714807, "post_id": 38746835, "comment_id": 85010198, "body": "I dont know how the up-voter understood you, but I am sure I understood nothing from your answer. Mind elaborating more...?"}, {"owner": {"reputation": 417, "user_id": 3049386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754afefdb87c446066459a9857d9a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Bestbug", "link": "https://stackoverflow.com/users/3049386/bestbug"}, "reply_to_user": {"reputation": 639, "user_id": 2024780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gbjWi.png?s=128&g=1", "display_name": "rrw", "link": "https://stackoverflow.com/users/2024780/rrw"}, "edited": false, "score": 0, "creation_date": 1519806833, "post_id": 38746835, "comment_id": 85054779, "body": "Well after more than 1 year I don&#39;t know exactly what I was thinking. Probably my idea was the Golang application can&#39;t retreive one or more env_variable from the host."}], "tags": [], "owner": {"reputation": 417, "user_id": 3049386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754afefdb87c446066459a9857d9a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Bestbug", "link": "https://stackoverflow.com/users/3049386/bestbug"}, "is_accepted": false, "score": 1, "last_activity_date": 1470235421, "creation_date": 1470235421, "answer_id": 38746835, "question_id": 38744131, "link": "https://stackoverflow.com/questions/38744131/server-returned-error-on-sasl-authentication-step-authentication-failed/38746835#38746835", "title": "server returned error on SASL authentication step: Authentication failed", "body": "<p>The error you report seem the cause of the authentication fail is caused by a nil pointer, you should check the data before using them to create the connection</p>\n"}, {"comments": [{"owner": {"reputation": 2957, "user_id": 2356383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0d3b7a2583bbb81815b92709d7f5c0?s=128&d=identicon&r=PG", "display_name": "ahaurat", "link": "https://stackoverflow.com/users/2356383/ahaurat"}, "edited": false, "score": 2, "creation_date": 1515351835, "post_id": 42086115, "comment_id": 83258879, "body": "In my case, I was using my mLab password instead of the db password. Silly mistake but this answer helped me figure it out!"}], "tags": [], "owner": {"reputation": 159, "user_id": 2614583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11523daef4e86cf69daecc83ad1e3b3f?s=128&d=identicon&r=PG", "display_name": "Geomy George", "link": "https://stackoverflow.com/users/2614583/geomy-george"}, "is_accepted": false, "score": 15, "last_activity_date": 1486459668, "creation_date": 1486459668, "answer_id": 42086115, "question_id": 38744131, "link": "https://stackoverflow.com/questions/38744131/server-returned-error-on-sasl-authentication-step-authentication-failed/42086115#42086115", "title": "server returned error on SASL authentication step: Authentication failed", "body": "<p>Often we confused with  parameter in the mongoexport command with \"Log-In\" user.\nThe command expects \"Database Username\" not Log-in username.\nThis is one possibility to input wrong user name.\n\"Database Username\" can be found in \"Users\" tab for a database</p>\n"}, {"comments": [{"owner": {"reputation": 1391, "user_id": 3107185, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/AKg0F.png?s=128&g=1", "display_name": "Rav", "link": "https://stackoverflow.com/users/3107185/rav"}, "edited": false, "score": 1, "creation_date": 1498563895, "post_id": 43749668, "comment_id": 76539288, "body": "Thanks, in my case that was exactly the solution."}, {"owner": {"reputation": 185, "user_id": 1400447, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/67dd7d9fe53e3a3e0c87984a6f5285d3?s=128&d=identicon&r=PG", "display_name": "vabm", "link": "https://stackoverflow.com/users/1400447/vabm"}, "edited": false, "score": 2, "creation_date": 1516449755, "post_id": 43749668, "comment_id": 83698319, "body": "I&#39;m confused... what is the --authenticationDatabase parameter? the name of the database you want to access?"}, {"owner": {"reputation": 2785, "user_id": 1192702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4ab92e03071e51c05bd9d22343492586?s=128&d=identicon&r=PG", "display_name": "alaster", "link": "https://stackoverflow.com/users/1192702/alaster"}, "edited": false, "score": 1, "creation_date": 1517764522, "post_id": 43749668, "comment_id": 84218039, "body": "In my case I had access to only one db on server. So I needed to just add <code>-d &lt;dbname&gt;</code> option. No need of <code>--authenticationDatabase</code> for me"}, {"owner": {"reputation": 1059, "user_id": 6255550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4GXbq.jpg?s=128&g=1", "display_name": "Pax Beach", "link": "https://stackoverflow.com/users/6255550/pax-beach"}, "edited": false, "score": 0, "creation_date": 1524466021, "post_id": 43749668, "comment_id": 86965698, "body": "It is the right advice, but I had &#39;%&#39; sign in my password, and in the cmd.exe script the sign has disappeared. I had the same error =)"}, {"owner": {"reputation": 222, "user_id": 757018, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/192c5e361523264460a0f5e5614cfb3d?s=128&d=identicon&r=PG", "display_name": "Bruno Fernandes", "link": "https://stackoverflow.com/users/757018/bruno-fernandes"}, "edited": false, "score": 0, "creation_date": 1538046187, "post_id": 43749668, "comment_id": 92010215, "body": "I had a &#39;;&#39; in my password!"}, {"owner": {"reputation": 1086, "user_id": 7619353, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e4d2a067a2026b3805e1f2f6a6ac48d0?s=128&d=identicon&r=PG&f=1", "display_name": "tyleax", "link": "https://stackoverflow.com/users/7619353/tyleax"}, "edited": false, "score": 0, "creation_date": 1556659478, "post_id": 43749668, "comment_id": 98511263, "body": "Thanks this was the solution after searching a while for what was wrong."}, {"owner": {"reputation": 112, "user_id": 1629952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be569a379ab2393381566fc64340df10?s=128&d=identicon&r=PG", "display_name": "Jigar Prajapati", "link": "https://stackoverflow.com/users/1629952/jigar-prajapati"}, "edited": false, "score": 0, "creation_date": 1573823579, "post_id": 43749668, "comment_id": 104022917, "body": "changing few things and it&#39;s working thank you so much bhai"}, {"owner": {"reputation": 355, "user_id": 190929, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/WLFPk.jpg?s=128&g=1", "display_name": "DummyBeginner", "link": "https://stackoverflow.com/users/190929/dummybeginner"}, "edited": false, "score": 0, "creation_date": 1597516485, "post_id": 43749668, "comment_id": 112160766, "body": "My problem was using shorthands <code>-u</code> and <code>-p</code> even beside <code>--authenticationDatabase</code> in <code>mongoimport</code>. Replacing them with their long-form respectively ( <code>--username</code> and <code>--password</code>) along with the <code>--authenticationDatabase</code> solved the problem."}], "tags": [], "owner": {"reputation": 1876, "user_id": 4264078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a045d1d55b8c707db7aa5a9c50ff10b?s=128&d=identicon&r=PG&f=1", "display_name": "Anantha", "link": "https://stackoverflow.com/users/4264078/anantha"}, "is_accepted": true, "score": 175, "last_activity_date": 1515792762, "last_edit_date": 1515792762, "creation_date": 1493775041, "answer_id": 43749668, "question_id": 38744131, "link": "https://stackoverflow.com/questions/38744131/server-returned-error-on-sasl-authentication-step-authentication-failed/43749668#43749668", "title": "server returned error on SASL authentication step: Authentication failed", "body": "<p>I faced similar error and added <code>--authenticationDatabase</code> parameter and it worked while we connecting to a remote MongoDB</p>\n\n<p>Use the similar below format in your code :</p>\n\n<pre><code>$mongorestore --host databasehost:98761 --username restoreuser\n--password restorepwd --authenticationDatabase admin --db targetdb ./path/to/dump/\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 523, "user_id": 1103781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01707c9cf4cc4f2847070b7bf4da6095?s=128&d=identicon&r=PG", "display_name": "Zach B.", "link": "https://stackoverflow.com/users/1103781/zach-b"}, "edited": false, "score": 0, "creation_date": 1522561625, "post_id": 49380370, "comment_id": 86197653, "body": "Exactly my problem. Thank you."}, {"owner": {"reputation": 1979, "user_id": 639708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd46b34c3b469bb10dc1644d1b185033?s=128&d=identicon&r=PG", "display_name": "Andrei Radulescu", "link": "https://stackoverflow.com/users/639708/andrei-radulescu"}, "edited": false, "score": 0, "creation_date": 1561554943, "post_id": 49380370, "comment_id": 100102907, "body": "tl;dr &quot;To solve the issue, simply single quote the password field.&quot; e.g. -p &#39;password&#39;"}, {"owner": {"reputation": 2247, "user_id": 1592783, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9k38I.jpg?s=128&g=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/1592783/jack"}, "edited": false, "score": 0, "creation_date": 1581504242, "post_id": 49380370, "comment_id": 106453957, "body": "Thank you, I had a <code>&amp;</code> which was causing the issue"}], "tags": [], "owner": {"reputation": 646, "user_id": 4896993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a48f0fcd8659003048f7d30179c145e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Shang", "link": "https://stackoverflow.com/users/4896993/michael-shang"}, "is_accepted": false, "score": 8, "last_activity_date": 1521537754, "creation_date": 1521537754, "answer_id": 49380370, "question_id": 38744131, "link": "https://stackoverflow.com/questions/38744131/server-returned-error-on-sasl-authentication-step-authentication-failed/49380370#49380370", "title": "server returned error on SASL authentication step: Authentication failed", "body": "<p>I got my answer from this link: <a href=\"https://newbiedba.wordpress.com/2016/11/21/mongodb-3-2-server-returned-error-on-sasl-authentication-step-authentication-failed/\" rel=\"noreferrer\">https://newbiedba.wordpress.com/2016/11/21/mongodb-3-2-server-returned-error-on-sasl-authentication-step-authentication-failed/</a></p>\n\n<p>Except for all answers above, the only unmentioned reason is that my password has a special character '$' in it. I think this is a very common practice to have special characters and this may trip many without this simple tip:</p>\n\n<p>When using command line mongo/mongostat/etc.. Single quote your username or password that has special characters!</p>\n"}, {"tags": [], "owner": {"reputation": 399, "user_id": 6062109, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/uDCUx.jpg?s=128&g=1", "display_name": "Seunghun Sunmoon Lee", "link": "https://stackoverflow.com/users/6062109/seunghun-sunmoon-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1549602600, "creation_date": 1549602600, "answer_id": 54586305, "question_id": 38744131, "link": "https://stackoverflow.com/questions/38744131/server-returned-error-on-sasl-authentication-step-authentication-failed/54586305#54586305", "title": "server returned error on SASL authentication step: Authentication failed", "body": "<p>I had the same error when using with dokku mongo:import . In my case I included dot(period) in my db name</p>\n\n<p>You shouldn't include dot in your mongodb name when 'dokku mongo:create '\nI've changed it to seunghunlee instead of seunghunlee.net\nnow this command works</p>\n\n<pre><code>dokku mongo:import seunghunlee &lt; seunghunlee.net.dump.gz\n</code></pre>\n\n<p>Hope it helps!</p>\n"}, {"tags": [], "owner": {"reputation": 5314, "user_id": 2430274, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s6S94.jpg?s=128&g=1", "display_name": "e18r", "link": "https://stackoverflow.com/users/2430274/e18r"}, "is_accepted": false, "score": 1, "last_activity_date": 1588388113, "creation_date": 1588388113, "answer_id": 61553887, "question_id": 38744131, "link": "https://stackoverflow.com/questions/38744131/server-returned-error-on-sasl-authentication-step-authentication-failed/61553887#61553887", "title": "server returned error on SASL authentication step: Authentication failed", "body": "<p>I got this error while using a connection string from a Heroku app by means of the <code>--uri</code> flag. What solved it in my case was adding the database name with <code>-d</code>:</p>\n\n<pre><code>mongodb_uri=\"$(heroku config:get MONGODB_URI -a myapp)\"\nmongorestore --uri=$mongodb_uri -d heroku_7m41q4xs db/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14837225, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xUdEojtK5Tg/AAAAAAAAAAI/AAAAAAAAAOo/1AY-5V2e_Ro/photo.jpg?sz=128", "display_name": "Adel Afsharipour", "link": "https://stackoverflow.com/users/14837225/adel-afsharipour"}, "is_accepted": false, "score": 0, "last_activity_date": 1608123289, "creation_date": 1608123289, "answer_id": 65323715, "question_id": 38744131, "link": "https://stackoverflow.com/questions/38744131/server-returned-error-on-sasl-authentication-step-authentication-failed/65323715#65323715", "title": "server returned error on SASL authentication step: Authentication failed", "body": "<p>In my case, I was missing both --authenticationDatabase &amp; --ssl, so here goes the full syntax for importing a json file into a Mongodb collection over an Atlas cluster (into the primary shard):</p>\n<pre><code>./mongoimport --host mycluster-shard-00-02.d0b2r.mongodb.net:27017 --authenticationDatabase admin --username TestUser --db Test --collection Messages --type json --file RAW.json --ssl\n</code></pre>\n"}], "owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78848, "favorite_count": 17, "accepted_answer_id": 43749668, "answer_count": 8, "score": 78, "last_activity_date": 1608123289, "creation_date": 1470228428, "last_edit_date": 1486463289, "question_id": 38744131, "link": "https://stackoverflow.com/questions/38744131/server-returned-error-on-sasl-authentication-step-authentication-failed", "title": "server returned error on SASL authentication step: Authentication failed", "body": "<p>The following is my MongoDB connection dial from GoLang. But it's returning a panic \"<em>server returned error on SASL authentication step: Authentication failed.</em>\". My username, password, hostAddrs and dbName are correct. What am I missing here?</p>\n\n<pre><code>dbName: = os.Getenv(\"ENV_DBNAME\")\nuserName: = os.Getenv(\"ENV_DBUSER\")\npassword: = os.Getenv(\"ENV_DBPASS\")\ndbHost: = os.Getenv(\"ENV_DBHOST\")\nmongoDialInfo: = &amp; mgo.DialInfo {\n Addrs: [] string {\n  dbHost\n },\n Database: dbName,\n Username: userName,\n Password: password,\n Timeout: 60 * time.Second,\n}\nsess, err: = mgo.DialWithInfo(mongoDialInfo)\nif (err != nil) {\n panic(err)\n\n}\n</code></pre>\n"}, {"tags": ["go", "struct", "padding"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470225491, "post_id": 38742731, "comment_id": 64859577, "body": "There is no guarantee there will be a specific padding. And that is apparently not related to C."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1470225819, "post_id": 38742731, "comment_id": 64859796, "body": "You must serialize and de-serialize if you don&#39;y want to pack your structs."}], "answers": [{"comments": [{"owner": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "edited": false, "score": 0, "creation_date": 1470294656, "post_id": 38743958, "comment_id": 64893321, "body": "<code>[3]byte</code> needs <code>_</code>, but that will fail. Then, it would be:<code>type Foo struct { \ta uint8 \t_ [3]byte \tb uint32 }</code> :-)"}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "reply_to_user": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "edited": false, "score": 0, "creation_date": 1470299289, "post_id": 38743958, "comment_id": 64896207, "body": "Oh yeah that&#39;s weird. I read about anonymous fields but didn&#39;t realise they only work for non-primative types."}], "tags": [], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "is_accepted": false, "score": 1, "last_activity_date": 1470299297, "last_edit_date": 1470299297, "creation_date": 1470227983, "answer_id": 38743958, "question_id": 38742731, "link": "https://stackoverflow.com/questions/38742731/copy-byte-array-to-go-struct-accounting-for-struct-padding/38743958#38743958", "title": "Copy byte array to Go struct accounting for struct padding", "body": "<p>Ah I realised there is a relatively simple way to do it - just explicitly add dummy padding bytes into the Go struct:</p>\n\n<pre><code>type Foo struct {\n    a uint8\n    _ [3]byte\n    b uint32\n}\n</code></pre>\n\n<p>Then you can use <code>binary.Read()</code></p>\n"}], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470299297, "creation_date": 1470224885, "last_edit_date": 1470225499, "question_id": 38742731, "link": "https://stackoverflow.com/questions/38742731/copy-byte-array-to-go-struct-accounting-for-struct-padding", "title": "Copy byte array to Go struct accounting for struct padding", "body": "<p>Suppose I have this C struct</p>\n\n<pre><code>struct Foo\n{\n    uint8_t a;\n    // 3 bytes of padding\n    uint32_t b;\n}\n</code></pre>\n\n<p>And its equivalent in Go:</p>\n\n<pre><code>type Foo struct {\n    a uint8\n    b uint32\n}\n</code></pre>\n\n<p>And I have a byte slice that contains the C struct:</p>\n\n<pre><code>data := []byte { 0x01, 0x00, 0x00, 0x00, 0x01, 0x02, 0x03, 0x04 }\n</code></pre>\n\n<p>What is the best way to get that data into the Go struct (and vice versa).</p>\n\n<p>Note that I <em>do want padding</em> according to the normal C rules. The C struct is <em>not packed</em>.</p>\n\n<p>For packed structs I could do something like this:</p>\n\n<pre><code>    data := []byte { 0x01, 0x01, 0x02, 0x03, 0x04 }\n    f := Foo{}\n    buf := bytes.NewBuffer(data)\n    err := binary.Read(buf, binary.LittleEndian, &amp;f)\n</code></pre>\n\n<p>What is the equivalent, taking padding into account?</p>\n"}, {"tags": ["go", "time"], "answers": [{"comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1470224340, "post_id": 38742456, "comment_id": 64858747, "body": "you need to pass that exact string to Forma, because the time package&#39;s reference time is &quot;Mon Jan 2 15:04:05 -0700 MST 2006&quot;"}, {"owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "edited": false, "score": 0, "creation_date": 1470369254, "post_id": 38742456, "comment_id": 64932762, "body": "If I need only month name, then I need to split it again. Thats why I actually think <code>m.String()[:3]</code> this one is less expensive.. up voted"}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "reply_to_user": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "edited": false, "score": 2, "creation_date": 1470375007, "post_id": 38742456, "comment_id": 64934408, "body": "@AerofoilKite If you only need (short) month name then use format string which only returns it, ie <code>fmt.Println(current.Format(&quot;Jan&quot;))</code>, no need to split anything!"}, {"owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "edited": false, "score": 0, "creation_date": 1470393757, "post_id": 38742456, "comment_id": 64944511, "body": "Thank you, I was looking for this solution."}, {"owner": {"reputation": 3585, "user_id": 4332480, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dda076eb310c8a597201a2563d07e0d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nurzhan Nogerbek", "link": "https://stackoverflow.com/users/4332480/nurzhan-nogerbek"}, "edited": false, "score": 0, "creation_date": 1578428734, "post_id": 38742456, "comment_id": 105433397, "body": "How do I return the same response in a specific language?"}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1578429142, "post_id": 38742456, "comment_id": 105433577, "body": "Unfortunately Go doesn&#39;t support this out of the box, maybe some thirdparty lib can do it."}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": true, "score": 8, "last_activity_date": 1470224150, "creation_date": 1470224150, "answer_id": 38742456, "question_id": 38742300, "link": "https://stackoverflow.com/questions/38742300/how-to-get-short-month-name-from-time-now-in-golang/38742456#38742456", "title": "How to get short month name from time.Now() in Golang", "body": "<p>Use the <a href=\"https://golang.org/pkg/time/#Time.Format\" rel=\"noreferrer\">Format</a> function with <code>Jan</code> for short month name, ie</p>\n\n<pre><code>current := time.Now().UTC()\nfmt.Println(current.Format(\"2006 Jan 02\"))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "edited": false, "score": 0, "creation_date": 1470369121, "post_id": 38748698, "comment_id": 64932729, "body": "You are right... I want to use this.. I need only short month name."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 5, "last_activity_date": 1470967988, "last_edit_date": 1470967988, "creation_date": 1470240566, "answer_id": 38748698, "question_id": 38742300, "link": "https://stackoverflow.com/questions/38742300/how-to-get-short-month-name-from-time-now-in-golang/38748698#38748698", "title": "How to get short month name from time.Now() in Golang", "body": "<p>Use <code>time.Now().UTC().Format(\"Jan\")</code> or <code>m.String()[:3]</code> to get short month name: </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>current := time.Now().UTC()\ny, m, d := current.Date()\nfmt.Println(y, m.String()[:3], d)\n</code></pre>\n\n<p>Also you may use <code>fmt.Sprintf(\"%d %s %02d\", t.Year(), t.Month().String()[:3], t.Day())</code><br>\nlike this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\nfunc main() {\n    fmt.Println(time.Now().UTC().Format(\"Jan\")) // Aug\n\n    t := time.Now()\n    str := fmt.Sprintf(\"%d %s %02d\", t.Year(), t.Month().String()[:3], t.Day())\n    fmt.Println(str) // 2016 Aug 03\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>Aug \n2016 Aug 03\n</code></pre>\n"}], "owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5832, "favorite_count": 0, "accepted_answer_id": 38742456, "answer_count": 2, "score": 2, "last_activity_date": 1470967988, "creation_date": 1470223727, "last_edit_date": 1470967871, "question_id": 38742300, "link": "https://stackoverflow.com/questions/38742300/how-to-get-short-month-name-from-time-now-in-golang", "title": "How to get short month name from time.Now() in Golang", "body": "<pre class=\"lang-golang prettyprint-override\"><code>current := time.Now().UTC()\ny, m, d := current.Date()\nfmt.Println(y, m, d)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2009 November 10\n</code></pre>\n\n<p>How can I get short month name? Like:</p>\n\n<pre><code>2009 Nov 10\n</code></pre>\n"}, {"tags": ["go", "system-calls"], "answers": [{"tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 5, "last_activity_date": 1470233353, "last_edit_date": 1470233353, "creation_date": 1470226251, "answer_id": 38743292, "question_id": 38738534, "link": "https://stackoverflow.com/questions/38738534/what-is-the-second-r2-return-value-in-gos-syscall-for/38743292#38743292", "title": "What is the second `r2` return value in Go&#39;s Syscall() for?", "body": "<p>I think they have multiple return values for consistency. As you can see from that table, some architectures return multiple values and if you check a few of the other assembly files from that directory you'll see they move register values to r2.</p>\n\n<hr>\n\n<p>But why DX? This part is still puzzling. Scattered across the web are docs  mentioning on i386 a function is allowed to use both EAX and EDX for return values. For example <a href=\"https://uclibc.org/docs/psABI-i386.pdf\" rel=\"nofollow\">System V Application Binary Interface Intel386 Architecture Processor Supplement</a>:</p>\n\n<blockquote>\n  <p><strong>%edx</strong> scratch register; also used to return the upper 32bits of some\n  64bit return types</p>\n</blockquote>\n\n<p>Later it goes on to say:</p>\n\n<blockquote>\n  <p>The most significant 32 bits are returned in %edx. The least unsigned\n  long long significant 32 bits are returned in %eax.</p>\n</blockquote>\n\n<p>Let's try this:</p>\n\n<pre><code>uint64_t some_function() {\n  return 18446744073709551614LLU;\n}\n</code></pre>\n\n<p>Clang ends up producing:</p>\n\n<pre><code>pushl   %ebp\nmovl    %esp, %ebp\nmovl    $-2, %eax\nmovl    $-1, %edx\npopl    %ebp\nret\n</code></pre>\n\n<p>Interestingly, <a href=\"https://golang.org/src/syscall/asm_linux_amd64.s\" rel=\"nofollow\">asm_linux_amd64.s</a> seems to do the same thing, giving us a pretext to look at the <a href=\"http://www.x86-64.org/documentation/abi.pdf\" rel=\"nofollow\">System V ABI for AMD64</a>. This also doc mentions in passing, about RDX:</p>\n\n<blockquote>\n  <p>used to pass 3rd argument to functions; <strong>2nd return register</strong></p>\n</blockquote>\n\n<p>But Appendix A deals with Linux Conventions specifically.</p>\n\n<blockquote>\n  <p>The interface between the C library and the Linux kernel is the same\n  as for the user-level applications with the following differences:</p>\n  \n  <p>Returning from the syscall, <strong>register %rax contains the result of the\n  system-call.</strong> A value in the range between -4095 and -1 indicates an error,\n  it is -errno.</p>\n</blockquote>\n\n<p>No mention of RDX for the system call.</p>\n\n<hr>\n\n<p>I won't put my hand in the fire for this (or in general) but I suspect taking DX is not necessary for Linux which doesn't make use of such large return values that they spill out of AX.</p>\n"}], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 3, "accepted_answer_id": 38743292, "answer_count": 1, "score": 4, "last_activity_date": 1470233353, "creation_date": 1470213486, "question_id": 38738534, "link": "https://stackoverflow.com/questions/38738534/what-is-the-second-r2-return-value-in-gos-syscall-for", "title": "What is the second `r2` return value in Go&#39;s Syscall() for?", "body": "<p>Here is <a href=\"https://golang.org/pkg/syscall/#Syscall\" rel=\"nofollow\">Go's undocumented Syscall function</a>:</p>\n\n<pre><code>func Syscall(trap, a1, a2, a3 uintptr) (r1, r2 uintptr, err Errno)\n</code></pre>\n\n<p>And here is <a href=\"http://man7.org/linux/man-pages/man2/syscall.2.html\" rel=\"nofollow\">the C definition</a>:</p>\n\n<pre><code>long syscall(long number, ...);\n</code></pre>\n\n<p>Pretty different. So it's fairly obvious that <code>trap</code> is <code>number</code>, and <code>a1</code>, <code>a2</code>, and <code>a3</code> allow for three arguments. I also worked out that <code>r1</code> is the return value, and <code>err</code> is <code>errno</code>. But what is <code>r2</code>? The syscall man page doesn't mention multiple return values.</p>\n\n<p>It does give the actual calling conventions (still only one retval):</p>\n\n<pre><code>       arch/ABI    instruction           syscall #  retval  error    Notes\n       \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n       alpha       callsys               v0         a0      a3       [1]\n       arc         trap0                 r8         r0      -\n       arm/OABI    swi NR                -          a1      -        [2]\n       arm/EABI    swi 0x0               r7         r0      -\n       arm64       svc #0                x8         x0      -\n       blackfin    excpt 0x0             P0         R0      -\n       i386        int $0x80             eax        eax     -\n       ia64        break 0x100000        r15        r8      r10      [1]\n       m68k        trap #0               d0         d0      -\n       microblaze  brki r14,8            r12        r3      -\n       mips        syscall               v0         v0      a3       [1]\n       nios2       trap                  r2         r2      r7\n       parisc      ble 0x100(%sr2, %r0)  r20        r28     -\n       powerpc     sc                    r0         r3      r0       [1]\n       s390        svc 0                 r1         r2      -        [3]\n       s390x       svc 0                 r1         r2      -        [3]\n       superh      trap #0x17            r3         r0      -        [4]\n       sparc/32    t 0x10                g1         o0      psr/csr  [1]\n       sparc/64    t 0x6d                g1         o0      psr/csr  [1]\n       tile        swint1                R10        R00     R01      [1]\n       x86_64      syscall               rax        rax     -        [5]\n       x32         syscall               rax        rax     -        [5]\n       xtensa      syscall               a2         a2      -\n</code></pre>\n\n<p>But on x86 this is <a href=\"https://golang.org/src/syscall/asm_linux_386.s\" rel=\"nofollow\">the implementation</a></p>\n\n<pre><code>    #define INVOKE_SYSCALL  INT $0x80\n\n    TEXT    \u00b7Syscall(SB),NOSPLIT,$0-28\n        CALL    runtime\u00b7entersyscall(SB)\n        MOVL    trap+0(FP), AX  // syscall entry\n        MOVL    a1+4(FP), BX\n        MOVL    a2+8(FP), CX\n        MOVL    a3+12(FP), DX\n        MOVL    $0, SI\n        MOVL    $0,  DI\n        INVOKE_SYSCALL\n        CMPL    AX, $0xfffff001\n        JLS ok\n        MOVL    $-1, r1+16(FP)\n        MOVL    $0, r2+20(FP)\n        NEGL    AX\n        MOVL    AX, err+24(FP)\n        CALL    runtime\u00b7exitsyscall(SB)\n        RET\n    ok:\n        MOVL    AX, r1+16(FP)\n        MOVL    DX, r2+20(FP)\n        MOVL    $0, err+24(FP)\n        CALL    runtime\u00b7exitsyscall(SB)\n        RET\n</code></pre>\n\n<p>Now, I don't read assembly too well, but I'm pretty sure it is returning EDX in r2. Why?</p>\n"}, {"tags": ["function", "go", "struct", "boolean"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1470210019, "post_id": 38736732, "comment_id": 64849427, "body": "Maybe you could take the Tour of Go <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">tour.golang.org</a> once more?"}], "answers": [{"tags": [], "owner": {"reputation": 930, "user_id": 4328963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/505Lz.png?s=128&g=1", "display_name": "huygn", "link": "https://stackoverflow.com/users/4328963/huygn"}, "is_accepted": false, "score": 0, "last_activity_date": 1470208621, "creation_date": 1470208621, "answer_id": 38736871, "question_id": 38736732, "link": "https://stackoverflow.com/questions/38736732/how-to-call-a-function-inside-another-function-in-go-language/38736871#38736871", "title": "How to call a function inside another function in Go language?", "body": "<p>Your defined <code>var isval isvalid</code>, while <code>isvalid</code> is not a known type in Go, instead:</p>\n\n<pre><code>func Possmov(pos Position) {\n\n    var isval bool  // default is false\n\n    if isval == true {\n\n        fmt.Println(\"Something\")\n\n    }\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Ml2PgEOZfV\" rel=\"nofollow\">https://play.golang.org/p/Ml2PgEOZfV</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 3, "last_activity_date": 1470745245, "last_edit_date": 1470745245, "creation_date": 1470208795, "answer_id": 38736929, "question_id": 38736732, "link": "https://stackoverflow.com/questions/38736732/how-to-call-a-function-inside-another-function-in-go-language/38736929#38736929", "title": "How to call a function inside another function in Go language?", "body": "<p>you may call <code>isvalid()</code> like this <code>pos.isvalid()</code> see this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\ntype Position struct {\n    row int\n    col int\n}\n\nfunc (posstn Position) isvalid() bool {\n    if posstn.row &gt; 8 || posstn.row &lt; 0 || posstn.col &gt; 8 || posstn.col &lt; 0 {\n        return false\n    }\n    return true\n}\n\nfunc Possmov(pos Position) {\n    isval := pos.isvalid()\n    if isval == true {\n        fmt.Println(\"Something\")\n    }\n}\nfunc main() {\n    Possmov(Position{1, 7}) //Something\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 376, "user_id": 953837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e809f1b811d369a2ff190f45115ed893?s=128&d=identicon&r=PG", "display_name": "Gov", "link": "https://stackoverflow.com/users/953837/gov"}, "is_accepted": false, "score": 1, "last_activity_date": 1470210931, "creation_date": 1470210931, "answer_id": 38737629, "question_id": 38736732, "link": "https://stackoverflow.com/questions/38736732/how-to-call-a-function-inside-another-function-in-go-language/38737629#38737629", "title": "How to call a function inside another function in Go language?", "body": "<p>Your first line in function <code>Possmov(pos Position){...}</code> i.e. <code>var isval isvalid</code> is actually attempting to declare a variable of type <code>isvalid</code> (which is undefined as described by the error)</p>\n\n<p>Instead your <code>isvalid()</code> method is declared on the <code>Position</code> type.</p>\n\n<p>Try: <code>var isvalid = pos.isvalid()</code> in it's place</p>\n"}], "owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5356, "favorite_count": 0, "accepted_answer_id": 38736929, "answer_count": 3, "score": 1, "last_activity_date": 1470745245, "creation_date": 1470208212, "last_edit_date": 1470745219, "question_id": 38736732, "link": "https://stackoverflow.com/questions/38736732/how-to-call-a-function-inside-another-function-in-go-language", "title": "How to call a function inside another function in Go language?", "body": "<p>I'm getting an error saying \"undefined isvalid\". How do I call another function in a function?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\ntype Position struct {\n    row int\n    col int\n}\n\nfunc (posstn Position) isvalid() bool {\n    if posstn.row &gt; 8 || posstn.row &lt; 0 || posstn.col &gt; 8 || posstn.col &lt; 0 {\n        return false\n    }\n    return true\n}\n\nfunc Possmov(pos Position) {\n    var isval isvalid\n    if isval == true {\n        fmt.Println(\"Something\")\n    }\n}\n\nfunc main() {\n    Possmov(Position{1, 7})\n}\n</code></pre>\n"}, {"tags": ["go", "storage", "distributed-computing", "api-design", "server-communication"], "comments": [{"owner": {"reputation": 5260, "user_id": 668929, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ca58d0a4a10ea07fabd4e4d32968982?s=128&d=identicon&r=PG", "display_name": "Dhanush Gopinath", "link": "https://stackoverflow.com/users/668929/dhanush-gopinath"}, "edited": false, "score": 0, "creation_date": 1470203617, "post_id": 38734757, "comment_id": 64846187, "body": "You can send some kind of a token from the Frontend Server to authenticate that the request is from the correct server."}, {"owner": {"reputation": 13, "user_id": 5022755, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2tk7u9LowDw/AAAAAAAAAAI/AAAAAAAAABo/KEZV92L45hk/photo.jpg?sz=128", "display_name": "Benjamin Radovsky", "link": "https://stackoverflow.com/users/5022755/benjamin-radovsky"}, "reply_to_user": {"reputation": 5260, "user_id": 668929, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ca58d0a4a10ea07fabd4e4d32968982?s=128&d=identicon&r=PG", "display_name": "Dhanush Gopinath", "link": "https://stackoverflow.com/users/668929/dhanush-gopinath"}, "edited": false, "score": 0, "creation_date": 1470206318, "post_id": 38734757, "comment_id": 64847498, "body": "Hey @DhanushGopinath, thanks for your reply. I&#39;ve previously created a session that creates a CSRF token which gets validated on the storage server&#39;s side over the same client&#39;s session, but would it be better, for example, to create a token and send it over tcp before I pass along the actual request, wait for an ACK containing the correct token from the storage server, and only then if it&#39;s correct, proxy the file upload request?"}, {"owner": {"reputation": 5260, "user_id": 668929, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ca58d0a4a10ea07fabd4e4d32968982?s=128&d=identicon&r=PG", "display_name": "Dhanush Gopinath", "link": "https://stackoverflow.com/users/668929/dhanush-gopinath"}, "edited": false, "score": 0, "creation_date": 1470211619, "post_id": 38734757, "comment_id": 64850355, "body": "I do it the first way you mentioned. And I wrote an HTTP Handler to authenticate it and only if it is valid I pass the request to the actual handler. The second method also should be fine, except that fact that each call will need to send 2 requests every time."}, {"owner": {"reputation": 3010, "user_id": 519557, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/x9V4f.jpg?s=128&g=1", "display_name": "jxstanford", "link": "https://stackoverflow.com/users/519557/jxstanford"}, "edited": false, "score": 0, "creation_date": 1470234296, "post_id": 38734757, "comment_id": 64866393, "body": "Do you control the storage server or is it a 3rd party service? Does it need to be exposed to someone who could make a direct call to it?  A little more detail about the deployment would be helpful to the question."}, {"owner": {"reputation": 13, "user_id": 5022755, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2tk7u9LowDw/AAAAAAAAAAI/AAAAAAAAABo/KEZV92L45hk/photo.jpg?sz=128", "display_name": "Benjamin Radovsky", "link": "https://stackoverflow.com/users/5022755/benjamin-radovsky"}, "reply_to_user": {"reputation": 3010, "user_id": 519557, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/x9V4f.jpg?s=128&g=1", "display_name": "jxstanford", "link": "https://stackoverflow.com/users/519557/jxstanford"}, "edited": false, "score": 0, "creation_date": 1470274407, "post_id": 38734757, "comment_id": 64886846, "body": "Hey @jxstanford, I do control the storage server/s. I&#39;m new to distributed computing so not sure about any best practices. The storage servers don&#39;t have to be exposed, but I&#39;m not sure how I would go about blocking it off from requests other than from my own servers. Sorry about all of this being quite vague, it&#39;s all more of a learning challenge, trying to build scalable applications that scale well."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5022755, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2tk7u9LowDw/AAAAAAAAAAI/AAAAAAAAABo/KEZV92L45hk/photo.jpg?sz=128", "display_name": "Benjamin Radovsky", "link": "https://stackoverflow.com/users/5022755/benjamin-radovsky"}, "edited": false, "score": 0, "creation_date": 1470483804, "post_id": 38782446, "comment_id": 64976553, "body": "Hey @Virgo, thanks for the comment! I&#39;ve already implemented CSRF prevention over sessions since the storage server is being sent it&#39;s data through a form, but I&#39;ve considered the idea previously to use IP whitelisting so I might give that a go as well! Great suggestions, much appreciated!"}], "tags": [], "owner": {"reputation": 518, "user_id": 1874590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5a8ce12d2853a306e6ca64e3b7ec011?s=128&d=identicon&r=PG", "display_name": "Virgo_The_Perfectionist", "link": "https://stackoverflow.com/users/1874590/virgo-the-perfectionist"}, "is_accepted": true, "score": 1, "last_activity_date": 1470378114, "creation_date": 1470378114, "answer_id": 38782446, "question_id": 38734757, "link": "https://stackoverflow.com/questions/38734757/how-to-verify-server-to-server-communication/38782446#38782446", "title": "How to Verify server to server communication", "body": "<p>There are multiple ways to do it:</p>\n\n<ol>\n<li>you can use a API Gateway (e.g. APIGEE, AWS AI Gateway etc). Gateway can do request origin validation.</li>\n<li>You can let front end app to use OAuth (for storage server) and use\nthat to get authenticated/authorized at storage server</li>\n<li>You can do IP whitelisting between servers &amp; allow a restricted set of IPs in source</li>\n<li>You can use MASSL (Mutual Authenthicated SSL) b/w servers to make sure only clients which are verified access your API (may be not for your problem directly but can be used with combination)</li>\n</ol>\n\n<p>These are the simple options if you don't need a complicated or more expensive solution.</p>\n"}], "owner": {"reputation": 13, "user_id": 5022755, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2tk7u9LowDw/AAAAAAAAAAI/AAAAAAAAABo/KEZV92L45hk/photo.jpg?sz=128", "display_name": "Benjamin Radovsky", "link": "https://stackoverflow.com/users/5022755/benjamin-radovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "accepted_answer_id": 38782446, "answer_count": 1, "score": 1, "last_activity_date": 1470378114, "creation_date": 1470200561, "last_edit_date": 1470200680, "question_id": 38734757, "link": "https://stackoverflow.com/questions/38734757/how-to-verify-server-to-server-communication", "title": "How to Verify server to server communication", "body": "<p>I'm having a few problems trying to decide what would be the best solution for something I'm trying to build.</p>\n\n<p>In the applications simplest form, I have a front end server which allows users to upload files which become associated with their account, for example a video or image. The upload file form posts the upload request to the front end server, which then uses a reverse proxy to pass the request directly along to a storage server's API (<a href=\"https://www.example.com/users/username/upload\" rel=\"nofollow\">https://www.example.com/users/username/upload</a>).</p>\n\n<p>What I'm currently stuck on, is trying to work out what the best way to verify that the request being received at the storage servers API is actually being sent from the reverse proxy from the front end server, as opposed to somebody just sending a direct post request to the storage server's API endpoint.</p>\n\n<p>Any suggestions would be really appreciated!</p>\n"}, {"tags": ["go", "composition"], "answers": [{"comments": [{"owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "edited": false, "score": 0, "creation_date": 1470443902, "post_id": 38747783, "comment_id": 64969017, "body": "Hmm, I understand why you suggest not having the set methods in the interface but my goal is to pass the interfaces around and allow set calls directly on them. The reason I ask the question is because it might lead to big interfaces, which I&#39;ve seen as something to watch out for and not do."}, {"owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "edited": false, "score": 0, "creation_date": 1470443994, "post_id": 38747783, "comment_id": 64969037, "body": "That&#39;s also why I have the methods listed as returning Weird interfaces. I want to worry about the actual implementors at construction time, but after that it would all be done through the interface."}, {"owner": {"reputation": 3010, "user_id": 519557, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/x9V4f.jpg?s=128&g=1", "display_name": "jxstanford", "link": "https://stackoverflow.com/users/519557/jxstanford"}, "reply_to_user": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "edited": false, "score": 0, "creation_date": 1470447241, "post_id": 38747783, "comment_id": 64969567, "body": "I see.  Unfortunately, I can&#39;t say whether what you&#39;re doing is idiomatic or not, but I&#39;d say if it solves your problem, go for it :-)"}], "tags": [], "owner": {"reputation": 3010, "user_id": 519557, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/x9V4f.jpg?s=128&g=1", "display_name": "jxstanford", "link": "https://stackoverflow.com/users/519557/jxstanford"}, "is_accepted": true, "score": 1, "last_activity_date": 1470238286, "last_edit_date": 1470238286, "creation_date": 1470237978, "answer_id": 38747783, "question_id": 38734487, "link": "https://stackoverflow.com/questions/38734487/is-my-approach-to-composability-idiomatic-for-go/38747783#38747783", "title": "Is my approach to composability idiomatic for Go?", "body": "<p>I'm not sure about idiomatic, but I think you've effectively used interfaces, structures and constructor methods to achieve your goal.  Here are a few things you might change if it suits you.</p>\n\n<p>1) Let the implementations deal with the setters.  </p>\n\n<pre><code>//An interface\ntype Weird interface {\n    Name() string\n\n    Age() int\n}\n</code></pre>\n\n<p>Implementers could choose to implement a SetName or SetAge, but they could just as well initialize with values or assign directly to the structure.  For good or bad, the business rules about min/max age, etc. are not enforceable by the interface, so the interface methods seems like extra code to me.</p>\n\n<p>2) Create an Admin interface, though you haven't really defined any unique behavior of Admins in your example:</p>\n\n<pre><code>type Admin interface {\n    Weird\n    SomeAdminMethod() string\n}\n</code></pre>\n\n<p>3) Your use of the interface as the return value for all of the New* functions is a bit confusing to me. It seems like that would be more suited to a single NewWeird function like:</p>\n\n<pre><code>func NewWeird(flavor string) (Weird, error) {\n    switch flavor {\n    case \"regular\":\n        return &amp;RegularWeird{Weird: &amp;SimpleWeird{}}, nil\n    case \"admin\":\n        return &amp;AdminWeird{Weird: &amp;SimpleWeird{}}, nil\n    case \"regularadmin\":\n        return &amp;RegularWeird{Weird: &amp;NewWeird(regular)}, nil\n    case default:\n        return nil, errors.Error(\"unknown weird type\")\n    }\n}\n</code></pre>\n\n<p>The use of the interface as the return is handy if you want to initialize a bunch of heterogeneous Weirds and stuff them into a <code>[]Weird</code> or something like that.  </p>\n\n<p>Hope it helps...</p>\n"}], "owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 38747783, "answer_count": 1, "score": 0, "last_activity_date": 1470238286, "creation_date": 1470198864, "question_id": 38734487, "link": "https://stackoverflow.com/questions/38734487/is-my-approach-to-composability-idiomatic-for-go", "title": "Is my approach to composability idiomatic for Go?", "body": "<p>I created this in the playground: <a href=\"https://play.golang.org/p/Jj4UhA8Yn7\" rel=\"nofollow\">https://play.golang.org/p/Jj4UhA8Yn7</a></p>\n\n<p>I'll paste the code below as well.</p>\n\n<p>The question revolves around whether my approach on composability is something I should consider as viable, good Go code, or if I'm thinking about it incorrectly and should consider something more in line with idiomatic Go. </p>\n\n<p>My goal is to use this pattern to create \"logic\" tiers that decorate the underlying layer with additional logic that the wrapped layer should not need to know about.</p>\n\n<p>As a cursory example I might have these \"layers\"</p>\n\n<ol>\n<li>interface layer - a set of interfaces that define the \"model\"</li>\n<li>simple struct layer - just holds data from the database meets the interfaces above</li>\n<li>validation layer - wraps around an interface from the interface layer and validates incoming data against some validation rules before it then forwards the method calls to the wrapped layer below. It also meets the same interface as the layer it is wrapping.</li>\n<li>translation layer - same as number 3, translates any text being accessed by first calling the layer it is wrapping, then translates the text, and returns the translated text. it will meet the same interface of the object it wraps. Any methods unrelated to getting info will be forwarded to the underlying layer transparently.</li>\n</ol>\n\n<p>I hope I've made myself somewhat clear and that the example code below will help illustrate it better than my words above. </p>\n\n<h2>The example code from the playgroud</h2>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n)\n\n//An interface\ntype Weird interface {\n    Name() string\n    SetName(name string) error\n\n    Age() int\n    SetAge(age int) error\n}\n\n//Simple struct to hold data\ntype SimpleWeird struct {\n    name string\n    age  int\n}\n\nfunc (s *SimpleWeird) Name() string {\n    return s.name\n}\n\nfunc (s *SimpleWeird) SetName(name string) error {\n    s.name = name\n    return nil\n}\n\nfunc (s *SimpleWeird) Age() int {\n    return s.age\n}\n\nfunc (s *SimpleWeird) SetAge(age int) error {\n    s.age = age\n    return nil\n}\n\n//RegularWeird encapsulates some \"business\" logic within it's methods\n//and would be considered normal logic flow\ntype RegularWeird struct {\n    Weird\n}\n\nfunc (r *RegularWeird) SetName(name string) error {\n    if len(name) &gt; 5 {\n        return errors.New(\"Regulars can't set a name longer than 5 characters long\")\n    }\n    return r.Weird.SetName(name)\n}\n\nfunc (r *RegularWeird) SetAge(age int) error {\n    if age &gt; 80 {\n        return errors.New(\"Regulars can't set an age above 80\")\n    }\n\n    return r.Weird.SetAge(age)\n}\n\n//AdminWeird encapsulates some admin \"business\" logic within it's methods\n//It would be considered admin logic flow/rules\ntype AdminWeird struct {\n    Weird\n}\n\n//AdminWeirds don't have their own SetName. If they\n//Wrap a SimpleWeird then any name size is allowed (desired behavior)\n//If the wrap a regular weird then the regular weird's logic is enforced\n\nfunc (a *AdminWeird) SetAge(age int) error {\n    if age &gt; 100 {\n        return errors.New(\"Admins can't set an age above 100\")\n    }\n    return nil\n}\n\nfunc NewAdminWeird() Weird {\n    return &amp;AdminWeird{Weird: &amp;SimpleWeird{}}\n}\n\nfunc NewRegularWeird() Weird {\n    return &amp;RegularWeird{Weird: &amp;SimpleWeird{}}\n}\n\n//This one doesn't make sense for this example but I wanted to show\n//the composability aspect of this. I would be creating chainable\n//interfaces that each handle different unrelated logic\nfunc NewAdminRegularWeird() Weird {\n    return &amp;AdminWeird{Weird: NewRegularWeird()}\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n\nfunc main() {\n    var err error\n\n    r := NewRegularWeird()\n    a := NewAdminWeird()\n    ar := NewAdminRegularWeird()\n\n    fmt.Println(\"Regular output:\")\n    err = r.SetName(\"test\")\n    checkErr(err)\n\n    err = r.SetAge(5)\n    checkErr(err)\n\n    err = r.SetName(\"something-longer\")\n    checkErr(err)\n\n    err = r.SetAge(90)\n    checkErr(err)\n\n    fmt.Println(\"Admin output:\")\n    err = a.SetName(\"test\")\n    checkErr(err)\n\n    err = a.SetAge(5)\n    checkErr(err)\n\n    err = a.SetName(\"something-longer\")\n    checkErr(err)\n\n    err = a.SetAge(101)\n    checkErr(err)\n\n    fmt.Println(\"AdminRegular output:\")\n    err = ar.SetName(\"test\")\n    checkErr(err)\n\n    err = ar.SetAge(5)\n    checkErr(err)\n\n    err = ar.SetName(\"something-longer\")\n    checkErr(err)\n\n    err = ar.SetAge(90)\n    checkErr(err)\n\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 2486, "user_id": 4273915, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9d9e188b62e9e3e3438781ececc8dd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Shrabanee", "link": "https://stackoverflow.com/users/4273915/shrabanee"}, "edited": false, "score": 0, "creation_date": 1470203400, "post_id": 38734485, "comment_id": 64846099, "body": "You want to remove` teachers` array along with <code>$pull</code> operation in one query or using two queries?"}, {"owner": {"reputation": 711, "user_id": 6178021, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vhabx.jpg?s=128&g=1", "display_name": "Tanmay Garg", "link": "https://stackoverflow.com/users/6178021/tanmay-garg"}, "reply_to_user": {"reputation": 2486, "user_id": 4273915, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9d9e188b62e9e3e3438781ececc8dd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Shrabanee", "link": "https://stackoverflow.com/users/4273915/shrabanee"}, "edited": false, "score": 0, "creation_date": 1470203965, "post_id": 38734485, "comment_id": 64846333, "body": "I need a way in <code>mgo</code> to find out that right after a remove function, the <code>teachers</code> array of that particular sectionid (on which the remove operation was carried out) is empty or not. Maybe a function that <code>mgo</code> provides with, which I can use to determine the size of the array, and if the size returned is 0, I can call an <code>$unset</code> (once again, using mgo). But, if existing, some other more elegant solution is welcome too :)"}], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 6178021, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vhabx.jpg?s=128&g=1", "display_name": "Tanmay Garg", "link": "https://stackoverflow.com/users/6178021/tanmay-garg"}, "edited": false, "score": 1, "creation_date": 1470215047, "post_id": 38738529, "comment_id": 64852569, "body": "Thanks, this is what I was looking for."}], "tags": [], "owner": {"reputation": 87200, "user_id": 122005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MX2CF.jpg?s=128&g=1", "display_name": "chridam", "link": "https://stackoverflow.com/users/122005/chridam"}, "is_accepted": true, "score": 1, "last_activity_date": 1470213474, "creation_date": 1470213474, "answer_id": 38738529, "question_id": 38734485, "link": "https://stackoverflow.com/questions/38734485/count-number-of-elements-in-an-array/38738529#38738529", "title": "Count number of elements in an array", "body": "<p>Would suggest using the <strong><a href=\"https://docs.mongodb.com/manual/reference/method/db.collection.findAndModify/\" rel=\"nofollow\"><code>findAndModify()</code></a></strong> API to do the <strong><a href=\"https://docs.mongodb.com/manual/reference/operator/update/pull/\" rel=\"nofollow\"><code>$pull</code></a></strong> update operation first, this will return the modified document which you can then access the teachers array for checking. Once you check for array emptiness, you can then issue another update operation that calls the <strong><a href=\"https://docs.mongodb.com/manual/reference/operator/update/unset/\" rel=\"nofollow\"><code>$unset</code></a></strong> operator on the teachers field if the array key has zero elements.</p>\n\n<p>A canonical example in mongo shell follows:</p>\n\n<pre><code>change = db.section.findAndModify({\n    query: { \"sectionid\": \"BTE4D\", \"teachers.facultyid\": \"CS-102\" },\n    update: { \"$pull\": { \"teachers\": { \"facultyid\" : \"CS-102\" } } },\n    new: true\n});\n\nprintjson(change);\n\nif (!change.teachers[0]) {\n     db.section.update(\n        { \"_id\": change._id },\n        { \"$unset\": { \"teachers\": \"\" } }\n    );\n}\n\ndb.section.find({ \"_id\": change._id })\n</code></pre>\n\n<hr>\n\n<p>Implementing this with mgo, you would need the <strong><a href=\"https://godoc.org/labix.org/v2/mgo#Query.Apply\" rel=\"nofollow\"><code>Query.Apply</code></a></strong> method which essentially wraps the <strong><a href=\"https://docs.mongodb.com/manual/reference/command/findAndModify/#dbcmd.findAndModify\" rel=\"nofollow\"><code>findAndModify</code></a></strong> MongoDB command</p>\n\n<pre><code>change := mgo.Change{\n        Update: bson.M{\"$pull\": bson.M{\"teachers\": bson.M{\"facultyid\": \"CS-102\"}}},\n        ReturnNew: true,\n}\ninfo, err = col.Find(M{\"sectionid\": \"BTE4D\"}).Apply(change, &amp;doc)\nfmt.Println(doc.N)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1176, "user_id": 6376725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u8lK1.png?s=128&g=1", "display_name": "Andriy Simonov", "link": "https://stackoverflow.com/users/6376725/andriy-simonov"}, "is_accepted": false, "score": 1, "last_activity_date": 1470216586, "last_edit_date": 1470216586, "creation_date": 1470213720, "answer_id": 38738624, "question_id": 38734485, "link": "https://stackoverflow.com/questions/38734485/count-number-of-elements-in-an-array/38738624#38738624", "title": "Count number of elements in an array", "body": "<p>To differentiate empty arrays from non-empty you can use the find command with the <a href=\"https://docs.mongodb.com/manual/reference/operator/query/size/\" rel=\"nofollow\">$size</a> operator.</p>\n\n<p>If you choose to remove empty arrays you can issue $pull operator with MongoDB <a href=\"https://docs.mongodb.com/manual/reference/method/db.collection.findAndModify/\" rel=\"nofollow\">findAndModify</a> (refer the mgo <a href=\"https://godoc.org/labix.org/v2/mgo#Query.Apply\" rel=\"nofollow\">documentation</a> for more details) which can atomically return modified document, check if the array is empty and unset it with another query.</p>\n"}], "owner": {"reputation": 711, "user_id": 6178021, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vhabx.jpg?s=128&g=1", "display_name": "Tanmay Garg", "link": "https://stackoverflow.com/users/6178021/tanmay-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 38738529, "answer_count": 2, "score": 2, "last_activity_date": 1470216586, "creation_date": 1470198854, "last_edit_date": 1470199935, "question_id": 38734485, "link": "https://stackoverflow.com/questions/38734485/count-number-of-elements-in-an-array", "title": "Count number of elements in an array", "body": "<p>I am creating an application, and it has a function which removes elements from an array inside a document in a MongoDB collection.</p>\n\n<p>I need a way to unset the array's field as soon as the array becomes empty right after a remove operation. I need to do this so that I can differentiate between a document that has a non-empty array, and a document that has an empty array.</p>\n\n<p>For example, right now my <code>section</code> collection looks like:</p>\n\n<pre><code>db.section.find({})\n\n{ \"_id\" : ObjectId(\"57a0a38ad1c6ef24376477c5\"), \"sectionid\" : \"BTE4B\", \n \"sectionname\" : \"BTech 4B\", \"year\" : 4,\n \"session\" : 2016, \"courseid\" : \"BTE-CS\", \"password\" : \"pm8xTE0-\",\n \"students\" : 35, \"addedon\" : \"2016-08-02 19:13:38\", \"teachers\" : [ ] }\n\n { \"_id\" : ObjectId(\"57a0a96bd1c6ef24376477cd\"), \"sectionid\" : \"BTE4D\",\n \"sectionname\" : \"BTech 4D\", \"year\" : 4, \"session\" : 2016, \"courseid\" :\n \"BTE-CS\", \"password\" : \"sHhKr0Ov\", \"students\" : 41, \"addedon\" :\n \"2016-08-02 19:38:43\", \"teachers\" : [ { \"facultyid\" : \"CS-102\",\n \"subjectid\" : \"CS-ALGO\" } ] }\n</code></pre>\n\n<p>I had applied a <em>$pull</em> operation using <em>mgo</em> on the <code>teachers</code> array of the first document, but I need a way to <code>$unset</code> it when it becomes empty.</p>\n\n<p>Currently, I have managed to create a workaround in Go, but I would like to get away without any workarounds.</p>\n\n<p>I hope I am not missing something very trivial here.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["mongodb", "go", "struct", "mgo", "revel"], "comments": [{"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1470202819, "post_id": 38734244, "comment_id": 64845879, "body": "Also, please do not ignore errors.  Collection(s).Find(bson.M{}).All(&amp;results) should check for the returned value ( type error ) to be nil.  <a href=\"https://blog.golang.org/error-handling-and-go\" rel=\"nofollow noreferrer\">blog.golang.org/error-handling-and-go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1470201273, "post_id": 38734395, "comment_id": 64845250, "body": "This - type Category struct { \tListName string      <code>bson:&quot;listName&quot;</code> \tSlug string              <code>bson:&quot;slug&quot;</code> } Returns this - {     &quot;ListName&quot;: &quot;Trimmer/Epilator&quot;,     &quot;Slug&quot;: &quot;trimmer&quot;   },  Whereas, this -  type Category struct { \tListName string      <code>json:&quot;listName&quot;</code> \tSlug string              <code>json:&quot;slug&quot;</code> } Returns this -  {&quot;listName&quot;: &quot;&quot;,     &quot;slug&quot;: &quot;trimmer&quot;   }, Which is actually closer to what I&#39;d want. I want the field names to be there in the json just as they are."}, {"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "reply_to_user": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1470202158, "post_id": 38734395, "comment_id": 64845619, "body": "add <code>bson:&quot;listName&quot; json:&quot;listName&quot;</code>"}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1470202469, "post_id": 38734395, "comment_id": 64845749, "body": "Please include this in the answer and I can mark it as correct! You&#39;re awesome!"}], "tags": [], "owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "is_accepted": true, "score": 1, "last_activity_date": 1470202554, "last_edit_date": 1470202554, "creation_date": 1470198303, "answer_id": 38734395, "question_id": 38734244, "link": "https://stackoverflow.com/questions/38734244/golang-revelmgo-no-data-returned-when-struct-variables-having-lowercase-names/38734395#38734395", "title": "Golang revel+mgo - no data returned when struct variables having lowercase names", "body": "<p>You need to make your fields visible for <a href=\"https://godoc.org/labix.org/v2/mgo/bson#Unmarshal\" rel=\"nofollow\">mgos bson Unmarshall</a> by naming them with a starting capital letter. You also need to map to the appropiates json/bson field names</p>\n\n<pre><code>type Category struct {\n    ListName string      `json:\"listName\" bson:\"listName\"`\n    Slug string          `json:\"slug\"     bson:\"slug\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 38734395, "answer_count": 1, "score": 1, "last_activity_date": 1470202554, "creation_date": 1470197367, "last_edit_date": 1470201460, "question_id": 38734244, "link": "https://stackoverflow.com/questions/38734244/golang-revelmgo-no-data-returned-when-struct-variables-having-lowercase-names", "title": "Golang revel+mgo - no data returned when struct variables having lowercase names", "body": "<p>This is my struct type</p>\n\n<pre><code>type Category struct {\n    Name string     `bson:\"listName\"`\n    Slug string     `bson:\"slug\"`\n}\n</code></pre>\n\n<p>used with the following function to return all results from a mongo collection -</p>\n\n<pre><code>func GetCategories(s *mgo.Session) []Category {\n    var results []Category\n    Collection(s).Find(bson.M{}).All(&amp;results)\n    return results\n}\n</code></pre>\n\n<p>The problem is that the field names in my db have names starting in lowercase but the Golang struct returns null when I try to use variable names starting with lower case. For e.g. this returns a JSON with corresponding fields empty -</p>\n\n<pre><code>type Category struct {\n    listName string `bson:\"listName\"`\n    slug string     `bson:\"slug\"`\n}\n</code></pre>\n\n<p>I'm actually porting a Meteor based API to Golang and a lot of products currently using the API rely on those field names like they are in the db!\nIs there a workaround?</p>\n"}, {"tags": ["arrays", "function", "go", "struct", "parameters"], "answers": [{"tags": [], "owner": {"reputation": 930, "user_id": 4328963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/505Lz.png?s=128&g=1", "display_name": "huygn", "link": "https://stackoverflow.com/users/4328963/huygn"}, "is_accepted": true, "score": 3, "last_activity_date": 1471088188, "last_edit_date": 1471088188, "creation_date": 1470194653, "answer_id": 38733844, "question_id": 38733650, "link": "https://stackoverflow.com/questions/38733650/passing-struct-array-elements-as-parameters-to-a-function-in-go-language/38733844#38733844", "title": "Passing Struct array elements as parameters to a function in Go language", "body": "<p>Simply do</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type rowcol struct {\n    row int\n    col int\n}\n\nfunc possiblemoves(rc []rowcol) {}\n\nfunc main() {\n    rc := []rowcol{\n        rowcol{1, 2},\n        rowcol{3, 4},\n    }\n    possiblemoves(rc)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/dQ1edTJNhq\" rel=\"nofollow\">https://play.golang.org/p/dQ1edTJNhq</a></p>\n\n<p><code>[]rowcol</code> is a slice of <code>rowcol</code> structs. Then you use <code>rc[1].row</code> and <code>rc[1].col</code> to access these struct fields.</p>\n"}], "owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 38733844, "answer_count": 1, "score": 0, "last_activity_date": 1471088188, "creation_date": 1470193019, "last_edit_date": 1471088159, "question_id": 38733650, "link": "https://stackoverflow.com/questions/38733650/passing-struct-array-elements-as-parameters-to-a-function-in-go-language", "title": "Passing Struct array elements as parameters to a function in Go language", "body": "<p>I have defined a function <code>possiblemoves()</code>, that takes in two integers as parameters, but later I want this function to make a call to all the elements in <code>Struct array</code> recursively\nI didn't put the terminating condition yet, I will do it once I finish it</p>\n\n<p>Code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\n/*type node struct{\n     prev node\n     current node\n      Next [64] int\n}*/\ntype rowcol struct {\n    row int\n    col int\n}\n\nfunc main() {\n    possiblemoves(1, 5)\n}\nfunc possiblemoves(row int, col int) {\n    var c [8]rowcol\n    var a [16]int\n\n    a[0] = row + 1\n    a[1] = col - 2\n    a[2] = row - 1\n    a[3] = col + 2\n    a[4] = row + 1\n    a[5] = col + 2\n    a[6] = row - 1\n    a[7] = col - 2\n    a[8] = row - 2\n    a[9] = col + 1\n    a[10] = row - 2\n    a[11] = col - 1\n    a[12] = row + 2\n    a[13] = col - 1\n    a[14] = row + 2\n    a[15] = col + 1\n\n    for i := 0; i &lt; len(a); i++ {\n        if a[i] &lt;= 0 {\n            a[i] = 0\n        }\n        fmt.Println(a[i])\n    }\n\n    c[0] = rowcol{a[0], a[1]}\n    c[1] = rowcol{a[2], a[3]}\n    c[2] = rowcol{a[4], a[5]}\n    c[3] = rowcol{a[6], a[7]}\n    c[4] = rowcol{a[8], a[9]}\n    c[5] = rowcol{a[10], a[11]}\n    c[6] = rowcol{a[12], a[13]}\n    c[7] = rowcol{a[14], a[15]}\n\n    for j := 0; j &lt; len(c); j++ {\n        {\n            possiblemoves(c[j])\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 3481111, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/UkbLs.jpg?s=128&g=1", "display_name": "Paulo Janeiro", "link": "https://stackoverflow.com/users/3481111/paulo-janeiro"}, "edited": false, "score": 0, "creation_date": 1470183488, "post_id": 38732423, "comment_id": 64840915, "body": "Yes. I changed the title to make my question clearer: how to make it work outside. Thanks!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2871, "user_id": 3481111, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/UkbLs.jpg?s=128&g=1", "display_name": "Paulo Janeiro", "link": "https://stackoverflow.com/users/3481111/paulo-janeiro"}, "edited": false, "score": 0, "creation_date": 1470183601, "post_id": 38732423, "comment_id": 64840943, "body": "@PauloJaneiro See edited answer: simply call the function, so it will return you the value."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1470185179, "last_edit_date": 1470185179, "creation_date": 1470183367, "answer_id": 38732423, "question_id": 38732390, "link": "https://stackoverflow.com/questions/38732390/how-to-make-a-return-variable-not-undefined-outside-the-function/38732423#38732423", "title": "How to make a return variable not undefined outside the function", "body": "<p>Return variables \u2013just like normal parameters and method receivers\u2013 are scoped to the function body.</p>\n\n<p>Mentioned in the spec: <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow\">Declarations and Scope:</a></p>\n\n<blockquote>\n  <p>The scope of an identifier denoting a method receiver, function parameter, or result variable is the function body.</p>\n</blockquote>\n\n<p>Outside the function they are not in scope, you can't refer to them.</p>\n\n<p>In your case the very simple fix is that you have to call the function, and what it returns, you can use it (you can pass it along, assign it to a variable etc.):</p>\n\n<pre><code>var Templates = template.Must(template.ParseFiles(ExtractFileNames()...))\n</code></pre>\n\n<p>One thing to note here is the <code>...</code> called the <em>ellipsis</em>. It is required because <code>ExtractFileNames()</code> returns a slice, but <a href=\"https://golang.org/pkg/html/template/#ParseFiles\" rel=\"nofollow\"><code>template.ParseFiles()</code></a> has a variadic parameter:</p>\n\n<pre><code>func ParseFiles(filenames ...string) (*Template, error)\n</code></pre>\n\n<p>So that <code>...</code> will tell the compiler that you want to pass the slice \"exploded\", as the value for the variadic parameter (and not for example a single element in the variadic list...). More on this in the spec: <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow\">Passing arguments to ... parameters</a></p>\n"}], "owner": {"reputation": 2871, "user_id": 3481111, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/UkbLs.jpg?s=128&g=1", "display_name": "Paulo Janeiro", "link": "https://stackoverflow.com/users/3481111/paulo-janeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 38732423, "answer_count": 1, "score": 2, "last_activity_date": 1480016521, "creation_date": 1470183145, "last_edit_date": 1480016521, "question_id": 38732390, "link": "https://stackoverflow.com/questions/38732390/how-to-make-a-return-variable-not-undefined-outside-the-function", "title": "How to make a return variable not undefined outside the function", "body": "<p>I'm new to Go and trying to make some proof of concept. As such, I would like to pass my template file names to the <code>template.ParseFiles</code>, like this:</p>\n\n<pre><code>var Templates = template.Must(template.ParseFiles(\"views/edit.html\", \"views/view.html\", \"views/main.html\"))\n</code></pre>\n\n<p>To do it dynamically I'm trying to do:</p>\n\n<pre><code>func ExtractFileNames () (templateFileNames []string) {\n    files, _ := ioutil.ReadDir(\"./views\")\n    for _, f := range files {\n        if strings.Contains(f.Name(), \".html\") {   \n           templateFileNames=append(templateFileNames, \"views/\" + f.Name())\n        }\n    }\n    return templateFileNames\n}\n\nvar Templates = template.Must(template.ParseFiles(templateFileNames))\n</code></pre>\n\n<p>The function is working OK except that I'm getting an error:</p>\n\n<pre><code>undefined: templateFileNames\n</code></pre>\n\n<p>This is making think that maybe I'm not using the best approach to this problem.</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 5, "creation_date": 1470176997, "post_id": 38731467, "comment_id": 64839247, "body": "The Go Tutorial will cover this for you."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 4, "creation_date": 1470177046, "post_id": 38731467, "comment_id": 64839265, "body": "an array and a pointer are just plain not the same type, or convertible types, in Go. What you probably really want is a slice, which is like a view on an array."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1470177943, "post_id": 38731467, "comment_id": 64839564, "body": "Try this: <a href=\"https://gobyexample.com/\" rel=\"nofollow noreferrer\">gobyexample.com</a>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1470180121, "post_id": 38731467, "comment_id": 64840153, "body": "To reinforce other comments, you most likely want a slice. A slice is very little more than a pointer to the beginning of an array and what gets passed in would just be that lightweight struct. I believe the correct term for this struct is the &#39;slice header&#39; and it consists of; an int for the length, an int for capacity and a pointer to the underlying array."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4941530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/637KS.jpg?s=128&g=1", "display_name": "Luke Miles", "link": "https://stackoverflow.com/users/4941530/luke-miles"}, "edited": false, "score": 6, "creation_date": 1553272236, "post_id": 38732782, "comment_id": 97336486, "body": "Technically, slices are passed by value, but their value is just a length and a pointer to an array."}, {"owner": {"reputation": 694, "user_id": 6528719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jyH70.jpg?s=128&g=1", "display_name": "Dinesh Gowda", "link": "https://stackoverflow.com/users/6528719/dinesh-gowda"}, "edited": false, "score": 2, "creation_date": 1577119829, "post_id": 38732782, "comment_id": 105098727, "body": "Yes even slices are passed by value. As a slice will contain pointer to array. The data modified inside the function will affect the actual array"}], "tags": [], "owner": {"reputation": 3010, "user_id": 519557, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/x9V4f.jpg?s=128&g=1", "display_name": "jxstanford", "link": "https://stackoverflow.com/users/519557/jxstanford"}, "is_accepted": true, "score": 15, "last_activity_date": 1470186466, "creation_date": 1470186466, "answer_id": 38732782, "question_id": 38731467, "link": "https://stackoverflow.com/questions/38731467/pass-array-by-reference-in-golang/38732782#38732782", "title": "pass array by reference in golang", "body": "<p>As others have mentioned in comments, you probably want to use a slice rather than an array.  Slices are passed by reference already, so no need to specify pointers.  The <code>make</code> statement below creates a slice of ints (backed by an array).  In the code below, I gave it a length of 2 and a capacity of 100 in order to satisfy your goal of assigning to index 1.</p>\n\n<pre><code>import (\n    \"fmt\"\n)\n\nfunc f(a []int) {\n    fmt.Println(a[1])\n}\n\nfunc main() {\n    a := make([]int, 2, 100)\n    a[1] = 100\n    f(a)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "is_accepted": false, "score": 2, "last_activity_date": 1470189630, "creation_date": 1470189630, "answer_id": 38733156, "question_id": 38731467, "link": "https://stackoverflow.com/questions/38731467/pass-array-by-reference-in-golang/38733156#38733156", "title": "pass array by reference in golang", "body": "<p>you must use a slice instead of an array as argument of function.\nfor example:</p>\n\n<pre><code>func p(a int){\nfmt.Println(a)\n}\nfunc main() {\n    var a = make([]int,2,10) //2 is length, 10 is capacity\n    a[0] = 10\n    p(a[0])\n}\n</code></pre>\n\n<p>array is value type, slice is reference type. you can see more at <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow\">https://blog.golang.org/go-slices-usage-and-internals</a></p>\n\n<p>Wish it help you!</p>\n"}, {"tags": [], "owner": {"reputation": 694, "user_id": 6528719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jyH70.jpg?s=128&g=1", "display_name": "Dinesh Gowda", "link": "https://stackoverflow.com/users/6528719/dinesh-gowda"}, "is_accepted": false, "score": 0, "last_activity_date": 1577120638, "creation_date": 1577120638, "answer_id": 59458924, "question_id": 38731467, "link": "https://stackoverflow.com/questions/38731467/pass-array-by-reference-in-golang/59458924#59458924", "title": "pass array by reference in golang", "body": "<p>The go arrays have limited functionality. In C/C++ when you pass an array to a function the address of the 0th index will be passed but in case of go the complete array will be copied. If you print the address of the array in main and f you can see they will be different if you pass an array. What you can do, is from your array <code>a</code> you can create a <code>slice</code> using <code>a[:]</code>. When slice is passed the value of slice is copied as slice contains pointer to <code>a</code> any changes you do in <code>f</code> will reflect in the original array <code>a</code>.</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc f(a []int){\n  fmt.Println(a[1])\n}\n\nfunc main(){\n  var a [100]int\n  a[1]=100\n  //Create a slice and pass it\n  f(a[:])\n</code></pre>\n\n<p>}</p>\n"}, {"tags": [], "owner": {"reputation": 2663, "user_id": 5192528, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NSRvo.jpg?s=128&g=1", "display_name": "Akshay Khot", "link": "https://stackoverflow.com/users/5192528/akshay-khot"}, "is_accepted": false, "score": 1, "last_activity_date": 1592152815, "last_edit_date": 1592152815, "creation_date": 1592151134, "answer_id": 62375118, "question_id": 38731467, "link": "https://stackoverflow.com/questions/38731467/pass-array-by-reference-in-golang/62375118#62375118", "title": "pass array by reference in golang", "body": "<p>To answer the original question, you can <strong>pass a pointer to the array</strong>, to pass the array by reference. </p>\n\n<p>For example, the following function changes the contents of an array of 3 integers. </p>\n\n<pre><code>func change(ptr *[3]int) {\n    ptr[2] = 20\n}\n</code></pre>\n\n<p>You can call this by passing a pointer to the original array:</p>\n\n<pre><code>change(&amp;arr)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/XMta1R9pOn2\" rel=\"nofollow noreferrer\">Complete Example</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    grades := [3]int {1, 2, 3}\n\n    fmt.Printf(\"\\nOriginal array:\\n\")\n    for i, v := range grades {\n        fmt.Printf(\"arr[%d] = %d\\n\", i, v)    // prints 1 2 3\n    }\n\n    change(&amp;grades)\n    fmt.Printf(\"\\nModified grades:\\n\")\n    for i, v := range grades {\n        fmt.Printf(\"arr[%d] = %d\\n\", i, v)    // prints 1 2 20\n    }\n}\n\nfunc change(ptr*[3]int) {\n    ptr[2] = 20\n}\n</code></pre>\n\n<p>In your example, <code>f</code> is expecting a pointer to an integer, </p>\n\n<pre><code>func f(a *int)    // a points to an integer\n</code></pre>\n\n<p>and you are passing it an array,</p>\n\n<pre><code>var a [100]int\nf(a)\n</code></pre>\n\n<p>hence it gives you the error <code>cannot use a (type [100]int) as type *int in argument to f</code>.</p>\n\n<p>Although passing a pointer to an array is efficient and allows the called function to change the caller\u2019s variable, arrays are still fixed in size. Hence, slices are recommended, which are passed by reference and are dynamic in size.</p>\n"}], "owner": {"reputation": 975, "user_id": 3657919, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c38a79ee00beaaf018dcacbd9c1c936?s=128&d=identicon&r=PG&f=1", "display_name": "iammehrabalam", "link": "https://stackoverflow.com/users/3657919/iammehrabalam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22522, "favorite_count": 2, "accepted_answer_id": 38732782, "answer_count": 4, "score": 11, "last_activity_date": 1592152815, "creation_date": 1470176845, "last_edit_date": 1563341196, "question_id": 38731467, "link": "https://stackoverflow.com/questions/38731467/pass-array-by-reference-in-golang", "title": "pass array by reference in golang", "body": "<p>I am from a C background and passing an array in C style causes an error.</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc f(a *int){\n  fmt.Println(a[1])\n}\n\nfunc main(){\n  var a [100]int\n  a[1]=100\n  f(a)\n}\n</code></pre>\n\n<p><strong>Error</strong>:: <strong>cannot use a (type [100]int) as type *int in argument to f</strong></p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470174387, "post_id": 38730989, "comment_id": 64838297, "body": "yes, a pointer to an interface is considered &quot;pointer to Go memory containing a Go pointers&quot;, but what valid use could there be to pass a pointer to a Go interface into C?"}, {"owner": {"reputation": 2549, "user_id": 749515, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/fdf40887bfac87aba430eec018cc0d2a?s=128&d=identicon&r=PG", "display_name": "pavelkolodin", "link": "https://stackoverflow.com/users/749515/pavelkolodin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470174949, "post_id": 38730989, "comment_id": 64838554, "body": "@JimB see the update to my post. I put a description of why I need that."}, {"owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "edited": false, "score": 0, "creation_date": 1470175090, "post_id": 38730989, "comment_id": 64838610, "body": "is the <code>&amp;du</code> in <code>unsafe.Pointer(&amp;du))    &#47;&#47; this is my suspect</code> supposed to be <code>&amp;de</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470175532, "post_id": 38730989, "comment_id": 64838765, "body": "<code>du</code> isn&#39;t even declared, so this can&#39;t compile in the first place. But in the end, an interface contains 2 pointer values, so cgo isn&#39;t going to allow you to pass a pointer to an interface, even if there were a way to make it work."}, {"owner": {"reputation": 2549, "user_id": 749515, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/fdf40887bfac87aba430eec018cc0d2a?s=128&d=identicon&r=PG", "display_name": "pavelkolodin", "link": "https://stackoverflow.com/users/749515/pavelkolodin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470175640, "post_id": 38730989, "comment_id": 64838799, "body": "@JimB &quot;du&quot; == &quot;de&quot;. Thank you."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470177162, "post_id": 38730989, "comment_id": 64839309, "body": "There is some example code in the <a href=\"https://github.com/golang/go/wiki/cgo\" rel=\"nofollow noreferrer\">cgo wiki page</a> for callbacks."}], "answers": [{"comments": [{"owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "edited": false, "score": 0, "creation_date": 1470240059, "post_id": 38748361, "comment_id": 64870806, "body": "Just FYI, in case you were wondering where my use-case cropped up, it&#39;s a go wrapper to a high-level kafka library written in C that wraps librdkafka and heavily relies on callbacks and passing context."}], "tags": [], "owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "is_accepted": false, "score": 1, "last_activity_date": 1470239542, "last_edit_date": 1592644375, "creation_date": 1470239542, "answer_id": 38748361, "question_id": 38730989, "link": "https://stackoverflow.com/questions/38730989/cgo-go-pointers-in-go-memory/38748361#38748361", "title": "cgo: Go pointers in Go memory", "body": "<h2>Answer</h2>\n<p>In follow up to @JimB, yes, this is considered a pointer to Go memory containing a Go pointer, so in go &gt;= 1.6 you're going to get &quot;cgo argument has Go pointer to Go pointer&quot; panics when you run your program.</p>\n<p>If you want to use something like this at runtime, you can disable the panic by running your program with <code>GODEBUG=cgocheck=0</code>.</p>\n<p>I've actually written code like this before in go &lt; 1.6 to wrap object-oriented handler code that's called asynchronously from threaded C code--so I don't think the use-case is that crazy.</p>\n<h3>Alternatives</h3>\n<p>One possible alternative to passing the pointer directly to the underlying C code is to make a threadsafe global registry for your handlers, so you would basically pass some index to the registry into the C code, receive it back in your callback, look up the handler for that index and then invoke the function on it.</p>\n<hr />\n<h2>Examples</h2>\n<p>These are a bit lengthy, but give an actual working example. If you want to just take a look at the registry implementation example, jump to the bottom.</p>\n<h3>Direct Pointer Example (Your issue)</h3>\n<p>Not the best C in the world, but here's a quick simplification of other code I've done this with before</p>\n<p><strong>Library Code</strong></p>\n<p>Makefile:</p>\n<pre><code>libtesting:\n  gcc -fPIC -c library/testing.c -o library/testing.o\n  gcc -dynamiclib library/testing.o -o library/libtesting.dylib\n</code></pre>\n<p>C Header:</p>\n<pre><code>/* library/testing.h */\n\n#ifndef __TESTING_H__\n#define __TESTING_H__\n\n#include &lt;pthread.h&gt;\n\nstruct worker_node {\n  pthread_t worker;\n  struct worker_node *next;\n};\n\n// Structs for publisher\nstruct publisher {\n  void (* callback)(void *, char *, int);\n  void *context;\n  struct worker_node *workers;\n};\n\nstruct publisher * publisher_new(void *, void (*)(void *, char *, int));\nvoid publisher_cleanup(struct publisher *);\nvoid publisher_finish(struct publisher *);\nvoid publisher_publish(struct publisher *, char *, int);\n\n#endif // __TESTING_H__\n</code></pre>\n<p>C Source:</p>\n<pre><code>/* library/testing.c */\n\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;assert.h&gt;\n\n#include &quot;testing.h&quot;\n\nstruct message_wrapper {\n  void * context;\n  char * message;\n  int message_len;\n  void (* callback)(void *, char *, int);\n};\n\nstruct publisher * publisher_new(void *context, void (*callback)(void *, char *, int)) {\n  struct publisher * self = (struct publisher *)malloc(sizeof(struct publisher));\n  assert(self);\n  assert(self-&gt;callback = callback);\n  self-&gt;context = context;\n  self-&gt;workers = NULL;\n\n  return self;\n}\n\nvoid publisher_cleanup(struct publisher * self) {\n  struct worker_node * next_node;\n  struct worker_node * node = self-&gt;workers;\n  while (node != NULL) {\n    next_node = node-&gt;next;\n    free(node);\n    node = next_node;\n  }\n  free(self);\n  self = NULL;\n}\n\nstatic void * publisher_worker_thread(void * args) {\n  struct message_wrapper * wrapper = (struct message_wrapper *)args;\n\n  wrapper-&gt;callback(wrapper-&gt;context, wrapper-&gt;message, wrapper-&gt;message_len);\n\n  free(wrapper-&gt;message);\n  free(wrapper);\n\n  pthread_exit(NULL);\n}\n\nvoid publisher_publish(struct publisher *self, char * message, int message_len) {\n  pthread_attr_t attr;\n\n  pthread_attr_init(&amp;attr);\n  pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_JOINABLE);\n\n  struct worker_node * new_node = (struct worker_node *)malloc(sizeof(struct worker_node));\n  new_node-&gt;next = self-&gt;workers;\n  self-&gt;workers = new_node;\n\n  struct message_wrapper *wrapper = (struct message_wrapper *)malloc(sizeof(struct message_wrapper));\n  wrapper-&gt;message = malloc(message_len);\n  memcpy(wrapper-&gt;message, message, message_len);\n  wrapper-&gt;message_len = message_len;\n  wrapper-&gt;context = self-&gt;context;\n  wrapper-&gt;callback = self-&gt;callback;\n\n  assert(!pthread_create(&amp;self-&gt;workers-&gt;worker, &amp;attr, publisher_worker_thread, (void *)wrapper));\n}\n\nvoid publisher_finish(struct publisher *self) {\n  struct worker_node * node = self-&gt;workers;\n  while (node != NULL) {\n    assert(!pthread_join(node-&gt;worker, NULL));\n    node = node-&gt;next;\n  }\n}\n</code></pre>\n<p><strong>Go Code</strong></p>\n<p>C wrapper:</p>\n<pre><code>/* testing_c.c */\n\n#include &quot;_cgo_export.h&quot;\n\nvoid cgo_callback_wrapper(void * context, char *message, int message_len) {\n    callbackWrapper(context, message, message_len);\n}\n</code></pre>\n<p>Go:</p>\n<pre><code>package main\n\n/*\n#cgo LDFLAGS: -lpthread -Llibrary -ltesting\n#include &quot;library/testing.h&quot;\n\nextern void cgo_callback_wrapper(void * context, char *message, int message_len);\n*/\nimport &quot;C&quot;\n\nimport (\n    &quot;fmt&quot;\n    &quot;unsafe&quot;\n)\n\ntype Handler interface {\n    HandleMessage([]byte)\n}\n\ntype Publisher struct {\n    base *C.struct_publisher\n}\n\n//export callbackWrapper\nfunc callbackWrapper(cContext unsafe.Pointer, cMessage *C.char, cMessageSize C.int) {\n    handler := *(*Handler)(cContext)\n    message := C.GoBytes(unsafe.Pointer(cMessage), cMessageSize)\n    handler.HandleMessage(message)\n}\n\nfunc (p *Publisher) Publish(message []byte) {\n    cMessage := (*C.char)(unsafe.Pointer(&amp;message[0]))\n    cMessageLen := C.int(len(message))\n    C.publisher_publish(p.base, cMessage, cMessageLen)\n}\n\nfunc CreatePublisher(handler Handler) *Publisher {\n    return &amp;Publisher{\n        base: C.publisher_new(unsafe.Pointer(&amp;handler), (*[0]byte)(C.cgo_callback_wrapper)),\n    }\n}\n\nfunc (p *Publisher) Finish() {\n    C.publisher_finish(p.base)\n}\n\n//////// EXAMPLE ////////\n\ntype TestHandler struct {\n    name string\n}\n\nfunc (h TestHandler) HandleMessage(message []byte) {\n    fmt.Printf(&quot;%s received %v&quot;, h.name, message)\n}\n\nfunc main() {\n    handler := TestHandler{name: &quot;Test&quot;}\n\n    publisher := CreatePublisher(handler)\n    publisher.Publish([]byte(&quot;test&quot;))\n    publisher.Finish()\n}\n</code></pre>\n<p>Disregard not cleaning up memory allocations...</p>\n<p>If you put the go, c wrappers, and Makefile in the top-level directory, the &quot;C library&quot; in a folder named library and run <code>make &amp;&amp; go build</code> (on OS X, adjust the makefile compiler flags for Linux) you should get a panic of &quot;cgo argument has Go pointer to Go pointer&quot; using go &gt;= 1.6 and no panic for go &lt; 1.6 when running the binary. Building with go 1.6 and running with <code>GODEBUG=cgocheck=0</code> should output <code>Test received [116 101 115 116]</code>.</p>\n<h3>Registry Example (Alternative)</h3>\n<p>To make this example run under 1.6 without disabling <code>cgocheck</code> add a registry kind of like this:</p>\n<pre><code>package main\n\n/*\n#cgo LDFLAGS: -lpthread -Llibrary -ltesting\n#include &quot;library/testing.h&quot;\n\nextern void cgo_callback_wrapper(void * context, char *message, int message_len);\n*/\nimport &quot;C&quot;\n\nimport (\n    &quot;fmt&quot;\n    &quot;sync&quot;\n    &quot;unsafe&quot;\n)\n\nvar registry map[int]Handler\nvar handlers int\nvar mutex = sync.Mutex{}\n\ntype Handler interface {\n    HandleMessage([]byte)\n}\n\ntype Publisher struct {\n    base *C.struct_publisher\n}\n\n//export callbackWrapper\nfunc callbackWrapper(cContext unsafe.Pointer, cMessage *C.char, cMessageSize C.int) {\n    mutex.Lock()\n    handler := registry[*(*int)(cContext)]\n    mutex.Unlock()\n    message := C.GoBytes(unsafe.Pointer(cMessage), cMessageSize)\n    handler.HandleMessage(message)\n}\n\nfunc (p *Publisher) Publish(message []byte) {\n    cMessage := (*C.char)(unsafe.Pointer(&amp;message[0]))\n    cMessageLen := C.int(len(message))\n    C.publisher_publish(p.base, cMessage, cMessageLen)\n}\n\nfunc CreatePublisher(handler Handler) *Publisher {\n    mutex.Lock()\n    index := handlers\n    handlers++\n    if registry == nil {\n        registry = make(map[int]Handler)\n    }\n    registry[index] = handler\n    mutex.Unlock()\n    return &amp;Publisher{\n        base: C.publisher_new(unsafe.Pointer(&amp;index), (*[0]byte)(C.cgo_callback_wrapper)),\n    }\n}\n\nfunc (p *Publisher) Finish() {\n    C.publisher_finish(p.base)\n}\n\n//////// EXAMPLE ////////\n\ntype TestHandler struct {\n    name string\n}\n\nfunc (h TestHandler) HandleMessage(message []byte) {\n    fmt.Printf(&quot;%s received %v&quot;, h.name, message)\n}\n\nfunc main() {\n    handler := TestHandler{name: &quot;Test&quot;}\n\n    publisher := CreatePublisher(handler)\n    publisher.Publish([]byte(&quot;test&quot;))\n    publisher.Finish()\n}\n</code></pre>\n<p>Notice the addition of registry code in <code>CreatePublisher</code> and <code>callbackWrapper</code> and now instead of passing a pointer to an interface we now just pass a pointer to the index of the interface in the registry. Compile the same way and no more panics!</p>\n"}, {"tags": [], "owner": {"reputation": 1104, "user_id": 6296060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZ37JUkP1Pw/AAAAAAAAAAI/AAAAAAAAAYw/Fp6BfZuv7Ho/photo.jpg?sz=128", "display_name": "greedy52", "link": "https://stackoverflow.com/users/6296060/greedy52"}, "is_accepted": false, "score": 0, "last_activity_date": 1498765944, "last_edit_date": 1498765944, "creation_date": 1498742965, "answer_id": 44826533, "question_id": 38730989, "link": "https://stackoverflow.com/questions/38730989/cgo-go-pointers-in-go-memory/44826533#44826533", "title": "cgo: Go pointers in Go memory", "body": "<p>Here is another hacky to workaround this. It is not encouraged unless the content of whatever is passing around is not accessed by your C library (like C library only pass it around for callbacks).</p>\n\n<p>Idea is to cast your unsafe.Pointer to C.ulonglong</p>\n\n<p>Calling C</p>\n\n<pre><code>C.function(C.ulonglong(uintptr(unsafe.Pointer(&amp;something))))\n</code></pre>\n\n<p>Casting it back</p>\n\n<pre><code>(*SomethingType)(unsafe.Pointer(uintptr(the_c_long_value)))\n</code></pre>\n"}], "owner": {"reputation": 2549, "user_id": 749515, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/fdf40887bfac87aba430eec018cc0d2a?s=128&d=identicon&r=PG", "display_name": "pavelkolodin", "link": "https://stackoverflow.com/users/749515/pavelkolodin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1799, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1498765944, "creation_date": 1470174225, "last_edit_date": 1470329077, "question_id": 38730989, "link": "https://stackoverflow.com/questions/38730989/cgo-go-pointers-in-go-memory", "title": "cgo: Go pointers in Go memory", "body": "<p>Does the code:</p>\n\n<pre><code>unsafe.Pointer(&amp;du)\n</code></pre>\n\n<p>where <code>du</code> is some <code>interface</code> satisfy the rule 1 from the following list?</p>\n\n<p><a href=\"https://github.com/golang/go/issues/12416\" rel=\"nofollow\">https://github.com/golang/go/issues/12416</a></p>\n\n<blockquote>\n  <p>Go code may pass a Go pointer to C provided that the Go memory to\n  which it points does not contain any Go pointers. That rule must be\n  preserved during C execution, in that the program must not store any\n  Go pointers into that memory.</p>\n</blockquote>\n\n<p>In other words, is the C-pointer to Go <code>interface</code> considered as a \"pointer to Go memory containing a Go pointers\"?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>My issue is the following code:</p>\n\n<pre><code>type Receiver interface {\n    Signal()\n}\n\nfunc WowFunction(data []byte, du Receiver) {\n\n    C.wow_function( (*C.char)( unsafe.Pointer(&amp;data[0]) ), \n                    (C.size_t)(len(data)),\n                    unsafe.Pointer(&amp;du))    // this is my suspect\n}\n</code></pre>\n\n<p>My idea is to make C-code calling the <code>Receiver</code>'s \"method\" <code>Signal()</code>. I achieve this by exporting a Go-callback and passing that <code>&amp;du</code> as an argument to the callback:</p>\n\n<pre><code>//export go_callback\nfunc go_callback(object_ptr unsafe.Pointer) {\n\n    object := *(*Receiver)(object_ptr);\n    object.Signal()\n}\n</code></pre>\n\n<p>Is there another way to reach that?</p>\n"}, {"tags": ["go", "command-line"], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 5235763, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MT8m38bvWls/AAAAAAAAAAI/AAAAAAAAAWc/sIY7wBDDXYk/photo.jpg?sz=128", "display_name": "Nathaniel Dean", "link": "https://stackoverflow.com/users/5235763/nathaniel-dean"}, "is_accepted": true, "score": 1, "last_activity_date": 1470325728, "creation_date": 1470325728, "answer_id": 38771986, "question_id": 38730950, "link": "https://stackoverflow.com/questions/38730950/getting-parameter-values-using-github-com-spf13-cobra/38771986#38771986", "title": "Getting parameter values using github.com/spf13/cobra", "body": "<p>The <code>args</code> variable is for extra parameters that are passed into that particular <code>cobra</code> verb. For example, if you wanted your <code>start</code> verb on the <code>server</code> command to (for example) require a particular configuration file, you could simply pass that in like</p>\n\n<p><code>server start -p 8080 config.yml</code> </p>\n\n<p>and <code>\"config.yml\"</code> is placed in <code>args[0]</code>. </p>\n"}], "owner": {"reputation": 4531, "user_id": 3011570, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/4Ht66.jpg?s=128&g=1", "display_name": "Eric Broda", "link": "https://stackoverflow.com/users/3011570/eric-broda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2067, "favorite_count": 0, "accepted_answer_id": 38771986, "answer_count": 1, "score": 1, "last_activity_date": 1470325728, "creation_date": 1470174076, "last_edit_date": 1470253773, "question_id": 38730950, "link": "https://stackoverflow.com/questions/38730950/getting-parameter-values-using-github-com-spf13-cobra", "title": "Getting parameter values using github.com/spf13/cobra", "body": "<p>I am using the <a href=\"https://github.com/spf13/cobra\" rel=\"nofollow\"><code>github.com/spf13/cobra</code></a>  package to interpret process' command-line arguments, and I'm having difficulty understanding how parameter values are determined.</p>\n\n<p>I have a working program (below) which uses internal variables that get updated with parameter values:</p>\n\n<pre><code>OptPort := 8088\n\nrootCmd := &amp;cobra.Command{\n    Use:   \"server\",\n    Short: \"Root command short version\",\n    Long:  \"Root command long version\",\n}\n\nstartCmd := &amp;cobra.Command{\n    Use:   \"start\",\n    Short: \"Start command short version\",\n    Long:  \"Start command long version\",\n    Run: func(cmd *cobra.Command, args []string) {\n        fmt.Println(\"args: \" + strings.Join(args, \" \"))\n        fmt.Println(\"port: \" + OptPort)\n    },\n}\nstartCmd.Flags().IntVarP(&amp;OptPort, \"port\", \"p\", OptPort, \"Port to listen to\")\n\nrootCmd.AddCommand(startCmd)\n\nrootCmd.Execute()\n</code></pre>\n\n<p>The output I get is as follows:</p>\n\n<pre><code>args:\nport: 8088\n</code></pre>\n\n<p>I realize that I can get the port value by interrogating the port variable, but I would have thought the values would be in the args variable also.  Is the args variable empty because I am doing something wrong?  If the args variable is expected to be empty, what is the purpose of the args variable?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 4633, "user_id": 1426906, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f22228bf1ee45283d539c68cf652590e?s=128&d=identicon&r=PG&f=1", "display_name": "sergiuz", "link": "https://stackoverflow.com/users/1426906/sergiuz"}, "is_accepted": false, "score": 5, "last_activity_date": 1470175068, "creation_date": 1470175068, "answer_id": 38731158, "question_id": 38730677, "link": "https://stackoverflow.com/questions/38730677/do-these-methods-create-new-database-and-collections-in-mongodb-server/38731158#38731158", "title": "Do these methods create new database and collections in MongoDB server", "body": "<p>In MongoDB, a new DB and collection will be <em>created</em> <strong>only</strong> after a write operation, <strong>after inserting first document</strong> in a specific database and collection. </p>\n\n<p>In MongoDB there is no <code>CREATE TABLE</code> like command/function, no need for that. </p>\n\n<p>Your code does not <em>create</em> a collection since is not inserting new documents in new collection. In your code you don't need to worry about creating dbs or collections</p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3576, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1470175068, "creation_date": 1470172922, "question_id": 38730677, "link": "https://stackoverflow.com/questions/38730677/do-these-methods-create-new-database-and-collections-in-mongodb-server", "title": "Do these methods create new database and collections in MongoDB server", "body": "<p>From Web Development with Go by Shiju Varghese</p>\n\n<blockquote>\n  <p>To perform CRUD operations into MongoDB, an object of <code>*mgo.Collection</code> is created, which represents the MongoDB collection. You can create an object of <code>*mgo.Collection</code> by calling method <code>C</code> of <code>*mgo.Database</code>. </p>\n  \n  <p>The <code>mgo.Database</code> type represents the named database that can be\n  created by calling the <code>DB</code> method of <code>*mgo.Session</code>.</p>\n  \n  <p>Listing 8-5 accesses the MongoDB collection named \"categories\".</p>\n  \n  <p>Listing 8-5.  Accessing a MongoDB Collection</p>\n\n<pre><code>c := session.DB(\"taskdb\").C(\"categories\")\n</code></pre>\n</blockquote>\n\n<p>Do the <code>DB</code> and <code>C</code> methods create database object and collection object in Go programs both</p>\n\n<ul>\n<li><p>for existing database and existing collection in a MongoDB server?</p></li>\n<li><p>for noexisting database and nonexisting collection, so that the methods will create new database and collection in a MongoDB server, which will be named as the arguments to the methods?</p></li>\n</ul>\n\n<p>Thanks.</p>\n"}, {"tags": ["macos", "go", "macos-sierra"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1470170411, "post_id": 38729871, "comment_id": 64836355, "body": "This is probably more appropriate for the mailing list or filing an issue, since it&#39;s problem with a specific beta OS version. (and I may have heard sierra changed something again as recently as today)"}, {"owner": {"reputation": 1547, "user_id": 2969841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ABgFw.jpg?s=128&g=1", "display_name": "tsabsch", "link": "https://stackoverflow.com/users/2969841/tsabsch"}, "edited": false, "score": 0, "creation_date": 1470213201, "post_id": 38729871, "comment_id": 64851349, "body": "There was a discussion about issues with macOS beta 4 yesterday. See this post: <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/XaVT6fi1g30\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/XaVT6fi1g30</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470332190, "post_id": 38729871, "comment_id": 64919376, "body": "Yes, i would try with the latest go1.7 rc to see if it&#39;s the same problem."}], "answers": [{"tags": [], "owner": {"reputation": 5303, "user_id": 5927126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q2PYp.jpg?s=128&g=1", "display_name": "AnandShanbhag", "link": "https://stackoverflow.com/users/5927126/anandshanbhag"}, "is_accepted": true, "score": 0, "last_activity_date": 1483708099, "creation_date": 1483708099, "answer_id": 41506443, "question_id": 38729871, "link": "https://stackoverflow.com/questions/38729871/after-updating-to-macos-beta-4-go-test-cover-is-throwing-fatal-error-unexpec/41506443#41506443", "title": "After updating to macOS beta 4, go test -cover is throwing &quot;fatal error: unexpected signal during runtime execution&quot;", "body": "<p>Yes, there is some issue with the go runtime. I was getting this issue after upgrading to Sierra macOS version.</p>\n\n<p>There is a lengthy discussion on what was the cause at this <a href=\"https://github.com/golang/go/issues/16331\" rel=\"nofollow noreferrer\">link</a>;</p>\n\n<p>Basically, just changing the position of the \"defer\" statement resolved this issue.More details on change is <a href=\"https://go-review.googlesource.com/#/c/31138/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p><strong>I resolved this issue by installing \"go1.8beta2.darwin-amd64.pkg\"</strong> beta version of Go. I am not facing this issue anymore.</p>\n\n<p>NOTE: this issue is not fixed in 1.7 as per <a href=\"https://github.com/golang/go/issues/16331#issuecomment-267377888\" rel=\"nofollow noreferrer\">this discussion</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 4326353, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268738014/picture?type=large", "display_name": "crhntr", "link": "https://stackoverflow.com/users/4326353/crhntr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 41506443, "answer_count": 1, "score": 0, "last_activity_date": 1483708099, "creation_date": 1470169659, "question_id": 38729871, "link": "https://stackoverflow.com/questions/38729871/after-updating-to-macos-beta-4-go-test-cover-is-throwing-fatal-error-unexpec", "title": "After updating to macOS beta 4, go test -cover is throwing &quot;fatal error: unexpected signal during runtime execution&quot;", "body": "<p>Go build and go test are still working.</p>\n\n<p>Before updating to macOS beta I had no problems using the test coverage tools.</p>\n\n<p>\"go test\" is working fine; however, all of the coverage test commands are throwing this error (go test -coverprofile=coverage.out throws the same issue). </p>\n\n<p>If anyone has any idea how to fix this, I would really appreciate it!</p>\n\n<pre><code>$ go test -cover\ngo build github.com/hunteramericano/ErrorQuiver: /usr/local/Cellar/go/1.6.3/libexec/pkg/tool/darwin_amd64/cover: signal:\nfatal error: unexpected signal during runtime execution\n[signal 0xb code=0x1 addr=0x57060029ec pc=0x17cc70]\n\ngoroutine 9 [running]:\nruntime.throw(0x689a00, 0x2a)\n/usr/local/Cellar/go/1.6.3/libexec/src/runtime/panic.go:547 +0x90 fp=0xc820037870 sp=0xc820037858\nruntime.sigpanic()\n/usr/local/Cellar/go/1.6.3/libexec/src/runtime/sigpanic_unix.go:12 +0x5a fp=0xc8200378c0 sp=0xc820037870\nsync.(*Pool).Get(0x882700, 0x0, 0x0)\n/usr/local/Cellar/go/1.6.3/libexec/src/sync/pool.go:102 +0x40 fp=0xc820037910 sp=0xc8200378c0\nfmt.newPrinter(0x10)\n/usr/local/Cellar/go/1.6.3/libexec/src/fmt/print.go:133 +0x27 fp=0xc820037950 sp=0xc820037910\nfmt.Fprintf(0xde5230, 0xc82017a150, 0x638380, 0x17, 0xc820037af0, 0x1, 0x1, 0x0, 0x0, 0x0)\n/usr/local/Cellar/go/1.6.3/libexec/src/fmt/print.go:187 +0x30 fp=0xc820037998 sp=0xc820037950\nmain.(*builder).runTest(0xc82017aaf0, 0xc82005e410, 0x0, 0x0)\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/test.go:1070 +0x463 fp=0xc820037e00 sp=0xc820037998\nmain.(*builder).do.func1(0xc82005e410)\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/build.go:1257 +0x3b2 fp=0xc820037ec0 sp=0xc820037e00\nmain.(*builder).do.func2(0xc82038ae20, 0xc82017aaf0, 0xc820428400)\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/build.go:1314 +0x156 fp=0xc820037f98 sp=0xc820037ec0\nruntime.goexit()\n/usr/local/Cellar/go/1.6.3/libexec/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820037fa0 sp=0xc820037f98\ncreated by main.(*builder).do\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/build.go:1320 +0x39e\n\ngoroutine 1 [semacquire]:\nsync.runtime_Semacquire(0xc82038ae2c)\n/usr/local/Cellar/go/1.6.3/libexec/src/runtime/sema.go:47 +0x26\nsync.(*WaitGroup).Wait(0xc82038ae20)\n/usr/local/Cellar/go/1.6.3/libexec/src/sync/waitgroup.go:127 +0xb4\nmain.(*builder).do(0xc82017aaf0, 0xc82005e680)\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/build.go:1323 +0x3c6\nmain.runTest(0x889620, 0xc82000a230, 0x1, 0x1)\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/test.go:595 +0x2836\nmain.main()\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/main.go:181 +0x783\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n/usr/local/Cellar/go/1.6.3/libexec/src/runtime/asm_amd64.s:1998 +0x1\n\ngoroutine 5 [syscall]:\nos/signal.signal_recv(0x0)\n/usr/local/Cellar/go/1.6.3/libexec/src/runtime/sigqueue.go:116 +0x132\nos/signal.loop()\n/usr/local/Cellar/go/1.6.3/libexec/src/os/signal/signal_unix.go:22 +0x18\ncreated by os/signal.init.1\n/usr/local/Cellar/go/1.6.3/libexec/src/os/signal/signal_unix.go:28 +0x37\n\ngoroutine 7 [select]:\nmain.(*builder).do.func2(0xc82038ae20, 0xc82017aaf0, 0xc820428400)\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/build.go:1304 +0x1cf\ncreated by main.(*builder).do\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/build.go:1320 +0x39e\n\ngoroutine 8 [select]:\nmain.(*builder).do.func2(0xc82038ae20, 0xc82017aaf0, 0xc820428400)\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/build.go:1304 +0x1cf\ncreated by main.(*builder).do\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/build.go:1320 +0x39e\n\ngoroutine 10 [select]:\nmain.(*builder).do.func2(0xc82038ae20, 0xc82017aaf0, 0xc820428400)\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/build.go:1304 +0x1cf\ncreated by main.(*builder).do\n/usr/local/Cellar/go/1.6.3/libexec/src/cmd/go/build.go:1320 +0x39e\n$\n</code></pre>\n"}, {"tags": ["dictionary", "go", "pass-by-reference", "pass-by-value"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1470170170, "post_id": 38729760, "comment_id": 64836214, "body": "As there <i>are</i> no references in Go the answer is obviously: By value."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470172861, "post_id": 38729760, "comment_id": 64837575, "body": "I&#39;m fine reopening this since you&#39;ve accepted an answer (thought closing would prevent the continued downvotes). The underlying reason for the answers are the same however, so it&#39;s good to understand why your example couldn&#39;t possibly work when the value in the map isn&#39;t addressable in the first place."}, {"owner": {"reputation": 2736, "user_id": 5090391, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh5.googleusercontent.com/-mYreaq2QAsQ/AAAAAAAAAAI/AAAAAAAAAE0/Qo8TuR0kJyk/photo.jpg?sz=128", "display_name": "Brendan", "link": "https://stackoverflow.com/users/5090391/brendan"}, "edited": false, "score": 0, "creation_date": 1470234884, "post_id": 38729760, "comment_id": 64866894, "body": "So I&#39;m right there with you on the answers being the same, and even that these questions stem from the same underlying lack of info.  But knowledge on SO needs to be indexed by question, and these are different indices -- having both questions even if they point to the same answer is still adding value to the site."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 11, "last_activity_date": 1594662464, "last_edit_date": 1594662464, "creation_date": 1470169480, "answer_id": 38729826, "question_id": 38729760, "link": "https://stackoverflow.com/questions/38729760/is-golang-map-lookup-by-value-or-by-reference/38729826#38729826", "title": "Is golang map lookup by value or by reference?", "body": "<p>Indexing a map returns a copy of the map value. If the map value is a struct, then modifications to the returned struct value will not change the struct value in the map. You must assign the modified value back to the map.</p>\n<p>If the value is a pointer to a struct, then modifications to the struct will be accessible through the pointer stored in the map.</p>\n"}, {"tags": [], "owner": {"reputation": 449, "user_id": 9024502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6acRO.jpg?s=128&g=1", "display_name": "Nitzan Cohen", "link": "https://stackoverflow.com/users/9024502/nitzan-cohen"}, "is_accepted": false, "score": 0, "last_activity_date": 1522071953, "creation_date": 1522071953, "answer_id": 49493033, "question_id": 38729760, "link": "https://stackoverflow.com/questions/38729760/is-golang-map-lookup-by-value-or-by-reference/49493033#49493033", "title": "Is golang map lookup by value or by reference?", "body": "<p>Just like the Cerise answer sais- it is not possible.\nInstead, you could hold a pointer as a value in the map.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/20224478/dereferencing-a-map-index-in-golang\">Dereferencing a map index in Golang</a></p>\n"}], "owner": {"reputation": 2736, "user_id": 5090391, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh5.googleusercontent.com/-mYreaq2QAsQ/AAAAAAAAAAI/AAAAAAAAAE0/Qo8TuR0kJyk/photo.jpg?sz=128", "display_name": "Brendan", "link": "https://stackoverflow.com/users/5090391/brendan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2144, "favorite_count": 2, "accepted_answer_id": 38729826, "answer_count": 2, "score": 2, "last_activity_date": 1594662464, "creation_date": 1470169279, "last_edit_date": 1470173469, "question_id": 38729760, "link": "https://stackoverflow.com/questions/38729760/is-golang-map-lookup-by-value-or-by-reference", "title": "Is golang map lookup by value or by reference?", "body": "<p>When I retrieve a struct from a map in Go, do I get a copy of the value?  Or do I get the actual value that's in the map?</p>\n\n<p>For example, let's say I have a map from strings to structs:</p>\n\n<pre><code>type quality struct {\n    goodness    int\n    crunchiness int \n}\ncookies := make(map[string]quality)\ncookies[\"nutrageous\"] = quality{goodness: 3, crunchiness: 10}\n</code></pre>\n\n<p>and I want to modify an entry.</p>\n\n<p>Can I count on the returned value being the same as what's in the map?</p>\n\n<pre><code>c := cookies[\"nutrageous\"]\nc.goodness += 5\n</code></pre>\n\n<p>Or do I also have to go back and modify what's in the map?</p>\n\n<pre><code>c := cookies[\"nutrageous\"]\nc.goodness += 5\ncookies[\"nutrageous\"] = c\n</code></pre>\n"}, {"tags": ["go", "struct", "append", "slice"], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 3, "last_activity_date": 1470166977, "last_edit_date": 1470166977, "creation_date": 1470166416, "answer_id": 38729037, "question_id": 38728982, "link": "https://stackoverflow.com/questions/38728982/go-append-to-slice-on-struct-does-not-persist/38729037#38729037", "title": "Go - append to slice on struct does not persist", "body": "<p><code>for</code> loop used with <code>range</code> creates a copy of the slice variable. So <code>user</code> above in your <code>for</code> loop is a copy of the <code>User</code> object in your <code>users</code> slice. It's this copy that's getting updated and the reason why you don't see any effect on the desired value. Try rhis:</p>\n\n<pre><code>for i, _ := range users {\n    // users[i] now refers to the actual User object in the slice\n    users[i].appendPost(p1)\n}\n</code></pre>\n\n<p>Demo: <a href=\"https://play.golang.org/p/CLkNQ2oh0O\" rel=\"nofollow\">https://play.golang.org/p/CLkNQ2oh0O</a></p>\n\n<p>Check out <em>For Statement</em> in the language specs <a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 506, "user_id": 5165511, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/970e5ae962c625b4911f451d694e92dc?s=128&d=identicon&r=PG&f=1", "display_name": "curious_gudleif", "link": "https://stackoverflow.com/users/5165511/curious-gudleif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 1, "accepted_answer_id": 38729037, "answer_count": 1, "score": 5, "last_activity_date": 1470166977, "creation_date": 1470166227, "question_id": 38728982, "link": "https://stackoverflow.com/questions/38728982/go-append-to-slice-on-struct-does-not-persist", "title": "Go - append to slice on struct does not persist", "body": "<p>I have a hard time understanding what seems to be a pretty basic operation. I want to create two structs, where one of the structs will hold a slice of another struct. Here' a simple example to illustration the problem:</p>\n\n<pre><code>// Post structure\ntype Post struct {\n    User string `bson:\"user\"`\n    Body string `bson:\"body\"`\n}\n\n// User structure\ntype User struct {\n    Name  string `bson:\"name\"`\n    Posts []Post `bson:\"posts\"`\n}\n\nfunc (u *User) appendPost(post Post) []Post {\n    u.Posts = append(u.Posts, post)\n    return u.Posts\n}\n\nfunc main() {\n    p1 := Post{User: \"Jane\", Body: \"First Jane's post\"}\n    u := User{Name: \"Jane\"}\n\n    users := []User{}\n    users = append(users, u)\n\n    for _, user := range users {\n        user.appendPost(p1)\n    }\n\n    // [{Jane []}]\n    fmt.Println(users)\n}\n</code></pre>\n\n<p>This code produces no errors and also no effect. If I initialize and append a user with the predefined post like this: <code>u := User{Name: \"Jane\", Posts: []Post{p1}}</code> - everything works as expected. But I can't figure out why the same operation doesn't work in a two steps:\n1. Create user with only Name and later append posts in a for loop. Thanks in advance.</p>\n\n<p><a href=\"https://play.golang.org/p/SAiofI26x9\" rel=\"noreferrer\">This code on the playground</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "edited": false, "score": 0, "creation_date": 1470170323, "post_id": 38729195, "comment_id": 64836296, "body": "perfect! yes, thank u, my question was not asked very well. ncurses is just what I&#39;m looking for."}], "tags": [], "owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "is_accepted": true, "score": 3, "last_activity_date": 1470166986, "creation_date": 1470166986, "answer_id": 38729195, "question_id": 38728614, "link": "https://stackoverflow.com/questions/38728614/how-do-i-control-where-text-is-printed-to-console-via-fmt/38729195#38729195", "title": "how do I control where text is printed to console via fmt?", "body": "<p>I think you're kind of confused. What <code>fmt</code> is essentially equivalent to are C's <code>printf</code> and <code>scanf</code> family of functions. The complexity of controlling the screen buffer is quite a bit more complex than just printing some stuff in a terminal output.</p>\n\n<p>The behavior you're talking about is a result of vim's integration with the <a href=\"https://www.gnu.org/software/ncurses/\" rel=\"nofollow\">ncurses</a> library (or something similar to it). Haven't ever used this, but <a href=\"https://github.com/rthornton128/goncurses\" rel=\"nofollow\">here</a>'s a link to an ncurses wrapper in cgo, which you could probably use to do something like vim does.</p>\n"}], "owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 38729195, "answer_count": 1, "score": 0, "last_activity_date": 1470167474, "creation_date": 1470164813, "last_edit_date": 1470167474, "question_id": 38728614, "link": "https://stackoverflow.com/questions/38728614/how-do-i-control-where-text-is-printed-to-console-via-fmt", "title": "how do I control where text is printed to console via fmt?", "body": "<p>When running vim if I type <code>:</code> the input cursor goes to bottom row of the screen and I can type a command, then go back to the top of the screen. Arrow keys let me move around, all that jazz. In Golang using the fmt package how can I do this?</p>\n"}, {"tags": ["go", "pass-by-reference"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1470165206, "last_edit_date": 1470165206, "creation_date": 1470164900, "answer_id": 38728640, "question_id": 38728567, "link": "https://stackoverflow.com/questions/38728567/how-to-pass-by-reference-a-slice-of-maps-with-value-type-interface-in-golang/38728640#38728640", "title": "How to pass by reference a slice of maps with value type interface in Golang", "body": "<p>The function is passing a <code>**interface{}</code> to Unmarshal.  To pass the the <code>*[]map[string]interface{}</code> through to Unmarshal, change the function signature to:</p>\n\n<pre><code> func (self BucketStats) GetAuthRequest(rurl string, data interface{}) (err error) {\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 2, "last_activity_date": 1489690560, "last_edit_date": 1489690560, "creation_date": 1470167705, "answer_id": 38729365, "question_id": 38728567, "link": "https://stackoverflow.com/questions/38728567/how-to-pass-by-reference-a-slice-of-maps-with-value-type-interface-in-golang/38729365#38729365", "title": "How to pass by reference a slice of maps with value type interface in Golang", "body": "<p>Several things wrong here.</p>\n\n<p>First, <code>[...]map[string]int{b}</code> is not in fact a slice, but a fixed-length array.  The <code>[...]</code> syntax means \"make an array, and set the length at compile time based on what's being put into it\".  The slice syntax is simply <code>[]map[string]int{b}</code>.  As a result, your call to <code>editit(a)</code> is in fact passing a copy of the array, not a reference (slices are innately references, arrays are not).  When <code>a</code> is reassigned in <code>editit()</code>, you're reassigning the copy, not the original, so nothing changes.</p>\n\n<p>Second, it's almost never useful to use pointers to interfaces.  In fact, the Go runtime was changed a few versions back to not automatically dereference pointers to interfaces (like it does for pointers to almost everything else) to discourage this habit.  Interfaces are innately references already, so there's little reason to make a pointer to one.</p>\n\n<p>Third, you don't actually <em>need</em> to pass a reference to an interface here.  You're trying to unmarshal into the fundamental data structure contained within that interface.  You don't actually care about the interface itself.  <code>GetAuthRequest(rurl string, data interface{})</code> works just fine here.</p>\n\n<pre><code>func (self BucketStats) GetSamples() {\n\n    var buckets []map[string]interface{}\n    self.GetAuthRequest(self.url, &amp;buckets)\n\n    //ProcessBuckets()\n}\n\nfunc (self BucketStats) GetAuthRequest(rurl string, data interface{}) (err error) {\n    client := &amp;http.Client{}\n\n    req, err := http.NewRequest(\"GET\", rurl, nil)\n    req.SetBasicAuth(self.un, self.pw)\n    resp, err := client.Do(req)\n    if err != nil {\n            return\n    }\n\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n            return\n    }\n\n    // it's all for this!!!\n    err = json.Unmarshal(body, data)\n\n    return\n}\n</code></pre>\n\n<p>Let me walk you through what exactly takes place, in order:</p>\n\n<ul>\n<li><p><code>buckets := var buckets []map[string]interface{}</code>\nWe don't need a make here, because <code>json.Unmarshal()</code> will fill it for us.</p></li>\n<li><p><code>self.GetAuthRequest(self.url, &amp;buckets)</code>\nThis passes a reference into an interface field.  Within <code>GetAuthRequest</code>, <code>data</code> is an interface with underlying type <code>*[]map[string]interface{}</code> and an underlying value equal to the address of the original <code>buckets</code> variable in <code>GetSamples()</code>.</p></li>\n<li><p><code>err = json.Unmarshal(body, data)</code>\nThis passes the interface <code>data</code>, by value, to the interface argument to <code>json.Unmarshal()</code>.  Inside <code>json.Unmarshal()</code>, it has new interface <code>v</code> with underlying type <code>*[]map[string]interface{}</code> and an underlying value equal to the address of the original <code>buckets</code> variable in <code>GetSamples()</code>.  This interface is a different variable, with a different address in memory, from the interface that held that same data in <code>GetAuthRequest</code>, but the data was copied over, and the data contains a reference to your slice, so you're still good.</p></li>\n<li><p><code>json.Unmarshal()</code> will, by reflection, fill the slice pointed to by the interface you handed it with the data in your request.  It has a reference to the slice header <code>buckets</code> that you handed it, even though it passed through two interfaces to get there, so any changes it make will affect the original <code>buckets</code> variable.</p></li>\n</ul>\n\n<p>When you get all the way back up to <code>ProcessBuckets()</code>, the <code>buckets</code> variable will contain all of your data.</p>\n\n<hr>\n\n<p>As an ancillary suggestion, don't use named returns if your function is more than a few lines long.  It's better to explicitly return your variables.  This is particularly important because of variable shadowing.  For example, in your <code>GetAuthRequest()</code> function, it will never return a non-nil error.  This is because you're declaring an error variable <code>err</code> in the function signature, but you're immediately shadowing it with a local variable <code>err</code> using the short declaration in <code>req, err := http.NewRequest(\"GET\", rurl, nil)</code>.  For the remainder of the function, <code>err</code> now refers to this new error variable rather than the one defined as the return variable.  As a result, when you return, the original <code>err</code> variable in the return is <em>always</em> <code>nil</code>.  A much better style would be:</p>\n\n<pre><code>func (self BucketStats) GetAuthRequest(rurl string, **data interface{}) error {\n    client := &amp;http.Client{}\n\n    req, err := http.NewRequest(\"GET\", rurl, nil)\n    req.SetBasicAuth(self.un, self.pw)\n    resp, err := client.Do(req)\n    if err != nil {\n            return err\n    }\n\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n            return err\n    }\n\n    // it's all for this!!!\n    return json.Unmarshal(body, data)\n}\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 2569695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57e761307c652ea0eeb0eba8b221e2ab?s=128&d=identicon&r=PG", "display_name": "jake_astub", "link": "https://stackoverflow.com/users/2569695/jake-astub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1637, "favorite_count": 1, "accepted_answer_id": 38728640, "answer_count": 2, "score": 1, "last_activity_date": 1489690560, "creation_date": 1470164664, "last_edit_date": 1470201875, "question_id": 38728567, "link": "https://stackoverflow.com/questions/38728567/how-to-pass-by-reference-a-slice-of-maps-with-value-type-interface-in-golang", "title": "How to pass by reference a slice of maps with value type interface in Golang", "body": "<p>I want to pass <code>[]map[string]interface{}</code> by reference to a function. Here is my attempt. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    b := map[string]int{\"foo\": 1, \"bar\": 2}\n    a := [...]map[string]int{b}\n\n    fmt.Println(a)\n\n    editit(a)\n\n    fmt.Println(a)\n}\n\nfunc editit(a interface{}) {\n    fmt.Println(a)\n\n    b := map[string]int{\"foo\": 3, \"bar\": 4}\n    a = [...]map[string]int{b}\n\n    fmt.Println(a)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/9Bt15mvud1\" rel=\"nofollow\">https://play.golang.org/p/9Bt15mvud1</a></p>\n\n<p>Here is another attempt and what I want to do finally. This does not compile.</p>\n\n<pre><code>func (self BucketStats) GetSamples() {\n\n    buckets := []make(map[string]interface{})\n    self.GetAuthRequest(self.url, &amp;buckets)\n\n    //ProcessBuckets()\n}\n\nfunc (self BucketStats) GetAuthRequest(rurl string, **data interface{}) (err error) {\n    client := &amp;http.Client{}\n\n    req, err := http.NewRequest(\"GET\", rurl, nil)\n    req.SetBasicAuth(self.un, self.pw)\n    resp, err := client.Do(req)\n    if err != nil {\n            return\n    }\n\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n            return\n    }\n\n    // it's all for this!!!\n    err = json.Unmarshal(body, data)\n\n    return\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470164395, "post_id": 38728461, "comment_id": 64832984, "body": "Equivalent to do what exactly?"}, {"owner": {"reputation": 1587, "user_id": 1870612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ce63ec9de008c1453de7ddc1910abca7?s=128&d=identicon&r=PG&f=1", "display_name": "DelGiudice", "link": "https://stackoverflow.com/users/1870612/delgiudice"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470164447, "post_id": 38728461, "comment_id": 64833021, "body": "To write a function just like the one above @JimB"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470164602, "post_id": 38728461, "comment_id": 64833109, "body": "Now it makes a little more sense. Normally in Go you would define a type to return. Can you show what you&#39;re trying to solve? You can use <code>map[string]interface{}</code> and <code>[]interface{}</code>, but that&#39;s usually not that useful."}, {"owner": {"reputation": 1587, "user_id": 1870612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ce63ec9de008c1453de7ddc1910abca7?s=128&d=identicon&r=PG&f=1", "display_name": "DelGiudice", "link": "https://stackoverflow.com/users/1870612/delgiudice"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470164671, "post_id": 38728461, "comment_id": 64833145, "body": "I want to parse it to json in order to send a request @JimB"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1470164732, "creation_date": 1470164732, "answer_id": 38728591, "question_id": 38728461, "link": "https://stackoverflow.com/questions/38728461/nested-maps-in-go/38728591#38728591", "title": "Nested maps in Go", "body": "<p>Here's a direct translation to Go:</p>\n\n<pre><code>var funcName = func(param1, param2, param3 interface{}) interface{} {\n  return map[string]interface{}{\n    \"arr\": []interface{}{\n        map[string]interface{}{\"key1\": param1, \"key2\": param2},\n    },\n    \"key2\": param3,\n  }\n}\n</code></pre>\n\n<p>There's probably a better way to accomplish the real problem you are trying to solve.</p>\n"}, {"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 1, "last_activity_date": 1470168689, "creation_date": 1470168689, "answer_id": 38729614, "question_id": 38728461, "link": "https://stackoverflow.com/questions/38728461/nested-maps-in-go/38729614#38729614", "title": "Nested maps in Go", "body": "<p>Seems like you're trying to end up with a JSON that looks like this:</p>\n\n<pre><code>{\n    \"arr\": [{\n        \"key1\": &lt;param1&gt;,\n        \"key2\": &lt;param2&gt;\n    }],\n    \"key2\": &lt;param3&gt;\n}\n</code></pre>\n\n<p>Is that accurate?  If so, it's far easier in Go to just define a data structure that matches, like:</p>\n\n<pre><code>struct {\n    Arr  []map[string]interface{} `json:\"arr\"`\n    Key2 interface{}              `json:\"key2\"`\n}\n</code></pre>\n\n<p>You can then directly marshal to JSON using the built in <code>json</code> package.  Example: <a href=\"https://play.golang.org/p/GE9DV1QeDC\" rel=\"nofollow\">https://play.golang.org/p/GE9DV1QeDC</a></p>\n"}], "owner": {"reputation": 1587, "user_id": 1870612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ce63ec9de008c1453de7ddc1910abca7?s=128&d=identicon&r=PG&f=1", "display_name": "DelGiudice", "link": "https://stackoverflow.com/users/1870612/delgiudice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1000, "favorite_count": 0, "accepted_answer_id": 38728591, "answer_count": 2, "score": 0, "last_activity_date": 1470202066, "creation_date": 1470164304, "last_edit_date": 1470202066, "question_id": 38728461, "link": "https://stackoverflow.com/questions/38728461/nested-maps-in-go", "title": "Nested maps in Go", "body": "<p>In Javascript I'd do something like this:</p>\n\n<pre><code>var funcName = function(param1, param2, param3) {\n    return {\n        arr: [\n           {key1: param1, key2: param2}\n        ],\n        key2: param3\n    };\n}\n</code></pre>\n\n<p>What would be the equivalent in Go?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1470164234, "creation_date": 1470164234, "answer_id": 38728441, "question_id": 38728334, "link": "https://stackoverflow.com/questions/38728334/how-to-convert-a-type-os-fileinfo-into-a-string/38728441#38728441", "title": "How to convert a type []os.FileInfo into a string?", "body": "<p>The value returned by <code>ioutil.ReadDir</code> is a <code>[]os.FileInfo</code>, which is a slice of interfaces. There's no general way to convert that into a meaningful string. You want to compare the name for each file individually:</p>\n\n<pre><code>files, err := ioutil.ReadDir(\"./views\")\nif err != nil {\n    log.Fatal(err)\n}\n\nfor _, f := range files {\n    if strings.HasSuffix(f.Name(), \".html\") {\n        fmt.Println(f.Name())\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2871, "user_id": 3481111, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/UkbLs.jpg?s=128&g=1", "display_name": "Paulo Janeiro", "link": "https://stackoverflow.com/users/3481111/paulo-janeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2528, "favorite_count": 0, "accepted_answer_id": 38728441, "answer_count": 1, "score": 1, "last_activity_date": 1470202236, "creation_date": 1470163926, "last_edit_date": 1470202236, "question_id": 38728334, "link": "https://stackoverflow.com/questions/38728334/how-to-convert-a-type-os-fileinfo-into-a-string", "title": "How to convert a type []os.FileInfo into a string?", "body": "<p>I'm using this code to dynamically extract template filenames from a directory using this code:</p>\n\n<pre><code>files, _ := ioutil.ReadDir(\"./views\")\n    htmlFiles := \".html\"\n    for _, f := range files {\n        if strings.Contains(files, htmlFiles) {\n            fmt.Println(f.Name())\n        }\n    }\n</code></pre>\n\n<p>and I'm getting this error:</p>\n\n<pre><code>cannot use files (type []os.FileInfo) as type string in argument to strings.Contains\n</code></pre>\n\n<p>So, how to convert <code>type []os.FileInfo</code> into a <code>string</code> (or how do to this in a simpler way)?</p>\n"}, {"tags": ["go", "build", "compilation", "vendor"], "comments": [{"owner": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470160740, "post_id": 38727203, "comment_id": 64830700, "body": "No it does. See <a href=\"https://engineeredweb.com/blog/2015/go-1.5-vendor-handling/\" rel=\"nofollow noreferrer\">engineeredweb.com/blog/2015/go-1.5-vendor-handling</a> and <a href=\"http://stackoverflow.com/questions/37253780/go-golang-vendor-experiment-failing-on-mac-osx?rq=1\" title=\"go golang vendor experiment failing on mac osx\">stackoverflow.com/questions/37253780/&hellip;</a> . It works with my other apps but not this one i just imported"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470161575, "post_id": 38727203, "comment_id": 64831242, "body": "You&#39;re right, it will walk up there (though I still wouldn&#39;t recommend it). Do you have any symlinks in your <code>GOPATH</code> or <code>vendor</code> dir? Are you trying to use any relative import paths?"}, {"owner": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470167291, "post_id": 38727203, "comment_id": 64834674, "body": "Nope no symlinks. As for relative import paths, I don&#39;t think so. All importing is done through the 3rd party package <a href=\"https://github.com/evnix/boltdbweb\" rel=\"nofollow noreferrer\">github.com/evnix/boltdbweb</a> and its dependencies"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470168085, "post_id": 38727203, "comment_id": 64835143, "body": "The only way I can reproduce this is if the <code>github.com&#47;boltdb&#47;bolt</code> dependency is completely missing. If you vendor&#39;ed that manually, are you sure there are no typos in the path? Are you using a vendor&#39;ing tool to manage the dependencies?"}, {"owner": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470180402, "post_id": 38727203, "comment_id": 64840212, "body": "There are no typos. If there was a typo, I think it should show cannot find package &quot;typo&quot; in any of: $GOPATH/..., $GOROOT/..., $GOPATH/src/vendor . No vendoring tools used either"}], "owner": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1130, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470159948, "creation_date": 1470159948, "question_id": 38727203, "link": "https://stackoverflow.com/questions/38727203/golang-vendor-not-detecting", "title": "Golang vendor not detecting", "body": "<p>I git cloned this specific repo <a href=\"https://github.com/evnix/boltdbweb\" rel=\"nofollow\">https://github.com/evnix/boltdbweb</a> into my environment in $GOPATH/src/somesetofpaths</p>\n\n<p>I also ran go get on the dependencies, but with this specific dependency </p>\n\n<p>go get github.com/boltdb/bolt/...</p>\n\n<p>I want it in vendor rather than src/github.com/...</p>\n\n<p>But when I run go build, I'm getting \n../../../github.com/evnix/boltdbweb/web/index.go:6:2: cannot find package \"github.com/boltdb/bolt\" in any of:\n    /opt/homebrew/Cellar/go/1.6.2/libexec/src/github.com/boltdb/bolt (from $GOROOT)\n    $GOPATH/src/github.com/boltdb/bolt (from $GOPATH)</p>\n\n<p>meaning it's not looking in the vendor directory.</p>\n\n<p>The thing is... it's only this package that's not looking in vendor. I have other projects in $GOPATH/src/someproject1/ , $GOPATH/src/someproject2/ that are building properly using code in $GOPATH/src/vendor. What am I missing?</p>\n\n<p>This is my go env</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=(omitted)\nGORACE=\"\"\nGOROOT=\"/opt/homebrew/Cellar/go/1.6.2/libexec\"\nGOTOOLDIR=\"/opt/homebrew/Cellar/go/1.6.2/libexec/pkg/tool/darwin_amd64\"\nGO15VENDOREXPERIMENT=\"1\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n"}, {"tags": ["testing", "go", "server", "code-coverage"], "answers": [{"tags": [], "owner": {"reputation": 3010, "user_id": 519557, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/x9V4f.jpg?s=128&g=1", "display_name": "jxstanford", "link": "https://stackoverflow.com/users/519557/jxstanford"}, "is_accepted": false, "score": 1, "last_activity_date": 1470186805, "creation_date": 1470186805, "answer_id": 38732825, "question_id": 38726938, "link": "https://stackoverflow.com/questions/38726938/how-can-i-get-code-coverage-from-my-golang-server/38732825#38732825", "title": "How can I get code coverage from my Golang Server?", "body": "<p>Here's what I do:</p>\n\n<pre><code>godep go test -coverprofile cover.out `go list ./... | grep -v vendor`\ngo tool cover -html=cover.out\n</code></pre>\n\n<p>That generates a coverage report and then opens a browser window to view it.</p>\n"}], "owner": {"reputation": 11, "user_id": 6668920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0175ce309f605ddf8804667ab4a47ba?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Biecher", "link": "https://stackoverflow.com/users/6668920/guy-biecher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1470202364, "creation_date": 1470158861, "last_edit_date": 1470202364, "question_id": 38726938, "link": "https://stackoverflow.com/questions/38726938/how-can-i-get-code-coverage-from-my-golang-server", "title": "How can I get code coverage from my Golang Server?", "body": "<p>I am using goconvey and other tools to get the code coverage.<br>\nThis produces a test coverage report but it only shows the coverage for the test case code.<br>\nAPI is hosted on the a Golang server.<br>\nI would like to know how much server side code is covered by my<br>\n<code>tests(unit,integreation,system tests)</code>.<br>\nHow should I do this? </p>\n"}, {"tags": ["go", "c-strings", "unsafe", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470158430, "post_id": 38726758, "comment_id": 64829413, "body": "One would normally make the <code>Name</code> field a <code>*byte</code> rather than an <code>unsafe.Pointer</code>. Look for examples in the syscall package, like: <a href=\"https://golang.org/pkg/syscall/#Iovec\" rel=\"nofollow noreferrer\">golang.org/pkg/syscall/#Iovec</a>"}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470169649, "post_id": 38726758, "comment_id": 64835945, "body": "Ah yes that makes more sense!"}], "tags": [], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "is_accepted": false, "score": 0, "last_activity_date": 1470158266, "creation_date": 1470158266, "answer_id": 38726758, "question_id": 38726704, "link": "https://stackoverflow.com/questions/38726704/convert-go-string-to-c-string-without-cgo/38726758#38726758", "title": "Convert Go string to C string without CGo", "body": "<p>Ah found the answer (well something that compiles anyway). First cast to <code>[]byte</code>, then take the address of the first element:</p>\n\n<pre><code>func int_bind(ksock int, name string, is_replier uint32) int {\n\n    bind_request := &amp;kbus_bind_request{}\n\n    s := []byte(name)\n\n    bind_request.name = unsafe.Pointer(&amp;s[0])\n    bind_request.name_len = uint32(len(s))\n    bind_request.is_replier = is_replier\n\n    rv := ioctl(ksock, KBUS_IOC_BIND, unsafe.Pointer(bind_request))\n\n    if rv != 0 {\n        return -int(rv)\n    }\n    return 0\n}\n</code></pre>\n"}], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 586, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470158266, "creation_date": 1470158074, "question_id": 38726704, "link": "https://stackoverflow.com/questions/38726704/convert-go-string-to-c-string-without-cgo", "title": "Convert Go string to C string without CGo", "body": "<p>I'm trying to call some ioctls from Go, and some of them take C strings as parameters. For example, in C:</p>\n\n<pre><code>/* When the user asks to bind a message name to an interface, they use: */\nstruct kbus_bind_request {\n    __u32 is_replier;   /* are we a replier? */\n    __u32 name_len;\n    char *name;\n};\n\nextern int kbus_ksock_bind(kbus_ksock_t         ksock,\n                           const char          *name,\n                           uint32_t             is_replier)\n{\n  int   rv;\n  kbus_bind_request_t   bind_request;\n\n  bind_request.name = (char *) name;\n  bind_request.name_len = strlen(name);\n  bind_request.is_replier = is_replier;\n\n  rv = ioctl(ksock, KBUS_IOC_BIND, &amp;bind_request);\n  if (rv &lt; 0)\n    return -errno;\n  else\n    return rv;\n}\n</code></pre>\n\n<p>I converted the struct to a Go struc like this:</p>\n\n<pre><code>type kbus_bind_request struct {\n    is_replier uint32 /* are we a replier? */\n    name_len   uint32\n    name       unsafe.Pointer // char*\n}\n</code></pre>\n\n<p>Now, how do I convert a Go <code>string</code> to a C string stored in an <code>unsafe.Pointer</code>? I don't want to use CGo as I am cross-compiling and it makes things a pain.</p>\n"}, {"tags": ["go", "casting", "type-conversion", "protocol-buffers", "grpc"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1470152568, "post_id": 38724811, "comment_id": 64825871, "body": "no, there are no other (safe) ways to do it. Slices are invariant, and you have to copy them to change the type of each element. It&#39;s the same concept as <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a>"}], "answers": [{"tags": [], "owner": {"reputation": 177, "user_id": 5086822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853c6f82008ed7b4728c143159e206f1?s=128&d=identicon&r=PG", "display_name": "Zhuharev", "link": "https://stackoverflow.com/users/5086822/zhuharev"}, "is_accepted": true, "score": 3, "last_activity_date": 1470153140, "creation_date": 1470153140, "answer_id": 38725190, "question_id": 38724811, "link": "https://stackoverflow.com/questions/38724811/golang-type-conversion-between-slice-of-pointers-to-slice-of-a-type-to-slice-of/38725190#38725190", "title": "Golang type conversion between slice of pointers to slice of a type to slice of another", "body": "<p>use <code>for</code> loop for convert each value in slice. no other way</p>\n\n<p><a href=\"https://play.golang.org/p/oQi6oVz6My\" rel=\"nofollow\">https://play.golang.org/p/oQi6oVz6My</a></p>\n"}], "owner": {"reputation": 988, "user_id": 1492846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad675aa5393ea400d2e54e08ff50d6c4?s=128&d=identicon&r=PG&f=1", "display_name": "bn00d", "link": "https://stackoverflow.com/users/1492846/bn00d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3220, "favorite_count": 0, "accepted_answer_id": 38725190, "answer_count": 1, "score": 0, "last_activity_date": 1470202598, "creation_date": 1470152034, "last_edit_date": 1470202598, "question_id": 38724811, "link": "https://stackoverflow.com/questions/38724811/golang-type-conversion-between-slice-of-pointers-to-slice-of-a-type-to-slice-of", "title": "Golang type conversion between slice of pointers to slice of a type to slice of another", "body": "<p>I am new to Golang.<br>\nWhen I try it I get a compile error:</p>\n\n<pre><code>cannot use a.B (type []*C) as type []Z in field value\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>package main\n\ntype A struct {\n    B []*C\n}\n\ntype C struct {\n    char string\n}\n\ntype X struct {\n    Y []Z\n}\n\ntype Z struct {\n    char string\n}\n\nfunc doSomething(r interface{}) X {\n    a := r.(*A)\n    return X{\n        Y: a.B, // cannot use a.B (type []*C) as type []Z in field value\n    }\n}\n\nfunc main() {\n    something := &amp;C{\"abc\"}\n    somewhere := A{}\n    somewhere.B = []*C{something}\n\n    doSomething(somewhere)\n}\n</code></pre>\n\n<p>The way I am thinking of getting around is by iterating over the slice and assigning it to another. But I know there must be other ways to do it.</p>\n\n<p>Go playground: <a href=\"https://play.golang.org/p/v0PUTPh6Mt\" rel=\"nofollow\">https://play.golang.org/p/v0PUTPh6Mt</a></p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1470173230, "post_id": 38724556, "comment_id": 64837743, "body": "This sound like a joke. Usually is go generated from proto and I cannot imagine useful case to do it upside down. For such primitive case like this is not a problem write *.proto directly. And for more complicated cases (enums, oneof, ...) every tool is useless."}, {"owner": {"reputation": 1694, "user_id": 544287, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/ha1kg.jpg?s=128&g=1", "display_name": "Ant", "link": "https://stackoverflow.com/users/544287/ant"}, "edited": false, "score": 7, "creation_date": 1541380316, "post_id": 38724556, "comment_id": 93185343, "body": "It doesn&#39;t sound like a joke to me... I have a large go project, and I need now to implement some gRPC communication, and such a tol would be useful to convert from proto float32 -&gt; float64, etc..."}], "answers": [{"comments": [{"owner": {"reputation": 6309, "user_id": 2263949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeab61900e08675dbd0d3a3fd8b56a0e?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/2263949/jonathan"}, "edited": false, "score": 0, "creation_date": 1502413609, "post_id": 45625408, "comment_id": 78210642, "body": "To avoid getting voted down / flagged, you should put more than just a link.  Put in the essential information so that if ever the link is broken, the answer would still be valid."}, {"owner": {"reputation": 218, "user_id": 4152293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b38dbce528fde3e5d006673f44eb28?s=128&d=identicon&r=PG&f=1", "display_name": "Ker Li", "link": "https://stackoverflow.com/users/4152293/ker-li"}, "reply_to_user": {"reputation": 6309, "user_id": 2263949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeab61900e08675dbd0d3a3fd8b56a0e?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/2263949/jonathan"}, "edited": false, "score": 3, "creation_date": 1502424291, "post_id": 45625408, "comment_id": 78212858, "body": "I&#39;m sorry, This is the first time I&#39;ve written an answer. I&#39;ll pay attention later"}, {"owner": {"reputation": 6309, "user_id": 2263949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeab61900e08675dbd0d3a3fd8b56a0e?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/2263949/jonathan"}, "edited": false, "score": 0, "creation_date": 1502424501, "post_id": 45625408, "comment_id": 78212921, "body": "Great job on the edit!  Unfortunately, I don&#39;t know whether this really answers the question since I don&#39;t know Go, but hopefully whoever down-voted will see your update and retract/upvote if it is good."}], "tags": [], "owner": {"reputation": 218, "user_id": 4152293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b38dbce528fde3e5d006673f44eb28?s=128&d=identicon&r=PG&f=1", "display_name": "Ker Li", "link": "https://stackoverflow.com/users/4152293/ker-li"}, "is_accepted": true, "score": 19, "last_activity_date": 1502422883, "last_edit_date": 1502422883, "creation_date": 1502412775, "answer_id": 45625408, "question_id": 38724556, "link": "https://stackoverflow.com/questions/38724556/generate-proto-file-from-golang-struct/45625408#45625408", "title": "Generate proto file from golang struct", "body": "<p>I'm find the package,Generate .proto files from Go source code:\n<a href=\"https://github.com/src-d/proteus\" rel=\"noreferrer\">proteus (https://github.com/src-d/proteus)</a></p>\n\n<p>Proteus /pro\u028ati\u0259s/ is a tool to generate protocol buffers version 3 compatible .proto files from your Go structs, types and functions.</p>\n\n<p>The motivation behind this library is to use Go as a source of truth for your models instead of the other way around and then generating Go code from a .proto file, which does not generate idiomatic code.</p>\n\n<p><strong>Generate protobuf messages</strong></p>\n\n<pre><code>  //proteus:generate\n  type User struct {\n        Model\n        Username string\n  }\n\n  type Model struct {\n        ID int\n        CreatedAt time.Time\n  }\n</code></pre>\n\n<p>This example will generate the following protobuf message.</p>\n\n<pre><code>  message User {\n          int32 id = 1;\n          google.protobuf.Timestamp created_at = 2;\n          string username = 3;\n  }\n</code></pre>\n\n<p><strong>Install</strong></p>\n\n<pre><code> go get -v gopkg.in/src-d/proteus.v1/...\n</code></pre>\n\n<p><strong>Requirements</strong></p>\n\n<p>There are two requirements for the full process.</p>\n\n<pre><code> protoc binary installed on your path\n go get -u github.com/gogo/protobuf/...\n</code></pre>\n\n<p><strong>Usage</strong></p>\n\n<p>You can generate the proto files, the marshal/unmarshal and the rest of protobuf stuff for your Go types, the RPC client and server interface and the RPC server implementation for your packages. That is, the whole process.</p>\n\n<pre><code> proteus -f /path/to/protos/folder \\\n    -p my/go/package \\\n    -p my/other/go/package\n</code></pre>\n\n<p>You can generate proto files only using the command line tool provided with proteus.</p>\n\n<pre><code> proteus proto -f /path/to/output/folder \\\n    -p my/go/package \\\n    -p my/other/go/package\n    --verbose\n</code></pre>\n\n<p>You can also only generate gRPC server implementations for your packages.</p>\n\n<pre><code>  proteus rpc -p my/go/package \\\n    -p my/other/go/package\n</code></pre>\n\n<p>NOTE: Of course, if the defaults don't suit your needs, until proteus is extensible via plugins, you can hack together your own generator command using the provided components. Check out the godoc documentation of the package.</p>\n"}, {"tags": [], "owner": {"reputation": 3596, "user_id": 2481780, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IlH4E.jpg?s=128&g=1", "display_name": "Andzej Maciusovic", "link": "https://stackoverflow.com/users/2481780/andzej-maciusovic"}, "is_accepted": false, "score": 2, "last_activity_date": 1553099067, "creation_date": 1553099067, "answer_id": 55265633, "question_id": 38724556, "link": "https://stackoverflow.com/questions/38724556/generate-proto-file-from-golang-struct/55265633#55265633", "title": "Generate proto file from golang struct", "body": "<p>If anyone just need to generate pure protobuf messages without any gogo, mogo, blogo syntax you can use <a href=\"https://github.com/anjmao/go2proto\" rel=\"nofollow noreferrer\">https://github.com/anjmao/go2proto</a> which I wrote recently. It's super simple and just generates proto messages from given go source package containing structs. Also it supports go modules.</p>\n"}], "owner": {"reputation": 5101, "user_id": 153586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bc43786cfcbc75521a28870e76759c1?s=128&d=identicon&r=PG", "display_name": "Sankar", "link": "https://stackoverflow.com/users/153586/sankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10901, "favorite_count": 2, "accepted_answer_id": 45625408, "answer_count": 2, "score": 12, "last_activity_date": 1553099067, "creation_date": 1470151393, "question_id": 38724556, "link": "https://stackoverflow.com/questions/38724556/generate-proto-file-from-golang-struct", "title": "Generate proto file from golang struct", "body": "<p>I have a golang struct which contains references to some other structs. Is there an automated way to generate the .proto file from the structs ?</p>\n\n<p>For example:</p>\n\n<pre><code>type A struct {\n a int\n b B\n}\n\ntype B struct {\n c []C\n}\n\ntype C struct {\n x int\n}\n</code></pre>\n\n<p>should generate:</p>\n\n<p><code>message A, B, C</code> etc. proto3 is preferred. </p>\n\n<p><a href=\"https://github.com/kubernetes/kubernetes/tree/master/cmd/libs/go2idl\" rel=\"noreferrer\">https://github.com/kubernetes/kubernetes/tree/master/cmd/libs/go2idl</a> seems to have something related but is undocumented. Any options ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1470149531, "post_id": 38723638, "comment_id": 64823532, "body": "How is the html generated? Do you know where it is at compile time? You could use absolute paths or pass it in as a command line argument"}, {"owner": {"reputation": 2871, "user_id": 3481111, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/UkbLs.jpg?s=128&g=1", "display_name": "Paulo Janeiro", "link": "https://stackoverflow.com/users/3481111/paulo-janeiro"}, "reply_to_user": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1470150914, "post_id": 38723638, "comment_id": 64824609, "body": "@BenjaminKadish I&#39;m having trouble understanding this...For example, if only one binary file is created I assume it has everything in it so path that are ok for go run should be ok for go install...I&#39;ll take a look at the libraries suggested below."}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 3481111, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/UkbLs.jpg?s=128&g=1", "display_name": "Paulo Janeiro", "link": "https://stackoverflow.com/users/3481111/paulo-janeiro"}, "edited": false, "score": 0, "creation_date": 1470151711, "post_id": 38724099, "comment_id": 64825265, "body": "So moving my binary file to the same folder as <code>main.go</code> would solve it. Do you see any issues with that when in production or is it irrelevant?"}, {"owner": {"reputation": 27181, "user_id": 1070354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56ca246e6d24b9a09114ff4542bcc2b1?s=128&d=identicon&r=PG", "display_name": "favoretti", "link": "https://stackoverflow.com/users/1070354/favoretti"}, "reply_to_user": {"reputation": 2871, "user_id": 3481111, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/UkbLs.jpg?s=128&g=1", "display_name": "Paulo Janeiro", "link": "https://stackoverflow.com/users/3481111/paulo-janeiro"}, "edited": false, "score": 0, "creation_date": 1470152863, "post_id": 38724099, "comment_id": 64826095, "body": "Well, yeah, that&#39;s a very straightforward approach. Depending on how you want to distribute your binary it might work it might now, it&#39;s quite dependant :) In general, if you are going to run it on a unix system, placing binary somewhere in <code>&#47;usr&#47;bin</code> or <code>&#47;usr&#47;local&#47;bin</code> would be advisable, and placing static resources somewhere under <code>&#47;usr&#47;share&#47;appname</code> or so. That can be solved with packaging. Then you can use absolute paths. Ideally I&#39;d make them configurable with sane defaults."}], "tags": [], "owner": {"reputation": 27181, "user_id": 1070354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56ca246e6d24b9a09114ff4542bcc2b1?s=128&d=identicon&r=PG", "display_name": "favoretti", "link": "https://stackoverflow.com/users/1070354/favoretti"}, "is_accepted": true, "score": 2, "last_activity_date": 1470150220, "creation_date": 1470150220, "answer_id": 38724099, "question_id": 38723638, "link": "https://stackoverflow.com/questions/38723638/path-that-is-working-with-go-run-is-not-working-with-go-install-calling-the-exec/38724099#38724099", "title": "Path that is working with go run is not working with go install/calling the executable from bin", "body": "<p>If you specify a relative path in your code, as in <code>views/edit.html</code> it will also be looked up relative to the binary location. You need to either make the path absolute, or use some logic to determine where your templates will be located.</p>\n\n<p>Another option would be to use <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow\">https://github.com/jteeuwen/go-bindata</a> or <a href=\"https://github.com/elazarl/go-bindata-assetfs\" rel=\"nofollow\">https://github.com/elazarl/go-bindata-assetfs</a> that will save you the hassle.</p>\n"}], "owner": {"reputation": 2871, "user_id": 3481111, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/UkbLs.jpg?s=128&g=1", "display_name": "Paulo Janeiro", "link": "https://stackoverflow.com/users/3481111/paulo-janeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 38724099, "answer_count": 1, "score": -1, "last_activity_date": 1470150220, "creation_date": 1470149107, "question_id": 38723638, "link": "https://stackoverflow.com/questions/38723638/path-that-is-working-with-go-run-is-not-working-with-go-install-calling-the-exec", "title": "Path that is working with go run is not working with go install/calling the executable from bin", "body": "<p>I'm starting to experiment with Go and I'm facing an issue that (I think) doesn't exist in languages that use a virtual machine.</p>\n\n<p>I have a <code>src/test/main.go</code> file that references my templates inside <code>src/test/views/</code> folder.\nWhen I use <code>go run main.go</code> it runs but when do <code>go install</code> and then inside my <code>bin</code> folder run the executable (<code>./test</code>) I get an error:</p>\n\n<pre><code>views/edit.html: no such file or directory\n</code></pre>\n\n<p>So, how does Go compiles my project (file/folder structure related) and how to use paths in a way that allows me to use either <code>go run</code> and <code>go install/executable</code>?</p>\n"}, {"tags": ["multithreading", "http", "go"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 2, "creation_date": 1470145391, "post_id": 38722143, "comment_id": 64820321, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/6807590/how-to-stop-a-goroutine\" title=\"how to stop a goroutine\">stackoverflow.com/questions/6807590/how-to-stop-a-goroutine</a>. Also read this article: <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">blog.golang.org/pipelines</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1470146044, "post_id": 38722143, "comment_id": 64820881, "body": "Also possible duplicate / related: 1. <a href=\"http://stackoverflow.com/questions/28240133/cancel-a-blocking-operation-in-go\">cancel a blocking operation in Go</a>; 2. <a href=\"http://stackoverflow.com/questions/31116870/goroutine-execution-inside-an-http-handler\">Goroutine execution inside an http handler</a>; 3. <a href=\"http://stackoverflow.com/questions/32470792/is-there-anyway-to-close-client-request-in-golang-gin\">Is there anyway to close client request in golang/gin?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1470146373, "creation_date": 1470146373, "answer_id": 38722575, "question_id": 38722143, "link": "https://stackoverflow.com/questions/38722143/how-to-stop-perform-request-created-with-httpclient/38722575#38722575", "title": "How to stop perform request created with HTTPClient", "body": "<p>I believe what you are looking for is the <a href=\"https://godoc.org/golang.org/x/net/context\" rel=\"nofollow\">context package</a>. There is a good blog article on golang.org explaining how to use it <a href=\"https://blog.golang.org/context\" rel=\"nofollow\">here</a>.</p>\n\n<p>The gist of it is, you create a context object, and pass it to your goroutine that is performing streaming. In your caller goroutine you can cancel the context or set a timeout. In the streaming goroutine you have to check for <code>context.Done()</code> and act accordingly.</p>\n\n<p>If the action is actually an http request that you want to cancel, you can do it at the <a href=\"https://golang.org/pkg/net/http/#Transport.CancelRequest\" rel=\"nofollow\">transport level</a> (when you get a message on <code>context.Done()</code>)</p>\n"}], "owner": {"reputation": 322, "user_id": 588650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KVeTQ.jpg?s=128&g=1", "display_name": "Vitold S.", "link": "https://stackoverflow.com/users/588650/vitold-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1470162381, "creation_date": 1470145291, "last_edit_date": 1470162381, "question_id": 38722143, "link": "https://stackoverflow.com/questions/38722143/how-to-stop-perform-request-created-with-httpclient", "title": "How to stop perform request created with HTTPClient", "body": "<p>How to stop perform request for example with audio or video stream by some condition like callback or similar like it doing in cURL?</p>\n"}, {"tags": ["oop", "go", "interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1470146000, "post_id": 38720366, "comment_id": 64820846, "body": "I think you&#39;re confusing embedding with inheritance here. There&#39;s no way to access the &quot;parent&quot; struct, without passing it as a parameter like any other (and the receiver itself is a parameter). Embedding interfaces is simply declaring that you&#39;re going to satisfy those interfaces."}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470147687, "post_id": 38720366, "comment_id": 64822110, "body": "@JimB  is there a better way of doing this <code>m.GetterA(m.(implementMain))</code> basically in the example I post, if I want to access data from an outer/parent I need to pass it as a reference, like you describe but I have to use type assertion, it works but just wondering if there is a better way of doing this"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1470148253, "post_id": 38720366, "comment_id": 64822618, "body": "I would really advise you to try to compose this differently. I can&#39;t imagine what you&#39;re trying to solve, but this looks like an attempt at inheritance-based OOP in Go. If it helps, one would normally operate on the struct value rather than the interface value, and let it be converted to an interface only as needed: <a href=\"https://play.golang.org/p/9H9z9qoLcc\" rel=\"nofollow noreferrer\">play.golang.org/p/9H9z9qoLcc</a>, but this circular dependency is usually not a good idea."}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470149204, "post_id": 38720366, "comment_id": 64823300, "body": "@JimB I was trying to test something and found this post <a href=\"http://nathanleclaire.com/blog/2015/10/10/interfaces-and-composition-for-effective-unit-testing-in-golang/\" rel=\"nofollow noreferrer\">nathanleclaire.com/blog/2015/10/10/&hellip;</a> in where basically operates at a interface level rather than struct and is what confused me"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470154629, "post_id": 38720366, "comment_id": 64827291, "body": "operating on interfaces is fine, and allows you to plug in other implementations, but interfaces themselves aren&#39;t your problem here. The base of the problem is the circular dependency between the embedded value and the outer value. Why doesn&#39;t <code>implementMain</code> implement it&#39;s own method for fetching <code>data</code>? If <code>SubInterfaceB</code> needs to operate on that, have the outer method chain the call and provide the value."}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470165076, "post_id": 38720366, "comment_id": 64833401, "body": "@JimB thank for the comments, Is more clear for me now, basically if I am right, while operating on interfaces and depending on the required data, could be the case that more methods setters/getters would be needed"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470140688, "creation_date": 1470140688, "question_id": 38720366, "link": "https://stackoverflow.com/questions/38720366/how-to-deal-with-embedded-interfaces-and-share-data-between-them", "title": "how to deal with embedded interfaces and share data between them", "body": "<p>I would like to better understand how to use interfaces, mainly to split code in reusable components and at the same time make it more easy for testing, currently my main question is how to share/get data between the interfaces that belong to a main interface, for example: </p>\n\n<p><a href=\"https://play.golang.org/p/67CQor1_pY\" rel=\"nofollow\">https://play.golang.org/p/67CQor1_pY</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype MainInterface interface {\n    SubInterfaceA\n    SubInterfaceB\n}\n\ntype SubInterfaceA interface {\n    MethodA()\n    GetterA(s implementMain)\n}\n\ntype SubInterfaceB interface {\n    MethodB()\n    GetterB(s implementMain)\n}\n\ntype implementA struct{}\n\nfunc (ia *implementA) MethodA() { fmt.Println(\"I am method A\") }\nfunc (ia *implementA) GetterA(s implementMain) {\n    fmt.Println(s.Data)\n}\n\ntype implementB struct{}\n\nfunc (ib *implementB) MethodB() { fmt.Println(\"I am method B\") }\nfunc (ib *implementB) GetterB(s implementMain) {\n    fmt.Println(s.Data)\n}\n\ntype implementMain struct {\n    Data string\n    SubInterfaceA\n    SubInterfaceB\n}\n\nfunc New(d string) implementMain {\n    return implementMain{\n        Data:          d,\n        SubInterfaceA: &amp;implementA{},\n        SubInterfaceB: &amp;implementB{},\n    }\n}\n\nfunc main() {\n    var m MainInterface\n\n    m = New(\"something\")\n\n    fmt.Println(m.(implementMain).Data)\n\n    m.MethodA()                  // prints I am method A\n    m.MethodB()                  // prints I am method B\n    m.GetterA(m.(implementMain)) // prints \"something\"\n    m.GetterB(m.(implementMain)) // prints \"something\"\n}\n</code></pre>\n\n<p>In the above code, within the methods of struct <code>implementA</code> or <code>implementB</code> how to  access the struct elements of the parent holder  <code>implementMain</code> that implements <code>MainInterface</code> without passing it  as an argument?</p>\n\n<p>with holder struct I mean:</p>\n\n<pre><code>type implementMain struct {\n    Data string\n    SubInterfaceA\n    SubInterfaceB\n}\n</code></pre>\n\n<p>If I am right <code>SubInterfaceA</code> and <code>SubInterfaceB</code> are embedded and help to make the struct <code>implementMain</code> satisfy the <code>MainInterface</code>:</p>\n\n<pre><code>type MainInterface interface {                                                                                                                                                                                                                                              \n   SubInterfaceA                                                                                                                                                                                                                                                           \n   SubInterfaceB                                                                                                                                                                                                                                                           \n} \n</code></pre>\n\n<p>But within the embedded methods of the <code>SubInterfaceA</code> or <code>subInterfaceB</code> what is the best practice to use in order to be available to get the <code>data string</code>?</p>\n\n<p>I created <code>Getter(s implementMain)</code> method and passed the <strong>holder</strong> struct, but had to cast type:</p>\n\n<pre><code>m.GetterA(m.(implementMain)) \n</code></pre>\n\n<p>I don't know if by satisfying a interface, all the involved interfaces can become part of the same structure scope and if they do, how to get/share data between them or either between its components?, for example besides been available to reach <code>data string</code> how from <code>SubInterfaceA</code> get/access <code>SubInterfaceB</code> </p>\n"}, {"tags": ["go", "bson", "mgo", "revel"], "answers": [{"comments": [{"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1470196985, "post_id": 38718373, "comment_id": 64843949, "body": "Thanks! I was playing around with the code and wrote exactly this later on and saw your answer now! Thank you!"}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 0, "last_activity_date": 1470134935, "creation_date": 1470134935, "answer_id": 38718373, "question_id": 38718097, "link": "https://stackoverflow.com/questions/38718097/revel-with-mgo-v2-how-to-return-all-data-from-a-collection-as-json/38718373#38718373", "title": "Revel with mgo.v2 - How to return all data from a collection as json?", "body": "<p>The error in your code is because of type mismatch between function <code>GetCategories</code>'s return value declaration and what you are actually returning. To fix, change the return type to return a slice of results:</p>\n\n<pre><code>func GetCategories(s *mgo.Session) []Category {\n    var results []Category\n    Collection(s).Find(nil).All(&amp;results)\n    return results\n}\n</code></pre>\n"}], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 38718373, "answer_count": 1, "score": 0, "last_activity_date": 1470134935, "creation_date": 1470134125, "question_id": 38718097, "link": "https://stackoverflow.com/questions/38718097/revel-with-mgo-v2-how-to-return-all-data-from-a-collection-as-json", "title": "Revel with mgo.v2 - How to return all data from a collection as json?", "body": "<p>I'm trying to build an API endpoint using Revel for Go.</p>\n\n<p>My models/models.go looks like this -</p>\n\n<pre><code>type Category struct {\nName string        `bson:\"name\"`\nSlug  string        `bson:\"slug\"`}\n\nfunc GetCategories(s *mgo.Session) *Category {\nvar results []Category\nCollection(s).Find(nil).All(&amp;results)\nreturn results}\n</code></pre>\n\n<p>My controllers/book.go looks like this -</p>\n\n<pre><code>type Category struct {\n*revel.Controller\nrevelbasic.MongoController}\n\nfunc (c Category) Categories() revel.Result {\nb := models.GetCategories(c.MongoSession)\n\nreturn c.RenderJson(b)}\n</code></pre>\n\n<p>I've configured my conf/routes like this -</p>\n\n<pre><code>GET /categories Book.Categories\n</code></pre>\n\n<p>When I run the code, I get this error - </p>\n\n<p><a href=\"http://i.stack.imgur.com/MBKQE.png\" rel=\"nofollow\">cannot use results (type []Category) as type *Category in return argument</a></p>\n\n<p>I understand that I'm doing something wrong with the database query.\nPlease help!</p>\n"}, {"tags": ["github", "go", "package"], "comments": [{"owner": {"reputation": 930, "user_id": 4328963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/505Lz.png?s=128&g=1", "display_name": "huygn", "link": "https://stackoverflow.com/users/4328963/huygn"}, "edited": false, "score": 7, "creation_date": 1470131571, "post_id": 38717033, "comment_id": 64810555, "body": "You would have the same problem in any other languages if the package author remove their package. You may use tools like <a href=\"https://github.com/Masterminds/glide\" rel=\"nofollow noreferrer\">glide</a> to download &amp; strip vendor package&#39;s vcs to push package files to your own repo."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1470141265, "post_id": 38717033, "comment_id": 64817196, "body": "See also the <a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"nofollow noreferrer\">wiki entry on package management for Go</a>. Other tools which are on the hype today are (in no particular order): <code>godep</code>, <code>govendor</code> and <code>gb</code>."}, {"owner": {"reputation": 741, "user_id": 116973, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58f3dd702b0b3beb1274a25326ab2069?s=128&d=identicon&r=PG", "display_name": "Martin M.", "link": "https://stackoverflow.com/users/116973/martin-m"}, "edited": false, "score": 0, "creation_date": 1470143390, "post_id": 38717033, "comment_id": 64818777, "body": "It is actually an interesting question. Maybe not phrased perfectly but it is very much akin to the whole vendoring and dependency management discussion"}], "answers": [{"comments": [{"owner": {"reputation": 370, "user_id": 4045924, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8853b251dfbea91580907dbdaf445bd3?s=128&d=identicon&r=PG&f=1", "display_name": "DailyFrankPeter", "link": "https://stackoverflow.com/users/4045924/dailyfrankpeter"}, "edited": false, "score": 3, "creation_date": 1519557305, "post_id": 38717439, "comment_id": 84950554, "body": "So this basically says: &quot;No, you cannot import packages directly from Github in Go. Its the tutorial that just makes it sound like that.&quot; Correct?"}, {"owner": {"reputation": 1547, "user_id": 2969841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ABgFw.jpg?s=128&g=1", "display_name": "tsabsch", "link": "https://stackoverflow.com/users/2969841/tsabsch"}, "reply_to_user": {"reputation": 370, "user_id": 4045924, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8853b251dfbea91580907dbdaf445bd3?s=128&d=identicon&r=PG&f=1", "display_name": "DailyFrankPeter", "link": "https://stackoverflow.com/users/4045924/dailyfrankpeter"}, "edited": false, "score": 0, "creation_date": 1519584470, "post_id": 38717439, "comment_id": 84959144, "body": "Yes, you have to download a package to be able to use it."}, {"owner": {"reputation": 408, "user_id": 9290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iquFR.png?s=128&g=1", "display_name": "isuldor", "link": "https://stackoverflow.com/users/9290/isuldor"}, "edited": false, "score": 8, "creation_date": 1555800052, "post_id": 38717439, "comment_id": 98228501, "body": "github.com/MakeNowJust/heredoc <i>is</i> a url and &quot;RTFM&quot; is not a high quality answer that the votes on this would suggest."}, {"owner": {"reputation": 1060, "user_id": 1727288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6f87f7fef5f4704e31d3ebf93b33f8f?s=128&d=identicon&r=PG", "display_name": "bain", "link": "https://stackoverflow.com/users/1727288/bain"}, "edited": false, "score": 1, "creation_date": 1562257771, "post_id": 38717439, "comment_id": 100330094, "body": "github.com/MakeNowJust/heredo isn&#39;t a valid URL - a hostname is present, which implies an absolute URL, but <a href=\"https://tools.ietf.org/html/rfc3986#section-4.3\" rel=\"nofollow noreferrer\">RFC3986 section 4.3</a> specifies that absolute URIs must have a mandatory scheme prefix (http, https, ftp etc.)."}], "tags": [], "owner": {"reputation": 1547, "user_id": 2969841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ABgFw.jpg?s=128&g=1", "display_name": "tsabsch", "link": "https://stackoverflow.com/users/2969841/tsabsch"}, "is_accepted": true, "score": 50, "last_activity_date": 1470132262, "creation_date": 1470132262, "answer_id": 38717439, "question_id": 38717033, "link": "https://stackoverflow.com/questions/38717033/golang-importing-packages-from-github-requests-me-to-remember-the-github-url/38717439#38717439", "title": "Golang, importing packages from Github requests me to remember the Github URL?", "body": "<p>I would recommend you to read the <a href=\"https://golang.org/doc/code.html\">How to Write Go Code</a> documentation and <a href=\"https://blog.golang.org/organizing-go-code\">this</a> blog post.</p>\n\n<p>The path you're seeing in your import line is not a url, but only the path the package is located in (normally relative to <code>$GOROOT/src/pkg</code> or <code>$GOPATH/src</code>). So your package <code>heredoc</code> is most probably located in the directory <code>$GOPATH/src/github.com/MakeNowJust/heredoc</code>.</p>\n\n<p>The recommended way to use external packages is by downloading and installing them via <code>go get</code>. You might want to check out the documentation of go get by <code>go get --help</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1518, "user_id": 591004, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/038dd79c1cd086e1c0d2d001771bf982?s=128&d=identicon&r=PG", "display_name": "derFunk", "link": "https://stackoverflow.com/users/591004/derfunk"}, "edited": false, "score": 4, "creation_date": 1537444318, "post_id": 38736482, "comment_id": 91791774, "body": "Glilde is deprecated, use <code>go dep</code> for package management instead. For this question you don&#39;t need it though."}, {"owner": {"reputation": 155, "user_id": 2955337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a62309e92cf8c8999619490a43f716b4?s=128&d=identicon&r=PG&f=1", "display_name": "sleepyhead", "link": "https://stackoverflow.com/users/2955337/sleepyhead"}, "edited": false, "score": 0, "creation_date": 1613464336, "post_id": 38736482, "comment_id": 117075811, "body": "go dep was the correct answer, but now it is replaced by mod <a href=\"https://golang.github.io/dep/docs/introduction.html\" rel=\"nofollow noreferrer\">golang.github.io/dep/docs/introduction.html</a> <a href=\"https://golang.org/ref/mod#go-mod-download\" rel=\"nofollow noreferrer\">golang.org/ref/mod#go-mod-download</a>"}], "tags": [], "owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "is_accepted": false, "score": 1, "last_activity_date": 1470207421, "creation_date": 1470207421, "answer_id": 38736482, "question_id": 38717033, "link": "https://stackoverflow.com/questions/38717033/golang-importing-packages-from-github-requests-me-to-remember-the-github-url/38736482#38736482", "title": "Golang, importing packages from Github requests me to remember the Github URL?", "body": "<p>dont worry man! you can use <a href=\"https://github.com/Masterminds/glide\" rel=\"nofollow\">glide</a> tool for package management</p>\n"}, {"tags": [], "owner": {"reputation": 408, "user_id": 9290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iquFR.png?s=128&g=1", "display_name": "isuldor", "link": "https://stackoverflow.com/users/9290/isuldor"}, "is_accepted": false, "score": 1, "last_activity_date": 1555801699, "creation_date": 1555801699, "answer_id": 55778522, "question_id": 38717033, "link": "https://stackoverflow.com/questions/38717033/golang-importing-packages-from-github-requests-me-to-remember-the-github-url/55778522#55778522", "title": "Golang, importing packages from Github requests me to remember the Github URL?", "body": "<p>The path that import statement refers is just appended to <code>$GOPATH/src</code>. So that import statement basically says \"import the package located at <code>$GOPATH/src/github.com/MakeNowJust/heredoc</code>\"</p>\n\n<blockquote>\n  <p>What if later the author of the package removed it or changed the URL?</p>\n</blockquote>\n\n<p>As long as you already have the source files for that package at the expected location, it should be included even if the repo has moved.</p>\n"}], "owner": {"reputation": 991, "user_id": 1572028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3c18fd15010927238391dd5049f0d98?s=128&d=identicon&r=PG", "display_name": "user130268", "link": "https://stackoverflow.com/users/1572028/user130268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50259, "favorite_count": 1, "accepted_answer_id": 38717439, "answer_count": 3, "score": 34, "last_activity_date": 1555801699, "creation_date": 1470131171, "question_id": 38717033, "link": "https://stackoverflow.com/questions/38717033/golang-importing-packages-from-github-requests-me-to-remember-the-github-url", "title": "Golang, importing packages from Github requests me to remember the Github URL?", "body": "<p>I'm very new to Golang. I see that in Golang you can import packages directly from Github like:</p>\n\n<pre><code>import \"github.com/MakeNowJust/heredoc\"\n</code></pre>\n\n<p>Does that mean I have to remember this URL in order to use this package? IMHO this is not cool. What if later the author of the package removed it or changed the URL? Any ideas?</p>\n"}, {"tags": ["json", "go", "unmarshalling", "json-deserialization"], "answers": [{"tags": [], "owner": {"reputation": 930, "user_id": 4328963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/505Lz.png?s=128&g=1", "display_name": "huygn", "link": "https://stackoverflow.com/users/4328963/huygn"}, "is_accepted": false, "score": 1, "last_activity_date": 1470132224, "creation_date": 1470132224, "answer_id": 38717425, "question_id": 38716267, "link": "https://stackoverflow.com/questions/38716267/decoding-top-level-json-array-with-json-decoder/38717425#38717425", "title": "Decoding top level JSON array with json.Decoder", "body": "<p><a href=\"https://play.golang.org/p/y2sKN7e8gf\" rel=\"nofollow\">https://play.golang.org/p/y2sKN7e8gf</a></p>\n\n<p>Note that use of <code>var r interface{}</code> is not recommended, you should define your JSON structure as a Go <code>struct</code> to parse it correctly.</p>\n"}, {"tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": true, "score": 8, "last_activity_date": 1569494826, "last_edit_date": 1569494826, "creation_date": 1470132294, "answer_id": 38717448, "question_id": 38716267, "link": "https://stackoverflow.com/questions/38716267/decoding-top-level-json-array-with-json-decoder/38717448#38717448", "title": "Decoding top level JSON array with json.Decoder", "body": "<p>You use <em>json.Decoder</em> in same way as any other json. Only difference is that instead of decoding into a struct, json need to be decoded into a slice of struct. This is a very simple example. <a href=\"https://play.golang.org/p/7moBlYt5wA\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Result struct {\n    Name         string `json:\"Name\"`\n    Age          int    `json:\"Age`\n    OriginalName string `json:\"Original_Name\"`\n}\n\nfunc main() {\n    jsonString := `[{\"Name\":\"Jame\",\"Age\":6,\"Original_Name\":\"Jameson\"}]`\n    result := make([]Result, 0)\n    decoder := json.NewDecoder(bytes.NewBufferString(jsonString))\n    err := decoder.Decode(&amp;result)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(result)\n}\n</code></pre>\n"}], "owner": {"reputation": 122, "user_id": 598899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547de00de25d03a5eeb4100c1deceba8?s=128&d=identicon&r=PG", "display_name": "Rustam", "link": "https://stackoverflow.com/users/598899/rustam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2448, "favorite_count": 1, "accepted_answer_id": 38717448, "answer_count": 2, "score": 4, "last_activity_date": 1569494826, "creation_date": 1470129038, "last_edit_date": 1569494779, "question_id": 38716267, "link": "https://stackoverflow.com/questions/38716267/decoding-top-level-json-array-with-json-decoder", "title": "Decoding top level JSON array with json.Decoder", "body": "<p>Is it possible to decode top level JSON array with json.Decoder?</p>\n\n<p>Or reading entire JSON and json.Unmarshall is the only way in this case?</p>\n\n<p>I have read the accepted answer in <a href=\"https://stackoverflow.com/questions/15672556/handling-json-post-request-in-go\">this question</a> and cannot figure out how to use it with top level JSON array</p>\n"}, {"tags": ["go", "docker", "docker-compose", "dockerfile", "docker-machine"], "answers": [{"tags": [], "owner": {"reputation": 6085, "user_id": 203200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f338eea2c0d517d29cf99865b831d3af?s=128&d=identicon&r=PG", "display_name": "Jawher", "link": "https://stackoverflow.com/users/203200/jawher"}, "is_accepted": true, "score": 2, "last_activity_date": 1470126333, "creation_date": 1470126333, "answer_id": 38715344, "question_id": 38715167, "link": "https://stackoverflow.com/questions/38715167/library-for-docker-remote-api-v1-24-for-go/38715344#38715344", "title": "Library for Docker Remote API v1.24 for Go?", "body": "<p>You can use the official docker API client:</p>\n\n<p><a href=\"https://github.com/docker/engine-api\" rel=\"nofollow\">https://github.com/docker/engine-api</a></p>\n\n<p>For instance, <a href=\"https://github.com/docker/engine-api/blob/master/client/service_list_test.go\" rel=\"nofollow\">here's how</a> you would retrieve the list of services using this library.</p>\n"}], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 38715344, "answer_count": 1, "score": 0, "last_activity_date": 1470203434, "creation_date": 1470125807, "last_edit_date": 1470203434, "question_id": 38715167, "link": "https://stackoverflow.com/questions/38715167/library-for-docker-remote-api-v1-24-for-go", "title": "Library for Docker Remote API v1.24 for Go?", "body": "<p>Hi is there any library that I can use for example to use the Types existing in <a href=\"https://docs.docker.com/engine/reference/api/docker_remote_api_v1.24/\" rel=\"nofollow\">Docker Remote API v1.24</a>, for example I have this function that returns a service type</p>\n\n<pre><code>func GetServices() docker.Services {\n    res, _ := client.Get(\"https:10.0.1.10:2376/services\") // client previously created\n    js, _ := ioutil.ReadAll(res.Body)\n    var Services docker.Services\n\n    _ = json.Unmarshal(js, &amp;Services)\n    return Services\n}\n</code></pre>\n\n<p>here I am assuming that there exists a library docker that contains these types, and this what I need can any one help? previously I used <a href=\"https://github.com/fsouza/go-dockerclient\" rel=\"nofollow\">go-dockerclient</a> </p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-pubsub"], "answers": [{"tags": [], "owner": {"reputation": 681, "user_id": 431013, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/0GkLS.jpg?s=128&g=1", "display_name": "Mete Atamel", "link": "https://stackoverflow.com/users/431013/mete-atamel"}, "is_accepted": false, "score": 0, "last_activity_date": 1470138855, "creation_date": 1470138855, "answer_id": 38719750, "question_id": 38714719, "link": "https://stackoverflow.com/questions/38714719/stable-gcp-pubsub-api-for-golang/38719750#38719750", "title": "Stable GCP PubSub API for Golang", "body": "<p>It's hard to tell for sure but I personally do not read experimental as unstable. Experimental usually means that the library APIs might change going forward in non-backwards compatible way (i.e. you might need to rewrite your app if you want to upgrade) but it does not mean that the library is unstable. I suggest that you run your performance and stability tests and convince yourself that it is indeed stable.</p>\n"}], "owner": {"reputation": 3386, "user_id": 4158603, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/6A1qm.png?s=128&g=1", "display_name": "areller", "link": "https://stackoverflow.com/users/4158603/areller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470138855, "creation_date": 1470124337, "last_edit_date": 1470125885, "question_id": 38714719, "link": "https://stackoverflow.com/questions/38714719/stable-gcp-pubsub-api-for-golang", "title": "Stable GCP PubSub API for Golang", "body": "<p>We have an infrastructure where we use GCP Pubsub as a global pubsub and redis as a local pubsub.</p>\n\n<p>Therefore we should create a component that would subscribe to GCP pubsub and publish incoming messages to redis.</p>\n\n<p>To make that component as fast as possible we have decided to write it in Go because:</p>\n\n<ol>\n<li>It compiles</li>\n<li>It runs nativly on Linux (as opposed to .NET)</li>\n<li>It's really fast while keeping simplicity (as opposed to C/C++)</li>\n</ol>\n\n<p>Everything was fine and we were ready to GO (pun intended) but then I saw this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PInbv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PInbv.png\" alt=\"enter image description here\"></a></p>\n\n<p>It seems that there is no stable GCP Pubsub API for Golang.<br>\nCan I really rely on experimental version to run in production?</p>\n\n<p>What should I do instead?\nMaybe Golang is not necessary for this task?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["email", "go", "smtp", "gmail", "postfix"], "comments": [{"owner": {"reputation": 215, "user_id": 5808912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035ed4fb917a6eafa33e1bed81c3ef4f?s=128&d=identicon&r=PG", "display_name": "Juergen Gmeiner", "link": "https://stackoverflow.com/users/5808912/juergen-gmeiner"}, "edited": false, "score": 0, "creation_date": 1470122172, "post_id": 38712902, "comment_id": 64804663, "body": "I would check /etc/hosts and make sure hostname (from smtp.SendMail) points to the external ip address of the server, not 127.0.0.1."}, {"owner": {"reputation": 41, "user_id": 6531412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/084b658415409442e63ed040e83713fd?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Owens", "link": "https://stackoverflow.com/users/6531412/scott-owens"}, "reply_to_user": {"reputation": 215, "user_id": 5808912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035ed4fb917a6eafa33e1bed81c3ef4f?s=128&d=identicon&r=PG", "display_name": "Juergen Gmeiner", "link": "https://stackoverflow.com/users/5808912/juergen-gmeiner"}, "edited": false, "score": 0, "creation_date": 1470137865, "post_id": 38712902, "comment_id": 64814761, "body": "hostname is equal to the fqdn of the server for both calls.  hosts file is correct by my understanding of the syntax used, but I&#39;m new to setting this up so the relevent line is 127.0.0.1       localhost example.com"}, {"owner": {"reputation": 215, "user_id": 5808912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035ed4fb917a6eafa33e1bed81c3ef4f?s=128&d=identicon&r=PG", "display_name": "Juergen Gmeiner", "link": "https://stackoverflow.com/users/5808912/juergen-gmeiner"}, "edited": false, "score": 0, "creation_date": 1470145473, "post_id": 38712902, "comment_id": 64820388, "body": "I think that is the problem. If example.com resolves to 127.0.0.1 and you send mail to example.com via smtp, the reverse lookup of the sending ip address will be 127.0.0.1 localhost. I would try pointing example.com at 10.77.88.99 (substitute the real externally reachable ip address).  The first name for that address will then show up in your via-line"}, {"owner": {"reputation": 41, "user_id": 6531412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/084b658415409442e63ed040e83713fd?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Owens", "link": "https://stackoverflow.com/users/6531412/scott-owens"}, "reply_to_user": {"reputation": 215, "user_id": 5808912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035ed4fb917a6eafa33e1bed81c3ef4f?s=128&d=identicon&r=PG", "display_name": "Juergen Gmeiner", "link": "https://stackoverflow.com/users/5808912/juergen-gmeiner"}, "edited": false, "score": 0, "creation_date": 1470191172, "post_id": 38712902, "comment_id": 64842645, "body": "changing the order was sufficient, changing it to 127.0.0.1 example.com localhost, resulted in everything still working and the received header being set correctly, still showing up in spam for some reason though, not sure why, but the problem I asked about is solved, Thank you Juergen."}, {"owner": {"reputation": 215, "user_id": 5808912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035ed4fb917a6eafa33e1bed81c3ef4f?s=128&d=identicon&r=PG", "display_name": "Juergen Gmeiner", "link": "https://stackoverflow.com/users/5808912/juergen-gmeiner"}, "edited": false, "score": 0, "creation_date": 1470205613, "post_id": 38712902, "comment_id": 64847141, "body": "I think now the problem is that a gmail.com address uses example.com as mail relay.  Usually the smtp server has to be the official (as of dns mx record) smtp server for the sending email address.  Why don&#39;t you do your &#39;echo &quot;body&quot; | mail -s &quot;subject&quot; test@example.com&#39; trick from go? <a href=\"https://golang.org/pkg/os/exec/#example_Cmd_StdoutPipe\" rel=\"nofollow noreferrer\">golang.org/pkg/os/exec/#example_Cmd_StdoutPipe</a> except pipe into StdinPipe"}, {"owner": {"reputation": 41, "user_id": 6531412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/084b658415409442e63ed040e83713fd?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Owens", "link": "https://stackoverflow.com/users/6531412/scott-owens"}, "reply_to_user": {"reputation": 215, "user_id": 5808912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035ed4fb917a6eafa33e1bed81c3ef4f?s=128&d=identicon&r=PG", "display_name": "Juergen Gmeiner", "link": "https://stackoverflow.com/users/5808912/juergen-gmeiner"}, "edited": false, "score": 0, "creation_date": 1470221171, "post_id": 38712902, "comment_id": 64856633, "body": "I&#39;m not actually using example.com, I changed the references in all the provided sources to make it more generic and easier for other people with the same problem to mentally substitute their own domain.  Running the echo equivalent within go wouldn&#39;t have produced a desirable outcome either as it would make adding other headers very difficult.  Changing the entries in /etc/hosts as Juergen suggested worked in the end, so Ill be marking this question closed shortly."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6531412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/084b658415409442e63ed040e83713fd?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Owens", "link": "https://stackoverflow.com/users/6531412/scott-owens"}, "is_accepted": false, "score": 1, "last_activity_date": 1470221726, "creation_date": 1470221726, "answer_id": 38741593, "question_id": 38712902, "link": "https://stackoverflow.com/questions/38712902/golang-postfix-email-received-header-is-localhost/38741593#38741593", "title": "golang &amp; postfix - email received header is localhost", "body": "<p>As Juergen Gmeiner suggested in the comments, my problem ended up being caused by a poorly configured <code>/etc/hosts</code> file, such that it wasn't effecting other services.</p>\n\n<p>The existing entry was:</p>\n\n<pre><code>127.0.0.1 localhost example.com\n</code></pre>\n\n<p>Changing this to:</p>\n\n<pre><code>127.0.0.1 example.com localhost\n</code></pre>\n\n<p>solved the problem while not breaking the existing services that needed localhost to evaluate properly.</p>\n\n<p>This solution worked for my locally hosted server process, if the same problem occurs with a remote server, and equivalent like would need to be created with the ip and hostname of the remote. i.e.</p>\n\n<pre><code>&lt;remote ip&gt; &lt;hostname&gt;\n</code></pre>\n\n<p>note: while I tested that this last part by calling from my local development build to our production server and it worked, its not a 100% tested solution.</p>\n\n<p>Thank you all for your help, and I hope that this mistake on my part helps anyone else who makes a similar error in the future.</p>\n"}], "owner": {"reputation": 41, "user_id": 6531412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/084b658415409442e63ed040e83713fd?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Owens", "link": "https://stackoverflow.com/users/6531412/scott-owens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1397, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1470221726, "creation_date": 1470118126, "last_edit_date": 1470119969, "question_id": 38712902, "link": "https://stackoverflow.com/questions/38712902/golang-postfix-email-received-header-is-localhost", "title": "golang &amp; postfix - email received header is localhost", "body": "<p>While trying to setup postfix to allow a website to sent password reset emails I've noticed that when sending emails form the command line using </p>\n\n<pre><code>echo \"body\" | mail -s \"subject\" test@example.com\n</code></pre>\n\n<p>the emails arrive just fine and are not marked as spam. However, when sending from withing the sites server, the header is set as being received from localhost and thus is marked as spam.</p>\n\n<pre><code>Received: from example.com (localhost [127.0.0.1])\nby example.com (Postfix) with ESMTPS id CE1299C435\nfor &lt;my_email@gmail.com&gt;; Tue,  2 Aug 2016 05:28:41 +0000 (UTC)\n</code></pre>\n\n<p>As a note, dkim, spf and dmarc test all list as passed, so they are not the problem.</p>\n\n<p>I have also tried sending an email with the same content using the above echo method and had it arrive fine (although plaintext as I used it as above and didn't add the content type headers).</p>\n\n<p>Initially this was sent using smtp.SendMail</p>\n\n<pre><code>err := smtp.SendMail(hostname + \":25\", nil, sender, recipients, []byte(msgstr))\n</code></pre>\n\n<p>which provides no way to set sending host, so in an attempt to correct this I switched to using a manual dial, sending a HELO message, then starting tls (attempting to start tls before the HELO resulted in a panic saying the HELO had to be the first call)</p>\n\n<pre><code>c, err := smtp.Dial(host + \":25\")\nif err != nil {\n    log.Panic(err)\n}\n\nif err = c.Hello(host); err != nil {\n  log.Panic(err)\n}\n\nif err = c.StartTLS(config.TLS()); err != nil {\n  log.Panic(err)\n}\n</code></pre>\n\n<p>This still sends the email successfully, but as before the received header still shows localhost as the origin, I feel I've misunderstood something as I believed that HELO served to identify where the call was coming from.</p>\n\n<p>Your advice and help is appreciated, this is the first time I've tried to configure an MTA and use it like this, there has been a bit of a learning curve that I'm evidently not over yet.</p>\n"}, {"tags": ["unit-testing", "go", "architecture", "integration-testing"], "comments": [{"owner": {"reputation": 122, "user_id": 4241670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/329e413106cac2bb6d6a281b40f8b8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Corbin", "link": "https://stackoverflow.com/users/4241670/corbin"}, "edited": false, "score": 2, "creation_date": 1470115048, "post_id": 38712120, "comment_id": 64801414, "body": "Usually you don&#39;t want to explicitly use un-exported functions in test code. I would consider this a code smell and explore other ways to organize your code. If you give more details someone might be able to help you out more."}, {"owner": {"reputation": 1243, "user_id": 1377526, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e5ebfaa05c01b33ac9abb9b4b17fdd60?s=128&d=identicon&r=PG", "display_name": "cmp", "link": "https://stackoverflow.com/users/1377526/cmp"}, "edited": false, "score": 0, "creation_date": 1470148109, "post_id": 38712120, "comment_id": 64822485, "body": "I&#39;d also add that you don&#39;t <i>have</i> to call the test function from main_test.go. You could just let go call it for you if you name it properly. (i.e. with &quot;Test&quot; at the front) <a href=\"https://golang.org/doc/code.html#Testing\" rel=\"nofollow noreferrer\">golang.org/doc/code.html#Testing</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1243, "user_id": 1377526, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e5ebfaa05c01b33ac9abb9b4b17fdd60?s=128&d=identicon&r=PG", "display_name": "cmp", "link": "https://stackoverflow.com/users/1377526/cmp"}, "edited": false, "score": 1, "creation_date": 1470148022, "post_id": 38715325, "comment_id": 64822414, "body": "A package with the utilities for testing is the best way here."}, {"owner": {"reputation": 13815, "user_id": 279614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2c21e0dfa85ff0d3d7ad4f277c3de0?s=128&d=identicon&r=PG", "display_name": "Subhas", "link": "https://stackoverflow.com/users/279614/subhas"}, "edited": false, "score": 4, "creation_date": 1554902103, "post_id": 38715325, "comment_id": 97920931, "body": "A package with test utility will help everyone else <i>except</i> the package where those relevant testing sources actually exist, due to cycling import issue. i.e. &quot;pkg1&quot; has a bunch of structs that you want to test, and a &quot;util&quot; package has some testing utilities which depend on this package. This &quot;util&quot; can be used everywhere else <i>except</i> &quot;pkg1&quot; due to cyclic import."}, {"owner": {"reputation": 417, "user_id": 3049386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754afefdb87c446066459a9857d9a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Bestbug", "link": "https://stackoverflow.com/users/3049386/bestbug"}, "edited": false, "score": 0, "creation_date": 1554995474, "post_id": 38715325, "comment_id": 97962831, "body": "Maybe I wasn&#39;t clear when I wrote the first answer but I really don&#39;t see the point to create a utils package for testing without a proper isolation for pkg1. We should have a little bit more of comprehation about how the pkg1 was developed and how the test function call the pkg1 function before discussing about the possible cycling import. If you have a similar problem and you want an opinion feel free to ask :)"}], "tags": [], "owner": {"reputation": 417, "user_id": 3049386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754afefdb87c446066459a9857d9a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Bestbug", "link": "https://stackoverflow.com/users/3049386/bestbug"}, "is_accepted": false, "score": 6, "last_activity_date": 1470184335, "last_edit_date": 1470184335, "creation_date": 1470126291, "answer_id": 38715325, "question_id": 38712120, "link": "https://stackoverflow.com/questions/38712120/how-to-reuse-test-code-in-imported-package/38715325#38715325", "title": "How to reuse test code in imported package?", "body": "<p>If you use this function in <code>*_test.go</code> file throughout the project it's a good idea to move it to a utils package and import this package in your <code>*_test.go</code>. Moreover since this util package is used only for testing purposes I suggest to save the output of the internal function of <code>pkg1</code> in a support file and load it when you call the support package's function which should use the private function of <code>pkg1</code>.</p>\n"}], "owner": {"reputation": 2371, "user_id": 4140668, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/50c0905a6e33a9fa6f7e050c09ed1277?s=128&d=identicon&r=PG", "display_name": "lz96", "link": "https://stackoverflow.com/users/4140668/lz96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9129, "favorite_count": 1, "closed_date": 1569220588, "answer_count": 1, "score": 10, "last_activity_date": 1569220463, "creation_date": 1470114311, "last_edit_date": 1569220463, "question_id": 38712120, "link": "https://stackoverflow.com/questions/38712120/how-to-reuse-test-code-in-imported-package", "closed_reason": "Duplicate", "title": "How to reuse test code in imported package?", "body": "<p>Here is my directory hierarchy:</p>\n\n<pre><code>/\n|-- main.go // package main, an HTTP server which accepts request and calls C/U APIs in pkg1 to finish certain task\n|-- main_test.go // wants to call veryfyTaskNumber in pkg1_test\n|-- pkg1 // package pkg1, CRUD APIs with Retrieve&amp;Delete unexported for safety\n    |-- pkg1_test.go // contains a function verifyTaskNumber(*testing.T, taskName string, expectedNo int) which calls internal Retrieve function in pkg1\n</code></pre>\n\n<p>I have some utility functions for tests only in <code>pkg1_test.go</code>. <code>main.go</code> imports <code>pkg1</code>. Now I want to use these functions in my <code>main_test.go</code>. After searching I found two possible solutions, but both of them have some drawbacks:</p>\n\n<ul>\n<li>Move these functions into <code>pkg1.go</code>. However these functions might be contained in binaries generated by <code>go build</code>.</li>\n<li>Move these functions into a separate <code>testutility</code> package, then import it in <code>*_test.go</code> manually. The problem is that these functions use some internal methods in <code>pkg1</code>.</li>\n</ul>\n\n<p>So I was wondering whether there is a better solution to this problem.</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1470111715, "post_id": 38711653, "comment_id": 64800460, "body": "No there is not. Just split your function into a) flag parsing which is not unit-tested and b) loading config files"}], "answers": [{"tags": [], "owner": {"reputation": 1281, "user_id": 787553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4be2932e858c8fc42b83a705031b73?s=128&d=identicon&r=PG", "display_name": "dmitris", "link": "https://stackoverflow.com/users/787553/dmitris"}, "is_accepted": false, "score": 0, "last_activity_date": 1470128327, "creation_date": 1470128327, "answer_id": 38716011, "question_id": 38711653, "link": "https://stackoverflow.com/questions/38711653/unit-test-different-flag-values/38716011#38716011", "title": "Unit test different flag values", "body": "<p>If you change it like the code below, <code>go test</code> will fail but <code>go test -config testconfig</code> will pass.  Not that we don't need to call <code>flag.Parse()</code> in the <code>init()</code> since it is be called by the testing package (as Rob Pike mentions in <a href=\"https://groups.google.com/d/msg/golang-nuts/uSFM8jG7yn4/PIQfEWOZx4EJ\" rel=\"nofollow\">https://groups.google.com/d/msg/golang-nuts/uSFM8jG7yn4/PIQfEWOZx4EJ</a>).</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"testing\"\n)\n\nvar configFile = flag.String(\"config\", \"\", \"File containing configuration\")\n\nfunc getConfigFile() string {\n    return *configFile\n}\n\nfunc TestConfig(t *testing.T) {\n    want := \"testconfig\"\n    if s := getConfigFile(); s != want {\n        t.Errorf(\"Got %s, want %s\", s, want)\n    }\n}\n</code></pre>\n\n<p>Test runs:</p>\n\n<pre><code>$ go test\n--- FAIL: TestConfig (0.00s)\n    flag_test.go:17: Got , want testconfig\nFAIL\nexit status 1\nFAIL    github.com/dmitris/soflagtest   0.013s\n$ go test -config testconfig\nPASS\nok      github.com/dmitris/soflagtest   0.012s\n</code></pre>\n\n<p>You can also use\n<code>var configFile string</code> declaration and an <code>init()</code> function to assign the flag value to the variable:</p>\n\n<pre><code>func init() {\n     flag.StringVar(&amp;configFile, \"config\", \"\", \"File containing configuration\")\n}\n</code></pre>\n\n<p>(then no pointer dereferencing in getConfigFile since configFile is a string)</p>\n"}, {"tags": [], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "is_accepted": false, "score": 2, "last_activity_date": 1470131471, "last_edit_date": 1470131471, "creation_date": 1470131114, "answer_id": 38717010, "question_id": 38711653, "link": "https://stackoverflow.com/questions/38711653/unit-test-different-flag-values/38717010#38717010", "title": "Unit test different flag values", "body": "<p>I have found that for testing custom flags is better to create a custom flag set, in that way I can fully test the flags, including the <code>-h</code> option without exiting the tests. hope the attached code could give you and idea of how you could implement test on your code:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"os\"\n    \"reflect\"\n    \"testing\"\n)\n\n// Test Helper\nfunc expect(t *testing.T, a interface{}, b interface{}) {\n    if a != b {\n        t.Errorf(\"Expected: %v (type %v)  Got: %v (type %v)\", a, reflect.TypeOf(a), b, reflect.TypeOf(b))\n    }\n}\n\ntype Flags struct {\n    ConfigFile string\n}\n\nfunc (self *Flags) Parse(fs *flag.FlagSet) (*Flags, error) {\n    fs.StringVar(&amp;self.ConfigFile, \"config\", \"\", \"File containing configuration\")\n\n    err := fs.Parse(os.Args[1:])\n    if err != nil {\n        return nil, err\n    }\n\n    return self, nil\n}\n\nfunc main() {\n\n    fs := flag.NewFlagSet(\"test\", flag.ContinueOnError)\n\n    parser := Flags{}\n    flags, err := parser.Parse(fs)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(flags)\n\n}\n\nfunc TestFlags(t *testing.T) {\n    oldArgs := os.Args\n    defer func() { os.Args = oldArgs }()\n    var flagTest = []struct {\n        flag     []string\n        name     string\n        expected interface{}\n    }{\n        {[]string{\"cmd\", \"-config\", \"config.yaml\"}, \"ConfigFile\", \"config.yaml\"},\n        {[]string{\"cmd\", \"-config\", \"config.json\"}, \"ConfigFile\", \"config.json\"},\n        {[]string{\"cmd\", \"-v\"}, \"Version\", true},\n    }\n\n    for _, f := range flagTest {\n        os.Args = f.flag\n        p := &amp;Flags{}\n        fs := flag.NewFlagSet(\"test\", flag.ContinueOnError)\n\n        flags, err := p.Parse(fs)\n        if err != nil {\n            t.Error(err)\n        }\n\n        refValue := reflect.ValueOf(flags).Elem().FieldByName(f.name)\n        switch refValue.Kind() {\n        case reflect.Bool:\n            expect(t, f.expected, refValue.Bool())\n        case reflect.String:\n            expect(t, f.expected, refValue.String())\n        }\n    }\n\n}\n</code></pre>\n\n<p>I put it also here: <a href=\"https://play.golang.org/p/h1nok1UMLA\" rel=\"nofollow\">https://play.golang.org/p/h1nok1UMLA</a> hope it can give you an idea.</p>\n"}], "owner": {"reputation": 28653, "user_id": 527288, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9e175031c4adde62f40456f86a5e91b0?s=128&d=identicon&r=PG", "display_name": "Kurtis Nusbaum", "link": "https://stackoverflow.com/users/527288/kurtis-nusbaum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1862, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1470203531, "creation_date": 1470111246, "last_edit_date": 1470203531, "question_id": 38711653, "link": "https://stackoverflow.com/questions/38711653/unit-test-different-flag-values", "title": "Unit test different flag values", "body": "<p>I have the following Golang code:</p>\n\n<pre><code>func getConfigFile() string {\n    var configFile string\n    flag.StringVar(&amp;configFile, \"config\", \"\", \"File containing configuration\")\n    flag.Parse()\n    return configFile\n}\n</code></pre>\n\n<p>This function is used elsewhere in my code, and I'd like to unit test what happens here when the user provides different values for the config argument (the config file name is used else where).<br>\nIs there a way to tell the flag package to return different values for the config argument while under test?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1470378462, "last_edit_date": 1470378462, "creation_date": 1470119196, "answer_id": 38713152, "question_id": 38711615, "link": "https://stackoverflow.com/questions/38711615/appengine-appengine-package-always-fails-with-syscall-or-unsafe-import-fai/38713152#38713152", "title": "AppEngine &quot;appengine&quot; package always fails with &quot;syscall&quot; or &quot;unsafe&quot; import failure", "body": "<p>All code in the application directory tree (the root is the directory containing app.yaml) is compiled in to the app. Appengine rejects code that uses \"unsafe\".</p>\n\n<p>The fix is to move the offending code out of the application directory tree. Here's one possible way to arrange the code:</p>\n\n<pre><code>$GOPATH\n    src\n        testapp\n            app.yaml\n            app.go\n        golang.org\n            x\n                net\n                    icmp\n                    ... and so on\n</code></pre>\n\n<p>It's also possible that using package <code>main</code> will cause some trouble. If the above does not work, change the package name.</p>\n\n<p>Appengine apps are not go-gettable. Don't struggle to make them so.</p>\n\n<p>There's more discussion on this topic at <a href=\"https://github.com/golang/gddo/issues/428\" rel=\"nofollow\">https://github.com/golang/gddo/issues/428</a>.</p>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 440, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470378462, "creation_date": 1470110945, "question_id": 38711615, "link": "https://stackoverflow.com/questions/38711615/appengine-appengine-package-always-fails-with-syscall-or-unsafe-import-fai", "title": "AppEngine &quot;appengine&quot; package always fails with &quot;syscall&quot; or &quot;unsafe&quot; import failure", "body": "<p>Using the AppEngine 1.9.40 SDK, I can't even import the \"appengine\" package.</p>\n\n<p>app.yaml:</p>\n\n<pre><code>application: testapp\nversion: 1\nruntime: go\napi_version: go1\n\nhandlers:\n- url: /.*\n  script: _go_app\n</code></pre>\n\n<p>Go code:</p>\n\n<pre><code>package main\n\nimport (\n    \"google.golang.org/appengine\"\n)\n\nfunc init() {\n    appengine.IsDevAppServer()\n}\n\nfunc main() {\n    // This is only here because go-get needs on it.\n}\n</code></pre>\n\n<p>Command-line:</p>\n\n<pre><code>$ GOPATH=$(pwd) goapp serve\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>2016/08/01 23:58:02 go-app-builder: Failed parsing input: parser: bad import \"unsafe\" in src/golang.org/x/net/icmp/helper.go\n</code></pre>\n\n<p>What can be done to get past this?</p>\n"}, {"tags": ["file-upload", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470139646, "post_id": 38711102, "comment_id": 64816061, "body": "Why do you need to set Content-Length?"}, {"owner": {"reputation": 8836, "user_id": 297679, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4142e29a2d1f290bd0296f8148489b95?s=128&d=identicon&r=PG", "display_name": "Nobu", "link": "https://stackoverflow.com/users/297679/nobu"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470188227, "post_id": 38711102, "comment_id": 64842011, "body": "A web application built with Flask (python) has <code>request.stream</code> and it didn&#39;t work without sending Content-Length."}], "answers": [{"tags": [], "owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "is_accepted": true, "score": 0, "last_activity_date": 1470108513, "creation_date": 1470108513, "answer_id": 38711323, "question_id": 38711102, "link": "https://stackoverflow.com/questions/38711102/how-to-use-os-opens-return-value-as-the-third-parameter-of-http-post-and-se/38711323#38711323", "title": "How to use os.Open()&#39;s return value as the third parameter of http.Post() and set Content-Length?", "body": "<p>If you look at source for <a href=\"https://golang.org/src/net/http/request.go#L598\" rel=\"nofollow\">NewRequest</a> you can see that contentLength is handled specially for specific input types, and the file reader isn't one of them. You'll have to manually set the Content-Length header if that's important [chunked should also work fine, unless you're sending to an old server impl].</p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1470254927, "last_edit_date": 1470254927, "creation_date": 1470233455, "answer_id": 38746044, "question_id": 38711102, "link": "https://stackoverflow.com/questions/38711102/how-to-use-os-opens-return-value-as-the-third-parameter-of-http-post-and-se/38746044#38746044", "title": "How to use os.Open()&#39;s return value as the third parameter of http.Post() and set Content-Length?", "body": "<p>If you want to add a add the <code>Content-Length</code>, you need to stat the file to get the size. The ContentLength isn't calculated automatically because an <code>os.File</code> may not have a useful size. </p>\n\n<pre><code>f, err := os.Open(file.Name())\nif err != nil {\n    log.Fatal(err)\n}\n\nreq, err := http.NewRequest(\"POST\", ts.URL, f)\nif err != nil {\n    log.Fatal(err)\n}\n\nstat, err := f.Stat()\nif err != nil {\n    log.Fatal(err)\n}\n\nreq.ContentLength = stat.Size()\nreq.Header.Set(\"Content-Type\", \"application/octet-stream\")\n\nresp, err = http.Do(req)\n...\n</code></pre>\n"}], "owner": {"reputation": 8836, "user_id": 297679, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4142e29a2d1f290bd0296f8148489b95?s=128&d=identicon&r=PG", "display_name": "Nobu", "link": "https://stackoverflow.com/users/297679/nobu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 38711323, "answer_count": 2, "score": 0, "last_activity_date": 1470254927, "creation_date": 1470106699, "question_id": 38711102, "link": "https://stackoverflow.com/questions/38711102/how-to-use-os-opens-return-value-as-the-third-parameter-of-http-post-and-se", "title": "How to use os.Open()&#39;s return value as the third parameter of http.Post() and set Content-Length?", "body": "<p>The third parameter of <code>http.Post()</code> allows <code>io.Reader</code> and that means the return value of <code>os.Open()</code> should work. But the below code gets unexpected result, in other words, it won't set <code>Content-Length</code> properly. Perhaps <code>File</code> type doesn't implement something. Is there any proper way to set <code>Content-Length</code> with <code>*File</code>?</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"net/http/httptest\"\n    \"os\"\n)\n\nvar sample = []byte(`hello`)\n\nfunc main() {\n    ts := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        log.Println(r.Header)\n        if int(r.ContentLength) != len(sample) {\n            log.Fatal(\"Unexpected Content-Length:\", r.ContentLength)\n        }\n        w.Header().Set(\"Content-Type\", \"application/json\")\n        w.Write([]byte(`{}`))\n    }))\n    defer ts.Close()\n\n    file, err := ioutil.TempFile(os.TempDir(), \"\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer os.Remove(file.Name())\n    file.Write(sample)\n\n    // This works\n    buf, err := ioutil.ReadFile(file.Name())\n    if err != nil {\n        log.Fatal(err)\n    }\n    _, err = http.Post(ts.URL, \"application/octet-stream\", bytes.NewBuffer(buf))\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // This looks fine in my opinion, though it doesn't set Content-Length\n    f, err := os.Open(file.Name())\n    if err != nil {\n        log.Fatal(err)\n    }\n    _, err = http.Post(ts.URL, \"application/octet-stream\", f)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2009/11/10 23:00:00 map[Content-Type:[application/octet-stream] Accept-Encoding:[gzip] User-Agent:[Go-http-client/1.1] Content-Length:[5]]\n2009/11/10 23:00:00 map[Content-Type:[application/octet-stream] Accept-Encoding:[gzip] User-Agent:[Go-http-client/1.1]]\n2009/11/10 23:00:00 Unexpected Content-Length:-1\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/hJLN2H9Y9p\" rel=\"nofollow\">https://play.golang.org/p/hJLN2H9Y9p</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 25076, "user_id": 207524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7204a1f9d3a10e3b044e2e8ca58c877?s=128&d=identicon&r=PG", "display_name": "Crystal", "link": "https://stackoverflow.com/users/207524/crystal"}, "edited": false, "score": 0, "creation_date": 1470168778, "post_id": 38712423, "comment_id": 64835501, "body": "At the bottom of fly.go on line 50, there&#39;s <code>var Fly FlyCommand</code>.  Why is this needed?  Can you not reference the FlyCommand from another package without that declaration on line 50?"}, {"owner": {"reputation": 122, "user_id": 4241670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/329e413106cac2bb6d6a281b40f8b8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Corbin", "link": "https://stackoverflow.com/users/4241670/corbin"}, "reply_to_user": {"reputation": 25076, "user_id": 207524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7204a1f9d3a10e3b044e2e8ca58c877?s=128&d=identicon&r=PG", "display_name": "Crystal", "link": "https://stackoverflow.com/users/207524/crystal"}, "edited": false, "score": 1, "creation_date": 1470171333, "post_id": 38712423, "comment_id": 64836850, "body": "Yea, that&#39;s to create an actual &#39;instance&#39; of the <code>FlyCommand</code> struct so that it can get populated with values. You&#39;ll see in the <code>main()</code> function that the address of that variable is passed in to the parser in <code>NewParser()</code>. Then when <code>Parse()</code> is called go-flags populates appropriate fields all the way through the command/options structure."}], "tags": [], "owner": {"reputation": 122, "user_id": 4241670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/329e413106cac2bb6d6a281b40f8b8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Corbin", "link": "https://stackoverflow.com/users/4241670/corbin"}, "is_accepted": true, "score": 1, "last_activity_date": 1470116001, "creation_date": 1470116001, "answer_id": 38712423, "question_id": 38709768, "link": "https://stackoverflow.com/questions/38709768/understanding-subcommands-with-go-flags/38712423#38712423", "title": "Understanding subcommands with go-flags", "body": "<p>I have used jessevdk/go-flags on multiple projects and really like it. The documentation is sparse, but the code is clean so self-documenting in many ways. </p>\n\n<p>I will try and address your questions as best I can: </p>\n\n<p><code>ex</code> would be your binary, and would usually be a 'master' struct of all the top level commands (eg <a href=\"https://github.com/concourse/fly/blob/master/commands/fly.go\" rel=\"nofollow\">https://github.com/concourse/fly/blob/master/commands/fly.go</a>). This will get parsed in your main function (eg <a href=\"https://github.com/concourse/fly/blob/master/main.go\" rel=\"nofollow\">https://github.com/concourse/fly/blob/master/main.go</a>).</p>\n\n<p><code>todos</code> and <code>events</code> would actually be the first level of subcommands. You would define those on the first level command (<code>list</code>) in the same way you define commands on the 'master' command struct.</p>\n\n<p><code>--completed</code> is indeed an option.</p>\n\n<p>One example of an open source project that uses go-flags in the Concourse CI CLI <a href=\"https://github.com/concourse/fly\" rel=\"nofollow\">https://github.com/concourse/fly</a>. Although it doesn't you nested commands like you want to do, it gives a pretty solid foundation for go-flags usage. </p>\n"}], "owner": {"reputation": 25076, "user_id": 207524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7204a1f9d3a10e3b044e2e8ca58c877?s=128&d=identicon&r=PG", "display_name": "Crystal", "link": "https://stackoverflow.com/users/207524/crystal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1463, "favorite_count": 1, "accepted_answer_id": 38712423, "answer_count": 1, "score": 2, "last_activity_date": 1606561113, "creation_date": 1470095593, "last_edit_date": 1606561113, "question_id": 38709768, "link": "https://stackoverflow.com/questions/38709768/understanding-subcommands-with-go-flags", "title": "Understanding subcommands with go-flags", "body": "<p>I'm building a CLI tool to start learning some Go.  I found this popular package that I wanted to use for some commands like this:</p>\n<p><a href=\"http://godoc.org/github.com/jessevdk/go-flags#Group\" rel=\"nofollow noreferrer\">http://godoc.org/github.com/jessevdk/go-flags#Group</a><br />\n<a href=\"https://github.com/jessevdk/go-flags\" rel=\"nofollow noreferrer\">https://github.com/jessevdk/go-flags</a></p>\n<pre><code>ex list todos\nex list todos --completed\nex list events\nex list todos events\nex authenticate\n</code></pre>\n<p>The way I understand it is <code>ex</code> would be my main command.<br />\n<code>list</code> and <code>authenticate</code> are subcommands.</p>\n<p>But what are <code>todos</code> and <code>events</code> in this scenario?  And what would be <code>--completed</code> be.  Is <code>--completed</code> called an <code>Option</code>?  That's the verbage I see around, but not sure if I'm reading it correctly.  I'm trying to find an example that has the different options for something like this scenario, but I could not find one.</p>\n<p>I tried using urfave/cli which worked at well at first, until I found a requirement to be able to pass multiple entities to <code>ex list</code> like <code>ex list todos events</code>.</p>\n"}, {"tags": ["testing", "asynchronous", "elasticsearch", "go"], "answers": [{"comments": [{"owner": {"reputation": 627, "user_id": 2000569, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3fc2a25dae524b3e09735e1a0f1f6a69?s=128&d=identicon&r=PG", "display_name": "fvosberg", "link": "https://stackoverflow.com/users/2000569/fvosberg"}, "edited": false, "score": 1, "creation_date": 1470118654, "post_id": 38711567, "comment_id": 64802816, "body": "Thank you so much, I didn&#39;t believe that there is a solution for this problem other than waiting for a second. It works like a charm"}], "tags": [], "owner": {"reputation": 3010, "user_id": 519557, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/x9V4f.jpg?s=128&g=1", "display_name": "jxstanford", "link": "https://stackoverflow.com/users/519557/jxstanford"}, "is_accepted": true, "score": 1, "last_activity_date": 1470110583, "creation_date": 1470110583, "answer_id": 38711567, "question_id": 38708541, "link": "https://stackoverflow.com/questions/38708541/testing-elasticsearch-in-golang-without-sleep/38711567#38711567", "title": "Testing Elasticsearch in Golang without sleep", "body": "<p>Elasticsearch has a flush command that is useful for this situation.  Since you're using the <code>elastic</code> project as an interface, you can use the following (where client is your ES client):</p>\n\n<p><code>\n...\ntestCustomer.Create()\nres, err := client.Flush().Do()\n    if err != nil {\n        t.Fatal(err)\n    }\n_, err := customer.FindByEmail(\"testing@test.de\")\n...\n</code></p>\n"}], "owner": {"reputation": 627, "user_id": 2000569, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3fc2a25dae524b3e09735e1a0f1f6a69?s=128&d=identicon&r=PG", "display_name": "fvosberg", "link": "https://stackoverflow.com/users/2000569/fvosberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 38711567, "answer_count": 1, "score": 1, "last_activity_date": 1470203792, "creation_date": 1470087509, "last_edit_date": 1470203792, "question_id": 38708541, "link": "https://stackoverflow.com/questions/38708541/testing-elasticsearch-in-golang-without-sleep", "title": "Testing Elasticsearch in Golang without sleep", "body": "<p>I am really new to Golang and I have a question regarding to testing.<br>\nI had a test where I wanted to check whether the persisting of a customer in elasticsearch works or not. I've reduced the code to the critical part and posted it on github: (<a href=\"https://github.com/fvosberg/elastic-go-testing\" rel=\"nofollow\">https://github.com/fvosberg/elastic-go-testing</a>)</p>\n\n<p>The problem is, that I have to wait for elasticsearch to index the new document, before I can search for it. Is there another option than waiting a second for this to happen? This feels very ugly, but I don't know how I can test the integration (working with elasticsearch with lowercasing the email address ...) in another way.</p>\n\n<p>Are there solutions for this problem?</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/fvosberg/elastic-go-testing/customer\"\n    \"testing\"\n    \"time\"\n)\n\nfunc TestRegistration(t *testing.T) {\n    testCustomer := customer.Customer{Email: \"testing@test.de\"}\n    testCustomer.Create()\n    time.Sleep(time.Second * 1)\n    _, err := customer.FindByEmail(\"testing@test.de\")\n    if err != nil {\n        t.Logf(\"Error occured: %+v\\n\", err)\n        t.Fail()\n    } else {\n        t.Log(\"Found customer testing@test.de\")\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "makefile", "docker", "dockerfile"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470080969, "post_id": 38706880, "comment_id": 64791487, "body": "What &quot;following article&quot;? I don&#39;t see anything in here about building a static binary, or what having a static binary would have to do with the docker error."}, {"owner": {"reputation": 7606, "user_id": 180253, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/df46030788b7cc95cadb9778a2b9e7dd?s=128&d=identicon&r=PG", "display_name": "TheJediCowboy", "link": "https://stackoverflow.com/users/180253/thejedicowboy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470081548, "post_id": 38706880, "comment_id": 64791795, "body": "@JimB I updated the post. My apologies."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1470082248, "post_id": 38706880, "comment_id": 64792152, "body": "You&#39;re not building a static binary per the directions. I&#39;m not sure if that&#39;s the only problem, but you need to start there. Also the <code>tianon&#47;true</code> image doesn&#39;t look particularly useful. You can start with <code>scratch</code> yourself, or use something a little more complete like <code>alpine</code>"}], "answers": [{"tags": [], "owner": {"reputation": 50397, "user_id": 1318694, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/JPEVC.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1318694/matt"}, "is_accepted": false, "score": 2, "last_activity_date": 1470106434, "last_edit_date": 1470106434, "creation_date": 1470106107, "answer_id": 38711044, "question_id": 38706880, "link": "https://stackoverflow.com/questions/38706880/static-go-binaries-w-docker-entrypoint-not-found/38711044#38711044", "title": "Static Go Binaries w/ Docker - Entrypoint Not Found", "body": "<p>The go static build in your makefile is missing some options. </p>\n\n<pre><code>buildgo:\n    CGO_ENABLED=0 GOOS=linux go build -ldflags \"-s\" -a -installsuffix cgo -o netverify ./go/src/github.com/eirwin/netverify\n</code></pre>\n\n<p>The build process can capture the container ID to avoid timing issues. <br>\nSeparate the tags for build and binary images. </p>\n\n<pre><code>builddocker:\n    docker build -t eirwin/netverify-build -f ./Dockerfile.build .\n    CID=$$(docker create eirwin/netverify-build); \\\n    docker cp $$CID:/netverify .; \\\n    docker rm $$CID\n    chmod 755 ./netverify\n    docker build --rm=true --tag=eirwin/netverify -f Dockerfile.static .\n</code></pre>\n\n<p>Your binary <code>Dockerfile.static</code> can start with the <code>scratch</code> blank image. </p>\n\n<pre><code>FROM scratch\n</code></pre>\n"}], "owner": {"reputation": 7606, "user_id": 180253, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/df46030788b7cc95cadb9778a2b9e7dd?s=128&d=identicon&r=PG", "display_name": "TheJediCowboy", "link": "https://stackoverflow.com/users/180253/thejedicowboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 775, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470106434, "creation_date": 1470080520, "last_edit_date": 1470081533, "question_id": 38706880, "link": "https://stackoverflow.com/questions/38706880/static-go-binaries-w-docker-entrypoint-not-found", "title": "Static Go Binaries w/ Docker - Entrypoint Not Found", "body": "<p>I used <a href=\"https://developer.atlassian.com/blog/2015/07/osx-static-golang-binaries-with-docker/?hn\" rel=\"nofollow\">Static Go Binaries with Docker on OSX</a> by Nicola Paolucci to try to use static Go binary w/ Docker. I believe I followed every step correctly, but when I run the final image, I get the following error response from Docker.</p>\n\n<p><em>NOTE</em> The name of my service and executable are <code>netverify</code></p>\n\n<pre><code>docker: Error response from daemon: Container command '/netverify' not found or does not exist..\n</code></pre>\n\n<p>My <code>Dockerfile.static</code> looks like the following...</p>\n\n<pre><code>#Create a minimal container to run a Golang static binary\n\nFROM tianon/true\nADD netverify /\nEXPOSE 8282\nCMD [\"/netverify\"]\n</code></pre>\n\n<p>My <code>Dockerfile.build</code> looks like the following...</p>\n\n<pre><code>FROM golang\n\nADD Makefile /\nWORKDIR /\nRUN make setup\n\nADD . /go/src/github.com/eirwin/netverify\n\nRUN make buildgo\nCMD [\"/bin/bash\"]\n</code></pre>\n\n<p>My <code>Makefile</code> is the following...</p>\n\n<pre><code>GOCMD = go\nGOBUILD = $(GOCMD) build\nGOGET = $(GOCMD) get -v\nGOCLEAN = $(GOCMD) clean\nGOINSTALL = $(GOCMD) install\nGOTEST = $(GOCMD) test\n\n.PHONY: all\n\nall: build\n\nsetup:\n    $(GOGET) github.com/gorilla/mux\n\nbuildgo:\n    GOOS=linux $(GOBUILD) -o netverify ./go/src/github.com/eirwin/netverify\n\nbuilddocker:\n    docker build -t eirwin/netverify -f ./Dockerfile.build .\n    docker run -t eirwin/netverify /bin/true\n    docker cp `docker ps -q -n=1`:/netverify .\n    chmod 755 ./netverify\n    docker build --rm=true --tag=eirwin/netverify -f Dockerfile.static .\n\nrun:    builddocker\n    docker run -p 8282:8282 eirwin/netverify    \n</code></pre>\n\n<p>For the purpose of this post, lets assume I have the following as my golang application.</p>\n\n<pre><code>func main() {\n\n    router := mux.NewRouter()\n    router.HandleFunc(\"/ping\", api.PingHandler).Methods(\"GET\")\n    http.ListenAndServe(\":8282\", router)\n}\n</code></pre>\n\n<p>When I run <code>Make run</code> everything seems to work except for when the image is ran.</p>\n\n<p>I can see that the image builds correctly at ~8.5MB</p>\n\n<pre><code>eirwin/netverify  latest  eae16e146b91 3 seconds ago       8.63 MB\n</code></pre>\n\n<p>But when If <code>docker run -p 8282:8282 eirwin/netverify</code> is ran I get the following error...</p>\n\n<pre><code>docker: Error response from daemon: Container command '/netverify' not found or does not exist..\n</code></pre>\n"}, {"tags": ["file", "go", "build", "installation", "external"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1470076014, "post_id": 38705615, "comment_id": 64788963, "body": "Not using <code>go install</code>.  Perhaps you want a makefile and/or build script?"}, {"owner": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470076144, "post_id": 38705615, "comment_id": 64789008, "body": "Really is there no way with Go install? Is it only limited to source files? @Kaedys"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470076337, "post_id": 38705615, "comment_id": 64789088, "body": "<code>go install</code> is pretty close to identical to <code>go build</code>, except that it places the binary in <code>$GOPATH&#47;bin</code> (instead of the local directory) and caches the compiled versions of non-main packages in <code>$GOPATH&#47;pkg</code> (instead of discarding them).  To my knowledge, it has no functionality to handle anything aside from the source files and the resulting artifacts."}, {"owner": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470076709, "post_id": 38705615, "comment_id": 64789297, "body": "Okay, so should a simple sh script that <code>go build</code>s and copies the files do the job? @Kaedys"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470076877, "post_id": 38705615, "comment_id": 64789389, "body": "You can even use <code>go install</code> and copy the file, but ya, either will work.  A <code>makefile</code> will probably be more extensible, but if all you need is to copy the config file, a simple shell script should do just fine."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470076934, "post_id": 38705615, "comment_id": 64789416, "body": "Advantage of using <code>go install</code> even in the script, by the way, is that if you have a large code base with lots of non-main packages, you won&#39;t have to recompile them on each build.  It&#39;ll use the cached versions unless that package&#39;s source files have changed since last build."}, {"owner": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470077683, "post_id": 38705615, "comment_id": 64789826, "body": "Thank you very much. But, is there a way to set <code>go install</code> to build <b>only a certain package</b> in a folder different than $GOPATH/bin? @Kaedys"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470078211, "post_id": 38705615, "comment_id": 64790074, "body": "No, <code>go install</code> always installs to <code>$GOPATH&#47;bin</code>.  You could change your <code>$GOPATH</code> for that script, but that isn&#39;t advisable.  That said, what do you mean by installing only a certain package, though?  <code>go install</code> places the compiled binary in <code>$GOPATH&#47;bin</code>.  No packages get placed there (their compiled version is cached in <code>$GOPATH&#47;pkg</code> instead).  By definition, <code>go install</code> only installs a <code>main</code> package, just as <code>go build</code> only builds a <code>main</code> package."}, {"owner": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470078459, "post_id": 38705615, "comment_id": 64790205, "body": "I&#39;m sorry, by &quot;only a certain package&quot; I meant &quot;only a folder in $GOPATH/src&quot;. Anyway thanks for your help @Kaedys."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470078650, "post_id": 38705615, "comment_id": 64790299, "body": "@altermetax: you use <code>go install import&#47;path</code> to install a specific package."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470078682, "post_id": 38705615, "comment_id": 64790310, "body": "@Kaedys: you use <code>GOBIN</code> to set the destination of <code>go install</code> binaries."}, {"owner": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470079354, "post_id": 38705615, "comment_id": 64790663, "body": "I know about <code>GOBIN</code>, but that way I should write a script that sets <code>GOBIN</code> and then <code>go install</code>s. Is that recommended? @JimB"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470079627, "post_id": 38705615, "comment_id": 64790830, "body": "That&#39;s fine. You can move the binary after install too, it&#39;s the same result."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470156842, "post_id": 38705615, "comment_id": 64828559, "body": "@JimB I thought usage of <code>GOBIN</code> was discouraged?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470157854, "post_id": 38705615, "comment_id": 64829101, "body": "@Kaedys: why? it just changes where the final binary is placed, so there not much it could interfere with."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470167880, "post_id": 38705615, "comment_id": 64835030, "body": "Hmm, ya, you&#39;re right, I was thinking about <code>$GOROOT</code>, not <code>$GOBIN</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1281, "user_id": 787553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4be2932e858c8fc42b83a705031b73?s=128&d=identicon&r=PG", "display_name": "dmitris", "link": "https://stackoverflow.com/users/787553/dmitris"}, "is_accepted": false, "score": 0, "last_activity_date": 1470091262, "creation_date": 1470091262, "answer_id": 38709178, "question_id": 38705615, "link": "https://stackoverflow.com/questions/38705615/go-install-add-non-source-files-to-built-package/38709178#38709178", "title": "go install: add non-source files to built package", "body": "<p>You can \"pack\" the static files (text, images etc.) by including it into a .go file (usually automatically generated) and then compiling it into the stand-alone binary.  You can do it by using <a href=\"https://github.com/golang/tools/blob/master/godoc/static/makestatic.go\" rel=\"nofollow\">https://github.com/golang/tools/blob/master/godoc/static/makestatic.go</a> or with <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow\">https://github.com/jteeuwen/go-bindata</a>. See <a href=\"http://blog.ralch.com/tutorial/golang-embedded-resources/\" rel=\"nofollow\">http://blog.ralch.com/tutorial/golang-embedded-resources/</a> for more information and examples.</p>\n"}], "owner": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1304, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1615297220, "creation_date": 1470075858, "last_edit_date": 1615297220, "question_id": 38705615, "link": "https://stackoverflow.com/questions/38705615/go-install-add-non-source-files-to-built-package", "title": "go install: add non-source files to built package", "body": "<p>My $GOPATH looks like this:</p>\n\n<pre><code>src/\n  mypkg/\n    source.go\n    config.txt\nbin/\n  mypkg\npkg/\n  somestuff/\n</code></pre>\n\n<p>When I build my package with <code>go install</code> (that builds and places the executable in <code>bin</code>), I'd like <code>config.txt</code> to be copied in that folder together with the executable. Is there a way to do so?</p>\n\n<p>Sorry if I didn't find a way that may look obvious to you, but I'm new to programming, especially to Go.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470072664, "post_id": 38704769, "comment_id": 64787250, "body": "<code>goimports</code> already sorts imports, and also maintains any groupings you make in the import block."}, {"owner": {"reputation": 12868, "user_id": 350278, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9f7e4046c9835840862c86e7b9e0900d?s=128&d=identicon&r=PG", "display_name": "Jimmy Sawczuk", "link": "https://stackoverflow.com/users/350278/jimmy-sawczuk"}, "edited": false, "score": 1, "creation_date": 1470072691, "post_id": 38704769, "comment_id": 64787265, "body": "Regular old <code>go fmt</code> does the same thing."}, {"owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 0, "creation_date": 1470073115, "post_id": 38704769, "comment_id": 64787495, "body": "I was hoping there was a tool that would make the groupings based on a regex or something. goimports creates two groupings stdlib and everything else so it&#39;s close to what I want."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 2, "creation_date": 1470073926, "post_id": 38704769, "comment_id": 64787952, "body": "to be clear, add a blank line between groups you want to separate"}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 1, "creation_date": 1470075847, "post_id": 38704769, "comment_id": 64788896, "body": "Suggestion: Take a look at how goimports does it and then write your own tool for this to use in addition to goimports, and then edit save hooks to run both. <a href=\"https://github.com/golang/tools/blob/master/imports/sortimports.go\" rel=\"nofollow noreferrer\">github.com/golang/tools/blob/master/imports/sortimports.go</a>"}, {"owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 0, "creation_date": 1470077829, "post_id": 38704769, "comment_id": 64789893, "body": "yep, that&#39;s the plan, was just checking to make sure there isn&#39;t already on before i spend the time on it."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1470080389, "post_id": 38704769, "comment_id": 64791195, "body": "For future reference this kind of question would be good to ask on the gophers slack channel or the go-nuts IRC channel."}, {"owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 0, "creation_date": 1470080739, "post_id": 38704769, "comment_id": 64791376, "body": "Why don&#39;t you think this is good for stackoverflow?"}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1471884413, "post_id": 38704769, "comment_id": 65517389, "body": "Eh. It&#39;s ambiguous for sure. &quot;hey is there a tool for this?&quot; is called &quot;tool shopping&quot; on stack overflow and it&#39;s presented in contrast to problem solving which is the main focus of the site. But the boundaries are vague. I think more importantly on the irc and slack channels you&#39;re much more likely to get quicker and more informed responses."}], "answers": [{"comments": [{"owner": {"reputation": 650, "user_id": 3316842, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/27a97d409966980c6c4799dbf12d1903?s=128&d=identicon&r=PG&f=1", "display_name": "baskInEminence", "link": "https://stackoverflow.com/users/3316842/baskineminence"}, "edited": false, "score": 0, "creation_date": 1611388289, "post_id": 38714480, "comment_id": 116439727, "body": "install:      go get golang.org/x/tools/cmd/goimports options:    goimports -h example:   goimports -w -local &quot;companyrepos/&quot; . where -w updates source file and . refers to current directory path"}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 16, "last_activity_date": 1470123597, "creation_date": 1470123597, "answer_id": 38714480, "question_id": 38704769, "link": "https://stackoverflow.com/questions/38704769/golang-import-grouping-by-package/38714480#38714480", "title": "Golang import grouping by package", "body": "<p>The latest version of <code>goimports</code> support <code>-local</code> flag. Quoting <a href=\"https://github.com/golang/tools/commit/ed69e84b1518b5857a9f4e01d1f9cefdcc45246e\" rel=\"noreferrer\">this commit message</a>:</p>\n\n<p>For example, running <code>goimports -local example.com/</code> might produce</p>\n\n<pre><code>import (\n    \"database/sql\"\n    \"io\"\n    \"strconv\"\n\n    \"golang.org/x/net/context\"\n\n    \"example.com/foo/bar\"\n    \"example.com/foo/baz\"\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 12468633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dt0SQ.jpg?s=128&g=1", "display_name": "Viacheslav Pryimak", "link": "https://stackoverflow.com/users/12468633/viacheslav-pryimak"}, "is_accepted": false, "score": 3, "last_activity_date": 1599684942, "last_edit_date": 1599684942, "creation_date": 1587981746, "answer_id": 61456274, "question_id": 38704769, "link": "https://stackoverflow.com/questions/38704769/golang-import-grouping-by-package/61456274#61456274", "title": "Golang import grouping by package", "body": "<p>I've also, tried to found the right answer on it until I solved the issue by myself... You could try this tool to sort Golang imports: <a href=\"https://github.com/incu6us/goimports-reviser\" rel=\"nofollow noreferrer\">https://github.com/incu6us/goimports-reviser</a>.</p>\n<p>It will sort and split your imports into 3-4 groups. Also, using <code>-local</code>-option you could set your company's libraries for sorting into separate group.</p>\n"}], "owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9970, "favorite_count": 2, "accepted_answer_id": 38714480, "answer_count": 2, "score": 8, "last_activity_date": 1599684942, "creation_date": 1470072484, "last_edit_date": 1470203887, "question_id": 38704769, "link": "https://stackoverflow.com/questions/38704769/golang-import-grouping-by-package", "title": "Golang import grouping by package", "body": "<p>I see that Go has goimports to help with import grouping, but I'm wondering if anyone has created a package to group imports in groupings by some pattern?</p>\n\n<p>Go imports does this a little by enforcing at least two groupings stdlib and everything else; however, my company has a policy of grouping imports in 4 groups</p>\n\n<pre><code>import (\n    stdlib\n\n    current_project\n\n    company\n\n    all others \n)\n</code></pre>\n\n<p>is there a tool that can automatically do this?</p>\n"}, {"tags": ["security", "go"], "comments": [{"owner": {"reputation": 18922, "user_id": 3633742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/thyJX.jpg?s=128&g=1", "display_name": "n00dl3", "link": "https://stackoverflow.com/users/3633742/n00dl3"}, "edited": false, "score": 5, "creation_date": 1470062426, "post_id": 38701617, "comment_id": 64780989, "body": "you can publish a checksum of your binary files on your website for example to ensure they are not corrupted. Like many linux distro do with their images..."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1470062845, "post_id": 38701617, "comment_id": 64781282, "body": "i&#39;ll point out that hosting checksums over http are easily spoofed by a mitm attack, and checksums over https can be spoofed by a highly resourced attacker"}, {"owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "edited": false, "score": 0, "creation_date": 1470063447, "post_id": 38701617, "comment_id": 64781680, "body": "Let me add on to my question, so we have a main scheduler that usually runs on our client machine and this scheduler executes other .exe files. There is a possibility that one of the exe files get corrupted and we wont know about it.  Our scheduler will keep on executing the file. Checksum is one great way of ensuring this, are there any other methods?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 5, "creation_date": 1470064899, "post_id": 38701617, "comment_id": 64782587, "body": "Just like .Net executables, Go executables can be signed with <code>signtool</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1470064940, "post_id": 38701617, "comment_id": 64782612, "body": "You can cryptographically sign your binary and verify it later with standard tools. Having a binary self-verify is of limited use, since a malicious attacker modifying the binary can also modify the check. You need external tooling that&#39;s known to be secure, either provided by the OS or another resource (like gpg)."}], "answers": [{"comments": [{"owner": {"reputation": 1762, "user_id": 4283590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZoOij.jpg?s=128&g=1", "display_name": "M. Adeel Khalid", "link": "https://stackoverflow.com/users/4283590/m-adeel-khalid"}, "edited": false, "score": 0, "creation_date": 1495106837, "post_id": 44045645, "comment_id": 75118148, "body": "It was better if you posted this as a comment."}], "tags": [], "owner": {"reputation": 1, "user_id": 8030351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dd237e0b81f61fe926250bf171479b?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon S", "link": "https://stackoverflow.com/users/8030351/brandon-s"}, "is_accepted": false, "score": -2, "last_activity_date": 1495107712, "last_edit_date": 1495107712, "creation_date": 1495104398, "answer_id": 44045645, "question_id": 38701617, "link": "https://stackoverflow.com/questions/38701617/ensure-integrity-of-exe-files-in-golang/44045645#44045645", "title": "Ensure integrity of exe files in Golang", "body": "<p>Use installers such as Inno Setup, InstallShield or Wise Installer. They can check the integrity of the files before installation.</p>\n\n<p>Inno Setup supports for digitally signed installs and uninstalls, including dual signing (SHA1 &amp; SHA256).</p>\n\n<p>InstallShield uses MD5 checks the integrity of the package.</p>\n"}], "owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 550, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1495107712, "creation_date": 1470062278, "last_edit_date": 1470201043, "question_id": 38701617, "link": "https://stackoverflow.com/questions/38701617/ensure-integrity-of-exe-files-in-golang", "title": "Ensure integrity of exe files in Golang", "body": "<p>I have a question on deployment of <code>.exe</code> file developed using Go Language.</p>\n\n<p>.exe files will be deployed on the customer machines. Which means the integrity of the files (the files are not corrupted, infected) is important.</p>\n\n<p>What should be the approach to ensure that the .exe file is not infected, corrupted or replaced?</p>\n\n<p>(for example\n.Net binaries can be signed at compilation, which ensures integrity, and they can be digitally signed by a certificate, which ensures the source of the binary.)</p>\n\n<p>Do we have any such precautions in Golang?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["arrays", "go"], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 2, "last_activity_date": 1470062656, "creation_date": 1470062656, "answer_id": 38701778, "question_id": 38701478, "link": "https://stackoverflow.com/questions/38701478/compare-two-slices-and-delete-the-unique-values-in-golang/38701778#38701778", "title": "Compare two slices and delete the unique values in Golang", "body": "<p>You are updating <code>names</code> inside your inner <code>for</code> loop. However, your inner loop is also logically incorrect. The very first value in <code>board</code> not equal to a value in <code>names</code> will empty <code>names</code>. This also causes an <code>index out of range</code> error.</p>\n\n<p>You can try something like this:</p>\n\n<pre><code>var names = []string{\"F5\", \"F7\", \"C6\", \"H5\", \"G5\"}\nvar board = []string{\"B4\", \"D4\", \"G5\", \"F5\", \"F7\", \"C6\"}\n\nresults := make([]string, 0) // slice tostore the result\n\nfor i := 0; i &lt; len(names); i++ {\n    for k := 0; k &lt; len(board); k++ {\n        if names[i] != board[k] {               \n            continue\n        }\n        // append a value in result only if\n        // it exists both in names and board\n        results = append(results, names[i])\n    }\n}\nfmt.Printf(\"%v %d \\n\", results, len(results))\n</code></pre>\n\n<p>Example: <a href=\"https://play.golang.org/p/cQpzbvCGpO\" rel=\"nofollow\">https://play.golang.org/p/cQpzbvCGpO</a></p>\n"}, {"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470076787, "post_id": 38702877, "comment_id": 64789339, "body": "You&#39;re using a map of bools!  Take advantage of the fact that the zero value of a bool is false, and reading a non-existent key from a map returns that type&#39;s zero value: <a href=\"https://play.golang.org/p/WYQiUegf8F\" rel=\"nofollow noreferrer\">play.golang.org/p/WYQiUegf8F</a>."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470076804, "post_id": 38702877, "comment_id": 64789349, "body": "Unrelated, prefer the <code>make</code> or simple variable declaration to the empty literal for maps and slices.  It&#39;s more clear, and in the case of the slice, avoids an allocation of the underlying array if the slice is never appended to."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470077707, "post_id": 38702877, "comment_id": 64789831, "body": "@Kaedys, Thanks. On the first point you are totally right, I edited my answer to reflect your suggestion. On the second point, I just wanted to be consistent with how the OP was declaring and initializing variables."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470078003, "post_id": 38702877, "comment_id": 64789972, "body": "OP was declaring literals because he was initializing them with non-zero values.  Empty literals, on the other hand, tend to be frowned upon a bit by the Go community.  JimB has also chastised me in the past for posting code that is sub-optimal when it&#39;s just for the purposes of aligning with the OP&#39;s non-idiomatic style."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470080969, "post_id": 38702877, "comment_id": 64791488, "body": "@Kaedys, I addressed the second point too. Thanks for pointing it out."}], "tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 1, "last_activity_date": 1470080792, "last_edit_date": 1470080792, "creation_date": 1470065931, "answer_id": 38702877, "question_id": 38701478, "link": "https://stackoverflow.com/questions/38701478/compare-two-slices-and-delete-the-unique-values-in-golang/38702877#38702877", "title": "Compare two slices and delete the unique values in Golang", "body": "<p>You can create a <code>map</code> out of one of your arrays and avoid the nested loop, for example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    var names = []string{\"F5\", \"F7\", \"C6\", \"H5\", \"G5\"}\n    var board = []string{\"B4\", \"D4\", \"G5\", \"F5\", \"F7\", \"C6\"}\n\n    var board_map = make(map[string]bool)\n\n    for _, ele := range board {\n        board_map[ele] = true\n    }\n\n    var result []string\n\n    for _, name := range names {\n        if board_map[name] {\n            result = append(result, name)\n        }\n    }\n\n    fmt.Println(result)\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/mMrAD3A5ty\" rel=\"nofollow\">Go Playground</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 1, "last_activity_date": 1470745097, "last_edit_date": 1470745097, "creation_date": 1470210824, "answer_id": 38737594, "question_id": 38701478, "link": "https://stackoverflow.com/questions/38701478/compare-two-slices-and-delete-the-unique-values-in-golang/38737594#38737594", "title": "Compare two slices and delete the unique values in Golang", "body": "<p>You need the intersection of two slices (delete the unique values from the first slice), try this working sample code (and notice the <code>i++</code>):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    names := []string{\"F5\", \"F7\", \"C6\", \"H5\", \"G5\"}\n    board := []string{\"B4\", \"D4\", \"G5\", \"F5\", \"F7\", \"C6\"}\n    for i := 0; i &lt; len(names); {\n        exist := false\n        for _, b := range board {\n            if b == names[i] {\n                exist = true\n                break\n            }\n        }\n        if !exist {\n            names = append(names[:i], names[i+1:]...) // delete names[i]\n        } else {\n            i++\n        }\n    }\n    fmt.Println(names) // [F5 F7 C6 G5]\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[F5 F7 C6 G5]\n</code></pre>\n\n<p>Also you may use this for the intersection of two slices with new <code>result</code>, try this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    names := []string{\"F5\", \"F7\", \"C6\", \"H5\", \"G5\"}\n    board := []string{\"B4\", \"D4\", \"G5\", \"F5\", \"F7\", \"C6\"}\n    result := make([]string, 0, 11)\n    for _, v := range names {\n        exist := false\n        for _, w := range board {\n            if v == w {\n                exist = true\n                break\n            }\n        }\n        if exist {\n            result = append(result, v)\n        }\n    }\n    fmt.Println(result) // [F5 F7 C6 G5]\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[F5 F7 C6 G5]\n</code></pre>\n\n<p>or if you need The union of two slices, try this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    names := []string{\"F5\", \"F7\", \"C6\", \"H5\", \"G5\"}\n    board := []string{\"B4\", \"D4\", \"G5\", \"F5\", \"F7\", \"C6\"}\n    for _, b := range board {\n        exist := false\n        for _, n := range names {\n            if n == b {\n                exist = true\n                break\n            }\n        }\n        if !exist {\n            names = append(names, b)\n        }\n    }\n    fmt.Println(names) // [F5 F7 C6 H5 G5 B4 D4]\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[F5 F7 C6 H5 G5 B4 D4]\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3060, "favorite_count": 0, "accepted_answer_id": 38737594, "answer_count": 3, "score": 2, "last_activity_date": 1470745123, "creation_date": 1470061898, "last_edit_date": 1470745123, "question_id": 38701478, "link": "https://stackoverflow.com/questions/38701478/compare-two-slices-and-delete-the-unique-values-in-golang", "title": "Compare two slices and delete the unique values in Golang", "body": "<p>I have this but it is not working properly :</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var i int\nvar names = []string{\"F5\", \"F7\", \"C6\", \"H5\", \"G5\"}\nvar board = []string{\"B4\", \"D4\", \"G5\", \"F5\", \"F7\", \"C6\"}\n\nfor i = 0; i &lt; len(names)-1; i++ {\n    for k := 0; k &lt; len(board)-1; k++ {\n        if names[i] != board[k] {\n            names = append(names[:i], names[i+1:]...)\n        }\n    }\n}\nfmt.Printf(\"%s \", names[i])\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 1, "creation_date": 1470060668, "post_id": 38700883, "comment_id": 64779834, "body": "So the :80 server gets the <code>redirectTLS</code> handler, thus it knows what to do with the requests. The :443 server gets an empty router instead, so how should it now that it should redirect anything anywhere?"}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1470065492, "post_id": 38700883, "comment_id": 64782989, "body": "have you considered putting a simple nginx server in front of your go app? it&#39;s built for this"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1470066041, "post_id": 38700883, "comment_id": 64783399, "body": "Yes I have considered nginx, and I do not think it is a good enough reason to add another thing to my stack just to redirect from www."}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1470080667, "creation_date": 1470060149, "last_edit_date": 1470080667, "question_id": 38700883, "link": "https://stackoverflow.com/questions/38700883/redirecting-https-www-domain-com-to-https-domain-com-in-go", "title": "Redirecting https://www.domain.com to https://domain.com in Go", "body": "<p>Right now I am doing a redirect of everything that is http:// to https:// like this:</p>\n\n<pre><code>func main() {\n    router := httprouter.New()\n    router.POST(\"/api/register\", toHandle(register))\n    router.GET(\"/api/token/verify/:token\", toHandle(verifyToken))\n    router.GET(\"/api/availability/username/:username\", toHandle(usernameAvailability))\n    router.POST(\"/api/search/cities\", toHandle(searchCities))\n    router.POST(\"/api/user\", toHandle(createUser))\n    router.GET(\"/api/user/:id\", toHandle(userById))\n    router.POST(\"/api/login\", toHandle(login))\n    router.NotFound = &amp;serveStatic{}\n\n    certificate := \"/srv/ssl/ssl-bundle.crt\"\n    privateKey := \"/srv/ssl/private.key\"\n\n    go func() {\n        if err := http.ListenAndServe(\":80\", http.HandlerFunc(redirectTLS)); err != nil {\n            log.Fatalf(\"ListenAndServe error: %v\", err)\n        }\n    }()\n    log.Fatal(http.ListenAndServeTLS(\":443\", certificate, privateKey, router))  \n}\n\nfunc redirectTLS(w http.ResponseWriter, r *http.Request) {\n    http.Redirect(w, r, \"https://domain.com\"+r.RequestURI, http.StatusMovedPermanently)\n}\n\ntype serveStatic struct{}\n\nfunc (df *serveStatic) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n\n    path := filepath.FromSlash(config.DirRoot + req.URL.Path)\n    data, err := ioutil.ReadFile(path)\n\n    var contentType string\n\n    if err == nil {\n\n        if strings.HasSuffix(path, \".css\") {\n            contentType = \"text/css\"\n        } else if strings.HasSuffix(path, \".html\") {\n            contentType = \"text/html\"\n        } else if strings.HasSuffix(path, \".js\") {\n            contentType = \"application/javascript\"\n        } else if strings.HasSuffix(path, \".png\") {\n            contentType = \"image/png\"\n        } else if strings.HasSuffix(path, \".jpg\") {\n            contentType = \"image/jpeg\"\n        } else if strings.HasSuffix(path, \".ico\") {\n            contentType = \"image/x-icon\"\n        } else {\n            contentType = \"text/plain\"\n        }\n\n        // spew.Dump(path)\n\n        w.Header().Add(\"Content-Type\", contentType)\n\n        // Prefix files with gz such as \"all.gz.js\" if you want gzipped files to be served.\n        if strings.Contains(path, \".gz.\") {\n            w.Header().Add(\"Content-Encoding\", \"gzip\")\n        }\n\n        w.Write(data)\n\n    } else {\n\n        path := filepath.FromSlash(config.DirRoot + \"/index.html\")\n        data, err = ioutil.ReadFile(path)\n        contentType = \"text/html\"\n\n        if err == nil {\n            w.Header().Add(\"Content-Type\", contentType)\n            w.Write(data)\n        } else {\n            w.WriteHeader(404)\n            w.Write([]byte(\"404 - \" + http.StatusText(404)))\n        }\n\n    }\n}\n</code></pre>\n\n<p>But this does not redirect <a href=\"https://www.domain.com\" rel=\"nofollow\">https://www.domain.com</a> to <a href=\"https://domain.com\" rel=\"nofollow\">https://domain.com</a>, it only redirects <a href=\"http://domain.com\" rel=\"nofollow\">http://domain.com</a> to <a href=\"https://domain.com\" rel=\"nofollow\">https://domain.com</a>.</p>\n\n<p>How can I even detect requests that start with <a href=\"https://www.domain.com\" rel=\"nofollow\">https://www.domain.com</a>?</p>\n\n<p>Any suggestions on how this can be achieved?</p>\n"}, {"tags": ["json", "go", "gofmt"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1470060634, "last_edit_date": 1495540292, "creation_date": 1470059428, "answer_id": 38700627, "question_id": 38700513, "link": "https://stackoverflow.com/questions/38700513/runtime-error-when-parsing-json-array-and-map-elements-with-trailing-commas/38700627#38700627", "title": "Runtime error when parsing JSON array and map elements with trailing commas", "body": "<p>There is not. The <a href=\"http://www.json.org/\" rel=\"nofollow noreferrer\">JSON specification</a> does not allow a trailing comma.</p>\n\n<p>This is not a valid JSON:</p>\n\n<pre><code>{ \"objects\": \n    [ \n        {\"name\": \"foo\"},\n]}\n</code></pre>\n\n<p>It's a Go syntax that you need to use a comma if the enumeration is not closed on the line (<a href=\"https://stackoverflow.com/a/34848928/1705598\">more on this</a>), e.g.:</p>\n\n<pre><code>// Slice literal:\ns := []int {\n    1,\n    2,\n}\n\n// Function call:\nfmt.Println(\n    \"Slice:\",\n    s,\n)\n</code></pre>\n\n<p>Even if you could \"convince\" one specific JSON parser to silently swallow it, other, valid JSON parsers would report an error, rightfully. Don't do it.</p>\n"}], "owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 0, "accepted_answer_id": 38700627, "answer_count": 1, "score": 1, "last_activity_date": 1470060634, "creation_date": 1470059151, "question_id": 38700513, "link": "https://stackoverflow.com/questions/38700513/runtime-error-when-parsing-json-array-and-map-elements-with-trailing-commas", "title": "Runtime error when parsing JSON array and map elements with trailing commas", "body": "<p>Dave Cheney, one of the leading subject matter experts on Go, wrote: \"When initializing a variable with a composite literal, Go requires that each line of the composite literal end with a comma, even the last line of your declaration. This is the result of the <a href=\"http://dave.cheney.net/2014/10/04/that-trailing-comma\" rel=\"nofollow\">semicolon rule</a>.\"</p>\n\n<p>However, when I am trying to apply that beautiful rule to JSON text, the parser doesn't seem to agree with this philosophy. In the code below, removing the comma works. Is there a fix for this so I can just see one line change when I add elements in my diffs?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype jsonobject struct {\n    Objects []ObjectType `json:\"objects\"`\n}\n\ntype ObjectType struct {\n    Name string `json:\"name\"`\n}\n\nfunc main() {\n    bytes := []byte(`{ \"objects\": \n        [ \n            {\"name\": \"foo\"}, // REMOVE THE COMMA TO MAKE THE CODE WORK!\n        ]}`)\n    jsontype := &amp;jsonobject{}\n    json.Unmarshal(bytes, &amp;jsontype)\n    fmt.Printf(\"Results: %v\\n\", jsontype.Objects[0].Name) // panic: runtime error: index out of range\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1470056047, "post_id": 38699405, "comment_id": 64776650, "body": "There are no &quot;handles&quot; (pointers) to <code>Container</code> -- you&#39;re returning the struct by value, not a pointer to it."}], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 3, "last_activity_date": 1470056383, "last_edit_date": 1470056383, "creation_date": 1470056079, "answer_id": 38699477, "question_id": 38699405, "link": "https://stackoverflow.com/questions/38699405/string-array-replaced-on-instance-isnt-reflected/38699477#38699477", "title": "String array replaced on instance isn&#39;t reflected", "body": "<p>It is because you are using the slice's value. You return the value of the slice which is returned to <code>main</code> by copy. Goroutine then executes and updates the original value. Make the following changes:</p>\n\n<pre><code>func Create() *Container { // return a pointer to container\n\n    // instance is now initialized and points to a Container value\n    // (i.e. instance is of type *Container)\n    instance := &amp;Container{\n        values: []string{\"initial value\"},\n    }\n    go func() {\n        instance.values = []string{\"modified value\"}\n        fmt.Print(\"values updated\")\n    }()\n    return instance\n}\n</code></pre>\n\n<p>Now that main has a pointer to the above <code>instance</code>, modifications done by goroutine will be visible.</p>\n\n<p>Example: <a href=\"https://play.golang.org/p/AKwUZfTu0s\" rel=\"nofollow\">https://play.golang.org/p/AKwUZfTu0s</a></p>\n\n<p>Also, to create a new value, you can directly use the type's name:</p>\n\n<pre><code>instance := Container{ // instance is of type Container\n    // ...\n}\n</code></pre>\n\n<p>And to create and initialize a pointer of a type, use:</p>\n\n<pre><code>instance := &amp;Container{ // instance is of type *Container\n    // ...\n}\n</code></pre>\n\n<p>Doing something like below is redundant:</p>\n\n<pre><code>instance := *&amp;Container{ // instance is of type Container. Same as first declaration\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 134715, "user_id": 67, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3e9f1629fd4cb4a5ce9fbd27b13e862d?s=128&d=identicon&r=PG", "display_name": "Rex M", "link": "https://stackoverflow.com/users/67/rex-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 38699477, "answer_count": 1, "score": 1, "last_activity_date": 1470056383, "creation_date": 1470055873, "question_id": 38699405, "link": "https://stackoverflow.com/questions/38699405/string-array-replaced-on-instance-isnt-reflected", "title": "String array replaced on instance isn&#39;t reflected", "body": "<p>I have an instance of a struct that has an array field. When a goroutine replaces the array on the instance, all the other handles to that instance still have the original array. Why is this? What should I change so that the instance of <code>Container</code> below will reflect the change made on the goroutine?</p>\n\n<p>A simple example is also reflected here: <a href=\"https://play.golang.org/p/dXVKN6o8aP\" rel=\"nofollow\">https://play.golang.org/p/dXVKN6o8aP</a></p>\n\n<pre><code>func Create() Container {\n    instance := *&amp;Container{\n        values: []string{\"initial value\"},\n    }\n    go func() {\n        instance.values = []string{\"modified value\"}\n        fmt.Print(\"values updated\")\n    }()\n    return instance\n}\n\nfunc main() {\n    instance := Create()\n    time.Sleep(100 * time.Millisecond)\n    fmt.Printf(\"%[1]v\", instance.values)\n    //prints \"initial value\", but I expected \"modified value\"\n}\n</code></pre>\n"}, {"tags": ["web-services", "redirect", "go", "server"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 6516927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8846f430177342654f12520e70889163?s=128&d=identicon&r=PG&f=1", "display_name": "subado512", "link": "https://stackoverflow.com/users/6516927/subado512"}, "edited": false, "score": 0, "creation_date": 1470052535, "post_id": 38698117, "comment_id": 64774372, "body": "It still does the same thing."}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 1, "creation_date": 1470053483, "post_id": 38698117, "comment_id": 64774958, "body": "In the <code>serveChat()</code> the ResponseWriter is sent as parameter on line <code>if user, err := aaa.CurrentUser(w, r);</code> - now if this function (CurrentUser) writes something to the <code>w</code>, then the headers are sent and your redirect headers will be lost."}, {"owner": {"reputation": 75, "user_id": 6516927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8846f430177342654f12520e70889163?s=128&d=identicon&r=PG&f=1", "display_name": "subado512", "link": "https://stackoverflow.com/users/6516927/subado512"}, "edited": false, "score": 0, "creation_date": 1470088138, "post_id": 38698117, "comment_id": 64794864, "body": "Ah, I think you are right. Is there anyway to fix this?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 75, "user_id": 6516927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8846f430177342654f12520e70889163?s=128&d=identicon&r=PG&f=1", "display_name": "subado512", "link": "https://stackoverflow.com/users/6516927/subado512"}, "edited": false, "score": 1, "creation_date": 1470088181, "post_id": 38698117, "comment_id": 64794883, "body": "@subado512: Refactor your code so <code>aaa.CurrentUser</code> doesn&#39;t write anything out."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 5, "last_activity_date": 1470052179, "creation_date": 1470052179, "answer_id": 38698117, "question_id": 38698066, "link": "https://stackoverflow.com/questions/38698066/go-lang-http-redirect-doesnt-really-redirect-in-my-server/38698117#38698117", "title": "Go lang http.Redirect doesn&#39;t really redirect in my server", "body": "<p><code>http.Redirect</code> must be called before the response headers are written, so place it before <code>w.Write</code>:</p>\n\n<pre><code>}else {\n    //user is not logged in\n    http.Redirect(w,r,\"/login\",http.StatusUnauthorized)\n    w.Write([]byte(\"&lt;script&gt;alert('Please login')&lt;/script&gt;\"))\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 6516927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8846f430177342654f12520e70889163?s=128&d=identicon&r=PG&f=1", "display_name": "subado512", "link": "https://stackoverflow.com/users/6516927/subado512"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3886, "favorite_count": 0, "accepted_answer_id": 38698117, "answer_count": 1, "score": 3, "last_activity_date": 1470052563, "creation_date": 1470052055, "last_edit_date": 1470052563, "question_id": 38698066, "link": "https://stackoverflow.com/questions/38698066/go-lang-http-redirect-doesnt-really-redirect-in-my-server", "title": "Go lang http.Redirect doesn&#39;t really redirect in my server", "body": "<p>I have a simple-ish chat server, For some reason the http.Redirect function isn't really working. The problem is that instead of actually redirecting me to '/login' it provides a html page with a link to /login. Which is quite annoying, because no CSS is present and it looks ugly. </p>\n\n<pre><code>func static(w http.ResponseWriter, r *http.Request) {\n    //check backend\n    if user, err := aaa.CurrentUser(w, r); err == nil {\n        //user is logged in\n        log.Println(user)\n        vars := mux.Vars(r)\n        page := vars[\"page\"]\n        data, _ := ioutil.ReadFile(\"downloads/\" + page)\n        w.Write(data)\n        return\n    }else {\n        //user is not logged in\n        http.Redirect(w,r,\"/login\",http.StatusUnauthorized)\n        w.Write([]byte(\"&lt;script&gt;alert('Please login')&lt;/script&gt;\"))\n        return\n    }\n} \n</code></pre>\n\n<p>For example when the user is not logged in the javascript alert comes up and take me to this page <code>&lt;a href=\"/login\"&gt;Unauthorized&lt;/a&gt;.</code> That is all the html page contains. just that single href no headers, nothing. </p>\n\n<p><strong>Just in case-main.go code(should be sufficient)</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"html/template\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n    \"strings\"\n    \"strconv\"\n    \"time\"\n    \"github.com/apexskier/httpauth\"\n    \"github.com/gorilla/mux\"\n    \"runtime\"\n)\n\nvar (\n    backend     httpauth.LeveldbAuthBackend\n    aaa         httpauth.Authorizer\n    roles       map[string]httpauth.Role\n    port        = 80\n    backendfile = \"auth.leveldb\"\n)\n\nfunc static(w http.ResponseWriter, r *http.Request) {\n    if user, err := aaa.CurrentUser(w, r); err == nil {\n        log.Println(user)\n        vars := mux.Vars(r)\n        page := vars[\"page\"]\n        data, _ := ioutil.ReadFile(\"downloads/\" + page)\n        w.Write(data)\n        return\n    }else {\n        w.Write([]byte(\"&lt;script&gt;alert('Please login')&lt;/script&gt;\"))\n        http.Redirect(w,r,\"/login\",http.StatusUnauthorized)\n        return\n    }\n}\nfunc main() {\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    var err error\n    os.Mkdir(backendfile, 0755)\n    defer os.Remove(backendfile)\n\n    // create the backend\n    backend, err = httpauth.NewLeveldbAuthBackend(backendfile)\n    if err != nil {\n        panic(err)\n    }\n\n    // create some default roles\n    roles = make(map[string]httpauth.Role)\n    roles[\"user\"] = 30\n    roles[\"admin\"] = 80\n    aaa, err = httpauth.NewAuthorizer(backend, []byte(\"cookie-encryption-key\"), \"user\", roles)\n\n    // create a default user\n    username := \"admin\"\n    defaultUser := httpauth.UserData{Username: username, Role: \"admin\"}\n    err = backend.SaveUser(defaultUser)\n    if err != nil {\n        panic(err)\n    }\n    // Update user with a password and email address\n    err = aaa.Update(nil, nil, username, \"adminadmin\", \"admin@localhost.com\")\n    if err != nil {\n        panic(err)\n    }\n\n    // set up routers and route handlers\n    flag.Parse()\n    hub := newHub()\n    go hub.run()\n    r := mux.NewRouter()\n    r.HandleFunc(\"/chat\", serveChat)\n    r.HandleFunc(\"/ws\", func(w http.ResponseWriter, r *http.Request) {\n        serveWs(hub, w, r)\n    })\n    r.HandleFunc(\"/downloads/{page}\", static)\n    http.Handle(\"/www/\", http.StripPrefix(\"/www/\", http.FileServer(http.Dir(\"./www\"))))\n    r.HandleFunc(\"/login\", getLogin).Methods(\"GET\")\n    r.HandleFunc(\"/register\", postRegister).Methods(\"POST\")\n    r.HandleFunc(\"/register\", getRegister).Methods(\"GET\")\n    r.HandleFunc(\"/login\", postLogin).Methods(\"POST\")\n    r.HandleFunc(\"/admin\", handleAdmin).Methods(\"GET\")\n    r.HandleFunc(\"/add_user\", postAddUser).Methods(\"POST\")\n    r.HandleFunc(\"/change\", postChange).Methods(\"POST\")\n    r.HandleFunc(\"/\", handlePage).Methods(\"GET\") // authorized page\n    r.HandleFunc(\"/logout\", handleLogout)\n    r.HandleFunc(\"/home\", homeHandle).Methods(\"GET\")\n\n    http.Handle(\"/\", r)\n    fmt.Printf(\"Server running on port %d\\n\", port)\n    srv:=&amp;http.Server {\n        Addr: \":\"+strconv.Itoa(port),\n        ReadTimeout: 10* time.Second,\n        WriteTimeout: 10*time.Second,\n        MaxHeaderBytes: 1&lt;&lt;20,\n    }\n    srv.ListenAndServe()\n}\nfunc serveChat(w http.ResponseWriter, r *http.Request) {\n    if user, err := aaa.CurrentUser(w, r); err == nil {\n        log.Println(r.URL)\n        log.Println(user)\n        w.Header().Set(\"Content-Type\", \"text/html; charset=utf-8\")\n        chatt, _ := template.New(\"member\").Parse(chat)\n        chatt.Execute(w, r.Host)\n        return\n    } else {\n        http.Redirect(w, r, \"/login\", http.StatusUnauthorized)\n        return\n    }\n}\n\ntype Page struct {\n    USER httpauth.UserData\n}\n\nfunc homeHandle(w http.ResponseWriter, r *http.Request) {\n    if user, err := aaa.CurrentUser(w, r); err == nil {\n        type data struct {\n            User  httpauth.UserData\n            Roles map[string]httpauth.Role\n            Users []httpauth.UserData\n            Msg   []string\n        }\n        messages := aaa.Messages(w, r)\n        users, err := backend.Users()\n        if err != nil {\n            panic(err)\n        }\n        d := data{User: user, Roles: roles, Users: users, Msg: messages}\n        homet, _ := template.New(\"member\").Parse(member)\n        homet.Execute(w, d)\n        return\n    } else {\n        http.Redirect(w, r, \"/login\", http.StatusUnauthorized)\n        return\n    }\n}\nfunc getRegister(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, register)\n    return\n}\nfunc getLogin(rw http.ResponseWriter, req *http.Request) {\n    fmt.Fprintf(rw, login)\n    return\n}\n\nfunc postLogin(rw http.ResponseWriter, req *http.Request) {\n    username := req.PostFormValue(\"username\")\n    password := req.PostFormValue(\"password\")\n    if err := aaa.Login(rw, req, username, password, \"/home\"); err == nil || (err != nil &amp;&amp; strings.Contains(err.Error(), \"already authenticated\")) {\n        http.Redirect(rw, req, \"/home\", http.StatusSeeOther)\n        return\n    } else if err != nil {\n        fmt.Println(err)\n        http.Redirect(rw, req, \"/login\", http.StatusSeeOther)\n        return\n    }\n}\n\nfunc postRegister(rw http.ResponseWriter, req *http.Request) {\n    var user httpauth.UserData\n    user.Username = req.PostFormValue(\"username\")\n    user.Email = req.PostFormValue(\"email\")\n    password := req.PostFormValue(\"password\")\n    if err := aaa.Register(rw, req, user, password); err == nil {\n        postLogin(rw, req)\n        return\n    } else {\n        http.Redirect(rw, req, \"/login\", http.StatusSeeOther)\n        return\n    }\n}\n\nfunc postAddUser(rw http.ResponseWriter, req *http.Request) {\n    var user httpauth.UserData\n    user.Username = req.PostFormValue(\"username\")\n    user.Email = req.PostFormValue(\"email\")\n    password := req.PostFormValue(\"password\")\n    user.Role = req.PostFormValue(\"role\")\n    if err := aaa.Register(rw, req, user, password); err != nil {\n        // maybe something\n    }\n    http.Redirect(rw, req, \"/admin\", http.StatusSeeOther)\n    return\n}\n\nfunc postChange(rw http.ResponseWriter, req *http.Request) {\n    email := req.PostFormValue(\"new_email\")\n    aaa.Update(rw, req, \"\", \"\", email)\n    http.Redirect(rw, req, \"/\", http.StatusSeeOther)\n    return\n}\n\nfunc handlePage(rw http.ResponseWriter, req *http.Request) {\n    rw.Write([]byte(index))\n    return\n}\n\nfunc handleAdmin(rw http.ResponseWriter, req *http.Request) {\n    if err := aaa.AuthorizeRole(rw, req, \"admin\", true); err != nil {\n        fmt.Println(err)\n        http.Redirect(rw, req, \"/login\", http.StatusSeeOther)\n        return\n    }\n    if user, err := aaa.CurrentUser(rw, req); err == nil {\n        type data struct {\n            User  httpauth.UserData\n            Roles map[string]httpauth.Role\n            Users []httpauth.UserData\n            Msg   []string\n        }\n        messages := aaa.Messages(rw, req)\n        users, err := backend.Users()\n        if err != nil {\n            panic(err)\n        }\n        d := data{User: user, Roles: roles, Users: users, Msg: messages}\n        t, err := template.New(\"admin\").Parse(admin)\n        if err != nil {\n            panic(err)\n        }\n        t.Execute(rw, d)\n        return\n    }\n}\n\nfunc handleLogout(rw http.ResponseWriter, req *http.Request) {\n    if err := aaa.Logout(rw, req); err != nil {\n        fmt.Println(err)\n        // this shouldn't happen\n        return\n    }\n    http.Redirect(rw, req, \"/\", http.StatusSeeOther)\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "scope"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1470052950, "post_id": 38697987, "comment_id": 64774619, "body": "you would use it if you needed the same identifier for two different variables, i.e. you might redefine <code>someBoolValue:=&quot;banana&quot;</code> in the block, and it will still be the passed-in value after the block. (the same scoping occurs within for/if/switch/select/func blocks, as other answers mention)"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 4, "last_activity_date": 1470052205, "last_edit_date": 1495542261, "creation_date": 1470052205, "answer_id": 38698128, "question_id": 38697987, "link": "https://stackoverflow.com/questions/38697987/golang-function-contains-anonymous-scope/38698128#38698128", "title": "Golang function contains anonymous scope", "body": "<p>It is called Variable scoping and shadowing:  </p>\n\n<blockquote>\n  <p>Go is lexically scoped using blocks:</p>\n  \n  <p>1-The scope of a predeclared identifier is the universe block.<br>\n  2-The scope of an identifier denoting a constant, type, variable, or\n  function (but not method) declared at top level (outside any function)\n  is the package block.<br>\n  3-The scope of the package name of an imported\n  package is the file block of the file containing the import\n  declaration.<br>\n   4-The scope of an identifier denoting a method receiver,\n  function parameter, or result variable is the function body.<br>\n  5-The scope of a constant or variable identifier declared inside a function\n  begins at the end of the ConstSpec or VarSpec (ShortVarDecl for short\n  variable declarations) and ends at the end of the innermost containing\n  block.<br>\n  6-The scope of a type identifier declared inside a function\n  begins at the identifier in the TypeSpec and ends at the end of the\n  innermost containing block. An identifier declared in a block may be\n  redeclared in an inner block. While the identifier of the inner\n  declaration is in scope, it denotes the entity declared by the inner\n  declaration.</p>\n  \n  <p>The package clause is not a declaration; the package name does not\n  appear in any scope. Its purpose is to identify the files belonging to\n  the same package and to specify the default package name for import\n  declarations.</p>\n</blockquote>\n\n<p>your working sample code:  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    i := 10\n    {\n        i := 1\n        fmt.Println(i)  // 1\n    }\n    fmt.Println(i)  // 10\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>1\n10\n</code></pre>\n\n<p>and see: <a href=\"https://stackoverflow.com/questions/36553134/where-can-we-use-variable-shadowing-and-why\">Where can we use Variable Scoping and Shadowing in Go?</a></p>\n"}, {"comments": [{"owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "edited": false, "score": 1, "creation_date": 1470054938, "post_id": 38698179, "comment_id": 64775909, "body": "thanks for the response. I think they might have been unnecessarily used in my example, but I now understand their correct use."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1470052358, "creation_date": 1470052358, "answer_id": 38698179, "question_id": 38697987, "link": "https://stackoverflow.com/questions/38697987/golang-function-contains-anonymous-scope/38698179#38698179", "title": "Golang function contains anonymous scope", "body": "<p><code>{}</code> in Go form a <em>Syntactic Block</em>. Each block defines a new scope. These are same blocks that you use with <code>if</code> and <code>for</code> for example.</p>\n\n<p>With respect to your code, I guess they exist mainly for readability purpose. You can reuse or hide variable defined in the enclosing scope to make use of variables names that maybe declare the code's intent more clearly.</p>\n\n<p>Other than that they can also be used to group a bunch of related statements, again for readability.</p>\n\n<p>To understand their behavior, refer to @Amd's answer.</p>\n"}], "owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1228, "favorite_count": 1, "accepted_answer_id": 38698128, "answer_count": 2, "score": 5, "last_activity_date": 1470052358, "creation_date": 1470051796, "question_id": 38697987, "link": "https://stackoverflow.com/questions/38697987/golang-function-contains-anonymous-scope", "title": "Golang function contains anonymous scope", "body": "<p>Can someone give me an explanation as to when and why I would use anonymous scope inside a function? (I'm not sure what it's actually called).</p>\n\n<p>I've been given some legacy code to maintain and some of the functions contain this \"scope\" I have not seen before:</p>\n\n<p>(simplified for demonstration purposes)</p>\n\n<pre><code>func DoSomething(someBoolValue bool) string {\n    if someBoolValue {\n        // do some stuff\n        return \"yes\"\n    }\n    {\n        // weird scope code\n    }\n    return \"no\"\n}\n</code></pre>\n\n<p>I have created a <a href=\"https://play.golang.org/p/4yNpvB7SL0\" rel=\"noreferrer\">Go Playground</a> to demonstrate some actual code (that throws an error).</p>\n"}, {"tags": ["go", "cryptography"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4060787, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c50243836a82234f490783b797b9791?s=128&d=identicon&r=PG&f=1", "display_name": "GajaLulu", "link": "https://stackoverflow.com/users/4060787/gajalulu"}, "edited": false, "score": 2, "creation_date": 1470049958, "post_id": 38697341, "comment_id": 64772891, "body": "Thank you! I&#39;ve just found this out. Also wanted to add that the code above with output &quot;false&quot;, since the md5 itself was not imported. If you add <code>crypto&#47;md5</code> to your import statement, the output will be true"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1470053536, "post_id": 38697341, "comment_id": 64774996, "body": "Just voted the other answer up because this comment wasn&#39;t integrated into the answer. Please edit answers and don&#39;t just leave such information in comments."}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 1, "creation_date": 1470054435, "post_id": 38697341, "comment_id": 64775583, "body": "The question isn&#39;t about the <code>Available()</code> function and on which circumstances it returns true or false, but about confusion on how to call it. To quote the OP: <i>As I understood from the documentation, the Available() function should return true if the given hash function was imported</i> - so he already knows it and just repeated in the comment what he had already said in the question."}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": false, "score": 2, "last_activity_date": 1470050292, "last_edit_date": 1470050292, "creation_date": 1470049832, "answer_id": 38697341, "question_id": 38697202, "link": "https://stackoverflow.com/questions/38697202/golang-cryptos-package-function-available-is-undefined/38697341#38697341", "title": "Golang - Crypto&#39;s package function &quot;Available()&quot; is undefined", "body": "<p>The <code>md5</code> youre using is package's identifier, what you need is \"instance\" of type <a href=\"https://golang.org/pkg/crypto/#Hash\" rel=\"nofollow\">Hash</a>:</p>\n\n<pre><code>import (\n    \"crypto\"\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(crypto.MD5.Available())\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>false\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1470050945, "last_edit_date": 1470050945, "creation_date": 1470050213, "answer_id": 38697472, "question_id": 38697202, "link": "https://stackoverflow.com/questions/38697202/golang-cryptos-package-function-available-is-undefined/38697472#38697472", "title": "Golang - Crypto&#39;s package function &quot;Available()&quot; is undefined", "body": "<p><code>crypto.MD5.Available()</code>: </p>\n\n<blockquote>\n  <p>Available reports whether the given hash function is linked into the\n  binary.</p>\n</blockquote>\n\n<p>hash function is linked into the binary:<br>\nworking sample code ( with <code>crypto.MD5.Available()</code> == <code>true</code>):  </p>\n\n<pre><code>package main\n\nimport (\n    \"crypto\"\n    \"crypto/md5\"\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(crypto.MD5.Available()) // true\n\n    w := md5.New()\n    fmt.Fprintf(w, \"Hello World\")\n    fmt.Printf(\"%x \\n\", w.Sum(nil))\n}\n</code></pre>\n\n<p>hash function is not linked into the binary:  </p>\n\n<pre><code>package main\n\nimport (\n    \"crypto\"\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(crypto.MD5.Available())\n}\n</code></pre>\n\n<p>output:   </p>\n\n<pre><code>false\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4060787, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c50243836a82234f490783b797b9791?s=128&d=identicon&r=PG&f=1", "display_name": "GajaLulu", "link": "https://stackoverflow.com/users/4060787/gajalulu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1470050945, "creation_date": 1470049439, "last_edit_date": 1470050146, "question_id": 38697202, "link": "https://stackoverflow.com/questions/38697202/golang-cryptos-package-function-available-is-undefined", "title": "Golang - Crypto&#39;s package function &quot;Available()&quot; is undefined", "body": "<p>It might be a very basic and stupid question, but I'm stuck. As I understood from the <a href=\"https://golang.org/pkg/crypto/#Hash.Available\" rel=\"nofollow\" title=\"documentation\">documentation</a>, the Available() function should return <code>true</code> if the given hash function was imported. So, this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/md5\"\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(md5.Available())\n}\n</code></pre>\n\n<p>Should produce <code>true</code> as an output. However, I get the \"./main.go:10: undefined: md5.Available\" error when trying to run code above. What am I missing? Thanks in advance.</p>\n"}, {"tags": ["mysql", "web", "go", "image-upload"], "comments": [{"owner": {"reputation": 47988, "user_id": 267540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2v58W.jpg?s=128&g=1", "display_name": "e4c5", "link": "https://stackoverflow.com/users/267540/e4c5"}, "edited": false, "score": 1, "creation_date": 1470041949, "post_id": 38694668, "comment_id": 64768202, "body": "consider yourself lucky that you don&#39;t know how to do this. Images shouldn&#39;t be saved in the database"}, {"owner": {"reputation": 594, "user_id": 2303808, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/cNIwW.jpg?s=128&g=1", "display_name": "Sandun Priyanka", "link": "https://stackoverflow.com/users/2303808/sandun-priyanka"}, "reply_to_user": {"reputation": 47988, "user_id": 267540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2v58W.jpg?s=128&g=1", "display_name": "e4c5", "link": "https://stackoverflow.com/users/267540/e4c5"}, "edited": false, "score": 0, "creation_date": 1470042334, "post_id": 38694668, "comment_id": 64768418, "body": "@e4c5 why shouldn&#39;t? In my case images are thumbnails and doesn&#39;t expect much of space."}, {"owner": {"reputation": 1030, "user_id": 1108547, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0316db582650c52c8aa85bdf621ae216?s=128&d=identicon&r=PG", "display_name": "Alexander W", "link": "https://stackoverflow.com/users/1108547/alexander-w"}, "edited": false, "score": 1, "creation_date": 1470047734, "post_id": 38694668, "comment_id": 64771589, "body": "By saving images in the database (especially relation databases, like MySQL) you will eventually clog the pipeline with data that could reside elsewhere. It&#39;s probably faster to upload the image to disk and then access it from there."}, {"owner": {"reputation": 552, "user_id": 3650955, "user_type": "registered", "profile_image": "https://graph.facebook.com/1508486486/picture?type=large", "display_name": "ufukomer", "link": "https://stackoverflow.com/users/3650955/ufukomer"}, "edited": false, "score": 0, "creation_date": 1553119722, "post_id": 38694668, "comment_id": 97272971, "body": "You could save it into db. There are pros and cons. <a href=\"https://stackoverflow.com/a/6472268/3650955\">stackoverflow.com/a/6472268/3650955</a>"}], "answers": [{"tags": [], "owner": {"reputation": 179, "user_id": 12698841, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mnLhX.png?s=128&g=1", "display_name": "0example.com", "link": "https://stackoverflow.com/users/12698841/0example-com"}, "is_accepted": true, "score": 0, "last_activity_date": 1612871337, "creation_date": 1612871337, "answer_id": 66118409, "question_id": 38694668, "link": "https://stackoverflow.com/questions/38694668/how-to-store-and-retrive-image-data-in-mysql-database-in-golang/66118409#66118409", "title": "How to store and retrive image data in MySQL database in Golang", "body": "<p>converting image to a blob and save it in the database is a somewhat long process and it may cause issues sometimes. The easiest way is saving the image to a server (or a local directory) and saving the image path in the database. In that way we can access the image by using the image path in the database. This, will show how to save image path and access it and converting image to a blob and save it in the database.</p>\n<p><a href=\"https://github.com/jayampathi-bac/ImageUploadApp/blob/main/main.go\" rel=\"nofollow noreferrer\">Here</a></p>\n"}], "owner": {"reputation": 594, "user_id": 2303808, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/cNIwW.jpg?s=128&g=1", "display_name": "Sandun Priyanka", "link": "https://stackoverflow.com/users/2303808/sandun-priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1693, "favorite_count": 0, "accepted_answer_id": 66118409, "answer_count": 1, "score": 3, "last_activity_date": 1612871337, "creation_date": 1470041707, "last_edit_date": 1470042087, "question_id": 38694668, "link": "https://stackoverflow.com/questions/38694668/how-to-store-and-retrive-image-data-in-mysql-database-in-golang", "title": "How to store and retrive image data in MySQL database in Golang", "body": "<p>How can I insert an image data in MySQL Database and then retrieve it using Golang?</p>\n\n<p>Basically I want that task for upload profile picture of user in web application.\nAccording to the my knowledge,the best solution is save image as blob object in database.Is it best solution for upload image in webapplication in golang.? </p>\n\n<p>Please help me find the best solution for that.I want to find the solution in golang.I am beginner for golang programming.</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 0, "creation_date": 1534111562, "post_id": 38693358, "comment_id": 90581268, "body": "Without seeing what your browser sees, it would be difficult to tell you what is really happening. We would need to see the HTTP header you see in Firebug or similar tool."}], "answers": [{"tags": [], "owner": {"reputation": 512, "user_id": 3782382, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0e0f24876474e579ce70cbbdd45e9571?s=128&d=identicon&r=PG&f=1", "display_name": "asyndrige", "link": "https://stackoverflow.com/users/3782382/asyndrige"}, "is_accepted": false, "score": 0, "last_activity_date": 1470041131, "creation_date": 1470041131, "answer_id": 38694491, "question_id": 38693358, "link": "https://stackoverflow.com/questions/38693358/file-is-cached-by-browser-even-if-the-response-has-no-cache-header/38694491#38694491", "title": "File is cached by browser even if the response has no-cache header", "body": "<p>Some browsers cache files without paying attention to headers. Typical solution is to add some get parameter to static file path, so the browser considered it like different request. It can be hash-sum or last modified timestamp. It might look somethind like this: <code>site.com/icon.png?q=123456</code>.</p>\n"}], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534111502, "creation_date": 1470037226, "last_edit_date": 1534111502, "question_id": 38693358, "link": "https://stackoverflow.com/questions/38693358/file-is-cached-by-browser-even-if-the-response-has-no-cache-header", "title": "File is cached by browser even if the response has no-cache header", "body": "<pre><code>var epoch = time.Unix(0, 0).Format(time.RFC1123)\nvar headers = map[string]string{\n    \"Expires\":         epoch,\n    \"Cache-Control\":   \"no-cache, private, max-age=0\",\n    \"Pragma\":          \"no-cache\",\n    \"X-Accel-Expires\": \"0\",\n}\n\nlog.Errorln(\"no cache header\")\nfor k, v := range headers {\n    rw.Header().Set(k, v)\n}\n\nhttp.ServeFile(rw, req, path)\n</code></pre>\n\n<p>I have the above code block in my server side to serve file requests. But the files served are still cached in browser.</p>\n\n<p>But instead of <code>http.ServeFile()</code> I used <code>http.ServeContent()</code> with the last modified timestamp as <code>time.Now()</code>. This works if the request has considerable time difference. Does browser give priority to last modified time than <code>no-cache</code> header? Then what is the purpose of <code>no-cache</code> header? Am I doing anything wrong?</p>\n"}, {"tags": ["arrays", "for-loop", "go", "append", "slice"], "comments": [{"owner": {"reputation": 4419, "user_id": 1592572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3PZJ.png?s=128&g=1", "display_name": "Victor H&#228;ggqvist", "link": "https://stackoverflow.com/users/1592572/victor-h%c3%a4ggqvist"}, "edited": false, "score": 0, "creation_date": 1513071119, "post_id": 38692998, "comment_id": 82499499, "body": "Playground of this at <a href=\"https://play.golang.org/p/nftYWXrflD\" rel=\"nofollow noreferrer\">play.golang.org/p/nftYWXrflD</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 1, "last_activity_date": 1470036370, "creation_date": 1470036370, "answer_id": 38693146, "question_id": 38692998, "link": "https://stackoverflow.com/questions/38692998/strange-golang-append-behavior-overwriting-values-in-slice/38693146#38693146", "title": "Strange golang &quot;append&quot; behavior (overwriting values in slice)", "body": "<p>Because you are appending the slice using as a pointer reference actually you are not creating new entries in the slice but updating every time the last entry. Changing the code from pointer reference to normal value reference it will work.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Foo struct {\n    val int\n}\n\nfunc main() {\n    var a = make([]Foo, 1)\n    a[0] = Foo{0}\n\n    var b = [3]Foo{Foo{1}, Foo{2}, Foo{3}}\n    for _, e := range b {\n        a = append(a, e)\n    }\n\n    for i, e := range a {\n        fmt.Printf(\"%d: %v\\n\", i, e)\n    }\n}\n</code></pre>\n\n<p>Working code on <a href=\"https://play.golang.org/p/dop73cEHCM\" rel=\"nofollow\">Go playground</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 575, "user_id": 550324, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5450829d6fe4fdd97aa2f73fd6ae7b74?s=128&d=identicon&r=PG", "display_name": "Chao Sun", "link": "https://stackoverflow.com/users/550324/chao-sun"}, "edited": false, "score": 1, "creation_date": 1470037844, "post_id": 38693163, "comment_id": 64765794, "body": "Thanks for the explanation! this behavior is very confusing though. Not sure why they design it like this..."}, {"owner": {"reputation": 3738, "user_id": 5509839, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/dgxf7.jpg?s=128&g=1", "display_name": "aroooo", "link": "https://stackoverflow.com/users/5509839/aroooo"}, "edited": false, "score": 0, "creation_date": 1544129875, "post_id": 38693163, "comment_id": 94177398, "body": "The reasoning makes sense, it&#39;s definitely confusing to a go newcomer. I spent a long time trying to figure out what was wrong, I thought it might be a race condition and it took me a while to even find this answer because I wasn&#39;t sure what I was even looking for."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1528882629, "last_edit_date": 1592644375, "creation_date": 1470036449, "answer_id": 38693163, "question_id": 38692998, "link": "https://stackoverflow.com/questions/38692998/strange-golang-append-behavior-overwriting-values-in-slice/38693163#38693163", "title": "Strange golang &quot;append&quot; behavior (overwriting values in slice)", "body": "<p>This is because in the <code>for</code> loop you operate with a <em>copy</em> and not with the slice/array element itself.</p>\n<p>The <code>for ... range</code> makes a copy of the elements it loops over, and you append the address of this temporary, loop variable - which is the same in all iterations. So you add the same pointer 3 times. And this temporary variable will be set to <code>Foo{3}</code> in the last iteration (last element of the array), so that's why you see that printed 3 times.</p>\n<p>Fix: do not add the address of the loop variable, but the address of the array element:</p>\n<pre><code>for i := range b {\n    a = append(a, &amp;b[i])\n}\n</code></pre>\n<p>Output (try it on the <a href=\"https://play.golang.org/p/7A3H9-gcIy\" rel=\"noreferrer\">Go Playground</a>):</p>\n<pre><code>{0} {1} {2} {3} \n</code></pre>\n<p>See possible duplicate <a href=\"https://stackoverflow.com/questions/34760950/assigned-pointer-field-becomes-nil\">Assigned pointer field becomes &lt;nil&gt;</a>.</p>\n<h3>Reasoning for this behavior</h3>\n<p>In Go there are <em>pointer</em> types and <em>non-pointer</em> types, but no <a href=\"https://en.wikipedia.org/wiki/Reference_type\" rel=\"noreferrer\">&quot;references&quot;</a> (in the meaning it is used in C++ and Java). Given the fact that there are no &quot;reference&quot; types in Go, this is not an unexpected behavior. The loop variable is just an &quot;ordinary&quot; local variable, it can only hold a value (which may be a pointer or non-pointer), but not a reference.</p>\n<p>Excerpt from <a href=\"https://stackoverflow.com/a/35426997/1705598\">this answer</a>:</p>\n<blockquote>\n<p>Pointers are values just like let's say <code>int</code> numbers. The difference is the interpretation of that value: pointers are interpreted as memory addresses, and <code>int</code>s are interpreted as integer numbers.</p>\n<p>When you want to change the value of a variable of type <code>int</code>, you pass a pointer to that <code>int</code> which is of type <code>*int</code>, and you modify the pointed object: <code>*i = newvalue</code> (the value assigned is an <code>int</code>).</p>\n<p>Same goes with pointers: when you want to change the value of a variable of pointer type <code>*int</code>, you pass a pointer to that <code>*int</code> which is of type <code>**int</code> and you modify the pointed object: <code>*i = &amp;newvalue</code> (the value assigned is an <code>*int</code>).</p>\n</blockquote>\n<p>All in all, the loop variable is just a normal variable having the element type of the array/slice you're looping over, and for it to have the value of the actual iteration, the value must be assigned to it which copies the value. It is overwritten in the next iteration.</p>\n"}, {"tags": [], "owner": {"reputation": 2913, "user_id": 4245294, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-ZTD9u96FrKU/AAAAAAAAAAI/AAAAAAAAAF0/uXngR7Vqjwg/photo.jpg?sz=128", "display_name": "Sam Malayek", "link": "https://stackoverflow.com/users/4245294/sam-malayek"}, "is_accepted": false, "score": 0, "last_activity_date": 1573769626, "creation_date": 1573769626, "answer_id": 58867315, "question_id": 38692998, "link": "https://stackoverflow.com/questions/38692998/strange-golang-append-behavior-overwriting-values-in-slice/58867315#58867315", "title": "Strange golang &quot;append&quot; behavior (overwriting values in slice)", "body": "<p>On each iteration of your loop, the value of <code>e</code> changes, yet each time you're passing a pointer to <code>e</code> into the slice. So you end up with a slice containing 3 pointers to the same value.</p>\n\n<p>You can also make a copy of the value and pass its pointer. Since on each iteration, you're making a new copy of the value, the pointers passed to the slice will point to different values:</p>\n\n<pre><code>var a = make([]*Foo, 1)\na[0] = &amp;Foo{0}\n\nvar b = [3]Foo{Foo{1}, Foo{2}, Foo{3}}\nfor _, e := range b {\n    eCopy := e\n    a = append(a, &amp;eCopy)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/VKLvNePU9af\" rel=\"nofollow noreferrer\">https://play.golang.org/p/VKLvNePU9af</a></p>\n"}], "owner": {"reputation": 575, "user_id": 550324, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5450829d6fe4fdd97aa2f73fd6ae7b74?s=128&d=identicon&r=PG", "display_name": "Chao Sun", "link": "https://stackoverflow.com/users/550324/chao-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2757, "favorite_count": 4, "accepted_answer_id": 38693163, "answer_count": 3, "score": 14, "last_activity_date": 1573769909, "creation_date": 1470035864, "last_edit_date": 1573769909, "question_id": 38692998, "link": "https://stackoverflow.com/questions/38692998/strange-golang-append-behavior-overwriting-values-in-slice", "title": "Strange golang &quot;append&quot; behavior (overwriting values in slice)", "body": "<p>I have this simple code:</p>\n\n<pre><code>import \"fmt\"\n\ntype Foo struct {\n    val int\n}\n\nfunc main() {\n    var a = make([]*Foo, 1)\n    a[0] = &amp;Foo{0}\n\n    var b = [3]Foo{Foo{1}, Foo{2}, Foo{3}}\n    for _, e := range b {\n        a = append(a, &amp;e)\n    }\n\n    for _, e := range a {\n        fmt.Printf(\"%v \", *e)\n    }\n}\n</code></pre>\n\n<p>I was expecting it to print <code>{0} {1} {2} {3}</code>, however it prints <code>{0} {3} {3} {3}</code>. What happened here?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "edited": false, "score": 0, "creation_date": 1470036669, "post_id": 38692387, "comment_id": 64765195, "body": "Thank you! I realized my mistake as soon as I saw the brackets you added around the element inside the array."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1470034544, "last_edit_date": 1470034544, "creation_date": 1470033440, "answer_id": 38692387, "question_id": 38692303, "link": "https://stackoverflow.com/questions/38692303/runtime-error-while-parsing-a-json-byte-stream-with-an-embedded-array/38692387#38692387", "title": "Runtime error while parsing a JSON byte stream with an embedded array", "body": "<p>Because your JSON input is not what you model in Go. And so the JSON array will not be unmarshaled into <code>jsonobject.Objects</code>: it will remain <code>nil</code>; so attempting to index it will result in <code>index out of range</code> error.</p>\n\n<p>Try to unmarshal from this:</p>\n\n<pre><code>bytes = []byte(`{ \"objects\": [ {\"name\": \"foo\"} ] }`)\n</code></pre>\n\n<p>Note that the elements (one element in this case) in the JSON array are also in braces (JSON object).</p>\n\n<p>Try it on the <kbd><a href=\"https://play.golang.org/p/vLU2582qJE\" rel=\"nofollow\">Go Playground</a></kbd>.</p>\n"}], "owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 38692387, "answer_count": 1, "score": 1, "last_activity_date": 1470034544, "creation_date": 1470033160, "question_id": 38692303, "link": "https://stackoverflow.com/questions/38692303/runtime-error-while-parsing-a-json-byte-stream-with-an-embedded-array", "title": "Runtime error while parsing a JSON byte stream with an embedded array", "body": "<p>I am able to parse a simple JSON object into a struct, but when I try to parse an array inside that object, I am getting an <code>index out of range</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype jsonobject struct {\n    Objects []ObjectType `json:\"objects\"`\n}\n\ntype ObjectType struct {\n    Name string `json:\"name\"`\n}\n\nfunc main() {\n\n    // Simple element\n    bytes := []byte(`{ \"name\": \"foo\" }`)\n    var objecttype ObjectType\n    json.Unmarshal(bytes, &amp;objecttype)\n    fmt.Printf(\"Results: %v\\n\", objecttype.Name) // Results: localhost\n\n    // Object with embedded array\n    bytes = []byte(`{ \"objects\": [ \"name\": \"foo\" ] }`)\n    jsontype := &amp;jsonobject{}\n    json.Unmarshal(bytes, &amp;jsontype)\n    fmt.Printf(\"Results: %v\\n\", jsontype.Objects[0].Name) // panic: runtime error: index out of range\n}\n</code></pre>\n"}, {"tags": ["file", "go", "character"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1470069634, "post_id": 38692956, "comment_id": 64785623, "body": "thanks alot .. :D @Amd, i forgot to mention i have to verify for special characters also..I&#39;m working on it. Anyways thanks again"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 1, "last_activity_date": 1471204172, "last_edit_date": 1471204172, "creation_date": 1470035734, "answer_id": 38692956, "question_id": 38691789, "link": "https://stackoverflow.com/questions/38691789/reading-specific-characters-from-file-in-golang/38692956#38692956", "title": "Reading specific characters from file in Golang", "body": "<p>You need to edit the inner loop to check for every input line,<br>\nand find the number  then comma and so, like this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc readLines(path string) ([]string, error) {\n    file, err := os.Open(path)\n    if err != nil {\n        return nil, err\n    }\n    defer file.Close()\n    var lines []string\n    scanner := bufio.NewScanner(file)\n    for scanner.Scan() {\n        lines = append(lines, scanner.Text())\n    }\n    return lines, scanner.Err()\n}\nfunc checkOne(letter byte, number, i, j int) {\n    if letter &gt; 'H' {\n        fmt.Printf(\"invalid input %q @ (%d, %d) \\n\", letter, i, j)\n    }\n    if number &gt; 8 {\n        fmt.Printf(\"invalid input number %d @ (%d, %d) \\n\", number, i, j+1)\n\n    }\n}\nfunc main() {\n    lines, err := readLines(\"chessin.txt\")\n    if err != nil {\n        log.Fatalf(\"readLines: %s\", err)\n    }\n    var numLines int = len(lines)\n    for i := 0; i &lt; numLines; i++ {\n        line := lines[i]\n        j := 0\n        comma := strings.IndexByte(line, ',')\n        if comma == -1 {\n            log.Fatalf(\"comma not found at line: %d\", i)\n        }\n        number, err := strconv.Atoi(line[j+1 : comma])\n        if err != nil {\n            log.Fatalf(\"line:%d err: %s\", i, err)\n        }\n        checkOne(line[j], number, i, j)\n\n        j = comma + 1\n        number, err = strconv.Atoi(line[j+1:])\n        if err != nil {\n            log.Fatalf(\"line:%d err: %s\", i, err)\n        }\n        checkOne(line[j], number, i, j)\n    }\n}\n</code></pre>\n\n<p>input file \"chessin.txt\":</p>\n\n<pre><code>I9,A2\nA10,C3\nD2,L3\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>invalid input 'I' @ (0, 0) \ninvalid input number 9 @ (0, 1) \ninvalid input number 10 @ (1, 1) \ninvalid input 'L' @ (2, 3) \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 6622850, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154485428494180/picture?type=large", "display_name": "FenixAra", "link": "https://stackoverflow.com/users/6622850/fenixara"}, "is_accepted": false, "score": -1, "last_activity_date": 1471204133, "last_edit_date": 1471204133, "creation_date": 1470069795, "answer_id": 38704002, "question_id": 38691789, "link": "https://stackoverflow.com/questions/38691789/reading-specific-characters-from-file-in-golang/38704002#38704002", "title": "Reading specific characters from file in Golang", "body": "<p>You can simplify by using string split and slice. Do not read and store all the values in an array and then loop through them again. Assuming the first character is always Caps and there will be no negative values. Working sample code is as follows:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    file, err := os.Open(\"chessin.txt\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer file.Close()\n    scanner := bufio.NewScanner(file)\n    valid := []bool{}\n    for scanner.Scan() {\n        strs := strings.Split(scanner.Text(), \",\")\n        valid = append(valid, validateStrings(strs))\n    }\n    fmt.Println(valid)\n}\n\nfunc validateStrings(strs []string) bool {\n    for _, str := range strs {\n        char := str[0]\n        num, err := strconv.Atoi(string(str[1:len(str)]))\n        if err != nil {\n            fmt.Println(\"Invalid input\")\n            os.Exit(1)\n        }\n        if char &lt; 'A' || char &gt; 'H' || num &gt; 8 || num &lt; 0 {\n            return false\n        }\n    }\n    return true\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1182, "favorite_count": 0, "accepted_answer_id": 38692956, "answer_count": 2, "score": 0, "last_activity_date": 1471204172, "creation_date": 1470030605, "last_edit_date": 1470745923, "question_id": 38691789, "link": "https://stackoverflow.com/questions/38691789/reading-specific-characters-from-file-in-golang", "title": "Reading specific characters from file in Golang", "body": "<p>I want to read a text  file character by character and print invalid input for those characters that exceed \"H\"and numbers that exceed \"8\".\n eg: my input is </p>\n\n<pre><code>I9,A2\nA10,C3\nD2,L3\n</code></pre>\n\n<p>output:\ninvalid input for all three</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n)\n\nfunc readLines(path string) ([]string, error) {\n    file, err := os.Open(path)\n    if err != nil {\n        return nil, err\n    }\n    defer file.Close()\n    var lines []string\n    scanner := bufio.NewScanner(file)\n    for scanner.Scan() {\n        lines = append(lines, scanner.Text())\n    }\n    return lines, scanner.Err()\n}\n\nfunc main() {\n    lines, err := readLines(\"chessin.txt\")\n    if err != nil {\n        log.Fatalf(\"readLines: %s\", err)\n    }\n    var numLines int = len(lines)\n    for i := 0; i &lt; numLines; i++ {\n        for j := 0; j &lt; len(lines[i]); j++ {\n            if j &gt; 'H' {\n                fmt.Printf(\"invalid input\")\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1470031077, "post_id": 38691772, "comment_id": 64762643, "body": "This is pretty much the standard way to do it, yes, are you having any specific problems with it?"}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1470031928, "post_id": 38691772, "comment_id": 64762914, "body": "Is it allowed to press &quot;start&quot; button multiple times, ie there might be more than one goroutine running?"}, {"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1470031989, "post_id": 38691772, "comment_id": 64762942, "body": "@ain No there won&#39;t be multiple goroutines..."}, {"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "reply_to_user": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1470032123, "post_id": 38691772, "comment_id": 64762994, "body": "@Jsor The stop is not working. Even after the stop button is pressed the loop is continuing.."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470071134, "post_id": 38691772, "comment_id": 64786427, "body": "Unrelated, it&#39;s just as easy to close quit (<code>close(quit)</code>) in your &quot;stop&quot; case as it is to send a message over it, and close won&#39;t block (though it <i>will</i> panic if you try to do it more than once).  I typically use close because it can terminate more than one listening routine in a single operation, instead of having to send a message to each of them."}], "answers": [{"comments": [{"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 0, "creation_date": 1470032316, "post_id": 38691901, "comment_id": 64763076, "body": "Can you please explain the comment <b>defined out of you command receivers loop/callback</b> ? I tested your code but stop is not working. May be I defined channel wrong again."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 0, "creation_date": 1470032986, "post_id": 38691901, "comment_id": 64763348, "body": "Edited above. Note that it&#39;s still an example. For above example to work properky, <code>c.GetString(&quot;command&quot;)</code> needs to act like a channel, as mentioned above."}, {"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 0, "creation_date": 1470035034, "post_id": 38691901, "comment_id": 64764275, "body": "Can&#39;t we break from the loop? I think in this code, the switch control is transferred to case &quot;stop&quot; from case &quot;start&quot;, loop is still running."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 0, "creation_date": 1470036778, "post_id": 38691901, "comment_id": 64765248, "body": "How have you defined <code>c.GetString</code>? And the type <code>c</code>?"}, {"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 0, "creation_date": 1470048060, "post_id": 38691901, "comment_id": 64771776, "body": "type c is the controller receiver and c.GetString is beego function."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1470071551, "post_id": 38691901, "comment_id": 64786664, "body": "If you&#39;re going to close <code>quit</code>, you don&#39;t actually need to send on it.   However, you also don&#39;t really want to set it to nil there, as the goroutine still needs to read the quit value from it (more critical if you use close, since it&#39;s async even on an unbuffered channel).  Better to set it to nil before the return inside the goroutine quit case."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 1, "last_activity_date": 1470032954, "last_edit_date": 1470032954, "creation_date": 1470031281, "answer_id": 38691901, "question_id": 38691772, "link": "https://stackoverflow.com/questions/38691772/how-to-stop-goroutine-from-client/38691901#38691901", "title": "How to stop goroutine from client?", "body": "<p>You are already right about the design. An issue is that you are creating new channels each time you recieve a command. Which means there is no way to communicate with the previously started goroutine. You need to have a <code>quit</code> channel that stays in scope for between requests. Try something like below (untested):</p>\n\n<pre><code>func listenForCommand() {\n    var quit chan bool\n\n    for {\n        // command receiver, should fire for each command received\n        command := c.GetString(\"command\")\n\n        switch command {\n        case \"start\":\n            if quit != nil {\n                continue\n            }\n            quit = make(chan bool)\n            go func() {\n                i := 0\n                for {\n                    select {\n                    case &lt;-quit:\n                        return\n                    default:\n                        fmt.Println(\"i: \", i)\n                        i++\n                        time.Sleep(3000 * time.Millisecond)\n                    }\n                }\n            }()\n        case \"stop\":\n            if quit == nil {\n                continue\n            }\n            quit &lt;- true\n            close(quit)\n            quit = nil\n        }\n    }\n}\n</code></pre>\n\n<p>You can now call <code>listenForCommand()</code> to start listening for commands. This example presumes that there is another process populating <code>c</code> so <code>c.GetString(\"command\")</code> returns a command if available, or blocks and waits for a command to arrive.</p>\n"}], "owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 38691901, "answer_count": 1, "score": 1, "last_activity_date": 1470032954, "creation_date": 1470030504, "question_id": 38691772, "link": "https://stackoverflow.com/questions/38691772/how-to-stop-goroutine-from-client", "title": "How to stop goroutine from client?", "body": "<p>I need to create a html page which has two buttons, one will start a goroutine, which has an infinite loop, and other button need to break the infinite loop. As from my readings I understood that a goroutine can't be killed from outside it. Is there anyway to implement this? My code is as follows:</p>\n\n<pre><code>command := c.GetString(\"command\") // from client to determine which button is clicked\nquit := make(chan bool)\nswitch command {\n    case \"start\":    // Button to start goroutine\n        go func() {\n            i := 0\n            for {\n                select {\n                    case &lt;- quit:\n                        return\n                     default:\n                         fmt.Println(\"i: \", i)\n                         i++\n                         time.Sleep(3000 * time.Millisecond)\n                 }\n             }\n         }()\n     case \"stop\":    // Button to stop goroutine\n         quit &lt;- true\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1470029792, "creation_date": 1470029792, "answer_id": 38691651, "question_id": 38691587, "link": "https://stackoverflow.com/questions/38691587/methods-with-a-pointer-receiver/38691651#38691651", "title": "Methods with a Pointer Receiver", "body": "<p>Taking the address of a composite literal is a special case in the language. This syntax generates a pointer to a unique variable initialized with the literal`s value. The composite literal itself is not addressable.</p>\n\n<p>You can use this syntax to call the method:</p>\n\n<pre><code>(&amp;Point{1, 2}).ScaleBy(2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 0, "last_activity_date": 1470029999, "creation_date": 1470029999, "answer_id": 38691688, "question_id": 38691587, "link": "https://stackoverflow.com/questions/38691587/methods-with-a-pointer-receiver/38691688#38691688", "title": "Methods with a Pointer Receiver", "body": "<p>When you write <code>Point{1,2}</code> you simply declaring and initializing a <em>value</em> of type <code>Point</code>. If you don't assign it to a variable, it is discarded.</p>\n\n<p>Go disallows this behavior of calling a pointer method on a simple value since a pointer method states an intent of object (pointed to by the pointer) modification. A pointer method called with a value would be useless in most of the cases since a value is passed by copy to the method. Any modifications made to the value will be done to that copied value and no actual modification would occur.</p>\n\n<p>If you tried this, it would work:</p>\n\n<pre><code>type Point struct {\n    x, y int\n}\n\nfunc (p Point) X() {\n    fmt.Println(p.x)\n}\n\nPoint{1, 2}.X() // 1\n</code></pre>\n\n<p>You can read more about it here: <a href=\"https://golang.org/doc/effective_go.html#pointers_vs_values\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#pointers_vs_values</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1470745316, "last_edit_date": 1470745316, "creation_date": 1470057114, "answer_id": 38699855, "question_id": 38691587, "link": "https://stackoverflow.com/questions/38691587/methods-with-a-pointer-receiver/38699855#38699855", "title": "Methods with a Pointer Receiver", "body": "<p>By using <code>Point{1, 2}.ScaleBy(2)</code> you  are trying to call pointer receiver method <code>ScaleBy</code> with value: <code>Point{1, 2}</code>:  </p>\n\n<blockquote>\n  <p>The method set of any other type T consists of all methods declared\n  with receiver type T.</p>\n</blockquote>\n\n<p>but if you use addressable type:  </p>\n\n<blockquote>\n  <p>The method set of the corresponding pointer type *T is the set of all\n  methods declared with receiver *T or T (that is, it also contains the\n  method set of T).</p>\n</blockquote>\n\n<p>then it is possible: meaning you or the compiler should get the address of  temporary value (Taking the address of a composite literal):  </p>\n\n<blockquote>\n  <p>Address operators:<br>\n  For an operand x of type T, the address operation &amp;x generates a\n  pointer of type *T to x. The operand must be addressable, <strong>that is,\n  either a variable, pointer indirection, or slice indexing operation;\n  or a field selector of an addressable struct operand; or an array\n  indexing operation of an addressable array. As an exception to the\n  addressability requirement, x may also be a (possibly parenthesized)\n  composite literal.</strong> If the evaluation of x would cause a run-time\n  panic, then the evaluation of &amp;x does too.  </p>\n</blockquote>\n\n<p>ref:  <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow\">https://golang.org/ref/spec#Address_operators</a>    </p>\n\n<p>You may call <code>(&amp;Point{1, 2}).ScaleBy(2)</code><br>\nlike this working sample code (pointer receiver):  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    p := (&amp;Point{1, 2}).ScaleBy(2)\n    fmt.Println(p) // &amp;{2 4}\n}\n\ntype Point struct {\n    X, Y int\n}\n\nfunc (p *Point) ScaleBy(factor float64) *Point {\n    p.X *= 2\n    p.Y *= 2\n    return p\n}\n</code></pre>\n\n<p>you may call <code>Point{1, 2}.ScaleBy(2)</code><br>\nlike this working sample code (value receiver):  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    p := Point{1, 2}.ScaleBy(2)\n    fmt.Println(p) // &amp;{2 4}\n}\n\ntype Point struct {\n    X, Y int\n}\n\nfunc (p Point) ScaleBy(factor float64) *Point {\n    p.X *= 2\n    p.Y *= 2\n    return &amp;p\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>&amp;{2 4}\n</code></pre>\n\n<p>also see this working sample code (pointer receiver):  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    p := Point{1, 2}\n    p.ScaleBy(2)\n\n    fmt.Println(p) //  {2 4}\n}\n\ntype Point struct {\n    X, Y int\n}\n\nfunc (p *Point) ScaleBy(factor float64) {\n    p.X *= 2\n    p.Y *= 2\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>{2 4}\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5254013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-xhJMq-eduHc/AAAAAAAAAAI/AAAAAAAAIhI/_3XFJFSZ1aw/photo.jpg?sz=128", "display_name": "Jay Chung", "link": "https://stackoverflow.com/users/5254013/jay-chung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1470745316, "creation_date": 1470029366, "last_edit_date": 1470058511, "question_id": 38691587, "link": "https://stackoverflow.com/questions/38691587/methods-with-a-pointer-receiver", "title": "Methods with a Pointer Receiver", "body": "<p>I am newbie in computer science.I just read the code snippet below from <em>The Go programming language</em> and got the following error log.</p>\n\n<pre><code>func (p *Point) ScaleBy(factor float64){\n  p.X *= 2\n  p.Y *= 2\n}\n\nPoint{1, 2}.ScaleBy(2)\n# error log\ncannot call pointer method on point literal\ncannot take the address of point literal\npoint literal.scaleby(2) used as value\n</code></pre>\n\n<p>The book explained that we can not call a <code>*Point</code> method on a non-addressable Point receiver, because there's no way to obtain address of a temporary value.</p>\n\n<p>However, if I print <code>&amp;Point{1, 2}</code>, this would not throw error. Accordingly, why <code>Point{1,2}</code> is a non-addressable Point receiver?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "edited": false, "score": 0, "creation_date": 1470031199, "post_id": 38691045, "comment_id": 64762684, "body": "Thanks a lot ! That was what i needed."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 3, "last_activity_date": 1470026877, "last_edit_date": 1470026877, "creation_date": 1470025725, "answer_id": 38691045, "question_id": 38690949, "link": "https://stackoverflow.com/questions/38690949/convert-int-array-to-char-array-using-golang/38691045#38691045", "title": "Convert int array to char array using Golang?", "body": "<p><code>strconv.Itoa</code> is shorthand for <code>FormatInt(int64(i), 10)</code>:</p>\n\n<blockquote>\n  <p>FormatInt returns the string representation of i in the given base,\n  for 2 &lt;= base &lt;= 36. The result uses the lower-case letters 'a' to 'z'\n  for digit values >= 10.</p>\n</blockquote>\n\n<p>so the result of <code>strconv.Itoa(i+64)</code> is string, and the <code>board</code> is not (this is the error).  </p>\n\n<p>I think you are trying to do something like this working sample code (let me know if not):  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    board := [8][8]string{}\n    for i := 0; i &lt; 8; i++ { // initialize  array\n        for j := 0; j &lt; 8; j++ {\n            board[i][j] = string(i+65) + string(j+49) // int to char\n            fmt.Printf(\"%s \", board[i][j])\n        }\n        fmt.Println()\n    }\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>A1 A2 A3 A4 A5 A6 A7 A8 \nB1 B2 B3 B4 B5 B6 B7 B8 \nC1 C2 C3 C4 C5 C6 C7 C8 \nD1 D2 D3 D4 D5 D6 D7 D8 \nE1 E2 E3 E4 E5 E6 E7 E8 \nF1 F2 F3 F4 F5 F6 F7 F8 \nG1 G2 G3 G4 G5 G6 G7 G8 \nH1 H2 H3 H4 H5 H6 H7 H8\n</code></pre>\n\n<p>if my guess is fine, you may do it this way too:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    board := [8][8]string{\n        {\"A1\", \"A2\", \"A3\", \"A4\", \"A5\", \"A6\", \"A7\", \"A8\"},\n        {\"B1\", \"B2\", \"B3\", \"B4\", \"B5\", \"B6\", \"B7\", \"B8\"},\n        {\"C1\", \"C2\", \"C3\", \"C4\", \"C5\", \"C6\", \"C7\", \"C8\"},\n        {\"D1\", \"D2\", \"D3\", \"D4\", \"D5\", \"D6\", \"D7\", \"D8\"},\n        {\"E1\", \"E2\", \"E3\", \"E4\", \"E5\", \"E6\", \"E7\", \"E8\"},\n        {\"F1\", \"F2\", \"F3\", \"F4\", \"F5\", \"F6\", \"F7\", \"F8\"},\n        {\"G1\", \"G2\", \"G3\", \"G4\", \"G5\", \"G6\", \"G7\", \"G8\"},\n        {\"H1\", \"H2\", \"H3\", \"H4\", \"H5\", \"H6\", \"H7\", \"H8\"},\n    }\n\n    // print the board:\n    for i := 0; i &lt; 8; i++ {\n        fmt.Println(board[i])\n    }\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>[A1 A2 A3 A4 A5 A6 A7 A8]\n[B1 B2 B3 B4 B5 B6 B7 B8]\n[C1 C2 C3 C4 C5 C6 C7 C8]\n[D1 D2 D3 D4 D5 D6 D7 D8]\n[E1 E2 E3 E4 E5 E6 E7 E8]\n[F1 F2 F3 F4 F5 F6 F7 F8]\n[G1 G2 G3 G4 G5 G6 G7 G8]\n[H1 H2 H3 H4 H5 H6 H7 H8]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 0, "last_activity_date": 1470025984, "last_edit_date": 1470025984, "creation_date": 1470025883, "answer_id": 38691064, "question_id": 38690949, "link": "https://stackoverflow.com/questions/38690949/convert-int-array-to-char-array-using-golang/38691064#38691064", "title": "Convert int array to char array using Golang?", "body": "<p>First of all, if you want to initialize each board position with a string, you need to change the declaration of your <code>board</code> array:</p>\n\n<pre><code>var board [8][8]string\n</code></pre>\n\n<p>since <code>strconv.Itoa</code> returns a string.</p>\n\n<p>Then, if you simply need to access each board location sequentially, you can simply update your inner loop:</p>\n\n<pre><code>// You don't need to iterate through the array like C using index arithmatic\nfor i := 0; i &lt; 8; i++ { // initialize  array\n        for j := 0; j &lt; 8; j++ {\n            // use whatever logic you are using to init each value\n            board[i][j] = (strconv.Itoa(i+64) + \"\" + strconv.Itoa(j+48)) // int to char\n\n            fmt.Printf(\"%s \\n\", board[i][j])\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2831, "favorite_count": 0, "accepted_answer_id": 38691045, "answer_count": 2, "score": 0, "last_activity_date": 1470746309, "creation_date": 1470025039, "last_edit_date": 1470746309, "question_id": 38690949, "link": "https://stackoverflow.com/questions/38690949/convert-int-array-to-char-array-using-golang", "title": "Convert int array to char array using Golang?", "body": "<p>I have this error : </p>\n\n<pre><code># command-line-arguments\n.\\cheking.go:14: cannot use strconv.Itoa(i + 64) + strconv.Itoa(j + 48) (type st\nring) as type [8]int in assignment\n</code></pre>\n\n<p>code:  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n\n    var board [8][8]int\n\n    for i := 1; i &lt;= 8; i++ { // initialize  array\n        for j := 1; j &lt;= 8; j++ {\n            board[(j-1)+8*(i-1)] = (strconv.Itoa(i+64) + \"\" + strconv.Itoa(j+48)) // int to char\n\n            fmt.Printf(\"%s \\n\", board[i][j])\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "session", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1470028843, "post_id": 38690815, "comment_id": 64761903, "body": "try this: <code>ub, ok = val.(UserBasic)</code> instead of <code>ub, ok = val.(*UserBasic)</code>"}, {"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "edited": false, "score": 0, "creation_date": 1470034496, "post_id": 38690815, "comment_id": 64764010, "body": "I fixed it by removing pointers everywhere. You suggested the same. However I dont understand why &quot;ub&quot; was not get getting a value when &quot;val&quot; has the value. Is there some exception to type assertion?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1470045870, "last_edit_date": 1470045870, "creation_date": 1470044972, "answer_id": 38695779, "question_id": 38690815, "link": "https://stackoverflow.com/questions/38690815/gorilla-session-extracting-structure-value-from-session-golang/38695779#38695779", "title": "Gorilla session extracting structure value from session golang", "body": "<p>If your interface method has pointer receiver you should create it as a pointer, like this:  </p>\n\n<pre><code>var val Worker = &amp;UserBasic{100}\n</code></pre>\n\n<p>and if you use <code>var val Worker = UserBasic{100}</code> you will see this error:  </p>\n\n<pre><code>UserBasic does not implement Worker (Work method has pointer receiver)\n</code></pre>\n\n<p>in this working sample code:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar _ Worker = (*UserBasic)(nil) // Verify that *UserBasic implements Worker.\n\nfunc main() {\n    var val Worker = &amp;UserBasic{100}\n\n    ub, ok := val.(*UserBasic)\n\n    fmt.Println(ub, ok) // &amp;{100} true\n}\n\ntype Worker interface {\n    Work()\n}\n\ntype UserBasic struct {\n    A int\n}\n\nfunc (t *UserBasic) Work() {\n    fmt.Println(\"Work.\")\n}\n</code></pre>\n\n<p>you may check at compile-time if a type implements an interface or not:  </p>\n\n<p>Verify that <code>*UserBasic</code> implements Worker (Compile: Success):  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar _ Worker = (*UserBasic)(nil) // Verify that *UserBasic implements Worker.\n\nfunc main() {\n    fmt.Println(\"Hello World!\")\n}\n\ntype Worker interface {\n    Work()\n}\n\ntype UserBasic struct{}\n\nfunc (t *UserBasic) Work() {\n    fmt.Println(\"Work.\")\n}\n</code></pre>\n\n<p>Verify that <code>UserBasic</code> implements Worker (Compile: Success):  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar _ Worker = UserBasic{} // Verify that UserBasic implements Worker.\n\nfunc main() {\n    fmt.Println(\"Hello World!\")\n}\n\ntype Worker interface {\n    Work()\n}\n\ntype UserBasic struct{}\n\nfunc (t UserBasic) Work() {\n    fmt.Println(\"Work.\")\n}\n</code></pre>\n\n<p>for test sample compile this code  (Compile: error):  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar _ Worker = (*UserBasic)(nil) // Verify that *UserBasic implements Worker.\n\nfunc main() {\n    fmt.Println(\"Hello World!\")\n}\n\ntype Worker interface {\n    Work()\n}\n\ntype UserBasic struct{}\n</code></pre>\n\n<p>it says:  </p>\n\n<pre><code>.\\m.go:5: cannot use (*UserBasic)(nil) (type *UserBasic) as type Worker in assignment:\n    *UserBasic does not implement Worker (missing Work method)\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470745846, "creation_date": 1470023897, "last_edit_date": 1470745846, "question_id": 38690815, "link": "https://stackoverflow.com/questions/38690815/gorilla-session-extracting-structure-value-from-session-golang", "title": "Gorilla session extracting structure value from session golang", "body": "<p>I created a user entry in my gorilla session </p>\n\n<pre><code>session.Values[\"ub\"] = ub\n</code></pre>\n\n<hr>\n\n<p>However when I am extracting, the extracted interface is getting the value but when I am type-asserting the data into my user structure it is showing null. </p>\n\n<p>I am not getting the reason behind this, as when I am running the same code with other structures, it is working fine. What could be the reason and how to fix this. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>val := session.Values[\"ub\"]\n    var ub = &amp;UserBasic{}\n    var ok bool\n\n    if val != \"\" {\n        //type assertion\n        //var userBasic = &amp;auth.UserBasic{}\n        ub, ok = val.(*UserBasic)\n        if !ok {\n            // Handle the case that it's not an expected type\n            log.Infof(ctx, \"GetUserGSession:  UserBasic structure value %+v\", ub)\n            log.Infof(ctx, \"GetUserGSession:  Value got from session %+v\", val)\n            log.Infof(ctx, \"GetUserGSession:  reasserting  %+v\", val.(UserBasic))\n        }\n        return ub\n    } else {\n        ub := new(UserBasic)\n        return ub\n    }\n</code></pre>\n\n<p>*********Outcome************</p>\n\n<pre><code>2016/08/01 03:49:12 INFO: GetUserGSession:  UserBasic structure value &lt;nil&gt;\n2016/08/01 03:49:12 INFO: GetUserGSession:  Value got from session {UserID:589578337 UserName:ds Name:ds createdAt:{sec:0 nsec:0 loc:&lt;nil&gt;} defaultProfileImage:false description: FavouritesCount:5 FollowersCount:0 FriendsCount:0 TotalTweets:6 ListedCount:0 Location: ProfileBgColor: ProfileBgImgURL: ProfileImgURL: IsLoggedIn:true TimeZone:}\n2016/08/01 03:49:12 INFO: GetUserGSession:  reasserting  {UserID:589578337 UserName:ds Name:ds createdAt:{sec:0 nsec:0 loc:&lt;nil&gt;} defaultProfileImage:false description: FavouritesCount:5 FollowersCount:0 FriendsCount:0 TotalTweets:6 ListedCount:0 Location: ProfileBgColor: ProfileBgImgURL: ProfileImgURL: IsLoggedIn:true TimeZone:}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1526, "user_id": 2446374, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/Jlm82.jpg?s=128&g=1", "display_name": "Darren Oakey", "link": "https://stackoverflow.com/users/2446374/darren-oakey"}, "edited": false, "score": 0, "creation_date": 1470099340, "post_id": 38691996, "comment_id": 64797924, "body": "that&#39;s actually what I&#39;ve done at the moment  - seems the least of all evils - return interface{} and just add a type assertion every time I do it.  crazy ugly, but not as ugly as an if compound statement! :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1470034795, "last_edit_date": 1470034795, "creation_date": 1470031836, "answer_id": 38691996, "question_id": 38690544, "link": "https://stackoverflow.com/questions/38690544/is-it-possible-to-make-a-type-generic-template-function-in-golang/38691996#38691996", "title": "is it possible to make a type-generic (template) function in Golang", "body": "<p>The best you can do is declare it to return a value of type <code>interface{}</code>, but that's not what you're looking for (you'd need <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a> to get values of other types out of it).</p>\n\n<p>You want your <code>panicIfError()</code> function to return different concrete types. That's not possible in Go.</p>\n\n<p>See related topic in <a href=\"https://golang.org/doc/faq#generics\" rel=\"nofollow\">FAQ: Why does Go not have generic types?</a></p>\n"}], "owner": {"reputation": 1526, "user_id": 2446374, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/Jlm82.jpg?s=128&g=1", "display_name": "Darren Oakey", "link": "https://stackoverflow.com/users/2446374/darren-oakey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2747, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470037536, "creation_date": 1470021705, "last_edit_date": 1470037536, "question_id": 38690544, "link": "https://stackoverflow.com/questions/38690544/is-it-possible-to-make-a-type-generic-template-function-in-golang", "title": "is it possible to make a type-generic (template) function in Golang", "body": "<p>I'm new to go - just playing with it - but I've written a command line tool - I call about 30 different functions that <code>return x, err</code>.  In every case - what I want to do is just panic if there is an error - basically everything works perfectly, or the whole thing fails.</p>\n\n<p>I know there's <code>template.Must( t Template*, err Error) Template*</code> - and I know I can make a <code>check(something interface{}, err Error) interface{}</code> - but to use it I've gotta do a type cast, which is nasty.</p>\n\n<p>Is it in any way possible to make a sort of generic function <code>panicIfError</code> such that I can do something like</p>\n\n<pre><code> x := panicIfError( ioutil.ReadFile( fileName )) \n</code></pre>\n\n<p>and have x come out with the right type?</p>\n\n<p>(I've seen lots of people put the if on the same line - to my mind that sacrifices too much readability - currently my only solution is to make an overload of <code>panicIfError</code> for every single type I use, which is not ideal)</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1470032098, "post_id": 38690467, "comment_id": 64762980, "body": "What is your <code>models.VMR</code> type? Can you post its declaration?"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 3, "creation_date": 1470032197, "post_id": 38690467, "comment_id": 64763022, "body": "why not <code>rows.One(&amp;vmr)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 5235763, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MT8m38bvWls/AAAAAAAAAAI/AAAAAAAAAWc/sIY7wBDDXYk/photo.jpg?sz=128", "display_name": "Nathaniel Dean", "link": "https://stackoverflow.com/users/5235763/nathaniel-dean"}, "is_accepted": false, "score": 0, "last_activity_date": 1470844904, "creation_date": 1470844904, "answer_id": 38878412, "question_id": 38690467, "link": "https://stackoverflow.com/questions/38690467/interface-conversion-interface-is-mapstringinterface-not/38878412#38878412", "title": "interface conversion: interface is map[string]interface {} not", "body": "<p>The <code>viewResults.One(interface{})</code> call is a wrapper around <code>Next(interface{})</code> which calls <code>json.Unmarshal</code> under the covers:<a href=\"https://github.com/couchbase/gocb/blob/e2744370fbc716dfa8c66ce1638602becf880c75/bucket_query.go#L40\" rel=\"nofollow\" title=\"under the covers.\">Github link to relevant code</a>. If you offer an <code>interface{}</code> object to <code>Unmarshal</code>, it will return to you a <code>map[string]interface{}</code> because it has no other option. Try this:</p>\n\n<pre><code>var row VMR\nrows.One(&amp;row)\nfmt.Printf(\"Query1: %+v\\n\", row)\n\nreturn row\n</code></pre>\n\n<p>...and that should handle the Unmarshal correctly.</p>\n"}], "owner": {"reputation": 1144, "user_id": 2851048, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/366502ddc3c69fd05dd185b01b0f6e8b?s=128&d=identicon&r=PG&f=1", "display_name": "schumacherj", "link": "https://stackoverflow.com/users/2851048/schumacherj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6932, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1613030870, "creation_date": 1470020889, "last_edit_date": 1470032817, "question_id": 38690467, "link": "https://stackoverflow.com/questions/38690467/interface-conversion-interface-is-mapstringinterface-not", "title": "interface conversion: interface is map[string]interface {} not", "body": "<p>I'm getting really confused by all the different types in Go, but I have a strictly defined struct 'VMR' and I'm trying to do a convert data to it.</p>\n\n<p>I'm querying CouchDB (using the Go SDK) and then trying to assert the returned data into my struct. Of course this isn't working and it's throwing a panic. I'm shooting in the dark trying to figure out what I'm doing wrong. </p>\n\n<p>Here is my function/struct:</p>\n\n<pre><code>type VMR struct {\n    Name               string `json:\"name,omitempty\"`\n    InUse              bool   `json:\"inuse\"`\n    Description        string `json:\"description,omitempty\"`\n    View               string `json:\"view,omitempty\"`\n    Theme              string `json:\"theme,omitempty\"`\n    Alias1             int    `json:\"alias1,omitempty\"`\n    Alias1_Description string `json:\"alias1_description,omitempty\"`\n    Host_PIN           int    `json:\"host_pin,omitempty\"`\n    Allow_Guests       bool   `json:\"allow_guests,omitempty\"`\n    Guest_Pin          int    `json:\"guest_pin,omitempty\"`\n    Alias2             int    `json:\"alias2,omitempty\"`\n    Alias2_Description string `json:\"alias2_description,omitempty\"`\n}\n\nfunc Get() VMR {\n    cluster, _ := gocb.Connect(\"couchbase://ip:port\")\n    bucket, _ := cluster.OpenBucket(\"bucket\", \"password\")\n    myQuery := gocb.NewN1qlQuery(\"SELECT * FROM `bucket` WHERE name='test42' LIMIT 1\")\n    rows, _ := bucket.ExecuteN1qlQuery(myQuery, nil)\n\n    var row interface{}\n    rows.One(&amp;row)\n    fmt.Printf(\"Query1: %+v\\n\", row)\n\n    return row.(VMR)\n}\n</code></pre>\n\n<p>Full output:</p>\n\n<p><code>Query1: map[115:map[alias1_description:Alias 1 description alias2_description:Alias description description:This is the best VMR name:test42 view:ViewOption theme:Theme51 alias1:1 alias2:1 guest_pin:1 host_pin:1 inuse:false]]</code></p>\n\n<p>Error:  </p>\n\n<pre><code>panic: interface conversion: interface is map[string]interface {}, not models.VMR\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 1, "last_activity_date": 1469996580, "last_edit_date": 1469996580, "creation_date": 1469995816, "answer_id": 38687999, "question_id": 38687781, "link": "https://stackoverflow.com/questions/38687781/why-the-array-resulted-from-the-stdin-in-golang-convert-the-last-item-to-zero/38687999#38687999", "title": "Why the array resulted from the stdin in Golang convert the last item to zero?", "body": "<blockquote>\n  <p>ReadString reads until the first occurrence of delim in the input,<br>\n   returning a string containing the data up to and including the\n  delimiter.</p>\n</blockquote>\n\n<p>so, <code>strings.Split(text, \" \")</code> not splits last <code>\\n</code> character so:<br>\nyou may use <code>strings.Fields(text)</code> instead of  <code>strings.Split(text, \" \")</code><br>\nand always check for errors:<br>\nlike this working sample code:  </p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    a := ReadInput()\n    fmt.Println(a)\n}\n\nfunc ReadInput() []float64 {\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter text: \")\n    text, err := reader.ReadString('\\n')\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    textSlice := strings.Fields(text)\n    floatsSlice := make([]float64, 0)\n    for _, elem := range textSlice {\n        i, err := strconv.ParseFloat(elem, 64)\n        if err != nil {\n            fmt.Println(err)\n        }\n        floatsSlice = append(floatsSlice, i)\n    }\n\n    return floatsSlice\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6660868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981266cc1f5b06bbcfde305b993d9037?s=128&d=identicon&r=PG&f=1", "display_name": "NewBie", "link": "https://stackoverflow.com/users/6660868/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 38687999, "answer_count": 1, "score": 1, "last_activity_date": 1469998923, "creation_date": 1469994201, "last_edit_date": 1469998923, "question_id": 38687781, "link": "https://stackoverflow.com/questions/38687781/why-the-array-resulted-from-the-stdin-in-golang-convert-the-last-item-to-zero", "title": "Why the array resulted from the stdin in Golang convert the last item to zero?", "body": "<p><em>Note: I am new to StackOverflow as well as to Programming, so if my question is not \"so professional\" or \"well formatted\", please forgive me.</em></p>\n\n<p>I am using the following Go (Golang) code to capture some space-separated numbers (string) from terminal, then split it into a slice. Later I'm converting this slice to a slice of float64 by getting one item at a time from the strings-slice and converting it to float64 and appending it to the float64-slice.\nThen I'm returning the resulting float64 slice and printing it in the main function.\nThe problem is when I pass some space-separated digits to the terminal, the last digit is converted to zero.</p>\n\n<p>for example if I pass <code>1 2 3 4 5</code> I expect the resulting slice as <code>[1 2 3 4 5]</code>, but it gives me the slice as <code>[1 2 3 4 0]</code>.</p>\n\n<p>I'm trying from the last 5 hours, but I'm not able to find what I'm missing or messing.</p>\n\n<p>code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    a := ReadInput()\n    fmt.Println(a)\n}\n\nfunc ReadInput() []float64 {\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter text: \")\n    text, _ := reader.ReadString('\\n')\n\n    textSlice := strings.Split(text, \" \")\n    floatsSlice := make([]float64, 0)\n    for _, elem := range textSlice {\n        i, _ := strconv.ParseFloat(elem, 64)\n        floatsSlice = append(floatsSlice, i)\n    }\n\n    return floatsSlice\n}\n</code></pre>\n\n<p>Thank You in advance!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1469986953, "post_id": 38686583, "comment_id": 64752637, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/32309830/can-template-parseglob-parse-templates-in-subdirectories\">Can template.ParseGlob() parse templates in subdirectories?</a>"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1470001343, "post_id": 38686583, "comment_id": 64756825, "body": "@icza I agree with the possible duplicate, but it doesn&#39;t exactly provide an answer on how to work around this which may be why these duplicate questions are appearing."}], "answers": [{"comments": [{"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 4, "creation_date": 1500417096, "post_id": 38688083, "comment_id": 77324842, "body": "A shame something like that isn&#39;t in the standard library. Good thing it isn&#39;t hard to implement, though."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 2, "creation_date": 1527581380, "post_id": 38688083, "comment_id": 88167895, "body": "This doesn&#39;t work very well if several directories contain files with the same name. Using ParseFiles, the template&#39;s name is obtained from the base name of the file path; this might cause name conflicts."}], "tags": [], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "is_accepted": false, "score": 19, "last_activity_date": 1469996550, "creation_date": 1469996550, "answer_id": 38688083, "question_id": 38686583, "link": "https://stackoverflow.com/questions/38686583/golang-parse-all-templates-in-directory-and-subdirectories/38688083#38688083", "title": "Golang: Parse all templates in directory and subdirectories?", "body": "<p>Not without implementing your own function to do it, I've been using something like this</p>\n\n<pre><code>func ParseTemplates() *template.Template {\n    templ := template.New(\"\")\n    err := filepath.Walk(\"./views\", func(path string, info os.FileInfo, err error) error {\n        if strings.Contains(path, \".html\") {\n            _, err = templ.ParseFiles(path)\n            if err != nil {\n                log.Println(err)\n            }\n        }\n\n        return err\n    })\n\n    if err != nil {\n        panic(err)\n    }\n\n    return templ\n}\n</code></pre>\n\n<p>This will parse all your templates then you can render them by calling their names e.g.</p>\n\n<p><code>template.ExecuteTemplate(w, \"home\", nil)</code></p>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 11, "last_activity_date": 1584110987, "last_edit_date": 1584110987, "creation_date": 1527586495, "answer_id": 50581032, "question_id": 38686583, "link": "https://stackoverflow.com/questions/38686583/golang-parse-all-templates-in-directory-and-subdirectories/50581032#50581032", "title": "Golang: Parse all templates in directory and subdirectories?", "body": "<p>Datsik's answer has the drawback that there are name collision issues when several directories contain many templates. If two templates in different directories have the same filename it won't work properly: only the second of them will be usable.</p>\n\n<p>This is caused by the implementation of template.ParseFiles, so we can solve it by avoiding template.ParseFiles. Here's a modified walk algorithm that does this by using template.Parse directly instead.</p>\n\n<pre><code>func findAndParseTemplates(rootDir string, funcMap template.FuncMap) (*template.Template, error) {\n    cleanRoot := filepath.Clean(rootDir)\n    pfx := len(cleanRoot)+1\n    root := template.New(\"\")\n\n    err := filepath.Walk(cleanRoot, func(path string, info os.FileInfo, e1 error) error {\n        if !info.IsDir() &amp;&amp; strings.HasSuffix(path, \".html\") {\n            if e1 != nil {\n                return e1\n            }\n\n            b, e2 := ioutil.ReadFile(path)\n            if e2 != nil {\n                return e2\n            }\n\n            name := path[pfx:]\n            t := root.New(name).Funcs(funcMap)\n            _, e2 = t.Parse(string(b))\n            if e2 != nil {\n                return e2\n            }\n        }\n\n        return nil\n    })\n\n    return root, err\n}\n</code></pre>\n\n<p>This will parse all your templates then you can render them by calling their names e.g.</p>\n\n<pre><code>template.ExecuteTemplate(w, \"a/home.html\", nil)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 122, "user_id": 5484148, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2OS9l.png?s=128&g=1", "display_name": "DAOdAppDev", "link": "https://stackoverflow.com/users/5484148/daodappdev"}, "edited": false, "score": 1, "creation_date": 1587947558, "post_id": 59125497, "comment_id": 108702703, "body": "i think this is a fantatic answer"}], "tags": [], "owner": {"reputation": 489, "user_id": 2800844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a7c17de7fc00ed31b24745ca0b317e7?s=128&d=identicon&r=PG&f=1", "display_name": "pete911", "link": "https://stackoverflow.com/users/2800844/pete911"}, "is_accepted": false, "score": 8, "last_activity_date": 1575203444, "creation_date": 1575203444, "answer_id": 59125497, "question_id": 38686583, "link": "https://stackoverflow.com/questions/38686583/golang-parse-all-templates-in-directory-and-subdirectories/59125497#59125497", "title": "Golang: Parse all templates in directory and subdirectories?", "body": "<p>if it is not deeply nested (if you know names of sub-directories beforehand) you can just do this:</p>\n\n<pre><code>t := template.Must(template.ParseGlob(\"template/*.tmpl\"))\ntemplate.Must(t.ParseGlob(\"template/layout/*.tmpl\"))\n</code></pre>\n\n<p>Then for each sub-directory do the same as for 'layout'</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14593180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QdZof.jpg?s=128&g=1", "display_name": "Reindert Vetter", "link": "https://stackoverflow.com/users/14593180/reindert-vetter"}, "is_accepted": false, "score": 0, "last_activity_date": 1604702463, "creation_date": 1604702463, "answer_id": 64722510, "question_id": 38686583, "link": "https://stackoverflow.com/questions/38686583/golang-parse-all-templates-in-directory-and-subdirectories/64722510#64722510", "title": "Golang: Parse all templates in directory and subdirectories?", "body": "<p>You can load multiple subdirectories this way. Here we ignore if subdirectories do not exist. But we want to make sure that the first directory can be loaded.</p>\n<pre><code>func ParseTemplates() (*template.Template, error) {\n    templateBuilder := template.New(&quot;&quot;)\n    if t, _ := templateBuilder.ParseGlob(&quot;/*/*/*/*/*.tmpl&quot;); t != nil {\n        templateBuilder = t\n    }\n    if t, _ := templateBuilder.ParseGlob(&quot;/*/*/*/*.tmpl&quot;); t != nil {\n        templateBuilder = t\n    }\n    if t, _ := templateBuilder.ParseGlob(&quot;/*/*/*.tmpl&quot;); t != nil {\n        templateBuilder = t\n    }\n    if t, _ := templateBuilder.ParseGlob(&quot;/*/*.tmpl&quot;); t != nil {\n        templateBuilder = t\n    }\n    return templateBuilder.ParseGlob(&quot;/*.tmpl&quot;)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32310, "user_id": 101152, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/17e922b50957d152280d6140c6756444?s=128&d=identicon&r=PG", "display_name": "Karel B&#237;lek", "link": "https://stackoverflow.com/users/101152/karel-b%c3%adlek"}, "is_accepted": false, "score": 0, "last_activity_date": 1610531470, "creation_date": 1610531470, "answer_id": 65699405, "question_id": 38686583, "link": "https://stackoverflow.com/questions/38686583/golang-parse-all-templates-in-directory-and-subdirectories/65699405#65699405", "title": "Golang: Parse all templates in directory and subdirectories?", "body": "<p>I made a package that solves exactly this problem.</p>\n<p><a href=\"https://github.com/karelbilek/template-parse-recursive\" rel=\"nofollow noreferrer\">https://github.com/karelbilek/template-parse-recursive</a></p>\n<pre><code>package main\n\nimport (\n    &quot;html/template&quot;\n    &quot;os&quot;\n\n    recurparse &quot;github.com/karelbilek/template-parse-recursive&quot;\n)\n\nfunc main() {\n    t, err := recurparse.HTMLParse(\n        template.New(&quot;templates&quot;), \n        &quot;path/to/templates&quot;, \n        &quot;*.html&quot;,\n    )\n   \n    if err != nil {\n        panic(err)\n    }\n    \n    templateUnder := t.Lookup(&quot;subdir/subdir/template.html&quot;)\n    templateUnder.Execute(os.Stdout, nil)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13534322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0fa59fbfd762276967fcf23d73254c7?s=128&d=identicon&r=PG&f=1", "display_name": "odas0r", "link": "https://stackoverflow.com/users/13534322/odas0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1614115616, "last_edit_date": 1614115616, "creation_date": 1614114231, "answer_id": 66341065, "question_id": 38686583, "link": "https://stackoverflow.com/questions/38686583/golang-parse-all-templates-in-directory-and-subdirectories/66341065#66341065", "title": "Golang: Parse all templates in directory and subdirectories?", "body": "<p>With the answer of pete911 I could create this function to parse all the html templates on multiple subdirectories.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>// parse.go\nfunc ParseHtmlTemplates() *template.Template {\n    var directories []string\n    var filenames []string\n\n    // Root directory of template files\n    root := &quot;./templates&quot;\n\n    // Get all directories on /templates and check if there's repeated files\n    err := filepath.Walk(root, func(path string, info os.FileInfo, err error) error {\n        if !info.IsDir() {\n            // Is file\n            filename := info.Name()\n\n            hasRepeatedFiles := contains(filenames, filename)\n            if hasRepeatedFiles {\n                return fmt.Errorf(&quot;You can't have repeated template files: %s&quot;, filename)\n            }\n\n            filenames = append(filenames, filename)\n        } else {\n            // Is directory\n            directories = append(directories, path)\n        }\n\n        return nil\n    })\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n\n    // Create a template for parsing all directories\n    tmpl := template.Must(template.ParseGlob(root + &quot;/*.html&quot;))\n\n    // Parse all directories (minus the root directory)\n    for _, path := range directories[1:] {\n        pattern := path + &quot;/*.html&quot;\n        template.Must(tmpl.ParseGlob(pattern))\n    }\n\n    return tmpl\n}\n\n// contains private method\nfunc contains(filenames []string, filename string) bool {\n    for _, f := range filenames {\n        if f == filename {\n            return true\n        }\n    }\n    return false\n}\n\n// main.go\nfunc main() {\n    tmpl = ParseHtmlTemplates()\n    if err := tmpl.Execute(os.Stdout, &quot;&quot;); err != nil {\n        panic(err)\n    }\n}\n\n\n\n</code></pre>\n"}], "owner": {"reputation": 1866, "user_id": 2449468, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/814a2fe06121017beb9d2c95426c7d36?s=128&d=identicon&r=PG", "display_name": "Sunny", "link": "https://stackoverflow.com/users/2449468/sunny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8726, "favorite_count": 0, "answer_count": 6, "score": 8, "last_activity_date": 1614115616, "creation_date": 1469985718, "question_id": 38686583, "link": "https://stackoverflow.com/questions/38686583/golang-parse-all-templates-in-directory-and-subdirectories", "title": "Golang: Parse all templates in directory and subdirectories?", "body": "<p>This is my directory structure:</p>\n\n<pre><code>app/\n  template/\n    layout/\n      base.tmpl\n    index.tmpl\n</code></pre>\n\n<p><code>template.ParseGlob(\"*/*.tmpl\")</code> parses <code>index.tmpl</code> but not <code>base.tmpl</code> in the <code>layout</code> subdirectory. Is there a way to parse all templates recursively?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 4, "creation_date": 1469977518, "post_id": 38684841, "comment_id": 64749809, "body": "You can&#39;t delete a line from the front of a file without re-writing the whole file.  Your sed example has the same problem with losing a line added while it&#39;s doing it&#39;s thing.  The race is smaller in sed given that you only lose the line if it was written while you were processing the previous last line"}, {"owner": {"reputation": 3010, "user_id": 519557, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/x9V4f.jpg?s=128&g=1", "display_name": "jxstanford", "link": "https://stackoverflow.com/users/519557/jxstanford"}, "edited": false, "score": 1, "creation_date": 1469981265, "post_id": 38684841, "comment_id": 64750908, "body": "Is the purpose of deleting the line to protect from failure, so you can pick up where you left off?  In that case, you might be better off writing a state file with the most recent line processed, checking for it on startup, then begin processing from that location if it exists.  When you hit EOF, you know you can safely delete the file."}, {"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 0, "creation_date": 1470017207, "post_id": 38684841, "comment_id": 64759665, "body": "You could loop through each line, concat the &quot;processed&quot; line to a string variable, then (once loop is done) rewrite the file use contents of string variable."}, {"owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1470186726, "post_id": 38684841, "comment_id": 64841685, "body": "@DavidBudworth I haver never thought about sed in a shell script having the same problem, it&#39;s only now that I&#39;m learning Go and having to deal with this directly that I learn these things."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1470043712, "last_edit_date": 1495540386, "creation_date": 1469997652, "answer_id": 38688215, "question_id": 38684841, "link": "https://stackoverflow.com/questions/38684841/reading-from-a-text-file-in-golang/38688215#38688215", "title": "Reading from a text file in Golang?", "body": "<p>you have some options:<br>\n1- read file, process it, then write it back (you need to lock that file).<br>\n2- use binary file and invent (make use of) special data structure (like linked list) to optimize text processing (with line locking).<br>\n3- <strong>use ready made databases</strong>.<br>\n4- use Virtual filesystem inside your file, and treat each line like one file, see: <a href=\"https://github.com/lotrfan/vfs\" rel=\"nofollow noreferrer\">https://github.com/lotrfan/vfs</a>   and <a href=\"https://github.com/blang/vfs\" rel=\"nofollow noreferrer\">https://github.com/blang/vfs</a></p>\n\n<p>using file manager (like database server) solves the file locking dilemma.</p>\n\n<p>and if the purpose of using file is one way communication which sender program just adds new line and receiver program just removes it, it is better to use os pipes (named pipe (FIFO)) or other <a href=\"https://stackoverflow.com/questions/tagged/interop\">interop</a> methods.</p>\n\n<p>see for Linux:  <a href=\"https://stackoverflow.com/questions/6441754/unix-fifo-in-go\">Unix FIFO in go?</a><br>\nfor Windows:  <a href=\"https://github.com/natefinch/npipe\" rel=\"nofollow noreferrer\">https://github.com/natefinch/npipe</a></p>\n\n<p>sample file writer:  </p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    f, err := os.OpenFile(\"/tmp/file.txt\", os.O_CREATE|os.O_WRONLY|os.O_APPEND, 0666)\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n    for i := 0; ; i++ {\n        w := bufio.NewWriter(f)\n        _, err := fmt.Fprintln(w, i)\n        if err != nil {\n            panic(err)\n        }\n        w.Flush() // Flush writes any buffered data to the underlying io.Writer.\n        f.Sync()  // commit the current contents of the file to stable storage.\n        fmt.Println(\"write\", i)\n        time.Sleep(500 * time.Millisecond)\n    }\n}\n</code></pre>\n\n<p>sample file reader:  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    f, err := os.OpenFile(\"/tmp/file.txt\", os.O_RDWR, 0666)\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n\n    i := 0\n    for {\n        n, err := fmt.Fscanln(f, &amp;i)\n        if n == 1 {\n            fmt.Println(i)\n        }\n        if err != nil {\n            fmt.Println(err)\n            return\n        }\n        time.Sleep(500 * time.Millisecond)\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "edited": false, "score": 0, "creation_date": 1470186456, "post_id": 38690024, "comment_id": 64841630, "body": "Perfect, this is what I need. I will change the requirement of deleting the line, because this seems not to be common, like <code>Wget</code> will not delete any lines if getting URL&#39;s from a file."}, {"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "reply_to_user": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "edited": false, "score": 0, "creation_date": 1470235894, "post_id": 38690024, "comment_id": 64867760, "body": "Sounds good. Figured once you have a skeleton for looping through the file, you could do as you want... Please upvote if you like."}], "tags": [], "owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "is_accepted": true, "score": 7, "last_activity_date": 1470017011, "last_edit_date": 1470017011, "creation_date": 1470016698, "answer_id": 38690024, "question_id": 38684841, "link": "https://stackoverflow.com/questions/38684841/reading-from-a-text-file-in-golang/38690024#38690024", "title": "Reading from a text file in Golang?", "body": "<p>Use the <code>bufio</code> package.</p>\n\n<p>Here's the basic syntax for opening a text file and looping through each <code>line</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    // Open the file.\n    f, _ := os.Open(\"C:\\\\programs\\\\file.txt\")\n    // Create a new Scanner for the file.\n    scanner := bufio.NewScanner(f)\n    // Loop over all lines in the file and print them.\n    for scanner.Scan() {\n      line := scanner.Text()\n      fmt.Println(line)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4215, "favorite_count": 0, "accepted_answer_id": 38690024, "answer_count": 2, "score": 1, "last_activity_date": 1470043712, "creation_date": 1469974280, "last_edit_date": 1469998664, "question_id": 38684841, "link": "https://stackoverflow.com/questions/38684841/reading-from-a-text-file-in-golang", "title": "Reading from a text file in Golang?", "body": "<p>I want to do this:</p>\n\n<ol>\n<li>Read a line from a text file.</li>\n<li>Process the line.</li>\n<li>Delete the line.</li>\n</ol>\n\n<p>My first thought was to read the entire file into memory with <code>ioutil.Readfile()</code>,<br>\nbut I'm not sure how to update the text file after the line has been processed,<br>\nand what happens if extra lines is added to the text file after it has been read into memory?</p>\n\n<p>I normally write shell scripts and would do something like this:</p>\n\n<pre><code>while read -r line; do\n    echo \"${line}\"\n    sed -i 1d \"${myList}\"\ndone &lt; \"${myList}\"\n</code></pre>\n\n<p>What is the best way to do this in Golang?</p>\n"}, {"tags": ["google-app-engine", "go", "remoteapi", "google-app-engine-go"], "comments": [{"owner": {"reputation": 5096, "user_id": 66051, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0178546674e0c7d0ff570a328af15603?s=128&d=identicon&r=PG", "display_name": "MeLight", "link": "https://stackoverflow.com/users/66051/melight"}, "edited": false, "score": 0, "creation_date": 1470037569, "post_id": 38683178, "comment_id": 64765649, "body": "I usually try not to give advice if it does not answer the question, but I see that no one has answered. Using remote_api_shell for production doesn&#39;t seem like a very good idea. Why not just create a handler to deal with that specific task?"}, {"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "reply_to_user": {"reputation": 5096, "user_id": 66051, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0178546674e0c7d0ff570a328af15603?s=128&d=identicon&r=PG", "display_name": "MeLight", "link": "https://stackoverflow.com/users/66051/melight"}, "edited": false, "score": 0, "creation_date": 1470123088, "post_id": 38683178, "comment_id": 64805286, "body": "@MeLight thanks! Why do you thing remote api is not a good idea to be used in production? Anyways, there is no one specific task, I need a way to query different entities from the datastore."}, {"owner": {"reputation": 5096, "user_id": 66051, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0178546674e0c7d0ff570a328af15603?s=128&d=identicon&r=PG", "display_name": "MeLight", "link": "https://stackoverflow.com/users/66051/melight"}, "edited": false, "score": 1, "creation_date": 1470140070, "post_id": 38683178, "comment_id": 64816392, "body": "Because remote API requires you to have the App Engine installed on the machine calling the API, <i>and</i> the code of the models. You will need to keep both up to date. Huge hassle. The better approach would be to make a handler to perform whatever task you need - you can pass parameters in the GET request. That way your called application is not dependent on the code of your app and you can trigger it from any app that can make a HTTP request."}, {"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "reply_to_user": {"reputation": 5096, "user_id": 66051, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0178546674e0c7d0ff570a328af15603?s=128&d=identicon&r=PG", "display_name": "MeLight", "link": "https://stackoverflow.com/users/66051/melight"}, "edited": false, "score": 0, "creation_date": 1470230481, "post_id": 38683178, "comment_id": 64863497, "body": "@MeLight good point"}], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1469962096, "creation_date": 1469962096, "question_id": 38683178, "link": "https://stackoverflow.com/questions/38683178/google-app-engine-using-remote-api-with-a-local-gae-dev-server", "title": "Google App Engine: Using Remote API with a Local GAE Dev Server", "body": "<p>I have a non-GAE backend that's using the Remote API to access datastore. The only way to do this (without a proxy GAE service) is to use the GAE Remote API. </p>\n\n<p>This works fine when connecting the Remote Context to a GAE production deployment, but what about GAE dev server? </p>\n\n<p>I want to be able to test my changes locally before deploying anything. Is there a way to connect the remote API to a local GAE dev server datastore?</p>\n\n<p>Relevant sample code:</p>\n\n<pre><code>func getRemoteCtx(ctx context.Context, r *http.Request) (context.Context, error) {\n    ts, err := google.DefaultTokenSource(ctx,\n        \"https://www.googleapis.com/auth/appengine.apis\",\n        \"https://www.googleapis.com/auth/userinfo.email\",\n        \"https://www.googleapis.com/auth/cloud-platform\",\n    )\n    if err != nil {\n        log.Fatal(err)\n    }\n    hc := oauth2.NewClient(ctx, ts)\n\n    host := \"myapp.appspot.com\"\n\n    log.Printf(\"create remote context with host: %s\", host)\n    return remote_api.NewRemoteContext(host, hc)\n}\n</code></pre>\n\n<p>Check out the <code>host</code>. Is there a way to set this to a local GAE dev server?</p>\n"}, {"tags": ["http", "go", "get"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6152536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZ3eV.png?s=128&g=1", "display_name": "britannic", "link": "https://stackoverflow.com/users/6152536/britannic"}, "is_accepted": false, "score": 0, "last_activity_date": 1469979070, "creation_date": 1469979070, "answer_id": 38685530, "question_id": 38682053, "link": "https://stackoverflow.com/questions/38682053/why-does-func-get-of-fasthttp-in-golang-have-dst-parameter/38685530#38685530", "title": "Why does func Get of fasthttp in golang have `dst` parameter?", "body": "<p>Looking at the code where it is used in fasthttp's <a href=\"https://github.com/valyala/fasthttp/blob/master/client.go\" rel=\"nofollow\">client.go func  clientGetURLDeadlineFreeConn (line 672)</a>, you can see that if there is a timeout, dst's contents are copied to body at line 712. So based on what I read in the code (and debugged with Delve using your code), I saw that dst doesn't get updated in this usage. It seems that it can be used to provide default content to body in the event of a timeout - probably worth a direct question to fasthttp's author for more detail.</p>\n\n<pre><code>func clientGetURLDeadlineFreeConn(dst []byte, url string, deadline time.Time, c clientDoer) (statusCode int, body []byte, err error) {\ntimeout := -time.Since(deadline)\nif timeout &lt;= 0 {\n    return 0, dst, ErrTimeout\n}\n\nvar ch chan clientURLResponse\nchv := clientURLResponseChPool.Get()\nif chv == nil {\n    chv = make(chan clientURLResponse, 1)\n}\nch = chv.(chan clientURLResponse)\n\nreq := AcquireRequest()\n\n// Note that the request continues execution on ErrTimeout until\n// client-specific ReadTimeout exceeds. This helps limiting load\n// on slow hosts by MaxConns* concurrent requests.\n//\n// Without this 'hack' the load on slow host could exceed MaxConns*\n// concurrent requests, since timed out requests on client side\n// usually continue execution on the host.\ngo func() {\n    statusCodeCopy, bodyCopy, errCopy := doRequestFollowRedirects(req, dst, url, c)\n    ch &lt;- clientURLResponse{\n        statusCode: statusCodeCopy,\n        body:       bodyCopy,\n        err:        errCopy,\n    }\n}()\n\ntc := acquireTimer(timeout)\nselect {\ncase resp := &lt;-ch:\n    ReleaseRequest(req)\n    clientURLResponseChPool.Put(chv)\n    statusCode = resp.statusCode\n    body = resp.body\n    err = resp.err\ncase &lt;-tc.C:\n    body = dst\n    err = ErrTimeout\n}\nreleaseTimer(tc)\n\nreturn statusCode, body, err\n</code></pre>\n\n<p>}</p>\n\n<p>In <a href=\"https://github.com/valyala/fasthttp/blob/master/client.go\" rel=\"nofollow\">client.go func doRequestFollowRedirects (line 743)</a> it is used at line 748: bodyBuf.B = dst</p>\n\n<pre><code>func doRequestFollowRedirects(req *Request, dst []byte, url string, c clientDoer) (statusCode int, body []byte, err error) {\nresp := AcquireResponse()\nbodyBuf := resp.bodyBuffer()\nresp.keepBodyBuffer = true\noldBody := bodyBuf.B\nbodyBuf.B = dst\n\nredirectsCount := 0\nfor {\n    req.parsedURI = false\n    req.Header.host = req.Header.host[:0]\n    req.SetRequestURI(url)\n\n    if err = c.Do(req, resp); err != nil {\n        break\n    }\n    statusCode = resp.Header.StatusCode()\n    if statusCode != StatusMovedPermanently &amp;&amp; statusCode != StatusFound &amp;&amp; statusCode != StatusSeeOther {\n        break\n    }\n\n    redirectsCount++\n    if redirectsCount &gt; maxRedirectsCount {\n        err = errTooManyRedirects\n        break\n    }\n    location := resp.Header.peek(strLocation)\n    if len(location) == 0 {\n        err = errMissingLocation\n        break\n    }\n    url = getRedirectURL(url, location)\n}\n\nbody = bodyBuf.B\nbodyBuf.B = oldBody\nresp.keepBodyBuffer = false\nReleaseResponse(resp)\n\nreturn statusCode, body, err\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 429, "user_id": 6659472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jnXWL.jpg?s=128&g=1", "display_name": "aQua", "link": "https://stackoverflow.com/users/6659472/aqua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 454, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1469979070, "creation_date": 1469952932, "question_id": 38682053, "link": "https://stackoverflow.com/questions/38682053/why-does-func-get-of-fasthttp-in-golang-have-dst-parameter", "title": "Why does func Get of fasthttp in golang have `dst` parameter?", "body": "<p>I found fasthttp godoc as fellow:</p>\n\n<pre><code>func Get\nfunc Get(dst []byte, url string) (statusCode int, body []byte, err error)\nGet appends url contents to dst and returns it as body.\nThe function follows redirects. Use Do* for manually handling redirects.\nNew body buffer is allocated if dst is nil.\n</code></pre>\n\n<p>But, when I run fellow code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    fh \"github.com/valyala/fasthttp\"\n)\n\nfunc main() {\n    url := \"https://www.okcoin.cn/api/v1/ticker.do?symbol=btc_cny\"\n\n    dst := []byte(\"ok100\")\n    _, body, err := fh.Get(dst, url)\n\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Println(\"body:\", string(body))\n    fmt.Println(\"dst:\", string(dst))\n}\n</code></pre>\n\n<p><strong>body</strong> does not have \"ok100\", and <strong>dst</strong> is still \"ok100\".\nwhy?</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 12722, "user_id": 393157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PiD4P.png?s=128&g=1", "display_name": "svenwltr", "link": "https://stackoverflow.com/users/393157/svenwltr"}, "edited": false, "score": 0, "creation_date": 1469952495, "post_id": 38681718, "comment_id": 64743375, "body": "May I ask why you want to do this? Go has strong typing, which means that the type is determined at compile time. Thus it should be clear for the developer what type it is."}, {"owner": {"reputation": 3075, "user_id": 1315755, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/322da6426394727a90876bf649229abf?s=128&d=identicon&r=PG", "display_name": "navins", "link": "https://stackoverflow.com/users/1315755/navins"}, "reply_to_user": {"reputation": 12722, "user_id": 393157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PiD4P.png?s=128&g=1", "display_name": "svenwltr", "link": "https://stackoverflow.com/users/393157/svenwltr"}, "edited": false, "score": 0, "creation_date": 1470021818, "post_id": 38681718, "comment_id": 64760463, "body": "Because sometime we need to reflect.New the key and value, and inject value for each pair."}], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 18, "last_activity_date": 1469952582, "creation_date": 1469952582, "answer_id": 38682021, "question_id": 38681718, "link": "https://stackoverflow.com/questions/38681718/golang-reflect-how-to-get-map-value-type/38682021#38682021", "title": "Golang reflect, how to get map value type?", "body": "<p><code>Elem()</code> of a map type will give you the element's type:</p>\n\n<pre><code>var m map[string]int\nfmt.Println(reflect.TypeOf(m).Elem())\n// output: int\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5093, "user_id": 302005, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eDmEQ.png?s=128&g=1", "display_name": "Pioz", "link": "https://stackoverflow.com/users/302005/pioz"}, "is_accepted": false, "score": 2, "last_activity_date": 1596638806, "creation_date": 1596638806, "answer_id": 63267702, "question_id": 38681718, "link": "https://stackoverflow.com/questions/38681718/golang-reflect-how-to-get-map-value-type/63267702#63267702", "title": "Golang reflect, how to get map value type?", "body": "<p>Here an example to get the type of the map keys and map elements:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;reflect&quot;\n)\n\nfunc main() {\n    fmt.Println(&quot;Hello, playground&quot;)\n    var m map[string]int\n    fmt.Println(reflect.TypeOf(m).Key())\n    fmt.Println(reflect.TypeOf(m).Elem())\n}\n\n</code></pre>\n<p>Playground <a href=\"https://play.golang.org/p/0HHUt19fqC6\" rel=\"nofollow noreferrer\">here</a></p>\n<p>Doc is here <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow noreferrer\">https://golang.org/pkg/reflect/#Type</a></p>\n"}], "owner": {"reputation": 3075, "user_id": 1315755, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/322da6426394727a90876bf649229abf?s=128&d=identicon&r=PG", "display_name": "navins", "link": "https://stackoverflow.com/users/1315755/navins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7870, "favorite_count": 2, "answer_count": 2, "score": 10, "last_activity_date": 1596638806, "creation_date": 1469949799, "last_edit_date": 1472400125, "question_id": 38681718, "link": "https://stackoverflow.com/questions/38681718/golang-reflect-how-to-get-map-value-type", "title": "Golang reflect, how to get map value type?", "body": "<p>For a map <code>m</code> in golang, we can get simply the key type using <code>t.Key()</code>.</p>\n\n<p>But I wonder how to get the map value type? </p>\n\n<p>When the map is empty, we can not even use <code>v.MapIndex</code>, any idea?</p>\n\n<pre><code>m := map[string]int{}\nt := reflect.TypeOf(m)\nv := reflect.ValueOf(m)\nt.Key()\nv.MapIndex()\n</code></pre>\n"}, {"tags": ["unit-testing", "testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 1, "last_activity_date": 1469953059, "creation_date": 1469953059, "answer_id": 38682067, "question_id": 38681702, "link": "https://stackoverflow.com/questions/38681702/example-test-of-go-templates-fails-with-imported-and-not-used-testing/38682067#38682067", "title": "Example test of go templates fails with imported and not used: &quot;testing&quot;", "body": "<p>You are using an incorrect type in your test function:</p>\n\n<pre><code>// tesintg.T, not Testing.T\n// T is a type defined in testing module\nfunc TestRunTempl(t *testing.T) { \n    sweaters := Inventory{\"wool\", 17}\n    tmpl := \"{{.Count}} items are made of {{.Material}}\"\n    err := RunTempl(tmpl, sweaters)\n    if err != nil {\n        t.Error(\"Template failed \")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 764, "user_id": 1405725, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/85157a97c87155b8ec2671e86aef1087?s=128&d=identicon&r=PG", "display_name": "Darian311", "link": "https://stackoverflow.com/users/1405725/darian311"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 38682067, "answer_count": 1, "score": 0, "last_activity_date": 1469953059, "creation_date": 1469949603, "question_id": 38681702, "link": "https://stackoverflow.com/questions/38681702/example-test-of-go-templates-fails-with-imported-and-not-used-testing", "title": "Example test of go templates fails with imported and not used: &quot;testing&quot;", "body": "<p>As far as I can tell I'm following structure needed for 'go test' flawlessly.  I don't see a discrepancy from tests I could run in other packages. 'go build' works fine.\nI'm getting </p>\n\n<blockquote>\n  <p>./HelloTemplate_test.go:3: imported and not used: \"testing\"\n  ./HelloTemplate_test.go:5: undefined: Testing in Testing.T</p>\n</blockquote>\n\n<p>What am I missing?</p>\n\n<p>HelloTemplate.go</p>\n\n<pre><code>package templateprint\n\nimport \"testing\"\n\nfunc TestRunTempl(t *Testing.T) {\n    sweaters := Inventory{\"wool\", 17}\n    tmpl := \"{{.Count}} items are made of {{.Material}}\"\n    err := RunTempl(tmpl, sweaters)\n    if err != nil {\n        t.Error(\"Template failed \")\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>HelloTemplate_test.go</p>\n</blockquote>\n\n<pre><code>package templateprint\n\nimport (\n    \"os\"\n    \"text/template\"\n)\n\ntype Inventory struct {\n    Material string\n    Count    uint\n}\n\nfunc RunTempl(templ string, inv Inventory) error {\n    tmpl, err := template.New(\"test\").Parse(templ)\n    if err != nil {\n        return (err)\n    }\n    err = tmpl.Execute(os.Stdout, inv)\n    if err != nil {\n        return (err)\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": ["json", "go", "struct", "unmarshalling"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1469942316, "post_id": 38680809, "comment_id": 64741588, "body": "There&#39;s some json field that is a number and you are trying to unmarshal it into a go <code>string</code> type. Do you have an example json data value?"}, {"owner": {"reputation": 746, "user_id": 2753021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2OkrK.png?s=128&g=1", "display_name": "Furkan Mustafa", "link": "https://stackoverflow.com/users/2753021/furkan-mustafa"}, "edited": false, "score": 0, "creation_date": 1498613730, "post_id": 38680809, "comment_id": 76565423, "body": "not a question."}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": false, "score": 0, "last_activity_date": 1469942257, "creation_date": 1469942257, "answer_id": 38681002, "question_id": 38680809, "link": "https://stackoverflow.com/questions/38680809/golang-cannot-unmarshal-number-into-go-value-of-type-string/38681002#38681002", "title": "Golang - Cannot unmarshal number into Go value of type string", "body": "<p>There are multiple errors in the struct definition. Here is fixed version.</p>\n\n<p><a href=\"https://play.golang.org/p/O39E3CdKes\" rel=\"nofollow\">https://play.golang.org/p/O39E3CdKes</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": -1, "last_activity_date": 1469942409, "creation_date": 1469942409, "answer_id": 38681007, "question_id": 38680809, "link": "https://stackoverflow.com/questions/38680809/golang-cannot-unmarshal-number-into-go-value-of-type-string/38681007#38681007", "title": "Golang - Cannot unmarshal number into Go value of type string", "body": "<p>this works for me (corrected version):  </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\ntype movie struct {\n    Adult         bool\n    Backdrop_path string\n    Budget        int\n    Genres        []struct {\n        Id   int // string\n        Name string\n    }\n    Homepage             string\n    Id                   int\n    Imdb_id              string\n    Original_language    string\n    Original_title       string\n    Overview             string\n    Popularity           float64 //    string\n    Poster_path          string\n    Production_companies []struct {\n        Name string\n        Id   int\n    }\n    Production_countries []struct {\n        Name string\n    }\n    Release_date     string\n    Revenue          int\n    Runtime          int\n    Spoken_languages []struct {\n        Name string\n    }\n    Status       string\n    Tagline      string\n    Title        string\n    Video        bool\n    Vote_average float64\n    Vote_count   int\n    Embedurl     string\n}\n\nfunc main() {\n    var movieData movie\n    str := `\n    {\n    \"adult\":false,\n    \"backdrop_path\":\"/mWuHbFc7qVmVcpybx3ezhXLj5VO.jpg\",\n    \"belongs_to_collection\":null,\n    \"budget\":25000000,\n    \"genres\":\n        [\n        {\n            \"id\":35,\n            \"name\":\"Comedy\"\n        },\n        {\n            \"id\":37,\n            \"name\":\"Western\"\n        }\n        ],\n    \"homepage\":\"\",\n    \"id\":8388,\n    \"imdb_id\":\"tt0092086\",\n    \"original_language\":\"en\",\n    \"original_title\":\"\u00a1Three Amigos!\",\n    \"overview\":\"Three unemployed actors accept an invitation to a Mexican village to replay their bandit fighter roles, unaware that it is the real thing.\",\n    \"popularity\":0.799492,\n    \"poster_path\":\"/ehCzedovkiM8CnDeuSSHlRbdfxI.jpg\",\n    \"production_companies\":\n    [{\n        \"name\":\"L.A. Films\",\n        \"id\":960\n     },\n     {\n        \"name\":\"Home Box Office (HBO)\",\n        \"id\":3268\n     }],\n    \"production_countries\":\n    [{\n        \"iso_3166_1\":\"US\",\n        \"name\":\"United States of America\"\n    }],\n    \"release_date\":\"1986-12-12\",\n    \"revenue\":0,\n    \"runtime\":102,\n    \"spoken_languages\":\n    [{\n        \"iso_639_1\":\"en\",\n        \"name\":\"English\"\n    },{\n        \"iso_639_1\":\"de\",\n        \"name\":\"Deutsch\"\n    },{\n        \"iso_639_1\":\"es\",\n        \"name\":\"Espa\u00f1ol\"\n    }],\n    \"status\":\"Released\",\n    \"tagline\":\"They're Down On Their Luck And Up To Their Necks In Senoritas, Margaritas, Banditos And Bullets!\",\n    \"title\":\"Three Amigos\",\n    \"video\":false,\n    \"vote_average\":6.2,\n    \"vote_count\":116\n    }`\n    err := json.Unmarshal([]byte(str), &amp;movieData)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(movieData)\n}\n</code></pre>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8291, "favorite_count": 0, "accepted_answer_id": 38681007, "answer_count": 2, "score": 0, "last_activity_date": 1469942409, "creation_date": 1469940150, "question_id": 38680809, "link": "https://stackoverflow.com/questions/38680809/golang-cannot-unmarshal-number-into-go-value-of-type-string", "title": "Golang - Cannot unmarshal number into Go value of type string", "body": "<p>When trying to <code>json.Unmarshal</code> some JSON code from a website into a struct I created, I receive the following error: </p>\n\n<blockquote>\n  <p>cannot unmarshal number into Go value of type string</p>\n</blockquote>\n\n<p>Here is my code: <a href=\"https://play.golang.org/p/-5nphV9vPw\" rel=\"nofollow\">https://play.golang.org/p/-5nphV9vPw</a></p>\n"}, {"tags": ["github", "go"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6524310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9e013b26e63baf596764f5d4afae4f?s=128&d=identicon&r=PG&f=1", "display_name": "Grandzam", "link": "https://stackoverflow.com/users/6524310/grandzam"}, "edited": false, "score": 0, "creation_date": 1469927365, "post_id": 38679852, "comment_id": 64739407, "body": "Thanks! I&#39;m going to set up my project this way now."}], "tags": [], "owner": {"reputation": 3010, "user_id": 519557, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/x9V4f.jpg?s=128&g=1", "display_name": "jxstanford", "link": "https://stackoverflow.com/users/519557/jxstanford"}, "is_accepted": true, "score": 1, "last_activity_date": 1469928213, "last_edit_date": 1469928213, "creation_date": 1469926670, "answer_id": 38679852, "question_id": 38679645, "link": "https://stackoverflow.com/questions/38679645/setting-up-golang-to-work-with-python-in-github/38679852#38679852", "title": "Setting up golang to work with Python in GitHub", "body": "<p>I would recommend setting up an environment consistent with the recommendations in the \"<a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">Organizing your code</a>\" section of the language documentation.  </p>\n\n<p>First, choose a top level directory (I tend to use <code>~/devel</code>), and set the value of your GOPATH environment var to that location, and add the GOPATH/bin dir to your path.  Put it in your the appropriate session startup file (<code>~/.bash_profile</code> or similar).  In my case, I would put these lines in that file:</p>\n\n<pre><code>export GOPATH=$HOME/devel\nexport PATH=$GOPATH/bin:$PATH\n</code></pre>\n\n<p>Quoting from the documentation:</p>\n\n<p>To give you an idea of how a workspace looks in practice, here's an example:</p>\n\n<pre><code>bin/\n    hello                          # command executable\n    outyet                         # command executable\npkg/\n    linux_amd64/\n        github.com/golang/example/\n            stringutil.a           # package object\nsrc/\n    github.com/golang/example/\n        .git/                      # Git repository metadata\n    hello/\n        hello.go               # command source\n    outyet/\n        main.go                # command source\n        main_test.go           # test source\n    stringutil/\n        reverse.go             # package source\n        reverse_test.go        # test source\n    golang.org/x/image/\n        .git/                      # Git repository metadata\n    bmp/\n        reader.go              # package source\n        writer.go              # package source\n    ... (many more repositories and packages omitted) ...\n</code></pre>\n\n<p>Next, clone your git repo into the appropriate path under the $GOPATH/src tree.  In my case it would be <code>$GOPATH/src/github.com/user/repo</code>.</p>\n\n<p>Now you should be all set to work on both go and python code without much trouble.</p>\n"}], "owner": {"reputation": 3, "user_id": 6524310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9e013b26e63baf596764f5d4afae4f?s=128&d=identicon&r=PG&f=1", "display_name": "Grandzam", "link": "https://stackoverflow.com/users/6524310/grandzam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "accepted_answer_id": 38679852, "answer_count": 1, "score": 0, "last_activity_date": 1469928213, "creation_date": 1469923945, "question_id": 38679645, "link": "https://stackoverflow.com/questions/38679645/setting-up-golang-to-work-with-python-in-github", "title": "Setting up golang to work with Python in GitHub", "body": "<p>I have a GitHub repo with some python code and some text files. However, I want to add some Golang code to my project. </p>\n\n<p>So basically my issue is that I'm confused on where to set my GOPATH so I can work with Go source files in the same place that I work on python files. Do I set my GOPATH to my repo path, then setup the \\src\\github.com\\user\\ directory and put my Go code there? Do I put Grandzam where user is, or leave it alone because someone else is working with me on the repo?</p>\n\n<p><a href=\"https://golang.org/doc/install\" rel=\"nofollow\">https://golang.org/doc/install</a> Test your installation is what I am confused about.</p>\n"}, {"tags": ["linux", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1469920162, "post_id": 38679294, "comment_id": 64738145, "body": "This is not supported. You will have to mount the file system and set the <code>GOPATH</code> to that mounted path. (Additionally, your file browser may have already mounted the share just be you browsing to it. Check <code>mount</code> for anything interesting)."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1470250366, "post_id": 38680521, "comment_id": 64876865, "body": "I get &quot;smbmount: command not found&quot;. If I try to install smbmount I get &quot;Unable to locate package&quot;. I am using Linux Mint (Ubuntu)."}], "tags": [], "owner": {"reputation": 236, "user_id": 6567843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dFx3D.jpg?s=128&g=1", "display_name": "Josh Benson", "link": "https://stackoverflow.com/users/6567843/josh-benson"}, "is_accepted": false, "score": 0, "last_activity_date": 1469936201, "creation_date": 1469936201, "answer_id": 38680521, "question_id": 38679294, "link": "https://stackoverflow.com/questions/38679294/how-do-i-use-a-samba-server-location-for-gopath/38680521#38680521", "title": "How do I use a Samba server location for GOPATH?", "body": "<p>You need to mount the Samba share to a folder on your machine:</p>\n\n<pre><code>$ mkdir /mnt/samba\n$ smbmount smb://path/to/share /mnt/samba\n</code></pre>\n\n<p>Of course you may need to use switches on the <code>smbmount</code> command to provide username, password, workgroup, etc., depending on the configuration of the Samba share you're trying to access.  Once you've mounted the share you can then do</p>\n\n<p><code>$ export GOPATH=/mnt/samba</code></p>\n\n<p>And as far as Go is concerned the files in the Samba share will be located on your local machine.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1470252664, "post_id": 38680558, "comment_id": 64878193, "body": "smbmount is deprecated."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1470253255, "post_id": 38680558, "comment_id": 64878535, "body": "@kristen : use mount  instead ( see ref )"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 1, "last_activity_date": 1470252993, "last_edit_date": 1492086159, "creation_date": 1469936625, "answer_id": 38680558, "question_id": 38679294, "link": "https://stackoverflow.com/questions/38679294/how-do-i-use-a-samba-server-location-for-gopath/38680558#38680558", "title": "How do I use a Samba server location for GOPATH?", "body": "<p>there is only one solution for this:<br>\nMap ( mount) a Samba server file path as a Local Disk Drive ( local path), \nthen set <code>GOPATH</code> to this local path:   </p>\n\n<p>Mounting SMB share on local folder by using smbmount command (smbmount is deprecated):  </p>\n\n<pre><code>smbmount //ipadd/sharename /mountpoint \u2013o  username=userid,workgroup=workgroupname\n</code></pre>\n\n<p>Example :</p>\n\n<pre><code>smbmount //192.168.0.1/share1 /mnt \u2013o username=steev,workgroup=test\n</code></pre>\n\n<p>Mounting SMB share by using mount command</p>\n\n<pre><code>mount \u2013t smbfs ipadd:/sharename /mountpoint \u2013o username=userid,workgroup=workgroupname\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>mount \u2013t smbfs //ipadd/sharename /mountpoint \u2013o username=userid,workgroup=workgroupname\n</code></pre>\n\n<p>Example :</p>\n\n<pre><code>mount \u2013t smbfs 192.168.0.1:/share1 /mnt \u2013o username=surendra,workgroup=test\n</code></pre>\n\n<p>ref:<br>\n<a href=\"http://www.linuxnix.com/8-ways-to-mount-smbfs-samba-file-system-in-linux/\" rel=\"nofollow noreferrer\">http://www.linuxnix.com/8-ways-to-mount-smbfs-samba-file-system-in-linux/</a>  </p>\n\n<p><a href=\"https://askubuntu.com/questions/232998/how-do-i-install-smbmount\">https://askubuntu.com/questions/232998/how-do-i-install-smbmount</a>\n<a href=\"http://www.howtogeek.com/116309/use-ubuntus-public-folder-to-easily-share-files-between-computers/\" rel=\"nofollow noreferrer\">http://www.howtogeek.com/116309/use-ubuntus-public-folder-to-easily-share-files-between-computers/</a><br>\nand for Windows:  <a href=\"https://serverfault.com/questions/6079/how-can-i-mount-an-ftp-to-a-drive-letter-in-windows\">https://serverfault.com/questions/6079/how-can-i-mount-an-ftp-to-a-drive-letter-in-windows</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 38680558, "answer_count": 2, "score": 1, "last_activity_date": 1470252993, "creation_date": 1469919847, "question_id": 38679294, "link": "https://stackoverflow.com/questions/38679294/how-do-i-use-a-samba-server-location-for-gopath", "title": "How do I use a Samba server location for GOPATH?", "body": "<p>I am trying to set my GOPATH to a shared network folder. When I enter </p>\n\n<pre><code>export GOPATH=smb://path/to/shared/folder\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>go: GOPATH entry is relative; must be absolute path: \"smb\".\nRun 'go help gopath' for usage.\n</code></pre>\n\n<p>I've also tried to prefix the path w/ \"/\" but then it tries to make a folder in root.</p>\n\n<p>thx!</p>\n"}, {"tags": ["go", "resources", "relative-path"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 2, "creation_date": 1469926520, "post_id": 38679191, "comment_id": 64739276, "body": "Consider embedding the email template file directly into your binary: see <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">github.com/jteeuwen/go-bindata</a>"}, {"owner": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "edited": false, "score": 2, "creation_date": 1469928837, "post_id": 38679191, "comment_id": 64739618, "body": "Inlining resources is IMHO the best way to go when you develop a Go library. This way, resources are totally transparent. Embeding the template into the binary will directly impact those who use your library and need to compile it."}], "answers": [{"tags": [], "owner": {"reputation": 23028, "user_id": 107156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mSIVv.jpg?s=128&g=1", "display_name": "Kyle Brandt", "link": "https://stackoverflow.com/users/107156/kyle-brandt"}, "is_accepted": true, "score": 2, "last_activity_date": 1469970235, "creation_date": 1469970235, "answer_id": 38684257, "question_id": 38679191, "link": "https://stackoverflow.com/questions/38679191/distributing-resources-with-golang/38684257#38684257", "title": "Distributing resources with golang", "body": "<p>The most common technique is to embed the resources so all you have to do is distribute the binary.</p>\n\n<p><a href=\"https://github.com/avelino/awesome-go#resource-embedding\" rel=\"nofollow\">This list</a> of Go libraries has a list of libraries that do resource embedding:</p>\n\n<blockquote>\n  <ul>\n  <li><a href=\"https://github.com/mjibson/esc\" rel=\"nofollow\">esc</a> - Embeds files into Go programs and provides http.FileSystem interfaces to them.</li>\n  <li><a href=\"https://github.com/UnnoTed/fileb0x\" rel=\"nofollow\">fileb0x</a> - Simple tool to embed files in go with focus on \"customization\" and ease to use.</li>\n  <li><a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow\">go-bindata</a> - Package that converts any file into managable Go source code.</li>\n  <li><a href=\"https://github.com/pyros2097/go-embed\" rel=\"nofollow\">go-embed</a> - Generates go code to embed resource files into your library or executable</li>\n  <li><a href=\"https://github.com/omeid/go-resources\" rel=\"nofollow\">go-resources</a> - Unfancy resources embedding with Go.</li>\n  <li><a href=\"https://github.com/GeertJohan/go.rice\" rel=\"nofollow\">go.rice</a> - go.rice is a Go package that makes working with resources such as html,js,css,images\n  and templates very easy.</li>\n  <li><a href=\"https://github.com/go-playground/statics\" rel=\"nofollow\">statics</a> - Embeds static resources into go files for single binary compilation + works with\n  http.FileSystem + symlinks.</li>\n  <li><a href=\"https://github.com/shurcooL/vfsgen\" rel=\"nofollow\">vfsgen</a> - Generates a vfsdata.go file that statically implements the given virtual\n  filesystem.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 94522, "user_id": 7595, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/99108829176dfbbc5d0bf3c041542a26?s=128&d=identicon&r=PG", "display_name": "Pablo Fernandez", "link": "https://stackoverflow.com/users/7595/pablo-fernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 38684257, "answer_count": 1, "score": 1, "last_activity_date": 1469970235, "creation_date": 1469919015, "question_id": 38679191, "link": "https://stackoverflow.com/questions/38679191/distributing-resources-with-golang", "title": "Distributing resources with golang", "body": "<p>I'm developing a library that contains a resource file, specifically an email template. The file is on <code>&lt;project_root&gt;/templates/email.html</code>.</p>\n\n<p>I'm having a hard time referencing this file from the <code>.go</code> sources, since it's hard to resolve a relative path. So far the options I found are:</p>\n\n<ul>\n<li><p>use <code>$GOPATH</code>: this comes with the issue that some dependency managemente tools may redefine <code>$GOPATH</code> and break</p></li>\n<li><p>use a custom env variable: works but it forces the user of the lib to add the variable.</p></li>\n<li><p>inline the template on a string: it's ugly.</p></li>\n</ul>\n\n<p>Does anyone have a better alternative? I'd rather not use 3rd party libs just for this but if you know one feel free to point it out so I can read the sources and see how they do it.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "websocket", "notifications", "beego"], "owner": {"reputation": 31, "user_id": 6639030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad7e053cab43626ddbd8e2ce7e55a332?s=128&d=identicon&r=PG&f=1", "display_name": "Sinojin", "link": "https://stackoverflow.com/users/6639030/sinojin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1469913755, "creation_date": 1469913755, "question_id": 38678620, "link": "https://stackoverflow.com/questions/38678620/how-to-make-notification-system-like-notification-in-facebook-in-go", "title": "How to make Notification system like notification in Facebook in Go", "body": "<p>I want to make notification system in my project which is has chat module.To be more specific, when I send message receiver receive notification. I have already made notification system and its working. My problem is that when user open second tab my notification system doesn't work fluently.</p>\n\n<p>There is my code </p>\n\n<pre><code>func GetNotification(w http.ResponseWriter, r *http.Request,id ,timestamp int) {\n    LastMessageTime := -1\n    conn, err := upgrader.Upgrade(w, r, nil)\n\n    if err != nil {\n        beego.Error(err)\n        return\n}\n\n\nwakeupNotification(id)\n\nfor {\n    select {\n\n    case notificationTime := &lt;-MessageNotification[strconv.Itoa(id)] :\n\n        if notificationTime &gt; LastMessageTime {\n            LastMessageTime = notificationTime\n\n        //MessageNotification[strconv.Itoa(id)] &lt;-notificationTime\n\n        chat_services,err := models.GetChatsNotifications(id,timestamp)\n\n        if err != nil{\n            return\n        }\n\n        not := notification{Status:true,MessageList:chat_services}\n\n        conn.WriteJSON(not)\n        }\n    }\n}\n\n\n}\n\n\nfunc SetNotification(id int,timeStamp int){\n    go func(){\n        wakeupNotification(id)\n        MessageNotification[strconv.Itoa(id)] &lt;- timeStamp\n\n    }()\n}\n\nfunc wakeupNotification(id int){\n    _,ok := MessageNotification[strconv.Itoa(id)]\n    if !ok {\n        MessageNotification[strconv.Itoa(id)] = make(chan int)\n    }\n}\n\nfunc SleptNotification(id int){\n    wakeupNotification(id)\n    &lt;-MessageNotification[strconv.Itoa(id)]\n}\n</code></pre>\n\n<p>Also i have  controller to trigger</p>\n\n<pre><code>    func (c *ChatController) Notification() {\n\n    chat.GetNotification(c.Ctx.ResponseWriter,c.Ctx.Request,1,1)\n}\n\n\nfunc (c *ChatController) DeleteNotification(){\n\n    chat.SleptNotification(1)\n\n    c.Data[\"json\"] = \"readed\"\n    c.ServeJSON();\n\n\n}\n\nfunc (c *ChatController) Websocket(){\n\n    //odalari olusturup mesajlasma bolumu yapilacak\n    chat.SetNotification(1,int(time.Now().Unix()))\n\n    c.Data[\"json\"] = \"test to trigger chan\"\n    c.ServeJSON();\n\n}\n</code></pre>\n\n<p>My problem is <code>notificationTime := &lt;-MessageNotification[strconv.Itoa(id)]</code> work one time and don't work again.So code never triggered again in browser second tab.\nDo you have any idea ?</p>\n\n<p>Code work fluently.\nSorry for English.\nThanks for your help.</p>\n"}, {"tags": ["regex", "go", "escaping", "backslash"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1469910658, "post_id": 38677976, "comment_id": 64736032, "body": "The issue here is that in case you have <code>\\\\*test*</code> the approach won&#39;t work. You should write a parser for this task, do not use regexps."}], "answers": [{"comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1469910841, "post_id": 38678201, "comment_id": 64736084, "body": "This regex won&#39;t match <code>\\\\*test*</code>  while this <code>test</code> appears in between valid <code>*</code> delimiters. One cannot rely on 1-regex solution when parsing strings with escape sequences."}, {"owner": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1469910936, "post_id": 38678201, "comment_id": 64736108, "body": "Why should it match <code>\\\\*test*</code>? @WiktorStribi\u017cew"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1469910977, "post_id": 38678201, "comment_id": 64736116, "body": "Because <code>\\\\</code> is a literal <code>\\</code>, and then comes <code>*test*</code> that should be matched."}, {"owner": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1469911116, "post_id": 38678201, "comment_id": 64736150, "body": "Let poster go further for additional information about entries. @WiktorStribi\u017cew"}, {"owner": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "edited": false, "score": 0, "creation_date": 1469911729, "post_id": 38678201, "comment_id": 64736292, "body": "Thank you for the answer. I think I&#39;ll be writing a parser for this then..."}, {"owner": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "reply_to_user": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "edited": false, "score": 0, "creation_date": 1469911839, "post_id": 38678201, "comment_id": 64736319, "body": "I don&#39;t think a parser is essential for this specific task. Based on Wiktor comments I just updated my answer. @altermetax"}], "tags": [], "owner": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "is_accepted": true, "score": 0, "last_activity_date": 1469911566, "last_edit_date": 1469911566, "creation_date": 1469910521, "answer_id": 38678201, "question_id": 38677976, "link": "https://stackoverflow.com/questions/38677976/regex-in-golang-how-to-set-character-that-makes-the-string-not-match/38678201#38678201", "title": "Regex in Golang: How to set character that makes the string not match?", "body": "<p><strong><em>Updated</em></strong></p>\n\n<p>Go does not support lookbehinds. So a workaround can be:</p>\n\n<pre><code>(?:\\A|(?:[^\\\\]+|\\A)(\\\\{2})+|[^\\\\])\\*([^\\\\*]+)\\*\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 38678201, "answer_count": 1, "score": 0, "last_activity_date": 1469911566, "creation_date": 1469908788, "question_id": 38677976, "link": "https://stackoverflow.com/questions/38677976/regex-in-golang-how-to-set-character-that-makes-the-string-not-match", "title": "Regex in Golang: How to set character that makes the string not match?", "body": "<p>I am a noob about regular expressions (sorry).\nI was trying to make a very simple markup language that matches bold and italic and then converts them to HTML.\nHere is an example for bold that I'm using:</p>\n\n<pre><code>var bold = regexp.MustCompile(\"\\\\*([^\\\\*]+)\\\\*\")\n</code></pre>\n\n<p>It matches everything between two asterisks. Now, I'd like it to match <code>*test*</code> but not <code>\\*test*</code>. Since I don't know much about regular expressions but I'm trying to make this experiment, I'd like to know what's the way for that. I searched everywhere but couldn't find the way to make this work.</p>\n"}, {"tags": ["go", "byte"], "answers": [{"comments": [{"owner": {"reputation": 4542, "user_id": 2313300, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/640f5de3cd3b6344d176363edb93030a?s=128&d=identicon&r=PG", "display_name": "tt9", "link": "https://stackoverflow.com/users/2313300/tt9"}, "edited": false, "score": 0, "creation_date": 1469891205, "post_id": 38675358, "comment_id": 64730445, "body": "perfect, I was missing the cast to uint16. Thanks!"}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": false, "score": 6, "last_activity_date": 1469891268, "last_edit_date": 1469891268, "creation_date": 1469891164, "answer_id": 38675358, "question_id": 38675266, "link": "https://stackoverflow.com/questions/38675266/go-convert-2-byte-array-into-a-uint16-value/38675358#38675358", "title": "Go - Convert 2 byte array into a uint16 value", "body": "<p>To combine two bytes into uint16</p>\n\n<pre><code>x := uint16(numBytes[i])&lt;&lt;8 | uint16(numBytes[i+1])\n</code></pre>\n\n<p>where <code>i</code> is the starting position of the uint16. So if your array is always only two items it would be <code>x := uint16(numBytes[0])&lt;&lt;8 | uint16(numBytes[1])</code></p>\n"}, {"tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 1, "last_activity_date": 1469895296, "last_edit_date": 1469895296, "creation_date": 1469891207, "answer_id": 38675363, "question_id": 38675266, "link": "https://stackoverflow.com/questions/38675266/go-convert-2-byte-array-into-a-uint16-value/38675363#38675363", "title": "Go - Convert 2 byte array into a uint16 value", "body": "<p>Firstly you have a slice not an array - an array has a fixed size and would be declared like this <code>[2]byte</code>.</p>\n\n<p>If you just have a 2 bytes slice, I wouldn't do anything fancy, I'd just do</p>\n\n<pre><code>numBytes := []byte{0xFF, 0x10}\nn := int(numBytes[0])&lt;&lt;8 + int(numBytes[1])\nfmt.Printf(\"n =0x%04X = %d\\n\", n, n)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/iH-T788xv-\" rel=\"nofollow\">Playground</a></p>\n\n<p><strong>EDIT</strong>: Just noticed you wanted <code>uint16</code> - replace <code>int</code> with that in the above!</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 8, "last_activity_date": 1469894397, "creation_date": 1469894397, "answer_id": 38675831, "question_id": 38675266, "link": "https://stackoverflow.com/questions/38675266/go-convert-2-byte-array-into-a-uint16-value/38675831#38675831", "title": "Go - Convert 2 byte array into a uint16 value", "body": "<p>you may use <code>binary.BigEndian.Uint16(numBytes)</code><br>\nlike this working sample code (with commented output):  </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n    \"fmt\"\n)\n\nfunc main() {\n    numBytes := []byte{0xFF, 0x10}\n    u := binary.BigEndian.Uint16(numBytes)\n    fmt.Printf(\"%#X %[1]v\\n\", u) // 0XFF10 65296\n}\n</code></pre>\n\n<p>and see inside <code>binary.BigEndian.Uint16(b []byte)</code>:  </p>\n\n<pre><code>func (bigEndian) Uint16(b []byte) uint16 {\n    _ = b[1] // bounds check hint to compiler; see golang.org/issue/14808\n    return uint16(b[1]) | uint16(b[0])&lt;&lt;8\n}\n</code></pre>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 4542, "user_id": 2313300, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/640f5de3cd3b6344d176363edb93030a?s=128&d=identicon&r=PG", "display_name": "tt9", "link": "https://stackoverflow.com/users/2313300/tt9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4481, "favorite_count": 0, "accepted_answer_id": 38675831, "answer_count": 3, "score": 7, "last_activity_date": 1469895296, "creation_date": 1469890581, "last_edit_date": 1469895091, "question_id": 38675266, "link": "https://stackoverflow.com/questions/38675266/go-convert-2-byte-array-into-a-uint16-value", "title": "Go - Convert 2 byte array into a uint16 value", "body": "<p>If I have a slice of bytes in Go, similar to this:</p>\n\n<pre><code>numBytes := []byte { 0xFF, 0x10 }\n</code></pre>\n\n<p>How would I convert it to it's <code>uint16</code> value (0xFF10, 65296)?</p>\n"}, {"tags": ["networking", "go", "synchronization"], "answers": [{"comments": [{"owner": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "edited": false, "score": 0, "creation_date": 1469886397, "post_id": 38674615, "comment_id": 64729028, "body": "this solves only serialization aspect of the task, I&#39;m checking is there anything that could handle the whole way of serializing, passing over network, deserializing"}, {"owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "reply_to_user": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "edited": false, "score": 1, "creation_date": 1469886524, "post_id": 38674615, "comment_id": 64729068, "body": "net/rpc it&#39;s that you want?"}, {"owner": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "edited": false, "score": 0, "creation_date": 1469886619, "post_id": 38674615, "comment_id": 64729095, "body": "this might be closer hit =) With some glue code for detecting changes in slices &amp;&amp; maps it could solve the task I guess"}, {"owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "reply_to_user": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "edited": false, "score": 0, "creation_date": 1469886950, "post_id": 38674615, "comment_id": 64729178, "body": "use only some function to modify slice/maps, those functions should also notify the changes of slice/map."}], "tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": false, "score": 0, "last_activity_date": 1469886310, "creation_date": 1469886310, "answer_id": 38674615, "question_id": 38674558, "link": "https://stackoverflow.com/questions/38674558/golang-array-and-map-synchronization-over-network/38674615#38674615", "title": "Golang array and map synchronization over network", "body": "<p>package encoding/gob maybe helpful if only for golang</p>\n"}], "owner": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469886316, "creation_date": 1469885973, "last_edit_date": 1469886316, "question_id": 38674558, "link": "https://stackoverflow.com/questions/38674558/golang-array-and-map-synchronization-over-network", "title": "Golang array and map synchronization over network", "body": "<p>I have a need to synchronize an internal state of 2 programs(client &amp;&amp; server) over the persistent network connection.</p>\n\n<p>The first idea was to implement a custom protocol for this, is there any alternatives you can think of? Any libraries that could help in the process?</p>\n\n<p>Internal state consists of a lot of maps and slices, when some structure inside slice/map changes it would be okay to pass it as a whole</p>\n"}, {"tags": ["networking", "go"], "answers": [{"comments": [{"owner": {"reputation": 2400, "user_id": 329869, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/74d391366ef8f8ee3ba207943a9f014d?s=128&d=identicon&r=PG", "display_name": "Tibor Szasz", "link": "https://stackoverflow.com/users/329869/tibor-szasz"}, "edited": false, "score": 1, "creation_date": 1469880962, "post_id": 38673698, "comment_id": 64727636, "body": "Thanks. Do you have any suggestion how could I have figured it out on my own? How does string() do that? Why can&#39;t I see it with reflect.TypeOf?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 2400, "user_id": 329869, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/74d391366ef8f8ee3ba207943a9f014d?s=128&d=identicon&r=PG", "display_name": "Tibor Szasz", "link": "https://stackoverflow.com/users/329869/tibor-szasz"}, "edited": false, "score": 1, "creation_date": 1469881111, "post_id": 38673698, "comment_id": 64727682, "body": "@TiborSzasz It is a simple conversion: see <a href=\"https://blog.golang.org/slices#TOC_12\" rel=\"nofollow noreferrer\">blog.golang.org/slices#TOC_12</a>."}, {"owner": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "edited": false, "score": 0, "creation_date": 1509497054, "post_id": 38673698, "comment_id": 81040437, "body": "A small improvement to your code would be to use <code>http.StatusOK</code> instead of the raw <code>200</code> value!"}, {"owner": {"reputation": 6202, "user_id": 1066615, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iv68W.png?s=128&g=1", "display_name": "sixty4bit", "link": "https://stackoverflow.com/users/1066615/sixty4bit"}, "edited": false, "score": 0, "creation_date": 1524759252, "post_id": 38673698, "comment_id": 87111453, "body": "I&#39;ve been doing this and finding that my request bodies always have a newline char at the end. Is this normal for a request body or is that cauased by <code>ioutil.ReadAll()</code>??"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 260, "last_activity_date": 1556296019, "last_edit_date": 1556296019, "creation_date": 1469880050, "answer_id": 38673698, "question_id": 38673673, "link": "https://stackoverflow.com/questions/38673673/access-http-response-as-string-in-go/38673698#38673698", "title": "Access HTTP response as string in Go", "body": "<p><code>bs := string(body)</code> should be enough to give you a string.</p>\n\n<p>From there, you can use it as a regular string.</p>\n\n<p>A bit as <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/Zdo8YVYz08k\" rel=\"noreferrer\">in this thread</a>:</p>\n\n<pre><code>var client http.Client\nresp, err := client.Get(url)\nif err != nil {\n    log.Fatal(err)\n}\ndefer resp.Body.Close()\n\nif resp.StatusCode == http.StatusOK {\n    bodyBytes, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    bodyString := string(bodyBytes)\n    log.Info(bodyString)\n}\n</code></pre>\n\n<p>See also <a href=\"http://dlintw.github.io/gobyexample/public/http-client.html\" rel=\"noreferrer\">GoByExample</a>.</p>\n\n<p>As commented below (and in <a href=\"https://stackoverflow.com/users/3435777/zzn\">zzn</a>'s <a href=\"https://stackoverflow.com/a/38674536/6309\">answer</a>), this is a <strong><a href=\"https://blog.golang.org/slices#TOC_12\" rel=\"noreferrer\">conversion</a></strong> (see <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">spec</a>).<br>\nSee \"<a href=\"https://stackoverflow.com/a/14373714/6309\">How expensive is <code>[]byte(string)</code>?</a>\" (reverse problem, but the same conclusion apply) where <a href=\"https://stackoverflow.com/users/1065241/zzzz\">zzzz</a> mentioned:</p>\n\n<blockquote>\n  <p>Some conversions are the same as a cast, like <code>uint(myIntvar)</code>, which just reinterprets the bits in place. </p>\n</blockquote>\n\n<p><a href=\"https://stackoverflow.com/users/620399/sonia\">Sonia</a> adds:</p>\n\n<blockquote>\n  <p>Making a string out of a byte slice, definitely involves allocating the string on the heap. The immutability property forces this.<br>\n  Sometimes you can optimize by doing as much work as possible with []byte and then creating a string at the end. The <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"noreferrer\"><code>bytes.Buffer</code></a> type is often useful.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1547, "user_id": 2969841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ABgFw.jpg?s=128&g=1", "display_name": "tsabsch", "link": "https://stackoverflow.com/users/2969841/tsabsch"}, "is_accepted": false, "score": 40, "last_activity_date": 1469880433, "creation_date": 1469880433, "answer_id": 38673765, "question_id": 38673673, "link": "https://stackoverflow.com/questions/38673673/access-http-response-as-string-in-go/38673765#38673765", "title": "Access HTTP response as string in Go", "body": "<p>The method you're using to read the http body response returns a byte slice:</p>\n\n<pre><code>func ReadAll(r io.Reader) ([]byte, error)\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/io/ioutil/#ReadAll\" rel=\"noreferrer\">official documentation</a></p>\n\n<p>You can convert <code>[]byte</code> to a string by using</p>\n\n<pre><code>body, err := ioutil.ReadAll(resp.Body)\nbodyString := string(body)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": false, "score": 1, "last_activity_date": 1469885827, "creation_date": 1469885827, "answer_id": 38674536, "question_id": 38673673, "link": "https://stackoverflow.com/questions/38673673/access-http-response-as-string-in-go/38674536#38674536", "title": "Access HTTP response as string in Go", "body": "<p>string(byteslice) will convert byte slice to string, just know that it's not only simply type conversion, but also memory copy.</p>\n"}], "owner": {"reputation": 2400, "user_id": 329869, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/74d391366ef8f8ee3ba207943a9f014d?s=128&d=identicon&r=PG", "display_name": "Tibor Szasz", "link": "https://stackoverflow.com/users/329869/tibor-szasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187875, "favorite_count": 27, "accepted_answer_id": 38673698, "answer_count": 3, "score": 161, "last_activity_date": 1556296019, "creation_date": 1469879898, "question_id": 38673673, "link": "https://stackoverflow.com/questions/38673673/access-http-response-as-string-in-go", "title": "Access HTTP response as string in Go", "body": "<p>I'd like to parse the response of a web request, but I'm getting trouble accessing it as string. </p>\n\n<pre><code>func main() {\n    resp, err := http.Get(\"http://google.hu/\")\n    if err != nil {\n        // handle error\n    }\n    defer resp.Body.Close()\n    body, err := ioutil.ReadAll(resp.Body)\n\n    ioutil.WriteFile(\"dump\", body, 0600)\n\n    for i:= 0; i &lt; len(body); i++ {\n        fmt.Println( body[i] ) // This logs uint8 and prints numbers\n    }\n\n    fmt.Println( reflect.TypeOf(body) )\n    fmt.Println(\"done\")\n}\n</code></pre>\n\n<p>How can I access the response as string? <code>ioutil.WriteFile</code> writes correctly the response to a file. </p>\n\n<p>I've already checked the package reference but it's not really helpful.</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "reply_to_user": {"reputation": 1237, "user_id": 4490615, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-AahyD50_HmQ/AAAAAAAAAAI/AAAAAAAAAVA/c8BqLWE3IQk/photo.jpg?sz=128", "display_name": "JSNoob", "link": "https://stackoverflow.com/users/4490615/jsnoob"}, "edited": false, "score": 2, "creation_date": 1469873946, "post_id": 38672694, "comment_id": 64725776, "body": "@JSNoob Notice they&#39;re backticks, not single quotes. &#39; is different from `"}, {"owner": {"reputation": 1237, "user_id": 4490615, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-AahyD50_HmQ/AAAAAAAAAAI/AAAAAAAAAVA/c8BqLWE3IQk/photo.jpg?sz=128", "display_name": "JSNoob", "link": "https://stackoverflow.com/users/4490615/jsnoob"}, "edited": false, "score": 0, "creation_date": 1469874118, "post_id": 38672694, "comment_id": 64725834, "body": "OMG I&#39;d never notice that difference. Really saved my day : )"}], "tags": [], "owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "is_accepted": true, "score": 5, "last_activity_date": 1469873298, "creation_date": 1469873298, "answer_id": 38672694, "question_id": 38672663, "link": "https://stackoverflow.com/questions/38672663/parse-json-with-field-name-containing-underscore/38672694#38672694", "title": "Parse JSON with field name containing underscore", "body": "<p>Does this work:</p>\n\n<pre><code>type Result struct {\n  Name string\n  Age int\n  Originalname string `json:\"Original_Name\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 1237, "user_id": 4490615, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-AahyD50_HmQ/AAAAAAAAAAI/AAAAAAAAAVA/c8BqLWE3IQk/photo.jpg?sz=128", "display_name": "JSNoob", "link": "https://stackoverflow.com/users/4490615/jsnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 38672694, "answer_count": 1, "score": 1, "last_activity_date": 1469874139, "creation_date": 1469873070, "last_edit_date": 1469874139, "question_id": 38672663, "link": "https://stackoverflow.com/questions/38672663/parse-json-with-field-name-containing-underscore", "title": "Parse JSON with field name containing underscore", "body": "<p>So I have JSON like this</p>\n\n<pre><code>{\"Name\":\"Jame\",\"Age\":6,\"Original_Name\":\"Jameson\"}\n</code></pre>\n\n<p>In order to get \"Name\" and \"Age\" in Go, I just need to use a corresponding struct</p>\n\n<pre><code>type Result struct {\n  Name string\n  Age int\n}\n</code></pre>\n\n<p>But how do I get the field \"Original_Name\" since I cannot use underscore in go?</p>\n"}, {"tags": ["pointers", "go", "pass-by-reference"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1469848383, "post_id": 38669971, "comment_id": 64720796, "body": "If the variables are exported (i.e., begin with an uppercase letter), you can access them from any package by qualifying with the package name. Since you&#39;re talking about &quot;wrapping the pointers into two packages&quot;, does that mean that they aren&#39;t in separate packages now? Can you explain more about how your code is organized?"}, {"owner": {"reputation": 3199, "user_id": 2828227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CEPMO.jpg?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/2828227/casper"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1469849579, "post_id": 38669971, "comment_id": 64720930, "body": "Thank you for your comment. I have updated my post."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1469884122, "post_id": 38669971, "comment_id": 64728451, "body": "i prefer to explicitly pass dependencies across the package boundary into a constructor function. i&#39;m actually right now refactoring a project from method 1 to method 2, <a href=\"https://github.com/namely/broadway/pull/121/files#diff-1427b112aa72f64adcf839007e954d56R18\" rel=\"nofollow noreferrer\">here&#39;s my wip</a> where I define a shared <code>cfg.Type</code> and pass it from my cmd package to server package"}], "answers": [{"comments": [{"owner": {"reputation": 3199, "user_id": 2828227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CEPMO.jpg?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/2828227/casper"}, "edited": false, "score": 0, "creation_date": 1469874383, "post_id": 38672052, "comment_id": 64725920, "body": "This method seems like in javascript. We can create and assign a value to a package externally. Right?"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "reply_to_user": {"reputation": 3199, "user_id": 2828227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CEPMO.jpg?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/2828227/casper"}, "edited": false, "score": 0, "creation_date": 1469883244, "post_id": 38672052, "comment_id": 64728241, "body": "Yes and no. You can not create a variable, but you can assign a value to it. Another possibility would be to pass a variable to all functions of your package."}, {"owner": {"reputation": 3199, "user_id": 2828227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CEPMO.jpg?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/2828227/casper"}, "edited": false, "score": 0, "creation_date": 1469883399, "post_id": 38672052, "comment_id": 64728281, "body": "Pass a variable to all functions by &quot;args&quot;?"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "reply_to_user": {"reputation": 3199, "user_id": 2828227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CEPMO.jpg?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/2828227/casper"}, "edited": false, "score": 0, "creation_date": 1469884133, "post_id": 38672052, "comment_id": 64728452, "body": "Yes. Would be the functional way. If you need a db reference inside of a function, why should you not pass the reference with one argument? Easier to test easier to understand, specially if your package is huge."}], "tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": true, "score": 2, "last_activity_date": 1469868296, "creation_date": 1469868296, "answer_id": 38672052, "question_id": 38669971, "link": "https://stackoverflow.com/questions/38669971/how-to-pass-service-pointers-from-one-package-to-another-package-in-go/38672052#38672052", "title": "How to pass service pointers from one package to another package in Go?", "body": "<p>This is the concept which should work.</p>\n\n<p>Inside the package you should declare a variable, which is exported. This variable has to be a pointer.</p>\n\n<pre><code>var myVar = 3\nvar MyPointer = &amp;myVar\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/EQDwGF7pjv\" rel=\"nofollow\">https://play.golang.org/p/EQDwGF7pjv</a></p>\n\n<p>From your main package you can set the pointer to your \"global\" db or session adress.</p>\n\n<pre><code>mypackage.MyPointer = dbPointer\n</code></pre>\n\n<p>Then the pointer inside your package points to your dbPointer. I think this is a good way to pass a pointer into other packages.</p>\n"}], "owner": {"reputation": 3199, "user_id": 2828227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CEPMO.jpg?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/2828227/casper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1138, "favorite_count": 1, "accepted_answer_id": 38672052, "answer_count": 1, "score": 2, "last_activity_date": 1469885687, "creation_date": 1469847727, "last_edit_date": 1469885687, "question_id": 38669971, "link": "https://stackoverflow.com/questions/38669971/how-to-pass-service-pointers-from-one-package-to-another-package-in-go", "title": "How to pass service pointers from one package to another package in Go?", "body": "<p>I separated different <code>http.HandleFunc</code> in different files according to which page they are related to. I use <code>gorilla/sessions</code> to manage client sessions and user authentication and I use <code>go-sql-driver</code> for accessing a MySQL database. </p>\n\n<p>Project Layout:</p>\n\n<pre><code>&lt;PROJECT ROOT&gt;\n   -&gt; &lt;cliend&gt;                     // This folder containing html, css, and js\n   -&gt; &lt;pagehndler&gt;\n         -&gt; &lt;index&gt;\n                -&gt; index.go        // Need to access database and session \n         -&gt; &lt;projbrwsr&gt;\n                -&gt; projbrwsr.go    // Need to access database and session\n   -&gt; main.go\n</code></pre>\n\n<p>Therefore, I have 1 pointer pointing to the <code>go-sql-driver</code> service</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"user:password@/dbname\")\n</code></pre>\n\n<p>and 1 pointer pointing to <code>gorilla/sessions</code> service</p>\n\n<pre><code>var store = sessions.NewCookieStore([]byte(\"something-very-secret\"))\n</code></pre>\n\n<p>There are 2 methods to pass the two pointers to other packages in my understanding: </p>\n\n<ol>\n<li><p>Wrap the two pointers into two packages (<code>sess</code>, <code>db</code>) and make them exported. And, the package that requires the service needed to import the packages (<code>sess</code>, <code>db</code>). And call the exported pointers.</p>\n\n<pre><code>&lt;PROJECT ROOT&gt;\n   -&gt; &lt;cliend&gt;                     // This folder containing html, css, and js\n   -&gt; &lt;pagehndler&gt;\n         -&gt; &lt;index&gt;\n                -&gt; index.go        // Need to access database and session \n         -&gt; &lt;projbrwsr&gt;\n                -&gt; projbrwsr.go    // Need to access database and session\n   -&gt; &lt;service&gt;\n          -&gt; sess.go               // Storing the database service pointer\n          -&gt; db.go                 // Storing the session service pointer\n   -&gt; main.go\n</code></pre></li>\n<li><p>Initialize the two pointers in main package and pass them to the another package, that contain the page handle functions, as args. Inside the another package, set the args to a local variable so we can call it locally in the another package.</p>\n\n<pre><code> &lt;PROJECT ROOT&gt;\n    -&gt; &lt;cliend&gt;                     // This folder containing html, css, and js\n    -&gt; &lt;pagehndler&gt;\n          -&gt; &lt;index&gt;\n                 -&gt; index.go        // Need to access database and session\n                                    // Containing a func newService(db *DB)\n          -&gt; &lt;projbrwsr&gt;\n                 -&gt; projbrwsr.go    // Need to access database and session\n                                    // Containing a func newService(sess *CookieStore)\n    -&gt; main.go\n</code></pre></li>\n</ol>\n\n<p>What is the best way to pass this two pointers to other packages for other handle function to call them?</p>\n"}, {"tags": ["git", "go", "bitbucket"], "comments": [{"owner": {"reputation": 97, "user_id": 4818508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GQx9e.jpg?s=128&g=1", "display_name": "Cedric", "link": "https://stackoverflow.com/users/4818508/cedric"}, "edited": false, "score": 0, "creation_date": 1530623611, "post_id": 38668444, "comment_id": 89294384, "body": "you are using <i>pipelines</i> from BitBucket right? same problem I added an SSH key pair and added <code>bitbucket.org</code> as a know host but I still get <code>403</code>. I think there is something missing in <a href=\"https://confluence.atlassian.com/x/DBuDMg\" rel=\"nofollow noreferrer\">confluence.atlassian.com/x/DBuDMg</a> since we can&#39;t add the PubKey to the remote hosts on Bitbucket."}, {"owner": {"reputation": 1, "user_id": 6516099, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fALl-gMIHfc/AAAAAAAAAAI/AAAAAAAAAFE/ehVoIiFsge4/photo.jpg?sz=128", "display_name": "Nazmi ZORLU", "link": "https://stackoverflow.com/users/6516099/nazmi-zorlu"}, "edited": false, "score": 0, "creation_date": 1589748517, "post_id": 38668444, "comment_id": 109410546, "body": "Since go@1.13 you need to follow <a href=\"https://stackoverflow.com/questions/61470626/how-do-i-use-go-with-bitbucket-private-repositories/61474660#61474660\">this solution</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "edited": false, "score": 6, "creation_date": 1502559852, "post_id": 38672481, "comment_id": 78264595, "body": "Still getting 403 error for bitbucket after adding to global config, what other reasons could there be for this and how to solve?"}, {"owner": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "edited": false, "score": 0, "creation_date": 1502561015, "post_id": 38672481, "comment_id": 78264956, "body": "i&#39;m able to push to and pull from my repo using ssh, not sure how why go get is not seeing this config change, and i&#39;m also getting same error when i put this config change in my local .git/config"}, {"owner": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "edited": false, "score": 0, "creation_date": 1502562427, "post_id": 38672481, "comment_id": 78265373, "body": "btw, i&#39;m doing the go get while building the docker image for my go app, not sure if it could be related to that too"}, {"owner": {"reputation": 1236, "user_id": 1289628, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/4ce1c64def03a08f11757ead0ae2b43a?s=128&d=identicon&r=PG", "display_name": "Subhash Chandran", "link": "https://stackoverflow.com/users/1289628/subhash-chandran"}, "reply_to_user": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "edited": false, "score": 1, "creation_date": 1504196565, "post_id": 38672481, "comment_id": 78932130, "body": "I faced the same issue @user3226932 faced: even after adding global config was getting 403 error. Solved it by doing <code>git config --system</code>: <code>git config --system url.&quot;git@github.com:&quot;.insteadOf &quot;https:&#47;&#47;github.com&#47;&quot;</code>."}, {"owner": {"reputation": 341, "user_id": 3121897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17316c8c4f8779a6ac2a96aa602e85d5?s=128&d=identicon&r=PG&f=1", "display_name": "kalsky", "link": "https://stackoverflow.com/users/3121897/kalsky"}, "edited": false, "score": 4, "creation_date": 1526261601, "post_id": 38672481, "comment_id": 87660008, "body": "Still didn&#39;t work after the command above, but the error mentioned that it goes to api.bitbucket.org, so I used: <code>git config --global url.&quot;git@bitbucket.org:&quot;.insteadOf &quot;https:&#47;&#47;api.bitbucket.org&#47;&quot;</code>"}, {"owner": {"reputation": 934, "user_id": 1885454, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6509a18dcc2587f0f665ae4bbc73c7b0?s=128&d=identicon&r=PG", "display_name": "Daveman", "link": "https://stackoverflow.com/users/1885454/daveman"}, "edited": false, "score": 0, "creation_date": 1588621389, "post_id": 38672481, "comment_id": 108964394, "body": "Both tipps in combination helped me, when I tried to use go modules with a public bitbucket repository on windows: <code>git config --system url.&quot;git@bitbucket.org:&quot;.insteadOf &quot;https:&#47;&#47;api.bitbucket.org&#47;&quot;</code>"}, {"owner": {"reputation": 337, "user_id": 2277289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9700a55bcc6e86c490feb127dd578d5a?s=128&d=identicon&r=PG", "display_name": "suraj.tripathi", "link": "https://stackoverflow.com/users/2277289/suraj-tripathi"}, "edited": false, "score": 0, "creation_date": 1598624782, "post_id": 38672481, "comment_id": 112528598, "body": "I was using my personal private bit bucket repo. follow helped me --&gt; <code>export GOPRIVATE=bitbucket.org&#47;companyNameORuserName</code> --&gt; <code>git config --global url.&quot;git@bitbucket.org:&quot;.insteadOf &quot;https:&#47;&#47;bitbucket.org&#47;&quot;</code>"}], "tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": false, "score": 75, "last_activity_date": 1497085455, "last_edit_date": 1497085455, "creation_date": 1469871539, "answer_id": 38672481, "question_id": 38668444, "link": "https://stackoverflow.com/questions/38668444/go-get-private-repo-from-bitbucket/38672481#38672481", "title": "&#39;Go Get&#39; Private Repo from Bitbucket", "body": "<p><code>go get</code> uses <code>git</code> internally. The following one liners will make <code>git</code> and consequently <code>go get</code> clone your package via SSH.</p>\n\n<p>Github:</p>\n\n<p><code>git config --global url.\"git@github.com:\".insteadOf \"https://github.com/\"</code></p>\n\n<p>BitBucket:</p>\n\n<p><code>git config --global url.\"git@bitbucket.org:\".insteadOf \"https://bitbucket.org/\"</code></p>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 2728986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51317475c5611e11e6188b700827ae67?s=128&d=identicon&r=PG&f=1", "display_name": "vin047", "link": "https://stackoverflow.com/users/2728986/vin047"}, "is_accepted": false, "score": 0, "last_activity_date": 1574156344, "creation_date": 1574156344, "answer_id": 58930832, "question_id": 38668444, "link": "https://stackoverflow.com/questions/38668444/go-get-private-repo-from-bitbucket/58930832#58930832", "title": "&#39;Go Get&#39; Private Repo from Bitbucket", "body": "<p><a href=\"https://stackoverflow.com/a/38672481/2728986\">Ammar Bandukwala's answer</a> is correct, but if you find yourself behind a firewall with SSH outgoing port (22) closed, you can use SSH over HTTPS port (443) instead:</p>\n\n<pre><code>git config --global url.\"ssh://git@altssh.bitbucket.org:443/&lt;account_name&gt;\".insteadOf \"https://bitbucket.org/&lt;account_name&gt;\"\n</code></pre>\n\n<p>source: <a href=\"https://confluence.atlassian.com/bitbucket/troubleshoot-ssh-issues-271943403.html#TroubleshootSSHissues-Ifport22isblocked\" rel=\"nofollow noreferrer\">https://confluence.atlassian.com/bitbucket/troubleshoot-ssh-issues-271943403.html#TroubleshootSSHissues-Ifport22isblocked</a></p>\n"}, {"comments": [{"owner": {"reputation": 841, "user_id": 4400812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/V6TEr.jpg?s=128&g=1", "display_name": "Marco Dufal", "link": "https://stackoverflow.com/users/4400812/marco-dufal"}, "edited": false, "score": 0, "creation_date": 1595924533, "post_id": 62558193, "comment_id": 111634502, "body": "With private modules hosted on GitHub setting <code>GOPRIVATE</code> as advised worked but differently from your example I had to modify git configuration with a specific authentication url e.g. <code>git config --global url.&quot;https:&#47;&#47;${GITHUB_USER}:${GITHUB_TOKEN}@github.com&quot;.inst&zwnj;&#8203;eadOf &quot;https:&#47;&#47;github.com&quot;</code>. If the repository is private how do you authenticate?"}, {"owner": {"reputation": 4220, "user_id": 965808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ab953a9d8a4131fb35af7c815690fa?s=128&d=identicon&r=PG", "display_name": "naoko", "link": "https://stackoverflow.com/users/965808/naoko"}, "reply_to_user": {"reputation": 841, "user_id": 4400812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/V6TEr.jpg?s=128&g=1", "display_name": "Marco Dufal", "link": "https://stackoverflow.com/users/4400812/marco-dufal"}, "edited": false, "score": 0, "creation_date": 1597790259, "post_id": 62558193, "comment_id": 112247814, "body": "Thank you @MarcoDufal, fixed!"}], "tags": [], "owner": {"reputation": 4220, "user_id": 965808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ab953a9d8a4131fb35af7c815690fa?s=128&d=identicon&r=PG", "display_name": "naoko", "link": "https://stackoverflow.com/users/965808/naoko"}, "is_accepted": false, "score": 3, "last_activity_date": 1597790244, "last_edit_date": 1597790244, "creation_date": 1593011298, "answer_id": 62558193, "question_id": 38668444, "link": "https://stackoverflow.com/questions/38668444/go-get-private-repo-from-bitbucket/62558193#62558193", "title": "&#39;Go Get&#39; Private Repo from Bitbucket", "body": "<p>Adition to setting <code>git config</code> described by others, I had to set <code>GOPRIVATE</code>.</p>\n<p>Step 1. <code>git config --global url.&quot;git@bitbucket.&lt;YOUR-COMPANY&gt;&quot;.insteadOf &quot;https://bitbucket.org/&lt;YOUR-COMPANY&gt;&quot;</code></p>\n<p>Step 2. <code>export GOPRIVATE=bitbucket.org/&lt;YOUR-COMPANY&gt;</code></p>\n<p>the <code>GOPRIAVTE</code> is documented here: <a href=\"https://golang.org/cmd/go/#hdr-Module_configuration_for_non_public_modules\" rel=\"nofollow noreferrer\">https://golang.org/cmd/go/#hdr-Module_configuration_for_non_public_modules</a></p>\n"}], "owner": {"reputation": 361, "user_id": 6656141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ebfb323a51b7cd90c7ac265a8ea7d0?s=128&d=identicon&r=PG&f=1", "display_name": "BeeAdmin", "link": "https://stackoverflow.com/users/6656141/beeadmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31504, "favorite_count": 16, "answer_count": 3, "score": 34, "last_activity_date": 1602174955, "creation_date": 1469831817, "question_id": 38668444, "link": "https://stackoverflow.com/questions/38668444/go-get-private-repo-from-bitbucket", "title": "&#39;Go Get&#39; Private Repo from Bitbucket", "body": "<p>So basically, I have an Openshift Project that on Git push, downloads all libraries with 'Go get' and builds the project on-the-fly and so, I have some code I don't want people to see from my own library, and for it to compile properly, the code needs to be taken from github.com or another repo, so I created a private bitbucket.org repo, now, as a public repo it works fine, but when I try to 'Go Get' from my private repo, it gives me 'Forbidden 403' </p>\n\n<p>How can I avoid this occurency?\nThank you for reading and have a nice day!</p>\n"}, {"tags": ["algorithm", "go"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 1980477, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/c33bL.jpg?s=128&g=1", "display_name": "Cute Tom", "link": "https://stackoverflow.com/users/1980477/cute-tom"}, "edited": false, "score": 0, "creation_date": 1469829805, "post_id": 38668076, "comment_id": 64717123, "body": "Thank You so much!"}], "tags": [], "owner": {"reputation": 9243, "user_id": 1318181, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1ZfAE.png?s=128&g=1", "display_name": "kylieCatt", "link": "https://stackoverflow.com/users/1318181/kyliecatt"}, "is_accepted": false, "score": 7, "last_activity_date": 1469829567, "creation_date": 1469829567, "answer_id": 38668076, "question_id": 38667980, "link": "https://stackoverflow.com/questions/38667980/why-this-correct-code-in-golang-is-considered-wrong-at-hackerrank/38668076#38668076", "title": "Why this correct code in Golang is considered wrong at HackerRank?", "body": "<p>Your output does not match the expected output:</p>\n\n<p>Your Output (stdout)</p>\n\n<pre><code>Please enter the first 3 digits separated by space or comma\nPlease enter the second 3 digits separated by space or comma\nA: 1, B: 1\n</code></pre>\n\n<p>Expected Output</p>\n\n<pre><code>1 1\n</code></pre>\n\n<p>You are printing way more than they asked for. You are also making this program for a computer to run not a person. You don't need to have a text prompt.</p>\n\n<p>Remove the excess printing:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a, b := ReadArrays()\n    sa, sb := CompareIt(a, b)\n    fmt.Printf(\"%d %d\", sa, sb)\n}\n\nfunc CompareIt(a, b []int) (int, int) {\n    var scoreA int\n    var scoreB int\n\n    for i := 0; i &lt; 3; i++ {\n        if a[i] &gt; b[i] {\n            scoreA += 1\n        } else if b[i] &gt; a[i] {\n            scoreB += 1\n        }\n    }\n    return scoreA, scoreB\n}\n\nfunc ReadArrays() ([]int, []int) {\n    a := make([]int, 3)\n    for i := range a {\n        fmt.Scanf(\"%d\", &amp;a[i])\n    }\n    b := make([]int, 3)\n    for i := range b {\n        fmt.Scanf(\"%d\", &amp;b[i])\n    }\n    return a, b\n}\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 1980477, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/c33bL.jpg?s=128&g=1", "display_name": "Cute Tom", "link": "https://stackoverflow.com/users/1980477/cute-tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1469829567, "creation_date": 1469829035, "question_id": 38667980, "link": "https://stackoverflow.com/questions/38667980/why-this-correct-code-in-golang-is-considered-wrong-at-hackerrank", "title": "Why this correct code in Golang is considered wrong at HackerRank?", "body": "<p>I solved \"Compare the Triplets\" in Golang using the following code, but its saying that the answer is wrong. \nWhen I run the code in my local environment it shows the desired results.</p>\n\n<p>(<a href=\"https://www.hackerrank.com/challenges/compare-the-triplets\" rel=\"nofollow\">here is the link to the problem at HackerRank</a>)</p>\n\n<p>Following is the code.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a, b := ReadArrays()\n    sa, sb := CompareIt(a, b)\n    fmt.Printf(\"A: %d, B: %d\\n\", sa, sb)\n}\n\nfunc CompareIt(a, b []int) (int, int) {\n    var scoreA int\n    var scoreB int\n\n    for i := 0; i &lt; 3; i++ {\n        if a[i] &gt; b[i] {\n            scoreA += 1\n        } else if b[i] &gt; a[i] {\n            scoreB += 1\n        }\n    }\n    return scoreA, scoreB\n}\n\nfunc ReadArrays() ([]int, []int) {\n    a := make([]int, 3)\n    fmt.Println(\"Please enter the first 3 digits separated by space or comma\")\n    for i := range a {\n        fmt.Scanf(\"%d\", &amp;a[i])\n    }\n    b := make([]int, 3)\n    fmt.Println(\"Please enter the second 3 digits separated by space or comma\")\n    for i := range b {\n        fmt.Scanf(\"%d\", &amp;b[i])\n    }\n    return a, b\n}\n</code></pre>\n\n<p>When I run this code in my local environment, its asks me at the terminal to enter the first 3 digits, then its asks me to to insert the other 3 digits, then the code compare it and give the scores to A and B as required in the challenge. </p>\n"}, {"tags": ["amazon-web-services", "go", "boto", "aws-sdk", "amazon-cognito"], "answers": [{"comments": [{"owner": {"reputation": 828, "user_id": 662017, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0b1bad601ac2781fc1a5dd2160121a44?s=128&d=identicon&r=PG", "display_name": "Alwin Doss", "link": "https://stackoverflow.com/users/662017/alwin-doss"}, "edited": false, "score": 0, "creation_date": 1513480347, "post_id": 38703955, "comment_id": 82668074, "body": "Pointing to the actual section would be better rather than mentioning a page number which could change with the addition of content."}], "tags": [], "owner": {"reputation": 1968, "user_id": 4402916, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2ed524952816b84787b70aea7c8bcf8a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkon", "link": "https://stackoverflow.com/users/4402916/arkon"}, "is_accepted": true, "score": 0, "last_activity_date": 1470069634, "creation_date": 1470069634, "answer_id": 38703955, "question_id": 38667705, "link": "https://stackoverflow.com/questions/38667705/aws-cognito-api-authentication-flow-sdks/38703955#38703955", "title": "AWS Cognito API Authentication flow SDKs", "body": "<p>I found what I needed here:docs.aws.amazon.com/cognito/latest/developerguide/\u2026 page 70.</p>\n\n<p>There is not an actual implementation example but this is way good enough to understand the process.</p>\n"}], "owner": {"reputation": 1968, "user_id": 4402916, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2ed524952816b84787b70aea7c8bcf8a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkon", "link": "https://stackoverflow.com/users/4402916/arkon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1528, "favorite_count": 0, "accepted_answer_id": 38703955, "answer_count": 1, "score": 1, "last_activity_date": 1470069634, "creation_date": 1469827460, "last_edit_date": 1469857111, "question_id": 38667705, "link": "https://stackoverflow.com/questions/38667705/aws-cognito-api-authentication-flow-sdks", "title": "AWS Cognito API Authentication flow SDKs", "body": "<p>I am trying to figure out what is the authentication flow with AWS Cognito (from a golang client for instance, or python with Boto). Basically registered user gets a token from Cognito and uses it to log in to the app server.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4qycf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4qycf.png\" alt=\"Simple Auth Flow with Cognito\"></a></p>\n\n<p>What I figured out so far: </p>\n\n<ol>\n<li>User sign in with SignUp()</li>\n<li>User Code Verification with ConfirmSignUp()</li>\n<li>How does the user get its token?</li>\n<li>How does the user provide it's token to a 3rd party server?</li>\n<li>How does the 3rd party server verify the user token ?</li>\n</ol>\n\n<p>The official documentation is talking about Authentication Challenge but I do not see it in the Golang or Python API libraries.\nHow can I validate steps 3, 4 and 5 please ?</p>\n\n<p>Thank you very much in advance</p>\n\n<p>API Doc:\n<a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/cognitoidentityprovider\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/cognitoidentityprovider</a>\n<a href=\"http://boto3.readthedocs.io/en/latest/reference/services/cognito-idp.html\" rel=\"nofollow noreferrer\">http://boto3.readthedocs.io/en/latest/reference/services/cognito-idp.html</a></p>\n"}, {"tags": ["logging", "go", "concurrency"], "answers": [{"comments": [{"owner": {"reputation": 3071, "user_id": 2979435, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c3fac4fcf2b4ae7f3f5a96164b34958e?s=128&d=identicon&r=PG", "display_name": "deFreitas", "link": "https://stackoverflow.com/users/2979435/defreitas"}, "edited": false, "score": 1, "creation_date": 1469846031, "post_id": 38668937, "comment_id": 64720465, "body": "it&#39;s true, the problem is that is hard to pass the int flag in every method at all the application, this also is not comprehensive ."}], "tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": false, "score": 0, "last_activity_date": 1469835717, "creation_date": 1469835717, "answer_id": 38668937, "question_id": 38666433, "link": "https://stackoverflow.com/questions/38666433/how-to-work-with-concurrent-logs-in-golang/38668937#38668937", "title": "How to work with concurrent logs in golang?", "body": "<p><code>goroutines</code> are very different from threads or even processes. They are managed by the go runtime and not your operating system. If you do some really heavy lifting it is even possible that the same goroutine jump between processes, therefore it is hard to give them unique IDs.</p>\n\n<p>For you example using the given <code>int</code> is perfectly fine, since every goroutine only processes one number.</p>\n"}, {"comments": [{"owner": {"reputation": 348, "user_id": 6634768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2WCdT.png?s=128&g=1", "display_name": "Pavel Kazhevets", "link": "https://stackoverflow.com/users/6634768/pavel-kazhevets"}, "edited": false, "score": 0, "creation_date": 1469872593, "post_id": 38672543, "comment_id": 64725392, "body": "Last example is really brief, but I hope you get the idea."}], "tags": [], "owner": {"reputation": 348, "user_id": 6634768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2WCdT.png?s=128&g=1", "display_name": "Pavel Kazhevets", "link": "https://stackoverflow.com/users/6634768/pavel-kazhevets"}, "is_accepted": false, "score": 0, "last_activity_date": 1469872535, "last_edit_date": 1469872535, "creation_date": 1469872101, "answer_id": 38672543, "question_id": 38666433, "link": "https://stackoverflow.com/questions/38666433/how-to-work-with-concurrent-logs-in-golang/38672543#38672543", "title": "How to work with concurrent logs in golang?", "body": "<p>If you don't want to pass some <code>int</code> in every goroutine, then you can try to generate random number in it with <a href=\"https://golang.org/pkg/math/rand/\" rel=\"nofollow\"><code>math/rand</code></a> package inside goroutine iself. If number will be high enough (depends on your load), then you'll get some kind of goroutine ID. </p>\n\n<p>You can find examples of random number generating <a href=\"https://gobyexample.com/random-numbers\" rel=\"nofollow\">here</a>.</p>\n\n<p>You can also print it in hex, so it will be easy to distinguish that id from other int values you may have in program.</p>\n\n<p>This should do the trick:</p>\n\n<p><code>log.Printf(\"m=getHello, i=%#x,begin\", d)</code></p>\n\n<p><strong>EDIT:</strong>\nAlso if you want to be sure your id is unique in each goroutine, then you can add some global counter and increment it in each goroutine.</p>\n\n<pre><code>import sync\n\nvar txCounter int\nvar counterMutex = &amp;sync.Mutex{}\n\nfor {\n    go func() {\n        id := txCounter\n        counterMutex.Lock()\n        txCounter++\n        counterMutex.Unlock()\n        log.Printf(\"m=getHello, i=%#x,begin\", id)\n    }() \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3071, "user_id": 2979435, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c3fac4fcf2b4ae7f3f5a96164b34958e?s=128&d=identicon&r=PG", "display_name": "deFreitas", "link": "https://stackoverflow.com/users/2979435/defreitas"}, "edited": false, "score": 0, "creation_date": 1470089111, "post_id": 38672627, "comment_id": 64795261, "body": "Is <code>context</code> package available in what go version?, I&#39;ve tested at &#39;1.6.3&#39; and the package not exists for me"}, {"owner": {"reputation": 3071, "user_id": 2979435, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c3fac4fcf2b4ae7f3f5a96164b34958e?s=128&d=identicon&r=PG", "display_name": "deFreitas", "link": "https://stackoverflow.com/users/2979435/defreitas"}, "edited": false, "score": 0, "creation_date": 1470089308, "post_id": 38672627, "comment_id": 64795342, "body": "In My case was needled change from <code>context</code> to <code>&quot;golang.org&#47;x&#47;net&#47;context&quot;</code> and run <code>go get</code>"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "reply_to_user": {"reputation": 3071, "user_id": 2979435, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c3fac4fcf2b4ae7f3f5a96164b34958e?s=128&d=identicon&r=PG", "display_name": "deFreitas", "link": "https://stackoverflow.com/users/2979435/defreitas"}, "edited": false, "score": 1, "creation_date": 1470104426, "post_id": 38672627, "comment_id": 64798980, "body": "<code>context</code> is new in the stdlib in 1.7, but <code>golang.org&#47;x&#47;net&#47;context</code> is almost identical."}, {"owner": {"reputation": 1635, "user_id": 2124961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/471c2ea37e94eb484de5a07c362bcfd3?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2124961/stefan"}, "edited": false, "score": 0, "creation_date": 1611865550, "post_id": 38672627, "comment_id": 116595565, "body": "Thanks you, that example was very helpful to me."}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 10, "last_activity_date": 1555590476, "last_edit_date": 1555590476, "creation_date": 1469872742, "answer_id": 38672627, "question_id": 38666433, "link": "https://stackoverflow.com/questions/38666433/how-to-work-with-concurrent-logs-in-golang/38672627#38672627", "title": "How to work with concurrent logs in golang?", "body": "<p>There's no goroutine ID available from the runtime. Goroutines are used more liberally than threads in other languages, so the idea of which goroutine is handling a particular request or item may be less well-defined in a larger program.</p>\n\n<p>So somehow you need to pass through an ID yourself for logging. You could just pass through an <code>int</code> yourself, but the <code>context</code> module is handy for this: apart from allowing user-defined values, it can handle item cancellation and deadlines which are also likely to be useful to you.</p>\n\n<p>Here's a rough example of how it might be used. I've added a simple logging object that can be used as a context-aware logger. It logs the ID the context was created with. Probably this logger would go in its own package in a real program and support more of the log package's functions rather than just <code>Printf</code> and <code>Println</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"sync\"\n    \"context\"\n)\n\ntype logger int\nconst loggerID = \"logger_id\"\n\nfunc (l logger) Printf(s string, args ...interface{}) {\n    log.Printf(\"[id=%d] %s\", l, fmt.Sprintf(s, args...))\n}\n\nfunc (l logger) Println(s string) {\n    log.Printf(\"[id=%d] %s\\n\", l, s)\n}\n\nfunc ctxWithLoggerID(ctx context.Context, id int) context.Context {\n    return context.WithValue(ctx, loggerID, id)\n}\n\nfunc getLogger(ctx context.Context) logger {\n    return logger(ctx.Value(loggerID).(int))\n}\n\nfunc main() {\n    ctx := context.Background()\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 10; i++ {\n        wg.Add(1)\n        go hello(ctxWithLoggerID(ctx, i), &amp;wg)\n    }\n    wg.Wait()\n}\n\nfunc hello(ctx context.Context, wg *sync.WaitGroup) {\n    defer wg.Done()\n    log := getLogger(ctx)\n    log.Printf(\"hello begin\")\n    log.Println(\"hello, processing the hello message\")\n    log.Printf(\"hello, end\")\n}\n</code></pre>\n\n<p>It's incidental to your question, but I added a <code>sync.WaitGroup</code> to your program so that <code>main</code> will wait until all of the workers are finished before exiting. That allows the code to be tested with a smaller number of workers (10 rather than the original 10000).</p>\n"}], "owner": {"reputation": 3071, "user_id": 2979435, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c3fac4fcf2b4ae7f3f5a96164b34958e?s=128&d=identicon&r=PG", "display_name": "deFreitas", "link": "https://stackoverflow.com/users/2979435/defreitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8001, "favorite_count": 2, "accepted_answer_id": 38672627, "answer_count": 3, "score": 9, "last_activity_date": 1586306282, "creation_date": 1469821546, "last_edit_date": 1586306282, "question_id": 38666433, "link": "https://stackoverflow.com/questions/38666433/how-to-work-with-concurrent-logs-in-golang", "title": "How to work with concurrent logs in golang?", "body": "<p>I've searched for it and only found <a href=\"https://stackoverflow.com/questions/18361750/correct-approach-to-global-logging-in-golang\">here</a> and <a href=\"https://stackoverflow.com/questions/19115273/looking-for-a-call-or-thread-id-to-use-for-logging\">here</a>, but it does not solve my problem.</p>\n\n<p>How can I, using a standard way, identify the log separating the concurrent logs like JAVA does with thread ID? Because if I have a concurrent method then the logs will be printed mixed at the output, so I think that the LOGGER needs to have a way of identifying each request \"thread\"</p>\n\n<p>Ex:</p>\n\n<pre><code>package main\n\nimport \"log\"\n\nfunc main() {\n\n    /* simulating 10000 users requests  */\n    for i:=1; i &lt; 10000; i++ {\n        go getHello(i)\n    }\n}\n\nfunc getHello(d int){\n    log.Printf(\"m=getHello, i=%d,begin\", d)\n    log.Println(\"m=getHello, processing the hello message\")\n    log.Printf(\"m=getHello, i=%d, end\", d)\n}\n</code></pre>\n\n<p>output</p>\n\n<pre><code>2016/07/29 15:59:46 m=getHello, i=1017,begin\n2016/07/29 15:59:46 m=getHello, processing the hello message\n2016/07/29 15:59:46 m=getHello, i=1017, end\n2016/07/29 15:59:46 m=getHello, processing the hello message\n2016/07/29 15:59:46 m=getHello, i=1038, end\n2016/07/29 15:59:46 m=getHello, i=311,begin\n2016/07/29 15:59:46 m=getHello, processing the hello message\n2016/07/29 15:59:46 m=getHello, i=311, end\n2016/07/29 15:59:46 m=getHello, i=1023,begin\n</code></pre>\n\n<p>As you can see, without using an int flag, it is impossible to know which request logged a message. In Java and C for example you can use thread id for this purpose.</p>\n\n<p>How to achieve this in Golang? Thanks.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 8339, "user_id": 1581069, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/53f781d013b1bdba5b7356908a82d356?s=128&d=identicon&r=PG", "display_name": "Peter Butkovic", "link": "https://stackoverflow.com/users/1581069/peter-butkovic"}, "edited": false, "score": 2, "creation_date": 1469821884, "post_id": 38666435, "comment_id": 64714010, "body": "great, thx for explanation (will mark as correct once it&#39;s possible)"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 23, "last_activity_date": 1469821547, "creation_date": 1469821547, "answer_id": 38666435, "question_id": 38666404, "link": "https://stackoverflow.com/questions/38666404/not-enough-arguments-in-call-to-method-expression/38666435#38666435", "title": "not enough arguments in call to method expression", "body": "<p>Your error unfortunately is somewhat misleading. The issue is that it is an instance method and you're calling it as if it's a method at the packages scope.</p>\n\n<p>You need something like this;</p>\n\n<pre><code>func main() {\n    var in []byte\n    jp := JSONParser{}\n    actual, err2 := jp.Parse(in)\n}\n</code></pre>\n\n<p>I'm guessing the error is worded like that because a receiver (thing in parens on the left hand site of function name) is handled like any other argument being passed to a function in the background.</p>\n\n<p>If you wanted to call your method like that the definition would just be <code>func Parse(toParse []byte) ([]Schema, int)</code> and if it were in a package called <code>JSONParser</code> then that would be the correct syntax. If it were defined in the same package as in your example you would just call it like <code>Parse(in)</code></p>\n"}], "owner": {"reputation": 8339, "user_id": 1581069, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/53f781d013b1bdba5b7356908a82d356?s=128&d=identicon&r=PG", "display_name": "Peter Butkovic", "link": "https://stackoverflow.com/users/1581069/peter-butkovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12702, "favorite_count": 2, "accepted_answer_id": 38666435, "answer_count": 1, "score": 16, "last_activity_date": 1469821547, "creation_date": 1469821402, "question_id": 38666404, "link": "https://stackoverflow.com/questions/38666404/not-enough-arguments-in-call-to-method-expression", "title": "not enough arguments in call to method expression", "body": "<p>While learning go I came to following error: </p>\n\n<pre><code>prog.go:18: not enough arguments in call to method expression JSONParser.Parse \n</code></pre>\n\n<p>in my test program (<a href=\"https://play.golang.org/p/PW9SF4c9q8\" rel=\"noreferrer\">https://play.golang.org/p/PW9SF4c9q8</a>):</p>\n\n<pre><code>package main\n\n\ntype Schema struct {\n}\n\ntype JSONParser struct {\n}\n\nfunc (jsonParser JSONParser) Parse(toParse []byte) ([]Schema, int) {\n    var schema []Schema\n    // whatever parsing logic\n    return schema, 0 \n}\n\nfunc main() {\n    var in []byte\n    actual, err2 := JSONParser.Parse(in)\n}\n</code></pre>\n\n<p>Anyone willing to help me to move on here?</p>\n"}, {"tags": ["go", "multiple-return-values"], "answers": [{"tags": [], "owner": {"reputation": 12672, "user_id": 1200821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cm117.jpg?s=128&g=1", "display_name": "Juan Diego Godoy Robles", "link": "https://stackoverflow.com/users/1200821/juan-diego-godoy-robles"}, "is_accepted": true, "score": 11, "last_activity_date": 1469815311, "creation_date": 1469815311, "answer_id": 38664932, "question_id": 38664844, "link": "https://stackoverflow.com/questions/38664844/multiple-return-value-and-in-go/38664932#38664932", "title": "Multiple return value and := in go", "body": "<p>The <a href=\"https://golang.org/doc/effective_go.html#redeclaration\">documentation</a> is clear at this point:</p>\n\n<blockquote>\n  <p>In a := declaration a variable v may appear even if it has already\n  been declared, provided:</p>\n  \n  <p>this declaration is in the same scope as the existing declaration of v\n  (if v is already declared in an outer scope, the declaration will\n  create a new variable \u00a7), the corresponding value in the\n  initialization is assignable to v, and <strong>there is at least one other\n  variable in the declaration that is being declared anew</strong>.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1469815498, "creation_date": 1469815498, "answer_id": 38664978, "question_id": 38664844, "link": "https://stackoverflow.com/questions/38664844/multiple-return-value-and-in-go/38664978#38664978", "title": "Multiple return value and := in go", "body": "<p>The rule is that at least one of the variables on the left hand side have to be new. You'll commonly see code that reuses the <code>error</code> variable when doing one function call after another.</p>\n\n<p>In your second example you're reassigning both values so in a case like that you have to use <code>=</code> on subsequent assignment. That particular detail is one you have have to reason about very often in Go. You get used to it quickly though, it's pretty straight forward.</p>\n"}, {"tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": false, "score": 3, "last_activity_date": 1469847152, "creation_date": 1469847152, "answer_id": 38669928, "question_id": 38664844, "link": "https://stackoverflow.com/questions/38664844/multiple-return-value-and-in-go/38669928#38669928", "title": "Multiple return value and := in go", "body": "<p>klashxx already answer the question. </p>\n\n<p>There may be something confusing here. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main(){\n     a, b := 1, 2            \n     fmt.Println(a, b)\n     {\n         b, c := 100, 200       //NOTE: b here is a new variable\n         fmt.Println(a, b, c)\n     }\n\n     fmt.Println(a, b)\n\n     b, c := 1000, 2000\n     fmt.Println(a, b, c)\n}\n</code></pre>\n"}], "owner": {"reputation": 29985, "user_id": 692499, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7757ce52a52d5696a160372ca41742d6?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/692499/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3460, "favorite_count": 0, "accepted_answer_id": 38664932, "answer_count": 3, "score": 7, "last_activity_date": 1469847152, "creation_date": 1469815032, "question_id": 38664844, "link": "https://stackoverflow.com/questions/38664844/multiple-return-value-and-in-go", "title": "Multiple return value and := in go", "body": "<p>Why is this a valid program?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc giveMeError(limit int) ([]string, error) {\n    return nil, fmt.Errorf(\"MY ERROR %d\", limit)\n}\n\nfunc main() {\n\n    res1, err := giveMeError(1)\n    if err == nil {\n        fmt.Println(\"res\", res1)\n    } else {\n        fmt.Println(\"err\", err)\n    }\n\n    res2, err := giveMeError(5)\n    if err == nil {\n        fmt.Println(\"res\", res2)\n    } else {\n        fmt.Println(\"err\", err)\n    }\n\n}\n</code></pre>\n\n<p>And this isn't?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc giveMeError(limit int) ([]string, error) {\n    return nil, fmt.Errorf(\"MY ERROR %d\", limit)\n}\n\nfunc main() {\n\n    res, err := giveMeError(1)\n    if err == nil {\n        fmt.Println(\"res\", res)\n    } else {\n        fmt.Println(\"err\", err)\n    }\n\n    res, err := giveMeError(5)\n    if err == nil {\n        fmt.Println(\"res\", res)\n    } else {\n        fmt.Println(\"err\", err)\n    }\n\n}\n</code></pre>\n\n<p>Complains that <code>./main.go:18: no new variables on left side of :=</code></p>\n\n<p>I thought <code>:=</code> cannot be used to change value to existing variables?</p>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 10321, "user_id": 215552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26bda02894d869c95f620de4b7cd386d?s=128&d=identicon&r=PG", "display_name": "Heretic Monkey", "link": "https://stackoverflow.com/users/215552/heretic-monkey"}, "reply_to_user": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 1, "creation_date": 1469817924, "post_id": 38664454, "comment_id": 64712093, "body": "@MayankPatel I updated your edit. Please do not put links in a <code>&lt;kbd&gt;</code> tag."}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "reply_to_user": {"reputation": 10321, "user_id": 215552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26bda02894d869c95f620de4b7cd386d?s=128&d=identicon&r=PG", "display_name": "Heretic Monkey", "link": "https://stackoverflow.com/users/215552/heretic-monkey"}, "edited": false, "score": 0, "creation_date": 1469820693, "post_id": 38664454, "comment_id": 64713486, "body": "@MikeMcCaughan Any particular reason?"}, {"owner": {"reputation": 10321, "user_id": 215552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26bda02894d869c95f620de4b7cd386d?s=128&d=identicon&r=PG", "display_name": "Heretic Monkey", "link": "https://stackoverflow.com/users/215552/heretic-monkey"}, "reply_to_user": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 3, "creation_date": 1469821481, "post_id": 38664454, "comment_id": 64713831, "body": "@MayankPatel Because the <code>&lt;kbd&gt;</code> element is only for keyboard keys, or possibly input, not links. See <a href=\"http://meta.stackoverflow.com/questions/270967/proper-use-of-the-kbd-tag\" title=\"proper use of the kbd tag\">meta.stackoverflow.com/questions/270967/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1469814475, "post_id": 38664524, "comment_id": 64710231, "body": "How does Go implementation learn to formulate a new string based on an example &quot;20060102_15&quot;, and how does it know which parts of &quot;20060102_15&quot; are year, month, day and hour?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1469814551, "post_id": 38664524, "comment_id": 64710272, "body": "@Tim: I linked directly to the documentation describing the reference time format."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1469814848, "post_id": 38664524, "comment_id": 64710407, "body": "is it right that the example time is a fixed one, i.e. you can&#39;t use another time as an example to teach Go?"}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1469815005, "post_id": 38664524, "comment_id": 64710497, "body": "Another question, is it also possible to formulate a string using a way similar to specification in C&#39;s string formulation?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1469815049, "post_id": 38664524, "comment_id": 64710531, "body": "@Tim: I don&#39;t understand. The reference time is a set constant, what good would there be to use a different time to teach go?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1469815171, "post_id": 38664524, "comment_id": 64710608, "body": "@Tim: no, the go time package uses the reference time as the formatter. Once you memorize <code>01&#47;02 03:04:05PM &#39;06 -0700</code>, you don&#39;t need to remember the individual format characters. I&#39;m sure you could find a package somewhere to make use of strftime formatting."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1469814606, "last_edit_date": 1592644375, "creation_date": 1469813777, "answer_id": 38664524, "question_id": 38664454, "link": "https://stackoverflow.com/questions/38664454/how-to-format-this-string-in-go/38664524#38664524", "title": "How to format this string in Go", "body": "<p>Use the formatting <a href=\"https://golang.org/pkg/time/#pkg-constants\" rel=\"nofollow noreferrer\">provided by the time package</a>:</p>\n<p><a href=\"https://play.golang.org/p/qIZ58CJqZa\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qIZ58CJqZa</a></p>\n<pre><code>t := time.Date(2016, 6, 3, 9, 0, 0, 0, time.UTC)\nfmt.Println(t.Format(&quot;20060102_15&quot;))\n</code></pre>\n<p>From the time package documentation on the reference time format string:</p>\n<blockquote>\n<p>The reference time used in the layouts is the specific time:</p>\n<pre><code>Mon Jan 2 15:04:05 MST 2006\n</code></pre>\n<p>which is Unix time 1136239445. Since MST is GMT-0700, the reference time can be thought of as</p>\n<pre><code>01/02 03:04:05PM '06 -0700\n</code></pre>\n<p>To define your own format, write down what the reference time would look like formatted your way; see the values of constants like ANSIC, StampMicro or Kitchen for examples. The model is to demonstrate what the reference time looks like so that the Format and Parse methods can apply the same transformation to a general time value.</p>\n<p>Within the format string, an underscore _ represents a space that may be replaced by a digit if the following number (a day) has two digits; for compatibility with fixed-width Unix time formats.</p>\n<p>A decimal point followed by one or more zeros represents a fractional second, printed to the given number of decimal places. A decimal point followed by one or more nines represents a fractional second, printed to the given number of decimal places, with trailing zeros removed. When parsing (only), the input may contain a fractional second field immediately after the seconds field, even if the layout does not signify its presence. In that case a decimal point followed by a maximal series of digits is parsed as a fractional second.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1469817837, "creation_date": 1469813556, "last_edit_date": 1469817837, "question_id": 38664454, "link": "https://stackoverflow.com/questions/38664454/how-to-format-this-string-in-go", "title": "How to format this string in Go", "body": "<p>Here is my program</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\nimport \"strconv\"\nimport \"strings\"\n\nfunc main() {\n\n    t := time.Date(2016, 10, 30, 14, 0, 0, 0, time.UTC) \n\n\n    year, month, day := t.Date()          \n    hr := t.Hour()  \n\n    s := []string{strconv.Itoa(year), strconv.Itoa(int(month)), strconv.Itoa(day)}\n    date := strings.Join(s, \"\")\n\n    s = []string{date, strconv.Itoa(hr)}\n    date = strings.Join(s, \"_\")\n    fmt.Println(date)       \n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/DreUDskIIs\" rel=\"nofollow\">Go Playground</a></p>\n\n<p>The output is </p>\n\n<pre><code>20161030_14\n</code></pre>\n\n<p>If I replace </p>\n\n<pre><code>t := time.Date(2016, 10, 30, 14, 0, 0, 0, time.UTC)\n</code></pre>\n\n<p>with </p>\n\n<pre><code>t := time.Date(2016, 6, 3, 9, 0, 0, 0, time.UTC)\n</code></pre>\n\n<p>then the output is </p>\n\n<pre><code>201663_9\n</code></pre>\n\n<p>but I hope it outputs</p>\n\n<pre><code>20160603_09\n</code></pre>\n\n<p>i.e. the month, day and hour should all be two-character long with possibly adding <code>0</code> in front. How can I do that? </p>\n\n<p>Or if you were me, what would be your program which implements the same thing?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "data-structures", "godoc"], "comments": [{"owner": {"reputation": 1512, "user_id": 3379440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7KSMr.jpg?s=128&g=1", "display_name": "Jonathon Ogden", "link": "https://stackoverflow.com/users/3379440/jonathon-ogden"}, "edited": false, "score": 0, "creation_date": 1469806718, "post_id": 38662411, "comment_id": 64706177, "body": "Regarding the first code sample, it&#39;s purpose is to demonstrate type declarations to help you understand named and unnamed type declarations. For example, instead of writing <code>[]string</code> you can write <code>T0</code> or <code>T1</code> instead. Interestingly, <code>T0</code> and <code>T1</code> are considered different because of the names they are given. Recommend reviewing <a href=\"https://golang.org/ref/spec#Type_identity\" rel=\"nofollow noreferrer\">Type identity</a>"}, {"owner": {"reputation": 1036, "user_id": 5523033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/K5pxl.jpg?s=128&g=1", "display_name": "Andrei", "link": "https://stackoverflow.com/users/5523033/andrei"}, "edited": false, "score": 0, "creation_date": 1469808285, "post_id": 38662411, "comment_id": 64707157, "body": "After reading that (which is what I posted in the top part) I don&#39;t see an explanation for the anon type. seeing as its <code>type ()</code> and the type can encapsulate/group other types + structs what does this do for a data structure and how does it help? take of instance the first two lines of <code>RoutesInfo []RouteInfo</code> and <code>RouteInfo struct {}</code> why is it inside of the type() instead of having a <code>var RoutesInfo[] RouteInfo</code> and another declaration such as <code>type RouteInfo struct {}</code> and another line for <code>type Engine struct {}</code>"}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1469808391, "post_id": 38662411, "comment_id": 64707217, "body": "I think you&#39;re misunderstanding what you&#39;re looking at - none of these (besides the last <code>var _</code> line that you included) are variable declarations. They&#39;re just type declarations. The use of <code>type ( ... )</code> is just a shorthand for writing <code>type</code> at the beginning of each line separately. It&#39;s just a syntax thing - they have the same meaning."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1469810303, "last_edit_date": 1495540859, "creation_date": 1469808512, "answer_id": 38663185, "question_id": 38662411, "link": "https://stackoverflow.com/questions/38662411/golang-godoc-explain-group-type-declarations/38663185#38663185", "title": "Golang godoc - Explain group type declarations", "body": "<p>The code </p>\n\n<pre><code>type (\n   A int\n   B string\n)\n</code></pre>\n\n<p>is functionality identical to</p>\n\n<pre><code>type A int\ntype B string\n</code></pre>\n\n<p>The grouping is just a way to organize code. The grouping is sometimes used to indicate that the types are related in some way.</p>\n\n<p>The use of the blank identifier is explained in <a href=\"https://stackoverflow.com/questions/38167403/specs-whats-the-purpose-of-the-blank-identifier-in-variable-assignment\">Specs: What&#39;s the purpose of the blank identifier in variable assignment?</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": false, "score": 3, "last_activity_date": 1469808709, "creation_date": 1469808709, "answer_id": 38663229, "question_id": 38662411, "link": "https://stackoverflow.com/questions/38662411/golang-godoc-explain-group-type-declarations/38663229#38663229", "title": "Golang godoc - Explain group type declarations", "body": "<p>I think the first part of your question has already been answered. As for the second part, the code</p>\n\n<pre><code>var _ IRouter = &amp;Engine{}\n</code></pre>\n\n<p>Creates a compile-time check that <code>*Engine</code> implements the <code>IRouter</code> interface. We are assigning a value of type <code>*Engine</code> to a variable that must be of the type <code>IRouter</code>. If a <code>*Engine</code> does not satisfy the interface then it won't compile.</p>\n\n<p>This isn't strictly necessary but some people like to put it in where they define a type to ensure it always satisfies an intended interface.</p>\n"}, {"tags": [], "owner": {"reputation": 760, "user_id": 2578506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0cbfd564375424ce1304a84c256078?s=128&d=identicon&r=PG", "display_name": "factotum", "link": "https://stackoverflow.com/users/2578506/factotum"}, "is_accepted": false, "score": 0, "last_activity_date": 1469861030, "last_edit_date": 1469861030, "creation_date": 1469860441, "answer_id": 38671076, "question_id": 38662411, "link": "https://stackoverflow.com/questions/38662411/golang-godoc-explain-group-type-declarations/38671076#38671076", "title": "Golang godoc - Explain group type declarations", "body": "<p>Regarding 1st question</p>\n\n<p>The statments shown are type declaration\nFrom the Go language spec :\nA type declaration binds an identifier, the type name, to a new type that has the same underlying type as an existing type, and operations defined for the existing type are also defined for the new type. The new type is different from the existing type.</p>\n\n<blockquote>\n  <p>TypeDecl     = \"type\" ( TypeSpec | \"(\" { TypeSpec \";\" } \")\" ) .\n  TypeSpec     = identifier Type .</p>\n</blockquote>\n\n<p>In layman terms, you can do :</p>\n\n<blockquote>\n  <p>type  </p>\n</blockquote>\n\n<p>e.g.</p>\n\n<pre><code>type Temperature uint8\ntype WeekTemp [7]Temperature\n</code></pre>\n\n<p>For underlying type, \n Named instances of the boolean, numeric, and string types are predeclared.\n Composite types are constructed using type literals</p>\n\n<blockquote>\n  <p>TypeLiteral   = ArrayType | StructType | PointerType | FunctionType | \n  InterfaceType |\n        SliceType | MapType | ChannelType .</p>\n</blockquote>\n\n<p>so you can also equivalently do :</p>\n\n<pre><code>type (\n    Temperature unit8\n    WeekTemp [7]Temperature\n)\n</code></pre>\n\n<p>another example for composite type</p>\n\n<pre><code>type Tree struct {\n    leftChild, rightChild *Tree\n}\n</code></pre>\n\n<p>For 2nd question,</p>\n\n<p>Edited :\nI wasn't aware of this but trying on go playground , it looks like the answer from  jcbwlkr is indeed right.</p>\n\n<p>So trying to compile</p>\n\n<pre><code>type MyInterface interface{\n    someMethod() \n}\ntype MyType struct{}\nvar _ MyInterface = &amp;MyType{}\n</code></pre>\n\n<p>will give this error</p>\n\n<blockquote>\n  <p>cannot use MyType literal (type *MyType) as type MyInterface in\n  assignment:   *MyType does not implement MyInterface (missing\n  someMethod method)</p>\n</blockquote>\n\n<p>So it indeed does a compile time check to make sure that Engine struct conforms to IRouter interface. neat</p>\n"}], "owner": {"reputation": 1036, "user_id": 5523033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/K5pxl.jpg?s=128&g=1", "display_name": "Andrei", "link": "https://stackoverflow.com/users/5523033/andrei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 992, "favorite_count": 0, "accepted_answer_id": 38663185, "answer_count": 3, "score": 2, "last_activity_date": 1469861030, "creation_date": 1469805983, "question_id": 38662411, "link": "https://stackoverflow.com/questions/38662411/golang-godoc-explain-group-type-declarations", "title": "Golang godoc - Explain group type declarations", "body": "<p>There is a piece of GO code I have seen in the GIN library and in the Google docs that look like the following</p>\n\n<pre><code>type (\n    T0 []string\n    T1 []string\n    T2 struct{ a, b int }\n    T3 struct{ a, c int }\n    T4 func(int, float64) *T0\n    T5 func(x int, y float64) *[]string\n)\n</code></pre>\n\n<p>What I don't understand is, what this grouping is doing and what are some purposes of this implementation (there wasn't much in the docs that went over this topic unless I missed it)</p>\n\n<p>another example from the gin library</p>\n\n<pre><code>type (\n    RoutesInfo []RouteInfo\n    RouteInfo  struct {\n        Method  string\n        Path    string\n        Handler string\n    }\n        Engine struct {\n        RouterGroup\n        HTMLRender  render.HTMLRender\n        allNoRoute  HandlersChain\n        allNoMethod HandlersChain\n        noRoute     HandlersChain\n        noMethod    HandlersChain\n        pool        sync.Pool\n        trees       methodTrees\n\n        RedirectTrailingSlash bool\n\n\n        RedirectFixedPath bool      \n        HandleMethodNotAllowed bool\n        ForwardedByClientIP    bool\n    }\n)\n</code></pre>\n\n<p>And lastly - sorry this is different topic but related to this one</p>\n\n<pre><code>var _ IRouter = &amp;Engine{}\n</code></pre>\n\n<p>why is there a _ infront of IRouter? I know it's a <code>blank identifier</code> but what purpose does it have in that case</p>\n"}, {"tags": ["unit-testing", "testing", "go"], "comments": [{"owner": {"reputation": 13146, "user_id": 3767, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ecc03e67aafd272846bb34e61bd7e2bd?s=128&d=identicon&r=PG", "display_name": "Eric Levine", "link": "https://stackoverflow.com/users/3767/eric-levine"}, "edited": false, "score": 1, "creation_date": 1469805009, "post_id": 38660219, "comment_id": 64705119, "body": "I don&#39;t know if this is considered idiomatic, but my gut instinct is to create an interface for UserRepository with the smallest surface area you need (only one method at the moment).  I would call the interface UserRepository and the struct something more specific to the implementation like MongoUserRepository if it was talking to MongoDb"}, {"owner": {"reputation": 13146, "user_id": 3767, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ecc03e67aafd272846bb34e61bd7e2bd?s=128&d=identicon&r=PG", "display_name": "Eric Levine", "link": "https://stackoverflow.com/users/3767/eric-levine"}, "edited": false, "score": 0, "creation_date": 1469805077, "post_id": 38660219, "comment_id": 64705159, "body": "You could create a file called something like <code>mocks_test.go</code> and keep your mocks in there.  As long as that file is in the same package as your other tests, they&#39;ll be able to use the mocks.  Again, I don&#39;t know if this would be considered idiomatic or not."}, {"owner": {"reputation": 555, "user_id": 5058168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2VxPP.png?s=128&g=1", "display_name": "RhinoLarva", "link": "https://stackoverflow.com/users/5058168/rhinolarva"}, "reply_to_user": {"reputation": 13146, "user_id": 3767, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ecc03e67aafd272846bb34e61bd7e2bd?s=128&d=identicon&r=PG", "display_name": "Eric Levine", "link": "https://stackoverflow.com/users/3767/eric-levine"}, "edited": false, "score": 0, "creation_date": 1469806878, "post_id": 38660219, "comment_id": 64706275, "body": "The problem is that with this approach I will end up with a lot of interfaces. One interface for FindAll() method. Another interface for FindByName() method. Third interface for combination of FindAll() and FindById() methods etc. And I cannot call them all UserRepository."}, {"owner": {"reputation": 13146, "user_id": 3767, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ecc03e67aafd272846bb34e61bd7e2bd?s=128&d=identicon&r=PG", "display_name": "Eric Levine", "link": "https://stackoverflow.com/users/3767/eric-levine"}, "edited": false, "score": 0, "creation_date": 1469807082, "post_id": 38660219, "comment_id": 64706407, "body": "I wasn&#39;t suggesting that.  Create one interface and put in as many methods as callers of the interface need. You shouldn&#39;t put in anything extra into the interface that isn&#39;t being called by another struct though."}], "answers": [{"tags": [], "owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "is_accepted": false, "score": 1, "last_activity_date": 1469926210, "creation_date": 1469926210, "answer_id": 38679818, "question_id": 38660219, "link": "https://stackoverflow.com/questions/38660219/what-is-the-most-idiomatic-way-in-go-to-test-code-which-has-dependency-on-struct/38679818#38679818", "title": "What is the most idiomatic way in Go to test code which has dependency on structure with big amount of methods?", "body": "<p>1) I'd go with what elevine said, i.e. only require the methods that you need for that struct. So for example: you have <code>UserService</code> that needs <code>FindByName</code> and <code>FindAll</code>, and <code>UserAdminService</code> that needs <code>FindById</code>, <code>FindAll</code> and <code>Save</code>. In that case you should have two interfaces:</p>\n\n<ol>\n<li><code>UserProvider</code> with <code>FindByName</code> and <code>FindAll</code></li>\n<li><code>UserAdminProvider</code> with <code>FindById</code>, <code>FindAll</code> and <code>Save</code>.</li>\n</ol>\n\n<p>This also lets you keep your <code>UserProvider</code> in check, e.g. you know it can't call <code>Save</code>, so it can't modify a user.</p>\n\n<p>You'll likely only need one actual implementation that satisfies both interfaces.</p>\n\n<p>2) Check out <a href=\"https://godoc.org/github.com/stretchr/testify/mock\" rel=\"nofollow\">testify/mock</a> and <a href=\"https://github.com/vektra/mockery\" rel=\"nofollow\">mockery</a>. Mockery will generate mocks for your interfaces in a <code>mocks</code> subpackage, one for each interface.\nThis does mean you can't use the same mock struct for both tests, but it doesn't matter, because the code is generated. You don't mock up the behavior of the interface in the mock struct, you do it in the test by setting up expectations, e.g.:</p>\n\n<pre><code>func TestThatYouCantLoginWithNonexistentUser(t *testing.T) {\n    userRepository := new(mocks.UserRepository)\n    userService := user.NewService(userRepository)\n    // if the userService calls UserRepository.FindByName(\"joe\"), it will return nil, since there's no such user.\n    userRepository.On(\"FindByName\", \"joe\").Return(nil)\n    _, err := userService.Login(\"joe\", \"password\")\n    // err should not be nil and the message should be \"user does not exist\"\n    assert.EqualError(t, err, \"user does not exist\")\n    // assert that the expectations were met, i.e. FindByName was called with \"joe\"\n    userRepository.AssertExpectations(t)\n}\n</code></pre>\n\n<p>This actually makes the test easy to understand, since you don't have to go check in some other file what the mock does when you call <code>FindByName(\"joe\")</code>.</p>\n"}], "owner": {"reputation": 555, "user_id": 5058168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2VxPP.png?s=128&g=1", "display_name": "RhinoLarva", "link": "https://stackoverflow.com/users/5058168/rhinolarva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1469926210, "creation_date": 1469799130, "last_edit_date": 1469799488, "question_id": 38660219, "link": "https://stackoverflow.com/questions/38660219/what-is-the-most-idiomatic-way-in-go-to-test-code-which-has-dependency-on-struct", "title": "What is the most idiomatic way in Go to test code which has dependency on structure with big amount of methods?", "body": "<p>Lets say I have a UserRepository struct which incapsulates logic for interacting with a database. This struct has a set of methods like:</p>\n\n<ul>\n<li>findAll()</li>\n<li>findById()</li>\n<li>findByName()</li>\n<li>save()</li>\n<li>and so on....</li>\n</ul>\n\n<p>There is another struct (let's call it UserService for instance) which depends on UserRepository struct.</p>\n\n<p>To test UserService I need to mock functionality of UserRepository. The only way I know to do this is to provide the interface for UserRepository and make UserService be dependent on it instead of UserRepository struct. It will allow to create a mocked implementation of interface and set it as dependency of UserService in the test.</p>\n\n<p>What is the most idiomatic way to do it?</p>\n\n<p>1) If UserService depends only on 1 UserRepository's method (let's say findAll) - should I still define an interface which will have all repository methods or it's better to define a separate interface for this method only and use it as a dependency of UserService? If so, what is the best name for it (interface)? If another struct will depend on findAll() and findById() methods should I again create another interface?</p>\n\n<p>2) Where is a best place to store mocks for these interfaces? Is it possible to reuse them? Or for tests of different structs I will need redefine the mocks?</p>\n\n<p>P.S. as for me unit tests is a very important part of the project. I would like to make them as readable as possible avoiding boilerplate code and focusing on their logic. So creating several mock implementations for same interfaces in different test files looks for me a bad option since it makes test code less readable.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1469798863, "post_id": 38660096, "comment_id": 64700950, "body": "Your tags are malformed: <code>`json:&quot;count&quot;`</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 1, "creation_date": 1469798908, "post_id": 38660143, "comment_id": 64700977, "body": "Just one note: since the Json thing wasn&#39;t done correctly the encoder was grabbing the field name."}], "tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": true, "score": 9, "last_activity_date": 1469820815, "last_edit_date": 1469820815, "creation_date": 1469798865, "answer_id": 38660143, "question_id": 38660096, "link": "https://stackoverflow.com/questions/38660096/golang-return-lower-case-json-key/38660143#38660143", "title": "Golang return lower case json key", "body": "<p>You forgot colon in tag declaration. As tags are not in proper format, field names are in your json.</p>\n\n<p>Try this:</p>\n\n<pre><code>type tableau struct {\n    Count int      `json:\"count\"`\n    Data  []People `json:\"data\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 3, "last_activity_date": 1469798952, "creation_date": 1469798952, "answer_id": 38660171, "question_id": 38660096, "link": "https://stackoverflow.com/questions/38660096/golang-return-lower-case-json-key/38660171#38660171", "title": "Golang return lower case json key", "body": "<p>Try adding a <code>:</code> to your struct tags:</p>\n\n<pre><code>type tableau struct {\n    Count int      `json:\"count\"`\n    Data  []People `json:\"data\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 116, "user_id": 5530061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9ff44f733a61d535af5ea99b1fc656?s=128&d=identicon&r=PG&f=1", "display_name": "A Laurent", "link": "https://stackoverflow.com/users/5530061/a-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1437, "favorite_count": 0, "accepted_answer_id": 38660143, "answer_count": 2, "score": 1, "last_activity_date": 1469820815, "creation_date": 1469798757, "question_id": 38660096, "link": "https://stackoverflow.com/questions/38660096/golang-return-lower-case-json-key", "title": "Golang return lower case json key", "body": "<p>I send Json data with net/http package by an Url, i want to have some lowercase keys in return, but it's not working.</p>\n\n<p>In this example of the problem, i want lowercase 'count' and 'data' key. </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n)\n\ntype tableau struct {\n    Count int      `json\"count\"`\n    Data  []People `json\"data\"`\n}\n\ntype People struct {\n    Id   int    `json\"Id\"`\n    Name string `json\"Name\"`\n    Age  int    `json\"Age\"`\n}\n\nfunc main() {\n    http.HandleFunc(\"/people\", recupPeople)\n    fs := http.FileServer(http.Dir(\"Static\"))\n    http.Handle(\"/\", fs)\n    http.ListenAndServe(\":80\", nil)\n}\n\nfunc recupPeople(w http.ResponseWriter, r *http.Request) {\n    listPeople := &amp;tableau{\n        Count: 4,\n        Data: []People{\n            People{Id: 1, Name: \"Laurent\", Age: 20},\n            People{Id: 2, Name: \"Laurent\", Age: 20},\n        },\n    }\n    peop, _ := json.Marshal(listPeople)\n    fmt.Println(string(peop))\n    w.Write(peop)\n    json.NewEncoder(w).Encode(listPeople)\n}\n</code></pre>\n\n<p>But when i check the URL i didn't have lower case.\n<a href=\"https://i.stack.imgur.com/WFGHF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WFGHF.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Cordially,\nLaurent</p>\n"}]