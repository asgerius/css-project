[{"tags": ["go"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1560384008, "post_id": 56571738, "comment_id": 99722154, "body": "Hint: your <code>Minus</code> method does not <i>really</i> update your instance of <code>Calc</code>. Can you figure out what&#39;s going on? (that&#39;s the main difference between them)"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8556012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aCZ9K.jpg?s=128&g=1", "display_name": "Vignoir", "link": "https://stackoverflow.com/users/8556012/vignoir"}, "is_accepted": false, "score": 1, "last_activity_date": 1560393023, "creation_date": 1560393023, "answer_id": 56572602, "question_id": 56571738, "link": "https://stackoverflow.com/questions/56571738/golang-type-method-with-point-and-without-pointer-difference/56572602#56572602", "title": "Golang Type method with * point and without pointer difference?", "body": "<p><code>func (c *Calc) Sum(a int, b int)</code> uses a pointer receiver, meaning any edit you make to <code>c</code> will change the variable it's called on.</p>\n\n<p><code>func (c Calc) Minus(a int, b int)</code> uses a value receiver. You can think of <code>c</code> in this instance as being only a copy of the variable it's called on. <code>c.Result = a-b</code> won't work as intended in this function. </p>\n\n<p>It is operating on a copy of the variable and not a <em>pointer</em> to the variable</p>\n"}], "owner": {"reputation": 273, "user_id": 4528308, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/43839a7150468e2715551e79491ba328?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Kedia", "link": "https://stackoverflow.com/users/4528308/robin-kedia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "closed_date": 1560403146, "answer_count": 1, "score": -1, "last_activity_date": 1560393023, "creation_date": 1560383836, "last_edit_date": 1560386284, "question_id": 56571738, "link": "https://stackoverflow.com/questions/56571738/golang-type-method-with-point-and-without-pointer-difference", "closed_reason": "Duplicate", "title": "Golang Type method with * point and without pointer difference?", "body": "<p>I'm new to golang. Just trying to understand the difference between the two methods declared for Calc type. The first function sum is declared as (c *Calc) Sum and the other one without * as (c Calc) Minus. What's the difference between the two and recommended way of writing this? </p>\n\n<p>I see the difference comes in how we call the function under main. The point * type method requires new(Calc) and the other one can be called directly by doing Calc{}.Sum.  </p>\n\n<p>Some behavioural explanation will help. </p>\n\n<pre><code>   func main() {\n\n    Calc{}.Minus(2, 2)\n    c :=new(Calc)\n    c.Sum(3, 2)\n}\n\n\ntype Calc struct{\n    Result int\n}\n\nfunc (c *Calc) Sum(a int, b int)  {\n    c.Result = a + b\n}\n\nfunc (c Calc) Minus(a int, b int) {\n    c.Result = a-b\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1568, "user_id": 4239355, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1062734612/picture?type=large", "display_name": "Zoltan King", "link": "https://stackoverflow.com/users/4239355/zoltan-king"}, "edited": false, "score": 1, "creation_date": 1560382841, "post_id": 56571538, "comment_id": 99721970, "body": "Thanks. That&#39;s a great idea. I shortened the variable names. I don&#39;t like using single letters as variable names but I think in case of a triangle they would work fine because they reflect the sides. if (a+b &gt; c) &amp;&amp; (a+c &gt; b) &amp;&amp; (b+c &gt; a)"}], "tags": [], "owner": {"reputation": 28, "user_id": 11639049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jd4hx.jpg?s=128&g=1", "display_name": "draven", "link": "https://stackoverflow.com/users/11639049/draven"}, "is_accepted": true, "score": 0, "last_activity_date": 1560381893, "creation_date": 1560381893, "answer_id": 56571538, "question_id": 56571502, "link": "https://stackoverflow.com/questions/56571502/a-program-that-checks-if-a-triangle-can-be-built-with-the-sides-of-given-lengths/56571538#56571538", "title": "A program that checks if a triangle can be built with the sides of given lengths. How can I shorten the IF conditions?", "body": "<p>If you're worried about the line length you could simply split your if statement onto multiple lines to make it more readable:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>if     (firstNum  + secondNum &gt; thirdNum)\n    &amp;&amp; (firstNum  + thirdNum  &gt; secondNum)\n    &amp;&amp; (secondNum + thirdNum  &gt; firstNum) {\n    fmt.Println(\"A triangle can be built\")\n} else {\n    fmt.Println(\"A triangle can't be built\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1568, "user_id": 4239355, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1062734612/picture?type=large", "display_name": "Zoltan King", "link": "https://stackoverflow.com/users/4239355/zoltan-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1060, "favorite_count": 0, "accepted_answer_id": 56571538, "answer_count": 1, "score": 1, "last_activity_date": 1560381893, "creation_date": 1560381601, "question_id": 56571502, "link": "https://stackoverflow.com/questions/56571502/a-program-that-checks-if-a-triangle-can-be-built-with-the-sides-of-given-lengths", "title": "A program that checks if a triangle can be built with the sides of given lengths. How can I shorten the IF conditions?", "body": "<p>I wrote a simple GO program to asks the user for three integers (firstNum, secondNum, and thirdNum). I'm using the triangle inequality to determine if a triangle can be built using those three integers:</p>\n\n<p>A (firstNum) + B (secondNum) > C (thirdNum)</p>\n\n<p>A (firstNum) + C (thirdNum) > B (secondNum)</p>\n\n<p>B (secondNum) + C (thirdNum) > A (firstNum)</p>\n\n<p>The program works fine if I use the following IF statement (see below), but the conditions make the statement a bit too long. I know I can also use nested IF statements but I'm wondering if there's a better way to do it.</p>\n\n<pre><code>if (firstNum+secondNum &gt; thirdNum) &amp;&amp; (firstNum+thirdNum &gt; secondNum) &amp;&amp; (secondNum+thirdNum &gt; firstNum) {\n    fmt.Println(\"A triangle can be built\")\n} else {\n    fmt.Println(\"A triangle can't be built\")\n}\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["docker", "go", "intellij-idea"], "comments": [{"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 1, "creation_date": 1560390372, "post_id": 56571168, "comment_id": 99723164, "body": "Just install the same dependencies on your local environment. Intellij/Golang synchronise dependencies automatically. Since you have the code that\u2019s easy and simple."}, {"owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "edited": false, "score": 0, "creation_date": 1560413307, "post_id": 56571168, "comment_id": 99730053, "body": "I&#39;ve written an answer here <a href=\"https://stackoverflow.com/questions/46724661/using-an-ide-while-developing-on-a-docker-container/48785303#48785303\">Using an IDE while developing on a docker container</a> which mentions a few things. I think it&#39;s a different problem for the various languages / frameworks out there."}], "owner": {"reputation": 350, "user_id": 5976559, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8069e64f55532678dd908c92d3387ea6?s=128&d=identicon&r=PG&f=1", "display_name": "Irindul", "link": "https://stackoverflow.com/users/5976559/irindul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560394980, "creation_date": 1560378698, "last_edit_date": 1560394980, "question_id": 56571168, "link": "https://stackoverflow.com/questions/56571168/ide-dependencies-and-auto-completion-for-docker-based-app", "title": "IDE dependencies and auto completion for docker-based app", "body": "<p>I found this <a href=\"https://stackoverflow.com/q/44748840/5976559\">StackOverflow</a> question but it wasn't answered so I ask it again.</p>\n\n<p>I have a Go project running inside a Docker container. I got my code running in the container, and I expose it via HTTP.<br>\nThe problem I have is with IntelliJ and dependencies auto-completion. Since all dependencies I have are managed by docker and downloaded inside the container, IntelliJ have no idea how to auto-complete the code and furthermore, it has no idea what methods are available so my code is full of errors in IntelliJ but runs fine in the container.</p>\n\n<p>Is there a way to configure IntelliJ to bind it to the container sources?\nMaybe with docker volumes, but I would have to setup GOPATH, etc.. on my machine, which I would prefer to avoid.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1560377757, "post_id": 56570732, "comment_id": 99720914, "body": "<a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/ListingKeysHierarchy.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/AmazonS3/latest/dev/&hellip;</a>"}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1560378554, "post_id": 56570732, "comment_id": 99721104, "body": "<a href=\"https://godoc.org/github.com/aws/aws-sdk-go/service/s3#example-S3-ListObjects-Shared00\" rel=\"nofollow noreferrer\">godoc.org/github.com/aws/aws-sdk-go/service/&hellip;</a> - Sample for GO SDK"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560433386, "post_id": 56570732, "comment_id": 99741627, "body": "Have you tried anything at all? Can you show your code?"}, {"owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "edited": false, "score": 0, "creation_date": 1560445177, "post_id": 56570732, "comment_id": 99748609, "body": "Sorry for late reply. Thank you for your help. Yes, I have tried using Listing API to list all keys with specific prefix (result of what I gett and what I was expecting is showed in the question). John has explained it nicely why I cannot get result that I desire. I managed to get the result by string manipulation when I retrieved all of the keys."}], "answers": [{"comments": [{"owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "edited": false, "score": 0, "creation_date": 1560445226, "post_id": 56572058, "comment_id": 99748635, "body": "Thank you so much for this clarification! I&#39;ve managed to get desired result by performing string manipulation (spliting strings etc.) on bucket keys."}], "tags": [], "owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "is_accepted": true, "score": 3, "last_activity_date": 1560387290, "creation_date": 1560387290, "answer_id": 56572058, "question_id": 56570732, "link": "https://stackoverflow.com/questions/56570732/aws-s3-listing-api-how-to-list-everything-inside-s3-bucket-with-specific-prefi/56572058#56572058", "title": "AWS S3 Listing API - How to list everything inside S3 Bucket with specific prefix", "body": "<p>Folders do not actually exist in Amazon S3. It is a flat object storage system.</p>\n\n<p>For example, using the <a href=\"http://aws.amazon.com/cli/\" rel=\"nofollow noreferrer\">AWS Command-Line Interface (CLI)</a> I could copy a command to an Amazon S3 bucket:</p>\n\n<pre><code>aws s3 cp foo.txt s3://my-bucket/folder1/folder2/foo.txt\n</code></pre>\n\n<p>This work just fine, even though <code>folder1</code> and <code>folder2</code> do not exist. This is because objects are stored with a <code>Key</code> (filename) that <strong>includes the full path of the object</strong>. So, the above object actually has a Key (filename) of:</p>\n\n<pre><code>folder1/folder2/foo.txt\n</code></pre>\n\n<p>However, to make things easier for humans, the Amazon S3 management console makes it <em>appear</em> as though there are folders. In S3, these are called <strong>Common Prefixes</strong> rather than folders.</p>\n\n<p>So, when you make an API call to list the contents of the bucket while specifying a <code>Prefix</code>, it simply says \"List all objects whose Key starts with this string\".</p>\n\n<p>Your listing doesn't show any folders because they don't actually exist.</p>\n\n<p>Now, just to contradict myself, it actually <em>is</em> possible to create a folder (eg by clicking <em>Create folder</em> in the management console). This actually <strong>creates a zero-length object with the same name as the folder</strong>. The folder will then appear in listings because it is actually listing the zero-length object rather than the folder.</p>\n\n<p>This is probably why <code>Item1/Item2/</code> appears in your listing, but <code>Item1/Item2/Item3</code> does not. Somebody, at some stage, must have \"created a folder\" called <code>Item1/Item2/</code>, which actually created a zero-length object with that Key.</p>\n"}], "owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 56572058, "answer_count": 1, "score": 0, "last_activity_date": 1560387290, "creation_date": 1560375688, "last_edit_date": 1560378582, "question_id": 56570732, "link": "https://stackoverflow.com/questions/56570732/aws-s3-listing-api-how-to-list-everything-inside-s3-bucket-with-specific-prefi", "title": "AWS S3 Listing API - How to list everything inside S3 Bucket with specific prefix", "body": "<p>I am trying to list all items with specific <code>prefix</code> in S3 bucket. Here is directory structure that I have:</p>\n\n<pre><code>Item1/\n     Item2/\n          Item3/\n               Item4/\n                     image_1.jpg\n               Item5/\n                     image_1.jpg\n                     image_2.jpg\n</code></pre>\n\n<p>When I set <code>prefex</code> to be <code>Item1/Item2</code>, I get as a result following keys:</p>\n\n<pre><code>Item1/Item2/\nItem1/Item2/Item3/Item4/image_1.jpg\nItem1/Item2/Item3/Item5/image_1.jpg\nItem1/Item2/Item3/Item5/image_2.jpg\n</code></pre>\n\n<p>What I would like to get is:</p>\n\n<pre><code>Item1/Item2/\nItem1/Item2/Item3\nItem1/Item2/Item3/Item4\nItem1/Item2/Item3/Item5\nItem1/Item2/Item3/Item4/image_1.jpg\nItem1/Item2/Item3/Item5/image_1.jpg\nItem1/Item2/Item3/Item5/image_2.jpg\n</code></pre>\n\n<p>Is there anyway to achieve this in golang?</p>\n"}, {"tags": ["function", "go", "interface"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1560372817, "post_id": 56570184, "comment_id": 99719481, "body": "Use type assertion, or instead of <code>[]interface{}</code> define your slice as <code>[]Parent</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1560372987, "post_id": 56570184, "comment_id": 99719544, "body": "Not sure if the names are just random but remember that interfaces and concrete types <i>do not have</i> a parent/child relationship."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1560403264, "post_id": 56570184, "comment_id": 99725722, "body": "Stop trying to mimic inheritance. There is NO inheritance in Go and literally <i>any</i> attempt to fake it will lead to disaster. Do not even try! You will fail!"}], "answers": [{"tags": [], "owner": {"reputation": 418, "user_id": 4893628, "user_type": "registered", "profile_image": "https://graph.facebook.com/1761892217370604/picture?type=large", "display_name": "Daniela Petruzalek", "link": "https://stackoverflow.com/users/4893628/daniela-petruzalek"}, "is_accepted": false, "score": 1, "last_activity_date": 1560373686, "creation_date": 1560373686, "answer_id": 56570389, "question_id": 56570184, "link": "https://stackoverflow.com/questions/56570184/object-added-to-interface-now-need-to-fetch-the-object-and-call-the-object/56570389#56570389", "title": "Object added to []interface{}. Now need to fetch the object and call the Object\u2019s respective Display() fn", "body": "<p>There are two ways you can do this: one is by instead of using the empty interface you use the proper Parent interface to declare the slice:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Maintains the created objects\nvar availableObjs []Parent\n</code></pre>\n\n<p>Please note that the naming of <code>Parent</code> for your interface suggests that you are approaching interfaces with the concept of inheritance, which is not something we use in Go. You must think of interfaces more like a behaviour. In this particular case, you want to represent the behaviour of something capable of \"displaying\", so you may well call the interface <code>Displayer</code>.</p>\n\n<p>This naming convention, appending <code>-er</code> to the interface name, is a very common pattern in Go, even though sometimes you get some strange names :)</p>\n\n<p>In the same sense, the <code>Child</code> structs are not actually children of the Parent interface, they are just structs that implicitly satisfy the interface. </p>\n\n<p>They could satisfy any number of interfaces at the same time. For instance, if they had a String() method they would also satisfy the <code>fmt.Stringer</code> interface.</p>\n\n<p>Now, the second option is to use a type assertion, either with a switch statement or a type statement:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>switch t := obj.(type) {\ncase Parent:\n    t.Display() // note that 't' is the new typed variable\n}\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>t, ok := obj.(Parent)\nif ok {\n    t.Display()\n}\n</code></pre>\n\n<p>Please note that the <code>ok</code> variable above can be omitted, but in that case the code will panic if the type assertion doesn't match.</p>\n"}], "owner": {"reputation": 47, "user_id": 4144823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f66dff93e0d126af3f1fffc5debd2f18?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/4144823/rohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1560373686, "creation_date": 1560372669, "question_id": 56570184, "link": "https://stackoverflow.com/questions/56570184/object-added-to-interface-now-need-to-fetch-the-object-and-call-the-object", "title": "Object added to []interface{}. Now need to fetch the object and call the Object\u2019s respective Display() fn", "body": "<p>I have done the following:</p>\n\n<ul>\n<li>Defined a \"Parent\" interface with Display() fn.</li>\n<li>Created 2 Child structs which implement their respective Display() fn.</li>\n<li>In main(), created 2 child objects and added them to : <code>availableObjs[]interface{}</code></li>\n<li>Now, in For loop, want to take the object and call its respective Display() function. This is where I am struck at.</li>\n</ul>\n\n<p><strong>GoPlayground Code :</strong> <a href=\"https://play.golang.org/p/jdHpueokrEk\" rel=\"nofollow noreferrer\">https://play.golang.org/p/jdHpueokrEk</a></p>\n\n<p>Tried searching online.</p>\n\n<p><strong>Same Code inline :</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\n////// Parent Interface which has Display() fn.\ntype Parent interface {\n    Display()\n}\n\n// 2 Child structs implementing their Display() fn.\ntype Child1 struct {\n    name1 string\n}\n\ntype Child2 struct {\n    name2 string\n}\n\nfunc (c1 Child1) Display() {\n    fmt.Println(\"c1Name : \", c1.name1)\n}\n\nfunc (c2 Child2) Display() {\n    fmt.Println(\"c2Name : \", c2.name2)\n}\n////////////////////////////////////////////\n\n// Maintains the created objects\nvar availableObjs []interface{}\n\nfunc main() {\n    //// Creating 2 objects\n    c1 := Child1{\"Child1\"}\n    c2 := Child2{\"Child2\"}\n\n    // Adding 2 objects to availableObjs\n    availableObjs = append(availableObjs, c1)\n    availableObjs = append(availableObjs, c2)\n\n    // Now, want to fetch the Object from Interface and call its respective Display() fn.\n    for _, obj := range availableObjs {\n            fmt.Println(\"\")\n        fmt.Println(\"Obj Got = \",obj)\n        fmt.Println(\"Obj type = \",reflect.TypeOf(obj))\n        //obj.Display()        //  &lt;-- Problem Line \n    }\n}\n</code></pre>\n\n<p><strong>Need to do :</strong> Need inputs on how I can call Display() function after getting object from array interface.</p>\n"}, {"tags": ["go", "keep-alive", "tcp-keepalive"], "comments": [{"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1560373804, "post_id": 56569911, "comment_id": 99719799, "body": "Please share some code to show us how you open and close connections and how your server is configured."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1560374174, "post_id": 56569911, "comment_id": 99719915, "body": "You never close the connection on the server side. Your <code>defer c.Close()</code> is to be run when <code>main()</code> returns."}, {"owner": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "edited": false, "score": 0, "creation_date": 1560374176, "post_id": 56569911, "comment_id": 99719916, "body": "Updated with some code. Everything is pretty simple there, the only configuration on the server is turning on keep-alive and setting its period."}, {"owner": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1560374367, "post_id": 56569911, "comment_id": 99719966, "body": "@zerkms, it&#39;s a persistent connection, thus the point is keep it open as long as possible, and keep-alive supposed to identify if it&#39;s been (abruptly) terminated from the other end. That&#39;s why closing it at the very end."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1560374402, "post_id": 56569911, "comment_id": 99719979, "body": "@surlac what&#39;s your question again then? The connection is not closed because you don&#39;t close it. &quot;1) What is the reason that it keeps sending probes?&quot; --- you don&#39;t close the connection, so it&#39;s open and keepalive packets are sent. &quot;2) how to properly terminate connection from client-side on Go level?&quot; --- both parties should close the connection."}, {"owner": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "edited": false, "score": 0, "creation_date": 1560374523, "post_id": 56569911, "comment_id": 99720015, "body": "So I see that keep-alive packets travel from server to client during wait period of 60s as expected. But if connection is closed from client side, server doesn&#39;t notice it and keeps sending keep-alive packets to the same client port. The question is - why."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1560374678, "post_id": 56569911, "comment_id": 99720062, "body": "Because that&#39;s how tcp works: <code>FIN</code> from client means &quot;I won&#39;t send anything but still can receive&quot;"}, {"owner": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1560374685, "post_id": 56569911, "comment_id": 99720063, "body": "@zerkms, &quot;both parties should close the connection&quot; - this contradicts the purpose of keep-alive, because conn can be broken without parties noticing it for minutes or hours, which is the problem keep-alive tries to solve."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1560374730, "post_id": 56569911, "comment_id": 99720072, "body": "@surlac &quot;this contradicts the purpose of keep-alive&quot; --- it does not. What you observe works &quot;as designed&quot;."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1560388884, "post_id": 56569911, "comment_id": 99722950, "body": "@surfac If &#39;the point is to keep it open as long as possible&#39;, why is the client closing it?myour question doesn&#39;t make sense."}, {"owner": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1560471070, "post_id": 56569911, "comment_id": 99757374, "body": "@zerkms, keepalive in code above doesn&#39;t detect dead peers, while filipe claims that it does for him. Which is what I&#39;m trying to understand. If you have any useful comments about it, feel free to chime in."}, {"owner": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1560471083, "post_id": 56569911, "comment_id": 99757381, "body": "@user207421 it&#39;s a simplified example to check dead peers detection, you can abruptly terminate client to simulate dead peer."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1560473672, "post_id": 56569911, "comment_id": 99757837, "body": "@surlac it definitely detects as long as the peer is really unavailable: after timeout the server sends <code>RST</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "edited": false, "score": 0, "creation_date": 1560380733, "post_id": 56570977, "comment_id": 99721574, "body": "+1. Appreciate answer. How do you detect that it sent 8 times? Does it return io.EOF on <code>c.Read(b)</code>? I ran in debian, it sent probes 15 times with interval 5 sec after 5 sec idle and then staying there, server didn&#39;t get EOF. Similar behavior on macOS - 27 times with 5 sec interval and 5 sec idle. Trying to understand what I&#39;m doing differently. Thanks."}, {"owner": {"reputation": 1558, "user_id": 11265949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x7xqr.png?s=128&g=1", "display_name": "filipe", "link": "https://stackoverflow.com/users/11265949/filipe"}, "reply_to_user": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "edited": false, "score": 0, "creation_date": 1560383619, "post_id": 56570977, "comment_id": 99722081, "body": "Yes, it return io.EOF on c.Read(b). The number of keepalive proves are set at kernel level. If you type <code>sudo sysctl -A | grep keep</code> you can read the values and if you look at go lang <a href=\"https://github.com/golang/go/search?p=1&amp;q=setKeepAlivePeriod&amp;unscoped_q=setKeepAlivePeriod\" rel=\"nofollow noreferrer\">source code</a> you can see the implementation and the parameters used."}, {"owner": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "edited": false, "score": 0, "creation_date": 1560470329, "post_id": 56570977, "comment_id": 99757260, "body": "I&#39;ve gone through the articles you added. Still wondering why <code>Read</code> never returns <code>EOF</code> in my case, I see <code>FIN</code> returned back to server though. The only possible reason I see for explicitly terminating connection in your case - someone is sending <code>RST</code> (e.g. proxy)."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "edited": false, "score": 0, "creation_date": 1560473811, "post_id": 56570977, "comment_id": 99757857, "body": "@surlac that&#39;s by TCP design as well: to close a connection <b>both</b> parties must FIN + ACK, or either may RST."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "edited": false, "score": 0, "creation_date": 1560473937, "post_id": 56570977, "comment_id": 99757875, "body": "@surlac another thing worth mentioning: you only read from the connection <b>ONCE</b>, so no wondering you don&#39;t see <code>io.EOF</code> anywhere given you don&#39;t read anything."}], "tags": [], "owner": {"reputation": 1558, "user_id": 11265949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x7xqr.png?s=128&g=1", "display_name": "filipe", "link": "https://stackoverflow.com/users/11265949/filipe"}, "is_accepted": false, "score": 1, "last_activity_date": 1560388127, "last_edit_date": 1560388127, "creation_date": 1560377255, "answer_id": 56570977, "question_id": 56569911, "link": "https://stackoverflow.com/questions/56569911/keep-alive-dead-peers-detection/56570977#56570977", "title": "Keep-alive: dead peers detection", "body": "<p>The response to that question:</p>\n\n<p>Sending keepalives is only necessary when you need the connection opened but idle. In that cases there is a risk that the connection is broken, so keep alive will try to detect broken connections.</p>\n\n<p>If you had close the connection at server side with a proper con.Close() the keep alive would not be triggered (you did defer it to the end of the main function).</p>\n\n<p>If you test your server code, it will start sending the keep alive <strong>after the timeout</strong> you set.</p>\n\n<p>You notice that only after all keep alive proves (default 9 from kernel) and the time between the proves (8x), <strong>you get an io.EOF error</strong> on the server side Read (yes, the server stop sending)!</p>\n\n<p>Currently the GO implementation is the same at Linux and OSX and it set both <code>TCP_KEEPINTVL</code> and <code>TCP_KEEPIDLE</code> to the value you pass to the <code>setKeepAlivePeriod</code> function, so, the behavior will depend of the kernel version.</p>\n\n<pre><code>func setKeepAlivePeriod(fd *netFD, d time.Duration) error {\n    // The kernel expects seconds so round to next highest second.\n    d += (time.Second - time.Nanosecond)\n    secs := int(d.Seconds())\n    if err := fd.pfd.SetsockoptInt(syscall.IPPROTO_TCP, syscall.TCP_KEEPINTVL, secs); err != nil {\n        return wrapSyscallError(\"setsockopt\", err)\n    }\n    err := fd.pfd.SetsockoptInt(syscall.IPPROTO_TCP, syscall.TCP_KEEPIDLE, secs)\n    runtime.KeepAlive(fd)\n    return wrapSyscallError(\"setsockopt\", err)\n}\n</code></pre>\n\n<p>There is a request opened since 2014 to <a href=\"https://github.com/golang/go/issues/8328\" rel=\"nofollow noreferrer\">provide a way to set keepalive time and interval separately</a>.</p>\n\n<p>Some references: </p>\n\n<ul>\n<li><a href=\"https://tools.ietf.org/html/rfc1122#page-101\" rel=\"nofollow noreferrer\">rfc1122</a></li>\n<li><a href=\"https://github.com/golang/go/issues/23459\" rel=\"nofollow noreferrer\">net: enable TCP keepalive on new connections from net.Dial</a></li>\n<li><a href=\"https://go-review.googlesource.com/c/go/+/107196/\" rel=\"nofollow noreferrer\">net: enable TCP keepalives by default</a></li>\n<li><a href=\"https://stackoverflow.com/questions/21358800/tcp-keep-alive-to-determine-if-client-disconnected-in-netty\">TCP keep-alive to determine if client disconnected in netty\n</a></li>\n<li><a href=\"https://felixge.de/2014/08/26/tcp-keepalive-with-golang.html\" rel=\"nofollow noreferrer\">Using TCP keepalive with Go</a></li>\n</ul>\n"}], "owner": {"reputation": 2893, "user_id": 506598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f98a2f13a970c7eca6b623117d2b34f5?s=128&d=identicon&r=PG", "display_name": "surlac", "link": "https://stackoverflow.com/users/506598/surlac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 883, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1560471338, "creation_date": 1560371239, "last_edit_date": 1560471338, "question_id": 56569911, "link": "https://stackoverflow.com/questions/56569911/keep-alive-dead-peers-detection", "title": "Keep-alive: dead peers detection", "body": "<p>I run client and socket server written in Go (1.12) on macOS localhost.  </p>\n\n<p>Server sets SetKeepAlive and SetKeepAlivePeriod on net.TCPConn.<br>\nClient sends a packet and then closes connection (<code>FIN</code>) or client abruptly terminated.    </p>\n\n<p>Tcpdump shows that even after client closes the connection, server keeps sending keep-alive probes.<br>\nShouldn't it detect that peer is \"dead\" and close the connection?</p>\n\n<p>The question is generic, feel free to clarify if I'm missing some basics.</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"net\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    var client bool\n    flag.BoolVar(&amp;client, \"client\", false, \"\")\n    flag.Parse()\n\n    if client {\n        fmt.Println(\"Client mode\")\n        conn, err := net.Dial(\"tcp\", \"127.0.0.1:12345\")\n        checkErr(\"Dial\", err)\n\n        written, err := conn.Write([]byte(\"howdy\"))\n        checkErr(\"Write\", err)\n\n        fmt.Printf(\"Written: %v\\n\", written)\n        fmt.Println(\"Holding conn\")\n\n        time.Sleep(60 * time.Second)\n\n        err = conn.Close()\n        checkErr(\"Close\", err)\n\n        fmt.Println(\"Closed conn\")\n\n        return\n    }\n\n    fmt.Println(\"Server mode\")\n    l, err := net.Listen(\"tcp\", \"127.0.0.1:12345\")\n    checkErr(\"listen\", err)\n    defer l.Close()\n\n    for {\n        c, err := l.Accept()\n        checkErr(\"accept\", err)\n        defer c.Close()\n\n        tcpConn := c.(*net.TCPConn)\n        err = tcpConn.SetKeepAlive(true)\n        checkErr(\"SetKeepAlive\", err)\n        err = tcpConn.SetKeepAlivePeriod(5 * time.Second)\n        checkErr(\"SetKeepAlivePeriod\", err)\n\n        b := make([]byte, 1024)\n\n        n, err := c.Read(b)\n        checkErr(\"read\", err)\n\n        fmt.Printf(\"Received: %v\\n\", string(b[:n]))\n    }\n}\n\nfunc checkErr(location string, err error) {\n    if err != nil {\n        fmt.Printf(\"%v: %v\\n\", location, err)\n        os.Exit(-1)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "amazon-dynamodb", "dynamodb-queries", "amazon-dynamodb-index"], "answers": [{"comments": [{"owner": {"reputation": 702, "user_id": 1053263, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e2fb058c0cd205f8abf24fc84cb738a7?s=128&d=identicon&r=PG", "display_name": "user1053263", "link": "https://stackoverflow.com/users/1053263/user1053263"}, "edited": false, "score": 0, "creation_date": 1560393162, "post_id": 56572559, "comment_id": 99723674, "body": "I don&#39;t know how I missed that field. Worked perfect, Thank you!"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 3, "last_activity_date": 1560392518, "creation_date": 1560392518, "answer_id": 56572559, "question_id": 56569183, "link": "https://stackoverflow.com/questions/56569183/query-a-secondary-index-on-dynamodb-in-golang/56572559#56572559", "title": "Query a Secondary Index on DynamoDB in Golang", "body": "<p>In addition to the TableName, You need to also specify the <code>IndexName</code> property when creating the QueryInput to query the index.</p>\n\n<p><a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/dynamodb/#QueryInput\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/dynamodb/#QueryInput</a></p>\n\n<pre><code>// The name of an index to query. This index can be any local secondary index\n// or global secondary index on the table. Note that if you use the IndexName\n// parameter, you must also provide TableName.\nIndexName *string `min:\"3\" type:\"string\"`\n</code></pre>\n"}], "owner": {"reputation": 702, "user_id": 1053263, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e2fb058c0cd205f8abf24fc84cb738a7?s=128&d=identicon&r=PG", "display_name": "user1053263", "link": "https://stackoverflow.com/users/1053263/user1053263"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2772, "favorite_count": 1, "accepted_answer_id": 56572559, "answer_count": 1, "score": 2, "last_activity_date": 1560392518, "creation_date": 1560367819, "question_id": 56569183, "link": "https://stackoverflow.com/questions/56569183/query-a-secondary-index-on-dynamodb-in-golang", "title": "Query a Secondary Index on DynamoDB in Golang", "body": "<p>My primary key is a field called \"id\"</p>\n\n<p>I've added a secondary index to my table on the field \"group_number\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/lKbQf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lKbQf.png\" alt=\"enter image description here\"></a></p>\n\n<p>I query via the secondary index like so:</p>\n\n<pre><code>// Query the secondary index\nqueryInput := &amp;dynamodb.QueryInput{\n    TableName: aws.String(c.GetDynamoDBTableName()),\n    KeyConditions: map[string]*dynamodb.Condition{\n        \"group_number\": {\n            ComparisonOperator: aws.String(\"EQ\"),\n            AttributeValueList: []*dynamodb.AttributeValue{\n                {\n                    S: aws.String(c.GroupNumber),\n                },\n            },\n        },\n    },\n}\n</code></pre>\n\n<p>However; I get the error \"validationexception: query condition missed key schema element: id\"</p>\n\n<p>Does DynamoDB only allow the querying of primary keys? \nI was under the impression you use \"GetItem\" for primary key being that only one record can come back if you use a primary key. To search via secondary indexes you use \"Query\", and to search by non-index keys, you use \"Scan\".</p>\n\n<p>Please let me know what I'm doing incorrectly here. </p>\n"}, {"tags": ["go", "sqlx"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560366478, "post_id": 56568799, "comment_id": 99716834, "body": "Use <code>ANY</code> instead of <code>IN</code>."}, {"owner": {"reputation": 107, "user_id": 11513919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Fm37GZKH8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reUwLtoKDncJwrABPekqr8NUpMkKw/mo/photo.jpg?sz=128", "display_name": "grhn", "link": "https://stackoverflow.com/users/11513919/grhn"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560366717, "post_id": 56568799, "comment_id": 99716933, "body": "<code>ANY</code> yields the same error."}, {"owner": {"reputation": 1711, "user_id": 5132823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/68f4a9e7967e8e95cf08a7bbdb06bc85?s=128&d=identicon&r=PG&f=1", "display_name": "R.S.", "link": "https://stackoverflow.com/users/5132823/r-s"}, "edited": false, "score": 0, "creation_date": 1560366909, "post_id": 56568799, "comment_id": 99717023, "body": "given this answer <a href=\"https://stackoverflow.com/questions/53983170/sql-converting-argument-1-type-unsupported-type-int-a-slice-of-in\" title=\"sql converting argument 1 type unsupported type int a slice of in\">stackoverflow.com/questions/53983170/&hellip;</a> I think if  the number of elements in threadIDs is fixed then using multiple ?s and threadID[1],threadIDs[2] etc will also work."}, {"owner": {"reputation": 107, "user_id": 11513919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Fm37GZKH8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reUwLtoKDncJwrABPekqr8NUpMkKw/mo/photo.jpg?sz=128", "display_name": "grhn", "link": "https://stackoverflow.com/users/11513919/grhn"}, "reply_to_user": {"reputation": 1711, "user_id": 5132823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/68f4a9e7967e8e95cf08a7bbdb06bc85?s=128&d=identicon&r=PG&f=1", "display_name": "R.S.", "link": "https://stackoverflow.com/users/5132823/r-s"}, "edited": false, "score": 0, "creation_date": 1560366986, "post_id": 56568799, "comment_id": 99717063, "body": "@R.S. the number of <code>threadIDs</code> is not fixes. It&#39;s user submitted data."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560366994, "post_id": 56568799, "comment_id": 99717066, "body": "You&#39;ll need to turn the slice of ints into a string representing an array and then cast the parameter reference in the query, like here: <a href=\"https://stackoverflow.com/questions/38036752/go-and-in-clause-in-postgres\" title=\"go and in clause in postgres\">stackoverflow.com/questions/38036752/&hellip;</a>. Or alternatively use <code>sqlx</code>&#39;s <code>In</code> helper, like here: <a href=\"https://stackoverflow.com/questions/40565805/how-to-use-sqlx-to-query-mysql-in-a-slice\" title=\"how to use sqlx to query mysql in a slice\">stackoverflow.com/questions/40565805/&hellip;</a>"}, {"owner": {"reputation": 107, "user_id": 11513919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Fm37GZKH8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reUwLtoKDncJwrABPekqr8NUpMkKw/mo/photo.jpg?sz=128", "display_name": "grhn", "link": "https://stackoverflow.com/users/11513919/grhn"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560367144, "post_id": 56568799, "comment_id": 99717124, "body": "@mkopriva, I could not figure out how to use this answer <a href=\"https://stackoverflow.com/questions/40565805/how-to-use-sqlx-to-query-mysql-in-a-slice\" title=\"how to use sqlx to query mysql in a slice\">stackoverflow.com/questions/40565805/&hellip;</a> in my particular use case. I appreciate if you elaborate the answer with code."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560367634, "post_id": 56568799, "comment_id": 99717326, "body": "... also if you don&#39;t want to manually convert the slice you can use something like <code>pq.Array</code> or <code>pq.Int64Array</code> or if <code>sqlx</code> has some equivalent to that use that. Have you tried this <a href=\"https://play.golang.com/p/Qwqb_v2oSZ0\" rel=\"nofollow noreferrer\">play.golang.com/p/Qwqb_v2oSZ0</a>? What error do you get if you do?"}, {"owner": {"reputation": 107, "user_id": 11513919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Fm37GZKH8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reUwLtoKDncJwrABPekqr8NUpMkKw/mo/photo.jpg?sz=128", "display_name": "grhn", "link": "https://stackoverflow.com/users/11513919/grhn"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560367838, "post_id": 56568799, "comment_id": 99717423, "body": "@mkopriva the playground code gives <code>database.SQL.In undefined (type *sqlx.DB has no field or method In)</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560367915, "post_id": 56568799, "comment_id": 99717462, "body": "It&#39;s just example code you should try on your own machine, playground doesn&#39;t have a database to connect to, neither does it support 3rd party package imports, at least not yet."}, {"owner": {"reputation": 107, "user_id": 11513919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Fm37GZKH8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reUwLtoKDncJwrABPekqr8NUpMkKw/mo/photo.jpg?sz=128", "display_name": "grhn", "link": "https://stackoverflow.com/users/11513919/grhn"}, "edited": false, "score": 0, "creation_date": 1560368301, "post_id": 56568799, "comment_id": 99717647, "body": "I tried that on my own machine!"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1560368587, "post_id": 56568799, "comment_id": 99717762, "body": "@grhn my bad I misunderstood your comment, and also it should be <code>sqlx.In</code> not <code>database.SQL.In</code> in that code."}, {"owner": {"reputation": 107, "user_id": 11513919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Fm37GZKH8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reUwLtoKDncJwrABPekqr8NUpMkKw/mo/photo.jpg?sz=128", "display_name": "grhn", "link": "https://stackoverflow.com/users/11513919/grhn"}, "edited": false, "score": 0, "creation_date": 1560368810, "post_id": 56568799, "comment_id": 99717854, "body": "Great! This modified one works. <code>query := &quot;UPDATE message SET recipient_deleted=? WHERE recipient_id=? AND thread_id IN (?)&quot;  \tqry, args, err := sqlx.In(query, 1, userID, threadIDs) \tif err != nil { \t\tpanic(err) \t}  \tif _, err := database.SQL.Exec(qry, args...); err != nil { \t\tpanic(err) \t}</code>  please answer and I&#39;ll accept it. Thank you so much!"}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 7172191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noKs5.jpg?s=128&g=1", "display_name": "Juan Chan", "link": "https://stackoverflow.com/users/7172191/juan-chan"}, "edited": false, "score": 0, "creation_date": 1577275129, "post_id": 56569925, "comment_id": 105133411, "body": "You should rebind your <code>qry</code> before <code>Exec</code>. Just like: <code>database.SQL.Exec(database.SQL.Rebind(qry), args...)</code>"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1560371320, "creation_date": 1560371320, "answer_id": 56569925, "question_id": 56568799, "link": "https://stackoverflow.com/questions/56568799/how-to-update-multiple-rows-using-sqlx/56569925#56569925", "title": "How to update multiple rows using sqlx?", "body": "<p>You can use <a href=\"https://godoc.org/github.com/jmoiron/sqlx#In\" rel=\"nofollow noreferrer\"><code>sqlx.In</code></a> which returns a new query and a new args slice that you then use instead of your original values, like so:</p>\n\n<pre><code>query := \"UPDATE message SET recipient_deleted=? WHERE recipient_id=? AND thread_id IN (?)\"\n\nqry, args, err := sqlx.In(query, 1, userID, threadIDs)\nif err != nil {\n    panic(err)\n}\n\nif _, err := database.SQL.Exec(qry, args...); err != nil {\n    panic(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 11513919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Fm37GZKH8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reUwLtoKDncJwrABPekqr8NUpMkKw/mo/photo.jpg?sz=128", "display_name": "grhn", "link": "https://stackoverflow.com/users/11513919/grhn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1731, "favorite_count": 0, "accepted_answer_id": 56569925, "answer_count": 1, "score": 0, "last_activity_date": 1560371320, "creation_date": 1560366110, "last_edit_date": 1560367663, "question_id": 56568799, "link": "https://stackoverflow.com/questions/56568799/how-to-update-multiple-rows-using-sqlx", "title": "How to update multiple rows using sqlx?", "body": "<p>I'd like to update multiple rows in a single query:</p>\n\n<pre><code>//threadIDs is a variable length slice of integers like [3 5 6]\nquery := \"UPDATE message SET recipient_deleted=? WHERE recipient_id=? AND thread_id IN ?\"\n_, err := database.SQL.Exec( query, 1, userID, threadIDs)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>But I get this runtime error:</p>\n\n<pre><code>sql: converting argument $3 type: unsupported type []int, a slice of int\n</code></pre>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["elasticsearch", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1560359338, "post_id": 56566105, "comment_id": 99713758, "body": "&quot;I cannot create a struct of all the fields.&quot; Why not? The entire source is obviously stored in hit.Source, JSON encoded. It&#39;s not clear what the actual problem is."}, {"owner": {"reputation": 3, "user_id": 11492327, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-51SYyJ4Sih4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcO5twttf-OZCriYblwDdmG1WELGw/mo/photo.jpg?sz=128", "display_name": "Mohan Kumar", "link": "https://stackoverflow.com/users/11492327/mohan-kumar"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1560399554, "post_id": 56566105, "comment_id": 99724779, "body": "I dont want to unmarshall it against any struct, i just want the json response"}], "answers": [{"tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": false, "score": 0, "last_activity_date": 1560496330, "creation_date": 1560496330, "answer_id": 56593201, "question_id": 56566105, "link": "https://stackoverflow.com/questions/56566105/how-to-retrieve-the-entire-source-of-search-hit-in-elasticsearch-golang-client/56593201#56593201", "title": "How to retrieve the entire source of search hit in elasticsearch golang client?", "body": "<p>If I understand correctly, you do not want to unmarshal the json result - you just want access to the value.</p>\n\n<p>The search operation returns a <code>SearchHit</code> result <a href=\"https://godoc.org/github.com/olivere/elastic#SearchHit\" rel=\"nofollow noreferrer\">docs here</a></p>\n\n<p>Which has a field</p>\n\n<pre><code>type SearchHit struct {\n    // trimmed\n    Source         json.RawMessage                `json:\"_source,omitempty\"`         \n\n}\n</code></pre>\n\n<p>A <code>json.RawMessage</code> is just a <code>[]byte</code>, <a href=\"https://godoc.org/encoding/json#RawMessage\" rel=\"nofollow noreferrer\">docs here</a>. </p>\n\n<p>So to get it as a string, you could do:</p>\n\n<pre><code>s := string(hit.Source)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11492327, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-51SYyJ4Sih4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcO5twttf-OZCriYblwDdmG1WELGw/mo/photo.jpg?sz=128", "display_name": "Mohan Kumar", "link": "https://stackoverflow.com/users/11492327/mohan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560496330, "creation_date": 1560354637, "question_id": 56566105, "link": "https://stackoverflow.com/questions/56566105/how-to-retrieve-the-entire-source-of-search-hit-in-elasticsearch-golang-client", "title": "How to retrieve the entire source of search hit in elasticsearch golang client?", "body": "<p>I have an index with too many fields like one docs has 6 fields and other has different number of fields, together there are nearly thousand different fields on total.</p>\n\n<p>i followed this <a href=\"https://github.com/olivere/elastic/wiki/Search\" rel=\"nofollow noreferrer\">https://github.com/olivere/elastic/wiki/Search</a>, it works fine but i cannot create a struct of all the fields and do <code>json.Unmarshal(*hit.Source, &amp;t)</code> on that.\nis there any way i can retrieve entire source with out the fields struct.</p>\n\n<p>i use elasticsearch version -7 and olivre elasticsearch golang library.</p>\n"}, {"tags": ["go", "smtp", "email-attachments", "mime"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560354092, "post_id": 56565594, "comment_id": 99711195, "body": "This seems unnecessarily manual - have you looked at the <a href=\"https://golang.org/pkg/net/smtp/\" rel=\"nofollow noreferrer\">standard library&#39;s SMTP package</a> or at the popular 3rd-party <a href=\"https://github.com/go-gomail/gomail\" rel=\"nofollow noreferrer\">gomail package</a>?"}, {"owner": {"reputation": 3020, "user_id": 1264920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6401cada72e3e86775c409db49e6befb?s=128&d=identicon&r=PG", "display_name": "TPPZ", "link": "https://stackoverflow.com/users/1264920/tppz"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1560354538, "post_id": 56565594, "comment_id": 99711438, "body": "I am using <code>net&#47;smtp</code> from the Go standard library which from those docs states &quot;the net/smtp package are low-level mechanisms and provide no support for DKIM signing, MIME attachments (see the mime/multipart package), or other mail functionality&quot;. Also: I am trying to avoid to use a 3rd party library to keep things minimal and not having to deal with dependency management. That library is not currently maintained, this fork is maintained: <a href=\"https://github.com/go-mail/mail\" rel=\"nofollow noreferrer\">github.com/go-mail/mail</a>"}], "answers": [{"tags": [], "owner": {"reputation": 70, "user_id": 4902496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9521a1df3945b0fa064cedcebe6278?s=128&d=identicon&r=PG&f=1", "display_name": "chopper24", "link": "https://stackoverflow.com/users/4902496/chopper24"}, "is_accepted": true, "score": 1, "last_activity_date": 1581956186, "creation_date": 1581956186, "answer_id": 60266450, "question_id": 56565594, "link": "https://stackoverflow.com/questions/56565594/email-message-with-no-body-part-when-attaching-a-file-and-sending-via-smtp-in-go/60266450#60266450", "title": "Email message with no body part when attaching a file and sending via SMTP in Golang", "body": "<p>Coincidentally I had a similar issue the other day. I needed a blank line between the body content type and the beginning of the body itself. Below is the updated lines for this section of your code:</p>\n\n<pre><code>    mime.WriteString(\"Content-Type: text/plain; charset=utf-8\\r\\n\")\n    mime.WriteString(\"\\r\\nThis should be the email message body (v2)...\")\n</code></pre>\n\n<p>For clarity, this newline (\\r\\n) doesn't have to be exactly here, it can be appended to the content-type line above. It just needs to see a blank line between the content-type and the beginning of the body.</p>\n\n<p>I'm assuming the attachment is being attached without problems, correct? My assumption is this is because you have the double new-line at the end of the content-disposition line before the attachment data is added.</p>\n"}], "owner": {"reputation": 3020, "user_id": 1264920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6401cada72e3e86775c409db49e6befb?s=128&d=identicon&r=PG", "display_name": "TPPZ", "link": "https://stackoverflow.com/users/1264920/tppz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 1, "accepted_answer_id": 60266450, "answer_count": 1, "score": 1, "last_activity_date": 1581956186, "creation_date": 1560352847, "question_id": 56565594, "link": "https://stackoverflow.com/questions/56565594/email-message-with-no-body-part-when-attaching-a-file-and-sending-via-smtp-in-go", "title": "Email message with no body part when attaching a file and sending via SMTP in Golang", "body": "<p>I am trying to send an email message with both an email body and a file attachment (a CSV file) in Go (Golang).</p>\n\n<p>I am following the <code>mime</code> standard of a multi-part message, however I am not  very familiar with the structure of the messages following that standard. I am vaguely following a Python code snippet from a colleague as a guide which is using the Python library <code>email</code> (I think this is from the standard library) e.g. <code>MIMEText</code> and <code>MIMEMultipart</code>.</p>\n\n<p><strong>The email message body is not showing up</strong> when executing the following Go code:</p>\n\n<ul>\n<li>What is wrong with it?</li>\n<li>How can I send an email message with both that file attachment and an email message body?</li>\n</ul>\n\n<p>This function should return a byte slice to be used as a parameter for the call to <code>smtp.SendMail</code> from the Go standard library. See the comments below explaining what's happening to the received email message (the <code>THIS DOES NOT SHOW UP [...]</code> and the <code>THIS ALSO DOES NOT SHOW UP [...]</code>).</p>\n\n<pre><code>func msgWithAttachment(subject, filePath string) ([]byte, error) {\n    // this is the separator used for the various parts of the MIME message structure\n    // identified as \"boundary\"\n    bPlaceholder := \"our-custom-separator\"\n\n    // the message setup of the common/standard initial part\n    mime := bytes.NewBuffer(nil)\n    mime.WriteString(fmt.Sprintf(\"Subject: %s\\r\\nMIME-Version: 1.0\\r\\n\", subject))\n    mime.WriteString(fmt.Sprintf(\"Content-Type: multipart/mixed; boundary=%s\\r\\n\", bPlaceholder))\n\n    // THIS DOES NOT SHOW UP AS THE BODY OF THE EMAIL...\n    // mime.WriteString(\"\\r\\n\")\n    // mime.WriteString(fmt.Sprintf(\"--%s\\r\\n\", bPlaceholder))\n    // mime.WriteString(\"This should be the email message body (v1)...\")\n    // mime.WriteString(\"\\r\\n\")\n\n    // THIS ALSO DOES NOT SHOW UP AS THE BODY OF THE EMAIL...\n    // BUT IS NEEDED OTHERWISE THE EMAIL MESSAGE SEEMS TO CONTAIN AS ATTACHMENT THE EMAIL MESSAGE ITSELF\n    // (CONTAINING ITSELF THE REAL ATTACHMENT)\n    mime.WriteString(fmt.Sprintf(\"--%s\\r\\n\", bPlaceholder))\n    mime.WriteString(\"Content-Type: text/plain; charset=utf-8\\r\\n\")\n    mime.WriteString(\"This should be the email message body (v2)...\")\n\n    // attach a file from the filesystem\n    _, msgFilename := filepath.Split(filePath)\n    mime.WriteString(fmt.Sprintf(\"\\n--%s\\r\\n\", bPlaceholder))\n    mime.WriteString(\"Content-Type: application/octet-stream\\r\\n\")\n    mime.WriteString(\"Content-Description: \" + msgFilename + \"\\r\\n\")\n    mime.WriteString(\"Content-Transfer-Encoding: base64\\r\\n\")\n    mime.WriteString(\"Content-Disposition: attachment; filename=\\\"\" + msgFilename + \"\\\"\\r\\n\\r\\n\")\n    fileContent, err := ioutil.ReadFile(filePath) // read and encode the content of the file\n    if err != nil {\n        return nil, err\n    }\n    b := make([]byte, base64.StdEncoding.EncodedLen(len(fileContent)))\n    base64.StdEncoding.Encode(b, fileContent)\n    mime.Write(b)\n\n    // footer of the email message\n    mime.WriteString(\"\\r\\n--\" + bPlaceholder + \"--\\r\\n\\r\\n\")\n\n    return mime.Bytes(), nil\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560351535, "post_id": 56564899, "comment_id": 99709685, "body": "Use the correct <code>hh:mm:ss</code> <i>values</i> in the format, just like you&#39;re doing with the <code>yyyy-mm-dd</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560351541, "post_id": 56564899, "comment_id": 99709691, "body": "That&#39;s not how formats work. Formats represent a time in a particular format; they don&#39;t <i>change</i> anything about the time value. If you want to show the time <code>23:59:59</code>, you need to set the time before you format it."}, {"owner": {"reputation": 1386, "user_id": 5293560, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh6.googleusercontent.com/-k9P2KYH96og/AAAAAAAAAAI/AAAAAAAAA_A/K3dmT7Nqow0/photo.jpg?sz=128", "display_name": "vityavv", "link": "https://stackoverflow.com/users/5293560/vityavv"}, "edited": false, "score": 0, "creation_date": 1560351564, "post_id": 56564899, "comment_id": 99709708, "body": "what is &quot;common&quot; defined as?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560352009, "post_id": 56564899, "comment_id": 99709987, "body": "<a href=\"https://play.golang.com/p/kFvzBU01FY7\" rel=\"nofollow noreferrer\">play.golang.com/p/kFvzBU01FY7</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "is_accepted": false, "score": 0, "last_activity_date": 1560352205, "creation_date": 1560352205, "answer_id": 56565394, "question_id": 56564899, "link": "https://stackoverflow.com/questions/56564899/golang-time-formatting-to-a-particular-timestamp/56565394#56565394", "title": "Golang time formatting to a particular timestamp", "body": "<p>Your time format is wrong. The reference time in Go is <a href=\"https://golang.org/pkg/time/#pkg-constants\" rel=\"nofollow noreferrer\"><code>Mon Jan 2 15:04:05 MST 2006</code></a></p>\n\n<pre><code>func getTimeInIST() time.Time {\n    loc, _ := time.LoadLocation(\"Asia/Kolkata\")\n    now := time.Now().In(loc)\n    return now\n}\nfunc GetYesterdaysDateFromTime() time.Time {\n    return getTimeInIST().AddDate(0, 0, -1)\n}\n\nfunc main() {\n    yesterday := GetYesterdaysDateFromTime()\n    print(yesterday.Format(\"2006-01-02 15:04:05\"))\n}\n</code></pre>\n\n<p>This prints:</p>\n\n<blockquote>\n  <p>2019-06-11 20:37:04</p>\n</blockquote>\n"}], "owner": {"reputation": 4986, "user_id": 4763988, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/99abed3bcb05d0b736fa03034ba5aadd?s=128&d=identicon&r=PG&f=1", "display_name": "Kannaj", "link": "https://stackoverflow.com/users/4763988/kannaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1560352205, "creation_date": 1560350683, "question_id": 56564899, "link": "https://stackoverflow.com/questions/56564899/golang-time-formatting-to-a-particular-timestamp", "title": "Golang time formatting to a particular timestamp", "body": "<p>I'm trying to format a <code>time.Time</code> type to a particular time of yesterday (particularly 23:59:59)</p>\n\n<p>I have one function which converts current time to IST</p>\n\n<pre><code>func getTimeInIST() time.Time {\n    loc, _ := time.LoadLocation(\"Asia/Kolkata\")\n    now := time.Now().In(loc)\n    return now\n}\n</code></pre>\n\n<p>another function which converts to the day before</p>\n\n<pre><code>func GetYesterdaysDateFromTime() time.Time{\n    return getTimeInIST().AddDate(0, 0, -1)\n}\n</code></pre>\n\n<p>I want to format the above to a time stamp of date <code>2009-06-12 23:59:59</code>\nfor which I do </p>\n\n<pre><code>yesterday := common.GetYesterdaysDateFromTime()\nyesterday.Format(\"2006-01-02 23:59:59\")\n</code></pre>\n\n<p>but I get this <code>2019-06-11 118:589:589</code></p>\n\n<p>what am I doing wrong?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560351055, "post_id": 56564772, "comment_id": 99709380, "body": "No, there is no recursive delete in the S3 API."}, {"owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560352932, "post_id": 56564772, "comment_id": 99710511, "body": "How is it suppose to be done then? I would have to first List all of keys on specified path and then call Delete where I pass previously generated list of keys?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1560353750, "post_id": 56564772, "comment_id": 99711029, "body": "Yes, that&#39;s how it&#39;s done."}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 1, "creation_date": 1560355193, "post_id": 56564772, "comment_id": 99711818, "body": "To reduce the pain of listing objects, you might consider using S3 Inventory, then perform a batch delete on 100s of objects at a time. Also see <a href=\"https://serverfault.com/questions/679989/most-efficient-way-to-batch-delete-s3-files\" title=\"most efficient way to batch delete s3 files\">serverfault.com/questions/679989/&hellip;</a>"}, {"owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560446347, "post_id": 56564772, "comment_id": 99749154, "body": "I have updated a question. Could you please take a look and if you know the answer to it please post it so I can accept it and close the question. @Adrian"}, {"owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "reply_to_user": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1560446365, "post_id": 56564772, "comment_id": 99749165, "body": "Could you please take a look as well @jarmod"}], "owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 384, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1570104608, "creation_date": 1560350307, "last_edit_date": 1570104608, "question_id": 56564772, "link": "https://stackoverflow.com/questions/56564772/how-to-recursively-delete-objects", "title": "How to recursively delete objects", "body": "<p>I would like to delete all <code>.JPEG</code> files from specified path at S3 bucket. For example, lets say that I have structure on S3 cloud service similar to following:</p>\n\n<pre><code>Obj1/\n   Obj2/\n      Obj3/\n         image_1.jpeg\n         ...\n         image_N.jpeg\n</code></pre>\n\n<p>Is it possible to specify <code>Obj1/Obj2/Obj3</code> as <code>DeleteObjectsInput's</code> <code>prefix</code> and recursively delete all <code>.JPEG</code> files that contain such <code>prefix</code>.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>func (s3Obj S3) Delete() error {\n    sess := session.Must(session.NewSession(&amp;aws.Config{\n        Region: aws.String(s3Obj.Region),\n    }))\n    svc := s3.New(sess)\n\n    input := &amp;s3.DeleteObjectsInput{\n        Bucket: aws.String(s3Obj.Bucket),\n        Delete: &amp;s3.Delete{\n            Objects: []*s3.ObjectIdentifier{\n                {\n                    Key: aws.String(s3Obj.ItemPath),\n                },\n            },\n            Quiet: aws.Bool(false),\n        },\n    }\n\n    result, err := svc.DeleteObjects(input)\n    if err != nil {\n        if aerr, ok := err.(awserr.Error); ok {\n            switch aerr.Code() {\n            default:\n                glog.Errorf(\"Error occurred while trying to delete object from S3. Error message - %v\", aerr.Error())\n            }\n        } else {\n            glog.Errorf(\"Error occurred while trying to delete object from S3. Error message - %v\", err.Error())\n        }\n        return err\n    }\n\n    glog.Info(result)\n    return nil\n}\n</code></pre>\n\n<p><code>sObj3.ItemPath</code> represents <code>Obj1/Obj2/Obj3</code> path from example above. As a result of this function I do not get any error. I actually get the following message:</p>\n\n<pre><code>Deleted: [{\n      Key: \"Obj1/Obj2/Obj3\"\n    }]\n</code></pre>\n\n<p>But when I check my S3 cloud service, nothing is done. What am I doing wrong?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I've changed my code so my Delete function accepts list of objects from which I make a list of <code>s3.ObjectIdentifier</code>. There is roughly 50 .JPEG files in that list, and for some reason following code <strong>ONLY DELETES LAST ONE</strong>. I am not sure why.</p>\n\n<pre><code>func (s3Obj S3) Delete(objects []string) error {\n    sess := session.Must(session.NewSession(&amp;aws.Config{\n        Region: aws.String(s3Obj.Region),\n    }))\n    svc := s3.New(sess)\n\n    var objKeys = make([]*s3.ObjectIdentifier, len(objects))\n    for i, v := range objects {\n        glog.Info(\"About to delete: \", v)\n        objKeys[i] = &amp;s3.ObjectIdentifier{\n            Key: &amp;v,\n        }\n    }\n\n    input := &amp;s3.DeleteObjectsInput{\n        Bucket: aws.String(s3Obj.Bucket),\n        Delete: &amp;s3.Delete{\n            Objects: objKeys,\n            Quiet:   aws.Bool(false),\n        },\n    }\n\n    result, err := svc.DeleteObjects(input)\n    if err != nil {\n        if aerr, ok := err.(awserr.Error); ok {\n            switch aerr.Code() {\n            default:\n                glog.Errorf(\"Error occurred while trying to delete object from S3. Error message - %v\", aerr.Error())\n            }\n        } else {\n            glog.Errorf(\"Error occurred while trying to delete object from S3. Error message - %v\", err.Error())\n        }\n        return err\n    }\n\n    glog.Info(result)\n    return nil\n}\n</code></pre>\n"}, {"tags": ["linux", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1560348307, "post_id": 56563992, "comment_id": 99707705, "body": "There&#39;s no std library Go function for this. All process info on linux is stored in <code>&#47;proc</code>, see <code>man proc</code> for more details"}], "answers": [{"tags": [], "owner": {"reputation": 1419, "user_id": 146032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TQf1.jpg?s=128&g=1", "display_name": "bithavoc", "link": "https://stackoverflow.com/users/146032/bithavoc"}, "is_accepted": true, "score": 2, "last_activity_date": 1560349150, "creation_date": 1560349150, "answer_id": 56564386, "question_id": 56563992, "link": "https://stackoverflow.com/questions/56563992/get-parent-process-id-from-child-process-id-using-golang/56564386#56564386", "title": "Get Parent process id from child process id using Golang", "body": "<p>I don't think the go standard library allows you to do this, however, third-party packages such as <a href=\"https://github.com/mitchellh/go-ps\" rel=\"nofollow noreferrer\">mitchellh/go-ps</a> provide more information.</p>\n\n<p>Example:</p>\n\n<pre><code>import ps \"github.com/mitchellh/go-ps\"\n...\n\nlist, err := ps.Processes()\nif err != nil {\n  panic(err)\n}\nfor _, p := range list {\n  log.Printf(\"Process %s with PID %d and PPID %d\", p.Executable(), p.Pid(), p.PPid())\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2019/06/12 09:13:04 Process com.apple.photom with PID 68663 and PPID 1\n2019/06/12 09:13:04 Process CompileDaemon with PID 49896 and PPID 49895\n</code></pre>\n\n<p>You can also use <code>ps.FindProcess(&lt;pid&gt;)</code> to find a specific process and inspect its PPid</p>\n"}], "owner": {"reputation": 93, "user_id": 10739773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d42d7ce80c37c542bed0d32e8b5e19b?s=128&d=identicon&r=PG&f=1", "display_name": "kms", "link": "https://stackoverflow.com/users/10739773/kms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1436, "favorite_count": 0, "accepted_answer_id": 56564386, "answer_count": 1, "score": 2, "last_activity_date": 1560349150, "creation_date": 1560347898, "last_edit_date": 1560349124, "question_id": 56563992, "link": "https://stackoverflow.com/questions/56563992/get-parent-process-id-from-child-process-id-using-golang", "title": "Get Parent process id from child process id using Golang", "body": "<p>I want to get parent process id (ppid) from specific child process id (pid) using Golang for Linux os</p>\n\n<p>I have this code which gives ppid and pid of the current process but I want to retrieve ppid of the child process which I specify and not the current process.</p>\n\n<pre><code>package main\n\n import (\n         \"fmt\"\n         \"os\"\n )\n\n func main() {\n\n         pid := os.Getpid()\n\n         parentpid := os.Getppid()\n\n         fmt.Printf(\"The parent process id of %v is %v\\n\", pid, parentpid)\n\n }\n</code></pre>\n\n<p>Is there a way to pass pid like this <code>os.Getppid(pid)</code> or any other method to retrieve ppid of specified pid in Golang?</p>\n"}, {"tags": ["go", "apache-kafka"], "comments": [{"owner": {"reputation": 23213, "user_id": 7131757, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wvEUE.jpg?s=128&g=1", "display_name": "Giorgos Myrianthous", "link": "https://stackoverflow.com/users/7131757/giorgos-myrianthous"}, "edited": false, "score": 0, "creation_date": 1560342877, "post_id": 56561421, "comment_id": 99704117, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/40642689/how-to-get-consumer-group-offsets-for-partition-in-golang-kafka-10\">How to get consumer group offsets for partition in Golang Kafka 10</a>"}, {"owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "reply_to_user": {"reputation": 23213, "user_id": 7131757, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wvEUE.jpg?s=128&g=1", "display_name": "Giorgos Myrianthous", "link": "https://stackoverflow.com/users/7131757/giorgos-myrianthous"}, "edited": false, "score": 0, "creation_date": 1560343714, "post_id": 56561421, "comment_id": 99704644, "body": "The answer in the question you point to gives a way to get the offset of the topic, not the consumer offset of the groups reading the topics"}, {"owner": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "edited": false, "score": 0, "creation_date": 1560378249, "post_id": 56561421, "comment_id": 99721031, "body": "By the way, this library already does what you&#39;re asking (using Sarama) <a href=\"https://github.com/linkedin/Burrow\" rel=\"nofollow noreferrer\">github.com/linkedin/Burrow</a>"}], "owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560346863, "creation_date": 1560339775, "last_edit_date": 1560346863, "question_id": 56561421, "link": "https://stackoverflow.com/questions/56561421/get-consumer-group-offset-for-all-topics-for-all-groups-in-kafka-using-go", "title": "Get consumer group offset for all topics for all groups in kafka using go", "body": "<p>NOTE: <strong>NOT A DUPLICATE OF</strong> <a href=\"https://stackoverflow.com/questions/40642689/how-to-get-consumer-group-offsets-for-partition-in-golang-kafka-10\">How to get consumer group offsets for partition in Golang Kafka 10</a> does not answer my question, it's not even a working solution</p>\n\n<p>I'm trying to write a function in go that queries kafka for all consumer group offsets for all topics.</p>\n\n<p>To do that, I was hoping to read all the messages in <code>__consumer_offsets</code> topic and parse them.</p>\n\n<p>However, in all the kakfa go libraries I looked through, I could not find a way to just <em>read</em> all the messages from <code>__consumer_offsets</code> without consuming them.</p>\n\n<p>(<code>kafka-go</code> either gives me a way to read from a single partition, or <em>consume</em>  messages from the entire topic)</p>\n\n<p>So my question is, simply put: Is there a way, using any kafka library out there, to get consumer group offsets for all the groups for all the topics?</p>\n\n<p>If not, is there a way to get the offset for a given topic and group id?</p>\n"}, {"tags": ["asp.net-mvc", "go"], "comments": [{"owner": {"reputation": 1983, "user_id": 3787353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o8UgV.jpg?s=128&g=1", "display_name": "Hasta Tamang", "link": "https://stackoverflow.com/users/3787353/hasta-tamang"}, "edited": false, "score": 0, "creation_date": 1560339894, "post_id": 56561318, "comment_id": 99702260, "body": "Are you looking for <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.process?view=netframework-4.8\" rel=\"nofollow noreferrer\">Process</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560346291, "post_id": 56561318, "comment_id": 99706387, "body": "<code>go run main.go</code> will be horribly inefficient. You should just build it and call the compiled binary from your .NET app."}, {"owner": {"reputation": 1, "user_id": 11636424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014fecc6df80df60510202ed029bd993?s=128&d=identicon&r=PG&f=1", "display_name": "Ramanpreet Kaur", "link": "https://stackoverflow.com/users/11636424/ramanpreet-kaur"}, "edited": false, "score": 0, "creation_date": 1560406919, "post_id": 56561318, "comment_id": 99726917, "body": "@Adrian...I agree can you please elaborate that how to call compiled binary file from .NET app?"}], "answers": [{"tags": [], "owner": {"reputation": 144, "user_id": 3210432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XFQE.jpg?s=128&g=1", "display_name": "abelgana", "link": "https://stackoverflow.com/users/3210432/abelgana"}, "is_accepted": false, "score": 1, "last_activity_date": 1560339913, "creation_date": 1560339913, "answer_id": 56561474, "question_id": 56561318, "link": "https://stackoverflow.com/questions/56561318/call-go-command-through-net-mvc/56561474#56561474", "title": "Call Go command through .net MVC", "body": "<p>I think you can use <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.processstartinfo?view=netframework-4.8\" rel=\"nofollow noreferrer\">processstartinfo</a>. Another way would be to use docker. If you have access to <code>dockerd</code> you can make an API call to start a new docker container and make the container stream the output once it's done.</p>\n"}], "owner": {"reputation": 1, "user_id": 11636424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014fecc6df80df60510202ed029bd993?s=128&d=identicon&r=PG&f=1", "display_name": "Ramanpreet Kaur", "link": "https://stackoverflow.com/users/11636424/ramanpreet-kaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560339913, "creation_date": 1560339442, "question_id": 56561318, "link": "https://stackoverflow.com/questions/56561318/call-go-command-through-net-mvc", "title": "Call Go command through .net MVC", "body": "<p>I have .Net MVC Web Application and I need Json Result from GoLang[github] project. How can I execute command or How can I get result from Go to .Net MVC application.</p>\n\n<p>Is it Possible? I am new in \"Go\".</p>\n\n<p>If it is impossible to call \"go run main.go\" [kind of calling] from Web Application, then please suggest any other solution to get result.</p>\n"}, {"tags": ["go", "nonblocking", "channel"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560335263, "post_id": 56559684, "comment_id": 99699656, "body": "If you care about urgency, why use a ticker? Why not just read as soon as a message is ready?"}, {"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 2, "creation_date": 1560335278, "post_id": 56559684, "comment_id": 99699669, "body": "IMO, Using channel and go-routine for this requirement defeats the purpose. This is an on-demand producer consumer problem. If you don&#39;t want to generate the message asynchronously ie producer shouldn&#39;t produce until a consumer wants it, then why do you want channel and go-routine in the first place. Why can&#39;t you just call the function directly and if generateMsg involves accessing critical memory then guard it with Mutex. Mutex is not evil, after all channel just wraps Mutex hides all dirty details as far I know."}, {"owner": {"reputation": 40290, "user_id": 124946, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5048ffde7ab92aeeedf45959f6d13c24?s=128&d=identicon&r=PG", "display_name": "Denilson S&#225; Maia", "link": "https://stackoverflow.com/users/124946/denilson-s%c3%a1-maia"}, "edited": false, "score": 0, "creation_date": 1560338002, "post_id": 56559684, "comment_id": 99701154, "body": "I omitted from the scenario some other cases of the <code>select</code> statement. The producer is actually reading from other channel, computing some on-the-fly stats, and serving those stats to the consumer. The consumer only needs to display the stats once per second or so, thus, it only needs to consume once per second. But maybe this is too convoluted like you say."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1560340529, "post_id": 56559684, "comment_id": 99702634, "body": "@DenilsonS&#225;Maia: So let it calculate the stats once per second. No need for a consumer/producer pattern, goroutines, or channels."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560346505, "post_id": 56559684, "comment_id": 99706513, "body": "Agreed. This seems like a case for shared memory that the &quot;producer&quot; updates on its schedule and the &quot;consumer&quot; reads on its schedule, with a mutex lock to avoid races."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1560347479, "post_id": 56559684, "comment_id": 99707148, "body": "Wouldn&#39;t it be better to completely change the logic? The producer, when it&#39;s ready to produce a message, merely sends some sort of a token to the consumer which means &quot;I am ready to roll&quot;. The consumer then acquires the token and either explicitly asks the producer to do the work or <i>does the work itself.</i> In the simplest case the producer could send a function value, which the consumer would then call. Sure, in this case one should think through the synchronization\u2014if needed\u2014since the consumer will initiate doing the work in an indeterminate moment of time."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1560336114, "post_id": 56559685, "comment_id": 99700113, "body": "This seems over-complicated to me. In fact, the entire scenario seems like unnecessary complexity, for no gain."}], "tags": [], "owner": {"reputation": 40290, "user_id": 124946, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5048ffde7ab92aeeedf45959f6d13c24?s=128&d=identicon&r=PG", "display_name": "Denilson S&#225; Maia", "link": "https://stackoverflow.com/users/124946/denilson-s%c3%a1-maia"}, "is_accepted": false, "score": 0, "last_activity_date": 1560334346, "creation_date": 1560334346, "answer_id": 56559685, "question_id": 56559684, "link": "https://stackoverflow.com/questions/56559684/how-can-i-compute-the-message-to-be-sent-on-a-channel-as-late-as-possible/56559685#56559685", "title": "How can I compute the message to be sent on a channel as late as possible?", "body": "<p><a href=\"https://stackoverflow.com/a/29016251\">This answer</a> (for <a href=\"https://stackoverflow.com/q/29016118\">Go non-blocking channel send, test-for-failure before attempting to send?</a>) suggests using a second channel to send a signal from the consumer to the producer:</p>\n\n<ol>\n<li>Consumer wants to get a message (e.g. after receiving a tick from <code>timer.Ticker</code>).</li>\n<li>Consumer sends a signal through a side channel to the producer goroutine. (So, for this side channel, the producer/consumer roles are reversed).</li>\n<li>Producer receives the signal from the side channel.</li>\n<li>Producer starts computing the real message.</li>\n<li>Producer sends the message through the main channel.</li>\n<li>Consumer receives the message.</li>\n</ol>\n"}], "owner": {"reputation": 40290, "user_id": 124946, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5048ffde7ab92aeeedf45959f6d13c24?s=128&d=identicon&r=PG", "display_name": "Denilson S&#225; Maia", "link": "https://stackoverflow.com/users/124946/denilson-s%c3%a1-maia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560334655, "creation_date": 1560334346, "last_edit_date": 1560334655, "question_id": 56559684, "link": "https://stackoverflow.com/questions/56559684/how-can-i-compute-the-message-to-be-sent-on-a-channel-as-late-as-possible", "title": "How can I compute the message to be sent on a channel as late as possible?", "body": "<p>My scenario:</p>\n\n<ul>\n<li>I have a producer and a consumer. Both are goroutines, and they communicate through one channel.</li>\n<li>The producer is capable of (theoretically) generating a message at any time.</li>\n<li>Generating a message requires some computation.</li>\n<li>The message is somewhat time-sensitive (i.e. the older it is, the less relevant it is).</li>\n<li>The consumer reads from the channel occasionally. For the sake of this example, let's say the consumer uses a <code>time.Ticker</code> to read a message once every couple of seconds.</li>\n<li>The consumer would prefer \"fresh\" messages (i.e. messages that were generated as recently as possible).</li>\n</ul>\n\n<p>So, the question is: <strong>How can the producer generate a message as late as possible?</strong></p>\n\n<hr>\n\n<p>Sample code that shows the general idea:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func producer() {\n    for {\n        select {\n        ...\n        case pipe &lt;- generateMsg():\n            // I'd like to call generateMsg as late as possible,\n            // i.e. calculate the timestamp when I know\n            // that writing to the channel will not block.\n        }\n    }\n}\n\nfunc consumer() {\n    for {\n        select {\n        ...\n        case &lt;-timeTicker.C:\n            // Reading from the consumer.\n            msg &lt;- pipe\n            ...\n        }\n    }\n}\n</code></pre>\n\n<p>Full code (slightly different from above) is available at the Go Playground: <a href=\"https://play.golang.org/p/y0oCf39AV6P\" rel=\"nofollow noreferrer\">https://play.golang.org/p/y0oCf39AV6P</a></p>\n\n<hr>\n\n<p>One idea I had was to check if writing to a channel would block. If it wouldn't block, then I can generate a message and then send it. However\u2026</p>\n\n<ul>\n<li>I couldn't find any way to test if writing to a channel would block or not.</li>\n<li>In the general case, this is a bad idea because it introduces a racing condition if we have multiple producers. In this specific case, I only have one producer.</li>\n</ul>\n\n<hr>\n\n<p>Another (bad) idea:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func producer() {\n    var msg Message\n    for {\n        // This is BAD. DON'T DO THIS!\n        select {\n        case pipe &lt;- msg:\n            // It may send the same message multiple times.\n        default:\n            msg = generateMsg()\n            // It causes a busy-wait loop, high CPU usage\n            // because it re-generates the message all the time.\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "mongo-go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560334408, "post_id": 56559352, "comment_id": 99699222, "body": "That &#39;Z&#39; at the end of your date literally means &quot;this us UTC, not local time&quot;"}, {"owner": {"reputation": 101, "user_id": 11635976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209ec150f0ce08ebced8e1c62b06bb44?s=128&d=identicon&r=PG", "display_name": "erofeev", "link": "https://stackoverflow.com/users/11635976/erofeev"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560334836, "post_id": 56559352, "comment_id": 99699424, "body": "Use mongodb stored datetime in UTC, without timezone. But driver can transform datetime to my local timezone. MGO driver can this"}], "owner": {"reputation": 101, "user_id": 11635976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209ec150f0ce08ebced8e1c62b06bb44?s=128&d=identicon&r=PG", "display_name": "erofeev", "link": "https://stackoverflow.com/users/11635976/erofeev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1560334415, "answer_count": 0, "score": 0, "last_activity_date": 1560333373, "creation_date": 1560333373, "question_id": 56559352, "link": "https://stackoverflow.com/questions/56559352/how-to-read-datetime-in-local-timezone", "closed_reason": "Duplicate", "title": "How to read datetime in local timezone", "body": "<p>I use github.com/mongodb/mongo-go-driver driver in golang\nMy code struct:</p>\n\n<pre><code>type Document struct {\n   CreatedAt time.Time `bson:\"createdAt\"`\n}\n</code></pre>\n\n<p>When I insert a document, it is inserted as ISODate (), it looks like this:</p>\n\n<pre><code>{\n    \"createdAt\" : ISODate(\"2019-06-12T08:55:45Z\")\n}\n</code></pre>\n\n<p>From the code, when I receive the document, he read in the UTC time zone.\nI want to convert the date in my local Timezone system. Is there any way to do this with the driver</p>\n"}, {"tags": ["ruby", "go", "openssl", "base64", "hmac"], "answers": [{"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 8, "last_activity_date": 1604639587, "last_edit_date": 1604639587, "creation_date": 1560333557, "answer_id": 56559414, "question_id": 56559148, "link": "https://stackoverflow.com/questions/56559148/ruby-vs-go-sha256-hmac-base64-encoded-string-mismatches/56559414#56559414", "title": "Ruby vs. Go / sha256 hmac base64 encoded string mismatches", "body": "<p>The Go code uses the URL safe variant of base64 encoding where your Ruby code uses the normal version. The URL safe version uses <code>-</code> and <code>_</code> instead of <code>+</code> and <code>/</code> so that it is safe for use in URLs. The Ruby version also includes padding (the <code>=</code> at the end).</p>\n<p>You can use the <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/base64/rdoc/Base64.html#method-i-urlsafe_encode64\" rel=\"nofollow noreferrer\">URL safe version in Ruby</a>, and you can also specify no padding to get the same result as Go:</p>\n<pre class=\"lang-ruby prettyprint-override\"><code>Base64.urlsafe_encode64(hmac, false)\n</code></pre>\n"}], "owner": {"reputation": 4429, "user_id": 102133, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/561a3a55352fe6a5343e541a6894b541?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/102133/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 56559414, "answer_count": 1, "score": 4, "last_activity_date": 1604639587, "creation_date": 1560332677, "last_edit_date": 1560333066, "question_id": 56559148, "link": "https://stackoverflow.com/questions/56559148/ruby-vs-go-sha256-hmac-base64-encoded-string-mismatches", "title": "Ruby vs. Go / sha256 hmac base64 encoded string mismatches", "body": "<p>playing around with imaginary, I'm attempting to create a ruby client.</p>\n\n<p>For security reasons, I'd need to sign the url</p>\n\n<p>Here is the go provided sample :</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/hmac\"\n    \"crypto/sha256\"\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc main() {\n  signKey := \"ea79b7fd-287b-4ffe-b941-bf983181783f\"\n  urlPath := \"/resize\"\n  url := \"https%3A%2F%2Fxyz\"\n  urlQuery := \"nocrop=true&amp;type=jpeg&amp;url=\" + url + \"&amp;width=500\"\n\n  h := hmac.New(sha256.New, []byte(signKey))\n  h.Write([]byte(urlPath))\n  h.Write([]byte(urlQuery))\n  buf := h.Sum(nil)\n    fmt.Println(base64.RawURLEncoding.EncodeToString(buf)\n}\n</code></pre>\n\n<p>Converted to ruby, this gives us :</p>\n\n<pre><code>require 'openssl'\nrequire 'base64'\n\nsignKey = \"ea79b7fd-287b-4ffe-b941-bf983181783f\"\nurlPath = \"/resize\"\nurl = \"https%3A%2F%2Fxyz\"\nurlQuery = \"nocrop=true&amp;type=jpeg&amp;url=\" + url + \"&amp;width=500\"\n\ndigest = OpenSSL::Digest.new('sha256')\nhmac = OpenSSL::HMAC.digest(digest, signKey, \"#{urlPath}#{urlQuery}\")\npp Base64.strict_encode64(hmac)\n</code></pre>\n\n<p>We're almost there , but there a slight issue, don't know if it is due to openssl or base64, but for example when I get this with go :</p>\n\n<p><code>wClkWcUvI9ILs7noAr_HtnKpRCeeWBXE1Ne2C99sAco</code></p>\n\n<p>I get the following with the ruby version :</p>\n\n<p><code>wClkWcUvI9ILs7noAr/HtnKpRCeeWBXE1Ne2C99sAco=</code></p>\n\n<p>With ruby, whatever's done, it ends up with a <code>=</code></p>\n\n<p>While go uses underscore, ruby use backslashes (this last one statement might be the result of pure unawareness about specific ruby parts, but let's just detail the issue)</p>\n\n<p>What should be done to get the same output with both versions ? Why do we get a close but not exact result between those languages ?</p>\n\n<p>Thanks a lot for the reply</p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 3345213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hunN.png?s=128&g=1", "display_name": "basebandit", "link": "https://stackoverflow.com/users/3345213/basebandit"}, "edited": false, "score": 0, "creation_date": 1560350132, "post_id": 56563071, "comment_id": 99708822, "body": "Did you use it to unmarshal nested structs for instance like in my example above am specifically having issues decoding this <code>Tokens     map[string]map[string]*Token  json:&quot;tokens,omitempty&quot; </code>"}, {"owner": {"reputation": 274, "user_id": 6738828, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WfJK-1Ftvr4/AAAAAAAAAAI/AAAAAAAAAJQ/nJ_xC9x09b8/photo.jpg?sz=128", "display_name": "Filip Wojciechowski", "link": "https://stackoverflow.com/users/6738828/filip-wojciechowski"}, "reply_to_user": {"reputation": 71, "user_id": 3345213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hunN.png?s=128&g=1", "display_name": "basebandit", "link": "https://stackoverflow.com/users/3345213/basebandit"}, "edited": false, "score": 0, "creation_date": 1560438792, "post_id": 56563071, "comment_id": 99745272, "body": "It was a long time ago, but I think I was unmarshaling an array of jsonb objects to a slice of structs -- and it worked on the first try without any fuss.  I ended up changing the queries and my data structure, to simplify things, so I ended up not using jsonb at all in the end -- but when I did try it, it worked fine."}], "tags": [], "owner": {"reputation": 274, "user_id": 6738828, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WfJK-1Ftvr4/AAAAAAAAAAI/AAAAAAAAAJQ/nJ_xC9x09b8/photo.jpg?sz=128", "display_name": "Filip Wojciechowski", "link": "https://stackoverflow.com/users/6738828/filip-wojciechowski"}, "is_accepted": false, "score": 0, "last_activity_date": 1560345037, "creation_date": 1560345037, "answer_id": 56563071, "question_id": 56558802, "link": "https://stackoverflow.com/questions/56558802/unmarshaling-postgresql-jsonb-query-response-string-into-golang-nested-struct/56563071#56563071", "title": "Unmarshaling postgresql jsonb query response string into golang nested struct", "body": "<p>I think this is the expected behavior of the pq driver -- see this: <a href=\"https://github.com/lib/pq/issues/348\" rel=\"nofollow noreferrer\">https://github.com/lib/pq/issues/348</a></p>\n\n<p>There is a suggestion to use sqlx in the issue thread -- I've not tried it: <a href=\"https://github.com/lib/pq/issues/348#issuecomment-282742349\" rel=\"nofollow noreferrer\">https://github.com/lib/pq/issues/348#issuecomment-282742349</a></p>\n\n<p>You could also switch the driver to pgx: <a href=\"https://github.com/jackc/pgx\" rel=\"nofollow noreferrer\">https://github.com/jackc/pgx</a> -- from this driver's docs:</p>\n\n<blockquote>\n  <p>pgx includes built-in support to marshal and unmarshal between Go types and the PostgreSQL JSON and JSONB.</p>\n</blockquote>\n\n<p>I've used pgx for jsonb unmarshalling in the past -- with good results.</p>\n"}], "owner": {"reputation": 71, "user_id": 3345213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hunN.png?s=128&g=1", "display_name": "basebandit", "link": "https://stackoverflow.com/users/3345213/basebandit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3063, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560345037, "creation_date": 1560331486, "question_id": 56558802, "link": "https://stackoverflow.com/questions/56558802/unmarshaling-postgresql-jsonb-query-response-string-into-golang-nested-struct", "title": "Unmarshaling postgresql jsonb query response string into golang nested struct", "body": "<p>I am trying to read some data from postgresql both jsonb and non-jsonb columns then unmarshal the response string I am getting to a nested struct.</p>\n\n<p>I am able to retrieve tha data as string.But I can't figure out how to unmarshal it into the struct.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"log\"\n    \"strconv\"\n\n    _ \"github.com/lib/pq\"\n)\n\ntype Token struct {\n    Name     string\n    Value    string\n    Path     string\n    HttpOnly bool\n}\n\ntype Session struct {\n    Phishlet   string                       `json:\"phishlet,omitempty\"`\n    LandingURL string                       `json:\"landing_url,omitempty\"`\n    Username   string                       `json:\"username,omitempty\"`\n    Password   string                       `json:\"password,omitempty\"`\n    Custom     map[string]string            `json:\"custom,omitempty\"`\n    Tokens     map[string]map[string]*Token `json:\"tokens,omitempty\"`\n    SessionId  string                       `json:\"session_id,omitempty\"`\n    UserAgent  string                       `json:\"useragent,omitempty\"`\n    RemoteAddr string                       `json:\"remote_addr,omitempty\"`\n    CreateTime int64                        `json:\"create_time,omitempty\"`\n    UpdateTime int64                        `json:\"update_time,omitempty\"`\n}\n\ntype Sessions struct {\n    Id      int64\n    UserId  []byte\n    Session Session\n}\n\n\n\nfunc main() {\n\n    db, err := sql.Open(\"postgres\", \"postgres://user:pass@localhost:port/db\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    rows, err := db.Query(\"SELECT id, user_id,session FROM sessions ORDER BY id\")\n    defer rows.Close()\n    columns, err := rows.Columns()\n    if err != nil {\n        log.Fatal(err)\n    }\n    count := len(columns)\n    values := make([]interface{}, count)\n    scanArgs := make([]interface{}, count)\n    for i := range values {\n        scanArgs[i] = &amp;values[i]\n    }\n\n    data := make(map[string][]interface{})\n\n    for rows.Next() {\n        err = rows.Scan(scanArgs...)\n        if err != nil {\n            panic(fmt.Sprintf(\"rows.Scan: %v\", err))\n        }\n        for i, v := range values {\n            switch col := columns[i]; col {\n            case \"id\":\n                fmt.Printf(\"Id: %v\\n\", v)\n            case \"user_id\":\n                fmt.Printf(\"UserId: %s\\n\", v)\n            case \"session\":\n                x := v.([]byte)\n                if nx, ok := strconv.ParseFloat(string(x), 64); ok == nil {\n                    data[columns[i]] = append(data[columns[i]], nx)\n                } else if b, ok := strconv.ParseBool(string(x)); ok == nil {\n                    data[columns[i]] = append(data[columns[i]], b)\n                } else if \"string\" == fmt.Sprintf(\"%T\", string(x)) {\n                    data[columns[i]] = append(data[columns[i]], string(x))\n                } else {\n                    fmt.Printf(\"Failed on if for type %T of %v\\n\", x, x)\n                }\n            }\n            fmt.Println(data)\n        }\n    }\n}\n\n//Database schema\ncreate table if not exists sessions(\n            id bigserial not null primary key,\n            user_id uuid not null references users(id)\n            session jsonb\n    )\n</code></pre>\n\n<p>I expect the output to be this after successfully unmarshaling to the struct </p>\n\n<pre><code>[\n  {\n    \"id\": 1,\n    \"user_id\": \"c610ceb9-640f-43d2-8e26-a80be6afb831\",\n    \"phishlet\": \"niko\",\n    \"landing_url\": \"https://niko.com/ke/login\",\n    \"username\": \"MyUser\",\n    \"password\": \"my_p@55\",\n    \"custom\": {},\n    \"tokens\": {\n      \".niko.com\": {\n        \"_niko_sess\": {\n          \"Name\": \"_niko_sess\",\n          \"Value\": \"BAh7CiIKZmxhc2hJQzonQWN0aW9uQ29udHJvbGxlcjo6Rmxhc2g6OkZsYXNo%250ASGFzaHsABjoKQHVzZWR7ADoPY3JlYXRlZF9hdGwrCG6lp1hqAToMY3NyZl9p%250AZCIlYjk4MGFiZDEyNGEzZTI0NjE0MzYzZDkyNTRmOWZiYzQ6B2lkIiVhOTA3%250AMjJjOGFkNDdlNzFiZmYyNmEwZjU2ZDBhYTYyYToJdXNlcmwrCQDgV68MtUMP--48e2dcf262fa4895366025210c10ff4c922a3fca\",\n          \"Path\": \"/\",\n          \"HttpOnly\": true\n        },\n        \"auth_token\": {\n          \"Name\": \"auth_token\",\n          \"Value\": \"e9b42a3b76907dff7b55117627a3be40e4c557ce\",\n          \"Path\": \"\",\n          \"HttpOnly\": true\n        },\n        \"nkt\": {\n          \"Name\": \"nkt\",\n          \"Value\": \"FdRf8fAkS8bEthMBUaY2gNqbTjFdZcUFh8wJBbR4\",\n          \"Path\": \"\",\n          \"HttpOnly\": true\n        },\n        \"nikd\": {\n          \"Name\": \"nikd\",\n          \"Value\": \"u=1099921800094539776\",\n          \"Path\": \"\",\n          \"HttpOnly\": false\n        }\n      }\n    },\n    \"session_id\": \"cd5c9c35b96cfdaac5e299b21c40a9fbad667e1710c6f1efb972008ac3bac55c\",\n    \"useragent\": \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0\",\n    \"remote_addr\": \"197.232.6.251\",\n    \"create_time\": 1556265484,\n    \"update_time\": 1556265594\n  },\n  {\n    \"id\": 2,\n    \"user_id\": \"d52673ef-cf4e-4081-855f-d7dd91762633\",\n    \"phishlet\": \"niko\",\n    \"landing_url\": \"https://niko.com/ke/login\",\n    \"username\": \"MyUser\",\n    \"password\": \"my_p@55\",\n    \"custom\": {},\n    \"tokens\": {\n      \".niko.com\": {\n        \"_niko_sess\": {\n          \"Name\": \"_niko_sess\",\n          \"Value\": \"BAh7CiIKZmxhc2hJQzonQWN0aW9uQ29udHJvbGxlcjo6Rmxhc2g6OkZsYXNo%250ASGFzaHsABjoKQHVzZWR7ADoPY3JlYXRlZF9hdGwrCG6lp1hqAToMY3NyZl9p%250AZCIlYjk4MGFiZDEyNGEzZTI0NjE0MzYzZDkyNTRmOWZiYzQ6B2lkIiVhOTA3%250AMjJjOGFkNDdlNzFiZmYyNmEwZjU2ZDBhYTYyYToJdXNlcmwrCQDgV68MtUMP--48e2dcf262fa4895366025210c10ff4c922a3fca\",\n          \"Path\": \"/\",\n          \"HttpOnly\": true\n        },\n        \"auth_token\": {\n          \"Name\": \"auth_token\",\n          \"Value\": \"e9b42a3b76907dff7b55117627a3be40e4c557ce\",\n          \"Path\": \"\",\n          \"HttpOnly\": true\n        },\n        \"nkt\": {\n          \"Name\": \"nkt\",\n          \"Value\": \"FdRf8fAkS8bEthMBUaY2gNqbTjFdZcUFh8wJBbR4\",\n          \"Path\": \"\",\n          \"HttpOnly\": true\n        },\n        \"nikd\": {\n          \"Name\": \"nikd\",\n          \"Value\": \"u=1099921800094539776\",\n          \"Path\": \"\",\n          \"HttpOnly\": false\n        }\n      }\n    },\n    \"session_id\": \"cd5c9c35b96cfdaac5e299b21c40a9fbad667e1710c6f1efb972008ac3bac55c\",\n    \"useragent\": \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0\",\n    \"remote_addr\": \"197.232.6.251\",\n    \"create_time\": 1556265484,\n    \"update_time\": 1556265594\n  }\n]\n</code></pre>\n\n<p>but instead am getting it from the db as type <code>string</code> like this. </p>\n\n<pre><code>map[session:[\n  {\n    \"phishlet\": \"niko\",\n    \"landing_url\": \"https://niko.com/ke/login\",\n    \"username\": \"MyUser\",\n    \"password\": \"my_p@55\",\n    \"custom\": {},\n    \"tokens\": {\n      \".niko.com\": {\n        \"_niko_sess\": {\n          \"Name\": \"_niko_sess\",\n          \"Value\": \"BAh7CiIKZmxhc2hJQzonQWN0aW9uQ29udHJvbGxlcjo6Rmxhc2g6OkZsYXNo%250ASGFzaHsABjoKQHVzZWR7ADoPY3JlYXRlZF9hdGwrCG6lp1hqAToMY3NyZl9p%250AZCIlYjk4MGFiZDEyNGEzZTI0NjE0MzYzZDkyNTRmOWZiYzQ6B2lkIiVhOTA3%250AMjJjOGFkNDdlNzFiZmYyNmEwZjU2ZDBhYTYyYToJdXNlcmwrCQDgV68MtUMP--48e2dcf262fa4895366025210c10ff4c922a3fca\",\n          \"Path\": \"/\",\n          \"HttpOnly\": true\n        },\n        \"auth_token\": {\n          \"Name\": \"auth_token\",\n          \"Value\": \"e9b42a3b76907dff7b55117627a3be40e4c557ce\",\n          \"Path\": \"\",\n          \"HttpOnly\": true\n        },\n        \"nkt\": {\n          \"Name\": \"nkt\",\n          \"Value\": \"FdRf8fAkS8bEthMBUaY2gNqbTjFdZcUFh8wJBbR4\",\n          \"Path\": \"\",\n          \"HttpOnly\": true\n        },\n        \"nikd\": {\n          \"Name\": \"nikd\",\n          \"Value\": \"u=1099921800094539776\",\n          \"Path\": \"\",\n          \"HttpOnly\": false\n        }\n      }\n    },\n    \"session_id\": \"cd5c9c35b96cfdaac5e299b21c40a9fbad667e1710c6f1efb972008ac3bac55c\",\n    \"useragent\": \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0\",\n    \"remote_addr\": \"197.232.6.251\",\n    \"create_time\": 1556265484,\n    \"update_time\": 1556265594\n  }]]\n  map[session:[{\n    \"phishlet\": \"niko\",\n    \"landing_url\": \"https://niko.com/ke/login\",\n    \"username\": \"MyUser\",\n    \"password\": \"my_p@55\",\n    \"custom\": {},\n    \"tokens\": {\n      \".niko.com\": {\n        \"_niko_sess\": {\n          \"Name\": \"_niko_sess\",\n          \"Value\": \"BAh7CiIKZmxhc2hJQzonQWN0aW9uQ29udHJvbGxlcjo6Rmxhc2g6OkZsYXNo%250ASGFzaHsABjoKQHVzZWR7ADoPY3JlYXRlZF9hdGwrCG6lp1hqAToMY3NyZl9p%250AZCIlYjk4MGFiZDEyNGEzZTI0NjE0MzYzZDkyNTRmOWZiYzQ6B2lkIiVhOTA3%250AMjJjOGFkNDdlNzFiZmYyNmEwZjU2ZDBhYTYyYToJdXNlcmwrCQDgV68MtUMP--48e2dcf262fa4895366025210c10ff4c922a3fca\",\n          \"Path\": \"/\",\n          \"HttpOnly\": true\n        },\n        \"auth_token\": {\n          \"Name\": \"auth_token\",\n          \"Value\": \"e9b42a3b76907dff7b55117627a3be40e4c557ce\",\n          \"Path\": \"\",\n          \"HttpOnly\": true\n        },\n        \"nkt\": {\n          \"Name\": \"nkt\",\n          \"Value\": \"FdRf8fAkS8bEthMBUaY2gNqbTjFdZcUFh8wJBbR4\",\n          \"Path\": \"\",\n          \"HttpOnly\": true\n        },\n        \"nikd\": {\n          \"Name\": \"nikd\",\n          \"Value\": \"u=1099921800094539776\",\n          \"Path\": \"\",\n          \"HttpOnly\": false\n        }\n      }\n    },\n    \"session_id\": \"cd5c9c35b96cfdaac5e299b21c40a9fbad667e1710c6f1efb972008ac3bac55c\",\n    \"useragent\": \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0\",\n    \"remote_addr\": \"197.232.6.251\",\n    \"create_time\": 1556265484,\n    \"update_time\": 1556265594\n  }\n]]\n</code></pre>\n"}, {"tags": ["python", "opencv", "go"], "comments": [{"owner": {"reputation": 12305, "user_id": 8192635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcaf44c9ff9eeeb51fc78c816891d75a?s=128&d=identicon&r=PG&f=1", "display_name": "LinPy", "link": "https://stackoverflow.com/users/8192635/linpy"}, "edited": false, "score": 0, "creation_date": 1560330703, "post_id": 56558506, "comment_id": 99697104, "body": "see this pachage <a href=\"https://www.gonum.org/\" rel=\"nofollow noreferrer\">gonum.org</a>"}, {"owner": {"reputation": 57, "user_id": 9716692, "user_type": "registered", "profile_image": "https://graph.facebook.com/1947922611894394/picture?type=large", "display_name": "user9716692", "link": "https://stackoverflow.com/users/9716692/user9716692"}, "reply_to_user": {"reputation": 12305, "user_id": 8192635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcaf44c9ff9eeeb51fc78c816891d75a?s=128&d=identicon&r=PG&f=1", "display_name": "LinPy", "link": "https://stackoverflow.com/users/8192635/linpy"}, "edited": false, "score": 0, "creation_date": 1560356038, "post_id": 56558506, "comment_id": 99712241, "body": "I think I need a method to manipulate the gocv.Mat like np.where."}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 9716692, "user_type": "registered", "profile_image": "https://graph.facebook.com/1947922611894394/picture?type=large", "display_name": "user9716692", "link": "https://stackoverflow.com/users/9716692/user9716692"}, "is_accepted": true, "score": 0, "last_activity_date": 1600507483, "last_edit_date": 1600507483, "creation_date": 1561187185, "answer_id": 56713379, "question_id": 56558506, "link": "https://stackoverflow.com/questions/56558506/is-there-any-similar-function-in-gocv-like-np-where-in-python/56713379#56713379", "title": "Is there any similar function in gocv like np.where() in python?", "body": "<p>I just found out that there is nothing like np.where() in gocv.<br />\nAll I have to do is:</p>\n<ol>\n<li>get []byte using Mat.ToBytes()</li>\n<li>writing a for loop to check each pixel in []byte and changing it if meet the condition.</li>\n<li>get Mat from gocv.NewMatFromBytes()</li>\n</ol>\n"}], "owner": {"reputation": 57, "user_id": 9716692, "user_type": "registered", "profile_image": "https://graph.facebook.com/1947922611894394/picture?type=large", "display_name": "user9716692", "link": "https://stackoverflow.com/users/9716692/user9716692"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 56713379, "answer_count": 1, "score": 0, "last_activity_date": 1600507483, "creation_date": 1560330530, "question_id": 56558506, "link": "https://stackoverflow.com/questions/56558506/is-there-any-similar-function-in-gocv-like-np-where-in-python", "title": "Is there any similar function in gocv like np.where() in python?", "body": "<p>Is there any similar function in Gocv like np.where() in Python? I want to specify some specific pixel values to 0, and others to 255. As follows, in Python I can do:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>        img = cv2.imread(\"test.png\", cv2.IMREAD_GRAYSCALE)\n        img_ = np.where(img == 144 , img*0, np.where(img == 170 , img*0, np.where(img == 178 , img*0, np.where(img == 187 , img*0, 255))))\n</code></pre>\n\n<p>the pixel values which are 187, 178, 170, 144 will be set to 0, and others to 255. How can I do this job in Golang with Gocv?</p>\n"}, {"tags": ["go", "build"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1560322164, "post_id": 56555931, "comment_id": 99692780, "body": "Your understanding is not correct. Keep a single cache."}], "answers": [{"tags": [], "owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "is_accepted": true, "score": 1, "last_activity_date": 1560322218, "creation_date": 1560322218, "answer_id": 56556174, "question_id": 56555931, "link": "https://stackoverflow.com/questions/56555931/go-build-single-or-separate-cache-directory/56556174#56556174", "title": "Go build single or separate cache directory", "body": "<p>Each package has it's own cache.  There is no advantage in having separate locations.</p>\n"}], "owner": {"reputation": 1606, "user_id": 7242490, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/259444dba6bc0f46688d3522a93cd82c?s=128&d=identicon&r=PG&f=1", "display_name": "bli00", "link": "https://stackoverflow.com/users/7242490/bli00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 56556174, "answer_count": 1, "score": 0, "last_activity_date": 1560322218, "creation_date": 1560321231, "question_id": 56555931, "link": "https://stackoverflow.com/questions/56555931/go-build-single-or-separate-cache-directory", "title": "Go build single or separate cache directory", "body": "<p>I have multiple Go projects that are caching their build in the default <code>GOCACHE</code> directory. According to Golang's official <a href=\"https://golang.org/cmd/go/#hdr-Build_and_test_caching\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>The go command periodically deletes cached data that has not been used recently. Running 'go clean -cache' deletes all cached data.</p>\n</blockquote>\n\n<p>So if I understand it correctly, it seems likely that <code>go build</code> will overwrite these cache as the number of project builds increase. Therefore, is it beneficial to keep each project's build cache in a separate location?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1560317671, "post_id": 56554574, "comment_id": 99691202, "body": "Whatever you are trying to do: Stop it now and redesign fundamentally. Combining the empty interface and package unsafe is a huge no go and totally unjustifiable."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560322240, "post_id": 56554574, "comment_id": 99692813, "body": "&quot;I want to convert interface{} to unsafe.Pointer&quot; -- Why? What is your actual goal here? This looks like an XY Problem."}], "answers": [{"tags": [], "owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "is_accepted": true, "score": 0, "last_activity_date": 1560314896, "creation_date": 1560314896, "answer_id": 56554836, "question_id": 56554574, "link": "https://stackoverflow.com/questions/56554574/interface-convert-to-unsafe-pointer-problem/56554836#56554836", "title": "interface{} convert to unsafe.Pointer problem", "body": "<p>Instead of <code>unsafe.Pointer(val)</code>, use <code>unsafe.Pointer(&amp;val)</code>. Because it accepts pointer.</p>\n\n<pre><code>package main\n\nimport (\n    \"unsafe\"\n\n)\ntype Person struct {\n    Name string\n}\n\nfunc main() {\n    p := &amp;Person{}\n    p.Name = \"TestName\"\n\n    TestFun(p)\n}\n\nfunc TestFun(val interface{}) {\n    // I want to convert interface{} to unsafe.Pointer\n    var pointer unsafe.Pointer\n\n    pointer = unsafe.Pointer(&amp;val)\n\n    println(pointer)\n\n    u := (*interface{})(pointer)\n    p := (*u).(*Person)\n    println(p.Name)\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7247290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a26845b04f006cea35fe72862bc64e?s=128&d=identicon&r=PG&f=1", "display_name": "Hailei Hu", "link": "https://stackoverflow.com/users/7247290/hailei-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 1, "accepted_answer_id": 56554836, "answer_count": 1, "score": -1, "last_activity_date": 1560323369, "creation_date": 1560312761, "question_id": 56554574, "link": "https://stackoverflow.com/questions/56554574/interface-convert-to-unsafe-pointer-problem", "title": "interface{} convert to unsafe.Pointer problem", "body": "<p>I am doing some test about unsafe.Pointer. Suppose TestFun is a common library function, so \"Person\" struct should not appear in this function</p>\n\n<pre><code>type Person struct {\n    Name string\n}\n\nfunc main() {\n    p := &amp;Person{}\n    p.Name = \"TestName\"\n    TestFun(p)\n}\n\nfunc TestFun(val interface{}) {\n    // I want to convert interface{} to unsafe.Pointer\n    var pointer unsafe.Pointer\n\n    // This Line compile error\n    //pointer = unsafe.Pointer(val)\n\n    // This is ok, but \"Person\" appears. This function is a common function, \"Person\" should not appear\n    // pointer = unsafe.Pointer(val.(*Person))\n\n    println(pointer)\n}\n</code></pre>\n\n<p>How could I do this ?</p>\n"}, {"tags": ["sql", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 711, "user_id": 3793624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33afc5fb488eac5527fde9482d0ba359?s=128&d=identicon&r=PG&f=1", "display_name": "Sivalingam", "link": "https://stackoverflow.com/users/3793624/sivalingam"}, "is_accepted": false, "score": 1, "last_activity_date": 1560762307, "creation_date": 1560762307, "answer_id": 56628097, "question_id": 56554038, "link": "https://stackoverflow.com/questions/56554038/when-inserting-data-with-gorm-the-check-does-not-exist-the-same/56628097#56628097", "title": "when inserting data with gorm, the check does not exist the same", "body": "<p><a href=\"http://jinzhu.me/gorm/crud.html#firstorcreate\" rel=\"nofollow noreferrer\">FirstOrCreate</a></p>\n\n<p>Get first matched record, or initalize a new one with given conditions (only works with struct, map conditions)</p>\n\n<pre><code>db.FirstOrCreate(&amp;user, User{Name: \"non_existing\"})\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11628416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a08d1d44a4380af9552ac26ae74e9a0?s=128&d=identicon&r=PG&f=1", "display_name": "better", "link": "https://stackoverflow.com/users/11628416/better"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1009, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564038942, "creation_date": 1560307937, "last_edit_date": 1564038942, "question_id": 56554038, "link": "https://stackoverflow.com/questions/56554038/when-inserting-data-with-gorm-the-check-does-not-exist-the-same", "title": "when inserting data with gorm, the check does not exist the same", "body": "<p>I am using gorm. I want to insert value while not exist same value </p>\n\n<p>just like the raw sql.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>\nINSERT INTO student (firstname, lastname)\nSELECT 'NEW FIRSTNAME', 'NEW LASTNAME'\nFROM DUAL\nWHERE NOT EXISTS(\n    SELECT 1\n    FROM table_name\n    WHERE firstname = 'NEW FIRSTNAME' AND lastname = 'NEW LASTNAME'\n)\nLIMIT 1;\n</code></pre>\n\n<p>How to implement this function with gorm</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Student struct {\n    Firstname string\n    Lastname string\n}\n\nfunc insert()  {\n    stu :=Student{\"fir\",\"la\"}\n    if res := DB.Create(&amp;stu).Or(\"some condition\"); res.Error != nil {\n        logrus.Println(res.Error)\n\n    }\n}\n</code></pre>\n\n<p>when found same value i want a message or error message</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2267, "user_id": 8242447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M6884.gif?s=128&g=1", "display_name": "\u1e42\u0173\u1efb\u1ecbg\u01fb\u0148\u1ea1c\u1ec3\u01a1\u1eed\u1e69", "link": "https://stackoverflow.com/users/8242447/%e1%b9%82%c5%b3%e1%bb%bb%e1%bb%8bg%c7%bb%c5%88%e1%ba%a1c%e1%bb%83%c6%a1%e1%bb%ad%e1%b9%a9"}, "edited": false, "score": 0, "creation_date": 1560316243, "post_id": 56552578, "comment_id": 99690827, "body": "This question is liable to downvoting since you haven&#39;t provided any relevant code."}, {"owner": {"reputation": 355, "user_id": 8177720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MaB7WPKxe98/AAAAAAAAAAI/AAAAAAAAAbM/sqkLZT9ecng/photo.jpg?sz=128", "display_name": "Adib Rastegarnia", "link": "https://stackoverflow.com/users/8177720/adib-rastegarnia"}, "reply_to_user": {"reputation": 2267, "user_id": 8242447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M6884.gif?s=128&g=1", "display_name": "\u1e42\u0173\u1efb\u1ecbg\u01fb\u0148\u1ea1c\u1ec3\u01a1\u1eed\u1e69", "link": "https://stackoverflow.com/users/8242447/%e1%b9%82%c5%b3%e1%bb%bb%e1%bb%8bg%c7%bb%c5%88%e1%ba%a1c%e1%bb%83%c6%a1%e1%bb%ad%e1%b9%a9"}, "edited": false, "score": 0, "creation_date": 1560446685, "post_id": 56552578, "comment_id": 99749312, "body": "I added some sample code."}], "answers": [{"tags": [], "owner": {"reputation": 2217, "user_id": 2604708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b62fe48f9c75ebe5e3868f9d428c125?s=128&d=identicon&r=PG", "display_name": "Dirbaio", "link": "https://stackoverflow.com/users/2604708/dirbaio"}, "is_accepted": true, "score": 0, "last_activity_date": 1560293689, "creation_date": 1560293689, "answer_id": 56552625, "question_id": 56552578, "link": "https://stackoverflow.com/questions/56552578/how-does-a-goroutine-behave-when-it-creates-a-channel/56552625#56552625", "title": "How does a goroutine behave when it creates a channel", "body": "<p>Yes, every time you create a channel with <code>make</code>, you get a new channel.</p>\n\n<p>If you want multiple goroutines to share a channel instead, you have to create the channel in the parent goroutine and pass it to the child goroutines.</p>\n"}], "owner": {"reputation": 355, "user_id": 8177720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MaB7WPKxe98/AAAAAAAAAAI/AAAAAAAAAbM/sqkLZT9ecng/photo.jpg?sz=128", "display_name": "Adib Rastegarnia", "link": "https://stackoverflow.com/users/8177720/adib-rastegarnia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1560322105, "accepted_answer_id": 56552625, "answer_count": 1, "score": -5, "last_activity_date": 1560446639, "creation_date": 1560293359, "last_edit_date": 1560446639, "question_id": 56552578, "link": "https://stackoverflow.com/questions/56552578/how-does-a-goroutine-behave-when-it-creates-a-channel", "closed_reason": "Needs more focus", "title": "How does a goroutine behave when it creates a channel", "body": "<p>Suppose I have a function which creates a goroutine and inside that goroutine, I create a channel. My question is that when we create N go routines, N separate channels will be created?</p>\n\n<p>A sample code here: </p>\n\n<pre><code>func createAChannel() {\n\n  // make a channel\n\n}\nfunc main() {\n  for i := 0; i &lt; 10; i++ {\n  go createAChannel()}\n\n}\n</code></pre>\n"}, {"tags": ["go", "protocol-buffers", "protoc", "twirp"], "answers": [{"comments": [{"owner": {"reputation": 40792, "user_id": 563420, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/715062f31800335c2a33422b311dbb93?s=128&d=identicon&r=PG", "display_name": "rynop", "link": "https://stackoverflow.com/users/563420/rynop"}, "edited": false, "score": 0, "creation_date": 1560348339, "post_id": 56554322, "comment_id": 99707724, "body": "Thanks, very helpful.  It works if I do <code>-I&#47;usr&#47;local&#47;include -I.</code> . However I&#39;m using dep to &quot;lock in&quot; my dependencies.  I want to do the same thing with protoc.  I don&#39;t want a global install of protoc because I wan&#39;t to lock-in/tie a protoc version to this project. I&#39;ve updated my post with how I install. Is there a best practice for this that still gets the headers? Or am I being overly concerned here (making something out of nothing)?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 40792, "user_id": 563420, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/715062f31800335c2a33422b311dbb93?s=128&d=identicon&r=PG", "display_name": "rynop", "link": "https://stackoverflow.com/users/563420/rynop"}, "edited": false, "score": 1, "creation_date": 1560348710, "post_id": 56554322, "comment_id": 99707978, "body": "I agree/share your concerns about the lock-in. You will encounter <code>proto2</code> and <code>proto3</code> projects and being able to juggle them on a build system is key.  In my makefiles, I explicitly have <code>PROTOC2</code> or <code>PROTOC3</code> env vars pointing to the relevant compiler path - and similarly use the <code>-IPATH</code> flag to point to associated standard headers. I&#39;ll update this answer shortly to include those details..."}, {"owner": {"reputation": 40792, "user_id": 563420, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/715062f31800335c2a33422b311dbb93?s=128&d=identicon&r=PG", "display_name": "rynop", "link": "https://stackoverflow.com/users/563420/rynop"}, "edited": false, "score": 1, "creation_date": 1560349820, "post_id": 56554322, "comment_id": 99708648, "body": "Thanks. My zip included the <code>include</code> dir and I never realized it.  I changed to <code>-Ibuild&#47;protoc&#47;include -I.</code> and now I&#39;m golden.  THANK YOU!"}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 2, "last_activity_date": 1560311439, "last_edit_date": 1560311439, "creation_date": 1560310409, "answer_id": 56554322, "question_id": 56551570, "link": "https://stackoverflow.com/questions/56551570/how-do-i-correctly-include-golang-protobuf-ptypes-for-protoc-when-using-dep/56554322#56554322", "title": "How do I correctly include golang protobuf/ptypes for protoc when using dep?", "body": "<p>The <code>protoc</code> error you are getting relates to your <code>INCLUDE</code> path.</p>\n\n<p>When you installed the <code>protoc</code> compiler (e.g. to <code>/usr/local/bin/protoc</code>), for it to pick up google's standard proto definitions like <code>timestamp.proto</code> - these need to be added somewhere along your <code>INCLUDE</code> path (on MacOS/Linux one may use <code>/usr/local/include</code>). Note: the protoc headers should have been included with the protoc compiler.</p>\n\n<p>So your proto import file would typically be located here:</p>\n\n<pre><code>/usr/local/include/google/protobuf/timestamp.proto\n</code></pre>\n\n<p>This path will be referenced when the <code>protoc</code> compiler sees an import like:</p>\n\n<pre><code>import \"google/protobuf/timestamp.proto\";\n</code></pre>\n\n<p>So check your <code>INCLUDE</code> path and ensure the <code>protoc</code> headers are installed correctly.</p>\n"}], "owner": {"reputation": 40792, "user_id": 563420, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/715062f31800335c2a33422b311dbb93?s=128&d=identicon&r=PG", "display_name": "rynop", "link": "https://stackoverflow.com/users/563420/rynop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1766, "favorite_count": 0, "accepted_answer_id": 56554322, "answer_count": 1, "score": 1, "last_activity_date": 1560348390, "creation_date": 1560286670, "last_edit_date": 1592644375, "question_id": 56551570, "link": "https://stackoverflow.com/questions/56551570/how-do-i-correctly-include-golang-protobuf-ptypes-for-protoc-when-using-dep", "title": "How do I correctly include golang protobuf/ptypes for protoc when using dep?", "body": "<p>I'm having trouble including the <a href=\"https://developers.google.com/protocol-buffers/docs/reference/go-generated#well-known-types\" rel=\"nofollow noreferrer\">google/protobuf/timestamp.proto</a> well known type, when using <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">dep</a>.</p>\n<p>I get an error: <code>google/protobuf/timestamp.proto: File not found</code></p>\n<p>service.proto:</p>\n<pre><code>syntax = &quot;proto3&quot;;\nimport &quot;google/protobuf/timestamp.proto&quot;;\n\npackage com.rynop.platform;\noption go_package = &quot;rpc&quot;;\n\nservice PlatformService {\n  rpc Test(EmptyMessage) returns (EmptyMessage);\n}\n\nmessage EmptyMessage { }\n\nmessage A {  \n    string summary = 1;\n    google.protobuf.Timestamp start = 2;\n}\n\nmessage B {\n  repeated A foos = 1;\n}\n</code></pre>\n<p>Install package containing timestamp .proto def:</p>\n<pre><code>dep ensure -add github.com/golang/protobuf/ptypes/timestamp \n</code></pre>\n<p>Run <code>protoc</code> and get error:</p>\n<pre><code>build/bin/protoc -Ivendor -I. --twirp_typescript_out=version=v6:./clients/ts-json/ rpc/service.proto\ngoogle/protobuf/timestamp.proto: File not found.\n</code></pre>\n<p>The dir containing timestamp's .proto definition exists:</p>\n<pre><code>file vendor/github.com/golang/protobuf/ptypes/timestamp/timestamp.proto\nvendor/github.com/golang/protobuf/ptypes/timestamp/timestamp.proto: ASCII text\n</code></pre>\n<p>I'm installing protoc locally because I wan't to lock-in/tie a protoc version to this project:</p>\n<pre><code># fetch the protoc compiler\nOS_NAME=$(shell uname -s)\nifeq ($(OS_NAME),Darwin)\n    PROTOC_URL=https://github.com/google/protobuf/releases/download/v3.7.1/protoc-3.7.1-osx-x86_64.zip\nendif\nifeq ($(OS_NAME),Linux)\n    PROTOC_URL=https://github.com/google/protobuf/releases/download/v3.7.1/protoc-3.7.1-linux-x86_64.zip\nendif\nbuild/protoc build/bin/protoc:\n    mkdir -p build/protoc/bin build/bin\n    cd build/protoc &amp;&amp; curl -L -o protoc.zip $(PROTOC_URL) &amp;&amp; \\\n        unzip protoc.zip &amp;&amp; mv bin/protoc ../bin/protoc\n</code></pre>\n<p>What am I doing wrong?</p>\n"}, {"tags": ["azure", "go", "azure-active-directory"], "comments": [{"owner": {"reputation": 1127, "user_id": 4904673, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NKZ2RbTlSZQ/AAAAAAAAAAI/AAAAAAAAACw/moEQESbBqWY/photo.jpg?sz=128", "display_name": "Shangjian Ding", "link": "https://stackoverflow.com/users/4904673/shangjian-ding"}, "reply_to_user": {"reputation": 30516, "user_id": 9455659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Albsq.jpg?s=128&g=1", "display_name": "Joy Wang", "link": "https://stackoverflow.com/users/9455659/joy-wang"}, "edited": false, "score": 0, "creation_date": 1560439925, "post_id": 56551566, "comment_id": 99745941, "body": "Ok. I marked it as the accepted answer."}], "answers": [{"tags": [], "owner": {"reputation": 30516, "user_id": 9455659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Albsq.jpg?s=128&g=1", "display_name": "Joy Wang", "link": "https://stackoverflow.com/users/9455659/joy-wang"}, "is_accepted": true, "score": 1, "last_activity_date": 1560318680, "creation_date": 1560318680, "answer_id": 56555430, "question_id": 56551566, "link": "https://stackoverflow.com/questions/56551566/how-to-get-object-id-from-application-client-id-and-directory-tenant-id/56555430#56555430", "title": "How to get Object ID from Application (client) ID and Directory (tenant) ID?", "body": "<p>The function in your question is to get the id of the service principal(located in the <code>Enterprise applications</code> in the portal), not the azure ad application(located in the <code>App registrations</code>) which in your screenshot.</p>\n\n<p>It seems there is no such function to get the <code>objectid</code> of the application via the properties that you want to use. (I am not familiar with go, if there is something wrong, please correct me.) The most similar is <a href=\"https://godoc.org/github.com/Azure/azure-sdk-for-go/services/graphrbac/1.6/graphrbac#ApplicationsClient.Get\" rel=\"nofollow noreferrer\"><code>func (ApplicationsClient) Get</code></a> which need the <code>objectid</code>, or the <a href=\"https://godoc.org/github.com/Azure/azure-sdk-for-go/services/graphrbac/1.6/graphrbac#ApplicationsClient.List\" rel=\"nofollow noreferrer\"><code>func (ApplicationsClient) List</code></a>  to list applications. </p>\n"}], "owner": {"reputation": 1127, "user_id": 4904673, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NKZ2RbTlSZQ/AAAAAAAAAAI/AAAAAAAAACw/moEQESbBqWY/photo.jpg?sz=128", "display_name": "Shangjian Ding", "link": "https://stackoverflow.com/users/4904673/shangjian-ding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 980, "favorite_count": 0, "accepted_answer_id": 56555430, "answer_count": 1, "score": 0, "last_activity_date": 1560318680, "creation_date": 1560286616, "last_edit_date": 1560306040, "question_id": 56551566, "link": "https://stackoverflow.com/questions/56551566/how-to-get-object-id-from-application-client-id-and-directory-tenant-id", "title": "How to get Object ID from Application (client) ID and Directory (tenant) ID?", "body": "<p>Using the azure go sdk, is it possible to use the <code>Application (client) ID</code>, <code>Directory (tenant) ID</code>, and a valid <code>Client secret</code> to obtain the <code>Object ID</code> of the Azure Active Directory application? How?</p>\n\n<p>Here is a screenshot of the Azure portal to help clarify those three fields.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aDI53.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aDI53.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've tried to use the following <a href=\"https://godoc.org/github.com/Azure/azure-sdk-for-go/services/graphrbac/1.6/graphrbac#ApplicationsClient.GetServicePrincipalsIDByAppID\" rel=\"nofollow noreferrer\">function from graphrbac</a>, but the <code>*result.Value</code> does not match with the <code>Object ID</code> from the screenshot above.</p>\n\n<p><code>func (client ApplicationsClient) GetServicePrincipalsIDByAppID(ctx context.Context, applicationID string) (result ServicePrincipalObjectResult, err error)</code></p>\n"}, {"tags": ["html", "go", "go-templates"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1560288049, "post_id": 56551429, "comment_id": 99685260, "body": "It&#39;s not clear what you&#39;re asking here or what problem you&#39;re having. &quot;if I use a go template I cannot show an image along with html and still keep the project size small&quot; doesn&#39;t really make sense - using templates has nothing to do with showing images and neither has much to do with the &quot;project size&quot;. Can you clarify your question?"}, {"owner": {"reputation": 9, "user_id": 8206601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc93a6413295f6bce2909313f2c311c1?s=128&d=identicon&r=PG&f=1", "display_name": "djoemart", "link": "https://stackoverflow.com/users/8206601/djoemart"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560306085, "post_id": 56551429, "comment_id": 99688849, "body": "OK, I tried to make things a bit more clear.  Hopefully it makes more sense now?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560346227, "post_id": 56551429, "comment_id": 99706343, "body": "There&#39;s no mandated file structure. You can do whatever you want. You&#39;ll need at a minimum a route to serve the template, and a route to serve the static files (images). It could all be in one, fairly small file, in one directory along with the images, if you wanted to do it that way. It seems like you&#39;ve got the template working, serving static files is well-documented in net/http and frequently answered on SO. What specifically are you having trouble with other than feeling like you&#39;re supposed to have more directories?"}, {"owner": {"reputation": 9, "user_id": 8206601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc93a6413295f6bce2909313f2c311c1?s=128&d=identicon&r=PG&f=1", "display_name": "djoemart", "link": "https://stackoverflow.com/users/8206601/djoemart"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560354015, "post_id": 56551429, "comment_id": 99711151, "body": "My main problem is I cannot display both image and form fields at the same time.  I am close I think. Currently, it appears to work with 1 request then I get error: http: panic serving [::1]:55198: http: multiple registrations for /img/.  If I use mux: mux.Handle(&quot;/img/&quot;, http.StripPrefix(&quot;/img/&quot;, http.FileServer(http.Dir(&quot;img&quot;))))  I do not get an error but the image never shows only the forms.  So my problem is I cannot get both forms and images to load together in a single html page.  Maybe I need to add routes but I am so close with just with what I have.  Does that make sense?"}, {"owner": {"reputation": 9, "user_id": 8206601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc93a6413295f6bce2909313f2c311c1?s=128&d=identicon&r=PG&f=1", "display_name": "djoemart", "link": "https://stackoverflow.com/users/8206601/djoemart"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560354566, "post_id": 56551429, "comment_id": 99711454, "body": "Can you elaborate with your question?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8206601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc93a6413295f6bce2909313f2c311c1?s=128&d=identicon&r=PG&f=1", "display_name": "djoemart", "link": "https://stackoverflow.com/users/8206601/djoemart"}, "edited": false, "score": 0, "creation_date": 1560366379, "post_id": 56566834, "comment_id": 99716789, "body": "Adrian, many thanks!  That certainly seems to have resolved the issue I have had and been stuck on the past few days....I almost was about to just give up so thanks again!"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1560357468, "creation_date": 1560357468, "answer_id": 56566834, "question_id": 56551429, "link": "https://stackoverflow.com/questions/56551429/simple-way-to-display-image-file-with-html-forms-section/56566834#56566834", "title": "Simple way to display image file with HTML forms section", "body": "<p>You have your <code>http.Handle</code> call, which <em>registers</em> the handler, <em>inside the handler</em>. That means every time a request comes in, it tries to register the handler <em>again</em>. That's not allowed (hence the error, which says explicitly that you cannot re-register the same route). You should be registering it in the same place you're registering the handler for the template, i.e. in <code>main</code>:</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/login\", login)\n    // Register handler correctly\n    // I changed the route to /img/ to match what you're using in your HTML\n    http.Handle(\"/img/\", http.StripPrefix(\"/img/\", http.FileServer(http.Dir(\"images/\"))))\n    err := http.ListenAndServe(\":9090\", nil) // setting listening port\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8206601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc93a6413295f6bce2909313f2c311c1?s=128&d=identicon&r=PG&f=1", "display_name": "djoemart", "link": "https://stackoverflow.com/users/8206601/djoemart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1560357468, "creation_date": 1560285840, "last_edit_date": 1560305957, "question_id": 56551429, "link": "https://stackoverflow.com/questions/56551429/simple-way-to-display-image-file-with-html-forms-section", "title": "Simple way to display image file with HTML forms section", "body": "<p>I have been playing around with numerous go server snippets trying to figure out how I can display an image file within a HTML file or go HTTP template along with an html forms section.  Basically, the biggest problem if I use a go template I cannot show an image along with html and still keep the project size small.  It seems the only way to get the template to work is by organizing the code into a \"typical go HTML project\" which I am trying to avoid.</p>\n\n<p>Is there any easy way (with only a couple files and not creating a \"typical go web project file structure\") to display HTML with an image inside a go template?  I believe the problem below is basically with http handlers.  Either I can have a text handler or image handler but not both?  I need both so I can have user control from HTML form which image will be displayed.</p>\n\n<p>If anyone can help I would really appreciate it.</p>\n\n<p>R\nJoe</p>\n\n<p>--Revised\nSorry about being unclear.  I have limited experience with go templates and I have seen many examples where people use go app project file structures that might include directories such as templates, img, etc.  These directories are often 10 or more.  Then they talk about using routes within apps and other things that I am timid to get into.</p>\n\n<p>I just view what I want to do as much more simple.  I have about 70 images.  I just want a way where a user can click an html page that displays an image and just provide a number 1,2,3,4 as feedback depending on what image is being displayed.</p>\n\n<p>I imagined that a single go program (1 file) could receive the number and once received change the img on the html page or allow the user to click a next hyperlink or something to bring up the next image and once it is over the program stops.</p>\n\n<pre><code>package main\nimport (\n\n\"fmt\"\n\"html/template\"\n\"log\"\n\"net/http\"\n//\"strings\"\n\n\n\nfunc img(w http.ResponseWriter, r *http.Request) {\n\n//http.Handle(\"/images/\", http.StripPrefix(\"/images/\", http.FileServer(http.Dir(\"images/\"))))\n\nfmt.Println(\"method:\", r.Method) //get request method\n\nif r.Method == \"GET\" {\n    t, _ := template.ParseFiles(\"image.gtpl\")\n    t.Execute(w, nil)\n} else {\n    r.ParseForm()\n    // logic part of log in\n    fmt.Println(\"previmage:\", r.Form[\"previmage\"])\n    fmt.Println(\"nextimage:\", r.Form[\"nextimage\"])\n}\n}\n\nfunc main() {\n\n//http.HandleFunc(\"/\", sayhelloName) // setting router rule\nhttp.HandleFunc(\"/login\", login)\nerr := http.ListenAndServe(\":9090\", nil) // setting listening port\nif err != nil {\n    log.Fatal(\"ListenAndServe: \", err)\n}\n}\n\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt; //How to Loop Images based on user submit??\n&lt;img src=\"img/question4.png\" alt=\"Cannot load image\" style=\"width: 800px;height: 800px\"&gt;\n    &lt;form action=\"/login\" method=\"post\"&gt;\n        Username:&lt;input type=\"text\" name=\"previmage\"&gt;\n        Password:&lt;input type=\"password\" name=\"nextimage\"&gt;\n        &lt;input type=\"submit\" value=\"Login\"&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 2, "creation_date": 1560278789, "post_id": 56549917, "comment_id": 99681762, "body": "All your methods use value instead of pointer receivers. As such none of these methods will have any effect on the value - as they change a copy of the struct - and not the original struct value. See the <a href=\"https://tour.golang.org/methods/4\" rel=\"nofollow noreferrer\">tour</a> for a refresher."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1560279179, "post_id": 56549917, "comment_id": 99681938, "body": "You&#39;re also ranging over a string rather than your channel in <code>worker</code>."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1560284349, "post_id": 56549917, "comment_id": 99683985, "body": "And <code>ntasks</code> needs a lock to be go-routine safe."}], "answers": [{"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 0, "last_activity_date": 1560279570, "last_edit_date": 1560279570, "creation_date": 1560279097, "answer_id": 56550093, "question_id": 56549917, "link": "https://stackoverflow.com/questions/56549917/golang-async-buffered-channel-hangs/56550093#56550093", "title": "golang async buffered channel hangs", "body": "<p>Change all your receivers to pointers like so:</p>\n\n<pre><code>func (s *Scraper) Init(timeout int, workers int) // *Scraper not 'Scraper'\n</code></pre>\n\n<p>For further details on pointer receivers:  <a href=\"https://tour.golang.org/methods/4\" rel=\"nofollow noreferrer\">https://tour.golang.org/methods/4</a></p>\n\n<p>As @JimB noted - the range has a bug too, it should be like so:</p>\n\n<pre><code>func (s *Scraper) worker(id int) {\n    // `range s.tasks` not `range &lt;-s.tasks`\n    for task := range s.tasks {\n        fmt.Println(task)\n        s.results &lt;- 0\n    }\n}\n</code></pre>\n\n<p>Playground with receiver &amp; range fixes: <a href=\"https://play.golang.org/p/RulKHHfnvJo\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RulKHHfnvJo</a></p>\n"}], "owner": {"reputation": 66, "user_id": 6585097, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-U7Sx0EuLLH4/AAAAAAAAAAI/AAAAAAAAAn8/KBTneTP3SuI/photo.jpg?sz=128", "display_name": "Mirco De Zorzi", "link": "https://stackoverflow.com/users/6585097/mirco-de-zorzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 56550093, "answer_count": 1, "score": 0, "last_activity_date": 1560279570, "creation_date": 1560278385, "question_id": 56549917, "link": "https://stackoverflow.com/questions/56549917/golang-async-buffered-channel-hangs", "title": "golang async buffered channel hangs", "body": "<p>As a first go project I decided to write a simple async web-scaper. My idea is to have a queue of tasks and a pool of workers \"solving\" the tasks. While writing the program I encountered the a problem.</p>\n\n<p>the following code hangs:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"time\"\n)\n\ntype Scraper struct {\n    client http.Client\n    timeout int\n    tasks chan string\n    results chan int\n    ntasks int\n}\n\nfunc (s Scraper) Init(timeout int, workers int) {\n    s.client = http.Client{\n        Timeout: time.Second * time.Duration(timeout),\n    }\n    s.timeout = timeout\n    s.ntasks = 0\n    s.Dispatch(workers)\n}\n\nfunc (s Scraper) Wait() {\n    for i := 0; i &lt; s.ntasks; i++ {\n        &lt;-s.results\n    }\n}\n\nfunc (s Scraper) Task(task string) {\n    s.tasks &lt;- task // hangs on this line\n    s.ntasks++;\n}\n\nfunc (s Scraper) Dispatch(workers int) {\n    s.tasks   = make(chan string, 100)\n    s.results = make(chan int,    100)\n    for i := 0; i &lt; workers; i++ {\n        go s.worker(i)\n    }\n}\n\nfunc (s Scraper) worker(id int) {\n    for task := range &lt;-s.tasks {\n        fmt.Println(task)\n        s.results &lt;- 0\n    }\n}\n\nfunc main() {\n\n    s := Scraper{}\n    s.Init(10, 5)\n    s.Task(\"Hello World\")\n    s.Wait()\n\n}\n</code></pre>\n\n<p>while this doesn't:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func worker(id int, jobs &lt;-chan int, results chan&lt;- int) {\n    for j := range jobs {\n        fmt.Println(\"worker\", id, \"started  job\", j)\n        time.Sleep(time.Second)\n        fmt.Println(\"worker\", id, \"finished job\", j)\n        results &lt;- j * 2\n    }\n}\n\nfunc main() {\n    jobs    := make(chan int, 100)\n    results := make(chan int, 100)\n\n    for w := 1; w &lt;= 3; w++ {\n        go worker(w, jobs, results)\n    }\n\n    for j := 1; j &lt;= 5; j++ {\n        jobs &lt;- j\n    }\n\n    close(jobs)\n\n    for a := 1; a &lt;= 5; a++ {\n        &lt;-results\n    }\n\n}\n</code></pre>\n\n<p>Looking on stack overflow I saw that unbuffered channels hang but make(chan string, 100) should create a buffered one.</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 6853753, "user_type": "registered", "profile_image": "https://graph.facebook.com/1093705174047596/picture?type=large", "display_name": "Dennys Azevedo", "link": "https://stackoverflow.com/users/6853753/dennys-azevedo"}, "is_accepted": false, "score": 0, "last_activity_date": 1560390571, "last_edit_date": 1560390571, "creation_date": 1560303862, "answer_id": 56553606, "question_id": 56549274, "link": "https://stackoverflow.com/questions/56549274/how-to-init-and-insert-struct-with-foreign-key-constraint-into-db-using-gorm/56553606#56553606", "title": "How to init and insert struct with foreign key constraint into db using GORM", "body": "<p>You should pass a pointer on gorm's Create method to get your model Filled after creation...</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>GetDB().Create(&amp;profile)\n</code></pre>\n\n<p>But, as is showed in <a href=\"https://gorm.io/docs/associations.html\" rel=\"nofollow noreferrer\">https://gorm.io/docs/associations.html</a> gorm Auto create the associations.</p>\n\n<p>You can change your models, like so... (I am supposing that User and Profile has a 1..1 relation ok?)\nAnd everything will get done automatically</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type User struct {\n    gorm.Model\n    Email     string `gorm:\"type:varchar(100);unique_index\"`\n    Password  string `json:\"password\"`\n    Name      string `json:\"name\"`\n    Token     string `json:\"token\";sql:\"-\"`\n    Profile   Profile\n    ProfileID uint\n}\n\ntype Profile struct {\n    gorm.Model\n    UserID      uint\n    FirstName   string `gorm:\"default:'John'\"`\n    LastName    string `gorm:\"default:'Doe'\"`\n    Description string `gorm:\"default:'Mysterious'\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 1060, "user_id": 1904151, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/bcf8addaae94d2a38e44eee62207db39?s=128&d=identicon&r=PG&f=1", "display_name": "alexc", "link": "https://stackoverflow.com/users/1904151/alexc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1224, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560390571, "creation_date": 1560275580, "last_edit_date": 1560278456, "question_id": 56549274, "link": "https://stackoverflow.com/questions/56549274/how-to-init-and-insert-struct-with-foreign-key-constraint-into-db-using-gorm", "title": "How to init and insert struct with foreign key constraint into db using GORM", "body": "<p>I am trying to create a rest API with golang. Each time a user is created, I would like to create a 'Profile' which is associated with that user. </p>\n\n<p>My initial thought was to first create the user, and then separately create the profile referencing the user ID and inserting that into the database. </p>\n\n<p>I'm not sure if this kind of thinking aligns with the way go should be used as i'm just starting with the language. </p>\n\n<p>Using below code, I create the user, but cannot create the profile. I receive this error: <code>using unaddressable value</code></p>\n\n<pre><code>var db *gorm.DB\n\nfunc GetDB() *gorm.DB {\n    return db\n}\n\ntype User struct {\n    gorm.Model\n    Email    string `gorm:\"type:varchar(100);unique_index\"`\n    Password string `json:\"password\"`\n    Name     string `json:\"name\"`\n    Token    string `json:\"token\";sql:\"-\"`\n}\n\ntype Profile struct {\n    gorm.Model\n    User        User `gorm:\"foreignkey:UserRefer\"` // use UserRefer as foreign key\n    UserRefer   uint\n    FirstName   string `gorm:\"default:'John'\"`\n    LastName    string `gorm:\"default:'Doe'\"`\n    Description string `gorm:\"default:'Mysterious'\"`\n}\n\nfunc (user *User) Create() (map[string]interface{}) {\n\n    if resp, ok := user.Validate(); !ok {\n        return resp\n    }\n\n    hashedPassword, _ := bcrypt.GenerateFromPassword([]byte(user.Password), bcrypt.DefaultCost)\n    user.Password = string(hashedPassword)\n\n    GetDB().Create(user)\n\n    profile := Profile{}\n    profile.UserRefer = user.ID\n\n    GetDB().Create(profile)\n\n    if user.ID &lt;= 0 {\n        return u.Message(false, \"Failed to create account, connection error.\")\n    }\n\n    response := u.Message(true, \"Account has been created\")\n    response[\"user\"] = user\n\n    return response\n\n}\n</code></pre>\n\n<p>I'm hoping someone will be able to help me understand what is going wrong here?</p>\n"}, {"tags": ["json", "go", "go-structtag"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1560273133, "post_id": 56548680, "comment_id": 99679196, "body": "`    HostList {}Host` is not valid Go. It won&#39;t compile. Is that a typo?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1560273139, "post_id": 56548680, "comment_id": 99679199, "body": "What have you tried? What issue did you run into? Please show your attempt and describe specifically what problems you had. This seems fairly straightforward, aside from the typo where <code>{}Host</code> should be <code>[]Host</code>."}, {"owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "edited": false, "score": 0, "creation_date": 1560273488, "post_id": 56548680, "comment_id": 99679338, "body": "You can just create a slice of Hosts, i.e. <code>hostsSlice := []Host</code> and then <code>unmarshal</code> your json into that hostsSlice variable for easy management. Sample playground code <a href=\"https://goplay.space/#-dSZbkFmzdc\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5456462, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N9vsvDT0B7c/AAAAAAAAAAI/AAAAAAAAAKA/JE2pH0psGF8/photo.jpg?sz=128", "display_name": "Hrishikesh Bajad", "link": "https://stackoverflow.com/users/5456462/hrishikesh-bajad"}, "edited": false, "score": 1, "creation_date": 1560274747, "post_id": 56548816, "comment_id": 99679925, "body": "Works like a charm"}], "tags": [], "owner": {"reputation": 2667, "user_id": 1508147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nueRO.jpg?s=128&g=1", "display_name": "Sathishkumar Rakkiasamy", "link": "https://stackoverflow.com/users/1508147/sathishkumar-rakkiasamy"}, "is_accepted": true, "score": 0, "last_activity_date": 1560273974, "last_edit_date": 1560273974, "creation_date": 1560273588, "answer_id": 56548816, "question_id": 56548680, "link": "https://stackoverflow.com/questions/56548680/read-multiple-json-object-from-a-json-file-in-go/56548816#56548816", "title": "Read Multiple json object from a json file in Go", "body": "<p>Try using below</p>\n\n<pre><code>type HostList []struct {\n  IP       string `json:\"ip\"`\n  Netmask  string `json:\"netmask\"`\n  Gateway  string `json:\"gateway\"`\n  Mac      string `json:\"mac\"`\n  Hostname string `json:\"hostname\"`\n  Callback string `json:\"callback\"`\n}\n</code></pre>\n\n<p>You can use this site <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">https://mholt.github.io/json-to-go/</a> for generating Go struct from JSON.</p>\n"}], "owner": {"reputation": 17, "user_id": 5456462, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N9vsvDT0B7c/AAAAAAAAAAI/AAAAAAAAAKA/JE2pH0psGF8/photo.jpg?sz=128", "display_name": "Hrishikesh Bajad", "link": "https://stackoverflow.com/users/5456462/hrishikesh-bajad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 56548816, "answer_count": 1, "score": -3, "last_activity_date": 1560273974, "creation_date": 1560272980, "last_edit_date": 1560273130, "question_id": 56548680, "link": "https://stackoverflow.com/questions/56548680/read-multiple-json-object-from-a-json-file-in-go", "title": "Read Multiple json object from a json file in Go", "body": "<p>I am trying to read the following json objects from the json file. So the number of objects are not predefined, they can be multiple or just one. </p>\n\n<p>So I tried making this struct but I am not able to read it properly. I want to parse the elements inside the json object.</p>\n\n<pre><code>type HostList struct {\n    HostList {}Host\n}\n\ntype Host struct {\n    IP       string `json: \"ip\"`\n    Netmask  string `json: \"netmask\"`\n    Gateway  string `json: \"gateway\"`\n    Mac      string `json: \"mac\"`\n    Hostname string `json: \"hostname\"`\n    Callback string `json: \"callback\"`\n}\n</code></pre>\n\n<p>And I want to read this Json file:</p>\n\n<pre><code>[\n    {\n        \"ip\": \"4.3.2.10\",\n        \"netmask\": \"255.255.255.234\",\n        \"gateway\": \"4.3.2.1\",\n        \"mac\": \"12:34:af:56:54:jj\",\n        \"hostname\": \"cds1.yyy.com\",\n        \"callback\": \"\"\n    },\n    {\n        \"ip\": \"4.3.2.11\",\n        \"netmask\": \"255.255.255.234\",\n        \"gateway\": \"4.3.2.1\",\n        \"mac\": \"12:34:af:55:54:jj\",\n        \"hostname\": \"cds2.yyy.com\",\n        \"callback\": \"\"\n    }\n]\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "answers": [{"comments": [{"owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "edited": false, "score": 0, "creation_date": 1560274832, "post_id": 56548702, "comment_id": 99679974, "body": "Thank you for your help!"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1560273062, "creation_date": 1560273062, "answer_id": 56548702, "question_id": 56548512, "link": "https://stackoverflow.com/questions/56548512/retrieve-content-from-specified-list-of-s3-directories/56548702#56548702", "title": "Retrieve content from specified list of S3 directories", "body": "<p>Not with a single call, no - particularly if you have enough objects to trigger paginated results. <a href=\"https://docs.aws.amazon.com/sdk-for-go/v1/api/service.s3.S3.html#service.s3.S3.ListObjects\" rel=\"nofollow noreferrer\"><code>ListObjects</code></a> takes a <a href=\"https://docs.aws.amazon.com/sdk-for-go/v1/api/service.s3.ListObjectsInput.html\" rel=\"nofollow noreferrer\"><code>ListObjectsInput</code></a> where <code>Prefix</code> is a single string, not a slice/array.</p>\n"}], "owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56548702, "answer_count": 1, "score": 0, "last_activity_date": 1560274813, "creation_date": 1560272219, "last_edit_date": 1560274813, "question_id": 56548512, "link": "https://stackoverflow.com/questions/56548512/retrieve-content-from-specified-list-of-s3-directories", "title": "Retrieve content from specified list of S3 directories", "body": "<p>Is there a way to retrieve list of all files from specified list of directories at specific <code>S3 bucket</code> by invoking cloud API only once?</p>\n\n<p>For example, lets say that I have following structure at my <code>S3</code> cloud service:</p>\n\n<pre><code>A/\n AA/\n   XXX/\n\nB/\n BB/\n   /EMPTY\n\nC/\n /EMPTY\n\nD/\n DD/\n   XXX/\n</code></pre>\n\n<p>And that I also have list of directories from which I wish to retrieve content:</p>\n\n<pre><code>Requested Paths: {\n    \"A/AA/XXX\",\n    \"B/BB/XXX\",\n    \"C/CC/XXX\",\n    \"D/DD/XXX\"\n}\n</code></pre>\n\n<p>I would like to create a map with key/value pairs where key is represented by specific directory path, and value is represented by its content. If path does not exist then key/value pair should not exist ether. Something like this:</p>\n\n<pre><code>Map {\n   \"A/AA/XXX\" : Content\n   \"D/DD/XXX\" : Content\n}\n</code></pre>\n\n<p>Note that there are no keys that correspond to <code>B/BB/XXX</code> and <code>C/CC/XXX</code> since <code>XXX</code> is not part of <code>B/BB/</code>/path and <code>CC/XXX</code> is not part of <code>C/</code>  path ether.</p>\n"}, {"tags": ["go", "linker", "cgo", "pkg-config"], "answers": [{"tags": [], "owner": {"reputation": 565, "user_id": 2106703, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f298ea122773c1538399d2cf270697b3?s=128&d=identicon&r=PG", "display_name": "fzd", "link": "https://stackoverflow.com/users/2106703/fzd"}, "is_accepted": false, "score": 1, "last_activity_date": 1560355151, "creation_date": 1560355151, "answer_id": 56566239, "question_id": 56547970, "link": "https://stackoverflow.com/questions/56547970/go-pkg-tool-linux-amd64-link-running-gcc-failed-exit-status-1-usr-bin-ld-can/56566239#56566239", "title": "go/pkg/tool/linux_amd64/link: running gcc failed: exit status 1 /usr/bin/ld: cannot find -lgdal", "body": "<p>Here are a few things I did to solve this issue:</p>\n\n<ul>\n<li><code>rm -rf ~/.cache/go-build</code> : this contained a few build artifacts</li>\n<li><code>rm -rf ${MyProject}/{bin,pkg}</code> : for the same reason</li>\n</ul>\n"}], "owner": {"reputation": 565, "user_id": 2106703, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f298ea122773c1538399d2cf270697b3?s=128&d=identicon&r=PG", "display_name": "fzd", "link": "https://stackoverflow.com/users/2106703/fzd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2262, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560355151, "creation_date": 1560269971, "last_edit_date": 1560270018, "question_id": 56547970, "link": "https://stackoverflow.com/questions/56547970/go-pkg-tool-linux-amd64-link-running-gcc-failed-exit-status-1-usr-bin-ld-can", "title": "go/pkg/tool/linux_amd64/link: running gcc failed: exit status 1 /usr/bin/ld: cannot find -lgdal", "body": "<p>I am trying to run <code>go build</code> on my sources. </p>\n\n<pre><code>go/pkg/tool/linux_amd64/link: running gcc failed: exit status 1\n/usr/bin/ld: cannot find -lgdal\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>My <code>LD_LIBRARY_PATH</code> variable contains <code>/home/fzd/project/lib64</code>, the path to the dir of the <code>libgdal.so</code> file. My <code>PKG_CONFIG_PATH</code> contains the path to the dir of a <code>.pc</code> file with the following contents :</p>\n\n<pre><code>prefix=/home/fzd/project\nexec_prefix=${prefix}\nlibdir=${prefix}/lib64\ndeplibdir=${prefix}/lib64\nincludedir=${prefix}/include\n\nName: myLibs\nDescription: Libs\nRequires:\nVersion: v1.0\nLibs: -L${deplibdir} -lgdal\nCflags: -I${includedir}\n</code></pre>\n\n<p>I don't know which variable to check. Everything seems fine, and the fun part is that, when I clone my repo elsewhere, I don't have the issue (same <code>LD_LIBRARY_PATH</code>, etc.)</p>\n\n<p>Does anyone have a clue about what I could check?</p>\n\n<p>I am using go1.11.1, on CentOS7.6.</p>\n"}, {"tags": ["go", "exec"], "answers": [{"comments": [{"owner": {"reputation": 2490, "user_id": 4967929, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fc9ad15bcbdaeb1aeed830f1ad21cc7a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4967929/michael"}, "edited": false, "score": 0, "creation_date": 1560267265, "post_id": 56547126, "comment_id": 99676153, "body": "Whoops, that makes a lot of sense. Works now, thanks!"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 7, "last_activity_date": 1560267112, "creation_date": 1560267112, "answer_id": 56547126, "question_id": 56547041, "link": "https://stackoverflow.com/questions/56547041/trouble-execing-command-with-weird-characters-in-it/56547126#56547126", "title": "Trouble exec&#39;ing command with weird characters in it", "body": "<p>It has nothing to do with \"weird\" characters. <code>\\\"*.txt\\\"\"</code> is quoted for your shell, but you're not running this in your shell. It should just be <code>*.txt</code>, which is the actual argument you want <code>find</code> to receive as the value for <code>-iname</code>:</p>\n\n<pre><code>fullCmd := \"find my-files -maxdepth 1 -type f -iname *.txt\"\n</code></pre>\n\n<p>Though, because this is <em>not</em> a shell, I would strongly recommend against this approach of building a shell-like command as a single string and splitting on spaces; just provide the args as an array in the first place to avoid confusion like this.</p>\n"}], "owner": {"reputation": 2490, "user_id": 4967929, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fc9ad15bcbdaeb1aeed830f1ad21cc7a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4967929/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 56547126, "answer_count": 1, "score": -2, "last_activity_date": 1560267112, "creation_date": 1560266857, "question_id": 56547041, "link": "https://stackoverflow.com/questions/56547041/trouble-execing-command-with-weird-characters-in-it", "title": "Trouble exec&#39;ing command with weird characters in it", "body": "<p>I'm trying to call the builtin function <code>find</code> to print out the contents of all the text files in a subfolder my-files. I understand that there are easier ways to do this, but I need to get it working with exec. I suspect that exec is not handling quotes correctly. My initial code is as follows:</p>\n\n<pre><code>fullCmd := \"find my-files -maxdepth 1 -type f\"\ncmdParts := strings.Split(fullCmd, \" \")\noutput, _ := exec.Command(cmdParts[0], cmdParts[1:]...).CombinedOutput()\nfmt.Println(\"Output is...\")\nfmt.Println(string(output))\n</code></pre>\n\n<p>This works fine and prints out </p>\n\n<pre><code>Output is...\nmy-files/goodbye.txt\nmy-files/badfile.java\nmy-files/hello.txt\n</code></pre>\n\n<p>However, when I then try to start adding 'weirder' characters, it falls apart. If I change the first line to</p>\n\n<pre><code>fullCmd := \"find my-files -maxdepth 1 -type f -iname \\\"*.txt\\\"\"\n</code></pre>\n\n<p>Nothing prints out. Worse, if I change the line to:</p>\n\n<pre><code>fullCmd := \"find my-files -maxdepth 1 -type f -exec cat {} \\\\;\"\n</code></pre>\n\n<p>Find errors out with this stdout:</p>\n\n<pre><code>Output is...\nfind: -exec: no terminating \";\" or \"+\"\n</code></pre>\n\n<p>I thought I was correctly escaping the neccesary characters, but I guess not. Any ideas on how to get the command to work? For reference, this command does exactly what I want when entered directly on the command line:</p>\n\n<pre><code>find my-files -maxdepth 1 -type f -iname \"*.txt\" -exec cat {} \\;\n</code></pre>\n"}, {"tags": ["go", "apache-kafka"], "answers": [{"comments": [{"owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "edited": false, "score": 0, "creation_date": 1560277731, "post_id": 56549649, "comment_id": 99681281, "body": "I don&#39;t understand your answer. I don&#39;t want to consume messages from a topic with a group id, I want to read the offsets of all the groups from __consumer_offsets. The part of the documentation you pointed me at explicitly says it will return -1 when using a group id. Plus, commiting offsets will defeat the entire purpose"}, {"owner": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "reply_to_user": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "edited": false, "score": 0, "creation_date": 1560280089, "post_id": 56549649, "comment_id": 99682355, "body": "Your question was asking how to not give a partition number. If you read the configuration docs of that library, you either give a single partition, or a consumer groupId so that all partitions are consumed. That property doesn&#39;t control what you read within the topic itself."}, {"owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "edited": false, "score": 0, "creation_date": 1560324492, "post_id": 56549649, "comment_id": 99693823, "body": "I&#39;m a bit confused, it might be that I don&#39;t yet understand kafka 100%. What is the logic in implementing a mechanism that does not allow me to read the entire topic unless I use a group id? I can do it without one when using kafkacat so why not in go? In my case, I want to read the <code>__consumer_offsets</code> topic because I want to do something with them (without changing them), so using a group and committing offsets defeats the purpose entirely.  Is there a reason it was implemented this way?"}, {"owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "edited": false, "score": 0, "creation_date": 1560347471, "post_id": 56549649, "comment_id": 99707144, "body": "another thing, I just tried what you suggested, it creates an infinite loop of reading __consumer_offsets, automatically committing a new offset, and reading the offsets that were just committed"}, {"owner": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "reply_to_user": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "edited": false, "score": 0, "creation_date": 1560365767, "post_id": 56549649, "comment_id": 99716529, "body": "The mechanism is called &quot;consumer groups&quot;. Kafkacat (and console-consumer) form a random one for you. You would have to turn off auto-commits if you want to read that topic without an infinite loop. I don&#39;t know the non-Java properties for that, though"}], "tags": [], "owner": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "is_accepted": false, "score": 0, "last_activity_date": 1560280167, "last_edit_date": 1560280167, "creation_date": 1560277252, "answer_id": 56549649, "question_id": 56545778, "link": "https://stackoverflow.com/questions/56545778/read-consumer-offsets-with-kafka-go/56549649#56549649", "title": "read __consumer_offsets with kafka go", "body": "<p>Use the consumer group API, and you don't need to give partitions. </p>\n\n<p><a href=\"https://github.com/segmentio/kafka-go#consumer-groups\" rel=\"nofollow noreferrer\">https://github.com/segmentio/kafka-go#consumer-groups</a></p>\n\n<blockquote>\n<pre><code>// GroupID holds the optional consumer group id.  If GroupID is specified, then\n// Partition should NOT be specified e.g. 0\nGroupID string\n\n\n// Partition to read messages from.  Either Partition or GroupID may\n// be assigned, but not both\nPartition int\n</code></pre>\n</blockquote>\n\n<p><a href=\"https://godoc.org/github.com/segmentio/kafka-go#ReaderConfig\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/segmentio/kafka-go#ReaderConfig</a></p>\n"}], "owner": {"reputation": 1794, "user_id": 1463751, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/089f887e5f22d434203d42308a4baab9?s=128&d=identicon&r=PG", "display_name": "Tom Klino", "link": "https://stackoverflow.com/users/1463751/tom-klino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 541, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560280167, "creation_date": 1560262598, "question_id": 56545778, "link": "https://stackoverflow.com/questions/56545778/read-consumer-offsets-with-kafka-go", "title": "read __consumer_offsets with kafka go", "body": "<p>I want to read from the topic __consumer_offsets using this library: <a href=\"https://github.com/segmentio/kafka-go\" rel=\"nofollow noreferrer\">https://github.com/segmentio/kafka-go</a></p>\n\n<p>My problem is that unless I specify a partition nothing seems to happen. There are 100 partitions for this topic by default, it seems unreasonable to query kafka for the list of partitions and then loop over them to read them, and I'm hoping for a pre-existing method in the library that reads messages from all partitions in the topic.</p>\n\n<p>Currently the following works, after I verified with kafkacat that there are messages in partition 15 of __consumer_offsets topic:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>  r := kafka.NewReader(kafka.ReaderConfig{\n    Brokers:   []string{\"kafka:9092\"},\n    Topic:     \"__consumer_offsets\",\n    Partition: 15\n  })\n  r.SetOffset(0)\n\n  for {\n    m, err := r.ReadMessage(context.Background())\n    if err != nil {\n      log.Println(\"Error while trying to read message\")\n      log.Fatal(err)\n      break\n    }\n    log.Printf(\"message at offset %d\\n\", m.Offset)\n  }\n\n  r.Close()\n</code></pre>\n\n<p>I would imagine that partition choosing should be transparent on the user level unless needed. Am I wrong?</p>\n\n<p>Is there a way to read from the topic regardless of which partitions the messages are in? or to rephrase, read from all partitions?</p>\n"}, {"tags": ["go", "constants", "integer-overflow"], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 741711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff559a937718ed241c344fc50756626?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/741711/john"}, "edited": false, "score": 0, "creation_date": 1560259972, "post_id": 56544258, "comment_id": 99671513, "body": "Yup, like I mentioned in my question I could just set it like that but there are many in the windows code that have negative values; this was just one example. Perhaps the wording of my question wasn&#39;t quite right....what I meant was is it possible to use the same hex value as they have defined in the windows code? I&#39;m not so familiar with the language (Go) so wasn&#39;t sure if there was some trick to make the wrap happen."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 455, "user_id": 741711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff559a937718ed241c344fc50756626?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/741711/john"}, "edited": false, "score": 1, "creation_date": 1560260041, "post_id": 56544258, "comment_id": 99671565, "body": "Yes, you can use the same hex value if you use a uint32."}, {"owner": {"reputation": 455, "user_id": 741711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff559a937718ed241c344fc50756626?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/741711/john"}, "edited": false, "score": 0, "creation_date": 1560260296, "post_id": 56544258, "comment_id": 99671713, "body": "Unfortunately that won&#39;t fly when I put it to code review. The definition in Windows is long int and WinVerifyTrust (where i use it) returns a LONG so using the uint32 type (which does make the compile error go away) wasn&#39;t an option I had unfortunately."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 455, "user_id": 741711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff559a937718ed241c344fc50756626?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/741711/john"}, "edited": false, "score": 1, "creation_date": 1560260572, "post_id": 56544258, "comment_id": 99671866, "body": "Then you&#39;re stuck with one of the other options."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1560257714, "creation_date": 1560257714, "answer_id": 56544258, "question_id": 56544122, "link": "https://stackoverflow.com/questions/56544122/how-to-set-a-constant-to-negative-value-in-go/56544258#56544258", "title": "How to set a constant to negative value in Go", "body": "<p>You just set it:</p>\n\n<pre><code>const TRUST_E_NOSIGNATURE = int32(-2146762496)\n</code></pre>\n\n<p>Use hex if you wish:</p>\n\n<pre><code>const TRUST_E_NOSIGNATURE = int32(-0x7ff4ff00)\n</code></pre>\n\n<p>But for this, you're probably just using the wrong data type. Use a uint32 instead:</p>\n\n<pre><code>const TRUST_E_NOSIGNATURE = uint32(0x800B0100)\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>why does it not wrap like it does in other languages?</p>\n</blockquote>\n\n<p>Because it wasn't designed that way. Go follows the philosophy of being as obvious and intuitive as possible. Silent wrapping is very non-intuitive.</p>\n"}], "owner": {"reputation": 455, "user_id": 741711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff559a937718ed241c344fc50756626?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/741711/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1560257714, "creation_date": 1560257266, "question_id": 56544122, "link": "https://stackoverflow.com/questions/56544122/how-to-set-a-constant-to-negative-value-in-go", "title": "How to set a constant to negative value in Go", "body": "<p>I am writing code in Go to call some of the Windows trust and crypt dlls to verify file signatures. There are many constants in wincrypt.h that I have tried to port over verbatim but i've hit some issues with integer overflow.</p>\n\n<p>For example, all of the error codes that can be returned from WinVerifyTrust are negative values. If I take one example, <strong>TRUST_E_NOSIGNATURE</strong>, this is defined in winerror.h as so: <code>#define TRUST_E_NOSIGNATURE _HRESULT_TYPEDEF_(0x800B0100L)</code>. In my Go code, I have <code>const TRUST_E_NOSIGNATURE = int32(0x800B0100)</code> but when compiled the error is:</p>\n\n<p><strong>constant 2148204800 overflows int32</strong></p>\n\n<p>when I really expected the value to be -2146762496</p>\n\n<p>So, my questions <strong>1)</strong> why does it not wrap like it does in other languages <strong>2)</strong> Is there anyway to have the constant still use the hex representation of the number or will I have to change the code to <code>const TRUST_E_NOSIGNATURE = int32(-2146762496)</code> which works ok but will require me to make this change in many other constants that I have ported?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 2, "creation_date": 1560258538, "post_id": 56543091, "comment_id": 99670510, "body": "a quick refresher on pointers may help also: <a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/1</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 2, "last_activity_date": 1560256742, "creation_date": 1560256742, "answer_id": 56543950, "question_id": 56543091, "link": "https://stackoverflow.com/questions/56543091/how-to-store-current-time-for-structs-field-of-type-time-time-in-datastore/56543950#56543950", "title": "How to store current time for struct&#39;s field of type *time.Time in DataStore?", "body": "<p>Note: one cannot get the address of a return value, so something like this will <strong><em>NOT</em></strong> work:</p>\n\n<pre><code>MyRule.UpdatedAt = &amp;time.Now() // compile fail\n</code></pre>\n\n<p>To get the address of a value, it must be in an addressable item. So assign the value to a variable, like so:</p>\n\n<pre><code>t := time.Now()\nMyRule.UpdatedAt = &amp;t\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 10295084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dz3VS2iO3Vw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNqlIuT0hmgmE7g-2JS52hKPZ_uyQ/mo/photo.jpg?sz=128", "display_name": "Aniruddha Dwivedi", "link": "https://stackoverflow.com/users/10295084/aniruddha-dwivedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "closed_date": 1560263390, "answer_count": 1, "score": 0, "last_activity_date": 1560258581, "creation_date": 1560253923, "last_edit_date": 1560258581, "question_id": 56543091, "link": "https://stackoverflow.com/questions/56543091/how-to-store-current-time-for-structs-field-of-type-time-time-in-datastore", "closed_reason": "Duplicate", "title": "How to store current time for struct&#39;s field of type *time.Time in DataStore?", "body": "<p>According to my requirements, I created one struct as -</p>\n\n<pre><code>type MyRule struct {\n   CreatedAt    time.Time  `json:\"createdAt\" datastore:\"createdAt,noindex\"`\n   UpdatedAt    *time.Time  `json:\"updatedAt\" datastore:\"updatedAt,noindex\"`\n}\n</code></pre>\n\n<p>for createdAt field, I am able to store current time as- </p>\n\n<pre><code>MyRule.CreatedAt = time.Now()\n</code></pre>\n\n<p>However, the same thing does not work to store current time in <code>updatedAt</code> field of <code>MyRule</code> struct as it's type is <code>*time.Time</code> and not <code>time.Time</code>.\nHere, I can't change field type of <code>updatedAt</code> because <code>*time.Time</code> allows me to accept nil as <code>updatedAt</code> value when I create any rule.</p>\n\n<p>If I try to do this as-</p>\n\n<pre><code> MyRule.UpdatedAt = time.Now()\n</code></pre>\n\n<p>It gives me below error-</p>\n\n<pre><code> cannot use time.Now()(type time.Time) as type *time.Time in assignment\n</code></pre>\n\n<p>How can I store current time value in updatedAt field of type *time.Time and not time.Time</p>\n"}, {"tags": ["csv", "go", "delimiter"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11383611, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-acCnAkUqJ-Q/AAAAAAAAAAI/AAAAAAAAAik/0dMvTIwYoUk/photo.jpg?sz=128", "display_name": "Jaanus", "link": "https://stackoverflow.com/users/11383611/jaanus"}, "reply_to_user": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1560260303, "post_id": 56544726, "comment_id": 99671717, "body": "Ahh sh.. Did not see that. That pull request should be aproved :)."}], "tags": [], "owner": {"reputation": 29, "user_id": 11383611, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-acCnAkUqJ-Q/AAAAAAAAAAI/AAAAAAAAAik/0dMvTIwYoUk/photo.jpg?sz=128", "display_name": "Jaanus", "link": "https://stackoverflow.com/users/11383611/jaanus"}, "is_accepted": false, "score": 0, "last_activity_date": 1560261331, "last_edit_date": 1560261331, "creation_date": 1560259237, "answer_id": 56544726, "question_id": 56542820, "link": "https://stackoverflow.com/questions/56542820/tab-separated-values-go-package-joho-sqltocsv/56544726#56544726", "title": "Tab separated values Go package joho/sqltocsv", "body": "<p>writer.Comma = '\\t'</p>\n\n<p>did the trick, just pulled the code from his repo and added it to line 97 on sqltocsv.go</p>\n\n<p>Edit:\nGuy named Jeffi has already turned this to pull request and found it from his repo.\n<a href=\"https://github.com/jeffyi/sqltocsv\" rel=\"nofollow noreferrer\">https://github.com/jeffyi/sqltocsv</a></p>\n\n<p>so using this instead of johos.</p>\n\n<p>(found it thanks to @dm03514)</p>\n"}], "owner": {"reputation": 29, "user_id": 11383611, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-acCnAkUqJ-Q/AAAAAAAAAAI/AAAAAAAAAik/0dMvTIwYoUk/photo.jpg?sz=128", "display_name": "Jaanus", "link": "https://stackoverflow.com/users/11383611/jaanus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560261331, "creation_date": 1560253000, "last_edit_date": 1560253884, "question_id": 56542820, "link": "https://stackoverflow.com/questions/56542820/tab-separated-values-go-package-joho-sqltocsv", "title": "Tab separated values Go package joho/sqltocsv", "body": "<p>I am using  Go <strong>joho/sqltocsv</strong> package to convert  SQL rows to CSV file.\nPackage what i am using: <a href=\"https://github.com/joho/sqltocsv\" rel=\"nofollow noreferrer\">github.com/joho/sqltocsv</a></p>\n\n<p>All works fine, except that i have not found any solution to change delimiter from ,(default) to /t (tab)</p>\n\n<p>I tried to implement somehow : </p>\n\n<pre><code>    writer = csv.NewWriter(w)\n    writer.Comma = '\\t'\n</code></pre>\n\n<p>but without any success</p>\n\n<p>Firstly i tried to implement it to: </p>\n\n<pre><code>rows, _ := db.Query(sqlQuery)\nerr = sqltocsv.WriteFile(directory+\"/\"+fileName, rows)\n</code></pre>\n\n<p>And after i moved on to: </p>\n\n<pre><code>rows, _ := db.Query(sqlQuery)\ncsvConverter := sqltocsv.New(rows)\ncsvConverter.WriteFile(directory + \"/\" + fileName)\n</code></pre>\n\n<p>But also with that way i did not find any good solution to implement writer.Comma .. </p>\n\n<p>Excepted result would be tab separated values in CSV instead of comma separated values.</p>\n\n<p>Any help would be appreciated :).</p>\n"}, {"tags": ["go", "amazon-dynamodb", "dynamodb-queries"], "comments": [{"owner": {"reputation": 6333, "user_id": 8891224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AZuUL.jpg?s=128&g=1", "display_name": "Nadav Har&#39;El", "link": "https://stackoverflow.com/users/8891224/nadav-harel"}, "edited": false, "score": 0, "creation_date": 1560267660, "post_id": 56541870, "comment_id": 99676413, "body": "Could it be that the error message is accurate? I.e., that fromDateDec or toDateDec has a NULL value?"}, {"owner": {"reputation": 390, "user_id": 8929189, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/55ac869bde783aad4bd5404738ae4b2b?s=128&d=identicon&r=PG&f=1", "display_name": "rlou", "link": "https://stackoverflow.com/users/8929189/rlou"}, "reply_to_user": {"reputation": 6333, "user_id": 8891224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AZuUL.jpg?s=128&g=1", "display_name": "Nadav Har&#39;El", "link": "https://stackoverflow.com/users/8891224/nadav-harel"}, "edited": false, "score": 0, "creation_date": 1560335898, "post_id": 56541870, "comment_id": 99699999, "body": "Yes it was.  toDate was supposed to be in64 rather than decimal....  i had read the error message incorrectly as thoguht the error was with me using the between function"}], "answers": [{"tags": [], "owner": {"reputation": 413, "user_id": 4549677, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152565221337447/picture?type=large", "display_name": "Apoorv Mote", "link": "https://stackoverflow.com/users/4549677/apoorv-mote"}, "is_accepted": false, "score": 0, "last_activity_date": 1573612128, "creation_date": 1573612128, "answer_id": 58829480, "question_id": 56541870, "link": "https://stackoverflow.com/questions/56541870/query-a-table-with-primary-key-and-two-conditions-on-sort-key/58829480#58829480", "title": "Query a table with primary key and two conditions on sort key", "body": "<p>First you need KeyAnd to combine Hash Key and sort key condition.</p>\n\n<pre><code>// keyCondition represents the key condition where the partition key\n// \"TeamName\" is equal to value \"Wildcats\" and sort key \"Number\" is equal\n// to value 1\nkeyCondition := expression.KeyAnd(expression.Key(\"TeamName\").Equal(expression.Value(\"Wildcats\")), expression.Key(\"Number\").Equal(expression.Value(1)))\n</code></pre>\n\n<p>Now instead equal condition you can replace with your between condition as follows</p>\n\n<pre><code>// keyCondition represents the boolean key condition of whether the value\n// of the key \"foo\" is between values 5 and 10\nkeyCondition := expression.KeyBetween(expression.Key(\"foo\"), expression.Value(5), expression.Value(10))\n</code></pre>\n"}], "owner": {"reputation": 390, "user_id": 8929189, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/55ac869bde783aad4bd5404738ae4b2b?s=128&d=identicon&r=PG&f=1", "display_name": "rlou", "link": "https://stackoverflow.com/users/8929189/rlou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1421, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1573612128, "creation_date": 1560249562, "last_edit_date": 1560249856, "question_id": 56541870, "link": "https://stackoverflow.com/questions/56541870/query-a-table-with-primary-key-and-two-conditions-on-sort-key", "title": "Query a table with primary key and two conditions on sort key", "body": "<p>I'm trying to query a dynamodb table using the partition key and a sort key.  The sort key is a unix date, so I want to request x partition key between these 2 dates on the sort.  I am currently able to achieve this with a table scan, but I have to move this to a query for the speed benefit.  I am unable to find any decent examples online of people using a partition key and sort key to query their table.</p>\n\n<p>I have carefully read through this <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/dynamodb/#DynamoDB.Query\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/dynamodb/#DynamoDB.Query</a> and understand that my params must go within the KeyConditionExpression.</p>\n\n<p>I have read through <a href=\"https://github.com/aws/aws-sdk-go/blob/master/service/dynamodb/expression/examples_test.go\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-go/blob/master/service/dynamodb/expression/examples_test.go</a> and understand it on the whole.  But I just can't find the syntax for KeyConditionExpression</p>\n\n<p>I'd have thought it was something like this:</p>\n\n<pre><code>keyCond := expression.Key(\"accountId\").\n    Equal(expression.Value(accountId)).\n    And(expression.Key(\"sortKey\").\n    Between(expression.Value(fromDateDec), expression.Value(toDateDec)))\n</code></pre>\n\n<p>But this throws:</p>\n\n<blockquote>\n  <p>ValidationException: Invalid KeyConditionExpression: Incorrect operand type for operator or function; operator or function: BETWEEN, operand type: NULL</p>\n</blockquote>\n"}, {"tags": ["go", "deferred", "panic"], "answers": [{"comments": [{"owner": {"reputation": 2217, "user_id": 2604708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b62fe48f9c75ebe5e3868f9d428c125?s=128&d=identicon&r=PG", "display_name": "Dirbaio", "link": "https://stackoverflow.com/users/2604708/dirbaio"}, "edited": false, "score": 1, "creation_date": 1560294269, "post_id": 56541278, "comment_id": 99686921, "body": "Also, the above code will stop the panic (the function will return successfully). If you want to continue panicking, you have to do <code>panic(err)</code>."}, {"owner": {"reputation": 151, "user_id": 7522482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4162a2e5bcba0ff6a7558a6a54abc252?s=128&d=identicon&r=PG&f=1", "display_name": "mourya venkat", "link": "https://stackoverflow.com/users/7522482/mourya-venkat"}, "edited": false, "score": 0, "creation_date": 1560329745, "post_id": 56541278, "comment_id": 99696565, "body": "Yeah, Got to know that. Thanks"}], "tags": [], "owner": {"reputation": 14359, "user_id": 5384363, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/975cbfcd1c4997cb9e85887a5271d48f?s=128&d=identicon&r=PG&f=1", "display_name": "for_stack", "link": "https://stackoverflow.com/users/5384363/for-stack"}, "is_accepted": true, "score": 3, "last_activity_date": 1560247474, "creation_date": 1560247474, "answer_id": 56541278, "question_id": 56541086, "link": "https://stackoverflow.com/questions/56541086/how-to-know-a-defer-function-is-called-after-successfully-executing-the-function/56541278#56541278", "title": "How to know a defer function is called after successfully executing the function or by a panic", "body": "<p>You can use <code>recover</code> to catch the panic:</p>\n\n<pre><code>defer func() {\n    if err := recover(); err != nil {\n        fmt.Println(\"panic\")\n    } else {\n        fmt.Println(\"successful\")\n    }\n}()\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 7522482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4162a2e5bcba0ff6a7558a6a54abc252?s=128&d=identicon&r=PG&f=1", "display_name": "mourya venkat", "link": "https://stackoverflow.com/users/7522482/mourya-venkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56541278, "answer_count": 1, "score": 1, "last_activity_date": 1560247474, "creation_date": 1560246877, "question_id": 56541086, "link": "https://stackoverflow.com/questions/56541086/how-to-know-a-defer-function-is-called-after-successfully-executing-the-function", "title": "How to know a defer function is called after successfully executing the function or by a panic", "body": "<p>I need to write some business logic in defer function. Control flow in defer should be based on whether the defer is executed after the system panicked or after the successful execution of the function.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"log\"\n\nfunc b() {\n    panic(\"panicked in b\")\n}\nfunc a() {\n\n    b()\n}\nfunc main() {\n    defer func() {\n     // If panicked \n         log.Println(\"panicked\")\n         // if called after function successfully executed\n         log.Println(\"Success\")\n         /* \n            How to understand if defer is triggered by panic or after function returned successfully.\n         */\n    }()\n    a()\n    log.Println(\"main code\")\n}\n\n</code></pre>\n\n<p>Expected: Defer should be able to know its called by panic by any possible way</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11072305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ecaae663225b0405921050ada719190?s=128&d=identicon&r=PG&f=1", "display_name": "Alina", "link": "https://stackoverflow.com/users/11072305/alina"}, "edited": false, "score": 0, "creation_date": 1560252816, "post_id": 56541931, "comment_id": 99667109, "body": "I have 7 goroutines with established db for each goroutine. And each goroutine call this func for select and update.    In .net i dont have this problem with transations and sql.Open/Close  :( Cuz select block rows and another transations waiting end of prev transation."}, {"owner": {"reputation": 27, "user_id": 11072305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ecaae663225b0405921050ada719190?s=128&d=identicon&r=PG&f=1", "display_name": "Alina", "link": "https://stackoverflow.com/users/11072305/alina"}, "edited": false, "score": 0, "creation_date": 1560253962, "post_id": 56541931, "comment_id": 99667740, "body": "It seems like its time to explore concurancy and using block channels."}], "tags": [], "owner": {"reputation": 137, "user_id": 1592177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ae1273dbd6cc27d2d7805b74521e1762?s=128&d=identicon&r=PG", "display_name": "kabanek", "link": "https://stackoverflow.com/users/1592177/kabanek"}, "is_accepted": true, "score": 0, "last_activity_date": 1560249783, "creation_date": 1560249783, "answer_id": 56541931, "question_id": 56540212, "link": "https://stackoverflow.com/questions/56540212/mysql-concurrency-select-and-update/56541931#56541931", "title": "MYSQL concurrency select and update", "body": "<p>you should read the data and then run a goroutine.</p>\n\n<pre><code>for rows.Next() {\n    rows.Scan(&amp;idTest, &amp;someValue)\n    go func(idTest int) {\n         stmt, err = db.Prepare(\"update test set date = now() where idTest= ?\")\n         CheckError(err)\n         _, err = stmt.Exec(idTest)\n         CheckError(err)\n    }(idTest)\n}\n</code></pre>\n\n<p>it's done this way because you have to read the data first before doing anything with it. Otherwise, the next read could override your previous value from time to time.</p>\n"}], "owner": {"reputation": 27, "user_id": 11072305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ecaae663225b0405921050ada719190?s=128&d=identicon&r=PG&f=1", "display_name": "Alina", "link": "https://stackoverflow.com/users/11072305/alina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56541931, "answer_count": 1, "score": 0, "last_activity_date": 1560258473, "creation_date": 1560244203, "last_edit_date": 1560258473, "question_id": 56540212, "link": "https://stackoverflow.com/questions/56540212/mysql-concurrency-select-and-update", "title": "MYSQL concurrency select and update", "body": "<p>I can't understand how to select and then update table with several goroutines. In the documentation for db and stmt it says: \"is safe for concurrent use by multiple goroutines.\" Also I use transatcions but without success. I want to start 7 goroutines and take every row. </p>\n\n<p>Data</p>\n\n<pre><code>+--------+-----------+---------------------+\n| idTest | someValue | date                |\n+--------+-----------+---------------------+\n|      1 | 1         | 2019-06-11 11:29:42 |\n|      2 | 2         | 2019-06-11 11:29:42 |\n|      3 | 3         | NULL                |\n|      4 | 4         | NULL                |\n|      5 | 5         | NULL                |\n|      6 | 6         | NULL                |\n|      7 | 7         | NULL                |\n+--------+-----------+---------------------+\n</code></pre>\n\n<p>current code</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", strConn)\nif err != nil {\n    fmt.Printf(\"Troubles in connaction! %s\", err)\n}\n\nvar idTest int\nvar someValue string\n\nstmt, err := db.Prepare(\"select idTest,someValue from test where date is null limit 1\")\nCheckError(err)\n\ndefer stmt.Close()\n\nrows, err := stmt.Query()\nCheckError(err)\n\ndefer rows.Close()\n\nfor rows.Next() {\n    rows.Scan(&amp;idTest, &amp;someValue)\n\n    stmt, err = db.Prepare(\"update test set date = now() where idTest= ?\")\n    CheckError(err)\n    _, err = stmt.Exec(idTest)\n    CheckError(err)\n}\n</code></pre>\n\n<p>Every goroutine have db.conn and sometimes trying to select and update table. </p>\n\n<pre><code>func main() {\n    for i := 0; i &lt; 7; i++ {\n        dbConn := \"blabla\"\n        go ChildBot(dbConn)\n    }\n    var input string\n    fmt.Scanln(&amp;input)\n}\n</code></pre>\n"}, {"tags": ["algorithm", "go"], "answers": [{"tags": [], "owner": {"reputation": 10071, "user_id": 1033518, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EwSaG.png?s=128&g=1", "display_name": "Tzook Bar Noy", "link": "https://stackoverflow.com/users/1033518/tzook-bar-noy"}, "is_accepted": false, "score": -2, "last_activity_date": 1560239804, "creation_date": 1560239804, "answer_id": 56538995, "question_id": 56538994, "link": "https://stackoverflow.com/questions/56538994/how-to-solve-maxcounters-coditility-with-golang/56538995#56538995", "title": "How to solve MaxCounters - Coditility with Golang", "body": "<h2>The first and simpler solution</h2>\n\n<ul>\n<li><p>wont pass 100% because of time complexity</p></li>\n<li><p>create <code>counters</code> array with all 0 in size of <code>len(A)</code></p></li>\n<li>for each <code>idx</code>,<code>action</code> in <code>A</code></li>\n<li>if <code>action</code> &lt;= <code>len(N)</code>\n\n<ul>\n<li><code>counters[idx-1]++</code></li>\n</ul></li>\n<li>else\n\n<ul>\n<li><code>maxVal = max(counters)</code></li>\n<li>now set max maxVal to all <code>counters</code> items</li>\n</ul></li>\n<li><p>return <code>counters</code></p></li>\n<li><p>small improvement, store <code>maxVal</code> variable in the top and update it with each increase of the counter items. Then when you need to set all items, you dont need to find <code>max</code> value.</p></li>\n</ul>\n\n<h2>Better solution</h2>\n\n<p>that passes the tests 100%</p>\n\n<p>We will still go through actions, and we store the max value and another new variable <code>forcedVal</code>. we will not update the whole counters array each time we need but only update the <code>forcedVal</code> with the max. Then when ever we need to <code>++</code> an item we will first check if it is smaller then <code>forcedVal</code> and if so we will give it <code>forcedVal</code> value before the <code>++</code>.</p>\n\n<ul>\n<li>create <code>counters</code> array with all 0 in size of <code>len(A)</code></li>\n<li>create <code>max</code> var with 0</li>\n<li>create <code>forcedVal</code> var with 0</li>\n<li>for each <code>idx</code>,<code>action</code> in <code>A</code></li>\n<li>if <code>action</code> &lt;= <code>len(N)</code>\n\n<ul>\n<li><code>cur = counters[idx-1]</code></li>\n<li><code>if cur &lt; forceVal ? cur = forceVal</code></li>\n<li>cur++</li>\n<li>if cur > max</li>\n<li>max = cur</li>\n<li>counters[idx-1] = cur</li>\n</ul></li>\n<li><p>else</p>\n\n<ul>\n<li><code>forcedVal</code> = <code>max</code></li>\n</ul></li>\n<li><p>here we do a single loop to set our counters</p></li>\n<li>for each cnt in counters\n\n<ul>\n<li>if cnt &lt; forcedVal ? cnt = forcedVal </li>\n</ul></li>\n<li>return <code>counters</code></li>\n</ul>\n\n<p>this is how it will look with this example</p>\n\n<p><code>Solution(5, [3, 4, 4, 6, 1, 4, 4])</code></p>\n\n<pre><code>\n| c[0] | c[1] | c[2] | c[3] | c[4] | action | max | forcedVal |\n|------|------|------|------|------|--------|-----|-----------|\n| 0    | 0    | 0    | 0    | 0    | null   | 0   | 0         |\n| 0    | 0    | 1    | 0    | 0    | 3      | 1   | 0         |\n| 0    | 0    | 1    | 1    | 0    | 4      | 1   | 0         |\n| 0    | 0    | 1    | 2    | 0    | 4      | 2   | 0         |\n| 0    | 0    | 1    | 2    | 0    | 6      | 2   | 2         |\n| 3    | 0    | 1    | 2    | 0    | 1      | 3   | 2         |\n| 3    | 0    | 1    | 3    | 0    | 4      | 3   | 2         |\n| 3    | 0    | 1    | 4    | 0    | 4      | 4   | 2         |\n\n</code></pre>\n\n<p>as you can see above after all we have left with:</p>\n\n<p><code>3, 0, 1, 4, 0</code></p>\n\n<p>we will our final cleanup loop to set all items to at least the value of <code>forcedVal</code> and we get</p>\n\n<p><code>3, 2, 2, 4, 2</code></p>\n\n<pre><code>func Solution(N int, A []int) []int {\n    counters := make([]int, N)\n    var max int\n    var forcedVal int\n\n    for _, v := range A {\n        if v &gt; N {\n            forcedVal = max\n        } else {\n            cur := counters[v-1]\n            if cur &lt; forcedVal {\n                cur = forcedVal\n            }\n            cur++\n            if cur &gt; max {\n                max = cur\n            }\n            counters[v-1] = cur\n        }\n    }\n    for i := range counters {\n        if counters[i] &lt; forcedVal {\n            counters[i] = forcedVal\n        }\n    }\n    return counters\n}\n</code></pre>\n"}], "owner": {"reputation": 10071, "user_id": 1033518, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EwSaG.png?s=128&g=1", "display_name": "Tzook Bar Noy", "link": "https://stackoverflow.com/users/1033518/tzook-bar-noy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1560263061, "creation_date": 1560239804, "last_edit_date": 1560263061, "question_id": 56538994, "link": "https://stackoverflow.com/questions/56538994/how-to-solve-maxcounters-coditility-with-golang", "title": "How to solve MaxCounters - Coditility with Golang", "body": "<p>You are given an array of counters <code>N</code> initiated with zero.</p>\n\n<p>You have a list of actions <code>A</code> to perform on <code>N</code> array.</p>\n\n<p>each action is an int <code>x</code></p>\n\n<p><code>ie A = [1,5,3]</code></p>\n\n<p>for each <code>k</code> in <code>A</code> as <code>x</code> actions</p>\n\n<ul>\n<li>if x &lt;= len(N) then increase N[i-1] by one</li>\n<li>else set all <code>N</code> items with max of max value of <code>N</code></li>\n</ul>\n\n<p>you should return the counters array after the last action</p>\n\n<p><a href=\"https://app.codility.com/programmers/lessons/4-counting_elements/max_counters/\" rel=\"nofollow noreferrer\">Exercise Link</a></p>\n"}, {"tags": ["go", "oauth-2.0", "google-oauth", "userinfo"], "comments": [{"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1560240005, "post_id": 56538832, "comment_id": 99659974, "body": "try and take the id token and put it in jwt.io.   Gtoken should contain an id token as well.  I am wondering if your library just isnt parsing the response correctly."}, {"owner": {"reputation": 134, "user_id": 1740461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e557a12e589171a30a9237716bff2d7?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1740461/sergey"}, "reply_to_user": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "edited": false, "score": 0, "creation_date": 1560248957, "post_id": 56538832, "comment_id": 99664893, "body": "So, it looks like you are right. When I extract id_token from the depths of the library and check it through jwt.io, I saw all the data I need. But I don&#39;t understand what&#39;s wrong.  I thought profile info should be retrieved through API request like <code>req, err := http.NewRequest(&quot;GET&quot;, &lt;endPoint&gt;, nil) gresponse, err := http.DefaultClient.Do(req)</code>. In this example only standard go library is used and <code>gresponse</code> contains whole http response, isn&#39;t it? Why response does not contains fields that I need?"}], "answers": [{"comments": [{"owner": {"reputation": 134, "user_id": 1740461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e557a12e589171a30a9237716bff2d7?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1740461/sergey"}, "edited": false, "score": 1, "creation_date": 1560242028, "post_id": 56539392, "comment_id": 99660948, "body": "Thanks for your answer. In original code (not shortened) I&#39;m checking all returned errors like this <code>if err != nil { \t\tlog.Println(&quot;Code exchange failed: &quot; + err.Error()) \t\tjson.NewEncoder(w).Encode(response) \t\treturn \t}</code> But there is no any errors. Also I&#39;m tried sending querys with params instead of headers, but result was the same."}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 0, "last_activity_date": 1560241371, "creation_date": 1560241371, "answer_id": 56539392, "question_id": 56538832, "link": "https://stackoverflow.com/questions/56538832/google-oauth2-endpoint-does-not-return-user-profile-info-name-etc/56539392#56539392", "title": "Google oauth2 endpoint does not return user profile info (name etc)", "body": "<ol>\n<li>Handle error in <code>googleOauthConfig.Exchange(oauth2.NoContext, code)</code></li>\n<li>Handle error in <code>http.DefaultClient.Do</code></li>\n<li>Handle error in <code>ioutil.ReadAll(gresponse.Body)</code></li>\n<li>Handle error in <code>json.Unmarshal</code></li>\n</ol>\n\n<p>And you may find the answer.</p>\n\n<p>Also I remember I was always sending <code>access_token</code> as a query param:</p>\n\n<pre><code>response, err := http.Get(\"https://www.googleapis.com/oauth2/v2/userinfo?access_token=\" + token.AccessToken)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 1740461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e557a12e589171a30a9237716bff2d7?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1740461/sergey"}, "is_accepted": true, "score": 0, "last_activity_date": 1560279671, "creation_date": 1560279671, "answer_id": 56550222, "question_id": 56538832, "link": "https://stackoverflow.com/questions/56538832/google-oauth2-endpoint-does-not-return-user-profile-info-name-etc/56550222#56550222", "title": "Google oauth2 endpoint does not return user profile info (name etc)", "body": "<p>I found the answer. That was my fault.\nThe structure that receive result was looking like this</p>\n\n<pre><code>type AuthContent struct {\n    ID            string `json:\"id\"`\n    Email         string `json:\"email\"`\n    VerifiedEmail bool   `json:\"verified_email\"`\n    Picture       string `json:\"picture\"`\n}\n</code></pre>\n\n<p>This is why there is no fields like name in response.</p>\n"}], "owner": {"reputation": 134, "user_id": 1740461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e557a12e589171a30a9237716bff2d7?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1740461/sergey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 56550222, "answer_count": 2, "score": 1, "last_activity_date": 1560279671, "creation_date": 1560239117, "last_edit_date": 1560249469, "question_id": 56538832, "link": "https://stackoverflow.com/questions/56538832/google-oauth2-endpoint-does-not-return-user-profile-info-name-etc", "title": "Google oauth2 endpoint does not return user profile info (name etc)", "body": "<p>I'm trying to use google oauth2 on my web service (golang), but can't get user profile info (given-name, family-name).</p>\n\n<p>I'm trying various endpoints but every time get this kind of answer:</p>\n\n<pre><code>{\n    \"id\":\"*************\",\n    \"email\":\"***@gmail.com\",\n    \"verified_email\":true,\n    \"picture\":\"https://***/photo.jpg\"\n}\n</code></pre>\n\n<p>In the same time google playground with this set of scopes returns this kind of answer:</p>\n\n<pre><code>{\n  \"family_name\": \"***\", \n  \"name\": \"****\", \n  \"picture\": \"https://*******/photo.jpg\", \n  \"locale\": \"ru\", \n  \"email\": \"****@gmail.com\", \n  \"given_name\": \"*****\", \n  \"id\": \"************\", \n  \"verified_email\": true\n}\n</code></pre>\n\n<p>How can i get the same answer in my web-app?\nPeople on this site and in the internet advise to add profile scope, but I'm already done this.</p>\n\n<p>Here is my code (shortened)</p>\n\n<pre><code>\"golang.org/x/oauth2\"\n\"golang.org/x/oauth2/google\"\n\nfunc init() {\n    googleOauthConfig = &amp;oauth2.Config{\n        RedirectURL:  \"*******\",\n        ClientID:     \"*********\",\n        ClientSecret: \"******\",\n        Scopes: []string{\n            \"https://www.googleapis.com/auth/userinfo.email\",\n            \"https://www.googleapis.com/auth/userinfo.profile\",\n            \"openid\"},\n        Endpoint: google.Endpoint,\n    }\n}\n\nvar googleOauthConfig *oauth2.Config\n\n//const oauthGoogleURLAPI = \"https://www.googleapis.com/oauth2/v1/userinfo\"\nconst oauthGoogleURLAPI = \"https://www.googleapis.com/oauth2/v2/userinfo\"\n//const oauthGoogleURLAPI = \"https://www.googleapis.com/oauth2/v3/userinfo\"\nconst oauthGoogleURLAPI2 = \"https://people.googleapis.com/v1/people/me?personFields=names,emailAddresses\"\n//const oauthGoogleURLAPI = \"https://openidconnect.googleapis.com/v1/userinfo\"\n\nfunc HandleGoogleCallback(w http.ResponseWriter, r *http.Request) {\n    ...\n\n    oauthState, _ := r.Cookie(oauthstateCookieName)\n\n    code := r.FormValue(\"code\") \n\n    gtoken, err := googleOauthConfig.Exchange(oauth2.NoContext, code)\n\n    bearer := \"Bearer \" + gtoken.AccessToken\n\n    req, err := http.NewRequest(\"GET\", oauthGoogleURLAPI, nil)\n    req.Header.Add(\"Authorization\", bearer)\n\n    gresponse, err := http.DefaultClient.Do(req)\n\n    contents, err := ioutil.ReadAll(gresponse.Body)\n\n    authContent := &amp;AuthContent{}\n\n    err = json.Unmarshal(contents, authContent)\n\n    log.Println(authContent)\n\n    ...\n}\n</code></pre>\n\n<p>I'm also read this article <a href=\"https://stackoverflow.com/questions/55541686/google-oauth2-userinfo-api-not-returning-users-name-data\">Google Oauth2 userinfo API not returning user&#39;s name data</a>\nBut result is the same : there is no profile info.</p>\n\n<p>Thanks.</p>\n\n<p>Update:\nOn the advice of the comment I slightly corrected code of \"golang.org/x/oauth2\" and get id_token.\nWhen I checked this id token on jwt.io,  I saw all the data I need.\nBut I thought profile info should be retrieved through API request like this</p>\n\n<pre><code>req, err := http.NewRequest(\"GET\", &lt;endPoint&gt;, nil)\ngresponse, err := http.DefaultClient.Do(req)\n</code></pre>\n\n<p>In this example only standard go library is used and gresponse contains whole http response, isn't it? Why response does not contains fields that I need?</p>\n"}, {"tags": ["json", "amazon-web-services", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1560236089, "post_id": 56537992, "comment_id": 99658153, "body": "You misplaced the <code>if</code> and <code>else</code> branches. Condition is <code>if err != nil </code>, and the error branch is on the <code>else</code>. Meaning when your <code>err</code> is <code>nil</code>, the <code>else</code> branch is executed and you call <code>err.Error()</code> which causes your runtime panic."}, {"owner": {"reputation": 853, "user_id": 2670576, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/UNY11.jpg?s=128&g=1", "display_name": "Marnus Steyn", "link": "https://stackoverflow.com/users/2670576/marnus-steyn"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1560236321, "post_id": 56537992, "comment_id": 99658271, "body": "Aah I see, that fixed the error being thrown, thanks! Now I get the object Unmarshalled, but the values are blank - Will update the Question."}, {"owner": {"reputation": 3462, "user_id": 2414739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99be8308c27600dba09715b22dec57e6?s=128&d=identicon&r=PG", "display_name": "technicallyjosh", "link": "https://stackoverflow.com/users/2414739/technicallyjosh"}, "edited": false, "score": 0, "creation_date": 1560236515, "post_id": 56537992, "comment_id": 99658375, "body": "What does <code>SimpleType</code> look like? The blank values could have everything to do with how the tags are defined there"}, {"owner": {"reputation": 853, "user_id": 2670576, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/UNY11.jpg?s=128&g=1", "display_name": "Marnus Steyn", "link": "https://stackoverflow.com/users/2670576/marnus-steyn"}, "edited": false, "score": 0, "creation_date": 1560236629, "post_id": 56537992, "comment_id": 99658435, "body": "Sorry, I thought I did post it there, updated the post."}], "answers": [{"tags": [], "owner": {"reputation": 3462, "user_id": 2414739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99be8308c27600dba09715b22dec57e6?s=128&d=identicon&r=PG", "display_name": "technicallyjosh", "link": "https://stackoverflow.com/users/2414739/technicallyjosh"}, "is_accepted": true, "score": 6, "last_activity_date": 1560237346, "last_edit_date": 1560237346, "creation_date": 1560236896, "answer_id": 56538293, "question_id": 56537992, "link": "https://stackoverflow.com/questions/56537992/parsing-json-with-golang-in-aws-lamda/56538293#56538293", "title": "Parsing JSON with GoLang in AWS Lamda", "body": "<p>Your <code>SimpleType</code> struct needs 2 things here...</p>\n\n<p>1) The properties need to be \"public\" or \"exported\". Meaning they need to start with an upper cased character.</p>\n\n<p><em>AND</em></p>\n\n<p>2) The properties need proper tags for the serialization and de serialization of JSON. e.g. each JSON tag surrounded by <code>\"</code></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type SimpleType struct {\n  AccountName string `json:\"accountName\"`\n  Amount int `json:\"amount\"`\n}\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 853, "user_id": 2670576, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/UNY11.jpg?s=128&g=1", "display_name": "Marnus Steyn", "link": "https://stackoverflow.com/users/2670576/marnus-steyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 56538293, "answer_count": 1, "score": 0, "last_activity_date": 1560237346, "creation_date": 1560235582, "last_edit_date": 1560236538, "question_id": 56537992, "link": "https://stackoverflow.com/questions/56537992/parsing-json-with-golang-in-aws-lamda", "title": "Parsing JSON with GoLang in AWS Lamda", "body": "<p>As part of an application we are building, one of the process steps is an AWS Lamda that captures a post request does some work with it, and then moves one. It has an API Gateway Request as a trigger and the body of this request would be a JSON String. I am having trouble parsing the JSON String to GoLang Object. Here is what I have:</p>\n\n<p>The function that catches request:</p>\n\n<pre><code>func HandleRequest(ctx context.Context, event events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n\n  log.Print(fmt.Sprintf(\"body:[%s] \", event.Body))\n\n  parseResponseStringToTypedObject(event.Body)\n\n  return events.APIGatewayProxyResponse{\n     StatusCode: http.StatusOK,\n     Body:       \"OK\",\n  },  nil\n}\n</code></pre>\n\n<p>Then the <code>parseResponseStringToTypedObject</code> function :</p>\n\n<pre><code>func parseResponseStringToTypedObject(responseString string) {\n\n  b := []byte(responseString)\n  var resp SimpleType\n  err := json.Unmarshal(b, &amp;resp)\n\n  if err == nil {\n      log.Print(fmt.Sprintf(\"Account Name: [%s]\", resp.accountName))\n  } else {\n      log.Print(fmt.Sprintf(\"Could not unmarshall JSON string: [%s]\", err.Error()))\n  }\n}\n</code></pre>\n\n<p>Here is the <code>SimpleType</code> struct:</p>\n\n<pre><code>type SimpleType struct {\n  accountName string `json:accountName`\n  amount      int    `json:amount`\n}\n</code></pre>\n\n<p>I then, as a test, posted this JSON Body via Postman:\n<a href=\"https://i.stack.imgur.com/3uwIn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3uwIn.png\" alt=\"enter image description here\"></a></p>\n\n<p>I opened up the CloudWatch Logs (where my lamda logs to) and see that the body is present in the <code>event.Body</code> property, and then logging out a field in the unmarshalled object (resp.accountName) I note that the field is blank. Why is this? Here is log output for the request:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SDvTM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SDvTM.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "go", "linker", "blockchain", "cgo"], "comments": [{"owner": {"reputation": 101, "user_id": 10248299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aADnH.png?s=128&g=1", "display_name": "Ha \u0110ANG", "link": "https://stackoverflow.com/users/10248299/ha-%c4%90ang"}, "edited": false, "score": 0, "creation_date": 1560337311, "post_id": 56537928, "comment_id": 99700758, "body": "what if rebuild <code>trezord-go&#47;usb</code> with header include only? :)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11643670, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Bm_OCABuR8/AAAAAAAAAAI/AAAAAAAAE3c/VbM1shUTKKw/photo.jpg?sz=128", "display_name": "user11643670", "link": "https://stackoverflow.com/users/11643670/user11643670"}, "is_accepted": false, "score": 0, "last_activity_date": 1560441305, "creation_date": 1560441305, "answer_id": 56584359, "question_id": 56537928, "link": "https://stackoverflow.com/questions/56537928/go-compile-returns-duplicate-symbols-for-architecture-x86-64-error-when-i-import/56584359#56584359", "title": "Go compile returns duplicate symbols for architecture x86_64 error when I import 2 different packages which use C package via Cgo", "body": "<p>From here: <a href=\"https://www.repustate.com/blog/go-duplicate-symbols-for-architecture-x86_64/\" rel=\"nofollow noreferrer\">https://www.repustate.com/blog/go-duplicate-symbols-for-architecture-x86_64/</a></p>\n\n<p>\"What does this mean? Well, it means we're trying to link the same symbol name (in our case, a method) from two (or more) different source files. The fix was easy: rename one of the methods by updating the header file, the source file (.c or .cpp file) and lastly, updating your references to the symbol in your Go code, if it is directly referenced there.\"</p>\n\n<p>Will it help ?</p>\n"}], "owner": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1078, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1560441305, "creation_date": 1560235294, "last_edit_date": 1560323852, "question_id": 56537928, "link": "https://stackoverflow.com/questions/56537928/go-compile-returns-duplicate-symbols-for-architecture-x86-64-error-when-i-import", "title": "Go compile returns duplicate symbols for architecture x86_64 error when I import 2 different packages which use C package via Cgo", "body": "<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    kusb \"github.com/karalabe/usb\"\n    tusb \"github.com/trezor/trezord-go/usb\"\n)\n\nfunc main() {\n    kusb.Enumerate(0, 0)\n    tusb.InitHIDAPI(nil)\n}\n</code></pre>\n\n<p>When I compile (I'm using <code>go mod</code> to manage the packages), it returns this error:</p>\n\n<pre><code>duplicate symbol _libusb_dev_mem_alloc in:\n    /var/folders/fm/1rln65d94mn45s0h5l78tdyh0000gp/T/go-link-624554542/000002.o\n    /var/folders/fm/1rln65d94mn45s0h5l78tdyh0000gp/T/go-link-624554542/000020.o\nld: 136 duplicate symbols for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>Why?</p>\n\n<p><em>Some investigation i had:</em></p>\n\n<ol>\n<li>The both packages use the same <code>hidapi</code> and <code>libusb</code> C packages in order to interact with usb devices.</li>\n<li>Those C packages are identical, hence it defines the same functions so i think it is directly related to the error.</li>\n<li>in <code>trezord-go/usb</code>, they include <code>.C</code> file, not the header file.</li>\n</ol>\n\n<p>It is very counterintuitive to me because in the perspective of package users, I shouldn't need to worry about how a C package is used in the internal of the package, only the exposed types, functions and its behaviors.</p>\n\n<p>Can anyone really explain what is going on here and how can I import both of them? They do different functions, eventhough they use the same C package.</p>\n"}, {"tags": ["sql-server", "go"], "comments": [{"owner": {"reputation": 73201, "user_id": 3094533, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9jbUI.jpg?s=128&g=1", "display_name": "Zohar Peled", "link": "https://stackoverflow.com/users/3094533/zohar-peled"}, "edited": false, "score": 0, "creation_date": 1560228250, "post_id": 56536044, "comment_id": 99655527, "body": "<code>SELECT TOP @p1</code> should be <code>SELECT TOP (@p1)</code>."}, {"owner": {"reputation": 73201, "user_id": 3094533, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9jbUI.jpg?s=128&g=1", "display_name": "Zohar Peled", "link": "https://stackoverflow.com/users/3094533/zohar-peled"}, "edited": false, "score": 0, "creation_date": 1560228456, "post_id": 56536044, "comment_id": 99655575, "body": "Also, <code>ORDER BY @p3</code> will give you an arbitrary order, since it&#39;s basically ordering by the constant value of the <code>@p3</code> parameter."}, {"owner": {"reputation": 2887, "user_id": 3068541, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/787075573/picture?type=large", "display_name": "JackyJohnson", "link": "https://stackoverflow.com/users/3068541/jackyjohnson"}, "reply_to_user": {"reputation": 73201, "user_id": 3094533, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9jbUI.jpg?s=128&g=1", "display_name": "Zohar Peled", "link": "https://stackoverflow.com/users/3094533/zohar-peled"}, "edited": false, "score": 0, "creation_date": 1560244858, "post_id": 56536044, "comment_id": 99662568, "body": "@ZoharPeled How do I parameterise ORDER BY?  The duplicate you referred to doesn&#39;t answer that either."}, {"owner": {"reputation": 73201, "user_id": 3094533, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9jbUI.jpg?s=128&g=1", "display_name": "Zohar Peled", "link": "https://stackoverflow.com/users/3094533/zohar-peled"}, "edited": false, "score": 0, "creation_date": 1560245369, "post_id": 56536044, "comment_id": 99662843, "body": "Since you can&#39;t parameterize identifiers in SQL, your only two options are either to <a href=\"https://stackoverflow.com/a/13846257/3094533\">use case expressions</a> or <a href=\"https://stackoverflow.com/a/2378754/3094533\">dynamic SQL</a>. With dynamic SQL you should white-list the column name (using sys.columns or information_schema.columns) to prevent the risk of an SQL injection attack."}, {"owner": {"reputation": 2887, "user_id": 3068541, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/787075573/picture?type=large", "display_name": "JackyJohnson", "link": "https://stackoverflow.com/users/3068541/jackyjohnson"}, "reply_to_user": {"reputation": 73201, "user_id": 3094533, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9jbUI.jpg?s=128&g=1", "display_name": "Zohar Peled", "link": "https://stackoverflow.com/users/3094533/zohar-peled"}, "edited": false, "score": 0, "creation_date": 1560246149, "post_id": 56536044, "comment_id": 99663292, "body": "@ZoharPeled Neither of these seem nice... Is it possible to get the column position (as I understand ORDER BY would accept) by parameterising/passing the column name somehow?"}, {"owner": {"reputation": 73201, "user_id": 3094533, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9jbUI.jpg?s=128&g=1", "display_name": "Zohar Peled", "link": "https://stackoverflow.com/users/3094533/zohar-peled"}, "edited": false, "score": 0, "creation_date": 1560246271, "post_id": 56536044, "comment_id": 99663354, "body": "not in a way that&#39;s shorter or nicer than using a case expression or dynamic sql..."}], "owner": {"reputation": 2887, "user_id": 3068541, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/787075573/picture?type=large", "display_name": "JackyJohnson", "link": "https://stackoverflow.com/users/3068541/jackyjohnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "closed_date": 1560228376, "answer_count": 0, "score": 0, "last_activity_date": 1560228232, "creation_date": 1560223412, "last_edit_date": 1560228232, "question_id": 56536044, "link": "https://stackoverflow.com/questions/56536044/go-denisenkom-go-mssqldb-mssql-incorrect-syntax-near-the-keyword-as", "closed_reason": "Duplicate", "title": "Go denisenkom/go-mssqldb: mssql: Incorrect syntax near the keyword &#39;AS&#39;", "body": "<p>I am passing the following query string using the <code>github.com/denisenkom/go-mssqldb</code> package:</p>\n\n<pre><code>q := `\nSELECT TOP @p1\n    firstname,\n    lastname,\n    username,\n    phone,\n    email,\n    picture,\n    bio,\n    active,\n    joined\nFROM (\n    SELECT\n        t2.first_name AS firstname,\n        t2.last_name AS lastname,\n        t1.username AS username,\n        t2.emp_phone AS phone,\n        t2.employee_email AS email,\n        t1.picture AS picture,\n        t1.bio AS bio,\n        CASE WHEN t2.employee_user_id IS NULL THEN 0\n        ELSE 1 END AS active,\n        t2.date_joined AS joined\n    FROM dbo.TBL_BIOS_ANALYSTS AS t1\n    LEFT JOIN dbo.TBL_HRMS_STAFF AS t2 \n        ON t2.employee_user_id = t1.username\n) AS t3  \nWHERE lastname=@p2 ORDER BY @p3`\n</code></pre>\n\n<p>I am passing the following arguments:</p>\n\n<pre><code>args := []interface{}{\n    sql.Named(\"p1\", 5),\n    sql.Named(\"p2\", \"chan\"),\n    sql.Named(\"p3\", \"firstname\"), \n}\n</code></pre>\n\n<p>The query runs fine using a mssql client with a GUI, but using Go and that package, I am getting the following error when doing <code>db.Query(q, args...)</code>:</p>\n\n<pre><code>mssql: Incorrect syntax near the keyword 'AS'.\n</code></pre>\n\n<p>Help pls.</p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 11486149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b635c6d3bfebc8cf83606317a30e9581?s=128&d=identicon&r=PG&f=1", "display_name": "civ15", "link": "https://stackoverflow.com/users/11486149/civ15"}, "edited": false, "score": 0, "creation_date": 1560263927, "post_id": 56537254, "comment_id": 99674000, "body": "But there are 3 cases in which the message type struct changes. If I make the channel of type &quot;Struct1&quot; it won&#39;t be able to accept messages of &quot;Struct2&quot; or &quot;Struct3&quot;."}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "reply_to_user": {"reputation": 125, "user_id": 11486149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b635c6d3bfebc8cf83606317a30e9581?s=128&d=identicon&r=PG&f=1", "display_name": "civ15", "link": "https://stackoverflow.com/users/11486149/civ15"}, "edited": false, "score": 0, "creation_date": 1560264445, "post_id": 56537254, "comment_id": 99674342, "body": "I said make channels not &quot;channel&quot;. Make as much channels as required. Listen to all of them using select statement"}], "tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 0, "last_activity_date": 1560232166, "creation_date": 1560232166, "answer_id": 56537254, "question_id": 56535748, "link": "https://stackoverflow.com/questions/56535748/golang-websocket-custom-json-messages/56537254#56537254", "title": "Golang Websocket Custom JSON Messages", "body": "<ol>\n<li><p>Remove the \"&amp;\" before <code>msg</code>. <code>msg</code> is already a pointer. This may make problems.</p></li>\n<li><p>Your question is not very clear. If <code>msg.Type</code> defines what the <code>msg.Msg</code> is, then I recommend you make channels typed with the actual message type, parse the <code>msg.Msg</code>, then send it through the channel.</p></li>\n</ol>\n"}], "owner": {"reputation": 125, "user_id": 11486149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b635c6d3bfebc8cf83606317a30e9581?s=128&d=identicon&r=PG&f=1", "display_name": "civ15", "link": "https://stackoverflow.com/users/11486149/civ15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 56537254, "answer_count": 1, "score": 1, "last_activity_date": 1560232166, "creation_date": 1560220745, "question_id": 56535748, "link": "https://stackoverflow.com/questions/56535748/golang-websocket-custom-json-messages", "title": "Golang Websocket Custom JSON Messages", "body": "<p>I'm trying to send/receive custom JSON messages. There are 3 cases in which the JSON struct changes, therefore I have 3 different structs. I have to access the room string which is sent as RawMessage. My question is what type should the channel Broadcast be?</p>\n\n<pre><code>type Message struct {\n    Type int64 `json:\"type\"`\n    Msg  json.RawMessage\n}\n</code></pre>\n\n<p><code>Broadcast chan interface{}  // ??? RawMessage or maybe interface</code></p>\n\n<pre><code>          case m := &lt;-r.Broadcast:\n            // What type should chan Broadcast be?\n            // If m is of type json.RawMessage should I deal with unmarshalling here?\n            connections := r.Clients[m.Room] // \n            for c := range connections {\n                select {\n                case c.send &lt;- m:\n                default:\n                    close(c.send)\n                    delete(connections, c)\n                    if len(connections) == 0 {\n                        delete(r.Clients, m.Room)\n                    }\n                }\n            }\n</code></pre>\n\n<pre><code>for {\n        msg := &amp;Message{}\n        err := c.conn.ReadJSON(&amp;msg)\n        // _, msg, err := c.conn.ReadMessage()\n        if err != nil {\n            if websocket.IsUnexpectedCloseError(err, websocket.CloseGoingAway, websocket.CloseAbnormalClosure) {\n                log.Printf(\"error: %v\", err)\n            }\n            break\n        }\n\n        if msg.Type == 0 {\n            newVideo := &amp;NewVideo{}\n            if err = json.Unmarshal(msg.Msg, &amp;newVideo); err != nil {\n                fmt.Println(err)\n            }\n            Roomb.Broadcast &lt;- msg.Msg // ??? should i send the RawMessage\n            online[msg.Room] = msg\n        } else if msg.Type == 1 {\n            if _, ok := online[msg.Room]; ok {\n                online[msg.Room].Start = float64(time.Now().Unix() - online[msg.Room].Timestamp)\n                c.send &lt;- online[msg.Room]\n            }\n        } else if msg.Type == 2 {\n            Roomb.Broadcast &lt;- msg.Msg // ??? should i send the RawMessage\n        }\n        fmt.Println(msg)\n    }\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 6, "creation_date": 1560222442, "post_id": 56535139, "comment_id": 99654430, "body": "Your suggested sutuon is <b><i>not</i></b> go-routine safe. For a full explanation why see: <a href=\"http://marcio.io/2015/07/singleton-pattern-in-go/\" rel=\"nofollow noreferrer\">marcio.io/2015/07/singleton-pattern-in-go</a>  TL;DR use sync.Once.Do() for singleton creation."}, {"owner": {"reputation": 155, "user_id": 8285681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/844f0ff5bf01d2c5de791c88ac369085?s=128&d=identicon&r=PG&f=1", "display_name": "user8285681", "link": "https://stackoverflow.com/users/8285681/user8285681"}, "edited": false, "score": 0, "creation_date": 1560459333, "post_id": 56535139, "comment_id": 99754621, "body": "Clear. Thanks a lot for detailed explanation."}], "tags": [], "owner": {"reputation": 356, "user_id": 6382792, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c985762a3e5e2fed1be6f4725a466ee4?s=128&d=identicon&r=PG&f=1", "display_name": "the-jackalope", "link": "https://stackoverflow.com/users/6382792/the-jackalope"}, "is_accepted": true, "score": 5, "last_activity_date": 1560376891, "last_edit_date": 1560376891, "creation_date": 1560214555, "answer_id": 56535139, "question_id": 56534491, "link": "https://stackoverflow.com/questions/56534491/singleton-test-not-working-when-var-is-instantiated-with/56535139#56535139", "title": "Singleton test not working when var is instantiated with *", "body": "<p>Follow the logic of your code and it's apparent where the problem is.</p>\n\n<p>When you declare, but do not initialize the singleton (<code>var instance *singleton</code>) then <code>instance</code> is <code>nil</code>. Calling <code>GetInstance</code> evaluates <code>instance == nil</code> as true and returns a new <code>*singleton</code> every time it is called. That is why <code>counter2</code> will never equal <code>expectedCounter</code> - each call to <code>GetInstance</code> is returning a new counter instance.</p>\n\n<p>When you initialize the singleton instance (<code>var instance = &amp;singleton{}</code>) then calls to <code>GetInstance</code> will return that singleton instance since it is not <code>nil</code>.</p>\n\n<p>I imagine you'd want to modify <code>GetInstance</code> to something like this:</p>\n\n<pre><code>func GetInstance() *singleton {\n    if instance == nil {\n        instance = new(singleton)\n    }\n    return instance\n}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Although you didn't mention that you need this singleton to be thread-safe, user <a href=\"https://stackoverflow.com/users/1218512/colminator\">colminator</a> correctly points out that instantiating a singleton this way can cause multiple go-routines to instantiate their own instance of the singleton, defeating the purpose of having one. Given how prolific concurrency is in Golang it's probably helpful to learn more! <a href=\"http://marcio.io/2015/07/singleton-pattern-in-go/\" rel=\"nofollow noreferrer\">Check out the link he posted here</a>.</p>\n"}], "owner": {"reputation": 155, "user_id": 8285681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/844f0ff5bf01d2c5de791c88ac369085?s=128&d=identicon&r=PG&f=1", "display_name": "user8285681", "link": "https://stackoverflow.com/users/8285681/user8285681"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 56535139, "answer_count": 1, "score": 0, "last_activity_date": 1560376891, "creation_date": 1560207597, "question_id": 56534491, "link": "https://stackoverflow.com/questions/56534491/singleton-test-not-working-when-var-is-instantiated-with", "title": "Singleton test not working when var is instantiated with *", "body": "<p>I'm following the Singleton design pattern as described in this book (<a href=\"https://github.com/PacktPublishing/Go-Design-Patterns/blob/master/Chapter02/main.go\" rel=\"nofollow noreferrer\">https://github.com/PacktPublishing/Go-Design-Patterns/blob/master/Chapter02/main.go</a>) and I have this code in file \"singleton2.go\":</p>\n\n<pre><code>package singleton2\n\ntype Singleton interface {\n  AddOne() int\n}\n\ntype singleton struct {\n  count int\n}\n\n//var instance = &amp;singleton{}\nvar instance *singleton\n\nfunc GetInstance() *singleton {\n  if instance == nil {\n    return new(singleton)\n  }\n  return instance\n}\n\nfunc (s *singleton) AddOne() int {\n  s.count++\n  return s.count\n}\n</code></pre>\n\n<p>Then I have this test file (singleton2_test.go):</p>\n\n<pre><code>package singleton2\n\nimport \"testing\"\n\nfunc TestGetInstance(t *testing.T) {\n  counter1 := GetInstance()\n  if counter1 == nil {\n    t.Fatal(\"expected pointer to Singleton after calling GetInstance(), not nil\")\n  }\n\n  expectedCounter := counter1\n\n  currentCount := counter1.AddOne()\n  if currentCount != 1 {\n    t.Errorf(\"After calling for the first time to count, the counter must be 1 but it is %d\", currentCount)\n  }\n\n  counter2 := GetInstance()\n  if counter2 != expectedCounter {\n    t.Errorf(\"Expected same instance in counter2 but it got a different instance.\")\n    t.Logf(\"Got %v, want %v\", counter2, expectedCounter)\n  }\n\n  currentCount = counter2.AddOne()\n  if currentCount != 2 {\n    t.Errorf(\"After calling AddOne() using second counter, the count must be 2, but it was %d\", currentCount)\n  }\n\n}\n</code></pre>\n\n<p>The problem is that tests always fail:</p>\n\n<pre><code>--- FAIL: TestGetInstance (0.00s)\n    singleton2_test.go:20: Expected same instance in counter2 but it got a different instance.\n    singleton2_test.go:21: Got &amp;{0}, want &amp;{1}\n    singleton2_test.go:26: After calling AddOne() using second counter, the count must be 2, but it was 1\nFAIL\nexit status 1\nFAIL    github.com/d3c3/design_patterns/singleton/singleton2    0.029s\n</code></pre>\n\n<p>Interestingly, if I change this line <code>var instance *singleton</code> to this line <code>var instance = &amp;singleton{}</code> tests pass !?  Why is that? IMO, it should work also with \"var instance *singleton\"</p>\n\n<p>Can anyone explain this difference in behavior?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11628098, "user_type": "registered", "profile_image": "https://graph.facebook.com/2369186716473293/picture?type=large", "display_name": "Bohdan Tsykaniuk", "link": "https://stackoverflow.com/users/11628098/bohdan-tsykaniuk"}, "edited": false, "score": 0, "creation_date": 1560233466, "post_id": 56535685, "comment_id": 99656987, "body": "Thanks for the answer. Here are the headers I send from the front: <code>Access-Control-Request-Headers: authorization,content-type Access-Control-Request-Method: GET Origin: http:&#47;&#47;localhost:3000 Referer: http:&#47;&#47;localhost:3000&#47;patients User-Agent: Mozilla&#47;5.0 (X11; Linux x86_64) AppleWebKit&#47;537.36 (KHTML, like Gecko) Chrome&#47;75.0.3770.80 Safari&#47;537.36</code>"}, {"owner": {"reputation": 119, "user_id": 10345898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ede012816e62beec856ee7f329347ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Surfus", "link": "https://stackoverflow.com/users/10345898/nathan-surfus"}, "reply_to_user": {"reputation": 13, "user_id": 11628098, "user_type": "registered", "profile_image": "https://graph.facebook.com/2369186716473293/picture?type=large", "display_name": "Bohdan Tsykaniuk", "link": "https://stackoverflow.com/users/11628098/bohdan-tsykaniuk"}, "edited": false, "score": 0, "creation_date": 1560247766, "post_id": 56535685, "comment_id": 99664216, "body": "Also, what does your Docker configuration look like? What port is your server listening on inside the container? What port gets exposed on the internet? Are you using a proxy like Nginx or Apache inside the container?"}, {"owner": {"reputation": 13, "user_id": 11628098, "user_type": "registered", "profile_image": "https://graph.facebook.com/2369186716473293/picture?type=large", "display_name": "Bohdan Tsykaniuk", "link": "https://stackoverflow.com/users/11628098/bohdan-tsykaniuk"}, "edited": false, "score": 0, "creation_date": 1560248385, "post_id": 56535685, "comment_id": 99664532, "body": "Here is my docekr-compose file <code>version: &#39;3.3&#39; services:   api:     container_name: &#39;api&#39;     build: &#39;.&#47;api&#39;     ports:       - &#39;8080:8080&#39;     volumes:       - &#39;.&#47;api:&#47;go&#47;src&#47;app&#39;     network_mode: host</code>"}, {"owner": {"reputation": 13, "user_id": 11628098, "user_type": "registered", "profile_image": "https://graph.facebook.com/2369186716473293/picture?type=large", "display_name": "Bohdan Tsykaniuk", "link": "https://stackoverflow.com/users/11628098/bohdan-tsykaniuk"}, "edited": false, "score": 0, "creation_date": 1560248446, "post_id": 56535685, "comment_id": 99664559, "body": "I do not use Apache and  Nginx"}, {"owner": {"reputation": 119, "user_id": 10345898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ede012816e62beec856ee7f329347ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Surfus", "link": "https://stackoverflow.com/users/10345898/nathan-surfus"}, "reply_to_user": {"reputation": 13, "user_id": 11628098, "user_type": "registered", "profile_image": "https://graph.facebook.com/2369186716473293/picture?type=large", "display_name": "Bohdan Tsykaniuk", "link": "https://stackoverflow.com/users/11628098/bohdan-tsykaniuk"}, "edited": false, "score": 0, "creation_date": 1560264789, "post_id": 56535685, "comment_id": 99674589, "body": "Would you be able to run the same curl commands (adjusting for the appropriate IP address)? Or simulate the OPTIONS/GET request with Postman."}, {"owner": {"reputation": 13, "user_id": 11628098, "user_type": "registered", "profile_image": "https://graph.facebook.com/2369186716473293/picture?type=large", "display_name": "Bohdan Tsykaniuk", "link": "https://stackoverflow.com/users/11628098/bohdan-tsykaniuk"}, "edited": false, "score": 0, "creation_date": 1560279935, "post_id": 56535685, "comment_id": 99682280, "body": "I ran your command at my place and got the same field as you. But the application reactant still does not receive them."}, {"owner": {"reputation": 119, "user_id": 10345898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ede012816e62beec856ee7f329347ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Surfus", "link": "https://stackoverflow.com/users/10345898/nathan-surfus"}, "reply_to_user": {"reputation": 13, "user_id": 11628098, "user_type": "registered", "profile_image": "https://graph.facebook.com/2369186716473293/picture?type=large", "display_name": "Bohdan Tsykaniuk", "link": "https://stackoverflow.com/users/11628098/bohdan-tsykaniuk"}, "edited": false, "score": 0, "creation_date": 1560305022, "post_id": 56535685, "comment_id": 99688685, "body": "Are you sure you&#39;re not setting any other headers besides Content-Type and Authorization? Can you share some of the code you use to make the web request to the service?"}], "tags": [], "owner": {"reputation": 119, "user_id": 10345898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ede012816e62beec856ee7f329347ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Surfus", "link": "https://stackoverflow.com/users/10345898/nathan-surfus"}, "is_accepted": false, "score": 0, "last_activity_date": 1560220143, "creation_date": 1560220143, "answer_id": 56535685, "question_id": 56534355, "link": "https://stackoverflow.com/questions/56534355/the-problem-with-cors-headers-for-the-server-on-go/56535685#56535685", "title": "The problem with CORS headers for the server on Go", "body": "<p>How are you testing this? When a browser must make a cross-origin request that fails pre-flight conditions an <code>OPTIONS</code> request gets sent. This <code>OPTIONS</code> request contains a header who's value is the HTTP method being used in the cross-origin request.</p>\n\n<p>I stood up your simplified version of your server and here's some example curl commands and results.</p>\n\n<p>The below request works fine, I've set the <code>Access-Control-Request-Method</code> to <code>GET</code></p>\n\n<pre><code>curl -I -X OPTIONS -H \"Origin: test.com\" -H \"Access-Control-Request-Method: GET\" http://localhost:8080/\nHTTP/1.1 200 OK\nAccess-Control-Allow-Credentials: true\nAccess-Control-Allow-Methods: GET\nAccess-Control-Allow-Origin: *\nVary: Origin\nVary: Access-Control-Request-Method\nVary: Access-Control-Request-Headers\nDate: Tue, 11 Jun 2019 02:20:35 GMT\nContent-Length: 0\n</code></pre>\n\n<p>The below request doesn't work without the <code>Access-Control-Request-Method</code> header. Our server may have different CORS settings for <code>GET</code> and <code>POST</code> (etc..), and our server can't communicate that to the client. The client must set the <code>Access-Control-Request-Method</code> header so the server knows how to properly respond.</p>\n\n<pre><code>curl -I -X OPTIONS -H \"Origin: test.com\" http://localhost:8080/\nHTTP/1.1 200 OK\nDate: Tue, 11 Jun 2019 02:31:12 GMT\nContent-Length: 436\nContent-Type: text/html; charset=utf-8\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11628098, "user_type": "registered", "profile_image": "https://graph.facebook.com/2369186716473293/picture?type=large", "display_name": "Bohdan Tsykaniuk", "link": "https://stackoverflow.com/users/11628098/bohdan-tsykaniuk"}, "edited": false, "score": 0, "creation_date": 1560235098, "post_id": 56536816, "comment_id": 99657654, "body": "Did not help( It did not help (The front part still gives the error \u0421ORS."}, {"owner": {"reputation": 13, "user_id": 11628098, "user_type": "registered", "profile_image": "https://graph.facebook.com/2369186716473293/picture?type=large", "display_name": "Bohdan Tsykaniuk", "link": "https://stackoverflow.com/users/11628098/bohdan-tsykaniuk"}, "edited": false, "score": 0, "creation_date": 1560251935, "post_id": 56536816, "comment_id": 99666635, "body": "Yes, the same mistake. The postman does not process CORS, therefore all requests pass through it perfectly."}], "tags": [], "owner": {"reputation": 353, "user_id": 3593762, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF6wa1FSnfQ/AAAAAAAAAAI/AAAAAAAAAAU/hbSKP7G8_s8/photo.jpg?sz=128", "display_name": "Ali Zohrevand", "link": "https://stackoverflow.com/users/3593762/ali-zohrevand"}, "is_accepted": true, "score": 0, "last_activity_date": 1560231955, "last_edit_date": 1560231955, "creation_date": 1560229561, "answer_id": 56536816, "question_id": 56534355, "link": "https://stackoverflow.com/questions/56534355/the-problem-with-cors-headers-for-the-server-on-go/56536816#56536816", "title": "The problem with CORS headers for the server on Go", "body": "<p>I had this problem too. You can use this code in the development environment.</p>\n\n<pre><code>    c := cors.New(cors.Options{\n        AllowedOrigins:   []string{\"*\"},\n        AllowCredentials: true,\n\n        AllowedHeaders: []string{\"Authorization\", \"Content-Type\", \"Access-Control-Allow-Origin\"},\n        // Enable Debugging for testing, consider disabling in production\n        AllowedMethods: []string{\"GET\", \"UPDATE\", \"PUT\", \"POST\", \"DELETE\"},\n        Debug:          true,\n    })\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11628098, "user_type": "registered", "profile_image": "https://graph.facebook.com/2369186716473293/picture?type=large", "display_name": "Bohdan Tsykaniuk", "link": "https://stackoverflow.com/users/11628098/bohdan-tsykaniuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 56536816, "answer_count": 2, "score": 1, "last_activity_date": 1560421851, "creation_date": 1560206489, "last_edit_date": 1560421851, "question_id": 56534355, "link": "https://stackoverflow.com/questions/56534355/the-problem-with-cors-headers-for-the-server-on-go", "title": "The problem with CORS headers for the server on Go", "body": "<p>Now I am writing a simple server on Go using the standard library net/http. The server is placed in a docker container and placed on google cloud paltform. But when I want to access the server from my third-party React application (which is located on a different server), I always get a CORS error.</p>\n\n<p>Looking for solutions online, I added a library to my code, which is designed to solve the problem of \u0421ORS. But adding a library didn\u2019t help. Even after its application, the server does not send me \u0421ORS headers. What code do I have now?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    controller \"./controllers\"\n    \"./util\"\n    \"github.com/gorilla/mux\"\n    \"github.com/rs/cors\"\n    \"log\"\n    \"net/http\"\n    //\"os\"\n)\n\n// Entry point\nfunc main() {\n    c := cors.New(cors.Options{\n        AllowedOrigins: []string{\"*\"}, // All origins\n        AllowedMethods: []string{\"GET\"}, // Allowing only get, just an example\n        AllowedHeaders: []string{\"Authorization\", \"Content-Type\"},\n        AllowCredentials: true,\n        Debug: true,\n    })\n\n    r := mux.NewRouter()\n    // Router\n    // Live check\n    r.HandleFunc(\"/live\", controller.LiveCheck)\n    apiRouter := r.PathPrefix(\"/api\").Subrouter()\n    // Medication data\n    medicationRouter := apiRouter.PathPrefix(\"/medication\").Subrouter()\n    medicationRouter.HandleFunc(\"\", controller.MedicationHeadersList).Methods(\"GET\")\n    medicationRouter.HandleFunc(\"/{id}\", controller.MedicationChildrenList).Methods(\"GET\")\n    medicationRouter.HandleFunc(\"/{id}/leafs\", controller.MedicationLeafsList).Methods(\"GET\")\n    medicationRouter.HandleFunc(\"/search/\", controller.SearchMedicationList).Methods(\"GET\")\n    medicationRouter.HandleFunc(\"/result/{id}\", controller.MedicationSearchResult).Methods(\"GET\")\n\n    //r.Use(util.CORS)\n    apiRouter.Use(util.VerifyToken)\n\n    log.Println(http.ListenAndServe(\":8080\", c.Handler(r)))\n}\n\n</code></pre>\n\n<p>Here is the answer I get from the up-point in the browser console:</p>\n\n<pre><code>Request Method: OPTIONS\nStatus Code: 200 OK\nRemote Address: 35.190.37.37:80\nReferrer Policy: no-referrer-when-downgrade\nContent-Length: 0\nDate: Mon, 10 Jun 2019 22:37:36 GMT\nVary: Origin, Access-Control-Request-Method, Access-Control-Request-Headers\nVia: 1.1 google\n</code></pre>\n\n<p>I also tried to manually set the CORS headers, creating a middleware, but it also did not help.\nThanks in advance for your help!</p>\n\n<p><strong>UPD</strong> Thank you all for the answers and help. Everything turned out to be much easier. Google did not update my docker container, so all my changes in the code did not give the desired effect. My code, which I gave in the question description, perfectly solves the problem of the CORS. The question can be considered closed.</p>\n"}, {"tags": ["go", "installation", "failed-installation"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1560206625, "post_id": 56534343, "comment_id": 99651741, "body": "That looks like it might be a module import path, but you&#39;re using GOPATH. Try setting <code>GO111MODULE=on</code>."}, {"owner": {"reputation": 965, "user_id": 8961491, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-xHi2xRHGRQE/AAAAAAAAAAI/AAAAAAAAAqw/jKxhtKjU-tE/photo.jpg?sz=128", "display_name": "APixel Visuals", "link": "https://stackoverflow.com/users/8961491/apixel-visuals"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1560207791, "post_id": 56534343, "comment_id": 99651965, "body": "@JimB after running <code>export GO111MODULE=&quot;on&quot;</code>, I still get the same error. <code>echo $GO111MODULE</code> does return <code>on</code>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1560228845, "post_id": 56534343, "comment_id": 99655659, "body": "Follow the official way to install Go as found on golang.org."}, {"owner": {"reputation": 3709, "user_id": 3902367, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7cf72dbd2609b3e002de28cb65046679?s=128&d=identicon&r=PG&f=1", "display_name": "arunjos007", "link": "https://stackoverflow.com/users/3902367/arunjos007"}, "edited": false, "score": 0, "creation_date": 1560232604, "post_id": 56534343, "comment_id": 99656670, "body": "@APixelVisuals Could you please share your import statements?"}, {"owner": {"reputation": 1714, "user_id": 992898, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b2e22ad8e9c7c782976df0acf69d3362?s=128&d=identicon&r=PG", "display_name": "ardhitama", "link": "https://stackoverflow.com/users/992898/ardhitama"}, "edited": false, "score": 0, "creation_date": 1560232895, "post_id": 56534343, "comment_id": 99656768, "body": "your gopath is on <code>&#47;root</code> are you sure it&#39;s read/writeable by <code>go get</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1560259958, "post_id": 56534343, "comment_id": 99671504, "body": "@APixelVisuals: <code>GO111MODULE</code> shouldn&#39;t be needed anyway, since this is a <code>main</code> package and your CWD is inn&#39;t in <code>GOPATH</code>. Are you using the current version of Go?"}, {"owner": {"reputation": 965, "user_id": 8961491, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-xHi2xRHGRQE/AAAAAAAAAAI/AAAAAAAAAqw/jKxhtKjU-tE/photo.jpg?sz=128", "display_name": "APixel Visuals", "link": "https://stackoverflow.com/users/8961491/apixel-visuals"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1560264370, "post_id": 56534343, "comment_id": 99674280, "body": "@JimB I&#39;m using Go 1.6"}, {"owner": {"reputation": 965, "user_id": 8961491, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-xHi2xRHGRQE/AAAAAAAAAAI/AAAAAAAAAqw/jKxhtKjU-tE/photo.jpg?sz=128", "display_name": "APixel Visuals", "link": "https://stackoverflow.com/users/8961491/apixel-visuals"}, "reply_to_user": {"reputation": 1714, "user_id": 992898, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b2e22ad8e9c7c782976df0acf69d3362?s=128&d=identicon&r=PG", "display_name": "ardhitama", "link": "https://stackoverflow.com/users/992898/ardhitama"}, "edited": false, "score": 0, "creation_date": 1560264391, "post_id": 56534343, "comment_id": 99674294, "body": "@ardhitama I&#39;m logged in as root so this shouldn&#39;t be a problem"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1560264471, "post_id": 56534343, "comment_id": 99674359, "body": "@APixelVisuals: go1.6 is very old and hasn&#39;t be supported in a few years. You will need go1.12 to build this package."}, {"owner": {"reputation": 965, "user_id": 8961491, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-xHi2xRHGRQE/AAAAAAAAAAI/AAAAAAAAAqw/jKxhtKjU-tE/photo.jpg?sz=128", "display_name": "APixel Visuals", "link": "https://stackoverflow.com/users/8961491/apixel-visuals"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1560269748, "post_id": 56534343, "comment_id": 99677584, "body": "@JimB Looks like the guide I was following was outdated. Installing the newest version did fix it. Feel free to turn this into an answer. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 965, "user_id": 8961491, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-xHi2xRHGRQE/AAAAAAAAAAI/AAAAAAAAAqw/jKxhtKjU-tE/photo.jpg?sz=128", "display_name": "APixel Visuals", "link": "https://stackoverflow.com/users/8961491/apixel-visuals"}, "edited": false, "score": 0, "creation_date": 1560264329, "post_id": 56541358, "comment_id": 99674247, "body": "I&#39;m logged in as root so this wouldn&#39;t be an issue"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 965, "user_id": 8961491, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-xHi2xRHGRQE/AAAAAAAAAAI/AAAAAAAAAqw/jKxhtKjU-tE/photo.jpg?sz=128", "display_name": "APixel Visuals", "link": "https://stackoverflow.com/users/8961491/apixel-visuals"}, "edited": false, "score": 0, "creation_date": 1560264541, "post_id": 56541358, "comment_id": 99674415, "body": "@APixelVisuals: in general, you should never be building software as root (with the exception of root in a namespaced container of some sort)"}, {"owner": {"reputation": 126, "user_id": 4299518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lQQf.jpg?s=128&g=1", "display_name": "Wei Huang", "link": "https://stackoverflow.com/users/4299518/wei-huang"}, "reply_to_user": {"reputation": 965, "user_id": 8961491, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-xHi2xRHGRQE/AAAAAAAAAAI/AAAAAAAAAqw/jKxhtKjU-tE/photo.jpg?sz=128", "display_name": "APixel Visuals", "link": "https://stackoverflow.com/users/8961491/apixel-visuals"}, "edited": false, "score": 0, "creation_date": 1560299354, "post_id": 56541358, "comment_id": 99687791, "body": "@APixelVisuals why doesn&#39;t try to do that as a normal user?"}], "tags": [], "owner": {"reputation": 126, "user_id": 4299518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lQQf.jpg?s=128&g=1", "display_name": "Wei Huang", "link": "https://stackoverflow.com/users/4299518/wei-huang"}, "is_accepted": false, "score": -1, "last_activity_date": 1560247735, "creation_date": 1560247735, "answer_id": 56541358, "question_id": 56534343, "link": "https://stackoverflow.com/questions/56534343/golang-go-get-cannot-find-package-in-any-of/56541358#56541358", "title": "Golang `go get` - Cannot find package in any of", "body": "<p>Check the writable right of $GOPATH. As you setting, it at /root</p>\n"}], "owner": {"reputation": 965, "user_id": 8961491, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-xHi2xRHGRQE/AAAAAAAAAAI/AAAAAAAAAqw/jKxhtKjU-tE/photo.jpg?sz=128", "display_name": "APixel Visuals", "link": "https://stackoverflow.com/users/8961491/apixel-visuals"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1538, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1560247735, "creation_date": 1560206409, "question_id": 56534343, "link": "https://stackoverflow.com/questions/56534343/golang-go-get-cannot-find-package-in-any-of", "title": "Golang `go get` - Cannot find package in any of", "body": "<p>I've followed <a href=\"https://www.digitalocean.com/community/tutorials/how-to-install-go-1-6-on-ubuntu-16-04\" rel=\"nofollow noreferrer\">this guide</a> to install Go on Ubuntu 16.04. However, when I follow the <a href=\"https://github.com/src-d/enry#installation\" rel=\"nofollow noreferrer\">installation instructions</a> for a Go application (<code>go get github.com/src-d/enry/cmd/enry</code>), I get the following error:</p>\n\n<pre><code>package github.com/src-d/enry/v2: cannot find package \"github.com/src-d/enry/v2\" in any of:\n        /usr/local/go/src/github.com/src-d/enry/v2 (from $GOROOT)\n        /root/work/src/github.com/src-d/enry/v2 (from $GOPATH)\npackage github.com/src-d/enry/v2/data: cannot find package \"github.com/src-d/enry/v2/data\" in any of:\n        /usr/local/go/src/github.com/src-d/enry/v2/data (from $GOROOT)\n        /root/work/src/github.com/src-d/enry/v2/data (from $GOPATH)\n</code></pre>\n\n<p>Here's the output of <code>go env</code>:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/root/work\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGO15VENDOREXPERIMENT=\"1\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>Note: I have absolutely zero knowledge of how to program in Go, I'm just trying to install a CLI application.</p>\n"}, {"tags": ["go", "testify", "go-gin"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1560202619, "post_id": 56533393, "comment_id": 99650785, "body": "A router is used for routing, ie. given a request the router decides which handler to execute. In your test you registered the <code>things.List</code> handler under <code>&#47;testList</code> and created a request with the url path <code>&#47;stuff</code>. Why would you expect anything other than <code>404</code>? The router in your test and the router in your <code>main</code> are completely different, one has middleware the other doesn&#39;t, one registers the handler under <code>Prefix + &#47;things</code> the other under <code>&#47;testList</code> it is only logical that the test doesn&#39;t produce the same output as when you run the program normally sending requests with postman."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1560203022, "post_id": 56533393, "comment_id": 99650898, "body": "... also note that <code>http.StatusOK</code> is <code>200</code> not <code>201</code>, even if you did everything else ok your test would still fail because 200 != 201."}], "owner": {"reputation": 119, "user_id": 10689245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ffe56b89216fa21e1e85a1d9ab0c47?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Upa", "link": "https://stackoverflow.com/users/10689245/amit-upa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567704581, "creation_date": 1560200038, "last_edit_date": 1567704581, "question_id": 56533393, "link": "https://stackoverflow.com/questions/56533393/test-cases-are-not-working-in-gin-framework", "title": "Test cases are not working in gin framework", "body": "<p>I have written test case to test method in Gin-Gonic framework but it in not giving expected output while running test case. But when I run method using API in Postman it is working properly. </p>\n\n<p>Test case</p>\n\n<pre><code>func TestList(t *testing.T) {\n    router := gin.New()\n    router.GET(\"/testList\", things.List)\n    req, _ := http.NewRequest(\"GET\", \"/stuff\", nil)\n    resp := httptest.NewRecorder()\n    router.ServeHTTP(resp, req)\n    assert.NotNil(t, resp.Body.String())\n    assert.Equal(t, 201,resp.Code, resp.Body.String())\n}\n</code></pre>\n\n<p>Method on which test case created</p>\n\n<pre><code>func List(c *gin.Context) {\n    db := c.MustGet(\"db\").(*mgo.Database)\n    things := []models.Thing{}\n    err := db.C(models.CollectionStuff).Find(nil).All(&amp;things)\n    if err != nil {\n        c.Error(err)\n    }\n    c.JSON(http.StatusOK, things)\n}\n</code></pre>\n\n<p>Router</p>\n\n<pre><code>func main() {\n    router := gin.Default()\n    router.Use(middlewares.Connect)\n    router.GET(Prefix +\"/things\", things.List)\n}\n</code></pre>\n\n<p>When I run test case using go test -v ./...\nOutput</p>\n\n<pre><code> Error Trace:    thing_test.go:31\n Error:          Not equal:\n expected: 201\n actual  : 404\n Test: TestList\n Messages: 404 page not found\n</code></pre>\n\n<p>While running through API it works but not while running through test case.</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 1968, "user_id": 9263083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d74d9629591720e7e7bc8ddd3f35c92?s=128&d=identicon&r=PG&f=1", "display_name": "sanoJ", "link": "https://stackoverflow.com/users/9263083/sanoj"}, "is_accepted": true, "score": 7, "last_activity_date": 1560187993, "creation_date": 1560187993, "answer_id": 56530992, "question_id": 56529602, "link": "https://stackoverflow.com/questions/56529602/how-to-use-template-variable-outside-a-loop/56530992#56530992", "title": "How to use template variable outside a loop?", "body": "<p>You need to declare the lastMsg variable outside the range loop in order to use it outside the loop</p>\n\n<pre><code>{{$lastMsg := \"\"}} // declare outside the loop\n{{range $m := .messages}}      \n        &lt;div&gt;Message subject: {{$m.Subject}}&lt;/div&gt;\n\n        {{$lastMsg = $m}} // assign the value \n{{end}}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 11513919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Fm37GZKH8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reUwLtoKDncJwrABPekqr8NUpMkKw/mo/photo.jpg?sz=128", "display_name": "grhn", "link": "https://stackoverflow.com/users/11513919/grhn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 56530992, "answer_count": 1, "score": 3, "last_activity_date": 1560188767, "creation_date": 1560181725, "last_edit_date": 1560188767, "question_id": 56529602, "link": "https://stackoverflow.com/questions/56529602/how-to-use-template-variable-outside-a-loop", "title": "How to use template variable outside a loop?", "body": "<p>In a go template, I'd like to get the last message in a loop, to be used outside the loop:</p>\n\n<pre><code>    {{range $m := .messages}}      \n            &lt;div&gt;Message subject: {{$m.Subject}}&lt;/div&gt;\n\n            {{$lastMsg := $m}}\n    {{end}}\n\n\n    &lt;div&gt;The last message's subject: {{$lasMsg.Subject}}&lt;/div&gt; \n</code></pre>\n\n<p>But this does not work and I get this error:</p>\n\n<pre><code> undefined variable \"$lastMsg\"\n</code></pre>\n\n<p>I have also tried <code>{{.lastMsg := $m}}</code> but then I get:</p>\n\n<pre><code> unexpected \":=\" in operand\n</code></pre>\n\n<p>So how can I fix this?</p>\n"}, {"tags": ["pointers", "go", "struct", "protocol-buffers"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1560429929, "last_edit_date": 1560429929, "creation_date": 1560429517, "answer_id": 56580693, "question_id": 56528859, "link": "https://stackoverflow.com/questions/56528859/cant-embed-message-in-message-due-to-autogenerated-pointer/56580693#56580693", "title": "Can&#39;t embed message in message due to autogenerated pointer", "body": "<p>Protobuf <a href=\"https://developers.google.com/protocol-buffers/docs/reference/go-generated#repeated\" rel=\"nofollow noreferrer\">documents that</a> for repeated message fields the generated Go code will use a slice of pointers. This allows optional values, because in Go structs cannot be <code>nil</code>, but pointers can.</p>\n\n<p>If you have a slice of structs and you want to assign that to a variable or field which is a slice of pointers, you have to \"manually\" produce that value.</p>\n\n<p>Use a simple loop to do that:</p>\n\n<pre><code>// returns []messages.Item\nitemsPB, _ := api.getItems(\"\", items.ItemIds...)\n\nitemPtrs := make([]*messages.Item, len(itemsPB))\nfor i := range itemsPB {\n    itemPtrs[i] = &amp;itemsPB[i]\n}\n\nitemsResponse := &amp;messages.ItemsResponse{\n    BatchUUID: uuid.NewV4().String(),\n    Items:     itemPtrs,\n}\n</code></pre>\n\n<p>Note that the slice of pointers we assemble above points to the elements of the original <code>itemsPB</code> slice.</p>\n\n<p>If you modify <code>api.getItems()</code> to return a slice of pointers (<code>[]*messages.Item</code>), you could assign that without having to create a slice of pointers.</p>\n"}], "owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 1, "accepted_answer_id": 56580693, "answer_count": 1, "score": 3, "last_activity_date": 1560429929, "creation_date": 1560178894, "last_edit_date": 1560181465, "question_id": 56528859, "link": "https://stackoverflow.com/questions/56528859/cant-embed-message-in-message-due-to-autogenerated-pointer", "title": "Can&#39;t embed message in message due to autogenerated pointer", "body": "<p>I have the following 3 protobuf messages.</p>\n\n<pre><code>message Item {\n    uint32 ID = 1;\n    string Name = 2;\n    ...\n}\n\nmessage ItemIdsRequest{\n    string batchUUID = 1;\n    repeated uint32 itemIds = 2;\n}\n\nmessage ItemsResponse{\n    string batchUUID = 1;\n    repeated Item items = 2;\n}\n</code></pre>\n\n<p>A function retrieves a list of item ID's to later fetch all its details. These ID's are stored in the mssage <code>ItemIdsRequest</code> along with a <code>batchUUID</code> for aggregating via event-sourcing.</p>\n\n<p>Then a function retrieves all details as a <code>[]messages.Item</code> from the int slice in <code>messages.ItemIdsRequest</code>. I copy the <code>batchUUID</code> from the message <code>ItemIdsRequest</code> over into the <code>message.ItemsResponse</code>.</p>\n\n<p>But when I try to copy the returned <code>[]messages.Item</code> into belows message I get the error <code>cannot use items (type []messages.Item as type []*item)</code></p>\n\n<pre><code>// returns []messages.Item\nitemsPB, _ := api.getItems(\"\", items.ItemIds...)\n\nitemsResponse := &amp;messages.ItemsResponse{\n    BatchUUID: uuid.NewV4().String(),\n    Items:   itemsPB,\n}\n</code></pre>\n\n<p>I cannot change the function to the following, because the item is a pointer, not the slice of items which the function returns. And I cannot have the functions return 'message.ItemsResponse'.</p>\n\n<p><strong>TLDR</strong>: I have two seperate protobuf structs. I am trying to set the <code>[]messages.items</code> in the <code>messages.ItemsResponse</code> <code>items</code> property but I am not allowed to because the generated protobuf code makes the <code>messages.ItemsResponse</code> <code>items</code> property a pointer. When I edit the autogenerated code and remove the pointer... everything works as intended.</p>\n\n<pre><code>type ItemsResponse struct {\n    BatchUUID            string   `protobuf:\"bytes,1,opt,name=batchUUID,proto3\" json:\"batchUUID,omitempty\"`\n    Items                []*Item  `protobuf:\"bytes,2,rep,name=items,proto3\" json:\"items,omitempty\"`\n    XXX_NoUnkeyedLiteral struct{} `json:\"-\"`\n    XXX_unrecognized     []byte   `json:\"-\"`\n    XXX_sizecache        int32    `json:\"-\"`\n}\n</code></pre>\n\n<p>I am new to protobuf and no expert on pointers (wanting to be) so I could also use some help understanding why its autogenerated into a pointer.</p>\n"}, {"tags": ["go", "random", "granularity"], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1560178944, "post_id": 56528855, "comment_id": 99641072, "body": "Good answer! Last line is wrong though - it&#39;s a PRNG whether you seed it or not."}, {"owner": {"reputation": 3020, "user_id": 1264920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6401cada72e3e86775c409db49e6befb?s=128&d=identicon&r=PG", "display_name": "TPPZ", "link": "https://stackoverflow.com/users/1264920/tppz"}, "edited": false, "score": 0, "creation_date": 1560179810, "post_id": 56528855, "comment_id": 99641519, "body": "That is working, could you please add the lower bound as well? Thanks @georgeok"}, {"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1560180303, "post_id": 56528855, "comment_id": 99641768, "body": "Why do you need the lower limit? If it&#39;s zero you don&#39;t need it. <code>rand.Intn</code> will always return a positive number."}, {"owner": {"reputation": 3020, "user_id": 1264920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6401cada72e3e86775c409db49e6befb?s=128&d=identicon&r=PG", "display_name": "TPPZ", "link": "https://stackoverflow.com/users/1264920/tppz"}, "edited": false, "score": 0, "creation_date": 1560180531, "post_id": 56528855, "comment_id": 99641913, "body": "Consider <code>minRand</code> being an arbitrary number, so the solution is general."}], "tags": [], "owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "is_accepted": true, "score": 3, "last_activity_date": 1560181233, "last_edit_date": 1560181233, "creation_date": 1560178865, "answer_id": 56528855, "question_id": 56528353, "link": "https://stackoverflow.com/questions/56528353/random-number-within-range-and-a-given-granularity-in-golang/56528855#56528855", "title": "Random number within range and a given granularity in Golang", "body": "<p>You can divide with the granularity, get a pseudo random integer and then multiply with the granularity to scale the result down.</p>\n\n<pre><code>const minRand = 8\nconst maxRand = 10\nv := float64(rand.Intn((maxRand-minRand)/0.05))*0.05 + minRand\nfmt.Printf(\"%.2f\\n\", v)\n</code></pre>\n\n<p>This will print:</p>\n\n<pre><code>8.05\n8.35\n8.35\n8.95\n8.05\n9.90\n....\n</code></pre>\n\n<p>If you don't want to get the same sequence every time <code>rand.Seed(time.Now().UTC().UnixNano())</code>.</p>\n\n<p><a href=\"https://golang.org/pkg/math/rand/#Seed\" rel=\"nofollow noreferrer\">From the docs</a></p>\n\n<blockquote>\n  <p>Seed uses the provided seed value to initialize the default Source to a deterministic state. If Seed is not called, the generator behaves as if seeded by Seed(1). Seed values that have the same remainder when divided by 2^31-1 generate the same pseudo-random sequence. Seed, unlike the Rand.Seed method, is safe for concurrent use.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 468, "user_id": 450333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11263845c2ece6187c3b87b2be66f60a?s=128&d=identicon&r=PG", "display_name": "Kent", "link": "https://stackoverflow.com/users/450333/kent"}, "is_accepted": false, "score": 1, "last_activity_date": 1560181146, "creation_date": 1560181146, "answer_id": 56529468, "question_id": 56528353, "link": "https://stackoverflow.com/questions/56528353/random-number-within-range-and-a-given-granularity-in-golang/56529468#56529468", "title": "Random number within range and a given granularity in Golang", "body": "<p>With lower bounds </p>\n\n<pre><code>const minRand = 0\nconst maxRand = 10\nconst stepRand = 0.05\n\nv := float64(rand.Intn((maxRand-minRand)/stepRand))*stepRand + minRand\nfmt.Printf(\"%.2f\\n\", v)\n</code></pre>\n"}], "owner": {"reputation": 3020, "user_id": 1264920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6401cada72e3e86775c409db49e6befb?s=128&d=identicon&r=PG", "display_name": "TPPZ", "link": "https://stackoverflow.com/users/1264920/tppz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 56528855, "answer_count": 2, "score": 0, "last_activity_date": 1560214304, "creation_date": 1560176863, "last_edit_date": 1560214304, "question_id": 56528353, "link": "https://stackoverflow.com/questions/56528353/random-number-within-range-and-a-given-granularity-in-golang", "title": "Random number within range and a given granularity in Golang", "body": "<p>I've written the following code to create a random number between 0.0 and 10.0.</p>\n\n<pre><code>const minRand = 0\nconst maxRand = 10\nv := minRand + rand.Float64()*(maxRand-minRand)\n</code></pre>\n\n<p>However, I would like to set the granularity to 0.05, so having all the digits as the least significant decimal should not be allowed, only 0 and 5 should be allowed, e.g.:</p>\n\n<ul>\n<li>the value 7.73 is NOT VALID, </li>\n<li>the values 7.7 and 7.75 ARE VALID. </li>\n</ul>\n\n<p>How can I produce such numbers in Go?</p>\n"}, {"tags": ["arrays", "go", "multidimensional-array", "yaml"], "comments": [{"owner": {"reputation": 50175, "user_id": 1307905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a38a4f5f180194ac457cdc057f1be6e3?s=128&d=identicon&r=PG", "display_name": "Anthon", "link": "https://stackoverflow.com/users/1307905/anthon"}, "edited": false, "score": 0, "creation_date": 1560176197, "post_id": 56527957, "comment_id": 99639673, "body": "I only see a <b>single</b> dimension array of <code>struct</code>s. Where are the other dimensions? Please use a spell-checker on your posts."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 11383611, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-acCnAkUqJ-Q/AAAAAAAAAAI/AAAAAAAAAik/0dMvTIwYoUk/photo.jpg?sz=128", "display_name": "Jaanus", "link": "https://stackoverflow.com/users/11383611/jaanus"}, "is_accepted": true, "score": 0, "last_activity_date": 1560175667, "creation_date": 1560175667, "answer_id": 56528042, "question_id": 56527957, "link": "https://stackoverflow.com/questions/56527957/array-from-yaml-golang/56528042#56528042", "title": "Array from Yaml - Golang", "body": "<p>ah as soon as i posted it i facepalmed.</p>\n\n<pre><code>\nprintln(service.JobToRun[0].Name)\n\n</code></pre>\n\n<p>so the reason was that \"JobToRun is an array not \"Name\"</p>\n"}], "owner": {"reputation": 29, "user_id": 11383611, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-acCnAkUqJ-Q/AAAAAAAAAAI/AAAAAAAAAik/0dMvTIwYoUk/photo.jpg?sz=128", "display_name": "Jaanus", "link": "https://stackoverflow.com/users/11383611/jaanus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 0, "accepted_answer_id": 56528042, "answer_count": 1, "score": 0, "last_activity_date": 1560184757, "creation_date": 1560175358, "last_edit_date": 1560184757, "question_id": 56527957, "link": "https://stackoverflow.com/questions/56527957/array-from-yaml-golang", "title": "Array from Yaml - Golang", "body": "<p>I try to create configuration file for my go app what loops through some jobs.</p>\n\n<p>My .yaml file looks like that (array):</p>\n\n<pre><code>jobToRun:\n  - name: This is my first job to run\n    sqlToRun: select 1 from some_table\n    someVariable: 1\n\n  - name: Other job to run\n    sqlToRun: select 2 from some_table\n    someVariable: 2\n</code></pre>\n\n<p>I have successfully imported the YAML file and created also structure.</p>\n\n<pre><code>\n    type Service struct {\n        JobToRun []struct {\n            Name         string `yaml:\"name\"`\n            SQLToRun     string `yaml:\"SqlToRun\"`\n            SomeVariable int    `yaml:\"someVariable\"`\n        } `yaml:\"jobToRun\"`\n    }\n</code></pre>\n\n<p>But I have no idea how to assign them to variable.</p>\n\n<p>I tried some stuff what work with Json array-s but without any luck.</p>\n\n<p>So I tried to print it to console without any luck:</p>\n\n<pre><code>println(service.JobToRun.name[0])\n</code></pre>\n\n<p>before that I tried to assign that SQL to my variable (which works if it is not an array item.</p>\n\n<pre><code>var sqlQuery = service.JobToRun.name[0] \n</code></pre>\n\n<p>And here is what I try to accomplish:</p>\n\n<p>I take the Job parameters from .yaml array and run it.<br>\nI am using that kind of array in YAML because it is easiest way to add new jobs.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1474, "user_id": 3659011, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/8aLi8.jpg?s=128&g=1", "display_name": "Adam Zahran", "link": "https://stackoverflow.com/users/3659011/adam-zahran"}, "edited": false, "score": 1, "creation_date": 1560174514, "post_id": 56527463, "comment_id": 99638798, "body": "Yes when I removed the CGO parts the error disappeared. So yeah it&#39;s a bug. Thanks."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 1, "last_activity_date": 1560174092, "last_edit_date": 1560174092, "creation_date": 1560173599, "answer_id": 56527463, "question_id": 56527179, "link": "https://stackoverflow.com/questions/56527179/gorename-what-is-a-do-not-edit-marker/56527463#56527463", "title": "gorename: What is a &#39;DO NOT EDIT&#39; marker?", "body": "<p>According to <a href=\"https://github.com/golang/tools/blob/master/refactor/rename/spec.go#L574-L593\" rel=\"nofollow noreferrer\">the source code for <code>gorename</code></a>, the check is simple: It looks for a comment at the beginning of the line that contains the phrase \"DO NOT EDIT\":</p>\n\n<pre><code>// Matches cgo generated comment as well as the proposed standard:\n//  https://golang.org/s/generatedcode\nvar generatedRx = regexp.MustCompile(`// .*DO NOT EDIT\\.?`)\n\n// generated reports whether ast.File is a generated file.\nfunc generated(f *ast.File, tokenFile *token.File) bool {\n\n    // Iterate over the comments in the file\n    for _, commentGroup := range f.Comments {\n        for _, comment := range commentGroup.List {\n            if matched := generatedRx.MatchString(comment.Text); matched {\n                // Check if comment is at the beginning of the line in source\n                if pos := tokenFile.Position(comment.Slash); pos.Column == 1 {\n                    return true\n                }\n            }\n        }\n    }\n    return false\n}\n</code></pre>\n\n<p>Reading <a href=\"https://github.com/golang/tools/blob/master/refactor/rename/rename.go#L487-L499\" rel=\"nofollow noreferrer\">elsewhere in the source code</a>, where the error message itself is generated, it looks like the error message may simply be misleading:</p>\n\n<pre><code>// Renaming not supported if cgo files are affected.\nvar generatedFileNames []string\nfor _, info := range r.packages {\n    for _, f := range info.Files {\n        tokenFile := r.iprog.Fset.File(f.Pos())\n        if filesToUpdate[tokenFile] &amp;&amp; generated(f, tokenFile) {\n            generatedFileNames = append(generatedFileNames, tokenFile.Name())\n        }\n    }\n}\nif !Force &amp;&amp; len(generatedFileNames) &gt; 0 {\n    return fmt.Errorf(\"refusing to modify generated file%s containing DO NOT EDIT marker: %v\", plural(len(generatedFileNames)), generatedFileNames)\n}\n</code></pre>\n\n<p>I see you are using CGO. It appears that this also triggers the \"generated file\" marker.</p>\n"}], "owner": {"reputation": 1474, "user_id": 3659011, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/8aLi8.jpg?s=128&g=1", "display_name": "Adam Zahran", "link": "https://stackoverflow.com/users/3659011/adam-zahran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 56527463, "answer_count": 1, "score": 0, "last_activity_date": 1560174584, "creation_date": 1560172515, "last_edit_date": 1560174584, "question_id": 56527179, "link": "https://stackoverflow.com/questions/56527179/gorename-what-is-a-do-not-edit-marker", "title": "gorename: What is a &#39;DO NOT EDIT&#39; marker?", "body": "<p>I'm using vscode and trying to rename a variable name.</p>\n\n<p>It fails saying:</p>\n\n<pre><code>Rename failed: gorename: cannot rename identifiers in generated file containing DO NOT EDIT marker: /home/adam/go/src/hello/hello.go \n</code></pre>\n\n<p>So what is a DO NOT EDIT marker? Why is it there and how can I remove it so that gorename can do its thing?</p>\n\n<p>This is how my file begins:</p>\n\n<pre><code>package main\n\n// #cgo CFLAGS: -g -Wall\n// #include &lt;stdlib.h&gt;\n// #include \"c/greet.h\"\nimport \"C\"\nimport (\n    \"encoding/json\"\n    \"log\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n</code></pre>\n"}, {"tags": ["go", "struct", "types"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560167865, "post_id": 56525903, "comment_id": 99635508, "body": "This question has already been asked countless times. There are various possible solutions. I encourage you to search SO and/or Google for additional options."}, {"owner": {"reputation": 51, "user_id": 11488851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f56ec36a34e67f8406ec2916d29b59?s=128&d=identicon&r=PG&f=1", "display_name": "Ling ling", "link": "https://stackoverflow.com/users/11488851/ling-ling"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560168254, "post_id": 56525903, "comment_id": 99635705, "body": "@Flimzy Please see my update question"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560168470, "post_id": 56525903, "comment_id": 99635809, "body": "I understood your question perfectly. And yes, it&#39;s a duplicate."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560168582, "post_id": 56525903, "comment_id": 99635861, "body": "TL;DR; you have two options: Unmarshal to <code>json.RawMessage</code>, and do your own post-processing, or use a custom <code>UnmarshalJSON</code> method on your struct."}], "owner": {"reputation": 51, "user_id": 11488851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f56ec36a34e67f8406ec2916d29b59?s=128&d=identicon&r=PG&f=1", "display_name": "Ling ling", "link": "https://stackoverflow.com/users/11488851/ling-ling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1471, "favorite_count": 0, "closed_date": 1560167868, "answer_count": 0, "score": 0, "last_activity_date": 1560168543, "creation_date": 1560167709, "last_edit_date": 1560168232, "question_id": 56525903, "link": "https://stackoverflow.com/questions/56525903/how-to-define-multiple-data-types-within-struct-in-golang", "closed_reason": "Duplicate", "title": "How to define multiple data types within struct in Golang?", "body": "<p>I have an HTTP request that I make, where the response is like so:</p>\n\n<pre><code>{\n  \"results\": [\n    {\n      \"gender\": \"male\",\n      \"name\": {\n        \"title\": \"mr\",\n        \"first\": \"carter\",\n        \"last\": \"roy\"\n      },\n      \"location\": {\n        \"street\": \"8662 pine rd\",\n        \"city\": \"minto\",\n        \"state\": \"nova scotia\",\n        \"postcode\": \"I8Q 4L3\",\n        \"coordinates\": {\n          \"latitude\": \"-65.0674\",\n          \"longitude\": \"-174.1034\"\n        },\n        \"timezone\": {\n          \"offset\": \"+8:00\",\n          \"description\": \"Beijing, Perth, Singapore, Hong Kong\"\n        }\n      },\n      \"email\": \"carter.roy@example.com\",\n      \"login\": {...},\n      \"dob\": {\n        \"date\": \"1972-07-18T03:10:43Z\",\n        \"age\": 46\n      },\n      \"registered\": {\n        \"date\": \"2014-05-14T07:12:34Z\",\n        \"age\": 5\n      },\n      \"phone\": \"174-802-7804\",\n      \"cell\": \"194-903-4287\",\n      \"id\": {\n        \"name\": \"\",\n        \"value\": null\n      },\n      \"picture\": {\n        \"large\": \"https://randomuser.me/api/portraits/men/9.jpg\",\n        \"medium\": \"https://randomuser.me/api/portraits/med/men/9.jpg\",\n        \"thumbnail\": \"https://randomuser.me/api/portraits/thumb/men/9.jpg\"\n      },\n      \"nat\": \"CA\"\n    }\n  ],\n  \"info\": {...}\n}\n</code></pre>\n\n<p>The response will always change every time you refresh the page.</p>\n\n<p>The problem is, some fields (like postcode), will either be a string, or int, so how can one specify multiple types for a field like \"postcode\":</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Location struct {\n    Street      string      `json:\"street\"`\n    Postcode    string      `json:\"postcode\"`\n    Coordinates Coordinates `json:\"coordinates\"`\n}\n</code></pre>\n\n<h1>Update</h1>\n\n<p>This is not a duplicate, because in my case I have two different data types for a field (i.e. string and int for postcode), so how can one specify this in a struct. I highly discourage looping through the raw data just for type checking.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1560166585, "post_id": 56525471, "comment_id": 99634978, "body": "Have your type implement Scanner. Or use github.com/jmoiron/sqlx."}, {"owner": {"reputation": 161, "user_id": 9148520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848e260e8e4ac014a0e9eca1f1093ac8?s=128&d=identicon&r=PG&f=1", "display_name": "Rife", "link": "https://stackoverflow.com/users/9148520/rife"}, "reply_to_user": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1560166812, "post_id": 56525471, "comment_id": 99635058, "body": "I have used only <code>database&#47;sql</code> and <code>github.com&#47;go-sql-driver&#47;mysql</code> ."}, {"owner": {"reputation": 26649, "user_id": 188702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9257dbb2fdd9d164711aa191420ef621?s=128&d=identicon&r=PG", "display_name": "Dominic Barnes", "link": "https://stackoverflow.com/users/188702/dominic-barnes"}, "edited": false, "score": 0, "creation_date": 1560187988, "post_id": 56525471, "comment_id": 99645302, "body": "@Rife you can accomplish this yourself with <code>reflect</code>, but honestly if you really want this you should probably consider adopting <code>sqlx</code>, as it already solved this problem for you."}, {"owner": {"reputation": 171, "user_id": 9579768, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "alexfwulf", "link": "https://stackoverflow.com/users/9579768/alexfwulf"}, "reply_to_user": {"reputation": 26649, "user_id": 188702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9257dbb2fdd9d164711aa191420ef621?s=128&d=identicon&r=PG", "display_name": "Dominic Barnes", "link": "https://stackoverflow.com/users/188702/dominic-barnes"}, "edited": false, "score": 0, "creation_date": 1560197954, "post_id": 56525471, "comment_id": 99649301, "body": "@DominicBarnes futhermore is reflect considered bad practice due to performance issues."}, {"owner": {"reputation": 26649, "user_id": 188702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9257dbb2fdd9d164711aa191420ef621?s=128&d=identicon&r=PG", "display_name": "Dominic Barnes", "link": "https://stackoverflow.com/users/188702/dominic-barnes"}, "reply_to_user": {"reputation": 171, "user_id": 9579768, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "alexfwulf", "link": "https://stackoverflow.com/users/9579768/alexfwulf"}, "edited": false, "score": 0, "creation_date": 1562219123, "post_id": 56525471, "comment_id": 100310542, "body": "@alexfwulf it has implications, but I pointed out <code>sqlx</code> as it implements this solution and uses <code>reflect</code> to do so, so you wouldn&#39;t need to implement it yourself."}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 9148520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848e260e8e4ac014a0e9eca1f1093ac8?s=128&d=identicon&r=PG&f=1", "display_name": "Rife", "link": "https://stackoverflow.com/users/9148520/rife"}, "edited": false, "score": 0, "creation_date": 1560166899, "post_id": 56525620, "comment_id": 99635095, "body": "sqlx is a good package, but how to achive that through only database/sql and github.com/go-sql-driver/mysql ."}], "tags": [], "owner": {"reputation": 171, "user_id": 9579768, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "alexfwulf", "link": "https://stackoverflow.com/users/9579768/alexfwulf"}, "is_accepted": false, "score": 4, "last_activity_date": 1560166577, "creation_date": 1560166577, "answer_id": 56525620, "question_id": 56525471, "link": "https://stackoverflow.com/questions/56525471/how-to-use-rows-scan-of-gos-database-sql/56525620#56525620", "title": "How to use rows.Scan of Go&#39;s database/sql", "body": "<p>You may consider using jmoiron's <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">sqlx</a> package. It has support for assigning to a struct.</p>\n\n<p>Excerpt from the readme:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Place struct {\n    Country string\n    City    sql.NullString\n    TelCode int\n}\n places := []Place{}\n err = db.Select(&amp;places, \"SELECT * FROM place ORDER BY telcode ASC\")\n if err != nil {\n     fmt.Println(err)\n      return\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 522, "user_id": 1611102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b464a54d2edba7c4979e018d0b81cd1a?s=128&d=identicon&r=PG", "display_name": "cpchung", "link": "https://stackoverflow.com/users/1611102/cpchung"}, "edited": false, "score": 0, "creation_date": 1587686610, "post_id": 56929480, "comment_id": 108616331, "body": "what if my <code>Users</code> interface has <code>json tag</code> also? I tried this approach and it does not work."}], "tags": [], "owner": {"reputation": 161, "user_id": 9148520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848e260e8e4ac014a0e9eca1f1093ac8?s=128&d=identicon&r=PG&f=1", "display_name": "Rife", "link": "https://stackoverflow.com/users/9148520/rife"}, "is_accepted": true, "score": 2, "last_activity_date": 1562569326, "last_edit_date": 1562569326, "creation_date": 1562567666, "answer_id": 56929480, "question_id": 56525471, "link": "https://stackoverflow.com/questions/56525471/how-to-use-rows-scan-of-gos-database-sql/56929480#56929480", "title": "How to use rows.Scan of Go&#39;s database/sql", "body": "<p>It's a good practice for using reflect:</p>\n\n<pre><code>    for rows.Next() {\n        user := Users{}\n\n        s := reflect.ValueOf(&amp;user).Elem()\n        numCols := s.NumField()\n        columns := make([]interface{}, numCols)\n        for i := 0; i &lt; numCols; i++ {\n            field := s.Field(i)\n            columns[i] = field.Addr().Interface()\n        }\n\n        err := rows.Scan(columns...)\n        if err != nil {\n            log.Fatal(err)\n        }\n        log.Println(user)\n    }\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 9148520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848e260e8e4ac014a0e9eca1f1093ac8?s=128&d=identicon&r=PG&f=1", "display_name": "Rife", "link": "https://stackoverflow.com/users/9148520/rife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6293, "favorite_count": 1, "accepted_answer_id": 56929480, "answer_count": 2, "score": 5, "last_activity_date": 1562569326, "creation_date": 1560165961, "question_id": 56525471, "link": "https://stackoverflow.com/questions/56525471/how-to-use-rows-scan-of-gos-database-sql", "title": "How to use rows.Scan of Go&#39;s database/sql", "body": "<p>I use database/sql and define a struct mapping to DB table columns(tag field):</p>\n\n<pre><code>// Users ...\ntype Users struct {\n    ID            int64  `field:\"id\"`                      \n    Username      string `field:\"username\"`           \n    Password      string `field:\"password\"`           \n    Tel           string `field:\"tel\"`                   \n}\n</code></pre>\n\n<p>then I query:</p>\n\n<pre><code>        rows, err := db.Query(sql)  // select * from users\n        if err != nil {\n            fmt.Println(err)\n        }\n        defer rows.Close()\n        for rows.Next() {\n            user := new(Users)\n\n            // works but I don't think it is good code for too many columns\n            err = rows.Scan(&amp;user.ID, &amp;user.Username, &amp;user.Password, &amp;user.Tel)\n\n            // TODO: How to scan in a simple way \n\n\n            if err != nil {\n                fmt.Println(err)\n            }\n            fmt.Println(\"user: \", user)\n            list = append(list, *user)\n        }\n        if err := rows.Err(); err != nil {\n            fmt.Println(err)\n        }\n</code></pre>\n\n<p>As you can see for <code>rows.Scan()</code> , I have to write all columns , and I don't think it's a good way for 20 or more columns . </p>\n\n<p>How to scan in a clear way.</p>\n"}, {"tags": ["linux", "file", "go", "filesystems"], "comments": [{"owner": {"reputation": 137, "user_id": 1592177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ae1273dbd6cc27d2d7805b74521e1762?s=128&d=identicon&r=PG", "display_name": "kabanek", "link": "https://stackoverflow.com/users/1592177/kabanek"}, "edited": false, "score": 0, "creation_date": 1560166194, "post_id": 56525397, "comment_id": 99634820, "body": "hmm how about using a pipe? You can add the answer to the prompt (continue/cancel?) and then execute the command: <a href=\"https://stackoverflow.com/questions/10781516/how-to-pipe-several-commands-in-go\" title=\"how to pipe several commands in go\">stackoverflow.com/questions/10781516/&hellip;</a> I mean, you should try to reproduce the command: <code>echo Y | mkfs.ext2</code> or similar"}, {"owner": {"reputation": 333, "user_id": 4816093, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/SVtg6.png?s=128&g=1", "display_name": "cachemoi", "link": "https://stackoverflow.com/users/4816093/cachemoi"}, "reply_to_user": {"reputation": 137, "user_id": 1592177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ae1273dbd6cc27d2d7805b74521e1762?s=128&d=identicon&r=PG", "display_name": "kabanek", "link": "https://stackoverflow.com/users/1592177/kabanek"}, "edited": false, "score": 0, "creation_date": 1560166689, "post_id": 56525397, "comment_id": 99635011, "body": "That would not be ideal because I&#39;d be sending &quot;n&quot; whatever the prompt is. Dangerous if the prompt is something like &quot;do you want to keep your data&quot; or if mkfs changes in any way."}, {"owner": {"reputation": 137, "user_id": 1592177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ae1273dbd6cc27d2d7805b74521e1762?s=128&d=identicon&r=PG", "display_name": "kabanek", "link": "https://stackoverflow.com/users/1592177/kabanek"}, "edited": false, "score": 0, "creation_date": 1560169973, "post_id": 56525397, "comment_id": 99636576, "body": "I don&#39;t think that they&#39;ll do some huge backward incompatible change but if you want to make sure you have to or parse the output or check the version before using it."}], "answers": [{"tags": [], "owner": {"reputation": 333, "user_id": 4816093, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/SVtg6.png?s=128&g=1", "display_name": "cachemoi", "link": "https://stackoverflow.com/users/4816093/cachemoi"}, "is_accepted": false, "score": 0, "last_activity_date": 1560250169, "last_edit_date": 1560250169, "creation_date": 1560247033, "answer_id": 56541143, "question_id": 56525397, "link": "https://stackoverflow.com/questions/56525397/exit-a-mkfs-command-if-the-block-device-is-already-formatted/56541143#56541143", "title": "Exit a mkfs command if the block device is already formatted", "body": "<p>It turns out that if we run the command without a terminal (tty), the <code>-F</code> option is assumed and the device is formatted regardless of whether or not the target device already has a file system.</p>\n\n<p>this occurs with <code>mkfs.ext2</code>, <code>mkfs.ext3</code> and <code>mkfs.ext4</code></p>\n\n<p>this is actually legacy behavior as indicated <a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=1236318\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p><code>mkfs.xfs</code> and <code>mkfs.btrfs</code> behave correctly and error if the block device is\nalready formatted.</p>\n\n<p>I'm posting this as an answer since I think this means that there's no actual solution... running <code>mkfs.ext2</code> outside the terminal will always delete data if there's already some on the device.</p>\n"}], "owner": {"reputation": 333, "user_id": 4816093, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/SVtg6.png?s=128&g=1", "display_name": "cachemoi", "link": "https://stackoverflow.com/users/4816093/cachemoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 606, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560250169, "creation_date": 1560165654, "question_id": 56525397, "link": "https://stackoverflow.com/questions/56525397/exit-a-mkfs-command-if-the-block-device-is-already-formatted", "title": "Exit a mkfs command if the block device is already formatted", "body": "<p>I'm writing a utility which needs to run <code>mkfs</code> to format a block device.</p>\n\n<p>I use go's <code>exec</code> package to run the correct <code>mkfs</code> command for each file system type, for example in the case of ext2: </p>\n\n<pre><code>err := exec.CommandContext(ctx, \"mkfs.ext2\", \"-F\", path).Run()\n</code></pre>\n\n<p>Unfortunately if the block device is already formatted <code>mkfs</code> will ask for confirmation (and hang). This means that I'm forced to pass the dangerous <code>-F</code> flag to skip this check, loosing data if the device was already formatted.</p>\n\n<p>I can't add a timeout to the context, because formatting might take a while for other reasons than this confirmation.</p>\n\n<p>I can't find a <code>mkfs</code> flag which makes it return an error instead of a confirmation check if the block device is already formatted.</p>\n\n<p>I would prefer not to rely on parsing the <code>mkfs</code> command's output to see if it's asking for the confirmation check since that would make it break if the <code>mkfs</code> output changes.</p>\n\n<p>Is there a way to abort the command with the correct error message if the block device is already formatted instead of hanging on this confirmation check?</p>\n"}, {"tags": ["arrays", "go", "maps", "aggregate"], "answers": [{"comments": [{"owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "edited": false, "score": 0, "creation_date": 1560173249, "post_id": 56525738, "comment_id": 99638201, "body": "Thanks a lot Kent, that was a nice and easy solution. In my final result I then converted back to the struct, so that I can sort the values and get a top n list. Thanks again"}], "tags": [], "owner": {"reputation": 468, "user_id": 450333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11263845c2ece6187c3b87b2be66f60a?s=128&d=identicon&r=PG", "display_name": "Kent", "link": "https://stackoverflow.com/users/450333/kent"}, "is_accepted": true, "score": 3, "last_activity_date": 1560167032, "creation_date": 1560167032, "answer_id": 56525738, "question_id": 56523804, "link": "https://stackoverflow.com/questions/56523804/grouping-maps-structs-by-key-and-summing-the-associated-values-for-an-array/56525738#56525738", "title": "Grouping maps/structs by key, and summing the associated values for an array", "body": "<p>Is something like this what your looking for?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype WordCountStruct struct {\n    word string\n    freq int\n}\n\ntype WordCountStructArray []WordCountStruct\n\nfunc main() {\n    wCounts := WordCountStructArray{\n        WordCountStruct{\"the\", 8},\n        WordCountStruct{\"and\", 8},\n        WordCountStruct{\"to\", 7},\n        WordCountStruct{\"and\", 6},\n        WordCountStruct{\"and\", 6},\n    }\n\n    fmt.Println(wCounts)\n\n    freq := make(map[string]int)\n    for _, wCount := range wCounts {\n        freq[wCount.word] += wCount.freq\n    }\n\n    fmt.Println(freq)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/oCqfoCy_W2g\" rel=\"nofollow noreferrer\">https://play.golang.org/p/oCqfoCy_W2g</a></p>\n"}], "owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 0, "accepted_answer_id": 56525738, "answer_count": 1, "score": 0, "last_activity_date": 1560167032, "creation_date": 1560159292, "question_id": 56523804, "link": "https://stackoverflow.com/questions/56523804/grouping-maps-structs-by-key-and-summing-the-associated-values-for-an-array", "title": "Grouping maps/structs by key, and summing the associated values for an array", "body": "<p>I have an array of structs that i've built by getting a word frequency count for a list of sentences. The output from this is the most popular words <strong>per sentence</strong>. I need it across all sentences</p>\n\n<p>Here are the structs:</p>\n\n<pre><code>type WordCountStruct struct {\n    word string\n    freq int\n}\n\ntype WordCountStructArray []WordCountStruct\n</code></pre>\n\n<p>This is a sample of the WordCountStructArray:</p>\n\n<pre><code>[{the 8} {and 8} {to 7} {and 6} {and 6}]\n</code></pre>\n\n<p>So what this is is an ordered list, for each sentence, of the most common words. <strong>I need to group by the key, and sum the values</strong></p>\n\n<p>In the case of the 5 sample set above, this would result in:</p>\n\n<pre><code>[{the 8} {to 7} {and 20}]\n</code></pre>\n\n<p>I can convert the struct to a []map[string]interface{} if this is easier?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1560161679, "post_id": 56523520, "comment_id": 99632785, "body": "Go doesn&#39;t have global variables, so your literal request isn&#39;t possible. The proper solution (in any language) is to pass the data you need to the place that needs it, rather than relying on global variables."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1560174823, "post_id": 56523520, "comment_id": 99638986, "body": "That&#39;s somewhat misleading. An exported package variable is a global by another name."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1560174909, "post_id": 56523520, "comment_id": 99639029, "body": "The more troubling thing here is: what happens when two requests come in at the same time? What do you expect to happen? A package variable is by definition shared, and creates a race condition if not a total breakdown of application logic."}], "answers": [{"tags": [], "owner": {"reputation": 353, "user_id": 3593762, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF6wa1FSnfQ/AAAAAAAAAAI/AAAAAAAAAAU/hbSKP7G8_s8/photo.jpg?sz=128", "display_name": "Ali Zohrevand", "link": "https://stackoverflow.com/users/3593762/ali-zohrevand"}, "is_accepted": true, "score": -1, "last_activity_date": 1560160470, "creation_date": 1560160470, "answer_id": 56524094, "question_id": 56523520, "link": "https://stackoverflow.com/questions/56523520/how-to-access-handler-value-globally/56524094#56524094", "title": "How to access handler value globally", "body": "<p>You could use net/context with http.Handler. for example you have \"X-Request-ID\" in header, you could define middlware like this:</p>\n\n<pre><code>func middleware(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(rw http.ResponseWriter, req *http.Request) {\n        ctx := newContextWithRequestID(req.Context(), req)\n        next.ServeHTTP(rw, req.WithContext(ctx))\n    })\n}\ntype key int\nconst requestIDKey key = 0\n\nfunc newContextWithRequestID(ctx context.Context, req *http.Request) context.Context {\n    reqID := req.Header.Get(\"X-Request-ID\")\n    if reqID == \"\" {\n        reqID = generateRandomID()\n    }\n\n    return context.WithValue(ctx, requestIDKey, reqID)\n}\n\nfunc requestIDFromContext(ctx context.Context) string {\n    return ctx.Value(requestIDKey).(string)\n}\n</code></pre>\n\n<p>you could get requestIDKey in any handler with Context object.</p>\n\n<pre><code>func handler(rw http.ResponseWriter, req *http.Request) {\n    reqID := requestIDFromContext(req.Context())\n    fmt.Fprintf(rw, \"Hello request ID %v\\n\", reqID)\n}\n</code></pre>\n\n<p>this is just an example. insted of requestIDKey you could have any data which you should put in Context and read from it with a key.\nfor more detail information visit <a href=\"https://www.joeshaw.org/revisiting-context-and-http-handler-for-go-17/\" rel=\"nofollow noreferrer\">this</a> blog.</p>\n"}], "owner": {"reputation": 63, "user_id": 11154131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Df9Cd5m8YbU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf3t3aLeqiZQsvHjhZOsFrB-0dzvg/mo/photo.jpg?sz=128", "display_name": "Abraham", "link": "https://stackoverflow.com/users/11154131/abraham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 56524094, "answer_count": 1, "score": 0, "last_activity_date": 1560160470, "creation_date": 1560158081, "question_id": 56523520, "link": "https://stackoverflow.com/questions/56523520/how-to-access-handler-value-globally", "title": "How to access handler value globally", "body": "<p>I have this simple http server. How can i access the request data to a global variable and use it in any part of the application.</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"net/http\"\n)\n\nvar data string // Get URL data globally and use it in other part of the  application\n\nfunc hello(w http.ResponseWriter, r *http.Request) {\n    data := r.URL.Query().Get(\"somestring\")\n}\n\nfunc main() {\n    mux := http.NewServeMux()\n    mux.HandleFunc(\"/\", hello)\n\n    http.ListenAndServe(\":8000\", mux)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 353, "user_id": 3593762, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF6wa1FSnfQ/AAAAAAAAAAI/AAAAAAAAAAU/hbSKP7G8_s8/photo.jpg?sz=128", "display_name": "Ali Zohrevand", "link": "https://stackoverflow.com/users/3593762/ali-zohrevand"}, "edited": false, "score": 1, "creation_date": 1560160565, "post_id": 56523069, "comment_id": 99632235, "body": "what is the path of your log package?"}, {"owner": {"reputation": 3040, "user_id": 2428052, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b5ba5c7f7667d354a09af981bbe81b38?s=128&d=identicon&r=PG", "display_name": "ZijingWu", "link": "https://stackoverflow.com/users/2428052/zijingwu"}, "reply_to_user": {"reputation": 353, "user_id": 3593762, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF6wa1FSnfQ/AAAAAAAAAAI/AAAAAAAAAAU/hbSKP7G8_s8/photo.jpg?sz=128", "display_name": "Ali Zohrevand", "link": "https://stackoverflow.com/users/3593762/ali-zohrevand"}, "edited": false, "score": 0, "creation_date": 1560161241, "post_id": 56523069, "comment_id": 99632558, "body": "It is in <code>src&#47;log&#47;log.go</code>"}, {"owner": {"reputation": 353, "user_id": 3593762, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF6wa1FSnfQ/AAAAAAAAAAI/AAAAAAAAAAU/hbSKP7G8_s8/photo.jpg?sz=128", "display_name": "Ali Zohrevand", "link": "https://stackoverflow.com/users/3593762/ali-zohrevand"}, "edited": false, "score": 0, "creation_date": 1560161504, "post_id": 56523069, "comment_id": 99632672, "body": "what is the path of main file?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560161764, "post_id": 56523069, "comment_id": 99632819, "body": "Use the full path. Never use relative imports in Go."}, {"owner": {"reputation": 3040, "user_id": 2428052, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b5ba5c7f7667d354a09af981bbe81b38?s=128&d=identicon&r=PG", "display_name": "ZijingWu", "link": "https://stackoverflow.com/users/2428052/zijingwu"}, "edited": false, "score": 0, "creation_date": 1560161787, "post_id": 56523069, "comment_id": 99632829, "body": "main.go in the same folder as src (with the same parent folder)"}], "answers": [{"tags": [], "owner": {"reputation": 468, "user_id": 450333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11263845c2ece6187c3b87b2be66f60a?s=128&d=identicon&r=PG", "display_name": "Kent", "link": "https://stackoverflow.com/users/450333/kent"}, "is_accepted": true, "score": 1, "last_activity_date": 1560167903, "creation_date": 1560167903, "answer_id": 56525964, "question_id": 56523069, "link": "https://stackoverflow.com/questions/56523069/how-to-include-my-log-package-instead-of-built-in-log-package-in-golang/56525964#56525964", "title": "How to include my `log` package instead of built-in `log` package in `golang`?", "body": "<p>You need to add your package inside $GOPATH</p>\n\n<p>So if your package is in </p>\n\n<pre><code>$GOPATH/src/github.com/ZijingWu/awesomeapp/src/\n</code></pre>\n\n<p>your log package would be in</p>\n\n<pre><code>$GOPATH/src/github.com/ZijingWu/awesomeapp/src/log\n</code></pre>\n\n<p>then it would be possible to use</p>\n\n<pre><code>import(\"github.com/ZijingWu/awesomeapp/src/log\")\n</code></pre>\n\n<p>The paths seams a bit strange tho, and maybe you should consider adding the log package as a completely separate repository on github, so it would look something like.</p>\n\n<pre><code>import(\"github.com/ZijingWu/log\")\n</code></pre>\n\n<p>Just using github as an example here, could of course be placed wherever, also just guessing at your username there. Doesnt need to be in github either you can just place it localy on your computer in the $GOPATH, but then noone else would be able to build your package.</p>\n"}], "owner": {"reputation": 3040, "user_id": 2428052, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b5ba5c7f7667d354a09af981bbe81b38?s=128&d=identicon&r=PG", "display_name": "ZijingWu", "link": "https://stackoverflow.com/users/2428052/zijingwu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56525964, "answer_count": 1, "score": -2, "last_activity_date": 1560167903, "creation_date": 1560156035, "question_id": 56523069, "link": "https://stackoverflow.com/questions/56523069/how-to-include-my-log-package-instead-of-built-in-log-package-in-golang", "title": "How to include my `log` package instead of built-in `log` package in `golang`?", "body": "<p>I have an <code>log</code> package in my project <code>src</code> folder. But when I include the <code>log</code> package from an another package as following, the <code>go</code> seams find the <code>log</code> in the system folder instead of my package.</p>\n\n<pre><code>import (\"log\")\n</code></pre>\n\n<p>And seams I cannot using relative path to import <code>log</code> package, because <code>go install</code> give following error:</p>\n\n<blockquote>\n  <p>local import \"./log\" in non-local package</p>\n</blockquote>\n\n<p>So how can I let the <code>go</code> using my <code>log</code> package?</p>\n"}, {"tags": ["json", "string", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560161863, "post_id": 56522608, "comment_id": 99632867, "body": "Your question is unclear. Are you saying that your string, <code>body</code>, is already JSON, and you want to serve it to the client as such?"}, {"owner": {"reputation": 173, "user_id": 9433582, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "fly high", "link": "https://stackoverflow.com/users/9433582/fly-high"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560163391, "post_id": 56522608, "comment_id": 99633559, "body": "@Flimzy I already have Json, but I did not understand it. I have solved it now. Thank you for your interest."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560163450, "post_id": 56522608, "comment_id": 99633581, "body": "If you don&#39;t understand it, how do you know if you solved it? The accepted answer looks wrong to me, based on your question. I expect you haven&#39;t actually solved it."}, {"owner": {"reputation": 173, "user_id": 9433582, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "fly high", "link": "https://stackoverflow.com/users/9433582/fly-high"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560233062, "post_id": 56522608, "comment_id": 99656836, "body": "@Flimzy I got the method from the answer below.  &#39;&#39;&#39;var raw map[string]interface{}     json.Unmarshal(body, &amp;raw)&#39;&#39;&#39; I used this code."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560235188, "post_id": 56522608, "comment_id": 99657706, "body": "Yeah, that&#39;s not correct. That&#39;s simply going to double-encode your already encoded string. That will make your code execute, but it won&#39;t behave properly. This is why it&#39;s important to actually understand what you&#39;re doing. &quot;Copy and paste from stackoverflow&quot; is mocked for a reason."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 9433582, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "fly high", "link": "https://stackoverflow.com/users/9433582/fly-high"}, "edited": false, "score": 0, "creation_date": 1560155214, "post_id": 56522705, "comment_id": 99629882, "body": "Thank you. However, the resulting values are: &quot;ImV5SnRaWE56WVdkbElqcDdJa0IwZVhCbElqb2ljbVZ6Y0c5dWMyVWlMQ0p&zwnj;&#8203;BYzJWeWRtbGpaU0k2SW1&zwnj;&#8203;0dmNtVmhMbTVoZG1WeWE&zwnj;&#8203;yOXlaV0Z6WlhKMmFXTmx&zwnj;&#8203;MbU52YlcxMWJtbDBlUzV&zwnj;&#8203;qWVdabElpd2lRSFpsY25&zwnj;&#8203;OcGIyNGlPaUl4TGpBdU1&zwnj;&#8203;DSXNJbk4wWVhSMWN5STZ&zwnj;&#8203;Jakl3TUNJc0luSmxjM1Z&zwnj;&#8203;zZENJNmV5SnRjMmNpT2l&zwnj;&#8203;KVGRXTmpaWE56SWl3aVk&zwnj;&#8203;yRm1aVlZ5YkNJNkluQnN&zwnj;&#8203;ZWGxyWVc1bklpd2lZWEo&zwnj;&#8203;wYVdOc1pVbGtJam95TWp&zwnj;&#8203;Nc0ltRnlkR2xqYkdWVmN&zwnj;&#8203;td2lPaUpvZEhSd2N6b3Z&zwnj;&#8203;MMk5oWm1VdWJtRjJaWEl&zwnj;&#8203;1WTI5dEwzQnNZWGxyWVc&zwnj;&#8203;1bkx6SXlNeUo5ZlgwPSI&zwnj;&#8203;=&quot;"}, {"owner": {"reputation": 18261, "user_id": 4185234, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hjhi2.png?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/4185234/charlie"}, "reply_to_user": {"reputation": 173, "user_id": 9433582, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "fly high", "link": "https://stackoverflow.com/users/9433582/fly-high"}, "edited": false, "score": 0, "creation_date": 1560160259, "post_id": 56522705, "comment_id": 99632111, "body": "Here is what I see when I decode it twice:   {&quot;message&quot;:{&quot;@type&quot;:&quot;response&quot;,&quot;@service&quot;:&quot;korea.naverkoreas&zwnj;&#8203;ervice.community.caf&zwnj;&#8203;e&quot;,&quot;@version&quot;:&quot;1.0.0&zwnj;&#8203;&quot;,&quot;status&quot;:&quot;200&quot;,&quot;re&zwnj;&#8203;sult&quot;:{&quot;msg&quot;:&quot;Succes&zwnj;&#8203;s&quot;,&quot;cafeUrl&quot;:&quot;playka&zwnj;&#8203;ng&quot;,&quot;articleId&quot;:223,&zwnj;&#8203;&quot;articleUrl&quot;:&quot;<a href=\"https://cafe.naver.com/playkang/223\" rel=\"nofollow noreferrer\">cafe.n&zwnj;&#8203;aver.com/playkang/22&zwnj;&#8203;3</a>&quot;}}}"}, {"owner": {"reputation": 173, "user_id": 9433582, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "fly high", "link": "https://stackoverflow.com/users/9433582/fly-high"}, "edited": false, "score": 1, "creation_date": 1560162986, "post_id": 56522705, "comment_id": 99633393, "body": "I did not know how to use it. Your answer has been a great help. Thank you very much."}], "tags": [], "owner": {"reputation": 18261, "user_id": 4185234, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hjhi2.png?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/4185234/charlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1560154024, "creation_date": 1560154024, "answer_id": 56522705, "question_id": 56522608, "link": "https://stackoverflow.com/questions/56522608/how-to-convert-string-to-json-in-golang/56522705#56522705", "title": "How to convert string to json in golang?", "body": "<p>It is pretty straightforward in Go</p>\n\n<pre><code>out, _ := json.Marshal(body)\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/a/40429627/4185234\">this</a> answer.</p>\n"}], "owner": {"reputation": 173, "user_id": 9433582, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "fly high", "link": "https://stackoverflow.com/users/9433582/fly-high"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2821, "favorite_count": 0, "closed_date": 1560233114, "accepted_answer_id": 56522705, "answer_count": 1, "score": 0, "last_activity_date": 1560154024, "creation_date": 1560153520, "last_edit_date": 1560153792, "question_id": 56522608, "link": "https://stackoverflow.com/questions/56522608/how-to-convert-string-to-json-in-golang", "closed_reason": "Duplicate", "title": "How to convert string to json in golang?", "body": "<p>I want to convert the string to Json and give it a return value.</p>\n\n<p>The <code>c.JSON(200, string(body))</code> values received via the POST request(writePost) are:</p>\n\n<blockquote>\n  <p>\"{\\\"message\\\":{\\\"@type\\\":\\\"response\\\",\\\"@service\\\":\\\"service.community.cafe\\\",\\\"@version\\\":\\\"1.0.0\\\",\\\"status\\\":\\\"200\\\",\\\"result\\\":{\\\"msg\\\":\\\"Success\\\",\\\"url\\\":\\\"aaabcd\\\",\\\"articleId\\\":211,\\\"articleUrl\\\":\\\"<a href=\"https://abcde.com/abc/211\" rel=\"nofollow noreferrer\">https://abcde.com/abc/211</a>\\\"}}}\"</p>\n</blockquote>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// WriteResult Struct\ntype WriteResult struct {\n    Message    int    `form:\"msg\" json:\"msg\"`\n    URL        string `form:\"url\" json:\"url\"`\n    ArticleID  int    `form:\"articleId\" json:\"articleId\"`\n    ArticleURL string `form:\"articleUrl\" json:\"articleUrl\"`\n}\n\nfunc writePost(c *gin.Context) {\n    var writeInfo WriteInfo\n\n    if err := c.ShouldBind(&amp;writeInfo); err != nil {\n        fmt.Println(\"error : \", err)\n    }\n\n    url := \"https://openapi.abcde.com/articles\"\n\n    var bearer = \"Bearer \" + writeInfo.AccessToken\n    var bufs bytes.Buffer\n\n    form := url.Values{}\n    form.Add(\"subject\", subject)\n    form.Add(\"content\", content)\n\n    req, err := http.NewRequest(\"POST\", url, strings.NewReader(form.Encode()))\n\n    req.Header.Add(\"Authorization\", bearer)\n    req.Header.Add(\"Content-Type\", \"application/x-www-form-urlencoded\")\n\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n    if err != nil {\n        panic(err)\n    }\n    defer resp.Body.Close()\n\n    writeResult := new(WriteResult)\n    body, _ := ioutil.ReadAll(resp.Body)\n    c.JSON(200, string(body))\n}\n\n</code></pre>\n\n<p>Is there a way to convert to Json and return it?</p>\n\n<p>Thank you for your advice.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 3, "creation_date": 1560152026, "post_id": 56522226, "comment_id": 99628725, "body": "Newline is a control character it must be escaped."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560175310, "post_id": 56522226, "comment_id": 99639255, "body": "A literal newline is illegal in a JSON string. The JSON is syntactically invalid."}], "answers": [{"tags": [], "owner": {"reputation": 868, "user_id": 4113109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c8272ee0ba8d6fb56ed64c4c116f80d?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Satyavada", "link": "https://stackoverflow.com/users/4113109/aditya-satyavada"}, "is_accepted": true, "score": 1, "last_activity_date": 1560152461, "creation_date": 1560152461, "answer_id": 56522401, "question_id": 56522226, "link": "https://stackoverflow.com/questions/56522226/golang-json-unmarshal-invalid-character-n-in-string-literal/56522401#56522401", "title": "Golang json.Unmarshal invalid character &#39;\\n&#39; in string literal", "body": "<p>Simply escaping the newline character should do the trick:</p>\n\n<pre><code>var val []byte = []byte(`\"{\\\"channel\\\":\\\"buupr\\\\niya\\\",\\\"name\\\":\\\"john\\\", \\\"msg\\\":\\\"doe\\\"}\"`)\n</code></pre>\n\n<p>The output for the above:</p>\n\n<pre><code>{\"channel\":\"buupr\\niya\",\"name\":\"john\", \"msg\":\"doe\"}\n</code></pre>\n\n<p>Since you're attempting to pass a raw string literal here, you will need to be able to represent the JSON in string form, which requires you to escape the newline character.</p>\n"}], "owner": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2793, "favorite_count": 0, "accepted_answer_id": 56522401, "answer_count": 1, "score": 0, "last_activity_date": 1560152461, "creation_date": 1560151716, "question_id": 56522226, "link": "https://stackoverflow.com/questions/56522226/golang-json-unmarshal-invalid-character-n-in-string-literal", "title": "Golang json.Unmarshal invalid character &#39;\\n&#39; in string literal", "body": "<p>Golang json.Unmarshal throws error for newline character. <a href=\"https://play.golang.org/p/pod2w6_UhOz\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n\n<p>How to unmarshal data if string contains newline?</p>\n"}, {"tags": ["go", "directory", "copy"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11623761, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JRItR9_KThk/AAAAAAAAAAI/AAAAAAAAAB0/NZf7qntmWEg/photo.jpg?sz=128", "display_name": "Nartay Dembayev", "link": "https://stackoverflow.com/users/11623761/nartay-dembayev"}, "edited": false, "score": 0, "creation_date": 1560243585, "post_id": 56525686, "comment_id": 99661828, "body": "I found the problem, the solution. Sorry, for incomprehensible question. It is my first question in stackoverflow. The solution is here <a href=\"https://github.com/malikov0216/lernaDirectoryTreeReplacer\" rel=\"nofollow noreferrer\">github.com/malikov0216/lernaDirectoryTreeReplacer</a>. May be it will be useful for someone"}], "tags": [], "owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "is_accepted": false, "score": 0, "last_activity_date": 1560166841, "creation_date": 1560166841, "answer_id": 56525686, "question_id": 56520754, "link": "https://stackoverflow.com/questions/56520754/copying-directory-with-conditions/56525686#56525686", "title": "Copying directory with conditions", "body": "<p>So far i can tell, you only need to change this line : <code>err := Dir(\"./packages\", \"./app\")</code> into : <code>err := Dir(\"./packages/process\", \"./app\")</code></p>\n\n<p>If you want something else, let it know. Because i am guessing what the real problem is.</p>\n"}], "owner": {"reputation": 11, "user_id": 11623761, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JRItR9_KThk/AAAAAAAAAAI/AAAAAAAAAB0/NZf7qntmWEg/photo.jpg?sz=128", "display_name": "Nartay Dembayev", "link": "https://stackoverflow.com/users/11623761/nartay-dembayev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560166841, "creation_date": 1560143088, "question_id": 56520754, "link": "https://stackoverflow.com/questions/56520754/copying-directory-with-conditions", "title": "Copying directory with conditions", "body": "<p>I have a task to copy directory, and paste it in an another folder with conditions using Go.\nFor example I have a directory tree such like that:\n<br>project\n<br>---app(where to copy)\n<br>---packages(from where copy)\n<br>------process\n<br>---------client01\n<br>------------build(folder)\n<br>---------------main.go\n<br>---------------config.json\n<br>---------------someFolder\n<br>------------someText.txt\n<br>---------client02\n<br>------------test4\n<br>---------------build\n<br>------------testProject\n<br>---------client04\n<br>------------projectX\n<br>------------test.go\nThe condition is copying only directory which only has child folder with name \"build\" and in the copied parent folder should be only build folder within its files.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"io\"\n    \"io/ioutil\"\n    \"os\"\n    \"path\"\n)\n// File copies a single file from src to dst\nfunc File(src, dst string) error {\n    var err error\n    var srcfd *os.File\n    var dstfd *os.File\n    var srcinfo os.FileInfo\n\n    if srcfd, err = os.Open(src); err != nil {\n        return err\n    }\n    defer srcfd.Close()\n\n    if dstfd, err = os.Create(dst); err != nil {\n        return err\n    }\n    defer dstfd.Close()\n\n    if _, err = io.Copy(dstfd, srcfd); err != nil {\n        return err\n    }\n    if srcinfo, err = os.Stat(src); err != nil {\n        return err\n    }\n    return os.Chmod(dst, srcinfo.Mode())\n}\n// Dir copies a whole directory recursively\nfunc Dir(src string, dst string) error {\n    //var files Files\n    var err error\n    var fds []os.FileInfo\n    var srcinfo os.FileInfo\n\n    if srcinfo, err = os.Stat(src); err != nil {\n        return err\n    }\n\n    if fds, err = ioutil.ReadDir(src); err != nil {\n        return err\n    }\n    if err = os.MkdirAll(dst, srcinfo.Mode()); err != nil {\n        return err\n    }\n\n    for _, fd := range fds {\n        srcfp := path.Join(src, fd.Name())\n        dstfp := path.Join(dst, fd.Name())\n\n\n        if fd.IsDir() &amp;&amp; srcfp == src + \"/build\"  {\n            //files = append(files, dstfp)\n            println(srcfp)\n            if err = Dir(srcfp, dstfp); err != nil {\n                return err\n            }\n            if err = File(srcfp, dstfp); err != nil {\n                return err\n            }\n        } else if fd.IsDir() &amp;&amp; srcfp == srcfp {\n            if err = Dir(srcfp, dstfp); err != nil {\n                return err\n            }\n        } else {\n            if err = File(srcfp, dstfp); err != nil {\n                return err\n            }\n        }\n\n    }\n    return nil\n}\n\nfunc main () {\n    err := Dir(\"./packages\", \"./app\")\n    if err != nil {\n        println(err)\n    }\n}\n</code></pre>\n\n<p>I expected a result directory tree in app:\n<br>project\n<br>---app(where to copy)\n<br>------client01\n<br>---------build\n<br>------------main.go\n<br>------------config.json\n<br>------------someFolder\n<br>------test4\n<br>---------build</p>\n\n<p>For instance, test4 and client01 copied because it has \"build\" child-folder, and it copies only build folder</p>\n\n<p>But I got that result directory tree:\nproject\n<br>---app\n<br>------process(that folder should not be copied)\n<br>---------client01\n<br>-----------build\n<br>--------------main.go\n<br>--------------config.json</p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 400, "user_id": 9527593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Np0L.png?s=128&g=1", "display_name": "z11i", "link": "https://stackoverflow.com/users/9527593/z11i"}, "edited": false, "score": 2, "creation_date": 1560141537, "post_id": 56520528, "comment_id": 99625794, "body": "Seems like a network issue where DNS is not resolving hostname &quot;go.mongodb.org&quot;. Can you clarify the question by providing your network environment (behind a firewall, etc)?"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 7510142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPn0t.png?s=128&g=1", "display_name": "Vadas Daniel", "link": "https://stackoverflow.com/users/7510142/vadas-daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1562597837, "creation_date": 1562597837, "answer_id": 56937623, "question_id": 56520528, "link": "https://stackoverflow.com/questions/56520528/golang-mongodb-import-issue/56937623#56937623", "title": "Golang MongoDB Import issue", "body": "<p>I would suggest using the mgo library.</p>\n\n<pre><code>import (\n    mgo \"gopkg.in/mgo.v2\"\n)\n</code></pre>\n\n<p>You can find more information about this library here: <a href=\"https://gopkg.in/mgo.v2\" rel=\"nofollow noreferrer\">https://gopkg.in/mgo.v2</a></p>\n\n<p>I used it for multiple websites and it worked like a charm every time.</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 11670343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VrFDk.png?s=128&g=1", "display_name": "Roshan Patil", "link": "https://stackoverflow.com/users/11670343/roshan-patil"}, "is_accepted": false, "score": 0, "last_activity_date": 1562645656, "creation_date": 1562645656, "answer_id": 56945260, "question_id": 56520528, "link": "https://stackoverflow.com/questions/56520528/golang-mongodb-import-issue/56945260#56945260", "title": "Golang MongoDB Import issue", "body": "<p>It seems to be a network issue. Try some another network connection which is not ruled under firewall. </p>\n\n<p>Or else you can use go mod to resolve dependencies automatically.</p>\n\n<p>I am also using the same driver for mongo DB and it is working perfectly fine.</p>\n\n<p>Kindly check here - <a href=\"https://github.com/rosspatil/Golang-Mongo-Driver-Example\" rel=\"nofollow noreferrer\">Golang-Mongo-Driver-Example</a></p>\n"}], "owner": {"reputation": 273, "user_id": 4528308, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/43839a7150468e2715551e79491ba328?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Kedia", "link": "https://stackoverflow.com/users/4528308/robin-kedia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1575742271, "creation_date": 1560140967, "question_id": 56520528, "link": "https://stackoverflow.com/questions/56520528/golang-mongodb-import-issue", "title": "Golang MongoDB Import issue", "body": "<p>Facing issue importing golang mongodb driver. </p>\n\n<pre><code>  go get -u go.mongodb.org/mongo-driver/mongo\n  go get -u go.mongodb.org/mongo-driver/mongo@~1.0.0\n</code></pre>\n\n<p><strong>package go.mongodb.org/mongo-driver/mongo: unrecognized import path \"go.mongodb.org/mongo-driver/mongo\" (https fetch: Get <a href=\"https://go.mongodb.org/mongo-driver/mongo?go-get=1\" rel=\"nofollow noreferrer\">https://go.mongodb.org/mongo-driver/mongo?go-get=1</a>: dial tcp: lookup go.mongodb.org:\n no such host)</strong></p>\n"}, {"tags": ["go", "marshalling"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1560140988, "post_id": 56520418, "comment_id": 99625688, "body": "See <a href=\"https://stackoverflow.com/questions/28254102/how-to-unmarshal-json-into-interface-in-go\" title=\"how to unmarshal json into interface in go\">stackoverflow.com/questions/28254102/&hellip;</a>"}, {"owner": {"reputation": 482, "user_id": 2425491, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8ae984fbdd00145a099890523538c5ac?s=128&d=identicon&r=PG", "display_name": "VsM", "link": "https://stackoverflow.com/users/2425491/vsm"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1560142184, "post_id": 56520418, "comment_id": 99625918, "body": "both solutions I submitted work, I&#39;m just wondering which one is the best :)"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1560142337, "post_id": 56520418, "comment_id": 99625942, "body": "FoodType is already a string, so why not just store that?"}], "owner": {"reputation": 482, "user_id": 2425491, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8ae984fbdd00145a099890523538c5ac?s=128&d=identicon&r=PG", "display_name": "VsM", "link": "https://stackoverflow.com/users/2425491/vsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560142458, "creation_date": 1560139964, "last_edit_date": 1560142458, "question_id": 56520418, "link": "https://stackoverflow.com/questions/56520418/serializing-golang-structs-in-a-unique-unstructured-datastore", "title": "serializing golang structs in a unique unstructured datastore", "body": "<p>I have a dilemma to store some data in an unstructured field.\nLet's say I have these to store:</p>\n\n<pre><code>package main\n\ntype FoodType string\n\nconst (\n    BeefFood    FoodType = \"beef\"\n    ChickenFood FoodType = \"chicken\"\n)\n\ntype FoodI interface {\n    Prepare()\n    GetType() FoodType\n}\n\ntype FoodContainer struct {\n    FoodI\n}\n\ntype Chicken struct {\n    Way string\n}\n\nfunc (c *Chicken) Prepare() {}\nfunc (c *Chicken) GetType() FoodType {\n    return ChickenFood\n}\n\ntype Beef struct {\n    Way string\n}\n\nfunc (b *Beef) Prepare() {}\nfunc (b *Beef) GetType() FoodType {\n    return BeefFood\n}\n</code></pre>\n\n<p>Let's say I choose json as a serializer (I will probably go for msgpack, but that's another story).</p>\n\n<p>Which way do you think is the most appropriate:</p>\n\n<p><strong>Solution 1</strong></p>\n\n<p>one container that contains all the message types, and simply use the default marshal/unmarshal:</p>\n\n<pre><code>package main\n\ntype FoodContainer struct {\n    Chicken *Chicken `json:\"chicken\"`\n    Beef    *Beef    `json:\"beef\"`\n}\n</code></pre>\n\n<p>And then, I just need to check which of the field is nil to know what to do with it.</p>\n\n<p><strong>Solution 2</strong></p>\n\n<p>A more \"typed\" solution, with interfaces and FoodType</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype FoodContainer struct {\n    FoodType\n    FoodI\n}\n\nfunc (fc *FoodContainer) MarshalJSON() ([]byte, error) {\n    return json.Marshal(&amp;FoodContainerT{\n        FoodType: fc.FoodI.GetType(),\n        FoodI:    fc.FoodI,\n    })\n}\n\nfunc (fc *FoodContainer) UnmarshalJSON(b []byte) error {\n    var fct struct {\n        FoodType\n    }\n    if err := json.Unmarshal(b, &amp;fct); err != nil {\n        return fmt.Errorf(\"fc UnmarshalJSON: %v\", err)\n    }\n\n    switch fct.FoodType {\n    case ChickenFood:\n        fmt.Printf(\"Yeah, Chickenfood: %v\\n\", fct.FoodType)\n        var fi struct {\n            FoodI Chicken\n        }\n        if err := json.Unmarshal(b, &amp;fi); err != nil {\n            return fmt.Errorf(\"chicken UnmarshalJSON: %v\", err)\n        }\n        fmt.Printf(\"%#v\", fi.FoodI)\n    default:\n        return fmt.Errorf(\"no known FoodType found\")\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>I benchmarked both, they have around the same processing time and same mem usage, but I'm wondering which of them could be more idiomatic?</p>\n"}, {"tags": ["go", "memory", "memory-leaks"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1560175430, "post_id": 56519907, "comment_id": 99639323, "body": "Allocating it is normal. Holding it until there is enough memory pressure on the system for the OS to reclaim it is normal. What is your question?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11623461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10fab5e039206c5ae26899be86ce0e9c?s=128&d=identicon&r=PG&f=1", "display_name": "xxxcvv", "link": "https://stackoverflow.com/users/11623461/xxxcvv"}, "edited": false, "score": 0, "creation_date": 1560168287, "post_id": 56520341, "comment_id": 99635723, "body": "Not help. Thanks for the reply"}, {"owner": {"reputation": 19, "user_id": 11623461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10fab5e039206c5ae26899be86ce0e9c?s=128&d=identicon&r=PG&f=1", "display_name": "xxxcvv", "link": "https://stackoverflow.com/users/11623461/xxxcvv"}, "edited": false, "score": 0, "creation_date": 1560219994, "post_id": 56520341, "comment_id": 99654018, "body": "I have 256MB memory per server container. And i need to handle concurrently many requests with big response sizes. And now the memory does not go away, it freezes and is not released. all the memory gets filled up and cannot be released more. Even 512MB is not enough, checked"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 19, "user_id": 11623461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10fab5e039206c5ae26899be86ce0e9c?s=128&d=identicon&r=PG&f=1", "display_name": "xxxcvv", "link": "https://stackoverflow.com/users/11623461/xxxcvv"}, "edited": false, "score": 0, "creation_date": 1560220753, "post_id": 56520341, "comment_id": 99654158, "body": "Did you fix the order of error checking described above? Keying off of  <code>resp != nil</code> may cause unpredictable results, if a resp body is not a valid response due to error."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 8, "last_activity_date": 1560206842, "last_edit_date": 1560206842, "creation_date": 1560139029, "answer_id": 56520341, "question_id": 56519907, "link": "https://stackoverflow.com/questions/56519907/allocated-a-lot-of-memory-in-go-how-to-fix/56520341#56520341", "title": "Allocated a lot of memory in Go. How to fix?", "body": "<p>You are creating an http client for each go-routine.</p>\n\n<p>Http client is designed to be create once &amp; used many times. They are go-routine safe.\nThey allow for connection reuse &amp; other efficiency savers.</p>\n\n<p>Create the http client once in main (instead of in your go-routine) &amp; then pass this single reference to all of your 50 go-routines.</p>\n\n<hr>\n\n<p><strong>Edit:</strong> Also, while it may not make a practical difference in your case, the order for a request is usually like so:</p>\n\n<pre><code>resp, err := httpClient.Do(req)\nif err != nil {\n        return err // check error first\n}\ndefer resp.Body.Close() // no error - so resp will *NOT* be nil - so this is safe\n</code></pre>\n\n<hr>\n\n<p><strong>Edit 2:</strong> As @Adrian has mentioned: <code>go</code>'s garbage collection is not instantaneous - nor should it be - as it is an expensive operation. If you no longer need a block of memory - simply don't reference it anymore. Let the GC do its job, so you can focus on yours!</p>\n\n<p>If you're curious about the evolution of <code>go</code>'s GC:</p>\n\n<ul>\n<li><a href=\"https://blog.golang.org/ismmkeynote\" rel=\"nofollow noreferrer\">https://blog.golang.org/ismmkeynote</a> (heavy on the technical side)</li>\n<li><a href=\"https://stackoverflow.com/questions/7823725/what-kind-of-garbage-collection-does-go-use\">What kind of Garbage Collection does Go use?</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 534, "user_id": 6192935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-WzVJWA1aLts/AAAAAAAAAAI/AAAAAAAABfQ/FxZhI2PBCBA/photo.jpg?sz=128", "display_name": "Manish Champaneri", "link": "https://stackoverflow.com/users/6192935/manish-champaneri"}, "is_accepted": true, "score": 0, "last_activity_date": 1560251288, "last_edit_date": 1560251288, "creation_date": 1560148745, "answer_id": 56521597, "question_id": 56519907, "link": "https://stackoverflow.com/questions/56519907/allocated-a-lot-of-memory-in-go-how-to-fix/56521597#56521597", "title": "Allocated a lot of memory in Go. How to fix?", "body": "<pre><code> for i := 0; i &lt; 50; i++ {\n        go func() {\n            DoRequest()\n        }()\n        time.Sleep(10 * time.Millisecond)\n    }\n</code></pre>\n\n<p>Never create go-routines like this. Always make sure you create go-routines the way it not fill large ( all ) memory in any case ( including worst case )</p>\n\n<p>Simple solution is control the count of go-routines can spawned ( or running ) at time.</p>\n\n<p>You can pre-calculate memory to be occupied in worst case by multiplying max-number of go-routines you want to run at a time and max-memory can be used by one go-routine.</p>\n\n<p><em>You can control instances of go-routines by using channles.</em></p>\n\n<p><strong>Refer first answer of this stackoverflow question\n<a href=\"https://stackoverflow.com/questions/25306073/always-have-x-number-of-goroutines-running-at-any-time\">Always have x number of goroutines running at any time</a></strong></p>\n\n<p>Always use balanced solution between perforamce and required resources.</p>\n\n<hr>\n\n<p><strong>Update June 11,2019</strong></p>\n\n<p>Here is example go program\n<a href=\"https://play.golang.org/p/HovNRgp6FxH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/HovNRgp6FxH</a></p>\n"}], "owner": {"reputation": 19, "user_id": 11623461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10fab5e039206c5ae26899be86ce0e9c?s=128&d=identicon&r=PG&f=1", "display_name": "xxxcvv", "link": "https://stackoverflow.com/users/11623461/xxxcvv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "accepted_answer_id": 56521597, "answer_count": 2, "score": 0, "last_activity_date": 1560251288, "creation_date": 1560134435, "question_id": 56519907, "link": "https://stackoverflow.com/questions/56519907/allocated-a-lot-of-memory-in-go-how-to-fix", "title": "Allocated a lot of memory in Go. How to fix?", "body": "<p>Several hundred MB of memory is allocated for 50 requests of 5 MB. Memory is allocated and is no longer released.\nHow can I clear my memory? Why can this happen?</p>\n\n<p>I've tried on Ubuntu on my home pc and on VPS</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n    fmt.Println(\"start\")\n\n    for i := 0; i &lt; 50; i++ {\n        go func() {\n            DoRequest()\n        }()\n        time.Sleep(10 * time.Millisecond)\n    }\n\n    time.Sleep(10 * time.Minute)\n}\n\nfunc DoRequest() error {\n    requestUrl := \"https://blockchain.info/rawblock/0000000000000000000eebedea046425bd54626e6c56eb032e66e714d0141ea6\"\n\n    req, err := http.NewRequest(\"GET\", requestUrl, nil)\n\n    if err != nil {\n        return err\n    }\n\n    req.Header.Set(\"user-agent\", \"free\")\n\n    httpClient := &amp;http.Client{\n        Timeout: time.Second * 10,\n    }\n\n    resp, err := httpClient.Do(req)\n\n    if resp != nil {\n        defer resp.Body.Close()\n    }\n\n    if err != nil {\n        return err\n    }\n\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        return err\n    }\n\n    fmt.Println(\"bodylen\", len(body))\n\n    return nil\n}\n</code></pre>\n\n<p>Allocated somewhere 400MB</p>\n"}, {"tags": ["go", "goland"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1560124275, "post_id": 56519162, "comment_id": 99623437, "body": "So you set GOPATH to $HOME/go (even though it&#39;s the default value, I think), but did you create that dir?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1560124348, "post_id": 56519162, "comment_id": 99623450, "body": "If you run <code>which go</code>, what does it say?"}, {"owner": {"reputation": 1245, "user_id": 8948092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b174734165fe08e672deb6cfe78fee5?s=128&d=identicon&r=PG&f=1", "display_name": "Petey", "link": "https://stackoverflow.com/users/8948092/petey"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1560124419, "post_id": 56519162, "comment_id": 99623459, "body": "/usr/local/go/bin/go . Is that the path I should use"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1560124446, "post_id": 56519162, "comment_id": 99623461, "body": "Well, there you go. Just create the dir and it&#39;ll hopefully just work."}, {"owner": {"reputation": 1245, "user_id": 8948092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b174734165fe08e672deb6cfe78fee5?s=128&d=identicon&r=PG&f=1", "display_name": "Petey", "link": "https://stackoverflow.com/users/8948092/petey"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1560124576, "post_id": 56519162, "comment_id": 99623477, "body": "Thank you.  I also saw in the docs the package should put the /usr/local/go/bin directory in your PATH environment variable. You may need to restart any open Terminal sessions for the change to take effect. I guess I thought go env did something different."}], "answers": [{"tags": [], "owner": {"reputation": 1245, "user_id": 8948092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b174734165fe08e672deb6cfe78fee5?s=128&d=identicon&r=PG&f=1", "display_name": "Petey", "link": "https://stackoverflow.com/users/8948092/petey"}, "is_accepted": false, "score": 0, "last_activity_date": 1560125164, "last_edit_date": 1560125164, "creation_date": 1560124378, "answer_id": 56519187, "question_id": 56519162, "link": "https://stackoverflow.com/questions/56519162/why-doesnt-my-users-myname-go-folder-exist/56519187#56519187", "title": "Why doesn&#39;t my Users/myname/go folder exist?", "body": "<p>I believe I found the folder under /usr/local/go</p>\n\n<p>I should have read this.</p>\n\n<p>Download the package file, open it, and follow the prompts to install the Go tools. The package installs the Go distribution to /usr/local/go.</p>\n\n<p>The package should put the /usr/local/go/bin directory in your PATH environment variable. You may need to restart any open Terminal sessions for the change to take effect.</p>\n\n<p>Edit: also this comment helped as far as the correct command.  \"where go\"</p>\n\n<p><a href=\"https://stackoverflow.com/questions/56519162/why-doesnt-my-users-myname-go-folder-exist#comment99623450_56519162\">Why doesn&#39;t my Users/myname/go folder exist?</a></p>\n\n<p>Thanks, leaving up for anyone else as confused as me. </p>\n"}], "owner": {"reputation": 1245, "user_id": 8948092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b174734165fe08e672deb6cfe78fee5?s=128&d=identicon&r=PG&f=1", "display_name": "Petey", "link": "https://stackoverflow.com/users/8948092/petey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 788, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560125164, "creation_date": 1560123943, "last_edit_date": 1560124309, "question_id": 56519162, "link": "https://stackoverflow.com/questions/56519162/why-doesnt-my-users-myname-go-folder-exist", "title": "Why doesn&#39;t my Users/myname/go folder exist?", "body": "<p>When I type in go env it shows me the path Users/myname/go</p>\n\n<p>I can use go from the terminal, I can even run a go file... When I open GoLand it says GOPATH is empty.  I can't even set my go path there because I can't find the folder to select on.  I try to cd into the directory from Users/myname and It still doesn't work.  I am extremely confused here.</p>\n\n<p>I have added both of these to my bash_profile even though I read it isn't necessary anymore.  </p>\n\n<pre><code>export GOPATH=$HOME/go\nexport PATH=$GOPATH/bin:$PATH\n</code></pre>\n\n<p>What is going on? Why don't I have this folder?</p>\n\n<p>EDIT: I downloaded it from here <a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">https://golang.org/dl/</a> for mac</p>\n"}, {"tags": ["go", "orm", "sqlboiler"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560118561, "post_id": 56518761, "comment_id": 99622588, "body": "These sorts of problems are one of the main reasons not to use an ORM. ORMs are ostensibly designed to make life easier. When you start banging your head against the wall because it&#39;s difficult to make the ORM do the right thing, it&#39;s obviously notmaking life easier any more."}, {"owner": {"reputation": 729, "user_id": 840821, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/aS3yN.jpg?s=128&g=1", "display_name": "Vikas Goel", "link": "https://stackoverflow.com/users/840821/vikas-goel"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560118705, "post_id": 56518761, "comment_id": 99622605, "body": "@flimzy - any suggestion to deal with it?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560118727, "post_id": 56518761, "comment_id": 99622610, "body": "My personal suggestion is to never use an ORM."}, {"owner": {"reputation": 729, "user_id": 840821, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/aS3yN.jpg?s=128&g=1", "display_name": "Vikas Goel", "link": "https://stackoverflow.com/users/840821/vikas-goel"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560118776, "post_id": 56518761, "comment_id": 99622621, "body": "If not ORM, then?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560118811, "post_id": 56518761, "comment_id": 99622626, "body": "Standard SQL. The normal way."}, {"owner": {"reputation": 729, "user_id": 840821, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/aS3yN.jpg?s=128&g=1", "display_name": "Vikas Goel", "link": "https://stackoverflow.com/users/840821/vikas-goel"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560118889, "post_id": 56518761, "comment_id": 99622641, "body": "Yes, but then if the code changes require db migration, then ORMs are convenient. Standard SQL with break a lot of things in production code. Besides, don&#39;t really have an option to not use ORM."}, {"owner": {"reputation": 729, "user_id": 840821, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/aS3yN.jpg?s=128&g=1", "display_name": "Vikas Goel", "link": "https://stackoverflow.com/users/840821/vikas-goel"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560118911, "post_id": 56518761, "comment_id": 99622643, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/194673/discussion-between-vikas-goel-and-flimzy\">continue this discussion in chat</a>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1560118914, "post_id": 56518761, "comment_id": 99622645, "body": "If that&#39;s your view, then use an ORM. In my view, an ORM is never convieneint."}], "answers": [{"tags": [], "owner": {"reputation": 2217, "user_id": 2604708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b62fe48f9c75ebe5e3868f9d428c125?s=128&d=identicon&r=PG", "display_name": "Dirbaio", "link": "https://stackoverflow.com/users/2604708/dirbaio"}, "is_accepted": false, "score": 0, "last_activity_date": 1560294942, "creation_date": 1560294942, "answer_id": 56552771, "question_id": 56518761, "link": "https://stackoverflow.com/questions/56518761/sqlboiler-select-from-another-table-in-andin/56552771#56552771", "title": "SQLBoiler select from another table in `AndIn`", "body": "<p>You can use arbitrary SQL in <code>Where</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>users, err := models.Users(\n  Select(\"id\", \"name\"),\n  Where(\"age &gt; ?\", 30),\n  Where(\"c.kind IN (select kind from your_other_table)\"),\n).All(ctx, db)\n</code></pre>\n\n<p><code>WhereIn</code>, <code>AndIn</code> are just handy functions to autogenerate a list of a variable amount of placeholders. <code>WhereIn(\"x in ?\", \"a\", \"b\")</code> is the same as <code>Where(\"x in (?, ?)\", \"a\", \"b\")</code>. If you don't need that, just use regular <code>Where</code>.</p>\n"}], "owner": {"reputation": 729, "user_id": 840821, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/aS3yN.jpg?s=128&g=1", "display_name": "Vikas Goel", "link": "https://stackoverflow.com/users/840821/vikas-goel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1600991387, "creation_date": 1560118388, "last_edit_date": 1600991387, "question_id": 56518761, "link": "https://stackoverflow.com/questions/56518761/sqlboiler-select-from-another-table-in-andin", "title": "SQLBoiler select from another table in `AndIn`", "body": "<p>I am trying to follow the examples in sqlboiler (<a href=\"https://github.com/volatiletech/sqlboiler\" rel=\"nofollow noreferrer\">https://github.com/volatiletech/sqlboiler</a>). But, I can't find a way to add another table in <code>AndIn</code> clause, since any <code>Where</code> leads to return two values.</p>\n\n<pre><code>users, err := models.Users(\n  Select(\"id\", \"name\"),\n  Where(\"age &gt; ?\", 30),\n  AndIn(\"c.kind in ?\", \"visa\", \"mastercard\"),\n).All(ctx, db)\n</code></pre>\n\n<p>In this example, if, we could get a filter a way to fetch values from another table, it'd be equivalent to SQL.</p>\n\n<p>One way to get this done is to obtain the values separately and then feed it in as a variable.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["sql", "go", "orm", "sqlboiler"], "comments": [{"owner": {"reputation": 7554, "user_id": 700471, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/ebb4cc58c1fce4f22abc59a1226ee8e2?s=128&d=identicon&r=PG", "display_name": "Matt Mc", "link": "https://stackoverflow.com/users/700471/matt-mc"}, "edited": false, "score": 0, "creation_date": 1597686281, "post_id": 56518744, "comment_id": 112208966, "body": "If your question has been answered, it would be good to accept that answer :)"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 12301035, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LvjgZr0reT0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reC2oSAQMKSr9RyuFFXr5qZCP1L_A/photo.jpg?sz=128", "display_name": "lotsof one", "link": "https://stackoverflow.com/users/12301035/lotsof-one"}, "is_accepted": false, "score": 0, "last_activity_date": 1575966943, "last_edit_date": 1575966943, "creation_date": 1575892294, "answer_id": 59248345, "question_id": 56518744, "link": "https://stackoverflow.com/questions/56518744/sqlboiler-not-in-clause/59248345#59248345", "title": "SQLboiler not in clause", "body": "<p>use <code>qm.WhereIn(\"c.kind not in ?\", \"visa\", \"mastercard\")</code></p>\n\n<p>or in a more universal format <code>qm.WhereIn(\"someColumeName not in ?\", values...)</code></p>\n\n<p>notice that <code>values</code> should be already converted to <code>[]interface{}</code></p>\n"}, {"tags": [], "owner": {"reputation": 2764, "user_id": 5326634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agDBB.jpg?s=128&g=1", "display_name": "Siyaram Malav", "link": "https://stackoverflow.com/users/5326634/siyaram-malav"}, "is_accepted": false, "score": 0, "last_activity_date": 1593540207, "creation_date": 1593540207, "answer_id": 62663557, "question_id": 56518744, "link": "https://stackoverflow.com/questions/56518744/sqlboiler-not-in-clause/62663557#62663557", "title": "SQLboiler not in clause", "body": "<p>Please use this</p>\n<pre><code>users, err := models.Users(qm.Select(&quot;id&quot;,&quot;name&quot;),qm.Where(&quot;age &gt; ?&quot;,30),model.UsersWhere.Kind.NIN([]string{&quot;visa&quot;,&quot;mastercard&quot;})).All(context.Background(),db)\nif err != nil {\n    fmt.Println(&quot;error is -- &quot;,err)\n}\nresp, _ := json.Marshal(users)\nfmt.Println(&quot;result &quot;,bytes.NewBuffer(resp))\n</code></pre>\n<p>where imported package qm is  -</p>\n<blockquote>\n<p>&quot;github.com/volatiletech/sqlboiler/v4/queries/qm&quot;</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 7554, "user_id": 700471, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/ebb4cc58c1fce4f22abc59a1226ee8e2?s=128&d=identicon&r=PG", "display_name": "Matt Mc", "link": "https://stackoverflow.com/users/700471/matt-mc"}, "is_accepted": true, "score": 3, "last_activity_date": 1597382953, "creation_date": 1597382953, "answer_id": 63407084, "question_id": 56518744, "link": "https://stackoverflow.com/questions/56518744/sqlboiler-not-in-clause/63407084#63407084", "title": "SQLboiler not in clause", "body": "<p>I'm seeing <code>AndNotIn</code> in current versions of SQLBoiler generated code.</p>\n<p>Looks like it was added on <a href=\"https://github.com/volatiletech/sqlboiler/blob/d551047361e2a3580169ce51d6445db17ae0d073/CHANGELOG.md#v420---2020-07-03\" rel=\"nofollow noreferrer\">July 3rd, 2020</a>.</p>\n"}], "owner": {"reputation": 729, "user_id": 840821, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/aS3yN.jpg?s=128&g=1", "display_name": "Vikas Goel", "link": "https://stackoverflow.com/users/840821/vikas-goel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 933, "favorite_count": 0, "accepted_answer_id": 63407084, "answer_count": 3, "score": 5, "last_activity_date": 1600991246, "creation_date": 1560118194, "last_edit_date": 1600991246, "question_id": 56518744, "link": "https://stackoverflow.com/questions/56518744/sqlboiler-not-in-clause", "title": "SQLboiler not in clause", "body": "<p>I am trying to follow the examples in sqlboiler (<a href=\"https://github.com/volatiletech/sqlboiler\" rel=\"nofollow noreferrer\">https://github.com/volatiletech/sqlboiler</a>). But, I can't find a way to get equivalent of <code>NOT IN</code> query.</p>\n\n<pre><code>users, err := models.Users(\n  Select(\"id\", \"name\"),\n  Where(\"age &gt; ?\", 30),\n  AndIn(\"c.kind in ?\", \"visa\", \"mastercard\"),\n).All(ctx, db)\n</code></pre>\n\n<p>In this example, if, we could get an operation <code>AndNotIn</code>, it'd be great.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "kubernetes"], "answers": [{"tags": [], "owner": {"reputation": 2862, "user_id": 10115847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Okv0j.jpg?s=128&g=1", "display_name": "Or Yaacov", "link": "https://stackoverflow.com/users/10115847/or-yaacov"}, "is_accepted": true, "score": 0, "last_activity_date": 1560108402, "creation_date": 1560108402, "answer_id": 56517750, "question_id": 56517463, "link": "https://stackoverflow.com/questions/56517463/how-to-increase-the-klog-level-verbosity/56517750#56517750", "title": "How to increase the klog level verbosity?", "body": "<p>from their <a href=\"https://github.com/kubernetes/klog/blob/master/klog.go\" rel=\"nofollow noreferrer\">source code</a>:</p>\n\n<pre><code>    flagset.Var(&amp;logging.verbosity, \"v\", \"number for the log level verbosity\")\n\n.\n.\n.\n    // get returns the value of the Level.\n    func (l *Level) get() Level {\n        return Level(atomic.LoadInt32((*int32)(l)))\n    }\n</code></pre>\n\n<p>so the answer is yes, all you need to do is to use the v flag.</p>\n\n<p>to know which number is which, <a href=\"http://rpg.ifi.uzh.ch/docs/glog.html\" rel=\"nofollow noreferrer\">read this article</a>  :</p>\n\n<blockquote>\n  <p>With VLOG, the lower the verbose level, the more likely messages are to be logged. For example, if --v==1, VLOG(1) will log, but VLOG(2) will not log. This is opposite of the severity level, where INFO is 0, and ERROR is 2. --minloglevel of 1 will log WARNING and above. Though you can specify any integers for both VLOG macro and --v flag, the common values for them are small positive integers. For example, if you write VLOG(0), you should specify --v=-1 or lower to silence it. This is less useful since we may not want verbose logs by default in most cases. The VLOG macros always log at the INFO log level (when they log at all).</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1817, "user_id": 5464805, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/y0MdL.png?s=128&g=1", "display_name": "Olympiloutre", "link": "https://stackoverflow.com/users/5464805/olympiloutre"}, "edited": false, "score": 0, "creation_date": 1563492922, "post_id": 57103653, "comment_id": 100728486, "body": "Can you post the actual solution and explainations on it instead of the actual solution in a PR ?"}], "tags": [], "owner": {"reputation": 49, "user_id": 9195403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931d4a8ccdc84fa14081c313ba93b640?s=128&d=identicon&r=PG&f=1", "display_name": "Zenler25", "link": "https://stackoverflow.com/users/9195403/zenler25"}, "is_accepted": false, "score": 1, "last_activity_date": 1563491219, "creation_date": 1563491219, "answer_id": 57103653, "question_id": 56517463, "link": "https://stackoverflow.com/questions/56517463/how-to-increase-the-klog-level-verbosity/57103653#57103653", "title": "How to increase the klog level verbosity?", "body": "<p>This was fixed by klog.InitFlags(nil) in this PR <a href=\"https://github.com/kubernetes/kubernetes/pull/79219/files\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/kubernetes/pull/79219/files</a></p>\n"}], "owner": {"reputation": 49, "user_id": 9195403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931d4a8ccdc84fa14081c313ba93b640?s=128&d=identicon&r=PG&f=1", "display_name": "Zenler25", "link": "https://stackoverflow.com/users/9195403/zenler25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1441, "favorite_count": 0, "accepted_answer_id": 56517750, "answer_count": 2, "score": 1, "last_activity_date": 1563491219, "creation_date": 1560106258, "question_id": 56517463, "link": "https://stackoverflow.com/questions/56517463/how-to-increase-the-klog-level-verbosity", "title": "How to increase the klog level verbosity?", "body": "<p>I am using the kubernetes sample controller and I want to increase the log verbosity</p>\n\n<p>On starting up the controller I tried <code>./sample-controller -kubeconfig=kubeconfig.yaml -v=8</code></p>\n\n<p>Does klog require a flag to be passed in on the flag.Parse() step or can I set some env variable to increase log level?</p>\n"}, {"tags": ["go", "gorilla", "tus"], "answers": [{"tags": [], "owner": {"reputation": 9303, "user_id": 2767626, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5f74cbf47c5fa12d9a045cabb5c2e0e2?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Gassmann", "link": "https://stackoverflow.com/users/2767626/tobias-gassmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1560091419, "creation_date": 1560091419, "answer_id": 56515537, "question_id": 56515450, "link": "https://stackoverflow.com/questions/56515450/difference-between-http-handle-and-gorilla-mux-when-implementing-tus-file-upload/56515537#56515537", "title": "Difference between http.handle and gorilla.mux when implementing tus-file-uploader", "body": "<p><strong>Solved it:</strong></p>\n\n<pre><code>r.PathPrefix(\"/files/\").Handler(http.StripPrefix(\"/files/\", handler))\n</code></pre>\n\n<p>is the correct way to implement the tusd-uploader-handler</p>\n"}], "owner": {"reputation": 9303, "user_id": 2767626, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5f74cbf47c5fa12d9a045cabb5c2e0e2?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Gassmann", "link": "https://stackoverflow.com/users/2767626/tobias-gassmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560091465, "creation_date": 1560090715, "last_edit_date": 1560091465, "question_id": 56515450, "link": "https://stackoverflow.com/questions/56515450/difference-between-http-handle-and-gorilla-mux-when-implementing-tus-file-upload", "title": "Difference between http.handle and gorilla.mux when implementing tus-file-uploader", "body": "<p>I am trying to implement a tus-file-uploader (tus.io) based on the exmaples provided on their website. Everything works fine until I switch from</p>\n\n<pre><code>http.Handle(\"/files/\", http.StripPrefix(\"/files/\", handler))\n</code></pre>\n\n<p>to</p>\n\n<pre><code>r.Handle(\"/files/\", http.StripPrefix(\"/files/\", handler))\n</code></pre>\n\n<p>having declared r like this:</p>\n\n<pre><code>r := mux.NewRouter()\n</code></pre>\n\n<p>Using the gorilla router makes the tus-server reply with 404 when trying to call the PATCH-Request to upload a file.</p>\n\n<p>Question: In which ways is http-Handle different from r.Handle given in the example above? Maybe it does not serve PATCH-Requests?</p>\n"}, {"tags": ["macos", "docker", "go"], "comments": [{"owner": {"reputation": 15252, "user_id": 176186, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a97589645d0606dc4aefc4c40301c429?s=128&d=identicon&r=PG", "display_name": "Tomasz Zieli\u0144ski", "link": "https://stackoverflow.com/users/176186/tomasz-zieli%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1560088099, "post_id": 56514763, "comment_id": 99616009, "body": "I have two wild guesses: 1) you use a custom bridge network and port publishing only works for the default one--you can try removing the custom network config and also &quot;unwire&quot; the containers from it (then the default bridge network will kick in). I can&#39;t test this now but I think <a href=\"https://docs.docker.com/v17.09/engine/userguide/networking/default_network/binding/\" rel=\"nofollow noreferrer\">docs.docker.com/v17.09/engine/userguide/networking/&hellip;</a> suggests this might be the case.  2) the web server is not responding--you can verify that by checking whether it responds inside the container (e.g. by running something like <code>docker-compose exec server curl http:&#47;&#47;127.0.0.1:8080</code>"}, {"owner": {"reputation": 30574, "user_id": 427763, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e7314f6ed3c46d62ce8671cad2c82b97?s=128&d=identicon&r=PG", "display_name": "prolink007", "link": "https://stackoverflow.com/users/427763/prolink007"}, "reply_to_user": {"reputation": 15252, "user_id": 176186, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a97589645d0606dc4aefc4c40301c429?s=128&d=identicon&r=PG", "display_name": "Tomasz Zieli\u0144ski", "link": "https://stackoverflow.com/users/176186/tomasz-zieli%c5%84ski"}, "edited": false, "score": 1, "creation_date": 1560088372, "post_id": 56514763, "comment_id": 99616061, "body": "@TomaszZieli\u0144ski Doing your (2) option worked. Will try 1 now."}, {"owner": {"reputation": 15252, "user_id": 176186, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a97589645d0606dc4aefc4c40301c429?s=128&d=identicon&r=PG", "display_name": "Tomasz Zieli\u0144ski", "link": "https://stackoverflow.com/users/176186/tomasz-zieli%c5%84ski"}, "edited": false, "score": 1, "creation_date": 1560088590, "post_id": 56514763, "comment_id": 99616111, "body": "As for (2), the server also needs to bind to 0.0.0.0 and not to 127.0.0.1, otherwise it won&#39;t bind to the bridge interface and so it won&#39;t be visible outside the container no matter what the network setup is."}, {"owner": {"reputation": 30574, "user_id": 427763, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e7314f6ed3c46d62ce8671cad2c82b97?s=128&d=identicon&r=PG", "display_name": "prolink007", "link": "https://stackoverflow.com/users/427763/prolink007"}, "reply_to_user": {"reputation": 15252, "user_id": 176186, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a97589645d0606dc4aefc4c40301c429?s=128&d=identicon&r=PG", "display_name": "Tomasz Zieli\u0144ski", "link": "https://stackoverflow.com/users/176186/tomasz-zieli%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1560088622, "post_id": 56514763, "comment_id": 99616115, "body": "@TomaszZieli\u0144ski I tried (1) and it did not work. With (1) number (2) is still working."}, {"owner": {"reputation": 15252, "user_id": 176186, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a97589645d0606dc4aefc4c40301c429?s=128&d=identicon&r=PG", "display_name": "Tomasz Zieli\u0144ski", "link": "https://stackoverflow.com/users/176186/tomasz-zieli%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1560088710, "post_id": 56514763, "comment_id": 99616134, "body": "Did you recreate the containers or just restart them? In order to apply the new network settings you need to do <code>docker-compose up</code> once again."}, {"owner": {"reputation": 30574, "user_id": 427763, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e7314f6ed3c46d62ce8671cad2c82b97?s=128&d=identicon&r=PG", "display_name": "prolink007", "link": "https://stackoverflow.com/users/427763/prolink007"}, "reply_to_user": {"reputation": 15252, "user_id": 176186, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a97589645d0606dc4aefc4c40301c429?s=128&d=identicon&r=PG", "display_name": "Tomasz Zieli\u0144ski", "link": "https://stackoverflow.com/users/176186/tomasz-zieli%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1560088847, "post_id": 56514763, "comment_id": 99616169, "body": "@TomaszZieli\u0144ski I did recreate the containers. What fixed the problem was changing my server address to <code>0.0.0.0</code>. Thank you so much! Add this as an answer, and i will accept it."}, {"owner": {"reputation": 30574, "user_id": 427763, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e7314f6ed3c46d62ce8671cad2c82b97?s=128&d=identicon&r=PG", "display_name": "prolink007", "link": "https://stackoverflow.com/users/427763/prolink007"}, "reply_to_user": {"reputation": 15252, "user_id": 176186, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a97589645d0606dc4aefc4c40301c429?s=128&d=identicon&r=PG", "display_name": "Tomasz Zieli\u0144ski", "link": "https://stackoverflow.com/users/176186/tomasz-zieli%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1560089150, "post_id": 56514763, "comment_id": 99616250, "body": "@TomaszZieli\u0144ski Any ideas on why my server can&#39;t connect to the mysql server? I get this message when trying to connect: <code>127.0.0.1:3306: connect: connection refused</code>"}, {"owner": {"reputation": 15252, "user_id": 176186, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a97589645d0606dc4aefc4c40301c429?s=128&d=identicon&r=PG", "display_name": "Tomasz Zieli\u0144ski", "link": "https://stackoverflow.com/users/176186/tomasz-zieli%c5%84ski"}, "edited": false, "score": 1, "creation_date": 1560089654, "post_id": 56514763, "comment_id": 99616367, "body": "Mysql doesn&#39;t bind to 127.0.0.1 inside the web server container. You should be able to use <code>http:&#47;&#47;mysql:3306</code> as then Docker DNS will resolve <code>mysql</code> to the correct IP address of mysql container."}], "answers": [{"tags": [], "owner": {"reputation": 15252, "user_id": 176186, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a97589645d0606dc4aefc4c40301c429?s=128&d=identicon&r=PG", "display_name": "Tomasz Zieli\u0144ski", "link": "https://stackoverflow.com/users/176186/tomasz-zieli%c5%84ski"}, "is_accepted": true, "score": 2, "last_activity_date": 1560089543, "creation_date": 1560089543, "answer_id": 56515299, "question_id": 56514763, "link": "https://stackoverflow.com/questions/56514763/cant-reach-server-inside-docker-container-from-host/56515299#56515299", "title": "Can&#39;t reach server inside docker container from host", "body": "<p><em>(This answer is based on the chat we had in <a href=\"https://stackoverflow.com/questions/56514763/cant-reach-server-inside-docker-container-from-host#comment99616009_56514763\">the comments</a>)</em></p>\n\n<p>In order to expose the web server from inside the container to the host it needs to bind to 0.0.0.0 and not to 127.0.0.1. Using 0.0.0.0 ensures that the web server binds to the bridge interface that can be accessed from the host side.</p>\n\n<p>Relevant Docker docs: <a href=\"https://docs.docker.com/v17.09/engine/userguide/networking/default_network/binding/\" rel=\"nofollow noreferrer\">https://docs.docker.com/v17.09/engine/userguide/networking/default_network/binding/</a> </p>\n"}], "owner": {"reputation": 30574, "user_id": 427763, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e7314f6ed3c46d62ce8671cad2c82b97?s=128&d=identicon&r=PG", "display_name": "prolink007", "link": "https://stackoverflow.com/users/427763/prolink007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 56515299, "answer_count": 1, "score": 2, "last_activity_date": 1560089543, "creation_date": 1560084931, "question_id": 56514763, "link": "https://stackoverflow.com/questions/56514763/cant-reach-server-inside-docker-container-from-host", "title": "Can&#39;t reach server inside docker container from host", "body": "<p>I am hosting a <code>mysql</code> server and a <code>go</code> http server in docker. I am unable to hit the http server from my host machine. My host machine is a mac.</p>\n\n<p>I have tried using <code>localhost:8080</code> and <code>ipofserver:8080</code>. I get the <code>ip</code> from the <code>docker inspect</code>. I am able to connect to my <code>mysql</code> server from my host, but i can't hit the server from the host.</p>\n\n<p>Here is my <code>docker ps</code> output.</p>\n\n<pre><code>0.0.0.0:8080-&gt;8080/tcp\n0.0.0.0:3306-&gt;3306/tcp, 33060/tcp\n</code></pre>\n\n<p>Below are my details:</p>\n\n<p>Docker Desktop version 2.0.0.3.</p>\n\n<p>docker-compose</p>\n\n<pre><code>version: '3.1'\n\nservices:\n\n    mysql:\n        image: mysql:latest\n        restart: always\n        environment:\n            MYSQL_ROOT_PASSWORD: password\n            MYSQL_DATABASE: mydb\n        volumes:\n            - mysql:/var/lib/mysql\n        ports:\n            - \"3306:3306\"\n        networks:\n            - mynetwork\n\n    server:\n        image: server:latest\n        networks:\n             - mynetwork\n        ports:\n             - \"8080:8080\"\n\nvolumes:\n    mysql: ~\n\nnetworks:\n    mynetwork:\n        driver: \"bridge\"\n</code></pre>\n\n<p>mysql dockerfile</p>\n\n<pre><code>FROM mysql:8.0.16\n\nCOPY ./scripts/mysql/dbgen-v1.sql /docker-entrypoint-initdb.d/\n\nEXPOSE 3306\n</code></pre>\n\n<p>server dockerfile</p>\n\n<pre><code>FROM golang:1.12.5\n\nWORKDIR a/go/path\nCOPY . .\n\nENV GOBIN=/usr/local/bin\n\nRUN go get github.com/go-sql-driver/mysql\nRUN go get github.com/iancoleman/strcase\nRUN go get github.com/jmoiron/sqlx\nRUN go get github.com/spf13/cobra\nRUN go get github.com/gorilla/websocket\nRUN go get github.com/spf13/viper\n\nRUN go install -v cmd/project/main.go\n\nEXPOSE 8080\n\nCMD [\"main\"]\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1560073993, "post_id": 56513174, "comment_id": 99613315, "body": "Should all of the 3 queues receive the same requests, or do you want each one of them to handle different requests?"}, {"owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560113049, "post_id": 56513174, "comment_id": 99621641, "body": "same structure and same worker code, but different worker for each of the 3 queues ( 1 each )"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1560113301, "post_id": 56513174, "comment_id": 99621675, "body": "My question was about serving the incoming requests. When a request is sent to your server, what should happen? Should all three queues handle that request? Or should a single request be handled always by only one queue?"}, {"owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560135940, "post_id": 56513174, "comment_id": 99625001, "body": "ah sorry, no there will be a set of api&#39;s that is associated to each queue, the worker associated for each queue will be executing a different external process."}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "edited": false, "score": 0, "creation_date": 1560136043, "post_id": 56513710, "comment_id": 99625020, "body": "looks cool ! will try it out - i am able to add more routes per gv right ?"}, {"owner": {"reputation": 2922, "user_id": 929981, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/66Mz4.png?s=128&g=1", "display_name": "jtepe", "link": "https://stackoverflow.com/users/929981/jtepe"}, "reply_to_user": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "edited": false, "score": 1, "creation_date": 1560141174, "post_id": 56513710, "comment_id": 99625730, "body": "Sure, just register the same gv Handler on multiple different routes. It will then serve all of those."}, {"owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "edited": false, "score": 0, "creation_date": 1560157489, "post_id": 56513710, "comment_id": 99630808, "body": "trying it out here, but one thing i am not sure of is how does it know what serveHTTP to go to ? or what requesthandler ex /route2 has compared to /route3 ?"}, {"owner": {"reputation": 2922, "user_id": 929981, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/66Mz4.png?s=128&g=1", "display_name": "jtepe", "link": "https://stackoverflow.com/users/929981/jtepe"}, "reply_to_user": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "edited": false, "score": 1, "creation_date": 1560176125, "post_id": 56513710, "comment_id": 99639648, "body": "Not sure I am following you, but do you mean how to ServeMux decides which implementation of Handler to call? It does it based on the incoming request URL path."}, {"owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "edited": false, "score": 0, "creation_date": 1560183810, "post_id": 56513710, "comment_id": 99643513, "body": "what i mean is if they all go through the same serveHTTP like im doing it today - so i just have swithcase like today for what route it is ex &quot;case  &#39;route1/&#39;:&quot; - then serveHTTP will know just by the api route in text what GV its associated to ?"}, {"owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "edited": false, "score": 0, "creation_date": 1560310541, "post_id": 56513710, "comment_id": 99689724, "body": "would you able to add a handler to your example for route1,route2,route3 ? am simply not able to get my head around this servemux, reading alot on it but all examples i come across are a single handler or examples where they pass on a function of the handler to it ( and in my case here im not passing a function but a variable structure )"}, {"owner": {"reputation": 2922, "user_id": 929981, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/66Mz4.png?s=128&g=1", "display_name": "jtepe", "link": "https://stackoverflow.com/users/929981/jtepe"}, "reply_to_user": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "edited": false, "score": 1, "creation_date": 1560401844, "post_id": 56513710, "comment_id": 99725303, "body": "I&#39;m still not entirely sure what you&#39;re asking, but I added a small example nonetheless ;)"}, {"owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "edited": false, "score": 0, "creation_date": 1560411038, "post_id": 56513710, "comment_id": 99728910, "body": "thanks alot - it was exactly this one i wasnt sure of :) marking it as the answer and thankyou so much."}], "tags": [], "owner": {"reputation": 2922, "user_id": 929981, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/66Mz4.png?s=128&g=1", "display_name": "jtepe", "link": "https://stackoverflow.com/users/929981/jtepe"}, "is_accepted": true, "score": 6, "last_activity_date": 1560413459, "last_edit_date": 1560413459, "creation_date": 1560075128, "answer_id": 56513710, "question_id": 56513174, "link": "https://stackoverflow.com/questions/56513174/http-server-multiple-handlers/56513710#56513710", "title": "Http.Server {} - multiple handler&#39;s?", "body": "<p>Have a look at the <a href=\"https://golang.org/pkg/net/http/#ServeMux\" rel=\"nofollow noreferrer\">net.http.ServeMux</a> type:</p>\n\n<blockquote>\n  <p>ServeMux is an HTTP request multiplexer. It matches the URL of each incoming request against a list of registered patterns and calls the handler for the pattern that most closely matches the URL.</p>\n</blockquote>\n\n<p>A ServeMux is itself an <code>http.Handler</code> and multiplexes to different <em>subhandlers</em> by request route.\nFrom what I understand of your question, you want to have different handlers on the same server, and each handler addresses a different queue with a different config.</p>\n\n<p>Using a ServeMux one can achieve that easily:</p>\n\n<pre><code>gv1 := GlobalVars{\n    jobs:             make(chan QueueElement),\n    appConfig:        appConfig1,\n}\ngv2 := GlobalVars{\n    jobs:             make(chan QueueElement),\n    appConfig:        appConfig2,\n}\ngv3 := GlobalVars{\n    jobs:             make(chan QueueElement),\n    appConfig:        appConfig3,\n}\n\nsm := http.NewServeMux()\n// Let gv{1,2,3} handle routes{1,2,3} respectively\nsm.Handle(\"/route1\", &amp;gv1)\nsm.Handle(\"/route2\", &amp;gv2)\nsm.Handle(\"/route3\", &amp;gv3)\n\n// Register the ServeMux as the sole Handler. It will delegate to the subhandlers.\nserver := http.Server{\n    Handler: sm,\n    Addr:    \":\" + globalAppConfig.Port,\n}\n</code></pre>\n\n<p>Note, you don't have to construct an <code>http.Server</code> by yourself. If you just need one server, you can use http package level functions <a href=\"https://golang.org/pkg/net/http/#ListenAndServe\" rel=\"nofollow noreferrer\">http.ListenAndServe</a> and <a href=\"https://golang.org/pkg/net/http/#Handle\" rel=\"nofollow noreferrer\">http.Handle</a> which take care of creating a Server and default ServeMux for you.</p>\n\n<pre><code>// same GlobalVars as above\n// ...\n\n// Instead of creating a ServeMux we can use the global DefaultServeMux\nhttp.Handle(\"/route1\", &amp;gv1)\nhttp.Handle(\"/route2\", &amp;gv2)\nhttp.Handle(\"/route3\", &amp;gv3)\n\n// Calling the package level ListenAndServe uses the single global server.\n// Passing nil as the Handler uses the DefaultServeMux as Handler on which we registered the Handlers above.\nlog.Fatal(http.ListenAndServe(\":\" + globalAppConfig.Port, nil)\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>A small example of the standard <code>ServeMux</code> with two <code>Handler</code>s serving 3 routes</p>\n\n<pre><code>// Keeping this type simple for the example\ntype GlobalVars struct {\n    appConfig string\n}\n\n// This method makes every GlobalVars a net.http.Handler\nfunc (gv *GlobalVars) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n    fmt.Fprintf(w, \"%s here. Receiving request for %s\\n\", gv.appConfig, req.URL.Path)\n}\n\nfunc main() {\n    gv1 := &amp;GlobalVars{\n        appConfig: \"gv1\",\n    }\n    gv2 := &amp;GlobalVars{\n        appConfig: \"gv2\",\n    }\n\n    // Handle requires a route and a Handler, our gvs are Handlers.\n    // gv1 handles two routes, while gv2 handles only one.\n    http.Handle(\"/route1\", gv1)\n    http.Handle(\"/route2\", gv1)\n    http.Handle(\"/route3\", gv2)\n\n    log.Fatal(http.ListenAndServe(\":8000\", nil))\n}\n</code></pre>\n\n<p>If I call all three routes after one another, I will receive the following responses:</p>\n\n<pre><code>$ curl localhost:8000/route1\ngv1 here. Receiving request for /route1\n$ curl localhost:8000/route2\ngv1 here. Receiving request for /route2\n$ curl localhost:8000/route3\ngv2 here. Receiving request for /route3\n</code></pre>\n\n<p>This shows how to use stateful variables as Handlers (e.g. variables of type GlobalVars).</p>\n\n<p><strong>NOTE</strong>: The handler method <code>ServeHTTP</code> has a pointer receiver for <code>GlobalVars</code>. This means the method could potentially change the <code>GlobalVars</code> variable. HTTP Handlers are executed concurrently (imagine multiple requests to the same handler in a very short time period, you'll want to stay as responsive as possible). This example only reads the appConfig value, so it's fine. Once a write to the variable/field comes into the mix, however, you'll need proper synchronization.</p>\n"}], "owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2773, "favorite_count": 0, "accepted_answer_id": 56513710, "answer_count": 1, "score": 3, "last_activity_date": 1560413459, "creation_date": 1560069763, "last_edit_date": 1560072078, "question_id": 56513174, "link": "https://stackoverflow.com/questions/56513174/http-server-multiple-handlers", "title": "Http.Server {} - multiple handler&#39;s?", "body": "<p>I have a structural problem: I can't figure out how I can do with the way I built it up now (I can find solutions where i can see it work with other models ).</p>\n\n<p>I'm using standard Net/Http, and I initiate my server with the following code :</p>\n\n<pre><code>gv := GlobalVars{\n    jobs:             make(chan QueueElement),\n    appConfig:        appConfig,\n}\n\ngo worker(&amp;gv)\n\nserver := http.Server{\n    Handler: &amp;gv,\n    Addr:    \":\" + appConfig.Port,\n}\n\nlog.Fatal(server.ListenAndServe())\n</code></pre>\n\n<p>Then I have one handler that checks for all the routes in a case :</p>\n\n<pre><code>func (gv *GlobalVars) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n\n}\n</code></pre>\n\n<p>The application is starting up some api's that passes jobs to a queue.</p>\n\n<p>My issue is, I need to start up 3 of these (different queues, different config ) but same globalvar structure.</p>\n\n<p>But this one only has one Handler that i can set - how would I be add multiple handlers (I don't want multiple servers, has to run on the same port ) that can understand its addressing different globalvars variables ? </p>\n\n<pre><code>server := http.Server{\n    Handler: &amp;gv,\n    Addr:    \":\" + appConfig.Port,\n}\n</code></pre>\n"}, {"tags": ["go", "govmomi"], "comments": [{"owner": {"reputation": 3921, "user_id": 2061684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ad823a3c12f55ee1103eeec268bc54?s=128&d=identicon&r=PG", "display_name": "jnovack", "link": "https://stackoverflow.com/users/2061684/jnovack"}, "edited": false, "score": 0, "creation_date": 1594057667, "post_id": 56513166, "comment_id": 110987357, "body": "Do you mean, rather than <code>dcs := []string{&quot;First-DC&quot;, &quot;Second-DC&quot;}</code>, you don&#39;t want to hard-code them, you want to dynamically find them?"}], "owner": {"reputation": 514, "user_id": 8096508, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1851159938543749/picture?type=large", "display_name": "Alex Nikitin", "link": "https://stackoverflow.com/users/8096508/alex-nikitin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1697, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561021616, "creation_date": 1560069706, "last_edit_date": 1561021616, "question_id": 56513166, "link": "https://stackoverflow.com/questions/56513166/golang-govmomi-filter-vms-by-resource-pool", "title": "Golang govmomi filter VMs by Resource Pool", "body": "<p>I currently have some go code to list VM names and Resource Pools with govmomi library. In the output I have some sort of Resource Pool identifiers, not actual names. So I have two questions: 1. Is there a clean and simple way to filter VMs by Resource Pool's name, as govc command:</p>\n\n<pre><code>govc find . -type m -resourcePool $(govc find -i . -name PoolName) \n</code></pre>\n\n<p>2. Is there a way to search in all DCs, without specifying names, as I want to create goroutine to search in a number of vSpheres, they have different DC names but same Pools.\nMy code:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"net/url\"\n    \"os\"\n    \"sync\"\n    \"github.com/vmware/govmomi\"\n    \"github.com/vmware/govmomi/find\"\n    \"github.com/vmware/govmomi/property\"\n    \"github.com/vmware/govmomi/vim25/mo\"\n    \"github.com/vmware/govmomi/vim25/types\"\n    \"golang.org/x/net/context\"\n)\n\nvar vsphereUrl = \"https://name:pass@vsphere/sdk\"\nvar insecureFlag = false\n\n\nfunc exit(err error) {\n    fmt.Fprintf(os.Stderr, \"Error: %s\\n\", err)\n    os.Exit(1)\n}\n\n\nfunc main() {\n    ctx, cancel := context.WithCancel(context.Background())\n    defer cancel()\n    flag.Parse()\n    u, err := url.Parse(vsphereUrl)\n    if err != nil {\n        exit(err)\n    }\n    c, err := govmomi.NewClient(ctx, u, insecureFlag)\n    if err != nil {\n        exit(err)\n    }\n    f := find.NewFinder(c.Client, true)\n    dcs := []string{\"First-DC\", \"Second-DC\"}\n    var group sync.WaitGroup\n    for _, dc := range dcs {\n        group.Add(1)\n        go func(ctx context.Context, dc string, f *find.Finder, c *govmomi.Client, group *sync.WaitGroup) {\n            defer group.Done()\n            dcObj, err := f.DatacenterOrDefault(ctx, dc)\n            if err != nil {\n                exit(err)\n            }\n            f.SetDatacenter(dcObj)\n            vms, err := f.VirtualMachineList(ctx, \"*\")\n            if err != nil {\n                exit(err)\n            }\n            pc := property.DefaultCollector(c.Client)\n            var refs []types.ManagedObjectReference\n            for _, vm := range vms {\n                refs = append(refs, vm.Reference())\n            }\n            var vmt []mo.VirtualMachine\n            err = pc.Retrieve(ctx, refs, []string{\"name\", \"resourcePool\"}, &amp;vmt)\n            if err != nil {\n                exit(err)\n            }\n            for _, vm := range vmt {\n                fmt.Println(vm.Name, vm.ResourcePool)\n            }\n        }(ctx, dc, f, c, &amp;group)\n    }\n    group.Wait()\n    fmt.Println(\"Done.\")\n}\n</code></pre>\n\n<p>Current output:</p>\n\n<pre><code>SRVAP1027 ResourcePool:resgroup-3246\nSRVAP1029 ResourcePool:resgroup-3246\nSRVWE086 ResourcePool:resgroup-544\nSRVDB087 ResourcePool:resgroup-3246\nSRVAP1031 ResourcePool:resgroup-49\nSRVAP1036 ResourcePool:resgroup-49\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1560068416, "post_id": 56512944, "comment_id": 99612378, "body": "To de-reference a pointer use the <code>*</code> (pointer indirection operator), not <code>&amp;</code>. That is, <code>(*matrix)[0][0] = 3</code>. <a href=\"https://play.golang.com/p/csHBqcCwF-b\" rel=\"nofollow noreferrer\">play.golang.com/p/csHBqcCwF-b</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1560068634, "post_id": 56512944, "comment_id": 99612411, "body": "... read more here: <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Address_operators</a>"}], "answers": [{"comments": [{"owner": {"reputation": 886, "user_id": 1034533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d49eae7506256d5a432cbef0c4b38b0?s=128&d=identicon&r=PG", "display_name": "user1034533", "link": "https://stackoverflow.com/users/1034533/user1034533"}, "edited": false, "score": 1, "creation_date": 1576702078, "post_id": 56513140, "comment_id": 104988612, "body": "the note in this response is very important! slice types are <i>already pointer types</i> (see: <a href=\"https://www.geeksforgeeks.org/slices-in-golang/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/slices-in-golang</a>), so you don&#39;t need to give pointers to them. Go also has Arrays, which are more like traditional array types but should very rarely be used"}], "tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": true, "score": 2, "last_activity_date": 1576702254, "last_edit_date": 1576702254, "creation_date": 1560069429, "answer_id": 56513140, "question_id": 56512944, "link": "https://stackoverflow.com/questions/56512944/pass-and-modify-2d-slice-by-reference/56513140#56513140", "title": "Pass and modify 2d slice by reference", "body": "<p>To set <code>matrix[0][0]</code> to 3, using pointer dereferencing: </p>\n\n<pre><code>(*matrix)[0][0] = 3\n</code></pre>\n\n<p>Try <a href=\"https://play.golang.org/p/tMsyu1I2OMC\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    matrix := [][]int{\n        {1, 0, 0},\n        {1, 0, 0},\n        {0, 1, 1},\n    }\n    fmt.Println(\"Before\")\n    printMatrix(matrix)\n    changeMatrixByReference(&amp;matrix)\n\n    fmt.Println(\"After\")\n    printMatrix(matrix)\n}\n\nfunc changeMatrixByReference(matrix *[][]int) {\n    (*matrix)[0][0] = 3\n}\n\nfunc printMatrix(matrix [][]int) {\n    for i := 0; i &lt; len(matrix); i++ {\n        for j := 0; j &lt; len(matrix[0]); j++ {\n            fmt.Printf(\"%d\", matrix[i][j])\n        }\n        fmt.Println(\"\")\n    }\n}\n\n</code></pre>\n\n<hr>\n\n<p>For as long as you don't modify the <a href=\"https://stackoverflow.com/a/54196005/4466350\">slice header</a> (like when adding element), you <strong>don't need a pointer</strong>, elements accessed by their index are stored in a backing array for which the slice header holds a pointer for you:<br>\nTry <a href=\"https://play.golang.org/p/ZdTreebbHZ9\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    matrix := [][]int{\n        {1, 0, 0},\n        {1, 0, 0},\n        {0, 1, 1},\n    }\n    fmt.Println(\"Before\")\n    printMatrix(matrix)\n    changeMatrixByReference(matrix)\n\n    fmt.Println(\"After\")\n    printMatrix(matrix)\n}\n\nfunc changeMatrixByReference(matrix [][]int) {\n    matrix[0][0] = 3\n}\n\nfunc printMatrix(matrix [][]int) {\n    for i := 0; i &lt; len(matrix); i++ {\n        for j := 0; j &lt; len(matrix[0]); j++ {\n            fmt.Printf(\"%d\", matrix[i][j])\n        }\n        fmt.Println(\"\")\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Before\n100\n100\n011\nAfter\n300\n100\n011\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11462039, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NhckbN6jaq8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re448C_a58woyCj9RY33vPAP-X-GQ/mo/photo.jpg?sz=128", "display_name": "alif", "link": "https://stackoverflow.com/users/11462039/alif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56513140, "answer_count": 1, "score": 0, "last_activity_date": 1576702254, "creation_date": 1560067540, "last_edit_date": 1576701905, "question_id": 56512944, "link": "https://stackoverflow.com/questions/56512944/pass-and-modify-2d-slice-by-reference", "title": "Pass and modify 2d slice by reference", "body": "<p>I'm trying to figure out how to change a multidimensional slice by reference.</p>\n\n<pre><code>func main() {\n\n    matrix := [][]int{\n        {1, 0, 0},\n        {1, 0, 0},\n        {0, 1, 1},\n    }\n    fmt.Println(\"Before\")\n    printMatrix(matrix)\n    changeMatrixByReference(&amp;matrix)\n\n    fmt.Println(\"After\")\n    printMatrix(matrix)\n}\n\nfunc changeMatrixByReference(matrix *[][]int) {\n    //&amp;matrix[0][0] = 3\n}\n\nfunc printMatrix(matrix [][]int) {\n    for i := 0; i &lt; len(matrix); i++ {\n        for j := 0; j &lt; len(matrix[0]); j++ {\n            fmt.Printf(\"%d\", matrix[i][j])\n        }\n        fmt.Println(\"\")\n    }\n}\n</code></pre>\n\n<p>How can I change the matrix 2d slice inside the function <code>changeMatrixByReference</code>? I expect when <code>printMatrix</code> runs the second time <code>matrix[0][0]</code> becomes <code>3</code>.</p>\n"}, {"tags": ["go", "api-gateway"], "answers": [{"tags": [], "owner": {"reputation": 197, "user_id": 622029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5e37efc9a7e2f24782b23beb56854c?s=128&d=identicon&r=PG", "display_name": "yuwono95", "link": "https://stackoverflow.com/users/622029/yuwono95"}, "is_accepted": false, "score": 0, "last_activity_date": 1560074313, "creation_date": 1560074313, "answer_id": 56513642, "question_id": 56512345, "link": "https://stackoverflow.com/questions/56512345/how-to-configure-krakend-json-to-forward-parameterized-url/56513642#56513642", "title": "How to configure krakend.json to forward parameterized url?", "body": "<p>Its turn out that I've declared same pattern as endpoint:</p>\n\n<pre><code>{\n      \"version\": 2,\n      \"timeout\": \"3000ms\",\n      \"cache_ttl\": \"300s\",\n      \"name\": \"myapi\",\n      \"output_encoding\": \"json\",\n      \"port\": 4321,\n      \"endpoints\": [\n          {\n              \"endpoint\": \"/api/v1/me/profile\",\n              \"method\": \"GET\",\n              \"headers_to_pass\": [ \"*\" ],\n              \"output_encoding\": \"no-op\",\n              \"concurrent_calls\": 1,\n              \"backend\": [\n                  {\n                      \"url_pattern\": \"/api/me/profile\",\n                      \"encoding\": \"no-op\",\n                      \"host\": [\n                          \"http://123.45.67.89:4321\"\n                      ]\n                 }\n             ]\n          },\n          {\n              \"endpoint\": \"/api/v1/{uid}/profile\",\n              \"method\": \"GET\",\n              \"headers_to_pass\": [ \"*\" ],\n              \"querystring_params\": [ \"*\" ],\n              \"output_encoding\": \"no-op\",\n              \"concurrent_calls\": 1,\n              \"backend\": [\n                  {\n                      \"url_pattern\": \"/api/{uid}/profile\",\n                      \"encoding\": \"no-op\",\n                      \"host\": [\n                          \"http://123.45.67.89:4321\"\n                      ]\n                  }\n              ]\n          }\n      ]\n}\n</code></pre>\n\n<p>After changed into this, it works well:</p>\n\n<pre><code>{\n      \"version\": 2,\n      \"timeout\": \"3000ms\",\n      \"cache_ttl\": \"300s\",\n      \"name\": \"myapi\",\n      \"output_encoding\": \"json\",\n      \"port\": 4321,\n      \"endpoints\": [\n          {\n              \"endpoint\": \"/api/v1/me/profile\",\n              \"method\": \"GET\",\n              \"headers_to_pass\": [ \"*\" ],\n              \"output_encoding\": \"no-op\",\n              \"concurrent_calls\": 1,\n              \"backend\": [\n                  {\n                      \"url_pattern\": \"/api/me/profile\",\n                      \"encoding\": \"no-op\",\n                      \"host\": [\n                          \"http://123.45.67.89:4321\"\n                      ]\n                 }\n             ]\n          },\n          {\n              \"endpoint\": \"/api/v1/user/{uid}/profile\",\n              \"method\": \"GET\",\n              \"headers_to_pass\": [ \"*\" ],\n              \"querystring_params\": [ \"*\" ],\n              \"output_encoding\": \"no-op\",\n              \"concurrent_calls\": 1,\n              \"backend\": [\n                  {\n                      \"url_pattern\": \"/api/user/{uid}/profile\",\n                      \"encoding\": \"no-op\",\n                      \"host\": [\n                          \"http://123.45.67.89:4321\"\n                      ]\n                  }\n              ]\n          }\n      ]\n}\n</code></pre>\n\n<p>Regards.</p>\n"}], "owner": {"reputation": 197, "user_id": 622029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5e37efc9a7e2f24782b23beb56854c?s=128&d=identicon&r=PG", "display_name": "yuwono95", "link": "https://stackoverflow.com/users/622029/yuwono95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 598, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560074313, "creation_date": 1560060097, "question_id": 56512345, "link": "https://stackoverflow.com/questions/56512345/how-to-configure-krakend-json-to-forward-parameterized-url", "title": "How to configure krakend.json to forward parameterized url?", "body": "<p>Basically I just want to forward this request:</p>\n\n<blockquote>\n  <p><a href=\"http://somehost:4321/api/v1/\" rel=\"nofollow noreferrer\">http://somehost:4321/api/v1/</a>{uid}/profile</p>\n</blockquote>\n\n<p>into this:</p>\n\n<blockquote>\n  <p><a href=\"http://123.45.67.89:4321/api/\" rel=\"nofollow noreferrer\">http://123.45.67.89:4321/api/</a>{uid}/profile</p>\n</blockquote>\n\n<p>I've done this in krakend.json:</p>\n\n<pre><code>{\n      \"version\": 2,\n      \"timeout\": \"3000ms\",\n      \"cache_ttl\": \"300s\",\n      \"name\": \"myapi\",\n      \"output_encoding\": \"json\",\n      \"port\": 4321,\n      \"endpoints\": [\n          {\n              \"endpoint\": \"/api/v1/{uid}/profile\",\n              \"method\": \"GET\",\n              \"headers_to_pass\": [ \"*\" ],\n              \"querystring_params\": [ \"*\" ],\n              \"output_encoding\": \"no-op\",\n              \"concurrent_calls\": 1,\n              \"backend\": [\n                  {\n                      \"url_pattern\": \"/api/{uid}/profile\",\n                      \"encoding\": \"no-op\",\n                      \"host\": [\n                          \"http://123.45.67.89:4321\"\n                      ]\n                  }\n              ]\n          }\n      ]\n}\n</code></pre>\n\n<p>But ends up with error:</p>\n\n<blockquote>\n  <p>panic: wildcard route ':uid' conflicts with existing children in path '/api/v1/:uid/profile'</p>\n</blockquote>\n\n<p>Any clue?</p>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1560178432, "post_id": 56512227, "comment_id": 99640794, "body": "The linked code is using calls from <code>Kernel32.dll</code>, you can do the same using <code>cgo</code>. How to actually do that is a bigger question than can be answered sufficiently on SO, you&#39;ll probably just have to experiment with it if you can&#39;t find any existing resources."}], "owner": {"reputation": 11, "user_id": 11620551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876842af3816a2fea68c3c855abf0d10?s=128&d=identicon&r=PG&f=1", "display_name": "legonporto", "link": "https://stackoverflow.com/users/11620551/legonporto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560078778, "creation_date": 1560058403, "last_edit_date": 1560078778, "question_id": 56512227, "link": "https://stackoverflow.com/questions/56512227/how-to-read-and-write-low-level-raw-disk-in-windows-and-go", "title": "How to read and write (Low Level) raw disk in Windows and Go", "body": "<p>I want to know, how should must be access to the raw drive in Windows and Go.</p>\n\n<p>I found <a href=\"https://stackoverflow.com/questions/21032426/low-level-disk-i-o-in-golang\">this</a> for Linux, but I ask for Windows.</p>\n\n<p>For example to clear what is ask I need to read and write MBR sector in windows (512 Bytes)</p>\n\n<p>For more clear what I ask, I want to do this on Go\n<a href=\"https://code.msdn.microsoft.com/windowsapps/CCS-LABS-C-Low-Level-Disk-91676ca9\" rel=\"nofollow noreferrer\">https://code.msdn.microsoft.com/windowsapps/CCS-LABS-C-Low-Level-Disk-91676ca9</a> (C#)</p>\n\n<p>Just a little more example code in C</p>\n\n<pre><code>HANDLE MasterBootRecord = CreateFile(\"\\\\\\\\.\\\\PhysicalDrive0\", GENERIC_ALL, FILE_SHARE_READ | FILE_SHARE_WRITE,      //Get a handle on the MBR File\n    NULL, OPEN_EXISTING, NULL, NULL);\n</code></pre>\n\n<p>Final: Read! and Write! raw disk drive in windows. I select to read which sector(s) and write too!</p>\n"}, {"tags": ["sql", "go", "orm"], "comments": [{"owner": {"reputation": 7554, "user_id": 700471, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/ebb4cc58c1fce4f22abc59a1226ee8e2?s=128&d=identicon&r=PG", "display_name": "Matt Mc", "link": "https://stackoverflow.com/users/700471/matt-mc"}, "edited": false, "score": 0, "creation_date": 1597696060, "post_id": 56511909, "comment_id": 112212931, "body": "I believe your question has been answered, even if it&#39;s not quite as convenient as some might like.  Would you mind accepting the answer?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12211419"}, "edited": false, "score": 0, "creation_date": 1582783162, "post_id": 56552811, "comment_id": 106897646, "body": "Yikes, the select should work here without the LiteUser struct but I guess it don&#39;t work"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12211419"}, "edited": false, "score": 0, "creation_date": 1582783206, "post_id": 56552811, "comment_id": 106897667, "body": "Use a map instead of a struct, my guess"}], "tags": [], "owner": {"reputation": 2217, "user_id": 2604708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b62fe48f9c75ebe5e3868f9d428c125?s=128&d=identicon&r=PG", "display_name": "Dirbaio", "link": "https://stackoverflow.com/users/2604708/dirbaio"}, "is_accepted": false, "score": 1, "last_activity_date": 1560295440, "creation_date": 1560295440, "answer_id": 56552811, "question_id": 56511909, "link": "https://stackoverflow.com/questions/56511909/sqlboiler-get-only-the-desired-columns/56552811#56552811", "title": "Sqlboiler get only the desired columns", "body": "<p>You get all the fields, because you get instances of <code>models.User</code>, which have all the fields, you want them or not.</p>\n\n<p>One thing you can do is write your own cut-down <code>User</code> struct, and bind to that.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type LiteUser struct {\n  ID int `boil:\"id\"`\n  Name string `boil:\"name\"`\n}\n\nvar users []*LiteUser\nerr := models.Users(\n  Select(\"id\", \"name\"),\n  Where(\"age &gt; ?\", 30),\n).Bind(ctx, db, &amp;users)\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 840821, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/aS3yN.jpg?s=128&g=1", "display_name": "Vikas Goel", "link": "https://stackoverflow.com/users/840821/vikas-goel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560295440, "creation_date": 1560053641, "last_edit_date": 1560118756, "question_id": 56511909, "link": "https://stackoverflow.com/questions/56511909/sqlboiler-get-only-the-desired-columns", "title": "Sqlboiler get only the desired columns", "body": "<p>I am trying to follow the examples in sqlboiler (<a href=\"https://github.com/volatiletech/sqlboiler\" rel=\"nofollow noreferrer\">https://github.com/volatiletech/sqlboiler</a>). But couldn't find a way to get just the columns queried in the select statement?</p>\n\n<pre><code>users, err := models.Users(\n  Select(\"id\", \"name\"),\n  Where(\"age &gt; ?\", 30),\n).All(ctx, db)\n</code></pre>\n\n<p>In this example, <code>.All</code> returns entire tuple containing empty/nil values of columns not queried. I was wondering if there is a way to return a map/list (or any relevant data structure/format) of just the queried columns. Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1560063238, "post_id": 56511723, "comment_id": 99611570, "body": "Those stacktraces look the same to me. What is your question?"}, {"owner": {"reputation": 4117, "user_id": 2272326, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d77a05612d6a5cb020dccbdbcbd596ac?s=128&d=identicon&r=PG", "display_name": "Dave Pile", "link": "https://stackoverflow.com/users/2272326/dave-pile"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1560075643, "post_id": 56511723, "comment_id": 99613667, "body": "@Volker- I dont think they look the same. I have updated the question to point out what I consider differences. Maybe I am reasing it wrong, but they are not identical outputs"}], "owner": {"reputation": 4117, "user_id": 2272326, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d77a05612d6a5cb020dccbdbcbd596ac?s=128&d=identicon&r=PG", "display_name": "Dave Pile", "link": "https://stackoverflow.com/users/2272326/dave-pile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560075575, "creation_date": 1560050315, "last_edit_date": 1560075575, "question_id": 56511723, "link": "https://stackoverflow.com/questions/56511723/golang-stack-trace-different-output-when-run-in-debug-vs-build-and-run", "title": "Golang Stack Trace different output when run in Debug vs Build and Run", "body": "<p>I have some code mostly copied from <a href=\"https://github.com/go-errors/errors\" rel=\"nofollow noreferrer\">https://github.com/go-errors/errors</a> which generates a Stack Trace</p>\n\n<p>When I run it in VSCode debugger the output is exactly as expected. File names and function names are correct.</p>\n\n<p><strong>Debug Output</strong></p>\n\n<pre><code>C:/work/projects/go/src/errtest/customerrors.go:17 (0x4d149f)\n    NewDbError: dbe.stacktrace = NewStackTrace()\nC:/work/projects/go/src/errtest/errortest04a.go:6 (0x4d156f)\n    errorTest04a: err := NewDbError(\"This is a db error\")\nC:/work/projects/go/src/errtest/errortest04.go:4 (0x4d1507)\n    errorTest04: errorTest04a()\nC:/work/projects/go/src/errtest/main.go:4 (0x4d16b7)\n    main: errorTest04()\nC:/Go/src/runtime/proc.go:200 (0x431bc1)\n    main: fn()\nC:/Go/src/runtime/asm_amd64.s:1337 (0x458bc1)\n    goexit: BYTE    $0x90   // NOP\n</code></pre>\n\n<p>When I build and run the same code however the output is not correct.</p>\n\n<p><strong>Build Output</strong></p>\n\n<pre><code>C:/work/projects/go/src/errtest/customerrors.go:17 (0x4a5dbe)\n        errorTest04a: dbe.stacktrace = NewStackTrace()\nC:/work/projects/go/src/errtest/customerrors.go:17 (0x4a5db9)\n        NewDbError: dbe.stacktrace = NewStackTrace()\nC:/work/projects/go/src/errtest/errortest04.go:4 (0x4a5e88)\n        main: errorTest04a()\nC:/work/projects/go/src/errtest/errortest04.go:4 (0x4a5e83)\n        errorTest04: errorTest04a()\nC:/Go/src/runtime/proc.go:200 (0x42d5ac)\n        main: fn()\nC:/Go/src/runtime/asm_amd64.s:1337 (0x452911)\n        goexit: BYTE    $0x90   // NOP\n</code></pre>\n\n<p><strong>Question:</strong> </p>\n\n<p>Why does the code generate different output depending on whether run in Debug or build?</p>\n\n<p>The top entry in the Debug Output correctly shows the last caller as function <code>NewDbError</code> and the line <code>dbe.stacktrace = NewStackTrace()</code> in file <code>customerrors.go:17</code></p>\n\n<p>The top entry in Build Output shows the same details but function name <code>errorTest04a</code> which is not in the file ``customerrors.go<code>but in the file</code>errorTest04a.go`</p>\n\n<p>The second line in the Build output shows what appears as the first line in the Debug output</p>\n\n<p>The third line in the build output shows the wrong function name <code>main</code></p>\n\n<p>It seems pretty weird that the same code generates different output. </p>\n\n<p><strong>End Question</strong></p>\n\n<p>I was thinking perhaps the compile removed file names but they are there, just in an incorrect order and with the function names out of order too.</p>\n\n<p>If anyone can shed some light it would be appreciated. Thanks</p>\n\n<p>Here is the code I have used</p>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\nfunc main() {\n    errorTest04()\n}\n</code></pre>\n\n<p><strong>errortest04.go</strong></p>\n\n<pre><code>package main\n\nfunc errorTest04() {\n    errorTest04a()\n}\n</code></pre>\n\n<p><strong>errortest04a.go</strong>\n    package main</p>\n\n<pre><code>import \"fmt\"\n\nfunc errorTest04a() {\n    err := NewDbError(\"This is a db error\")\n\n    fmt.Print(string(err.stacktrace.Stack()))\n}\n</code></pre>\n\n<p><strong>customerorrs.go</strong></p>\n\n<pre><code>package main\n\n// DbError is a custom error that holds a dberror\ntype DbError struct {\n    stacktrace *StackTrace\n\n    errmsg string\n}\n\nfunc (e *DbError) Error() string {\n    return e.errmsg\n}\n\n// NewDbError returns a new DbError\nfunc NewDbError(e string) DbError {\n    dbe := DbError{errmsg: e}\n    dbe.stacktrace = NewStackTrace()\n    return dbe\n}\n</code></pre>\n\n<p><strong>stacktrace.go</strong> - lifted from <a href=\"https://github.com/go-errors/errors\" rel=\"nofollow noreferrer\">https://github.com/go-errors/errors</a> </p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"runtime\"\n    \"strings\"\n)\n\nconst maxStackDepth = 50\n\n// StackTrace holds the stack data\ntype StackTrace struct {\n    callers    []uintptr\n    callerslen int\n    frames     []StackFrame\n}\n\n// Stack - returns a formatted Stack Trace\nfunc (st *StackTrace) Stack() []byte {\n    buf := bytes.Buffer{}\n\n    for _, frame := range st.frames {\n        buf.WriteString(frame.String())\n    }\n\n    return buf.Bytes()\n}\n\n// NewStackTrace creates a new stack object\nfunc NewStackTrace() *StackTrace {\n    st := StackTrace{}\n    st.callers = make([]uintptr, maxStackDepth)\n    st.callerslen = runtime.Callers(2, st.callers[:])\n\n    st.frames = make([]StackFrame, st.callerslen)\n\n    for i := range st.frames {\n        st.frames[i] = newStackFrame(st.callers[i])\n    }\n\n    return &amp;st\n}\n\n// StackFrame - details of a caller. Lifted from https://github.com/go-errors/errors/blob/master/stackframe.go\ntype StackFrame struct {\n    // The path to the file containing this ProgramCounter\n    File string\n    // The LineNumber in that file\n    LineNumber int\n    // The Name of the function that contains this ProgramCounter\n    FnName string\n    // The Package that contains this function\n    Package string\n    // The underlying ProgramCounter\n    ProgramCounter uintptr\n}\n\nfunc newStackFrame(pc uintptr) StackFrame {\n\n    frame := StackFrame{ProgramCounter: pc}\n    if frame.Func() == nil {\n        return frame\n    }\n\n    frame.Package, frame.FnName = packageAndName(frame.Func())\n\n    // pc -1 because the program counters we use are usually return addresses,\n    // and we want to show the line that corresponds to the function call\n    // frame.File, frame.LineNumber = frame.Func().FileLine(pc)\n    frame.File, frame.LineNumber = frame.Func().FileLine(pc - 1)\n    return frame\n}\n\n// Func returns the function that contained this frame.\nfunc (frame *StackFrame) Func() *runtime.Func {\n    if frame.ProgramCounter == 0 {\n        return nil\n    }\n    return runtime.FuncForPC(frame.ProgramCounter)\n}\n\n// SourceLine gets the line of code (from File and Line) of the original source if possible.\nfunc (frame *StackFrame) SourceLine() (string, error) {\n    data, err := ioutil.ReadFile(frame.File)\n    // _ replace with err\n\n    if err != nil {\n        return \"\", err\n    }\n\n    lines := bytes.Split(data, []byte{'\\n'})\n    if frame.LineNumber &lt;= 0 || frame.LineNumber &gt;= len(lines) {\n        return \"???\", nil\n    }\n    // -1 because line-numbers are 1 based, but our array is 0 based\n    return string(bytes.Trim(lines[frame.LineNumber-1], \" \\t\")), nil\n}\n\n// String returns the stackframe formatted in the same way as go does\n// in runtime/debug.Stack()\nfunc (frame *StackFrame) String() string {\n    str := fmt.Sprintf(\"%s:%d (0x%x)\\n\", frame.File, frame.LineNumber, frame.ProgramCounter)\n\n    source, err := frame.SourceLine()\n    if err != nil {\n        return str\n    }\n\n    return str + fmt.Sprintf(\"\\t%s: %s\\n\", frame.FnName, source)\n}\n\nfunc packageAndName(fn *runtime.Func) (string, string) {\n    name := fn.Name()\n    pkg := \"\"\n\n    // The name includes the path name to the package, which is unnecessary\n    // since the file name is already included.  Plus, it has center dots.\n    // That is, we see\n    //  runtime/debug.*T\u00b7ptrmethod\n    // and want\n    //  *T.ptrmethod\n    // Since the package path might contains dots (e.g. code.google.com/...),\n    // we first remove the path prefix if there is one.\n    if lastslash := strings.LastIndex(name, \"/\"); lastslash &gt;= 0 {\n        pkg += name[:lastslash] + \"/\"\n        name = name[lastslash+1:]\n    }\n    if period := strings.Index(name, \".\"); period &gt;= 0 {\n        pkg += name[:period]\n        name = name[period+1:]\n    }\n\n    name = strings.Replace(name, \"\u00b7\", \".\", -1)\n    return pkg, name\n}\n</code></pre>\n"}, {"tags": ["sql", "go", "orm", "sqlboiler"], "comments": [{"owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "edited": false, "score": 0, "creation_date": 1560047302, "post_id": 56511449, "comment_id": 99609734, "body": "Not familiar with sqlboiler, but I know that most ORMs do not really have support for variable column or table names. However you can use string interpolation (<code>fmt.Sprintf</code>), but make sure that you are very careful about checking for valid values since this can lead to SQL injection vulnerabilities. (You can sanitize by checking that the given value is one of a select few)."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 9996904, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MIcXgduHr2k/AAAAAAAAAAI/AAAAAAAADwA/kDW_BbPXuig/photo.jpg?sz=128", "display_name": "Juan Torres", "link": "https://stackoverflow.com/users/9996904/juan-torres"}, "is_accepted": true, "score": 1, "last_activity_date": 1560050112, "creation_date": 1560050112, "answer_id": 56511713, "question_id": 56511449, "link": "https://stackoverflow.com/questions/56511449/sqlboiler-get-table-name-for-join/56511713#56511713", "title": "SQLBoiler get table name for Join", "body": "<p>The table names are in the <code>TableNames</code> struct, which is in the file <code>boil_table_names.go</code></p>\n\n<p>So, I think it would be something like this <code>models.TableNames.CreditCards</code></p>\n"}], "owner": {"reputation": 729, "user_id": 840821, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/aS3yN.jpg?s=128&g=1", "display_name": "Vikas Goel", "link": "https://stackoverflow.com/users/840821/vikas-goel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 56511713, "answer_count": 1, "score": 0, "last_activity_date": 1600991283, "creation_date": 1560045969, "last_edit_date": 1600991283, "question_id": 56511449, "link": "https://stackoverflow.com/questions/56511449/sqlboiler-get-table-name-for-join", "title": "SQLBoiler get table name for Join", "body": "<p>I am trying to follow the examples in sqlboiler (<a href=\"https://github.com/volatiletech/sqlboiler\" rel=\"nofollow noreferrer\">https://github.com/volatiletech/sqlboiler</a>). But, I can't find a way to get the table name used in the Inner join query.</p>\n\n<pre><code>users, err := models.Users(\n  Select(\"id\", \"name\"),\n  InnerJoin(\"credit_cards c on c.user_id = users.id\"),\n  Where(\"age &gt; ?\", 30),\n  AndIn(\"c.kind in ?\", \"visa\", \"mastercard\"),\n  Or(\"email like ?\", `%aol.com%`),\n  GroupBy(\"id\", \"name\"),\n  Having(\"count(c.id) &gt; ?\", 2),\n  Limit(5),\n  Offset(6),\n).All(ctx, db)\n</code></pre>\n\n<p>In this example, if, instead of hard-coding the name (<code>credit_cards</code>), I could provide the table name, it'd be great.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["amazon-web-services", "go", "struct", "amazon-iam"], "answers": [{"comments": [{"owner": {"reputation": 108, "user_id": 3226398, "user_type": "registered", "profile_image": "https://graph.facebook.com/825608468/picture?type=large", "display_name": "Nihanth Dara", "link": "https://stackoverflow.com/users/3226398/nihanth-dara"}, "edited": false, "score": 0, "creation_date": 1560072770, "post_id": 56513340, "comment_id": 99613119, "body": "i like this approach too."}, {"owner": {"reputation": 3171, "user_id": 1200874, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/142d4e98b4befc3e20c8bf0d83ebec6d?s=128&d=identicon&r=PG", "display_name": "tommy_o", "link": "https://stackoverflow.com/users/1200874/tommy-o"}, "edited": false, "score": 0, "creation_date": 1560446787, "post_id": 56513340, "comment_id": 99749368, "body": "This works quite well.  I haven&#39;t accepted it as the answer yet because, it turns out, that the AWS PolicyDocument can be either <code>StatementEntry</code> or <code>[]StatementEntry</code>.  Using the solutions provided here, I&#39;ve been trying to solve that myself before updating the question and accepting your answer."}, {"owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "edited": false, "score": 0, "creation_date": 1560451846, "post_id": 56513340, "comment_id": 99751674, "body": "You should be able to do a similar thing for structs as well as strings in this example, let me know if it doesn&#39;t work for you and I can have a play"}], "tags": [], "owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "is_accepted": false, "score": 3, "last_activity_date": 1560071438, "creation_date": 1560071438, "answer_id": 56513340, "question_id": 56511229, "link": "https://stackoverflow.com/questions/56511229/unmarshal-aws-iam-document-but-conditional-string-or-string-in-doc/56513340#56513340", "title": "Unmarshal AWS IAM Document But Conditional string or []string in Doc", "body": "<p>You can achieve this by using a custom type for the slice with an Unmarshal method that first unmarshals to an empty interface and then determines if it is a slice or a single string:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n    \"errors\"\n)\n\ntype container struct {\n    Field customSlice\n}\n\ntype customSlice []string\n\nfunc (c *customSlice) UnmarshalJSON(data []byte) error {\n    var tmp interface{}\n    err := json.Unmarshal(data, &amp;tmp)\n    if err != nil {\n        return err\n    }\n    slice, ok := tmp.([]interface{})\n    if ok {\n        for _, item := range slice {\n            *c = append(*c, item.(string))\n        }\n        return nil\n    }\n    theString, ok := tmp.(string)\n    if ok {\n        *c = append(*c, theString)\n        return nil\n    }\n    return errors.New(\"Field neither slice or string\")\n}\n\nfunc main() {\n    jsonInputSlice := `{\"Field\":[\"a\"]}`\n    jsonInputString := `{\"Field\":\"a\"}`\n    var containerSlice container\n    var containerString container\n    err := json.Unmarshal([]byte(jsonInputSlice), &amp;containerSlice)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(containerSlice)\n    err = json.Unmarshal([]byte(jsonInputString), &amp;containerString)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(containerString)\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/mAhJBNhE1yc\" rel=\"nofollow noreferrer\">https://play.golang.org/p/mAhJBNhE1yc</a></p>\n"}, {"tags": [], "owner": {"reputation": 108, "user_id": 3226398, "user_type": "registered", "profile_image": "https://graph.facebook.com/825608468/picture?type=large", "display_name": "Nihanth Dara", "link": "https://stackoverflow.com/users/3226398/nihanth-dara"}, "is_accepted": false, "score": 1, "last_activity_date": 1560072709, "creation_date": 1560072709, "answer_id": 56513472, "question_id": 56511229, "link": "https://stackoverflow.com/questions/56511229/unmarshal-aws-iam-document-but-conditional-string-or-string-in-doc/56513472#56513472", "title": "Unmarshal AWS IAM Document But Conditional string or []string in Doc", "body": "<p>You can do this in multiple ways. One of the way is you define <code>Resource</code> as <code>interface{}</code> and do the parsing later. Playground - <a href=\"https://play.golang.org/p/PiLaa0DySEj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/PiLaa0DySEj</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n)\n\ntype PolicyDocument struct {\n    Version   string\n    Statement []StatementEntry\n}\n\ntype StatementEntry struct {\n    Effect   string\n    Action   []string\n    Resource interface{}\n}\n\nfunc main() {\n\n    data := `{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"VisualEditor0\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ssm:PutParameter\",\n                \"ssm:DeleteParameter\",\n                \"ssm:DescribeInstancePatchStates\",\n                \"elasticloadbalancing:RegisterTargets\",\n                \"elasticloadbalancing:DescribeTargetHealth\",\n                \"elasticloadbalancing:DescribeTargetGroups\",\n                \"elasticloadbalancing:DeregisterTargets\",\n                \"ssm:GetParameter\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}`\n\n    convertPolicy(data)\n\n    data = `{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Action\": [\n                \"s3:ListBucket\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": [\n                \"arn:aws:s3:::SageMaker\"\n            ]\n        },\n        {\n            \"Action\": [\n                \"s3:GetObject\",\n                \"s3:PutObject\",\n                \"s3:DeleteObject\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": [\n                \"arn:aws:s3:::SageMaker/*\"\n            ]\n        }\n    ]\n}`\n\n    convertPolicy(data)\n\n}\n\nfunc convertPolicy(data string) {\n    var doc PolicyDocument\n    err1 := json.Unmarshal([]byte(data), &amp;doc)\n\n    if err1 != nil {\n        fmt.Println(err1)\n    }\n\n    //find out the type of resource string or []string\n    for _, statement := range doc.Statement {\n        fmt.Println(\"statement.Resource was of type - \", reflect.TypeOf(statement.Resource))\n        if reflect.TypeOf(statement.Resource).Name() != \"string\" {\n            // we will convert the []interface to []string\n            x := statement.Resource.([]interface{})\n            y := make([]string, len(x))\n            for i := 0; i &lt; len(x); i++ {\n                y[i] = x[i].(string)\n            }\n            statement.Resource = y\n            fmt.Println(\"statement.Resource is converted to type - \", reflect.TypeOf(statement.Resource))\n        }\n    }\n\n    fmt.Printf(\"\\n----\\n%v\\n---\\n\", doc)\n}\n</code></pre>\n"}], "owner": {"reputation": 3171, "user_id": 1200874, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/142d4e98b4befc3e20c8bf0d83ebec6d?s=128&d=identicon&r=PG", "display_name": "tommy_o", "link": "https://stackoverflow.com/users/1200874/tommy-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1560072709, "creation_date": 1560042120, "question_id": 56511229, "link": "https://stackoverflow.com/questions/56511229/unmarshal-aws-iam-document-but-conditional-string-or-string-in-doc", "title": "Unmarshal AWS IAM Document But Conditional string or []string in Doc", "body": "<p>I'm working through the IAM policy <a href=\"https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/iam-example-policies.html\" rel=\"nofollow noreferrer\">examples</a> for the AWS Go SDK and trying to do the opposite of the <code>Create Policy</code> example -- basically, get all of the IAM policy in the account, get the default policy versions, then unmarshal that json document into a struct so it is easily parsed.</p>\n\n<p>I got this far but I'm stuck with how go handles a conditional struct type.  In the AWS policy doc version response, the json data for <code>StatementEntry</code> can be <code>string</code> or <code>[]string</code> depending on the doc.</p>\n\n<p>What would be a best practice?  Add another struct and use retry logic in the error handling?</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/iam\"\n    \"log\"\n    \"net/url\"\n)\n\ntype PolicyDocument struct {\n    Version   string\n    Statement []StatementEntry\n}\n\ntype StatementEntry struct {\n    Effect   string\n    Action   []string\n    Resource []string\n}\n\nfunc main() {\n    sess, _ := session.NewSession(&amp;aws.Config{\n        Region: aws.String(\"us-west-2\")},\n    )\n\n    svc := iam.New(sess)\n\n    fmt.Printf(\"%s - %s\\n\", arn, *result.Policy.Description)\n\n    results, _ := svc.ListPolicies(&amp;iam.ListPoliciesInput{})\n\n    for _, policy := range results.Policies {\n\n        arn := policy.Arn\n        version := policy.DefaultVersionId\n\n        pv, _ := svc.GetPolicyVersion(&amp;iam.GetPolicyVersionInput{\n            PolicyArn: arn,\n            VersionId: version,\n        })\n\n        decodedValue, err := url.QueryUnescape(aws.StringValue(pv.PolicyVersion.Document))\n        if err != nil {\n            log.Fatal(err)\n            return\n        }\n        //fmt.Println(decodedValue)\n\n        data := []byte(decodedValue)\n\n        var doc PolicyDocument\n        err1 := json.Unmarshal(data, &amp;doc)\n\n        if err1 != nil {\n            log.Fatal(err1)\n        }\n\n        fmt.Printf(\"\\n----\\n%v\\n---\\n\", doc)\n    }\n}\n</code></pre>\n\n<p>Example <code>PolicyDocuments</code> are this:</p>\n\n<pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"VisualEditor0\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ssm:PutParameter\",\n                \"ssm:DeleteParameter\",\n                \"ssm:DescribeInstancePatchStates\",\n                \"elasticloadbalancing:RegisterTargets\",\n                \"elasticloadbalancing:DescribeTargetHealth\",\n                \"elasticloadbalancing:DescribeTargetGroups\",\n                \"elasticloadbalancing:DeregisterTargets\",\n                \"ssm:GetParameter\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n</code></pre>\n\n<p>And this (for <code>Resource []string</code> in the <code>StatementEntry</code>):</p>\n\n<pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Action\": [\n                \"s3:ListBucket\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": [\n                \"arn:aws:s3:::SageMaker\"\n            ]\n        },\n        {\n            \"Action\": [\n                \"s3:GetObject\",\n                \"s3:PutObject\",\n                \"s3:DeleteObject\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": [\n                \"arn:aws:s3:::SageMaker/*\"\n            ]\n        }\n    ]\n}\n</code></pre>\n"}, {"tags": ["go", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "is_accepted": true, "score": 0, "last_activity_date": 1560034909, "creation_date": 1560034909, "answer_id": 56510734, "question_id": 56510682, "link": "https://stackoverflow.com/questions/56510682/does-gin-gonic-support-get-request/56510734#56510734", "title": "Does gin-gonic support get request?", "body": "<p>The function you are looking for is not <code>Param()</code>, it's <code>Query()</code>.</p>\n\n<p><a href=\"https://github.com/gin-gonic/gin#querystring-parameters\" rel=\"nofollow noreferrer\">https://github.com/gin-gonic/gin#querystring-parameters</a></p>\n"}], "owner": {"reputation": 9, "user_id": 7847931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b6a838ab058b2080ab63b01e746e94?s=128&d=identicon&r=PG&f=1", "display_name": "cocobot", "link": "https://stackoverflow.com/users/7847931/cocobot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1227, "favorite_count": 0, "accepted_answer_id": 56510734, "answer_count": 1, "score": -1, "last_activity_date": 1560034909, "creation_date": 1560034210, "question_id": 56510682, "link": "https://stackoverflow.com/questions/56510682/does-gin-gonic-support-get-request", "title": "Does gin-gonic support get request?", "body": "<p>I am new in gin-gonic framework and i have been trying to read the values from the inputs that i added in a get request from html but i have not been able to read the values that i wrote.</p>\n\n<p>When i submit the request the browser sends this url : \n<a href=\"http://localhost:3000/backend?name1=value1&amp;name2=value2&amp;name3=value3\" rel=\"nofollow noreferrer\">http://localhost:3000/backend?name1=value1&amp;name2=value2&amp;name3=value3</a></p>\n\n<p>I have been looking in the internet where gin-gonic uses this url type but i have only found that it uses url like this one \n<a href=\"http://localhost:3000/backend/value1\" rel=\"nofollow noreferrer\">http://localhost:3000/backend/value1</a></p>\n\n<p>html code:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt;\n    &lt;title&gt;Document&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form method=\"GET\" action=\"/backend\"&gt;\n        &lt;input id=\"store\" name=\"name1\" type=\"text\"&gt;\n        &lt;input id=\"razon\" name=\"name2\" type=\"text\"&gt;\n        &lt;input id=\"total\" name=\"name3\" type=\"text\"&gt;\n        &lt;input type=\"submit\" value=\"submit\"&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>golang code:</p>\n\n<pre><code>package main\n\nimport(\n\"net/http\"\n\"fmt\"\n\"github.com/gin-gonic/contrib/static\"\n\"github.com/gin-gonic/gin\"\n )\n\nfunc main(){\nrouter := gin.Default()\n\nrouter.Use(static.Serve(\"/\",static.LocalFile(\"./views\",true)))\n\nrouter.GET(\"/backend\",func(c *gin.Context){\n    fmt.Println(c.Param(\"name1\"))\n    c.JSON(http.StatusOK, gin.H{\n        \"name1\" : c.Param(\"name1\"),\n    })\n})\n\n\nrouter.Run(\":3000\")\n}\n</code></pre>\n\n<p>Actual result:\n    {\"name1\":\"\"}</p>\n\n<p>Expected result:\n    {\"name1\":\"value1\"}</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 644, "user_id": 5744883, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4e17219364956c469a3a4c1dfa469d35?s=128&d=identicon&r=PG&f=1", "display_name": "Parnab Sanyal", "link": "https://stackoverflow.com/users/5744883/parnab-sanyal"}, "edited": false, "score": 0, "creation_date": 1560027012, "post_id": 56510007, "comment_id": 99607006, "body": "have you tried doing <code>go build</code> and then executing the <code>.exe</code> file?"}, {"owner": {"reputation": 49, "user_id": 4209919, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001499688086/picture?type=large", "display_name": "Sayantan Ghosh", "link": "https://stackoverflow.com/users/4209919/sayantan-ghosh"}, "reply_to_user": {"reputation": 644, "user_id": 5744883, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4e17219364956c469a3a4c1dfa469d35?s=128&d=identicon&r=PG&f=1", "display_name": "Parnab Sanyal", "link": "https://stackoverflow.com/users/5744883/parnab-sanyal"}, "edited": false, "score": 0, "creation_date": 1560027084, "post_id": 56510007, "comment_id": 99607024, "body": "@ParnabSanyal Yes I have tried doing that and I am getting the same results in the Windows 10 PC."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1560027537, "post_id": 56510007, "comment_id": 99607118, "body": "Don\u2019t ignore the errors, windows uses <code>\\r\\n</code> for newlines."}, {"owner": {"reputation": 49, "user_id": 4209919, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001499688086/picture?type=large", "display_name": "Sayantan Ghosh", "link": "https://stackoverflow.com/users/4209919/sayantan-ghosh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1560027592, "post_id": 56510007, "comment_id": 99607130, "body": "I am not getting any errors in the terminal @JimB"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1560027674, "post_id": 56510007, "comment_id": 99607151, "body": "You\u2019re ignoring the error value from <code>ParseInt</code>. Try printing the literal string you read."}, {"owner": {"reputation": 49, "user_id": 4209919, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001499688086/picture?type=large", "display_name": "Sayantan Ghosh", "link": "https://stackoverflow.com/users/4209919/sayantan-ghosh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1560027701, "post_id": 56510007, "comment_id": 99607155, "body": "@JimB It worked when I added \\r\\n. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 644, "user_id": 5744883, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4e17219364956c469a3a4c1dfa469d35?s=128&d=identicon&r=PG&f=1", "display_name": "Parnab Sanyal", "link": "https://stackoverflow.com/users/5744883/parnab-sanyal"}, "edited": false, "score": 1, "creation_date": 1560028145, "post_id": 56510112, "comment_id": 99607247, "body": "beautifully explained"}], "tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 8, "last_activity_date": 1560028097, "last_edit_date": 1560028097, "creation_date": 1560027711, "answer_id": 56510112, "question_id": 56510007, "link": "https://stackoverflow.com/questions/56510007/golang-program-giving-incorrect-result-in-windows-10/56510112#56510112", "title": "Golang program giving incorrect result in Windows 10", "body": "<p>While UNIX (and Linux) have a line ending of <code>\\n</code> Windows has a line ending of <code>\\r\\n</code>. This means that the line you've read on Linux is <code>1 2 3\\n</code> while on Windows it is <code>1 2 3\\r\\n</code>. If you now remove the <code>\\n</code> (i.e. <code>strings.Trim(text, \"\\n\")</code>) and split by space you get <code>1</code>, <code>2</code> and <code>3</code> on Linux but you'll get <code>1</code>, <code>2</code>, <code>3\\r</code> on Windows.</p>\n\n<p><code>ParseInt</code> on <code>3\\r</code> returns <code>0</code> and likely returns an error - which you explicitly ignore. That's why you get the output of <code>1</code>, <code>2</code> and <code>0</code> on Windows. Also, the array on Windows will be printed as <code>[1 2 3\\r]</code>. Since <code>\\r</code> sets the output cursor to the beginning of the current line and does not move to the next line (that's what <code>\\n</code> would do) this effectively overrides the initial <code>[</code> with the final <code>]</code>, resulting on a visible output of <code>] 1 2 3</code>. </p>\n"}], "owner": {"reputation": 49, "user_id": 4209919, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001499688086/picture?type=large", "display_name": "Sayantan Ghosh", "link": "https://stackoverflow.com/users/4209919/sayantan-ghosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 56510112, "answer_count": 1, "score": 2, "last_activity_date": 1560028097, "creation_date": 1560026676, "question_id": 56510007, "link": "https://stackoverflow.com/questions/56510007/golang-program-giving-incorrect-result-in-windows-10", "title": "Golang program giving incorrect result in Windows 10", "body": "<p>First of all, I am a newbie to Go programming. I have a simple Golang program which is giving the correct output in Linux environment but not in my Windows 10 PC.</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter text: \")\n    text, _ := reader.ReadString('\\n')\n    tarr := strings.Split(strings.Trim(text, \"\\n\"), \" \")\n\n    for i := 0; i &lt; len(tarr); i++ {\n        num, _ := strconv.ParseInt(tarr[i], 10, 32)\n        fmt.Println(num)\n    }\n\n    fmt.Println(tarr)\n    reader.ReadString('\\n')\n}\n</code></pre>\n\n<p>If I enter 1 2 3 as input from the terminal, I am getting the following output in Windows 10 (go version go1.12.5 windows/amd64):</p>\n\n<pre><code>1\n2\n0\n]1 2 3\n</code></pre>\n\n<p>I am getting the following output in Linux Elementary OS (go version go1.12.5 linux/amd64)</p>\n\n<pre><code>1\n2\n3\n[1 2 3]\n</code></pre>\n\n<p>Can anyone explain why this is happening?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21, "user_id": 4094273, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HGaY3VxpgNE/AAAAAAAAAAI/AAAAAAAAAEo/HhgqKLWBO1A/photo.jpg?sz=128", "display_name": "gballa", "link": "https://stackoverflow.com/users/4094273/gballa"}, "edited": false, "score": 0, "creation_date": 1560259425, "post_id": 56509632, "comment_id": 99680286, "body": "You may need an Adapter or something."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 1, "creation_date": 1560276508, "post_id": 56509632, "comment_id": 99680725, "body": "<a href=\"https://golang.org/doc/contribute.html\" rel=\"nofollow noreferrer\">golang.org/doc/contribute.html</a>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1560288673, "post_id": 56509632, "comment_id": 99685453, "body": "@MichaelHampton kind of true..."}], "answers": [{"comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1560288629, "post_id": 56547246, "comment_id": 99685440, "body": "yes money package is a good alternative. I have added a call within init(). the json approach is overkill."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1560290820, "last_edit_date": 1560290820, "creation_date": 1560267506, "answer_id": 56547246, "question_id": 56509632, "link": "https://stackoverflow.com/questions/56509632/how-to-add-new-currency-support-to-golang-org-x-text-currency/56547246#56547246", "title": "how to add new currency support to golang.org/x/text/currency", "body": "<p>Considering the Currency Unit represents <a href=\"https://en.wikipedia.org/wiki/ISO_4217\" rel=\"nofollow noreferrer\">ISO_4217</a>, and seems fairly complete, you can't extend it directly.</p>\n\n<p>You would need to go:</p>\n\n<ul>\n<li>either with a third-party package like <a href=\"https://github.com/Rhymond/go-money\" rel=\"nofollow noreferrer\"><code>Rhymond/go-money</code></a>, which could be more complete</li>\n<li>implement your own definition, as in <a href=\"https://github.com/thrasher-/gocryptotrader/tree/master/currency\" rel=\"nofollow noreferrer\"><code>thrasher-/gocryptotrader/currency</code></a>, where new currencies can be extended <a href=\"https://github.com/thrasher-/gocryptotrader/blob/master/config_example.json\" rel=\"nofollow noreferrer\">through a json config file</a>.<br>\nOr, as <a href=\"https://stackoverflow.com/users/4466350/mh-cbon\">mh-cbon</a> proposes <a href=\"https://stackoverflow.com/questions/56509632/how-to-add-new-currency-support-to-golang-org-x-text-currency/56547246#comment99685440_56547246\">in the comments</a>, through a call within <a href=\"https://golang.org/doc/effective_go.html#init\" rel=\"nofollow noreferrer\"><code>init()</code></a>.</li>\n</ul>\n"}], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1560290820, "creation_date": 1560023174, "last_edit_date": 1560024212, "question_id": 56509632, "link": "https://stackoverflow.com/questions/56509632/how-to-add-new-currency-support-to-golang-org-x-text-currency", "title": "how to add new currency support to golang.org/x/text/currency", "body": "<p>The package <code>golang.org/x/text/currency</code> is designed to handle currency standard printing implementation.</p>\n\n<p>It provides all the most common currencies via a bunch of <a href=\"https://godoc.org/golang.org/x/text/currency#Unit\" rel=\"nofollow noreferrer\">const currency.Unit</a> </p>\n\n<p>A <code>currency.Unit</code> is a struct to an <a href=\"https://github.com/golang/text/blob/master/currency/currency.go#L68\" rel=\"nofollow noreferrer\">uint index</a></p>\n\n<p>They refers to some data located under <code>internal</code> <a href=\"https://github.com/golang/text/tree/master/internal\" rel=\"nofollow noreferrer\">folder</a>.</p>\n\n<p>I want to add support for a new currency. How do I proceed ?</p>\n"}, {"tags": ["reactjs", "api", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1560024493, "post_id": 56509592, "comment_id": 99606424, "body": "The backend communicates with the frontend by writing to the <code>http.ResponseWriter</code> (your <code>writer</code>) which is what you are already doing with <code>json.NewEncoder(writer).Encode(books)</code>. Does that not work for you? <code>Encode</code> returns and error value, you should check if it&#39;s nil or not, and if not you should at least log it to know what it says."}, {"owner": {"reputation": 477, "user_id": 1771375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JLDWW.jpg?s=128&g=1", "display_name": "Lakshan Dissanayake", "link": "https://stackoverflow.com/users/1771375/lakshan-dissanayake"}, "edited": false, "score": 0, "creation_date": 1560028472, "post_id": 56509592, "comment_id": 99607313, "body": "show the response of <a href=\"http://localhost:3000/api/books\" rel=\"nofollow noreferrer\">localhost:3000/api/books</a>"}, {"owner": {"reputation": 51, "user_id": 11488851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f56ec36a34e67f8406ec2916d29b59?s=128&d=identicon&r=PG&f=1", "display_name": "Ling ling", "link": "https://stackoverflow.com/users/11488851/ling-ling"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1560028572, "post_id": 56509592, "comment_id": 99607339, "body": "It actually works! My bad, I wasn&#39;t actually calling the correct url from FE. @mkopriva"}], "owner": {"reputation": 51, "user_id": 11488851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f56ec36a34e67f8406ec2916d29b59?s=128&d=identicon&r=PG&f=1", "display_name": "Ling ling", "link": "https://stackoverflow.com/users/11488851/ling-ling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560022885, "creation_date": 1560022885, "question_id": 56509592, "link": "https://stackoverflow.com/questions/56509592/how-to-pass-api-response-from-backend-go-to-frontend-react", "title": "How to pass API response from Backend (Go) to frontend (React)?", "body": "<p>Fairly new backend, specifically in Go. I'm finding it very hard to understand how backend can/should communicate to the frontend, especially in.</p>\n\n<p>For example, I have a simple mock Books API in Go, which I'd like to pass the response from Go to React.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (...)\n\nvar books []Book\n\nfunc main() {\n    // initialize router\n    r := mux.NewRouter()\n\n    books = append(books, []Book{\n        {\n            ID: \"1\",\n            Isbn: \"23423\",\n            Title: \"Book 1\",\n            Author: &amp;Author{\n                FirstName: \"Nas\",\n                LastName: \"Ahm\",\n            },\n        },\n        {\n            ID: \"2\",\n            Isbn: \"97878\",\n            Title: \"Book 2\",\n            Author: &amp;Author{\n                FirstName: \"Has\",\n                LastName: \"Ahm\",\n            },\n        },\n    }...)\n\n    // router endpoints\n    r.HandleFunc(\"/api/books\", getBooks).Methods(\"GET\")\n\n    log.Fatal(http.ListenAndServe(\":3000\", r))\n\n}\n\nfunc getBooks(writer http.ResponseWriter, request *http.Request) {\n    writer.Header().Set(\"Content-Type\", \"application/json\")\n    json.NewEncoder(writer).Encode(books)\n}\n</code></pre>\n\n<p>So the question is, how do I pass the Books data to Frontend (react)?</p>\n"}, {"tags": ["go", "compiler-errors", "go-modules"], "comments": [{"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1560021631, "post_id": 56509105, "comment_id": 99605859, "body": "Your project seems to be inside your gopath, so you don&#39;t need to turn modules on. I don&#39;t think that you have a compile error, if the program compiles. So what is inside of your main files?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11140984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eed0e1b33279908b692904291500cb6?s=128&d=identicon&r=PG&f=1", "display_name": "ik9999", "link": "https://stackoverflow.com/users/11140984/ik9999"}, "edited": false, "score": 1, "creation_date": 1560021634, "post_id": 56509388, "comment_id": 99605861, "body": "Thank you. Setting package name to <code>main</code> in main.go files inside cmd directory fixed my problem. I had &quot;package c&quot; and &quot;package d&quot; there before."}], "tags": [], "owner": {"reputation": 108, "user_id": 3226398, "user_type": "registered", "profile_image": "https://graph.facebook.com/825608468/picture?type=large", "display_name": "Nihanth Dara", "link": "https://stackoverflow.com/users/3226398/nihanth-dara"}, "is_accepted": true, "score": 0, "last_activity_date": 1560021146, "creation_date": 1560021146, "answer_id": 56509388, "question_id": 56509105, "link": "https://stackoverflow.com/questions/56509105/error-building-go-project-with-cmd-structure-multiple-entry-points/56509388#56509388", "title": "Error building Go project with /cmd structure (multiple entry points)", "body": "<p>You can use <code>go install ./...</code> and it will create the executables in $GOPATH/bin directory if you are looking to get the executables</p>\n\n<p>And regarding the multiple compiler entry points, you can. You can build using <code>go build ./cmd/c ./cmd/d .</code> but you cannot get the executables as per the <a href=\"https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies\" rel=\"nofollow noreferrer\">GO Documentation</a> <code>-o</code> can be only used in the case of single package. Instead you can write a <a href=\"https://en.wikipedia.org/wiki/Makefile\" rel=\"nofollow noreferrer\">makefile</a> to get all the executables with a single make target.</p>\n\n<p>And regarding the error that you are seeing, I would need more information. When I tried to build a sample application, everything works fine. I am not using GO111MODULE flag though.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qPLIZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qPLIZ.png\" alt=\"enter image description here\"></a></p>\n\n<ol>\n<li><code>go build</code> gives me <em>stackoverflow</em> executable</li>\n<li><code>go build -o test ./cmd/c</code> gives me <em>test</em> executable</li>\n<li><code>go build ./cmd/c</code> gives me <em>c</em> executable</li>\n</ol>\n\n<p>For your convenience I uploaded the project to <a href=\"https://github.com/nihanthd/stackoverflow/tree/multiple-entry-points\" rel=\"nofollow noreferrer\">github repo</a> </p>\n"}], "owner": {"reputation": 33, "user_id": 11140984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eed0e1b33279908b692904291500cb6?s=128&d=identicon&r=PG&f=1", "display_name": "ik9999", "link": "https://stackoverflow.com/users/11140984/ik9999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 56509388, "answer_count": 1, "score": 0, "last_activity_date": 1560021146, "creation_date": 1560018337, "question_id": 56509105, "link": "https://stackoverflow.com/questions/56509105/error-building-go-project-with-cmd-structure-multiple-entry-points", "title": "Error building Go project with /cmd structure (multiple entry points)", "body": "<p>Here is the directory structure of my project (<code>~/go/src/bitbucket.org/a/b</code>):</p>\n\n<pre><code>\u251c\u2500\u2500 cmd\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 c\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 d\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 main.go\n\u251c\u2500\u2500 config\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 config.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 default.json\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 development.json\n\u251c\u2500\u2500 go.mod\n\u251c\u2500\u2500 go.sum\n\u251c\u2500\u2500 log\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 log.go\n\u251c\u2500\u2500 main.go\n</code></pre>\n\n<p>I need to compile 2 binaries (one for each module in cmd/).</p>\n\n<p>I have tried running <code>GO111MODULE=on go build ./cmd/c</code> from project root (<code>~/go/src/bitbucket.org/a/b</code>). It silently finishes without doing anything.</p>\n\n<p>I also tried running <code>GO111MODULE=on go build -o test ./cmd/c</code>. It created 29kb <code>test</code> file. When i add execution rights to it and run, it finishes with error:</p>\n\n<pre><code>./test: 2: ./test: Syntax error: newline unexpected\n</code></pre>\n\n<p>I have tried using go 1.12.5 and go 1.11.10.\nAlso when i put <code>main.go</code> file from any of the cmd directories to project root  directory and build, the compiler builds it just fine (binary file size is ~33mb).</p>\n\n<p>Is it possible to use 2 compiler entry points in a single project?</p>\n"}, {"tags": ["python", "django", "date", "go"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1560015915, "post_id": 56508711, "comment_id": 99604662, "body": "What is django datetime? Is it just a timestamp ? Why you dont use the unix timestamp?"}], "answers": [{"tags": [], "owner": {"reputation": 416, "user_id": 7242832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154ab9d73b4b094123b7e3631c7c7ce6?s=128&d=identicon&r=PG&f=1", "display_name": "biswa1991", "link": "https://stackoverflow.com/users/7242832/biswa1991"}, "is_accepted": false, "score": 0, "last_activity_date": 1560019379, "creation_date": 1560019379, "answer_id": 56509207, "question_id": 56508711, "link": "https://stackoverflow.com/questions/56508711/pass-a-django-datetime-to-a-golang-server-with-json/56509207#56509207", "title": "Pass a django datetime to a golang server with json", "body": "<p>by default django datetime field had timezone support. you need think other way . or you can use django-extentions . this third party package comes with a created and modified datetime field which is don't record timezone, use those two field you will get output like {0001-01-01 00:00:00 }</p>\n"}, {"tags": [], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "is_accepted": false, "score": 0, "last_activity_date": 1560021707, "creation_date": 1560021707, "answer_id": 56509457, "question_id": 56508711, "link": "https://stackoverflow.com/questions/56508711/pass-a-django-datetime-to-a-golang-server-with-json/56509457#56509457", "title": "Pass a django datetime to a golang server with json", "body": "<p>I've used a dirty trick to serialize the date : </p>\n\n<pre><code>def toJson(self):\n    ret = {}\n    date_handler = lambda obj: (\n        obj.isoformat()\n        if isinstance(obj, (datetime.datetime, datetime.date))\n        else None\n    )\n    ret[\"Created\"] = str(json.dumps(self.created, default=date_handler)).replace(\"\\\"\",\"\")\n    ret[\"Modified\"] = str(json.dumps(self.modified, default=date_handler)).replace(\"\\\"\",\"\")\n    ret[\"Used\"] = self.used\n    ret[\"Raw\"] = self.raw\n    return ret\n</code></pre>\n\n<p>I hope someone will find a better solution</p>\n"}, {"tags": [], "owner": {"reputation": 2219, "user_id": 3882744, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8bec02fe258d18391f277f7669df1c6c?s=128&d=identicon&r=PG&f=1", "display_name": "caot", "link": "https://stackoverflow.com/users/3882744/caot"}, "is_accepted": true, "score": 2, "last_activity_date": 1560095652, "last_edit_date": 1560095652, "creation_date": 1560095210, "answer_id": 56516027, "question_id": 56508711, "link": "https://stackoverflow.com/questions/56508711/pass-a-django-datetime-to-a-golang-server-with-json/56516027#56516027", "title": "Pass a django datetime to a golang server with json", "body": "<p>Here is a working example related to the question that could be helpful to someone in the future.</p>\n\n<p>server.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gin-contrib/cors\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/jmoiron/sqlx\"\n    \"gopkg.in/guregu/null.v3\"\n    \"strconv\"\n)\n\n\ntype RawOffer struct {\n    Used_f        bool          `json:\"Used_f\"`\n    Used_t        bool          `json:\"Used_t\"`\n    RawOfferData  string        `json:\"Raw\"`\n    Modified      null.Time     `json:\"Modified\"`\n    Created       null.Time     `json:\"Created\"`\n}\n\nfunc convert(c *gin.Context) {\n    var rawOffer RawOffer\n    c.BindJSON(&amp;rawOffer)\n\n    fmt.Println(`Used_f       = ` + strconv.FormatBool(rawOffer.Used_f))\n    fmt.Println(`Used_t       = ` + strconv.FormatBool(rawOffer.Used_t))\n    fmt.Println(`RawOfferData = `, rawOffer.RawOfferData)\n    fmt.Println(`Modified     = `, rawOffer.Modified)\n    fmt.Println(`Created      = `, rawOffer.Created)\n}\n\n\nvar db *sqlx.DB\nfunc main() {\n    fmt.Println(\"begin\")\n    r := gin.Default()\n    r.Use(cors.Default())\n\n    r.POST(\"/convert/\", convert)\n    r.Run((\":8087\"))\n}\n</code></pre>\n\n<p>test.py</p>\n\n<pre><code>import requests\nimport json\nimport datetime\n\n\ndef default(o):\n    if isinstance(o, (datetime.date, datetime.datetime)):\n        return o.isoformat() + 'Z'\n\ntry :\n    data = dict(\n        Created = datetime.datetime.utcnow(),\n        Modified = datetime.datetime.utcnow(),\n        Used_f = False,\n        Used_t = True,\n        Raw = 'some raw data here',\n    )\n\n    datastr = json.dumps(data, default=default)\n\n    print(datastr)\n    requests.post(\"http://127.0.0.1:8087/convert/\", datastr)\nexcept Exception as e:\n    print(e)\n</code></pre>\n\n<p>Log on test.py:</p>\n\n<pre><code>$ python test.py\n{\"Created\": \"2019-06-09T15:48:38.978230Z\", \"Modified\": \"2019-06-09T15:48:38.978689Z\", \"Used_f\": false, \"Used_t\": true, \"Raw\": \"some raw data here\"}\n</code></pre>\n\n<p>Log on Server:</p>\n\n<pre><code>begin\n[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.\n\n[GIN-debug] [WARNING] Running in \"debug\" mode. Switch to \"release\" mode in production.\n - using env:   export GIN_MODE=release\n - using code:  gin.SetMode(gin.ReleaseMode)\n\n[GIN-debug] POST   /convert/                 --&gt; main.convert (4 handlers)\n[GIN-debug] Listening and serving HTTP on :8087\n\nUsed_f       = false\nUsed_t       = true\nRawOfferData =  some raw data here\nModified     =  {2019-06-09 15:48:38.978689 +0000 UTC true}\nCreated      =  {2019-06-09 15:48:38.97823 +0000 UTC true}\n[GIN] 2019/06/09 - 11:48:39 |[97;42m 200 [0m|   16.979399ms |       127.0.0.1 |[97;46m POST    [0m /convert/\n</code></pre>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 56516027, "answer_count": 3, "score": 0, "last_activity_date": 1560095652, "creation_date": 1560015300, "last_edit_date": 1560048773, "question_id": 56508711, "link": "https://stackoverflow.com/questions/56508711/pass-a-django-datetime-to-a-golang-server-with-json", "title": "Pass a django datetime to a golang server with json", "body": "<blockquote>\n  <p>Here is my django model</p>\n</blockquote>\n\n<pre class=\"lang-py prettyprint-override\"><code>class Data(models.Model):\n    created = models.DateTimeField(null=True, blank=True, editable=False)\n    modified = models.DateTimeField(null=True, blank=True)\n    raw = models.TextField(null=True, blank=True)\n    uuid = models.CharField(blank=True, null=True, max_length=48,unique=True)\n    used = models.BooleanField(default=False,null=True)\n    name = models.CharField(blank=True, null=True, max_length=200)\n    geohash = models.CharField(blank=True, null=True, max_length=200)\n    def __str__(self):\n        return str(self.created) + \":\" + str(self.raw)\n\n    def __unicode__(self):\n        return str(self.created) + \":\" + str(self.raw)\n\n    def save(self, *args, **kwargs):\n        \"\"\" On save, update timestamps \"\"\"\n        if not self.uuid :\n            self.uuid = str(uuid.uuid4().hex) +str(random.randint(1000,9999) )\n        if not self.id:\n            self.created = timezone.now()\n        self.modified = timezone.now()\n        # if not self.geoHash and (self.gpsLat and self.gpsLong):\n        # Geohash.encode(self.gpsLat, self.gpsLong)\n        return super(DataLbc, self).save(*args, **kwargs)\n    def toJson(self):\n        ret = {}\n        ret[\"Created\"] = str(self.created)\n        ret[\"Modified\"] = str(self.modified)\n        ret[\"Used\"] = self.used\n        ret[\"Raw\"] = self.raw\n        return ret\n</code></pre>\n\n<blockquote>\n  <p>Here is the way that i send it to my golang server :</p>\n</blockquote>\n\n<pre class=\"lang-py prettyprint-override\"><code>from RawOffer.models import Data\nwhile True:\n    try :\n        for data in Data.objects.all()[:10]:\n            requests.post(\"http://127.0.0.1:8087/convert/\",json=data.toJson())\n    except Exception as e:\n        print(e)\n    time.sleep(5)\n</code></pre>\n\n<blockquote>\n  <p>Now my golang server : </p>\n</blockquote>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    \"github.com/gin-contrib/cors\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/jmoiron/sqlx\"\n    \"github.com/lib/pq\"\n    \"strings\"\n    \"gopkg.in/guregu/null.v3\"\n)\n\ntype RawOffer struct {\n    RawOfferData string  `json:\"Raw\"`\n    Modified      null.Time    `json:\"Modified\"`\n    Created       null.Time    `json:\"Created\"`\n}\n\nfunc convertLbc(c *gin.Context) {\n    var rawOffer RawOffer\n    c.BindJSON(&amp;rawOffer)\n    fmt.Println(rawOffer.Created)\n    var err error\n    s := strings.Split(rawOffer.RawOfferData, `\"ads\": `)\n\n    s2 := `{ \"ads\": ` + s[1]\n    result := strings.Replace(s2, `, \"status\": \"ready\"}]`, ``, -1)\n    //fmt.Println(result)\n    var rawOfferLbc RawOfferLbc\n    if err = json.Unmarshal([]byte(result), &amp;rawOfferLbc); err != nil {\n        fmt.Println(result)\n        panic(err)\n    }\n}\n\nvar db *sqlx.DB\nfunc main() {\n    var err error\n    fmt.Println(\"begin\")\n    r := gin.Default()\n    r.Use(cors.Default())\n    r.POST(\"/convert/\",convert)\n    r.Run((\":8087\"))\n}\n</code></pre>\n\n<p>but for Created and modified when i try to receive it i have <code>{0001-01-01 00:00:00 +0000 UTC false}</code></p>\n\n<p>How to serialize a django datetime to send it in json and how to get it in golang?</p>\n\n<p>My main goal so is to send an object with the date from the django app to a microservice in golang. So I need to serialize the django date and I need to write a lot of text because stackoverflow won't let me post my program if i don't write enough text ...</p>\n\n<p>Regards</p>\n"}, {"tags": ["python", "go", "base32"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1560017609, "post_id": 56508660, "comment_id": 99605035, "body": "FYI... there is no need to base64-encode a hash that is in hexadecimal format. Such a character set <code>[0-9] [a-f]</code> is safe to send over any protocol."}, {"owner": {"reputation": 13, "user_id": 11619016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b648c754cb13ecf4e93fd18f488c4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/11619016/will"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1560017947, "post_id": 56508660, "comment_id": 99605110, "body": "thanks for the comment. The original code is kube-router is computing an identifier for use in ipsets in iptables. it is not used to send over any protocol, just to construct a safe identifier to use in the kernel."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11619016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b648c754cb13ecf4e93fd18f488c4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/11619016/will"}, "edited": false, "score": 0, "creation_date": 1560018791, "post_id": 56509125, "comment_id": 99605290, "body": "I have basically no experience with/understanding of go -- certainly contributing to the problem. I read the docs, but am not seeing the problem. Is there a code suggestion for could give to get the python code to yield the same base32 encoding, please?"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 13, "user_id": 11619016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b648c754cb13ecf4e93fd18f488c4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/11619016/will"}, "edited": false, "score": 0, "creation_date": 1560024773, "post_id": 56509125, "comment_id": 99606478, "body": "cpburnz gave you a direct example but just digest() instead of hexdigest()."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1560018497, "creation_date": 1560018497, "answer_id": 56509125, "question_id": 56508660, "link": "https://stackoverflow.com/questions/56508660/cannot-get-python-to-follow-go-in-base32-encoding/56509125#56509125", "title": "Cannot get python to follow go in base32 encoding", "body": "<p>The go version isn\u2019t base32 encoding the hex version of the digest. It encodes the raw form. You\u2019re printing the hex form differently on each side.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11619016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b648c754cb13ecf4e93fd18f488c4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/11619016/will"}, "edited": false, "score": 0, "creation_date": 1560027979, "post_id": 56509646, "comment_id": 99607216, "body": "Thanks! I tried a bunch of different casts/transforms before putting into base32 encode. I did not try the .encode(&#39;hex&#39;) -- that was just what I was missing!"}], "tags": [], "owner": {"reputation": 15679, "user_id": 369450, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5cf82bfcd75a3bd40deaad83f7657c59?s=128&d=identicon&r=PG&f=1", "display_name": "All Workers Are Essential", "link": "https://stackoverflow.com/users/369450/all-workers-are-essential"}, "is_accepted": true, "score": 3, "last_activity_date": 1560024013, "last_edit_date": 1560024013, "creation_date": 1560023364, "answer_id": 56509646, "question_id": 56508660, "link": "https://stackoverflow.com/questions/56508660/cannot-get-python-to-follow-go-in-base32-encoding/56509646#56509646", "title": "Cannot get python to follow go in base32 encoding", "body": "<p>On the Python side you're getting the SHA256 hash hex-encoded, and then base32 encoding the hexadecimal digits. To fix it, use the following:</p>\n\n<pre><code>sha256 = hashlib.sha256()\nsha256.update(namespace+policyName)\nchksum = sha256.digest() # Get hash as byte string\nprint chksum.encode('hex') # Convert byte string to hexadecimal for printing\nprint base64.b32encode(chksum)\nprint base64.b32encode(bytearray(\"abc\"))\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11619016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b648c754cb13ecf4e93fd18f488c4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/11619016/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 56509646, "answer_count": 2, "score": 1, "last_activity_date": 1560193044, "creation_date": 1560014974, "last_edit_date": 1560193044, "question_id": 56508660, "link": "https://stackoverflow.com/questions/56508660/cannot-get-python-to-follow-go-in-base32-encoding", "title": "Cannot get python to follow go in base32 encoding", "body": "<p>I am trying to replicate a base32 encoding of a sha256 hash from go in python. I am trying to replicate the logic by which kube-router creates ipset names for namespace-networkpolicies: <a href=\"https://github.com/cloudnativelabs/kube-router/blob/736757d942f173e19566eea0a512dfa819699126/pkg/controllers/netpol/network_policy_controller.go#L1476\" rel=\"nofollow noreferrer\">https://github.com/cloudnativelabs/kube-router/blob/736757d942f173e19566eea0a512dfa819699126/pkg/controllers/netpol/network_policy_controller.go#L1476</a></p>\n\n<p>I just cannot get python to yield the same base32 output. I am probably doing something obviously wrong. Help! </p>\n\n<p>Go Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"crypto/sha256\"\n    \"encoding/base32\"\n)\n\nfunc main() {\n    namespace := \"my-ns\"\n    policyName := \"default-deny\"\n\n    chksum := sha256.Sum256([]byte(namespace + policyName))\n    fmt.Printf(\"%x\\n\", chksum)\n    fmt.Println(base32.StdEncoding.EncodeToString(chksum[:]))\n    fmt.Println(base32.StdEncoding.EncodeToString([]byte(\"abc\")))\n}\n</code></pre>\n\n<p>running this yields:</p>\n\n<pre><code>dd684919ef4a1362b841409f5255ec963bd53d353804114779c4e6d66641eb28\n3VUESGPPJIJWFOCBICPVEVPMSY55KPJVHACBCR3ZYTTNMZSB5MUA====\nMFRGG===\n</code></pre>\n\n<p>Python Code:</p>\n\n<pre><code>#!/usr/bin/env python\n\nimport hashlib\nimport base64\n\nnamespace = \"my-ns\"\npolicyName = \"default-deny\"\n\nsha256 = hashlib.sha256()\nsha256.update(namespace+policyName)\nchksum = sha256.hexdigest()\nprint chksum\nprint base64.b32encode(chksum)\nprint base64.b32encode(bytearray(\"abc\"))\n</code></pre>\n\n<p>running this yields:</p>\n\n<pre><code>dd684919ef4a1362b841409f5255ec963bd53d353804114779c4e6d66641eb28\nMRSDMOBUHEYTSZLGGRQTCMZWGJRDQNBRGQYDSZRVGI2TKZLDHE3DGYTEGUZWIMZVGM4DANBRGE2DONZZMM2GKNTEGY3DMNBRMVRDEOA=\nMFRGG===\n</code></pre>\n\n<p>The first lines of output in each agree, which is good. lets me know that the sha256 checksum is being computed the same on each side. The second line on each doesn't agree, I do not understand why -- I have tried many different casts of the chksum in the python code to no avail. The third line in each just suggests that a base32 encoding of a simple string seems to work on both sides.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1560015434, "post_id": 56507564, "comment_id": 99604562, "body": "You start a goroutine with the <code>go</code> keyword, but you obviously already know that. So what do you have trouble with, exactly?"}, {"owner": {"reputation": 1, "user_id": 11618622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1742f913b0965efe54adc718a0db9bf?s=128&d=identicon&r=PG&f=1", "display_name": "ThePlatypus", "link": "https://stackoverflow.com/users/11618622/theplatypus"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1560018153, "post_id": 56507564, "comment_id": 99605166, "body": "I know that I can start dataProcessor(output) in goroutine but I&#39;m not sure if spawning like 2000 goroutines in a second to proces every single line is a good idea. I would prefer to put all lines in some queue and process this queue in second goroutine. There is also second problem with goroutine, they don&#39;t guarantee me correct order."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1560020277, "post_id": 56507564, "comment_id": 99605611, "body": "I wasn&#39;t suggesting to create one goroutine per line. Send the lines to a single goroutine that does the processing using a buffered channels. If channels are new to you, see <a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow noreferrer\">The Tour</a> and maybe <a href=\"https://gobyexample.com/channels\" rel=\"nofollow noreferrer\">Go by Example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1742, "user_id": 6142150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6518cc1347db7055f0b133c794ab01c?s=128&d=identicon&r=PG", "display_name": "Maxim Kosov", "link": "https://stackoverflow.com/users/6142150/maxim-kosov"}, "edited": false, "score": 1, "creation_date": 1560172966, "post_id": 56526116, "comment_id": 99638040, "body": "Can you please format your code nicely? Also, in <code>for true</code> loop <code>true</code> is not needed and <code>continue</code> inside select won&#39;t work, better to use <code>return</code> here."}], "tags": [], "owner": {"reputation": 353, "user_id": 3593762, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cF6wa1FSnfQ/AAAAAAAAAAI/AAAAAAAAAAU/hbSKP7G8_s8/photo.jpg?sz=128", "display_name": "Ali Zohrevand", "link": "https://stackoverflow.com/users/3593762/ali-zohrevand"}, "is_accepted": false, "score": 0, "last_activity_date": 1560230992, "last_edit_date": 1560230992, "creation_date": 1560168493, "answer_id": 56526116, "question_id": 56507564, "link": "https://stackoverflow.com/questions/56507564/non-blocking-way-to-read-from-a-pipe/56526116#56526116", "title": "Non-blocking way to read from a Pipe", "body": "<p>You can have two goroutines, one supplier and other is a consumer. supplier execute a command and pass data with a channel to the consumer.</p>\n\n<pre><code>    cmd := exec.Command(\"someapp\")\n    stdoutPipe, _ := cmd.StdoutPipe()\n    stdoutReader := bufio.NewReader(stdoutPipe)\n    Datas := make(chan Data, 100)\n    go dataProcessor(Datas)\n        bufioReader := bufio.NewReader(stdoutReader)\n        for {\n            output, _, err := bufioReader.ReadLine()\n            var tempData Data\n            tempData.Out = output\n            if err != nil || err == io.EOF {\n                break\n            }\n            Datas &lt;- tempData\n            }\n    }\n</code></pre>\n\n<p>and then you will prccess data in dataProcessor func:</p>\n\n<pre><code>func dataProcessor(Datas &lt;-chan Data)  {\n    for  {\n        select {\n        case data := &lt;-Datas:\n        fmt.Println(data)\n        default:\n            continue\n        }\n    }\n}\n</code></pre>\n\n<p>obviesly it is very simple example and you should customize it and make it better. search about chanle and goroutins. reading <a href=\"https://gobyexample.com/channels\" rel=\"nofollow noreferrer\">this</a> tutorial could be helpfull.</p>\n"}], "owner": {"reputation": 1, "user_id": 11618622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1742f913b0965efe54adc718a0db9bf?s=128&d=identicon&r=PG&f=1", "display_name": "ThePlatypus", "link": "https://stackoverflow.com/users/11618622/theplatypus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 763, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560230992, "creation_date": 1560006528, "question_id": 56507564, "link": "https://stackoverflow.com/questions/56507564/non-blocking-way-to-read-from-a-pipe", "title": "Non-blocking way to read from a Pipe", "body": "<p>I want to create a simple app which will be reading continuously output from one app, process it and write processed output to stdout. This app can produce a lot of data within a second and next is silent for a few minutes. </p>\n\n<p>The problem is that mine data processing algorithm is quite slow so main loop is blocked. When the loop is blocked I'm loosing a data which comes and this moment.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    cmd := exec.Command(\"someapp\")\n    stdoutPipe, _ := cmd.StdoutPipe()\n    stdoutReader := bufio.NewReader(stdoutPipe)\n\n    go func() {\n        bufioReader := bufio.NewReader(stdoutReader)\n        for {\n            output, _, err := bufioReader.ReadLine()\n            if err != nil || err == io.EOF {\n                break\n            }\n\n            processedOutput := dataProcessor(output);\n\n            fmt.Print(processedOutput)\n        }\n    }()\n</code></pre>\n\n<p>Probably the best way to solve this problem is to buffer all output and process it in another Goroutine but I'm not sure how to implement this in Golang. What is the most idiomatic way to solve this problem?</p>\n"}, {"tags": ["go", "kubernetes"], "comments": [{"owner": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1560011844, "post_id": 56506916, "comment_id": 99603706, "body": "Currently running pods as part of that job? Or completed ones?"}, {"owner": {"reputation": 11, "user_id": 11618378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/092e6f84985d2ae7ff7ddba6cc9c71ea?s=128&d=identicon&r=PG&f=1", "display_name": "jamese", "link": "https://stackoverflow.com/users/11618378/jamese"}, "reply_to_user": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1560069608, "post_id": 56506916, "comment_id": 99612561, "body": "Completed ones.  I think my code marks the job for deletion but it seems like something else isn&#39;t being triggered to actually do the deletes."}, {"owner": {"reputation": 11, "user_id": 11618378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/092e6f84985d2ae7ff7ddba6cc9c71ea?s=128&d=identicon&r=PG&f=1", "display_name": "jamese", "link": "https://stackoverflow.com/users/11618378/jamese"}, "reply_to_user": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1560094056, "post_id": 56506916, "comment_id": 99617352, "body": "To add a little more context to this, I&#39;ll describe what I&#39;m trying to achieve. I&#39;m trying to write a go program that will take a video file and process it with ffmpeg as a k8s job.  I want the program to clean up the pods and jobs after itself. I can create the jobs but it&#39;s just the cleanup that&#39;s causing me issues."}, {"owner": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1560102326, "post_id": 56506916, "comment_id": 99619414, "body": "What version of k8s? Can you use <code>ttlSecondsAfterFinished</code> on the Job creation? Also requires the <code>TTLAfterFinished</code> feature gate. <a href=\"https://kubernetes.io/docs/concepts/workloads/controllers/ttlafterfinished/\" rel=\"nofollow noreferrer\">kubernetes.io/docs/concepts/workloads/controllers/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 11618378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/092e6f84985d2ae7ff7ddba6cc9c71ea?s=128&d=identicon&r=PG&f=1", "display_name": "jamese", "link": "https://stackoverflow.com/users/11618378/jamese"}, "reply_to_user": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1560142556, "post_id": 56506916, "comment_id": 99625974, "body": "I&#39;ve been testing this on Openshift 3.9 (so k8s 3.9). Thanks for the suggestion, but I&#39;d rather not have something that requires a feature gate as it should be possible without it."}, {"owner": {"reputation": 147, "user_id": 1543285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Sq5Wz.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/1543285/brian"}, "edited": false, "score": 0, "creation_date": 1571673252, "post_id": 56506916, "comment_id": 103310107, "body": "that&#39;s not the foreground option &quot;fg := metav1.DeletePropagationBackground&quot;"}], "owner": {"reputation": 11, "user_id": 11618378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/092e6f84985d2ae7ff7ddba6cc9c71ea?s=128&d=identicon&r=PG&f=1", "display_name": "jamese", "link": "https://stackoverflow.com/users/11618378/jamese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 878, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560064453, "creation_date": 1560000979, "last_edit_date": 1560064453, "question_id": 56506916, "link": "https://stackoverflow.com/questions/56506916/deleting-a-job-with-client-go", "title": "Deleting a job with client-go", "body": "<p>Does anyone have any examples of how to delete k8s jobs using client-go?\nI've tried the following which deletes the job but leaves the pods behind:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>fg := metav1.DeletePropagationBackground\ndeleteOptions := metav1.DeleteOptions{PropagationPolicy: &amp;fg}\n\nif err := clientset.BatchV1().Jobs(\"default\").Delete(\"example-job\", &amp;deleteOptions); err != nil {\n    fmt.Printf(err)\n}\n</code></pre>\n\n<p>I've tried using the DeletePropagationForeground option, but that resulted in nothing being deleted.</p>\n"}, {"tags": ["html", "go"], "comments": [{"owner": {"reputation": 111, "user_id": 1542778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fc3444375d06a3f970671917ffdb42?s=128&d=identicon&r=PG", "display_name": "jesusnoseq", "link": "https://stackoverflow.com/users/1542778/jesusnoseq"}, "edited": false, "score": 0, "creation_date": 1560026247, "post_id": 56506255, "comment_id": 99606823, "body": "Make sure that you are doing a POST request.  In my case this works <a href=\"https://play.golang.org/p/-IBJ4RPvB5j\" rel=\"nofollow noreferrer\">play.golang.org/p/-IBJ4RPvB5j</a>"}], "answers": [{"tags": [], "owner": {"reputation": 534, "user_id": 6192935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-WzVJWA1aLts/AAAAAAAAAAI/AAAAAAAABfQ/FxZhI2PBCBA/photo.jpg?sz=128", "display_name": "Manish Champaneri", "link": "https://stackoverflow.com/users/6192935/manish-champaneri"}, "is_accepted": false, "score": 0, "last_activity_date": 1560150937, "creation_date": 1560150937, "answer_id": 56522070, "question_id": 56506255, "link": "https://stackoverflow.com/questions/56506255/unable-to-take-input-form-data-as-variable-in-golang/56522070#56522070", "title": "Unable to take input form data as variable in Golang", "body": "<pre><code>  } else {\n        fmt.Println(\"forgotPostHandler\")\n        request.ParseForm()\n        fmt.Println(\"email:\", request.Form[\"email\"]) // -- Problem is here\n    }\n</code></pre>\n\n<p>You are using requst.Form[xxx]. <strong><em>Use r.FormValue(\"email\") instead of request.Form[\"email\"]</em></strong></p>\n\n<p>You code should be</p>\n\n<pre><code>  } else {\n            fmt.Println(\"forgotPostHandler\")\n            request.ParseForm()\n            fmt.Println(\"email:\", r.FormValue(\"email\")) // -- Solution is here\n        }\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 9867528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Gautam Sardana", "link": "https://stackoverflow.com/users/9867528/gautam-sardana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560150937, "creation_date": 1559995944, "question_id": 56506255, "link": "https://stackoverflow.com/questions/56506255/unable-to-take-input-form-data-as-variable-in-golang", "title": "Unable to take input form data as variable in Golang", "body": "<p>I want to take this input form 'email' value as a variable in Go. But I am unable to do so.</p>\n\n<p>My html code: </p>\n\n<pre><code>&lt;form class=\"login100-form validate-form\" role=\"form\" \n                        action=\"/forgot\" method=\"POST\"&gt;\n\n&lt;input class=\"input100\" type=\"email\" name=\"email\"&gt;\n\n&lt;input type=\"submit\" value=\"Send Token\" class=\"login100-form-btn\"&gt;&lt;/form&gt;\n</code></pre>\n\n<p>My golang code:</p>\n\n<pre><code>\nfunc main() {\nrouter := newRouter()\nrouter.HandleFunc(\"/forgot\", forgotPageHandler)\n}\n\nfunc forgotPageHandler(writer http.ResponseWriter, request *http.Request) {\n\n    pInfo := PageInfo{\n        Title: \"Forgot\",\n    }\n    _, err := ActiveSession(writer, request)\n\n    if request.Method == \"GET\" {\n\n        fmt.Println(\"forgotGetHandler\")\n        if err != nil {\n            generateHTML(writer, pInfo, \"layout\", \"navPublic\", \"forgot\")\n        } else {\n            generateHTML(writer, pInfo, \"layout\", \"navPrivate\", \"forgot\")\n        }\n\n    } else {\n        fmt.Println(\"forgotPostHandler\")\n        request.ParseForm()\n        fmt.Println(\"email:\", request.Form[\"email\"])\n    }\n\n}\n\n</code></pre>\n\n<p>My request.method = GET is working while POST is not even reaching in the else clause.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11617986, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zc8_dggH3Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBKoIm39hYXjZett0cFOk4nd4_Og/mo/photo.jpg?sz=128", "display_name": "mikhels", "link": "https://stackoverflow.com/users/11617986/mikhels"}, "edited": false, "score": 0, "creation_date": 1560009068, "post_id": 56507572, "comment_id": 99603089, "body": "Awesome, HasZero method is almost exact what I need. @sanoJ, thank you!"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1560011674, "post_id": 56507572, "comment_id": 99603666, "body": "A YAML field may be set with an empty string <code>&quot;&quot;</code> - so the above check would give a false positive in this case. One may or may not care about this edge case. If one does, use a <code>*string</code> &amp; unmarshal will leave this <code>nil</code> for any missing fields."}], "tags": [], "owner": {"reputation": 1968, "user_id": 9263083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d74d9629591720e7e7bc8ddd3f35c92?s=128&d=identicon&r=PG&f=1", "display_name": "sanoJ", "link": "https://stackoverflow.com/users/9263083/sanoj"}, "is_accepted": true, "score": 0, "last_activity_date": 1560006591, "creation_date": 1560006591, "answer_id": 56507572, "question_id": 56506045, "link": "https://stackoverflow.com/questions/56506045/go-yaml-parsing-mandatory-fields/56507572#56507572", "title": "Go YAML parsing: mandatory fields", "body": "<p>You can use this <a href=\"https://godoc.org/github.com/fatih/structs\" rel=\"nofollow noreferrer\">library</a>'s <code>HasZero</code> method to check wether there are any missing values in a struct. This will return true or false depending wether the struct is completely filled or not. Please see the playground <a href=\"https://play.golang.org/p/VsQDGZZmaZI\" rel=\"nofollow noreferrer\">example</a> to get an idea.</p>\n\n<p>But if you specifically need to tell what field is missing, you need to check wether the value is nil like in the example below.</p>\n\n<pre><code>package main\nimport (\n   \"fmt\"\n   \"errors\"\n  \"gopkg.in/yaml.v2\"\n)\n\ntype TestStruct struct {\n  FieldA  string `yaml:\"a\"`\n  FieldB  string `yaml:\"b\"`\n}\n\nfunc main() {\n  input := []byte(`{a: 1}`)\n\n  var output TestStruct \n  if err := output.ParseFromFile(input); err != nil {\n     fmt.Println(err)\n  }\n  fmt.Println(output)     \n}\n\nfunc (output *TestStruct) ParseFromFile(data []byte) error {\n\n  if err := yaml.Unmarshal(data, output); err != nil {\n    return err\n  }\n\n  if output.FieldA == \"\" {\n    return errors.New(\"Blank Field A\")\n  }\n  if output.FieldB == \"\" {\n    return errors.New(\"Blank Field B\")\n  }\n\n  return nil\n}\n</code></pre>\n\n<p>Playground <a href=\"https://play.golang.org/p/caHzembswOu\" rel=\"nofollow noreferrer\">example</a> if you need to specifically return an error</p>\n"}], "owner": {"reputation": 3, "user_id": 11617986, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zc8_dggH3Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBKoIm39hYXjZett0cFOk4nd4_Og/mo/photo.jpg?sz=128", "display_name": "mikhels", "link": "https://stackoverflow.com/users/11617986/mikhels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 0, "accepted_answer_id": 56507572, "answer_count": 1, "score": 0, "last_activity_date": 1560006591, "creation_date": 1559994365, "question_id": 56506045, "link": "https://stackoverflow.com/questions/56506045/go-yaml-parsing-mandatory-fields", "title": "Go YAML parsing: mandatory fields", "body": "<p>Summary:\nI need to parse data in YAML format into golang struct. It there a way (library, attributes) to make some of the fields mandatory, i.e. to make Unmarshal function return the error in case if some field doesn't exist?</p>\n\n<p>Example what is wanted:\nUnmarshal function in this code should raise an error because input data doesn't contain 'b' field.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"gopkg.in/yaml.v2\"\n)\n\ntype TestStruct struct {\n    FieldA string `yaml:\"a\"`\n    FieldB string `yaml:\"b\"`\n}\n\nfunc main() {\n    input := []byte(`{a: 1}`)\n    var output TestStruct\n\n    _ = yaml.Unmarshal(input, &amp;output)\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1559994606, "post_id": 56505336, "comment_id": 99599654, "body": "You never break from this loop. Why do you have a <code>default:</code> in the <code>switch</code> statement? The <code>break</code> only breaks from the <code>switch</code>, but it\u2019s in a <code>default</code> so it does nothing."}, {"owner": {"reputation": 59, "user_id": 11543716, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SRB-pw6Qah0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdz6DsOACBMSFULvuqJEJdXAZr6Kg/mo/photo.jpg?sz=128", "display_name": "nickMason", "link": "https://stackoverflow.com/users/11543716/nickmason"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1560010475, "post_id": 56505336, "comment_id": 99603385, "body": "I thought the default case would be invoked when I stop getting results from both the channels"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1560015647, "post_id": 56505336, "comment_id": 99604609, "body": "What would it mean to \u201cstop getting results\u201d? It\u2019s either blocking waiting for values, or it isn\u2019t. The only way to indicate that there are no more values is to close the channels, but closing the channels results in non blocking reads as well, so the default wouldn\u2019t be useful then either."}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1559995719, "creation_date": 1559995719, "answer_id": 56506220, "question_id": 56505336, "link": "https://stackoverflow.com/questions/56505336/consuming-from-two-channels-simultaneously-leads-to-goroutines-hogging-up-my-ram/56506220#56506220", "title": "Consuming from two channels simultaneously leads to goroutines hogging up my RAM", "body": "<p>It is hard to say without profiling your program or, even better, tracing it. If you enable tracing you will easily see where your code allocates most of the memory.</p>\n\n<p>But there are two things one may notice from your implementation:</p>\n\n<ol>\n<li>Why cloning the objects? Are other goroutines accessing them? Otherwise you could just use the objects directly and avoid the cost of cloning.</li>\n<li>Are you sure that you need channels and goroutines to process <code>questions</code> and <code>rules</code> objects? It seems to me that in <code>cloneQuestions</code> function you don't perform any I/O operation, in fact you just clone the object and sent it to channel. Finally, you take those objects and append all of them into a single slice (that is <code>array</code>). Thus the algorithm looks like intrinsically sequential and you will not get any performance benefit from using concurrency.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 1, "last_activity_date": 1560013107, "last_edit_date": 1560013107, "creation_date": 1560012361, "answer_id": 56508331, "question_id": 56505336, "link": "https://stackoverflow.com/questions/56505336/consuming-from-two-channels-simultaneously-leads-to-goroutines-hogging-up-my-ram/56508331#56508331", "title": "Consuming from two channels simultaneously leads to goroutines hogging up my RAM", "body": "<p>As @JimB suggests, remove the <code>default</code> clause from the select statement, as it is causing a tight-loop, which pegs your CPU.</p>\n\n<p>Select's optional default allows for non-blocking polling of channels. In your case, you want to wait for either channel item. And in most use cases, blocking is better than polling.</p>\n\n<p>If you are worried the service may appear asleep due to blocking, you can add a timer channel to show liveliness e.g.</p>\n\n<pre><code>t := time.NewTicker(time.Minute)\nfor {\n    select {\n    case i := &lt;-ch:\n        log.Println(\"got item:\", i)\n    case &lt;-t.C:\n        log.Println(\"I'm not dead yet!\")\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/DmOK3AiyRu-\" rel=\"nofollow noreferrer\">playground</a></p>\n"}], "owner": {"reputation": 59, "user_id": 11543716, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SRB-pw6Qah0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdz6DsOACBMSFULvuqJEJdXAZr6Kg/mo/photo.jpg?sz=128", "display_name": "nickMason", "link": "https://stackoverflow.com/users/11543716/nickmason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562913852, "creation_date": 1559988120, "last_edit_date": 1562913852, "question_id": 56505336, "link": "https://stackoverflow.com/questions/56505336/consuming-from-two-channels-simultaneously-leads-to-goroutines-hogging-up-my-ram", "title": "Consuming from two channels simultaneously leads to goroutines hogging up my RAM", "body": "<p>I am quite new to concurrency and I decided to run a few parts of my http handler in goroutines and it started eating up my RAM and froze my computer.</p>\n\n<p>This is what I am trying to do:</p>\n\n<p>My handler has these two function calls</p>\n\n<pre><code>qChan := cloneQuestions(currentFormView.QuestionObjects, currentForm.Id, currentForm.VersionNumber, now)\n\nrChan := cloneRules(currentFormView.RuleObjects, currentForm.Id, currentForm.VersionNumber, now)\n</code></pre>\n\n<p>Both these function calls are defined in a file called helpers.go and they return channels of structs to their callers.</p>\n\n<p>This is the function definition of cloneQuestions and clonedRules follows the same pattern as this one</p>\n\n<pre><code>func cloneQuestions(questions []question.Model, formID string, versionNumber int, now time.Time) &lt;-chan question.Model {\n    out := make(chan question.Model)\n\n    go func() {\n        for _, currentQuestion := range questions {\n            out &lt;- getClonedQuestion(currentQuestion, formID, versionNumber, now)\n        }\n        close(out)\n    }()\n\n    return out\n}\n\n    func getClonedQuestion(currentQuestion question.Model, formID string, versionNumber int, now time.Time) question.Model {\n    newOptionsArray := cloneQuestionOptions(currentQuestion, formID, now)\n\n\n    return currentQuestion\n}\n</code></pre>\n\n<p><code>cloneRules</code> is very similar to this</p>\n\n<p>After calling these two functions in my handler and storing their returned channels in qChan and rChan variables as described above I run an infinite loop to consume values from both the channels simultaneously and break out of the loop once I stop receiving values from both the channels, here is the code</p>\n\n<pre><code>for {\n    select {\n    case clonedQuestion := &lt;-qChan:\n        insertQuestionToFormTxn := h.service.Mongo.GetAppendTxn(ctx, form.COLLECTION, currentForm.FormID, \"questions\", clonedQuestion.Id, clonedQuestion.Order)\n\n        newQuestionTxn := h.service.Mongo.GetNewTxn(ctx, question.COLLECTION, clonedQuestion, clonedQuestion.Id)\n        // collect all the txns in the arrray\n        array = append(array, insertQuestionToFormTxn, newQuestionTxn)\n    case clonedRule := &lt;-rChan:\n\n        newRuleTxn := h.service.Mongo.GetNewTxn(ctx, rule.COLLECTION, clonedRule, clonedRule.Id)\n        // collect all the txns in the arrray\n        array = append(array, insertRuleToFormTxn, newRuleTxn)\n    default:\n        break\n    }\n}\n</code></pre>\n\n<p>When I make a request to this handler and I run htop side by side I saw that it started filling up my RAM and froze my machine, why is this happening?</p>\n"}, {"tags": ["mongodb", "go"], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 10897835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fad722ff71d6330172fc91a8118022f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10897835/alex"}, "is_accepted": false, "score": 3, "last_activity_date": 1559964556, "creation_date": 1559964556, "answer_id": 56503188, "question_id": 56503108, "link": "https://stackoverflow.com/questions/56503108/go-mongodb-org-mongo-driver-insertone-with-nilvalueobjectid/56503188#56503188", "title": "go.mongodb.org/mongo-driver - InsertOne with NilValueObjectId", "body": "<p>I found the problem. I did not add ```omitempty` to the bson tag.</p>\n\n<p>It should be</p>\n\n<pre><code>type Account struct {\n    ID       primitive.ObjectID `json:\"id\" bson:\"_id,omitempty\"`\n    Email    string             `json:\"email\"`\n    Password string             `json:\"password\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 10897835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fad722ff71d6330172fc91a8118022f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10897835/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559979679, "creation_date": 1559963339, "last_edit_date": 1559979679, "question_id": 56503108, "link": "https://stackoverflow.com/questions/56503108/go-mongodb-org-mongo-driver-insertone-with-nilvalueobjectid", "title": "go.mongodb.org/mongo-driver - InsertOne with NilValueObjectId", "body": "<p>I have the following struct</p>\n\n<pre><code>type Account struct {\n    ID       primitive.ObjectID `json:\"id\" bson:\"_id\"`\n    Email    string             `json:\"email\"`\n    Password string             `json:\"password\"`\n}\n</code></pre>\n\n<p>and the following function</p>\n\n<pre><code>func (a *Account) Create() map[string]interface{} {\n\n    if resp, ok := a.Validate(); !ok {\n        return resp\n    }\n\n    hashedPassword, _ := bcrypt.GenerateFromPassword([]byte(a.Password), bcrypt.DefaultCost)\n    a.Password = string(hashedPassword)\n\n    users := db.Collection(\"users\")\n\n    insertResult, err := users.InsertOne(context.TODO(), a)\n\n    if err != nil {\n        return utils.Message(false, \"Error inserting user document \"+err.Error())\n    }\n\n      ... more code down hre\n}\n</code></pre>\n\n<p>The problem I am having is that I can insert the first account, but any account after that can't be inserted due to a dup key error on the _id field. I know that mongoDB will auto generate an _id field and will use the one provided if there is an id. In my case in this create function, the a.ID (_id) is always be NilValue <code>\"_id\" : ObjectId(\"000000000000000000000000\")</code></p>\n\n<p>Is there any way mongoDB can generate an _id for me even if I provide and ID field with the nil value?</p>\n\n<p>I need the <code>Account.ID `bson: \"_id\"`</code> property on there so I can decode it when I am reading from mongoDB such as</p>\n\n<pre><code>func GetUser(email string) *Account {\n        account := &amp;Account{}\n    users := db.Collection(\"users\")\n\n    filter := bson.D{{\"email\", email}}\n\n    if err := users.FindOne(context.TODO(), filter).Decode(&amp;account); err != nil {\n        return utils.Message(false, \"Error Retrieving account for \"+email)\n    }\n\n        // account.ID will be available due to the bson tag\n}\n</code></pre>\n\n<p>I'd appreciate some feedback if I am doing this wrong and how I could do this better. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "data-structures", "hashtable"], "answers": [{"comments": [{"owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "edited": false, "score": 0, "creation_date": 1559967390, "post_id": 56502897, "comment_id": 99595198, "body": "ok nice, i found the answer for the first question too: <a href=\"https://stackoverflow.com/a/15313681/1620210\">stackoverflow.com/a/15313681/1620210</a> (its about 170 bytes-ish per map)"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1559960521, "last_edit_date": 1559960521, "creation_date": 1559960025, "answer_id": 56502897, "question_id": 56502560, "link": "https://stackoverflow.com/questions/56502560/whats-the-memory-cost-overhead-of-declaring-one-empty-mapstringinterface-in/56502897#56502897", "title": "What&#39;s the memory cost/overhead of declaring one empty map[string]interface{} in golang?", "body": "<blockquote>\n  <p>why the <a href=\"https://play.golang.org/p/n8DzH082Myk\" rel=\"nofollow noreferrer\">creation cost is 0</a>?</p>\n</blockquote>\n\n<p>A Go stack allocation allocates zero bytes on the heap.</p>\n\n<pre><code>mp := map[byte]byte{}\n\nmain map[byte]byte literal does not escape\n</code></pre>\n\n<hr>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc main() {\n    var m1, m2 runtime.MemStats\n    var i byte\n\n    runtime.ReadMemStats(&amp;m1)\n    mp := map[byte]byte{}\n    runtime.ReadMemStats(&amp;m2)\n    fmt.Println(\"Bytes allocated on creation:\", m2.Alloc-m1.Alloc)\n    for i = 0; i &lt; 100; i++ {\n        runtime.ReadMemStats(&amp;m1)\n        mp[i] = i\n        runtime.ReadMemStats(&amp;m2)\n        fmt.Printf(\"Bytes allocated on assignment %d: %d\\n\", i, m2.Alloc-m1.Alloc)\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/iyYshDzexQt\" rel=\"nofollow noreferrer\">https://play.golang.org/p/iyYshDzexQt</a></p>\n\n<p>Output:</p>\n\n<pre><code>Bytes allocated on creation: 0\n</code></pre>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 1, "closed_date": 1559968381, "accepted_answer_id": 56502897, "answer_count": 1, "score": -1, "last_activity_date": 1559960804, "creation_date": 1559954812, "last_edit_date": 1559960804, "question_id": 56502560, "link": "https://stackoverflow.com/questions/56502560/whats-the-memory-cost-overhead-of-declaring-one-empty-mapstringinterface-in", "closed_reason": "Duplicate", "title": "What&#39;s the memory cost/overhead of declaring one empty map[string]interface{} in golang?", "body": "<p>Asking just for curiousity, from the <a href=\"https://github.com/golang/go/blob/master/src/runtime/map.go\" rel=\"nofollow noreferrer\">source code</a></p>\n\n<pre><code>type hmap struct {\n    count     int // 1 word\n    flags     uint8\n    B         uint8  \n    noverflow uint16 \n    hash0     uint32 // = 8 byte\n\n    buckets    unsafe.Pointer // 1 word\n    oldbuckets unsafe.Pointer // 1 word\n    nevacuate  uintptr        // 1 word\n\n    extra *mapextra // 1 word\n}\n</code></pre>\n\n<p>so it would at least: 5 word + 8 byte</p>\n\n<p>but why the <a href=\"https://play.golang.org/p/n8DzH082Myk\" rel=\"nofollow noreferrer\">creation cost is 0</a>? -</p>\n\n<hr>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc main() {\n    var m1, m2 runtime.MemStats\n    var i byte\n\n    runtime.ReadMemStats(&amp;m1)\n    mp := map[byte]byte{}\n    runtime.ReadMemStats(&amp;m2)\n    fmt.Println(\"Bytes allocated on creation:\", m2.Alloc-m1.Alloc)\n    for i = 0; i &lt; 100; i++ {\n        runtime.ReadMemStats(&amp;m1)\n        mp[i] = i\n        runtime.ReadMemStats(&amp;m2)\n        fmt.Printf(\"Bytes allocated on assignment %d: %d\\n\", i, m2.Alloc-m1.Alloc)\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/iyYshDzexQt\" rel=\"nofollow noreferrer\">https://play.golang.org/p/iyYshDzexQt</a></p>\n\n<p>Output:</p>\n\n<pre><code>Bytes allocated on creation: 0\n</code></pre>\n"}, {"tags": ["go", "put"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1559941014, "post_id": 56501029, "comment_id": 99591388, "body": "Use <code>&#47;max&#47;</code> instead of <code>&#47;max</code> and you may also need to use <a href=\"https://golang.org/pkg/net/http/#StripPrefix\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#StripPrefix</a> depending on what files you expect. No need to use <code>go http.HandleFunc</code>, just call <code>http.HandleFunc</code>. For handling PUT requests differently from the fileserver, use a custom handler that calls the fileserver handler when method is not PUT."}], "answers": [{"comments": [{"owner": {"reputation": 972, "user_id": 9488865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d560f151faf6a0565f7cebd93958acf?s=128&d=identicon&r=PG&f=1", "display_name": "struggling_learner", "link": "https://stackoverflow.com/users/9488865/struggling-learner"}, "edited": false, "score": 0, "creation_date": 1559945604, "post_id": 56501454, "comment_id": 99592545, "body": "thank you. <code>&#47;&#47; handle PUT</code> :  Please see <b>Edit 1</b> above - how can I find/retrieve actual data, and the filename that was inside the PUT request?"}, {"owner": {"reputation": 972, "user_id": 9488865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d560f151faf6a0565f7cebd93958acf?s=128&d=identicon&r=PG&f=1", "display_name": "struggling_learner", "link": "https://stackoverflow.com/users/9488865/struggling-learner"}, "edited": false, "score": 0, "creation_date": 1559948689, "post_id": 56501454, "comment_id": 99593059, "body": "Apparently, filename is not sent as part of HTTP PUT request, it is often deduced from the URL <code>curl -k http:&#47;&#47;localhost:3114&#47;ping&#47;a.txt -T &#47;tmp&#47;a.txt  -v</code>  <a href=\"https://stackoverflow.com/questions/14479386/how-to-get-filename-in-php-in-put-request\">helpful post here</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 972, "user_id": 9488865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d560f151faf6a0565f7cebd93958acf?s=128&d=identicon&r=PG&f=1", "display_name": "struggling_learner", "link": "https://stackoverflow.com/users/9488865/struggling-learner"}, "edited": false, "score": 0, "creation_date": 1559948842, "post_id": 56501454, "comment_id": 99593088, "body": "If you want the filename with file send a multipart form and use the corresponding request methods to retrieve that info."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 2, "last_activity_date": 1559983748, "last_edit_date": 1559983748, "creation_date": 1559943309, "answer_id": 56501454, "question_id": 56501029, "link": "https://stackoverflow.com/questions/56501029/http-put-request-handler-using-go/56501454#56501454", "title": "HTTP PUT request handler using go", "body": "<p>From <a href=\"https://golang.org/pkg/net/http/#ServeMux\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#ServeMux</a>:</p>\n\n<blockquote>\n  <p>Patterns name fixed, rooted paths, like \"/favicon.ico\", or <strong>rooted\n  subtrees, like \"/images/\" (note the trailing slash)</strong>.</p>\n</blockquote>\n\n<p>That means that <code>/max</code>, which is a <em>fixed rooted path</em>, will match only <code>/max</code> and the pattern <code>/max/</code>, which is a <em>rooted subtree</em>, will match <code>/max/</code>, any other path that starts with <code>/max/</code>, and by default it will also match <code>/max</code>.</p>\n\n<pre><code>http.Handle(\"/max/\", http.FileServer(http.Dir(\".\")))\n</code></pre>\n\n<hr>\n\n<p>Depending on what the layout of your <code>.</code> directory is, you may need to use <a href=\"https://golang.org/pkg/net/http/#StripPrefix\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#StripPrefix</a>.</p>\n\n<p>Let's say your directory contains two files:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 foo.txt\n\u2514\u2500\u2500 max\n    \u2514\u2500\u2500 bar.txt\n</code></pre>\n\n<p>Given the handler above, a request to <code>/max/bar.txt</code> will return the <code>bar.txt</code> file, but a request to <code>/max/foo.txt</code> or <code>/foo.txt</code> will return <code>404</code>, no file.</p>\n\n<p>So if you want to serve the files from the <code>/max/</code> path, but your <code>.</code> directory doesn't have a <code>max</code> sub-directory then you can use <code>StripPrefix</code> to remove the <code>/max</code> prefix from the request's url path before it is passed on to the <code>FileServer</code>.</p>\n\n<pre><code>http.Handle(\"/max/\", http.StripPrefix(\"/max/\", http.FileServer(http.Dir(\".\"))))\n</code></pre>\n\n<hr>\n\n<p>To handle <code>PUT</code> requests at the same route you need a custom handler.</p>\n\n<pre><code>type myhandler struct {\n    fs http.Handler\n}\n\nfunc (h myhandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    if r.Method != \"PUT\" {\n        // business as usual\n        h.fs.ServeHTTP(w, r)\n        return\n    }\n\n    // handle PUT\n    // ...\n}\n</code></pre>\n\n<p>And then to register it, do:</p>\n\n<pre><code>fs := http.StripPrefix(\"/max/\", http.FileServer(http.Dir(\".\")))\nhttp.Handle(\"/max/\", myhandler{fs: fs})\n</code></pre>\n"}], "owner": {"reputation": 972, "user_id": 9488865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d560f151faf6a0565f7cebd93958acf?s=128&d=identicon&r=PG&f=1", "display_name": "struggling_learner", "link": "https://stackoverflow.com/users/9488865/struggling-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1559983748, "creation_date": 1559940370, "last_edit_date": 1559945472, "question_id": 56501029, "link": "https://stackoverflow.com/questions/56501029/http-put-request-handler-using-go", "title": "HTTP PUT request handler using go", "body": "<p>Please consider this sample Go code snippet, </p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"log\"\n        \"net/http\"\n        \"time\"\n)\n\nfunc main() {\n        listen_at := \":3114\"\n        go http.Handle(\"/\", http.FileServer(http.Dir(\".\")))\n        //go http.Handle(\"/max\", http.FileServer(http.Dir(\".\"))) &lt;-- Fails\n        go http.HandleFunc(\"/ping\", ping_handler)\n        log.Fatal(http.ListenAndServe(listen_at, nil))\n\n}\n\nfunc ping_handler(w http.ResponseWriter, r *http.Request) {\n        a := time.Now()\n        layout := \"2006-01-02-03-04-05-000\"\n\n        fmt.Println(\"Got root!\")\n        fmt.Println(\"r is\", r)\n        fmt.Println(\"RemoteAddr is\", r.RemoteAddr)\n        send_this := \"OK GOT ping! \" + a.Format(layout)\n        w.Write([]byte(send_this))\n}\n</code></pre>\n\n<p>I've two questions: </p>\n\n<p>(1) How can I change the FileServer to serve <code>/max</code> instead of <code>/</code> - my attempts failed, I get 404 for <code>http://localhost:3114/max/</code> and <code>http://localhost:3114/max</code>.</p>\n\n<p>(2) I wish to accept <code>PUT</code> requests to <code>/max</code> - how can I achieve this?</p>\n\n<p>Please point me the right direction, thanks! </p>\n\n<p><strong>Edit 1</strong></p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"log\"\n        \"net/http\"\n)\n\nfunc main() {\n        go http.HandleFunc(\"/ping\", hello)\n        log.Fatal(http.ListenAndServe(\":3114\", nil))\n}\n\nfunc hello(w http.ResponseWriter, r *http.Request) {\n        fmt.Println(\"STarting hello!\")\n\n        log.Println(\"Got connection\")\n        if r.URL.Path != \"/ping\" {\n                http.Error(w, \"404 not found\", http.StatusNotFound)\n                return\n        }\n        log.Println(\"Method:\", r.Method)\n        switch r.Method {\n        case \"GET\":\n                send_this := \"OK GOT ping! \"\n                w.Write([]byte(send_this))\n        case \"PUT\":\n                fmt.Println(\"We got put!\")\n                err := r.ParseForm()\n                checkErr(err)\n                fmt.Println(\"r now\", r)\n                fmt.Println(\"r.Form\", r.Form)\n                fmt.Println(\"r.PostForm\", r.PostForm)\n        default:\n                send_this := \"Please dont!\"\n                w.Write([]byte(send_this))\n                fmt.Fprintf(w, \"Unknown request!\")\n        }\n\n}\n\nfunc checkErr(err error) {\n        if err != nil {\n                fmt.Println(\"Error\", err)\n        }\n}\n</code></pre>\n\n<p>I send a PUT request as <code>curl -k http://localhost:3114/ping -T /tmp/a.go  -v</code>, it shows:</p>\n\n<pre><code>STarting hello!\n2019/06/07 15:05:10 Got connection\n2019/06/07 15:05:10 Method: PUT\nWe got put!\nr now &amp;{PUT /ping HTTP/1.1 1 1 map[Content-Length:[10115] Expect:[100-continue] User-Agent:[curl/7.47.0] Accept:[*/*]] 0xc4200ec2e0 &lt;nil&gt; 10115 [] false localhost:3114 map[] map[] &lt;nil&gt; map[] 127.0.0.1:64612 /ping &lt;nil&gt; &lt;nil&gt; &lt;nil&gt; 0xc42005e340}\nr.Form map[]\nr.PostForm map[]\n</code></pre>\n\n<p>How can I find the actual data, and the filename that came in from PUT? </p>\n"}, {"tags": ["mongodb", "go", "webassembly"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7293785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9f548009f98161b0038060e7e9a574?s=128&d=identicon&r=PG&f=1", "display_name": "mshirobokov", "link": "https://stackoverflow.com/users/7293785/mshirobokov"}, "edited": false, "score": 0, "creation_date": 1559947270, "post_id": 56501209, "comment_id": 99592851, "body": "Thank you for your answer. I&#39;ll try to google something useful in terms of WebAssembly&#39;s capabilities of running low-level network code."}], "tags": [], "owner": {"reputation": 76, "user_id": 11615961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/673938b7e89b06dc85576f83e061d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "JDU", "link": "https://stackoverflow.com/users/11615961/jdu"}, "is_accepted": false, "score": 3, "last_activity_date": 1559941547, "creation_date": 1559941547, "answer_id": 56501209, "question_id": 56500709, "link": "https://stackoverflow.com/questions/56500709/how-to-connect-to-a-local-mongodb-instance-from-wasm-module/56501209#56501209", "title": "How to connect to a local mongodb instance from wasm module?", "body": "<p>You are trying to connect from WebAssembly to a local server, most likely using a protocol which isn't allowed from the browser WASM sandbox. </p>\n\n<p>WebAssembly can't for instance open low-level network sockets out of the WASM sandbox, you're mainly constrained to the same things that you can do with JavaScript in terms of file, system and network access when you're running WASM in a browser.</p>\n\n<p>It's worth reading up on the constraints that WebAssembly has around security and system access <strong>when used in a browser context</strong> as well as it's worth noting that it's not WebAssembly that's blocking your connection here, it's the browser that's running the WebAssembly.</p>\n"}], "owner": {"reputation": 1, "user_id": 7293785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9f548009f98161b0038060e7e9a574?s=128&d=identicon&r=PG&f=1", "display_name": "mshirobokov", "link": "https://stackoverflow.com/users/7293785/mshirobokov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563201040, "creation_date": 1559938382, "last_edit_date": 1563201040, "question_id": 56500709, "link": "https://stackoverflow.com/questions/56500709/how-to-connect-to-a-local-mongodb-instance-from-wasm-module", "title": "How to connect to a local mongodb instance from wasm module?", "body": "<p>I'm trying to store some data in my local MongoDB instance using Go compiled to WebAssembly. The problem is, I cannot even connect to it. The mondog instance doesn't react to connection from wasm module in any way. This problem arises only when connecting from wasm module. The same code when compiled in ordinary way works fine, as well as connection from mongo shell. The runned mongod instance has no password protection.</p>\n\n<p>My OS is Windows 10 in case that matters.</p>\n\n<p>I've tried to change mongod bind_ip parameter from localhost to the actual local adress of my machine and use different browsers (Chrome 75.0.3770.80, Opera 60.0.3255.109).\nChanging the timeout duration doesn't do the trick also.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func connectToMongo(URI string, timeout time.Duration) *mongo.Client {\n\n    ctx, cancel := context.WithTimeout(context.Background(), timeout)\n    defer cancel()\n\n    client, err := mongo.Connect(ctx, options.Client().ApplyURI(URI))\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    err = client.Ping(ctx, readpref.Primary())\n\n    if err != nil {\n        log.Fatal(err) // It fails here\n    }\n\n    return client\n}\n\nfunc main() {\n    client := connectToMongo(\"mongodb://localhost:27017\", 20*time.Second)\n}\n\n</code></pre>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;script type=\"text/javascript\" src=\"./wasm_exec.js\"&gt;&lt;/script&gt;\n        &lt;script&gt;\n            const go = new Go();\n            WebAssembly.instantiateStreaming(fetch('main.wasm'),go.importObject).then( res=&gt; {\n                go.run(res.instance)    \n            })\n        &lt;/script&gt;\n    &lt;/head&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>I run mongod.exe without any parameters so it is binded to localhost.</p>\n\n<p>I expected my code to connect to mongod instance, but actually I get the following error in browser console: \"context deadline exceeded\".</p>\n\n<p>I'm still learning Go and a total newbie in JavaScript so I might be missing something very simple. Any help would be greatly appreciated.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4953531, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205683003746704/picture?type=large", "display_name": "Michael Lewis", "link": "https://stackoverflow.com/users/4953531/michael-lewis"}, "edited": false, "score": 0, "creation_date": 1559933921, "post_id": 56499693, "comment_id": 99588935, "body": "The first option works, however, I&#39;m not always going to have 4 elements.  The second option (using <code>[]interface{}</code>) produces the same incorrect result.  Until I find a long term result, I can use a <code>switch</code> statement on the length of the array.  It should always be between 4 and 8 elements (until I hardcode that)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 27, "user_id": 4953531, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205683003746704/picture?type=large", "display_name": "Michael Lewis", "link": "https://stackoverflow.com/users/4953531/michael-lewis"}, "edited": false, "score": 0, "creation_date": 1559934090, "post_id": 56499693, "comment_id": 99588990, "body": "@MichaelLewis: I&#39;m not sure what you mean, they produce identical results. You do of course have to switch over the length to match the format string. <a href=\"https://play.golang.org/p/viR1hTazJlH\" rel=\"nofollow noreferrer\">play.golang.org/p/viR1hTazJlH</a>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1559938173, "last_edit_date": 1559938173, "creation_date": 1559932709, "answer_id": 56499693, "question_id": 56499626, "link": "https://stackoverflow.com/questions/56499626/i-want-to-format-an-array-of-integers-how-do-i-send-the-array-so-that-each-verb/56499693#56499693", "title": "I want to format an array of integers. How do I send the array so that each verb receives a different element of the array?", "body": "<p>You either need to pass in the elements individually:</p>\n\n<pre><code>nums := []int{10,100,250,99}\nformat := \"%02d-%04d-%04d-%02d\\n\"\nfmt.Printf(format, nums[0], nums[1], nums[2], nums[3])\n</code></pre>\n\n<p>Or use the correct type for the <code>fmt.Printf</code> argument, which is <code>[]interface{}</code>:</p>\n\n<pre><code>nums := []interface{}{10,100,250,99}\nformat := \"%02d-%04d-%04d-%02d\\n\"\nfmt.Printf(format, nums...)\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4953531, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205683003746704/picture?type=large", "display_name": "Michael Lewis", "link": "https://stackoverflow.com/users/4953531/michael-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56499693, "answer_count": 1, "score": 0, "last_activity_date": 1559938173, "creation_date": 1559932332, "question_id": 56499626, "link": "https://stackoverflow.com/questions/56499626/i-want-to-format-an-array-of-integers-how-do-i-send-the-array-so-that-each-verb", "title": "I want to format an array of integers. How do I send the array so that each verb receives a different element of the array?", "body": "<p>I have a variable array of integers that I would like to format into a string.  When I pass the array, it is placed into the first format verb and the rest are listed as missing.  For example, I pass [10, 100, 250, 99] and a format of \"%02d-%04d-%04d-%02d\".  I want it to return \"10-0100-0250-99\".  What is the correct way to do this in go?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\ninclude (\n    \"fmt\"\n)\n\nfunc main() {\n    nums := []int{10,100,250,99}\n    format := \"%02d-%04d-%04d-%02d\\n\"\n\n    fmt.Printf(format, 10, 100, 250, 99)\n    fmt.Printf(format, nums)\n}\n</code></pre>\n\n<p>[10 100 250 99]-%!d(MISSING)-%!d(MISSING)-%!d(MISSING)   (Wrong)\n10-0100-0250-99  (correct)</p>\n"}, {"tags": ["go", "apache-kafka", "confluent-platform"], "comments": [{"owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1559932127, "post_id": 56499279, "comment_id": 99588197, "body": "Is the topic already created?  Sounds like you have an issue with your cluster.  If you have configured a minimum of 2 brokers for a new topic, you will not be able to produce to a new topic until there are 2 are available."}, {"owner": {"reputation": 450, "user_id": 7692562, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a943ccab242bc2219020a87c729c3b6?s=128&d=identicon&r=PG&f=1", "display_name": "foobarbaz", "link": "https://stackoverflow.com/users/7692562/foobarbaz"}, "reply_to_user": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1559932468, "post_id": 56499279, "comment_id": 99588354, "body": "Yes the topic is already created. I wrote to it in the example from the console-producer. The console-consumer shows it was read. The golang code works to write to a topic on my local cluster, but not for the one on aws."}, {"owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1559935274, "post_id": 56499279, "comment_id": 99589426, "body": "Working locally suggests that your code is ok. Have you tried AWS again after giving the cluster a few minutes to rebalance?"}, {"owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 1, "creation_date": 1559935556, "post_id": 56499279, "comment_id": 99589539, "body": "Also, having 2 replicas for 3 brokers is not recommended.  Check this article for more info <a href=\"https://hiya.com/blog/2018/06/07/hiyas-best-practices-around-kafka-consistency-and-availability/\" rel=\"nofollow noreferrer\">hiya.com/blog/2018/06/07/&hellip;</a>.  1 or 3 replicas may be better for your setup."}, {"owner": {"reputation": 450, "user_id": 7692562, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a943ccab242bc2219020a87c729c3b6?s=128&d=identicon&r=PG&f=1", "display_name": "foobarbaz", "link": "https://stackoverflow.com/users/7692562/foobarbaz"}, "reply_to_user": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1559952994, "post_id": 56499279, "comment_id": 99593684, "body": "@PassKit I increased replication factor to 3 for my topic and it worked!"}], "answers": [{"tags": [], "owner": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "is_accepted": true, "score": 5, "last_activity_date": 1559968976, "last_edit_date": 1559968976, "creation_date": 1559968640, "answer_id": 56503453, "question_id": 56499279, "link": "https://stackoverflow.com/questions/56499279/confluent-kafka-golang-client-producer-broker-not-enough-in-sync-replicas/56503453#56503453", "title": "Confluent Kafka Golang Client Producer &quot;Broker: Not enough in-sync replicas&quot;", "body": "<p>You have <code>min.insync.replicas=2</code>, but the topic only has one replica.</p>\n\n<p>If you have <code>request.required.acks=all</code> (which is the default), then the producer will fail because it cannot replicate what you've produced to the leader broker to the minimum set of required replicas</p>\n\n<p><a href=\"https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md#topic-configuration-properties\" rel=\"noreferrer\">https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md#topic-configuration-properties</a></p>\n\n<p>I believe console producer only sets that property to just 1 </p>\n\n<blockquote>\n  <p>there are 3</p>\n</blockquote>\n\n<p>There's actually only one. That's broker ID 3. You'd see a total of three separate numbers there as ISR if there were actually three replicas </p>\n"}], "owner": {"reputation": 450, "user_id": 7692562, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a943ccab242bc2219020a87c729c3b6?s=128&d=identicon&r=PG&f=1", "display_name": "foobarbaz", "link": "https://stackoverflow.com/users/7692562/foobarbaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3579, "favorite_count": 0, "accepted_answer_id": 56503453, "answer_count": 1, "score": 1, "last_activity_date": 1559968976, "creation_date": 1559930637, "last_edit_date": 1559968860, "question_id": 56499279, "link": "https://stackoverflow.com/questions/56499279/confluent-kafka-golang-client-producer-broker-not-enough-in-sync-replicas", "title": "Confluent Kafka Golang Client Producer &quot;Broker: Not enough in-sync replicas&quot;", "body": "<p>I am attempting to test out a producer writing messages to a topic on a kafka cluster using the Golang client. This works fine writing to a topic on a local cluster, I just copied and pasted the example code from their <a href=\"https://github.com/confluentinc/confluent-kafka-go\" rel=\"nofollow noreferrer\">github repo</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"gopkg.in/confluentinc/confluent-kafka-go.v1/kafka\"\n)\n\n\nfunc main() {\n\n    p, err := kafka.NewProducer(&amp;kafka.ConfigMap{\"bootstrap.servers\":\"localhost\"})\n    if err != nil {\n        panic(err)\n    }\n\n    defer p.Close()\n\n    // Delivery report handler for produced messages\n    go func() {\n        for e := range p.Events() {\n            switch ev := e.(type) {\n            case *kafka.Message:\n                if ev.TopicPartition.Error != nil {\n                    fmt.Printf(\"Delivery failed: %v\\n\", ev.TopicPartition)\n                } else {\n                    fmt.Printf(\"Delivered message to %v\\n\", ev.TopicPartition)\n                }\n            }\n        }\n    }()\n\n    // Produce messages to topic (asynchronously)\n    topic := \"test\"\n    for _, word := range []string{\"test message\"} {\n        p.Produce(&amp;kafka.Message{\n            TopicPartition: kafka.TopicPartition{Topic: &amp;topic, Partition: kafka.PartitionAny},\n            Value:          []byte(word),\n        }, nil)\n    }\n\n    // Wait for message deliveries before shutting down\n    p.Flush(15 * 1000)\n}\n</code></pre>\n\n<p>I receive the message on my console-consumer no issues.</p>\n\n<p>I then try to do the same thing, just using my remote kafka cluster topic (note I also tried without the ports in the strings):</p>\n\n<pre><code>p, err := kafka.NewProducer(&amp;kafka.ConfigMap{\"bootstrap.servers\":\"HOSTNAME.amazonaws.com:9092,HOSTNAME2.amazonaws.com:9092,HOSTNAME3.amazonaws.com:9092\"})\n</code></pre>\n\n<p>it prints the following error:</p>\n\n<pre><code>Delivery failed: test[0]@end(Broker: Not enough in-sync replicas)\n</code></pre>\n\n<p>The console producer has no issues though:</p>\n\n<pre><code>./bin/kafka-console-producer.sh --broker-list HOSTNAME.amazonaws.com:9092,HOSTNAME2.amazonaws.com:9092,HOSTNAME3.amazonaws.com:9092 --topic test\n&gt;proving that this works\n</code></pre>\n\n<p>The console-consumer receives it:</p>\n\n<pre><code>bin/kafka-console-consumer.sh --bootstrap-server HOSTNAME.amazonaws.com:9092,HOSTNAME2.amazonaws.com:9092,HOSTNAME3.amazonaws.com:9092 --topic test --from-beginning \n\nproving that this works\n\n</code></pre>\n\n<p>Last thing I did was check to see how many In-Sync replicas there were for that topic. If I am reading this correctly, the min should be 2 and there are 3.</p>\n\n<pre><code>./bin/kafka-topics.sh --describe --bootstrap-server HOSTNAME1.amazonaws.com:9092,HOSTNAME2.amazonaws.com:9092,HOSTNAME3.amazonaws.com:9092 --topic test \nTopic:test      PartitionCount:1        ReplicationFactor:1     Configs:min.insync.replicas=2,flush.ms=10000,segment.bytes=1073741824,retention.ms=86400000,flush.messages=9223372036854775807,max.message.bytes=1000012,min.cleanable.dirty.ratio=0.5,unclean.leader.election.enable=true,retention.bytes=-1,delete.retention.ms=86400000,segment.ms=604800000\n        Topic: test     Partition: 0    Leader: 3       Replicas: 3     Isr: 3\n</code></pre>\n\n<p>Any ideas of what else I could look into?</p>\n"}]