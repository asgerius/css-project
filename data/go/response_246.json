[{"tags": ["javascript", "go", "gorilla", "polymer-3.x", "lit-element"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1569486144, "post_id": 58107883, "comment_id": 102614730, "body": "something is wrong in your problem analysis. FileServer uses ServeContent internally, and ServeContent manages content type for you. <a href=\"https://golang.org/pkg/net/http/#ServeContent\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#ServeContent</a> can you try to curl the js resource and share the result ?"}, {"owner": {"reputation": 1818, "user_id": 1626597, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1400f25283ad32b0fc56999d051ae4ad?s=128&d=identicon&r=PG", "display_name": "NicolasR", "link": "https://stackoverflow.com/users/1626597/nicolasr"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569498231, "post_id": 58107883, "comment_id": 102621219, "body": "Ok, see my update"}], "answers": [{"comments": [{"owner": {"reputation": 1818, "user_id": 1626597, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1400f25283ad32b0fc56999d051ae4ad?s=128&d=identicon&r=PG", "display_name": "NicolasR", "link": "https://stackoverflow.com/users/1626597/nicolasr"}, "edited": false, "score": 1, "creation_date": 1569503000, "post_id": 58116636, "comment_id": 102623819, "body": "Thanks for that example! It&#39;s totally crazy: your code produces on my side Content-Type: text/plain; charset=utf-8. As soon as I change the extension to mjs it correctly reports Content-Type: application/javascript. I checked the source code of the current http and mime packages. There seem to be differences between Windows and Linux mime detection. And in my Windows registry I found the extension js mapped to text/plain!!! Other Windows systems don&#39;t seem to have that entry. I&#39;m going to investigate this closer tonight..."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 1818, "user_id": 1626597, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1400f25283ad32b0fc56999d051ae4ad?s=128&d=identicon&r=PG", "display_name": "NicolasR", "link": "https://stackoverflow.com/users/1626597/nicolasr"}, "edited": false, "score": 0, "creation_date": 1569503411, "post_id": 58116636, "comment_id": 102624045, "body": "that s indeed very surprising. Looking at the go source code, ServeContent calls for mime.TypeByExtension (<a href=\"https://golang.org/src/net/http/fs.go#L196\" rel=\"nofollow noreferrer\">golang.org/src/net/http/fs.go#L196</a>). On windows (to keep this comment short) it relies on the registry, indeed, <a href=\"https://golang.org/src/mime/type_windows.go\" rel=\"nofollow noreferrer\">golang.org/src/mime/type_windows.go</a>"}, {"owner": {"reputation": 1818, "user_id": 1626597, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1400f25283ad32b0fc56999d051ae4ad?s=128&d=identicon&r=PG", "display_name": "NicolasR", "link": "https://stackoverflow.com/users/1626597/nicolasr"}, "edited": false, "score": 1, "creation_date": 1569577074, "post_id": 58116636, "comment_id": 102650619, "body": "Ok, the registry setting was indeed the problem. I don&#39;t understand which software made this mapping and why this did not cause any problems before with other applications. Anyway, thanks for your time and I will accept your answer as it gave me an idea how to diagnose the problem."}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": true, "score": 1, "last_activity_date": 1569503552, "last_edit_date": 1569503552, "creation_date": 1569500202, "answer_id": 58116636, "question_id": 58107883, "link": "https://stackoverflow.com/questions/58107883/golang-and-javascript-modules/58116636#58116636", "title": "Golang and JavaScript modules", "body": "<p>Are you sure you hit the right end point ?</p>\n\n<p>See that small example (that you can try on your host to give a check)</p>\n\n<pre><code>$ tree\n.\n\u251c\u2500\u2500 main.go\n\u2514\u2500\u2500 wwwroot\n    \u2514\u2500\u2500 test.js\n\n1 directory, 2 files\n\n$ cat main.go \npackage main\n\nimport (\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n    mux := mux.NewRouter()\n    mux.PathPrefix(\"/\").Handler(http.FileServer(http.Dir(\"./wwwroot\")))\n\n    http.ListenAndServe(\":8080\", mux)\n}\n\n\n$  cat wwwroot/test.js\n\n$ go run main.go &amp;\n[1] 11841\n$ curl -v http://localhost:8080/test.js\n*   Trying ::1:8080...\n* TCP_NODELAY set\n* Connected to localhost (::1) port 8080 (#0)\n&gt; GET /test.js HTTP/1.1\n&gt; Host: localhost:8080\n&gt; User-Agent: curl/7.65.3\n&gt; Accept: */*\n&gt; \n* Mark bundle as not supporting multiuse\n&lt; HTTP/1.1 200 OK\n&lt; Accept-Ranges: bytes\n&lt; Content-Length: 0\n&lt; Content-Type: application/javascript\n&lt; Last-Modified: Thu, 26 Sep 2019 12:12:15 GMT\n&lt; Date: Thu, 26 Sep 2019 12:15:36 GMT\n&lt; \n* Connection #0 to host localhost left intact\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1818, "user_id": 1626597, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1400f25283ad32b0fc56999d051ae4ad?s=128&d=identicon&r=PG", "display_name": "NicolasR", "link": "https://stackoverflow.com/users/1626597/nicolasr"}, "edited": false, "score": 0, "creation_date": 1611098265, "post_id": 65756658, "comment_id": 116340483, "body": "Unfortunately that doesn&#39;t work for me because I need at least es6. And, by the way, I don&#39;t use Typescript in this project."}], "tags": [], "owner": {"reputation": 1, "user_id": 15021736, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1bDnE.png?s=128&g=1", "display_name": "lovegolabs", "link": "https://stackoverflow.com/users/15021736/lovegolabs"}, "is_accepted": false, "score": 0, "last_activity_date": 1610858459, "last_edit_date": 1610858459, "creation_date": 1610849322, "answer_id": 65756658, "question_id": 58107883, "link": "https://stackoverflow.com/questions/58107883/golang-and-javascript-modules/65756658#65756658", "title": "Golang and JavaScript modules", "body": "<p>In my project, I had the same problem. Following is my solution:\nIn <code>tsconfig.json</code> file, make <code>&quot;target&quot;: &quot;es5&quot;</code></p>\n"}], "owner": {"reputation": 1818, "user_id": 1626597, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1400f25283ad32b0fc56999d051ae4ad?s=128&d=identicon&r=PG", "display_name": "NicolasR", "link": "https://stackoverflow.com/users/1626597/nicolasr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 58116636, "answer_count": 2, "score": 0, "last_activity_date": 1610858459, "creation_date": 1569455666, "last_edit_date": 1569498219, "question_id": 58107883, "link": "https://stackoverflow.com/questions/58107883/golang-and-javascript-modules", "title": "Golang and JavaScript modules", "body": "<p>I want to use Polymer LitElement with a Go backend.\nWith LitElement I implement the web components in JavaScript modules!\nFor routing on the server-side I use Gorilla Mux like this</p>\n\n<pre><code>mux := mux.NewRouter()\nmux.PathPrefix(\"/\").Handler(http.FileServer(http.Dir(\"./wwwroot\")))\n</code></pre>\n\n<p>This loads static html files correctly. When a html file references a <em>js</em> file that implements a web component I get the following error (in Chrome):</p>\n\n<p><em>Failed to load module script: The server responded with a non-JavaScript MIME type of \"text/plain\". Strict MIME type checking is enforced for module scripts per HTML spec.</em></p>\n\n<p>When I rename my component module to have the extension <em>mjs</em> the file loads correctly but then the module for LitElement fails to load with the same error. Since I have no influence on the file extensions of all third party JavaScript modules I don't know how to fix this. </p>\n\n<p>(I guess I would experience the same problems if I were using Polymer 3 instead of LitElement)</p>\n\n<p>Any ideas?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Here is the output from requesting the lit-element.js JavaScript module with <code>curl</code></p>\n\n<pre><code>PS C:\\Test\\Polymer\\LitElement&gt; curl http://localhost:8082/node_modules/lit-element/lit-element.js\n\nStatusCode        : 200\nStatusDescription : OK\nContent           : /**\n                     * @license\n                     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n                     * This code may only be used under the BSD style license found at\n                     * http://polymer.github.io/LICENSE.txt\n                     * Th...\nRawContent        : HTTP/1.1 200 OK\n                    Accept-Ranges: bytes\n                    Content-Length: 8925\n                    Content-Type: text/plain; charset=utf-8\n                    Date: Thu, 26 Sep 2019 11:38:23 GMT\n                    Last-Modified: Sat, 26 Oct 1985 08:15:00 GMT\n\n                    /**\n                     * @licen...\nForms             : {}\nHeaders           : {[Accept-Ranges, bytes], [Content-Length, 8925], [Content-Type, text/plain; charset=utf-8], [Date,\n                    Thu, 26 Sep 2019 11:38:23 GMT]...}\nImages            : {}\nInputFields       : {}\nLinks             : {}\nParsedHtml        : mshtml.HTMLDocumentClass\nRawContentLength  : 8925\n</code></pre>\n\n<p>Notice the Content-Type!!!</p>\n"}, {"tags": ["unit-testing", "go", "stdout"], "answers": [{"tags": [], "owner": {"reputation": 34200, "user_id": 995862, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d5efb6c1054808f7a79aaefbc64cce76?s=128&d=identicon&r=PG", "display_name": "Kurt Peek", "link": "https://stackoverflow.com/users/995862/kurt-peek"}, "is_accepted": false, "score": 0, "last_activity_date": 1569449583, "creation_date": 1569449583, "answer_id": 58107208, "question_id": 58107031, "link": "https://stackoverflow.com/questions/58107031/how-to-test-a-go-function-which-runs-a-command/58107208#58107208", "title": "How to test a Go function which runs a command?", "body": "<p>I added unit tests by splitting the function into two parts: one which reads the output to a slice of bytes, and one which parses that output to a <code>Person</code>:</p>\n\n<pre><code>package stdoutexample\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"os/exec\"\n)\n\n// Person represents a person\ntype Person struct {\n    Name string\n    Age  int\n}\n\nfunc getCommandOutput() ([]byte, error) {\n    cmd := exec.Command(\"echo\", \"-n\", `{\"Name\": \"Bob\", \"Age\": 32}`)\n    return cmd.Output()\n}\n\nfunc getPerson(commandOutput []byte) (Person, error) {\n    person := Person{}\n    if err := json.NewDecoder(bytes.NewReader(commandOutput)).Decode(&amp;person); err != nil {\n        return person, err\n    }\n    return person, nil\n}\n</code></pre>\n\n<p>The following test cases pass:</p>\n\n<pre><code>package stdoutexample\n\nimport (\n    \"testing\"\n\n    \"github.com/stretchr/testify/assert\"\n    \"github.com/stretchr/testify/require\"\n)\n\nfunc TestGetPerson(t *testing.T) {\n    commandOutput, err := getCommandOutput()\n    require.NoError(t, err)\n    person, err := getPerson(commandOutput)\n    require.NoError(t, err)\n    assert.Equal(t, person.Name, \"Bob\")\n    assert.Equal(t, person.Age, 32)\n}\n\nfunc TestGetPersonBob(t *testing.T) {\n    commandOutput := []byte(`{\"Name\": \"Bob\", \"Age\": 32}`)\n    person, err := getPerson(commandOutput)\n    require.NoError(t, err)\n    assert.Equal(t, person.Name, \"Bob\")\n    assert.Equal(t, person.Age, 32)\n}\n\nfunc TestGetPersonAlice(t *testing.T) {\n    commandOutput := []byte(`{\"Name\": \"Alice\", \"Age\": 25}`)\n    person, err := getPerson(commandOutput)\n    require.NoError(t, err)\n    assert.Equal(t, person.Name, \"Alice\")\n    assert.Equal(t, person.Age, 25)\n}\n</code></pre>\n\n<p>where the <code>Bob</code> and <code>Alice</code> test cases simulate different output which can be generated by the command.</p>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 9353289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7zRvzDBVsKY/AAAAAAAAAAI/AAAAAAAALJU/mLo07MckG9M/photo.jpg?sz=128", "display_name": "Sufiyan Parkar", "link": "https://stackoverflow.com/users/9353289/sufiyan-parkar"}, "is_accepted": true, "score": 2, "last_activity_date": 1570258776, "last_edit_date": 1570258776, "creation_date": 1569471354, "answer_id": 58109489, "question_id": 58107031, "link": "https://stackoverflow.com/questions/58107031/how-to-test-a-go-function-which-runs-a-command/58109489#58109489", "title": "How to test a Go function which runs a command?", "body": "<p>adding to <a href=\"https://stackoverflow.com/a/58107208/9353289\">https://stackoverflow.com/a/58107208/9353289</a>,</p>\n\n<p>Instead of writing separate Test functions for every test, I suggest you use a Table Driven Test approach instead.\nHere is an example, </p>\n\n<pre><code>func Test_getPerson(t *testing.T) {\n    tests := []struct {\n        name          string\n        commandOutput []byte\n        want          Person\n    }{\n        {\n            name:          \"Get Bob\",\n            commandOutput: []byte(`{\"Name\": \"Bob\", \"Age\": 32}`),\n            want: Person{\n                Name: \"Bob\",\n                Age:  32,\n            },\n        },\n\n        {\n            name:          \"Get Alice\",\n            commandOutput: []byte(`{\"Name\": \"Alice\", \"Age\": 25}`),\n            want: Person{\n                Name: \"Alice\",\n                Age:  25,\n            },\n        },\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            got, err := getPerson(tt.commandOutput)\n            require.NoError(t, err)\n            assert.Equal(t, tt.want.Name, got.Name)\n            assert.Equal(t, tt.want.Age, got.Age)\n\n        })\n    }\n}\n</code></pre>\n\n<p>Simply adding test cases to the slice, will run all test cases.</p>\n"}, {"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1569488812, "creation_date": 1569488812, "answer_id": 58113281, "question_id": 58107031, "link": "https://stackoverflow.com/questions/58107031/how-to-test-a-go-function-which-runs-a-command/58113281#58113281", "title": "How to test a Go function which runs a command?", "body": "<p>your implementation design actively rejects fine grain testing because it does not allow any injection.</p>\n\n<p>However, given the example, besides using a TestTable, there is not much to improve.</p>\n\n<p>Now, on a real workload, you might encounter unacceptable slowdown dues to call to the external binary. This might justify another approach involving a design refactoring to mock  and the setup of multiple tests stubs.</p>\n\n<p>To mock your implementation you make use of <code>interface</code> capabilities.\nTo stub your execution you create a mock that outputs stuff you want to check for.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os/exec\"\n)\n\ntype Person struct{}\n\ntype PersonProvider struct {\n    Cmd outer\n}\n\nfunc (p PersonProvider) Get() (Person, error) {\n    person := Person{}\n    b, err := p.Cmd.Out()\n    if err != nil {\n        return person, err\n    }\n    err = json.Unmarshal(b, &amp;person)\n    return person, err\n}\n\ntype outer interface{ Out() ([]byte, error) }\n\ntype echo struct {\n    input string\n}\n\nfunc (e echo) Out() ([]byte, error) {\n    cmd := exec.Command(\"echo\", \"-n\", e.input)\n    return cmd.Output()\n}\n\ntype mockEcho struct {\n    output []byte\n    err    error\n}\n\nfunc (m mockEcho) Out() ([]byte, error) {\n    return m.output, m.err\n}\n\nfunc main() {\n\n    fmt.Println(PersonProvider{Cmd: echo{input: `{\"Name\": \"Bob\", \"Age\": 32}`}}.Get())\n    fmt.Println(PersonProvider{Cmd: mockEcho{output: nil, err: fmt.Errorf(\"invalid json\")}}.Get())\n\n}\n</code></pre>\n"}], "owner": {"reputation": 34200, "user_id": 995862, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d5efb6c1054808f7a79aaefbc64cce76?s=128&d=identicon&r=PG", "display_name": "Kurt Peek", "link": "https://stackoverflow.com/users/995862/kurt-peek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "accepted_answer_id": 58109489, "answer_count": 3, "score": 0, "last_activity_date": 1570258776, "creation_date": 1569448422, "question_id": 58107031, "link": "https://stackoverflow.com/questions/58107031/how-to-test-a-go-function-which-runs-a-command", "title": "How to test a Go function which runs a command?", "body": "<p>Following the example at <a href=\"https://golang.org/pkg/os/exec/#Cmd.StdoutPipe\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/exec/#Cmd.StdoutPipe</a>, suppose I have a function <code>getPerson()</code> defined like so:</p>\n\n<pre><code>package stdoutexample\n\nimport (\n    \"encoding/json\"\n    \"os/exec\"\n)\n\n// Person represents a person\ntype Person struct {\n    Name string\n    Age  int\n}\n\nfunc getPerson() (Person, error) {\n    person := Person{}\n    cmd := exec.Command(\"echo\", \"-n\", `{\"Name\": \"Bob\", \"Age\": 32}`)\n    stdout, err := cmd.StdoutPipe()\n    if err != nil {\n        return person, err\n    }\n    if err := cmd.Start(); err != nil {\n        return person, err\n    }\n    if err := json.NewDecoder(stdout).Decode(&amp;person); err != nil {\n        return person, err\n    }\n    if err := cmd.Wait(); err != nil {\n        return person, err\n    }\n    return person, nil\n}\n</code></pre>\n\n<p>In my 'real' application, the command run can have different outputs, I'd like to write test cases for each of these scenarios. However, I'm not sure how to go about this.</p>\n\n<p>So far all I have is a test case for one case:</p>\n\n<pre><code>package stdoutexample\n\nimport (\n    \"testing\"\n\n    \"github.com/stretchr/testify/assert\"\n    \"github.com/stretchr/testify/require\"\n)\n\nfunc TestGetPerson(t *testing.T) {\n    person, err := getPerson()\n    require.NoError(t, err)\n    assert.Equal(t, person.Name, \"Bob\")\n    assert.Equal(t, person.Age, 32)\n}\n</code></pre>\n\n<p>Perhaps the way to go about this is to split this function into two parts, one which writes the output of the command to a string, and another which decodes the output of a string?</p>\n"}, {"tags": ["json", "go", "struct", "encoding"], "answers": [{"comments": [{"owner": {"reputation": 888, "user_id": 1795357, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f85b0ef93603bc344ed36172ee2d98a?s=128&d=identicon&r=PG", "display_name": "ajoseps", "link": "https://stackoverflow.com/users/1795357/ajoseps"}, "edited": false, "score": 0, "creation_date": 1569444749, "post_id": 58106352, "comment_id": 102603518, "body": "that does seem to work! Is there a way around needing to define every nested field and bringing it up a level? e.g. City and Size just need to be brought up a level, but if the City struct had many fields, it would be very verbose. Additionally, why does making the field anonymous work?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 888, "user_id": 1795357, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f85b0ef93603bc344ed36172ee2d98a?s=128&d=identicon&r=PG", "display_name": "ajoseps", "link": "https://stackoverflow.com/users/1795357/ajoseps"}, "edited": false, "score": 1, "creation_date": 1569445344, "post_id": 58106352, "comment_id": 102603718, "body": "@ajoseps An anonymous field works because the encoding/json package is written to flatten anonymous fields.  The other approach is to flatten with a <code>MarshalJSON</code> method as in the question. See updated answer on how to make that work."}, {"owner": {"reputation": 888, "user_id": 1795357, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f85b0ef93603bc344ed36172ee2d98a?s=128&d=identicon&r=PG", "display_name": "ajoseps", "link": "https://stackoverflow.com/users/1795357/ajoseps"}, "edited": false, "score": 0, "creation_date": 1569445749, "post_id": 58106352, "comment_id": 102603836, "body": "thank you for the explanation. I was confused since I&#39;m using <code>graphql-go</code> which I assumed used the default <code>encoding&#47;json</code> for its output, but it does not seem to. When I change the field to be anonymous, it does not flatten it."}, {"owner": {"reputation": 888, "user_id": 1795357, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f85b0ef93603bc344ed36172ee2d98a?s=128&d=identicon&r=PG", "display_name": "ajoseps", "link": "https://stackoverflow.com/users/1795357/ajoseps"}, "edited": false, "score": 0, "creation_date": 1569445854, "post_id": 58106352, "comment_id": 102603866, "body": "seems like I&#39;m not the only one with the same issue: <a href=\"https://github.com/graphql-go/graphql/issues/170\" rel=\"nofollow noreferrer\">github.com/graphql-go/graphql/issues/170</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1569445100, "last_edit_date": 1569445100, "creation_date": 1569444608, "answer_id": 58106352, "question_id": 58106307, "link": "https://stackoverflow.com/questions/58106307/how-do-i-marshal-a-struct-with-an-embdedded-struct-field-to-be-a-flat-json-objec/58106352#58106352", "title": "How do I Marshal a struct with an embdedded struct field to be a flat JSON object in Go?", "body": "<p>Use an anonymous field to flatten the JSON output:</p>\n\n<pre><code>type City struct {\n    City string `json:\"City\"`\n    Size int        `json:\"Size\"`\n}\n\ntype Location struct {\n    City     // &lt;-- anonymous field has type, but no field name\n    State string `json:\"State\"`\n}\n</code></pre>\n\n<p>The <code>MarshalJSON</code> method is ignored in the question because code encodes a <code>Location</code> value, but the <code>MarshalJSON</code> method is declared with a pointer receiver.  Fix by encoding a <code>*Location</code>.</p>\n\n<pre><code>js, _ := json.Marshal(&amp;loc)  // &lt;-- note &amp;\n</code></pre>\n"}], "owner": {"reputation": 888, "user_id": 1795357, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f85b0ef93603bc344ed36172ee2d98a?s=128&d=identicon&r=PG", "display_name": "ajoseps", "link": "https://stackoverflow.com/users/1795357/ajoseps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 58106352, "answer_count": 1, "score": 0, "last_activity_date": 1569445100, "creation_date": 1569444348, "question_id": 58106307, "link": "https://stackoverflow.com/questions/58106307/how-do-i-marshal-a-struct-with-an-embdedded-struct-field-to-be-a-flat-json-objec", "title": "How do I Marshal a struct with an embdedded struct field to be a flat JSON object in Go?", "body": "<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype City struct {\n    City string `json:\"City\"`\n    Size int        `json:\"Size\"`\n}\n\ntype Location struct {\n    City City\n    State string `json:\"State\"`\n}\n\nfunc main() {\n    city := City{City: \"San Francisco\", Size: 8700000}\n    loc := Location{}\n    loc.State = \"California\"\n    loc.City = city\n    js, _ := json.Marshal(loc)\n    fmt.Printf(\"%s\", js)\n}\n</code></pre>\n\n<p>Outputs the following:</p>\n\n<pre><code>{\"City\":{\"City\":\"San Francisco\",\"Size\":8700000},\"State\":\"California\"}\n</code></pre>\n\n<p>The intended output I want is:</p>\n\n<pre><code>{\"City\":\"San Francisco\",\"Size\":8700000,\"State\":\"California\"}\n</code></pre>\n\n<p>I've read this <a href=\"http://choly.ca/post/go-json-marshalling/\" rel=\"nofollow noreferrer\">blog post</a> for custom JSON Marshalling, but I can't seem to get it to work for a struct with another embedded struct.</p>\n\n<p>I tried flattening the struct by defining a custom <code>MarshalJSON</code> function but I still get the same nested output:</p>\n\n<pre><code>func (l *Location) MarshalJSON() ([]byte, error) {\n    return json.Marshal(&amp;struct {\n            City string `json:\"City\"`\n            Size int    `json:\"Size\"`\n            State string `json:\"State\"`\n    }{\n        City: l.City.City,\n        Size: l.City.Size,\n        State:   l.State,\n    })\n}\n</code></pre>\n"}, {"tags": ["windows", "go", "service", "server"], "answers": [{"tags": [], "owner": {"reputation": 455, "user_id": 3543477, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8878da151e113c7a7bcaccd7952a6b51?s=128&d=identicon&r=PG&f=1", "display_name": "user3543477", "link": "https://stackoverflow.com/users/3543477/user3543477"}, "is_accepted": true, "score": 0, "last_activity_date": 1570481667, "creation_date": 1570481667, "answer_id": 58277010, "question_id": 58106069, "link": "https://stackoverflow.com/questions/58106069/launch-a-server-executable-on-a-port-in-windows-using-golang/58277010#58277010", "title": "Launch a server executable on a port in windows using golang", "body": "<p>I had to use the /c to the command in order to execute the command in bash in windows. Without the the command was not being executed. </p>\n\n<pre><code>command := []string{\"/c\", \"C:\\\\Install\\\\Build\\\\server.exe start \" }\nout, err := ExecuteCommandInWindows(command, \"run\")\nif err != \"\" {\n    fmt.Println(err, len(err))\n}else{\n    fmt.Println(out)\n}\n</code></pre>\n"}], "owner": {"reputation": 455, "user_id": 3543477, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8878da151e113c7a7bcaccd7952a6b51?s=128&d=identicon&r=PG&f=1", "display_name": "user3543477", "link": "https://stackoverflow.com/users/3543477/user3543477"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 1, "accepted_answer_id": 58277010, "answer_count": 1, "score": 0, "last_activity_date": 1570481667, "creation_date": 1569443106, "last_edit_date": 1569443501, "question_id": 58106069, "link": "https://stackoverflow.com/questions/58106069/launch-a-server-executable-on-a-port-in-windows-using-golang", "title": "Launch a server executable on a port in windows using golang", "body": "<p>I am trying to launch multiple servers on different ports on my windows machine using golang. This is for an internal testing purpose. </p>\n\n<p>So the end result is to have an executable which will launch multiple instances of my server(another windows executable) on multiple ports. My ideal approach would be to have \"n\" go routines that launch the command \"myserver.exe .\\config.json port+n\" on ports ranging from \"port+0\" to \"port+n\" so that I would have \"n\" servers up and running. I am figuring out a way to launch my server and keep listening until I want the program to end. </p>\n\n<p>I have my server as an windows executable which serves on a port mentioned while launching it. It works fine when I launch it manually. It can be launched as : </p>\n\n<pre><code>C:\\Install\\myServer.exe C:\\Install\\Configuration.json 8079 \n</code></pre>\n\n<p>The above command starts the server and listens to the port 8079. I would like to launch multiple instances of the same server on different ports. The code that I have written following <a href=\"https://stackoverflow.com/questions/35040234/golang-program-doesnt-not-work-on-windows-services\">golang program doesn&#39;t not work on windows services</a> and <a href=\"https://github.com/kardianos/service\" rel=\"nofollow noreferrer\">https://github.com/kardianos/service</a> is below. I can see that the command to start my server has been executed but I donot see any services when I open the services.msc neither when I do a get-service powershell command. I also tried to see if I can listen to the port 8079(in this case) after launching through my go program to see if I get any response but I get the following error: </p>\n\n<pre><code>panic: Get http://localhost:8079/config: dial tcp [::1]:8079: connectex: No connection could be made because the targetmachine actively refused it.\n</code></pre>\n\n<p>Following is the code: </p>\n\n<pre><code>var logger service.Logger\n\ntype program struct{}\n\nfunc (p *program) Start(s service.Service) error {\n    // Start should not block. Do the actual work async.\n    go p.run()\n    return nil\n}\nfunc (p *program) run() {\n    /*// Do work here\n    // the following sleep-print was used for testing if this method is actually being executed and it worked. \n    fmt.Println(\"Waiting\")\n    time.Sleep(3 * time.Second)\n    fmt.Println(\"waited\")\n    */\n    command := \"C:\\\\Install\\\\myServer.exe C:\\\\Install\\\\Configuration.json \"+ flag.Arg(0) \n    fmt.Println(\"Creating the command\", command)\n    c := exec.Command(\"cmd\", command )\n\n    var outb, errb bytes.Buffer\n    c.Stdout = &amp;outb\n    c.Stderr = &amp;errb\n\n    fmt.Println(\"Starting the command\")\n    if err := c.Run(); err != nil { \n        fmt.Println(\"Error: \", err)\n    }else{\n        fmt.Println(\"out:\", outb.String(), \"err:\", errb.String())\n    }\n    fmt.Println(\"After run issued\")\n    //\n}\nfunc (p *program) Stop(s service.Service) error {\n    // Stop should not block. Return with a few seconds.\n    return nil\n}\n\nfunc main() {\n    flag.Parse() // get the source and destination directory\n\n    svcConfig := &amp;service.Config{\n        Name:        \"GoServiceExampleSimple\",\n        DisplayName: \"Go Service Example\",\n        Description: \"This is an example Go service.\",\n    }\n\n    fmt.Printf(\"%v+\", svcConfig)\n\n    prg := &amp;program{}\n    s, err := service.New(prg, svcConfig)\n    if err != nil {\n        fmt.Println(err)\n    }\n    logger, err = s.Logger(nil)\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(\"Main Run\")\n    err = s.Run()\n    fmt.Println(\"After Main Run\")\n    if err != nil {\n        logger.Error(err)\n    }\n}\n</code></pre>\n\n<p>Output of the above code: </p>\n\n<pre><code>Main Run\nCreating the command C:\\Install\\myServer.exe C:\\Install\\Configuration.json 8079\nStarting the command\nout: Microsoft Windows [Version 6.3.9600]\n(c) 2013 Microsoft Corporation. All rights reserved.\n</code></pre>\n\n<p>Thanks in advance :) </p>\n"}, {"tags": ["go", "glide-golang"], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 6243470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/335981a22c1733a215e5d47f9efd8ff6?s=128&d=identicon&r=PG&f=1", "display_name": "Ami", "link": "https://stackoverflow.com/users/6243470/ami"}, "is_accepted": false, "score": -1, "last_activity_date": 1569442867, "creation_date": 1569442867, "answer_id": 58106021, "question_id": 58106020, "link": "https://stackoverflow.com/questions/58106020/https-gonum-org-v1-gonum-not-found/58106021#58106021", "title": "https://gonum.org/v1/gonum Not Found", "body": "<p>gonum.org/v1/gonum is not a package but a filesystem hierarchy which represents a group of packages that are grouped on the basis of the authors' identities. </p>\n\n<p>With glide this will still fail for which the workaround is </p>\n\n<blockquote>\n  <p>glide mirror set <a href=\"https://gonum.org/v1\" rel=\"nofollow noreferrer\">https://gonum.org/v1</a> <a href=\"https://github.com/gonum\" rel=\"nofollow noreferrer\">https://github.com/gonum</a></p>\n</blockquote>\n"}], "owner": {"reputation": 176, "user_id": 6243470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/335981a22c1733a215e5d47f9efd8ff6?s=128&d=identicon&r=PG&f=1", "display_name": "Ami", "link": "https://stackoverflow.com/users/6243470/ami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1569442867, "creation_date": 1569442867, "question_id": 58106020, "link": "https://stackoverflow.com/questions/58106020/https-gonum-org-v1-gonum-not-found", "title": "https://gonum.org/v1/gonum Not Found", "body": "<p>gonum.org/v1/gonum is not being recognized as a go package.\nglide get gonum.org/v1/gonum is erroring out</p>\n\n<blockquote>\n  <p>$> go get gonum.org/v1/gonum\n  can't load package: package gonum.org/v1/gonum: no Go files in /home/binet/dev/go/gocode/src/gonum.org/v1/gonum</p>\n</blockquote>\n"}, {"tags": ["http", "go", "curl"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1569442371, "post_id": 58105449, "comment_id": 102602641, "body": "You want to generate multipart/mixed but call writer.FormDataContentType() which creates a multipart/form-data: Assemble the Content-Type header yourself using writer.Boundary. Your part is not a form field so you cannot use the convenience function writer.CreateFormFields but you should use writer.CreatePart which lets you set the appropriate Content-Type to application/json."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1569480262, "creation_date": 1569480262, "answer_id": 58110947, "question_id": 58105449, "link": "https://stackoverflow.com/questions/58105449/how-to-use-multipart-in-golang/58110947#58110947", "title": "How to use multipart in golang", "body": "<p>Use it like this:</p>\n\n<pre><code>body := &amp;bytes.Buffer{}\nwriter := multipart.NewWriter(body)\n\npart, _ := writer.CreatePart(textproto.MIMEHeader{\"Content-Type\": {\"application/json\"}})\npart.Write(jsonStr)\n\nwriter.Close()\n\nreq, _ := http.NewRequest(\"POST\", \"http://1.1.1.1/blabla\", body)\nreq.Header.Set(\"Content-Type\", writer.FormDataContentType())\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/DO1bWaityqT\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n"}], "owner": {"reputation": 1835, "user_id": 963319, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1b950873c444db9f4ae35d86563b430b?s=128&d=identicon&r=PG", "display_name": "Jenia Ivanov", "link": "https://stackoverflow.com/users/963319/jenia-ivanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1049, "favorite_count": 0, "accepted_answer_id": 58110947, "answer_count": 1, "score": 2, "last_activity_date": 1569480262, "creation_date": 1569440252, "question_id": 58105449, "link": "https://stackoverflow.com/questions/58105449/how-to-use-multipart-in-golang", "title": "How to use multipart in golang", "body": "<p>I need to generate a multipart post request of this form:</p>\n\n<pre><code>POST /blabla HTTP/1.1\nHost: 2.2.2.2\nAuthorization: moreblabla Content-Type: multipart/mixed; boundary=--rs0q5Jq0M2Yt08jU534d1q Content-Length: 347\nNode: 1.1.1.1.1\n--rs0q5Jq0M2Yt08jU534d1q Content-Type: application/json\n\n{\"hello\" : \"world\"}\n--rs0q5Jq0M2Yt08jU534d1q\n\n</code></pre>\n\n<p>(if you know how to generate the above with Curl, please give me a tip too ;))\nI tried the following:</p>\n\n<pre><code>\nvar jsonStr = []byte(`{\"hello\" : \"world\"}`)\n\nfunc main() {\n\n    body := &amp;bytes.Buffer{}\n    writer := multipart.NewWriter(body)\n\n    part, _:= writer.CreateFormField(\"\")\n\n    part.Write(jsonStr)\n    writer.Close()\n\n    req, _ := http.NewRequest(\"POST\", \"blabla\", body)\n    req.Header.Set(\"Content-Type\", writer.FormDataContentType())\n\n   ...\n\n}\n\n</code></pre>\n\n<p>But the server cannot read the content of body. It responds with a 200 HTTP request but it says that the message type is not supported.</p>\n\n<p>So how do I generate a multipart/mixed request that is of the form above?</p>\n\n<p>Thanks kindly in advance for your help.</p>\n"}, {"tags": ["postgresql", "go", "schema", "go-gorm"], "comments": [{"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1569439862, "post_id": 58105342, "comment_id": 102601603, "body": "<code>CREATE TABLE &quot;players.Gangstas&quot;</code> will create a table in the default schema named <code>players.Gangstas</code>. If you want to create a table in a different schema you need to use <code>CREATE TABLE &quot;players&quot;.&quot;Gangstas&quot;</code>"}, {"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1569439915, "post_id": 58105342, "comment_id": 102601620, "body": "If you want to always do that, you can change the search_path for the user <code>alter user elliot set search_path = &#39;players, public&#39;</code>;"}, {"owner": {"reputation": 7545, "user_id": 370605, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/r8v6e.png?s=128&g=1", "display_name": "beauXjames", "link": "https://stackoverflow.com/users/370605/beauxjames"}, "reply_to_user": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1569440057, "post_id": 58105342, "comment_id": 102601670, "body": "this isn&#39;t relevant to the configuration of the gorm ORM"}, {"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1569440100, "post_id": 58105342, "comment_id": 102601684, "body": "The search_path is irrelevant from the client"}, {"owner": {"reputation": 7545, "user_id": 370605, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/r8v6e.png?s=128&g=1", "display_name": "beauXjames", "link": "https://stackoverflow.com/users/370605/beauxjames"}, "reply_to_user": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1569440586, "post_id": 58105342, "comment_id": 102601836, "body": "@a_horse_with_no_name - get that...but the question is whether or not I can have Gorm prepend the schema to the table within each query"}, {"owner": {"reputation": 7545, "user_id": 370605, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/r8v6e.png?s=128&g=1", "display_name": "beauXjames", "link": "https://stackoverflow.com/users/370605/beauxjames"}, "reply_to_user": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1569443575, "post_id": 58105342, "comment_id": 102603108, "body": "@a_horse_with_no_name - the only option seems to be via DB configuration, so I found the query &#39;SET search_path TO players&#39; is scoped to the current DB connection, so it&#39;ll do for now!"}], "owner": {"reputation": 7545, "user_id": 370605, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/r8v6e.png?s=128&g=1", "display_name": "beauXjames", "link": "https://stackoverflow.com/users/370605/beauxjames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 728, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569908570, "creation_date": 1569439714, "last_edit_date": 1569908570, "question_id": 58105342, "link": "https://stackoverflow.com/questions/58105342/how-do-i-set-postgres-db-schema-for-all-golang-gorm-orm-query-statements", "title": "How do I set Postgres DB Schema for all Golang Gorm ORM query statements?", "body": "<p>I have many different schemas in a single instance of a Postgres DB. I am creating a simple GoLang service that needs to connect to one or more schemas.</p>\n\n<p>In configuring the DB connection there seems to be no way to point to any specific schema, nor on the Model itself. How can I add {schema}.Model to my queries?</p>\n\n<pre><code>main() {\n  db, err = gorm.Open(\"postgres\", \"host=localhost port=5432 user=elliot password=ness dbname=goodfellas sslmode=disable\")\n  defer db.Close()\n\n  db.CreateTable(&amp;Gangsta{})\n}\ntype Gangsta struct {\n  gorm.Model\n  Name string\n}\n</code></pre>\n\n<p>I would like for this particular table to be created in Postgres DB 'goodfellas' in the 'players' schema, making a statement like </p>\n\n<pre><code> CREATE TABLE \"players.Gangstas\" (\"id\" serial,\"created_at\" timestamp with time zone,\"updated_at\" timestamp with time zone,\"deleted_at\" timestamp with time zone,\"name\" text , PRIMARY KEY (\"id\"))\n</code></pre>\n\n<p>Same goes for all other SQL queries...</p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1569439852, "creation_date": 1569439852, "answer_id": 58105371, "question_id": 58105298, "link": "https://stackoverflow.com/questions/58105298/how-to-not-store-key-in-datastore/58105371#58105371", "title": "How to not store __key__ in datastore", "body": "<p>Use the datastore name \"-\" to ignore the field when saving or loading the entity.</p>\n\n<pre><code>type UserDetails struct {\n    UserID    string `datastore:\"-\"` // &lt;-- change on this line\n    Name      string\n    UserEmail string\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1030, "user_id": 4624877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f91dadad091002fe1a5a4867bc954721?s=128&d=identicon&r=PG&f=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/4624877/siva"}, "is_accepted": false, "score": 0, "last_activity_date": 1569439974, "creation_date": 1569439974, "answer_id": 58105401, "question_id": 58105298, "link": "https://stackoverflow.com/questions/58105298/how-to-not-store-key-in-datastore/58105401#58105401", "title": "How to not store __key__ in datastore", "body": "<p>According to the following, \"<strong>key</strong>\" has to be a *datastore.Key type but you are using string type. Don't know if that has an effect.</p>\n\n<p><a href=\"https://godoc.org/cloud.google.com/go/datastore#hdr-Key_Field\" rel=\"nofollow noreferrer\">https://godoc.org/cloud.google.com/go/datastore#hdr-Key_Field</a></p>\n\n<p>But for what you are trying to achieve, you can do either of two things. Change UserID to \"userID\" and not specify a tag or use</p>\n\n<p>UserID string `datastore:\"-\"`</p>\n\n<p>This will prevent it from being stored.</p>\n"}], "owner": {"reputation": 6598, "user_id": 504717, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/598508c7ef12ece4ca6c1c0f542e5dcd?s=128&d=identicon&r=PG", "display_name": "Em Ae", "link": "https://stackoverflow.com/users/504717/em-ae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 58105371, "answer_count": 2, "score": 0, "last_activity_date": 1569439974, "creation_date": 1569439499, "question_id": 58105298, "link": "https://stackoverflow.com/questions/58105298/how-to-not-store-key-in-datastore", "title": "How to not store __key__ in datastore", "body": "<p>Here is how i am persisting data to datastore</p>\n\n<pre><code>type UserDetails struct {\n    UserID    string `datastore:\"__key__\"`\n    Name      string\n    UserEmail string\n}\n\nfunc (c DataStoreClient) Put(ctx context.Context, orgID string, ud *UserDetails) (id int64, err error) {\n    key := datastore.NameKey(userKind, ud.UserID, nil)\n    key.Namespace = orgID\n\n    k, err := c.client.Put(ctx, key, ud)\n    if err != nil {\n        return 0, err\n    }\n    return k.ID, nil\n}\n\nfunc (ud *DataStoreUserDetails) Save() ([]datastore.Property, error) {\n    return datastore.SaveStruct(ud)\n}\n\nfunc (ud *DataStoreUserDetails) LoadKey(k *datastore.Key) error {\n    ud.UserID = k.Name\n    return nil\n}\n\nfunc (ud *DataStoreUserDetails) Load(ps []datastore.Property) error {\n    return datastore.LoadStruct(ud, ps)\n}\n</code></pre>\n\n<p>When i call <code>Put</code> method, i am able to store <code>UserDetails</code> successfully in datastore. But, along with all the columns in <code>UserDetails</code>, I can also see <code>__key__</code> column. I don't want that. I want to keep <code>UserID</code> as the key for this table. </p>\n\n<p>How can i do that? </p>\n"}, {"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 3, "creation_date": 1569433440, "post_id": 58103857, "comment_id": 102598959, "body": "Use a <code>map</code> if you don&#39;t know the keys ahead of time."}, {"owner": {"reputation": 77, "user_id": 6736522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5538141650e7a5bd5216282644204952?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Bennett", "link": "https://stackoverflow.com/users/6736522/paul-bennett"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1569437325, "post_id": 58103857, "comment_id": 102600572, "body": "Thanks. Can you point me to any example that preserves arbitrarily complex yaml? The examples I&#39;ve seen have specific maps for specific yaml.   This is particularly relevant for Kubernetes where a core programming technique is getting resource yaml (often complex, often poorly documented), updating some field(s), and then applying the modified yaml. I&#39;m porting function currently implemented in Javascript (yaml converted to JSON) where dynamically accessing fields and preserving all input fields is just built in to the language. I&#39;m trying to consolidate some bash and javascript to go."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1569438352, "post_id": 58103857, "comment_id": 102600986, "body": "this is <a href=\"https://mengzhuo.github.io/yaml-to-go/\" rel=\"nofollow noreferrer\">YAML-to-go generator</a> is a good on-line resource for building <code>go</code> compatible structs given sample input <code>YAML</code>."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1569507728, "post_id": 58103857, "comment_id": 102626765, "body": "I just posted an answer based on what I think your source YAML looks like..."}], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 6736522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5538141650e7a5bd5216282644204952?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Bennett", "link": "https://stackoverflow.com/users/6736522/paul-bennett"}, "is_accepted": false, "score": 1, "last_activity_date": 1569503794, "last_edit_date": 1569503794, "creation_date": 1569462109, "answer_id": 58108467, "question_id": 58103857, "link": "https://stackoverflow.com/questions/58103857/how-do-i-modify-a-yaml-field-in-go-when-i-dont-know-every-possible-field-in-the/58108467#58108467", "title": "How do I modify a yaml field in go when I don&#39;t know every possible field in the yaml?", "body": "<p>Unmarshalling with <code>map[interface{}]interface{}</code> did the trick:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>            wcc := make(map[interface{}]interface{})\n            err := yaml.Unmarshal([]byte(wccString), &amp;wcc)\n</code></pre>\n\n<p>The  notation to access the yaml structure is not intuitive (to me), but I did eventually find an incantation that works:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>wcc[\"extensions\"].(map[interface{}]interface{})[\"scriptURLs\"].([]interface{})[2] = \"https://192.168.0.3:8080/...\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 1, "last_activity_date": 1569507612, "creation_date": 1569507612, "answer_id": 58118885, "question_id": 58103857, "link": "https://stackoverflow.com/questions/58103857/how-do-i-modify-a-yaml-field-in-go-when-i-dont-know-every-possible-field-in-the/58118885#58118885", "title": "How do I modify a yaml field in go when I don&#39;t know every possible field in the yaml?", "body": "<p>Guessing what your YAML looks like based on your answer, perhaps something like this would work:</p>\n\n<pre><code>//\n// a map (string index) of map (string index) of a string slice\n//\ntype mystruct map[string]map[string][]string\n\n//\n// guessing what your YAML looks like:\n//\nwccYAML = `\nextensions:\n  scriptURLs:\n    - 'https://localhost:9000'\n    - 'https://localhost:9001'\n    - 'https://localhost:9002'\n`\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/wvkr2pFk-0j\" rel=\"nofollow noreferrer\">https://play.golang.org/p/wvkr2pFk-0j</a></p>\n\n<p>Generally one wants to avoid using <code>interface{}</code> as you have seen the casting gets messy very quickly.</p>\n"}], "owner": {"reputation": 77, "user_id": 6736522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5538141650e7a5bd5216282644204952?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Bennett", "link": "https://stackoverflow.com/users/6736522/paul-bennett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1569507612, "creation_date": 1569433158, "question_id": 58103857, "link": "https://stackoverflow.com/questions/58103857/how-do-i-modify-a-yaml-field-in-go-when-i-dont-know-every-possible-field-in-the", "title": "How do I modify a yaml field in go when I don&#39;t know every possible field in the yaml?", "body": "<p>How can I modify a field in yaml when I don't know every possible field the yaml can have? I can't define a struct that has every possible field, and <code>gopkg.in/yaml.v2</code> <code>Unmarshall</code> ignores fields that are not in the supplied struct, so <code>Marshall</code> loses any fields not in the struct, which is unacceptable.</p>\n\n<p>Is there a package that will allow me to dynamically specify a field name that will either return a basic value or struct if the field exists and nil/err otherwise? And marshall my changes out while preserving  all other fields from the input yaml?</p>\n\n<p>Thanks, Paul</p>\n"}, {"tags": ["templates", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1569434872, "post_id": 58103816, "comment_id": 102599566, "body": "&quot;What am I doing wrong?&quot; You&#39;re not checking the error returned by temp.Execute."}, {"owner": {"reputation": 1087, "user_id": 5205011, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/968219f104811ae38a507aae54cef85b?s=128&d=identicon&r=PG&f=1", "display_name": "davidb", "link": "https://stackoverflow.com/users/5205011/davidb"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569447959, "post_id": 58103816, "comment_id": 102604517, "body": "I checked it now and got this: template: orders.html:2:23: executing &quot;orders.html&quot; at &lt;.Customer&gt;: can&#39;t evaluate field Customer in type []main.Order"}, {"owner": {"reputation": 1087, "user_id": 5205011, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/968219f104811ae38a507aae54cef85b?s=128&d=identicon&r=PG&f=1", "display_name": "davidb", "link": "https://stackoverflow.com/users/5205011/davidb"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569448032, "post_id": 58103816, "comment_id": 102604530, "body": "The way I understand this is I should be calling .Customer as defined in the struct?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569482330, "post_id": 58103816, "comment_id": 102612858, "body": "&quot;can&#39;t evaluate field Customer in type []main.Order&quot; means just what it says. <code>.</code> has type <code>[]Order</code> and slices don&#39;t have fields, so <code>.Customer</code> is nonsensical. You forgot a <code>range</code> action or <code>index</code> call or something like that."}], "owner": {"reputation": 1087, "user_id": 5205011, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/968219f104811ae38a507aae54cef85b?s=128&d=identicon&r=PG&f=1", "display_name": "davidb", "link": "https://stackoverflow.com/users/5205011/davidb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569485126, "creation_date": 1569432991, "last_edit_date": 1569485126, "question_id": 58103816, "link": "https://stackoverflow.com/questions/58103816/problem-displaying-query-results-in-template", "title": "Problem displaying query results in template", "body": "<p>I'm working on a page that will get a variable from the url, run a query against mysql db, fetch results and display them on the page. I'm using templates here.\nI'm following some tutorial and got most of this done, however I'm stuck at one thing.</p>\n\n<pre><code>func dbConnection() (db *sql.DB) {\ndb, err := sql.Open(\"mysql\", \"root:password@tcp(127.0.0.1:3306)/dbname\")\nif err != nil {\n    panic(err.Error())\n}\nreturn db\n}\n\ntype Order struct {\n   Order_id int\n   Customer string\n   Date_of_purchase string\n}\n</code></pre>\n\n<p>And here's my function that's supposed to get the data and render the template:</p>\n\n<pre><code>func CustomerPage(w http.ResponseWriter, r *http.Request)  {\ndb := dbConnection()\n//customer := r.URL.Query().Get(\"username\")\nquery, err := db.Query(\"SELECT * FROM orders WHERE customer='David'\")\nif err != nil {\n    panic(err.Error())\n}\norder := Order{}\nresults := []Order{}\nfor query.Next(){\n    var order_id int\n    var customer, date_of_purchase string\n    query.Scan(&amp;order_id, &amp;customer, &amp;date_of_purchase)\n    order.Order_id = order_id\n    order.Customer = customer\n    order.Date_of_purchase = date_of_purchase\n    results = append(results, order)\n    fmt.Println(order_id)\n    fmt.Println(customer)\n}\nfmt.Println(results)\ntemp, err := template.ParseFiles(\"templates/orders.html\")\ntemp.Execute(w, results)\ndefer query.Close()\n}\n</code></pre>\n\n<p>And finally my template:</p>\n\n<pre><code>&lt;h1&gt;Hello&lt;/h1&gt;\n&lt;h3&gt;Your username is {{ .Customer }}&lt;/h3&gt;\n{{ range . }}\n&lt;h2&gt; {{ .Order_id }}&lt;/h2&gt;\n{{ end }}\n</code></pre>\n\n<p>With the prints I can see that the data is fetched correctly like this:</p>\n\n<pre><code>[{3485208 David 2019-06-03} {4448668 David 2019-03-10} {5727877 David 2019-08-23} {6979516 David 2019-03-04} {8277481 David 2019-02-07}]\n</code></pre>\n\n<p>The problem I'm having is displaying this data in the template. I get only the hard-coded text and no variables. \nWhat am I doing wrong?</p>\n"}, {"tags": ["go", "google-cloud-platform"], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 2, "last_activity_date": 1569464609, "last_edit_date": 1569464609, "creation_date": 1569451487, "answer_id": 58107446, "question_id": 58101663, "link": "https://stackoverflow.com/questions/58101663/how-do-i-run-local-gae-emulator-with-go-1-12/58107446#58107446", "title": "How do I run local GAE emulator with Go 1.12?", "body": "<p>The short answer is that there isn't an emulator for App Engine from Go 1.12 onward. You run your project as a regular Go program because, for the most part, now it <em>is</em> just a regular Go program.</p>\n\n<p>That <code>helloworld</code> example hasn't been updated to follow the new conventions for Go 1.12 on App Engine... notably because it resides WITHIN the old deprecated libraries. You no longer call <code>appengine.Main</code>, just <code>http.ListenAndServe</code> as you'd do normally outside App Engine.</p>\n\n<p>They've come (mostly) full circle and opened it up so that the standard library calls that you would use in a normal Go program are now what you use on App Engine, with a few exceptions. This makes it easy to push almost any existing standalone Go program to App Engine with much less friction, which is a win for them and a win for developers.</p>\n\n<p>Even if you are starting fresh and not migrating from the legacy SDK you should give this article a read, as it outlines a number of changes that you'll want to be aware of and watch out for in open source libs that could possibly still be legacy. If you are migrating it will be especially useful.</p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/standard/go112/go-differences\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/standard/go112/go-differences</a></p>\n\n<p>Notable snippet:</p>\n\n<blockquote>\n  <p>App Engine no longer modifies the Go toolchain to include the appengine package. If you are using the appengine package or the google.golang.org/appengine package, you must migrate to the Google Cloud client library.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1053, "user_id": 1067450, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/FEqxy.jpg?s=128&g=1", "display_name": "AXSM", "link": "https://stackoverflow.com/users/1067450/axsm"}, "is_accepted": false, "score": 0, "last_activity_date": 1592583951, "creation_date": 1592583951, "answer_id": 62474613, "question_id": 58101663, "link": "https://stackoverflow.com/questions/58101663/how-do-i-run-local-gae-emulator-with-go-1-12/62474613#62474613", "title": "How do I run local GAE emulator with Go 1.12?", "body": "<p>Maybe is late, but I was using dev_appserver.py bla,bla,bla but after an <code>gcloud components update</code>, the script stoped working, but still you can use:  </p>\n\n<pre><code>go run .\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 11843526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f12747264bfd62cf5cb57d00d7728d?s=128&d=identicon&r=PG&f=1", "display_name": "GolangNewb", "link": "https://stackoverflow.com/users/11843526/golangnewb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 58107446, "answer_count": 2, "score": 3, "last_activity_date": 1592583951, "creation_date": 1569424507, "question_id": 58101663, "link": "https://stackoverflow.com/questions/58101663/how-do-i-run-local-gae-emulator-with-go-1-12", "title": "How do I run local GAE emulator with Go 1.12?", "body": "<p>With Go 1.9 you ran a local GAE emulator with \"dev_appserver.py yaml\"</p>\n\n<p>It seems google-cloud-sdk/ is deprecated.</p>\n\n<p>The Go 1.12 documentation says you can run an emulator locally with \"go run\"\n<a href=\"https://cloud.google.com/appengine/docs/standard/go112/testing-and-deploying-your-app\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/standard/go112/testing-and-deploying-your-app</a></p>\n\n<p>I was not able to run the demo app at with:<br>\ngoogle.golang.org/appengine/demos/helloworld</p>\n\n<p>$ go run *.go</p>\n\n<pre><code>2019/09/25 10:57:27 INFO: Serving the front page.\npanic: Metadata fetch failed for 'instance/attributes/gae_project': Get http://metadata/computeMetadata/v1/instance/attributes/gae_project: dial tcp: lookup metadata: no such host\n\ngoroutine 5 [running]:\ngoogle.golang.org/appengine/internal.mustGetMetadata(0x1474a38, 0x1f, 0x0, 0x0, 0x0)\n    /Users/Steve/go/src/google.golang.org/appengine/internal/metadata.go:34 +0x18a\ngoogle.golang.org/appengine/internal.partitionlessAppID(0x0, 0xc0000304c0)\n    /Users/Steve/go/src/google.golang.org/appengine/internal/identity_vm.go:112 +0xa2\ngoogle.golang.org/appengine/internal.DefaultTicket.func1()\n    /Users/Steve/go/src/google.golang.org/appengine/internal/api.go:294 +0x86\nsync.(*Once).Do(0x17f0150, 0x1484448)\n    /usr/local/go/src/sync/once.go:44 +0xb3\ngoogle.golang.org/appengine/internal.DefaultTicket(0xc0001945d0, 0x13b78e0)\n    /Users/Steve/go/src/google.golang.org/appengine/internal/api.go:289 +0x39\ngoogle.golang.org/appengine/internal.Call(0x14d9f00, 0xc0001945d0, 0x146a718, 0xa, 0x14666df, 0x5, 0x14d8ec0, 0xc0000304c0, 0x14d80c0, 0xc00000c1e0, ...)\n    /Users/Steve/go/src/google.golang.org/appengine/internal/api.go:496 +0x8ea\ngoogle.golang.org/appengine/internal.(*context).flushLog(0xc0001920c0, 0x1484b01, 0xc00002e100)\n    /Users/Steve/go/src/google.golang.org/appengine/internal/api.go:641 +0x3c7\ngoogle.golang.org/appengine/internal.handleHTTP.func1(0xc00002e120, 0xc0001920c0)\n    /Users/Steve/go/src/google.golang.org/appengine/internal/api.go:138 +0x56\ncreated by google.golang.org/appengine/internal.handleHTTP\n    /Users/Steve/go/src/google.golang.org/appengine/internal/api.go:134 +0x350\nexit status 2\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["json", "algorithm", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569422960, "post_id": 58101125, "comment_id": 102593841, "body": "What have you tried? Include your code. What specific problem are you having?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569423129, "post_id": 58101125, "comment_id": 102593941, "body": "Create a matching structure using structs and slices, you can start with a flat node (step 1), then add a slice of nodes (step 2), and you&#39;re done."}, {"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 1, "creation_date": 1569425983, "post_id": 58101125, "comment_id": 102595649, "body": "Go and the JSON library both support structs defined recursively, i.e. the struct has a field whose type is the struct itself."}, {"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1569426112, "post_id": 58101125, "comment_id": 102595725, "body": "@Flimzy The provided duplicate is not the same problem -- nested payloads vs. recursive payloads are two different things."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1569426266, "post_id": 58101125, "comment_id": 102595806, "body": "@Jesse: JSON doesn&#39;t permit recursion, and the question doesn&#39;t show recursion. So where are you getting that recursion is related?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569426684, "post_id": 58101125, "comment_id": 102596009, "body": "If there&#39;s something that the duplicate question doesn&#39;t answer, the OP is invited (in the automatically added text) to submit a new question. But the options for <i>this</i> question are to close it as a duplicate, or close it as off-topic for not including the code to be debugged. Closing it as off-topic seems the more charitable, and most likely to help."}, {"owner": {"reputation": 76, "user_id": 4951966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NXWvVkuXd-A/AAAAAAAAAAI/AAAAAAAAACQ/CvXhj-1i1HY/photo.jpg?sz=128", "display_name": "Rama Bramantara", "link": "https://stackoverflow.com/users/4951966/rama-bramantara"}, "edited": false, "score": 0, "creation_date": 1569428006, "post_id": 58101125, "comment_id": 102596614, "body": "how about this? <code>res := map[string]interface{}{}</code> -&gt; <code>json.Unmarshal(jsondata, &amp;res)</code> <a href=\"https://play.golang.org/p/rtwwGF1CJyi\" rel=\"nofollow noreferrer\">Playground</a>. Be more specific on describe you problem please"}, {"owner": {"reputation": 764, "user_id": 7680208, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/km5EG.png?s=128&g=1", "display_name": "virullius", "link": "https://stackoverflow.com/users/7680208/virullius"}, "edited": false, "score": 2, "creation_date": 1569429297, "post_id": 58101125, "comment_id": 102597162, "body": "Not a duplicate, and is recursive. <a href=\"https://play.golang.org/p/OWVdsH8BfpO\" rel=\"nofollow noreferrer\">play.golang.org/p/OWVdsH8BfpO</a>"}, {"owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "reply_to_user": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "edited": false, "score": 0, "creation_date": 1569436398, "post_id": 58101125, "comment_id": 102600184, "body": "@Jesse thx for help"}, {"owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "reply_to_user": {"reputation": 764, "user_id": 7680208, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/km5EG.png?s=128&g=1", "display_name": "virullius", "link": "https://stackoverflow.com/users/7680208/virullius"}, "edited": false, "score": 0, "creation_date": 1569436466, "post_id": 58101125, "comment_id": 102600215, "body": "@mjb2kmn thx.  i got it."}, {"owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569436569, "post_id": 58101125, "comment_id": 102600259, "body": "@Flimzy yes you r right. i should post my code first"}, {"owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "reply_to_user": {"reputation": 76, "user_id": 4951966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NXWvVkuXd-A/AAAAAAAAAAI/AAAAAAAAACQ/CvXhj-1i1HY/photo.jpg?sz=128", "display_name": "Rama Bramantara", "link": "https://stackoverflow.com/users/4951966/rama-bramantara"}, "edited": false, "score": 0, "creation_date": 1569436805, "post_id": 58101125, "comment_id": 102600353, "body": "@RamaBramantara sorry for my pool english. actually, i wanna get everyname in the json. Jesse is right, it is a  recursive problem."}, {"owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569436849, "post_id": 58101125, "comment_id": 102600373, "body": "@mkopriva yep, that&#39;s another way. thx"}], "owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "closed_date": 1569423551, "answer_count": 0, "score": 0, "last_activity_date": 1569435581, "creation_date": 1569422836, "last_edit_date": 1569435581, "question_id": 58101125, "link": "https://stackoverflow.com/questions/58101125/how-to-unmarshall-multi-layer-json", "closed_reason": "Duplicate", "title": "how to unmarshall multi-layer JSON", "body": "<p>I got nested JSON code like below, what looks like a tree, having multi-layer child node.\nSo how unmarshall it in Go? Anyone has a good idea?</p>\n\n<pre><code>{\n   \"name\": \"mark\",\n   \"sons\": [\n     {\n       \"name\": \"markson1\"\n     },\n     {\n       \"name\": \"markson2\",\n       \"sons\": [\n         {\n           \"name\": \"markson21\",\n           \"sons\": [\n             {\n               \"name\": \"markson211\"\n             }\n           ]\n         }\n       ]\n     }\n   ]\n}\n</code></pre>\n\n<p>sorry for bothering you, I just resolved the problem by using recursive call. anyway, thx all.</p>\n\n<p>here is my code: </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Unmarshal(j string) error {\n    obj, err := simplejson.NewJson([]byte(j))\n    if err != nil {\n        return err\n    }\n    foo := make(map[string]byte)\n    bar, err := recursion(foo, obj);\n    if err != nil {\n        return err\n    }\n    bar[obj.Get(\"name\").MustString()]=0\n    fmt.Println(bar)\n    return nil\n}\n\nfunc recursion(foo map[string]byte, obj *simplejson.Json) (map[string]byte, error) {\n    if exist(obj) {\n        sonsObj := obj.Get(\"sons\")\n        sons, err := sonsObj.Array()\n        if err != nil {\n            return nil, err\n        }\n        for key, _ := range sons {\n            obj = sonsObj.GetIndex(key)\n            n := obj.Get(\"name\").MustString()\n            foo[n]=0\n            tmp, err := recursion(foo, obj)\n            if err != nil {\n                return nil, err\n            }\n            for k, _ := range tmp {\n                foo[k]=0\n            }\n        }\n    }\n    return foo, nil\n}\n\nfunc exist(obj *simplejson.Json) bool {\n    _, exist := obj.CheckGet(\"sons\")\n    return exist\n}\n</code></pre>\n\n<p>output:<br>\nmap[mark:0 markson1:0 markson2:0 markson21:0 markson211:0]<br>\n--- PASS: TestUnmarshal (0.00s)<br>\n--- PASS: TestUnmarshal/#00 (0.00s)<br>\nPASS  </p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1569419422, "post_id": 58099901, "comment_id": 102591675, "body": "if any of those are nil, <code>D</code> <i>can&#39;t</i> be an empty string, because its memory won&#39;t be allocated.  <code>C* C</code> (or an upper level) won&#39;t exist to hold <code>D</code>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1569419818, "post_id": 58099901, "comment_id": 102591928, "body": "You can&#39;t really avoid the repetitive statements."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1569420816, "post_id": 58099901, "comment_id": 102592568, "body": "In my opinion an elegant way is to add getter methods that do the <code>nil</code> check, and then you can naturally chain the calls, no runtime panic will occur. This &quot;technique&quot; is also used in the generated Go code by protobuf. See it in <a href=\"https://stackoverflow.com/a/58100426/1705598\">my answer of the marked duplicate</a>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1569421217, "post_id": 58099901, "comment_id": 102592798, "body": "And here&#39;s the solution to your concrete example: <a href=\"https://play.golang.org/p/trzctjbqmDD\" rel=\"nofollow noreferrer\">Go Playground</a>. Basically the final code is like: <code>if a.B.GetC().GetD() != &quot;&quot; { ... }</code> \u2013 which does what you expect from it, and it never panics."}], "owner": {"reputation": 448, "user_id": 480673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7db33c79f4d18058f12cc4705747b55?s=128&d=identicon&r=PG", "display_name": "Dionysius", "link": "https://stackoverflow.com/users/480673/dionysius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "closed_date": 1569419927, "answer_count": 0, "score": 0, "last_activity_date": 1569419206, "creation_date": 1569419206, "question_id": 58099901, "link": "https://stackoverflow.com/questions/58099901/elegant-way-to-if-check-a-property-within-a-struct-chain-of-nil-pointers", "closed_reason": "Duplicate", "title": "Elegant way to `if` check a property within a struct chain of nil pointers", "body": "<p>Example (<a href=\"https://play.golang.org/p/OkNHkYYpg-D\" rel=\"nofollow noreferrer\">go playgrounds</a>)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A struct {\n  B *B\n}\n\ntype B struct {\n  C *C\n}\n\ntype C struct {\n  D string\n}\n\nfunc main() {\n\n  a := A{}\n\n  // I'd like to avoid this repetitive statements\n  if a.B != nil &amp;&amp; a.B.C != nil &amp;&amp; a.B.C.D != \"\" {\n    fmt.Println(\"no nil-pointer panic here\")\n  }\n\n  // I'd like to go into that if body if any of these are nil and D is not empty string\n  if a.B.C.D != \"\" {\n    fmt.Println(\"nil-pointer panic here\")\n  }\n\n}\n</code></pre>\n\n<p>I can't figure out a way to check if a property is empty in a chain of pointers which should also result into <code>false</code> if any of them is nil. Assume these fields have a bit of a longer name - and the struct is a bit more complex - this gets unreadable pretty fast. But maybe there's no other way...</p>\n"}, {"tags": ["go", "visual-studio-code", "windows-subsystem-for-linux"], "comments": [{"owner": {"reputation": 751, "user_id": 606576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3255056ffc684ad96fadf59304476dcf?s=128&d=identicon&r=PG", "display_name": "kthy", "link": "https://stackoverflow.com/users/606576/kthy"}, "edited": false, "score": 0, "creation_date": 1571832770, "post_id": 58096783, "comment_id": 103370298, "body": "I&#39;m experiencing the same issue, except <code>go get -v</code> doesn&#39;t work for me either. VS Code 1.39.2, Ubuntu 18.04 on WSL 1 / Windows 10, go-1.13 from the longsleep backport. <code>$ go get -v github.com&#47;go-delve&#47;delve&#47;cmd&#47;dlv go: extracting golang.org&#47;x&#47;sys v0.0.0-20191008105621-543471e840be build github.com&#47;go-delve&#47;delve&#47;cmd&#47;dlv: cannot load golang.org&#47;x&#47;sys&#47;unix: rename &#47;home&#47;ktri&#47;go&#47;pkg&#47;mod&#47;golang.org&#47;x&#47;sys@v0.0.0-20191008105621&zwnj;&#8203;-543471e840be.tmp-96&zwnj;&#8203;8345340 &#47;home&#47;ktri&#47;go&#47;pkg&#47;mod&#47;golang.org&#47;x&#47;sys@v0.0.0-20191008105621&zwnj;&#8203;-543471e840be: permission denied</code>"}, {"owner": {"reputation": 751, "user_id": 606576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3255056ffc684ad96fadf59304476dcf?s=128&d=identicon&r=PG", "display_name": "kthy", "link": "https://stackoverflow.com/users/606576/kthy"}, "edited": false, "score": 0, "creation_date": 1571834118, "post_id": 58096783, "comment_id": 103371036, "body": "It looks like it is related to permissions - if I do an <code>ls -la</code> in <code>$GOROOT&#47;go&#47;pkg&#47;mod</code> the problematic packages are marked 500, i.e. read-only. Weirdly enough some packages install fine."}, {"owner": {"reputation": 751, "user_id": 606576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3255056ffc684ad96fadf59304476dcf?s=128&d=identicon&r=PG", "display_name": "kthy", "link": "https://stackoverflow.com/users/606576/kthy"}, "edited": false, "score": 0, "creation_date": 1571861757, "post_id": 58096783, "comment_id": 103384592, "body": "Just tried wiping my go installation, installed the official binary from golang.org and ran <code>go get</code> from bash. Same error, so seems unrelated to VS Code. Possibly caused by WSL running on NTFS screwing up file permissions."}, {"owner": {"reputation": 751, "user_id": 606576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3255056ffc684ad96fadf59304476dcf?s=128&d=identicon&r=PG", "display_name": "kthy", "link": "https://stackoverflow.com/users/606576/kthy"}, "edited": false, "score": 0, "creation_date": 1571953266, "post_id": 58096783, "comment_id": 103419872, "body": "Now I tried with the Windows version of Go and I&#39;m seeing the same issue. Some packages can&#39;t install from VS Code, and some packages won&#39;t install at all. I&#39;m beginning to think it&#39;s something else. Do you have any kind of antivirus installed? I&#39;m forced to run McAfee here."}, {"owner": {"reputation": 47, "user_id": 11764428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699b5963168bb7097db2cd9bd5cba18d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex_M6", "link": "https://stackoverflow.com/users/11764428/alex-m6"}, "reply_to_user": {"reputation": 751, "user_id": 606576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3255056ffc684ad96fadf59304476dcf?s=128&d=identicon&r=PG", "display_name": "kthy", "link": "https://stackoverflow.com/users/606576/kthy"}, "edited": false, "score": 0, "creation_date": 1572069718, "post_id": 58096783, "comment_id": 103454554, "body": "Just tried to reproduce the issue and found out that it&#39;s gone. All packages install correctly through &quot;Go: Install/Update tools&quot; as well as bash go get -v. I totally confused! Before that, I had reinstalled Win10 about a week ago. Maybe it was the reason."}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 11764428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699b5963168bb7097db2cd9bd5cba18d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex_M6", "link": "https://stackoverflow.com/users/11764428/alex-m6"}, "is_accepted": false, "score": 3, "last_activity_date": 1574506747, "creation_date": 1574506747, "answer_id": 59006884, "question_id": 58096783, "link": "https://stackoverflow.com/questions/58096783/visual-studio-code-cant-install-the-go-tools/59006884#59006884", "title": "Visual Studio code can&#39;t install the Go tools", "body": "<p>That's a known problem with the WSL file system implementation (<a href=\"https://github.com/Microsoft/WSL/issues/3395\" rel=\"nofollow noreferrer\">Microsoft/WSL#3395, Microsoft/WSL#1956</a>) caused by the file watcher active by VSCode. The issue will only be fixed in WSL 2.</p>\n\n<p>As a workaround, you can just exclude folders pkg and bin from Workspace.\n<a href=\"https://code.visualstudio.com/docs/remote/wsl#_i-see-eaccess-permission-denied-error-trying-to-rename-a-folder-in-the-open-workspace\" rel=\"nofollow noreferrer\">More info</a> from the official page.</p>\n"}], "owner": {"reputation": 47, "user_id": 11764428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699b5963168bb7097db2cd9bd5cba18d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex_M6", "link": "https://stackoverflow.com/users/11764428/alex-m6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2348, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574506747, "creation_date": 1569408825, "last_edit_date": 1571894514, "question_id": 58096783, "link": "https://stackoverflow.com/questions/58096783/visual-studio-code-cant-install-the-go-tools", "title": "Visual Studio code can&#39;t install the Go tools", "body": "<p>I try to use VS Code (v1.38.1) via <strong>WSL</strong> and when I launch any go tools installation or command Go:Install/Update tools, I have an issue with permissions. I tried to reinstall WSL and VS Code and got the same result. Manual input <code>go get -v github.com/mdempsky/gocode</code> via embedded terminal works correct.</p>\n\n<p>VS Code output console shows this:</p>\n\n<pre><code>Installing 2 tools at /home/username/go/bin\n  gocode\n  gopkgs\n\nInstalling github.com/mdempsky/gocode FAILED\nInstalling github.com/uudashr/gopkgs/cmd/gopkgs FAILED\n\n2 tools failed to install.\n\ngocode:\nError: Command failed: /usr/local/go/bin/go get -v github.com/mdempsky/gocode\ngo: finding github.com/mdempsky/gocode latest\ngo: extracting github.com/mdempsky/gocode v0.0.0-20190203001940-7fb65232883f\ngo get github.com/mdempsky/gocode: rename /home/username/go/pkg/mod/github.com/mdempsky/gocode@v0.0.0-20190203001940-7fb65232883f.tmp-492884992 /home/username/go/pkg/mod/github.com/mdempsky/gocode@v0.0.0-20190203001940-7fb65232883f: permission denied\ngo: finding github.com/mdempsky/gocode latest\ngo: extracting github.com/mdempsky/gocode v0.0.0-20190203001940-7fb65232883f\ngo get github.com/mdempsky/gocode: rename /home/username/go/pkg/mod/github.com/mdempsky/gocode@v0.0.0-20190203001940-7fb65232883f.tmp-492884992 /home/username/go/pkg/mod/github.com/mdempsky/gocode@v0.0.0-20190203001940-7fb65232883f: permission denied\n\ngopkgs:\nError: Command failed: /usr/local/go/bin/go get -v github.com/uudashr/gopkgs/cmd/gopkgs\ngo: extracting github.com/uudashr/gopkgs v2.0.1+incompatible\ngo get github.com/uudashr/gopkgs/cmd/gopkgs: rename /home/username/go/pkg/mod/github.com/uudashr/gopkgs@v2.0.1+incompatible.tmp-058746657 /home/username/go/pkg/mod/github.com/uudashr/gopkgs@v2.0.1+incompatible: permission denied\ngo: extracting github.com/uudashr/gopkgs v2.0.1+incompatible\ngo get github.com/uudashr/gopkgs/cmd/gopkgs: rename /home/username/go/pkg/mod/github.com/uudashr/gopkgs@v2.0.1+incompatible.tmp-058746657 /home/username/go/pkg/mod/github.com/uudashr/gopkgs@v2.0.1+incompatible: permission denied\n</code></pre>\n\n<p>Here is my <code>go env</code> output:</p>\n\n<pre><code>username@PC_username:~$ go env\nGOARCH=\"amd64\"\nGOCACHE=\"/home/username/.cache/go-build\"\nGOENV=\"/home/username/.config/go/env\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/username/GoProjects\"\nGOPROXY=\"https://proxy.golang.org,direct\"\nGOROOT=\"/usr/local/go\"\nGOSUMDB=\"sum.golang.org\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nAR=\"ar\"\nCC=\"gcc\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build120415101=/tmp/go-build -gno-record-gcc-switches\"\n</code></pre>\n\n<p>Anybody has any idea what may be the issue?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6454289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ec863b4ade367b4c7476e6bdb1cfeb6?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Fariz Hidayat", "link": "https://stackoverflow.com/users/6454289/muhammad-fariz-hidayat"}, "edited": false, "score": 0, "creation_date": 1569463869, "post_id": 58097974, "comment_id": 102607555, "body": "big thanks mas Rama, saya coba implementasikan dulu :D"}], "tags": [], "owner": {"reputation": 76, "user_id": 4951966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NXWvVkuXd-A/AAAAAAAAAAI/AAAAAAAAACQ/CvXhj-1i1HY/photo.jpg?sz=128", "display_name": "Rama Bramantara", "link": "https://stackoverflow.com/users/4951966/rama-bramantara"}, "is_accepted": true, "score": 2, "last_activity_date": 1569413142, "creation_date": 1569413142, "answer_id": 58097974, "question_id": 58096533, "link": "https://stackoverflow.com/questions/58096533/can-i-loop-some-data-json-with-nested-value/58097974#58097974", "title": "can I loop some data json with nested value", "body": "<p>Why your result only showing 1 data? it because of this line of code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>hasil := data[0]\n</code></pre>\n\n<p><code>hasil</code> will always have just one element</p>\n\n<p>also <code>qa</code> will only contains value like this:</p>\n\n<pre><code>{\n  \"ALAMAT_KTP\": \"BOGOR\",\n  \"FULLNAME\": \"Fariz\"\n}\n</code></pre>\n\n<p>it because every <code>data</code> iteration, <code>qa[v[\"FIELD_QUESTION\"].(string)]</code> will keep replaced due to <code>v[\"FIELD_QUESTION\"].(string)</code> is no unique, so in the 3rd iteration of <code>data</code>, the <code>qa[\"ALAMAT_KTP]</code> that already have value <code>\"jalandisana\"</code> is replaced with <code>qa[\"ALAMAT_KTP] = \"Bogor\"</code></p>\n\n<p>I modified your code here: <a href=\"https://play.golang.org/p/Ca4aGPGJwT7\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Ca4aGPGJwT7</a></p>\n\n<p>I use 2 <code>map[string]map[string]interface{}</code> to hold <code>qa</code> and <code>modified data</code>\nand then I combine them into one</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    dataJSON := `[\n        {\n            \"QUICK_DATA_H_ID\": \"1\",\n            \"ORDER_TRX_H_ID\": \"1\",\n            \"FIELD_QUESTION\": \"FULLNAME\",\n            \"FIELD_ANSWER\": \"RUBEN\",\n            \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\"\n        },\n        {\n            \"QUICK_DATA_H_ID\": \"2\",\n            \"ORDER_TRX_H_ID\": \"1\",\n            \"FIELD_QUESTION\": \"ALAMAT_KTP\",\n            \"FIELD_ANSWER\": \"jalandisana\",\n            \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\"\n        },\n        {\n            \"QUICK_DATA_H_ID\": \"3\",\n            \"ORDER_TRX_H_ID\": \"2\",\n            \"FIELD_QUESTION\": \"FULLNAME\",\n            \"FIELD_ANSWER\": \"Fariz\",\n            \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\"\n        },\n        {\n            \"QUICK_DATA_H_ID\": \"4\",\n            \"ORDER_TRX_H_ID\": \"2\",\n            \"FIELD_QUESTION\": \"ALAMAT_KTP\",\n            \"FIELD_ANSWER\": \"Bogor\",\n            \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\"\n        }\n    ]`\n\n    var data, finalResult []map[string]interface{}\n    json.Unmarshal([]byte(dataJSON), &amp;data)\n\n    qa := map[string]map[string]interface{}{}\n    res := map[string]map[string]interface{}{}\n\n    for _, v := range data {\n        if qa[v[\"ORDER_TRX_H_ID\"].(string)] == nil {\n            // initialize the map first if map is nil\n            qa[v[\"ORDER_TRX_H_ID\"].(string)] = make(map[string]interface{})\n        }\n        qa[v[\"ORDER_TRX_H_ID\"].(string)][v[\"FIELD_QUESTION\"].(string)] = v[\"FIELD_ANSWER\"]\n\n        delete(v, \"FIELD_QUESTION\")\n        delete(v, \"FIELD_ANSWER\")\n\n        // only assign res if res[key] is nil to prevent doubled data\n        if res[v[\"ORDER_TRX_H_ID\"].(string)] == nil {\n            res[v[\"ORDER_TRX_H_ID\"].(string)] = v\n        }\n    }\n\n    // combine qa and res in finalResult\n    for k, v := range res {\n        v[\"QUESTION\"] = qa[k]\n        finalResult = append(finalResult, v)\n    }\n\n    hasilJSON, _ := json.MarshalIndent(finalResult, \"\", \"  \")\n\n    fmt.Println(string(hasilJSON))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[\n  {\n    \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\",\n    \"ORDER_TRX_H_ID\": \"1\",\n    \"QUESTION\": {\n      \"ALAMAT_KTP\": \"jalandisana\",\n      \"FULLNAME\": \"RUBEN\"\n    },\n    \"QUICK_DATA_H_ID\": \"1\"\n  },\n  {\n    \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\",\n    \"ORDER_TRX_H_ID\": \"2\",\n    \"QUESTION\": {\n      \"ALAMAT_KTP\": \"Bogor\",\n      \"FULLNAME\": \"Fariz\"\n    },\n    \"QUICK_DATA_H_ID\": \"3\"\n  }\n]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6454289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ec863b4ade367b4c7476e6bdb1cfeb6?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Fariz Hidayat", "link": "https://stackoverflow.com/users/6454289/muhammad-fariz-hidayat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58097974, "answer_count": 1, "score": -2, "last_activity_date": 1569413142, "creation_date": 1569407972, "last_edit_date": 1569411539, "question_id": 58096533, "link": "https://stackoverflow.com/questions/58096533/can-i-loop-some-data-json-with-nested-value", "title": "can I loop some data json with nested value", "body": "<p>When I got a new data json ORDER_TRX_H_ID the result must looping with new ORDER_TRX_H_ID, but my result always show last data.</p>\n\n<p>My code is</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    dataJSON := `[\n{\n    \"QUICK_DATA_H_ID\": \"1\",\n    \"ORDER_TRX_H_ID\": \"1\",\n    \"FIELD_QUESTION\": \"FULLNAME\",\n    \"FIELD_ANSWER\": \"RUBEN\",\n    \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\"\n},\n{\n    \"QUICK_DATA_H_ID\": \"2\",\n    \"ORDER_TRX_H_ID\": \"1\",\n    \"FIELD_QUESTION\": \"ALAMAT_KTP\",\n    \"FIELD_ANSWER\": \"jalandisana\",\n    \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\"\n},\n{\n    \"QUICK_DATA_H_ID\": \"3\",\n    \"ORDER_TRX_H_ID\": \"2\",\n    \"FIELD_QUESTION\": \"FULLNAME\",\n    \"FIELD_ANSWER\": \"Fariz\",\n    \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\"\n},\n{\n    \"QUICK_DATA_H_ID\": \"4\",\n    \"ORDER_TRX_H_ID\": \"2\",\n    \"FIELD_QUESTION\": \"ALAMAT_KTP\",\n    \"FIELD_ANSWER\": \"Bogor\",\n    \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\"\n}\n    ]`\n    var data []map[string]interface{}\n    json.Unmarshal([]byte(dataJSON), &amp;data)\n    qa := map[string]interface{}{}\n    for _, v := range data {\n        qa[v[\"FIELD_QUESTION\"].(string)] = v[\"FIELD_ANSWER\"]\n    }\n    hasil := data[0]\n    hasil[\"QUESTION\"] = qa\n    delete(hasil, \"FIELD_QUESTION\")\n    delete(hasil, \"FIELD_ANSWER\")\n    hasilJSON, _ := json.MarshalIndent(hasil, \"\", \"  \")\n    fmt.Println(string(hasilJSON))\n}\n</code></pre>\n\n<p>You can run my code \n<a href=\"https://play.golang.org/p/aHUoYZlEQs4\" rel=\"nofollow noreferrer\">https://play.golang.org/p/aHUoYZlEQs4</a></p>\n\n<p>My result always show last data</p>\n\n<pre><code>{\n  \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\",\n  \"ORDER_TRX_H_ID\": \"1\",\n  \"QUESTION\": {\n    \"ALAMAT_KTP\": \"Bogor\",\n    \"FULLNAME\": \"Fariz\"\n  },\n  \"QUICK_DATA_H_ID\": \"1\"\n}\n</code></pre>\n\n<p>my expected result</p>\n\n<pre><code>{\n  \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\",\n  \"ORDER_TRX_H_ID\": \"1\",\n  \"QUESTION\": {\n    \"ALAMAT_KTP\": \"jalandisana\",\n    \"FULLNAME\": \"RUBEN\"\n  },\n  \"QUICK_DATA_H_ID\": \"1\"\n},\n{\n  \"DTM_CRT\": \"2019-08-28T16:25:15.757Z\",\n  \"ORDER_TRX_H_ID\": \"2\",\n  \"QUESTION\": {\n    \"ALAMAT_KTP\": \"Bogor\",\n    \"FULLNAME\": \"Fariz\"\n  },\n  \"QUICK_DATA_H_ID\": \"2\"\n}\n</code></pre>\n"}, {"tags": ["go", "aws-codecommit"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1569403003, "post_id": 58094810, "comment_id": 102582410, "body": "You can clone whatever git repo you want but this is done via <code>git clone</code> and not via <code>go get</code>. Only some code hosting sites and sites with custom headers are go getable. And please installing Go from the official sources only."}, {"owner": {"reputation": 11, "user_id": 12095269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c8e8b899dcbd6631c8b415ac25d6af1?s=128&d=identicon&r=PG&f=1", "display_name": "palle1", "link": "https://stackoverflow.com/users/12095269/palle1"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1569404062, "post_id": 58094810, "comment_id": 102582981, "body": "And what do I do after I have cloned the repo? How do I install the dependencies? I have tried cd into the project and then running &quot;go get ./...&quot; but it results in &quot;no install location for directory /home/me/projects/myGoRepo/cmd/history-parse outside GOPATH&quot;"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1569412527, "post_id": 58094810, "comment_id": 102587455, "body": "Doing Go get./... is clean Nonsenses. Go get all the non-stdlib packages."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 4810898, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7HTTWH_JbT0/AAAAAAAAAAI/AAAAAAAAAH4/donPEyz2noo/photo.jpg?sz=128", "display_name": "Junia Antony", "link": "https://stackoverflow.com/users/4810898/junia-antony"}, "is_accepted": false, "score": -1, "last_activity_date": 1569408848, "creation_date": 1569408848, "answer_id": 58096788, "question_id": 58094810, "link": "https://stackoverflow.com/questions/58094810/how-to-clone-a-repository-in-go/58096788#58096788", "title": "How to clone a repository in go?", "body": "<p>Clone the repositories with <code>git clone</code>. In order to do <code>go get ./...</code> inside 'myGoRepo' repository to install all its dependency packages, you need to place the repository somewhere inside the <code>GOPATH</code> which in your case is <code>$HOME/gopath</code>. e.g., $HOME/gopath/src/myGoRepo</p>\n"}], "owner": {"reputation": 11, "user_id": 12095269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c8e8b899dcbd6631c8b415ac25d6af1?s=128&d=identicon&r=PG&f=1", "display_name": "palle1", "link": "https://stackoverflow.com/users/12095269/palle1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569408848, "creation_date": 1569402045, "last_edit_date": 1569402862, "question_id": 58094810, "link": "https://stackoverflow.com/questions/58094810/how-to-clone-a-repository-in-go", "title": "How to clone a repository in go?", "body": "<p>I am having some issues cloning my go repository to my local machine. </p>\n\n<p>I am running Ubuntu 18 and did a complete reinstall following these commands:</p>\n\n<pre><code>dpkg -l|grep golang  #  if you see any, run following cmd to remove\nsudo apt-get purge golang-*\n\nsudo rm -rf /usr/local/go \n\new_golang_ver=$(curl https://golang.org/VERSION?m=text 2&gt; /dev/null)\ncd /tmp\nwget https://dl.google.com/go/${new_golang_ver}.linux-amd64.tar.gz\nsudo tar -C /usr/local -xzf  ${new_golang_ver}.linux-amd64.tar.gz\n\nAdded these to bashrc\nexport PATH=/usr/local/go/bin:${PATH}\nexport GOPATH=${HOME}/gopath  # typical value change at will\nexport PATH=${GOPATH}/bin:${PATH}\n\nsource ~/.bashrc  \n\ngo version\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code> go version go1.13 linux/amd64\n</code></pre>\n\n<p>Now I have a repository with a go project on AWS Code commit that I would like to Clone. These are the commands I tried and the output:</p>\n\n<pre><code>go get ssh://git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo\npackage ssh:/git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo: ssh:/git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo: invalid import path: malformed import path \"ssh:/git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo\": invalid char ':'\n\ngo get https://git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo\npackage https:/git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo: https:/git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo: invalid import path: malformed import path \"https:/git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo\": invalid char ':'\n\ngo get git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo\npackage git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo: unrecognized import path \"git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo\" (parse https://git-codecommit.eu-west-1.amazonaws.com/v1/repos/myGoRepo?go-get=1: no go-import meta tags ())\n</code></pre>\n\n<p>I can do git clone  just fine though. </p>\n\n<p>So this leads me to two questions:</p>\n\n<ol>\n<li>Can I use go get command with AWS Code Commit at all?</li>\n<li>Can I use git clone command and then install the project in some other way? Where should I clone it? What go commands to use? In my project I have a setup.go file that generates some files as well as a cmd folder with another go file with my main function.</li>\n</ol>\n"}, {"tags": ["mysql", "go", "orm"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569402432, "post_id": 58094234, "comment_id": 102582061, "body": "Can you show the definition of <code>Data</code>? Are its fields exported? Do the tags match the columns? Is <code>d</code> empty or does it contain 5 <code>Data</code> instances with empty fields? please try to be more specific with what&#39;s wrong."}, {"owner": {"reputation": 87, "user_id": 6582712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c874ea468cd513ec09233bb8474bb7ef?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay Sawant", "link": "https://stackoverflow.com/users/6582712/vinay-sawant"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569403213, "post_id": 58094234, "comment_id": 102582520, "body": "Result is saying &quot; In when Debug Print statement returned by library.&quot;"}, {"owner": {"reputation": 87, "user_id": 6582712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c874ea468cd513ec09233bb8474bb7ef?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay Sawant", "link": "https://stackoverflow.com/users/6582712/vinay-sawant"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569403260, "post_id": 58094234, "comment_id": 102582547, "body": "i use db2Struct to automatically create struct just in case if i am doing something wrong..No error is being thrown."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569403730, "post_id": 58094234, "comment_id": 102582783, "body": "Have you executed <code>db2struct</code> properly? Your type&#39;s tags use <code>sql</code>, but gorm, I believe, uses <code>gorm</code> in tags."}, {"owner": {"reputation": 87, "user_id": 6582712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c874ea468cd513ec09233bb8474bb7ef?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay Sawant", "link": "https://stackoverflow.com/users/6582712/vinay-sawant"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569404120, "post_id": 58094234, "comment_id": 102583012, "body": "I added &quot;sql&quot; tag..what is gorm column name tag?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569404336, "post_id": 58094234, "comment_id": 102583148, "body": "<a href=\"http://gorm.io/docs/conventions.html#Snake-Case-Column-Name\" rel=\"nofollow noreferrer\">gorm.io/docs/conventions.html#Snake-Case-Column-Name</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569405375, "post_id": 58094234, "comment_id": 102583722, "body": "... also note that some of your tags are missing quotes and some have more then they should."}, {"owner": {"reputation": 87, "user_id": 6582712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c874ea468cd513ec09233bb8474bb7ef?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay Sawant", "link": "https://stackoverflow.com/users/6582712/vinay-sawant"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569405858, "post_id": 58094234, "comment_id": 102583981, "body": "Thanks its working... But how do i map Mysql date column to time.Time goorm"}], "owner": {"reputation": 87, "user_id": 6582712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c874ea468cd513ec09233bb8474bb7ef?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay Sawant", "link": "https://stackoverflow.com/users/6582712/vinay-sawant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1569403481, "creation_date": 1569400032, "last_edit_date": 1569403481, "question_id": 58094234, "link": "https://stackoverflow.com/questions/58094234/unable-to-get-queried-results-into-go-orm-structs", "title": "Unable to get Queried results into Go orm structs?", "body": "<p>I am trying to fetch mysql sql query into golang structs using goorm library by jinzhu.</p>\n\n<pre><code>SELECT * FROM abc where id=23  and WEEK&gt;=DATE(NOW())-INTERVAL 7 WEEK  ```\n\nSELECT col1,col2,col3 FROM abc where id=23  and WEEK&gt;=DATE(NOW())-INTERVAL 7 WEEK\n</code></pre>\n\n<pre><code>type Data struct {\n    Col1  sql.NullInt64\n    Col2          int `gorm:\"primary_key\" sql:\"COL2\" json:\"col2`\n    Col3            sql.NullString `json:\"col3\" sql:\"COL3\"`\n    Col4     time.Time `json:\"col4\" sql:\"COL4\"`\n    Col5      int `json:\"col5\" sql:\"COL5\"`\n    INCOME          float64 `json:\"col6\" sql:\"COL6\"`\n    INCOMPLETE      sql.NullInt64 `json:\"col7\" sql:\"COL7\"`\n    NUMBEROFDRIVERS sql.NullInt64 `json:\"col8\" sql:\"COL8\"`\n    PARTNERTYPE     sql.NullString `json:\"col9\" sql:\"COL9\"`\n    PRESENTSTATUS   sql.NullString `json:\"col10\" sql:\"COL10\"`\n    RATING          sql.NullFloat64 `json:\"col11\" sql:\"COL11\"`\n    TIER            sql.NullString `json:\"col12\" sql:\"COL12\"`\n    TOTALVEHICLES   sql.NullInt64 `json:\"col13\" sql:\"COL13\"`\n    TRIPS           sql.NullInt64 `json:\"col14\" sql:\"COL14\"`\n    WEEK            time.Time `json:\"col15\"\" sql:\"COL15\"`\n```}\n\nquery tried either from above\n\nI am trying to get data into the go orm structs.\n\n</code></pre>\n\n<p>var d []*Data</p>\n\n<p>result:=db.Table(\"mw_data\").Debug().Raw(query).Scan(&amp;d)\nResult is saying [5 rows affected or returned ] </p>\n\n<pre><code>\nBut I am unable to put those data into struct.\nall the values into fields of struct contains default value.\n\nI tried normal struct as well i tried creating struct using \n&lt;https://github.com/Shelnutt2/db2struct&gt;\n\nusing \"github.com/jinzhu/gorm\" for scanning data into structs\n</code></pre>\n"}, {"tags": ["go", "amazon-s3", "minio"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569396122, "post_id": 58093007, "comment_id": 102578731, "body": "The docs mention a <a href=\"https://godoc.org/github.com/aws/aws-sdk-go/service/s3#Error\" rel=\"nofollow noreferrer\">GoStriong()</a> method. Did you try that?"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 3012542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3254cd522151c4c4436ab72eaad685bd?s=128&d=identicon&r=PG&f=1", "display_name": "labulaka", "link": "https://stackoverflow.com/users/3012542/labulaka"}, "is_accepted": false, "score": 0, "last_activity_date": 1569416611, "creation_date": 1569416611, "answer_id": 58099100, "question_id": 58093007, "link": "https://stackoverflow.com/questions/58093007/how-to-get-the-xml-format-error-response-returned-by-s3-by-using-aws-sdk-go/58099100#58099100", "title": "How to get the xml format error response returned by S3 by using aws-sdk-go?", "body": "<p>I have found the way:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    head := s3.GetObjectInput{Bucket: &amp;bucket, Key: aws.String(\"a\")}\n    req, _ := fs.s3.GetObjectRequest(&amp;head)\n    req.Handlers.UnmarshalMeta.PushBack(func(req *request.Request) {\n        defer req.HTTPResponse.Body.Close()\n\n        //req.HTTPResponse.Header['x-amz-bucket-region']\n        buf, err := ioutil.ReadAll(req.HTTPResponse.Body)\n        fmt.Printf(\"err: %v\", string(buf))\n        return\n    })\n    req.Send()\n</code></pre>\n\n<p>go to <a href=\"https://github.com/aws/aws-sdk-go/issues/542#issuecomment-180893732\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-go/issues/542#issuecomment-180893732</a> for more details.</p>\n"}], "owner": {"reputation": 46, "user_id": 3012542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3254cd522151c4c4436ab72eaad685bd?s=128&d=identicon&r=PG&f=1", "display_name": "labulaka", "link": "https://stackoverflow.com/users/3012542/labulaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1569416611, "creation_date": 1569395696, "last_edit_date": 1569408008, "question_id": 58093007, "link": "https://stackoverflow.com/questions/58093007/how-to-get-the-xml-format-error-response-returned-by-s3-by-using-aws-sdk-go", "title": "How to get the xml format error response returned by S3 by using aws-sdk-go?", "body": "<p>The following response was returned from S3 server:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Error&gt;\n    &lt;Code&gt;BucketAlreadyOwnedByYou&lt;/Code&gt;\n    &lt;Message&gt;Your previous request to create the named bucket succeeded and you already own it.&lt;/Message&gt;\n    &lt;BucketName&gt;newbucket&lt;/BucketName&gt;\n    &lt;Resource&gt;/newbucket&lt;/Resource&gt;\n    &lt;RequestId&gt;15C79B745D6D5C78&lt;/RequestId&gt;\n    &lt;HostId&gt;1c8c1a3a-fe7a-472a-a401-b57d6997aa9e&lt;/HostId&gt;\n&lt;/Error&gt;\n</code></pre>\n\n<p>How to get the xml response from S3 server by using <code>aws-sdk-go</code> when getting an error? I want all the xml response.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func createBucket(s *s3.S3) {\n    out, err := s.CreateBucket(&amp;s3.CreateBucketInput{\n        Bucket: aws.String(\"newbucket\"),\n    })\n}\n</code></pre>\n\n<p>It's not enough to use the <code>err</code> in my case.</p>\n\n<p>Thank you for you time.</p>\n"}, {"tags": ["pointers", "go", "methods", "interface"], "comments": [{"owner": {"reputation": 23850, "user_id": 196679, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fXUzE.jpg?s=128&g=1", "display_name": "Bazzz", "link": "https://stackoverflow.com/users/196679/bazzz"}, "edited": false, "score": 1, "creation_date": 1569395648, "post_id": 58092804, "comment_id": 102578501, "body": "XYZ implements the interface ABC fine, so I think perhaps you misunderstood how Go interfaces work? If a struct has all the methods specified by the interface, it implements it without you having to do anything about that. And that is what you did, XYZ has all the methods specified by ABC, namely <code>a() string</code> and <code>b() int</code>."}, {"owner": {"reputation": 17, "user_id": 12117154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ad02e8fda8fbb2fc5804ecb474bd40?s=128&d=identicon&r=PG&f=1", "display_name": "JoeRadar", "link": "https://stackoverflow.com/users/12117154/joeradar"}, "reply_to_user": {"reputation": 23850, "user_id": 196679, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fXUzE.jpg?s=128&g=1", "display_name": "Bazzz", "link": "https://stackoverflow.com/users/196679/bazzz"}, "edited": false, "score": 0, "creation_date": 1569396418, "post_id": 58092804, "comment_id": 102578869, "body": "thanks, and I defined the receiver of a() and b(), is XYZ, not is *XYZ.    XYZ.a() is ok, *XYZ.a() will not work. so, I think *XYZ not implements ABC."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 12117154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ad02e8fda8fbb2fc5804ecb474bd40?s=128&d=identicon&r=PG&f=1", "display_name": "JoeRadar", "link": "https://stackoverflow.com/users/12117154/joeradar"}, "edited": false, "score": 0, "creation_date": 1569396944, "post_id": 58092872, "comment_id": 102579134, "body": "thanks, Golang can invoke the method a() on a pointer to nil value(but the type is distinct,  XYZ),  it will transfer nil as a receiver to a(). so, Go should know *XYZ is not the receiver of a(), it can determine a() can not be invoked on *XYZ."}, {"owner": {"reputation": 17, "user_id": 12117154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ad02e8fda8fbb2fc5804ecb474bd40?s=128&d=identicon&r=PG&f=1", "display_name": "JoeRadar", "link": "https://stackoverflow.com/users/12117154/joeradar"}, "edited": false, "score": 0, "creation_date": 1569397425, "post_id": 58092872, "comment_id": 102579370, "body": "certainly, I have try like you do, before I ask the question,  just modify (xyz XYZ) a() =&gt; (xyz *XYZ) a() , it will work right, because the receiver is matched. I was thinking: Since Golang allow the situation\uff0cwhy not it occur error when I assign *XYZ to abc?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 17, "user_id": 12117154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ad02e8fda8fbb2fc5804ecb474bd40?s=128&d=identicon&r=PG&f=1", "display_name": "JoeRadar", "link": "https://stackoverflow.com/users/12117154/joeradar"}, "edited": false, "score": 0, "creation_date": 1569397536, "post_id": 58092872, "comment_id": 102579431, "body": "@JoeRadar It&#39;s not about matching. If methods have non-pointer receivers, then both <code>XYZ</code> and <code>*XYZ</code> types implement the interface. The problem is that a <code>nil</code> pointer cannot be dereferenced to call the non-pointer methods. If the pointer is initialized, it works with non-pointer methods too. It&#39;s all written in the answer."}, {"owner": {"reputation": 17, "user_id": 12117154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ad02e8fda8fbb2fc5804ecb474bd40?s=128&d=identicon&r=PG&f=1", "display_name": "JoeRadar", "link": "https://stackoverflow.com/users/12117154/joeradar"}, "edited": false, "score": 0, "creation_date": 1569494585, "post_id": 58092872, "comment_id": 102619302, "body": "maybe I understand all of what you said, but I think I can give a answer for the question. when I invoke a method of a struct that implem"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1569396805, "last_edit_date": 1569396805, "creation_date": 1569395266, "answer_id": 58092872, "question_id": 58092804, "link": "https://stackoverflow.com/questions/58092804/about-the-interface-assignment/58092872#58092872", "title": "About the interface assignment", "body": "<blockquote>\n  <p>will occur a error, because the type of a(*main.XYZ) not implements the interface ABC</p>\n</blockquote>\n\n<p>Wrong. <code>*main.XYZ</code> implements <code>ABC</code> (else <code>abc = xyz</code> would fail at compile-time, try to rename the method <code>b</code> to <code>c</code> for example), but the variable <code>a</code> holds a <code>nil</code> pointer (of type <code>*XYZ</code>). And since the <code>XYZ.a()</code> method has value receiver, to call that, a pointer value of type <code>*XYZ</code> would have to be dereferenced. But a <code>nil</code> pointer points to nothing, it cannot be dereferenced, an attempt to do so results in a runtime panic, just as you experienced.</p>\n\n<p>If you would initialize <code>xyz</code> in the beginning with a non-<code>nil</code> pointer, it would work:</p>\n\n<pre><code>var xyz *XYZ = new(XYZ)\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/MUJ9F3uEvqB\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Also note that if <code>XYZ.a()</code> and <code>XYZ.b()</code> would have pointer receivers, then it would also work if <code>xyz</code> is <code>nil</code>:</p>\n\n<pre><code>func (xyz *XYZ) a() string {\n    return \"XYZ\"\n}\n\nfunc (xyz *XYZ) b() int {\n    return 123\n}\n\nfunc main() {\n    var xyz *XYZ\n    // ...\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/nCLAx1e2taZ\" rel=\"nofollow noreferrer\">Go Playground</a>. The reason for this is because if the receivers are pointers, the <code>nil</code> pointer does not have to be dereferenced in order to call methods with pointer receivers, so no runtime panic occurs. Of course if in the methods you would refer to the <code>XZY.aa</code> or <code>XYZ.bb</code> fields, that would be a runtime panic, but your current method implementations does not do so, so it works.</p>\n"}, {"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1569405100, "creation_date": 1569405100, "answer_id": 58095695, "question_id": 58092804, "link": "https://stackoverflow.com/questions/58092804/about-the-interface-assignment/58095695#58095695", "title": "About the interface assignment", "body": "<p>XYZ does implement ABC. This has to do with how <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method sets</a> are determined (emphasis added):</p>\n\n<blockquote>\n  <p>A type may have a method set associated with it. The method set of an interface type is its interface. The method set of any other type T consists of all methods declared with receiver type T. <em>The method set of the corresponding pointer type *T is the set of all methods declared with receiver *T or T</em> (that is, it also contains the method set of T).</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">The method set determines whether an interface is implemented</a>:</p>\n\n<blockquote>\n  <p>An interface type specifies a method set called its interface. A variable of interface type can store a value of any type with a method set that is any superset of the interface. Such a type is said to <em>implement the interface</em>.</p>\n</blockquote>\n\n<p>When calling <code>*XYZ.a()</code>, the Go compiler can always automatically dereference the pointer to obtain a value receiver. There is no downside to doing so, because the receiver cannot be modified (as far as the caller is concerned).</p>\n\n<p>The inverse is true if and only if the value is addressable:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type T struct {}\nfunc (*T) M()\n\nfunc main() {\n    var t T\n    t.M() // ok; t is addressable and the compiler rewrites this to (*t).M()\n\n    var m map[string]T\n    m[\"x\"].M() // error: cannot take the address of m[\"x\"]\n}\n</code></pre>\n\n<p>See also: <a href=\"https://stackoverflow.com/questions/33587227/golang-method-sets-pointer-vs-value-receiver\">Golang Method Sets (Pointer vs Value Receiver)</a></p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 12117154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ad02e8fda8fbb2fc5804ecb474bd40?s=128&d=identicon&r=PG&f=1", "display_name": "JoeRadar", "link": "https://stackoverflow.com/users/12117154/joeradar"}, "is_accepted": false, "score": 0, "last_activity_date": 1569495224, "creation_date": 1569495224, "answer_id": 58115243, "question_id": 58092804, "link": "https://stackoverflow.com/questions/58092804/about-the-interface-assignment/58115243#58115243", "title": "About the interface assignment", "body": "<p>@icza, maybe I don't understand all of what you said, but I think I can give a answer for the question now. when I invoke a method on a value(not pointer, the method of a struct that implements a interface, and the receiver of the method is a pointer). the Golang will create a new object and copy value from the original struct value, then, the iface.data will point the new object, now ,when we pass the pointer of the new object to method, it will can be modify, but this operate will not change the origin struct value, this is not any useful, so, Golang will occur a error when we assign a struct value to a interface(pointer receiver)</p>\n"}], "owner": {"reputation": 17, "user_id": 12117154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ad02e8fda8fbb2fc5804ecb474bd40?s=128&d=identicon&r=PG&f=1", "display_name": "JoeRadar", "link": "https://stackoverflow.com/users/12117154/joeradar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1569495224, "creation_date": 1569395008, "last_edit_date": 1569395328, "question_id": 58092804, "link": "https://stackoverflow.com/questions/58092804/about-the-interface-assignment", "title": "About the interface assignment", "body": "<p>Why doesn't Go think it's type mismatch error when a struct pointer be assigned to an interface?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\ntype ABC interface {\n    a() string\n    b() int\n}\n\ntype XYZ struct {\n    aa string\n    bb int\n}\n\nfunc (xyz XYZ) a() string {\n    return \"XYZ\"\n}\n\nfunc (xyz XYZ) b() int {\n    return 123\n}\n\nfunc main() {\n    var xyz *XYZ\n    var abc ABC = xyz // type of abc is *main.XYZ\uff0cI think that Golang can find this error here, but why not?\n\n    fmt.Printf(\"%T\\n\", abc)\n\n    a, ret := abc.(*XYZ)\n    fmt.Println(a, ret) // type of a is *main.XYZ\n\n    fmt.Println(a.a()) // will occur a error, because the type of a(*main.XYZ) not implements the interface ABC\n}\n\n</code></pre>\n\n<p>I want know why Go doesn't think this is an error at \"var abc ABC = xyz\"</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569395558, "post_id": 58092749, "comment_id": 102578457, "body": "Whether that&#39;s correct or not depends on what you&#39;re trying to measure. Are you trying to measure the size of the map and slices of entries only? Or do you want to measure the contained entries as well?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1569395802, "post_id": 58092749, "comment_id": 102578566, "body": "If the goal is to measure the size of all contained entries as well, there&#39;s probably no fool-proof way to do this. Each entry could be any size, from 0 bytes (an empty struct that satisfies the interface) to zettabytes (if you have some implementation that holds all of human knowledge in memory). And that&#39;s not even the complex part yet. What if you have the same instance in your list twice? Should that be counted once or twice? Worse: What if two instances share some part of their in-memory representation (like a database handle)? Should that be counted once or twice?"}, {"owner": {"reputation": 3731, "user_id": 4349666, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e849d156870115f4e2a851cbfdaac99d?s=128&d=identicon&r=PG&f=1", "display_name": "Manish Gupta", "link": "https://stackoverflow.com/users/4349666/manish-gupta"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569395803, "post_id": 58092749, "comment_id": 102578568, "body": "@Flimzy I am trying to calculate the size of variable in memory for only slices of entries."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569395833, "post_id": 58092749, "comment_id": 102578584, "body": "So &quot;complete variable&quot; includes the actual <code>Entry</code> instances? Unfortunately, as eluded to above, there&#39;s no good way to do that."}, {"owner": {"reputation": 3731, "user_id": 4349666, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e849d156870115f4e2a851cbfdaac99d?s=128&d=identicon&r=PG&f=1", "display_name": "Manish Gupta", "link": "https://stackoverflow.com/users/4349666/manish-gupta"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569395985, "post_id": 58092749, "comment_id": 102578659, "body": "No Only the slice of entries.. for each object of entry unsafe.sizeof(entry) gives 16 bytes but for the slice unsafe.sizeof(entries) gives 24 bytes. Lets say I have 5 elements in map, What size would the map take?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1569398642, "post_id": 58092749, "comment_id": 102579986, "body": "No, this is all wrong. Especially as your code does not include the internal map overhead and you simply <i>cannot</i> know that. Whatever you try to do (XY problem?) redesign."}, {"owner": {"reputation": 3731, "user_id": 4349666, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e849d156870115f4e2a851cbfdaac99d?s=128&d=identicon&r=PG&f=1", "display_name": "Manish Gupta", "link": "https://stackoverflow.com/users/4349666/manish-gupta"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1569407327, "post_id": 58092749, "comment_id": 102584740, "body": "@Volker How can I correct my solution?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1569412406, "post_id": 58092749, "comment_id": 102587396, "body": "You simply cannot."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1569420387, "post_id": 58092749, "comment_id": 102592309, "body": "@ManishGupta: A Go map does not have a fixed size. It&#39;s dyamic. It depends on the implmentation.  It depends on the pattern of inserts, deletes, and updates."}], "answers": [{"tags": [], "owner": {"reputation": 412, "user_id": 10779150, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PdwkjFzp4rE/AAAAAAAAAAI/AAAAAAAAABU/9BZconXx6W0/photo.jpg?sz=128", "display_name": "Laevus Dexter", "link": "https://stackoverflow.com/users/10779150/laevus-dexter"}, "is_accepted": false, "score": 0, "last_activity_date": 1569432131, "last_edit_date": 1569432131, "creation_date": 1569431632, "answer_id": 58103511, "question_id": 58092749, "link": "https://stackoverflow.com/questions/58092749/how-to-calculate-memory-size-of-complex-map-variable/58103511#58103511", "title": "How to calculate memory size of complex map variable", "body": "<p>This is not a thing that you can calculate just in time...</p>\n\n<p>But I prepared test playground for you.</p>\n\n<p><a href=\"https://play.golang.org/p/V_2fheWHQn-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/V_2fheWHQn-</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\ntype Entry interface {\n    A() string\n    B() string\n    D() int64\n}\n\ntype Entries []Entry\ntype EntryMap map[string]Entries\n\nfunc main() {\n\n    size := memcalc(func() {\n        /* Put your code here */\n        var hm = make(EntryMap)\n\n        // do something with map, grow, for example        \n\n        // pass variable to this function to measure\n        calc(hm)\n    })\n\n    fmt.Println(size)\n}\n</code></pre>\n"}], "owner": {"reputation": 3731, "user_id": 4349666, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e849d156870115f4e2a851cbfdaac99d?s=128&d=identicon&r=PG&f=1", "display_name": "Manish Gupta", "link": "https://stackoverflow.com/users/4349666/manish-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1569432131, "creation_date": 1569394768, "last_edit_date": 1569394986, "question_id": 58092749, "link": "https://stackoverflow.com/questions/58092749/how-to-calculate-memory-size-of-complex-map-variable", "title": "How to calculate memory size of complex map variable", "body": "<p>I am trying to calculate the size of a variable (EntryMap) in memory.</p>\n\n<pre><code>type Entry interface {\n    A() string\n    B() string\n    C() time.Time\n    D() int64\n}\n\ntype Entries []Entry\ntype EntryMap map[string]Entries\n</code></pre>\n\n<p>What I got so far is this:</p>\n\n<pre><code>hm = make(EntryMap)\nSizeInMem = 8 //Length of Empty HMap\n\nfor key, value := range hm {\n    A = 8 // For each Key Value Assignment\n    B = len(Key) + 1 // Size of key string var\n    C = len(Entries) * unsafe.Sizeof(Entry) // Size of Entry object * len of slice\n    SizeInMem += A+B+C\n}\n\nfmt.Println(\"Size in Memory &amp;v\", SizeInMem)\n\n</code></pre>\n\n<p>Is this the correct way to determine the size of variable in memory?</p>\n"}, {"tags": ["mysql", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 7402185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58bf7f2a1a8fe5c3c5a9e19eeb309e24?s=128&d=identicon&r=PG&f=1", "display_name": "chen", "link": "https://stackoverflow.com/users/7402185/chen"}, "is_accepted": true, "score": 0, "last_activity_date": 1569395850, "creation_date": 1569395850, "answer_id": 58093059, "question_id": 58092486, "link": "https://stackoverflow.com/questions/58092486/how-to-organize-multiple-foreign-keys-for-gorm/58093059#58093059", "title": "How to organize multiple foreign keys for gorm", "body": "<pre><code>type Members struct {\n    ...\n    MemberUserID int32\n    MemberUser   User   `gorm:\"foreignkey:MemberUserID\"`\n}\n</code></pre>\n\n<p><a href=\"https://gorm.io/docs/belongs_to.html#Foreign-Key\" rel=\"nofollow noreferrer\">document: define a foreign key</a></p>\n"}], "owner": {"reputation": 353, "user_id": 10641015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rb6K-6eC5TI/AAAAAAAAAAI/AAAAAAAAAGw/E-daD0VOiz0/photo.jpg?sz=128", "display_name": "jadejoe", "link": "https://stackoverflow.com/users/10641015/jadejoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "accepted_answer_id": 58093059, "answer_count": 1, "score": 0, "last_activity_date": 1569395850, "creation_date": 1569393676, "question_id": 58092486, "link": "https://stackoverflow.com/questions/58092486/how-to-organize-multiple-foreign-keys-for-gorm", "title": "How to organize multiple foreign keys for gorm", "body": "<p>I am making a Go project with gorm for mysql.</p>\n\n<p>When creating a mysql table using gorm, it is necessary to create multiple foreign keys for one table. Until now, it was created like the following code</p>\n\n<p>such a table</p>\n\n<pre><code>type Members struct {\n    ID           int32     `gorm:\"AUTO_INCREMENT\" json:\"id\" from:\"id\"`\n    MyselfUserID int32     `gorm:\"NOT NULL\" json:\"myself_user_id\" from:\"myself_user_id\"` \n    MemberUserID int32     `gorm:\"NOT NULL\" json:\"member_user_id\" from:\"family_user_id\"` \n    FirstName    string    `json:\"first_name\" from:\"first_name\"`\n    LastName     string    `json:\"last_name\" from:\"last_name\"`\n    Relationship string    `json:\"relationship\" from:\"relationship\"`\n    Image        string    `json:\"image\" from:\"image\"`                       \n    Version      int32     `gorm:\"column:version\" json:\"version\" form:\"version\"`        \n    UpdatedAt    time.Time `gorm:\"column:updated_at\" json:\"updated_at\" form:\"updated_at\"`\n    CreatedAt    time.Time `gorm:\"column:created_at\" json:\"created_at\" form:\"created_at\"` \n}\n</code></pre>\n\n<p>I had a foreign key like this</p>\n\n<pre><code>MgtDB.AutoMigrate(&amp;Members{}).AddForeignKey(\"myself_user_id\", \"users(user_id)\", \"RESTRICT\", \"RESTRICT\").AddForeignKey(\"member_user_id\", \"users(user_id)\", \"RESTRICT\", \"RESTRICT\")\n</code></pre>\n\n<p>I feel a little verbose\nPlease let me know if there are other ways like this</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 3, "creation_date": 1569382858, "post_id": 58090804, "comment_id": 102574436, "body": "You cannot make someone else&#39;s code stop. You can make <i>your</i> code stop, by having your code ask (at appropriate points) &quot;should I stop now?&quot;  If it gets an answer telling it to stop now, it can stop. If it calls someone else&#39;s routine that takes too long, there&#39;s nothing you can really do about that."}, {"owner": {"reputation": 1, "user_id": 12116516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3232725c913e7a85cd8f849668fda85a?s=128&d=identicon&r=PG&f=1", "display_name": "fengweiqiang", "link": "https://stackoverflow.com/users/12116516/fengweiqiang"}, "reply_to_user": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 0, "creation_date": 1569390772, "post_id": 58090804, "comment_id": 102576379, "body": "It\u2019s true that the logic is complicated."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1569393302, "post_id": 58090804, "comment_id": 102577405, "body": "There&#39;s no magic in Go. If you want your goroutine to stop, you need to make it stop. It doesn&#39;t just magically infer that there&#39;s some related context floating around somewhere, and act on it."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12116516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3232725c913e7a85cd8f849668fda85a?s=128&d=identicon&r=PG&f=1", "display_name": "fengweiqiang", "link": "https://stackoverflow.com/users/12116516/fengweiqiang"}, "edited": false, "score": 0, "creation_date": 1569390343, "post_id": 58090915, "comment_id": 102576243, "body": "<code>case &lt;-calcDone:</code>This is not true, it is waiting for 3 seconds to receive the signal to execute, as if there is really no way to terminate the logic being executed."}, {"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 1, "creation_date": 1569414529, "post_id": 58090915, "comment_id": 102588616, "body": "when using context in a function it should always be the first argument as defined in the go standard"}, {"owner": {"reputation": 647, "user_id": 857156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66412a85a83783c2061838e1b44a9bbb?s=128&d=identicon&r=PG", "display_name": "Dave Gray", "link": "https://stackoverflow.com/users/857156/dave-gray"}, "edited": false, "score": 0, "creation_date": 1569477112, "post_id": 58090915, "comment_id": 102610610, "body": "In order to be able to interrupt <code>longRunningCalculation</code>, you&#39;ll have to break up the work it does, and check <code>&lt;-ctx.Done()</code> inbetween those smaller chunks of work. As others have said, there isn&#39;t a magic way to stop a goroutine once it&#39;s started, you have to ask the caller if it&#39;s time to stop via <code>&lt;-ctx.Done()</code>."}], "tags": [], "owner": {"reputation": 647, "user_id": 857156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66412a85a83783c2061838e1b44a9bbb?s=128&d=identicon&r=PG", "display_name": "Dave Gray", "link": "https://stackoverflow.com/users/857156/dave-gray"}, "is_accepted": false, "score": 3, "last_activity_date": 1569452539, "last_edit_date": 1569452539, "creation_date": 1569383453, "answer_id": 58090915, "question_id": 58090804, "link": "https://stackoverflow.com/questions/58090804/how-can-i-completely-terminate-the-running-go-func-when-ctx-times-out/58090915#58090915", "title": "How can I completely terminate the running go func() when ctx times out?", "body": "<p>To stop the goroutine started by <code>longRunningCalculation</code> when the caller's context times out, you need to pass <code>ctx</code> into <code>longRunningCalculation</code> and explicitly handle the context timing out, the same way you do in <code>jobWithTimeout</code></p>\n\n<p>Doing things that way also means instead of calling <code>time.Sleep</code>, that <code>time.Tick</code> will be a better choice, so both timers are running at the same time. Like so:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"log\"\n    \"time\"\n)\n\nfunc longRunningCalculation(ctx context.Context, timeCost int) chan string {\n    result := make(chan string)\n    go func() {\n        calcDone := time.Tick(time.Second * time.Duration(timeCost))\n        log.Printf(\"entering select (longRunningCalculation)\")\n        select {\n        case &lt;-ctx.Done():\n            result &lt;- \"Caller timed out\"\n            return\n        case &lt;-calcDone:\n            log.Println(\"Still doing other things...\") //Even if it times out, this goroutine is still doing other tasks.\n            result &lt;- \"Done\"\n        }\n        log.Println(timeCost)\n    }()\n    return result\n}\n\nfunc jobWithTimeout() {\n    ctx, cancel := context.WithTimeout(context.Background(), 2*time.Second)\n    defer cancel()\n    result := longRunningCalculation(ctx, 3)\n    log.Printf(\"entering select (jobWithTimeout)\")\n    select {\n    case &lt;-ctx.Done():\n        log.Println(ctx.Err())\n        return\n    case res := &lt;-result:\n        log.Println(res)\n    }\n}\n\nfunc main() {\n    jobWithTimeout()\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12116516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3232725c913e7a85cd8f849668fda85a?s=128&d=identicon&r=PG&f=1", "display_name": "fengweiqiang", "link": "https://stackoverflow.com/users/12116516/fengweiqiang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1569452539, "creation_date": 1569382388, "question_id": 58090804, "link": "https://stackoverflow.com/questions/58090804/how-can-i-completely-terminate-the-running-go-func-when-ctx-times-out", "title": "How can I completely terminate the running go func() when ctx times out?", "body": "<p>When I want ctx timeout, what should I do to completely terminate the method that is executing longRunningCalculation()?</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"log\"\n    \"time\"\n)\n\nfunc longRunningCalculation(timeCost int) chan string {\n    result := make(chan string)\n    go func() {\n        time.Sleep(time.Second * (time.Duration(timeCost)))\n        log.Println(\"Still doing other things...\") //Even if it times out, this goroutine is still doing other tasks.\n        result &lt;- \"Done\"\n        log.Println(timeCost)\n    }()\n    return result\n}\nfunc jobWithTimeout() {\n    ctx, cancel := context.WithTimeout(context.Background(), 2*time.Second)\n    defer cancel()\n    select {\n    case &lt;-ctx.Done():\n        log.Println(ctx.Err())\n        return\n    case result := &lt;-longRunningCalculation(3):\n        log.Println(result)\n    }\n}\n\nfunc main() {\n    jobWithTimeout()\n    time.Sleep(time.Second * 5)\n}\n\n</code></pre>\n\n<p>What did you expect to see?\n2019/09/25 11:00:16 context deadline exceeded</p>\n\n<p>What did you see instead?\n2019/09/25 11:00:16 context deadline exceeded\n2019/09/25 11:00:17 Still doing other things...</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 278, "user_id": 6704961, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a760243c4749a63f7532522cd0ee1f2?s=128&d=identicon&r=PG&f=1", "display_name": "switch", "link": "https://stackoverflow.com/users/6704961/switch"}, "edited": false, "score": 1, "creation_date": 1569367038, "post_id": 58089183, "comment_id": 102571717, "body": "I feel so dumb, should have thought about it.. Thanks !"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1569366720, "creation_date": 1569366720, "answer_id": 58089183, "question_id": 58089112, "link": "https://stackoverflow.com/questions/58089112/share-variables-between-golang-templates/58089183#58089183", "title": "Share variables between golang templates", "body": "<p>Create a third file with the common definitions:</p>\n\n<pre><code>{{define \"myVar\"}}\nthe-var\n{{end}}\n</code></pre>\n\n<p>Parse that file with the others:</p>\n\n<pre><code>aTmpl, _ := template.ParseFiles(aFilePath, commonFilePath)\n\nbTmpl, _ := template.ParseFiles(bFilePath, commonFilePath)\n</code></pre>\n\n<p>Use \"myvar\" in the two templates as follows:</p>\n\n<pre><code>{{template \"myVar\" .}}\n</code></pre>\n"}], "owner": {"reputation": 278, "user_id": 6704961, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a760243c4749a63f7532522cd0ee1f2?s=128&d=identicon&r=PG&f=1", "display_name": "switch", "link": "https://stackoverflow.com/users/6704961/switch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "accepted_answer_id": 58089183, "answer_count": 1, "score": 2, "last_activity_date": 1569366720, "creation_date": 1569366022, "question_id": 58089112, "link": "https://stackoverflow.com/questions/58089112/share-variables-between-golang-templates", "title": "Share variables between golang templates", "body": "<p>I want to generate 2 separate files with GOtemplate, let's say I have this code :</p>\n\n<pre><code>aBuffer := new(bytes.Buffer)\nbBuffer := new(bytes.Buffer)\n\naTmpl, _ := template.ParseFiles(aFilePath)\naTmpl.Execute(aBuffer, someVariables)\n\nbTmpl, _ := template.ParseFiles(bFilePath)\nbTmpl.Execute(bBuffer, someVariables)\n</code></pre>\n\n<p>Let's say I use a common var for these two files (not coming from the \"someVariables\" golang var), do I have a way to declare it in a seperate file like with Helm ?</p>\n\n<pre><code>{{ define myVar }}\nthe-var\n{{ end }}\n</code></pre>\n\n<p>Then to keep a kind of context that I can re-use in both aTmpl &amp; bTmpl :</p>\n\n<pre><code>{{ template myVar .}}\n</code></pre>\n"}, {"tags": ["go", "http2"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569365879, "post_id": 58088956, "comment_id": 102571444, "body": "It says it right there in the docs you linked: &quot;Programs that must disable HTTP/2 can do so by setting Server.TLSNextProto to a non-nil, empty map.&quot; What&#39;s unclear about that?"}], "answers": [{"comments": [{"owner": {"reputation": 972, "user_id": 9488865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d560f151faf6a0565f7cebd93958acf?s=128&d=identicon&r=PG&f=1", "display_name": "struggling_learner", "link": "https://stackoverflow.com/users/9488865/struggling-learner"}, "edited": false, "score": 0, "creation_date": 1569520806, "post_id": 58095540, "comment_id": 102633317, "body": "Thank you, and +1 for the curl verification tip!"}, {"owner": {"reputation": 2860, "user_id": 5397, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e1d626dc8d86cfc672022946ee03be83?s=128&d=identicon&r=PG", "display_name": "Martin Del Vecchio", "link": "https://stackoverflow.com/users/5397/martin-del-vecchio"}, "edited": false, "score": 0, "creation_date": 1591908106, "post_id": 58095540, "comment_id": 110242236, "body": "Grzegorz can you tell me how that command verifies that HTTP2 is disabled?  I am trying to disable HTTP2 in this manner, and the equivalent curl command is telling me &quot;Connection state changed (HTTP/2 confirmed)&quot; and then &quot;Failed sending HTTP2 data, * nghttp2_session_send() failed: The user callback function failed(-902)&quot;  Is this what I should see?  It sounds to me like this method has not in fact disabled HTTP2.  Thanks."}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "reply_to_user": {"reputation": 2860, "user_id": 5397, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e1d626dc8d86cfc672022946ee03be83?s=128&d=identicon&r=PG", "display_name": "Martin Del Vecchio", "link": "https://stackoverflow.com/users/5397/martin-del-vecchio"}, "edited": false, "score": 0, "creation_date": 1591941453, "post_id": 58095540, "comment_id": 110250804, "body": "@MartinDelVecchio The command parameters tells curl to use HTTP/2 protocol only. If the tool fails to communicate with server it means that HTTP/2 is not available. It is what we wanted to achieve."}, {"owner": {"reputation": 2860, "user_id": 5397, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e1d626dc8d86cfc672022946ee03be83?s=128&d=identicon&r=PG", "display_name": "Martin Del Vecchio", "link": "https://stackoverflow.com/users/5397/martin-del-vecchio"}, "edited": false, "score": 0, "creation_date": 1592072081, "post_id": 58095540, "comment_id": 110295878, "body": "OK.  I am seeing the same errors when I don&#39;t tell curl to use HTTP2.  When I explicitly tell it to use HTTP 1.1, I get success.  But when I don&#39;t tell it, it tries HTTP2, fails, and returns an error."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 6, "last_activity_date": 1570001433, "last_edit_date": 1570001433, "creation_date": 1569404530, "answer_id": 58095540, "question_id": 58088956, "link": "https://stackoverflow.com/questions/58088956/how-to-disable-http-2-using-server-tlsnextproto/58095540#58095540", "title": "How to disable HTTP/2 using Server.TLSNextProto", "body": "<p>The simplest setup that disables HTTP/2 is</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"crypto/tls\"\n)\n\nfunc main() {\n\n    m := http.NewServeMux()\n\n    srv := &amp;http.Server{\n        Handler:      m,\n        Addr:         \"127.0.0.1:8080\",\n        TLSNextProto: make(map[string]func(*http.Server, *tls.Conn, http.Handler)),\n    }\n\n    log.Fatal(srv.ListenAndServe())\n\n}\n</code></pre>\n\n<p>You can verify the support with</p>\n\n<pre>\ncurl -v --http2-prior-knowledge http://localhost:8080\n</pre>\n"}], "owner": {"reputation": 972, "user_id": 9488865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d560f151faf6a0565f7cebd93958acf?s=128&d=identicon&r=PG&f=1", "display_name": "struggling_learner", "link": "https://stackoverflow.com/users/9488865/struggling-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1348, "favorite_count": 1, "accepted_answer_id": 58095540, "answer_count": 1, "score": 4, "last_activity_date": 1570001433, "creation_date": 1569364657, "last_edit_date": 1569394815, "question_id": 58088956, "link": "https://stackoverflow.com/questions/58088956/how-to-disable-http-2-using-server-tlsnextproto", "title": "How to disable HTTP/2 using Server.TLSNextProto", "body": "<p>I have a Go server handling https requests:</p>\n\n<pre><code>package main\nimport (\n        \"fmt\"\n        \"net/http\"\n        \"log\"\n)\nconst (\n        port       = \"5966\"\n        cert       = \"/tmp/cert.pem\"\n        key        = \"/tmp/key.pem\"\n)\nfunc main() {\n\n        listen_at := \":\" + port\n        fmt.Println(\"Listening at\", listen_at)\n        go http.HandleFunc(\"/job_handler/\", job_handler)\n        log.Fatal(http.ListenAndServeTLS(listen_at, cert, key, nil))\n}\nfunc job_handler(w http.ResponseWriter, r *http.Request) {\n       // do somework\n}\n</code></pre>\n\n<p>Turns out in https mode, Go has transparent support for the HTTP/2 protocol. We've some clients that noticeably misbehave in HTTP/2, and hence we need to disable HTTP/2 on the server side.</p>\n\n<p>Unfortunately, I can't use ENV variable <code>GODEBUG=http2server=0</code> to disable HTTP/2. What's left is <code>Server.TLSNextProto</code> as documented <a href=\"https://go.googlesource.com/go/+/master/src/net/http/doc.go?autodive=0%2F%2F#81\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>How can I use <code>Server.TLSNextProto</code> on my server code above to disable https/2?</p>\n"}, {"tags": ["reactjs", "go", "mux"], "answers": [{"comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "reply_to_user": {"reputation": 115, "user_id": 9743949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608305185933373/picture?type=large", "display_name": "Sasank Ganapathiraju", "link": "https://stackoverflow.com/users/9743949/sasank-ganapathiraju"}, "edited": false, "score": 0, "creation_date": 1569393891, "post_id": 58088940, "comment_id": 102577664, "body": "I improved my answer to handle additional routes."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 4, "last_activity_date": 1569394187, "last_edit_date": 1569394187, "creation_date": 1569364487, "answer_id": 58088940, "question_id": 58088803, "link": "https://stackoverflow.com/questions/58088803/how-to-serve-react/58088940#58088940", "title": "How to serve React", "body": "<p>In your case only build handler is needed. It must point to directory not a file. Rest of the handlers are obsolete except the case of routing.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n\n    r := mux.NewRouter()\n\n    r.HandleFunc(\"/route1\", index).Methods(\"GET\")\n    r.HandleFunc(\"/route2\", index).Methods(\"GET\")\n    buildHandler := http.FileServer(http.Dir(\"client/build\"))\n    r.PathPrefix(\"/\").Handler(buildHandler)\n\n    srv := &amp;http.Server{\n        Handler:      r,\n        Addr:         \"127.0.0.1:8080\",\n        WriteTimeout: 15 * time.Second,\n        ReadTimeout:  15 * time.Second,\n    }\n\n    fmt.Println(\"Server started on PORT 8080\")\n    log.Fatal(srv.ListenAndServe())\n\n}\n\nfunc index(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"client/build/index.html\")\n}\n</code></pre>\n\n<p>The same can be achieved with the standard library only.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n\n    r := http.NewServeMux()\n\n    r.HandleFunc(\"/route1\", index)\n    r.HandleFunc(\"/route2\", index)\n    buildHandler := http.FileServer(http.Dir(\"client/build\"))\n    r.Handle(\"/\", buildHandler)\n\n    srv := &amp;http.Server{\n        Handler:      r,\n        Addr:         \"127.0.0.1:8080\",\n        WriteTimeout: 15 * time.Second,\n        ReadTimeout:  15 * time.Second,\n    }\n\n    fmt.Println(\"Server started on PORT 8080\")\n    log.Fatal(srv.ListenAndServe())\n\n}\n\nfunc index(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"client/build/index.html\")\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 9743949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608305185933373/picture?type=large", "display_name": "Sasank Ganapathiraju", "link": "https://stackoverflow.com/users/9743949/sasank-ganapathiraju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 1, "accepted_answer_id": 58088940, "answer_count": 1, "score": 5, "last_activity_date": 1569394983, "creation_date": 1569363413, "last_edit_date": 1569394983, "question_id": 58088803, "link": "https://stackoverflow.com/questions/58088803/how-to-serve-react", "title": "How to serve React", "body": "<p>I have a simple React application I would like to serve from my Go server back end. I hear the process is similar to serving a static html file, but I just can't seem to get it to work.</p>\n\n<p>When I try to view the app on the browser it says \"This page isn't working\" and that \"localhost has redirected too many times\"</p>\n\n<p>Here is the code where I am running the server locally as well as trying to handle the react application</p>\n\n<pre><code>func main() {\n\nr := mux.NewRouter()\n\n// handle app\nbuildHandler := http.FileServer(http.Dir(\"./client/build/index.html\"))\nr.PathPrefix(\"/\").Handler(buildHandler)\n\nstaticHandler := http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"./client/build/static\")))\nr.PathPrefix(\"/static/\").Handler(staticHandler)\n\nr.HandleFunc(\"/\", index).Methods(\"GET\")\n\nsrv := &amp;http.Server{\n    Handler:      r,\n    Addr:         \"127.0.0.1:8080\",\n    WriteTimeout: 15 * time.Second,\n    ReadTimeout:  15 * time.Second,\n}\n\n// serve\nfmt.Println(\"Server started on PORT 8080\")\nlog.Fatal(srv.ListenAndServe())\n\n\n}\n</code></pre>\n\n<p>Here is the code for the index route</p>\n\n<pre><code>func index(w http.ResponseWriter, r *http.Request) {\n    // not sure if this is necessary\n    http.ServeFile(w, r, \"index.html\")\n}\n</code></pre>\n\n<p>I believe the solution is simple and that I am most likely making a small error somewhere.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 1, "creation_date": 1569382442, "post_id": 58088873, "comment_id": 102574347, "body": "<code>int64</code> cents is pretty good: it gets you to about $92 quadrillion. You might need mills (<a href=\"https://financial-dictionary.thefreedictionary.com/mill\" rel=\"nofollow noreferrer\">financial-dictionary.thefreedictionary.com/mill</a>) for some financial software in which case you&#39;re down to just $9 quadrillion :-)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569395436, "post_id": 58088873, "comment_id": 102578392, "body": "@torke: Or if you&#39;re working with <a href=\"https://i.ebayimg.com/images/g/y6MAAOSw8cNUUpMn/s-l300.jpg\" rel=\"nofollow noreferrer\">US fueling stations</a>."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 5, "last_activity_date": 1569389257, "last_edit_date": 1569389257, "creation_date": 1569363932, "answer_id": 58088873, "question_id": 58088633, "link": "https://stackoverflow.com/questions/58088633/how-should-we-calc-money-decimal-big-float/58088873#58088873", "title": "How should we calc money (decimal, big.Float)", "body": "<p>Floating-point is imprecise. Use integers (<code>int64</code>) scaled to cents or fractional cents. </p>\n\n<hr>\n\n<p>For example, cents,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    cents := int64(0)\n    for i := 0; i &lt;= 2; i++ {\n        cents += 15\n        fmt.Println(cents)\n    }\n    fmt.Printf(\"$%d.%02d\\n\", cents/100, cents%100)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/k4mJZFRUGVH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/k4mJZFRUGVH</a></p>\n\n<p>Output:</p>\n\n<pre><code>15\n30\n45\n$0.45\n</code></pre>\n\n<hr>\n\n<p>For example, hundredths of a cent rounded,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    c := int64(0) // hundredths of a cent\n    for i := 0; i &lt;= 2; i++ {\n        c += 1550\n        fmt.Println(c)\n    }\n    c += 50 // rounded\n    fmt.Printf(\"$%d.%02d\\n\", c/10000, c%10000/100)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/YGW9SC7OcU3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/YGW9SC7OcU3</a></p>\n\n<p>Output:</p>\n\n<pre><code>1550\n3100\n4650\n$0.47\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 4951966, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NXWvVkuXd-A/AAAAAAAAAAI/AAAAAAAAACQ/CvXhj-1i1HY/photo.jpg?sz=128", "display_name": "Rama Bramantara", "link": "https://stackoverflow.com/users/4951966/rama-bramantara"}, "is_accepted": false, "score": 1, "last_activity_date": 1569399573, "last_edit_date": 1569399573, "creation_date": 1569396442, "answer_id": 58093245, "question_id": 58088633, "link": "https://stackoverflow.com/questions/58088633/how-should-we-calc-money-decimal-big-float/58093245#58093245", "title": "How should we calc money (decimal, big.Float)", "body": "<p>you can try <a href=\"https://github.com/shopspring/decimal\" rel=\"nofollow noreferrer\">https://github.com/shopspring/decimal</a> if you really concern about precision,</p>\n\n<p>try this code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/shopspring/decimal\"\n)\n\nfunc main() {\n\n    z := decimal.NewFromFloat(0)\n\n    b := decimal.NewFromFloat(0.15)\n\n    z = z.Add(b)\n    z = z.Add(b)\n    z = z.Add(b)\n\n    fmt.Println(\"z value:\", z)\n\n    testz := z.Cmp(decimal.NewFromFloat(0.45)) == 0\n\n    fmt.Println(\"is z pass the test? \", testz)\n\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/g_fSGlXPKDH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/g_fSGlXPKDH</a></p>\n\n<p>Output:</p>\n\n<pre><code>z value: 0.45\nis z pass the test?  true\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 12115630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UIaXtmgvMi8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rduMMTLeGgQIX5Tbbocq4NNonk2fQ/photo.jpg?sz=128", "display_name": "gorush322", "link": "https://stackoverflow.com/users/12115630/gorush322"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1569399573, "creation_date": 1569362176, "last_edit_date": 1569395166, "question_id": 58088633, "link": "https://stackoverflow.com/questions/58088633/how-should-we-calc-money-decimal-big-float", "title": "How should we calc money (decimal, big.Float)", "body": "<p>Can someone tell the right way to calculate finance data in Go. I tryed to use big.Float but prob I miss something. The core goal is to calculate numbers with flaoting point and precision from 2 to 4 without any losses.\n<code>0.15 + 0.15</code> always should be 0.30.\n<code>float</code> try:\n<a href=\"https://play.golang.org/p/_3CXtRRNcA0\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_3CXtRRNcA0</a>\n<code>big.Float</code> try:\n<a href=\"https://play.golang.org/p/zegE__Dit1O\" rel=\"nofollow noreferrer\">https://play.golang.org/p/zegE__Dit1O</a></p>\n"}, {"tags": ["go", "cookies"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1569354883, "post_id": 58087294, "comment_id": 102568185, "body": "You cannot store JSON directly in a cookie value. Most of the characters used in JSON are not permitted in cookies."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1569354901, "post_id": 58087294, "comment_id": 102568190, "body": "See related: <a href=\"https://stackoverflow.com/questions/1969232/allowed-characters-in-cookies\" title=\"allowed characters in cookies\">stackoverflow.com/questions/1969232/&hellip;</a>"}, {"owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "edited": false, "score": 0, "creation_date": 1569354987, "post_id": 58087294, "comment_id": 102568227, "body": "Please, could you add the framework/library that you are using? Are you making a request or are you receiving request from a webserver?"}, {"owner": {"reputation": 2955, "user_id": 6655126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DUGmM.jpg?s=128&g=1", "display_name": "T. Short", "link": "https://stackoverflow.com/users/6655126/t-short"}, "reply_to_user": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "edited": false, "score": 0, "creation_date": 1569355996, "post_id": 58087294, "comment_id": 102568526, "body": "@alessiosavi - I&#39;m receiving a request and it&#39;s a straight forward <code>go</code> set up importing <code>&quot;net&#47;url&quot;</code>"}, {"owner": {"reputation": 2955, "user_id": 6655126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DUGmM.jpg?s=128&g=1", "display_name": "T. Short", "link": "https://stackoverflow.com/users/6655126/t-short"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1569356485, "post_id": 58087294, "comment_id": 102568693, "body": "@CeriseLim&#243;n When I get the value of ` r.Header.Get[&quot;Cookie&quot;]`. I can see the cookie (and it&#39;s value) in the output with all the other cookie data."}], "answers": [{"comments": [{"owner": {"reputation": 2955, "user_id": 6655126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DUGmM.jpg?s=128&g=1", "display_name": "T. Short", "link": "https://stackoverflow.com/users/6655126/t-short"}, "edited": false, "score": 0, "creation_date": 1569355868, "post_id": 58087371, "comment_id": 102568481, "body": "Thanks for your answer. If those characters are not permitted, how does the cookie even exist in the first place?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 2955, "user_id": 6655126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DUGmM.jpg?s=128&g=1", "display_name": "T. Short", "link": "https://stackoverflow.com/users/6655126/t-short"}, "edited": false, "score": 0, "creation_date": 1569357480, "post_id": 58087371, "comment_id": 102569079, "body": "That&#39;s a complicated question - not to be pedantic, but it depends on what you mean by &quot;exist&quot; here. A cookie is just a value passed back and forth in the Cookie and Set-Cookie headers. Only certain characters are permitted there. A client or server could send an invalid header (containing invalid characters), and the other side may or may not accept it. But according to the standard, JSON does not generally make for a valid cookie value."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1569355178, "creation_date": 1569355178, "answer_id": 58087371, "question_id": 58087294, "link": "https://stackoverflow.com/questions/58087294/not-able-to-read-json-cookie/58087371#58087371", "title": "Not able to read JSON cookie", "body": "<p>JSON uses many <a href=\"https://stackoverflow.com/questions/1969232/allowed-characters-in-cookies\">characters not permitted in HTTP cookie values</a> <a href=\"https://www.ietf.org/rfc/rfc6265.txt\" rel=\"nofollow noreferrer\">per the RFC</a> - for example, double quotes, commas, and whitespace characters are not permitted. The eastiest way to transfer JSON data via cookie would probably be to Base64 encode it when setting the cookie, and Base64 decode it when reading the cookie, using the <a href=\"https://golang.org/pkg/encoding/base64/\" rel=\"nofollow noreferrer\"><code>encoding/base64</code></a> package.</p>\n"}], "owner": {"reputation": 2955, "user_id": 6655126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DUGmM.jpg?s=128&g=1", "display_name": "T. Short", "link": "https://stackoverflow.com/users/6655126/t-short"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 1, "accepted_answer_id": 58087371, "answer_count": 1, "score": 0, "last_activity_date": 1569394921, "creation_date": 1569354728, "last_edit_date": 1569394921, "question_id": 58087294, "link": "https://stackoverflow.com/questions/58087294/not-able-to-read-json-cookie", "title": "Not able to read JSON cookie", "body": "<p>I have a situation where I want to read the contents of a cookie in Go. However the contents of the cookie is in a JSON format. (Changing the format of the cookie is not an option)</p>\n\n<p>For example the contents of the cookie might be:</p>\n\n<pre><code>{\"id\":\"abc\",\"data\":\"information\",\"on_off\":false}\n</code></pre>\n\n<p>In JavaScript I'm easily able to read the contents of the cookie and parse it.</p>\n\n<p>With Go, on the other hand, when I try to read the cookie with <code>r.Cookie('my_cookie')</code> I get the following error: <code>http: named cookie not present</code>.</p>\n\n<p>If I modify the cookie to a simple string, then it works as expected.</p>\n\n<p>Does anyone know what to do in this case? Is it just not possible to read a such a cookie in Go?</p>\n\n<p>When I use <code>r.Header.Get[\"Cookie\"]</code>, the output it returns does contain the cookie and it's JSON value (listed among all the other cookies)</p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569354000, "post_id": 58087134, "comment_id": 102567909, "body": "please share <code>pwd</code> <code>go env</code> <code>go version</code>"}], "answers": [{"tags": [], "owner": {"reputation": 34200, "user_id": 995862, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d5efb6c1054808f7a79aaefbc64cce76?s=128&d=identicon&r=PG", "display_name": "Kurt Peek", "link": "https://stackoverflow.com/users/995862/kurt-peek"}, "is_accepted": false, "score": 2, "last_activity_date": 1569354470, "creation_date": 1569354470, "answer_id": 58087245, "question_id": 58087134, "link": "https://stackoverflow.com/questions/58087134/godef-there-must-be-at-least-one-package-that-contains-the-file-even-though-t/58087245#58087245", "title": "&quot;godef: There must be at least one package that contains the file&quot; even though the file does have a package?", "body": "<p>It turns out this functionality was broken by setting the <code>GO111MODULE</code> environment variable to <code>on</code> in my <code>~/.config/fish/config.fish</code>. When I removed this, the 'Go-To Definition' button worked again.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4957890, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GxrHBQXTATQ/AAAAAAAAAAI/AAAAAAAABc4/YqA4nIkOTos/photo.jpg?sz=128", "display_name": "Ajay Mahar", "link": "https://stackoverflow.com/users/4957890/ajay-mahar"}, "is_accepted": false, "score": 0, "last_activity_date": 1614169630, "creation_date": 1614169630, "answer_id": 66350933, "question_id": 58087134, "link": "https://stackoverflow.com/questions/58087134/godef-there-must-be-at-least-one-package-that-contains-the-file-even-though-t/66350933#66350933", "title": "&quot;godef: There must be at least one package that contains the file&quot; even though the file does have a package?", "body": "<p>ERROR: godef: There must be at least one package that contains the file.</p>\n<p><a href=\"https://i.stack.imgur.com/nb4WK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nb4WK.png\" alt=\"enter image description here\" /></a></p>\n<p>It seems like in go 1.16 env variable (GO111MODULE) is set <code>auto/on</code>.</p>\n<p>You can turn it off the GO111MODULE by simply exporting the env var.</p>\n<pre><code>export GO111MODULE=off\n</code></pre>\n"}], "owner": {"reputation": 34200, "user_id": 995862, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d5efb6c1054808f7a79aaefbc64cce76?s=128&d=identicon&r=PG", "display_name": "Kurt Peek", "link": "https://stackoverflow.com/users/995862/kurt-peek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1614169630, "creation_date": 1569353880, "question_id": 58087134, "link": "https://stackoverflow.com/questions/58087134/godef-there-must-be-at-least-one-package-that-contains-the-file-even-though-t", "title": "&quot;godef: There must be at least one package that contains the file&quot; even though the file does have a package?", "body": "<p>I'm using VS Code with the Go extension, but I noticed that when I right-click on a method and select \"Go to definition\", no definition is found. For example, </p>\n\n<p><a href=\"https://i.stack.imgur.com/nRGQm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nRGQm.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is in a sample app I generated using Cobra:</p>\n\n<pre><code>cobra init myCobraApp --pkg-name=github.com/khpeek/myCobraApp\n</code></pre>\n\n<p>I would expect this to work because the <code>myCobraApp</code> directory is organized like</p>\n\n<pre><code>.\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 cmd\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 root.go\n\u2514\u2500\u2500 main.go\n</code></pre>\n\n<p>where <code>cmd/root.go</code> contains</p>\n\n<pre><code>package cmd\n\nimport (\n  \"fmt\"\n  \"os\"\n  \"github.com/spf13/cobra\"\n\n  homedir \"github.com/mitchellh/go-homedir\"\n  \"github.com/spf13/viper\"\n\n)\n\n\nvar cfgFile string\n\n\n// rootCmd represents the base command when called without any subcommands\nvar rootCmd = &amp;cobra.Command{\n  Use:   \"myCobraApp\",\n  Short: \"A brief description of your application\",\n  Long: `A longer description that spans multiple lines and likely contains\nexamples and usage of using your application. For example:\n\nCobra is a CLI library for Go that empowers applications.\nThis application is a tool to generate the needed files\nto quickly create a Cobra application.`,\n  // Uncomment the following line if your bare application\n  // has an action associated with it:\n  //    Run: func(cmd *cobra.Command, args []string) { },\n}\n\n// Execute adds all child commands to the root command and sets flags appropriately.\n// This is called by main.main(). It only needs to happen once to the rootCmd.\nfunc Execute() {\n  if err := rootCmd.Execute(); err != nil {\n    fmt.Println(err)\n    os.Exit(1)\n  }\n}\n</code></pre>\n\n<p>I've also tried to invoke <code>godef</code> from the command line, but I get this error message:</p>\n\n<pre><code>~/g/s/g/k/myCobraApp&gt; godef -f main.go \"cmd.Execute()\"\ngodef: There must be at least one package that contains the file\n</code></pre>\n\n<p>I don't understand this error message: isn't there a package that contains the file?</p>\n"}, {"tags": ["go", "aws-sdk-go"], "comments": [{"owner": {"reputation": 1044, "user_id": 10792855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/121087ed418f11dbd5063043380340a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Kilpatrick", "link": "https://stackoverflow.com/users/10792855/joey-kilpatrick"}, "edited": false, "score": 0, "creation_date": 1569354564, "post_id": 58086849, "comment_id": 102568081, "body": "Why are you trying to create \u201cfolders\u201d? There seems to be no use for this without objects \u201cinside\u201d of them."}], "answers": [{"comments": [{"owner": {"reputation": 864, "user_id": 845435, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/610458a30958c9d336ee691fa1a87369?s=128&d=identicon&r=PG", "display_name": "Pavel", "link": "https://stackoverflow.com/users/845435/pavel"}, "edited": false, "score": 0, "creation_date": 1569419847, "post_id": 58097459, "comment_id": 102591947, "body": "Appreciate the answer!"}], "tags": [], "owner": {"reputation": 1543, "user_id": 8356442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8f892cf10c7afae14ab19ebbe89543?s=128&d=identicon&r=PG", "display_name": "Martin Campbell", "link": "https://stackoverflow.com/users/8356442/martin-campbell"}, "is_accepted": true, "score": 0, "last_activity_date": 1569411307, "creation_date": 1569411307, "answer_id": 58097459, "question_id": 58086849, "link": "https://stackoverflow.com/questions/58086849/golang-aws-s3-batch-object-creation/58097459#58097459", "title": "Golang AWS S3 batch object creation", "body": "<p>There is no such thing as \"folders\" in S3. At simple high level, S3 is a big key/value store. The list operation supports finding subsets of keys that begin with a certain prefix and can stop at a known delimiter (e.g. <code>/</code>), allowing it to look like it has file system like semantics. </p>\n\n<p>Simply putting an object to <code>/a/b/c/d</code> which look like it has created folders <code>a</code>, <code>b</code> &amp; <code>c</code> but it has simply created one object with that key. The list operation used in the console is stopping at <code>/</code> as a delimiter so it offers a folder like view.</p>\n\n<p>You can't put multiple S3 objects in a single operation. Each one has to be uploaded as an individual operation. Using Go, I'd recommend you could have a channel which you put all uploads required and have multiple concurrent workers processing these to improve performance. You'd need to do some tuning to find the optimal amount. I wouldn't be surprised if there isn't already a library for this as this would be quite a common S3 use case.</p>\n"}], "owner": {"reputation": 864, "user_id": 845435, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/610458a30958c9d336ee691fa1a87369?s=128&d=identicon&r=PG", "display_name": "Pavel", "link": "https://stackoverflow.com/users/845435/pavel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 58097459, "answer_count": 1, "score": 0, "last_activity_date": 1569411307, "creation_date": 1569352404, "question_id": 58086849, "link": "https://stackoverflow.com/questions/58086849/golang-aws-s3-batch-object-creation", "title": "Golang AWS S3 batch object creation", "body": "<p>I'm trying to create a bunch of \"folders\" inside s3 bucket. Was trying to duplicate the same approach as \n<a href=\"https://github.com/aws/aws-sdk-go/blob/master/service/s3/s3manager/batch_test.go#L742\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-go/blob/master/service/s3/s3manager/batch_test.go#L742</a> but this thing expects a \"Body\" which is not really needed in my case. \nSo far the following code does what I need but I feel like there is a better \"batched\" approach that can be implemented.</p>\n\n<pre><code>serv := s3.New(session.New(s3h.Config))\n\nfor _, i1 := range []string{\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"0\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\"} {\n    for _, i2 := range []string{\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"0\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\"} {\n        req := &amp;s3.PutObjectInput{\n            Bucket: aws.String(S3_BUCKET),\n            Key:    aws.String(i1 + i2 + \"/\"),\n        }\n        serv.PutObject(req)\n    }\n}\n</code></pre>\n\n<p>Any pointers?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1569351129, "post_id": 58086532, "comment_id": 102566778, "body": "Length is already an integer property of a slice: <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>"}, {"owner": {"reputation": 6964, "user_id": 1424739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/19d3c927744b5ad3b94afbf88e1c3844?s=128&d=identicon&r=PG", "display_name": "user1424739", "link": "https://stackoverflow.com/users/1424739/user1424739"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1569351363, "post_id": 58086532, "comment_id": 102566854, "body": "But will the function call <code>len()</code> be optimized away?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1569351604, "post_id": 58086532, "comment_id": 102566947, "body": "Not sure what you mean - all it does is read an int. That&#39;s about as optimized as it gets. Storing it in a variable would be no change; you&#39;d be reading an int just like <code>len</code> does."}, {"owner": {"reputation": 6964, "user_id": 1424739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/19d3c927744b5ad3b94afbf88e1c3844?s=128&d=identicon&r=PG", "display_name": "user1424739", "link": "https://stackoverflow.com/users/1424739/user1424739"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1569351661, "post_id": 58086532, "comment_id": 102566973, "body": "My question is whether the function call of <code>len()</code> actually appears in the compile binary code."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1569353805, "post_id": 58086532, "comment_id": 102567844, "body": "What does it mean for &quot;<code>len()</code> to appear in the compile binary code&quot;? The corresponding instructions must be in the binary for it to work. Whether that means it&#39;s an inlined &quot;function&quot; or a compiler construct is really just irrelevant details about the implementation. It all boils down to some MOV instructions regardless of what you call it."}, {"owner": {"reputation": 6964, "user_id": 1424739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/19d3c927744b5ad3b94afbf88e1c3844?s=128&d=identicon&r=PG", "display_name": "user1424739", "link": "https://stackoverflow.com/users/1424739/user1424739"}, "edited": false, "score": 0, "creation_date": 1569354715, "post_id": 58086532, "comment_id": 102568127, "body": "I mean whether <code>len()</code> is inlined or not."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1569365448, "post_id": 58086532, "comment_id": 102571345, "body": "The builtin len() is function syntax for several operations known to the compiler.  For slice arguments, the operation is slice length read.  There is no runtime function for reading the length field."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1569366685, "post_id": 58086532, "comment_id": 102571642, "body": "* &quot;Premature optimization is the root of all evil&quot; -- Donald Knuth* I suggest <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">profiling on your code</a>. <code>len()</code> will hardly be something which will be a culprit..."}], "answers": [{"tags": [], "owner": {"reputation": 78, "user_id": 9512099, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SEHnRCSkYVc/AAAAAAAAAAI/AAAAAAAAAIQ/rIa8ZBnFhMc/photo.jpg?sz=128", "display_name": "Gavin Xu", "link": "https://stackoverflow.com/users/9512099/gavin-xu"}, "is_accepted": true, "score": 2, "last_activity_date": 1569378313, "creation_date": 1569378313, "answer_id": 58090355, "question_id": 58086532, "link": "https://stackoverflow.com/questions/58086532/how-fast-is-it-to-call-len-on-a-slice/58090355#58090355", "title": "How fast is it to call len() on a slice?", "body": "<p>Here is my understanding:</p>\n\n<p>You can regard <code>slice</code> as a <code>struct</code>,of which <code>length</code> is a member.</p>\n\n<p>The only thing function <code>len()</code> does is to read that member of <code>type slice struct</code>,thus there is no need to worry about its performance---it's as fast as reading the <code>length int</code> you create by yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 412, "user_id": 10779150, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PdwkjFzp4rE/AAAAAAAAAAI/AAAAAAAAABU/9BZconXx6W0/photo.jpg?sz=128", "display_name": "Laevus Dexter", "link": "https://stackoverflow.com/users/10779150/laevus-dexter"}, "is_accepted": false, "score": 2, "last_activity_date": 1569386849, "last_edit_date": 1569386849, "creation_date": 1569385387, "answer_id": 58091122, "question_id": 58086532, "link": "https://stackoverflow.com/questions/58086532/how-fast-is-it-to-call-len-on-a-slice/58091122#58091122", "title": "How fast is it to call len() on a slice?", "body": "<p>All of build-in functions not actually functions. It might be bunch of another functions or just one asm instruction (as for this case).</p>\n\n<p>Here's slice struct:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type SliceHeader struct {\n    Data uintptr // sizeof(uintptr) = 8 byte\n    Len  int\n    Cap  int\n}\n</code></pre>\n\n<p>To get len of slice, we should to get offset from pointer of slice.\nGo-idiomatic variant looks like following:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>*(*int)(unsafe.Pointer(uintptr(pointer_to_slice) + 8))\n</code></pre>\n\n<p>As you can see, output goasm code of len(b) equals one instruction:\n<a href=\"https://godbolt.org/z/z0PtMe\" rel=\"nofollow noreferrer\">https://godbolt.org/z/z0PtMe</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var b1 = []byte{1, 2, 3}\nvar b2 = []byte{4, 5, 6}\n\nfunc main() {\n   l1 := len(b1)\n\n   if len(b2) == l1 {\n       println(l1)\n   } else {\n       println(len(b2))\n   }\n}\n</code></pre>\n\n<p><code>l1 := len(b1)</code></p>\n\n<p>=</p>\n\n<p><code>movq    \"\".b1+8(SB), AX // ax == l1</code></p>\n\n<p>but,  for <code>len(b2) == l1</code> compiler creates additional variable:</p>\n\n<p><code>movq    \"\".b2+8(SB), CX // cx == len(b2) in \"if\" statement</code> </p>\n\n<p>So, we can conclude that creating new variable for length does not affect performance. </p>\n"}], "owner": {"reputation": 6964, "user_id": 1424739, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/19d3c927744b5ad3b94afbf88e1c3844?s=128&d=identicon&r=PG", "display_name": "user1424739", "link": "https://stackoverflow.com/users/1424739/user1424739"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 58090355, "answer_count": 2, "score": 2, "last_activity_date": 1569386849, "creation_date": 1569351048, "question_id": 58086532, "link": "https://stackoverflow.com/questions/58086532/how-fast-is-it-to-call-len-on-a-slice", "title": "How fast is it to call len() on a slice?", "body": "<p>I am wondering how fast is it to access <code>len()</code> of a slice. If I need to use the length of a slice for a few time, is it worthwhile to store it to an <code>int</code> variable? Or calling <code>len()</code> will be optimized as if an int variable is accessed? (In such case, there is no need to store the length of a variable by the user.) Thanks.</p>\n"}, {"tags": ["google-chrome", "go", "web-scraping"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1569929059, "post_id": 58085607, "comment_id": 102747182, "body": "This is kinda old but might help: <a href=\"https://github.com/chromedp/chromedp/issues/92\" rel=\"nofollow noreferrer\">github.com/chromedp/chromedp/issues/92</a>"}, {"owner": {"reputation": 179, "user_id": 4546396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4AxEt.jpg?s=128&g=1", "display_name": "Salis", "link": "https://stackoverflow.com/users/4546396/salis"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1569944655, "post_id": 58085607, "comment_id": 102756321, "body": "I want specific code example"}], "answers": [{"tags": [], "owner": {"reputation": 154, "user_id": 10316247, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--EoxDyFKf8Y/AAAAAAAAAAI/AAAAAAAAAuM/gd0UM-OmTx8/photo.jpg?sz=128", "display_name": "nicolasassi", "link": "https://stackoverflow.com/users/10316247/nicolasassi"}, "is_accepted": false, "score": 0, "last_activity_date": 1570042076, "creation_date": 1570042076, "answer_id": 58207612, "question_id": 58085607, "link": "https://stackoverflow.com/questions/58085607/chromedp-handle-alert/58207612#58207612", "title": "Chromedp: handle alert", "body": "<p>I did a workaround by hard-coding some javascript into the browser before anything and then listening to the alert box text in the console.</p>\n\n<p>here the code for reference:</p>\n\n<pre><code>func main() {\n    // create context\n    ctx, cancel := chromedp.NewContext(context.Background())\n    defer cancel()\n\n    // run task list\n    var res interface{}\n    err := chromedp.Run(ctx,\n    chromedp.Navigate(`https://www.quackit.com/javascript/javascript_alert_box.cfm`), // navigate to random page\n    chromedp.EvaluateAsDevTools(`window.alert = function (txt){return txt}`, &amp;res), // set a function to return the text in the alert box as text\n    chromedp.EvaluateAsDevTools(`alert('hehe')`, &amp;res), // create an alert box to test the execution\n)\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Println(res)\n</code></pre>\n\n<p>}</p>\n\n<p>it will log in your console the res.\nHope it helps ;)</p>\n"}, {"tags": [], "owner": {"reputation": 5340, "user_id": 324827, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ed7f53f5feab686252b126d0cb4a1459?s=128&d=identicon&r=PG", "display_name": "TCS", "link": "https://stackoverflow.com/users/324827/tcs"}, "is_accepted": false, "score": 2, "last_activity_date": 1570287861, "creation_date": 1570287861, "answer_id": 58249530, "question_id": 58085607, "link": "https://stackoverflow.com/questions/58085607/chromedp-handle-alert/58249530#58249530", "title": "Chromedp: handle alert", "body": "<p>Inside a Task, use ListenTarget and wait till you a JS dialog event.</p>\n\n<pre><code>printMsg := chromedp.ActionFunc(func(ctx context.Context) error {\n\n\n    chromedp.ListenTarget(lctx, func(ev interface{}) {\n\n        if _, ok := ev.(*page.EventJavascriptDialogOpening); ok { // page loaded\n\n            fmt.Printf(ev.(*page.EventJavascriptDialogOpening).Message) // holds msg!\n        }\n    })\n\n}\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 4546396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4AxEt.jpg?s=128&g=1", "display_name": "Salis", "link": "https://stackoverflow.com/users/4546396/salis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 3, "answer_count": 2, "score": 4, "last_activity_date": 1570287861, "creation_date": 1569346685, "question_id": 58085607, "link": "https://stackoverflow.com/questions/58085607/chromedp-handle-alert", "title": "Chromedp: handle alert", "body": "<p>How to catch alert box showing on web page and getting the text inside it by using chromedp</p>\n\n<p>I have noticed that when alert is showing up, I can see that Page.javascriptDialogOpening is showing</p>\n\n<p>I am using      </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>cdp.EvaluateAsDevTools(\"Page.javascriptDialogOpening\", res)\n</code></pre>\n\n<p>to get the text inside it, but it doesn't work\nHow to handle it in chromedp??</p>\n"}, {"tags": ["go", "testing", "command-line-interface"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1569344550, "post_id": 58085039, "comment_id": 102564052, "body": "The general answer would be &quot;the same way you test anything else&quot;. If there is some specific aspect you&#39;re having trouble with, can you clarify your question and if possible provide a sample of the code you need to test?"}, {"owner": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1569344787, "post_id": 58085039, "comment_id": 102564156, "body": "@Adrian If that&#39;s so, then why isn&#39;t there any real examples for testing CLI applications, but rather only some bits of code (functions) inside them? I&#39;ve specifically said I&#39;m having troubles with coming up with tests for flags."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1569345044, "post_id": 58085039, "comment_id": 102564250, "body": "Outside of a handful of GUI experiments, basically <b>all</b> Go programs are CLI programs, so generally speaking, every example for testing in Go is an example for testing CLI applications. You have some code that does some stuff. It needs to be designed in a way that it is testable, then tested. Without seeing your code, there&#39;s no real way to offer more advice than that."}, {"owner": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1569345240, "post_id": 58085039, "comment_id": 102564323, "body": "@Adrian I&#39;m sorry, but that level of generalisation, while technically correct, isn&#39;t very helpful. Docker isn&#39;t a &#39;GUI experiment&#39; but we wouldn&#39;t call it a &#39;CLI program&#39; (perhaps with exception for the CLI Docker command). Neither is kube-apiserver, and we still wouldn&#39;t call it that. I&#39;ve also clarified the flags case, which you&#39;ve ignored."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1569345636, "post_id": 58085039, "comment_id": 102564504, "body": "Generalizations are all that can really be offered <i>without seeing the code you&#39;re trying to test</i>. And those programs you listed are definitely CLI programs; they are executed from the command line, taking command line flags and parameters."}, {"owner": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 1, "creation_date": 1569347381, "post_id": 58085039, "comment_id": 102565243, "body": "As usual, <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a> will increase the chance that somebody will be able to help you. What have you tried ?"}, {"owner": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "reply_to_user": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 0, "creation_date": 1569400995, "post_id": 58085039, "comment_id": 102581228, "body": "@marco.m question updated with example code."}, {"owner": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 0, "creation_date": 1569408030, "post_id": 58085039, "comment_id": 102585137, "body": "Thanks for the code; on the other hand it doesn&#39;t compile, the flags are undeclared. I made the effort to copy the code in my editor, please make the effort to give us working code."}, {"owner": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "reply_to_user": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 0, "creation_date": 1569409706, "post_id": 58085039, "comment_id": 102586034, "body": "@marco.m The code was simply a pseudocode to display the case I&#39;d like to test. Here you go, a code that compiles."}, {"owner": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 0, "creation_date": 1569433784, "post_id": 58085039, "comment_id": 102599089, "body": "The code compiles and exits silently and immediately. My attempts finish here."}, {"owner": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "reply_to_user": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 0, "creation_date": 1569595509, "post_id": 58085039, "comment_id": 102660175, "body": "@marco.m I&#39;m sorry, I don&#39;t understand your point, you wanted me to provide a code sample that complies, so I did?"}], "answers": [{"comments": [{"owner": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "edited": false, "score": 0, "creation_date": 1569400904, "post_id": 58089323, "comment_id": 102581185, "body": "I&#39;ve updated the question with slightly modified code, showing the flags I am concerned about. How would you write tests for those?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "edited": false, "score": 0, "creation_date": 1569409855, "post_id": 58089323, "comment_id": 102586105, "body": "@SpankMe Again: Do NOT write them as a &quot;closure&quot;, as shown. Make them a named function, and reference that function in &quot;App.Action&quot;. Then, you can test it all you like."}, {"owner": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "edited": false, "score": 0, "creation_date": 1569413602, "post_id": 58089323, "comment_id": 102588045, "body": "I&#39;m sorry, but I don&#39;t understand, could you please provide an example on how to do that?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "edited": false, "score": 0, "creation_date": 1569414213, "post_id": 58089323, "comment_id": 102588416, "body": "@SpankMe I did above. See <code>App.Action = Friend</code>"}, {"owner": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "edited": false, "score": 0, "creation_date": 1569416291, "post_id": 58089323, "comment_id": 102589764, "body": "I still don&#39;t understand, your example does nothing with flags, and it is specifically flags testing (the CLI nature of the application) that I am having problems wrapping my head around."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "edited": false, "score": 0, "creation_date": 1569416800, "post_id": 58089323, "comment_id": 102590108, "body": "@SpankMe You pass your flags to a function. This function is externalized. So you can set the values as you see fit. Remember: you do not unittest <code>urfave&#47;cli</code>, you unit test <i>your code</i>. Which you can do with the sample above."}, {"owner": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "edited": false, "score": 0, "creation_date": 1569595456, "post_id": 58089323, "comment_id": 102660147, "body": "I&#39;ve externalised the action function, but I still struggle to test anything - how do I set cli flags for the testing function or how do I check these flags values if things like cli.Context are being set when the actual application code executes, not the test code? Would you be able to amend your example to reflect even a single flag?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "edited": false, "score": 0, "creation_date": 1569894210, "post_id": 58089323, "comment_id": 102734729, "body": "@SpankMe Again - you do not test flags. You test functions. A function which now has a name, after you externalized it. PLEASE read the links I gave you - the testable example example should show you that I call <code>Friend</code> with nil. With an externalized function, you can follow <a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">golang.org/pkg/testing</a>. You do not call your program with flags. You call functions. Functions. no program."}, {"owner": {"reputation": 784, "user_id": 5280055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZJPMINabE4M/AAAAAAAAAAI/AAAAAAAAHvU/y3n_gZhwvVE/photo.jpg?sz=128", "display_name": "Robert Ranjan", "link": "https://stackoverflow.com/users/5280055/robert-ranjan"}, "edited": false, "score": 0, "creation_date": 1610397333, "post_id": 58089323, "comment_id": 116115393, "body": "@MarkusWMahlberg, how to extract <code>*cli.Context</code> from var <code>app</code> if one like to call Friend(c *cli.Context) from ExampleFriend()?"}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1569368584, "last_edit_date": 1569368584, "creation_date": 1569368112, "answer_id": 58089323, "question_id": 58085039, "link": "https://stackoverflow.com/questions/58085039/testing-urfave-cli-based-applications-with-go/58089323#58089323", "title": "Testing urfave/cli based applications with go", "body": "<p>As Adrian correctly wrote</p>\n\n<blockquote>\n  <p>the same way you test anything else</p>\n</blockquote>\n\n<p>Given a slightly modified example of the sample code of the project</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"log\"\n  \"os\"\n\n  \"github.com/urfave/cli\"\n)\n\nfunc Friend(c *cli.Context) error {\n  fmt.Println(\"Hello friend!\")\n  return nil\n}\n\nfunc main() {\n  app := cli.NewApp()\n  app.Name = \"greet\"\n  app.Usage = \"fight the loneliness!\"\n  app.Action = Friend\n\n  err := app.Run(os.Args)\n  if err != nil {\n    log.Fatal(err)\n  }\n}\n</code></pre>\n\n<p>Since this code actually prints something instead of returning a value you can evaluate, you could use a <a href=\"https://blog.golang.org/examples\" rel=\"nofollow noreferrer\">testable example</a></p>\n\n<pre><code>func ExampleFriend(){\n   // Yeah, technically, we can save the error check with the code above\n   // but this illustrates how you can make sure the output\n   // is not what the testable example expects.\n   if err := Friend(nil){\n     fmt.Printf(\"Friend: %s\",err)\n   }\n\n  // Output:\n  // Hello friend!\n}\n</code></pre>\n\n<p>Note that <code>Action</code> expects an <a href=\"https://godoc.org/github.com/urfave/cli#ActionFunc\" rel=\"nofollow noreferrer\"><code>ActionFunc</code></a>. Where you define that <code>ActionFunc</code> is pretty much your thing. It could even come from a different package. So it is your design on how good your application will be testable.</p>\n\n<p><strong>Edit</strong> The signature of the value Action expects will change in the future, at least <a href=\"https://godoc.org/github.com/urfave/cli#App\" rel=\"nofollow noreferrer\">according to the docs</a>. I already find it questionable to use <code>interface{}</code> to be able to pass nil to Action, and then check and type assert for ActionFunc, where a no-op ActionFunc would actually serve the same purpose, but removing an error return value <em>really</em> makes me scratch my head. I strongly recommend to have a look at <a href=\"https://github.com/alecthomas/kingpin\" rel=\"nofollow noreferrer\">alecthomas/kingpin</a> for smaller to medium size applications or <a href=\"https://github.com/spf13/cobra\" rel=\"nofollow noreferrer\">spf13/cobra</a>, which is suitable even for the most complex of cli applications.</p>\n"}], "owner": {"reputation": 770, "user_id": 302765, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3897d1c3192a477838482cb4bc567c64?s=128&d=identicon&r=PG", "display_name": "SpankMe", "link": "https://stackoverflow.com/users/302765/spankme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1147, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1569409680, "creation_date": 1569344310, "last_edit_date": 1569409680, "question_id": 58085039, "link": "https://stackoverflow.com/questions/58085039/testing-urfave-cli-based-applications-with-go", "title": "Testing urfave/cli based applications with go", "body": "<p>I'm writing a small CLI application in Golang using urfave/cli framework and I'd like to write tests for it, but I can't find any useful information on how to test CLI applications, specifically written with the urfave/cli library. I have a lot of flags in the application and some of them are mutually exclusive and I'd like a proper test to stay on top of them - does anyone have an idea how to do it the right way?</p>\n\n<p>EDIT:\nConsider the following minimal example of application with several flags and restrictions around them. How would you test these flags usage (requirements, exclusivity, etc.) and how they influence the functions when they're set or not?</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"os\"\n\n    \"github.com/urfave/cli\"\n)\n\nfunc doSomething(flag1 string, flag2 string, flag3 bool, flag4 bool) error {\n    err := errors.New(\"something\")\n    return err\n}\n\nfunc main() {\n    app := cli.NewApp()\n    app.Name = \"greet\"\n    app.Usage = \"fight the loneliness!\"\n\n    var flag1, flag2 string\n    var flag3, flag4 bool\n\n    app.Flags = []cli.Flag{\n        cli.StringFlag{\n            Name:        \"flag1\",\n            Value:       \"\",\n            Usage:       \"flag1\",\n            Destination: &amp;flag1,\n        },\n        cli.StringFlag{\n            Name:        \"flag2\",\n            Value:       \"\",\n            Usage:       \"flag2\",\n            Destination: &amp;flag2,\n        },\n        cli.BoolFlag{\n            Name:        \"flag3\",\n            Usage:       \"flag3\",\n            Destination: &amp;flag3,\n        },\n        cli.BoolFlag{\n            Name:        \"flag4\",\n            Usage:       \"flag4\",\n            Destination: &amp;flag4,\n        },\n    }\n\n    app.Action = func(c *cli.Context) error {\n\n        if flag1 != \"\" &amp;&amp; c.NumFlags() &gt; 1 {\n            fmt.Println(\"--flag1 flag cannot be used with any other flags\")\n            cli.ShowAppHelp(c)\n            os.Exit(1)\n        }\n\n        if flag1 == \"\" &amp;&amp; flag2 == \"\" || c.NumFlags() &lt; 1 {\n            fmt.Println(\"--flag2 is required\")\n            cli.ShowAppHelp(c)\n            os.Exit(1)\n        }\n\n        if flag3 &amp;&amp; flag4 {\n            fmt.Println(\"--flag3 and --flag4 flags are mutually exclusive\")\n            cli.ShowAppHelp(c)\n            os.Exit(1)\n        }\n\n        err := doSomething(flag1, flag2, flag3, flag4)\n        return err\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go", "postman", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 6766452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hYo44.jpg?s=128&g=1", "display_name": "Lakhan Kamireddy", "link": "https://stackoverflow.com/users/6766452/lakhan-kamireddy"}, "is_accepted": true, "score": 5, "last_activity_date": 1569655523, "last_edit_date": 1569655523, "creation_date": 1569526268, "answer_id": 58123569, "question_id": 58084494, "link": "https://stackoverflow.com/questions/58084494/golang-how-can-i-get-authorization-from-mux/58123569#58123569", "title": "Golang - How can I get authorization from mux?", "body": "<p>Since you are checking for the token <code>x-access-token</code> in the request header, you need to add the same while sending the request. This can be easily done in Postman as shown below -</p>\n\n<p><img src=\"https://i.stack.imgur.com/WnMy2.png\" alt=\"Screenshot of Postman showing how to set header in http request\"></p>\n\n<p>The router I've used is -</p>\n\n<blockquote>\n  <p>package main</p>\n</blockquote>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func router() *mux.Router {\n    router := mux.NewRouter().StrictSlash(true)\n    secure := router.PathPrefix(\"/auth\").Subrouter()\n    secure.Use(auth.JwtVerify)\n    secure.HandleFunc(\"/api\", middleware.ApiHandler).Methods(\"GET\")\n    return router\n}\n\nfunc main() {\n    r := router()\n    http.ListenAndServe(\":8080\", r)\n}\n</code></pre>\n\n<p>The middleware I've used is -</p>\n\n<blockquote>\n  <p>package auth</p>\n</blockquote>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func JwtVerify(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        var header = r.Header.Get(\"x-access-token\")\n\n        json.NewEncoder(w).Encode(r)\n        header = strings.TrimSpace(header)\n\n        if header == \"\" {\n            w.WriteHeader(http.StatusForbidden)\n            json.NewEncoder(w).Encode(\"Missing auth token\")\n            return\n        } else {\n            json.NewEncoder(w).Encode(fmt.Sprintf(\"Token found. Value %s\", header))\n        }\n        next.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>and the handler is -</p>\n\n<blockquote>\n  <p>package middleware</p>\n</blockquote>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func ApiHandler(w http.ResponseWriter, r *http.Request) {\n    w.WriteHeader(http.StatusOK)\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    json.NewEncoder(w).Encode(\"SUCCESS!\")\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 513, "user_id": 8491066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFNEP.jpg?s=128&g=1", "display_name": "sirisakc", "link": "https://stackoverflow.com/users/8491066/sirisakc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3223, "favorite_count": 0, "accepted_answer_id": 58123569, "answer_count": 1, "score": 2, "last_activity_date": 1569655523, "creation_date": 1569342030, "question_id": 58084494, "link": "https://stackoverflow.com/questions/58084494/golang-how-can-i-get-authorization-from-mux", "title": "Golang - How can I get authorization from mux?", "body": "<p>I'm a new beginner of Golang, I start learning Gorilla/Mux with JWT.</p>\n\n<p>I'm just success in doing register a user to MongoDB and then login.\nI use Postman to test. But when I try to browse to protected route.\nI get the error \"Missing auth token\" as I have in the verification.</p>\n\n<p>How can postman get the authorization to browse protected route?</p>\n\n<p>Below is the code of register and login:</p>\n\n<blockquote>\n  <p>Router Function</p>\n</blockquote>\n\n<pre><code>func Router() *mux.Router {\n\n    router := mux.NewRouter().StrictSlash(true)\n  router.Use(CommonMiddleware)\n\n  //router.HandleFunc(\"/\", middleware.TestAPI).Methods(\"GET\", \"OPTIONS\")\n  router.HandleFunc(\"/register\", middleware.RegisterHandler).Methods(\"POST\", \"OPTIONS\")\n  router.HandleFunc(\"/login\", middleware.LoginHandler).Methods(\"POST\", \"OPTIONS\")\n\n  secure := router.PathPrefix(\"/auth\").Subrouter()\n  secure.Use(auth.JwtVerify)\n\n    secure.HandleFunc(\"/api/task\", middleware.GetAllTask).Methods(\"GET\", \"OPTIONS\")\n    secure.HandleFunc(\"/api/task\", middleware.CreateTask).Methods(\"POST\", \"OPTIONS\")\n    secure.HandleFunc(\"/api/task/{id}\", middleware.TaskComplete).Methods(\"PUT\", \"OPTIONS\")\n    secure.HandleFunc(\"/api/undoTask/{id}\", middleware.UndoTask).Methods(\"PUT\", \"OPTIONS\")\n    secure.HandleFunc(\"/api/deleteTask/{id}\", middleware.DeleteTask).Methods(\"DELETE\", \"OPTIONS\")\n    secure.HandleFunc(\"/api/deleteAllTask\", middleware.DeleteAllTask).Methods(\"DELETE\", \"OPTIONS\")\n    return router\n}\n\nfunc CommonMiddleware(next http.Handler) http.Handler {\n  return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    w.Header().Add(\"Content-Type\", \"application/json\")\n    w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n    w.Header().Set(\"Access-Control-Allow-Methods\", \"POST, GET, OPTIONS, PUT, DELETE\")\n    w.Header().Set(\"Access-Control-Allow-Headers\", \"Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization, Access-Control-Request-Headers, Access-Control-Request-Method, Connection, Host, Origin, User-Agent, Referer, Cache-Control, X-header\")\n    next.ServeHTTP(w, r)\n  })\n}\n</code></pre>\n\n<blockquote>\n  <p>Register function</p>\n</blockquote>\n\n<pre><code>func RegisterHandler(w http.ResponseWriter, r *http.Request) {\n  w.Header().Set(\"Content-Type\", \"application/json\")\n  var user models.User\n  body, _ := ioutil.ReadAll(r.Body)\n  err := json.Unmarshal(body, &amp;user)\n  var res models.ResponseResult\n  if err != nil {\n    res.Error = err.Error()\n    json.NewEncoder(w).Encode(res)\n    return\n  }\n\n  var result models.User\n  err = usercollection.FindOne(context.TODO(), bson.D{{\"username\", user.Username}}).Decode(&amp;result)\n\n  if err != nil {\n    if err.Error() == \"mongo: no documents in result\" {\n      hash, err := bcrypt.GenerateFromPassword([]byte(user.Password), 5)\n\n      if err != nil {\n        res.Error = \"Error While Hashing Password, Try Again\"\n        json.NewEncoder(w).Encode(res)\n        return\n      }\n      user.Password = string(hash)\n\n      _, err = usercollection.InsertOne(context.TODO(), user)\n      if err != nil {\n        res.Error = \"Error While Creating User, Try Again\"\n        json.NewEncoder(w).Encode(res)\n        return\n      }\n      res.Result = \"Register Successful\"\n      json.NewEncoder(w).Encode(res)\n      return\n    }\n    res.Error = err.Error()\n    json.NewEncoder(w).Encode(res)\n    return\n  }\n  res.Result = \"Username already exists!!\"\n  json.NewEncoder(w).Encode(res)\n  return\n}\n</code></pre>\n\n<blockquote>\n  <p>Login Function</p>\n</blockquote>\n\n<pre><code>func LoginHandler(w http.ResponseWriter, r *http.Request) {\n  w.Header().Set(\"Content-Type\", \"application/json\")\n  var user models.User\n  body, _ := ioutil.ReadAll(r.Body)\n  err := json.Unmarshal(body, &amp;user)\n\n  if err != nil {\n    log.Fatal(err)\n  }\n  //var resultToken models.Token\n  var resultUser models.User\n  var res models.ResponseResult\n\n  err = usercollection.FindOne(context.TODO(), bson.D{{\"username\", user.Username}}).Decode(&amp;resultUser)\n\n  if err != nil {\n    res.Error = \"Invalid username\"\n    json.NewEncoder(w).Encode(res)\n    return\n  }\n\n  expiresAt := time.Now().Add(time.Minute * 100000).Unix()\n\n  errf := bcrypt.CompareHashAndPassword([]byte(resultUser.Password), []byte(user.Password))\n\n  if errf != nil &amp;&amp; errf == bcrypt.ErrMismatchedHashAndPassword {\n    var  res = map[string]interface{}{\"status\": false, \"message\": \"Invalid login credential. Please try again\"}\n    json.NewEncoder(w).Encode(res)\n    return\n  }\n  tk := &amp;models.Token{\n    Username: user.Username,\n    StandardClaims: &amp;jwt.StandardClaims{\n      ExpiresAt: expiresAt,\n    },\n  }\n\n  token := jwt.NewWithClaims(jwt.GetSigningMethod(\"HS256\"), tk)\n\n  tokenString, err := token.SignedString([]byte(\"secret\"))\n\n  if err != nil {\n    res.Error = \"Error while generating token, Try again\"\n    json.NewEncoder(w).Encode(res)\n    return\n  }\n  var resp = map[string]interface{}{\"status\": false, \"message\": \"logged in\"}\n  resp[\"token\"] = tokenString\n  resp[\"tk\"] = tk\n\n  json.NewEncoder(w).Encode(resp)\n}\n</code></pre>\n\n<blockquote>\n  <p>Verification Function</p>\n</blockquote>\n\n<pre><code>func JwtVerify(next http.Handler) http.Handler {\n  return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    var header = r.Header.Get(\"x-access-token\")\n\n    json.NewEncoder(w).Encode(r)\n    header = strings.TrimSpace(header)\n\n    if header == \"\" {\n      w.WriteHeader(http.StatusForbidden)\n      json.NewEncoder(w).Encode(Exception{Message: \"Missing auth token\"})\n      return\n    }\n\n    tk := &amp;models.Token{}\n\n    _, err := jwt.ParseWithClaims(header, tk, func(token *jwt.Token) (interface{}, error) {\n      return []byte(\"secret\"), nil\n    })\n\n    if err != nil {\n      w.WriteHeader(http.StatusForbidden)\n      json.NewEncoder(w).Encode(Exception{Message: err.Error()})\n      return\n    }\n\n    ctx := context.WithValue(r.Context(), \"user\", tk)\n    next.ServeHTTP(w, r.WithContext(ctx))\n  })\n}\n</code></pre>\n"}, {"tags": ["go", "kubernetes"], "answers": [{"tags": [], "owner": {"reputation": 1694, "user_id": 1774723, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/rKOqh.png?s=128&g=1", "display_name": "erstaples", "link": "https://stackoverflow.com/users/1774723/erstaples"}, "is_accepted": false, "score": 4, "last_activity_date": 1569346753, "last_edit_date": 1569346753, "creation_date": 1569344964, "answer_id": 58085185, "question_id": 58084335, "link": "https://stackoverflow.com/questions/58084335/how-do-i-get-update-a-kubernetes-custom-resource-from-a-go-program/58085185#58085185", "title": "How do I get/update a Kubernetes custom resource from a go program?", "body": "<p>For any type, including your CRDs, use <a href=\"https://godoc.org/sigs.k8s.io/controller-runtime/pkg/client#Client\" rel=\"nofollow noreferrer\"><code>client.Client</code></a>. </p>\n\n<p>From the documentation:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Using a typed object.\npod := &amp;corev1.Pod{}\n// c is a created client.\n_ = c.Get(context.Background(), client.ObjectKey{\n    Namespace: \"namespace\",\n    Name:      \"name\",\n}, pod)\npod.SetFinalizers(append(pod.GetFinalizers(), \"new-finalizer\"))\n_ = c.Update(context.Background(), pod)\n\n// Using a unstructured object.\nu := &amp;unstructured.Unstructured{}\nu.SetGroupVersionKind(schema.GroupVersionKind{\n    Group:   \"apps\",\n    Kind:    \"Deployment\",\n    Version: \"v1\",\n})\n_ = c.Get(context.Background(), client.ObjectKey{\n    Namespace: \"namespace\",\n    Name:      \"name\",\n}, u)\nu.SetFinalizers(append(u.GetFinalizers(), \"new-finalizer\"))\n_ = c.Update(context.Background(), u)\n</code></pre>\n\n<p>You could just as easily swap in <code>SomeCustomResourceKind</code>:</p>\n\n<pre><code>myCR := &amp;v1alpha1.SomeCustomResourceKind{}\n\n// c is a created client.Client\n_ = c.Get(context.TODO(), client.ObjectKey{\n  Namespace: \"namespace\",\n  Name:      \"some-custom-resource\", }, myCR)\n\nmyCR.MyProperty = \"NewValue\"\n\n_ = c.Update(context.TODO(), myCR)\n</code></pre>\n\n<p>You mentioned you're trying to move this functionality from a bash script to a Go controller, so it would be worth checking out the <a href=\"https://github.com/kubernetes-sigs/kubebuilder\" rel=\"nofollow noreferrer\">Kubebuilder</a> project, which can scaffold out a controller for you (and any additional APIs you might need). It creates fully functional controllers with the controller-runtime Client and wires up all the reconciliation logic to manage your CRDs. </p>\n"}], "owner": {"reputation": 77, "user_id": 6736522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5538141650e7a5bd5216282644204952?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Bennett", "link": "https://stackoverflow.com/users/6736522/paul-bennett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1830, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1615837123, "creation_date": 1569341339, "last_edit_date": 1569397520, "question_id": 58084335, "link": "https://stackoverflow.com/questions/58084335/how-do-i-get-update-a-kubernetes-custom-resource-from-a-go-program", "title": "How do I get/update a Kubernetes custom resource from a go program?", "body": "<p>I'm looking for the go equivalent of:</p>\n\n<pre><code>kubectl get some-custom-resource-kind some-custom-resource -o yaml &gt; file.yaml\nModify the yaml file...\nkubectl apply -f file.yaml\n</code></pre>\n\n<p>Kubernetes has a client go library for <a href=\"https://github.com/kubernetes/client-go\" rel=\"nofollow noreferrer\">standard resource</a> kinds.</p>\n\n<p>And various vendors have client go libraries for their <a href=\"https://github.com/openshift/client-go\" rel=\"nofollow noreferrer\">custom resources</a>.</p>\n\n<p>But I need to get/update a resource kind that doesn't have a publicly available client go library. The logic is implemented in bash script today and I'm trying to move that function to a go controller. </p>\n\n<p>Seems like it there should be a straightforward way in go to do the equivalent of kubectl.</p>\n\n<p>Thanks, Paul</p>\n"}, {"tags": ["go", "rsa", "jwk", "webcrypto"], "comments": [{"owner": {"reputation": 11100, "user_id": 2157818, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f122e6b4c044c93222b952d70aaec3ec?s=128&d=identicon&r=PG", "display_name": "Florent Morselli", "link": "https://stackoverflow.com/users/2157818/florent-morselli"}, "edited": false, "score": 0, "creation_date": 1569346970, "post_id": 58083147, "comment_id": 102565070, "body": "Is it possible to get sample data to determine if it is malformed or not?"}, {"owner": {"reputation": 1504, "user_id": 2594743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/L4gxd.jpg?s=128&g=1", "display_name": "dulan", "link": "https://stackoverflow.com/users/2594743/dulan"}, "reply_to_user": {"reputation": 11100, "user_id": 2157818, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f122e6b4c044c93222b952d70aaec3ec?s=128&d=identicon&r=PG", "display_name": "Florent Morselli", "link": "https://stackoverflow.com/users/2157818/florent-morselli"}, "edited": false, "score": 0, "creation_date": 1569369178, "post_id": 58083147, "comment_id": 102572062, "body": "@FlorentMorselli Hi, just added the backend and frontend print log, not sure if these are the sample data you need"}], "answers": [{"tags": [], "owner": {"reputation": 1504, "user_id": 2594743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/L4gxd.jpg?s=128&g=1", "display_name": "dulan", "link": "https://stackoverflow.com/users/2594743/dulan"}, "is_accepted": false, "score": 0, "last_activity_date": 1569414298, "creation_date": 1569414298, "answer_id": 58098326, "question_id": 58083147, "link": "https://stackoverflow.com/questions/58083147/golang-rsa-oaep-failed-to-decrypt-frontend-uses-webcrypto/58098326#58098326", "title": "Golang rsa-oaep failed to decrypt, frontend uses webcrypto", "body": "<p>Ok my problem is with the arraybuffer to string and string to arraybuffer conversion on the client side. Since the backend treats just about everything in <code>[]byte</code> which is literally byte array, when doing the conversion at frontend, <strong>ALWAYS</strong> use <code>Uint8Array</code> instead of <code>Uint16Array</code> like the following:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>    str2ab(str: string): ArrayBuffer {\n        const buf = new ArrayBuffer(str.length);\n        const bufView = new Uint8Array(buf);\n        for (let i = 0, strLen = str.length; i &lt; strLen; i++) {\n            bufView[i] = str.charCodeAt(i);\n        }\n        return buf;\n    }\n\n    ab2str(buf: ArrayBuffer): string {\n        return String.fromCharCode.apply(null, new Uint8Array(buf));\n    }\n</code></pre>\n\n<p>To be more specific, it's the label field when doing encryption at frontend that's causing me all the headache. </p>\n\n<p>Some side notes: it isn't a smart move to convert the encrypted data from arraybuffer to int array before sending to the backend, that's what base64 encoding is for:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>    uint8ArrayToBase64(buf: Uint8Array): string {\n        let binaryStr = Array.prototype.map.call(buf, function (ch) {\n            return String.fromCharCode(ch);\n        }).join('');\n        return btoa(binaryStr);\n    }\n    ...\n    const encrypted = await Crypto.encrypt(serverPublicKey, loginLabel, enteredPassword); // &lt;&lt;&lt;================= encrypted is an ArrayBuffer\n    const encryptedUint8Array = new Uint8Array(encrypted);\n    const base64Encoded = uint8ArrayToBase64(encryptedUint8Array);\n    // Now we're good to send the encrypted data to the backend\n    ...\n</code></pre>\n\n<p>Hope this will save someone else's precious time... Cheers!</p>\n"}], "owner": {"reputation": 1504, "user_id": 2594743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/L4gxd.jpg?s=128&g=1", "display_name": "dulan", "link": "https://stackoverflow.com/users/2594743/dulan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1569414298, "creation_date": 1569337104, "last_edit_date": 1569369126, "question_id": 58083147, "link": "https://stackoverflow.com/questions/58083147/golang-rsa-oaep-failed-to-decrypt-frontend-uses-webcrypto", "title": "Golang rsa-oaep failed to decrypt, frontend uses webcrypto", "body": "<p>I have this app written in Golang as backend and Typescript as frontend. I need the transfered data to be encrypted so I choose RSA encryption, basically the steps are as follows:</p>\n\n<p><strong>* Backend *</strong></p>\n\n<ol>\n<li>Golang generates private key and public key, save them in redis</li>\n<li>Golang converts the public key to JWK(json web key) using <a href=\"https://github.com/lestrrat-go/jwx\" rel=\"nofollow noreferrer\">lestrrat-go/jwx/</a></li>\n<li>Golang sends the JWK</li>\n</ol>\n\n<p><strong>* Frontend *</strong></p>\n\n<ol start=\"4\">\n<li>Typescript uses Webcrypto API to import JWK key</li>\n<li>Typescript uses the imported key to encrypt some plain text</li>\n<li>After encryption, I get an ArrayBuffer, in order to prevent any encoding issue, I then convert the ArrayBuffer byte to byte to an integer array</li>\n<li>Sending the converted integer array to backend inside a stringified JSON</li>\n</ol>\n\n<p><strong>* Backend *</strong></p>\n\n<ol start=\"8\">\n<li>Golang receives the JSON and convert the integer array to <code>[]byte</code></li>\n<li>retrieve private key from redis and then decrypt</li>\n</ol>\n\n<p>Now all I get is a <code>decryption error</code>... </p>\n\n<p>Things I've checked:</p>\n\n<ul>\n<li>Backend Golang alone encrypt/decrypt just fine</li>\n<li>Frontend webcrypto alone encrypt/decrypt just fine</li>\n<li><p>Check if anything went wrong during golang rsa.PublicKey -> JWK</p>\n\n<ol>\n<li>If the frontend gets the jwk from backend</li>\n<li>import it </li>\n<li>then export it </li>\n<li>send the exported key back to backend</li>\n<li>backend convert the jwk back to rsa public key, it equals to the public key saved in redis</li>\n</ol></li>\n<li><p>After backend receives the int array and convert it to <code>[]byte</code>, its length and content equals to that from frontend</p></li>\n</ul>\n\n<p>Code as follows:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\n    func RSADecrypt(privateKey *rsa.PrivateKey, messageToDecrypt, cryptLabel []byte) (decipherText []byte, err error) {\n        if privateKey == nil {\n            return nil, errors.New(\"private cannot be nil\")\n        }\n        if messageToDecrypt == nil {\n            return nil, errors.New(\"message cannot be nil\")\n        }\n        rng := rand.Reader\n        return rsa.DecryptOAEP(sha256.New(), rng, privateKey, messageToDecrypt, cryptLabel)\n    }\n\n    func GenerateKeyPair() (privateKey *rsa.PrivateKey, publicKey *rsa.PublicKey, err error) {\n        privateKey, err = rsa.GenerateKey(rand.Reader, bitSize)\n        if err != nil {\n            return nil, nil, err\n        }\n        return privateKey, &amp;privateKey.PublicKey, nil\n    }\n\n    func BytesToRSAPrivateKey(privateKeyBytes []byte) (*rsa.PrivateKey, error) {\n        if privateKeyBytes == nil {\n            return nil, errors.New(\"private key bytes cannot be nil\")\n        }\n        block, _ := pem.Decode(privateKeyBytes)\n        enc := x509.IsEncryptedPEMBlock(block)\n        b := block.Bytes\n        var err error\n        if enc {\n            log.Println(\"is encrypted pem block\")\n            b, err = x509.DecryptPEMBlock(block, nil)\n            if err != nil {\n                return nil, err\n            }\n        }\n        key, err := x509.ParsePKCS1PrivateKey(b)\n        if err != nil {\n            return nil, err\n        }\n        return key, nil\n    }\n    ...\n    func userLogin(userUUID string, loginUserInfo []byte) error {\n        privateKeyInString, err := adapter.Get(userUUID + \":privateKey\")\n        if err != nil {\n            return err\n        }\n        privateKey, err := cred.BytesToRSAPrivateKey([]byte(privateKeyInString))\n        if err != nil {\n            return err\n        }\n            var userInfo struct {\n            Username          string `json:\"username\"`\n            EncryptedPassword []int  `json:\"password\"`\n        }\n        err = json.Unmarshal(loginUserInfo, &amp;userInfo)\n        if err != nil {\n            return err\n        }\n        encryptedInBytes := util.IntArrayToByteArray(userInfo.EncryptedPassword)\n        fmt.Println(\"encrypted length: \", len(encryptedInBytes))\n        fmt.Println(encryptedInBytes)\n        decrypted, err := cred.RSADecrypt(privateKey, encryptedInBytes, []byte(\"qp_user_login\"))\n        if err != nil {\n            fmt.Println(\"3, \", err)                 // &lt;&lt;&lt;============================= I'm getting here\n            return err\n        }\n        fmt.Println(string(decrypted))\n\n        return nil\n    }\n\n</code></pre>\n\n<pre class=\"lang-js prettyprint-override\"><code>\n    static async importPublicKey(keyData: string): Promise&lt;CryptoKey&gt; {\n        return new Promise&lt;CryptoKey&gt;((resolve, reject) =&gt; {\n            return window.crypto.subtle.importKey(\n                \"jwk\", //can be \"jwk\" (public or private), \"spki\" (public only), or \"pkcs8\" (private only)\n                {   //this is an example jwk key, other key types are Uint8Array objects\n                    e: \"AQAB\",\n                    kty: \"RSA\",\n                    n: keyData,\n                    alg: \"RSA-OAEP-256\",\n                    ext: true,\n                },\n                {\n                    name: 'RSA-OAEP',\n                    hash: {name: 'SHA-256'}\n                },\n                true,\n                ['encrypt']\n            )\n                .then(publicKey =&gt; {\n                    resolve(publicKey);\n                })\n                .catch(err =&gt; {\n                    reject(err);\n                });\n        });\n    }\n\n    static async encrypt(publicKey: CryptoKey, l, dataToEncrypt: string) {\n        return new Promise&lt;number[]&gt;((resolve, reject) =&gt; {\n            return window.crypto.subtle.encrypt(\n                {\n                    name: 'RSA-OAEP',\n                    label: Toolbox.stringToArrayBuffer(l)\n                },\n                publicKey,\n                Toolbox.stringToArrayBuffer(dataToEncrypt)\n            )\n                .then(encrypted =&gt; {\n                    let uint8View = new Uint8Array(encrypted);\n                    let intArray: number[] = [];\n                    for (let i = 0; i &lt; uint8View.byteLength; i++) {\n                        intArray.push(uint8View[i]);\n                    }\n                    resolve(intArray);\n                })\n                .catch(err =&gt; {\n                    console.error(err);\n                    reject(err);\n                });\n        });\n    }\n\n    async sendLogin(jwkFromServer: any) {\n        let serverPublicKey = await Crypto.importPublicKey(message.content.n);\n        let exported = await Crypto.exportPublicKey(serverPublicKey);\n\n        let encryptedDataChunk = await Crypto.encrypt(serverPublicKey, 'qp_user_login', 'hello foobar');\n        // \u6b63\u5f0f\u53d1\u51fa\u5305\u542b\u7528\u6237\u540d\u548c\u52a0\u5bc6\u7684\u5bc6\u7801\u7684\u767b\u5f55\u8bf7\u6c42\n        let userLoginInfo = {\n            username: 'ycx',\n            password: encryptedDataChunk\n        };\n        let tempUserUUID = ds.getTempUserUUID();\n        console.log('-#@#!#!%%% stringify: ');\n        console.log(JSON.stringify(userLoginInfo));\n        ws.sendMessage({\n            P: tempUserUUID,\n            T: `${constants.clientToServerMessage.officialLogin}`,\n            C: JSON.stringify(userLoginInfo)\n            // C: JSON.stringify(exported)\n        });\n    }\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Adding some print log here:</p>\n\n<ul>\n<li>Backend:</li>\n</ul>\n\n<pre class=\"lang-sh prettyprint-override\"><code>\n    jwk:  {\n            \"e\": \"AQAB\",\n            \"kty\": \"RSA\",\n            \"n\": \"7uCtPCMRhQVkFKQoOuOiY57bfycM_mhmTUAX6n1jj-jTLBpN799URWAtJ0Tk5zL9uJzR89euNTt0DcL0aRT7VuKyyZW4Sty7TK6ivKGkyCMeQkaM2YIY0G7AGj1aPPdwNSsMOXPfppdAmJHEZrxvtwVt1ToHz9h_37X_XVwCFDLr6JpsRCH-dmk87pWrVKxc6x1IJVfhMoAJ9LvbrS0rxAF_sgUhomsJZOUFi9iKMVNONvo1R6diTTqXj2ecJ6-ZO2e0qRANqPU9__Yvqg5Bwkwn8-fIcgohnAM9-DMLEkRiIOG3cgXvpjGEa2aKr0_xb-fsVzRRSYjyAziETZTk-Q\"\n    }\n    public key:\n    -----BEGIN RSA PUBLIC KEY-----\n    MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7uCtPCMRhQVkFKQoOuOi\n    Y57bfycM/mhmTUAX6n1jj+jTLBpN799URWAtJ0Tk5zL9uJzR89euNTt0DcL0aRT7\n    VuKyyZW4Sty7TK6ivKGkyCMeQkaM2YIY0G7AGj1aPPdwNSsMOXPfppdAmJHEZrxv\n    twVt1ToHz9h/37X/XVwCFDLr6JpsRCH+dmk87pWrVKxc6x1IJVfhMoAJ9LvbrS0r\n    xAF/sgUhomsJZOUFi9iKMVNONvo1R6diTTqXj2ecJ6+ZO2e0qRANqPU9//Yvqg5B\n    wkwn8+fIcgohnAM9+DMLEkRiIOG3cgXvpjGEa2aKr0/xb+fsVzRRSYjyAziETZTk\n    +QIDAQAB\n    -----END RSA PUBLIC KEY-----\n\n    encrypted length:  256 and its content in []byte:\n    [187 39 30 53 22 144 100 28 16 168 214 201 115 116 147 82 95 117 84 226 22 100 216 250 222 149 230 162 79 205 19 100 146 226 221 110 155 9 177 19 254 13 141 31 23 208 187 177 228 229 121 148 186 8 213 61 130 230 190 98 147 10 197 138 68 30 243 121 212 4 243 52 240 108 143 126 181 71 5 223 159 27 242 15 150 84 233 255 218 194 151 183 203 158 199 246 128 122 6 45 137 252 48 30 80 150 100 121 158 240 96 164 45 142 110 182 98 230 107 198 142 250 107 38 224 152 228 195 0 38 102 208 216 5 138 67 249 110 171 49 84 195 42 29 74 147 56 233 193 168 189 142 110 24 16 188 210 20 149 44 172 100 1 119 4 21 81 121 26 98 2 163 219 225 218 186 144 220 78 243 212 5 66 40 116 160 147 128 41 201 194 0 74 69 116 204 202 88 204 86 16 164 16 8 142 36 154 189 228 144 61 233 128 247 80 95 190 39 82 34 155 197 130 74 215 73 6 240 37 158 130 11 66 192 54 252 197 71 247 69 115 202 234 30 57 192 254 136 150 71 149 231 207 237 108 217]\n    3,  crypto/rsa: decryption error\n\n</code></pre>\n\n<ul>\n<li>Frontend:</li>\n</ul>\n\n<pre><code>    -#@#!#!%%% stringify: \n    {\"username\":\"ycx\",\"password\":[187,39,30,53,22,144,100,28,16,168,214,201,115,116,147,82,95,117,84,226,22,100,216,250,222,149,230,162,79,205,19,100,146,226,221,110,155,9,177,19,254,13,141,31,23,208,187,177,228,229,121,148,186,8,213,61,130,230,190,98,147,10,197,138,68,30,243,121,212,4,243,52,240,108,143,126,181,71,5,223,159,27,242,15,150,84,233,255,218,194,151,183,203,158,199,246,128,122,6,45,137,252,48,30,80,150,100,121,158,240,96,164,45,142,110,182,98,230,107,198,142,250,107,38,224,152,228,195,0,38,102,208,216,5,138,67,249,110,171,49,84,195,42,29,74,147,56,233,193,168,189,142,110,24,16,188,210,20,149,44,172,100,1,119,4,21,81,121,26,98,2,163,219,225,218,186,144,220,78,243,212,5,66,40,116,160,147,128,41,201,194,0,74,69,116,204,202,88,204,86,16,164,16,8,142,36,154,189,228,144,61,233,128,247,80,95,190,39,82,34,155,197,130,74,215,73,6,240,37,158,130,11,66,192,54,252,197,71,247,69,115,202,234,30,57,192,254,136,150,71,149,231,207,237,108,217]}\n\n</code></pre>\n"}, {"tags": ["go", "https", "client-certificates"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1569338499, "post_id": 58082076, "comment_id": 102561096, "body": "Presumably b[1] is the intermediate that signed b[0]? If so, you can&#39;t just omit that. The server can&#39;t construct the complete chain if you do. Try <code>tls.X509KeyPair(append(pem.EncodeToMemory(b[0]), pem.EncodeToMemory(b[1])...), pem.EncodeToMemory(b[2]))</code>."}, {"owner": {"reputation": 665, "user_id": 533237, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c53d96de85a46700cefb0f6da8a2275?s=128&d=identicon&r=PG&f=1", "display_name": "yodhevauhe", "link": "https://stackoverflow.com/users/533237/yodhevauhe"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569340867, "post_id": 58082076, "comment_id": 102562343, "body": "Working, thanks, Please post as answer"}], "owner": {"reputation": 665, "user_id": 533237, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c53d96de85a46700cefb0f6da8a2275?s=128&d=identicon&r=PG&f=1", "display_name": "yodhevauhe", "link": "https://stackoverflow.com/users/533237/yodhevauhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 549, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1569333821, "creation_date": 1569333821, "question_id": 58082076, "link": "https://stackoverflow.com/questions/58082076/go-https-client-certificate", "title": "go https client certificate", "body": "<p>Trying to migrate a working java code with https client certificate authentication to golang but getting tls handshake error</p>\n\n<p>go version go1.12.9 linux/amd64</p>\n\n<p>client certificate details</p>\n\n<pre><code>openssl pkcs12 -info -in p12file.p12 \nEnter Import Password:\nMAC: sha1, Iteration 2048\nMAC length: 20, salt length: 8\nPKCS7 Encrypted dat..\nCertificate bag\nBag Attributes\n    friendlyName: test\n    localKeyID:..\nsubject=CN = *....com\nissuer=C = US, O = DigiCert Inc...\n\n-----BEGIN CERTIFICATE-----\n-----END CERTIFICATE-----\n\nCertificate bag\nBag Attributes: &lt;No Attributes&gt;\nsubject=C = US, O = DigiCert Inc, OU = www.digicert.com, CN = RapidS...\nissuer=C = US, O = DigiCert Inc, OU = www.digicert.com, CN = DigiCert Global Root CA\n....\n</code></pre>\n\n<p>working Java code</p>\n\n<pre><code>url = new URL(https_url);\nHttpsURLConnection con = (HttpsURLConnection)url.openConnection();\n\nBufferedReader br = new BufferedReader(new InputStreamReader(con.getInputStream()));\n//geting 405 status - so its working\n\nable to establish https connection with this arg -Djavax.net.ssl.keyStoreType=pkcs12 -Djavax.net.ssl.keyStore=./p12file.p12 -Djavax.net.ssl.keyStorePassword=password\n</code></pre>\n\n<p>golang issue (removed error handling part)</p>\n\n<pre><code>fb, err := ioutil.ReadFile(p12file)\nb, err := pkcs12.ToPEM(fb, password)\n\ncert, err := tls.X509KeyPair(pem.EncodeToMemory(b[0]), pem.EncodeToMemory(b[2]))\n//b[0] and b[1] is CERTIFICATE, b[2] is PRIVATE KEY, with 1&amp;2 getting 'private key does not match public key'\n\n//also tried \n// openssl pkcs12 -in ./p12file.p12 -clcerts -nokeys -out certfile.crt \n// openssl pkcs12 -in ./p12file.p12 -nocerts -nodes -out keyfile.key\n// cert, err := tls.LoadX509KeyPair(certFile, keyFile)\ntlsConfig := &amp;tls.Config{\n    Certificates:       []tls.Certificate{cert},\n    InsecureSkipVerify: true,\n}\ntlsConfig.BuildNameToCertificate()\ntransport := &amp;http.Transport{TLSClientConfig: tlsConfig}\nclient := &amp;http.Client{Transport: transport}\n\nresp, err := client.Get(url)\n</code></pre>\n\n<p>getting 'remote error: tls: handshake failure'</p>\n"}, {"tags": ["go", "vim", "vim-plugin"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1569335772, "post_id": 58082037, "comment_id": 102559512, "body": "What are &quot;lot of errors&quot;? Being errors, they probably tell you something important."}, {"owner": {"reputation": 317, "user_id": 984649, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7505110fd29df6eada58ba140fd3eca3?s=128&d=identicon&r=PG", "display_name": "Henrik Guschov", "link": "https://stackoverflow.com/users/984649/henrik-guschov"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1569336566, "post_id": 58082037, "comment_id": 102560007, "body": "I added some of the error messages, though they are longer per line - since the debugger crashes I cannot scroll further to the right."}, {"owner": {"reputation": 2917, "user_id": 187519, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nzv7O.jpg?s=128&g=1", "display_name": "Hassan Voyeau", "link": "https://stackoverflow.com/users/187519/hassan-voyeau"}, "edited": false, "score": 0, "creation_date": 1569336985, "post_id": 58082037, "comment_id": 102560229, "body": "What guide you used to install vim-go on windows?"}, {"owner": {"reputation": 317, "user_id": 984649, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7505110fd29df6eada58ba140fd3eca3?s=128&d=identicon&r=PG", "display_name": "Henrik Guschov", "link": "https://stackoverflow.com/users/984649/henrik-guschov"}, "edited": false, "score": 0, "creation_date": 1569338086, "post_id": 58082037, "comment_id": 102560855, "body": "I used the official guide at <i><a href=\"https://github.com/fatih/vim-go\" rel=\"nofollow noreferrer\">github.com/fatih/vim-go</a></i>. All I did was to clone the repo into plugins/start/vim-go and called <i>:GoInstallBinaries</i>"}, {"owner": {"reputation": 2917, "user_id": 187519, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nzv7O.jpg?s=128&g=1", "display_name": "Hassan Voyeau", "link": "https://stackoverflow.com/users/187519/hassan-voyeau"}, "edited": false, "score": 0, "creation_date": 1569339913, "post_id": 58082037, "comment_id": 102561837, "body": "where is your plugins/start folder on windows?"}, {"owner": {"reputation": 317, "user_id": 984649, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7505110fd29df6eada58ba140fd3eca3?s=128&d=identicon&r=PG", "display_name": "Henrik Guschov", "link": "https://stackoverflow.com/users/984649/henrik-guschov"}, "edited": false, "score": 0, "creation_date": 1569341285, "post_id": 58082037, "comment_id": 102562563, "body": "~/vimfiles/pack/plugins/start"}, {"owner": {"reputation": 317, "user_id": 984649, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7505110fd29df6eada58ba140fd3eca3?s=128&d=identicon&r=PG", "display_name": "Henrik Guschov", "link": "https://stackoverflow.com/users/984649/henrik-guschov"}, "edited": false, "score": 0, "creation_date": 1569341331, "post_id": 58082037, "comment_id": 102562585, "body": "Though nerdtree and vimairline are in vimfiles\\pack\\dist\\start"}, {"owner": {"reputation": 2917, "user_id": 187519, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nzv7O.jpg?s=128&g=1", "display_name": "Hassan Voyeau", "link": "https://stackoverflow.com/users/187519/hassan-voyeau"}, "edited": false, "score": 0, "creation_date": 1569343194, "post_id": 58082037, "comment_id": 102563441, "body": "I am seeing the same errors."}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 984649, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7505110fd29df6eada58ba140fd3eca3?s=128&d=identicon&r=PG", "display_name": "Henrik Guschov", "link": "https://stackoverflow.com/users/984649/henrik-guschov"}, "edited": false, "score": 0, "creation_date": 1569343487, "post_id": 58084826, "comment_id": 102563563, "body": "Thanks, but the whole vim crashes the moment the errors appear. No debugging is possible."}, {"owner": {"reputation": 317, "user_id": 984649, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7505110fd29df6eada58ba140fd3eca3?s=128&d=identicon&r=PG", "display_name": "Henrik Guschov", "link": "https://stackoverflow.com/users/984649/henrik-guschov"}, "edited": false, "score": 0, "creation_date": 1569343546, "post_id": 58084826, "comment_id": 102563590, "body": "Please look at this screenshot for more details: <a href=\"https://user-images.githubusercontent.com/55752765/65526532-874d8580-def1-11e9-933a-394aa798d619.jpg\" rel=\"nofollow noreferrer\">user-images.githubusercontent.com/55752765/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2917, "user_id": 187519, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nzv7O.jpg?s=128&g=1", "display_name": "Hassan Voyeau", "link": "https://stackoverflow.com/users/187519/hassan-voyeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1569343409, "creation_date": 1569343409, "answer_id": 58084826, "question_id": 58082037, "link": "https://stackoverflow.com/questions/58082037/vim-go-debugger-on-windows-results-in-goroutine-not-found/58084826#58084826", "title": "VIM-Go Debugger on Windows results in &quot;Goroutine not found&quot;", "body": "<p>I am reading here <a href=\"https://github.com/fatih/vim-go/issues/2200\" rel=\"nofollow noreferrer\">Request: option to suppress delve debugging logs</a></p>\n\n<blockquote>\n  <p>They are not errors, they're just the diagnostics that delve sends on\n  stderr , hence ERR. You're free to ignore them.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 317, "user_id": 984649, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7505110fd29df6eada58ba140fd3eca3?s=128&d=identicon&r=PG", "display_name": "Henrik Guschov", "link": "https://stackoverflow.com/users/984649/henrik-guschov"}, "is_accepted": false, "score": 1, "last_activity_date": 1569410252, "creation_date": 1569410252, "answer_id": 58097164, "question_id": 58082037, "link": "https://stackoverflow.com/questions/58082037/vim-go-debugger-on-windows-results-in-goroutine-not-found/58097164#58097164", "title": "VIM-Go Debugger on Windows results in &quot;Goroutine not found&quot;", "body": "<p>This seems to be a bug and I filed it as bug #2511 with the developer on github. Just in case somebody else has this problem.</p>\n"}], "owner": {"reputation": 317, "user_id": 984649, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7505110fd29df6eada58ba140fd3eca3?s=128&d=identicon&r=PG", "display_name": "Henrik Guschov", "link": "https://stackoverflow.com/users/984649/henrik-guschov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1569410252, "creation_date": 1569333677, "last_edit_date": 1569336526, "question_id": 58082037, "link": "https://stackoverflow.com/questions/58082037/vim-go-debugger-on-windows-results-in-goroutine-not-found", "title": "VIM-Go Debugger on Windows results in &quot;Goroutine not found&quot;", "body": "<p>I am setting up a vim-go environment on Windows, which is working for the most part. The one thing I cannot get to work is the debugger. I start it with <em>:GoDebugStart</em>. This already leads to a lot of errors regarding the <em>debug layer=rpc</em>.\nThen I get more rpc related errors when trying to create the breakpoint. At the end when starting to debug with <em>:GoDebugNext</em> it complains about <em>Goroutine not found</em>. Does anybody have any similar issues or has an idea what this could be or what is missing?\nThanks!</p>\n\n<p>Here is some of the error output:</p>\n\n<pre><code>ERR: 2019-09-24T16:43:37+02:00 info layer=debugger launching process with args: [C:\\Users\\henri\\AppData\\Local\\Temp\\VIA7813.tmp]\n\nERR: 2019-09-24T16:43:53+02:00 debug layer=rpc &lt;- RPCServer.CreateBreakpoint(rpc2.CreateBreakpointIn{\"Breakpoint\":{\"id\":0,\"name\":\"\",\"addr\":0,\"file\":\"C:/Users/henri/go/src/local/flightGenerator/readAirports.go\",\"line\":38,\"Cond\":\"\",\"continue\":false,\"traceReturn\":false,\"goroutine\":false,\"stacktrace\":0,\"LoadArgs\":null,\"LoadLocals\":null,\"hitCount\":null,\"totalHitCount\":0}})\n\nERR: 2019-09-24T16:43:53+02:00 info layer=debugger created breakpoint: &amp;api.Breakpoint{ID:1, Name:\"\", Addr:0x4d179f, File:\"C:/Users/henri/go/src/local/flightGenerator/readAirports.go\", Line:38, FunctionName:\"main.main\", Cond:\"\", Tracepoint:false, TraceReturn:false, Goroutine:false, Stacktrace:0, Variables:[]string(nil), LoadArgs:(*api.LoadConfig)(nil), LoadLocals:(*api.LoadConfig)(nil), HitCount:map[string]uint64{}, TotalHitCount:0x0}\n\nERR: 2019-09-24T16:43:53+02:00 debug layer=rpc -&gt; *rpc2.CreateBreakpointOut{\"Breakpoint\":{\"id\":1,\"name\":\"\",\"addr\":5052319,\"file\":\"C:/Users/hen\n</code></pre>\n\n<p>Also, after starting the debugging process with <em>:GoDebugNext</em> I get error stating that:</p>\n\n<p>current goroutine not found...\nvim-go: dictionary required</p>\n"}, {"tags": ["docker", "go", "docker-compose", "grpc"], "answers": [{"tags": [], "owner": {"reputation": 247, "user_id": 8928435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ae19f029b39d6cf105485ebdb8bf5a?s=128&d=identicon&r=PG", "display_name": "ahmetovicajdin", "link": "https://stackoverflow.com/users/8928435/ahmetovicajdin"}, "is_accepted": true, "score": 2, "last_activity_date": 1569401325, "creation_date": 1569401325, "answer_id": 58094599, "question_id": 58081376, "link": "https://stackoverflow.com/questions/58081376/docker-compose-cant-find-local-package/58094599#58094599", "title": "Docker compose can&#39;t find local package", "body": "<p>After couple of hours I finally realized what the problem was. \nMy volume path for item-service and go-rest were wrong.\nBecuse my docker-compose file is on the same level with folders of projects item-service and go-rest</p>\n\n<pre><code>-go-rest\n -Project files\n-item-service\n -Project files\n-docker-compose.yaml\n</code></pre>\n\n<p>and my volume paths were </p>\n\n<pre><code>volumes:\n      - .:/go/src/github.com/ajdinahmetovic/go-rest\nvolumes:\n      - .:/go/src/github.com/ajdinahmetovic/item-service\n</code></pre>\n\n<p>They were not able to acces my project folder so they need to be changed to </p>\n\n<pre><code>volumes:\n      - .:/go-rest\nvolumes:\n      - .:/item-service\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 8928435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ae19f029b39d6cf105485ebdb8bf5a?s=128&d=identicon&r=PG", "display_name": "ahmetovicajdin", "link": "https://stackoverflow.com/users/8928435/ahmetovicajdin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 58094599, "answer_count": 1, "score": 2, "last_activity_date": 1569401325, "creation_date": 1569331536, "last_edit_date": 1569342590, "question_id": 58081376, "link": "https://stackoverflow.com/questions/58081376/docker-compose-cant-find-local-package", "title": "Docker compose can&#39;t find local package", "body": "<p>So I created REST api and one grpc service in GOlang and now I want to compose it in docker compose. \nMy docker-compose looks like this:</p>\n\n<pre><code>version: '3'\nservices: \n  db:\n    image: postgres\n    environment:\n      POSTGRES_DB: db_1\n      POSTGRES_USER: postgres\n      POSTGRES_PASSWORD: tajna\n      PGDATA: /tmp\n    volumes:\n      - ./db/sql/user/1_create.sql:/docker-entrypoint-initdb.d/1-create_user.sql\n      - ./db/sql/item/2_create.sql:/docker-entrypoint-initdb.d/2-create_item.sql\n    ports:\n      - 5432:5432\n    networks: \n      apinetwork:\n  service:\n    build: ./item-service\n    command: [\"go\", \"run\", \".\"]\n    volumes:\n      - .:/go/src/github.com/ajdinahmetovic/item-service\n    ports:\n      - \"4040:4040\"\n    depends_on: \n      - db\n    links:\n      - db\n    networks: \n      apinetwork:\n  rest:\n    image: go-rest\n    build: \n      context: ./go-rest\n      dockerfile: Dockerfile\n    command: [\"go\", \"run\", \"main.go\"]\n    volumes:\n      - .:/go/src/github.com/ajdinahmetovic/go-rest\n    ports:\n      - \"3000:3000\"\n    depends_on:\n      - service\n    networks: \n      apinetwork:\nnetworks:\n  apinetwork:\n    driver: bridge\n</code></pre>\n\n<p>After I run docker-compose up I get error that local packages that are inside of go-rest and item-service could not be found.</p>\n\n<pre><code>service_1  | item.go:7:2: no Go files in /go/src/github.com/ajdinahmetovic/item-service/db\nservice_1  | main.go:8:2: cannot find package \"github.com/ajdinahmetovic/item-service/logger\" in any of:\nservice_1  |    /usr/local/go/src/github.com/ajdinahmetovic/item-service/logger (from $GOROOT)\nservice_1  |    /go/src/github.com/ajdinahmetovic/item-service/logger (from $GOPATH)\nservice_1  | item.go:8:2: cannot find package \"github.com/ajdinahmetovic/item-service/proto/v1\" in any of:\nservice_1  |    /usr/local/go/src/github.com/ajdinahmetovic/item-service/proto/v1 (from $GOROOT)\nservice_1  |    /go/src/github.com/ajdinahmetovic/item-service/proto/v1 (from $GOPATH)\najdinahmetovic_service_1 exited with code 1\nrest_1     | /go/src/github.com/ajdinahmetovic/go-rest/routes/item/post.go:9:2: no Go files in /go/src/github.com/ajdinahmetovic/go-rest/db\nrest_1     | /go/src/github.com/ajdinahmetovic/go-rest/routes/refreshToken.go:9:2: cannot find package \"github.com/ajdinahmetovic/go-rest/httputil\" in any of:\nrest_1     |    /usr/local/go/src/github.com/ajdinahmetovic/go-rest/httputil (from $GOROOT)\nrest_1     |    /go/src/github.com/ajdinahmetovic/go-rest/httputil (from $GOPATH)\najdinahmetovic_rest_1 exited with code 1\n</code></pre>\n\n<p>However when I move docker compose file to go-rest folder, rest app succcessfuly runs but my item service fails. As i see problem is in my path to go apps.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569329452, "post_id": 58080411, "comment_id": 102555649, "body": "Not built into the language. Someone may have created some sort of library to provide some or all of that functionality."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569329793, "post_id": 58080411, "comment_id": 102555841, "body": "<a href=\"https://golang.org/pkg/container/list/\" rel=\"nofollow noreferrer\">golang.org/pkg/container/list</a>. As customary for linked lists doesn&#39;t allow random access, though."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1569329826, "post_id": 58080411, "comment_id": 102555867, "body": "Basically this is an &quot;Exceptional Bad Idea&quot; (TM) anyway. One of the main advantages of Go is its static typing."}, {"owner": {"reputation": 23850, "user_id": 196679, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fXUzE.jpg?s=128&g=1", "display_name": "Bazzz", "link": "https://stackoverflow.com/users/196679/bazzz"}, "edited": false, "score": 0, "creation_date": 1569395241, "post_id": 58080411, "comment_id": 102578301, "body": "It is also questionable whether List is a strong data type in Python as you say. To me it seems rather weakly typed if it allows anything inside."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1569328722, "creation_date": 1569328722, "answer_id": 58080533, "question_id": 58080411, "link": "https://stackoverflow.com/questions/58080411/insert-element-at-index-and-delete-element-by-value-in-a-array/58080533#58080533", "title": "Insert element at index and Delete element by value in a Array", "body": "<blockquote>\n  <p>[Is there a] Go[...] datatype similar to List in Python [?]</p>\n</blockquote>\n\n<p>No, there is not.</p>\n"}], "owner": {"reputation": 182, "user_id": 12034040, "user_type": "registered", "profile_image": "https://graph.facebook.com/2694086327309833/picture?type=large", "display_name": "Devendra Mukharaiya", "link": "https://stackoverflow.com/users/12034040/devendra-mukharaiya"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1569330046, "answer_count": 1, "score": -5, "last_activity_date": 1569934443, "creation_date": 1569328287, "last_edit_date": 1569934443, "question_id": 58080411, "link": "https://stackoverflow.com/questions/58080411/insert-element-at-index-and-delete-element-by-value-in-a-array", "closed_reason": "Needs details or clarity", "title": "Insert element at index and Delete element by value in a Array", "body": "<p>What is the fastest way to insert element at index and Delete element by value in a large Array? I can loop over the contents of array (find the location and then shift all the elements) but it will give complexity of o(n).</p>\n\n<p>Is there a builtin that can help shifting the elements in array/slice? or if there is another data structure that can help</p>\n"}, {"tags": ["go", "time", "goroutine", "channels", "go-playground"], "comments": [{"owner": {"reputation": 35, "user_id": 10739382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999b4a0ed9ac0dc426e952896fad2647?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Jain", "link": "https://stackoverflow.com/users/10739382/abhishek-jain"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569329279, "post_id": 58079847, "comment_id": 102555555, "body": "@Flimzy I was testing it out in go playground. But as icza pointed out, the results on playground are cached and hence the actual behaviour is masked. It works fine when I now try it locally"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1569326735, "creation_date": 1569326735, "answer_id": 58079958, "question_id": 58079847, "link": "https://stackoverflow.com/questions/58079847/why-does-time-sleep-not-work-if-there-are-no-further-statements-to-execute/58079958#58079958", "title": "Why does time.Sleep not work if there are no further statements to execute?", "body": "<p>Run it locally, and it will wait. The output on the Go Playground is cached. If there is no output, it doesn't make you wait 6 seconds for nothing. If there is output, the timing of the output is preserved.</p>\n\n<p>Read blog post: <a href=\"https://blog.golang.org/playground\" rel=\"nofollow noreferrer\">The Go Blog: Inside the Go Playground:</a></p>\n\n<blockquote>\n  <p>We capture the timing of each write to standard output and standard error and provide it to the client. Then the client can \"play back\" the writes with the correct timing, so that the output appears just as if the program were running locally.</p>\n</blockquote>\n"}], "owner": {"reputation": 35, "user_id": 10739382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999b4a0ed9ac0dc426e952896fad2647?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Jain", "link": "https://stackoverflow.com/users/10739382/abhishek-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 58079958, "answer_count": 1, "score": -2, "last_activity_date": 1569327372, "creation_date": 1569326354, "last_edit_date": 1569327372, "question_id": 58079847, "link": "https://stackoverflow.com/questions/58079847/why-does-time-sleep-not-work-if-there-are-no-further-statements-to-execute", "title": "Why does time.Sleep not work if there are no further statements to execute?", "body": "<p>I am trying to run this below piece of code</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    time.Sleep(time.Millisecond*6000)\n    fmt.Println(\"Done\")\n}\n</code></pre>\n\n<p>As one expects, it waits for 6 seconds, print \"done\" and then exits</p>\n\n<p>But if I remove the print statement,</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"time\"\n)\n\nfunc main() {\n    time.Sleep(time.Millisecond*6000)\n}\n</code></pre>\n\n<p>it doesn't wait and exits immediately. Why?</p>\n\n<p>Consequently, look at the code below</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    c := make(chan int)\n    go count(6, c)\n    time.Sleep(time.Millisecond*5000)\n}\n\nfunc count(num int, c chan int) {\n    for i := 1; i &lt;= num; i++ {\n        fmt.Println(i)\n        c &lt;- i\n        time.Sleep(time.Millisecond*2000)\n    }\n    close(c)\n}\n</code></pre>\n\n<p>Here the <code>count</code> goroutine will get blocked trying to send <code>i</code> to a channel when no receiver is there to read it and the <code>main</code> function immediately exits even though there is a <code>sleep</code> statement after it. But when I remove the statement</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>c &lt;- i\n</code></pre>\n\n<p>the <code>count</code> goroutine gets to count till 3 since the <code>main</code> function does wait for those 5 seconds as stated.</p>\n\n<p>What is going on here?</p>\n"}, {"tags": ["c#", "go", "dll", "encoding", "c-strings"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10400458"}, "is_accepted": false, "score": 0, "last_activity_date": 1569370741, "last_edit_date": 1569370741, "creation_date": 1569370034, "answer_id": 58089533, "question_id": 58079705, "link": "https://stackoverflow.com/questions/58079705/c-dll-import-go-dll-string-value-discrepancy-cstring-return-values/58089533#58089533", "title": "C# Dll Import Go Dll string value discrepancy - CString return values", "body": "<p>Here is an example with AES encryption within a go dll; the strings are matching for me:</p>\n\n<p>Go code (compiled with <code>CGO_ENABLED=1 GOARCH=386 GOOS=windows go build -buildmode=c-shared -o test.dll AES.go</code>):</p>\n\n<pre><code>package main\n\nimport (\n    \"C\"\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"crypto/rand\"\n    \"encoding/base64\"\n    \"errors\"\n    \"io\"\n)\n\nvar cipherKey = []byte(\"Zq4t7w!z%C&amp;F)J@N\")\n\nfunc main() {}\n\n//export Encrypt\nfunc Encrypt(cMessage *C.char) *C.char {\n    message := C.GoString(cMessage)\n    plainText := []byte(message)\n\n    block, err := aes.NewCipher(cipherKey)\n    if err != nil {\n        panic(err)\n    }\n\n    cipherText := make([]byte, aes.BlockSize+len(plainText))\n    iv := cipherText[:aes.BlockSize]\n    if _, err = io.ReadFull(rand.Reader, iv); err != nil {\n        panic(err)\n    }\n\n    stream := cipher.NewCFBEncrypter(block, iv)\n    stream.XORKeyStream(cipherText[aes.BlockSize:], plainText)\n\n    //returns to base64 encoded string\n    encmess := base64.URLEncoding.EncodeToString(cipherText)\n    return C.CString(encmess)\n}\n\n//export Decrypt\nfunc Decrypt(cEncryptedMessage *C.char) *C.char {\n    encryptedMessage := C.GoString(cEncryptedMessage)\n    cipherText, err := base64.URLEncoding.DecodeString(encryptedMessage)\n    if err != nil {\n        panic(err)\n    }\n\n    block, err := aes.NewCipher(cipherKey)\n    if err != nil {\n        panic(err)\n    }\n\n    if len(cipherText) &lt; aes.BlockSize {\n        err = errors.New(\"Ciphertext block size is too short!\")\n        panic(err)\n    }\n\n    iv := cipherText[:aes.BlockSize]\n    cipherText = cipherText[aes.BlockSize:]\n\n    stream := cipher.NewCFBDecrypter(block, iv)\n    stream.XORKeyStream(cipherText, cipherText)\n\n    decodedmess := string(cipherText)\n    return C.CString(decodedmess)\n}\n</code></pre>\n\n<p>C# code:</p>\n\n<pre><code>namespace WindowsFormsApp1\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            var encrypted = GoFunctions.Encrypt(System.Text.Encoding.UTF8.GetBytes(\"hello\"));\n            var decrypted = GoFunctions.Decrypt(System.Text.Encoding.UTF8.GetBytes(Marshal.PtrToStringAnsi(encrypted)));\n            label1.Text = Marshal.PtrToStringAnsi(encrypted);\n            label2.Text = Marshal.PtrToStringAnsi(decrypted);\n        }\n\n        static class GoFunctions\n        {\n            [DllImport(@\"C:\\Repos\\Go_AES\\test.dll\", CharSet = CharSet.Unicode, CallingConvention = CallingConvention.Cdecl)]\n            public static extern IntPtr Encrypt(byte[] message);\n\n            [DllImport(@\"C:\\Repos\\Go_AES\\test.dll\", CharSet = CharSet.Unicode, CallingConvention = CallingConvention.Cdecl)]\n            public static extern IntPtr Decrypt(byte[] encrypted_message);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 12112838, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCEfa30MSKM0bsWNAF1sQxJOc_peTsYlkFAfN2d=k-s128", "display_name": "Magic Lee", "link": "https://stackoverflow.com/users/12112838/magic-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1569408946, "creation_date": 1569408946, "answer_id": 58096818, "question_id": 58079705, "link": "https://stackoverflow.com/questions/58079705/c-dll-import-go-dll-string-value-discrepancy-cstring-return-values/58096818#58096818", "title": "C# Dll Import Go Dll string value discrepancy - CString return values", "body": "<p>Thank you for helping me. </p>\n\n<p>Your solution didn't work for me, but it helped me a lot. </p>\n\n<pre><code>//export EncryptForDb\nfunc EncryptForDb(value *C.char) unsafe.Pointer {\n   encodedString := Cipher.PrivatKeyEncryptValue(Cipher.PrivatKey, C.GoString(value))\n   return C.CBytes([]byte(encodedString))\n}\n</code></pre>\n\n<p>I'm returning an unsafe Pointer to the result ByteArray. On the C# side im using this code now. </p>\n\n<pre><code>byte[] ICipherManager.EncryptForDb(string value)\n{\n    byte[] encryptedBytes = new byte[1024];\n\n    IntPtr pointer = EncryptForDb(value);\n    Marshal.Copy(pointer, encryptedBytes, 0, encryptedBytes.Length);\n\n    return encryptedBytes;\n}\n</code></pre>\n\n<p>When im using C.CString the raw value is sliced. \nGo and C# Strings does contain a length property. CStrings are terminated by ram and i couldn't find a solution to read or write a whole encrypted string with it. So i decided to use []byte instead.       </p>\n"}], "owner": {"reputation": 31, "user_id": 12112838, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCEfa30MSKM0bsWNAF1sQxJOc_peTsYlkFAfN2d=k-s128", "display_name": "Magic Lee", "link": "https://stackoverflow.com/users/12112838/magic-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1569408946, "creation_date": 1569325846, "last_edit_date": 1569330807, "question_id": 58079705, "link": "https://stackoverflow.com/questions/58079705/c-dll-import-go-dll-string-value-discrepancy-cstring-return-values", "title": "C# Dll Import Go Dll string value discrepancy - CString return values", "body": "<p>i wrote in Go a dll to decrypt / encrypt data with public / private key encoding. </p>\n\n<p>The first problem I encountered was sharing strings between the dll and the c# code. </p>\n\n<p>I solved this by using the C library in Go.  </p>\n\n<pre><code>func myfunc( password *C.char, passwordLength C.int )  *C.char{\n   result = C.GoStringN(password, passwordLength)\n   return C.CString(result)\n}\n</code></pre>\n\n<p>More or less Something like that. </p>\n\n<p>In C# the counterpart is </p>\n\n<pre><code>Marshal.PtrToStringAuto(value);\n</code></pre>\n\n<p>My problem is now that the strings do not match in go and c#. One function is returning an encrypted value and when i log it with    </p>\n\n<pre><code>fmt.println(...)\n</code></pre>\n\n<p>It does not match the return value I'm logging in c# </p>\n\n<pre><code>Console.writeln(...)\n</code></pre>\n\n<p>I tried different functions:</p>\n\n<pre><code>Marshal.PtrToStringAuto(...)\nMarshal.PtrToStringAnsi(...)\nMarshal.PtrToStringUTF8(...)\nMarshal.PtrToStringUni(...)\n</code></pre>\n\n<p>After using the C Library I had problems with the strings in go too. Because of that I added length and moved from C.GoString to C.GoStringN that helped while debugging the code in Go.</p>\n\n<p>I really don't know what I'm doing wrong. Has someone an idea what I could try?</p>\n\n<p><a href=\"https://i.stack.imgur.com/ovSQD.png\" rel=\"nofollow noreferrer\">Output Go 1</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/OzaTr.png\" rel=\"nofollow noreferrer\">Output Go 2</a></p>\n\n<p>I solved a part of the problem. The output of the encryption has a defined size. So in Go im able to read the values now properly. \nWhat options i have in C# to read the values properly? \nMarshal.PtrToStringUTF8 seems to works best from the Marshal functions. But it does not equals the value from Go.</p>\n"}, {"tags": ["docker", "go", "go-modules"], "comments": [{"owner": {"reputation": 428, "user_id": 3647782, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f1d3ea4a1d93019fce2505b49959c42?s=128&d=identicon&r=PG&f=1", "display_name": "FabianTe", "link": "https://stackoverflow.com/users/3647782/fabiante"}, "edited": false, "score": 0, "creation_date": 1569323784, "post_id": 58077106, "comment_id": 102552579, "body": "Have you checked the package names in all you go files? Maybe there is one that does not reflect the directory it is in."}, {"owner": {"reputation": 9, "user_id": 7474143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1VyiM.png?s=128&g=1", "display_name": "Sagad Salem", "link": "https://stackoverflow.com/users/7474143/sagad-salem"}, "reply_to_user": {"reputation": 428, "user_id": 3647782, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f1d3ea4a1d93019fce2505b49959c42?s=128&d=identicon&r=PG&f=1", "display_name": "FabianTe", "link": "https://stackoverflow.com/users/3647782/fabiante"}, "edited": false, "score": 0, "creation_date": 1569345233, "post_id": 58077106, "comment_id": 102564321, "body": "yes I double-check its all right the problem is within the packages outside the go.mod and Dockerfile root path  @FabianTe"}, {"owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "edited": false, "score": 1, "creation_date": 1570035449, "post_id": 58077106, "comment_id": 102790157, "body": "How many go.mod files do you have, and where exactly are they located? The simplest approach by far is to have a single go.mod file, and to place that single go.mod in the root directory of the repository. See this answer for more details: <a href=\"https://stackoverflow.com/a/57314494/11210494\">stackoverflow.com/a/57314494/11210494</a>. Also, what is the exact full error you get? What is the exact command you issued, and in what directory did you issue it?"}], "owner": {"reputation": 9, "user_id": 7474143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1VyiM.png?s=128&g=1", "display_name": "Sagad Salem", "link": "https://stackoverflow.com/users/7474143/sagad-salem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569317427, "creation_date": 1569317149, "last_edit_date": 1569317427, "question_id": 58077106, "link": "https://stackoverflow.com/questions/58077106/docker-build-with-go-modules-import-problem", "title": "docker build with Go modules import problem", "body": "<p>I have a problem with building microservices with Go using some specific project structure</p>\n\n<p>after research, I use the below project structure</p>\n\n<pre><code>github.com/username/container/\n\u251c\u2500\u2500 pkg/ ('username' created packages - common for all services &amp; reusable in other projects)\n|   \u251c\u2500\u2500 errors/\n|   \u251c\u2500\u2500 log/\n|   \u251c\u2500\u2500 metrics/\n|   \u251c\u2500\u2500 infra/     (sub category in packages)\n|   |   \u251c\u2500\u2500 consul/\n|   |   \u2514\u2500\u2500 kubernetes/\n|   \u2514\u2500\u2500 tracing/\n\u251c\u2500\u2500 services/ (where all microservices will be imported as submodules - may or may not be reused)\n|   \u251c\u2500\u2500 account/\n|   |   \u251c\u2500\u2500 handler.go\n|   |   \u251c\u2500\u2500 handler_test.go (unit testing, note filename with '_test')\n|   |   \u251c\u2500\u2500 main.go\n|   |   \u251c\u2500\u2500 main_test.go    (another unit testing)\n|   |   \u251c\u2500\u2500 account.yml     (the configuration file for account microservice)\n|   |   \u251c\u2500\u2500 submodule/      (sub directory)\n|   |   |   \u251c\u2500\u2500 submodule.go\n|   |   |   \u2514\u2500\u2500 submodule_test.go   (submodule unit test)\n|   |   \u251c\u2500\u2500 Dockerfile\n|   |   \u2514\u2500\u2500 README.md\n|   \u251c\u2500\u2500 auth/\n|   \u251c\u2500\u2500 booking/\n|   \u2514\u2500\u2500 user/\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 docker-compose.yml\n</code></pre>\n\n<p>the problem is when I build my account service its give me an error (the module github.com/user_name/services/pkg/errors not found)</p>\n\n<p>so how I build my account service when it has dependencies outside the Dockerfile and go.mod?</p>\n"}, {"tags": ["go", "gcc", "apache-kafka", "librdkafka"], "comments": [{"owner": {"reputation": 2288, "user_id": 1821055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4031acff2994243c56d92f9fd4a8e3bb?s=128&d=identicon&r=PG", "display_name": "Edenhill", "link": "https://stackoverflow.com/users/1821055/edenhill"}, "edited": false, "score": 1, "creation_date": 1569324195, "post_id": 58077079, "comment_id": 102552807, "body": "It seems as if your librdkafka version is outdated. Install v1.1.0 or later."}], "answers": [{"comments": [{"owner": {"reputation": 304, "user_id": 5630721, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/553ee12f5a07d9f25fd0561ff8916295?s=128&d=identicon&r=PG", "display_name": "Dapo Michaels", "link": "https://stackoverflow.com/users/5630721/dapo-michaels"}, "edited": false, "score": 0, "creation_date": 1581692591, "post_id": 58163851, "comment_id": 106532889, "body": "How do I set this up using a Dockerfile"}, {"owner": {"reputation": 401, "user_id": 8002010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6796fea327cab9ac13e660bf3a9b67b?s=128&d=identicon&r=PG&f=1", "display_name": "rvl007", "link": "https://stackoverflow.com/users/8002010/rvl007"}, "reply_to_user": {"reputation": 304, "user_id": 5630721, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/553ee12f5a07d9f25fd0561ff8916295?s=128&d=identicon&r=PG", "display_name": "Dapo Michaels", "link": "https://stackoverflow.com/users/5630721/dapo-michaels"}, "edited": false, "score": 0, "creation_date": 1581729948, "post_id": 58163851, "comment_id": 106545623, "body": "@dapo You can refer this <a href=\"https://stackoverflow.com/questions/58128541/build-golang-application-with-librdkafka-in-a-debian-docker-image\" title=\"build golang application with librdkafka in a debian docker image\">stackoverflow.com/questions/58128541/&hellip;</a>"}], "tags": [], "owner": {"reputation": 401, "user_id": 8002010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6796fea327cab9ac13e660bf3a9b67b?s=128&d=identicon&r=PG&f=1", "display_name": "rvl007", "link": "https://stackoverflow.com/users/8002010/rvl007"}, "is_accepted": false, "score": 2, "last_activity_date": 1569830964, "creation_date": 1569830964, "answer_id": 58163851, "question_id": 58077079, "link": "https://stackoverflow.com/questions/58077079/unable-to-read-librdkafka-file-showing-undefined-reference-to-rd-kafka-header-g/58163851#58163851", "title": "unable to read librdkafka file showing undefined reference to `rd_kafka_header_get_all&#39;", "body": "<p>This is definitely an issue with the librdkafka version. Can you download from the source?</p>\n\n<p>Steps to be followed:</p>\n\n<pre><code>git clone https://github.com/edenhill/librdkafka.git\ncd librdkafka\n./configure --prefix /usr\nmake\nsudo make install\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8654714, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wl9BTn8EQUU/AAAAAAAAAAI/AAAAAAAAACY/4NoFa_Luqdo/photo.jpg?sz=128", "display_name": "Harish Rana", "link": "https://stackoverflow.com/users/8654714/harish-rana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1299, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1569830964, "creation_date": 1569317051, "last_edit_date": 1569334712, "question_id": 58077079, "link": "https://stackoverflow.com/questions/58077079/unable-to-read-librdkafka-file-showing-undefined-reference-to-rd-kafka-header-g", "title": "unable to read librdkafka file showing undefined reference to `rd_kafka_header_get_all&#39;", "body": "<p>I'm trying to set up my project and try to make a build or try to run but every time it showing this error undefined reference. what I learned until now my code is not able to read librdkafka's files.</p>\n\n<p>I tried to change locations where I installed these tools or libraries, I tried to change versions of them, but didn't succeed to resolve it.</p>\n\n<p>these are the locations where libraries installed.</p>\n\n<pre><code>/opt/apache-zookeeper-3.5.5-bin \n/opt/zookeeper\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go\n/home/harishrana/librdkafka\n</code></pre>\n\n<p>and this is the location where my project is situated.</p>\n\n<pre><code>/home/harishrana/go/src/autoextraction\n</code></pre>\n\n<p>this is the error coming</p>\n\n<pre><code>/usr/local/go/pkg/tool/linux_amd64/link: running gcc failed: exit status 1\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_AlterConfigs_result_resources':\n/tmp/go-build/cgo-gcc-prolog:124: undefined reference to `rd_kafka_AlterConfigs_result_resources'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigEntry_is_read_only':\n/tmp/go-build/cgo-gcc-prolog:143: undefined reference to `rd_kafka_ConfigEntry_is_read_only'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigEntry_is_sensitive':\n/tmp/go-build/cgo-gcc-prolog:162: undefined reference to `rd_kafka_ConfigEntry_is_sensitive'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigEntry_is_synonym':\n/tmp/go-build/cgo-gcc-prolog:181: undefined reference to `rd_kafka_ConfigEntry_is_synonym'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigEntry_name':\n/tmp/go-build/cgo-gcc-prolog:199: undefined reference to `rd_kafka_ConfigEntry_name'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigEntry_source':\n/tmp/go-build/cgo-gcc-prolog:218: undefined reference to `rd_kafka_ConfigEntry_source'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigEntry_synonyms':\n/tmp/go-build/cgo-gcc-prolog:237: undefined reference to `rd_kafka_ConfigEntry_synonyms'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigEntry_value':\n/tmp/go-build/cgo-gcc-prolog:255: undefined reference to `rd_kafka_ConfigEntry_value'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigResource_configs':\n/tmp/go-build/cgo-gcc-prolog:274: undefined reference to `rd_kafka_ConfigResource_configs'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigResource_error':\n/tmp/go-build/cgo-gcc-prolog:305: undefined reference to `rd_kafka_ConfigResource_error'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigResource_error_string':\n/tmp/go-build/cgo-gcc-prolog:323: undefined reference to `rd_kafka_ConfigResource_error_string'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigResource_name':\n/tmp/go-build/cgo-gcc-prolog:341: undefined reference to `rd_kafka_ConfigResource_name'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigResource_new':\n/tmp/go-build/cgo-gcc-prolog:361: undefined reference to `rd_kafka_ConfigResource_new'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigResource_set_config':\n/tmp/go-build/cgo-gcc-prolog:382: undefined reference to `rd_kafka_ConfigResource_set_config'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigResource_type':\n/tmp/go-build/cgo-gcc-prolog:401: undefined reference to `rd_kafka_ConfigResource_type'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigSource_name':\n/tmp/go-build/cgo-gcc-prolog:420: undefined reference to `rd_kafka_ConfigSource_name'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_CreatePartitions_result_topics':\n/tmp/go-build/cgo-gcc-prolog:455: undefined reference to `rd_kafka_CreatePartitions_result_topics'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_CreateTopics_result_topics':\n/tmp/go-build/cgo-gcc-prolog:490: undefined reference to `rd_kafka_CreateTopics_result_topics'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_DeleteTopic_new':\n/tmp/go-build/cgo-gcc-prolog:520: undefined reference to `rd_kafka_DeleteTopic_new'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_DeleteTopics_result_topics':\n/tmp/go-build/cgo-gcc-prolog:555: undefined reference to `rd_kafka_DeleteTopics_result_topics'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_DescribeConfigs_result_resources':\n/tmp/go-build/cgo-gcc-prolog:590: undefined reference to `rd_kafka_DescribeConfigs_result_resources'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_NewPartitions_new':\n/tmp/go-build/cgo-gcc-prolog:623: undefined reference to `rd_kafka_NewPartitions_new'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_NewPartitions_set_replica_assignment':\n/tmp/go-build/cgo-gcc-prolog:648: undefined reference to `rd_kafka_NewPartitions_set_replica_assignment'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_NewTopic_new':\n/tmp/go-build/cgo-gcc-prolog:682: undefined reference to `rd_kafka_NewTopic_new'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_NewTopic_set_config':\n/tmp/go-build/cgo-gcc-prolog:703: undefined reference to `rd_kafka_NewTopic_set_config'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_NewTopic_set_replica_assignment':\n/tmp/go-build/cgo-gcc-prolog:728: undefined reference to `rd_kafka_NewTopic_set_replica_assignment'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ResourceType_name':\n/tmp/go-build/cgo-gcc-prolog:747: undefined reference to `rd_kafka_ResourceType_name'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_AlterConfigs_result':\n/tmp/go-build/cgo-gcc-prolog:796: undefined reference to `rd_kafka_event_AlterConfigs_result'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_CreatePartitions_result':\n/tmp/go-build/cgo-gcc-prolog:814: undefined reference to `rd_kafka_event_CreatePartitions_result'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_CreateTopics_result':\n/tmp/go-build/cgo-gcc-prolog:832: undefined reference to `rd_kafka_event_CreateTopics_result'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_DeleteTopics_result':\n/tmp/go-build/cgo-gcc-prolog:850: undefined reference to `rd_kafka_event_DeleteTopics_result'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_DescribeConfigs_result':\n/tmp/go-build/cgo-gcc-prolog:868: undefined reference to `rd_kafka_event_DescribeConfigs_result'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_error':\n/tmp/go-build/cgo-gcc-prolog:899: undefined reference to `rd_kafka_event_error'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_error_string':\n/tmp/go-build/cgo-gcc-prolog:917: undefined reference to `rd_kafka_event_error_string'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_type':\n/tmp/go-build/cgo-gcc-prolog:936: undefined reference to `rd_kafka_event_type'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_queue_poll':\n/tmp/go-build/cgo-gcc-prolog:1008: undefined reference to `rd_kafka_queue_poll'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_topic_result_error':\n/tmp/go-build/cgo-gcc-prolog:1027: undefined reference to `rd_kafka_topic_result_error'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_topic_result_error_string':\n/tmp/go-build/cgo-gcc-prolog:1045: undefined reference to `rd_kafka_topic_result_error_string'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_topic_result_name':\n/tmp/go-build/cgo-gcc-prolog:1063: undefined reference to `rd_kafka_topic_result_name'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_AdminOptions_destroy':\n/tmp/go-build/cgo-gcc-prolog:92: undefined reference to `rd_kafka_AdminOptions_destroy'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_AlterConfigs':\n/tmp/go-build/cgo-gcc-prolog:108: undefined reference to `rd_kafka_AlterConfigs'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_ConfigResource_destroy':\n/tmp/go-build/cgo-gcc-prolog:289: undefined reference to `rd_kafka_ConfigResource_destroy'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_CreatePartitions':\n/tmp/go-build/cgo-gcc-prolog:439: undefined reference to `rd_kafka_CreatePartitions'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_CreateTopics':\n/tmp/go-build/cgo-gcc-prolog:474: undefined reference to `rd_kafka_CreateTopics'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_DeleteTopic_destroy':\n/tmp/go-build/cgo-gcc-prolog:505: undefined reference to `rd_kafka_DeleteTopic_destroy'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_DeleteTopics':\n/tmp/go-build/cgo-gcc-prolog:539: undefined reference to `rd_kafka_DeleteTopics'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_DescribeConfigs':\n/tmp/go-build/cgo-gcc-prolog:574: undefined reference to `rd_kafka_DescribeConfigs'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_NewPartitions_destroy':\n/tmp/go-build/cgo-gcc-prolog:605: undefined reference to `rd_kafka_NewPartitions_destroy'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_NewTopic_destroy':\n/tmp/go-build/cgo-gcc-prolog:663: undefined reference to `rd_kafka_NewTopic_destroy'\n/tmp/go-link-908398633/000019.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_destroy':\n/tmp/go-build/cgo-gcc-prolog:883: undefined reference to `rd_kafka_event_destroy'\n/tmp/go-link-908398633/000020.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_AdminOptions_new':\n/tmp/go-build/cgo-gcc-prolog:45: undefined reference to `rd_kafka_AdminOptions_new'\n/tmp/go-link-908398633/000020.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_AdminOptions_set_operation_timeout':\n/tmp/go-build/cgo-gcc-prolog:68: undefined reference to `rd_kafka_AdminOptions_set_operation_timeout'\n/tmp/go-link-908398633/000020.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_AdminOptions_set_request_timeout':\n/tmp/go-build/cgo-gcc-prolog:91: undefined reference to `rd_kafka_AdminOptions_set_request_timeout'\n/tmp/go-link-908398633/000020.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_AdminOptions_set_validate_only':\n/tmp/go-build/cgo-gcc-prolog:114: undefined reference to `rd_kafka_AdminOptions_set_validate_only'\n/tmp/go-link-908398633/000022.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_conf_set_default_topic_conf':\n/tmp/go-build/cgo-gcc-prolog:93: undefined reference to `rd_kafka_conf_set_default_topic_conf'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_assign':\n/tmp/go-build/cgo-gcc-prolog:65: undefined reference to `rd_kafka_assign'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_assignment':\n/tmp/go-build/cgo-gcc-prolog:85: undefined reference to `rd_kafka_assignment'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_commit_queue':\n/tmp/go-build/cgo-gcc-prolog:108: undefined reference to `rd_kafka_commit_queue'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_committed':\n/tmp/go-build/cgo-gcc-prolog:130: undefined reference to `rd_kafka_committed'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_consumer_close':\n/tmp/go-build/cgo-gcc-prolog:163: undefined reference to `rd_kafka_consumer_close'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_name':\n/tmp/go-build/cgo-gcc-prolog:181: undefined reference to `rd_kafka_event_name'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_topic_partition_list':\n/tmp/go-build/cgo-gcc-prolog:199: undefined reference to `rd_kafka_event_topic_partition_list'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_offsets_store':\n/tmp/go-build/cgo-gcc-prolog:219: undefined reference to `rd_kafka_offsets_store'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_pause_partitions':\n/tmp/go-build/cgo-gcc-prolog:239: undefined reference to `rd_kafka_pause_partitions'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_poll_set_consumer':\n/tmp/go-build/cgo-gcc-prolog:258: undefined reference to `rd_kafka_poll_set_consumer'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_queue_get_consumer':\n/tmp/go-build/cgo-gcc-prolog:276: undefined reference to `rd_kafka_queue_get_consumer'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_queue_get_main':\n/tmp/go-build/cgo-gcc-prolog:294: undefined reference to `rd_kafka_queue_get_main'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_resume_partitions':\n/tmp/go-build/cgo-gcc-prolog:314: undefined reference to `rd_kafka_resume_partitions'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_seek':\n/tmp/go-build/cgo-gcc-prolog:338: undefined reference to `rd_kafka_seek'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_subscribe':\n/tmp/go-build/cgo-gcc-prolog:358: undefined reference to `rd_kafka_subscribe'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_subscription':\n/tmp/go-build/cgo-gcc-prolog:378: undefined reference to `rd_kafka_subscription'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_topic_partition_list_add':\n/tmp/go-build/cgo-gcc-prolog:399: undefined reference to `rd_kafka_topic_partition_list_add'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_topic_partition_list_new':\n/tmp/go-build/cgo-gcc-prolog:430: undefined reference to `rd_kafka_topic_partition_list_new'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_unsubscribe':\n/tmp/go-build/cgo-gcc-prolog:449: undefined reference to `rd_kafka_unsubscribe'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_conf_set_events':\n/tmp/go-build/cgo-gcc-prolog:147: undefined reference to `rd_kafka_conf_set_events'\n/tmp/go-link-908398633/000023.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_topic_partition_list_destroy':\n/tmp/go-build/cgo-gcc-prolog:414: undefined reference to `rd_kafka_topic_partition_list_destroy'\n/tmp/go-link-908398633/000025.o: In function `chdrs_to_tmphdrs':\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/event.go:38: undefined reference to `rd_kafka_header_get_all'\n/tmp/go-link-908398633/000025.o: In function `_rk_queue_poll':\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/event.go:53: undefined reference to `rd_kafka_event_destroy'\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/event.go:55: undefined reference to `rd_kafka_queue_poll'\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/event.go:56: undefined reference to `rd_kafka_event_type'\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/event.go:63: undefined reference to `rd_kafka_event_message_next'\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/event.go:64: undefined reference to `rd_kafka_message_timestamp'\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/event.go:67: undefined reference to `rd_kafka_message_headers'\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/event.go:68: undefined reference to `rd_kafka_header_cnt'\n/tmp/go-link-908398633/000025.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_message_array':\n/tmp/go-build/cgo-gcc-prolog:68: undefined reference to `rd_kafka_event_message_array'\n/tmp/go-link-908398633/000025.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_message_count':\n/tmp/go-build/cgo-gcc-prolog:86: undefined reference to `rd_kafka_event_message_count'\n/tmp/go-link-908398633/000025.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_stats':\n/tmp/go-build/cgo-gcc-prolog:104: undefined reference to `rd_kafka_event_stats'\n/tmp/go-link-908398633/000025.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_event_topic_partition':\n/tmp/go-build/cgo-gcc-prolog:122: undefined reference to `rd_kafka_event_topic_partition'\n/tmp/go-link-908398633/000025.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_topic_partition_destroy':\n/tmp/go-build/cgo-gcc-prolog:137: undefined reference to `rd_kafka_topic_partition_destroy'\n/tmp/go-link-908398633/000027.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_last_error':\n/tmp/go-build/cgo-gcc-prolog:43: undefined reference to `rd_kafka_last_error'\n/tmp/go-link-908398633/000031.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_query_watermark_offsets':\n/tmp/go-build/cgo-gcc-prolog:169: undefined reference to `rd_kafka_query_watermark_offsets'\n/tmp/go-link-908398633/000033.o: In function `_cgo_a32e55418a84_Cfunc_rd_kafka_offsets_for_times':\n/tmp/go-build/cgo-gcc-prolog:65: undefined reference to `rd_kafka_offsets_for_times'\n/tmp/go-link-908398633/000034.o: In function `tmphdrs_to_chdrs':\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/producer.go:43: undefined reference to `rd_kafka_headers_new'\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/producer.go:46: undefined reference to `rd_kafka_header_add'\n/tmp/go-link-908398633/000034.o: In function `do_produce':\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/producer.go:98: undefined reference to `rd_kafka_producev'\n/home/harishrana/go/src/github.com/confluentinc/confluent-kafka-go/kafka/producer.go:112: undefined reference to `rd_kafka_headers_destroy'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0x9ce3): undefined reference to `crc32'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0x9d06): undefined reference to `crc32'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0x9d3e): undefined reference to `crc32'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0x9d9d): undefined reference to `crc32'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0x9dcc): undefined reference to `crc32'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0xa988): undefined reference to `deflateInit2_'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0xaafc): undefined reference to `crc32'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0xab11): undefined reference to `crc32'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0xab2c): undefined reference to `crc32'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0xaba7): undefined reference to `deflateBound'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0xac41): undefined reference to `deflate'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0xad53): undefined reference to `deflate'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0xade0): undefined reference to `deflateEnd'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdkafka_broker.o): In function `rd_kafka_broker_thread_main':\n(.text+0xaf1b): undefined reference to `deflateEnd'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdgz.o): In function `rd_gz_decompress':\n(.text+0x8b): undefined reference to `inflateInit2_'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdgz.o): In function `rd_gz_decompress':\n(.text+0xb8): undefined reference to `inflateGetHeader'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdgz.o): In function `rd_gz_decompress':\n(.text+0x10f): undefined reference to `inflate'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdgz.o): In function `rd_gz_decompress':\n(.text+0x12a): undefined reference to `inflateEnd'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdgz.o): In function `rd_gz_decompress':\n(.text+0x179): undefined reference to `inflateEnd'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdgz.o): In function `rd_gz_decompress':\n(.text+0x1d8): undefined reference to `inflateEnd'\n/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/librdkafka.a(rdgz.o): In function `rd_gz_decompress':\n(.text+0x1fc): undefined reference to `inflateEnd'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Thanks for the help in advance.</p>\n"}, {"tags": ["go", "concurrency", "channels"], "comments": [{"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 1, "creation_date": 1569318721, "post_id": 58076747, "comment_id": 102549717, "body": "You <code>fanIn</code> function does not compile. Maybe you should edit your post. Don&#39;t forget to add <code>in2</code>, If you are not using it you should not declare it. Maybe you could check the video again."}, {"owner": {"reputation": 1481, "user_id": 469898, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Qf9DF.jpg?s=128&g=1", "display_name": "Dr.eel", "link": "https://stackoverflow.com/users/469898/dr-eel"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1569332029, "post_id": 58076747, "comment_id": 102557372, "body": "@apxp Fixed return value"}], "answers": [{"tags": [], "owner": {"reputation": 1481, "user_id": 469898, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Qf9DF.jpg?s=128&g=1", "display_name": "Dr.eel", "link": "https://stackoverflow.com/users/469898/dr-eel"}, "is_accepted": false, "score": 0, "last_activity_date": 1569315960, "creation_date": 1569315960, "answer_id": 58076748, "question_id": 58076747, "link": "https://stackoverflow.com/questions/58076747/what-channel1-channel2-does/58076748#58076748", "title": "What &quot;channel1 &lt;- &lt;-channel2&quot; does?", "body": "<p>The <code>c &lt;- &lt;-in1</code> stands for:</p>\n\n<pre><code>in1Val := &lt;-in1 // read from channel in1\nc &lt;- in1Val // write the value from in1 channel to `c` channel\n</code></pre>\n\n<p>If you write such kind of code first time - use more this detailed code to understand what happens better.</p>\n"}], "owner": {"reputation": 1481, "user_id": 469898, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Qf9DF.jpg?s=128&g=1", "display_name": "Dr.eel", "link": "https://stackoverflow.com/users/469898/dr-eel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1569331996, "creation_date": 1569315960, "last_edit_date": 1569331996, "question_id": 58076747, "link": "https://stackoverflow.com/questions/58076747/what-channel1-channel2-does", "title": "What &quot;channel1 &lt;- &lt;-channel2&quot; does?", "body": "<p>In Concurrency Go Patterns (<a href=\"https://www.youtube.com/watch?v=f6kdp27TYZs\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=f6kdp27TYZs</a>) there is an example of code that looks like:</p>\n\n<pre><code>func fanIn(in1 &lt;-chan string) &lt;-chan string {\n    c:=make(chan string)\n    go func() { \n        for {\n            c &lt;- &lt;-in1 \n        } \n    }() \n    return c\n}\n</code></pre>\n\n<p>For me this looks very strange <code>c &lt;- &lt;-in1</code>. What does it mean?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1569315892, "post_id": 58076692, "comment_id": 102548070, "body": "It means you forgot the <code>%s</code>."}, {"owner": {"reputation": 4609, "user_id": 4636715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ebd8c54bb287f99b94373429b588e21?s=128&d=identicon&r=PG&f=1", "display_name": "vahdet", "link": "https://stackoverflow.com/users/4636715/vahdet"}, "edited": false, "score": 1, "creation_date": 1569316047, "post_id": 58076692, "comment_id": 102548155, "body": "It is not specifically about log structure, but string formatting as you use <code>Print**f**</code>. So, did you try <code>log.Printf(&quot;Greeting:%s\\n&quot;,resp.GetMessage())</code>?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 4609, "user_id": 4636715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ebd8c54bb287f99b94373429b588e21?s=128&d=identicon&r=PG&f=1", "display_name": "vahdet", "link": "https://stackoverflow.com/users/4636715/vahdet"}, "edited": false, "score": 1, "creation_date": 1569332331, "post_id": 58076692, "comment_id": 102557557, "body": "@vahdet you never need a trailing <code>\\n</code> in <code>log</code> calls, just so you know."}, {"owner": {"reputation": 321, "user_id": 5501816, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-CdXutmncoDg/AAAAAAAAAAI/AAAAAAAAM10/fp51YCvbbSI/photo.jpg?sz=128", "display_name": "Enrique Alcazar", "link": "https://stackoverflow.com/users/5501816/enrique-alcazar"}, "edited": false, "score": 0, "creation_date": 1569426923, "post_id": 58076692, "comment_id": 102596124, "body": "It was a fair question, I tried to specify it as much as possible and followed all of the patterns, and yet you guys downvoted and got me banned, thanks for that..."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1569316251, "last_edit_date": 1569316251, "creation_date": 1569315927, "answer_id": 58076735, "question_id": 58076692, "link": "https://stackoverflow.com/questions/58076692/no-placeholders-in-format-string/58076735#58076735", "title": "No placeholders in format string", "body": "<p><a href=\"https://golang.org/pkg/log/#Printf\" rel=\"nofollow noreferrer\"><code>log.Printf()</code></a> expects a format string as its first argument:</p>\n\n<pre><code>func Printf(format string, v ...interface{})\n</code></pre>\n\n<p>A format string is a string where you may use <em>verbs</em> with modifiers to lay out how you want the result string to look like. A format string without any verbs is likely an error (indicating you probably forgot something from it, or if it truly does not need verbs, you shouldn't use <code>Pritnf()</code> which expects a format string). You can read more about format strings and their Go syntax at the doc of the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code></a> package.</p>\n\n<p>For example, this is a format string:</p>\n\n<pre><code>\"Greeting: %s\"\n</code></pre>\n\n<p>This is how it would be used:</p>\n\n<pre><code>log.Printf(\"Greeting: %s\", resp.GetMessage())\n</code></pre>\n\n<p>This is a very simple example and does not warrant formatted output. If you don't have a format string, use <a href=\"https://golang.org/pkg/log/#Print\" rel=\"nofollow noreferrer\"><code>log.Print()</code></a> or <a href=\"https://golang.org/pkg/log/#Println\" rel=\"nofollow noreferrer\"><code>log.Println()</code></a> instead (they don't require a format string):</p>\n\n<pre><code>log.Println(\"Greeting:\", resp.GetMessage())\n</code></pre>\n\n<p>The <code>Printf()</code> variant comes handy when you need more complex formatting, not just log 2 strings (concatenated).</p>\n\n<p>For example:</p>\n\n<pre><code>log.Printf(\"Hi, my name is %s, and I'm %d years old.\", \"Bob\", 22)\n</code></pre>\n\n<p>Output will be (try it on the <a href=\"https://play.golang.org/p/R3WxT5MT_b3\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2009/11/10 23:00:00 Hi, my name is Bob, and I'm 22 years old.\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 5501816, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-CdXutmncoDg/AAAAAAAAAAI/AAAAAAAAM10/fp51YCvbbSI/photo.jpg?sz=128", "display_name": "Enrique Alcazar", "link": "https://stackoverflow.com/users/5501816/enrique-alcazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 58076735, "answer_count": 1, "score": -3, "last_activity_date": 1569426980, "creation_date": 1569315790, "last_edit_date": 1569426980, "question_id": 58076692, "link": "https://stackoverflow.com/questions/58076692/no-placeholders-in-format-string", "title": "No placeholders in format string", "body": "<p>This question is about best practices when formatting strings in Go.</p>\n\n<p>Whenever I'm using the print library like so: </p>\n\n<p><code>log.Printf(\"Greeting:\",resp.GetMessage())</code></p>\n\n<p>I get a warning from my IDE (Goland) saying:</p>\n\n<p><code>No placeholders in format string</code></p>\n\n<p>What does that mean? What would a proper print look like?</p>\n"}, {"tags": ["json", "mongodb", "go", "mongo-go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1569313396, "creation_date": 1569313396, "answer_id": 58076011, "question_id": 58075716, "link": "https://stackoverflow.com/questions/58075716/why-am-i-getting-all-zero-value-for-certain-field-in-my-json-from-mongodb/58076011#58076011", "title": "Why am I getting all zero value for certain field in my json from mongodb?", "body": "<p>You have to use <code>bson</code> tags when marshalling from / to MongoDB. <code>json</code> tags are for the <code>encoding/json</code> package, and they are not used (ignored) by the Mongo driver.</p>\n\n<pre><code>type PlantData struct {\n    Minute       int     `bson:\"minute\"`\n    Date         int     `bson:\"date\"`\n    Moisture1    int     `bson:\"moisture_1\"`\n    Hour         int     `bson:\"hour\"`\n    Month        int     `bson:\"month\"`\n    Year         int     `bson:\"year\"`\n    Humidity1    float64 `bson:\"humidity_1\"`\n    Temperature1 float64 `bson:\"temperature_1\"`\n}\n</code></pre>\n\n<p>If <code>bson</code> tags are missing from your struct fields, the default name used in MongoDB will be the struct field name starting with lowercased letters, that's why some (most) of the fields were matched but not <code>Moisture1</code> (it differs more than just the capital first letter from <code>moisture_1</code>).</p>\n\n<p>If you also want to use the <code>encoding/json</code> package with this struct, you may provide both:</p>\n\n<pre><code>type PlantData struct {\n    Minute       int     `bson:\"minute\" json:\"minute\"`\n    Date         int     `bson:\"date\" json:\"date\"`\n    Moisture1    int     `bson:\"moisture_1\" json:\"moisture_1\"`\n    Hour         int     `bson:\"hour\" json:\"hour\"`\n    Month        int     `bson:\"month\" json:\"month\"`\n    Year         int     `bson:\"year\" json:\"year\"`\n    Humidity1    float64 `bson:\"humidity_1\" json:\"humidity_1\"`\n    Temperature1 float64 `bson:\"temperature_1\" json:\"temperature_1\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8025213, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Kdzcq240nss/AAAAAAAAAAI/AAAAAAAAGVg/DnTKucpYI28/photo.jpg?sz=128", "display_name": "Vishal Gawde", "link": "https://stackoverflow.com/users/8025213/vishal-gawde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 58076011, "answer_count": 1, "score": -1, "last_activity_date": 1569313599, "creation_date": 1569312270, "last_edit_date": 1569313599, "question_id": 58075716, "link": "https://stackoverflow.com/questions/58075716/why-am-i-getting-all-zero-value-for-certain-field-in-my-json-from-mongodb", "title": "Why am I getting all zero value for certain field in my json from mongodb?", "body": "<p>I'm fetching my data from MongoDB atlas in a Go web Server using the official mongodb-go-driver. I'm using json.Marshal to convert to json. but all values of certain fields becomes Zero.  </p>\n\n<pre><code>package main\n\nimport (\n\"context\"\n\"fmt\"\n\"log\"\n\n\"github.com/gin-gonic/gin\"\n\"go.mongodb.org/mongo-driver/bson\"\n\"go.mongodb.org/mongo-driver/mongo\"\n\"go.mongodb.org/mongo-driver/mongo/options\"\n\"go.mongodb.org/mongo-driver/mongo/readpref\"\n)\n\nvar c = GetClient()\n\ntype PlantData struct {\nMinute       int     `json:\"minute\"`\nDate         int     `json:\"date\"`\nMoisture1    int     `json:\"moisture_1\"`\nHour         int     `json:\"hour\"`\nMonth        int     `json:\"month\"`\nYear         int     `json:\"year\"`\nHumidity1    float64 `json:\"humidity_1\"`\nTemperature1 float64 `json:\"temperature_1\"`\n}\n\nfunc GetClient() *mongo.Client {\n    clientOptions := options.Client().ApplyURI(\"MY_MONGODB_URI\")\n    client, err := mongo.NewClient(clientOptions)\n    if err != nil {\n        log.Fatal(err)\n    }\n    err = client.Connect(context.Background())\n    if err != nil {\n        log.Fatal(err)\n    }\n    return client\n}\n\nfunc ReturnAllPlantsData(client *mongo.Client, filter bson.M) []*PlantData {\n    var plantsdata []*PlantData\n    collection := client.Database(\"iot\").Collection(\"tomatos\")\n    cur, err := collection.Find(context.TODO(), filter)\n    if err != nil {\n        log.Fatal(\"Error on Finding all the documents\", err)\n    }\n    for cur.Next(context.TODO()) {\n        var plantdata PlantData\n        err = cur.Decode(&amp;plantdata)\n        if err != nil {\n            log.Fatal(\"Error on Decoding the document\", err)\n        }\n        plantsdata = append(plantsdata, &amp;plantdata)\n    }\n    return plantsdata\n}\n\nfunc getting(g *gin.Context) {  \n     plantsdatas := ReturnAllPlantsData(c, bson.M{})\n     ans, _ := json.Marshal(plantsdatas)\n     fmt.Println(string(ans))\n     c.String(200, string(ans))\n}\n\nfunc main() {\n    err := c.Ping(context.Background(), readpref.Primary())\n    if err != nil {\n        log.Fatal(\"Couldn't connect to the database\", err)\n    } else {\n        log.Println(\"Connected!\")\n    }\n\n    router := gin.Default()\n    router.GET(\"/data\", getting)    \n    router.Run()\n}\n</code></pre>\n\n<p>My Expected Output:</p>\n\n<pre><code>[{\n    \"minute\": 3,\n    \"date\": 14,\n    \"moisture_1\": 96,\n    \"hour\": 23,\n    \"month\": \"02\",\n    \"year\": 2019,\n    \"humidity_1\": 77.2,\n    \"temperature_1\": 22.7\n}, {\n    \"minute\": 8,\n    \"date\": 14,\n    \"moisture_1\": 96,\n    \"hour\": 23,\n    \"month\": \"02\",\n    \"year\": 2019,\n    \"humidity_1\": 78.1,\n    \"temperature_1\": 22.8\n}]\n</code></pre>\n\n<p>Actual Result:</p>\n\n<pre><code>[{\n    \"minute\": 3,\n    \"date\": 14,\n    \"moisture_1\": 0,\n    \"hour\": 23,\n    \"month\": \"02\",\n    \"year\": 2019,\n    \"humidity_1\": 0,\n    \"temperature_1\": 0\n}, {\n    \"minute\": 8,\n    \"date\": 14,\n    \"moisture_1\": 0,\n    \"hour\": 23,\n    \"month\": \"02\",\n    \"year\": 2019,\n    \"humidity_1\": 0,\n    \"temperature_1\": 0\n}]\n</code></pre>\n\n<p>Values of minute,hour,date,month and year are Correct and Unchanged\nbut all the values of moisture, humidity and temperature becomes zero.</p>\n"}, {"tags": ["go", "cassandra", "gocql"], "answers": [{"tags": [], "owner": {"reputation": 1574, "user_id": 1461499, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bOMwp.jpg?s=128&g=1", "display_name": "Alex Tbk", "link": "https://stackoverflow.com/users/1461499/alex-tbk"}, "is_accepted": false, "score": 0, "last_activity_date": 1569390019, "creation_date": 1569390019, "answer_id": 58091780, "question_id": 58075690, "link": "https://stackoverflow.com/questions/58075690/how-log-cassandra-queries-on-application-side/58091780#58091780", "title": "How log Cassandra queries on application side?", "body": "<p>This is how we do it in Java. We define a custom LatencyTracker:</p>\n\n<pre><code>private LatencyTracker getLatencyTracker() {\n    return new LatencyTracker() {\n        @Override\n        public void update(Host host, Statement statement, Exception e, long l) {\n            LOGGER.info(statement.toString());\n        }\n\n        @Override\n        public void onRegister(Cluster cluster1) {\n\n        }\n\n        @Override\n        public void onUnregister(Cluster cluster1) {\n\n        }\n    };\n}\n</code></pre>\n\n<p>Then register it in the cluster:</p>\n\n<pre><code>cluster.register(getLatencyTracker());\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1888, "user_id": 798244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40c3cbbef306763d8f70b408922bab87?s=128&d=identicon&r=PG", "display_name": "zznate", "link": "https://stackoverflow.com/users/798244/zznate"}, "is_accepted": false, "score": 1, "last_activity_date": 1569461876, "creation_date": 1569461876, "answer_id": 58108440, "question_id": 58075690, "link": "https://stackoverflow.com/questions/58075690/how-log-cassandra-queries-on-application-side/58108440#58108440", "title": "How log Cassandra queries on application side?", "body": "<p>The go driver has a QueryObserver that you can implement to time queries:\n<a href=\"https://github.com/gocql/gocql/blob/master/session.go#L1891-L1926\" rel=\"nofollow noreferrer\">https://github.com/gocql/gocql/blob/master/session.go#L1891-L1926</a></p>\n\n<p>It would be up to you check that the execution time breached a threshold and then printed as needed, but it looks like it gives you access to the statement object, host and timings which is all you need for debugging. </p>\n\n<p>Here is some sample code that shows a QueryObserver in action in the context of timing the impact of speculative execution:\n<a href=\"https://github.com/instaclustr/sample-GoCql-Speculative-Execution/blob/master/spectest.go\" rel=\"nofollow noreferrer\">https://github.com/instaclustr/sample-GoCql-Speculative-Execution/blob/master/spectest.go</a></p>\n\n<p>The above example comes from the following blog post on speculative execution:\n<a href=\"https://www.instaclustr.com/speculative-query-executions-gocql/\" rel=\"nofollow noreferrer\">https://www.instaclustr.com/speculative-query-executions-gocql/</a></p>\n\n<p>(If you are having tail latency issues, you should probably consider using client-side speculative execution, but this is a different topic :)</p>\n\n<p>Additionally, there is a test case in tree that uses a QueryObserver for verification:\n<a href=\"https://github.com/gocql/gocql/blob/16cf9ea1b3e28090d416d36528f304e4553e6b56/cassandra_test.go#L140\" rel=\"nofollow noreferrer\">https://github.com/gocql/gocql/blob/16cf9ea1b3e28090d416d36528f304e4553e6b56/cassandra_test.go#L140</a></p>\n\n<p>Might be a good place to start playing around with it.</p>\n"}], "owner": {"reputation": 39, "user_id": 3442754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2add5026ffd8db813a61f45b23d30378?s=128&d=identicon&r=PG&f=1", "display_name": "user3442754", "link": "https://stackoverflow.com/users/3442754/user3442754"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1569461876, "creation_date": 1569312157, "question_id": 58075690, "link": "https://stackoverflow.com/questions/58075690/how-log-cassandra-queries-on-application-side", "title": "How log Cassandra queries on application side?", "body": "<p>I'm using gocql driver in my application. Is there a way for the driver to log queries on the console? \nHow do I configure the logger to print complete queries (along with data bindings)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/gocql/gocql\"\n)\n\nvar Session *gocql.Session\n\ntype Emp struct {\n    id        string\n    firstName string\n    lastName  string\n    age       int\n}\n\nfunc init() {\n    var err error\n\n    cluster := gocql.NewCluster(\"localhost\")\n    cluster.Keyspace = \"cms\"\n    Session, err = cluster.CreateSession()\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(\"cassandra init done\")\n}\n\nfunc main() {\n    e := Emp{\n        id:        \"1\",\n        firstName: \"John\",\n        lastName:  \"DOe\",\n        age:       88,\n    }\n    createEmp(e)\n}\nfunc createEmp(emp Emp) {\n    fmt.Println(\" **** Creating new emp ****\\n\", emp)\n    if err := Session.Query(\"INSERT INTO emps(empid, first_name, last_name, age) VALUES(?, ?, ?, ?)\",\n        emp.id, emp.firstName, emp.lastName, emp.age).Exec(); err != nil {\n        fmt.Println(\"Error while inserting Emp\")\n        fmt.Println(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "is_accepted": true, "score": 1, "last_activity_date": 1569306127, "creation_date": 1569306127, "answer_id": 58074189, "question_id": 58073691, "link": "https://stackoverflow.com/questions/58073691/is-it-necessary-to-specify-a-column-name/58074189#58074189", "title": "Is it necessary to specify a column name?", "body": "<p>You need to tag the field of struct if you would like to have a name of column different than it is by default behavior.  </p>\n\n<p>This declaration <code>UserID int32</code> gives you <code>user_id</code> field. You could not specify the <code>gorm</code> tag if it is ok for you, but if you will do it - it is not a mistake.</p>\n"}], "owner": {"reputation": 353, "user_id": 10641015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rb6K-6eC5TI/AAAAAAAAAAI/AAAAAAAAAGw/E-daD0VOiz0/photo.jpg?sz=128", "display_name": "jadejoe", "link": "https://stackoverflow.com/users/10641015/jadejoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 58074189, "answer_count": 1, "score": 0, "last_activity_date": 1569306127, "creation_date": 1569303444, "last_edit_date": 1569304372, "question_id": 58073691, "link": "https://stackoverflow.com/questions/58073691/is-it-necessary-to-specify-a-column-name", "title": "Is it necessary to specify a column name?", "body": "<p>I am making a Go project with gorm.</p>\n\n<p>When creating a table, is it necessary to specify the column name in the option?\nWhen you look at the formula and need mapping</p>\n\n<pre><code>ID`gorm: \"column: user_id\"\n</code></pre>\n\n<p>It need to write something like this</p>\n\n<pre><code>UserID int32 `gorm:\" column: user_id \"`\n</code></pre>\n\n<p>Isn't it wrong to realize that this is not necessary?</p>\n"}, {"tags": ["go", "unmarshalling"], "comments": [{"owner": {"reputation": 6258, "user_id": 11032044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bz8vL.jpg?s=128&g=1", "display_name": "Kamol Hasan", "link": "https://stackoverflow.com/users/11032044/kamol-hasan"}, "edited": false, "score": 0, "creation_date": 1569301682, "post_id": 58073214, "comment_id": 102541837, "body": "Can you provide an example output for given input json? Just to be sure what kind of changes you want to perform on <code>my_value</code>."}], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569302629, "post_id": 58073515, "comment_id": 102542079, "body": "a variation utilizing the unmarshaler interface <a href=\"https://play.golang.com/p/WolxQKnSyJD\" rel=\"nofollow noreferrer\">play.golang.com/p/WolxQKnSyJD</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1569302401, "creation_date": 1569302401, "answer_id": 58073515, "question_id": 58073214, "link": "https://stackoverflow.com/questions/58073214/is-there-a-way-to-dynamically-unmarshal-json-base-on-content/58073515#58073515", "title": "Is there a way to dynamically unmarshal json base on content?", "body": "<p>Unmarshal the varying part to a <a href=\"https://godoc.org/encoding/json#RawMessage\" rel=\"nofollow noreferrer\">json.RawMessage</a>.  Loop through the data and unmarshal the raw message data to a type based on the version.</p>\n\n<pre><code>type V1Value struct{}\n\ntype myObject struct {\n    Meta struct {\n        Version int `json:\"version\"`\n    } `json:\"meta\"`\n    RawValue json.RawMessage `json:\"my_value\"`\n    Value    interface{} `json:\"-\"`\n}\n\ntype MyResponse struct {\n    MyObjectList []*myObject `json:\"my_object_list\"`\n}\n\n\n...\n\nvar response MyResponse\nif err := json.Unmarshal(data, &amp;response); err != nil {\n     // handle error\n}\nfor _, o := range response.MyObjectList {\n    switch o.Meta.Version {\n    case 1:\n        var v V1Value\n        if err := json.Unmarshal(o.RawValue, &amp;v); err != nil {\n            // handle error\n        }\n        o.Value = v\n    default:\n        // handle unknown version\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 10714010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d1de8ea4503b597aab9c31e5654c197?s=128&d=identicon&r=PG&f=1", "display_name": "user10714010", "link": "https://stackoverflow.com/users/10714010/user10714010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "closed_date": 1569303599, "answer_count": 1, "score": -2, "last_activity_date": 1569312283, "creation_date": 1569300186, "last_edit_date": 1569312283, "question_id": 58073214, "link": "https://stackoverflow.com/questions/58073214/is-there-a-way-to-dynamically-unmarshal-json-base-on-content", "closed_reason": "Duplicate", "title": "Is there a way to dynamically unmarshal json base on content?", "body": "<p>I have a json format that looks like this</p>\n\n<pre><code>{\n    \"my_object_list\": [\n        {\n            \"meta\": {\"version\": 1},\n            \"my_value\": {// Some complex value\n            }\n        }\n        {\n            \"meta\": {\"version\": 2},\n            \"my_value\": {// Some complex value\n            }\n        }\n    ]\n}\n</code></pre>\n\n<p>I want to be able to marshal each of the <code>my_value</code> base on <code>meta</code> is there a way to achieve that in golang?</p>\n\n<pre><code>type MyResponse struct {\n    // how to I unmarshal each myObject base on version?\n    MyObjectList     []myObject   `json:\"my_object_list\"`\n}\n</code></pre>\n"}, {"tags": ["arrays", "go", "newline", "bytebuffer"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1569301332, "post_id": 58073179, "comment_id": 102541740, "body": "<code>[]byte(&quot;\\n&quot;)</code> certainly is not transformed to 2 bytes: <a href=\"https://play.golang.org/p/MAS6nfl4XJ2\" rel=\"nofollow noreferrer\">play.golang.org/p/MAS6nfl4XJ2</a>"}, {"owner": {"reputation": 732, "user_id": 4999812, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8bd09518ec24320e674e5feb9cf69a63?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon Dube", "link": "https://stackoverflow.com/users/4999812/brandon-dube"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1569302237, "post_id": 58073179, "comment_id": 102541962, "body": "Yes, I know.  I\u2019m asking if there is a way to get a sequence of []byte{97, 110}, \u201c\\\u201d and \u201cn\u201d as distinct bytes, to compare to []byte(\u201c\\n\u201d) as truthy."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1569302369, "post_id": 58073179, "comment_id": 102542000, "body": "97 in ascii is <code>a</code> and 110 in ascii is <code>n</code>. How does it correlate with <code>\\n</code>? If you meant 92 and 110, then probably the best you could do is to manually substitute <code>\\n</code> with <code>\\\\n</code>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569315376, "post_id": 58073179, "comment_id": 102547777, "body": "why don t you handle EOF ? Is 128 the message size or arbitrary ? the sleep should run only if n&lt;1, if necessary at all. can you provide a minimal reproducible example that i can run (assuming linux) ?"}], "owner": {"reputation": 732, "user_id": 4999812, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8bd09518ec24320e674e5feb9cf69a63?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon Dube", "link": "https://stackoverflow.com/users/4999812/brandon-dube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569316599, "creation_date": 1569299937, "last_edit_date": 1569302838, "question_id": 58073179, "link": "https://stackoverflow.com/questions/58073179/byte10-or-byte-n-vs-byte92-110", "title": "[]byte{10} or []byte(&quot;\\n&quot;) vs []byte{92, 110}", "body": "<p>I'm working with <code>github.com/tarm/serial</code> to interface with some serial instrumentation.  In development, I'm working with the <code>/dev/ttyp0</code> and <code>/dev/ptyp0</code> pair, where my go process connects to one and I use <code>screen</code> to connect to the other.  I've written a function that, combined with <code>serial.Config.ReadTimeout</code>, reads for up to <code>ReadTimeout</code> or a given byte sequence is received.  That function is:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func readToTermination(s serial.Port, termination []byte, rate time.Duration) []byte {\n    var out []byte\n    lterm := len(termination)\n    for {\n        buf := make([]byte, 128)\n        n, _ := s.Read(buf)\n        out = append(out, buf[:n]...)\n        l := len(out)\n        if l &gt;= lterm {\n            if bytes.Compare(out[l-lterm:], termination) == 0 {\n                break\n            }\n        }\n        time.Sleep(rate)\n    }\n    return out\n}\n</code></pre>\n\n<p>This avoids burning up CPU cycles doing nothing with a debounce.  When I test with <code>termination = []byte(\"\\n\")</code> and screen, the <code>break</code> never triggers because it turns into <code>[]byte{97, 11}</code> (two distinct elements, something like screen flushing after each keystroke).  On the other hand, if I do something like <code>echo \"foo\" &gt; /dev/ptyp0</code>, the break triggers correctly.  Echo implicitly seems to be sending a <code>\\n</code>, or the closing of the connection does so.  I see <code>\\r\\n</code> for <code>echo foo</code> and <code>\\r\\n\\r\\n</code> for <code>echo \"foo\\n\"</code>.</p>\n\n<p>So my question is:</p>\n\n<p>(1) why is there a difference in behavior here?</p>\n\n<p>(2) how do I get the behavior I really am after with a carriage return for the termination?  Perhaps I should use EOT instead?  A human will never be typing into this directly.</p>\n"}, {"tags": ["arrays", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 1188, "user_id": 17734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf592a20de754300721bf954aa40507?s=128&d=identicon&r=PG", "display_name": "AquilaX", "link": "https://stackoverflow.com/users/17734/aquilax"}, "edited": false, "score": 0, "creation_date": 1569296266, "post_id": 58072719, "comment_id": 102540665, "body": "Thank you very much. It&#39;s a bit more verbose that I&#39;d like it to be but will get the job done."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1188, "user_id": 17734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf592a20de754300721bf954aa40507?s=128&d=identicon&r=PG", "display_name": "AquilaX", "link": "https://stackoverflow.com/users/17734/aquilax"}, "edited": false, "score": 1, "creation_date": 1569296701, "post_id": 58072719, "comment_id": 102540754, "body": "@AquilaX Added note about efficiency and some alternative solutions."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1569296421, "last_edit_date": 1569296421, "creation_date": 1569295914, "answer_id": 58072719, "question_id": 58072635, "link": "https://stackoverflow.com/questions/58072635/using-spread-when-initializing-array-in-go/58072719#58072719", "title": "Using spread when initializing array in Go", "body": "<p>You can only use <code>...</code> with a slice when passing it to a variadic function. See <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow noreferrer\">Spec: Passing arguments to ... parameters</a>.</p>\n\n<p>So for example you could use it when passing it to <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"nofollow noreferrer\"><code>append()</code></a>:</p>\n\n<pre><code>var i = []int{1, 2, 3}\na := append([]int{2}, i...)\na = append(a, 3)\nfmt.Println(a)\n</code></pre>\n\n<p>Which outputs (try it on the <a href=\"https://play.golang.org/p/rmgkiVBGJLB\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[2 1 2 3 3]\n</code></pre>\n\n<p>Alternatively the above can be written in one line:</p>\n\n<pre><code>a := append(append([]int{2}, i...), 3)\n</code></pre>\n\n<p>Do note that this may be compact, it's not necessarily efficient as it may create and copy multiple backing arrays under the hood.</p>\n\n<p>To ensure a single allocation, you could use <code>make()</code> with capacity provided, for example:</p>\n\n<pre><code>a := make([]int, 0, 2+len(i))\na = append(a, 2)\na = append(a, i...)\na = append(a, 3)\n</code></pre>\n\n<p>Try this one on the <a href=\"https://play.golang.org/p/tCGewcIbtv1\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Yet another solution is to use <a href=\"https://golang.org/pkg/builtin/#copy\" rel=\"nofollow noreferrer\"><code>copy()</code></a> if you have the slice preallocated (either with <a href=\"https://golang.org/pkg/builtin/#make\" rel=\"nofollow noreferrer\"><code>make()</code></a> or using indices in the compositle literal):</p>\n\n<pre><code>a := []int{2, 4: 3}\ncopy(a[1:], i)\n</code></pre>\n\n<p>Try this one on the <a href=\"https://play.golang.org/p/ePPvN6xQSx9\" rel=\"nofollow noreferrer\">Go Playground</a>. The disadvantage here is that the index (<code>4: 3</code>) must be constant and can't be something like <code>1 + len(i)</code>. If you'd want to preallocate the slice (e.g. <code>make([]int, 2+len(i))</code>), you can't combine that with a composite literal to list elements.</p>\n"}], "owner": {"reputation": 1188, "user_id": 17734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf592a20de754300721bf954aa40507?s=128&d=identicon&r=PG", "display_name": "AquilaX", "link": "https://stackoverflow.com/users/17734/aquilax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 0, "accepted_answer_id": 58072719, "answer_count": 1, "score": 2, "last_activity_date": 1569296535, "creation_date": 1569295295, "last_edit_date": 1569296535, "question_id": 58072635, "link": "https://stackoverflow.com/questions/58072635/using-spread-when-initializing-array-in-go", "title": "Using spread when initializing array in Go", "body": "<p>I have a repeating list of values which I want to re-use when initializing several arrays like that:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var i = []int{1, 2, 3}\n    var a = []int{2, i..., 3}\n    fmt.Println(a)\n}\n\n</code></pre>\n\n<p>This code above gives the following error:</p>\n\n<blockquote>\n  <p>./prog.go:9:20: syntax error: unexpected ..., expecting comma or }</p>\n</blockquote>\n\n<p>I wanted to use the spread <code>...</code> operator but this does not seem to be possible while initializing an array. </p>\n\n<p>Am I missing something here or spreading is not allowed?</p>\n"}, {"tags": ["go", "google-cloud-platform", "gcloud", "openid-connect", "google-cloud-run"], "comments": [{"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1569294210, "post_id": 58072361, "comment_id": 102540334, "body": "Are you using User Credentials (Google Account / G Suite) or a Service Account for your identity? Is the code running on your desktop outside of Google Cloud or on a Compute instance? These details change the type of code that generates/fetches an Identity Token."}, {"owner": {"reputation": 287, "user_id": 1106407, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7378cf289645ef7c4735c3e60a97eb26?s=128&d=identicon&r=PG", "display_name": "Kevin O&#39;Hara", "link": "https://stackoverflow.com/users/1106407/kevin-ohara"}, "reply_to_user": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1569327200, "post_id": 58072361, "comment_id": 102554390, "body": "@JohnHanley Yes, we are using user credentials (not a service account) and the code is running on our desktops in a CLI. We&#39;re building a developer CLI tool to call these services."}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1569334061, "post_id": 58072361, "comment_id": 102558567, "body": "Server to server uses service accounts not user accounts. Your CLI should also be using a service account. You will get warnings and quota violations for using user accounts. Some services will NOT accept user account OAuth Tokens. However, post your code that shows the entire authentication process and not one function. When you exchange the OAuth Code, if the initial request was correct you will get three tokens: Access Token, ID Token and Refresh Token."}, {"owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "edited": false, "score": 0, "creation_date": 1571245991, "post_id": 58072361, "comment_id": 103179532, "body": "It seems like the <code>audience</code> parameter you&#39;re providing is not the url of the Cloud Run service. Also do you have <code>gcloud</code> present in your environment? Why are you trying to re-implement <code>gcloud print-identity-token</code>?"}, {"owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "edited": false, "score": 0, "creation_date": 1571246039, "post_id": 58072361, "comment_id": 103179547, "body": "Also it&#39;s unclear where IAP got into the picture in your question? Cloud Run does not support IAPs."}], "answers": [{"comments": [{"owner": {"reputation": 287, "user_id": 1106407, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7378cf289645ef7c4735c3e60a97eb26?s=128&d=identicon&r=PG", "display_name": "Kevin O&#39;Hara", "link": "https://stackoverflow.com/users/1106407/kevin-ohara"}, "edited": false, "score": 0, "creation_date": 1569327297, "post_id": 58072779, "comment_id": 102554442, "body": "We already have working server-to-server implementations that are generating ID tokens for service accounts. We&#39;re trying to generate ID tokens using user credentials to call these services because we are building a developer CLI."}], "tags": [], "owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "is_accepted": false, "score": 0, "last_activity_date": 1569296558, "creation_date": 1569296558, "answer_id": 58072779, "question_id": 58072361, "link": "https://stackoverflow.com/questions/58072361/google-cloud-auth-for-internal-cli-using-cloud-run/58072779#58072779", "title": "Google Cloud Auth for Internal CLI using Cloud Run", "body": "<p>This answer is for creating an Identity Token from a service account. This example is in Python. If requested, I will write this in Go.  I just had this code already written in Python.</p>\n\n<p>In the code below, the first code block is the section that takes a service account and requests the Identity Token from Google. Notice that I do not use any scopes. Scopes are used when requesting Google OAuth Access Tokens. Identity Tokens have identity stored in them. Instead you need to specify the audience (URL) that the Identity Token is destined for. Not all services require a valid audience value.</p>\n\n<p>My code also shows how to decode an Identity Token to see the Header and Payload JSON. The Payload contains the identity that Google IAP validates.</p>\n\n<p>Once you have the Identity Token, include the HTTP Header <code>authorization: bearer TOKEN</code> when making requests to Cloud Run.</p>\n\n<pre><code>import google.auth.transport.requests\nimport google.oauth2.service_account\n\ncredentials = google.oauth2.service_account.IDTokenCredentials.from_service_account_file(\n        json_filename,\n        target_audience=aud)\n\nrequest = google.auth.transport.requests.Request()\n\ncredentials.refresh(request)\n</code></pre>\n\n<ol>\n<li>Change the path to the service account to match your software.</li>\n<li>Change the <code>aud</code> to be your Cloud Run URL.</li>\n</ol>\n\n<p>Full Source Code Example:</p>\n\n<pre><code>'''\nThis program creates an OIDC Identity Token from a service account\n'''\n\nimport json\nimport base64\n\nimport google.auth.transport.requests\nimport google.oauth2.service_account\n\n# The service account JSON key file to use to create the Identity Token\njson_filename = '/config/service-account.json'\n\n# The audience that this ID token is intended for (example Google Cloud Run service URL)\naud = 'http://localhost'\n\ndef pad(data):\n    \"\"\" pad base64 string \"\"\"\n\n    missing_padding = len(data) % 4\n    data += '=' * (4 - missing_padding)\n    return data\n\ndef print_jwt(signed_jwt):\n    \"\"\" Print a JWT Header and Payload \"\"\"\n\n    s = signed_jwt.decode('utf-8').split('.')\n\n    print('Header:')\n    h = base64.urlsafe_b64decode(pad(s[0])).decode('utf-8')\n    print(json.dumps(json.loads(h), indent=4))\n\n    print('Payload:')\n    p = base64.urlsafe_b64decode(pad(s[1])).decode('utf-8')\n    print(json.dumps(json.loads(p), indent=4))\n\nif __name__ == '__main__':\n    credentials = google.oauth2.service_account.IDTokenCredentials.from_service_account_file(\n            json_filename,\n            target_audience=aud)\n\n    request = google.auth.transport.requests.Request()\n\n    credentials.refresh(request)\n\n    #print(dir(credentials))\n\n    # This is debug code to show how to decode Identity Token\n    print('Decoded Identity Token:')\n    print_jwt(credentials.token.encode())\n\n    # This is the actual Identity Token\n    print()\n    print('Identity Token:')\n    print(credentials.token)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 287, "user_id": 1106407, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7378cf289645ef7c4735c3e60a97eb26?s=128&d=identicon&r=PG", "display_name": "Kevin O&#39;Hara", "link": "https://stackoverflow.com/users/1106407/kevin-ohara"}, "edited": false, "score": 0, "creation_date": 1571331651, "post_id": 58418685, "comment_id": 103214974, "body": "Would we need to add the cloud run service url as one of the scopes within DefaultTokenSource? Getting that URL configured correctly is probably the missing link at this point."}, {"owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "reply_to_user": {"reputation": 287, "user_id": 1106407, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7378cf289645ef7c4735c3e60a97eb26?s=128&d=identicon&r=PG", "display_name": "Kevin O&#39;Hara", "link": "https://stackoverflow.com/users/1106407/kevin-ohara"}, "edited": false, "score": 0, "creation_date": 1571702329, "post_id": 58418685, "comment_id": 103320701, "body": "The way to get an <code>id_token</code> for a Cloud Run application is providing the <code>?audience=</code> parameter with the value of the Run service URL, it&#39;s documented here: <a href=\"https://cloud.google.com/run/docs/authenticating/service-to-service\" rel=\"nofollow noreferrer\">cloud.google.com/run/docs/authenticating/service-to-service</a>. Similarly you&#39;ll notice the <code>--audiences</code> option for this gcloud command."}], "tags": [], "owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "is_accepted": false, "score": 2, "last_activity_date": 1571246679, "creation_date": 1571246679, "answer_id": 58418685, "question_id": 58072361, "link": "https://stackoverflow.com/questions/58072361/google-cloud-auth-for-internal-cli-using-cloud-run/58418685#58418685", "title": "Google Cloud Auth for Internal CLI using Cloud Run", "body": "<p>It's unclear why you are trying to reimplement <code>gcloud auth print-identity-token</code>. I highly recommend you do not try to do that.</p>\n\n<p>If you're building a developer CLI, your job will be much easier if you make <code>gcloud</code> present in the dev machine, and call out to this command to retrieve an id_token.</p>\n\n<p>Reimplementing <code>print-identity-token</code> is really going to be difficult. Because <code>gcloud</code> makes a call to the OAuth token endpoint with the internal <code>refresh_token</code> it's been storing to get an <code>id_token</code> as well as an <code>access_token</code>. (Run command with <code>--log-http</code> to see more, and set the relevant gcloud config to not to redact tokens from req/resp body.)</p>\n\n<p><strong>Alternatively,</strong> without <code>gcloud</code> present and authenticated with GSuite account on the developer machine, your only other option is to distribute <strong>IAM service account keys</strong> to each developer machine. (On the flipside, you need to make sure these keys are rotated properly, and kept secure.)</p>\n\n<p>You can use the IAM Service Account key to make a POST to <code>https://www.googleapis.com/oauth2/v4/token</code> with proper fields (like client_secret, grant_type etc) get an <code>id_token</code>. I believe the simplest way to do that is to set <code>GOOGLE_APPLICATION_CREDENTIALS</code> env variable in your Go program to the key file, specify the correct <code>audience</code> parameter in token exchange request and then use <code>token.Extra(\"id_token\")</code> as you've done.</p>\n\n<p>Aside: I also notice your identity field is not set to Cloud Run service\u2019s URL in your example code.</p>\n"}], "owner": {"reputation": 287, "user_id": 1106407, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7378cf289645ef7c4735c3e60a97eb26?s=128&d=identicon&r=PG", "display_name": "Kevin O&#39;Hara", "link": "https://stackoverflow.com/users/1106407/kevin-ohara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1571246679, "creation_date": 1569292747, "last_edit_date": 1569296657, "question_id": 58072361, "link": "https://stackoverflow.com/questions/58072361/google-cloud-auth-for-internal-cli-using-cloud-run", "title": "Google Cloud Auth for Internal CLI using Cloud Run", "body": "<p>We've built several services using Cloud Run. Our goal is to build an internal CLI that allows our developers to make calls to these services. We're having trouble generating an <code>id_token</code> to use with the Identity Aware Proxy that sits in front of Cloud Run services.</p>\n\n<p>According to the docs, making calls to your Cloud Run services can be accomplished by using <code>gcloud</code> and the <code>gcloud auth print-identity-token</code> command. This works great. This also avoids having to download and pass around service account credentials to our developers as this method leverages your application default credentials.</p>\n\n<p>We've tried implementing something to replicate this <code>print-identity-token</code> functionality in Go with no luck. The <code>id_token</code> generated returns 401's to all of our Cloud Run API's. Example code for generating the token:</p>\n\n<pre><code>func GetIDToken() string {\n    ctx := context.Background()\n    tokenSource, err := google.DefaultTokenSource(ctx, \"openid\", \"email\")\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    token, err := tokenSource.Token()\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    return fmt.Sprintf(\"%v\", token.Extra(\"id_token\"))\n}\n</code></pre>\n\n<p>This returns an <code>id_token</code> but it doesn't work with the API's. The scopes seem to be correct according to the docs.</p>\n\n<p>This leaves us with two questions:</p>\n\n<ol>\n<li>Is this the correct approach for generating an Id token for the IAP?</li>\n<li>Is there a better way to implement the authentication for our developers to these internal API's?</li>\n</ol>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1569295273, "last_edit_date": 1569295273, "creation_date": 1569292320, "answer_id": 58072302, "question_id": 58072244, "link": "https://stackoverflow.com/questions/58072244/assertion-of-zero-int-to-int32/58072302#58072302", "title": "Assertion of zero int to int32", "body": "<p>No, it's not a bug, it's a well defined behavior.</p>\n\n<p>This line:</p>\n\n<pre><code>i = 0\n</code></pre>\n\n<p>Is an <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">assignment</a>, and you use the untyped <code>0</code> integer constant to assign to <code>i</code>. Since a (concrete) type is needed to carry out the assignment (and <code>i</code>s type being <code>interface{}</code> does not define one), the default type of that untyped constant will be used which is <code>int</code>. Read <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">The Go Blog: Constants</a>:</p>\n\n<blockquote>\n  <p>The answer is that an untyped constant has a default type, an implicit type that it transfers to a value if a type is needed where none is provided.</p>\n</blockquote>\n\n<p>You can verify it if you modify it like this:</p>\n\n<pre><code>i2, ok := i.(int)\nfmt.Println(ok)\nfmt.Println(i2)\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>true\n0\n</code></pre>\n\n<p>If you would use a typed constant:</p>\n\n<pre><code>i = int32(0)\n</code></pre>\n\n<p>Then yes, the stored value would be of type <code>int32</code>, and you would get the same output:</p>\n\n<pre><code>i = int32(0)\ni32, ok := i.(int32)\nfmt.Println(ok)\nfmt.Println(i32)\n</code></pre>\n\n<p>Try the examples on the <a href=\"https://play.golang.org/p/5hWG0hyTCS1\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 5, "last_activity_date": 1569292393, "creation_date": 1569292393, "answer_id": 58072308, "question_id": 58072244, "link": "https://stackoverflow.com/questions/58072244/assertion-of-zero-int-to-int32/58072308#58072308", "title": "Assertion of zero int to int32", "body": "<p><code>i</code> doesn't contain an <code>int32</code>, it contains an <code>int</code>, and so the type assertion fails.</p>\n\n<p>Assigning a literal value directly to an <code>interface{}</code> like this or using one in a short variable declaration can be a bit confusing because you don't really get to see what type of value you get; you need to know the rules for the <a href=\"https://golang.org/ref/spec#Constants\" rel=\"noreferrer\">\"default type\"</a> of a constant. If this gives you trouble, you can explicitly cast it to a type, like\n<code>i = int32(0)</code>, which will ensure that <code>i</code> does in fact contain an <code>int32</code>.</p>\n"}], "owner": {"reputation": 3394, "user_id": 1791510, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c08e35b5b14606b89ecce713a94663ee?s=128&d=identicon&r=PG", "display_name": "Yuriy Bondaruk", "link": "https://stackoverflow.com/users/1791510/yuriy-bondaruk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 58072302, "answer_count": 2, "score": -3, "last_activity_date": 1569295273, "creation_date": 1569291775, "question_id": 58072244, "link": "https://stackoverflow.com/questions/58072244/assertion-of-zero-int-to-int32", "title": "Assertion of zero int to int32", "body": "<p>I noticed that Go assertion doesn't work as I expect for zero int. Here is the code:</p>\n\n<pre><code>var i interface{}\ni = 0\ni32, ok := i.(int32)\nfmt.Println(ok)\nfmt.Println(i32)\n</code></pre>\n\n<p>The output is following:</p>\n\n<pre><code>false\n0\n</code></pre>\n\n<p>I can't find an explanation of this behavior. Is it a bug?</p>\n"}, {"tags": ["go", "deadlock", "channel"], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 5400197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bd95a827950f2c0a00b6eb48041613?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Chandak", "link": "https://stackoverflow.com/users/5400197/ravi-chandak"}, "is_accepted": false, "score": 0, "last_activity_date": 1569288383, "creation_date": 1569288383, "answer_id": 58071908, "question_id": 58071762, "link": "https://stackoverflow.com/questions/58071762/how-to-resolve-go-channel-deadlock/58071908#58071908", "title": "How to resolve Go channel deadlock?", "body": "<p>If a channel is nil the <code>&lt;-c</code> receiving from c blocks forever. hence the deadlock\nThe reason the channel could be nil is that one of the goroutines from the 1st for loop may not have been executed at the time the goroutine receiving was executed.</p>\n\n<p>So your code would work fine if you assume that all the goroutines from the 1st for loop are executed before the 2nd for loop starts. </p>\n\n<p>Adding in a sleep can show you the difference but you should actually tackle is issue.</p>\n\n<p>One more thing that could be the issue is \n<code>subTask := make([]Task, 100)</code> This statement creates 100 empty task obj in the slice and append adds more to it so the length grows to 200 eventually.</p>\n\n<p><a href=\"https://play.golang.org/p/4bZDJ2zvKdF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/4bZDJ2zvKdF</a></p>\n"}, {"comments": [{"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 0, "creation_date": 1569295760, "post_id": 58072220, "comment_id": 102540574, "body": "WARNING: as Cerise has pointed out there is a race condition on the use of the slice which is still present in my code above.  It may be better to avoid sharing a slice between go-routines by using another chan - see my later answer."}], "tags": [], "owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "is_accepted": false, "score": 0, "last_activity_date": 1569296269, "last_edit_date": 1569296269, "creation_date": 1569291538, "answer_id": 58072220, "question_id": 58071762, "link": "https://stackoverflow.com/questions/58071762/how-to-resolve-go-channel-deadlock/58072220#58072220", "title": "How to resolve Go channel deadlock?", "body": "<p>One problem is that you are appending to the slice instead of updating the existing slice items.  Also you don't need a buffered chan.</p>\n\n<pre><code>func main() {\n    subTask := make([]Task, 100)\n    for i := range subTask {\n        go func(i int) {\n            subTask[i] = Task{i, make(chan int)}\n            subTask[i].Callback &lt;- i\n        }(i)\n    }\n\n    var wg sync.WaitGroup\n    wg.Add(len(subTask))\n    for _, v := range subTask {\n        go func(v Task) {\n            defer wg.Done()\n            fmt.Println(&lt;-v.Callback)\n        }(v)\n    }\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1569293821, "last_edit_date": 1569293821, "creation_date": 1569292738, "answer_id": 58072359, "question_id": 58071762, "link": "https://stackoverflow.com/questions/58071762/how-to-resolve-go-channel-deadlock/58072359#58072359", "title": "How to resolve Go channel deadlock?", "body": "<p>There's a data race on <code>subTask</code>. The task initialization goroutines read and write the variable <code>subTask</code> with no synchronization. </p>\n\n<p>The intent of the program is to create and initialize a slice of 100 <code>Task</code> values, but it creates a slice with 100 zero value <code>Task</code>s and appends 100 more initialized <code>Task</code>s (ignoring the data race issue just mentioned).</p>\n\n<p>Fix both of these issues by assigning tasks to the slice elements:</p>\n\n<pre><code>for i := 0; i &lt; 100; i++ {\n    go func(i int) {\n        task := Task{\n            Id:       i,\n            Callback: make(chan int, 1),\n        }\n        task.Callback &lt;- i\n        subTask[i] = task\n    }(i)\n}\n</code></pre>\n\n<p>There's a data race on the <code>subTask</code> elements.  There's no guarantee that the task initialization goroutines complete writing to the elements before the main goroutine ranges over those those elements.  Fix by using a wait group to coordinate the completion of the initialization goroutines and the main goroutine:</p>\n\n<pre><code>subTask := make([]Task, 100)\nfor i := 0; i &lt; 100; i++ {\n    wg.Add(1)\n    go func(i int) {\n        task := Task{\n            Id:       i,\n            Callback: make(chan int, 1),\n        }\n        task.Callback &lt;- i\n        subTask[i] = task\n        wg.Done()\n    }(i)\n}\nwg.Wait()\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/7T0u1tzcr5R\" rel=\"nofollow noreferrer\">Run the code on the playground</a>.</p>\n\n<p>The <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">race detector</a> reports both of the data races mentioned above.</p>\n\n<p>If the code in the question is the actual code and not a minimal example for the purpose of asking the question, then the goroutines are not needed at all.  </p>\n"}, {"tags": [], "owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "is_accepted": false, "score": 0, "last_activity_date": 1569296539, "last_edit_date": 1569296539, "creation_date": 1569295813, "answer_id": 58072698, "question_id": 58071762, "link": "https://stackoverflow.com/questions/58071762/how-to-resolve-go-channel-deadlock/58072698#58072698", "title": "How to resolve Go channel deadlock?", "body": "<p>Instead of a slice of tasks you might consider a chan of tasks.</p>\n\n<p>I think this preserves your original idea of creating 100 channels written and read independently.  It also avoids the data race.</p>\n\n<pre><code>func main() {\n    subTasks := make(chan Task)\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 100; i++ {\n        wg.Add(1)\n        go func(i int) {\n            defer wg.Done()\n            task := Task{i, make(chan int)}\n            subTasks &lt;- task\n            task.Callback &lt;- i\n        }(i)\n    }\n\n    go func() {\n        wg.Wait()\n        close(subTasks)\n    }()\n\n    for v := range subTasks {\n        go func(v Task) {\n            fmt.Println(&lt;-v.Callback)\n        }(v)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/guaON4rewAO\" rel=\"nofollow noreferrer\">Run in the playground</a></p>\n"}], "owner": {"reputation": 1, "user_id": 12109916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3320157f24c67f525f96658c4f7e9c9?s=128&d=identicon&r=PG&f=1", "display_name": "wwts17", "link": "https://stackoverflow.com/users/12109916/wwts17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1569298152, "creation_date": 1569286599, "last_edit_date": 1569298152, "question_id": 58071762, "link": "https://stackoverflow.com/questions/58071762/how-to-resolve-go-channel-deadlock", "title": "How to resolve Go channel deadlock?", "body": "<p>I am learning go programming language, recently I have a problem, that I try much ways to run my code but I cannot correctly run. How can I change my program to do it?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\ntype Task struct {\n    Id       int\n    Callback chan int\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n    subTask := make([]Task, 100)\n    for i := 0; i &lt; 100; i++ {\n        go func(i int) {\n            task := Task{\n                Id:       i,\n                Callback: make(chan int, 1),\n            }\n            task.Callback &lt;- i\n            subTask = append(subTask, task)\n        }(i)\n    }\n\n    for _, v := range subTask {\n        wg.Add(1)\n        go func(v Task) {\n            defer wg.Done()\n            x := &lt;-v.Callback\n            fmt.Printf(\"%d \", x)\n        }(v)\n    }\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1569277031, "post_id": 58070254, "comment_id": 102537148, "body": "You can use the <a href=\"https://golang.org/pkg/errors/#Is\" rel=\"nofollow noreferrer\"><code>errors.Is</code></a> function to check the error type or <a href=\"https://golang.org/pkg/errors/#Unwrap\" rel=\"nofollow noreferrer\"><code>errors.Unwrap</code></a> to access its inner error."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1569297357, "post_id": 58070254, "comment_id": 102540890, "body": "What is the &quot;context of error&quot;? There is no such thing in Go,"}, {"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1569306299, "post_id": 58070254, "comment_id": 102543450, "body": "@Volker, i used this work because it was used in the documentation - <code>the errors.Wrap function returns a new error that adds context to the original error</code> - I have post the link in the question."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1569307402, "post_id": 58070254, "comment_id": 102543935, "body": "This is <b>informal</b> language. The &quot;context&quot; mentioned is the additional text and there is <i>no</i> (reliable way) to get it. (Nitpick: adding the stacktrace is also &quot;context&quot; here and you can get the stacktrace, but that is not what you are taking about here). And this is good: This &quot;context&quot; is for human consumption. If you need to distinguish errors: Use different types or a type with exposes this distinction criteria."}, {"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1569310303, "post_id": 58070254, "comment_id": 102545243, "body": "@Volker, thanks. Can you please look at this code <a href=\"https://codereview.stackexchange.com/questions/229555/error-handling-in-go\" title=\"error handling in go\">codereview.stackexchange.com/questions/229555/&hellip;</a>. I put it in the Code Review, becasue it look like the better place for this question. Do you mean this approach when you were talking about different types?"}], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569273429, "creation_date": 1569273044, "last_edit_date": 1569273429, "question_id": 58070254, "link": "https://stackoverflow.com/questions/58070254/error-handling-extracting-context-of-error", "title": "Error handling: extracting context of error", "body": "<p>I have a function which return <code>error</code>:</p>\n\n<pre><code>func foo(i int) error {\n    err := errors.New(\"error here\")\n\n    if i == 1 {\n        return errors.Wrap(err, \"one\")\n    }\n\n    if i == 2 {\n        return errors.Wrap(err, \"two\")  \n    }\n\n    return nil\n}\n</code></pre>\n\n<p>I want to handle an error in the calling function, but to do it, I need to know the context of error. Something like this:</p>\n\n<pre><code>err := foo(i) \n\nswitch err.getContext() {\n  case \"foo\":\n  case \"bar\":\n}\n</code></pre>\n\n<p>I have found <a href=\"https://godoc.org/github.com/pkg/errors\" rel=\"nofollow noreferrer\">causer</a> interface, but I don't know how to use it here.</p>\n\n<p>Or do I need to create the different types (<code>struct</code>) for each type of error here ?</p>\n"}, {"tags": ["csv", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1569272557, "post_id": 58070027, "comment_id": 102535991, "body": "What problem are you having?"}, {"owner": {"reputation": 45, "user_id": 5893162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b75f055c8d9db1690609e7f546125ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zl1987", "link": "https://stackoverflow.com/users/5893162/zl1987"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1569274553, "post_id": 58070027, "comment_id": 102536556, "body": "I don&#39;t know how to auto generate a csv file, right now the csv file has to already be created in order for my results to be written to it."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1569277381, "post_id": 58070027, "comment_id": 102537240, "body": "<a href=\"https://github.com/joho/sqltocsv/blob/ddc1b19/sqltocsv.go#L79\" rel=\"nofollow noreferrer\">The code</a> clearly shows that the file will be created if necessary. How do you come to the conclusion that it must already exist?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1569304830, "post_id": 58070027, "comment_id": 102542879, "body": "You already asked this exact question a few days ago. Don&#39;t post duplicate questions."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5893162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b75f055c8d9db1690609e7f546125ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zl1987", "link": "https://stackoverflow.com/users/5893162/zl1987"}, "edited": false, "score": 0, "creation_date": 1569284351, "post_id": 58071311, "comment_id": 102538655, "body": "This worked perfectly! Thank you!"}], "tags": [], "owner": {"reputation": 89, "user_id": 10122942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09825561ecab09d723592d136eacc40b?s=128&d=identicon&r=PG&f=1", "display_name": "pjmonk", "link": "https://stackoverflow.com/users/10122942/pjmonk"}, "is_accepted": true, "score": 1, "last_activity_date": 1569281500, "creation_date": 1569281500, "answer_id": 58071311, "question_id": 58070027, "link": "https://stackoverflow.com/questions/58070027/generate-csv-file-from-mysql-results/58071311#58071311", "title": "Generate .CSV file from MySQL results", "body": "<p><code>sqltocsv.WriteFile(...)</code> should create the file for you if it doesn't exist.</p>\n\n<p>Under the hood, it just uses <code>os.Create(...)</code> from the standard library.</p>\n\n<p>github.com/joho/sqltocsv/sqltocsv.go:</p>\n\n<pre><code>// WriteFile writes the CSV to the filename specified, return an error if problem\nfunc (c Converter) WriteFile(csvFileName string) error {\n    f, err := os.Create(csvFileName)\n    if err != nil {\n        return err\n    }\n\n    err = c.Write(f)\n    if err != nil {\n        f.Close() // close, but only return/handle the write error\n        return err\n    }\n\n    return f.Close()\n}\n</code></pre>\n\n<p>The documentation for <code>os.Create(...)</code>:</p>\n\n<pre><code>// Create creates the named file with mode 0666 (before umask), truncating\n// it if it already exists. If successful, methods on the returned\n// File can be used for I/O; the associated file descriptor has mode\n// O_RDWR.\n// If there is an error, it will be of type *PathError.\nfunc Create(name string) (*File, error) {\n    return OpenFile(name, O_RDWR|O_CREATE|O_TRUNC, 0666)\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5893162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b75f055c8d9db1690609e7f546125ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zl1987", "link": "https://stackoverflow.com/users/5893162/zl1987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "closed_date": 1569304745, "accepted_answer_id": 58071311, "answer_count": 1, "score": -3, "last_activity_date": 1569304818, "creation_date": 1569271857, "last_edit_date": 1569304474, "question_id": 58070027, "link": "https://stackoverflow.com/questions/58070027/generate-csv-file-from-mysql-results", "closed_reason": "Duplicate", "title": "Generate .CSV file from MySQL results", "body": "<p>I'm attempting to generate a CSV file which would store a dump of a MySQL query, using Go.</p>\n\n<p>I am currently able to export my results to a pre-existing CSV file, but I am trying to auto generate the CSV file once main.go is run. I've tried to use <code>WriteFile</code>, which I know will write a CSV file to the file name specified. I know this is by design, but I'd like the file to generate.</p>\n\n<pre><code>rows, _ := db.Query(\"SELECT * FROM orderTest limit 100;\")\n\n    err := sqltocsv.WriteFile(\"orderTest.csv\", rows)\n    if err != nil {\n        panic(err)\n    }\n\n    columns, _ := rows.Columns()\n    count := len(columns)\n    values := make([]interface{}, count)\n    valuePtrs := make([]interface{}, count)\n\n    for rows.Next() {\n        for i := range columns {\n            valuePtrs[i] = &amp;values[i]\n        }\n\n        rows.Scan(valuePtrs...)\n\n        for i, col := range columns {\n            val := values[i]\n\n            b, ok := val.([]byte)\n            var v interface{}\n            if ok {\n                v = string(b)\n            } else {\n                v = val\n            }\n\n            fmt.Println(col, v)\n        }\n    }\n}\n</code></pre>\n\n<p>My goal is to have the OrdeTest.csv file to auto create itself when I run main.go</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 5, "creation_date": 1569270821, "post_id": 58069828, "comment_id": 102535337, "body": "Go does not have named arguments. You can use structs as a workaround."}, {"owner": {"reputation": 21535, "user_id": 21539, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d620c3ccb17934ab778e66839a7168af?s=128&d=identicon&r=PG", "display_name": "Zain Rizvi", "link": "https://stackoverflow.com/users/21539/zain-rizvi"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569276821, "post_id": 58069828, "comment_id": 102537092, "body": "Ah, that&#39;s a shame"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1569279389, "post_id": 58069828, "comment_id": 102537705, "body": "Is it? Wanting a programming language to behave like <code>insertFavouriteProgrammingLanguageHere</code> tends to lead people to treat it like said language. Go is different from Python. For a reason. Embrace it."}, {"owner": {"reputation": 21535, "user_id": 21539, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d620c3ccb17934ab778e66839a7168af?s=128&d=identicon&r=PG", "display_name": "Zain Rizvi", "link": "https://stackoverflow.com/users/21539/zain-rizvi"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1569370198, "post_id": 58069828, "comment_id": 102572266, "body": "@MarkusWMahlberg what sort of behavior would you expect to a Go programmer to embrace in this scenario? And what benefit would you expect it to confer?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1569396942, "post_id": 58069828, "comment_id": 102579133, "body": "Plain and simple: Try not to use idioms from other programming languages. <code>c := Add(1,3)</code> or <code>c :=Add(a,b)</code> do just fine. And for example, what would be the output of <code>a:=1;b:=2;c:=Add(a:3,b:4);fmt.Println(a,b,c)</code>. Not quite obvious - and something not obvious and/or making assumptions is less desired, isn&#39;t it? It gets even worse when <code>Add := func(a,b float) float</code>."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 5535261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/075621105f274a487d5bf84352fa36db?s=128&d=identicon&r=PG&f=1", "display_name": "B. Ackerman", "link": "https://stackoverflow.com/users/5535261/b-ackerman"}, "is_accepted": true, "score": 1, "last_activity_date": 1569273170, "creation_date": 1569273170, "answer_id": 58070266, "question_id": 58069828, "link": "https://stackoverflow.com/questions/58069828/go-how-to-use-named-arguments-when-calling-a-function/58070266#58070266", "title": "Go: How to use named arguments when calling a function?", "body": "<p>Go does not have named arguments.  The closest thing I know of in Go to named arguments is using a struct as input.  So for your example you could do -</p>\n\n<pre><code>type Input struct {\n  A int\n  B int\n}\n\nfunc Add(in Input) int {\n  return in.A + in.B\n}\n\nfunc main() {\n  c := Add(Input{A: 1, B: 3})\n  return c\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "is_accepted": false, "score": 1, "last_activity_date": 1569288923, "creation_date": 1569288923, "answer_id": 58071967, "question_id": 58069828, "link": "https://stackoverflow.com/questions/58069828/go-how-to-use-named-arguments-when-calling-a-function/58071967#58071967", "title": "Go: How to use named arguments when calling a function?", "body": "<p>In brief: the Go language does not support named args but IDEs do (see below).</p>\n\n<p>I agree that named arguments could be useful in Go.  It could help avoid bugs.  For example, just yesterday my tests picked up a bug where the source and dest. parameters to copy() (Go built-in function) were back to front.</p>\n\n<p>However, there are probably hundreds of useful language features that Go <em>could</em> have. We try to avoid adding non-essential features to the language to keep things simple.  Once you've used Go for a large project you will greatly appreciate how much simpler things are compared to other languages. (I have used more than a dozen languages professionally and Go is by far the least annoying.)</p>\n\n<p>But actually you <strong>can</strong> have named arguments if your IDE supports it. For example, I use GoLand and when you enter the arguments to a function it shows the parameter name (in light gray) in-line with a colon before the value.  This is even better than what you are used to as you don't even have to type the name!</p>\n"}], "owner": {"reputation": 21535, "user_id": 21539, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d620c3ccb17934ab778e66839a7168af?s=128&d=identicon&r=PG", "display_name": "Zain Rizvi", "link": "https://stackoverflow.com/users/21539/zain-rizvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 58070266, "answer_count": 2, "score": -3, "last_activity_date": 1569288923, "creation_date": 1569270719, "last_edit_date": 1569276892, "question_id": 58069828, "link": "https://stackoverflow.com/questions/58069828/go-how-to-use-named-arguments-when-calling-a-function", "title": "Go: How to use named arguments when calling a function?", "body": "<p>How can I invoke a function while using named arguments? </p>\n\n<p>(If it's unclear what named arguments are, here's an example of <a href=\"https://treyhunner.com/2018/04/keyword-arguments-in-python/\" rel=\"nofollow noreferrer\">using them in Python</a>)</p>\n\n<p>Example of what I'd like to do:</p>\n\n<pre><code>func Add(a int, b int) int {\n  return a + b\n}\n\nfunc main() {\n  c := Add(a: 1, b:3)\n  return c\n}\n</code></pre>\n\n<p>However, the above gives me the error:</p>\n\n<pre><code>unexpected :, expecting comma or )\n</code></pre>\n\n<p>(it's referring to the ':' right after the 'a')</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1569272627, "post_id": 58069812, "comment_id": 102536022, "body": "If you&#39;re looking for a better solution than your own, your solution should be part of your question, not an answer."}, {"owner": {"reputation": 585, "user_id": 6420513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/pzKbR.png?s=128&g=1", "display_name": "John Drinane", "link": "https://stackoverflow.com/users/6420513/john-drinane"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1569272964, "post_id": 58069812, "comment_id": 102536138, "body": "YO @Adrian ! Done done done done"}, {"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 0, "creation_date": 1569289304, "post_id": 58069812, "comment_id": 102539499, "body": "Here&#39;s a similar question <a href=\"https://stackoverflow.com/questions/50833673/rotate-array-in-go\">stackoverflow.com/questions/50833673/rotate-array-in-go</a>  Also see <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/SliceTricks</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1569286590, "post_id": 58069984, "comment_id": 102539068, "body": "doesn&#39;t this incur an extra alloc - versus pre-alloc&#39;ing the slice size?  <a href=\"https://play.golang.org/p/IPOCAP8EZTH\" rel=\"nofollow noreferrer\">play.golang.org/p/IPOCAP8EZTH</a>"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1569289038, "post_id": 58069984, "comment_id": 102539462, "body": "@colminator mine does one alloc in <code>append</code>, yours does one alloc in <code>make</code>. The slicing operations don&#39;t alloc."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1569289142, "post_id": 58069984, "comment_id": 102539473, "body": "(<code>append</code> might alloc slightly more space than needed, but that&#39;s a different matter, and not one that I would worry about in <i>most</i> situations)."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1569329230, "post_id": 58069984, "comment_id": 102555530, "body": "ok that clarifies things. When I saw a slice entering a function that is smaller than its eventual target value - I had assumed that incur a slight inefficiency. And yes - as playground example shows - for a slice of size 5 - the returned slice capacity is 8."}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 4, "last_activity_date": 1569291657, "last_edit_date": 1569291657, "creation_date": 1569271606, "answer_id": 58069984, "question_id": 58069812, "link": "https://stackoverflow.com/questions/58069812/how-to-translate-or-shift-values-in-slice-in-golang/58069984#58069984", "title": "How to translate or shift values in slice in golang?", "body": "<pre><code>func translation(nums []int, n int) []int {\n    n = n % len(nums)\n    return append(nums[n:len(nums):len(nums)], nums[:n]...)\n}\n</code></pre>\n\n<p>is sufficient.</p>\n\n<p><code>nums[n:len(nums):len(nums)]</code> is a \"<a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">full slice expression</a>\" which ensures that the resulting slice has no excess capacity (even if <code>nums</code> does). Since it has 0 extra capacity, <code>append</code> will have to allocate a new array to place the extra items, and the returned slice won't be an alias of the original slice \u2014 unless <code>n</code> is 0. If you need to handle the case of <code>0</code>, then you can do it with a <code>copy</code>.</p>\n"}], "owner": {"reputation": 585, "user_id": 6420513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/pzKbR.png?s=128&g=1", "display_name": "John Drinane", "link": "https://stackoverflow.com/users/6420513/john-drinane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569291657, "creation_date": 1569270652, "last_edit_date": 1569272909, "question_id": 58069812, "link": "https://stackoverflow.com/questions/58069812/how-to-translate-or-shift-values-in-slice-in-golang", "title": "How to translate or shift values in slice in golang?", "body": "<p>I have a slice in golang, say [1 2 3 4 5 6 7 8 9 10], and I would like to efficiently shift the values to different indexes such as a shift of 5 would yield [6 7 8 9 10 1 2 3 4 5].</p>\n\n<p>I have come up with a solution below, but wondering if there is a built-in or better way to accomplish this?</p>\n\n<p><a href=\"https://play.golang.org/p/tkYPkGmffQ1\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tkYPkGmffQ1</a></p>\n"}, {"tags": ["amazon-web-services", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1569269457, "post_id": 58069458, "comment_id": 102534785, "body": "Is it when you run it locally that you get that error or when you run it in AWS?"}], "answers": [{"tags": [], "owner": {"reputation": 1044, "user_id": 10792855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/121087ed418f11dbd5063043380340a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Kilpatrick", "link": "https://stackoverflow.com/users/10792855/joey-kilpatrick"}, "is_accepted": true, "score": 0, "last_activity_date": 1569269743, "last_edit_date": 1592644375, "creation_date": 1569269743, "answer_id": 58069615, "question_id": 58069458, "link": "https://stackoverflow.com/questions/58069458/missingregion-could-not-find-region-configuration-but-i-have-it-in-my-aw/58069615#58069615", "title": "&quot;MissingRegion&quot; : could not find region configuration, but I have it in my ~/.aws.config", "body": "<p>This is expected behavior. See here:</p>\n<blockquote>\n<p>By default the SDK will only load the shared credentials file's (~/.aws/credentials) credentials values, and all other config is provided by the environment variables, SDK defaults, and user provided aws.Config values.</p>\n<p>If the AWS_SDK_LOAD_CONFIG environment variable is set, or SharedConfigEnable option is used to create the Session the full shared config values will be loaded. This includes credentials, region, and support for assume role. In addition the Session will load its configuration from both the shared config file (~/.aws/config) and shared credentials file (~/.aws/credentials). Both files have the same format.</p>\n</blockquote>\n<p>Link <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/aws/session/#NewSessionWithOptions\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>So just set the AWS_SDK_LOAD_CONFIG environment variable to read the config.</p>\n"}], "owner": {"reputation": 8456, "user_id": 1879101, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/knzYU.jpg?s=128&g=1", "display_name": "Vitaly Zdanevich", "link": "https://stackoverflow.com/users/1879101/vitaly-zdanevich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 0, "accepted_answer_id": 58069615, "answer_count": 1, "score": 0, "last_activity_date": 1569269907, "creation_date": 1569269010, "last_edit_date": 1569269907, "question_id": 58069458, "link": "https://stackoverflow.com/questions/58069458/missingregion-could-not-find-region-configuration-but-i-have-it-in-my-aw", "title": "&quot;MissingRegion&quot; : could not find region configuration, but I have it in my ~/.aws.config", "body": "<p>My code:</p>\n\n<pre><code>sess = session.Must(session.NewSessionWithOptions(session.Options{\n    Profile: \"gms-ai\",\n}))\n</code></pre>\n\n<p>My <code>~/.aws/config</code>:</p>\n\n<pre><code>[default]\noutput = json\nregion = us-east-1\n\n[profile gms-ai]\noutput = json\nregion = us-east-2\n</code></pre>\n\n<p>But for example this is working snipet from my deployment script:</p>\n\n<pre><code>AWS_PROFILE=gms-ai \\\naws lambda update-function-code...\n</code></pre>\n\n<p>So looks like <code>aws cli</code> do read <code>region</code> but AWS SDK ignore it?</p>\n"}, {"tags": ["go", "installation"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1569268875, "post_id": 58069314, "comment_id": 102534524, "body": "Maybe this can help: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>"}, {"owner": {"reputation": 8456, "user_id": 1879101, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/knzYU.jpg?s=128&g=1", "display_name": "Vitaly Zdanevich", "link": "https://stackoverflow.com/users/1879101/vitaly-zdanevich"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569269264, "post_id": 58069314, "comment_id": 102534703, "body": "@mkopriva I see this document now, looks like I understand this, but why I see this strange error when trying to update installed packages?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1569269418, "post_id": 58069314, "comment_id": 102534764, "body": "Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Show the directory structure if your files and the line of code that produces the error."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1569269519, "post_id": 58069314, "comment_id": 102534810, "body": "Can you give you <code>go env</code> output?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569269545, "post_id": 58069314, "comment_id": 102534829, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47187280/unrecognized-import-path-import-path-does-not-begin-with-hostname\">unrecognized import path (import path does not begin with hostname)</a>"}, {"owner": {"reputation": 8456, "user_id": 1879101, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/knzYU.jpg?s=128&g=1", "display_name": "Vitaly Zdanevich", "link": "https://stackoverflow.com/users/1879101/vitaly-zdanevich"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1569269600, "post_id": 58069314, "comment_id": 102534855, "body": "@CeriseLim&#243;n I removed  <code>~&#47;.gopath</code> and installed only <code>github.com&#47;aws&#47;aws-sdk-go&#47;aws&#47;session</code> - but this the same error."}, {"owner": {"reputation": 8456, "user_id": 1879101, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/knzYU.jpg?s=128&g=1", "display_name": "Vitaly Zdanevich", "link": "https://stackoverflow.com/users/1879101/vitaly-zdanevich"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1569269703, "post_id": 58069314, "comment_id": 102534890, "body": "@Adrian added to the question."}, {"owner": {"reputation": 8456, "user_id": 1879101, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/knzYU.jpg?s=128&g=1", "display_name": "Vitaly Zdanevich", "link": "https://stackoverflow.com/users/1879101/vitaly-zdanevich"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569269862, "post_id": 58069314, "comment_id": 102534955, "body": "@mkopriva I checked this question - I think this this is not a duplicate - I trying to update all packages (<code>go get -u</code> from any directory), not to install some library for local project."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1569271042, "post_id": 58069314, "comment_id": 102535415, "body": "Are you running <code>go get -u</code> from your home directory?"}, {"owner": {"reputation": 8456, "user_id": 1879101, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/knzYU.jpg?s=128&g=1", "display_name": "Vitaly Zdanevich", "link": "https://stackoverflow.com/users/1879101/vitaly-zdanevich"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1569271238, "post_id": 58069314, "comment_id": 102535490, "body": "@CeriseLim&#243;n yes, hm I found that if I change directory to <code>foo</code> I will get <code>package _&#47;home&#47;vitaly&#47;foo: unrecognized import path &quot;_&#47;home&#47;vitaly&#47;foo&quot; (import path does not begin with hostname) </code>."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1569271531, "post_id": 58069314, "comment_id": 102535599, "body": "@VitalyZdanevich That important information is missing from the question.  Run <code>go help packages</code>  for information on how specify packages to the <code>go get</code> and other commands."}], "answers": [{"tags": [], "owner": {"reputation": 8456, "user_id": 1879101, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/knzYU.jpg?s=128&g=1", "display_name": "Vitaly Zdanevich", "link": "https://stackoverflow.com/users/1879101/vitaly-zdanevich"}, "is_accepted": false, "score": 0, "last_activity_date": 1569271405, "creation_date": 1569271405, "answer_id": 58069949, "question_id": 58069314, "link": "https://stackoverflow.com/questions/58069314/package-home-vitaly-unrecognized-import-path-home-vitaly-import-path-do/58069949#58069949", "title": "&quot;package _/home/vitaly: unrecognized import path &quot;_/home/vitaly&quot; (import path does not begin with hostname)&quot;", "body": "<p>Sorry, again my inattention: in order to update all packages we need to run <code>go get -u all</code>.</p>\n"}], "owner": {"reputation": 8456, "user_id": 1879101, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/knzYU.jpg?s=128&g=1", "display_name": "Vitaly Zdanevich", "link": "https://stackoverflow.com/users/1879101/vitaly-zdanevich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569286444, "creation_date": 1569268346, "last_edit_date": 1569286444, "question_id": 58069314, "link": "https://stackoverflow.com/questions/58069314/package-home-vitaly-unrecognized-import-path-home-vitaly-import-path-do", "title": "&quot;package _/home/vitaly: unrecognized import path &quot;_/home/vitaly&quot; (import path does not begin with hostname)&quot;", "body": "<p>Running <code>go get -u</code> returns:</p>\n\n<pre><code>package _/home/vitaly: unrecognized import path \"_/home/vitaly\" (import path does not begin with hostname)\n</code></pre>\n\n<p>I tried to reinstall <code>golang</code> - nothing changed.</p>\n\n<p><code>/home/vitaly</code> is my $HOME.</p>\n\n<p>Output of <code>go env</code>:</p>\n\n<pre><code>GOARCH=\"386\"\nGOBIN=\"\"\nGOCACHE=\"/home/vitaly/.cache/go-build\"\nGOEXE=\"\"\nGOHOSTARCH=\"386\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/vitaly/.gopath\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go-1.10\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/lib/go-1.10/pkg/tool/linux_386\"\nGCCGO=\"gccgo\"\nGO386=\"387\"\nCC=\"gcc\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m32 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build014652388=/tmp/go-build -gno-record-gcc-switches\"\n</code></pre>\n\n<p>Ubuntu 18.04.3 LTS with all updates, 386 system (32 bits).</p>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1569268063, "post_id": 58069237, "comment_id": 102534174, "body": "It&#39;s not unreachable: <a href=\"https://play.golang.org/p/-ejhWDI_0zs\" rel=\"nofollow noreferrer\">play.golang.org/p/-ejhWDI_0zs</a>"}, {"owner": {"reputation": 109, "user_id": 11901987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366b46cd818a7cf27faa030449e84328?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Lucci", "link": "https://stackoverflow.com/users/11901987/rob-lucci"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1569268134, "post_id": 58069237, "comment_id": 102534201, "body": "@JimB I guess, that in such short program gc sweep doesn&#39;t happen"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1569268306, "post_id": 58069237, "comment_id": 102534273, "body": "No, it&#39;s part of the slice specification, <code>arr[:len(arr)]</code> doesn&#39;t change the capacity. GC will collect the backing array when it&#39;s no longer used."}, {"owner": {"reputation": 109, "user_id": 11901987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366b46cd818a7cf27faa030449e84328?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Lucci", "link": "https://stackoverflow.com/users/11901987/rob-lucci"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1569268366, "post_id": 58069237, "comment_id": 102534303, "body": "@JimB actually, my question was named <b>Does</b> GC handle... Guess, that it&#39;s better to revert this edit :)"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1569268531, "post_id": 58069237, "comment_id": 102534376, "body": "The expression <code>arr[:len(arr)]</code> does not make the tail unreachable. For example, one can write <code>tail := arr[len(arr):cap(arr)]</code> to get the tail."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1569268563, "post_id": 58069237, "comment_id": 102534388, "body": "@RobLucci No, because per the specification, you can access the capacity of a slice as a contiguous block of memory. The memory in your example is not unreachable."}, {"owner": {"reputation": 412, "user_id": 10779150, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PdwkjFzp4rE/AAAAAAAAAAI/AAAAAAAAABU/9BZconXx6W0/photo.jpg?sz=128", "display_name": "Laevus Dexter", "link": "https://stackoverflow.com/users/10779150/laevus-dexter"}, "edited": false, "score": 0, "creation_date": 1569270824, "post_id": 58069237, "comment_id": 102535338, "body": "You allocate memory once, slice just contains offsetted data."}, {"owner": {"reputation": 412, "user_id": 10779150, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PdwkjFzp4rE/AAAAAAAAAAI/AAAAAAAAABU/9BZconXx6W0/photo.jpg?sz=128", "display_name": "Laevus Dexter", "link": "https://stackoverflow.com/users/10779150/laevus-dexter"}, "edited": false, "score": 0, "creation_date": 1569271230, "post_id": 58069237, "comment_id": 102535483, "body": "<code>arr = arrz[1:]</code> equals a C equivalent <code>array += 1</code> (considering that array is pointer). Golang just has abstraction for this as struct with additional fields like cap and len."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1569283039, "post_id": 58069237, "comment_id": 102538417, "body": "There&#39;s even a post in the official wiki about this <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/SliceTricks</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 412, "user_id": 10779150, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PdwkjFzp4rE/AAAAAAAAAAI/AAAAAAAAABU/9BZconXx6W0/photo.jpg?sz=128", "display_name": "Laevus Dexter", "link": "https://stackoverflow.com/users/10779150/laevus-dexter"}, "edited": false, "score": 0, "creation_date": 1569286652, "post_id": 58069237, "comment_id": 102539081, "body": "@LaevusDexter <code>array = array[:1]</code> is somewhat equivalent to C <code>array += 1</code>, but note that Go does not have the equivalent of C&#39;s  <code>array -= 1</code>.  Slicing with a positive offset can make elements before the offset unreachable and therefore eligible for collection.  Whether that happens or not is an implementation detail."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1569283881, "last_edit_date": 1569283881, "creation_date": 1569282509, "answer_id": 58071402, "question_id": 58069237, "link": "https://stackoverflow.com/questions/58069237/does-gc-handle-unpointed-parts-of-arrays/58071402#58071402", "title": "Does GC handle unpointed parts of arrays", "body": "<blockquote>\n  <p>Let's say that we created a slice this way:</p>\n\n<pre><code>arr := make([]byte, 0, 10)\narr = append(arr, []byte{1, 1, 1}...)\n</code></pre>\n  \n  <p>And then we want to free 7 tail bytes:</p>\n\n<pre><code>arr = arr[:len(arr)]\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>You can't; the Go GC does not do partial frees. The 10 bytes will stay allocated until there are no references to any part of the 10 bytes.</p>\n\n<p>For example, to free tail bytes,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    arr := make([]byte, 0, 10)\n    arr = append(arr, []byte{1, 1, 1}...)\n\n    // free tail bytes:\n    fmt.Println(len(arr), cap(arr), &amp;arr[0], arr)\n    arr = append(make([]byte, 0, len(arr)), arr...)\n    fmt.Println(len(arr), cap(arr), &amp;arr[0], arr)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/l6cbiBoMf4j\" rel=\"nofollow noreferrer\">https://play.golang.org/p/l6cbiBoMf4j</a></p>\n\n<p>Output:</p>\n\n<pre><code>3 10 0x414020 [1 1 1]\n3 3 0x414050 [1 1 1]\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">The Go Blog: Go Slices: usage and internals</a></p>\n"}], "owner": {"reputation": 109, "user_id": 11901987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366b46cd818a7cf27faa030449e84328?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Lucci", "link": "https://stackoverflow.com/users/11901987/rob-lucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1569283881, "creation_date": 1569267958, "last_edit_date": 1569268435, "question_id": 58069237, "link": "https://stackoverflow.com/questions/58069237/does-gc-handle-unpointed-parts-of-arrays", "title": "Does GC handle unpointed parts of arrays", "body": "<p>Let's say that we created a slice this way:</p>\n\n<pre><code>arr := make([]byte, 0, 10)\narr = append(arr, []byte{1, 1, 1}...)\n</code></pre>\n\n<p>And then we want to free 7 tail bytes:</p>\n\n<pre><code>arr = arr[:len(arr)]\n</code></pre>\n\n<p>We leave the slices' tail unreachable. Will GC simply claim this memory free on the next sweep iteration? Or something else will happen with an underlying array(e.g. <code>copy()</code>, memory will not be freed at all)?</p>\n"}, {"tags": ["variables", "go", "polymorphism"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1569267125, "post_id": 58069019, "comment_id": 102533792, "body": "<i>&quot;So I wonder if it possible to do an interface with variables, something like:&quot;</i> No, it isn&#39;t."}, {"owner": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569267739, "post_id": 58069019, "comment_id": 102534034, "body": "This is weird, this is pretty advanced language. They don&#39;t have solution for such basic problem :/"}, {"owner": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569267830, "post_id": 58069019, "comment_id": 102534072, "body": "This is not duplication, I understand that it is not possible to use variables inside interfaces. I am asking if there other solution for polymorphism problem when it comes to variables"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1569267994, "post_id": 58069019, "comment_id": 102534147, "body": "If you have multiple types that share a common structure, then the way to do it would be <i>composition</i>, I believe. You can then have the &quot;containers&quot; implement a one method interface that provides access to this common structure."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1569268220, "post_id": 58069019, "comment_id": 102534236, "body": "Add <code>getName</code> method to all types (example: <code>func (v struct1) getName() string  { return v.name }</code>, define interface <code>type getNamer interface { getName() string }</code>, use that type as the value type for the <code>structMap</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1569268651, "post_id": 58069019, "comment_id": 102534424, "body": "@E235 <a href=\"https://play.golang.com/p/Bs0gfOPNHtu\" rel=\"nofollow noreferrer\">play.golang.com/p/Bs0gfOPNHtu</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1569269806, "post_id": 58069019, "comment_id": 102534934, "body": "@E235 &quot;I am asking if there other solution for polymorphism&quot; - no. Interfaces are the only form of polymorphism in Go."}], "answers": [{"comments": [{"owner": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "edited": false, "score": 0, "creation_date": 1569320759, "post_id": 58069297, "comment_id": 102550907, "body": "So I will need to add <code>MyStruct</code> as a field in my objects to make it work?"}, {"owner": {"reputation": 4828, "user_id": 8378419, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2772206b4d6afcbdfe7485286554190d?s=128&d=identicon&r=PG&f=1", "display_name": "Robbie Milejczak", "link": "https://stackoverflow.com/users/8378419/robbie-milejczak"}, "reply_to_user": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "edited": false, "score": 0, "creation_date": 1569335089, "post_id": 58069297, "comment_id": 102559127, "body": "no, for this example you just need to set the expected type to the interface. If the function accepts a <code>GenericStruct</code> then <i>any</i> struct with a receiver called <code>GetName</code> will satisfy it. Go uses this pattern heavily, for example any thing that satisfies the <code>io.Writer</code> interface can be used as an argument to <code>fmt.Fprintf</code>, which includes <code>strings.Builder</code>, <code>os.File</code> etc. I merely included reference to more complex constructs for further consideration, sorry if that was confusing"}, {"owner": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "edited": false, "score": 0, "creation_date": 1569342832, "post_id": 58069297, "comment_id": 102563282, "body": "I added the following interface + 2 functions for each struct: <code>type GenericStruct interface {    GetName() string }  func (gs *struct2) GetName() string {   return gs.name }  func (gs *struct1) GetName() string {   return gs.name }</code>  in the <code>main</code> function I added `\tg := structMap[key].(GenericStruct) \tfmt.Print(g)` but now I am receiving different error: <code>interface conversion: main.struct1 is not main.GenericStruct: missing method GetName</code>. This is because the method <code>GetName</code> is not related to <code>struct1</code>."}, {"owner": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "edited": false, "score": 0, "creation_date": 1569343225, "post_id": 58069297, "comment_id": 102563447, "body": "I think I must add new field to the my objects <code>struct1</code> and <code>struct2</code> but this means that I won&#39;t be able to do it when working with objects from 3rd party libraries."}, {"owner": {"reputation": 4828, "user_id": 8378419, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2772206b4d6afcbdfe7485286554190d?s=128&d=identicon&r=PG&f=1", "display_name": "Robbie Milejczak", "link": "https://stackoverflow.com/users/8378419/robbie-milejczak"}, "reply_to_user": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "edited": false, "score": 1, "creation_date": 1569343977, "post_id": 58069297, "comment_id": 102563797, "body": "you&#39;re doing it wrong, you don&#39;t need any sort of assertion for this to work <a href=\"https://gobyexample.com/interfaces\" rel=\"nofollow noreferrer\">gobyexample.com/interfaces</a> see how both circle and rect structs are instances of the geometry interface implicitly, because they have all the required method definitions"}, {"owner": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "edited": false, "score": 0, "creation_date": 1569348850, "post_id": 58069297, "comment_id": 102565815, "body": "OK, now it is more clear. I edited my answer based on what you wrote, now the new problem is because the array of the object is a key,value while the value is <code>interface{}</code> so the new function <code>printName</code> can&#39;t get <code>interface{}</code> inside it. I need to find a way to convert the <code>interface{}</code> to <code>genericInterface</code>"}, {"owner": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "edited": false, "score": 0, "creation_date": 1569348932, "post_id": 58069297, "comment_id": 102565854, "body": "Oh ! I succeed, cool ! I edited the answer"}], "tags": [], "owner": {"reputation": 4828, "user_id": 8378419, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2772206b4d6afcbdfe7485286554190d?s=128&d=identicon&r=PG&f=1", "display_name": "Robbie Milejczak", "link": "https://stackoverflow.com/users/8378419/robbie-milejczak"}, "is_accepted": true, "score": 1, "last_activity_date": 1569343924, "last_edit_date": 1569343924, "creation_date": 1569268273, "answer_id": 58069297, "question_id": 58069019, "link": "https://stackoverflow.com/questions/58069019/how-to-use-polymorphism-for-variables/58069297#58069297", "title": "How to use polymorphism for variables", "body": "<p>For this contrived example you could use getters / setters instead of static properties to leverage interfaces:</p>\n\n<pre><code>type GenericStruct interface {\n   GetName() string\n}\n</code></pre>\n\n<p>And now any struct with a receiver called <code>GetName</code> will satisfy the <code>GenericStruct</code> interface:</p>\n\n<pre><code>type MyStruct struct {\n  Name string\n}\n\nfunc (ms *MyStruct) GetName() string {\n  return ms.Name\n}\n</code></pre>\n\n<p>This could get messy with more complex structs, in which case you may want to consider the composition suggestion (typically achieved via <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">embedding</a>) or a third party library such as <a href=\"https://github.com/cheekybits/genny\" rel=\"nofollow noreferrer\">genny</a></p>\n"}], "owner": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1569297495, "accepted_answer_id": 58069297, "answer_count": 1, "score": -2, "last_activity_date": 1569349006, "creation_date": 1569267042, "last_edit_date": 1569349006, "question_id": 58069019, "link": "https://stackoverflow.com/questions/58069019/how-to-use-polymorphism-for-variables", "closed_reason": "Duplicate", "title": "How to use polymorphism for variables", "body": "<p>I am new in Go and started learning about polymorphism.<br>\nI know how to do it when multiple objects need to use the same function.<br>\nBut I have a new problem, I don't know what to do in a case I have the same variable on different objects.  </p>\n\n<p>In the following example I have two different objects: <code>struct1</code> and <code>struct2</code>. Both of them have the same variable <code>name</code>.<br>\nI can run over them and check which is which and work accordingly (you can test it <a href=\"https://play.golang.org/p/vX9BYTLGl2c\" rel=\"nofollow noreferrer\">here</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\ntype struct1 struct {\n    name string\n}\n\ntype struct2 struct {\n    name string\n}\n\nfunc main(){\n    structMap := make(map[string]interface{})\n    s1 := struct1{name:\"struct1_name\"}\n    s2 := struct2{name:\"struct2_name\"}\n    structMap[\"struct1\"] = s1\n    structMap[\"struct2\"] = s2\n\n    for key, _ := range structMap {\n        switch key {\n            case \"struct1\":\n                generic := structMap[key].(struct1)\n                fmt.Println(generic.name)\n            case \"struct2\":\n                generic := structMap[key].(struct2)\n                fmt.Println(generic.name)\n        }\n    }\n}\n</code></pre>\n\n<p>But if I had 20 objects ? I would need to do 20 checks?<br>\nSo I wonder if it possible to do an interface with variables, something like:  </p>\n\n<pre><code>type genericStruct interfcae {\n   name string\n}\n\n...\nfor key, _ := range structMap {\n    generic := structMap[key].(genericStruct)\n    fmt.Println(generic.name)\n\n}\n</code></pre>\n\n<p>Of course this code doesn't work because I don't know how to do it, but I wanted to know about a way to do it.  </p>\n\n<p><strong>EDIT:</strong><br>\nI tried to use interface based on the example from:\n<a href=\"https://gobyexample.com/interfaces\" rel=\"nofollow noreferrer\">https://gobyexample.com/interfaces</a><br>\nThanks for Robbie Milejczak and the other guys who help me.  </p>\n\n<p>This the new working code:  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\ntype struct1 struct {\n    name string\n}\n\ntype struct2 struct {\n    name string\n}\n\ntype genericInterface interface {\n    GetName() string\n}\n\nfunc (r struct1 ) GetName() string{\n    return r.name\n}\n\nfunc (r struct2 ) GetName() string{\n    return r.name\n}\n\nfunc printName(g interface{}){\n    a := g.(genericInterface)\n    fmt.Println(a.GetName())\n}\n\nfunc main(){\n    structMap := make(map[string]interface{})\n    s1 := struct1{name:\"struct1_name\"}\n    s2 := struct2{name:\"struct2_name\"}\n    structMap[\"struct1\"] = s1\n    structMap[\"struct2\"] = s2\n\n    for key, _ := range structMap {\n    printName(structMap[key])\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "channels"], "answers": [{"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 2, "last_activity_date": 1569267515, "creation_date": 1569267515, "answer_id": 58069133, "question_id": 58068846, "link": "https://stackoverflow.com/questions/58068846/how-to-get-all-the-results-without-getting-a-deadlock-error/58069133#58069133", "title": "How to get all the results without getting a deadlock error", "body": "<p>you are confused about the synchronisation mechanism. The point is to synchronize the async workers. Not the number of elements they will process.</p>\n\n<p>You are not closing the channel after writes has ended, but after reads are supposed to have ended. This is wrong.</p>\n\n<p>You are making both the producer and the consumer async. It is a little weird. As you already have a thread in main, you can take advantage of it to not start a spurious routine.</p>\n\n<p>some variations of your code after fixes</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\n\nfunc main() {\n    c := make(chan int)\n\n    a := []int{1, 3, 10, 8, 15, 23}\n\n    wg.Add(1) // one async worker\n    go Print(c) // ensure the worker is started upfront\n\n    for _, v := range a {\n        c &lt;- v // write the data\n    }\n    close(c) //then close\n\n    wg.Wait()\n    fmt.Println(\"done\")\n}\n\nfunc Print(c chan int) {\n    for v := range c { // the loop will break because the channel is closed.\n        fmt.Println(v)\n    }\n    wg.Done()\n}\n</code></pre>\n\n<p>You can also build it without any waitgroup. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    c := make(chan int)\n\n    a := []int{1, 3, 10, 8, 15, 23}\n\n    go func() {\n        for _, v := range a {\n            c &lt;- v // write the data\n        }\n        close(c) //then close\n    }()\n\n    for v := range c { // the loop will break because the channel is closed.\n        fmt.Println(v)\n    }\n    fmt.Println(\"done\")\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11193096, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_3VQ9fq8_YY/AAAAAAAAAAI/AAAAAAAACMc/riulW5dPSek/photo.jpg?sz=128", "display_name": "Justin Obanor", "link": "https://stackoverflow.com/users/11193096/justin-obanor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569267515, "creation_date": 1569266309, "question_id": 58068846, "link": "https://stackoverflow.com/questions/58068846/how-to-get-all-the-results-without-getting-a-deadlock-error", "title": "How to get all the results without getting a deadlock error", "body": "<p>Should get all the values from the slice without getting a deadlock in the end. I dont get a deadlock error when i dont use waitGroups.\n<em>&lt;-time.After(time.Second)</em>\nIs what i used instead of a waitGroup, and that helped</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\n\nfunc main() {\n    c := make(chan int)\n\n    a := []int{1, 3, 10, 8, 15, 23}\n\n    wg.Add(len(a))\n\n    go func(i []int) {\n        for _, v := range i {\n            c &lt;- v\n        }\n    }(a)\n\n    go Print(c)\n    wg.Wait()\n}\n\nfunc Print(c chan int) {\n    for v := range c {\n        fmt.Println(v)\n    }\n    wg.Done()\n    close(c)\n}\n</code></pre>\n"}, {"tags": ["go", "goland"], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 11, "last_activity_date": 1569266174, "creation_date": 1569266174, "answer_id": 58068812, "question_id": 58068489, "link": "https://stackoverflow.com/questions/58068489/goland-debugger-not-working-with-go-version-upgrade-v1-11-v1-13-on-mac/58068812#58068812", "title": "Goland Debugger not working with go version upgrade ( v1.11 -&gt; v1.13) on mac", "body": "<p>Update your IDE to GoLand 2019.2.2 or newer and the issue will be solved.</p>\n"}], "owner": {"reputation": 43, "user_id": 10340425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nUW7HFiEnU4/AAAAAAAAAAI/AAAAAAAAAO0/WJ5jJlyE0VE/photo.jpg?sz=128", "display_name": "vishal ashank", "link": "https://stackoverflow.com/users/10340425/vishal-ashank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3067, "favorite_count": 0, "accepted_answer_id": 58068812, "answer_count": 1, "score": 3, "last_activity_date": 1569266174, "creation_date": 1569264664, "question_id": 58068489, "link": "https://stackoverflow.com/questions/58068489/goland-debugger-not-working-with-go-version-upgrade-v1-11-v1-13-on-mac", "title": "Goland Debugger not working with go version upgrade ( v1.11 -&gt; v1.13) on mac", "body": "<p>I upgraded golang from v1.11 to v1.13 in mac (mojave OS). The debugger started throwing error <code>Test framework quit unexpectedly</code>. The console output was </p>\n\n<pre><code>API server listening at: 127.0.0.1:xxxxx\nVersion of Delve is too old for this version of Go (maximum supported version 1.12, suppress this error with --check-go-version=false)\n\nDebugger finished with exit code 1\n</code></pre>\n\n<p>I am unable to use debugger on goland since then, however delve as cli command is working. Dont know how to proceed? Also I cannot find any option to disable --check-go-version in goland?</p>\n"}, {"tags": ["go", "jenkins-x"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1569256283, "post_id": 58066548, "comment_id": 102529425, "body": "<a href=\"https://github.com/golang/go/wiki/Modules#semantic-import-versioning\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/Modules#semantic-import-versioning</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1569256749, "post_id": 58066548, "comment_id": 102529637, "body": "Yeah, it looks like they&#39;ve totally broken that repo for importing as a library (though it doesn&#39;t appear to be intended for import as a library). As the page Jim linked shows, a major version change necessitates a path change (i.e. for v2.x the path should be github.com/jenkins-x/jx/v2)."}, {"owner": {"reputation": 4828, "user_id": 8378419, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2772206b4d6afcbdfe7485286554190d?s=128&d=identicon&r=PG&f=1", "display_name": "Robbie Milejczak", "link": "https://stackoverflow.com/users/8378419/robbie-milejczak"}, "edited": false, "score": 0, "creation_date": 1569257215, "post_id": 58066548, "comment_id": 102529805, "body": "to add to what has been said, it seems like you want to do some hacking on <code>jenkins-x</code>. If that&#39;s the case, I&#39;d recommend cloning that repo, making changes to it, and building your own custom binary from source. The <a href=\"https://jenkins-x.io/contribute/development/\" rel=\"nofollow noreferrer\">jenkins-x contribution guidelines</a> should help you with that"}, {"owner": {"reputation": 341, "user_id": 10061187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MBVSv.jpg?s=128&g=1", "display_name": "Benbentwo", "link": "https://stackoverflow.com/users/10061187/benbentwo"}, "edited": false, "score": 0, "creation_date": 1569257466, "post_id": 58066548, "comment_id": 102529907, "body": "The problem is I was hoping to make a web server calling jx functions directly, I&#39;ve written it in bash / python hybrid but it seems hacky to have a container with jx installed to run the cobra commands rather than just call the functions directly, so I was hoping to rewrite it in go."}], "answers": [{"tags": [], "owner": {"reputation": 341, "user_id": 10061187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MBVSv.jpg?s=128&g=1", "display_name": "Benbentwo", "link": "https://stackoverflow.com/users/10061187/benbentwo"}, "is_accepted": false, "score": 1, "last_activity_date": 1579894510, "creation_date": 1579894510, "answer_id": 59902675, "question_id": 58066548, "link": "https://stackoverflow.com/questions/58066548/installing-a-go-module-fails-with-invalid-module-contains-a-go-mod-file-so-ma/59902675#59902675", "title": "Installing a go module fails with `invalid: module contains a go.mod file, so major version must be compatible`", "body": "<p>To anyone looking to compile with some neat Jenkins-x functions I was able to talk to the creators and found out a few things. </p>\n\n<ol>\n<li>Go <code>1.12.4</code></li>\n<li>Look at <a href=\"https://github.com/jenkins-x/lighthouse/blob/master/go.mod\" rel=\"nofollow noreferrer\">their lighthouse</a> project which has a <code>go.mod</code> and uses jenkins-x/jx as a requirement</li>\n<li>As mentioned in the comments once a project goes above major version 1 essentially go.mod uses <code>0.0.0-timestamp-commithash</code></li>\n</ol>\n"}], "owner": {"reputation": 341, "user_id": 10061187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MBVSv.jpg?s=128&g=1", "display_name": "Benbentwo", "link": "https://stackoverflow.com/users/10061187/benbentwo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5344, "favorite_count": 1, "answer_count": 1, "score": 10, "last_activity_date": 1579894510, "creation_date": 1569255972, "question_id": 58066548, "link": "https://stackoverflow.com/questions/58066548/installing-a-go-module-fails-with-invalid-module-contains-a-go-mod-file-so-ma", "title": "Installing a go module fails with `invalid: module contains a go.mod file, so major version must be compatible`", "body": "<p>I'm trying to import from Jenkins-X/jx to customize some stuff a little bit.</p>\n\n<p>I'm really new to go heads up</p>\n\n<p>but trying to <code>go get ./...</code> fails.</p>\n\n<p>my go.mod file</p>\n\n<pre><code>module github.com/my-org/my-project\n\ngo 1.13\n\nrequire github.com/jenkins-x/jx v2.0.383\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>... require github.com/jenkins-x/jx: version \"v2.0.383\" invalid: module contains a go.mod file, so major version must be compatible: should be v0 or v1, not v2\n</code></pre>\n\n<p>which is because jx has a few requirements in its mod file</p>\n\n<p>But I'm not sure what I have to do to actually download the module.</p>\n"}, {"tags": ["go", "type-assertion"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1569256355, "post_id": 58065841, "comment_id": 102529457, "body": "Your playground link doesn&#39;t work. Your code isn&#39;t even valid (<code>fmt.printf</code> isn&#39;t exported)"}, {"owner": {"reputation": 29, "user_id": 2716685, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/y5lta.jpg?s=128&g=1", "display_name": "gustable", "link": "https://stackoverflow.com/users/2716685/gustable"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569309248, "post_id": 58065841, "comment_id": 102544749, "body": "The modified code actually also does not work, hence the question: <a href=\"https://goplay.space/#SF7X7dx8yL9\" rel=\"nofollow noreferrer\">goplay.space/#SF7X7dx8yL9</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569309424, "post_id": 58065841, "comment_id": 102544832, "body": "Please read the compiler error messages. They tell you what&#39;s wrong with your code. We&#39;re not here to read error messages to you."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1569253886, "creation_date": 1569253886, "answer_id": 58066016, "question_id": 58065841, "link": "https://stackoverflow.com/questions/58065841/is-there-an-idiomatic-way-to-index-through-a-type-asserted-interface-in-go/58066016#58066016", "title": "Is there an idiomatic way to index through a type-asserted interface in Go?", "body": "<p>When you're calling <code>Use(other())</code>, you're passing two arguments to <code>Use</code>'s variadic parameter: a <code>string</code>, and a <code>[]byte</code>. So when you iterate over them, the first iteration gives you the <code>string</code>, the second iteration gives you the <code>[]byte</code>. Also a lot of this code is unnecessary and should be failing (some at compile time, some at run time):</p>\n\n<pre><code>// this declares a variable in function scope that is never used; it's immediately shadowed\nval := []byte(\"\")\n// this declares a *new* variable val in loop scope, shadowing the outer val\nfor i, val := range vals {\n    if i &lt; 1 {\n        // this does absolutely nothing\n        _ = val\n        // this also does absolutely nothing - i is the loop iterator and is overwritten by range on every iteration\n        i++\n    } else {\n        // this should be hard failing because there is no case where val is a byte; it's only ever string or []byte\n        p[i] = val.(byte)\n        // It's fmt.Print - fmt.print would be unexported and not usable\n        return fmt.print(p[i])\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1569256571, "creation_date": 1569256571, "answer_id": 58066710, "question_id": 58065841, "link": "https://stackoverflow.com/questions/58065841/is-there-an-idiomatic-way-to-index-through-a-type-asserted-interface-in-go/58066710#58066710", "title": "Is there an idiomatic way to index through a type-asserted interface in Go?", "body": "<blockquote>\n<pre><code>        return fmt.print(p[i]) \n        //interestingly, this call to p[i] returns more than one value\n</code></pre>\n</blockquote>\n\n<p>No, it doesn't.</p>\n\n<p>In fact, the compiler doesn't have any idea how many items it returns, because <code>fmt.printf</code> isn't exported, so it doesn't know what it is. All it knows is that it returns <strong>one or more</strong> values. But you're in a function with zero return values, thus the error.</p>\n\n<p>It's unclear what you want, so I'm not sure how to suggest changing your code, but two potential answers seem obvious:</p>\n\n<ol>\n<li><p>Stop returning something:</p>\n\n<pre><code>    fmt.Print(p[i])\n    return\n</code></pre></li>\n<li><p>Change your function to return something, then call the proper function:</p>\n\n<pre><code>func Use(vals ...interface{}) byte {\n  // ... skip\n      return p[i]\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 29, "user_id": 2716685, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/y5lta.jpg?s=128&g=1", "display_name": "gustable", "link": "https://stackoverflow.com/users/2716685/gustable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1569309782, "creation_date": 1569253106, "last_edit_date": 1569309782, "question_id": 58065841, "link": "https://stackoverflow.com/questions/58065841/is-there-an-idiomatic-way-to-index-through-a-type-asserted-interface-in-go", "title": "Is there an idiomatic way to index through a type-asserted interface in Go?", "body": "<p>I'm working towards implementing a concurrent <code>string</code> and <code>byte</code> reader in Go. The purpose of this is to allow parsing of <code>newline</code> and other such bytes in the read strings.</p>\n\n<p>In researching this problem I've found various ways of handling multiple values in a single value context <a href=\"https://stackoverflow.com/questions/28227095/multiple-values-in-single-value-context/28233172#28233172\">1</a>, however none of these deal with the occurrence of mixed types. The idea of using an interface to deal with this has been suggested <a href=\"https://stackoverflow.com/questions/21743841/how-to-avoid-annoying-error-declared-and-not-used/35966287#35966287\">2</a>, and has been attempted, but I am uncomfortable with the lengthy verbosity of the exisitng suggestions <a href=\"http://blog.vladimirvivien.com/2014/03/hacking-go-filter-values-from-multi.html\" rel=\"nofollow noreferrer\">3</a> and <a href=\"https://play.golang.org/p/IwqmoKwVm-\" rel=\"nofollow noreferrer\">4</a>.</p>\n\n<p>I wonder if there is an idiomatic way to ectively sort through a variety of typed values in a tidy fashion.</p>\n\n<p>EDITED: First I established an interface, as suggested.  This seems a good idea, and is a commonly used trick from C if I recall.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Use(vals ...interface{}) {\n    i := 0\n    p := []uint8{}  //I've replaced the alias \"byte\" with the native \"uint8\"\n    var val uint8  //I've changed this declaration to a non-assigned declaration\n    for i, val := range vals {\n        if i &lt; 1 {\n            _ = val\n            i++\n        } else {\n            p[i] = val.(uint8)\n            return fmt.Print(p[i]) //please excuse the earlier typo\n            //interestingly, this call to p[i] returns more than one value\n        }\n    }\n}\n</code></pre>\n\n<p>The rest of the essential code follows:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func other() (string, []byte) {\n    a := \"declared and not used\"\n    b := []byte(\"stuff\")\n    return a,b\n}\n\nfunc main() {\n    Use(other())\n}\n</code></pre>\n\n<p>It remains unbeknownst to me why this code should appear to have multiple values inside p[i]. Shouldn't the <code>blank identifier</code> used in the control loop make such a possibility unlikely?</p>\n\n<p>The new error, from the edited code is reported as:\n<code>invalid type assertion: x.(uint8) (non-interface type func(...interface {}) []interface {} on left)</code></p>\n\n<p>The original code can be found at:\n<a href=\"https://play.golang.org/p/BEhOT7R0vvr\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BEhOT7R0vvr</a></p>\n\n<p>The edited code can be found at:\n<a href=\"https://goplay.space/#SF7X7dx8yL9\" rel=\"nofollow noreferrer\">https://goplay.space/#SF7X7dx8yL9</a></p>\n"}, {"tags": ["sql", "go", "prepared-statement"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569247267, "post_id": 58064081, "comment_id": 102524649, "body": "In practice, no, because you cannot use statements concurrently. You would have to serialize your requests, which is almost certainly not acceptable."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569247894, "post_id": 58064081, "comment_id": 102525016, "body": "@Peter huh? The docs on <code>Prepare</code> state <i>&quot;Multiple queries or executions may be run concurrently from the returned statement.&quot;</i>, am I misunderstanding something?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569254280, "post_id": 58064081, "comment_id": 102528491, "body": "@mkopriva, &quot;When the Stmt needs to execute on a new underlying connection, it will prepare itself on the new connection automatically.&quot; I don&#39;t recall this happening when I last tried something similar. I saw the same symptoms that happen when a transaction is used concurrently. Perhaps that changed since then or it was a bug in the database driver. Good to know that this is supposed to work."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1569248595, "creation_date": 1569248595, "answer_id": 58064554, "question_id": 58064081, "link": "https://stackoverflow.com/questions/58064081/is-it-okay-to-prepare-sql-statement-once-for-multiple-request/58064554#58064554", "title": "Is it okay to prepare SQL statement once for multiple request?", "body": "<p>As the documentation of <a href=\"https://golang.org/pkg/database/sql/#DB.Prepare\" rel=\"nofollow noreferrer\"><code>DB.Prepare()</code></a> states:</p>\n\n<blockquote>\n  <p>Multiple queries or executions may be run concurrently from the returned statement.</p>\n</blockquote>\n\n<p>It is safe for concurrent use, although the <em>intended</em> use for prepared statements is not to share them between multiple requests. The main reason is that a prepared statement (may) allocate resources in the DB server itself, and it's not freed until you call the <code>Close()</code> method of the returned statement. So I'd advise against it.</p>\n\n<p>The typical use case is if you have to run the same statement multiple times with different parameters, such as the example in the documentation:</p>\n\n<pre><code>projects := []struct {\n    mascot  string\n    release int\n}{\n    {\"tux\", 1991},\n    {\"duke\", 1996},\n    {\"gopher\", 2009},\n    {\"moby dock\", 2013},\n}\n\nstmt, err := db.Prepare(\"INSERT INTO projects(id, mascot, release, category) VALUES( ?, ?, ?, ? )\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer stmt.Close() // Prepared statements take up server resources and should be closed after use.\n\nfor id, project := range projects {\n    if _, err := stmt.Exec(id+1, project.mascot, project.release, \"open source\"); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3567, "user_id": 4019871, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7db9ac6bdc0a996dd01da64b3660f8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mas Bagol", "link": "https://stackoverflow.com/users/4019871/mas-bagol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 58064554, "answer_count": 1, "score": 2, "last_activity_date": 1569250049, "creation_date": 1569246932, "last_edit_date": 1569250049, "question_id": 58064081, "link": "https://stackoverflow.com/questions/58064081/is-it-okay-to-prepare-sql-statement-once-for-multiple-request", "title": "Is it okay to prepare SQL statement once for multiple request?", "body": "<p>I have some SQL queries that do not change on every request (only it's parameter). So, instead of doing this for each request:</p>\n\n<pre><code>func HandleRequest() {\n    rows, err := db.Query(sqlQuery, params...)\n    // do something with data\n}\n</code></pre>\n\n<p>Is it okay if for each reqest I do this instead:</p>\n\n<pre><code>// together with server initialization\nstmt, err := db.Prepare(sqlQuery)\n\nfunc HandleRequest() {\n    rows, err := stmt.Query(params...)\n    // do something with data\n}\n</code></pre>\n"}, {"tags": ["go", "apache-kafka", "confluent-platform", "librdkafka"], "owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1569244867, "creation_date": 1569243700, "last_edit_date": 1569244867, "question_id": 58063086, "link": "https://stackoverflow.com/questions/58063086/explain-the-getmetadata-parameters", "title": "Explain the GetMetadata parameters", "body": "<p>As the <a href=\"https://github.com/confluentinc/confluent-kafka-go/blob/master/kafka/adminapi.go#L858\" rel=\"nofollow noreferrer\">documentation</a> of function <code>GetMetaData</code>:</p>\n\n<pre><code>// GetMetadata queries broker for cluster and topic metadata.\n// If topic is non-nil only information about that topic is returned, else if\n// allTopics is false only information about locally used topics is returned,\n// else information about all topics is returned.\n// GetMetadata is equivalent to listTopics, describeTopics and describeCluster in the Java API.\nfunc (a *AdminClient) GetMetadata(topic *string, allTopics bool, timeoutMs int) (*Metadata, error) {\n    return getMetadata(a, topic, allTopics, timeoutMs)\n}\n</code></pre>\n\n<p>So I guess if the topic is non-nil, the result always returns only the specific topic information. However, when I try to test, I see the very strange result. </p>\n\n<p>Let say I I already have a Kafka topic. Then I call the method <code>GetMetadata</code> as the below code:</p>\n\n<pre><code>topic := \"sample_topic\"\nadmin.GetMetadata(nil, false, timeout)\nadmin.GetMetadata(nil, true, timeout)\nadmin.GetMetadata(&amp;topic, false, timeout)\nadmin.GetMetadata(&amp;topic, true, timeout)\n</code></pre>\n\n<p>Only <code>admin.GetMetadata(&amp;topic, false, timeout)</code> returns the topic information. All other cases return all topics information.</p>\n\n<p>However, when testing on a non-exist topic in the cluster, only the call <code>admin.GetMetadata(&amp;topic, false, timeout)</code> will yield the error.</p>\n\n<pre><code>data, err := admin.GetMetadata(&amp;topic, false, admin.timeOutMs())\nfmt.Println(data.Topics[topic]) //   Broker: Unknown topic or partition\n</code></pre>\n\n<p>When re-order the code, the result also changes.</p>\n\n<p>I read the source code and I see that it uses some functions from <code>librdkafka</code> such as <code>rd_kafka_metadata</code> or <code>_getMetadata_broker_element</code>. But it is hard for me to understand those functions.</p>\n\n<p>I tested on the Kafka cluster with 3 brokers. Please explain for me what is the logic behind.</p>\n"}, {"tags": ["go", "concurrency", "redigo", "data-race"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569240301, "post_id": 58062032, "comment_id": 102520534, "body": "you got to share the data races detection output so we might try to help you further."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1569240629, "post_id": 58062032, "comment_id": 102520683, "body": "When you get a data race, the output tells you exactly where--which two files/lines had the race. Start by reading that. If you need help, please include that output in your question."}, {"owner": {"reputation": 1504, "user_id": 2594743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/L4gxd.jpg?s=128&g=1", "display_name": "dulan", "link": "https://stackoverflow.com/users/2594743/dulan"}, "edited": false, "score": 0, "creation_date": 1569242190, "post_id": 58062032, "comment_id": 102521547, "body": "This code snippet creates 1000 goroutines that does redis SET command, so as you can see the data race happens here <code>err := Set(&quot;key&quot;, strconv.Itoa(i))</code>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1569242515, "post_id": 58062032, "comment_id": 102521727, "body": "The race is because your for loop is updating <code>i</code> while your goroutines are reading <code>i</code> simultaneously."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1569242666, "post_id": 58062032, "comment_id": 102521818, "body": "<a href=\"https://github.com/golang/go/wiki/CommonMistakes#using-goroutines-on-loop-iterator-variables\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/&hellip;</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569243496, "post_id": 58062032, "comment_id": 102522317, "body": "Note line 47 is not where Set happens... it&#39;s where <code>go func() {</code> happens."}], "answers": [{"comments": [{"owner": {"reputation": 1504, "user_id": 2594743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/L4gxd.jpg?s=128&g=1", "display_name": "dulan", "link": "https://stackoverflow.com/users/2594743/dulan"}, "edited": false, "score": 0, "creation_date": 1569243039, "post_id": 58062737, "comment_id": 102522040, "body": "How dump I am... I thought I&#39;m using redigo incorrectly, thanks man!"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1504, "user_id": 2594743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/L4gxd.jpg?s=128&g=1", "display_name": "dulan", "link": "https://stackoverflow.com/users/2594743/dulan"}, "edited": false, "score": 0, "creation_date": 1569243282, "post_id": 58062737, "comment_id": 102522184, "body": "If you look closely at the race detector output, it points you in the right direction:  &quot;Read at ... redis_test.go:48&quot; and &quot;Previous write at ... redis_test.go:45&quot; This narrows it down to variables that are written on line 45, and read on 48. The only variable that fits that description is <code>i</code>."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 1, "last_activity_date": 1569242607, "creation_date": 1569242607, "answer_id": 58062737, "question_id": 58062032, "link": "https://stackoverflow.com/questions/58062032/redigo-concurrent-set-gives-data-race/58062737#58062737", "title": "Redigo concurrent Set gives data race", "body": "<p>The race is because your for loop is updating <code>i</code> while your goroutines are reading <code>i</code> simultaneously. One way to solve this is to pass <code>i</code> into your goroutine function:</p>\n\n<pre><code>for i := 0; i &lt; numOfOperations; i++ {\n    wg.Add(1)\n    go func(i int) {                             // &lt;----------- CHANGE THIS\n        err := Set(\"key\", strconv.Itoa(i))\n        if err != nil {\n            t.Errorf(\"error when setting key value: %s\", err)\n        }\n        wg.Done()\n    }(i)                                         // &lt;----------- AND THIS\n}\n</code></pre>\n\n<p>This way you no longer have a closure over <code>i</code>, and the <code>i</code> inside your goroutine function is a distinct value that can be read (or written) without interference from the outside.</p>\n\n<p>This also solves another bug, that the race detector won't find:  in a <code>for</code> loop, the incremented variable is re-used, which means your current version is actually unwittingly using the same <code>i</code> value in many cases, and skipping over others. See <a href=\"https://stackoverflow.com/q/15945030/13860\">here</a> for more on this.</p>\n"}], "owner": {"reputation": 1504, "user_id": 2594743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/L4gxd.jpg?s=128&g=1", "display_name": "dulan", "link": "https://stackoverflow.com/users/2594743/dulan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 58062737, "answer_count": 1, "score": -1, "last_activity_date": 1569243520, "creation_date": 1569240178, "last_edit_date": 1569243520, "question_id": 58062032, "link": "https://stackoverflow.com/questions/58062032/redigo-concurrent-set-gives-data-race", "title": "Redigo concurrent Set gives data race", "body": "<p>I'm running this test against my redigo functions to see if it supports massive concurrent writes, here're the code</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"github.com/gomodule/redigo/redis\"\n    \"log\"\n    \"os\"\n)\n\n// Redis connection pool\nvar RedisPool *redis.Pool\n\nfunc InitPool() {\n    RedisPool = &amp;redis.Pool{\n        MaxIdle:   80,\n        MaxActive: 12000,\n        Dial: func() (redis.Conn, error) {\n            conn, err := redis.Dial(\"tcp\", \"127.0.0.1:6379\")\n            if err != nil {\n                log.Printf(\"ERROR: fail init redis: %s\", err.Error())\n                os.Exit(1)\n            }\n            return conn, err\n        },\n    }\n}\n\nfunc ClosePool() error {\n    return RedisPool.Close()\n}\n\nfunc Set(key string, val string) error {\n    // get conn and put back when exit from method\n    conn := RedisPool.Get()\n    defer conn.Close()\n\n    _, err := conn.Do(\"SET\", key, val)\n    if err != nil {\n        log.Printf(\"ERROR: fail set key %s, val %s, error %s\", key, val, err.Error())\n        return err\n    }\n\n    return nil\n}\n\nfunc TestManySets(t *testing.T) {\n    InitPool()\n    defer ClosePool()\n\n    var wg sync.WaitGroup\n    numOfOperations := 1000\n    for i := 0; i &lt; numOfOperations; i++ {\n        wg.Add(1)\n        go func() {\n            err := Set(\"key\", strconv.Itoa(i))\n            if err != nil {\n                t.Errorf(\"error when setting key value: %s\", err)\n            }\n            wg.Done()\n        }()\n    }\n    wg.Wait()\n\n    result, err := Get(\"key\")\n    if err != nil {\n        t.Errorf(\"error when getting key value: %s\", err)\n    }\n    t.Logf(\"result: %s\", result)\n}\n\n</code></pre>\n\n<p>When running the test with <code>go test -run TestManySets /path/to/package -count 1 -v</code> I'm getting A LOT of <code>EOF</code> error;</p>\n\n<p>and when running the test with <code>-race</code>, i.e. <code>go test -race -run TestManySets /path/to/package -count 1 -v</code> I'm getting  a lot of data race detected, anyone could kindly point out to me how I could make things right?</p>\n\n<p>Below is the data race log:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>ycx@DESKTOP-NBD349L:/mnt/c/Users/robbi/Projects/GoGameServer$ go test -race -run TestManySets visiontech.com/adapter -count 1 -v\n=== RUN   TestManySets\n==================\nWARNING: DATA RACE\nRead at 0x00c00009ab10 by goroutine 7:\n  visiontech.com/adapter.TestManySets.func1()\n      /home/ycx/Projects/GoGameServer/src/visiontech.com/adapter/redis_test.go:48 +0x3c\n\nPrevious write at 0x00c00009ab10 by goroutine 6:\n  visiontech.com/adapter.TestManySets()\n      /home/ycx/Projects/GoGameServer/src/visiontech.com/adapter/redis_test.go:45 +0x14c\n  testing.tRunner()\n      /usr/local/go/src/testing/testing.go:865 +0x163\n\nGoroutine 7 (running) created at:\n  visiontech.com/adapter.TestManySets()\n      /home/ycx/Projects/GoGameServer/src/visiontech.com/adapter/redis_test.go:47 +0x128\n  testing.tRunner()\n      /usr/local/go/src/testing/testing.go:865 +0x163\n\nGoroutine 6 (running) created at:\n  testing.(*T).Run()\n      /usr/local/go/src/testing/testing.go:916 +0x65a\n  testing.runTests.func1()\n      /usr/local/go/src/testing/testing.go:1157 +0xa8\n  testing.tRunner()\n      /usr/local/go/src/testing/testing.go:865 +0x163\n  testing.runTests()\n      /usr/local/go/src/testing/testing.go:1155 +0x523\n  testing.(*M).Run()\n      /usr/local/go/src/testing/testing.go:1072 +0x2eb\n  main.main()\n      _testmain.go:62 +0x222\n==================\n--- FAIL: TestManySets (10.08s)\n    redis_test.go:62: result: 1000\n    testing.go:809: race detected during execution of test\nFAIL\nFAIL    visiontech.com/adapter  10.098s\nycx@DESKTOP-NBD349L:/mnt/c/Users/robbi/Projects/GoGameServer$\n</code></pre>\n\n<p>And redis_test.go line 47 is where the <code>Set</code> happens in the code above.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14633, "user_id": 5069957, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/597577c2765adaa190e4524d3a3860fe?s=128&d=identicon&r=PG&f=1", "display_name": "edkeveked", "link": "https://stackoverflow.com/users/5069957/edkeveked"}, "edited": false, "score": 0, "creation_date": 1569237452, "post_id": 58061182, "comment_id": 102519029, "body": "Maybe you have to close w before closing gzw."}, {"owner": {"reputation": 845, "user_id": 416068, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7b01c56f6d6592b5239cc20107ec8d2?s=128&d=identicon&r=PG", "display_name": "Mathnode", "link": "https://stackoverflow.com/users/416068/mathnode"}, "reply_to_user": {"reputation": 14633, "user_id": 5069957, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/597577c2765adaa190e4524d3a3860fe?s=128&d=identicon&r=PG&f=1", "display_name": "edkeveked", "link": "https://stackoverflow.com/users/5069957/edkeveked"}, "edited": false, "score": 0, "creation_date": 1569237674, "post_id": 58061182, "comment_id": 102519162, "body": "@edkeveked, that just produced an ASCII text file. I shall try a few more things with the close/wait order."}], "answers": [{"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": true, "score": 3, "last_activity_date": 1569237741, "creation_date": 1569237741, "answer_id": 58061358, "question_id": 58061182, "link": "https://stackoverflow.com/questions/58061182/how-can-i-use-gzip-in-go-to-compress-from-a-command-using-stdoutpipe/58061358#58061358", "title": "How can I use gzip in go to compress from a command using stdoutpipe?", "body": "<p>your pipings are uselessly complex, don't forget to flush and close, remember defer is lifo.</p>\n\n<p>You only need to wrap f writer into a gzip writer, than copy stdout to the writer.</p>\n\n<pre><code>package main\n\nimport (\n    \"compress/gzip\"\n    \"io\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    os.Remove(\"local_test.gz\")\n    f, _ := os.Create(\"local_test.gz\")\n    defer f.Close()\n\n    cmd := exec.Command(\"echo\", \"my\\nstrings\\nare\\nfancy\")\n\n    gzw := gzip.NewWriter(f)\n    defer gzw.Close()\n    defer gzw.Flush()\n\n    out, _ := cmd.StdoutPipe()\n\n    cmd.Start()\n\n    io.Copy(gzw, out)\n\n    // cmd.Wait() // to catch processing errors    \n}\n</code></pre>\n\n<p>the result check</p>\n\n<pre><code>$ file local_test.gz \nlocal_test.gz: gzip compressed data, original size 21\n$ cat local_test.gz | gunzip -c\nmy\nstrings\nare\nfancy\n</code></pre>\n"}], "owner": {"reputation": 845, "user_id": 416068, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7b01c56f6d6592b5239cc20107ec8d2?s=128&d=identicon&r=PG", "display_name": "Mathnode", "link": "https://stackoverflow.com/users/416068/mathnode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 58061358, "answer_count": 1, "score": 1, "last_activity_date": 1569237741, "creation_date": 1569237152, "question_id": 58061182, "link": "https://stackoverflow.com/questions/58061182/how-can-i-use-gzip-in-go-to-compress-from-a-command-using-stdoutpipe", "title": "How can I use gzip in go to compress from a command using stdoutpipe?", "body": "<p>I am trying to understand how to use compression (gzip) for processes which must write to a valid pipe, all in go.</p>\n\n<p>If a pipe is not detected, the enclosing process will error, stating the pipe is broken. So as far as I can tell, I <strong>have</strong> to use StdoutPipe?</p>\n\n<p>For this example, I am just trying to gzip the output from echo.</p>\n\n<pre><code>package main\n\nimport (\n    \"compress/gzip\"\n    //  \"fmt\"\n    \"io\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    f, _ := os.Create(\"/tmp/local_test.gz\")\n\n    cmd := exec.Command(\"echo\", \"my\\nstrings\\nare\\nfancy\")\n\n    r, w := io.Pipe()\n    gzw := gzip.NewWriter(w)\n\n    out, _ := cmd.StdoutPipe()\n\n    cmd.Start()\n\n    go func() {\n        // copy stdoutpipe to gz writer?\n        io.Copy(w, out)\n        gzw.Close()\n        w.Close()\n    }()\n\n    // copy pipe to file?\n    io.Copy(f, r)\n}\n</code></pre>\n\n<p>The file is written, but it's not in gzip format?</p>\n\n<pre><code>$ file /tmp/local_test.gz\n/tmp/local_test.gz: data\n$ gunzip /tmp/local_test.gz\ngunzip: /tmp/local_test.gz: not in gzip format\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1569235738, "post_id": 58060725, "comment_id": 102518154, "body": "If you want a JSON string, which contains an escaped JSON object, just marshal it twice. But... why do you want that?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1569235832, "post_id": 58060725, "comment_id": 102518203, "body": "<code>strconv.Quote(somestring)</code>."}, {"owner": {"reputation": 835, "user_id": 6573592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1020935187991144/picture?type=large", "display_name": "Devendra Verma", "link": "https://stackoverflow.com/users/6573592/devendra-verma"}, "edited": false, "score": 0, "creation_date": 1569238924, "post_id": 58060725, "comment_id": 102519804, "body": "@Filmzy I want to convert this in string because I am applying elastic search on this data. And I dont want to apply my search for all these keys. So for some keys I will just keep everything as a string and assign everything as a string to one key. And rest of the keys, I will include them in my elastic search. If these fields are written as it is then it will also be included in my elastic search any I dont want that."}], "owner": {"reputation": 835, "user_id": 6573592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1020935187991144/picture?type=large", "display_name": "Devendra Verma", "link": "https://stackoverflow.com/users/6573592/devendra-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569235682, "creation_date": 1569235591, "last_edit_date": 1569235682, "question_id": 58060725, "link": "https://stackoverflow.com/questions/58060725/properly-converting-json-to-string", "title": "Properly converting JSON to string", "body": "<p>I am writing a function in which I am getting data in JSON format. I want to convert this JSON into string format then write in log file. Below is my code:</p>\n\n<pre><code>func JSONToString(logs map[string]interface{}){\n    jsonLog, err := json.Marshal(logs)\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n    jsonLogString := string(jsonLog[:len(jsonLog)])\n    logfile := \"/ServiceLogs/\" + \"UploadServiceLog_\" + currentTime.Format(\"2006-01-02\") + \".txt\"\n    jsonLogFile, err := os.OpenFile(logfile, os.O_RDWR|os.O_CREATE|os.O_APPEND, 0644)\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n    defer jsonLogFile.Close()\n\n    jsonLogFile.WriteString(jsonLogString + \"\\n\")\n    jsonLogFile.Close()\n}\n</code></pre>\n\n<p>Now what I get in logs is like </p>\n\n<blockquote>\n  <p>{\"Errors\":{},\"RequestEnd\":1569214715575873000,\"ResponseTime\":1569214715575.873,\"ServiceName\":\"IMAGE_LISTING_SERVICE\",\"Times\":{\"BasicValidationTime\":0.150016,\"ExtraValidationTime\":0.002048,\"FormParsingTime\":0.479232,\"ImagePgConnectionTime\":0.31488,\"RequestDecodingTime\":0.009216}}</p>\n</blockquote>\n\n<p>But I actually wanted this:</p>\n\n<blockquote>\n  <p>\"{\\\"Errors\\\":{},\\\"RequestEnd\\\":1569214715575873000,\\\"ResponseTime\\\":1569214715575.873,\\\"ServiceName\\\":\\\"IMAGE_LISTING_SERVICE\\\",\\\"Times\\\":{\\\"BasicValidationTime\\\":0.150016,\\\"ExtraValidationTime\\\":0.002048,\\\"FormParsingTime\\\":0.479232,\\\"ImagePgConnectionTime\\\":0.31488,\\\"RequestDecodingTime\\\":0.009216}}\"</p>\n</blockquote>\n\n<p>I don't know how to achieve this.</p>\n"}, {"tags": ["go", "fyne"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569235361, "post_id": 58060547, "comment_id": 102517989, "body": "The Godoc probably doesn&#39;t cover the topic, because the topic can&#39;t be addressed by Go. You have to do this in the frontend, with HTML, CSS and/or JavaScript."}, {"owner": {"reputation": 47, "user_id": 12106416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9087cfb2f042cff9d325d150db4a2cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Robman", "link": "https://stackoverflow.com/users/12106416/robman"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569236378, "post_id": 58060547, "comment_id": 102518484, "body": "I think it does <a href=\"https://godoc.org/fyne.io/fyne\" rel=\"nofollow noreferrer\">godoc.org/fyne.io/fyne</a>"}, {"owner": {"reputation": 342, "user_id": 9955790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "RimeBeliskner", "link": "https://stackoverflow.com/users/9955790/rimebeliskner"}, "edited": false, "score": 0, "creation_date": 1572126304, "post_id": 58060547, "comment_id": 103465992, "body": "It seems there isn&#39;t easy way to do it now - <a href=\"https://stackoverflow.com/questions/57651536/how-to-change-color-of-gui-components\">How to change color of GUI components</a>"}, {"owner": {"reputation": 1242, "user_id": 672958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76268f3a255915fa380139dac950652?s=128&d=identicon&r=PG", "display_name": "andy.xyz", "link": "https://stackoverflow.com/users/672958/andy-xyz"}, "edited": false, "score": 2, "creation_date": 1576196525, "post_id": 58060547, "comment_id": 104830716, "body": "HTML, CSS and other web technologies have no impact on Fyne. It specifically avoids using them in rendering"}], "answers": [{"tags": [], "owner": {"reputation": 1242, "user_id": 672958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76268f3a255915fa380139dac950652?s=128&d=identicon&r=PG", "display_name": "andy.xyz", "link": "https://stackoverflow.com/users/672958/andy-xyz"}, "is_accepted": true, "score": 3, "last_activity_date": 1576196233, "creation_date": 1576196233, "answer_id": 59314514, "question_id": 58060547, "link": "https://stackoverflow.com/questions/58060547/how-to-add-padding-font-size-and-colours-to-fyne-ui-app/59314514#59314514", "title": "How to add padding, font size and colours to fyne UI app", "body": "<p>To align the buttons differently you will need to use a different layout (VBox uses the Box layout).</p>\n\n<p>Changing the colours and sizes of standard widgets is not possible. You can specify a different text colour or size in a custom theme but it will apply to all components.\nIf you want elements on screen that don\u2019t conform to the theme you could use the \u2018canvas\u2019 package as that deals with lower level elements. For example canvas.Text can be any size or colour.</p>\n"}, {"tags": [], "owner": {"reputation": 2140, "user_id": 6634060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m8azl.png?s=128&g=1", "display_name": "jozo", "link": "https://stackoverflow.com/users/6634060/jozo"}, "is_accepted": false, "score": 2, "last_activity_date": 1603046171, "creation_date": 1603046171, "answer_id": 64416951, "question_id": 58060547, "link": "https://stackoverflow.com/questions/58060547/how-to-add-padding-font-size-and-colours-to-fyne-ui-app/64416951#64416951", "title": "How to add padding, font size and colours to fyne UI app", "body": "<p>You can't do those things out of the box but you can use <strong>canvas</strong> from Fyne. Examples:</p>\n<p><strong>A label with color:</strong></p>\n<pre><code>label := canvas.NewText(&quot;Hello world&quot;, color.White)\n</code></pre>\n<p><strong>A label with different font size:</strong></p>\n<pre><code>label := canvas.NewText(&quot;Hello world&quot;, color.White)\nlabel.TextSize = 50\n</code></pre>\n<p><strong>Aligning to the right with VBox:</strong></p>\n<pre><code>layout := fyne.NewContainerWithLayout(\n    layout.NewVBoxLayout(),\n    layout.NewSpacer(),\n    widget.NewLabel(&quot;Hello world&quot;),\n)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 12106416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9087cfb2f042cff9d325d150db4a2cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Robman", "link": "https://stackoverflow.com/users/12106416/robman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "accepted_answer_id": 59314514, "answer_count": 2, "score": 2, "last_activity_date": 1603046171, "creation_date": 1569235006, "question_id": 58060547, "link": "https://stackoverflow.com/questions/58060547/how-to-add-padding-font-size-and-colours-to-fyne-ui-app", "title": "How to add padding, font size and colours to fyne UI app", "body": "<p>I have this sample app code below for a UI I'm implementing using the fyne toolkit, and cant figure out how to align the buttons to the left, makes top text bigger, and add colours.</p>\n\n<p>I've tried trying to create a custom theme to implement the UI features I need, but my understanding of the godoc for the fyne toolkit is lacking. Is there a doc someone can point me to to make this work? or provide me with some pointers, as the toolkit is poorly documented</p>\n\n<p>this is my sample app code</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fyne.io/fyne\"\n    \"fyne.io/fyne/app\"\n    \"fyne.io/fyne/layout\"\n    \"fyne.io/fyne/theme\"\n    \"fyne.io/fyne/widget\"\n)\n\nfunc main() {\n    a := app.New()\n    a.Settings().SetTheme(theme.LightTheme())\n    w := a.NewWindow(\"myapp\")\n    w.Resize(fyne.NewSize(340, 600))\n    w.SetContent(widget.NewVBox(\n        widget.NewLabelWithStyle(\"myApp version1\", fyne.TextAlignLeading, fyne.TextStyle{Bold: true}),\n        widget.NewLabelWithStyle(\"Welcome to \\n myAPp\", fyne.TextAlignLeading, fyne.TextStyle{Bold: true}),\n        layout.NewSpacer(),\n        widget.NewButton(\"Register\", func() {\n            a.Quit()\n        }),\n        widget.NewButton(\"Login\", func() {\n            a.Quit()\n        }),\n    ))\n    w.ShowAndRun()\n}\n</code></pre>\n"}, {"tags": ["json", "parsing", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569227714, "post_id": 58058437, "comment_id": 102514139, "body": "Have you tried <code>IndexName string `json:&quot;index_name&quot;`</code>? Or what exactly do you mean by &quot;labels don&#39;t match&quot;?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1569228159, "post_id": 58058437, "comment_id": 102514342, "body": "Why don&#39;t you add <code>json</code> tags to <code>Measure</code> in <code>common</code>? Then problem would be solved, or do I miss something?"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1569228190, "post_id": 58058437, "comment_id": 102514360, "body": "how come the same entity return 2 different models?"}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1569230053, "post_id": 58058437, "comment_id": 102515305, "body": "@icza but then, I won&#39;t be able to have different parsing for the same objects, will I ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1569230241, "post_id": 58058437, "comment_id": 102515394, "body": "@JuliatzindelToro I don&#39;t understand what you mean by different parsing, can you show concrete examples?"}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1569230356, "post_id": 58058437, "comment_id": 102515460, "body": "Differents labels. In one case, I will have prm label :  Prm         string <code>json:&quot;prm&quot;</code>, and on the other case, I will receive PRM label:  Prm         string <code>json:&quot;prmID&quot;</code>. Thing is I don&#39;t always decide the name of the fields, my providers do."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569237522, "post_id": 58058437, "comment_id": 102519076, "body": "If you have two different json objects you need two different Go structs (or use a map), Go does not support changing tags at runtime. A solution to avoid duplication would be more complicated than the duplication itself."}], "answers": [{"comments": [{"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1569230018, "post_id": 58058716, "comment_id": 102515281, "body": "But how should I do it if I need 2 different parsing for the same object ? I will change my fields so it match. But if in common, I add json parsing, I will not be able to change label for another service, If I need to receive labels with another name."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1569231500, "post_id": 58058716, "comment_id": 102516058, "body": "then why not go with two structs like what you already do now"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 0, "last_activity_date": 1569228326, "creation_date": 1569228326, "answer_id": 58058716, "question_id": 58058437, "link": "https://stackoverflow.com/questions/58058437/how-to-avoid-duplicating-object-if-i-want-to-parse-it-in-2-different-json/58058716#58058716", "title": "How to avoid duplicating Object if I want to parse it in 2 different JSON", "body": "<blockquote>\n  <p>Thing is I don't like to use 2 models for the same entity, just because I have no JSON labels in common object</p>\n</blockquote>\n\n<p>First of all, I have a question, how come same entity return two different sets of data that majority of the fields are different?</p>\n\n<p>If those different fields are still from single entity, then you could probably combine the fields and store it into single <code>common.Measure</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Measure struct {\n    Timestamp     time.Time `json:\"timestamp\"`\n    Delta         float64\n    Redistributed float64\n    IsProd        bool\n    IndexValue    string `json:\"index_value\"`\n    IndexName     string `json:\"index_name\"` \n    Source        string \n    ConsoProd     string  `json:\"conso_prod\"` \n    Prm           string  `json:\"prm\"` \n    Operation     string  `json:\"operation\"` \n}\n</code></pre>\n"}], "owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569228326, "creation_date": 1569227235, "last_edit_date": 1569228250, "question_id": 58058437, "link": "https://stackoverflow.com/questions/58058437/how-to-avoid-duplicating-object-if-i-want-to-parse-it-in-2-different-json", "title": "How to avoid duplicating Object if I want to parse it in 2 different JSON", "body": "<p>I have an object that I receive:</p>\n\n<pre><code>{\n    \"operation\": \"ACC00000001\", \n    \"prm\": \"23597250350000\", \n    \"conso_prod\": \"Conso\",\n    \"index_name\": \"BASE\",\n    \"index_value\": \"123456\",\n    \"timestamp\": \"2019-08-20T22:00:00Z\"\n }\n</code></pre>\n\n<p>The object I use is in a common lib, so it is shared by several services:</p>\n\n<p>common.Measure:</p>\n\n<pre><code>type Measure struct {\n    Timestamp     time.Time\n    Delta         float64\n    Redistributed float64\n    IsProd        bool\n    IndexValue    uint32\n    IndexName     string \n    Source        string \n}\n</code></pre>\n\n<p>and Meter:</p>\n\n<pre><code>type Meter struct {\n    ID          string\n    Operation string\n    Unit        string\n    Timestep    time.Duration\n    Measures    []Measure\n}\n</code></pre>\n\n<p>But as the labels don't match, I must create another object  <code>MeasureFromJSON</code> which is the created based in the json I receive.</p>\n\n<pre><code>type MeasureFromJSON struct {\n    Operation   string `json:\"operation\" binding:\"required\"`\n    Prm         string `json:\"prm\"`\n    Conso_prod  string `json:\"conso_prod\"`\n    Index_name  string `json:\"index_name\"`\n    Index_value string `json:\"index_value\"`\n    Timestamp   string `json:\"timestamp\"`\n}\n</code></pre>\n\n<p>Thing is I don't like to use 2 models for the same entity, just because I have no JSON labels in common object. Is there a way to use the common models (<code>meter.Measure</code>)?</p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6188898, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UutsS5qr5_8/AAAAAAAAAAI/AAAAAAAAArQ/bkzJ6M5sTOw/photo.jpg?sz=128", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u041a\u043e\u043b\u043e\u043c\u0435\u0435\u0446", "link": "https://stackoverflow.com/users/6188898/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%9a%d0%be%d0%bb%d0%be%d0%bc%d0%b5%d0%b5%d1%86"}, "edited": false, "score": 0, "creation_date": 1569221919, "post_id": 58057073, "comment_id": 102511452, "body": "it already set when i create item, i need to set data which stored in s.data to src."}, {"owner": {"reputation": 101, "user_id": 6626924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6314a8d2bbf893ac226060cf9dcb17ea?s=128&d=identicon&r=PG&f=1", "display_name": "apurva thakker", "link": "https://stackoverflow.com/users/6626924/apurva-thakker"}, "reply_to_user": {"reputation": 3, "user_id": 6188898, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UutsS5qr5_8/AAAAAAAAAAI/AAAAAAAAArQ/bkzJ6M5sTOw/photo.jpg?sz=128", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u041a\u043e\u043b\u043e\u043c\u0435\u0435\u0446", "link": "https://stackoverflow.com/users/6188898/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%9a%d0%be%d0%bb%d0%be%d0%bc%d0%b5%d0%b5%d1%86"}, "edited": false, "score": 0, "creation_date": 1569222351, "post_id": 58057073, "comment_id": 102511648, "body": "Okay I understood what you are trying to do"}, {"owner": {"reputation": 101, "user_id": 6626924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6314a8d2bbf893ac226060cf9dcb17ea?s=128&d=identicon&r=PG&f=1", "display_name": "apurva thakker", "link": "https://stackoverflow.com/users/6626924/apurva-thakker"}, "reply_to_user": {"reputation": 3, "user_id": 6188898, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UutsS5qr5_8/AAAAAAAAAAI/AAAAAAAAArQ/bkzJ6M5sTOw/photo.jpg?sz=128", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u041a\u043e\u043b\u043e\u043c\u0435\u0435\u0446", "link": "https://stackoverflow.com/users/6188898/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%9a%d0%be%d0%bb%d0%be%d0%bc%d0%b5%d0%b5%d1%86"}, "edited": false, "score": 0, "creation_date": 1569222719, "post_id": 58057073, "comment_id": 102511829, "body": "Please check the edited answer and <a href=\"https://play.golang.org/p/lXYg4eS38TT\" rel=\"nofollow noreferrer\">play.golang.org/p/lXYg4eS38TT</a>"}, {"owner": {"reputation": 3, "user_id": 6188898, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UutsS5qr5_8/AAAAAAAAAAI/AAAAAAAAArQ/bkzJ6M5sTOw/photo.jpg?sz=128", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u041a\u043e\u043b\u043e\u043c\u0435\u0435\u0446", "link": "https://stackoverflow.com/users/6188898/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%9a%d0%be%d0%bb%d0%be%d0%bc%d0%b5%d0%b5%d1%86"}, "edited": false, "score": 0, "creation_date": 1569223196, "post_id": 58057073, "comment_id": 102512030, "body": "I changed your code a bit and it works) Thanks for help) <a href=\"https://play.golang.org/p/9uAqmYj6MQL\" rel=\"nofollow noreferrer\">play.golang.org/p/9uAqmYj6MQL</a>"}], "tags": [], "owner": {"reputation": 101, "user_id": 6626924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6314a8d2bbf893ac226060cf9dcb17ea?s=128&d=identicon&r=PG&f=1", "display_name": "apurva thakker", "link": "https://stackoverflow.com/users/6626924/apurva-thakker"}, "is_accepted": true, "score": 0, "last_activity_date": 1569222687, "last_edit_date": 1569222687, "creation_date": 1569221646, "answer_id": 58057073, "question_id": 58056912, "link": "https://stackoverflow.com/questions/58056912/golang-store-any-struct-in-other-struct-field/58057073#58057073", "title": "Golang store any struct in other struct field", "body": "<pre><code>func (s *TemporaryStoreItem) Data()interface{} {\n    return s.data\n}\ndata := TestData{\n    Key: \"TestData\",\n}\n\nitem := TemporaryStoreItem{\n    key:     \"item1\",\n    data:    data,\n    aliveUntil: time.Now(),\n}\noldItem := item.Data()\nfmt.Println(oldItem)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6188898, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UutsS5qr5_8/AAAAAAAAAAI/AAAAAAAAArQ/bkzJ6M5sTOw/photo.jpg?sz=128", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u041a\u043e\u043b\u043e\u043c\u0435\u0435\u0446", "link": "https://stackoverflow.com/users/6188898/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%9a%d0%be%d0%bb%d0%be%d0%bc%d0%b5%d0%b5%d1%86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 58057073, "answer_count": 1, "score": -1, "last_activity_date": 1569222687, "creation_date": 1569221002, "question_id": 58056912, "link": "https://stackoverflow.com/questions/58056912/golang-store-any-struct-in-other-struct-field", "title": "Golang store any struct in other struct field", "body": "<p>I have this code:</p>\n\n<pre><code>type TestData struct {\n    Key string\n}\n\ntype TemporaryStoreItem struct {\n    key string\n    data interface{}\n    aliveUntil time.Time\n}\n\nfunc (s *TemporaryStoreItem) SetData(src interface{}) {\n    src = s.data\n}\n\ndata := TestData{\n    Key: \"value\",\n}\n\nitem := TemporaryStoreItem{\n    key:     \"item1\",\n    data:    data,\n    aliveUntil: time.Now(),\n}\noldItem := TestData{}\nitem.SetData(&amp;oldItem)\n\n</code></pre>\n\n<p>I need to save any data or pointer to data in 'data' field of TemporaryStoreItem, and i need to get data as TestData struct(or any else source struct), what i do wrong, and is it possible to implement this idea?</p>\n"}, {"tags": ["go", "apache-kafka", "confluent-platform"], "comments": [{"owner": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "edited": false, "score": 0, "creation_date": 1569237818, "post_id": 58056771, "comment_id": 102519238, "body": "Typically your tests would create the topic programmatically. Otherwise you end up with the default number of partitions, replicas, and other topic settings"}, {"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "reply_to_user": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "edited": false, "score": 0, "creation_date": 1569238477, "post_id": 58056771, "comment_id": 102519595, "body": "I agree that my tests will create the topic programmatically. However, you don&#39;t know the next operator will be successfully or not. (e.g: insert a message into that topic because that topic might not exist)"}, {"owner": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "edited": false, "score": 0, "creation_date": 1569238759, "post_id": 58056771, "comment_id": 102519740, "body": "Right. Though, this code that creates them looks blocking to me. <a href=\"https://github.com/confluentinc/confluent-kafka-go/blob/master/examples/admin_create_topic/admin_create_topic.go#L87\" rel=\"nofollow noreferrer\">github.com/confluentinc/confluent-kafka-go/blob/master/examp&zwnj;&#8203;les/&hellip;</a>"}, {"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "reply_to_user": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "edited": false, "score": 0, "creation_date": 1569239279, "post_id": 58056771, "comment_id": 102519984, "body": "The result is only on the node that the client connected to."}, {"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "reply_to_user": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "edited": false, "score": 0, "creation_date": 1569239787, "post_id": 58056771, "comment_id": 102520290, "body": "AdminAPI has a method named <code>GetMetadata</code> that is hard  to understand with me. I don&#39;t know what is the difference when  <code>allTopics</code> flag is set to true and topic is not null."}, {"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "reply_to_user": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "edited": false, "score": 0, "creation_date": 1569239884, "post_id": 58056771, "comment_id": 102520331, "body": "<a href=\"https://github.com/confluentinc/confluent-kafka-go/blob/master/kafka/adminapi.go#L858\" rel=\"nofollow noreferrer\">github.com/confluentinc/confluent-kafka-go/blob/master/kafka&zwnj;&#8203;/&hellip;</a> As the comment here, it looks like <code>allTopics</code> does not matter when the topic is not null. But I run example with defined topic + allTopics = true and defined topic + allTopics = false, they yield the different result."}], "owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569229107, "creation_date": 1569220321, "last_edit_date": 1569229107, "question_id": 58056771, "link": "https://stackoverflow.com/questions/58056771/how-to-get-the-controller-address-id", "title": "How to get the controller address/ID", "body": "<p>I am using <a href=\"https://github.com/confluentinc/confluent-kafka-go\" rel=\"nofollow noreferrer\">confluent Kafka Go</a> for my project. When writing tests, because of the asynchronous nature of Kafka when creating a topic, I might be have errors (error code 3: UNKNOWN_TOPIC_OR_PARTITION) when create the topic then get back immediately. </p>\n\n<p>As I understood, if I can query directly on the controller, I can always get the lastest meta data. So my question is: How can I get Kafka controller's IP or ID when using Confluent Kafka Go.</p>\n"}, {"tags": ["go", "graphql", "graphql-go"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1569209814, "post_id": 58055257, "comment_id": 102508250, "body": "The go <code>graphql</code> package has extensive examples e.g. the TODO app: <a href=\"https://github.com/graphql-go/graphql/blob/master/examples/todo/main.go\" rel=\"nofollow noreferrer\">github.com/graphql-go/graphql/blob/master/examples/todo/main&zwnj;&#8203;.go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "is_accepted": false, "score": 1, "last_activity_date": 1569210632, "creation_date": 1569210632, "answer_id": 58055432, "question_id": 58055257, "link": "https://stackoverflow.com/questions/58055257/how-to-make-a-request-using-graphql-go/58055432#58055432", "title": "How to make a request using graphql-go", "body": "<p>CRUD example extracted from <a href=\"https://github.com/graphql-go/graphql/tree/master/examples/crud\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"math/rand\"\n    \"net/http\"\n    \"time\"\n\n    \"github.com/graphql-go/graphql\"\n)\n\n// Product contains information about one product\ntype Product struct {\n    ID    int64   `json:\"id\"`\n    Name  string  `json:\"name\"`\n    Info  string  `json:\"info,omitempty\"`\n    Price float64 `json:\"price\"`\n}\n\nvar products = []Product{\n    {\n        ID:    1,\n        Name:  \"Chicha Morada\",\n        Info:  \"Chicha morada is a beverage originated in the Andean regions of Per\u00fa but is actually consumed at a national level (wiki)\",\n        Price: 7.99,\n    },\n    {\n        ID:    2,\n        Name:  \"Chicha de jora\",\n        Info:  \"Chicha de jora is a corn beer chicha prepared by germinating maize, extracting the malt sugars, boiling the wort, and fermenting it in large vessels (traditionally huge earthenware vats) for several days (wiki)\",\n        Price: 5.95,\n    },\n    {\n        ID:    3,\n        Name:  \"Pisco\",\n        Info:  \"Pisco is a colorless or yellowish-to-amber colored brandy produced in winemaking regions of Peru and Chile (wiki)\",\n        Price: 9.95,\n    },\n}\n\nvar productType = graphql.NewObject(\n    graphql.ObjectConfig{\n        Name: \"Product\",\n        Fields: graphql.Fields{\n            \"id\": &amp;graphql.Field{\n                Type: graphql.Int,\n            },\n            \"name\": &amp;graphql.Field{\n                Type: graphql.String,\n            },\n            \"info\": &amp;graphql.Field{\n                Type: graphql.String,\n            },\n            \"price\": &amp;graphql.Field{\n                Type: graphql.Float,\n            },\n        },\n    },\n)\n\nvar queryType = graphql.NewObject(\n    graphql.ObjectConfig{\n        Name: \"Query\",\n        Fields: graphql.Fields{\n            /* Get (read) single product by id\n               http://localhost:8080/product?query={product(id:1){name,info,price}}\n            */\n            \"product\": &amp;graphql.Field{\n                Type:        productType,\n                Description: \"Get product by id\",\n                Args: graphql.FieldConfigArgument{\n                    \"id\": &amp;graphql.ArgumentConfig{\n                        Type: graphql.Int,\n                    },\n                },\n                Resolve: func(p graphql.ResolveParams) (interface{}, error) {\n                    id, ok := p.Args[\"id\"].(int)\n                    if ok {\n                        // Find product\n                        for _, product := range products {\n                            if int(product.ID) == id {\n                                return product, nil\n                            }\n                        }\n                    }\n                    return nil, nil\n                },\n            },\n            /* Get (read) product list\n               http://localhost:8080/product?query={list{id,name,info,price}}\n            */\n            \"list\": &amp;graphql.Field{\n                Type:        graphql.NewList(productType),\n                Description: \"Get product list\",\n                Resolve: func(params graphql.ResolveParams) (interface{}, error) {\n                    return products, nil\n                },\n            },\n        },\n    })\n\nvar mutationType = graphql.NewObject(graphql.ObjectConfig{\n    Name: \"Mutation\",\n    Fields: graphql.Fields{\n        /* Create new product item\n        http://localhost:8080/product?query=mutation+_{create(name:\"Inca Kola\",info:\"Inca Kola is a soft drink that was created in Peru in 1935 by British immigrant Joseph Robinson Lindley using lemon verbena (wiki)\",price:1.99){id,name,info,price}}\n        */\n        \"create\": &amp;graphql.Field{\n            Type:        productType,\n            Description: \"Create new product\",\n            Args: graphql.FieldConfigArgument{\n                \"name\": &amp;graphql.ArgumentConfig{\n                    Type: graphql.NewNonNull(graphql.String),\n                },\n                \"info\": &amp;graphql.ArgumentConfig{\n                    Type: graphql.String,\n                },\n                \"price\": &amp;graphql.ArgumentConfig{\n                    Type: graphql.NewNonNull(graphql.Float),\n                },\n            },\n            Resolve: func(params graphql.ResolveParams) (interface{}, error) {\n                rand.Seed(time.Now().UnixNano())\n                product := Product{\n                    ID:    int64(rand.Intn(100000)), // generate random ID\n                    Name:  params.Args[\"name\"].(string),\n                    Info:  params.Args[\"info\"].(string),\n                    Price: params.Args[\"price\"].(float64),\n                }\n                products = append(products, product)\n                return product, nil\n            },\n        },\n\n        /* Update product by id\n           http://localhost:8080/product?query=mutation+_{update(id:1,price:3.95){id,name,info,price}}\n        */\n        \"update\": &amp;graphql.Field{\n            Type:        productType,\n            Description: \"Update product by id\",\n            Args: graphql.FieldConfigArgument{\n                \"id\": &amp;graphql.ArgumentConfig{\n                    Type: graphql.NewNonNull(graphql.Int),\n                },\n                \"name\": &amp;graphql.ArgumentConfig{\n                    Type: graphql.String,\n                },\n                \"info\": &amp;graphql.ArgumentConfig{\n                    Type: graphql.String,\n                },\n                \"price\": &amp;graphql.ArgumentConfig{\n                    Type: graphql.Float,\n                },\n            },\n            Resolve: func(params graphql.ResolveParams) (interface{}, error) {\n                id, _ := params.Args[\"id\"].(int)\n                name, nameOk := params.Args[\"name\"].(string)\n                info, infoOk := params.Args[\"info\"].(string)\n                price, priceOk := params.Args[\"price\"].(float64)\n                product := Product{}\n                for i, p := range products {\n                    if int64(id) == p.ID {\n                        if nameOk {\n                            products[i].Name = name\n                        }\n                        if infoOk {\n                            products[i].Info = info\n                        }\n                        if priceOk {\n                            products[i].Price = price\n                        }\n                        product = products[i]\n                        break\n                    }\n                }\n                return product, nil\n            },\n        },\n\n        /* Delete product by id\n           http://localhost:8080/product?query=mutation+_{delete(id:1){id,name,info,price}}\n        */\n        \"delete\": &amp;graphql.Field{\n            Type:        productType,\n            Description: \"Delete product by id\",\n            Args: graphql.FieldConfigArgument{\n                \"id\": &amp;graphql.ArgumentConfig{\n                    Type: graphql.NewNonNull(graphql.Int),\n                },\n            },\n            Resolve: func(params graphql.ResolveParams) (interface{}, error) {\n                id, _ := params.Args[\"id\"].(int)\n                product := Product{}\n                for i, p := range products {\n                    if int64(id) == p.ID {\n                        product = products[i]\n                        // Remove from product list\n                        products = append(products[:i], products[i+1:]...)\n                    }\n                }\n\n                return product, nil\n            },\n        },\n    },\n})\n\nvar schema, _ = graphql.NewSchema(\n    graphql.SchemaConfig{\n        Query:    queryType,\n        Mutation: mutationType,\n    },\n)\n\nfunc executeQuery(query string, schema graphql.Schema) *graphql.Result {\n    result := graphql.Do(graphql.Params{\n        Schema:        schema,\n        RequestString: query,\n    })\n    if len(result.Errors) &gt; 0 {\n        fmt.Printf(\"errors: %v\", result.Errors)\n    }\n    return result\n}\n\nfunc main() {\n    http.HandleFunc(\"/product\", func(w http.ResponseWriter, r *http.Request) {\n        result := executeQuery(r.URL.Query().Get(\"query\"), schema)\n        json.NewEncoder(w).Encode(result)\n    })\n\n    fmt.Println(\"Server is running on port 8080\")\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<h2>Create</h2>\n\n<p><code>http://localhost:8080/product?query=mutation+_{create(name:\"Inca Kola\",info:\"Inca Kola is a soft drink that was created in Peru in 1935 by British immigrant Joseph Robinson Lindley using lemon verbena (wiki)\",price:1.99){id,name,info,price}}</code></p>\n\n<h2>Read</h2>\n\n<ul>\n<li>Get single product by id: <code>http://localhost:8080/product?query={product(id:1){name,info,price}}</code></li>\n<li>Get product list: <code>http://localhost:8080/product?query={list{id,name,info,price}}</code></li>\n</ul>\n\n<h2>Update</h2>\n\n<p><code>http://localhost:8080/product?query=mutation+_{update(id:1,price:3.95){id,name,info,price}}</code></p>\n\n<h2>Delete</h2>\n\n<p><code>http://localhost:8080/product?query=mutation+_{delete(id:1){id,name,info,price}}</code></p>\n"}], "owner": {"reputation": 904, "user_id": 2882913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d183c2965463a49264d76b912beb73f3?s=128&d=identicon&r=PG&f=1", "display_name": "MrCujo", "link": "https://stackoverflow.com/users/2882913/mrcujo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1569220625, "creation_date": 1569208821, "last_edit_date": 1569220625, "question_id": 58055257, "link": "https://stackoverflow.com/questions/58055257/how-to-make-a-request-using-graphql-go", "title": "How to make a request using graphql-go", "body": "<p>I need to make a request to an external API which uses GraphQL using Go. To do so, I'm using the following client: <a href=\"https://github.com/graphql-go/graphql\" rel=\"nofollow noreferrer\">https://github.com/graphql-go/graphql</a> but the documentation is very limited and don't quite understand how to perform the request. My request is a simple mutation but again, don't know how to perform it.</p>\n"}, {"tags": ["go", "cookies", "controller", "beego"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1569204215, "post_id": 58054667, "comment_id": 102507392, "body": "The <a href=\"https://godoc.org/github.com/astaxie/beego#Controller.Ctx\" rel=\"nofollow noreferrer\">controller&#39;s context</a> is required to set and get cookies."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5515825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0cc2caddfa502efe5b4ee001828d31?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo.Huang", "link": "https://stackoverflow.com/users/5515825/hugo-huang"}, "edited": false, "score": 0, "creation_date": 1569224119, "post_id": 58055680, "comment_id": 102512485, "body": "Thanks very much!  but I wanna to set cookie outside of controller , do you have any other methods recommended"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 1, "user_id": 5515825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0cc2caddfa502efe5b4ee001828d31?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo.Huang", "link": "https://stackoverflow.com/users/5515825/hugo-huang"}, "edited": false, "score": 0, "creation_date": 1569227576, "post_id": 58055680, "comment_id": 102514063, "body": "@Hugo.Huang you need to pass the context object into the model. see updated answer"}, {"owner": {"reputation": 1, "user_id": 5515825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0cc2caddfa502efe5b4ee001828d31?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo.Huang", "link": "https://stackoverflow.com/users/5515825/hugo-huang"}, "edited": false, "score": 0, "creation_date": 1569229391, "post_id": 58055680, "comment_id": 102514969, "body": "How to use function SetCookieFromHere outside of controller? I get a error &quot;invalid memory address or nil pointer dereference&quot; when I use it in my service or util file."}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 1, "last_activity_date": 1569227563, "last_edit_date": 1569227563, "creation_date": 1569212878, "answer_id": 58055680, "question_id": 58054667, "link": "https://stackoverflow.com/questions/58054667/how-to-get-cookie-and-session-outside-of-controller-in-beego/58055680#58055680", "title": "How to get cookie and session outside of controller in beego", "body": "<p>Set cookie can be done via <code>.SetCookie()</code> method of beego context object. The context object itself is accessible via any controller that embed <code>beego.Controller</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (c *MainController) SetToken() {\n    c.Ctx.SetCookie(\"token\", \"xxxxxxxx\")\n}\n\nfunc (c *MainController) GetToken() {\n    cookieValue := c.Ctx.GetCookie(\"token\")\n    fmt.Println(cookieValue)\n}\n</code></pre>\n\n<p>Doc <a href=\"https://beego.me/docs/module/context.md\" rel=\"nofollow noreferrer\">https://beego.me/docs/module/context.md</a></p>\n\n<h3>Update #1</h3>\n\n<blockquote>\n  <p>I wanna to set cookie outside of controller</p>\n</blockquote>\n\n<p>What you need to do is pass the context object of the controller into the particular function. For example:</p>\n\n<pre><code>package models\n\nimport \"github.com/astaxie/beego/context\"\n\nfunc SetCookieFromHere(ctx *context.Context) {\n    ctx.SetCookie(\"token\", \"xxxxxxxx\")\n}\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package controllers\n\nimport \"yourpackage/models\"\n\nfunc (c *MainController) SetToken() {\n    models.SetCookieFromHere(c.Ctx)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 1957835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/65d3b38093aa7662cbe0cce12e0d62c4?s=128&d=identicon&r=PG", "display_name": "ahmetlutfu", "link": "https://stackoverflow.com/users/1957835/ahmetlutfu"}, "is_accepted": false, "score": 1, "last_activity_date": 1578177286, "creation_date": 1578177286, "answer_id": 59595443, "question_id": 58054667, "link": "https://stackoverflow.com/questions/58054667/how-to-get-cookie-and-session-outside-of-controller-in-beego/59595443#59595443", "title": "How to get cookie and session outside of controller in beego", "body": "<p>You can set via beego filter. </p>\n\n<pre><code>var SetCookie = func(ctx *context.Context) {\n    ctx.SetCookie(\"token\", \"xxxxxxxx\")\n}\n\nbeego.InsertFilter(\"/*\", beego.BeforeRouter, SetCookie)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5515825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0cc2caddfa502efe5b4ee001828d31?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo.Huang", "link": "https://stackoverflow.com/users/5515825/hugo-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1578177286, "creation_date": 1569201840, "question_id": 58054667, "link": "https://stackoverflow.com/questions/58054667/how-to-get-cookie-and-session-outside-of-controller-in-beego", "title": "How to get cookie and session outside of controller in beego", "body": "<p>I wanna get and set cookie in my service file, but the code \"ctx.SetCookie()\" always get error \"invalid memory address or nil pointer dereference\", please help me, thanks in advance</p>\n\n<p>I have tried two methods to deal this problem,but there is still something wrong with it </p>\n\n<p>method 1:</p>\n\n<pre><code>type security struct {\n    beego.Controller\n}\n...\nfunc (s security) CheckToken(){\n    ...\n\n    ctx.SetCookie(\"token\",\"xxxxxxxx\")\n}\n</code></pre>\n\n<p>methos 2:</p>\n\n<pre><code>import \"github.com/astaxie/beego/context\"\n\nfunc (s security) CheckToken(){\n    ...\n    ctx := context.NewContext()\n    ctx.SetCookie(\"token\",\"xxxxxxxx\")\n}\n</code></pre>\n\n<p>panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x10 pc=0x832639]</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 5, "creation_date": 1569190582, "post_id": 58053414, "comment_id": 102505503, "body": "No, this isn&#39;t possible because db_test.go isn&#39;t compiled when testing any other package. Put your function into a non-test file, possibly in a package that&#39;s only used for testing and not in production code."}, {"owner": {"reputation": 395, "user_id": 852070, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/54c5cfd077a828339fc540fadcb29faa?s=128&d=identicon&r=PG", "display_name": "kenen", "link": "https://stackoverflow.com/users/852070/kenen"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569197594, "post_id": 58053414, "comment_id": 102506476, "body": "Oh yeah I guess that would work. I guess if it isn&#39;t used (or even imported) by the deployed code it won&#39;t be compiled into the binary. Thanks."}], "owner": {"reputation": 395, "user_id": 852070, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/54c5cfd077a828339fc540fadcb29faa?s=128&d=identicon&r=PG", "display_name": "kenen", "link": "https://stackoverflow.com/users/852070/kenen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "closed_date": 1569220486, "answer_count": 0, "score": 0, "last_activity_date": 1569220551, "creation_date": 1569186532, "question_id": 58053414, "link": "https://stackoverflow.com/questions/58053414/can-i-use-a-test-function-defined-in-one-packages-test-go-file-from-another-pa", "closed_reason": "Duplicate", "title": "Can I use a test function defined in one package&#39;s _test.go file from another packages _test.go?", "body": "<p>I have a db package. Inside of a db_test.go I define a MemoryDb() function to return an in memory database for testing purposes. I can use MemoryDb() from my db_test.go just fine, but I would also like to use it in some other package, apkg's apkg_test.go. That doesn't seem to work, should it?</p>\n\n<p>apkg_test.go</p>\n\n<pre><code>package apkg                                                                                                                                     \n\nimport (                                                                                                                                             \n        \"db\"                                                                                                                                     \n        \"testing\"                                                                                                                                                       \n)                                                                                                                                                           \n\nfunc TestHelloWorld(t *testing.T) {                                                                                                  \n        _ = db.MemoryDb()                                                                                                                                \n}    \n</code></pre>\n\n<p>db.go</p>\n\n<pre><code>package db                                                                                                                           \n\n// Db struct                                                                                                                                     \ntype Db struct {                                                                                                                                                        \n} \n</code></pre>\n\n<p>db_test.go</p>\n\n<pre><code>package db                                                                                                                           \n\nimport \"testing\"                                                                                                                                 \n\nfunc TestHelloWorld(t *testing.T) {                                                                                                                         \n        _ = MemoryDb()\n}\n\nfunc MemoryDb() Db {\n        return Db{}\n}\n</code></pre>\n\n<p>Error that I get</p>\n\n<pre><code>/tmp/go/src/db$ go test\nPASS\nok      db      0.008s\n/tmp/go/src/db$ cd ../apkg/\n/tmp/go/src/apkg$ go test\n$ apkg [apkg.test]\n./apkg_test.go:9:6: undefined: db.MemoryDb\nFAIL    apkg [build failed]\n</code></pre>\n\n<p>Assuming this is not allowed because it's in a _test in another package, is there any way to reach into another package's _test files from other _test files in other packages? I'd rather factor out the MemoryDb but still keep separate _test.go files in separate packages and keey MemoryDb out of deployed binaries (keep it in a _test.go file).</p>\n"}, {"tags": ["mongodb", "sockets", "unix", "go"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1569180213, "post_id": 58052633, "comment_id": 102503320, "body": "You might want to try setting the <code>ClientOptions.Dialer</code> in the client, and return a connection to the domain socket from the custom dialer."}], "answers": [{"tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": true, "score": 1, "last_activity_date": 1569222692, "creation_date": 1569222692, "answer_id": 58057319, "question_id": 58052633, "link": "https://stackoverflow.com/questions/58052633/mongodb-unix-socket-connection-with-an-official-mongo-go-driver/58057319#58057319", "title": "Mongodb unix socket connection with an official mongo-go-driver?", "body": "<blockquote>\n  <p>Is it implemented and supported officially?</p>\n</blockquote>\n\n<p>Using the official <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo\" rel=\"nofollow noreferrer\">MongoDB Go driver</a> you can connect directly to a URI socket. You just need to escape the slash(es). For example using v1.1+: </p>\n\n<pre><code>mongoURI := \"mongodb://%2Ftmp%2Fmongodb-27017.sock\"\n\nclient, err := mongo.NewClient(options.Client().ApplyURI(mongoURI))\nif err != nil {\n    panic(err)\n}\nctx, cancel := context.WithTimeout(context.Background(), 3*time.Second)\ndefer cancel()\nerr = client.Connect(ctx)\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>In addition, <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo#Client\" rel=\"nofollow noreferrer\">mongo.Client</a> supports two types of connection string, either: </p>\n\n<ul>\n<li><p><a href=\"https://docs.mongodb.com/manual/reference/connection-string/#connections-standard-connection-string-format\" rel=\"nofollow noreferrer\">Standard Connection String</a> format, i.e. <code>mongodb://user:pwd@mongodb0.example.com:27017,mongodb1.example.com:27017,mongodb2.example.com:27017/admin?replicaSet=myRepl</code></p></li>\n<li><p><a href=\"https://docs.mongodb.com/manual/reference/connection-string/#connections-dns-seedlist\" rel=\"nofollow noreferrer\">DNS Seedlist Connection</a> format, i.e <code>mongodb+srv://server.example.com/</code></p></li>\n</ul>\n\n<p>Please note that MongoDB, by design, is a distributed database (see <a href=\"https://docs.mongodb.com/manual/replication/\" rel=\"nofollow noreferrer\">Replica Set</a>). Socket is a file based communication and intended for access within a single machine. Unless your use case and requirements specifically require to connect directly via Unix sockets, I'd recommend to use one of the connection string formats above instead.</p>\n"}], "owner": {"reputation": 3, "user_id": 6882557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f8358d11d6c43c5208d19c76247469?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6882557/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 58057319, "answer_count": 1, "score": 0, "last_activity_date": 1569222692, "creation_date": 1569179759, "question_id": 58052633, "link": "https://stackoverflow.com/questions/58052633/mongodb-unix-socket-connection-with-an-official-mongo-go-driver", "title": "Mongodb unix socket connection with an official mongo-go-driver?", "body": "<p>Can't find any information about unix domain sockets connection support with official mongo-go-driver.</p>\n\n<p>Is it implemented and supported officially?</p>\n\n<p>The \"mongodb:///tmp/mongodb-27017.sock\" uri does not work.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1569172935, "post_id": 58051542, "comment_id": 102501359, "body": "Please take <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">A Tour of Go</a> to become familiar with the basic workings of Go."}], "answers": [{"tags": [], "owner": {"reputation": 353, "user_id": 7770917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5d72c19508e683f3a5d4c46685870e?s=128&d=identicon&r=PG&f=1", "display_name": "FattySalami", "link": "https://stackoverflow.com/users/7770917/fattysalami"}, "is_accepted": false, "score": 0, "last_activity_date": 1569172408, "creation_date": 1569172408, "answer_id": 58051602, "question_id": 58051542, "link": "https://stackoverflow.com/questions/58051542/how-to-use-values-from-a-map/58051602#58051602", "title": "How to use values from a map", "body": "<p>To iterate over a map in go, use the range keyword</p>\n\n<pre><code>for key, value := range typeCar {\n   //access values here\n}\n</code></pre>\n\n<p>This will give you the key and value of that key in the map. </p>\n"}, {"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 1, "last_activity_date": 1569172877, "creation_date": 1569172877, "answer_id": 58051664, "question_id": 58051542, "link": "https://stackoverflow.com/questions/58051542/how-to-use-values-from-a-map/58051664#58051664", "title": "How to use values from a map", "body": "<p>you can get user input as a string and test it against the map to retrieve the value associated.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    typeCar := map[string]int{\n        \"audi\":  50,\n        \"volvo\": 100,\n        \"tesla\": 300,\n    }\n\n    fmt.Print(\"how many days would you like to rent?: \")\n    var days int\n    fmt.Scanf(\"%d\", &amp;days)\n\n    // \"typeCar[\"audi\"]\" should be the input of the user instead.\n    fmt.Printf(\"waht type %v ? \", typeCar)\n    var userInput string\n    fmt.Scan(&amp;userInput)\n\n    tCar, ok := typeCar[userInput]\n    if !ok {\n        panic(\"not a valid car\")\n    }\n\n    fmt.Println(\"the price is:\", tCar*days, \"euro\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12103416, "user_type": "registered", "profile_image": "https://graph.facebook.com/2451480261601008/picture?type=large", "display_name": "Bandit", "link": "https://stackoverflow.com/users/12103416/bandit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1569172871, "answer_count": 2, "score": -4, "last_activity_date": 1569172911, "creation_date": 1569172037, "last_edit_date": 1569172839, "question_id": 58051542, "link": "https://stackoverflow.com/questions/58051542/how-to-use-values-from-a-map", "closed_reason": "Duplicate", "title": "How to use values from a map", "body": "<p>I want to use the values in the map I created to  multiply with the days that are given by the input. </p>\n\n<p>I just don't know how to scan for the values that are stored in the map.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    typeCar := map[string]int{\n        \"audi\":  50,\n        \"volvo\": 100,\n        \"tesla\": 300,\n    }\n\n    fmt.Print(\"how many days would you like to rent?: \")\n    var days int\n    fmt.Scanf(\"%d\", &amp;days)\n\n    fmt.Println(\"the price is:\", typeCar[\"audi\"]*days, \"euro\")\n\n    // \"typeCar[\"audi\"]\" should be the input of the user instead.\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1569170247, "post_id": 58051019, "comment_id": 102500574, "body": "See <a href=\"https://stackoverflow.com/questions/45117214/golang-os-exec-stdoutpipe-with-colors\" title=\"golang os exec stdoutpipe with colors\">stackoverflow.com/questions/45117214/&hellip;</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1569175549, "post_id": 58051019, "comment_id": 102502060, "body": "These commands might not generate &quot;colored output&quot; if not attached to a terminal."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1569185247, "post_id": 58051019, "comment_id": 102504467, "body": "There&#39;s nothing to be done in Go. Go doesn&#39;t arbitrarily &quot;remove color&quot;. If you don&#39;t see colored output, it&#39;s because the processes turned it off. Like Volker said, that&#39;s normal behavior if stdout isn&#39;t a terminal (run <code>sls offline | cat</code> and you&#39;ll see uncolored output too). Assign os.Stdout to the commands&#39; Stdout field to connect them directly to your terminal. There may also be a flag that forces colors to be turned on."}, {"owner": {"reputation": 80, "user_id": 3145357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08d913c373c91e17de7dfaa618a06986?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/3145357/tim"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569251668, "post_id": 58051019, "comment_id": 102527147, "body": "I did take a look at the minecraft post. stackoverflow.com/questions/45117214/ That doesn&#39;t help as the command is unknown at run time. @Peter - I am not claiming that &quot;go arbitrarily removes color&quot; I am asking how to pass the color of an known process through go&#39;s io.ReadCloser, or how to pass the hex color from a process."}, {"owner": {"reputation": 80, "user_id": 3145357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08d913c373c91e17de7dfaa618a06986?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/3145357/tim"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569252430, "post_id": 58051019, "comment_id": 102527554, "body": "@Peter again, the command that go executes is dynamic and user defined. It could be a custom script - the go app can&#39;t possibly know what flag to use to force that and I would prefer not to force the user to pass some extra flag just to get my orchestration utility to work. Can I assign a multitude of commands to a single os.Stdout?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569255131, "post_id": 58051019, "comment_id": 102528918, "body": "&quot;the color that the child process prints is not recorded and passed through the pipe&quot; This implies that Go removes the color but it doesn&#39;t. Yes, you can assign os.Stdout to multiple commands, but the output will most likely be interleaved in unintended ways. I wasn&#39;t suggesting to have the Go program add any flags. I meant to suggest to have the caller of your Go program do so if they want colored output."}, {"owner": {"reputation": 80, "user_id": 3145357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08d913c373c91e17de7dfaa618a06986?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/3145357/tim"}, "edited": false, "score": 0, "creation_date": 1569256249, "post_id": 58051019, "comment_id": 102529411, "body": "No worries, man, assigning the os.Stdout was what I was looking to do."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 2748653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff69cb30f31c29e4bab1df37a75810a?s=128&d=identicon&r=PG&f=1", "display_name": "CodeGuy2001", "link": "https://stackoverflow.com/users/2748653/codeguy2001"}, "edited": false, "score": 0, "creation_date": 1609178594, "post_id": 58066339, "comment_id": 115769471, "body": "There&#39;s more to be said about why this works. Many command line programs check if stdout is a terminal or not, and issue different output, such as colors or escape codes if they&#39;re attached to a terminal. What this solution appears to do is reuse the existing stdout, so commands operate as they would if run from the same terminal. It might not work in all cases, but it&#39;s an extremely simple and useful solution. Thanks, Tim."}], "tags": [], "owner": {"reputation": 80, "user_id": 3145357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08d913c373c91e17de7dfaa618a06986?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/3145357/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1569255161, "creation_date": 1569255161, "answer_id": 58066339, "question_id": 58051019, "link": "https://stackoverflow.com/questions/58051019/how-do-you-get-the-color-of-the-output-from-an-exec-stdoutpipe/58066339#58066339", "title": "How do you get the color of the output from an exec.StdoutPipe()?", "body": "<p>Changing the spawn code to assign the os.Stdout to the cmd.Stdout enabled the output to print with the correct colors.</p>\n\n<pre><code>func Spawn(cmd *exec.Cmd, wg *sync.WaitGroup) {\n    defer wg.Done()\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    err := cmd.Start()\n    if err != nil {\n        color.Red(err.Error())\n    }\n    defer cmd.Wait()\n}```\n</code></pre>\n"}], "owner": {"reputation": 80, "user_id": 3145357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08d913c373c91e17de7dfaa618a06986?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/3145357/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1569255161, "creation_date": 1569168411, "question_id": 58051019, "link": "https://stackoverflow.com/questions/58051019/how-do-you-get-the-color-of-the-output-from-an-exec-stdoutpipe", "title": "How do you get the color of the output from an exec.StdoutPipe()?", "body": "<p>I want to be able to seamlessly print the output from an unknown(user defined) command in go passed through a io.ReadCloser. The bufio.NewScanner reads the std out and prints the text correctly, however the color that the child process prints is not recorded and passed through the pipe(or I don't know how to access it).</p>\n\n<p>I tried using <code>execErr := syscall.Exec(binary, cmd.Args, os.Environ())</code> however since this takes over the go process, I can't get an array of processes to run. </p>\n\n<pre><code>// SpawnGroup spawns a group of processes\nfunc SpawnGroup(cmds []*exec.Cmd) {\n    spawnWg := &amp;sync.WaitGroup{}\n    spawnWg.Add(len(cmds))\n    defer spawnWg.Wait()\n    for _, cmd := range cmds {\n        go Spawn(cmd, spawnWg)\n    }\n}\n\n// Spawn spawn a child process\nfunc Spawn(cmd *exec.Cmd, wg *sync.WaitGroup) {\n    defer wg.Done()\n    stdout, _ := cmd.StdoutPipe()\n    stderr, _ := cmd.StderrPipe()\n    err := cmd.Start()\n    if err != nil {\n        color.Red(err.Error())\n    }\n    scanner := bufio.NewScanner(stdout)\n    for scanner.Scan() {\n        fmt.Println(scanner.Text())\n    }\n    errScanner := bufio.NewScanner(stderr)\n    for errScanner.Scan() {\n        color.Red(scanner.Text())\n    }\n    cmd.Wait()\n}\n</code></pre>\n\n<p>For example, if I try to run two commands passed in an array such as <code>sls offline</code> and <code>vue-cli-service serve</code> everything works as expected, but the logged output doesn't have the color. Both of these processes print some of their output to the command line with color. The exact array of commands will be unknown, so I need a way to print the exact output from them. </p>\n\n<p>I was able to get this to work in node by using:</p>\n\n<pre><code>  let cmd = await spawn(command, args, {\n    stdio: 'inherit',\n    shell: true,\n    ...options\n  });\n</code></pre>\n\n<p>I haven't been able to track down how to do this in go. </p>\n\n<p>Thanks for any advice or help, this is my first real dive into go, but it seems like an excellent language!</p>\n"}, {"tags": ["go", "deployment", "package", "shared-hosting"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1569165111, "post_id": 58050459, "comment_id": 102499198, "body": "The language is called &quot;Go&quot;, Not &quot;GoLang&quot;"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1569165908, "post_id": 58050459, "comment_id": 102499426, "body": "I would go with the flow by using 1.10.  Vendor dependencies instead of using Go modules.  Use <a href=\"https://godoc.org/golang.org/x/xerrors\" rel=\"nofollow noreferrer\">golang.org/x/errors</a> instead of the new 1.13 error features."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1569166164, "post_id": 58050459, "comment_id": 102499498, "body": "Regarding templates:  The application probably assumes that the current working directory is the directory above <code>.&#47;ui&#47;html&#47;</code> in the source directory tree.  That directory will not be present if you copy the executable only to another machine."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1569167272, "post_id": 58050459, "comment_id": 102499810, "body": "I agree with @CeriseLim&#243;n. Go 1.10 isn&#39;t that old. Just use it. For a university project, you&#39;re unlikely to need mods anyway. Vendoring should be just fine.  On the other hand... In my university days, I often made tasks harder than necessary, just for fun, and I learned a lot... so either way, good luck :)"}, {"owner": {"reputation": 5690, "user_id": 1551948, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710df1916afe732a80ba572dfb895d47?s=128&d=identicon&r=PG", "display_name": "harperville", "link": "https://stackoverflow.com/users/1551948/harperville"}, "edited": false, "score": 0, "creation_date": 1569170627, "post_id": 58050459, "comment_id": 102500682, "body": "I will start the back-porting to v1.10 per your advice.  I need to work the paths out for the modules, though.  I need to use sqlite3 module and so far, I&#39;m failing being able to build because of it not being found.  The GOROOT is set system-wide and they may not have the sqlite3 module installed which puts me in a jam.  Maybe I can pass arguments to the <code>go build</code> command to look in a local module repo for some modules and the system repo for others?"}, {"owner": {"reputation": 2292, "user_id": 767903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7ae9acb5bf16896b78a9708403da20ca?s=128&d=identicon&r=PG", "display_name": "Andrew W. Phillips", "link": "https://stackoverflow.com/users/767903/andrew-w-phillips"}, "edited": false, "score": 2, "creation_date": 1569204385, "post_id": 58050459, "comment_id": 102507421, "body": "If the server has docker it is simple to build using an official docker image containing a specific version of the Go compiler (eg use image &quot;golang:1.13&quot; from DockerHub)."}], "answers": [{"tags": [], "owner": {"reputation": 5690, "user_id": 1551948, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710df1916afe732a80ba572dfb895d47?s=128&d=identicon&r=PG", "display_name": "harperville", "link": "https://stackoverflow.com/users/1551948/harperville"}, "is_accepted": false, "score": 0, "last_activity_date": 1571096161, "creation_date": 1571096161, "answer_id": 58385305, "question_id": 58050459, "link": "https://stackoverflow.com/questions/58050459/how-to-create-an-all-inclusive-go-environment-to-meet-the-requirements-set-forth/58385305#58385305", "title": "How to create an all-inclusive Go environment to meet the requirements set forth: &quot;application must compile on shared server&quot;", "body": "<p>The answer in my case was that I can supply a <code>Makefile</code> that does anything I need it to do.</p>\n\n<p>(It's actually good practice, if not an <em>expectation</em>, of a project that is turned in.)</p>\n\n<p>The requirements were that my project needs to compile on the server and that I had to supply a <code>Makefile</code>.  Therefore, any downloading, installing, and setting up of a Go environment for my project can be done, as long as everything happens in the user's environment and is not something that needs <code>sudo</code> to install correctly.  The server does not have Docker.   </p>\n"}], "owner": {"reputation": 5690, "user_id": 1551948, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710df1916afe732a80ba572dfb895d47?s=128&d=identicon&r=PG", "display_name": "harperville", "link": "https://stackoverflow.com/users/1551948/harperville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571096161, "creation_date": 1569164674, "last_edit_date": 1571003135, "question_id": 58050459, "link": "https://stackoverflow.com/questions/58050459/how-to-create-an-all-inclusive-go-environment-to-meet-the-requirements-set-forth", "title": "How to create an all-inclusive Go environment to meet the requirements set forth: &quot;application must compile on shared server&quot;", "body": "<p>A little backstory:</p>\n\n<p>I am creating my first Go web app for school.  The professor said that I could use Go.  I asked him if I could use the latest version, 1.13, rather than the version installed on the server, 1.10, to leverage the module management feature and the updated errors module.  He did <em>not</em> say that I was restricted to 1.10 and even gave me the contact information of the server admin.  I reached out to the server admin with my professor CC'd and he said he doesn't want to update the server's version of Go in the middle of the semester.  He then included instructions on how to download, install, and use whatever version of Go that I need in my home directory.</p>\n\n<blockquote>\n  <p>Pick your version:</p>\n  \n  <p><a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">https://golang.org/dl/</a></p>\n  \n  <p>Set it up for your own use:</p>\n  \n  <p><a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">https://golang.org/doc/install</a></p>\n</blockquote>\n\n<p>I installed go 1.13 and updated my own envvars to reflect this version and everything works.</p>\n\n<p>Well, the other requirement is that I have to hand my professor my project and that it has to compile on the server.  I am thinking that if I hand him a bundle and give him directions on how to build it, then I've technically met the requirements of the project so far.</p>\n\n<p>My question is, does Go have anything that takes my Go v1.13 environment and packages everything up so that the project can <strong><em>compile</em></strong> on the target server?  I have only been able to find solutions along the lines of \"<em>just copy the project binary to your production server</em>\" but that doesn't help me.  I need it to <em>compile</em> on the production server.  Besides, I tried copying my binary to the production server and it couldn't find my html templates (stored in ./ui/html/ directory) but I guess that will be solved in this discussion or saved for another SO question later.</p>\n\n<pre><code>student@universityserver:~$ ./web\nINFO    2019/09/22 10:21:52 Starting server on :5089\nINFO    2019/09/22 10:23:03 &lt;ipaddress&gt;:63527 - HTTP/1.1 GET /\nERROR   2019/09/22 10:23:03 handlers.go:29: open ./ui/html/home.page.tmpl: no such file or directory\n</code></pre>\n\n<p>The only thing I can think of right now is to basically add everything they need (the go amd64 binary distribution and all modules) and write a script that handles it all (extract go in local folder, export envvars, build, etc.)</p>\n\n<blockquote>\n  <p>Dear, Professor.</p>\n  \n  <p>Copy this tarball to your home directory, extract, run <code>build_my_goapp.sh</code> script.</p>\n  \n  <p>Sincerely,\n  Your student</p>\n</blockquote>\n"}, {"tags": ["amazon-web-services", "go", "credentials", "aws-fargate"], "comments": [{"owner": {"reputation": 179, "user_id": 7190684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d8ec86d3e9c618582bc4905aa0cc5a?s=128&d=identicon&r=PG&f=1", "display_name": "Chanonry", "link": "https://stackoverflow.com/users/7190684/chanonry"}, "edited": false, "score": 0, "creation_date": 1569331270, "post_id": 58050325, "comment_id": 102556855, "body": "Looks like an error loading the aws libraries. Raised an issue on GitHub"}], "owner": {"reputation": 179, "user_id": 7190684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d8ec86d3e9c618582bc4905aa0cc5a?s=128&d=identicon&r=PG&f=1", "display_name": "Chanonry", "link": "https://stackoverflow.com/users/7190684/chanonry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1569163778, "creation_date": 1569163778, "question_id": 58050325, "link": "https://stackoverflow.com/questions/58050325/creating-a-service-client-in-fargate-task", "title": "Creating a service client in Fargate Task", "body": "<p>I am trying to build a service client within a Fargate task using a Task level IAM Role. </p>\n\n<p>Posts elsewhere suggest the TaskRole is part of the default credentials provider chain so the standard call to load credentials should work.</p>\n\n<p>Stripped down task code</p>\n\n<pre><code>import (\n\"fmt\"\n\"github.com/aws/aws-sdk-go-v2/aws/external\"\n\"github.com/aws/aws-sdk-go-v2/service/sns\"\n)\n\nfunc main() {\n    cfg, err := external.LoadDefaultAWSConfig()\n    if err != nil {\n        fmt.Println(\"failed to load config, \" + err.Error())\n    }\n    fmt.Printf(\"%+v\\n\", cfg )\n\n    client := sns.New(cfg)\n    fmt.Printf(\"%+v\\n\", client)\n}\n</code></pre>\n\n<p>Terraform Role and Policy definitions...</p>\n\n<p>TaskExecutions and TaskRole are essentially the same code albeit 2 blocks: (correct ??)</p>\n\n<pre><code>resource \"aws_iam_role\" \"++++++++++++\" {\n  name = \"++++++++++++++\"\n  assume_role_policy = &lt;&lt;EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n      \"Service\": [\n        \"ecs.amazonaws.com\",\n        \"ecs-tasks.amazonaws.com\"\n      ]\n     },\n    \"Effect\": \"Allow\",\n    \"Sid\": \"\"\n    }\n  ]\n}\nEOF\n}\n</code></pre>\n\n<p>Task execution Policy</p>\n\n<pre><code>resource \"aws_iam_policy\" \"ExecutionPolicy\" {\n  name = \"execution-policy\"\n  policy = &lt;&lt;EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n      {\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"ecr:GetAuthorizationToken\",\n            \"ecr:BatchCheckLayerAvailability\",\n            \"ecr:GetDownloadUrlForLayer\",\n            \"ecr:BatchGetImage\",\n            \"logs:CreateLogStream\",\n            \"logs:PutLogEvents\"\n          ],\n        \"Resource\": \"*\"\n      }\n  ]\n}\nEOF\n}\n</code></pre>\n\n<p>Task Role Policy</p>\n\n<pre><code>resource \"aws_iam_policy\" \"TaskPolicy\" {\n  name = \"task-policy\"\n  policy = &lt;&lt;EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n      {\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"logs:PutLogEvents\",\n            \"sns:Publish\"\n          ],\n        \"Resource\": \"*\"\n      }\n  ]\n}\nEOF\n}\n</code></pre>\n\n<p>Policies seem to be attached to the roles correctly and look ok on the console when the task is running.</p>\n\n<p>I would expect the task to load the configuration/credentials from the IAM task role from a search of the default credentials provider chain and create a client.</p>\n\n<p>However, the ONLY log result is :</p>\n\n<p><strong>standard_init_linux.go:190: exec user process caused \"no such file or directory\"</strong></p>\n\n<p>When I run other code <strong>without</strong> calls to other aws services the task executes correctly.</p>\n\n<p>What am I missing ?</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-go-client"], "answers": [{"comments": [{"owner": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "edited": false, "score": 0, "creation_date": 1569163266, "post_id": 58050134, "comment_id": 102498747, "body": "The problem is that I cannot place the <code>controllerList</code> shared scope because I am casting in each <code>case</code> the appropriate object."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "edited": false, "score": 0, "creation_date": 1569163674, "post_id": 58050134, "comment_id": 102498854, "body": "make <code>controllerList</code> a slice of type <code>[]interface{}</code> and deal with it"}, {"owner": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "edited": false, "score": 1, "creation_date": 1569225063, "post_id": 58050134, "comment_id": 102512900, "body": "I used <code>var controllerList []interface{}</code> and <code>var workloadItems interface{}</code> right after the firs <code>for</code> loop. It now recognize the <code>workloadItems</code>."}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": true, "score": 1, "last_activity_date": 1569162392, "creation_date": 1569162392, "answer_id": 58050134, "question_id": 58050052, "link": "https://stackoverflow.com/questions/58050052/how-to-resolve-reference-for-multiple-objects/58050134#58050134", "title": "How to resolve reference for multiple objects", "body": "<p>no. This happens because your variable <code>controllerList</code> is not declared in the right scope.</p>\n\n<p>it must be declared in the common scope shared by both the <code>for</code> loop and the <code>switch</code> statement, the parent scope, IE the <code>if controllerName != ...</code>.</p>\n\n<p>** Note that to post on SO you must NOT include screenshot of the code, but provide a minimal reproducible example of the code, copy &amp;&amp; pasted &amp;&amp; linted in your post. </p>\n"}], "owner": {"reputation": 6454, "user_id": 2153777, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/L67zf.jpg?s=128&g=1", "display_name": "E235", "link": "https://stackoverflow.com/users/2153777/e235"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 58050134, "answer_count": 1, "score": -1, "last_activity_date": 1569162392, "creation_date": 1569161770, "question_id": 58050052, "link": "https://stackoverflow.com/questions/58050052/how-to-resolve-reference-for-multiple-objects", "title": "How to resolve reference for multiple objects", "body": "<p>I am using the go-client library.<br>\nI am searching for mounted secrets inside the workload.<br>\nIn my example we have two workloads: <code>daemonset</code> and <code>deployments</code>.<br>\nAlthough both of them are different objects, they have similar structure:  </p>\n\n<pre><code>type DaemonSet struct {\n    metav1.TypeMeta `json:\",inline\"`\n    metav1.ObjectMeta `json:\"metadata,omitempty\" protobuf:\"bytes,1,opt,name=metadata\"`\n    Spec DaemonSetSpec `json:\"spec,omitempty\" protobuf:\"bytes,2,opt,name=spec\"`\n    Status DaemonSetStatus `json:\"status,omitempty\" protobuf:\"bytes,3,opt,name=status\"`\n}\n\n\ntype Deployment struct {\n    metav1.TypeMeta `json:\",inline\"`\n    metav1.ObjectMeta `json:\"metadata,omitempty\" protobuf:\"bytes,1,opt,name=metadata\"`\n    Spec DeploymentSpec `json:\"spec,omitempty\" protobuf:\"bytes,2,opt,name=spec\"`\n    Status DeploymentStatus `json:\"status,omitempty\" protobuf:\"bytes,3,opt,name=status\"`\n}\n</code></pre>\n\n<p>I am getting errors of:  </p>\n\n<blockquote>\n  <p>Unresolved reference   </p>\n</blockquote>\n\n<p>This happens because the compilation doesn't know what object I am referring to: <code>v1beta2.DaemonSetList</code> or <code>v1beta2.DeploymentList</code>.  </p>\n\n<p>How can I resolve it for both of them ?  </p>\n\n<p><a href=\"https://i.stack.imgur.com/gPhxH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gPhxH.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "go", "swig", "libraries"], "answers": [{"tags": [], "owner": {"reputation": 432, "user_id": 10369131, "user_type": "registered", "profile_image": "https://graph.facebook.com/834863476885527/picture?type=large", "display_name": "Anton", "link": "https://stackoverflow.com/users/10369131/anton"}, "is_accepted": true, "score": 2, "last_activity_date": 1569173552, "creation_date": 1569173552, "answer_id": 58051755, "question_id": 58049430, "link": "https://stackoverflow.com/questions/58049430/how-to-use-c-shared-library-in-go-code-with-the-help-of-swig/58051755#58051755", "title": "How to use C++ shared library in Go code with the help of SWIG?", "body": "<p>I managed to finally link the C++ shared library to my Go code by adding extra <strong>cgo</strong> compilation tags to the .go file produced by SWIG. This wasn't obvious thing to do as I thought SWIG didn't need any further adjustments after it was run. </p>\n\n<p>So the two lines of code that fix the issue are:</p>\n\n<pre><code>#cgo CFLAGS: -std=c99\n#cgo LDFLAGS: -L. -l:examplelib.so\n</code></pre>\n\n<p>LDFLAGS says to look for the library 'examplelib.so' in the current path. </p>\n"}], "owner": {"reputation": 432, "user_id": 10369131, "user_type": "registered", "profile_image": "https://graph.facebook.com/834863476885527/picture?type=large", "display_name": "Anton", "link": "https://stackoverflow.com/users/10369131/anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1287, "favorite_count": 1, "accepted_answer_id": 58051755, "answer_count": 1, "score": 2, "last_activity_date": 1569187904, "creation_date": 1569156928, "last_edit_date": 1569187904, "question_id": 58049430, "link": "https://stackoverflow.com/questions/58049430/how-to-use-c-shared-library-in-go-code-with-the-help-of-swig", "title": "How to use C++ shared library in Go code with the help of SWIG?", "body": "<p>I have a <strong>3rd party C++ .so library</strong> that I want to use in my <strong>Go code</strong>. I can make it work with plain C/C++, but fail to connect to Go.</p>\n\n<p>The library has a big header file and the function I need is declared in it like so (renamed for a simpler look):</p>\n\n<pre><code>typedef unsigned long (*INTERFACE_EXAMPLE_FUNC)(int example_var);\n#ifdef PC_STATIC_LIBS\nextern \"C\" unsigned long Example_func(int example_var);\n#endif //PC_STATIC_LIBS\n</code></pre>\n\n<p><em>(I assume it's easier to link a static lib, so I put #define PC_STATIC_LIBS on top of the header)</em></p>\n\n<p>I've spent many hours trying to link this library without SWIG, but <strong>cgo</strong> wouldn't parse the C++ header, giving me tons of error messages.\nSo, I'm trying to use SWIG now. Currently my swig interface file <strong>example.i</strong> looks as follows:</p>\n\n<pre><code>%module example\n %{\n #include \"libheader.h\"\n extern unsigned long Example_func(int example_var);\n %}\n extern unsigned long Example_func(int example_var);\n</code></pre>\n\n<p><strong>Steps I take:</strong></p>\n\n<ol>\n<li>run swig command: <code>swig -go -cgo -c++ -intgosize 64 -use-shlib -soname examplelib.so example.i</code></li>\n<li><code>go install</code></li>\n</ol>\n\n<p><strong>Results I get:</strong></p>\n\n<pre><code>/usr/bin/ld: $WORK/b001/_x003.o: in function `_wrap_Example_func_examplelib_8c0447b5964daffe':\n./examplelib_wrap.cxx:302: undefined reference to `Example_func'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>All the files that are being used are in the same directory. I also have a copy of the library placed in my /usr/local/lib and <code>ldconfig -p</code> shows it.</p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["javascript", "go", "jwt", "local-storage", "token"], "comments": [{"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1569152105, "post_id": 58048783, "comment_id": 102496245, "body": "You send a new token to the client and let them store it in local storage. Then for every request after session login, send a token along with the request to valdate identity. That&#39;s pretty much how its done"}, {"owner": {"reputation": 31, "user_id": 12070137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f2095f1603b08f40d60868ed9c2b31?s=128&d=identicon&r=PG&f=1", "display_name": "iuer ui", "link": "https://stackoverflow.com/users/12070137/iuer-ui"}, "reply_to_user": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1569152189, "post_id": 58048783, "comment_id": 102496268, "body": "it much work if we send the token every request :( , did u do that for your project ? @Nina"}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1569152321, "post_id": 58048783, "comment_id": 102496298, "body": "Yes. In the case of a client sending requests to a server, if an identity has to be proven then a token from local storage has to be sent back to the server. Otherwise the server does not know who is sending it."}], "answers": [{"tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": false, "score": 0, "last_activity_date": 1569159510, "creation_date": 1569159510, "answer_id": 58049748, "question_id": 58048783, "link": "https://stackoverflow.com/questions/58048783/refresh-token-local-storage-after-refreshed-on-server/58049748#58049748", "title": "refresh token local storage after refreshed on server", "body": "<p>I'm not sure if this helps or not but in many workflows it's the client driving the request.  If possible, it may help to simplify the problem:</p>\n\n<blockquote>\n  <p>The client needs a valid token to make a request</p>\n</blockquote>\n\n<p>If you're able to make this assumption then this can allow you to push the responsibility of token management to the client.  Then the server will reject ANY request with an invalid token and return unauthorized to the client.  This makes it the clients responsibility to re-auth or refresh by keeping track of token validity.</p>\n\n<p>This separates concerns so that the server doesn't need to have token management and refresh on each request.</p>\n\n<hr>\n\n<p>I'm basing this on Single Page Application Authentication workflows like described <a href=\"https://auth0.com/docs/architecture-scenarios/spa-api\" rel=\"nofollow noreferrer\">https://auth0.com/docs/architecture-scenarios/spa-api</a></p>\n"}], "owner": {"reputation": 31, "user_id": 12070137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f2095f1603b08f40d60868ed9c2b31?s=128&d=identicon&r=PG&f=1", "display_name": "iuer ui", "link": "https://stackoverflow.com/users/12070137/iuer-ui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569159510, "creation_date": 1569151901, "last_edit_date": 1569152255, "question_id": 58048783, "link": "https://stackoverflow.com/questions/58048783/refresh-token-local-storage-after-refreshed-on-server", "title": "refresh token local storage after refreshed on server", "body": "<p>How do you handle jwt token after it has expired?</p>\n\n<p>I really need to know what is the best thing to handle token in local storage,\nOn my server, if the token on header is expired, I refresh it, and the token in local storage will not updated after it refresh from server, \nI could think each respond after refresh token, I will set the token on each response then set it to local storage, for every request which need the token, but I am sure it is not efficient and too much work, right? \nwhat is the best practice to handle refresh token from server for client-side?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1569142336, "post_id": 58047521, "comment_id": 102494029, "body": "Hiya! One question per ... well... question. ;) As per your second question: It depends. UNIX has the following convention: no news are good news, and there is <a href=\"https://en.m.wikipedia.org/wiki/Exit_status\" rel=\"nofollow noreferrer\">an exit status</a>. So, in general: No message, no exit status and the call did not return yet? Still running."}, {"owner": {"reputation": 789, "user_id": 9077800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StzLv.jpg?s=128&g=1", "display_name": "aquiseb", "link": "https://stackoverflow.com/users/9077800/aquiseb"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1569143795, "post_id": 58047521, "comment_id": 102494354, "body": "@MarkusWMahlberg Thanks, I edited so there&#39;s only one question now ;) if no news good news, how can I know that A and B actually started and that&#39;s the reason why they gave no news?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1569145511, "post_id": 58047521, "comment_id": 102494703, "body": "As long as <code>Run</code> does not return, the processes run."}, {"owner": {"reputation": 789, "user_id": 9077800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StzLv.jpg?s=128&g=1", "display_name": "aquiseb", "link": "https://stackoverflow.com/users/9077800/aquiseb"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1569145865, "post_id": 58047521, "comment_id": 102494778, "body": "Based on your last comment, if I understand correctly, my question might have had to be &quot;how to ensure goroutines are called in a defined order?&quot; right? Because I always have C trying to start first..."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1569148227, "post_id": 58047521, "comment_id": 102495299, "body": "Sorta. Working on according code. But I am not sure... Are you actually trying to pipe the output of one command into the other and modify the second command&#39;s behavior based on the output of the first?"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1569148266, "post_id": 58047521, "comment_id": 102495309, "body": "C seems to start first because your synchronization mechanism are incorrect. this might worth to read <a href=\"https://medium.com/golangspec/synchronized-goroutines-part-i-4fbcdd64a4ec\" rel=\"nofollow noreferrer\">medium.com/golangspec/&hellip;</a>"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1569178951, "post_id": 58047521, "comment_id": 102503004, "body": "In case you are on a UNIX-ish system, you should not reinvent the wheel. You should rather compile your programs and use your shell for piping: <code>$ (micro-post; micro-hello) | micro-federation</code>. This way, <code>micro-post</code>, <code>micro-hello</code> and <code>micro-federation</code> can be kept <i>much</i> smaller and more concise, since they only have to deal with writing to stdout and reading from stdin, respectively."}], "answers": [{"comments": [{"owner": {"reputation": 789, "user_id": 9077800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StzLv.jpg?s=128&g=1", "display_name": "aquiseb", "link": "https://stackoverflow.com/users/9077800/aquiseb"}, "edited": false, "score": 0, "creation_date": 1569144666, "post_id": 58047806, "comment_id": 102494532, "body": "Thanks. The expectation is that A and B do run. Could pls you provide some code on  <code>consideration to the content being printed</code>, <code>keeping main from exiting</code>, <code>loop to collect results</code>, a less awkward chan signature example, a refactor of runModule that would be more consistent? As mentioned, I&#39;m a learning hobbyist and some code to accompany your explanation would be very helpful."}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": true, "score": 3, "last_activity_date": 1569185838, "last_edit_date": 1569185838, "creation_date": 1569143881, "answer_id": 58047806, "question_id": 58047521, "link": "https://stackoverflow.com/questions/58047521/ensure-two-commands-are-running-before-starting-a-third-one/58047806#58047806", "title": "Ensure two commands are running before starting a third one", "body": "<p>About process management</p>\n\n<p>Starting the process is the action of calling the binary path with its arguments. \nIt will fail if the bin path is not found, or some malformed arguments syntax is provided.</p>\n\n<p>As a consequence you might start a process with success, but receive an exit error because somehow its execution fails.</p>\n\n<p>Those details are important to figure out if you need only to startup the process to consider the operation as successful or dig further its state and/or output.</p>\n\n<p>In your code it appears you wait for the first line of stderr to be printed to consider it as started, without any consideration to the content being printed. </p>\n\n<p>It resemble more to a kind of sleeping time to ensure the process has initialized.</p>\n\n<p>Consider that starting the binary happens much faster in comparison to the execution of its bootstrap sequence.</p>\n\n<p>About the code, your exit rules are unclear. What is keeping main from exiting ?</p>\n\n<p>In the current code it will exit before C is executed when A and B has started (not anylising other cases)</p>\n\n<p>Your implementation of job concurrency in main is not standard. It is missing the loop to collect results, quit and close(chan).</p>\n\n<p>The chan signature is awkward, i would rather use a <code>struct {Module string, Err error}</code> </p>\n\n<p>The runModule function is buggy. It might close(o) while another routine might attempt to write it. If starts fails, you are not returning any error signal.</p>\n\n<p>A somewhat solution might look like this, consider it as being opinniated and depending the binary run other strategies can/should be implemented to detect error over the standard FDs.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"os/exec\"\n    \"strings\"\n    \"sync\"\n    \"time\"\n)\n\ntype cmd struct {\n    Module string\n    Cmd    string\n    Args   []string\n    Err    error\n}\n\nfunc main() {\n\n    torun := []cmd{\n        cmd{\n            Module: \"A\",\n            Cmd:    \"ping\",\n            Args:   []string{\"8.8.8.8\"},\n        },\n        cmd{\n            Module: \"B\",\n            Cmd:    \"ping\",\n            // Args:   []string{\"8.8.8.8.9\"},\n            Args: []string{\"8.8.8.8\"},\n        },\n    }\n\n    var wg sync.WaitGroup // use a waitgroup to ensure all concurrent jobs are done\n    wg.Add(len(torun))\n\n    out := make(chan cmd) // a channel to output cmd status\n\n    go func() {\n        wg.Wait()  //wait for the group to finish\n        close(out) //  then close the signal channel\n    }()\n\n    // start the commands\n    for _, c := range torun {\n        // go runCmd(c, out, &amp;wg)\n        go runCmdAndWaitForSomeOutput(c, out, &amp;wg)\n    }\n\n    // loop over the chan to collect errors\n    // it ends when wg.Wait unfreeze and closes out\n    for c := range out {\n        if c.Err != nil {\n            log.Fatalf(\"%v %v has failed with %v\", c.Cmd, c.Args, c.Err)\n        }\n    }\n\n    // here all commands started you can proceed further to run the last command\n    fmt.Println(\"all done\")\n    os.Exit(0)\n}\n\nfunc runCmd(o cmd, out chan cmd, wg *sync.WaitGroup) {\n    defer wg.Done()\n\n    cmd := exec.Command(o.Cmd, o.Args...)\n\n    if err := cmd.Start(); err != nil {\n        o.Err = err // save err\n        out &lt;- o    // signal completion error\n        return      // return to unfreeze the waitgroup wg\n    }\n    go cmd.Wait() // dont wait for command completion,\n    // consider its done once the program started with success.\n\n    // out &lt;- o // useless as main look ups only for error\n}\n\nfunc runCmdAndWaitForSomeOutput(o cmd, out chan cmd, wg *sync.WaitGroup) {\n    defer wg.Done()\n\n    cmd := exec.Command(o.Cmd, o.Args...)\n\n    stdout, err := cmd.StdoutPipe()\n    if err != nil {\n        o.Err = err // save err\n        out &lt;- o    // signal completion\n        return      // return to unfreeze the waitgroup wg\n    }\n    stderr, err := cmd.StderrPipe()\n    if err != nil {\n        o.Err = err\n        out &lt;- o\n        return\n    }\n\n    if err := cmd.Start(); err != nil {\n        o.Err = err\n        out &lt;- o\n        return\n    }\n\n    go cmd.Wait() // dont wait for command completion\n\n    // build a concurrent fd's scanner\n\n    outScan := make(chan error) // to signal errors detected on the fd\n\n    var wg2 sync.WaitGroup\n    wg2.Add(2) // the number of fds being watched\n\n    go func() {\n        defer wg2.Done()\n        sc := bufio.NewScanner(stdout)\n        for sc.Scan() {\n            line := sc.Text()\n            if strings.Contains(line, \"icmp_seq\") { // the OK marker\n                return // quit asap to unfreeze wg2\n            } else if strings.Contains(line, \"not known\") { // the nOK marker, if any...\n                outScan &lt;- fmt.Errorf(\"%v\", line)\n                return // quit  to unfreeze wg2\n            }\n        }\n    }()\n\n    go func() {\n        defer wg2.Done()\n        sc := bufio.NewScanner(stderr)\n        for sc.Scan() {\n            line := sc.Text()\n            if strings.Contains(line, \"icmp_seq\") { // the OK marker\n                return // quit asap to unfreeze wg2\n            } else if strings.Contains(line, \"not known\") { // the nOK marker, if any...\n                outScan &lt;- fmt.Errorf(\"%v\", line) // signal error\n                return                            // quit to unfreeze wg2\n            }\n        }\n    }()\n\n    go func() {\n        wg2.Wait() // consider that if the program does not output anything,\n        // or never prints ok/nok, this will block forever\n        close(outScan) // close the chan so the next loop is finite\n    }()\n\n    // - simple timeout less loop\n    // for err := range outScan {\n    //  if err != nil {\n    //      o.Err = err // save the execution error\n    //      out &lt;- o // signal the cmd\n    //      return // qui to unfreeze the wait group wg\n    //  }\n    // }\n\n    // - more complex version with timeout\n    timeout := time.After(time.Second * 3)\n    for {\n        select {\n        case err, ok := &lt;-outScan:\n            if !ok { // if !ok, outScan is closed and we should quit the loop\n                return\n            }\n            if err != nil {\n                o.Err = err // save the execution error\n                out &lt;- o    // signal the cmd\n                return      // quit to unfreeze the wait group wg\n            }\n        case &lt;-timeout:\n            o.Err = fmt.Errorf(\"timed out...%v\", timeout) // save the execution error\n            out &lt;- o                                      // signal the cmd\n            return                                        // quit to unfreeze the wait group wg\n        }\n    }\n\n    // exit and unfreeze the wait group wg\n}\n</code></pre>\n"}], "owner": {"reputation": 789, "user_id": 9077800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StzLv.jpg?s=128&g=1", "display_name": "aquiseb", "link": "https://stackoverflow.com/users/9077800/aquiseb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 58047806, "answer_count": 1, "score": 1, "last_activity_date": 1569185838, "creation_date": 1569141867, "last_edit_date": 1592644375, "question_id": 58047521, "link": "https://stackoverflow.com/questions/58047521/ensure-two-commands-are-running-before-starting-a-third-one", "title": "Ensure two commands are running before starting a third one", "body": "<p>I have three commands to run, but I'd like to make sure the two first are running before running the third one.</p>\n<p>Currently, it does run A and B then C.</p>\n<ol>\n<li>I run A and B in goroutines</li>\n<li>I communicate their name through <code>chan</code> if there's no <code>stderr</code></li>\n<li>the <code>main</code> functions pushes the names received through chan into a slice</li>\n<li>once the slice contains all names of module A and B it starts C</li>\n</ol>\n<p><strong>Some context</strong></p>\n<p>I'm in the process of learning goroutines and chan as a hobbyist. It's not clear to me how to output <code>exec.Command(&quot;foo&quot;, &quot;bar&quot;).Run()</code> in a reliable way while it's running. It's not clear either how to handle errors received by each process through chan.</p>\n<p>The reason why I need A and B to run before C is because A and B are graphql microservices, C needs them to run in order to get their schemas through HTTP and start doing some graphql federation (f.k.a. graphql stitching)</p>\n<p><strong>Inconsistencies</strong></p>\n<ul>\n<li>With my current approach, I will know if A and B are running only if they print something I guess.</li>\n<li>I don't like that each subsequent <code>stdout</code> will hit an if statement, just to know if the process is running.</li>\n<li>My error handling is not as clean as I'd like it to be.</li>\n</ul>\n<p><strong>Question</strong></p>\n<p>How could I have a more reliable way to ensure that A and B are running, event if they don't print anything and that they did not throw errors?</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;bufio&quot;\n    &quot;fmt&quot;\n    &quot;log&quot;\n    &quot;os/exec&quot;\n    &quot;reflect&quot;\n    &quot;sort&quot;\n    &quot;strings&quot;\n    &quot;sync&quot;\n)\n\nvar wg sync.WaitGroup\nvar modulesToRun = []string{&quot;micro-post&quot;, &quot;micro-hello&quot;}\n\nfunc main() {\n    // Send multiple values to chan\n    // https://stackoverflow.com/a/50857250/9077800\n    c := make(chan func() (string, error))\n\n    go runModule([]string{&quot;go&quot;, &quot;run&quot;, &quot;micro-post&quot;}, c)  // PROCESS A\n    go runModule([]string{&quot;go&quot;, &quot;run&quot;, &quot;micro-hello&quot;}, c) // PROCESS B\n\n    modulesRunning := []string{}\n    for {\n        msg, err := (&lt;-c)()\n        if err != nil {\n            log.Fatalln(err)\n        }\n\n        if strings.HasPrefix(msg, &quot;micro-&quot;) &amp;&amp; err == nil {\n            modulesRunning = append(modulesRunning, msg)\n            if CompareUnorderedSlices(modulesToRun, modulesRunning) {\n                go runModule([]string{&quot;go&quot;, &quot;run&quot;, &quot;micro-federation&quot;}, c) // PROCESS C\n            }\n        }\n    }\n\n}\n\nfunc runModule(commandArgs []string, o chan func() (string, error)) {\n    cmd := exec.Command(commandArgs[0], commandArgs[1], commandArgs[2]+&quot;/main.go&quot;)\n\n    // Less verbose solution to stream output with io?\n    // var stdBuffer bytes.Buffer\n    // mw := io.MultiWriter(os.Stdout, &amp;stdBuffer)\n    // cmd.Stdout = mw\n    // cmd.Stderr = mw\n\n    c := make(chan struct{})\n    wg.Add(1)\n\n    // Stream command output\n    // https://stackoverflow.com/a/38870609/9077800\n    go func(cmd *exec.Cmd, c chan struct{}) {\n        defer wg.Done()\n        stdout, err := cmd.StdoutPipe()\n        if err != nil {\n            close(o)\n            panic(err)\n        }\n\n        stderr, err := cmd.StderrPipe()\n        if err != nil {\n            close(o)\n            panic(err)\n        }\n\n        &lt;-c\n        outScanner := bufio.NewScanner(stdout)\n        for outScanner.Scan() {\n            m := outScanner.Text()\n            fmt.Println(commandArgs[2]+&quot;:&quot;, m)\n            o &lt;- (func() (string, error) { return commandArgs[2], nil })\n        }\n\n        errScanner := bufio.NewScanner(stderr)\n        for errScanner.Scan() {\n            m := errScanner.Text()\n            fmt.Println(commandArgs[2]+&quot;:&quot;, m)\n            o &lt;- (func() (string, error) { return &quot;bad&quot;, nil })\n        }\n    }(cmd, c)\n\n    c &lt;- struct{}{}\n    cmd.Start()\n\n    wg.Wait()\n    close(o)\n}\n\n// CompareUnorderedSlices orders slices before comparing them\nfunc CompareUnorderedSlices(a, b []string) bool {\n    if len(a) != len(b) {\n        return false\n    }\n\n    sort.Strings(a)\n    sort.Strings(b)\n\n    return reflect.DeepEqual(a, b)\n}\n</code></pre>\n"}, {"tags": ["go", "ssl"], "comments": [{"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1569130932, "post_id": 58046295, "comment_id": 102492148, "body": "Unfortunately the limited amount of detail you provide is not sufficient to answer your question. It might be that you are using a self-signed certificate and explicitly accepted it as trusted in the browser or imported it but that you did nothing like this for Postman. It might be that you are using a public certificate which should be trusted by Postman too but that you&#39;ve failed to provide the necessary chain certificates - browser often work around this problem but other applications don&#39;t."}, {"owner": {"reputation": 28441, "user_id": 27305, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/174ac998689321daaa7cfecf910522e4?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/27305/john"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1569131775, "post_id": 58046295, "comment_id": 102492270, "body": "Thanks for your feedback. I updated my question some more.  I&#39;m curious to learn what would typically be needed in teh chain of certificates?  If I recall, my process was create a CSR and Key, get CSR signed/approved by Sectigo, get a CRT file back.  I think that was my process..."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1569137572, "post_id": 58046295, "comment_id": 102493175, "body": "You usually do not get only the signed leaf certificate back but also any intermediate certificates. These MUST be provided to the client too so that it can build the trust chain to the local root certificate. See <a href=\"https://security.stackexchange.com/questions/56389/ssl-certificate-framework-101-how-does-the-browser-actually-verify-the-validity\">SSL Certificate framework 101: How does the browser actually verify the validity of a given server certificate?</a> for more details on how certificate validation works."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1569137749, "post_id": 58046295, "comment_id": 102493197, "body": "A valid chain consists of all certificates from the leaf up to but excluding the root certificate. You can check your configuration over at ssllabs: <a href=\"https://www.ssllabs.com/ssltest/\" rel=\"nofollow noreferrer\">ssllabs.com/ssltest</a> If it mentions &quot;extra download&quot; you&#39;re missing an intermediate."}, {"owner": {"reputation": 28441, "user_id": 27305, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/174ac998689321daaa7cfecf910522e4?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/27305/john"}, "edited": false, "score": 0, "creation_date": 1569162979, "post_id": 58046295, "comment_id": 102498660, "body": "Very helpful links!  I&#39;ve updated my question to say my <code>example.cert</code> seems to be a concatenation of several files, and that ssllabs.com doesn&#39;t seem to work on port 8001."}], "owner": {"reputation": 28441, "user_id": 27305, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/174ac998689321daaa7cfecf910522e4?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/27305/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569605335, "creation_date": 1569129975, "last_edit_date": 1569163718, "question_id": 58046295, "link": "https://stackoverflow.com/questions/58046295/verify-ssl-error-with-golang-http-server", "title": "Verify SSL Error with Golang http server?", "body": "<p>I have a golang project that provides some REST API endpoints over SSL.  I serve things over https with this line of code:</p>\n\n<pre><code>router := mux.NewRouter() // mux is from the gorilla mux library\n\nheadersOk := handlers.AllowedHeaders([]string{\"Accept\",\"Accept-Encoding\",\"Content-Length\",\"Content-Type\",\n  \"Authorization\",\"Organization\"})\noriginsOk := handlers.AllowedOrigins([]string{\"*\"})\nmethodsOk := handlers.AllowedMethods([]string{\"GET\", \"HEAD\", \"POST\", \"PUT\", \"DELETE\", \"OPTIONS\"})\n\n\nhttp.ListenAndServeTLS(\":8000\", \"path/to/example.cert\",\"path/to/example.com.key\",handlers.CORS(originsOk, headersOk, methodsOk)(router)\n</code></pre>\n\n<p>When I visit <code>https://example.com:8000/some-endpoint</code> with a web browser, everything loads up fine and I see a nice green lock icon in my address bar.  But when I try to connect to it with Postman software, Postman just says it can't get any response unless I disable \"Verify SSL\" in the settings.</p>\n\n<p>Is there something wrong with the way I initialize my golang http server?</p>\n\n<p><strong>Edit</strong>\nThe certificate I'm using is a commercial certificate verified by Sectigo Limited that supports wild card subdomains.  This API end point is actually in production usage and other people with ReactJS and Angular JS apps have successfully been consuming data from these end points.</p>\n\n<p><strong>Edit 2</strong>\nI reviewed my certificates.  I have several files.  My <code>/path/to/example.cert</code> is actually a concatenation of these files:</p>\n\n<ul>\n<li>example.com.ca-bundle</li>\n<li>example.com.crt</li>\n<li>example.com.csr</li>\n<li>example.com.key</li>\n</ul>\n\n<p>Between the each cert in the <code>/path/to/example.cert</code>, I do see something like:</p>\n\n<pre><code>-----END CERTIFICATE REQUEST-----^@^@^@^@^@^@.....example.com.key^@^@^@^@^@^@^@^@^@....-----BEGIN PRIVATE KEY-----\n</code></pre>\n\n<p>I'm not sure if those <code>^@^@^@^@^@</code> characters should be there?  I tried removing them and restarting my golang http server, but it didn't make any difference.</p>\n\n<p>When I tried to test my <code>https://example.com:8000</code> at <a href=\"https://www.ssllabs.com/ssltest/\" rel=\"nofollow noreferrer\">ssl labs</a>, it said port 8000 is not supported.  Most of REST APIs are hosted on the same domain but with different port numbers.</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1569122582, "post_id": 58045701, "comment_id": 102491194, "body": "<code>$1</code> style notation is useful if you want to send a parameter value once, but use it say in multiple places in a single query."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1569123741, "post_id": 58045701, "comment_id": 102491348, "body": "Executive summary: PostgreSQL uses numbered placeholders (<code>$1</code>, <code>$2</code>, ...) natively and the low level Go interfaces use the database&#39;s native placeholders."}], "owner": {"reputation": 846, "user_id": 6582127, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/ijqtr.png?s=128&g=1", "display_name": "Luis Cardoza Bird", "link": "https://stackoverflow.com/users/6582127/luis-cardoza-bird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "closed_date": 1569124110, "answer_count": 0, "score": 0, "last_activity_date": 1569339756, "creation_date": 1569121287, "last_edit_date": 1569339756, "question_id": 58045701, "link": "https://stackoverflow.com/questions/58045701/whats-the-difference-between-1-and-in-db-query", "closed_reason": "Duplicate", "title": "What&#39;s the difference between $1 and ? in db.query", "body": "<p>Can someone please explain me what is the difference between using</p>\n\n<blockquote>\n  <p>$1</p>\n</blockquote>\n\n<pre><code>query, err := b.Db.Prepare(\"SELECT id, name, owner, coordinates, reason_froggy FROM Business WHERE name ilike $1\")\n    if err != nil {\n        return business_list, err\n    }\n    rows, err := query.Query(\"%\" + business + \"%\")\n    if err != nil {\n        return business_list, err\n    }\n</code></pre>\n\n<p>and</p>\n\n<blockquote>\n  <p>?</p>\n</blockquote>\n\n<pre><code>query, err := b.Db.Prepare(\"SELECT id, name, owner, coordinates, reason_froggy FROM Business WHERE name ilike ?\")\n    if err != nil {\n        return business_list, err\n    }\n    rows, err := query.Query(\"%\" + business + \"%\")\n    if err != nil {\n        return business_list, err\n    }\n</code></pre>\n\n<p>are they're supposed to work the same way as an anon param, or they're different?</p>\n\n<p>Also the other thing is that with the <strong>$1</strong> param the query runs perfect, but with the <strong>?</strong> param the query returns a pg error in syntax.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 4, "creation_date": 1569108647, "post_id": 58044885, "comment_id": 102489735, "body": "<code>github.com&#47;user</code> is not a repository URI (it&#39;s your user account root, essentially), the repo is the next path down. GitHub&#39;s URI convention is <code>github.com&#47;{user-or-organization-name}&#47;{repo-name}</code>."}], "answers": [{"comments": [{"owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "edited": false, "score": 0, "creation_date": 1569109157, "post_id": 58044929, "comment_id": 102489805, "body": "I don&#39;t think I was confused by the flattened directories. I was confused by the git path convention of <code>github.com&#47;{user-or-organization-name}&#47;{repo-name}</code> in your comment above."}, {"owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "edited": false, "score": 0, "creation_date": 1569109208, "post_id": 58044929, "comment_id": 102489812, "body": "It probably didn&#39;t help that the article uses the word &quot;package&quot; when they should probably say &quot;repository&quot;, e.g.  &quot;Again, the first step is to choose a package path (we&#39;ll use github.com/user/stringutil) and create the package directory.&quot;"}, {"owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "edited": false, "score": 0, "creation_date": 1569109266, "post_id": 58044929, "comment_id": 102489817, "body": "Also, I still think the directory structure above should have a .git directory somewhere  below <code>user&#47;</code>."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "edited": false, "score": 0, "creation_date": 1569110960, "post_id": 58044929, "comment_id": 102489997, "body": "@learnJ12 you can have multiple packages in the same repository."}, {"owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "edited": false, "score": 0, "creation_date": 1569112089, "post_id": 58044929, "comment_id": 102490123, "body": "yes but in this case <code>stringutil</code> is the directory just below <code>user</code> so shouldn&#39;t it be considered the repository and not the package?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "edited": false, "score": 0, "creation_date": 1569130886, "post_id": 58044929, "comment_id": 102492140, "body": "@learnJ12 They are using &quot;package&quot; for a reason, and if they were to use &quot;repository&quot; instead <i>that</i> would be a mistake. Note that using repositories to hold your package(s) is optional, your package does <i>not</i> have to live in a folder that&#39;s associated to some vcs repo. Packages are part of the language spec, required by the compiler and essential for your code to work. The use of repositories on the other hand is but a convention, nothing will break if you don&#39;t utilize them."}, {"owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569164095, "post_id": 58044929, "comment_id": 102498964, "body": "@mkopriva The &quot;Overview&quot; section of the article says: &quot;A workspace contains many version control repositories. Each repository contains one or more packages.&quot; And in this case the &quot;hello&quot; package is in the path <code>src&#47;github.com&#47;user&#47;hello</code>. So you are saying that <code>hello</code> is a package not living in a repository, <code>github.com&#47;user</code> is here used as a namespace with no associated repository, and the convention specified in the Overview is in this case not used?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "edited": false, "score": 1, "creation_date": 1569165242, "post_id": 58044929, "comment_id": 102499243, "body": "@learnJ12 what I meant to say is that you can have a package live <i>anywhere</i> in the gopath&#39;s src directory, for example in <code>$GOPATH&#47;src&#47;hello</code> and you&#39;ll be able to import it using the path relative from <code>src</code>, i.e. <code>import &quot;hello&quot;</code>, or you can have your package in <code>$GOPATH&#47;src&#47;iam&#47;not&#47;github&#47;hello</code> and then you can import it with <code>import &quot;iam&#47;not&#47;github&#47;hello&quot;</code>. What&#39;s important is that your package lives somewhere in <code>$GOPATH&#47;src&#47;</code> it can be a repo but it doesn&#39;t have to be, it can containt <code>.git</code> but it doesn&#39;t have to."}, {"owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1569165657, "post_id": 58044929, "comment_id": 102499356, "body": "@mkopriva Thank you for the clarification. I think that I&#39;m getting it, but I do think it&#39;s a bit confusing in the documentation."}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": false, "score": 0, "last_activity_date": 1569109158, "last_edit_date": 1569109158, "creation_date": 1569108944, "answer_id": 58044929, "question_id": 58044885, "link": "https://stackoverflow.com/questions/58044885/am-i-correctly-confused-by-the-git-repository-structure-in-the-go-workspace-in-t/58044929#58044929", "title": "Am I correctly confused by the git repository structure in the Go workspace in the examples on &quot;How to Write Go Code&quot;?", "body": "<p>The documentation you linked to does not show directory trees accurately - they combine directory names together which means directories of the same depth don't necessarily appear to have the same depth.</p>\n\n<p>This is not the documentation being <em>wrong</em> - it's fairly common to flatten directory trees to avoid wasting screen-space (especially in Java projects where you'll have many directories all containing only a single subdirectory due to Java's file/package naming convention enforced by their compiler).</p>\n\n<p>The tree diagram after \"After issuing the above go get command, the workspace directory tree should now look like this:\" should really look like this:</p>\n\n<pre><code>bin/\n    hello                                   # command executable\nsrc/\n    github.com/\n        golang/\n            example/\n                .git/                       # \n                hello/\n                    hello.go                # \n                stringutil/                 #\n                    reverse.go              # \n                    reverse_test.go         # \n        user/\n            hello/                          # \"github.com/user/hello\" package repo root\n                hello.go                    # \n            stringutil/                     # \"stringutil\" package source root, but not a repo\n                reverse.go                  # \n                reverse_test.go             # test source\n</code></pre>\n\n<p>Note that <code>github.com/user</code> is described as a \"base path\" and not as a repository root or package path, but <code>github.com/user/hello</code> <em>is</em> described as a package root.</p>\n"}, {"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1569162135, "creation_date": 1569162135, "answer_id": 58050101, "question_id": 58044885, "link": "https://stackoverflow.com/questions/58044885/am-i-correctly-confused-by-the-git-repository-structure-in-the-go-workspace-in-t/58050101#58050101", "title": "Am I correctly confused by the git repository structure in the Go workspace in the examples on &quot;How to Write Go Code&quot;?", "body": "<blockquote>\n  <p>Should the repository have been initialized in the hello directory or one level up?</p>\n</blockquote>\n\n<p>assuming <code>hello</code> directory is the root of your project, and that you are using a Version Control System, yes.</p>\n\n<p>In the blog post, at <a href=\"https://golang.org/doc/code.html#Command\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html#Command</a>, yes, this directory is the root of the hello program/project, belonging to the namespace <code>github.com/user/</code>. As a consequence, and because this demo uses a VCS, currently <code>git</code>, yes it contains a <code>.git</code> directory.</p>\n\n<blockquote>\n  <p>Should the final repository show a .git directory?</p>\n</blockquote>\n\n<p>If this <strong>is</strong> a <strong>repository</strong> then yes, it contains a <code>.git</code>, or alike, directory to store metadatas of the VCS.</p>\n\n<p>Although, having a repository, ie a directory managed by a VCS, is not mandatory to run go programs.</p>\n\n<p>It is a requirement you have when you want to navigate over history, and / or save multiple state of a program, and / or write and share your code with other people.</p>\n\n<p>In enterprise environment it is required (99.999999%, there must be some fools, we are only humans).</p>\n"}, {"comments": [{"owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "edited": false, "score": 0, "creation_date": 1569164386, "post_id": 58050398, "comment_id": 102499026, "body": "I think this is the correct answer. In this case, <code>hello</code> is both a &quot;repository&quot; and a &quot;package&quot;. As an aside, I still think there should be a <code>.git</code> directory shown in the final workspace hierarchy."}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 2, "last_activity_date": 1569164271, "creation_date": 1569164271, "answer_id": 58050398, "question_id": 58044885, "link": "https://stackoverflow.com/questions/58044885/am-i-correctly-confused-by-the-git-repository-structure-in-the-go-workspace-in-t/58050398#58050398", "title": "Am I correctly confused by the git repository structure in the Go workspace in the examples on &quot;How to Write Go Code&quot;?", "body": "<blockquote>\n  <p>Since <code>github.com/user</code> is the repository and <code>hello</code> is the package, it seems like the <code>git init</code> should be done at the level of <code>github.com/user</code>.</p>\n</blockquote>\n\n<p>No it isn't. <code>github.com/user</code> is a github user. Users have repositories, such as <code>github.com/user/hello</code>. A repository can hold one or more go packages, including one which may be at the top level of the repository, and have the same name as the repository.</p>\n"}], "owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1569164271, "creation_date": 1569108454, "question_id": 58044885, "link": "https://stackoverflow.com/questions/58044885/am-i-correctly-confused-by-the-git-repository-structure-in-the-go-workspace-in-t", "title": "Am I correctly confused by the git repository structure in the Go workspace in the examples on &quot;How to Write Go Code&quot;?", "body": "<p>I have 2 points of confusion about the <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a> article. They may be mistakes in the article, or I may just be missing the point. In describing the structure of the typical workspace, the article says </p>\n\n<blockquote>\n  <p>The src subdirectory typically contains multiple version control repositories (such as for Git or Mercurial) that track the development of one or more source packages.</p>\n</blockquote>\n\n<p>The first example workspace in the article matches this description, with 2 folders representing repositories (<code>github.com/golang/example/</code> and <code>golang.org/x/image/</code>), each of which has a .git directory immediately below it.</p>\n\n<p>Later, the article says:</p>\n\n<blockquote>\n  <p>If you're using a source control system, now would be a good time to initialize a repository, add the files, and commit your first change. Again, this step is optional: you do not need to use source control to write Go code.</p>\n</blockquote>\n\n<p>Then the article shows example code running <code>git init</code> in the <code>src/github.com/user/hello/</code> directory. This is point of confusion #1. Since <code>github.com/user</code> is the repository and <code>hello</code> is the package, it seems like the <code>git init</code> should be done at the level of <code>github.com/user</code>.</p>\n\n<p>Point of confusion #2 comes near the end of the article, when it says:</p>\n\n<blockquote>\n  <p>After issuing the above go get command, the workspace directory tree should now look like this:</p>\n</blockquote>\n\n<p>It then shows another example repository, which has a <code>.git</code> directory under the <code>github.com/golang/example/</code> directory, but none under the <code>github.com/user/</code> directory, either right below it or in the <code>hello</code> package where it was initialized earlier.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li>Should the repository have been initialized in the <code>hello</code> directory or one level up?</li>\n<li>Should the final repository show a <code>.git</code> directory?</li>\n</ol>\n"}, {"tags": ["ubuntu", "go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569162894, "post_id": 58044793, "comment_id": 102498633, "body": "it looks likes a broken install. Please add output of <code>go version</code>, <code>go env</code>, <code>lsb_release -a</code>. Note that <code>go tet</code> is not a valid command. Did you mean <code>go teSt</code> ?"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569168743, "post_id": 58044793, "comment_id": 102500163, "body": "Yes -- go test!"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569168888, "post_id": 58044793, "comment_id": 102500189, "body": "go version go1.12.9 linux/amd64"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569169015, "post_id": 58044793, "comment_id": 102500213, "body": "NEPTUNE:~$go env GOARCH=&quot;amd64&quot; GOBIN=&quot;=/home/thornton/GO_WorkSpace/bin&quot; GOCACHE=&quot;/home/thornton/.cache/go-build&quot; GOEXE=&quot;&quot;"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569169058, "post_id": 58044793, "comment_id": 102500226, "body": "GOFLAGS=&quot;&quot; GOHOSTARCH=&quot;amd64&quot; GOHOSTOS=&quot;linux&quot; GOOS=&quot;linux&quot; GOPATH=&quot;/home/thornton/GO_WorkSpace&quot;"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569169093, "post_id": 58044793, "comment_id": 102500237, "body": "GOPROXY=&quot;&quot; GORACE=&quot;&quot; GOROOT=&quot;/home/thornton/go&quot; GOTMPDIR=&quot;&quot; GOTOOLDIR=&quot;/home/thornton/go/pkg/tool/linux_amd64&quot; GCCGO=&quot;gccgo&quot;"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569169122, "post_id": 58044793, "comment_id": 102500249, "body": "CC=&quot;gcc&quot; CXX=&quot;g++&quot; CGO_ENABLED=&quot;1&quot; GOMOD=&quot;&quot; CGO_CFLAGS=&quot;-g -O2&quot; CGO_CPPFLAGS=&quot;&quot; CGO_CXXFLAGS=&quot;-g -O2&quot; CGO_FFLAGS=&quot;-g -O2&quot;"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569169200, "post_id": 58044793, "comment_id": 102500270, "body": "CGO_LDFLAGS=&quot;-g -O2&quot; PKG_CONFIG=&quot;pkg-config&quot; GOGCCFLAGS=&quot;-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build315039382=/tmp/go-build -gno-record-gcc-switches&quot; NEPTUNE:~$lsb_release"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569169222, "post_id": 58044793, "comment_id": 102500278, "body": "No LSB modules are available. NEPTUNE:~$GOPROXY=&quot;&quot; NEPTUNE:~$GORACE=&quot;&quot; NEPTUNE:~$GOROOT=&quot;/home/thornton/go&quot; NEPTUNE:~$GOTMPDIR=&quot;&quot; NEPTUNE:~$GOTOOLDIR=&quot;/home/thornton/go/pkg/tool/linux_amd64&quot; NEPTUNE:~$GCCGO=&quot;gccgo&quot;"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569169316, "post_id": 58044793, "comment_id": 102500304, "body": "NEPTUNE:~$lsb_release -a No LSB modules are available.                                                             Distributor ID: Ubuntu Description:    Ubuntu 18.04.2 LTS Release:        18.04 Codename:       bionic"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569169453, "post_id": 58044793, "comment_id": 102500349, "body": "I will check hourly if you need more info - This is for work and failure is not acceptable"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569170321, "post_id": 58044793, "comment_id": 102500601, "body": "you can just edit your post."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569170892, "post_id": 58044793, "comment_id": 102500757, "body": "have you followed this wiki to install golang ? <a href=\"https://github.com/golang/go/wiki/Ubuntu\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/Ubuntu</a>"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569255703, "post_id": 58044793, "comment_id": 102529166, "body": "yes - downloaded 1.13 and installed in /usr/local."}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569255741, "post_id": 58044793, "comment_id": 102529181, "body": "One problem:   Version in go dir 1.13"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569255806, "post_id": 58044793, "comment_id": 102529217, "body": "entering &quot;go version&quot; we get 1.12.9??"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569255838, "post_id": 58044793, "comment_id": 102529233, "body": "Any secret you wish to lay on me."}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569255964, "post_id": 58044793, "comment_id": 102529286, "body": "I just looked at your reference, it is different than the one I used which used tar to install - Will try your method"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1569257147, "post_id": 58044793, "comment_id": 102529781, "body": "have you configured the PATH variable ? If yes, share its output (edit your initial post)."}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "is_accepted": false, "score": 0, "last_activity_date": 1569368280, "creation_date": 1569368280, "answer_id": 58089338, "question_id": 58044793, "link": "https://stackoverflow.com/questions/58044793/go-1-13-has-go-tools-version-12-9/58089338#58089338", "title": "go 1.13 has go tools version 12.9", "body": "<p>I have solved the problem by removing all traces of previous\ngo installations and reinstalling.</p>\n\n<p>Thank you for you answers</p>\n"}, {"tags": [], "owner": {"reputation": 1266, "user_id": 8035711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54251e31927388d864e8f2fc49fdce27?s=128&d=identicon&r=PG", "display_name": "keser", "link": "https://stackoverflow.com/users/8035711/keser"}, "is_accepted": false, "score": 0, "last_activity_date": 1593504099, "creation_date": 1593504099, "answer_id": 62652837, "question_id": 58044793, "link": "https://stackoverflow.com/questions/58044793/go-1-13-has-go-tools-version-12-9/62652837#62652837", "title": "go 1.13 has go tools version 12.9", "body": "<p>maybe its me but, after i find versions with :</p>\n<p><code>$ where go</code></p>\n<p>and removed the ones from older versions, this issue emerged</p>\n<pre><code># vendor/golang.org/x/crypto/internal/subtle\ncompile: version &quot;go1.13.3&quot; does not match go tool version &quot;go1.14.4&quot;\n# vendor/golang.org/x/crypto/curve25519\ncompile: version &quot;go1.13.3&quot; does not match go tool version &quot;go1.14.4&quot;\n# runtime/cgo\ncompile: version &quot;go1.13.3&quot; does not match go tool version &quot;go1.14.4&quot;\n</code></pre>\n<p>First I removed go again with brew too</p>\n<pre><code>$ brew uninstall --ignore-dependencies go\n</code></pre>\n<ul>\n<li>Then I checked my path in <code>.bashrc</code> and sourced it again anyways.</li>\n</ul>\n<p>It didn't solve neither.</p>\n<ul>\n<li>Finally I restarted my Terminal and it started working.</li>\n</ul>\n<p>I don't know which ones were required but I can't reproduce the error. You can try all of them. If none works, maybe restart your machine as well</p>\n"}], "owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1275, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593504099, "creation_date": 1569107330, "last_edit_date": 1569170918, "question_id": 58044793, "link": "https://stackoverflow.com/questions/58044793/go-1-13-has-go-tools-version-12-9", "title": "go 1.13 has go tools version 12.9", "body": "<p>I created the dir <strong>TEST-13</strong> under <strong>GOPATH/src</strong> </p>\n\n<p>I installed <strong>hello.go</strong> and <strong>hello_test.go</strong> (the specified test code files)</p>\n\n<p>Is there a reason that in version 1.13 running <strong>go mod init</strong>\nproduces the following go.mod:</p>\n\n<pre><code>module TEST-13\n\ngo 1.12\n</code></pre>\n\n<p>Running <strong>go tet</strong> in the directory gets errors - See example:</p>\n\n<pre><code>compile: version \"go1.13\" does not match go tool version \"go1.12.9\"\n</code></pre>\n\n<p>This message produces 7 similar messages for various library modules</p>\n\n<p>How do I fix this - or is it a release error? - or did I mess up the install?</p>\n"}, {"tags": ["go", "github"], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 2, "last_activity_date": 1569104924, "creation_date": 1569104924, "answer_id": 58044592, "question_id": 58044538, "link": "https://stackoverflow.com/questions/58044538/changes-in-github-fork-not-being-imported/58044592#58044592", "title": "Changes in Github fork not being imported", "body": "<p>You can use a replace statement in go.mod:</p>\n\n<pre><code>replace original =&gt; fork\n</code></pre>\n\n<p>This should make references to the original repo in the forked source lookup from the forked repo.</p>\n"}], "owner": {"reputation": 208, "user_id": 3614985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ssU7L.jpg?s=128&g=1", "display_name": "Try431", "link": "https://stackoverflow.com/users/3614985/try431"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58044592, "answer_count": 1, "score": -1, "last_activity_date": 1569104924, "creation_date": 1569104223, "last_edit_date": 1592644375, "question_id": 58044538, "link": "https://stackoverflow.com/questions/58044538/changes-in-github-fork-not-being-imported", "title": "Changes in Github fork not being imported", "body": "<p>I'm writing a MIDI parser that splits apart MIDI files and adjusts the volume on different tracks to allow for specific voice isolation to help practicing. I'm using a Go library, <a href=\"https://github.com/algoGuy/EasyMIDI\" rel=\"nofollow noreferrer\">EasyMIDI</a>. However, I ran into a use case that the library didn't cover, so I forked the repo and made changes that should fix my issues in the short term.</p>\n<p>I'm able to successfully build when using my forked Github URL in my <code>go.mod</code> and import statements, but the code changes I made aren't being reflected. I added the function <code>GetChannel()</code> to an interface, and so should see it listed as an option. When I click into the source for another function that was originally implemented, I see that my VSCode is referencing the non-forked repo when grabbing the code (see screen snippet below).</p>\n<p><a href=\"https://i.stack.imgur.com/FdycX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FdycX.png\" alt=\"VSCode Screen Snippet\" /></a></p>\n<p>As you can see on the left, there is no <code>GetChannel()</code> function. If I click on &quot;algo!guy&quot; and select &quot;!try431&quot;, I do see the changes I made and pushed to my fork. How do I get my code to recognize that I want my forked repo so I can get access to these changes I've made?</p>\n<p>Edit: Thought I might as well throw in the <code>go.mod</code> and <code>go.sum</code> files that are generated upon a <code>go build</code>.</p>\n<p><strong>go.mod</strong></p>\n<pre><code>module github.com/Try431/acc-midi-splitter\n\ngo 1.12\n\nrequire github.com/Try431/EasyMIDI v0.0.0-20190921213858-238fe2946087\n</code></pre>\n<p><strong>go.sum</strong></p>\n<pre><code>github.com/Try431/EasyMIDI v0.0.0-20190921213858-238fe2946087 h1:dXDwjgIHMgL4zow9ixgTslZ3cWZHHIu3+FurDjDC6wA=\ngithub.com/Try431/EasyMIDI v0.0.0-20190921213858-238fe2946087/go.mod h1:c/dd/WkUR9yfzjC9sPO9J0vh5TzTmE8ryAvEviTDwgg=\ngithub.com/algoGuy/EasyMIDI v0.0.0-20180322051653-708ca39e7399 h1:f0h3xTKQjrTzAUwqMJr1TY3lk3gTK8R4v7ZjcSMiwm8=\ngithub.com/algoGuy/EasyMIDI v0.0.0-20180322051653-708ca39e7399/go.mod h1:z6svyEeOasADFxg4gn6funK2OBjocr62B4J7ZPodCPs=\n</code></pre>\n<p>I've tried deleting the algoGuy lines in the <code>go.sum</code>, but obviously the lines are put back on a <code>go build</code>.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-dynamodb", "aws-sam-cli", "amazon-dynamodb-local"], "answers": [{"tags": [], "owner": {"reputation": 1719, "user_id": 1552953, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ca2f2c9f96dccf58079fee9ac2880f68?s=128&d=identicon&r=PG", "display_name": "James Burke", "link": "https://stackoverflow.com/users/1552953/james-burke"}, "is_accepted": false, "score": 0, "last_activity_date": 1569136226, "creation_date": 1569136226, "answer_id": 58046913, "question_id": 58043482, "link": "https://stackoverflow.com/questions/58043482/timing-out-while-trying-to-access-dynamodb-locally/58046913#58046913", "title": "Timing out while trying to access DynamoDB locally", "body": "<p>For some reason SAM lambdas aren't able to connect to localhost DynamoDB, so you need to create a loopback IP address that they reference to access it.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>ifconfig lo0 alias 172.16.123.1\n</code></pre>\n\n<p>Then update your session configuration to:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>sess, err := session.NewSessionWithOptions(session.Options{\n    // Provide SDK Config options, such as Region.\n    Config: aws.Config{\n        Endpoint: aws.String(\"http://172.16.123.1:8000/\"),\n        Region:   aws.String(\"eu-central-1\"),\n    },\n})\nif err != nil {\n    logger.Println(err)\n    return nil\n}\n</code></pre>\n\n<p><a href=\"https://github.com/awslabs/aws-sam-cli/issues/102#issuecomment-326177151\" rel=\"nofollow noreferrer\">https://github.com/awslabs/aws-sam-cli/issues/102#issuecomment-326177151</a></p>\n"}], "owner": {"reputation": 1719, "user_id": 1552953, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ca2f2c9f96dccf58079fee9ac2880f68?s=128&d=identicon&r=PG", "display_name": "James Burke", "link": "https://stackoverflow.com/users/1552953/james-burke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 400, "favorite_count": 0, "closed_date": 1569140578, "answer_count": 1, "score": 0, "last_activity_date": 1569136226, "creation_date": 1569094288, "question_id": 58043482, "link": "https://stackoverflow.com/questions/58043482/timing-out-while-trying-to-access-dynamodb-locally", "closed_reason": "Duplicate", "title": "Timing out while trying to access DynamoDB locally", "body": "<p>I can access DynamoDB on AWS with my code. I can access the local DynamoDB with CLI. But I can't get the two to talk to each other.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code># deploying dynamodb\ndocker run \\\n    --detach \\\n    --tty \\\n    --interactive \\\n    --publish 8000:8000 \\\n    --name lokal_dynamodb amazon/dynamodb-local\n\n# deploying Go with SAM\nsam local start-api \\\n    --template sam/template.yaml \\\n    --region eu-central-1 \\\n    --profile default\n\n</code></pre>\n\n<p>Creating a session</p>\n\n<pre><code>sess, err := session.NewSessionWithOptions(session.Options{\n    // Provide SDK Config options, such as Region.\n    Config: aws.Config{\n        Endpoint: aws.String(\"http://localhost:8000/\"),\n        Region:   aws.String(\"eu-central-1\"),\n    },\n})\nif err != nil {\n    logger.Println(err)\n    return nil\n}\n</code></pre>\n\n<p>Error returned</p>\n\n<pre><code>unction 'ShopFunction' timed out after 20 seconds\nFunction returned an invalid response (must include one of: body, headers, multiValueHeaders or statusCode in the response object). Response received: \n2019-09-21 21:22:03 127.0.0.1 - - [21/Sep/2019 21:22:03] \"GET /shop/f10b7ab5-9508-4cfd-acb2-efb2299dd460 HTTP/1.1\" 502 -\n</code></pre>\n"}, {"tags": ["go", "flatbuffers"], "answers": [{"tags": [], "owner": {"reputation": 4578, "user_id": 17419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JU9iE.jpg?s=128&g=1", "display_name": "Aardappel", "link": "https://stackoverflow.com/users/17419/aardappel"}, "is_accepted": true, "score": 1, "last_activity_date": 1569092773, "creation_date": 1569092773, "answer_id": 58043293, "question_id": 58042846, "link": "https://stackoverflow.com/questions/58042846/is-there-a-simpler-way-to-serialize-byte-with-flatbuffers/58043293#58043293", "title": "Is there a simpler way to serialize [][]byte with FlatBuffers?", "body": "<p>The first 2 for loops can be merged: you can create the byte vector, followed by the table holding it. You just can't nest the byte vector between Start/End.</p>\n\n<p>For the last for loop there really should be a helper function doing this for you (they exist for other languages). If there's none in Go, create an issue (or better yet, a PR) on the FlatBuffers repo.</p>\n"}], "owner": {"reputation": 136, "user_id": 1120148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a50efc32c17fb182d769c6d8e0ea59?s=128&d=identicon&r=PG", "display_name": "Absurdev", "link": "https://stackoverflow.com/users/1120148/absurdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 58043293, "answer_count": 1, "score": 0, "last_activity_date": 1569092773, "creation_date": 1569089078, "question_id": 58042846, "link": "https://stackoverflow.com/questions/58042846/is-there-a-simpler-way-to-serialize-byte-with-flatbuffers", "title": "Is there a simpler way to serialize [][]byte with FlatBuffers?", "body": "<p>I am looking to serialize a <code>[][]byte</code> message with FlatBuffers. Given than FBS Vectors cannot be nested it seems that this is the way to go:</p>\n\n<pre><code>namespace msgfbs;\n\ntable SubmitMessage {\n  nonces:[Nonce];\n}\n\ntable Nonce {\n  bytes:[ubyte];\n}\n</code></pre>\n\n<p>Now to write this structure I ended up writing this function:</p>\n\n<pre><code>func NewSubmitMessage(builder *fbs.Builder, nonces [][]byte) []byte {\n    builder.Reset()\n\n    nonceCount := len(nonces)\n\n    // Convert nonces to byte vectors\n    byteVectors := make([]fbs.UOffsetT, nonceCount)\n    for i, nonce := range nonces {\n        byteVectors[i] = builder.CreateByteVector(nonce)\n    }\n\n    // Create FBS Nonces\n    noncesFbs := make([]fbs.UOffsetT, nonceCount)\n    for i := range nonces {\n        msgfbs.NonceStart(builder)\n        msgfbs.NonceAddBytes(builder, byteVectors[i])\n        noncesFbs[i] = msgfbs.NonceEnd(builder)\n    }\n\n    // Create vector of FBS Nonces\n    msgfbs.SubmitMessageStartNoncesVector(builder, nonceCount)\n    for i := nonceCount - 1; i &gt;= 0; i-- {\n        builder.PrependUOffsetT(noncesFbs[i])\n    }\n    noncesVector := builder.EndVector(nonceCount)\n\n    // Create message\n    msgfbs.SubmitMessageStart(builder)\n    msgfbs.SubmitMessageAddNonces(builder, noncesVector)\n    builder.Finish(msgfbs.SubmitMessageEnd(builder))\n    builder.PrependByte(Submit)\n\n    return builder.FinishedBytes()\n}\n</code></pre>\n\n<p>I need 3 consecutive for-loop before finally wrapping up my message. Is this the simplest way to serialize a <code>[][]byte</code>? Is there a more efficient way to achieve the same?</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 9139691, "user_type": "registered", "profile_image": "https://graph.facebook.com/1741000322585477/picture?type=large", "display_name": "Rob Ert", "link": "https://stackoverflow.com/users/9139691/rob-ert"}, "edited": false, "score": 0, "creation_date": 1569167523, "post_id": 58042948, "comment_id": 102499878, "body": "I verified this one and it&#39;s not working. But unfortunately, it should due to documentation. Thanks"}], "tags": [], "owner": {"reputation": 65, "user_id": 4586561, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-VkNxFONF0gU/AAAAAAAAAAI/AAAAAAAAAEU/t7lUo5IxN5Y/photo.jpg?sz=128", "display_name": "NinjaCode", "link": "https://stackoverflow.com/users/4586561/ninjacode"}, "is_accepted": false, "score": 0, "last_activity_date": 1569089865, "creation_date": 1569089865, "answer_id": 58042948, "question_id": 58042335, "link": "https://stackoverflow.com/questions/58042335/gorm-doesnt-create-foreignkey-column/58042948#58042948", "title": "GORM doesn&#39;t create ForeignKey column", "body": "<p>try to edit your struct like this :</p>\n\n<pre><code>// TripKeyPoint models\ntype TripKeyPoint struct {\n    gorm.Model\n    KPName        string\n    KPDescription string\n    TripID        Trip `gorm:\"foreignkey:TripId\"`\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 361, "user_id": 10195610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4MxN.jpg?s=128&g=1", "display_name": "HammoTime", "link": "https://stackoverflow.com/users/10195610/hammotime"}, "edited": false, "score": 1, "creation_date": 1592740657, "post_id": 58046475, "comment_id": 110526885, "body": "You are a legend, have been trying to figure this out for the last hour. Thanks!"}, {"owner": {"reputation": 103, "user_id": 7053271, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/971fe1cb95fe98e8c6bffb3040bc3511?s=128&d=identicon&r=PG&f=1", "display_name": "isht3", "link": "https://stackoverflow.com/users/7053271/isht3"}, "edited": false, "score": 1, "creation_date": 1599749761, "post_id": 58046475, "comment_id": 112876340, "body": "How would you create a list of foreign keys using this paradigm?"}], "tags": [], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "is_accepted": true, "score": 3, "last_activity_date": 1569135091, "last_edit_date": 1569135091, "creation_date": 1569132204, "answer_id": 58046475, "question_id": 58042335, "link": "https://stackoverflow.com/questions/58042335/gorm-doesnt-create-foreignkey-column/58046475#58046475", "title": "GORM doesn&#39;t create ForeignKey column", "body": "<p>I explicitly define foreign key column:</p>\n\n<pre><code>// TripKeyPoint models\ntype TripKeyPoint struct {\n    gorm.Model\n    KPName        string\n    KPDescription string\n    TripID        uint `gorm:\"TYPE:integer REFERENCES trips\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 9139691, "user_type": "registered", "profile_image": "https://graph.facebook.com/1741000322585477/picture?type=large", "display_name": "Rob Ert", "link": "https://stackoverflow.com/users/9139691/rob-ert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1437, "favorite_count": 0, "accepted_answer_id": 58046475, "answer_count": 2, "score": 2, "last_activity_date": 1569135091, "creation_date": 1569084949, "last_edit_date": 1569085344, "question_id": 58042335, "link": "https://stackoverflow.com/questions/58042335/gorm-doesnt-create-foreignkey-column", "title": "GORM doesn&#39;t create ForeignKey column", "body": "<p>I'm trying to setup relation between two models on PostgreSQL database using Go and gorm.</p>\n\n<p>Here is my code, first model:</p>\n\n<h3>Trip.go</h3>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package model\n\nimport \"github.com/jinzhu/gorm\"\n\n// Trip models\ntype Trip struct {\n    gorm.Model\n    TripName        string\n    TripDescription string\n}\n\n</code></pre>\n\n<p>Second model:</p>\n\n<h3>TripKeyPoints.go</h3>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package model\n\nimport \"github.com/jinzhu/gorm\"\n\n// TripKeyPoint models\ntype TripKeyPoint struct {\n    gorm.Model\n    KPName        string\n    KPDescription string\n    TripID        Trip\n}\n</code></pre>\n\n<p>Part of code from a file which runs migrations and initializes all</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    db.DropTableIfExists(&amp;User{}, &amp;model.Trip{}, &amp;model.TripKeyPoint{})\n    db.AutoMigrate(&amp;User{}, &amp;model.Trip{}, &amp;model.TripKeyPoint{})\n    db.Model(&amp;model.TripKeyPoint{}).AddForeignKey(\"trip_id\", \"trips(id)\", \"CASCADE\", \"CASCADE\")\n</code></pre>\n\n<p>Users models is just an addon but I leave it in this snippet.\nDue to many tests, I drop tables at the beginning.</p>\n\n<p>Here is what I receive when i run the code:</p>\n\n<pre><code>?[35m(C:/golang_lab/golang-gorm-tutorial/users.go:36)?[0m\n?[33m[2019-09-21 18:40:34]?[0m ?[31;1m pq: column \"trip_id\" referenced in foreign key constraint does not exist ?[0m\n</code></pre>\n\n<p>And yeah that's true, when I log into postgres in table trip_key_points there isn't column with a foreign key. </p>\n\n<p>What I need to do, I want to have one TRIP object and then assign other TripKeyPoints.</p>\n\n<p>Any idea what why? Or how can I force GORM to create this column?</p>\n"}, {"tags": ["docker", "vue.js", "go", "grpc", "envoyproxy"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1569102401, "post_id": 58042084, "comment_id": 102488906, "body": "Have you done integration tests? You sure your grpc works correctly?"}, {"owner": {"reputation": 195, "user_id": 8484805, "user_type": "registered", "profile_image": "https://graph.facebook.com/1646240402077569/picture?type=large", "display_name": "Jon Nimrod", "link": "https://stackoverflow.com/users/8484805/jon-nimrod"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1569103937, "post_id": 58042084, "comment_id": 102489109, "body": "Well it works perfectly on Linux, I only have this issue on mac."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1569141241, "post_id": 58042084, "comment_id": 102493811, "body": "I prolly would check the firewall. Other than that... <i>shrugs</i>"}], "owner": {"reputation": 195, "user_id": 8484805, "user_type": "registered", "profile_image": "https://graph.facebook.com/1646240402077569/picture?type=large", "display_name": "Jon Nimrod", "link": "https://stackoverflow.com/users/8484805/jon-nimrod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569083501, "creation_date": 1569082978, "last_edit_date": 1569083501, "question_id": 58042084, "link": "https://stackoverflow.com/questions/58042084/vuejs-client-cant-communicate-with-go-backend-via-grpc-on-macos", "title": "Vuejs client can&#39;t communicate with Go backend via gRPC on MacOS", "body": "<p>I built a simple web app with a VueJS front (client) and a Go back (server), using gRPC and protobuf.\nIn order to communicate, an envoy proxy has to be set up between them to convert web client HTTP/1.1 to HTTP/2.\nI have no issue deploying this app on Linux, and have dockerized all three services.</p>\n\n<p>However, I cannot manage to get my services to communicate on MacOS.</p>\n\n<p>The app repository is available here: <a href=\"https://github.com/42Projects/nPuzzle\" rel=\"nofollow noreferrer\">https://github.com/42Projects/nPuzzle</a></p>\n\n<p>The deploy folder contains the docker-compose file, the envoy.yaml file required for the envoy container, as well as all three dockerfiles.\nOn MacOS the last line of the envoy.yaml needs to be updated, <code>localhost</code> has to be changed to <code>host.docker.internal</code>.</p>\n\n<p>The client contains a ping function (in client/src/App.vue), the window.location.hostname might need to be changed to the docker-machine IP, unsure about that, my tries made no difference:</p>\n\n<pre><code>    created () {\n        this.client = new NpuzzleClient('http://' + window.location.hostname + ':8080', null, null);\n        const ping = () =&gt; {\n            let message = new Message();\n            message.setMessage('ping');\n            this.client.greets(message, {}, err =&gt; this.serverOnline = !err);\n        };\n        ping();\n        window.setInterval(ping, 1000);\n    },\n</code></pre>\n\n<p>which is executed every second, and will display that the server is online on the top right corner. I have been so far unsuccessful in reaching my server while deploying on MacOS. It works perfectly fine on Linux.</p>\n\n<p>Here is the code for the go server, I think it is correct to listen on localhost:9090 as the server will be dockerized, but I might be wrong and the address might need to be changed.</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"flag\"\n    \"fmt\"\n    pb \"github.com/42Projects/nPuzzle/proto\"\n    npuzzle \"github.com/42Projects/nPuzzle/src\"\n    \"google.golang.org/grpc\"\n    \"log\"\n    \"net\"\n    \"time\"\n)\n\nvar port = flag.Int(\"port\", 9090, \"the server port\")\n\ntype server struct{}\n\nfunc (s *server) Greets(ctx context.Context, message *pb.Message) (*pb.Message, error) {\n\n    return &amp;pb.Message{Message: \"pong!\"}, nil\n}\n\nfunc (s *server) Parse(ctx context.Context, message *pb.Message) (*pb.Matrix, error) {\n\n    log.Printf(\"received parsing request: %#v\", message.Message)\n    m, err := npuzzle.ParseMatrix(message.Message)\n    if err != nil {\n        log.Println(err)\n        return &amp;pb.Matrix{\n            Success: false,\n            Error:   err.Error(),\n        }, nil\n    }\n\n    rows := make([]*pb.Matrix_Row, len(m))\n    for index, row := range m {\n\n        /* We need unsigned 32bits integer for protobuf */\n        uIntRow := make([]uint32, len(m))\n        for rowIndex, num := range row {\n            uIntRow[rowIndex] = uint32(num)\n        }\n\n        rows[index] = &amp;pb.Matrix_Row{Num: uIntRow}\n    }\n\n    return &amp;pb.Matrix{\n        Success: true,\n        Rows:    rows,\n    }, nil\n}\n\nfunc (s *server) Solve(ctx context.Context, problem *pb.Problem) (*pb.Result, error) {\n\n    /* Choose heuristic function */\n    var heuristic npuzzle.Heuristic\n    switch problem.Heuristic {\n    case \"hamming\":\n        heuristic = npuzzle.HammingDistance\n    case \"manhattan\":\n        heuristic = npuzzle.ManhattanDistance\n    case \"manhattan + linear conflicts\":\n        heuristic = npuzzle.ManhattanPlusLinearConflicts\n    }\n\n    /* Choose between greedy search and uniform-cost search */\n    var goal npuzzle.Goal\n    var search npuzzle.Search\n    switch problem.Search {\n    case \"greedy\":\n        goal = npuzzle.GreedyGoalReached\n        search = npuzzle.GreedySearch\n    case \"uniform-cost\":\n        goal = npuzzle.UniformCostGoalReached\n        search = npuzzle.UniformCostSearch\n    }\n\n    /* Convert protobuf unsigned 32bits integer to regular integer */\n    size := len(problem.Rows)\n    m := make(npuzzle.Matrix, size)\n    for y, row := range problem.Rows {\n        m[y] = make([]int, size)\n        for x, num := range row.Num {\n            m[y][x] = int(num)\n        }\n    }\n\n    log.Printf(\"received problem:\\n - heuristic: %v\\n - search: %v\\n - matrix: %v\\n\", problem.Heuristic, problem.Search, m)\n    if npuzzle.IsSolvable(m) == false {\n        log.Println(\"failed to solve problem: unsolvable\")\n        return &amp;pb.Result{\n            Success: false,\n            Error:   \"unsolvable\",\n        }, nil\n    }\n\n    begin := time.Now()\n    log.Printf(\"starting solve on %v...\", m)\n    res, totalNumberOfStates, maxNumberOfStates, err := m.Solve(heuristic, search, goal, 30*time.Second)\n    if err != nil {\n        log.Printf(\"timed ouf after %v\", 30*time.Second)\n        return &amp;pb.Result{\n            Success: false,\n            Error:   fmt.Sprintf(\"timed ouf after %v\", 30*time.Second),\n        }, nil\n    }\n\n    duration := time.Since(begin)\n    log.Printf(\"solved %v in %v seconds\", m, duration)\n    var path string\n    if res.Parent == nil {\n        path = \"already solved!\"\n    } else {\n        path = npuzzle.StringifyPath(res)\n    }\n\n    return &amp;pb.Result{\n        Success:     true,\n        Time:        duration.String(),\n        Moves:       int32(res.Cost),\n        TotalStates: int32(totalNumberOfStates),\n        MaxStates:   int32(maxNumberOfStates),\n        Path:        path,\n    }, nil\n}\n\nfunc main() {\n\n    flag.Parse()\n    lis, err := net.Listen(\"tcp\", fmt.Sprintf(\"localhost:%d\", *port))\n    if err != nil {\n        log.Fatalf(\"failed to listen: %v\\n\", err)\n    }\n\n    s := grpc.NewServer()\n    pb.RegisterNpuzzleServer(s, &amp;server{})\n    log.Printf(\"starting server on port %v\\n\", *port)\n    log.Fatalf(\"failed to serve: %v\\n\", s.Serve(lis))\n}\n</code></pre>\n\n<p>I tried to launch the client and the server locally, and only containerize the envoy proxy, while trying different addresses (my docker machine IP address and localhost), but it didn't work. I also tried to launch all three containers but no result here either.\nI'm unsure what to change to successfully manage to make my app work properly on MacOS.</p>\n"}, {"tags": ["go", "runtime", "trace"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1569082456, "post_id": 58041933, "comment_id": 102484404, "body": "Maybe I understand... you&#39;re not talking about that code, per se... you want to know which of those lines of code are executed. What you need is the <a href=\"https://stackoverflow.com/questions/10516662/how-to-measure-code-coverage-in-golang\">coverage tool</a>."}, {"owner": {"reputation": 1, "user_id": 6157739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b6bcc1118453fa54f7703425c9efa74?s=128&d=identicon&r=PG&f=1", "display_name": "Steve C.", "link": "https://stackoverflow.com/users/6157739/steve-c"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569083416, "post_id": 58041933, "comment_id": 102484637, "body": "@Flimzy Thank you for the advice. I think I got it. What I need to do is integrate the coverage tool into my code and make sure there&#39;s coverage report generated in each execution. Then I can have the line numbers in each execution. Thank you so much."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1569083467, "post_id": 58041933, "comment_id": 102484648, "body": "It&#39;s not intended for running in normal execution. It&#39;s a profiling tool, meant to run on occasion (during testing). But maybe you can force it to do what you want."}, {"owner": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 0, "creation_date": 1569098866, "post_id": 58041933, "comment_id": 102488224, "body": "Another way of looking at what a program is doing is its callgraph. Have a look at <a href=\"https://github.com/protolambda/gocyto\" rel=\"nofollow noreferrer\">github.com/protolambda/gocyto</a> and <a href=\"https://github.com/TrueFurby/go-callvis\" rel=\"nofollow noreferrer\">github.com/TrueFurby/go-callvis</a>"}, {"owner": {"reputation": 1, "user_id": 6157739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b6bcc1118453fa54f7703425c9efa74?s=128&d=identicon&r=PG&f=1", "display_name": "Steve C.", "link": "https://stackoverflow.com/users/6157739/steve-c"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569099420, "post_id": 58041933, "comment_id": 102488346, "body": "@Flimzy  I tried &quot;testing&quot; package to collect lines of code that are tested with &quot;go test&quot; command and it works. Thanks for the advice. This should a candidate solution. I will continue to look for another easier way to collect these information during the runtime execution without using &quot;go test&quot;"}, {"owner": {"reputation": 1, "user_id": 6157739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b6bcc1118453fa54f7703425c9efa74?s=128&d=identicon&r=PG&f=1", "display_name": "Steve C.", "link": "https://stackoverflow.com/users/6157739/steve-c"}, "reply_to_user": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 0, "creation_date": 1569099479, "post_id": 58041933, "comment_id": 102488361, "body": "@marco.m Thank you for the advice. I will check them out to see if I can obtain some ideas from their source codes."}], "owner": {"reputation": 1, "user_id": 6157739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b6bcc1118453fa54f7703425c9efa74?s=128&d=identicon&r=PG&f=1", "display_name": "Steve C.", "link": "https://stackoverflow.com/users/6157739/steve-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569082396, "creation_date": 1569081883, "last_edit_date": 1569082396, "question_id": 58041933, "link": "https://stackoverflow.com/questions/58041933/how-to-collect-executed-line-numbers-in-runtime", "title": "How to collect executed line numbers in runtime", "body": "<p>I was researching on topic to analyze the codes that are executed with different inputs in Go. Assuming I have following code:</p>\n\n<pre><code>1  package main\n2  import \"fmt\"\n3  func main() {\n4      var i int\n5      _, err := fmt.Scanf(\"%d\", &amp;i)\n6      if i%2 == 0 {\n7         fmt.Println(\"input is even\")\n8      } else {\n9         fmt.Println(\"input is odd\")\n10     }\n11  }\n</code></pre>\n\n<p>The codes that are executed are based on the value of input. If your input is an even number, like 20, then the output should be <code>[1, 2, 3, 4, 5, 6, 7, 11]</code>. Otherwise, if the value of input is odd, like 21, then output will be <code>[1, 2, 3, 4, 5, 6, 8, 9, 10, 11]</code>.</p>\n\n<p>I am looking for a way in Go to print out the line numbers executed in runtime. If there are other imported go files, the line numbers that are executed in those files should be also printed out.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform", "betfair"], "answers": [{"tags": [], "owner": {"reputation": 1218, "user_id": 10423558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tytRy.png?s=128&g=1", "display_name": "Alex Riquelme", "link": "https://stackoverflow.com/users/10423558/alex-riquelme"}, "is_accepted": false, "score": 0, "last_activity_date": 1569096341, "creation_date": 1569096341, "answer_id": 58043703, "question_id": 58041348, "link": "https://stackoverflow.com/questions/58041348/betfair-non-interactive-bot-login-doesnt-work-in-google-app-engine-region-eu/58043703#58043703", "title": "Betfair Non-Interactive (Bot) login doesn&#39;t work in Google App Engine region eu-west2 (London)", "body": "<p>The IPs of Google Cloud Platform share the same geolocation (US). And it could be possible that your bot doesn't allow connections from this part of the world. If this is the issue, there isn't any available solution within GCP just yet. You can follow <a href=\"https://issuetracker.google.com/issues/112448138\" rel=\"nofollow noreferrer\">this</a> feature request or in the meantime, just point the requests to an on-prem service hosted in London that acts as a proxy.</p>\n"}], "owner": {"reputation": 29, "user_id": 10842642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TDNmMNSIwTQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcboQ_Xd6fUEYz_XpFrHXu-LTdPrSA/mo/photo.jpg?sz=128", "display_name": "Karan Bains", "link": "https://stackoverflow.com/users/10842642/karan-bains"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569096341, "creation_date": 1569077055, "last_edit_date": 1569077488, "question_id": 58041348, "link": "https://stackoverflow.com/questions/58041348/betfair-non-interactive-bot-login-doesnt-work-in-google-app-engine-region-eu", "title": "Betfair Non-Interactive (Bot) login doesn&#39;t work in Google App Engine region eu-west2 (London)", "body": "<p>The error I'm getting is BETTING_RESTRICTED_LOCATION. But when I run my app locally using London location from VPN I am able to login in perfectly.</p>\n\n<p>Is there a way I can ensure that the app is running from places where betting is legal?</p>\n\n<p>There is another question like this but its very old and doesn't help me.</p>\n"}, {"tags": ["docker", "go", "pcre", "alpine", "cgo"], "comments": [{"owner": {"reputation": 34972, "user_id": 3288890, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/sSQpx.jpg?s=128&g=1", "display_name": "Adiii", "link": "https://stackoverflow.com/users/3288890/adiii"}, "edited": false, "score": 1, "creation_date": 1569059373, "post_id": 58038858, "comment_id": 102479087, "body": "<code>RUN apk add --virtual build-dependencies RUn apk add --no-cache build-base gcc</code> try this or you can install the alpine sdk <code>apk add --update alpine-sdk</code>"}, {"owner": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "reply_to_user": {"reputation": 34972, "user_id": 3288890, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/sSQpx.jpg?s=128&g=1", "display_name": "Adiii", "link": "https://stackoverflow.com/users/3288890/adiii"}, "edited": false, "score": 0, "creation_date": 1569060322, "post_id": 58038858, "comment_id": 102479304, "body": "@Adiii On last step (deploy to server) I have an error [20278] INTERNAL ERROR: cannot create temporary directory!"}, {"owner": {"reputation": 34972, "user_id": 3288890, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/sSQpx.jpg?s=128&g=1", "display_name": "Adiii", "link": "https://stackoverflow.com/users/3288890/adiii"}, "edited": false, "score": 0, "creation_date": 1569060423, "post_id": 58038858, "comment_id": 102479330, "body": "does the above solve the issue?"}, {"owner": {"reputation": 34972, "user_id": 3288890, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/sSQpx.jpg?s=128&g=1", "display_name": "Adiii", "link": "https://stackoverflow.com/users/3288890/adiii"}, "edited": false, "score": 0, "creation_date": 1569060426, "post_id": 58038858, "comment_id": 102479332, "body": "<a href=\"https://github.com/docker/compose/issues/3262\" rel=\"nofollow noreferrer\">github.com/docker/compose/issues/3262</a>"}, {"owner": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "reply_to_user": {"reputation": 34972, "user_id": 3288890, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/sSQpx.jpg?s=128&g=1", "display_name": "Adiii", "link": "https://stackoverflow.com/users/3288890/adiii"}, "edited": false, "score": 0, "creation_date": 1569061711, "post_id": 58038858, "comment_id": 102479583, "body": "@Adiii I have fixed <code>[20278] INTERNAL ERROR: cannot create temporary directory!</code> but I still get <code>github.com&#47;glenn-brown&#47;golang-pkg-pcre&#47;src&#47;pkg&#47;pcre &#47;go&#47;pkg&#47;mod&#47;github.com&#47;glenn-brown&#47;golang-pkg-pcre@v0.0.0-20&zwnj;&#8203;120522223659-48bb82a&zwnj;&#8203;8b8ce&#47;src&#47;pkg&#47;pcre&#47;p&zwnj;&#8203;cre.go:52:10: fatal error: pcre.h: No such file or directory #include ^~~~~~~~ compilation terminated</code>"}, {"owner": {"reputation": 34972, "user_id": 3288890, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/sSQpx.jpg?s=128&g=1", "display_name": "Adiii", "link": "https://stackoverflow.com/users/3288890/adiii"}, "edited": false, "score": 0, "creation_date": 1569061842, "post_id": 58038858, "comment_id": 102479614, "body": "you can ask another question this is different issue"}, {"owner": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "reply_to_user": {"reputation": 34972, "user_id": 3288890, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/sSQpx.jpg?s=128&g=1", "display_name": "Adiii", "link": "https://stackoverflow.com/users/3288890/adiii"}, "edited": false, "score": 0, "creation_date": 1569061908, "post_id": 58038858, "comment_id": 102479634, "body": "@Adiii It is not a different problem. I have the same error message as I had before"}, {"owner": {"reputation": 34972, "user_id": 3288890, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/sSQpx.jpg?s=128&g=1", "display_name": "Adiii", "link": "https://stackoverflow.com/users/3288890/adiii"}, "reply_to_user": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "edited": false, "score": 0, "creation_date": 1569061922, "post_id": 58038858, "comment_id": 102479636, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/199765/discussion-between-adiii-and-klimbo\">continue this discussion in chat</a>."}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1569074735, "post_id": 58038858, "comment_id": 102482574, "body": "<a href=\"https://pkgs.alpinelinux.org/packages\" rel=\"nofollow noreferrer\">pkgs.alpinelinux.org/packages</a> might be a good starting point to try to find packages; there&#39;s a link from the <a href=\"https://hub.docker.com/_/alpine/\" rel=\"nofollow noreferrer\">Docker Hub <code>alpine</code> image page</a>."}, {"owner": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1569074825, "post_id": 58038858, "comment_id": 102482594, "body": "@DavidMaze I know this site and I have tested a lot of packages but all of them does not work"}], "answers": [{"comments": [{"owner": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "edited": false, "score": 0, "creation_date": 1569084274, "post_id": 58039382, "comment_id": 102484821, "body": "I have an error: Error loading shared library libpcre.so.3"}], "tags": [], "owner": {"reputation": 34972, "user_id": 3288890, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/sSQpx.jpg?s=128&g=1", "display_name": "Adiii", "link": "https://stackoverflow.com/users/3288890/adiii"}, "is_accepted": false, "score": 0, "last_activity_date": 1569076208, "last_edit_date": 1569076208, "creation_date": 1569061650, "answer_id": 58039382, "question_id": 58038858, "link": "https://stackoverflow.com/questions/58038858/what-package-should-i-install-instead-of-libpcre-dev-to-use-c-code-in-alpine-g/58039382#58039382", "title": "What package should I install instead of libpcre++-dev to use C code in Alpine Golang?", "body": "<p>You can try one of these, as both package </p>\n\n<pre><code>RUN apk add --virtual build-dependencies \nRUn apk add --no-cache build-base gcc\n</code></pre>\n\n<blockquote>\n  <p>build-essential is a metapackage (a package that installs many other\n  packages, like g++ and gcc: the GNU C &amp; C++ compilers).</p>\n</blockquote>\n\n<p>Or you can install the alpine sdk.</p>\n\n<blockquote>\n  <p>You can start with alpine-sdk, which is a \"metapackage that pulls in\n  the most essential packages used to build new packages.\"\n  <a href=\"http://wiki.alpinelinux.org/wiki/Developer_Documentation\" rel=\"nofollow noreferrer\">http://wiki.alpinelinux.org/wiki/Developer_Documentation</a> has more\n  info.</p>\n</blockquote>\n\n<pre><code>RUN apk add --update alpine-sdk\n</code></pre>\n\n<p><a href=\"https://github.com/gliderlabs/docker-alpine/issues/24\" rel=\"nofollow noreferrer\">docker-alpine-issues-24</a></p>\n\n<p>Or you can use golang:latest which will work fine.</p>\n\n<pre><code>FROM golang:latest\nRUN apt-get update \nRUN apt-get install libpcre++-dev -y\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "edited": false, "score": 0, "creation_date": 1569084287, "post_id": 58041016, "comment_id": 102484826, "body": "I have an error: Error loading shared library libpcre.so.3"}], "tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": false, "score": 1, "last_activity_date": 1569074503, "creation_date": 1569074503, "answer_id": 58041016, "question_id": 58038858, "link": "https://stackoverflow.com/questions/58038858/what-package-should-i-install-instead-of-libpcre-dev-to-use-c-code-in-alpine-g/58041016#58041016", "title": "What package should I install instead of libpcre++-dev to use C code in Alpine Golang?", "body": "<p>You can use one of the Debian-based <code>golang</code> images instead.  By the time you're installing GNU libc and a full C toolchain on top of this anyways, there's not really going to be much space savings over the Alpine base image.  You can (and should) use a multi-stage build where the final image just contains your compiled binary, and that can use an Alpine base.</p>\n\n<p>The result would look something like:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code># Build-time image; just has the parts needed to run `go build`\nFROM golang:1.12-buster AS build\n\n# Install additional build-time tools\nRUN apt-get update \\\n &amp;&amp; apt-get install --assume-yes \\\n      build-essential ca-certificates git-core tzdata \\\n      libpcre++-dev\n\n# Build your application\nWORKDIR /app\nCOPY . .\nENV GO111MODULE=on\nRUN go build -o myapp ./cmd/myapp\n\n# Runtime image; has only what we need to run the application\nFROM alpine:3.10\n# Note that you'll need the shared library for libpcre++\nRUN apk add ca-certificates tzdata libpcrepp\nCOPY --from=build /app/myapp /usr/bin/myapp\nCMD [\"myapp\"]\n</code></pre>\n"}], "owner": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1153, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1569090333, "creation_date": 1569057136, "last_edit_date": 1569090333, "question_id": 58038858, "link": "https://stackoverflow.com/questions/58038858/what-package-should-i-install-instead-of-libpcre-dev-to-use-c-code-in-alpine-g", "title": "What package should I install instead of libpcre++-dev to use C code in Alpine Golang?", "body": "<p>I have a Golang program inside a docker container (I use Ubuntu 18). Also I use <a href=\"http://github.com/glenn-brown/golang-pkg-pcre/src/pkg/pcre\" rel=\"nofollow noreferrer\">github.com/glenn-brown/golang-pkg-pcre/src/pkg/pcre</a> for regex in my Golang app. Before using this library I should install <code>libpcre++-dev</code> this way:</p>\n\n<blockquote>\n  <p>sudo apt-get install libpcre++-dev</p>\n</blockquote>\n\n<p>But I use golang:alpine in my Dockerfile and this is no <code>libpcre++-dev</code> library in alpine packages.</p>\n\n<p><strong>What package should I install instead of</strong> <code>libpcre++-dev</code>?</p>\n\n<p>p.s. I have tried to install <code>libc6-compat</code>, <code>pcre pcre-dev</code>, <code>libpcrecpp</code> but I see this error:</p>\n\n<blockquote>\n  <p>github.com/glenn-brown/golang-pkg-pcre/src/pkg/pcre\n  /go/pkg/mod/github.com/glenn-brown/golang-pkg-pcre@v0.0.0-20120522223659-48bb82a8b8ce/src/pkg/pcre/pcre.go:52:10:\n  fatal error: pcre.h: No such file or directory  #include \n            ^~~~~~~~ compilation terminated</p>\n</blockquote>\n\n<p>My Dockerfile:</p>\n\n<pre><code>FROM golang:alpine\n\nRUN apk update\nRUN apk upgrade\nRUN apk add --update --no-cache build-base gcc g++ pcre pcre-dev libc6-compat\n\n# Install git + SSL ca certificates.\n# Git is required for fetching the dependencies.\n# Ca-certificates is required to call HTTPS endpoints.\nRUN apk update &amp;&amp; apk add --no-cache curl git ca-certificates tzdata \\\n &amp;&amp; update-ca-certificates 2&gt; /dev/null || true\n</code></pre>\n\n<p>I build my app this way:</p>\n\n<pre><code>- CGO_ENABLED=1 GOOS=linux GOARCH=amd64 go build -a -installsuffix cgo -ldflags=\"-w -s\" -o bin/backend ./cmd/backend/main.go\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have change my Dockerfile (add line below)</p>\n\n<p><code>RUN apk add --update --no-cache build-base gcc g++ pcre pcre-dev libc6-compat</code></p>\n\n<p>And now I have a new error:</p>\n\n<blockquote>\n  <p>Error loading shared library libpcre.so.1: No such file or directory\n  (needed by /bin/backend)</p>\n</blockquote>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1569054653, "post_id": 58038557, "comment_id": 102478137, "body": "Whats the question? A <code>map[string]interface{}</code> isn&#39;t a <code>map[string]int</code> so the type assertion fails."}, {"owner": {"reputation": 1894, "user_id": 5358188, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rmI0xdPfyEI/AAAAAAAAAAI/AAAAAAAACJ8/l2_Fc-2YGjU/photo.jpg?sz=128", "display_name": "f_i", "link": "https://stackoverflow.com/users/5358188/f-i"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1569054840, "post_id": 58038557, "comment_id": 102478173, "body": "am i right to suppose that the map has key as string and value as int? type assertion with types other then map works with those assumptions"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1569075507, "post_id": 58038557, "comment_id": 102482744, "body": "You can&#39;t do a type assertion to an incompatible type. You must manually convert it instead."}], "answers": [{"comments": [{"owner": {"reputation": 1894, "user_id": 5358188, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rmI0xdPfyEI/AAAAAAAAAAI/AAAAAAAACJ8/l2_Fc-2YGjU/photo.jpg?sz=128", "display_name": "f_i", "link": "https://stackoverflow.com/users/5358188/f-i"}, "edited": false, "score": 0, "creation_date": 1569054947, "post_id": 58038588, "comment_id": 102478204, "body": "I am not at a liberty to return a static type, a map could hold any type as key and any type as value. right now for the sake of demonstration i have considered the values as interface. am i doing this right?"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 1894, "user_id": 5358188, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rmI0xdPfyEI/AAAAAAAAAAI/AAAAAAAACJ8/l2_Fc-2YGjU/photo.jpg?sz=128", "display_name": "f_i", "link": "https://stackoverflow.com/users/5358188/f-i"}, "edited": false, "score": 0, "creation_date": 1569055071, "post_id": 58038588, "comment_id": 102478230, "body": "so you need map[interface{}]interface{}"}, {"owner": {"reputation": 1894, "user_id": 5358188, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rmI0xdPfyEI/AAAAAAAAAAI/AAAAAAAACJ8/l2_Fc-2YGjU/photo.jpg?sz=128", "display_name": "f_i", "link": "https://stackoverflow.com/users/5358188/f-i"}, "edited": false, "score": 0, "creation_date": 1569055157, "post_id": 58038588, "comment_id": 102478250, "body": "yeah, if i can figure out map[string]interface{} for now i will see the second part later."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 1894, "user_id": 5358188, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rmI0xdPfyEI/AAAAAAAAAAI/AAAAAAAACJ8/l2_Fc-2YGjU/photo.jpg?sz=128", "display_name": "f_i", "link": "https://stackoverflow.com/users/5358188/f-i"}, "edited": false, "score": 0, "creation_date": 1569055266, "post_id": 58038588, "comment_id": 102478268, "body": "<code>Just to elaborate, my goal is to return a map with dynamic types</code> there is no such thing in go. You can however use interface{} to mixin multiple types."}, {"owner": {"reputation": 1894, "user_id": 5358188, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rmI0xdPfyEI/AAAAAAAAAAI/AAAAAAAACJ8/l2_Fc-2YGjU/photo.jpg?sz=128", "display_name": "f_i", "link": "https://stackoverflow.com/users/5358188/f-i"}, "edited": false, "score": 0, "creation_date": 1569055382, "post_id": 58038588, "comment_id": 102478296, "body": "i am using reflection to achieve that to some level. With other types it works but with maps i am getting this error."}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 1, "last_activity_date": 1569054775, "creation_date": 1569054775, "answer_id": 58038588, "question_id": 58038557, "link": "https://stackoverflow.com/questions/58038557/golang-type-assertion-on-map-is-panicking/58038588#58038588", "title": "golang type assertion on map is panicking", "body": "<p>return the appropriate type</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main()  {\n    m := hello().(map[string]int)\n    fmt.Println(m)\n}\n\nfunc hello() interface{} {\n    return map[string]int{\n        \"foo\": 2,\n        \"bar\": 3,\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1894, "user_id": 5358188, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rmI0xdPfyEI/AAAAAAAAAAI/AAAAAAAACJ8/l2_Fc-2YGjU/photo.jpg?sz=128", "display_name": "f_i", "link": "https://stackoverflow.com/users/5358188/f-i"}, "is_accepted": false, "score": -1, "last_activity_date": 1569057308, "creation_date": 1569057308, "answer_id": 58038875, "question_id": 58038557, "link": "https://stackoverflow.com/questions/58038557/golang-type-assertion-on-map-is-panicking/58038875#58038875", "title": "golang type assertion on map is panicking", "body": "<p>To answer my own question, <strong>assertion works on map values</strong></p>\n\n<p>a few examples</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype person struct {\n    name string\n}\n\nfunc main()  {\n    m := example1().(map[string]interface{})\n\n    fmt.Println(m[\"foo\"].(int))\n\n    m2 := example2().(map[string]interface{})\n\n    fmt.Println(m2[\"foo\"].(person).name)\n\n}\n\nfunc example1() interface{} {\n    return map[string]interface{} {\n        \"foo\": 2,\n        \"bar\": 3,\n    }\n}\n\nfunc example2() interface{} {\n    m := make(map[string]interface{})\n\n    m[\"foo\"] = person{\"Name is foo!\"}\n    m[\"bar\"] = person{\"Name is bar!\"}\n\n    return m\n}\n</code></pre>\n"}], "owner": {"reputation": 1894, "user_id": 5358188, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rmI0xdPfyEI/AAAAAAAAAAI/AAAAAAAACJ8/l2_Fc-2YGjU/photo.jpg?sz=128", "display_name": "f_i", "link": "https://stackoverflow.com/users/5358188/f-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "closed_date": 1569075424, "answer_count": 2, "score": -3, "last_activity_date": 1569075365, "creation_date": 1569054533, "last_edit_date": 1569075365, "question_id": 58038557, "link": "https://stackoverflow.com/questions/58038557/golang-type-assertion-on-map-is-panicking", "closed_reason": "Duplicate", "title": "golang type assertion on map is panicking", "body": "<p>Type assertion on a map doesn't work, is this the right way to do it?</p>\n\n<p><strong>Just to elaborate, my goal is to return a map with dynamic types. this example is just for demonstration.</strong></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main()  {\n    m := hello().(map[string]int)\n    fmt.Println(m)\n}\n\nfunc hello() interface{} {\n    return map[string]interface{} {\n        \"foo\": 2,\n        \"bar\": 3,\n    }\n}\n</code></pre>\n\n<p>it panics</p>\n\n<blockquote>\n  <p>panic: interface conversion: interface {} is map[string]interface {},\n  not map[string]int</p>\n</blockquote>\n"}]