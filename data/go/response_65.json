[{"tags": ["go", "printf"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 2, "creation_date": 1459991574, "post_id": 36464068, "comment_id": 60541477, "body": "Precision (as in <code>%.9g</code>) is the number of digits in the scientific notations (i.e. leading zeros are ignored). This is not very well documented, I suggest to file a bug at github.com/golang/go. Width (as in <code>%10g</code>) is the minimum number of runes to output according to the documentation. So the output looks correct."}, {"owner": {"reputation": 9811, "user_id": 168717, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/851da71d0192b0e34ac44dd6c98c31d2?s=128&d=identicon&r=PG", "display_name": "AkiRoss", "link": "https://stackoverflow.com/users/168717/akiross"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1460026572, "post_id": 36464068, "comment_id": 60558332, "body": "Ah, therefore a <code>0.000123456789</code> is still be formatted using 13 digits using <code>%.9g</code>! Damn, that&#39;s not clear from the docs... &quot;Total number of digits&quot; is kinda misleading!"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1460035170, "post_id": 36464068, "comment_id": 60564943, "body": "@AkiRoss you are right, Go&#39;s official documentation is really confusing on this :( I believe this question will help a lot of people."}, {"owner": {"reputation": 9811, "user_id": 168717, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/851da71d0192b0e34ac44dd6c98c31d2?s=128&d=identicon&r=PG", "display_name": "AkiRoss", "link": "https://stackoverflow.com/users/168717/akiross"}, "edited": false, "score": 1, "creation_date": 1460044287, "post_id": 36464068, "comment_id": 60572256, "body": "I hope it will be useful. In general, I feel like that formatting is a not-so-straightforward topic. Here&#39;s the issue report <a href=\"https://github.com/golang/go/issues/15178\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/15178</a>"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1460047814, "post_id": 36464068, "comment_id": 60574637, "body": "nice job @AkiRoss :D"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1460227677, "post_id": 36464068, "comment_id": 60647380, "body": "Related / Possible duplicate of <a href=\"http://stackoverflow.com/questions/36515818/golang-is-there-any-standard-library-to-convert-float64-to-string-with-fix-widt\">Golang: is there any standard library to convert float64 to string with fix width with maximum number of significant digits?</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1460005997, "post_id": 36465402, "comment_id": 60545515, "body": "Simple Answer is &quot;%10.5g&quot; but it will not return maximum number of Significant Digits of float number"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 1, "creation_date": 1460011966, "post_id": 36465402, "comment_id": 60548385, "body": "The OP is asking why, not looking for a solution :p"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1460137930, "post_id": 36465402, "comment_id": 60619184, "body": "Yes, I agree. I think the fmt lib for Printf needs rewriting for providing more significant digits. With float64 which provides 16 digits of significant digits it\u2019s a little odd to loose significant digits for any reason. And give to length filed a little more respect in %L.Dg"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1460195799, "last_edit_date": 1460195799, "creation_date": 1459994431, "answer_id": 36465402, "question_id": 36464068, "link": "https://stackoverflow.com/questions/36464068/fmt-printf-with-width-and-precision-fields-in-g-behaves-unexpectedly/36465402#36465402", "title": "fmt.Printf with width and precision fields in %g behaves unexpectedly", "body": "<p>Yes, I agree: it gives precedence to the \"precision fields\" not to \"width\".\nSo when we need fix columns for printing we need write new formatting func.</p>\n"}, {"tags": [], "owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "is_accepted": true, "score": 1, "last_activity_date": 1460011776, "creation_date": 1460011776, "answer_id": 36468685, "question_id": 36464068, "link": "https://stackoverflow.com/questions/36464068/fmt-printf-with-width-and-precision-fields-in-g-behaves-unexpectedly/36468685#36468685", "title": "fmt.Printf with width and precision fields in %g behaves unexpectedly", "body": "<p>Firstly, we need to understand the documentation correctly:</p>\n\n<blockquote>\n  <p>width sets the minimum width of the field and precision sets the number of places after the decimal, if appropriate, except that for %g/%G it sets the total number of digits.</p>\n</blockquote>\n\n<p>This line is grammatically correct, but the <strong>it</strong> in the last part of this sentence is really confusing: it actually refers to <strong>the precision</strong>, not the <strong>width</strong>.</p>\n\n<p>Therefore, let's look at some examples:</p>\n\n<pre><code>123.45\n12312.2\n1.6069\n0.6069\n0.0006069\n</code></pre>\n\n<p>and you print it like <code>fmt.Printf(\"%.4g\")</code>, it gives you</p>\n\n<pre><code>123.5\n1.231e+04\n1.607\n0.6069\n0.0006069\n</code></pre>\n\n<p>only 4 <strong>digits, excluding all decimal points and exponent</strong>. But wait, what happens to the last 2 example? Are you kidding me isn't that more than 5 digits?</p>\n\n<p>This is the confusing part in printing: <strong>leading 0s</strong> won't be counted as digits, and <strong>won't be shrunk when there are less than 4 zeros</strong>.</p>\n\n<p>Let's look at 0 behavior using the example below:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Printf(\"%.4g\\n\", 0.12345)\n    fmt.Printf(\"%.4g\\n\", 0.012345)\n    fmt.Printf(\"%.4g\\n\", 0.0012345)\n    fmt.Printf(\"%.4g\\n\", 0.00012345)\n    fmt.Printf(\"%.4g\\n\", 0.000012345)\n    fmt.Printf(\"%.4g\\n\", 0.0000012345)\n    fmt.Printf(\"%.4g\\n\", 0.00000012345)\n\n    fmt.Printf(\"%g\\n\", 0.12345)\n    fmt.Printf(\"%g\\n\", 0.012345)\n    fmt.Printf(\"%g\\n\", 0.0012345)\n    fmt.Printf(\"%g\\n\", 0.00012345)\n    fmt.Printf(\"%g\\n\", 0.000012345)\n    fmt.Printf(\"%g\\n\", 0.0000012345)\n    fmt.Printf(\"%g\\n\", 0.00000012345)\n}\n</code></pre>\n\n<p>and the output:</p>\n\n<pre><code>0.1235\n0.01235\n0.001234\n0.0001234\n1.234e-05\n1.234e-06\n1.235e-07\n0.12345\n0.012345\n0.0012345\n0.00012345\n1.2345e-05\n1.2345e-06\n1.2345e-07\n</code></pre>\n\n<p>So you could see, when there are less than 4 leading 0s, they will be counted, and be shrunk if there are more than that.</p>\n\n<p>Ok, next thing is the <code>width</code>. From the documentation, <code>width</code> only specifies the minimum width, <strong>including decimal place and exponent</strong>. Which means, if you have more digits than what <code>width</code> specified, it will shoot out of the width. </p>\n\n<p>Remember, width will be taken account as the last step, which means it needs to <strong>first satisfy the precision field</strong>.</p>\n\n<p>Let's go back to your case. You specified <code>%10.9g</code>, that means you want a total digit of 9, excluding the leading <code>0</code>, and a min width of <code>10</code> including decimal place and exponent, and the precision should take priority.</p>\n\n<p><code>0.0606060606060606</code>: take 9 digits without leading 0 will give you <code>0.0606060606</code>, since it's already 12 width, it passes the min width of 10;</p>\n\n<p><code>0.3333333333333333</code>: take 9 digits without leading 0 will give you <code>0.333333333</code>, since it's already 11 width, it passes the min width of 10;</p>\n\n<p><code>0.05</code>: take 9 digits without leading 0 will give you <code>0.05</code>, since it's less than width 10, it will pad with another 6 width to get width of 10;</p>\n\n<p><code>0.4</code>: same as above;</p>\n\n<p><code>0.1818181818181818</code>: take 9 digits without leading 0 will give you <code>0.181818182</code> with <strong>rounding</strong>, since it's already 11 width, it passes the min width of 10.</p>\n\n<p>So this explains why you got the funny printing.</p>\n"}], "owner": {"reputation": 9811, "user_id": 168717, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/851da71d0192b0e34ac44dd6c98c31d2?s=128&d=identicon&r=PG", "display_name": "AkiRoss", "link": "https://stackoverflow.com/users/168717/akiross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1697, "favorite_count": 0, "accepted_answer_id": 36468685, "answer_count": 2, "score": 5, "last_activity_date": 1460195799, "creation_date": 1459985122, "last_edit_date": 1460024608, "question_id": 36464068, "link": "https://stackoverflow.com/questions/36464068/fmt-printf-with-width-and-precision-fields-in-g-behaves-unexpectedly", "title": "fmt.Printf with width and precision fields in %g behaves unexpectedly", "body": "<p>I am trying to get some floats formatted with the same width using <code>fmt.Printf()</code>.</p>\n\n<p>For example, given the float values 0.0606060606060606, 0.3333333333333333, 0.05, 0.4 and 0.1818181818181818, I would like to get each value formatted in, say, 10 runes:</p>\n\n<pre><code>0.06060606\n0.33333333\n      0.05\n       0.4\n0.18181818\n</code></pre>\n\n<p>But I can't understand how it's done. Documentation says that</p>\n\n<blockquote>\n  <p>For floating-point values, width sets the minimum width of the field\n  and precision sets the number of places after the decimal, if\n  appropriate, except that for %g/%G it sets the total number of digits.\n  For example, given 123.45 the format %6.2f prints 123.45 while %.4g\n  prints 123.5. The default precision for %e and %f is 6; for %g it is\n  the smallest number of digits necessary to identify the value\n  uniquely.</p>\n</blockquote>\n\n<p>So, if I use <code>%f</code> a larger number will not fit in 10-character constraint, therefore <code>%g</code> is required. To get a minimum width of 10 is <code>%10g</code> and to get a maximum number of 9 digits (+1 for the dot) it's <code>%.9g</code>, but combining them in <code>%10.9g</code> is not behaving as I expect</p>\n\n<pre><code>0.0606060606\n0.333333333\n      0.05\n       0.4\n0.181818182\n</code></pre>\n\n<p>How come I get strings which are of 10 runes, others that are 11 runes and others that are 12 runes?</p>\n\n<p>In particular, it seems that <code>%.9g</code> does not produce 9 digits in total. See for example: <a href=\"http://play.golang.org/p/ie9k8bYC7r\" rel=\"nofollow\">http://play.golang.org/p/ie9k8bYC7r</a></p>\n"}, {"tags": ["go", "pass-by-reference"], "comments": [{"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 1, "creation_date": 1536589889, "post_id": 36463608, "comment_id": 91467552, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25290956/go-update-slice-iterating-error-does-not-support-indexing\">Go update slice iterating error &quot;does not support indexing&quot;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 14, "last_activity_date": 1459983781, "last_edit_date": 1459983781, "creation_date": 1459982784, "answer_id": 36463641, "question_id": 36463608, "link": "https://stackoverflow.com/questions/36463608/go-invalid-operation-type-mapkeyvalue-does-not-support-indexing/36463641#36463641", "title": "Go: invalid operation - type *map[key]value does not support indexing", "body": "<p>You can simply dereference <code>b</code>: <code>(*b)</code></p>\n\n<p><a href=\"https://play.golang.org/p/Xq6qFy4_PC\" rel=\"noreferrer\">https://play.golang.org/p/Xq6qFy4_PC</a></p>\n\n<pre><code>func (b *Balance) Add(amount Amount) *Balance {\n    current, ok := (*b)[amount.Currency]\n    if ok {\n        (*b)[amount.Currency] = current + amount.Value\n    } else {\n        (*b)[amount.Currency] = amount.Value\n    }\n    return b\n}\n</code></pre>\n\n<h3>Update</h3>\n\n<p>@Serdmanczyk makes a good point... you can safely pass a map around by value, the underlying map will be updated, not a copy of the map.  That is to say; pass-by-value in the case of a map means passing the address of the map, not the contents of the map.</p>\n\n<p>See <a href=\"https://play.golang.org/p/i7Yz4zMq4v\" rel=\"noreferrer\">https://play.golang.org/p/i7Yz4zMq4v</a></p>\n\n<pre><code>type foo map[string]string\n\nfunc main() {\n    a := foo{}\n    a[\"hello\"] = \"world\"\n    fmt.Printf(\"%#v\\n\", a)\n    mod(a)\n    fmt.Printf(\"%#v\\n\", a)\n\n}\n\nfunc mod(f foo) {\n    f[\"hello\"] = \"cruel world\"\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>main.foo{\"hello\":\"world\"}\nmain.foo{\"hello\":\"cruel world\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 894, "user_id": 2406040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4126afa62f9870ada0859381ca589d20?s=128&d=identicon&r=PG", "display_name": "Serdmanczyk", "link": "https://stackoverflow.com/users/2406040/serdmanczyk"}, "is_accepted": true, "score": 48, "last_activity_date": 1459983169, "creation_date": 1459983169, "answer_id": 36463704, "question_id": 36463608, "link": "https://stackoverflow.com/questions/36463608/go-invalid-operation-type-mapkeyvalue-does-not-support-indexing/36463704#36463704", "title": "Go: invalid operation - type *map[key]value does not support indexing", "body": "<p>You are trying to index on the pointer rather than the map itself.  Kind of confusing because usually with pointers vs. values dereferencing is automatic for structs.  If your struct is just a map, however, it's only passed in by reference anyway so you don't have to worry about creating methods that act on pointers to avoid copying the entire structure every time.  The following code is equivalent to your first snippet but using a pointer type.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Currency string\n\ntype Amount struct {\n    Currency Currency\n    Value float32\n}\n\ntype Balance map[Currency]float32\n\nfunc (b *Balance) Add(amount Amount) *Balance {\n    current, ok := (*b)[amount.Currency]\n    if ok {\n        (*b)[amount.Currency] = current + amount.Value\n    } else {\n        (*b)[amount.Currency] = amount.Value\n    }\n    return b\n}\n\nfunc main() {\n    b := &amp;Balance{Currency(\"USD\"): 100.0}\n    b = b.Add(Amount{Currency: Currency(\"USD\"), Value: 5.0})\n\n    fmt.Println(\"Balance: \", (*b))\n}\n</code></pre>\n\n<p>But to answer how to deal with it: if your struct is just of type map, I wouldn't worry about writing your receiving functions to take pointers, and just receive the value since the value is only a reference anyways.  Do like in your original snippet.</p>\n"}], "owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26660, "favorite_count": 2, "accepted_answer_id": 36463704, "answer_count": 2, "score": 33, "last_activity_date": 1520929816, "creation_date": 1459982625, "question_id": 36463608, "link": "https://stackoverflow.com/questions/36463608/go-invalid-operation-type-mapkeyvalue-does-not-support-indexing", "title": "Go: invalid operation - type *map[key]value does not support indexing", "body": "<p>I'm trying to write a function that modifies original map that is passed by pointer but Go does not allow it. Let's say I have a big map and don't want to copy it back and forth.</p>\n\n<p>The code that uses passing by value is working and is doing what I need but involves passing by value (<a href=\"https://play.golang.org/p/-UUiJ9vbMa\" rel=\"noreferrer\">playground</a>):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Currency string\n\ntype Amount struct {\n    Currency Currency\n    Value float32\n}\n\ntype Balance map[Currency]float32\n\nfunc (b Balance) Add(amount Amount) Balance {\n    current, ok := b[amount.Currency]\n    if ok {\n        b[amount.Currency] = current + amount.Value\n    } else {\n        b[amount.Currency] = amount.Value\n    }\n    return b\n}\n\nfunc main() {\n    b := Balance{Currency(\"USD\"): 100.0}\n    b = b.Add(Amount{Currency: Currency(\"USD\"), Value: 5.0})\n\n    fmt.Println(\"Balance: \", b)\n}\n</code></pre>\n\n<p>But if I try to pass parameter as pointer like here (<a href=\"https://play.golang.org/p/kVCAt7074j\" rel=\"noreferrer\">playground</a>):</p>\n\n<pre><code>func (b *Balance) Add(amount Amount) *Balance {\n    current, ok := b[amount.Currency]\n    if ok {\n        b[amount.Currency] = current + amount.Value\n    } else {\n        b[amount.Currency] = amount.Value\n    }\n    return b\n}\n</code></pre>\n\n<p>I'm getting compilation error:</p>\n\n<pre><code>prog.go:15: invalid operation: b[amount.Currency] (type *Balance does not support indexing)\nprog.go:17: invalid operation: b[amount.Currency] (type *Balance does not support indexing)\nprog.go:19: invalid operation: b[amount.Currency] (type *Balance does not support indexing)\n</code></pre>\n\n<p>How should I deal with this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1459970359, "post_id": 36460306, "comment_id": 60532788, "body": "Allocated off the bat. If you want dynamic size, you might just want to have a slice and use a <a href=\"https://golang.org/pkg/sync/#Mutex\" rel=\"nofollow noreferrer\"><code>sync.Mutex</code></a> to lock access to it."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1460003842, "post_id": 36460306, "comment_id": 60544787, "body": "Probably 8 MByte as most ints are 64 bits nowadays."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 5, "last_activity_date": 1459974104, "last_edit_date": 1459974104, "creation_date": 1459971132, "answer_id": 36460695, "question_id": 36460306, "link": "https://stackoverflow.com/questions/36460306/how-does-memory-allocation-work-for-buffered-channels/36460695#36460695", "title": "How does memory allocation work for buffered channels", "body": "<p>The full size of the buffer (plus I believe two words for the channel itself) will be allocated up front and retained until it is garbage collected.</p>\n"}], "owner": {"reputation": 8373, "user_id": 58109, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f644c55ff071f7a87f335fe5624b5c8f?s=128&d=identicon&r=PG", "display_name": "Sam Lee", "link": "https://stackoverflow.com/users/58109/sam-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "accepted_answer_id": 36460695, "answer_count": 1, "score": 2, "last_activity_date": 1460053963, "creation_date": 1459969848, "last_edit_date": 1460053963, "question_id": 36460306, "link": "https://stackoverflow.com/questions/36460306/how-does-memory-allocation-work-for-buffered-channels", "title": "How does memory allocation work for buffered channels", "body": "<p>If I have a buffered channel like this:</p>\n\n<pre><code>ch := make(chan int, 1000000)\n</code></pre>\n\n<p>is 8MB of memory allocated off the bat, or does the memory allocation grow/shrink depending on the amount of data?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1459968924, "post_id": 36459827, "comment_id": 60531866, "body": "It might be worth bugging Datadog support about it, if you&#39;re a customer of theirs."}, {"owner": {"reputation": 1631, "user_id": 97094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfe21dc7a0a8ad4e92cced3d4c02063f?s=128&d=identicon&r=PG", "display_name": "des4maisons", "link": "https://stackoverflow.com/users/97094/des4maisons"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1459969155, "post_id": 36459827, "comment_id": 60532023, "body": "@twotwotwo appreciate the pointer, however I&#39;m not bothered by the fact that my program isn&#39;t working. What I really want to know is how to interpret the stack trace."}], "answers": [{"comments": [{"owner": {"reputation": 1631, "user_id": 97094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfe21dc7a0a8ad4e92cced3d4c02063f?s=128&d=identicon&r=PG", "display_name": "des4maisons", "link": "https://stackoverflow.com/users/97094/des4maisons"}, "edited": false, "score": 1, "creation_date": 1459968959, "post_id": 36459921, "comment_id": 60531891, "body": "Thanks for the answer, though I&#39;m not interested in solving this particular problem as much as I am interested in learning how to interpret what the various addresses in github.com/DataDog/datadog-go/statsd.(*Client).Event(0x0, 0xc8200c7ec8, 0x0, 0x0) mean. I will edit my question to make that clear."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 1631, "user_id": 97094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfe21dc7a0a8ad4e92cced3d4c02063f?s=128&d=identicon&r=PG", "display_name": "des4maisons", "link": "https://stackoverflow.com/users/97094/des4maisons"}, "edited": false, "score": 4, "creation_date": 1459969908, "post_id": 36459921, "comment_id": 60532513, "body": "@des4maisons -- the receiver (the <code>*Client</code>) comes first in the argument list. <code>0x0</code> is a nil pointer. <code>0xc8200c7ec8</code> is the raw value of the Event pointer. Not sure about the last two; they may be the two words in the <i>returned</i> <a href=\"http://research.swtch.com/interfaces\" rel=\"nofollow noreferrer\">interface value</a>. Note that you&#39;re getting a dump of the raw words passed, so, e.g. <a href=\"http://research.swtch.com/godata\" rel=\"nofollow noreferrer\">a slice would show up as three words</a>. There&#39;s something called <a href=\"https://github.com/maruel/panicparse\" rel=\"nofollow noreferrer\">panicparse</a> that makes these more digestible and you may even find skimming its source useful."}, {"owner": {"reputation": 1631, "user_id": 97094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfe21dc7a0a8ad4e92cced3d4c02063f?s=128&d=identicon&r=PG", "display_name": "des4maisons", "link": "https://stackoverflow.com/users/97094/des4maisons"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1459973889, "post_id": 36459921, "comment_id": 60534855, "body": "@twotwotwo thanks, that&#39;s exactly what it was. I wrote up an answer expanding on your explanation."}], "tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": false, "score": 2, "last_activity_date": 1459968743, "creation_date": 1459968743, "answer_id": 36459921, "question_id": 36459827, "link": "https://stackoverflow.com/questions/36459827/how-to-interpret-go-stacktrace/36459921#36459921", "title": "How to interpret Go stacktrace", "body": "<p>What you have is a nil pointer dereference. (Unless you are using package <code>unsafe</code>, which you probably shouldn't touch, so I'm assuming you're not.)</p>\n\n<p>It looks like the <code>e</code> argument to <code>func (c *Client) Event(e *Event) error</code> is <code>nil</code> when called from <code>github.com/some/path/server/http.go:86</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2043, "user_id": 157943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/745c55f201b982c31c610cabab10a6be?s=128&d=identicon&r=PG", "display_name": "gmcnaughton", "link": "https://stackoverflow.com/users/157943/gmcnaughton"}, "edited": false, "score": 1, "creation_date": 1497276491, "post_id": 36461477, "comment_id": 75996644, "body": "Thanks for the step-by-step examples!"}], "tags": [], "owner": {"reputation": 1631, "user_id": 97094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfe21dc7a0a8ad4e92cced3d4c02063f?s=128&d=identicon&r=PG", "display_name": "des4maisons", "link": "https://stackoverflow.com/users/97094/des4maisons"}, "is_accepted": true, "score": 19, "last_activity_date": 1459973822, "creation_date": 1459973822, "answer_id": 36461477, "question_id": 36459827, "link": "https://stackoverflow.com/questions/36459827/how-to-interpret-go-stacktrace/36461477#36461477", "title": "How to interpret Go stacktrace", "body": "<p>Thanks to a comment from @twotwotwo, I think I figured this out.</p>\n\n<p>In this line</p>\n\n<pre><code>github.com/DataDog/datadog-go/statsd.(*Client).Event(0x0, 0xc8200c7ec8, 0x0, 0x0)\n</code></pre>\n\n<ul>\n<li>the first <code>0x0</code> is the <code>*Client</code>, which is indeed nil.</li>\n<li><code>0xc8200c7ec8</code> is <code>*Event</code></li>\n<li>the following <code>0x0, 0x0</code> represent the return value of type <code>error</code>. <code>error</code>, according to <a href=\"http://blog.golang.org/error-handling-and-go\" rel=\"noreferrer\">http://blog.golang.org/error-handling-and-go</a>, is an interface. According to <a href=\"http://research.swtch.com/interfaces\" rel=\"noreferrer\">http://research.swtch.com/interfaces</a>, interfaces are stored as two pointers. The first pointer points to the type information stored in the interface, and the second pointer points to the data stored in the interface.</li>\n</ul>\n\n<p>I wrote the following program to demonstrate to myself how different function signatures appear in a stack trace:</p>\n\n<pre><code>package main\n\nimport \"errors\"\n\ntype X struct {\n        i int\n}\n\ntype Y struct {\n}\n\nfunc (y *Y) foo(x *X) {\n        panic(\"panic in foo\")\n}\n\nfunc (y *Y) bar(x *X) (*Y) {\n        panic(\"panic in bar\")\n        return y\n}\n\nfunc (y *Y) baz(x *X) (error) {\n        panic(\"panic in baz\")\n        return errors.New(\"error in baz\")\n}\n\nfunc (y *Y) bam() {\n        panic(\"panic in bam\")\n}\n\nfunc main() {\n        y := new(Y)\n        x := new(X)\n        // comment out the ones you don't want to check\n        y.foo(x)\n        y.bar(x)\n        y.baz(x)\n        y.bam()\n}\n</code></pre>\n\n<p>When <code>bam</code> is called, which acts on <code>*Y</code> but has no arguments or return value, the output contains: </p>\n\n<pre><code>main.(*Y).bam(0xc82002df48)\n</code></pre>\n\n<p>When <code>foo</code> is called, which acts on <code>*Y</code> and takes a <code>*X</code> as argument, but has no return value, the output contains:</p>\n\n<pre><code>main.(*Y).foo(0xc820033f30, 0xc820033f30)\n</code></pre>\n\n<p>When <code>bar</code> is called, which acts on <code>*Y</code>, takes a <code>*X</code> as argument, and returns a <code>*Y</code>, the output contains:</p>\n\n<pre><code>main.(*Y).bar(0xc820033f30, 0xc820033f30, 0x40fb46)\n</code></pre>\n\n<p>When <code>baz</code> is called, which acts on <code>*Y</code>, takes <code>*X</code> as argument, and returns an <code>error</code> (which is an interface), the output contains:</p>\n\n<pre><code>main.(*Y).baz(0xc820033f38, 0xc820033f38, 0x0, 0x0)\n</code></pre>\n"}], "owner": {"reputation": 1631, "user_id": 97094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfe21dc7a0a8ad4e92cced3d4c02063f?s=128&d=identicon&r=PG", "display_name": "des4maisons", "link": "https://stackoverflow.com/users/97094/des4maisons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2996, "favorite_count": 6, "accepted_answer_id": 36461477, "answer_count": 2, "score": 8, "last_activity_date": 1459977669, "creation_date": 1459968433, "last_edit_date": 1459977669, "question_id": 36459827, "link": "https://stackoverflow.com/questions/36459827/how-to-interpret-go-stacktrace", "title": "How to interpret Go stacktrace", "body": "<p>I am getting this stacktrace when running a go program:</p>\n\n<pre><code>        /home/travis/.gimme/versions/go1.6.linux.amd64/src/runtime/panic.go:464 +0x3e6\ngithub.com/DataDog/datadog-go/statsd.(*Client).Event(0x0, 0xc8200c7ec8, 0x0, 0x0)\n        /home/travis/gopath/src/github.com/DataDog/datadog-go/statsd/statsd.go:286 +0x11f\ngithub.com/some/path/server.(*Server).buildAndUpdate(0xc820024068, 0xc820064600, 0x0, 0x0)\n        /home/travis/gopath/src/github.com/some/path/server/http.go:86 +0xf9f\ncreated by github.com/some/path/server.(*Server).processPullRequestEvent\n        /home/travis/gopath/src/github.com/some/path/server/http.go:169 +0x53f\n</code></pre>\n\n<p>The signature of the Event function is:</p>\n\n<pre><code>func (c *Client) Event(e *Event) error\n</code></pre>\n\n<p>which can also be seen here: <a href=\"https://github.com/DataDog/datadog-go/blob/cc2f4770f4d61871e19bfee967bc767fe730b0d9/statsd/statsd.go#L285\" rel=\"noreferrer\">https://github.com/DataDog/datadog-go/blob/cc2f4770f4d61871e19bfee967bc767fe730b0d9/statsd/statsd.go#L285</a></p>\n\n<p>The type definition for <code>Event</code> can be seen here: <a href=\"https://github.com/DataDog/datadog-go/blob/cc2f4770f4d61871e19bfee967bc767fe730b0d9/statsd/statsd.go#L333\" rel=\"noreferrer\">https://github.com/DataDog/datadog-go/blob/cc2f4770f4d61871e19bfee967bc767fe730b0d9/statsd/statsd.go#L333</a></p>\n\n<p>The type definition for <code>Client</code> can be seen here: <a href=\"https://github.com/DataDog/datadog-go/blob/cc2f4770f4d61871e19bfee967bc767fe730b0d9/statsd/statsd.go#L59\" rel=\"noreferrer\">https://github.com/DataDog/datadog-go/blob/cc2f4770f4d61871e19bfee967bc767fe730b0d9/statsd/statsd.go#L59</a></p>\n\n<p>My question is, how do I interpret the memory addresses on this line, and more generally, any stack traces which involve typed variables as targets and as arguments?</p>\n\n<pre><code>github.com/DataDog/datadog-go/statsd.(*Client).Event(0x0, 0xc8200c7ec8, 0x0, 0x0)\n</code></pre>\n\n<p>When I looked at <a href=\"http://www.goinggo.net/2015/01/stack-traces-in-go.html\" rel=\"noreferrer\">http://www.goinggo.net/2015/01/stack-traces-in-go.html</a> (which is the only information I was able to find on the subject), I didn't see anything about how to interpret the output when structs were involved.</p>\n"}, {"tags": ["go", "oauth", "gmail-api"], "comments": [{"owner": {"reputation": 33081, "user_id": 4625829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tw3Uk.png?s=128&g=1", "display_name": "AL.", "link": "https://stackoverflow.com/users/4625829/al"}, "edited": false, "score": 0, "creation_date": 1460009992, "post_id": 36459104, "comment_id": 60547303, "body": "Have you seen this <a href=\"http://stackoverflow.com/a/33246332/6124253\">answer</a>? It simply says it&#39;s not possible to send email using Gmail via the service account. He did mention some workarounds though."}, {"owner": {"reputation": 33081, "user_id": 4625829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tw3Uk.png?s=128&g=1", "display_name": "AL.", "link": "https://stackoverflow.com/users/4625829/al"}, "edited": false, "score": 0, "creation_date": 1460014647, "post_id": 36459104, "comment_id": 60550117, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/33233694/gmail-api-can-i-send-email-using-the-service-account\">GMAIl API - Can I send email using the Service Account?</a>"}], "owner": {"reputation": 2565, "user_id": 17234, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f84e832bfeef0ade1ca7dd4f023ed923?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/17234/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484049896, "creation_date": 1459966320, "last_edit_date": 1460011319, "question_id": 36459104, "link": "https://stackoverflow.com/questions/36459104/go-gmail-api-service-account", "title": "Go Gmail API Service Account", "body": "<p>I would like to send email via Gmail using a service account API. I am able to do this with a Client ID and Client Secret, but a service account doesn't have a client secret.  Here's what I do have:</p>\n\n<pre><code>{\n  \"type\": \"service_account\",\n  \"project_id\": \"my-project-id\",\n  \"private_key_id\": \"107...\",\n  \"private_key\": \"-----BEGIN PRIVATE KEY-----\\nMII...=\\n-----END PRIVATE KEY-----\\n\",\n  \"client_email\": \"something@something.iam.gserviceaccount.com\",\n  \"client_id\": \"103...\",\n  \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n  \"token_uri\": \"https://accounts.google.com/o/oauth2/token\",\n  \"auth_provider_x509_cert_url\": \"https://www.googleapis.com/oauth2/v1/certs\",\n  \"client_x509_cert_url\": \"https://www.googleapis.com/robot/v1/metadata/x509/something%40something.iam.gserviceaccount.com\"\n}\n</code></pre>\n\n<p>How can I use this information to connect and send an email?  All the documentation seems to reference non-service accounts.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "edited": false, "score": 0, "creation_date": 1459967719, "post_id": 36458716, "comment_id": 60531139, "body": "I tried your suggestions <a href=\"https://play.golang.org/p/ecJv730Zrd\" rel=\"nofollow noreferrer\">here</a> and it errors with &quot;cannot use cars (type []car) as type []interface {} in argument to genericAppenderNew&quot;. I am not sure this is still possible..."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "edited": false, "score": 0, "creation_date": 1459968661, "post_id": 36458716, "comment_id": 60531703, "body": "@gextra in that case you&#39;re using the second option and you need to make the type an <code>[]interface{}</code> before passing it to <code>genericAppender</code> if you use the first example it will take the collection as you currently have it and do a type assertion inside the method."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "edited": false, "score": 1, "creation_date": 1459976812, "post_id": 36458716, "comment_id": 60536587, "body": "@gextra I updated to include a complete example of the second suggestion that runs without errors."}, {"owner": {"reputation": 1100, "user_id": 1548557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0d23686d0f2a1f68be3cdb60a4adc86?s=128&d=identicon&r=PG", "display_name": "MrMesees", "link": "https://stackoverflow.com/users/1548557/mrmesees"}, "edited": false, "score": 0, "creation_date": 1515153046, "post_id": 36458716, "comment_id": 83201638, "body": "Surely this is dangerous AF though? I mean any object can be put inside, so how would you access type-specific methods or data?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 1100, "user_id": 1548557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0d23686d0f2a1f68be3cdb60a4adc86?s=128&d=identicon&r=PG", "display_name": "MrMesees", "link": "https://stackoverflow.com/users/1548557/mrmesees"}, "edited": false, "score": 1, "creation_date": 1515179422, "post_id": 36458716, "comment_id": 83216145, "body": "@MrMesees I wouldn&#39;t necessarily say it&#39;s dangerous, it&#39;s more a pain in the ass. If you want to write code that safely handles unknown types it&#39;s going to involve a lot of reflection and conditionals, it is possible to do, you can&#39;t guarantee you&#39;ll parse though. It&#39;s all up to the person designing the code. I prefer types to be concrete because it makes for simpler, more performant and more consistent code (at run time) but generics allow reuse and some amount of them usually is a good thing. If you wanted a better/safer app, I&#39;d recommend using something more specific than <code>interface{}</code>."}, {"owner": {"reputation": 1100, "user_id": 1548557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0d23686d0f2a1f68be3cdb60a4adc86?s=128&d=identicon&r=PG", "display_name": "MrMesees", "link": "https://stackoverflow.com/users/1548557/mrmesees"}, "edited": false, "score": 0, "creation_date": 1515184844, "post_id": 36458716, "comment_id": 83218555, "body": "Yeah I came looking for something in the morning and after a few minutes browsing I quickly realised I didn&#39;t want to make these trade-off&#39;s. It&#39;s a pity Go doesn&#39;t have some form of pre-compilation processor which would be able to snip around and fill in placeholders to give type-safe generics."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 1100, "user_id": 1548557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0d23686d0f2a1f68be3cdb60a4adc86?s=128&d=identicon&r=PG", "display_name": "MrMesees", "link": "https://stackoverflow.com/users/1548557/mrmesees"}, "edited": false, "score": 1, "creation_date": 1515708357, "post_id": 36458716, "comment_id": 83415096, "body": "@MrMesees you just have to define interfaces for that purpose. Go&#39;s type system is pretty light weight and therefor not quite as streamlined as some where you can work with <code>List&lt;T&gt;</code> but instead you just have to put a heavier emphasis on using interfaces in place of concrete types and you achieve the same kind of generic code without giving up type safety. Using a more specific interface will limit the scope of what can be passed in there to a more realistic and valid input set and then the method can be type safe without doing a huge amount of reflective operations."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 4, "last_activity_date": 1459976787, "last_edit_date": 1459976787, "creation_date": 1459965173, "answer_id": 36458716, "question_id": 36458649, "link": "https://stackoverflow.com/questions/36458649/creating-generic-functions-for-multi-type-arrays-in-go/36458716#36458716", "title": "creating generic functions for multi type arrays in Go", "body": "<p>After this change you're still getting a runtime error (index out of range) however the problem is that <code>thingList</code> is not of type <code>[]interface{}</code> but rather <code>interface{}</code> so you can't append to it. Here's an updated version of your code on playground that does a type assertion to convert it to an <code>[]interface{}</code> in line with the append. In reality you need to do that on a separate line and check for errors.</p>\n\n<p><a href=\"https://play.golang.org/p/YMed0VDZrv\" rel=\"nofollow\">https://play.golang.org/p/YMed0VDZrv</a></p>\n\n<p>So to put some code here;</p>\n\n<pre><code>func genericAppender(thingList interface{}, thing interface{}) []interface{}  {\n    return append(thingList.([]interface{}), thing)\n}\n</code></pre>\n\n<p>will solve the basic problem you're facing. As noted, you still get runtime errors when indexing into the slice. Also, you could change the argument to avoid this by making it;</p>\n\n<pre><code>func genericAppender(thingList []interface{}, thing interface{}) []interface{} {\n    return append(thingList, thing)\n}\n</code></pre>\n\n<p>Here's a complete example of the second type; <a href=\"https://play.golang.org/p/dIuW_UG7XY\" rel=\"nofollow\">https://play.golang.org/p/dIuW_UG7XY</a></p>\n\n<p>Note I also corrected the runtime error. When you use make with 3 args they are, in this order, type, length, capacity. This means the length of the array is 0 so when you try to assign to indexes 0 and 1 it was causing a panic for IndexOutoFRange. Instead I removed the middle argument so it's <code>make([]interface{}, 10)</code> meaning the length is initially set to 10 so you can assign to those indexes.</p>\n"}, {"comments": [{"owner": {"reputation": 5450, "user_id": 942317, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/SY5ID.jpg?s=128&g=1", "display_name": "STEEL", "link": "https://stackoverflow.com/users/942317/steel"}, "edited": false, "score": 0, "creation_date": 1578684885, "post_id": 57731985, "comment_id": 105532564, "body": "You are saviour. I had implemented this to accept multiple types, but could not get it work. Your solutions shows how. Thanks again."}], "tags": [], "owner": {"reputation": 55, "user_id": 2482892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50dfa6d58b0b45cc604e83cd214237c6?s=128&d=identicon&r=PG", "display_name": "Mayank Bansal", "link": "https://stackoverflow.com/users/2482892/mayank-bansal"}, "is_accepted": false, "score": 1, "last_activity_date": 1567191628, "creation_date": 1567191628, "answer_id": 57731985, "question_id": 36458649, "link": "https://stackoverflow.com/questions/36458649/creating-generic-functions-for-multi-type-arrays-in-go/57731985#57731985", "title": "creating generic functions for multi type arrays in Go", "body": "<p>In the answer above if you do the following then it throws error. This is what the original question was about:</p>\n\n<pre><code>//genericAppender(subs, newCar). // Throws \"cannot use subs (type []submarine) as type []interface {} in argument to genericAppender\"\n</code></pre>\n\n<p>The trick is to convert your slice of specific type into a generic []interface{}. </p>\n\n<pre><code>func convertToGeneric(thingList interface{}) []interface{} {\n        input := reflect.ValueOf(thingList)\n        length := input.Len()\n        out := make([]interface{},length)\n        for i:=0 ;i &lt; length; i++ {\n           out[i] = input.Index(i).Interface()\n        }\n    return out\n}\n</code></pre>\n\n<p>This you can call the function like this:</p>\n\n<pre><code>genericAppender(convertToGeneric(subs), newCar)\n</code></pre>\n\n<p>You can check modified working code here: <a href=\"https://play.golang.org/p/0_Zmme3c8lT\" rel=\"nofollow noreferrer\">https://play.golang.org/p/0_Zmme3c8lT</a></p>\n"}], "owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3544, "favorite_count": 0, "accepted_answer_id": 36458716, "answer_count": 2, "score": 0, "last_activity_date": 1567191628, "creation_date": 1459964985, "question_id": 36458649, "link": "https://stackoverflow.com/questions/36458649/creating-generic-functions-for-multi-type-arrays-in-go", "title": "creating generic functions for multi type arrays in Go", "body": "<p>I am trying to create a generic function that can handle actions on slices in Go... for instance, append an item of any type to a slice of that same type. This is simply a generic purpose for a more complex solution, but overall the issue boils down to this example:</p>\n\n<pre><code>package main\n\ntype car struct {\n    make  string\n    color string\n}\n\ntype submarine struct {\n    name   string\n    length int\n}\n\nfunc genericAppender(thingList interface{}, thing interface{}) []interface{} {\n    return append(thingList, thing)\n}\n\nfunc main() {\n\n    cars := make([]car, 0, 10)\n    cars[0] = car{make: \"ford\", color: \"red\"}\n    cars[1] = car{make: \"chevy\", color: \"blue\"}\n\n    subs := make([]submarine, 0, 10)\n    subs[0] = submarine{name: \"sally\", length: 100}\n    subs[1] = submarine{name: \"matilda\", length: 200}\n\n    newCar := car{make: \"bmw\", color: \"white\"}\n    genericAppender(&amp;cars, newCar)\n\n}\n</code></pre>\n\n<p>The code playground is at this <a href=\"https://play.golang.org/p/2mESsiD6XD\" rel=\"nofollow\">location</a></p>\n\n<p>The above errors as follows: </p>\n\n<pre><code>prog.go:14: first argument to append must be slice; have interface {}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 2, "creation_date": 1459966379, "post_id": 36458566, "comment_id": 60530318, "body": "Since you are accessing the file system, that alone I would protect with a <code>mutex.Lock()</code>.  As for go-kit, perhaps a direct question on their Stack channel (which they are very active in) would answer if creating a new logger is thread safe."}], "answers": [{"tags": [], "owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "is_accepted": false, "score": 1, "last_activity_date": 1460111806, "last_edit_date": 1460111806, "creation_date": 1460109720, "answer_id": 36496792, "question_id": 36458566, "link": "https://stackoverflow.com/questions/36458566/goroutine-thread-safety-of-go-logging-struct-instantiation-utility-method/36496792#36496792", "title": "Goroutine thread safety of Go logging struct instantiation utility method", "body": "<p>Since your setting up of your Logger only involves library instantiation, creating a log file if it doesn't exist, opening the log file and no writing involved there will be no problem calling it from different go-routines since the shared data is not getting tampered with.</p>\n\n<p><em>Side note:</em> \nDesign wise it makes sense (assuming Logger is writing to the same file) to pass around the only instantiated instance of Logger for logging which would prevent two go-routines calling your setup function at the same time.</p>\n"}, {"tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": true, "score": 1, "last_activity_date": 1460112485, "creation_date": 1460112485, "answer_id": 36497750, "question_id": 36458566, "link": "https://stackoverflow.com/questions/36458566/goroutine-thread-safety-of-go-logging-struct-instantiation-utility-method/36497750#36497750", "title": "Goroutine thread safety of Go logging struct instantiation utility method", "body": "<p>First recommendation: Use the <code>-race</code> flag to <code>go build</code> and <code>go test</code>. It will almost always be able to tell you if you have a race condition. Although it might not in this case since you could end up calling your <code>os.Create()</code> and your <code>os.OpenFile()</code> simultaneously.</p>\n\n<p>So, second recommendation is to avoid, if at all possible, the \"If it exists/matches/has permissions Then open/delete/whatever\" pattern.</p>\n\n<p>That pattern leads to the TOCTTOU (Time of Check To Time Of Use) bug, which is often a security bug and can at the very least lead to data loss.</p>\n\n<p>To avoid it either wrap the check and use into the same mutex, or use atomic operations, such as an OpenFile call that creates the file or returns an error if it already existed (although to be technical, its locked inside the OS kernel. Just like how atomic CPU ops are locked in the hardware bus.).</p>\n\n<p>In your case here I am not quite sure why you have two Open calls since it looks like just one would do the job.</p>\n"}], "owner": {"reputation": 12542, "user_id": 480807, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fd3c806f94926cbe683f3ddc878ae4d3?s=128&d=identicon&r=PG", "display_name": "Casey Flynn", "link": "https://stackoverflow.com/users/480807/casey-flynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "accepted_answer_id": 36497750, "answer_count": 2, "score": 0, "last_activity_date": 1460112485, "creation_date": 1459964758, "last_edit_date": 1459977724, "question_id": 36458566, "link": "https://stackoverflow.com/questions/36458566/goroutine-thread-safety-of-go-logging-struct-instantiation-utility-method", "title": "Goroutine thread safety of Go logging struct instantiation utility method", "body": "<p>I'm working with a new go service and I have a <code>SetupLogger</code> utility function that creates a new instance of go-kit's logging struct <code>log.Logger</code>.</p>\n\n<p>Is this method safe to invoke from code that's handling requests inside separate go-routines?</p>\n\n<pre><code>package utils\n\nimport (\n    \"fmt\"\n    \"github.com/go-kit/kit/log\"\n    \"io\"\n    \"os\"\n    \"path/filepath\"\n)\n\n// If the environment-specified directory for writing log files exists, open the existing log file\n// if it already exists or create a log file if no log file exists.\n// If the environment-specified directory for writing log files does not exist, configure the logger\n// to log to process stdout.\n// Returns an instance of go-kit logger\nfunc SetupLogger() log.Logger {\n    var logWriter io.Writer\n    var err error\n\n    LOG_FILE_DIR := os.Getenv(\"CRAFT_API_LOG_FILE_DIR\")\n    LOG_FILE_NAME := os.Getenv(\"CRAFT_API_LOG_FILE_NAME\")\n\n    fullLogFilePath := filepath.Join(\n        LOG_FILE_DIR,\n        LOG_FILE_NAME,\n    )\n\n    if dirExists, _ := Exists(&amp;ExistsOsCheckerStruct{}, LOG_FILE_DIR); dirExists {\n        if logFileExists, _ := Exists(&amp;ExistsOsCheckerStruct{}, fullLogFilePath); !logFileExists {\n            os.Create(fullLogFilePath)\n        }\n        logWriter, err = os.OpenFile(fullLogFilePath, os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)\n        if err != nil {\n            fmt.Println(\"Could not open log file. \", err)\n        }\n    } else {\n        logWriter = os.Stdout\n    }\n\n    return log.NewContext(log.NewJSONLogger(logWriter)).With(\n        \"timestamp\", log.DefaultTimestampUTC,\n        \"caller\", log.DefaultCaller,\n    )\n}\n</code></pre>\n"}, {"tags": ["go", "types", "casting"], "comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 1, "creation_date": 1459962683, "post_id": 36457728, "comment_id": 60527966, "body": "Off the top of my head, although I find that I am having to invent a use case for what it appears you&#39;re trying to do above, I would suggest something like: switch on what you&#39;re calling &quot;raw&quot; here; then call a func depending the result of the switch and return whatever type is appropriate for your case."}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1459963372, "post_id": 36457728, "comment_id": 60528443, "body": "Oh wait. what about passing in and returning an interface{} and then switching on the type after the return?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1459963677, "post_id": 36457728, "comment_id": 60528639, "body": "Are the incoming types restricted to bool, int and float? You should return the empty interface type; <code>interface{}</code> from <code>parse</code>. Go is not like Java or C# where you have a base class of <code>Object</code> that everything inherits from. Instead you have an empty interface that all types implement. In the scope where you called <code>parse</code> you can use a type switch/type assertions to get the concrete type out of the <code>interface{}</code>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1459963790, "post_id": 36457728, "comment_id": 60528705, "body": "Probably the whole notion of &quot;optimal type&quot; is misleading: If you do not know the type you cannot process it any further (except type switches)."}, {"owner": {"reputation": 801, "user_id": 5388567, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d0171125d3261a31e3ab7792913f74c8?s=128&d=identicon&r=PG", "display_name": "Valkyrie", "link": "https://stackoverflow.com/users/5388567/valkyrie"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1459963890, "post_id": 36457728, "comment_id": 60528768, "body": "@Volker it&#39;s definite that the incoming type is <code>string</code>, thus I can parse"}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1465395208, "post_id": 36457728, "comment_id": 62883925, "body": "@Emilia I know this question is a little old and likely you&#39;ve handled the problem and moved on but I improved the answer, so hopefully something of it is (more) useful to you now."}], "answers": [{"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": false, "score": -1, "last_activity_date": 1465503981, "last_edit_date": 1465503981, "creation_date": 1459968490, "answer_id": 36459843, "question_id": 36457728, "link": "https://stackoverflow.com/questions/36457728/cast-string-to-most-fitting-type/36459843#36459843", "title": "Cast string to most fitting type", "body": "<h1>Edit</h1>\n\n<p><em>The original example was correct but wasn't all that helpful, and it didn't satisfy the OP's requirements. I've since updated the answer so that it works in the given context... and I hope it is also helpful.</em></p>\n\n<p>You can return an interface{} and then switch on the return type, something like this:</p>\n\n<pre><code>package main\n\nimport \"strconv\"\n\nfunc parse(raw string, block int) interface{} {\n    if block == 0 {\n        if raw == \"true\" || raw == \"false\" {\n            if ok, err := strconv.ParseBool(raw); err == nil {\n                return ok\n            }\n        } \n        return parse(raw, block+1)\n\n    } else if block == 1 {\n        if res, err := strconv.ParseInt(raw, 10, 64); err == nil {\n            return res\n        }\n        return parse(raw, block+1)\n\n    } else if block == 2 {\n        if res, err := strconv.ParseFloat(raw, 64); err == nil {\n            return res\n        }\n        return parse(raw, block+1)\n    }\n    return raw\n}\n\nfunc main() {\n    a := parse(\"10.1\", 0)\n    switch a.(type) {\n    case bool:\n        //do something with a.(bool))\n    case float64:\n        //do something with a.(float64))\n    case int64:\n        //do something with a.(int64))\n    case string:\n        // do something with a.(string)\n    }\n}\n</code></pre>\n\n<p>Notable differences between this and your original example:</p>\n\n<ul>\n<li><p>You have to return that semi-recursive function call, not merely call it, else you eventually return raw unless your first case (<code>block == 0</code>) returns.</p></li>\n<li><p>It is necessary to check <code>ParseInt()</code> before <code>ParseFloat()</code> as an int can always satisfy the conditions of a float, not the other way around however.</p></li>\n<li><p>Unless you need methods on the return type you can simply return interface{}, and there is no need to declare a type.</p></li>\n<li><p>And finally, for no other reason than style, I opted for returning on <code>err == nil</code> vs. calling <code>parse(raw, block+1)</code> on <code>err != nil</code>; ultimately either get the same result.</p></li>\n</ul>\n"}], "owner": {"reputation": 801, "user_id": 5388567, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d0171125d3261a31e3ab7792913f74c8?s=128&d=identicon&r=PG", "display_name": "Valkyrie", "link": "https://stackoverflow.com/users/5388567/valkyrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1465503981, "creation_date": 1459962222, "last_edit_date": 1592644375, "question_id": 36457728, "link": "https://stackoverflow.com/questions/36457728/cast-string-to-most-fitting-type", "title": "Cast string to most fitting type", "body": "<p>I'm aware that using the <code>strconv</code> package, one can parse a string to whatever type they need. However, with the program I'm making, I won't know the optimal type of the variable I need to parse at runtime. Is there a better way to do this than the one I have? (My code is ugly, terrible, and awful. I <em>really</em> want to figure out a better solution.)</p>\n<h3>relevant code</h3>\n<pre><code>import(\n    &quot;strconv&quot;\n    &quot;fmt&quot;\n)\n\ntype object interface{}\n\nfunc parse(raw string,block int) object{\n    if block==0{\n        if raw==&quot;true&quot;{\n            return true\n        }else if raw==&quot;false&quot;{\n            return false\n        }else{\n            parse(raw,block+1)\n        }\n    }else if block==1{\n        res,err:=strconv.ParseFloat(raw,64)\n        if err!=nil{parse(raw,block+1)}\n        return res\n    }else if block==2{\n        res,err:=strconv.ParseInt(raw,10,64)\n        if err!=nil{parse(raw,block+1)}\n        return res\n    }\n    return raw\n}\n</code></pre>\n<p>edit: using the <code>object</code> type blocks me from using the returned value in it's type, so that needs to go, too.</p>\n"}, {"tags": ["go", "streaming", "channel", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 595, "user_id": 1107942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18f0f0f1c9e4088e7a36872dd95f13d8?s=128&d=identicon&r=PG", "display_name": "MrSaints", "link": "https://stackoverflow.com/users/1107942/mrsaints"}, "is_accepted": true, "score": 1, "last_activity_date": 1459985302, "last_edit_date": 1459985302, "creation_date": 1459984744, "answer_id": 36464007, "question_id": 36457512, "link": "https://stackoverflow.com/questions/36457512/how-to-structure-a-go-web-server-using-channels-and-goroutines/36464007#36464007", "title": "How to structure a Go web server, using channels and goroutines?", "body": "<p>I'm not entirely sure if this addresses your problem as I'm not fully aware of your use case, but nevertheless, I've come up with a solution below.</p>\n\n<p>I've used Gin for the HTTP router because it was more comfortable to me, but I'm pretty sure you can adapt the code to fit yours. I did this in a hurry (sorry), so there may be problems I'm not aware of, but do let me know if there are any.</p>\n\n<p>In short:</p>\n\n<ol>\n<li>I created a <code>Manager</code> that takes care of several <code>Client</code>. It also contains a <code>sync.Mutex</code> to ensure only one <em>thread</em> is modifying the <code>clients</code> at any given time;</li>\n<li>There is an <code>InitBackgroundTask()</code> that will generate a random <code>float64</code> number, and pass it to ALL <code>clients</code> in a <code>Manager</code> (if there are any). If there aren't any <code>clients</code>, we just sleep, and carry on...</li>\n<li>The index handler deals with adding, and removing clients. Clients are identified through a UUID;</li>\n<li>3 things can happen now. Clients are automatically removed when they disconnect via the <code>&lt;-c.Writer.CloseNotify()</code> channel (because the method returns thereby calling the <code>defer</code>). We can also receive the random <code>float64</code> number in the next background task <em>tick</em>. Finally, we can also terminate if we have not received anything in 20s.</li>\n</ol>\n\n<p>I made several assumptions about your needs here (e.g. that the background task will return X every Y minutes). If you are looking for more fine grain streaming, I'd recommend using websockets instead (and the pattern below can still be used).</p>\n\n<p>Let me know if you have any questions.</p>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gin-gonic/gin\"\n    \"github.com/satori/go.uuid\"\n    \"log\"\n    \"math/rand\"\n    \"net/http\"\n    \"sync\"\n    \"time\"\n)\n\ntype Client struct {\n    uuid string\n    out  chan float64\n}\n\ntype Manager struct {\n    clients map[string]*Client\n    mutex   sync.Mutex\n}\n\nfunc NewManager() *Manager {\n    m := new(Manager)\n    m.clients = make(map[string]*Client)\n    return m\n}\n\nfunc (m *Manager) AddClient(c *Client) {\n    m.mutex.Lock()\n    defer m.mutex.Unlock()\n    log.Printf(\"add client: %s\\n\", c.uuid)\n    m.clients[c.uuid] = c\n}\n\nfunc (m *Manager) DeleteClient(id string) {\n    m.mutex.Lock()\n    defer m.mutex.Unlock()\n    // log.Println(\"delete client: %s\", c.uuid)\n    delete(m.clients, id)\n}\n\nfunc (m *Manager) InitBackgroundTask() {\n    for {\n        f64 := rand.Float64()\n        log.Printf(\"active clients: %d\\n\", len(m.clients))\n        for _, c := range m.clients {\n            c.out &lt;- f64\n        }\n        log.Printf(\"sent output (%+v), sleeping for 10s...\\n\", f64)\n        time.Sleep(time.Second * 10)\n    }\n}\n\nfunc main() {\n    r := gin.Default()\n    m := NewManager()\n\n    go m.InitBackgroundTask()\n\n    r.GET(\"/\", func(c *gin.Context) {\n        cl := new(Client)\n        cl.uuid = uuid.NewV4().String()\n        cl.out = make(chan float64)\n\n        defer m.DeleteClient(cl.uuid)\n        m.AddClient(cl)\n\n        select {\n        case &lt;-c.Writer.CloseNotify():\n            log.Printf(\"%s : disconnected\\n\", cl.uuid)\n        case out := &lt;-cl.out:\n            log.Printf(\"%s : received %+v\\n\", out)\n            c.JSON(http.StatusOK, gin.H{\n                \"output\": out,\n            })\n        case &lt;-time.After(time.Second * 20):\n            log.Println(\"timed out\")\n        }\n    })\n\n    r.Run()\n}\n</code></pre>\n\n<p>Note: if you're testing this on Chrome, you might have to append a random parameter at the end of the URL so that the request will actually be made, e.g. <code>?rand=001</code>, <code>?rand=002</code> and so on.</p>\n"}], "owner": {"reputation": 38, "user_id": 2693973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bkPYm.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2693973/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2326, "favorite_count": 2, "accepted_answer_id": 36464007, "answer_count": 1, "score": 1, "last_activity_date": 1459985302, "creation_date": 1459961595, "last_edit_date": 1459978028, "question_id": 36457512, "link": "https://stackoverflow.com/questions/36457512/how-to-structure-a-go-web-server-using-channels-and-goroutines", "title": "How to structure a Go web server, using channels and goroutines?", "body": "<p>I am implementing a server to stream many arrays of floats. I need some help to design my system to achieve the following:</p>\n\n<ul>\n<li>The audio process must be independent and does its work even if there isn't any request coming in. My current approach make the DataProcess function to wait until there is a request.</li>\n<li>Because the channel can only give data to 1 request, how can 2 or more requests get the data I've prepared in the DataProcess?</li>\n<li>To actually stream data, the request handler cant wait for the whole DataProcess to finish, is there anyway to give the handler data as soon as we complete each iteration in the DataProcess?</li>\n</ul>\n\n<p>Any reply is appreciated. This is my current thoughts:</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"io\"\n\"net/http\"\n\"strconv\"\n\"time\"\n)\n\nfunc main() {\n    c := AudioProcess()\n    handleHello := makeHello(c)\n\n    http.HandleFunc(\"/\", handleHello)\n    http.ListenAndServe(\":8000\", nil)\n}\n\nfunc makeHello(c chan string) func(http.ResponseWriter, *http.Request) {\n    return func(w http.ResponseWriter, r *http.Request) {\n        for item := range c { // this loop runs when channel c is closed\n            io.WriteString(w, item)\n        }\n    }\n}\n\nfunc AudioProcess() chan string {\n    c := make(chan string)\n    go func() {\n        for i := 0; i &lt;= 10; i++ { // Iterate the audio file\n            c &lt;- strconv.Itoa(i) // have my frame of samples, send to channel c\n            time.Sleep(time.Second)\n            fmt.Println(\"send \", i) // logging\n        }\n        close(c) // done processing, close channel c\n        }()\n        return c\n    }\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1459958872, "creation_date": 1459958872, "answer_id": 36456530, "question_id": 36456232, "link": "https://stackoverflow.com/questions/36456232/insertion-sort-in-golang/36456530#36456530", "title": "Insertion sort in golang", "body": "<p>A couple of things:</p>\n\n<ul>\n<li>scanf isn't a function (you probably want fmt.Scanf)</li>\n<li>arrays aren't slices ( [100]int is a different type than []int)</li>\n<li>you can't print trace(A,N) because it doesn't return a value</li>\n</ul>\n"}], "owner": {"reputation": 25, "user_id": 5237648, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-X530ch3WG2o/AAAAAAAAAAI/AAAAAAAACX4/G1n1TDsfWoE/photo.jpg?sz=128", "display_name": "Yoshihro Hasegawa", "link": "https://stackoverflow.com/users/5237648/yoshihro-hasegawa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 36456530, "answer_count": 1, "score": -2, "last_activity_date": 1460034651, "creation_date": 1459958087, "last_edit_date": 1460034651, "question_id": 36456232, "link": "https://stackoverflow.com/questions/36456232/insertion-sort-in-golang", "title": "Insertion sort in golang", "body": "<pre><code>package main\n    import(\n      \"fmt\"\n    )\n</code></pre>\n\n<p>Output an element of the sequence in turn.</p>\n\n<pre><code>func trace(A[]int,N int){\n  for i :=0; i &lt; N; i++{\n    if i &gt; 0 {\n      fmt.Println(\" \")\n      fmt.Println(\"%d\",A[i])\n    }\n  }\n    fmt.Println(\"\\n\")\n}\n</code></pre>\n\n<p>0-rigin</p>\n\n<pre><code>func insertionSort(A[]int, N int) (int int) {\n      for i := 0; i &lt; N; i++{\n        v := A[i]\n        j := i -  1\n        for j &gt;= 0 &amp;&amp; A[j] &gt; v{\n          A[j + 1] = A[j]\n          j--\n        }\n          A[ j + 1 ] = v\n          trace(A,N)\n      }\n      return int\n    }\n</code></pre>\n\n<p>The above code has an error and the code below also has an error.    </p>\n\n<pre><code>   func main() {\n      var N,i,j int\n      var A[100]int\n      scanf(\"%d\",&amp;N)\n      for i:= 0;  i &lt; N; i++ {\n        scanf(\"%d\",&amp;A[i])\n      }\n      fmt.Println(trace(A,N))\n      fmt.Println(insertionSort(A,N))\n\n      return 0\n    }\n</code></pre>\n\n<p>This is all in C and lots of the errors occured in <code>Main</code>.</p>\n\n<p>go1.5.2</p>\n"}, {"tags": ["go", "cascade", "operation", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 6077258, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-M_m1jAgxY80/AAAAAAAAAAI/AAAAAAAAABk/5BaP46al-xs/photo.jpg?sz=128", "display_name": "J&#233;r&#233;my Bricout", "link": "https://stackoverflow.com/users/6077258/j%c3%a9r%c3%a9my-bricout"}, "is_accepted": false, "score": 0, "last_activity_date": 1460368116, "creation_date": 1460368116, "answer_id": 36545225, "question_id": 36456019, "link": "https://stackoverflow.com/questions/36456019/how-treat-cascade-operation-with-gorm-go/36545225#36545225", "title": "How treat cascade operation with GORM (Go)", "body": "<p>I have implemented this solution for responding to my problem : </p>\n\n<pre><code>func DeleteContentCascade(content *Content, db *gorm.DB, debug bool) error {\n\n  if debug {\n      db = db.Debug()\n  }\n\n  for _, child := range content.Children {\n      DeleteChildCascade(&amp;child, db, debug) //Custom method like the current\n  }\n\n  if err := db.Delete(content).Error; err != nil {\n      return err\n  }\n\n  return nil\n}\n</code></pre>\n\n<p>For every \"Item\" File in my DB management, I have created a custom function DeleteCascade.</p>\n\n<p>I hope it'll help :)</p>\n"}, {"tags": [], "owner": {"reputation": 396, "user_id": 5271400, "user_type": "registered", "profile_image": "https://graph.facebook.com/842781095836945/picture?type=large", "display_name": "Wilson Tamarozzi", "link": "https://stackoverflow.com/users/5271400/wilson-tamarozzi"}, "is_accepted": false, "score": 5, "last_activity_date": 1576877257, "last_edit_date": 1576877257, "creation_date": 1484158611, "answer_id": 41597918, "question_id": 36456019, "link": "https://stackoverflow.com/questions/36456019/how-treat-cascade-operation-with-gorm-go/41597918#41597918", "title": "How treat cascade operation with GORM (Go)", "body": "<p>To perform cascade exclusion, you must add the foreign key between the tables.</p>\n\n<p>This is an example I used where task history gets linked to tasks. When I delete the task, it already deletes the history.</p>\n\n<p><strong>Add Foreign Key</strong></p>\n\n<pre><code>// Add foreign key\n// 1st param : foreignkey field\n// 2nd param : destination table(id)\n// 3rd param : ONDELETE\n// 4th param : ONUPDATE\ndb.Model(&amp;User{}).AddForeignKey(\"city_id\", \"cities(id)\", \"RESTRICT\", \"RESTRICT\")\n</code></pre>\n\n<p><strong>My example:</strong></p>\n\n<pre><code>db.Model(&amp;models.TaskHistoric{}).AddForeignKey(\"task_uuid\", \"tasks(uuid)\", \"CASCADE\", \"CASCADE\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 5341267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206547982193940/picture?type=large", "display_name": "James Vare Samuel", "link": "https://stackoverflow.com/users/5341267/james-vare-samuel"}, "is_accepted": false, "score": 2, "last_activity_date": 1568184989, "last_edit_date": 1568184989, "creation_date": 1565718831, "answer_id": 57483015, "question_id": 36456019, "link": "https://stackoverflow.com/questions/36456019/how-treat-cascade-operation-with-gorm-go/57483015#57483015", "title": "How treat cascade operation with GORM (Go)", "body": "<pre><code>type Bucketlist struct {\n    gorm.Model\n    Name      string           `json:\"name\"`\n    CreatedBy string           `json:\"created_by\"`\n    UserID    uint             `json:\"user_id\"`\n    Item      []BucketlistItem `json:\"item\"`\n}\n\ntype BucketlistItem struct {\n    gorm.Model\n    Name         string `json:\"name\"`\n    Done         bool   `json:\"done\"`\n    BucketlistID uint   `json:\"bucketlist_id,omitempty\"`\n}\n\n// AfterDelete hook defined for cascade delete\nfunc (bucketlist *Bucketlist) AfterDelete(tx *gorm.DB) error {\n    return tx.Model(&amp;BucketlistItem{}).Where(\"bucketlist_id = ?\", bucketlist.ID).Unscoped().Delete(&amp;BucketlistItem{}).Error\n}\n</code></pre>\n\n<p>This works for me</p>\n\n<p><strong>Context</strong>: \nWhen a bucketlist model instance is deleted, the corresponding items(1 up to x) are also deleted using the AfterDelete hook. </p>\n"}], "owner": {"reputation": 99, "user_id": 6077258, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-M_m1jAgxY80/AAAAAAAAAAI/AAAAAAAAABk/5BaP46al-xs/photo.jpg?sz=128", "display_name": "J&#233;r&#233;my Bricout", "link": "https://stackoverflow.com/users/6077258/j%c3%a9r%c3%a9my-bricout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6575, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1576877257, "creation_date": 1459957497, "last_edit_date": 1518702800, "question_id": 36456019, "link": "https://stackoverflow.com/questions/36456019/how-treat-cascade-operation-with-gorm-go", "title": "How treat cascade operation with GORM (Go)", "body": "<p>I'm testing out Go's GORM lib.\nI find this lib particularly useful and, step by step, I play with more and more complicated notions.</p>\n\n<p>I'm facing the problem of cascading operation management.</p>\n\n<p>On certain issues, the creator suggests to use the AfterDelete.\nThe problem is : in the After/BeforeDelete functions, nested items are not present.</p>\n\n<p>Is everyone have a good way to implement this ?</p>\n\n<p>Here is my code (almost working if someone is discovering Gorm) :</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/sqlite\"\n    \"fmt\"\n    \"github.com/satori/go.uuid\"\n)\n\ntype Company struct {\n    ID        string     `gorm:\"primary_key;column:ID\"`\n    Name      string     `sql:\"size:255;unique;index\" gorm:\"column:Name\"`\n    Employees []Employee // one-to-many relationship\n    Address   Address    // one-to-one relationship\n}\n\nfunc (u Company) TableName() string {\n    return \"Company\"\n}\nfunc (u Company) String() string {\n    return fmt.Sprintf(\"ID: %s | Name: %s | Employees: %v | Address: %v \", u.ID, u.Name, u.Employees, u.Address)\n}\nfunc (u *Company) BeforeCreate(scope *gorm.Scope) error {\n    scope.SetColumn(\"ID\", uuid.NewV4().String())\n    return nil\n}\nfunc (u *Company) BeforeDelete(scope *gorm.Scope) error {\n    fmt.Println(\"BeforeDelete\")\n    fmt.Println(u)\n    return nil\n}\nfunc (u *Company) AfterDelete(scope *gorm.Scope) error {\n    fmt.Println(\"AfterDelete\")\n    fmt.Println(u)\n    return nil\n}\n\ntype Employee struct {\n    ID        string        `gorm:\"primary_key;column:ID\"`\n    FirstName        string    `gorm:\"column:FirstName\"`\n    LastName         string    `gorm:\"column:LastName\"`\n    SocialSecurityNo string    `gorm:\"column:SocialSecurityNo\"`\n    DateOfBirth      time.Time `sql:\"DEFAULT:current_timestamp\" gorm:\"column:DateOfBirth\"`\n    Deleted          bool      `sql:\"DEFAULT:false\" gorm:\"column:Deleted\"`\n    CompanyID    string    `gorm:\"column:Company_ID\"`\n    Roles []Role // one-to-many relationship\n}\nfunc (u Employee) TableName() string {\n    return \"Employee\"\n}\nfunc (u Employee) String() string {\n    return fmt.Sprintf(\"ID: %s | FirstName: %s | Roles: %v \", u.ID, u.FirstName, u.Roles)\n}\nfunc (u *Employee) BeforeCreate(scope *gorm.Scope) error {\n    scope.SetColumn(\"ID\", uuid.NewV4().String())\n    return nil\n}\n\ntype Role struct {\n    Name string `gorm:\"column:Name\"`\n    Code string `gorm:\"column:Code\"`\n    EmployeeID string `gorm:\"column:Employee_ID\"`\n}\nfunc (u Role) TableName() string {\n    return \"Role\"\n}\nfunc (u Role) String() string {\n    return fmt.Sprintf(\"Name: %s | Code: %s\", u.Name, u.Code)\n}\n\ntype Address struct {\n    Country  string `gorm:\"column:Country\"`\n    City     string `gorm:\"column:City\"`\n    PostCode string `gorm:\"column:PostCode\"`\n    Line1    string `gorm:\"column:Line1\"`\n    Line2    string `gorm:\"column:Line2\"`\n    CompanyID    string `gorm:\"column:Company_ID\"`\n}\nfunc (u Address) TableName() string {\n    return \"Address\"\n}\n\nfunc main() {\n    db := getDBConnection()\n    //If needed, you can create the file and schemas with the line below\n    createTables(db)\n    testCRUD(db)\n}\n\nfunc getDBConnection() (db *gorm.DB) {\n    //Change the file location for your needs\n    db, err := gorm.Open(\"sqlite3\", `C:\\Users\\jbricout\\Desktop\\TestORM.db`)\n    if err != nil {\n        panic(err)\n    }\n\n    // Ping function checks the database connectivity\n    err = db.DB().Ping()\n    if err != nil {\n        panic(err)\n    }\n\n    return db\n}\n\nfunc createTables(db *gorm.DB) {\n    if err := db.CreateTable(&amp;Company{}).Error; err != nil {\n        checkErr(err)\n    }\n    if err := db.CreateTable(&amp;Address{}).Error; err != nil {\n        checkErr(err)\n    }\n    if err := db.CreateTable(&amp;Employee{}).Error; err != nil {\n        checkErr(err)\n    }\n    if err := db.CreateTable(&amp;Role{}).Error; err != nil {\n        checkErr(err)\n    }\n}\n\nfunc testCRUD(db *gorm.DB) {\n    sampleCompany := getInitializedCompany()\n\n    fmt.Println(\"Insert...\")\n    if err := db.Create(&amp;sampleCompany).Error; err != nil {\n        checkErr(err)\n    }\n    fmt.Println(\"Insert done with id : \", sampleCompany.ID)\n\n    fmt.Println(\"Find Only Company (Lazy load)...\")\n    var firstComp Company\n    if err := db.Where(\"ID = ?\", sampleCompany.ID).First(&amp;firstComp).Error; err != nil {\n        checkErr(err)\n    }\n    fmt.Println(\"Company : \", firstComp)\n    fmt.Println(\"Find done\")\n\n    fmt.Println(\"Find Only Company (Eager load)...\")\n    var fullComp Company\n\n    db.Preload(\"Employees.Roles\").Preload(\"Address\").First(&amp;fullComp)\n    if err := db.Where(\"ID = ?\", sampleCompany.ID).First(&amp;fullComp).Error; err != nil {\n        checkErr(err)\n    }\n    fmt.Println(\"Company : \", fullComp)\n    fmt.Println(\"Find done\")\n\n    fmt.Println(\"Update...\")\n    firstComp.Name = \"Google Plus\"\n    if len(firstComp.Address.Country) &gt; 0 {\n        firstComp.Address.Country = \"France\"\n    }\n\n    if err := db.Save(&amp;firstComp).Error; err != nil {\n        checkErr(err)\n    }\n    fmt.Println(\"Update done\")\n\n    transaction := db.Begin()\n    fmt.Println(\"Delete...\")\n    if err := transaction.Delete(&amp;firstComp).Error; err != nil {\n        checkErrTransaction(err, transaction)\n    }\n\n    transaction.Commit()\n    fmt.Println(\"Delete done\")\n}\n\nfunc getInitializedCompany() Company {\n    return Company{\n        Name: \"Google\",\n        Address: Address{\n            Country:  \"USA\",\n            City:     \"Moutain View\",\n            PostCode: \"1600\",\n            Line1: \"Cloverfield Lane, 32\",\n            Line2: \"Apt 64\",\n        },\n        Employees: []Employee{\n            Employee{\n                FirstName:        \"John\",\n                LastName:         \"Doe\",\n                SocialSecurityNo: \"00-000-0000\",\n                Roles: []Role{\n                    Role{\n                        Name: \"Metier 1\",\n                        Code: \"MET1\",\n                    },\n                    Role{\n                        Name: \"Metier 2\",\n                        Code: \"MET2\",\n                    },\n                },\n            },\n            Employee{\n                FirstName:        \"James\",\n                LastName:         \"Dean\",\n                SocialSecurityNo: \"00-000-0001\",\n                Roles: []Role{\n                    Role{\n                        Name: \"Metier 1\",\n                        Code: \"MET1\",\n                    },\n                },\n            },\n            Employee{\n                FirstName:        \"Joan\",\n                LastName:         \"Dutsch\",\n                SocialSecurityNo: \"00-000-0002\",\n                Roles: []Role{\n                    Role{\n                        Name: \"Metier 2\",\n                        Code: \"MET3\",\n                    },\n                },\n            },\n        },\n    }\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc checkErrTransaction(err error, transaction *gorm.DB) {\n    transaction.Rollback()\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1459957372, "post_id": 36455328, "comment_id": 60524361, "body": "You are using <code>b</code> by value, because everything in Go is passed by value."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1459957335, "creation_date": 1459957335, "answer_id": 36455949, "question_id": 36455328, "link": "https://stackoverflow.com/questions/36455328/why-the-function-append-in-go-work-with-reference-when-pass-a-slice/36455949#36455949", "title": "Why the function append in Go work with reference when pass a slice?", "body": "<p>There is no way to insert a slice \"by value\"; you need to make a <a href=\"https://godoc.org/builtin#copy\" rel=\"nofollow\">copy</a> of the slice before inserting it:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc copy_ints(c []int) []int {\n    s := make([]int, len(c))\n    copy(s, c)\n    return s\n}\n\nfunc main() {\n    a := []int{1}\n    arr := [][]int{copy_ints(a)}\n\n    b := []int{2}\n\n    arr = append(arr, copy_ints(b))\n    fmt.Println(arr)\n\n    b[0] = 3\n    arr = append(arr, copy_ints(b))\n\n    fmt.Println(arr)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Tds5FGj3nf\" rel=\"nofollow\">https://play.golang.org/p/Tds5FGj3nf</a></p>\n"}], "owner": {"reputation": 355, "user_id": 222077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c206874803821bccabc2b22958f2971a?s=128&d=identicon&r=PG", "display_name": "josegil", "link": "https://stackoverflow.com/users/222077/josegil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 36455949, "answer_count": 1, "score": -1, "last_activity_date": 1459959208, "creation_date": 1459955726, "last_edit_date": 1459959208, "question_id": 36455328, "link": "https://stackoverflow.com/questions/36455328/why-the-function-append-in-go-work-with-reference-when-pass-a-slice", "title": "Why the function append in Go work with reference when pass a slice?", "body": "<p>In the next code I'm trying to add an element of a slice of slices, but as Go works with reference, how can I use this by using the b slice by value?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    a := []int{1}\n    arr := [][]int{a}\n\n    b := []int{2}\n\n    arr = append(arr, b)\n    fmt.Println(arr)\n\n    b[0] = 3\n    arr = append(arr, b)   \n\n    fmt.Println(arr)\n}\n</code></pre>\n\n<p>I expected that the last Println was [[1] [2] [3]], but it's [[1] [3] [3]].</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1459953216, "post_id": 36453709, "comment_id": 60521104, "body": "Rule of thumb with Go, which was co-invented by Ken Thompson, one of the heads behind UNIX: &quot;No news are good news.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 3, "last_activity_date": 1459953166, "creation_date": 1459953166, "answer_id": 36454233, "question_id": 36453709, "link": "https://stackoverflow.com/questions/36453709/go-testing-no-output/36454233#36454233", "title": "Go - Testing - No output", "body": "<p>Passing tests aren't displayed by default. Hence the <code>-v</code> option\u2026</p>\n"}], "owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1567, "favorite_count": 0, "accepted_answer_id": 36454233, "answer_count": 1, "score": -1, "last_activity_date": 1459959236, "creation_date": 1459951865, "last_edit_date": 1459959236, "question_id": 36453709, "link": "https://stackoverflow.com/questions/36453709/go-testing-no-output", "title": "Go - Testing - No output", "body": "<p>I have the following test which is working but isn't giving the \"official\" output when running:</p>\n\n<pre><code>func TestDeployLive(t *testing.T) {\n// EXPECTING PASS\nun, pw := GetGlobalAdminLogins()\nsc, err, _ := PostImage(\"apps/10130/icon\", un, pw, \"/valid.png\")\nsc2, err2, _ := PostImage(\"apps/10130/learn-more-image\", un, pw, \"/valid-learn-more.png\")\n\nif err != nil &amp;&amp; err2 != nil {\n    t.Error(\"Fail\")\n} else {\n    if sc != 200 || sc2 != 200 {\n        t.Error(\"Fail\")\n    } else {\n        deploy, err3, json := DeployApp(\"apps/10130/deploy\", un, pw, \"live\")\n        fmt.Print(deploy)\n        if err3 != nil {\n            t.Error(\"Fail\")\n        } else {\n            if deploy != 200 {\n                t.Error(\"Fail\")\n            } else {\n                if json.Data[0].LiveDate != nil {\n                    fmt.Println(\"Pass Live\")\n                    t.Logf(\"Success\")\n                } else {\n                    fmt.Println(\"Fail Live\")\n                    t.Error(\"Fail\")\n                }\n            }\n        }\n      }\n   }\n}\n</code></pre>\n\n<p>My output is:\n<code>200</code>\n<code>Pass Live</code></p>\n\n<p>Which as you can see means the test has passed but I am not getting the proper \n<code>--- FAIL: TestIconImagePost (0.76s)</code> for example.</p>\n\n<p>Do I have to do something to get the output to display - my other tests are displaying the output correctly?</p>\n\n<p>UPDATE:</p>\n\n<p>If i run with -v on the end it will show it, and shows its passing. But my question is, why do all my other tests show up without the need for <code>-v</code> but this new test needs it?</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["php", "go", "rsa", "password-encryption"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459948116, "post_id": 36450743, "comment_id": 60516971, "body": "This looks dangerous: why do you need to RSA encrypt a password? You should be using a suitable hash/KDF, since it&#39;s extremely rare you need to decrypt user passwords."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459948348, "post_id": 36450743, "comment_id": 60517162, "body": "I am not trying to decrypt, I am trying to encrypt. My aim is to login to steamcommunity.com with a go script."}, {"owner": {"reputation": 30119, "user_id": 2224584, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gbVrH.png?s=128&g=1", "display_name": "Scott Arciszewski", "link": "https://stackoverflow.com/users/2224584/scott-arciszewski"}, "edited": false, "score": 0, "creation_date": 1460061034, "post_id": 36450743, "comment_id": 60582458, "body": "<code>$rsa-&gt;setEncryptionMode(CRYPT_RSA_ENCRYPTION_PKCS1);</code> <a href=\"http://framework.zend.com/security/advisory/ZF2015-10\" rel=\"nofollow noreferrer\">Seems legit</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459945429, "post_id": 36450942, "comment_id": 60514711, "body": "I implimented this code and receive the following error: panic: runtime error: invalid memory address or nil pointer dereference. Here is the complete message <a href=\"http://pastebin.com/8EbvkuEH\" rel=\"nofollow noreferrer\">pastebin.com/8EbvkuEH</a>"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459945527, "post_id": 36450942, "comment_id": 60514788, "body": "@Acidic what is line 72?"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459945546, "post_id": 36450942, "comment_id": 60514803, "body": "modulus, bol := new(big.Int).SetString(decoded[&quot;publickey_mod&quot;].(string), 16 /* = base 16 */) \tif !bol { \t\treturn errors.New(&quot;Unable to set modulus.&quot;) \t}  \tpublicKey.N = modulus"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459945575, "post_id": 36450942, "comment_id": 60514823, "body": "That&#39;s from line 67 to 72. Line 72 is where I set publicKey.N = modulus"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459945735, "post_id": 36450942, "comment_id": 60514937, "body": "<code>var publicKey *rsa.PublicKey</code> should be <code>var publicKey rsa.PublicKey</code> and pass it to <code>rsa.EncryptPKCS1v15</code> like <code>&amp;publicKey</code>."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459951189, "post_id": 36450942, "comment_id": 60519418, "body": "My encrypted password looks something like <a href=\"http://pastebin.com/Pe1incYg\" rel=\"nofollow noreferrer\">pastebin.com/Pe1incYg</a> when it should look something like <a href=\"http://pastebin.com/kkXRLNBi\" rel=\"nofollow noreferrer\">pastebin.com/kkXRLNBi</a> ... Any further ideas of what I may be doing wrong when encrypting?"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459954501, "post_id": 36450942, "comment_id": 60522131, "body": "I fixed it, I had to base64 encrypt the encrypted password again to result in what I wanted."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1459945110, "creation_date": 1459945110, "answer_id": 36450942, "question_id": 36450743, "link": "https://stackoverflow.com/questions/36450743/go-how-to-set-rsa-publickey-modulus-from-string/36450942#36450942", "title": "Go - How to Set RSA PublicKey Modulus from String?", "body": "<p><code>decoded[\"publickey_mod\"]</code> is a hex string, you need to convert it to a big.Int:</p>\n\n<pre><code>publicKey.N, _ = new(big.Int).SetString(decoded[\"publickey_mod\"].(string), 16 /* = base 16 */)\n// json numbers are float64 by default unless you use a struct and force a type\npublicKey.E = int(decoded[\"publickey_exp\"].(float64))\n</code></pre>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1355, "favorite_count": 0, "accepted_answer_id": 36450942, "answer_count": 1, "score": 0, "last_activity_date": 1459959255, "creation_date": 1459944640, "last_edit_date": 1459959255, "question_id": 36450743, "link": "https://stackoverflow.com/questions/36450743/go-how-to-set-rsa-publickey-modulus-from-string", "title": "Go - How to Set RSA PublicKey Modulus from String?", "body": "<p>I am trying to encrypt a password with Go's <a href=\"https://golang.org/pkg/crypto/rsa/\" rel=\"nofollow\">RSA</a> package.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"net/http\"\n    \"strconv\"\n    \"io/ioutil\"\n    \"encoding/json\"\n    \"errors\"\n    \"crypto/rsa\"\n    \"crypto/rand\"\n    //\"math/big\"\n)\n\nfunc main() {\n    if err := Login(\"username\", \"password\"); err != nil {\n        fmt.Println(err)\n    }\n}\n\nfunc Login(username, password string) error {\n    doNotCache := strconv.FormatInt(time.Now().UnixNano() / int64(time.Millisecond), 10)\n\n    // Get RSA Key\n    resp, err := http.PostForm(\"https://steamcommunity.com/login/getrsakey/\", map[string][]string{\n        \"donotcache\": {doNotCache},\n        \"username\": {username},\n    })\n    if err != nil {\n        return err\n    }\n\n    content, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        return err\n    }\n\n    var decoded map[string]interface{}\n    err = json.Unmarshal(content, &amp;decoded)\n    if err != nil {\n        return err\n    }\n\n    if decoded[\"success\"] != true {\n        return errors.New(\"Failed to retrieve RSA key.\")\n    }\n\n    // Set encryption variables\n    var privateKey *rsa.PrivateKey\n    var publicKey *rsa.PublicKey\n    var plain_text, encrypted []byte\n\n    plain_text = []byte(password)\n\n    // Generate Private Key\n    if privateKey, err = rsa.GenerateKey(rand.Reader, 1024); err != nil {\n        return err\n    }\n\n    privateKey.Precompute()\n\n    if err = privateKey.Validate(); err != nil {\n        return err\n    }\n\n    publicKey.N = decoded[\"publickey_mod\"].(string) // &lt;- This is not right, I need to create a modulus from the publickey_mod string and it needs to be of type big.Int\n    publicKey.E = decoded[\"publickey_exp\"].(int)\n\n    encrypted, err = rsa.EncryptPKCS1v15(rand.Reader, publicKey, plain_text)\n    if err != nil {\n        return err\n    }\n\n    fmt.Printf(\"PKCS1 Encrypted [%s] to \\n[%x]\\n\", string(plain_text), encrypted)\n\n    return nil\n}\n</code></pre>\n\n<p>I am unable to set the publicKey.N value to a big.Int from a given string.</p>\n\n<p>variable <code>decoded[\"publickey_mod\"]</code> looks something like this:</p>\n\n<p><code>D3ABCD8303F887E0C7B390E088F24A797FE7084555FFB8BCE21F25EDD1F0DD02F48743EBAEC6BEEA6789DDC2AB51C7297A73957AC5CBEE7F4F8281EF6F47EDBDC83C366CDDAF087802082BE1620749754D05078F9EE4E71B4B6B5B3C6B999652F99F019B65468C632FC918C6840B63F801A49C5938F7BFCEB8EB913222A568CB2FE2F3E90911C1EAE9592F2811FD9E156068ABE18540542647D13A70D73F6DC5363A68426C3F9B1EC20FB29BB6920D784DF7724B31321A3CF9320CC657CA4044BB59AE4AFC4497FEC0DC032004183D5116F456A0C9A303E942EEEA6635A4E00C8DED8D6EAB67708682AC04FC18AB3CA1705C18E17DA9C6F06E2A0FDC905C88E3</code></p>\n\n<p>and variable <code>decoded[\"publickey_mod\"]</code> looks something like <code>010001</code></p>\n\n<p>I am trying to encrypt a this password for <a href=\"https://steamcommunity.com/\" rel=\"nofollow\">https://steamcommunity.com/</a>.</p>\n\n<hr>\n\n<p>I have encrypted with this exact method using <strong>PHP</strong> before with a class called <a href=\"https://github.com/pear/Math_BigInteger\" rel=\"nofollow\">Math_BigInteger</a> and this is how I made the publickey and encrypted the password:</p>\n\n<pre><code>$key = array(\n    'n' =&gt; new Math_BigInteger($curl-&gt;response-&gt;publickey_mod,16),\n    'e' =&gt; new Math_BigInteger($curl-&gt;response-&gt;publickey_exp,16)\n);\n\n// Define exponent\ndefine('CRYPT_RSA_EXPONENT', 010001);\n\n// Load the key\n$rsa-&gt;loadKey($key)\n\n// Set settings\n$rsa-&gt;setEncryptionMode(CRYPT_RSA_ENCRYPTION_PKCS1);\n$rsa-&gt;setHash('sha256');\n\n// Encrypt password\n$encrypted_password = base64_encode($rsa-&gt;encrypt($password));\n</code></pre>\n\n<p>Help would be extremely appreciated, thanks in advance.</p>\n\n<p><a href=\"https://play.golang.org/p/wmkgu2_Q20\" rel=\"nofollow\">https://play.golang.org/p/wmkgu2_Q20</a></p>\n"}, {"tags": ["rest", "web", "go", "jwt"], "answers": [{"tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1459944973, "creation_date": 1459944973, "answer_id": 36450892, "question_id": 36449724, "link": "https://stackoverflow.com/questions/36449724/mixed-named-and-unnamed-function-parameters/36450892#36450892", "title": "Mixed named and unnamed function parameters", "body": "<p>You are defining a function inline (of type <code>jwt.Keyfunc</code>), but not binding it to anything.  If <code>VerifyKey</code> is of type jwt.Keyfunc, then you can just change line 13 to</p>\n\n<pre><code>token, err := jwt.ParseFromRequest(r, VerifyKey)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 8704703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60855792cb2a878def95aaf544796e89?s=128&d=identicon&r=PG&f=1", "display_name": "Lizzz", "link": "https://stackoverflow.com/users/8704703/lizzz"}, "is_accepted": false, "score": 5, "last_activity_date": 1506879660, "last_edit_date": 1506879660, "creation_date": 1506877910, "answer_id": 46514815, "question_id": 36449724, "link": "https://stackoverflow.com/questions/36449724/mixed-named-and-unnamed-function-parameters/46514815#46514815", "title": "Mixed named and unnamed function parameters", "body": "<pre><code>token, err := jwt.ParseFromRequest(r, func(token *jwt.Token) (interface{}, err error)\n</code></pre>\n\n<p>Your function here returns two parameters, an interface, and and error.</p>\n\n<p>You need to name BOTH like <code>( x interface{}, err error )</code></p>\n\n<p>or</p>\n\n<p>You need to name NEITHER like <code>( interface{}, error )</code></p>\n\n<p>because,</p>\n\n<p>What you have there right now is a parameter list of two error type parameters.</p>\n\n<p>Like when you say:</p>\n\n<pre><code>var x, y, z int\n</code></pre>\n\n<p>you have a list of ints, you wrote that you have 2 comma-separated variables of type error named <code>interface{}</code> and <code>err</code>. The compiler knows <code>interface{}</code> is a stupid name for an error variable, and is pointing out that you need a variable for the first (what it presumes is really a) type, or you should ditch the word <code>err</code>.</p>\n"}], "owner": {"reputation": 419, "user_id": 4142855, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-2FYIVZaaVow/AAAAAAAAAAI/AAAAAAAAALo/SMJpZYi-MQ8/photo.jpg?sz=128", "display_name": "alexcons", "link": "https://stackoverflow.com/users/4142855/alexcons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10054, "favorite_count": 0, "accepted_answer_id": 36450892, "answer_count": 2, "score": 2, "last_activity_date": 1506880696, "creation_date": 1459941951, "last_edit_date": 1506880696, "question_id": 36449724, "link": "https://stackoverflow.com/questions/36449724/mixed-named-and-unnamed-function-parameters", "title": "Mixed named and unnamed function parameters", "body": "<p>I have this function for authenticating JWT tokens (not middleware), which says:</p>\n\n<pre><code>package main\n\nimport (\n\"net/http\"\n\"log\"\n\"fmt\"\n\"github.com/dgrijalva/jwt-go\"\n)\n\nfunc ValidateToken(w http.ResponseWriter, r *http.Request) *jwt.Token {\n\n//parse token\ntoken, err := jwt.ParseFromRequest(r, func(token *jwt.Token) (interface{}, err error) {\n    return VerifyKey, nil\n})\n\n//validate token\nif err != nil {\n\n    switch err.(type) {\n\n    //something went wrong during validation\n    case *jwt.ValidationError:\n        vErr := err.(*jwt.ValidationError)\n\n        switch vErr.Errors {\n\n        case jwt.ValidationErrorExpired:\n            w.WriteHeader(http.StatusUnauthorized)\n            fmt.Fprintln(w, \"Token expired\")\n            return nil\n\n        default:\n            w.WriteHeader(http.StatusInternalServerError)\n            fmt.Fprintln(w, \"Error parsing token\")\n            log.Printf(\"Validation error: %v\\n\", err)\n            return nil\n        }\n\n\n    //something else went wrong\n    default:\n        w.WriteHeader(http.StatusInternalServerError)\n        fmt.Fprintln(w, \"Error parsing token\")\n        log.Printf(\"Validation error: %v\\n\", err)\n        return nil\n    }\n\n}\n\nreturn token\n\n}\n</code></pre>\n\n<p>Then, in my handlers, I call this function to get the token and check if it is valid using the Valid property in the JWT Token struct. However, when I run the web server, I get an error on line 13, saying: </p>\n\n<pre><code>Mixed named and unnamed function parameters\n</code></pre>\n\n<p>Line 13 is the jwt.ParseFromRequest() call. Any thoughts on what I am doing wrong? I am new to Go.</p>\n"}, {"tags": ["go", "imagemagick", "imagick", "go-imagick"], "comments": [{"owner": {"reputation": 22900, "user_id": 778719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/B4v0w.jpg?s=128&g=1", "display_name": "Danack", "link": "https://stackoverflow.com/users/778719/danack"}, "edited": false, "score": 0, "creation_date": 1460058500, "post_id": 36446678, "comment_id": 60581003, "body": "You almost certainly want to separate the process of generating a mask of the image to remove pixels from the actual pixel removal process. That will allow you to do &#39;destructive&#39; things to the mask, while leaving the image pixels you want untouched. This may be an inspiration - <a href=\"http://phpimagick.com/Tutorial/backgroundMasking\" rel=\"nofollow noreferrer\">phpimagick.com/Tutorial/backgroundMasking</a>"}], "answers": [{"comments": [{"owner": {"reputation": 144829, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1471946123, "post_id": 39097443, "comment_id": 65542615, "body": "If you use <code>convert 10x10.jpg -fuzz 2000 -format %@ info:</code> it will give you the crop you need directly without the extraneous stuff you are ignoring...."}, {"owner": {"reputation": 143, "user_id": 2061202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647ca4f150d64c0bf32d3c26cd83e90f?s=128&d=identicon&r=PG", "display_name": "fvm", "link": "https://stackoverflow.com/users/2061202/fvm"}, "reply_to_user": {"reputation": 144829, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1471948164, "post_id": 39097443, "comment_id": 65543953, "body": "Yes, thanks for pointing that out. I used separate steps here to illustrate the different steps in the process and how blurring helps overcome the noise. And of course that there&#39;s more info which you can get, etc."}, {"owner": {"reputation": 143, "user_id": 2061202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647ca4f150d64c0bf32d3c26cd83e90f?s=128&d=identicon&r=PG", "display_name": "fvm", "link": "https://stackoverflow.com/users/2061202/fvm"}, "reply_to_user": {"reputation": 144829, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1471979960, "post_id": 39097443, "comment_id": 65565551, "body": "@MarkSetchell Upon re-reading my original answer and your comment, I&#39;ve decided to rewrite the original, taking your suggestion into account."}, {"owner": {"reputation": 18331, "user_id": 961018, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/jdMgW.jpg?s=128&g=1", "display_name": "mmm", "link": "https://stackoverflow.com/users/961018/mmm"}, "reply_to_user": {"reputation": 144829, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1602942167, "post_id": 39097443, "comment_id": 113881856, "body": "@MarkSetchell What is the 2000 for ?"}], "tags": [], "owner": {"reputation": 143, "user_id": 2061202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647ca4f150d64c0bf32d3c26cd83e90f?s=128&d=identicon&r=PG", "display_name": "fvm", "link": "https://stackoverflow.com/users/2061202/fvm"}, "is_accepted": true, "score": 7, "last_activity_date": 1471981759, "last_edit_date": 1471981759, "creation_date": 1471944630, "answer_id": 39097443, "question_id": 36446678, "link": "https://stackoverflow.com/questions/36446678/best-way-to-remove-borders-crop-image/39097443#39097443", "title": "Best way to remove borders / crop image", "body": "<p>Basically, your problem is that you have a high-frequency, high-amplitude artifact at the edge of your image. Or, put differently, a sharp, high peak at the edge, which, if you want to use trim, forces you to use such a high a fuzz-value to overcome this, that the algorithm also considers the 'actual content' as equal to the 'background' (border).</p>\n\n<p>One solution here is to use a multi-step approach, whereby you first smooth out the edge artifacts and then apply trim to the resulting image. By smoothing it out, you get rid of the high peak and smear it out into a nice rolling hill. Rolling hills, in turn, can be easily trimmed with low fuzz values. This then provides you with the desired geometry which you can use to crop the original.</p>\n\n<p>Specifically, let's take the original image:\n<a href=\"https://i.stack.imgur.com/a1hN1.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/a1hN1.jpg\" alt=\"Original Image\"></a></p>\n\n<p>Now, let's smooth out that ridge on the edge using a blur with a radius of 10 and a sigma of 10 through <code>convert original.jpg -blur 10x10 10x10.jpg</code>, which yields:\n<a href=\"https://i.stack.imgur.com/r8D7b.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/r8D7b.jpg\" alt=\"10x10 blurred image\"></a></p>\n\n<p>Now, you might notice that the artifacts on the edge have now pretty much disappeared.</p>\n\n<p>We can now do a 'virtual' trim and ask ImageMagick what the result of the trim would be through <code>convert 10x10.jpg -fuzz 2000 -format %@ info:</code>, which, according to the documentation gives you the \"<em>trim bounding box (without actually trimming)</em>\": <code>1326x1560+357+578%</code> </p>\n\n<p>Taking these values (except for the percentage sign) and using them for crop geometry, gives you the convert with crop command <code>convert original.jpg -crop 1326x1560+357+578 cropped.jpg</code>, which gives you:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DCS8P.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/DCS8P.jpg\" alt=\"cropped image without noise\"></a></p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Now, since you want this as code, using <a href=\"https://godoc.org/gopkg.in/gographics/imagick.v2/imagick\" rel=\"noreferrer\" title=\"imagick\">imagick</a>, here's the solution in code. It assumes you have the file stored as './data/original.jpg' and will store it as './data/trimmed.jpg'</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n  \"fmt\"\n\n  \"gopkg.in/gographics/imagick.v2/imagick\"\n)\n\nfunc init() {\n  imagick.Initialize()\n}\n\nconst originalImageFilename = \"data/original.jpg\"\n\nfunc main() {\n\n  mw := imagick.NewMagickWand()\n  err := mw.ReadImage(originalImageFilename)\n  if err != nil {\n    fmt.Sprint(err.Error())\n    return\n  }\n\n  // Use a clone to determine what will happen\n  mw2 := mw.Clone()\n\n  mw2.BlurImage(10, 10)\n  mw2.TrimImage(2000)\n\n  _, _, xOffset, yOffset, err := mw2.GetImagePage()\n  if err != nil {\n    fmt.Sprint(err.Error())\n    return\n  }\n\n  trimmedWidth := mw2.GetImageWidth()\n  trimmedHeight := mw2.GetImageHeight()\n\n  mw2.Destroy()\n\n  mw.CropImage(trimmedWidth, trimmedHeight, xOffset, yOffset)\n\n  mw.WriteImage(\"data/trimmed.jpg\")\n  mw.Destroy()\n}\n</code></pre>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1432, "favorite_count": 1, "accepted_answer_id": 39097443, "answer_count": 1, "score": 2, "last_activity_date": 1471981759, "creation_date": 1459934242, "last_edit_date": 1459972454, "question_id": 36446678, "link": "https://stackoverflow.com/questions/36446678/best-way-to-remove-borders-crop-image", "title": "Best way to remove borders / crop image", "body": "<p>I am using a <a href=\"https://github.com/gographics/imagick\" rel=\"nofollow\">Go package</a> (Go binding to ImageMagick's MagickWand C API) to ImageMagick where I'm removing borders from images (cropping). The way I am using the trim function can be found below.</p>\n\n<p>Now the problem is the fuzzy factor. For example, if I set the value to 2000, the image (<a href=\"https://dl.dropboxusercontent.com/u/15684927/tshirt-original.jpg\" rel=\"nofollow\">here</a> is the source) still has some white images like these:</p>\n\n<ul>\n<li>fuzz factor value 2000 --> <a href=\"https://dl.dropboxusercontent.com/u/15684927/fuzzy-2000-outcome.jpg\" rel=\"nofollow\">result</a></li>\n<li>fuzz factor value 10000 --> <a href=\"https://dl.dropboxusercontent.com/u/15684927/fuzzy-10000-outcome.jpg\" rel=\"nofollow\">result</a></li>\n</ul>\n\n<p>I have created a small html which illustrates the problem best. It contains both images: <a href=\"https://dl.dropboxusercontent.com/u/15684927/image-trim-problem.html\" rel=\"nofollow\">https://dl.dropboxusercontent.com/u/15684927/image-trim-problem.html</a></p>\n\n<p>As you can see the source has some pixels on the bottom right corner which are causing the trouble. If I set the factor to 10000, I'm afraid that I will loose pixels on other pictures. If I set it on 2000, the trimming isn't done right in pictures like these.</p>\n\n<p>So my actual question is: what is the best way to \"crop\" / \"trim\" images?</p>\n\n<pre><code>package main\n\nimport \"gopkg.in/gographics/imagick.v1/imagick\"\n\nfunc main() {\n    imagick.Initialize()\n    defer imagick.Terminate()\n\n    inputFile := \"tshirt-original.jpg\"\n    outputFile := \"trimmed.jpg\"\n    mw := imagick.NewMagickWand()\n    // Schedule cleanup\n    defer mw.Destroy()\n\n    // read image\n    err := mw.ReadImage(inputFile)\n    if err != nil {\n        panic(err)\n    }\n\n    // first trim original image\n    // fuzz: by default target must match a particular pixel color exactly.\n    // However, in many cases two colors may differ by a small amount. The fuzz\n    // member of image defines how much tolerance is acceptable to consider two\n    // colors as the same. For example, set fuzz to 10 and the color red at\n    // intensities of 100 and 102 respectively are now interpreted as the same\n    // color for the purposes of the floodfill.\n    mw.TrimImage(10000)\n\n    // Set the compression quality to 95 (high quality = low compression)\n    err = mw.SetImageCompressionQuality(95)\n    if err != nil {\n        panic(err)\n    }\n\n    // save\n    err = mw.WriteImage(outputFile)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1459940582, "post_id": 36446675, "comment_id": 60511023, "body": "The first version of Foo does not work. Unmarshal to result, not pointer to result. <code>json.Unmarshal([]byte(some_string), result)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23513, "user_id": 1029936, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BZUZK.png?s=128&g=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/1029936/bill"}, "edited": false, "score": 0, "creation_date": 1459965593, "post_id": 36448282, "comment_id": 60529863, "body": "Only problem is that I don&#39;t know the concrete type of result inside of Foo. That&#39;s why I&#39;m using interface{}.  Do I need to use reflect to figure that out?"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "reply_to_user": {"reputation": 23513, "user_id": 1029936, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BZUZK.png?s=128&g=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/1029936/bill"}, "edited": false, "score": 0, "creation_date": 1459997937, "post_id": 36448282, "comment_id": 60543216, "body": "Bill, sorry I overlooked it. Updated the answer with the best solution I could come up with. I hope you have thought through using this API. Maybe you could change it to just return data instead of assigning it to a pointer?"}, {"owner": {"reputation": 23513, "user_id": 1029936, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BZUZK.png?s=128&g=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/1029936/bill"}, "edited": false, "score": 0, "creation_date": 1460000719, "post_id": 36448282, "comment_id": 60543903, "body": "I need to pass in a referenced struct for the deserialization case anyways and no matter how I refactor I&#39;m always going to eventually get down to a point where I&#39;m either loading a struct or deserializing a string.  It ends up being something like foo(result interface{}, load Loader) (interface{}, error) which is fine but not as clean as I was hoping for."}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 5, "last_activity_date": 1459999700, "last_edit_date": 1459999700, "creation_date": 1459938267, "answer_id": 36448282, "question_id": 36446675, "link": "https://stackoverflow.com/questions/36446675/go-passing-a-return-value-via-an-interface-pointer/36448282#36448282", "title": "Go: Passing a return value via an interface{} pointer", "body": "<p>You can do,</p>\n\n<pre><code>p := result.(*Bar)\n*p = data\n</code></pre>\n\n<p>The first line is a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a>.</p>\n\n<p>The second assigns <code>data</code> to the dereferenced pointer. Assigning a value to a dereferenced pointer changes the value at the referenced address. </p>\n\n<p>Since you don't know the underlying types of <code>result</code> or <code>data</code> the best you can do is using a type assertion switch.</p>\n\n<pre><code>switch v := data.(type) {\ncase Bar:\n    // If 'data' is of type 'Bar'\n    p, ok := result.(*Bar)\n    if(!ok){\n        // This means inputs were bad.\n        // 'result' and 'data' should both have the same underlying type.\n        fmt.Println(\"underlying types mismatch\")\n        break;\n    }\n\n    *p = v\n\ncase Baz:\n    // If 'data' is of type 'Baz'\n    // Equivalent of above for 'Baz'\n}\n</code></pre>\n\n<p>See <strong>Type Switches</strong> from <a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"nofollow\">switch statement</a></p>\n"}], "owner": {"reputation": 23513, "user_id": 1029936, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BZUZK.png?s=128&g=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/1029936/bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 36448282, "answer_count": 1, "score": 2, "last_activity_date": 1459999700, "creation_date": 1459934238, "last_edit_date": 1459967363, "question_id": 36446675, "link": "https://stackoverflow.com/questions/36446675/go-passing-a-return-value-via-an-interface-pointer", "title": "Go: Passing a return value via an interface{} pointer", "body": "<p>I have a function that looks like this:</p>\n\n<pre><code>func Foo(result interface{}) error {\n     ...\n     json.Unmarshal([]byte(some_string), result)\n     ...\n}\n</code></pre>\n\n<p>Which is called like this:</p>\n\n<pre><code>var bar Bar\nFoo(&amp;bar)\n</code></pre>\n\n<p>Generally, Foo fetches a string that is then unmarshalled into the result. However, now I need to update it so that Foo sometimes loads data from another source and returns that instead. </p>\n\n<pre><code>type Loader func() (interface{})\n\nfunc Foo(result interface{}, Loader load) error {\n     ...\n     data := load()\n     // result = data ???\n     ...\n}\n</code></pre>\n\n<p>Is there any way for me to assign this new value to result? I found that I can marshal the data into a string and then unmarshal it into result which works, but I can't imagine that's the best way.</p>\n"}, {"tags": ["go", "utf-8", "db2"], "answers": [{"comments": [{"owner": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "edited": false, "score": 0, "creation_date": 1460011561, "post_id": 36460371, "comment_id": 60548131, "body": "still the same result: my &quot;normal&quot; datasets contains two characters, except those with two bytes UTF-8 encoding"}], "tags": [], "owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "is_accepted": false, "score": 0, "last_activity_date": 1459970065, "creation_date": 1459970065, "answer_id": 36460371, "question_id": 36446127, "link": "https://stackoverflow.com/questions/36446127/go-query-db2-delivers-not-all-characters-utf-8-from-table/36460371#36460371", "title": "Go query (db2) delivers not all characters (utf-8) from table", "body": "<p>You cannot scan into your struct, you have to scan into a <code>sql.NullString</code> variable or a <code>string</code> and then assign to your struct:</p>\n\n<pre><code>for rows.Next() {\n    var s sql.NullString\n    rows.Scan(&amp;s)\n    c := Code{Code: s}\n\n    log.PrintLn(c.Code)     //  &lt;== '\u00d6'\n    result = append(result, c)\n}\n</code></pre>\n\n<p>Also: The field tag <code>sql</code> has no effect (or do you use sqlx? If yes you have to use StructScan instead of Scan)</p>\n"}], "owner": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 436, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459970065, "creation_date": 1459932893, "last_edit_date": 1459959324, "question_id": 36446127, "link": "https://stackoverflow.com/questions/36446127/go-query-db2-delivers-not-all-characters-utf-8-from-table", "title": "Go query (db2) delivers not all characters (utf-8) from table", "body": "<p>complicated to express my problem, I try:</p>\n\n<p>I have a DB2-Table (internal codepage CP850)</p>\n\n<pre><code>create table codes (code character(2))\n</code></pre>\n\n<p>with a dataset of utf-8 characters</p>\n\n<pre><code>insert into codes values('\u00d6\u00d6')\n</code></pre>\n\n<p>under linux the db2-clients <code>select * from codes</code> delivers</p>\n\n<pre><code>code\n\u00d6\u00d6\n</code></pre>\n\n<p>as expected.</p>\n\n<p><strong>Now for the Go part, thats problematic.</strong></p>\n\n<p>my model looks like</p>\n\n<pre><code>package codes\ntype Code struct {\n  Code db.NullString `json:\"code\" sql:\"code\"`\n}\ntype Codes []*Code\n</code></pre>\n\n<p>and my query looks like</p>\n\n<pre><code>package codes\nfunc FindAll()(Codes, error) {\n  result := make(Codes, 0)\n  row, err := db.Query(nil, 'SELECT c.code FROM codes c');\n  //errorhandling...\n  for rows.Next() {\n    c := &amp;Code{}\n    rows.Scan(&amp;c.Code)\n    log.PrintLn(c.Code)     //  &lt;== '\u00d6'\n    result = append(result, c)\n  }\n  return result, nil\n}\n</code></pre>\n\n<p>This log only prints one <code>\u00d6</code> instead of both. I know it is because the rune <code>\u00d6</code> is not one byte in memory. But I do not know where to look for and fix as this is my first attempt to Go.</p>\n\n<p>(anything missing? i can provide)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1586, "user_id": 533209, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/72e5d3b00e13ada4c5c35569590014c3?s=128&d=identicon&r=PG", "display_name": "rwilson04", "link": "https://stackoverflow.com/users/533209/rwilson04"}, "edited": false, "score": 0, "creation_date": 1460009174, "post_id": 36442415, "comment_id": 60546877, "body": "negative votes without an explanation are so useless"}], "answers": [{"tags": [], "owner": {"reputation": 2809, "user_id": 680668, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0f594cfa76cdc7d3046871b2b0976697?s=128&d=identicon&r=PG", "display_name": "Ryan Atallah", "link": "https://stackoverflow.com/users/680668/ryan-atallah"}, "is_accepted": false, "score": 2, "last_activity_date": 1459921609, "creation_date": 1459921609, "answer_id": 36442525, "question_id": 36442415, "link": "https://stackoverflow.com/questions/36442415/how-to-use-variable-package-selector-in-go/36442525#36442525", "title": "How to use variable package selector in go", "body": "<p>No, there's no way to reference exported variables from a package, which are stored on the stack, without explicitly referencing them using a data structure that you define that's built at runtime.</p>\n\n<p>For example, you could do:</p>\n\n<pre><code>var days = map[string]time.Weekday{\n  \"Monday\":    time.Monday,\n  \"Tuesday\":   time.Tuesday,\n  \"Wednesday\": time.Wednesday,\n  \"Thursday\":  time.Thursday,\n  \"Friday\":    time.Friday,\n  \"Saturday\":  time.Saturday,\n  \"Sunday\":    time.Sunday,\n}\nfmt.Println(days[\"Thursday\"])\n</code></pre>\n\n<p>See <a href=\"http://play.golang.org/p/6EYqcklf8X\" rel=\"nofollow\">http://play.golang.org/p/6EYqcklf8X</a></p>\n"}], "owner": {"reputation": 1586, "user_id": 533209, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/72e5d3b00e13ada4c5c35569590014c3?s=128&d=identicon&r=PG", "display_name": "rwilson04", "link": "https://stackoverflow.com/users/533209/rwilson04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1459921609, "creation_date": 1459921123, "question_id": 36442415, "link": "https://stackoverflow.com/questions/36442415/how-to-use-variable-package-selector-in-go", "title": "How to use variable package selector in go", "body": "<p>I'm following the Go tour, and still trying to learn the basics of the language. For the imported package <code>time</code>, is there a way to access its exports with a variable? E.g. <code>time[day]</code> instead of <code>time.Saturday</code></p>\n\n<p>Here's a more complete example</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    day := \"Thursday\"\n    fmt.Printf(\"When's %v?\", day)\n    today := time.Now().Weekday()\n    switch time[day] { // This is how I would do it in javascript\n    case today + 0:\n        fmt.Println(\"Today.\")\n    default:\n        fmt.Println(\"Too far away.\")\n    }\n}\n</code></pre>\n\n<p>Also, what is the correct terminology for what I want to do? I'm having very little luck using Google</p>\n"}, {"tags": ["sockets", "networking", "go", "tcp", "ip"], "answers": [{"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "edited": false, "score": 0, "creation_date": 1459917860, "post_id": 36441005, "comment_id": 60497497, "body": "Set <code>SO_LINGER</code> to <code>true</code> with a zero timeout and then close the socket. Don&#39;t try this at home, kids. Or, close the socket when you know there is still unread data, or data being sent."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 0, "last_activity_date": 1459913705, "creation_date": 1459913705, "answer_id": 36441005, "question_id": 36440850, "link": "https://stackoverflow.com/questions/36440850/when-a-socket-is-disconnected-in-go-can-i-know-if-it-was-a-good-or-bad-close/36441005#36441005", "title": "When a socket is disconnected in Go, can I know if it was a good or bad close?", "body": "<p>It depends on the operating system. The one you're on clearly does a graceful close for you if your process exits with an unclosed socket, so it is equivalent to 'good'. With the other kind you will get an ECONNRESET.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6159031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1019b766a6ab0bfce642a8bdab737991?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6159031/eric"}, "is_accepted": false, "score": 0, "last_activity_date": 1459944872, "creation_date": 1459944872, "answer_id": 36450858, "question_id": 36440850, "link": "https://stackoverflow.com/questions/36440850/when-a-socket-is-disconnected-in-go-can-i-know-if-it-was-a-good-or-bad-close/36450858#36450858", "title": "When a socket is disconnected in Go, can I know if it was a good or bad close?", "body": "<p>You should call Read like this:</p>\n\n<pre><code> var done,closeCh chan struct{}\n\n func readLoop(c net.Conn) {\n   for {\n       n,err := conn.Read(buf)\n       // check n and err\n       close(closeCh)\n       // or\n       close(done)\n   }\n}\n\n\nfunc handle(conn net.Conn) {\n     go readLoop(conn)\n     select {\n       case &lt;-closeCh:\n         println(\"closed\")\n       case &lt;-done:\n         println(\"done\")\n     }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "edited": false, "score": 1, "creation_date": 1459957663, "post_id": 36455178, "comment_id": 60524602, "body": "fine with me you posted this, thanks for the info! EJP what say u?"}, {"owner": {"reputation": 453, "user_id": 6083111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba01cf3ef98244da8d16027dc3eb8a9?s=128&d=identicon&r=PG", "display_name": "user161778", "link": "https://stackoverflow.com/users/6083111/user161778"}, "reply_to_user": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "edited": false, "score": 0, "creation_date": 1459961695, "post_id": 36455178, "comment_id": 60527374, "body": "Looking at the source code I&#39;m beginning to doubt the GC interferes (&quot;c.fd.Close()&quot;). It&#39;s not impossible though. I never considered some libraries I&#39;ve been using might be doing some &quot;magic&quot; with goroutines in the background (like closing sockets for me). More on topic: The way I detect a clean close is I expect a logout packet of 1 byte, if I don&#39;t get it, it didn&#39;t close properly."}], "tags": [], "owner": {"reputation": 453, "user_id": 6083111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba01cf3ef98244da8d16027dc3eb8a9?s=128&d=identicon&r=PG", "display_name": "user161778", "link": "https://stackoverflow.com/users/6083111/user161778"}, "is_accepted": false, "score": 0, "last_activity_date": 1459955366, "creation_date": 1459955366, "answer_id": 36455178, "question_id": 36440850, "link": "https://stackoverflow.com/questions/36440850/when-a-socket-is-disconnected-in-go-can-i-know-if-it-was-a-good-or-bad-close/36455178#36455178", "title": "When a socket is disconnected in Go, can I know if it was a good or bad close?", "body": "<p>I know this isn't an answer but I can't comment and it's extremely frustrating because I tried to suggest an edit to just ask this question, and this app told me I couldn't <em>after</em> I wrote it. Please be merciful.</p>\n\n<p>@EJP Can you provide a source? I know what you're saying is true for C but almost literally everything is safe to let the GC handle for closes on program termination in Go. I'd wager it has nothing to do with the OS (but I could be mistaken) as the GC probably handles closing the socket properly for you anyways (see all the libraries which explain \"you can save time by ommiting 'Close' if the program execution is terminating\"). I'm considering asking a question of how far that goes but I've run into exactly one case where it doesn't handle the cleanup (and it's certainly not in a standard lib).</p>\n"}], "owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1235, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1459959351, "creation_date": 1459912500, "last_edit_date": 1459959351, "question_id": 36440850, "link": "https://stackoverflow.com/questions/36440850/when-a-socket-is-disconnected-in-go-can-i-know-if-it-was-a-good-or-bad-close", "title": "When a socket is disconnected in Go, can I know if it was a good or bad close?", "body": "<p>Say I open a connection to a server like:</p>\n\n<pre><code>conn, _ := net.DialTimeout(\"tcp\", \"127.0.0.1:2121\", 10000000)\n</code></pre>\n\n<p>and I do some stuff and then call</p>\n\n<pre><code>conn.Close()\n</code></pre>\n\n<p>that's option 1. But what if I don't call Close on the conn and just call</p>\n\n<pre><code>os.Exit(1)\n</code></pre>\n\n<p>leaving the connection still open. That's option 2. i.e. I'm trying to simulate a user uploading a file and either reaching the ending and really Closing the connection... or ending the stream being writen to the socket but never officially closing it.</p>\n\n<p>Back on the server side, is there anyway to tell which event happened? The good Close or the bad one?</p>\n\n<p>Does <code>net.Listener</code> have like some sort of callback to let me know. Because when I just call:</p>\n\n<pre><code>n, err := serverConn.Read()\n</code></pre>\n\n<p>I get an EOF err in either case, good or bad.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "is_accepted": false, "score": 2, "last_activity_date": 1459905384, "creation_date": 1459905384, "answer_id": 36439781, "question_id": 36439733, "link": "https://stackoverflow.com/questions/36439733/how-do-you-invoke-a-method-on-the-dynamic-type-of-a-variable/36439781#36439781", "title": "How do you invoke a method on the dynamic type of a variable?", "body": "<pre><code>func main() {\n    var Mstruct map[string]interface{}\n    Mstruct = make(map[string]interface{}, 100)\n    Mstruct[\"MyStruct\"] = &amp;MyStruct{}\n    m := Mstruct[\"MyStruct\"].(*MyStruct) //This is a type assertion\n    fmt.Println(reflect.TypeOf(m)) // *main.MyStruct\n    m.Action()\n}\n</code></pre>\n\n<p>Use type assertion.  After you assert that it is not nil and of the specified type, you can treat it as that type.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">https://golang.org/ref/spec#Type_assertions</a></p>\n\n<p><a href=\"https://play.golang.org/p/bJib9g7kDY\" rel=\"nofollow\">https://play.golang.org/p/bJib9g7kDY</a></p>\n"}, {"tags": [], "owner": {"reputation": 2678, "user_id": 5191913, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5b5ba3fc2faf13d6caa3e630dd074f06?s=128&d=identicon&r=PG&f=1", "display_name": "Savior", "link": "https://stackoverflow.com/users/5191913/savior"}, "is_accepted": true, "score": 3, "last_activity_date": 1459906514, "creation_date": 1459906514, "answer_id": 36439925, "question_id": 36439733, "link": "https://stackoverflow.com/questions/36439733/how-do-you-invoke-a-method-on-the-dynamic-type-of-a-variable/36439925#36439925", "title": "How do you invoke a method on the dynamic type of a variable?", "body": "<p>The expression</p>\n\n<pre><code>m := Mstruct[\"MyStruct\"]\n</code></pre>\n\n<p>is a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">short variable declaration</a>. The <a href=\"https://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow\">specification</a> states</p>\n\n<blockquote>\n  <p>If a type is present, each variable is given that type. Otherwise,\n  each variable is given the type of the corresponding initialization\n  value in the assignment.</p>\n</blockquote>\n\n<p>Since a type is not present in that expression, the variable <code>m</code> is given the type of the corresponding initialization value, <code>Mstruct[\"MyStruct\"]</code>. That type is <code>interface{}</code>. </p>\n\n<p>Based on your current imports, the method set of <code>interface{}</code> is empty. There's nothing you can invoke on a value of ype <code>interface{}</code>. Therefore the compiler rejects </p>\n\n<pre><code>m.Action()\n</code></pre>\n\n<p>You seem to want to use <code>m</code> as a method receiver based on its dynamic type, <code>*MyStruct</code>. You can do that with a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a>. For example</p>\n\n<pre><code>dynamic := m.(*MyStruct)\ndynamic.Action()\n</code></pre>\n\n<p>The specification states</p>\n\n<blockquote>\n  <p>If the type assertion holds, the value of the expression is the value\n  stored in <code>x</code> and its type is <code>T</code>.</p>\n</blockquote>\n\n<p>Its type here is <code>*MyStruct</code> which is the receiver type of your <code>Action</code> method. You can therefore invoke the method with the variable <code>dynamic</code>.</p>\n"}], "owner": {"reputation": 411, "user_id": 4737876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tygIZ.jpg?s=128&g=1", "display_name": "Muge", "link": "https://stackoverflow.com/users/4737876/muge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 36439925, "answer_count": 2, "score": 0, "last_activity_date": 1459922766, "creation_date": 1459905089, "last_edit_date": 1495540781, "question_id": 36439733, "link": "https://stackoverflow.com/questions/36439733/how-do-you-invoke-a-method-on-the-dynamic-type-of-a-variable", "title": "How do you invoke a method on the dynamic type of a variable?", "body": "<p>I found two questions and read them:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/36424907/reflection-struct-by-string/36425480#36425480\">Reflection: Struct by string</a></li>\n<li><a href=\"https://stackoverflow.com/questions/8103617/call-a-struct-and-its-method-by-name-in-go\">Call a Struct and its Method by name in Go?</a></li>\n</ul>\n\n<p>But I still don't understand why I tried mapping an Object that got error:</p>\n\n<p><code>./aaa.go:21: m.Action undefined (type interface {} is interface with no methods)</code></p>\n\n<pre><code>type MyStruct struct {\n}\n\nfunc (a *MyStruct) Action() {\n    fmt.Println(\"Hello\")\n}\n\nfunc main() {\n    var Mstruct map[string]interface{}\n    Mstruct = make(map[string]interface{}, 100)\n    Mstruct[\"MyStruct\"] = &amp;MyStruct{}\n    m := Mstruct[\"MyStruct\"]\n    fmt.Println(reflect.TypeOf(m)) // *main.MyStruct\n    m.Action()\n}\n</code></pre>\n\n<p>This always works in dynamic language, so I miss something in static language. </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 2678, "user_id": 5191913, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5b5ba3fc2faf13d6caa3e630dd074f06?s=128&d=identicon&r=PG&f=1", "display_name": "Savior", "link": "https://stackoverflow.com/users/5191913/savior"}, "is_accepted": false, "score": 10, "last_activity_date": 1459902811, "last_edit_date": 1459902811, "creation_date": 1459902448, "answer_id": 36439401, "question_id": 36439191, "link": "https://stackoverflow.com/questions/36439191/go-substring-operation-no-index-out-of-range/36439401#36439401", "title": "Go substring operation, no index out of range?", "body": "<p>As the <a href=\"https://golang.org/ref/spec#Slice_expressions\">language specification</a> states, given a slice expression</p>\n\n<pre><code>a[low : high]\n</code></pre>\n\n<blockquote>\n  <p>For arrays or strings, <strong>the indices are in range if <code>0 &lt;= low &lt;= high &lt;= len(a)</code>, otherwise they are out of range.</strong> [...] If the indices are out of range at run time, a run-time panic occurs.</p>\n</blockquote>\n\n<p>In your example</p>\n\n<pre><code>s[1:]\n</code></pre>\n\n<p>the <code>low</code> is <code>1</code>, <code>high</code> is <code>len(s)</code> and <code>len(s)</code> is <code>1</code>. Since <code>low &lt;= len(s)</code>, there's no panic. </p>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 2, "last_activity_date": 1459902820, "creation_date": 1459902820, "answer_id": 36439458, "question_id": 36439191, "link": "https://stackoverflow.com/questions/36439191/go-substring-operation-no-index-out-of-range/36439458#36439458", "title": "Go substring operation, no index out of range?", "body": "<p>It is, <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow\">by definition</a>, not out of range: any position from 0 to <code>len(s)</code> can be the beginning or the end of a range on <code>s</code>. The way that slice endpoints work is designed so that you can write correct code without a lot of extra checks or arithmetic. In particular,</p>\n\n<pre><code>first  = s[:x]\nsecond = s[x:]\n</code></pre>\n\n<p>will split <code>s</code> into two parts, with <code>first</code> having <code>x</code> bytes and <code>second</code> having the remainder of the string, for <em>any</em> value of <code>x</code> between 0 and <code>len(s)</code>. <code>first</code> will be an empty string if <code>x == 0</code>, and <code>second</code> will be an empty string if <code>x == len(s)</code>. This can only be true if the full range of values from 0 to <code>len(s)</code> is allowed, otherwise at least one of the possible split positions wouldn't be expressible.</p>\n"}], "owner": {"reputation": 104, "user_id": 2592554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c27897b7745d317db79cedc1849f81d6?s=128&d=identicon&r=PG", "display_name": "Jason Gu", "link": "https://stackoverflow.com/users/2592554/jason-gu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459959371, "creation_date": 1459901113, "last_edit_date": 1459959371, "question_id": 36439191, "link": "https://stackoverflow.com/questions/36439191/go-substring-operation-no-index-out-of-range", "title": "Go substring operation, no index out of range?", "body": "<p>I would like know why \"s[1:]\" in the 2nd fmt.Println isn't throwing an index out of range error? Index 1 is clearly out of range</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n   s := \"J\"\n\n   //fmt.Println(s[1]) // This results in a runtime error: index out of range\n\n   fmt.Println(s[1:]) // Why does this work? Index value 1 is clearly out of range, but the statement prints an empty string\n\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "is_accepted": true, "score": 1, "last_activity_date": 1471916142, "creation_date": 1471916142, "answer_id": 39091036, "question_id": 36438508, "link": "https://stackoverflow.com/questions/36438508/403-forbidden-on-local-google-cloud-storage-call/39091036#39091036", "title": "403 Forbidden on local Google Cloud Storage call", "body": "<p>It's trying to write on your remote Google Cloud Storage account. Seems like a current bug. For now you might have to create/reconfigure the default bucket on your account.</p>\n\n<p><a href=\"https://code.google.com/p/googleappengine/issues/detail?id=12883\" rel=\"nofollow\">Using the client library with the dev server not working in Go</a></p>\n"}], "owner": {"reputation": 1425, "user_id": 293581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d96c8822fa6bd112a3df4e45c16ea786?s=128&d=identicon&r=PG", "display_name": "Machiel", "link": "https://stackoverflow.com/users/293581/machiel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 39091036, "answer_count": 1, "score": 0, "last_activity_date": 1471916142, "creation_date": 1459896894, "question_id": 36438508, "link": "https://stackoverflow.com/questions/36438508/403-forbidden-on-local-google-cloud-storage-call", "title": "403 Forbidden on local Google Cloud Storage call", "body": "<p>I am using the default bucket name, but whenever I try to write a file, I get a <code>403 Forbidden</code>. It tries to write to a bucket named: <code>app_default_bucket</code>. </p>\n\n<p>This is the default bucket retrieved by <code>file.DefaultBucketName(ctx)</code>.</p>\n\n<p>Local file permissions also seem to be okay.</p>\n\n<p>In production everything works as expected.</p>\n"}, {"tags": ["sockets", "go", "zeromq"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1459894924, "post_id": 36437799, "comment_id": 60491019, "body": "What ZMQ library are you using on the Go side?"}, {"owner": {"reputation": 37873, "user_id": 1202421, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9ecf725ab72554a6fb27e979e3cd0a6?s=128&d=identicon&r=PG", "display_name": "Pedro Werneck", "link": "https://stackoverflow.com/users/1202421/pedro-werneck"}, "reply_to_user": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1459895431, "post_id": 36437799, "comment_id": 60491208, "body": "@sberry github.com/pebbe/zmq4, the one linked on #1"}, {"owner": {"reputation": 12998, "user_id": 545332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d8d3c844a9033a1c70daaaff2c4ab5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/545332/jason"}, "edited": false, "score": 0, "creation_date": 1459947710, "post_id": 36437799, "comment_id": 60516607, "body": "I&#39;m new to the Go world - is there a reason other than consistency that you would use inproc sockets rather than a hybrid system that uses ZMQ for external communication and Go channels for internal communication?"}, {"owner": {"reputation": 37873, "user_id": 1202421, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9ecf725ab72554a6fb27e979e3cd0a6?s=128&d=identicon&r=PG", "display_name": "Pedro Werneck", "link": "https://stackoverflow.com/users/1202421/pedro-werneck"}, "reply_to_user": {"reputation": 12998, "user_id": 545332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d8d3c844a9033a1c70daaaff2c4ab5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/545332/jason"}, "edited": false, "score": 0, "creation_date": 1459957376, "post_id": 36437799, "comment_id": 60524363, "body": "@Jason Because I can&#39;t use a channel with ZMQ poller. It would be great if I could use ZMQ sockets with Go&#39;s select or channels with the ZMQ poller."}], "answers": [{"comments": [{"owner": {"reputation": 37873, "user_id": 1202421, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9ecf725ab72554a6fb27e979e3cd0a6?s=128&d=identicon&r=PG", "display_name": "Pedro Werneck", "link": "https://stackoverflow.com/users/1202421/pedro-werneck"}, "edited": false, "score": 0, "creation_date": 1459910811, "post_id": 36438285, "comment_id": 60495510, "body": "Forget my previous comment. I got it now. In essence what it does is to use an <code>inproc</code> socket to break out of the infinite timeout and wrap everything in channels to make it more seamless. Nice one. Thanks."}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 5, "last_activity_date": 1459896078, "last_edit_date": 1459896078, "creation_date": 1459895716, "answer_id": 36438285, "question_id": 36437799, "link": "https://stackoverflow.com/questions/36437799/how-to-deal-with-zmq-sockets-lack-of-thread-safety/36438285#36438285", "title": "How to deal with ZMQ sockets lack of thread safety?", "body": "<p>I <a href=\"https://github.com/pebbe/zmq4/issues/26\" rel=\"noreferrer\">opened an issue</a> a 1.5 years ago to introduce a port of <a href=\"https://github.com/vaughan0/go-zmq/blob/master/channels.go\" rel=\"noreferrer\">https://github.com/vaughan0/go-zmq/blob/master/channels.go</a> to pebbe/zmq4.  Ultimately the author decided against it, but we have used this in production (under VERY heavy workloads) for a long time now.</p>\n\n<p>This is a <a href=\"https://gist.github.com/schleppy/7d26c53b40825657454d14bbf038496d\" rel=\"noreferrer\">gist</a> of the file that had to be added to the pebbe/zmq4 package (since it adds methods to the Socket).  This could be re-written in such a way that the methods on the Socket receiver instead took a <code>Socket</code> as an argument, but since we vendor our code anyway, this was an easy way forward.</p>\n\n<p>The basic usage is to create your <code>Socket</code> like normal (call it <code>s</code> for example) then you can:</p>\n\n<pre><code>channels := s.Channels()\noutBound := channels.Out()\ninBound := channels.In()\n</code></pre>\n\n<p>Now you have two channels of type <code>[][]byte</code> that you can use between goroutines, but a single goroutine - managed within the channels abstraction, is responsible for managing the <code>Poller</code> and communicating with the socket.</p>\n"}, {"comments": [{"owner": {"reputation": 37873, "user_id": 1202421, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9ecf725ab72554a6fb27e979e3cd0a6?s=128&d=identicon&r=PG", "display_name": "Pedro Werneck", "link": "https://stackoverflow.com/users/1202421/pedro-werneck"}, "edited": false, "score": 0, "creation_date": 1459911054, "post_id": 36438543, "comment_id": 60495579, "body": "I got it, but I just realized I can simply use an <code>inproc</code> socket to break out of the <code>poller.Poll(-1)</code> call, I don&#39;t even have to use a reactor. Thanks."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 37873, "user_id": 1202421, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9ecf725ab72554a6fb27e979e3cd0a6?s=128&d=identicon&r=PG", "display_name": "Pedro Werneck", "link": "https://stackoverflow.com/users/1202421/pedro-werneck"}, "edited": false, "score": 0, "creation_date": 1459914188, "post_id": 36438543, "comment_id": 60496431, "body": "@PedroWerneck clever. Glad I could help somehow."}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 1, "last_activity_date": 1459897111, "creation_date": 1459897111, "answer_id": 36438543, "question_id": 36437799, "link": "https://stackoverflow.com/questions/36437799/how-to-deal-with-zmq-sockets-lack-of-thread-safety/36438543#36438543", "title": "How to deal with ZMQ sockets lack of thread safety?", "body": "<p>The blessed way to do this with pebbe/zmq4 is with a <a href=\"https://godoc.org/github.com/pebbe/zmq4#Reactor\" rel=\"nofollow\">Reactor</a>. Reactors have the ability to listen on Go channels, but you <em>don't want to do that</em> because they do so by polling the channel periodically using a poll timeout, which reintroduces the same exact problem you have in your Python version. Instead you can use zmq <code>inproc</code> sockets, with one end held by the reactor and the other end held by a goroutine that passes data in from a channel. It's complicated, verbose, and unpleasant, but I have used it successfully.</p>\n"}], "owner": {"reputation": 37873, "user_id": 1202421, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9ecf725ab72554a6fb27e979e3cd0a6?s=128&d=identicon&r=PG", "display_name": "Pedro Werneck", "link": "https://stackoverflow.com/users/1202421/pedro-werneck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1399, "favorite_count": 1, "accepted_answer_id": 36438285, "answer_count": 2, "score": 4, "last_activity_date": 1459911514, "creation_date": 1459893455, "last_edit_date": 1459911514, "question_id": 36437799, "link": "https://stackoverflow.com/questions/36437799/how-to-deal-with-zmq-sockets-lack-of-thread-safety", "title": "How to deal with ZMQ sockets lack of thread safety?", "body": "<p>I've been using ZMQ in some Python applications for a while, but only very recently I decided to reimplement one of them in Go and I realized that ZMQ sockets are not thread-safe.</p>\n\n<p>The original Python implementation uses an event loop that looks like this:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>while running:\n    socks = dict(poller.poll(TIMEOUT))\n    if socks.get(router) == zmq.POLLIN:\n        client_id = router.recv()\n        _ = router.recv()\n        data = router.recv()\n        requests.append((client_id, data))\n\n    for req in requests:\n        rep = handle_request(req)\n        if rep:\n            replies.append(rep)\n            requests.remove(req)\n\n    for client_id, data in replies:\n        router.send(client_id, zmq.SNDMORE)\n        router.send(b'', zmq.SNDMORE)\n        router.send(data)\n        del replies[:]\n</code></pre>\n\n<p>The problem is that the reply might not be ready on the first pass, so whenever I have pending requests, I have to poll with a very short timeout or the clients will wait for more than they should, and the application ends up using a lot of CPU for polling.</p>\n\n<p>When I decided to reimplement it in Go, I thought it would be as simple as this, avoiding the problem by using infinite timeout on polling:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>for {\n    sockets, _ := poller.Poll(-1) \n    for _, socket := range sockets {\n        switch s := socket.Socket; s {\n        case router:\n            msg, _ := s.RecvMessage(0)\n            client_id := msg[0]\n            data := msg[2]\n            go handleRequest(router, client_id, data)                \n        }\n    }\n}\n</code></pre>\n\n<p>But that ideal implementation only works when I have a single client connected, or a light load. Under heavy load I get random assertion errors inside libzmq. I tried the following:</p>\n\n<ol>\n<li><p>Following the <a href=\"https://godoc.org/github.com/pebbe/zmq4#Context.NewSocket\" rel=\"nofollow\">zmq4 docs</a> I tried adding a sync.Mutex and lock/unlock on all socket operations. It fails. I assume it's because ZMQ uses its own threads for flushing.</p></li>\n<li><p>Creating one goroutine for polling/receiving and one for sending, and use channels in the same way I used the req/rep queues in the Python version. It fails, as I'm still sharing the socket.</p></li>\n<li><p>Same as 2, but setting <code>GOMAXPROCS=1</code>. It fails, and throughput was very limited because replies were being held back until the <code>Poll()</code> call returned.</p></li>\n<li><p>Use the req/rep channels as in 2, but use <code>runtime.LockOSThread</code> to keep all socket operations in the same thread as the socket. Has the same problem as above. It doesn't fail, but throughput was very limited.</p></li>\n<li><p>Same as 4, but using the poll timeout strategy from the Python version. It works, but has the same problem the Python version does. </p></li>\n<li><p>Share the context instead of the socket and create one socket for sending and one for receiving in separate goroutines, communicating with channels. It works, but I'll have to rewrite the client libs to use two sockets instead of one.</p></li>\n<li><p>Get rid of zmq and use raw TCP sockets, which are thread-safe. It works perfectly, but I'll also have to rewrite the client libs. </p></li>\n</ol>\n\n<p>So, it looks like 6 is how ZMQ was really intended to be used, as that's the only way I got it to work seamlessly with goroutines, but I wonder if there's any other way I haven't tried. Any ideas?</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>With the answers here I realized I can just add an <code>inproc</code> PULL socket to the poller and have a goroutine connect and push a byte to break out of the infinite wait. It's not as versatile as the solutions suggested here, but it works and I can even backport it to the Python version.</p>\n"}, {"tags": ["java", "go", "dsa"], "answers": [{"comments": [{"owner": {"reputation": 2498, "user_id": 863192, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/250233733ef04cf76518e845254b9b26?s=128&d=identicon&r=PG", "display_name": "Zack Newsham", "link": "https://stackoverflow.com/users/863192/zack-newsham"}, "edited": false, "score": 0, "creation_date": 1459895882, "post_id": 36436172, "comment_id": 60491380, "body": "Unfortunately Go doesn&#39;t support parsing DSA keys in this way, even though the check signature method allows for DSA, I switched to RSA, and found the CheckSignature returned an error even when checking the go computed signature"}], "tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1459887310, "creation_date": 1459887310, "answer_id": 36436172, "question_id": 36435908, "link": "https://stackoverflow.com/questions/36435908/cant-verify-a-dsa-signature-in-java-that-was-created-in-go-and-vice-versa/36436172#36436172", "title": "Can&#39;t verify a DSA signature in Java that was created in Go, and vice versa", "body": "<p>You shouldn't have to handle splitting the ASN1 []bytes by hand, you should be using functions from the crypto pkg.</p>\n\n<p><a href=\"https://golang.org/pkg/crypto/x509/#Certificate.CheckSignature\" rel=\"nofollow\">https://golang.org/pkg/crypto/x509/#Certificate.CheckSignature</a> looks like it takes a SignatureAlgorithm as an arg (and DSAWithSHA1 is a valid value).</p>\n"}, {"tags": [], "owner": {"reputation": 2498, "user_id": 863192, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/250233733ef04cf76518e845254b9b26?s=128&d=identicon&r=PG", "display_name": "Zack Newsham", "link": "https://stackoverflow.com/users/863192/zack-newsham"}, "is_accepted": false, "score": -1, "last_activity_date": 1459896141, "last_edit_date": 1495535332, "creation_date": 1459896141, "answer_id": 36438362, "question_id": 36435908, "link": "https://stackoverflow.com/questions/36435908/cant-verify-a-dsa-signature-in-java-that-was-created-in-go-and-vice-versa/36438362#36438362", "title": "Can&#39;t verify a DSA signature in Java that was created in Go, and vice versa", "body": "<p>Ok, DSA may be different, but for RSA at least the solution was that Java didn't want the value to be hashed first (I guess it hashes internally) while GO did, changing the functions to use RSA rather than DSA and considering the above, this worked.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/29422738/verify-rsa-signpkcs1v15-signature-generated-in-golang-in-java\">Verify rsa.SignPKCS1v15 signature generated in golang in Java</a></p>\n"}], "owner": {"reputation": 2498, "user_id": 863192, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/250233733ef04cf76518e845254b9b26?s=128&d=identicon&r=PG", "display_name": "Zack Newsham", "link": "https://stackoverflow.com/users/863192/zack-newsham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1459896141, "creation_date": 1459886342, "question_id": 36435908, "link": "https://stackoverflow.com/questions/36435908/cant-verify-a-dsa-signature-in-java-that-was-created-in-go-and-vice-versa", "title": "Can&#39;t verify a DSA signature in Java that was created in Go, and vice versa", "body": "<p>I'm trying to verify a signature in Java that was created in Go, and vice versa. However, in each case I'm getting no error, but false on the verify function.</p>\n\n<p>The public and private key being used are the same, as are the parameters, I have checked this by passing the Java key data to Go, and using it to sign and verify the data - this works.</p>\n\n<p>I have also checked that the data being passed in (which is then MD5 hashed) is the same in both Java and Go, and that the resulting hash is the same (just in case) - they are.</p>\n\n<p>I know that Java uses the ASN1 encoding for it's signature, and I found a function to rebuild this from the separate R and S values provided by Go, and I used that as a template to split the ASN1 byte[] generated by Java into R and S values for Go. In Java, if I split, and rebuild the ASN1 byte[], I can verify the signature, but no matter what I do, Go won't, and Java won't verify a signature signed by Go. </p>\n\n<p>Is there a difference in the versions of the DSA algorithm they use? I see that Java uses <code>SHA1withDSA</code> and go mentions that it conforms to the FIPS 186-3 specitication</p>\n"}, {"tags": ["mongodb", "sorting", "go"], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 3326930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae73600d26eff4529ea7b220529a7b70?s=128&d=identicon&r=PG&f=1", "display_name": "Quest", "link": "https://stackoverflow.com/users/3326930/quest"}, "edited": false, "score": 0, "creation_date": 1459980900, "post_id": 36439568, "comment_id": 60538442, "body": "You&#39;re absolutely right. Thank you for taking the time to put this together."}], "tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1459903835, "creation_date": 1459903835, "answer_id": 36439568, "question_id": 36435683, "link": "https://stackoverflow.com/questions/36435683/sort-a-mongodb-query-based-on-a-field-in-a-subdocument-in-go/36439568#36439568", "title": "sort a mongodb query based on a field in a subdocument in Go", "body": "<p>I'm pretty sure it is something with your data structures because next code works as expected (you can test it on your PC)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n    \"log\"\n    \"time\"\n)\n\ntype Test struct {\n    Title  string `bson:\"title\" json:\"title\"`\n    Update Update `bson:\"update\" json:\"update\"`\n}\n\ntype Update struct {\n    Changes   []string  `bson:\"change\" json:\"change\"`\n    UpdatedAt time.Time `bson:\"updatedAt\" json:\"updatedAt\"`\n}\n\nfunc main() {\n    session, err := mgo.Dial(\"mongodb://souser:123456@ds055855.mlab.com:55855/catalog\")\n\n    if err != nil {\n        panic(err)\n    }\n    defer session.Close()\n    session.SetMode(mgo.Monotonic, true)\n\n    c := session.DB(\"catalog\").C(\"sortable\")\n\n    /*\n        // Fill collection with test data (test collection aready has 15 elements)\n        for i := 0; i &lt; 15; i++ {\n            c.Insert(&amp;Test{\n                Title: \"Title\",\n                Update: Update{\n                    Changes:   []string{fmt.Sprintf(\"Changes #%d\", i)},\n                    UpdatedAt: time.Now(),\n                },\n            })\n        }\n    */\n\n    var results []Test\n\n    err = c.Find(bson.M{\"title\": \"Title\"}).Sort(\"-update.updatedAt\").Limit(10).All(&amp;results)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for _, e := range results {\n        fmt.Println(e.Update.UpdatedAt)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 1415083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99aa2910d07e46a0d35fb9ff1920e509?s=128&d=identicon&r=PG", "display_name": "user1415083", "link": "https://stackoverflow.com/users/1415083/user1415083"}, "is_accepted": false, "score": 0, "last_activity_date": 1528885893, "creation_date": 1528885893, "answer_id": 50834972, "question_id": 36435683, "link": "https://stackoverflow.com/questions/36435683/sort-a-mongodb-query-based-on-a-field-in-a-subdocument-in-go/50834972#50834972", "title": "sort a mongodb query based on a field in a subdocument in Go", "body": "<p>You need to pass subdocument fields comma(,) seperated like:</p>\n\n<p>cs.Find(bson.M{title: \"some title\"}).Sort(\"update\",\"-updatedAt\").Limit(10).All(&amp;results)</p>\n"}], "owner": {"reputation": 383, "user_id": 3326930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae73600d26eff4529ea7b220529a7b70?s=128&d=identicon&r=PG&f=1", "display_name": "Quest", "link": "https://stackoverflow.com/users/3326930/quest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "accepted_answer_id": 36439568, "answer_count": 2, "score": 0, "last_activity_date": 1528885893, "creation_date": 1459885532, "question_id": 36435683, "link": "https://stackoverflow.com/questions/36435683/sort-a-mongodb-query-based-on-a-field-in-a-subdocument-in-go", "title": "sort a mongodb query based on a field in a subdocument in Go", "body": "<p>suppose I have the following struct </p>\n\n<pre><code>type Test struct {\n  Title  string `bson:\"title\" json:\"title\"`\n  Update Update `bson:\"update\" json:\"update\"`\n}\n\ntype Update struct {\n  Changes    []string  `bson:\"change\" json:\"change\"`\n  UpdatedAt time.Time `bson:\"updatedAt\" json:\"updatedAt\"`\n}\n</code></pre>\n\n<p>And suppose I want to sort my results in the Query by \"update.updatedAt\"</p>\n\n<pre><code>cs.Find(bson.M{title: \"some title\"}).Sort(\"-update.updatedAt\").Limit(10).All(&amp;results)\n</code></pre>\n\n<p>This query does not work as expected. I can't seem to find any documentation about how to sort a Query by a subdocument field. Intuitively, I was certain that my example would work. For reference, \"-updatedAt\" works just fine, but for reasons that aren't necessary to explain, I have to keep Update as a subdocument of Test. </p>\n\n<p>Every example and Stack Overflow question I have seen so far involves the sorting and reordering of subdocuments, or arrays. In this case I don't care about the order of my subdocuments, and I'm not sorting by anything inside of an array. I merely want to sort my the documents by the date of a subdocument.</p>\n\n<p>Is there a way to do this with the Go Mgo Query library? </p>\n"}, {"tags": ["http", "go", "proxy", "environment"], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 1, "last_activity_date": 1459887665, "last_edit_date": 1459887665, "creation_date": 1459885506, "answer_id": 36435677, "question_id": 36434788, "link": "https://stackoverflow.com/questions/36434788/when-to-use-http-proxy/36435677#36435677", "title": "When to use HTTP Proxy", "body": "<p>Both functions are related to how you use the <code>http.Transport</code> mechanism.</p>\n\n<p>One can be used to allow the transport to dynamically retrieve the proxy settings from the environment, the other can be used to provide a static URL to be used by the transport for the proxy every time.</p>\n\n<p><code>ProxyFromEnvironment</code> is a func that returns a URL describing the proxy that is configured in the Environment; it can be assigned to the <code>Transport.Proxy</code> field, and every time the Transport makes a request, the Proxy will depend on the values in the Environment.</p>\n\n<p><code>ProxyURL</code> is a func that returns a general func which returns the given URL every time it is invoked; it can be used to generate a helper function to assign to the <code>Transport.Proxy</code> field, so that your Transport has a consistent Proxy every time the Transport makes a request.</p>\n"}], "owner": {"reputation": 253, "user_id": 5719160, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/abd92cbc314012f263ee283c0fe8f323?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Byer", "link": "https://stackoverflow.com/users/5719160/kim-byer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541662355, "creation_date": 1459882533, "question_id": 36434788, "link": "https://stackoverflow.com/questions/36434788/when-to-use-http-proxy", "title": "When to use HTTP Proxy", "body": "<p>I am having trouble understanding <a href=\"https://golang.org/pkg/net/http/#ProxyFromEnvironment\" rel=\"nofollow\">ProxyFromEnvironment</a> and <a href=\"https://golang.org/pkg/net/http/#ProxyURL\" rel=\"nofollow\">ProxyURL</a> in net/http package. Can someone please explain me when and why these two functionalities are used?</p>\n\n<p>My current understanding (at least for ProxyFromEnvironment) is that this is used to get the URL of a PROXY Server from the Environment Variables and this PROXY Server is used to make HTTP Requests.</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459882535, "post_id": 36434332, "comment_id": 60484010, "body": "What version of Go are you using?"}, {"owner": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459885523, "post_id": 36434332, "comment_id": 60485852, "body": "@JohnWeldon I am using 1.6"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459885586, "post_id": 36434332, "comment_id": 60485912, "body": "So assuming you have more than one logical CPU, you <i>could</i> potentially see parallelism, but it&#39;s not guaranteed.  Goroutines provide concurrency, not necessarily parallelism."}], "answers": [{"comments": [{"owner": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "edited": false, "score": 4, "creation_date": 1459885648, "post_id": 36434929, "comment_id": 60485960, "body": "I fully understand the concepts of concurrency and parallelism in go and us go routines in a number of areas. My question has nothing to do with that. It was asking if gin-gonic handles requests in a synchronous fashion or it was async (boiling it all down). I am looking for help more with gin-gonic than with go. Now it&#39;s possible that the answer is that I have to use a go routine with gin-gonic but I&#39;m not familiar enough with gin-gonic to know if that&#39;s the case."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "edited": false, "score": 0, "creation_date": 1459885696, "post_id": 36434929, "comment_id": 60485990, "body": "Got it.  Well, we can review the gin-gonic code to see if it&#39;s using goroutines or not."}, {"owner": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "edited": false, "score": 0, "creation_date": 1459885756, "post_id": 36434929, "comment_id": 60486037, "body": "PS: I have 22 cores on the server and nothing else running so I am not running out of processors. Actually, the issue may be further up the line in net/http. Does it support async operations and process multiple requests at the same time?"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "edited": false, "score": 3, "creation_date": 1459886872, "post_id": 36434929, "comment_id": 60486779, "body": "gin-gonic is just a web framework that uses a (fast) router, but the actual http requests are ultimately handled by the Go http.Server.Serve function"}, {"owner": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "edited": false, "score": 0, "creation_date": 1459887734, "post_id": 36434929, "comment_id": 60487286, "body": "So based on your answer to the root question it seems that in fact multiple requests can be serviced at the same time (until we run out of cores). So I&#39;m back to the puzzling issue: Why do the connections seem to be executed sequentially? I double checked to make sure that GOMAXPROCS isn&#39;t set anywhere. It isn&#39;t (by me anyway). I started with a 1.6 clean install so there&#39;s no legacy code. I&#39;m stuck."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "edited": false, "score": 0, "creation_date": 1459887848, "post_id": 36434929, "comment_id": 60487348, "body": "Yeah; more complicated question than I initially realized..  It seems like parallelism related questions can be quite hard to track down."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459918178, "post_id": 36434929, "comment_id": 60497597, "body": "The logger (by requirement) would process events serially. gin-gonic does handle requests concurrently (I don&#39;t know any Go mux that doesn&#39;t). How are you testing this? What are you testing with."}, {"owner": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459955369, "post_id": 36434929, "comment_id": 60522809, "body": "@elithrar Thanks for the input. I have a go program which launches 5 requests as go routines (from another server). It was while watching the logs that I saw the odd timing and seemed to bear up when the results returned to the callers. There is one &quot;fat&quot; call that takes 1.5 - 4 seconds to run and some of the other calls seem to stack up behind them. I then tried it in Javascript with posts and callbacks. Same behavior."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459958450, "post_id": 36434929, "comment_id": 60525199, "body": "It sounds like a side-effect of your testing methodology, the logging, etc. Without seeing your program it&#39;s hard to know for sure, but Go&#39;s HTTP server is &quot;concurrent by default&quot;, as is Gin/gorilla mux/Goji/etc."}, {"owner": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459963802, "post_id": 36434929, "comment_id": 60528710, "body": "@elithrar Okay I think I will write a quick net/http server and see if the same behavior appears. Using gin-gonic, the caller and logger on the server agree that the calls are not happening concurrently."}, {"owner": {"reputation": 2062, "user_id": 5347169, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/c9RlU.png?s=128&g=1", "display_name": "sphoenix", "link": "https://stackoverflow.com/users/5347169/sphoenix"}, "reply_to_user": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "edited": false, "score": 0, "creation_date": 1612335710, "post_id": 36434929, "comment_id": 116731105, "body": "@mlewis54 Did you manage to dig down what was the issue?"}, {"owner": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "reply_to_user": {"reputation": 2062, "user_id": 5347169, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/c9RlU.png?s=128&g=1", "display_name": "sphoenix", "link": "https://stackoverflow.com/users/5347169/sphoenix"}, "edited": false, "score": 0, "creation_date": 1612638236, "post_id": 36434929, "comment_id": 116831608, "body": "@sphoenix I was able to eliminate the GIN-GONIC and NET/HTTP modules. They were indeed running concurrently. It appeared to be something in the front end code that was making the call to a PHP program that was issuing the API call. However, it&#39;s been a while so I may be forgetting some of the details."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 4, "last_activity_date": 1459886509, "last_edit_date": 1459886509, "creation_date": 1459883027, "answer_id": 36434929, "question_id": 36434332, "link": "https://stackoverflow.com/questions/36434332/does-gin-gonic-process-requests-in-parallel/36434929#36434929", "title": "Does gin-gonic process requests in parallel?", "body": "<p>To answer your root question; The stdlib <a href=\"https://golang.org/src/net/http/server.go?s=63384:64156#2137\" rel=\"nofollow\"><code>http.Serve</code></a> (<a href=\"https://golang.org/pkg/net/http/#Server.Serve\" rel=\"nofollow\">doc</a>) func farms the request out to a goroutine after the initial connection accept and some connection work.</p>\n\n<h3>Conceptual Rambling:</h3>\n\n<p>Go has primitives that are designed to provide strong concurrency capability, but concurrency is not the same as parallelism.</p>\n\n<p>If you have more than one processor core, and if your GOMAXPROCS environment is set to be more than 1, then you may see some parallelism in addition to concurrency, assuming the appropriate goroutines.</p>\n\n<p>As of Go 1.5 the default setting for GOMAXPROCS is the number of CPU cores.  Prior versions of Go default the GOMAXPROCS setting to 1. </p>\n\n<p>William Kennedy had a good write up about the differences a couple years ago: <a href=\"http://www.goinggo.net/2014/01/concurrency-goroutines-and-gomaxprocs.html\" rel=\"nofollow\">http://www.goinggo.net/2014/01/concurrency-goroutines-and-gomaxprocs.html</a></p>\n"}], "owner": {"reputation": 2112, "user_id": 583101, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d287efdca7b2df3361ca31a942083348?s=128&d=identicon&r=PG", "display_name": "mlewis54", "link": "https://stackoverflow.com/users/583101/mlewis54"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7545, "favorite_count": 4, "accepted_answer_id": 36434929, "answer_count": 1, "score": 9, "last_activity_date": 1490870098, "creation_date": 1459881226, "last_edit_date": 1490870098, "question_id": 36434332, "link": "https://stackoverflow.com/questions/36434332/does-gin-gonic-process-requests-in-parallel", "title": "Does gin-gonic process requests in parallel?", "body": "<p>We have a API server written in go that is based on gin-gonic. We've noticed something odd that has led us to believe that it is processing requests serially rather than the expected parallel operation. Consider this log file:</p>\n\n<pre><code>[GIN] 2016/04/05 - 17:24:37 | 200 |    5.738742ms | 64.... |   POST    /api/v2/d/\n[GIN] 2016/04/05 - 17:24:40 | 200 |  3.262816256s | 64.... |   POST    /api/v2/d/\n[GIN] 2016/04/05 - 17:24:42 | 200 |    3.563779ms | 64.... |   POST    /api/v2/d/\n[GIN] 2016/04/05 - 17:24:43 | 200 |     105.429\u00c2\u00b5s | 64.... |   POST    /api/v2/d/\n[GIN] 2016/04/05 - 17:24:43 | 200 |     808.824\u00c2\u00b5s | 64.... |   POST    /api/v2/d/\n</code></pre>\n\n<p>Watching the log in real time, the last 3 entries are not displayed until the second call finishes. These five calls are made to the API within 5 milliseconds of each other. We expect that the calls should be processed in parallel. This implies that all the calls should complete by 17:24:40, not 17:24:43. IE: That the server spawns a new thread/goroutine when the connection is made to process the request. If that is not the case does anyone have any suggestions for a package that does work that way. </p>\n\n<p>This is our first project with gin-gonic and I'm wondering if there is some configuration parameter that needs to be set. Any ideas/suggestions are appreciated.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2777, "user_id": 4852094, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10102767534136292/picture?type=large", "display_name": "Rob", "link": "https://stackoverflow.com/users/4852094/rob"}, "edited": false, "score": 0, "creation_date": 1459881465, "post_id": 36433843, "comment_id": 60483347, "body": "So if I understand correctly, my personal code goes in the <code>$GOROOT&#47;src</code>, but if I import a repo from someone else&#39;s code, I would put that in the <code>$GOROOT&#47;src&#47;github.com&#47;username&#47;reponame</code> folder?"}, {"owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "edited": false, "score": 1, "creation_date": 1459886431, "post_id": 36433843, "comment_id": 60486515, "body": "A user&#39;s code is supposed to be under $GOPATH[/src], not $GOROOT[/src]."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "edited": false, "score": 0, "creation_date": 1459888706, "post_id": 36433843, "comment_id": 60487842, "body": "@cd1 ugh, very sorry, fixed"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 2777, "user_id": 4852094, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10102767534136292/picture?type=large", "display_name": "Rob", "link": "https://stackoverflow.com/users/4852094/rob"}, "edited": false, "score": 0, "creation_date": 1459888752, "post_id": 36433843, "comment_id": 60487871, "body": "@Rob -- see above; I was dead wrong. Generally, your code and other people&#39;s code should be in a similar structure -- see &quot;the first steps...&quot; link for an example where you make `$GOPATH/src/github.com/youruser&quot;"}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 3, "last_activity_date": 1459899984, "last_edit_date": 1495542728, "creation_date": 1459879627, "answer_id": 36433843, "question_id": 36433615, "link": "https://stackoverflow.com/questions/36433615/go-custom-package-import-error/36433843#36433843", "title": "Go custom package import error", "body": "<p>Your Go code (as opposed to Go's stdlib) is meant to be under <code>$GOPATH/src</code> (edit: <em>not</em> <code>$GOROOT</code>, as I initially said!), and it's standard to always use the full import path, in your case starting with <code>github.com/</code> (even if you figured out a way to avoid having to). </p>\n\n<p>There is more in <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a> by the Go team, and other answers here describing <a href=\"https://stackoverflow.com/questions/14867452/what-is-a-sensible-way-to-layout-a-go-project\">project layout</a> and <a href=\"https://stackoverflow.com/questions/20628918/cannot-download-gopath-not-set\">the first steps to setting a workspace up</a>.</p>\n"}], "owner": {"reputation": 2777, "user_id": 4852094, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10102767534136292/picture?type=large", "display_name": "Rob", "link": "https://stackoverflow.com/users/4852094/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 968, "favorite_count": 0, "accepted_answer_id": 36433843, "answer_count": 1, "score": 0, "last_activity_date": 1459959401, "creation_date": 1459878903, "last_edit_date": 1459959401, "question_id": 36433615, "link": "https://stackoverflow.com/questions/36433615/go-custom-package-import-error", "title": "Go custom package import error", "body": "<p>I am trying to write a program where I have a structure like:</p>\n\n<pre><code>Go/src/\n  -github.com\n     -myname\n        -hello\n           main.go\n           -vector\n              vector.go\n</code></pre>\n\n<p>When I import the package in my code inside of the <code>main.go</code> file using a command like:</p>\n\n<pre><code>import(\n  \"vector\"\n)\n</code></pre>\n\n<p>I get the error message:</p>\n\n<pre><code>Can't find package \"vector\" in any of:\n    C:\\Go\\src\\vendor\\vector (vendor tree)\n    C:\\Go\\src\\vertex (from $GOROOT)\n    C:\\Go\\src\\github.com\\myname\\src\\vertex (from $GOPATH)\n</code></pre>\n\n<p>Why is it adding <code>src</code> on that last line?  Shouldn't it replace the src with the hello folder since that is where I'm running the file from?  Also, it runs if I import it from the full file structure like <code>github.com/myname/hello/vertex</code> which seems strange to me.</p>\n\n<p>I am executing using <code>go run hello.go</code> to simplify my interaction with the program.    </p>\n"}, {"tags": ["mongodb", "go"], "answers": [{"comments": [{"owner": {"reputation": 3638, "user_id": 2884309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/T1Mo3.jpg?s=128&g=1", "display_name": "Ivan Aracki", "link": "https://stackoverflow.com/users/2884309/ivan-aracki"}, "edited": false, "score": 0, "creation_date": 1511176507, "post_id": 36432385, "comment_id": 81734272, "body": "do we actually need closing session if we made it by Clone()?"}], "tags": [], "owner": {"reputation": 1364, "user_id": 711400, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6d759a9e10591c530ff2f1b400637eff?s=128&d=identicon&r=PG", "display_name": "Monodeep", "link": "https://stackoverflow.com/users/711400/monodeep"}, "is_accepted": true, "score": 8, "last_activity_date": 1459874790, "creation_date": 1459874790, "answer_id": 36432385, "question_id": 36432123, "link": "https://stackoverflow.com/questions/36432123/how-to-correctly-work-with-mongodb-session-in-go/36432385#36432385", "title": "How to correctly work with MongoDB session in Go?", "body": "<p>You can do something like this. Create a package which does the Db initialization </p>\n\n<pre><code>    package common\n\n    import \"gopkg.in/mgo.v2\"\n\n    var mgoSession   *mgo.Session\n\n    // Creates a new session if mgoSession is nil i.e there is no active mongo session. \n   //If there is an active mongo session it will return a Clone\n    func GetMongoSession() *mgo.Session {\n        if mgoSession == nil {\n            var err error\n            mgoSession, err = mgo.Dial(mongo_conn_str)\n            if err != nil {\n                log.Fatal(\"Failed to start the Mongo session\")\n            }\n        }\n        return mgoSession.Clone()\n    }\n</code></pre>\n\n<p><a href=\"https://godoc.org/gopkg.in/mgo.v2#Session.Clone\" rel=\"noreferrer\">Clone</a> reuses the same socket as the original session.</p>\n\n<p>Now in other packages you can call this method:</p>\n\n<pre><code>package main\n\nsession := common.GetMongoSession()\ndefer session.Close()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": false, "score": 3, "last_activity_date": 1459874949, "creation_date": 1459874949, "answer_id": 36432433, "question_id": 36432123, "link": "https://stackoverflow.com/questions/36432123/how-to-correctly-work-with-mongodb-session-in-go/36432433#36432433", "title": "How to correctly work with MongoDB session in Go?", "body": "<p>Pass the section to the other part of the code\nafter the defer(), </p>\n\n<pre><code>func main(){\n    // ... other stuff\n    session, err := mgo.Dial(mongodbURL)\n      if err != nil {\n        panic(err)\n      }\n    defer session.Close()\n    doThinginOtherFile(session) \n}\n</code></pre>\n\n<p>It looks like you can clone/copy sessions if necessary as long as you have one to clone from.</p>\n"}], "owner": {"reputation": 4021, "user_id": 3830108, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/elcXQ.jpg?s=128&g=1", "display_name": "Cortwave", "link": "https://stackoverflow.com/users/3830108/cortwave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4530, "favorite_count": 1, "accepted_answer_id": 36432385, "answer_count": 2, "score": 5, "last_activity_date": 1459874949, "creation_date": 1459874030, "question_id": 36432123, "link": "https://stackoverflow.com/questions/36432123/how-to-correctly-work-with-mongodb-session-in-go", "title": "How to correctly work with MongoDB session in Go?", "body": "<p>I'm using MongoDB (<code>gopkg.in/mgo.v2</code> package) as a database in my go app. According to MongoDB best practices I should to open connection when application starting and close it when application is terminating. To verify that connection will be closed I can use <code>defer</code> construction:</p>\n\n<pre><code>session, err := mgo.Dial(mongodbURL)\nif err != nil {\n    panic(err)\n}\ndefer session.Close()\n</code></pre>\n\n<p>All will be good if I execute this code in <code>main</code> function. But I want to have this code in separate go file. If I do this session will be closed after method will be executed.What is the best way to open and close session in Golang according MongoDB best practices?</p>\n"}, {"tags": ["go", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "edited": false, "score": 0, "creation_date": 1459977333, "post_id": 36431846, "comment_id": 60536894, "body": "Following the comments from your link, it looks like there are issues that can lead to contention for database access even with multiple open connections...probably safest to find a way to serialize requests to the database, it seems."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 1, "last_activity_date": 1459873126, "creation_date": 1459873126, "answer_id": 36431846, "question_id": 36431452, "link": "https://stackoverflow.com/questions/36431452/precautions-to-avoid-sqlite-file-database-locks-when-concurrent-goroutines-try-t/36431846#36431846", "title": "Precautions to avoid SQLite file/database locks when concurrent goroutines try to access the database?", "body": "<p>You should open a separate connection per goroutine.  The driver will take care of locking and access, but you should have a different connection per goroutine.</p>\n\n<p>Also, you can add some parameters to your connection opening to speed up some access:</p>\n\n<pre><code>gDb, err = sql.Open(\"sqlite3\", \"file:databaselocked.sqlite?cache=shared&amp;mode=rwc\")\n</code></pre>\n\n<p>See the comments on this thread in Github, especially the linked comment by the author of the package: <a href=\"https://github.com/mattn/go-sqlite3/issues/148#issuecomment-56764080\" rel=\"nofollow\">https://github.com/mattn/go-sqlite3/issues/148#issuecomment-56764080</a></p>\n"}], "owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1234, "favorite_count": 0, "accepted_answer_id": 36431846, "answer_count": 1, "score": 1, "last_activity_date": 1459873126, "creation_date": 1459871975, "question_id": 36431452, "link": "https://stackoverflow.com/questions/36431452/precautions-to-avoid-sqlite-file-database-locks-when-concurrent-goroutines-try-t", "title": "Precautions to avoid SQLite file/database locks when concurrent goroutines try to access the database?", "body": "<p>I'm currently working on an application where multiple goroutines may at some point try to query or update a SQLite database file concurrently (using github.com/mattn/go-sqlite3 and database/sql drivers.) </p>\n\n<p>What I'm not sure of is how locking/concurrent access is controlled; does the driver take care of it, or do I need to find a way to serialize requests with a mutex or channel?</p>\n\n<p>Does someone know if the driver will wait to perform operations and retry if the database file is locked for some reason, or would it throw an error and give up?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 0, "last_activity_date": 1459872133, "creation_date": 1459872133, "answer_id": 36431500, "question_id": 36431355, "link": "https://stackoverflow.com/questions/36431355/channel-as-parameter-why-not-an-asterisk/36431500#36431500", "title": "Channel as parameter, why not an asterisk?", "body": "<p>In Go, <code>chan</code> is a language primitive, and <code>sync.WaitGroup</code> is a struct.  Because Go passes parameters by value the <code>WaitGroup</code> would be passed as a copy, and the <code>chan</code> would be passed like an <code>interface</code> which is implemented as a primitive type with metadata including a pointer to the implementation details.</p>\n"}, {"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 2, "last_activity_date": 1459872169, "creation_date": 1459872169, "answer_id": 36431517, "question_id": 36431355, "link": "https://stackoverflow.com/questions/36431355/channel-as-parameter-why-not-an-asterisk/36431517#36431517", "title": "Channel as parameter, why not an asterisk?", "body": "<p>That's because internally, the <code>chan</code> is somewhat a struct made of pointers. You don't need to send a pointer to it. On contrary, the <code>sync.WaitGroup</code> is a classical struct</p>\n\n<pre><code>type WaitGroup struct {\n    state1 [12]byte\n    sema   uint32\n}\n</code></pre>\n\n<p>for whose all methods are declared with a pointer receiver, so you need to pass a pointer to it around to use it in different scopes.</p>\n"}], "owner": {"reputation": 81, "user_id": 3914974, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af981b3159e194b9c177069cc955d6eb?s=128&d=identicon&r=PG&f=1", "display_name": "codingIsFun", "link": "https://stackoverflow.com/users/3914974/codingisfun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 36431517, "answer_count": 2, "score": 0, "last_activity_date": 1459872169, "creation_date": 1459871702, "question_id": 36431355, "link": "https://stackoverflow.com/questions/36431355/channel-as-parameter-why-not-an-asterisk", "title": "Channel as parameter, why not an asterisk?", "body": "<p>When I pass a channel as a parameter to close it at the end of the function, I don't need to put * before it to refer to the channel in the main-function scope. But when I'm supposed to set a WaitGroup to done (wg.Done()) I have to so, why is that?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1459873747, "post_id": 36430469, "comment_id": 60478343, "body": "The comment you quoted is pretty much the answer to your question. What is unclear with this comment?"}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 4, "last_activity_date": 1459871728, "last_edit_date": 1459871728, "creation_date": 1459871399, "answer_id": 36431240, "question_id": 36430469, "link": "https://stackoverflow.com/questions/36430469/exported-and-unexported-in-go-explanation/36431240#36431240", "title": "exported and unexported in Go explanation", "body": "<p>According to the <a href=\"https://golang.org/ref/spec#Function_declarations\" rel=\"nofollow\">spec</a>, function declarations without a body, as you show in the <a href=\"https://golang.org/src/math/sqrt.go?s=3704:3732#L82\" rel=\"nofollow\">first line of the code you quoted</a>, provide a declaration for code implemented outside of Go; usually in assembly or another language.</p>\n\n<p>In this case, most implementations for that <code>func Sqrt(x float64) float64</code> are in assembly; for example <a href=\"https://golang.org/src/math/sqrt_386.s?s=183:243\" rel=\"nofollow\">386</a>, <a href=\"https://golang.org/src/math/sqrt_amd64.s?s=184:243\" rel=\"nofollow\">amd64</a>, <a href=\"https://golang.org/src/math/sqrt_arm.s?s=184:243\" rel=\"nofollow\">arm</a>, etc.</p>\n\n<p>Sample from amd64:</p>\n\n<pre><code>// func Sqrt(x float64) float64\nTEXT \u00b7Sqrt(SB),NOSPLIT,$0\n    SQRTSD x+0(FP), X0\n    MOVSD X0, ret+8(FP)\n    RET\n</code></pre>\n\n<p>For architectures that have no assembly implementation the assembly simply refers to the unexported / private <code>func sqrt(x float64) float64</code> version that is in Go.  For example the <a href=\"https://golang.org/src/math/stubs_mips64x.s?s=1370:1413#L87\" rel=\"nofollow\">mips64</a> architecture.</p>\n\n<pre><code>TEXT \u00b7Sqrt(SB),NOSPLIT,$0\n    JMP \u00b7sqrt(SB)\n</code></pre>\n"}], "owner": {"reputation": 2659, "user_id": 2484238, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RVQ1a.jpg?s=128&g=1", "display_name": "Bun", "link": "https://stackoverflow.com/users/2484238/bun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 1, "accepted_answer_id": 36431240, "answer_count": 1, "score": 3, "last_activity_date": 1459874950, "creation_date": 1459869515, "last_edit_date": 1459874950, "question_id": 36430469, "link": "https://stackoverflow.com/questions/36430469/exported-and-unexported-in-go-explanation", "title": "exported and unexported in Go explanation", "body": "<p>I skimmed through math package in Golang GitHub repo. Some of them have two difference function declarations. In the code below, <a href=\"https://github.com/golang/go/blob/master/src/math/sqrt.go\" rel=\"nofollow\"><code>sqrt.go</code></a> has <code>Sqrt</code> and <code>sqrt</code> func. My questions are: \nWhy do they implement it this way? What are the benefits? Is this because of the exported and unexported identifier (lowercase vs uppercase first letter)? </p>\n\n<pre><code>func Sqrt(x float64) float64\n\n// Note: Sqrt is implemented in assembly on some systems.\n// Others have assembly stubs that jump to func sqrt below.\n// On systems where Sqrt is a single instruction, the compiler\n// may turn a direct call into a direct use of that instruction instead.\n\nfunc sqrt(x float64) float64 {\n</code></pre>\n\n<p><code>math.Sqrt()</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1459868537, "post_id": 36429885, "comment_id": 60474508, "body": "1. The factor <code>4</code> in your code suggests that you do not want a type-conversion but somehow get the raw memory of your []uint32. 2. What about endianess? 3. &quot;the most efficient way&quot; is not specific enough: Effizient in what sense? CPU cycles, memory, lines of code, compatibility, comprehensibility?"}, {"owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1459868754, "post_id": 36429885, "comment_id": 60474675, "body": "it&#39;s on appengine, so i don&#39;t really know what kind of machine they use, biggest possibility is little endian. efficient in term of performance"}], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 3, "creation_date": 1459909065, "post_id": 36430151, "comment_id": 60495053, "body": "A slightly different approach, it is a little bit more efficient since it saves the type assertion in binary.Write: <a href=\"http://play.golang.org/p/ypoFpYt2QF\" rel=\"nofollow noreferrer\">play.golang.org/p/ypoFpYt2QF</a>"}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 9, "last_activity_date": 1459868698, "creation_date": 1459868698, "answer_id": 36430151, "question_id": 36429885, "link": "https://stackoverflow.com/questions/36429885/convert-uint32-to-byte-and-vice-versa-in-golang/36430151#36430151", "title": "Convert []uint32 to []byte and vice versa in golang", "body": "<p>I suspect you are after something like this <a href=\"http://play.golang.org/p/lJYRwOt4q7\" rel=\"noreferrer\">Playground</a></p>\n\n<p>Adjust <code>LittleEndian</code> for <code>BigEndian</code> as appropriate</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/binary\"\n    \"fmt\"\n)\n\nfunc main() {\n    buf := new(bytes.Buffer)\n    source := []uint32{1, 2, 3}\n    err := binary.Write(buf, binary.LittleEndian, source)\n    if err != nil {\n        fmt.Println(\"binary.Write failed:\", err)\n    }\n    fmt.Printf(\"Encoded: % x\\n\", buf.Bytes())\n\n    check := make([]uint32, 3)\n    rbuf := bytes.NewReader(buf.Bytes())\n    err = binary.Read(rbuf, binary.LittleEndian, &amp;check)\n    if err != nil {\n        fmt.Println(\"binary.Read failed:\", err)\n    }\n    fmt.Printf(\"Decoded: %v\\n\", check)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3386, "favorite_count": 0, "accepted_answer_id": 36430151, "answer_count": 1, "score": 6, "last_activity_date": 1459873639, "creation_date": 1459868004, "last_edit_date": 1459873639, "question_id": 36429885, "link": "https://stackoverflow.com/questions/36429885/convert-uint32-to-byte-and-vice-versa-in-golang", "title": "Convert []uint32 to []byte and vice versa in golang", "body": "<p>What's the most efficient way (in performance) to convert <code>[]uint32</code> to and from <code>[]byte</code> in Golang?</p>\n\n<p>for example:</p>\n\n<pre><code>func main() {\n   source := []uint32{1,2,3}\n   dest := make([]byte, 4 * len(source))\n   // source to dest\n   // ?\n   check := len(dest)/4\n   // dest to check\n   // ?\n}\n</code></pre>\n\n<p>I have a <a href=\"http://play.golang.org/p/BBWElfj3Jq\" rel=\"noreferrer\">solution</a> but it consist div, mod, and multiply</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n)\nfunc main() {\n    source := []uint32{1,2,3}\n    dest := make([]byte, 4*len(source))\n    fmt.Println(source)\n    for start, v := range source {\n       dest[start*4+0] = byte(v % 256)\n       dest[start*4+1] = byte(v / 256 % 256)\n       dest[start*4+2] = byte(v / 256 / 256 % 256)\n       dest[start*4+3] = byte(v / 256/ 256/ 256% 256)\n    }\n    fmt.Println(dest)\n    check := make([]uint32,cap(dest)/4)\n    for start := 0; start&lt;len(check); start++ {\n       check[start] = uint32(dest[start*4+0]) + uint32(dest[start*4+1]) * 256 + uint32(dest[start*4+2]) * 256 * 256 + uint32(dest[start*4+3]) * 256 * 256 * 256\n    }  \n    fmt.Println(check)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1459867902, "post_id": 36429554, "comment_id": 60473986, "body": "Your code appears to be backwards. If you were decoding wouldn&#39;t you pass in a byte slice?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1459868281, "post_id": 36429554, "comment_id": 60474300, "body": "Don&#39;t do that, you&#39;ll hurt yourself. Forget anything &quot;generic&quot;. If you want to load several objects from some backend: Have them all implement a specific interface which has all methods needed for the []byte to object deserialization."}, {"owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1459868504, "post_id": 36429554, "comment_id": 60474471, "body": "@ZanLynx you are right. I missed the decoder read from the store in the example... I will update the code shortly."}, {"owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "edited": false, "score": 0, "creation_date": 1459869044, "post_id": 36429554, "comment_id": 60474897, "body": "I was able to resolve. Since this was the first attempt to use interfaces like this, I was skeptic on that layer, but instead I forgot to add the byte data instead. So what was missing is:\tcontent, _ := cs.Get(fileName); buffer := bytes.NewBuffer(content); dec := gob.NewDecoder(buffer)"}], "answers": [{"tags": [], "owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "is_accepted": false, "score": 1, "last_activity_date": 1459869200, "creation_date": 1459869200, "answer_id": 36430335, "question_id": 36429554, "link": "https://stackoverflow.com/questions/36429554/creating-a-function-in-go-with-generic-type-parameters/36430335#36430335", "title": "Creating a function in Go with generic type parameters", "body": "<p>The concept of interfaces is correct. The issue was related to a missing getter  from the persistence store and how to create a buffer out of its []byte content:</p>\n\n<pre><code>func GetObject(key string, thing interface{}) error {\n    content, _ := SomePersistanceStoreGet(fileName)\n    buffer := bytes.NewBuffer(content)\n    dec := gob.NewDecoder(buffer)\n   err := dec.Decode(thing)\n    if err != nil {\n        log.Errorf(\"decode error: %v\", err)\n        return err\n    }\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 6987, "user_id": 816415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6718587772b15f57b3e7923aee8420ea?s=128&d=identicon&r=PG", "display_name": "gextra", "link": "https://stackoverflow.com/users/816415/gextra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459869200, "creation_date": 1459867192, "last_edit_date": 1459867704, "question_id": 36429554, "link": "https://stackoverflow.com/questions/36429554/creating-a-function-in-go-with-generic-type-parameters", "title": "Creating a function in Go with generic type parameters", "body": "<p>I am trying to create a generic function that can accept a key string and a reference to an object. </p>\n\n<p>The function reads a key's content, which is a serialized byte array out of an original object of the same type and it should assign that (deserializing) to an empty structure of that same type. The function wants to be generic, so it can serialize a type A as well as B or []C</p>\n\n<p>Here is what I tried to do:</p>\n\n<pre><code>func GetObject(key string, thing interface{}) error {\n    var buf bytes.Buffer        \n    dec := gob.NewDecoder(&amp;buf)\n    err := dec.Decode(thing)\n    if err != nil {\n        log.Errorf(cs.ctx, \"cloud store - GetObject - decode error:\", err)\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>This is how I try to invoke the above function:</p>\n\n<pre><code>newThing := MyStruct{}\nerr := GetObject(\"a123\", &amp;newThing)\n</code></pre>\n\n<p>The last lines about  cause a runtime error:</p>\n\n<pre><code>decode error:%!(EXTRA *errors.errorString=EOF)\n</code></pre>\n\n<p><strong>the question:</strong></p>\n\n<ul>\n<li>is the interface approach correct for this purpose (allow the function be used generically) ? </li>\n<li>The serialization error ( using Gob ) seems to be problematic. Any suggestions on how to rectify that ? </li>\n</ul>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "edited": false, "score": 0, "creation_date": 1459865327, "post_id": 36428689, "comment_id": 60471851, "body": "Ah, but of course!  On the other hand I&#39;m still stumped vis a vis the type of the literal, as I&#39;m assuming <code>{&quot;$match&quot;: bson.M{&quot;name&quot;: &quot;Otavio&quot;}}</code> isn&#39;t of type <code>bson.M</code>."}, {"owner": {"reputation": 5903, "user_id": 1387612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3ybF.png?s=128&g=1", "display_name": "janisz", "link": "https://stackoverflow.com/users/1387612/janisz"}, "reply_to_user": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "edited": false, "score": 0, "creation_date": 1459865756, "post_id": 36428689, "comment_id": 60472192, "body": "<a href=\"https://godoc.org/labix.org/v2/mgo/bson#M\" rel=\"nofollow noreferrer\"><code>bson.M</code></a> is just <code>map[string]interface{}</code>. So in your case it&#39;s mapping string to another <code>bson.M</code>"}], "tags": [], "owner": {"reputation": 5903, "user_id": 1387612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3ybF.png?s=128&g=1", "display_name": "janisz", "link": "https://stackoverflow.com/users/1387612/janisz"}, "is_accepted": false, "score": 1, "last_activity_date": 1459865388, "last_edit_date": 1459865388, "creation_date": 1459865104, "answer_id": 36428689, "question_id": 36428562, "link": "https://stackoverflow.com/questions/36428562/what-is-the-type-of-this-literal/36428689#36428689", "title": "What is the type of this literal?", "body": "<pre><code>x := {\"foo\": 1, \"bar\": 1}\n</code></pre>\n\n<p>In this statement there is no chance to deduct the type. When you do something like this:</p>\n\n<pre><code>[]bson.M{{\"$match\": bson.M{\"name\": \"Otavio\"}}}\n</code></pre>\n\n<p>Compiler know that you are initializing slice of specific type, so there is no need to repeat this type every time (unless it's interface). This initalisation is called <a href=\"https://golang.org/doc/effective_go.html#composite_literals\" rel=\"nofollow\">composite literals</a> and was introduced in <a href=\"https://golang.org/doc/go1#literals\" rel=\"nofollow\">go1.0</a></p>\n"}, {"comments": [{"owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "edited": false, "score": 2, "creation_date": 1459865735, "post_id": 36428935, "comment_id": 60472174, "body": "The one thing I didn&#39;t think to check... this is not one of my most brilliant questions ...  Thank you!"}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 2, "last_activity_date": 1459865688, "creation_date": 1459865688, "answer_id": 36428935, "question_id": 36428562, "link": "https://stackoverflow.com/questions/36428562/what-is-the-type-of-this-literal/36428935#36428935", "title": "What is the type of this literal?", "body": "<p><code>bson.M</code> is just another name for <code>map[string]interface{}</code>. See its <a href=\"https://godoc.org/labix.org/v2/mgo/bson#M\" rel=\"nofollow\">documentation</a>. Its declared as,</p>\n\n<pre><code>type M map[string]interface{}\n</code></pre>\n\n<p>So, yes <code>{\"$match\": bson.M{\"name\": \"Otavio\"}</code> is of type <code>bson.M</code></p>\n"}], "owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 36428935, "answer_count": 2, "score": 0, "last_activity_date": 1459865688, "creation_date": 1459864841, "question_id": 36428562, "link": "https://stackoverflow.com/questions/36428562/what-is-the-type-of-this-literal", "title": "What is the type of this literal?", "body": "<p>From the <code>mgo</code> docs:</p>\n\n<pre><code>pipe := collection.Pipe([]bson.M{{\"$match\": bson.M{\"name\": \"Otavio\"}}})\n</code></pre>\n\n<p>Decomposing this statement, I see that the argument passed to <code>collection.Pipe</code> is of type <code>[]bson.M</code>.  Given that slices are initialized via <code>[]sometype{ ... }</code> syntax, I conclude that the aforementioned slice contains exactly one item (so <code>len == 1</code>), and that this item is the <code>{\"$match\": bson.M{\"name\": \"Otavio\"}}</code> literal.</p>\n\n<p>What is the type of this literal?  Intuitively, I want to say it's a <code>map[string]interface{}</code>, but when I tried checking on the go playground, I'm unable to initialize a similar data structure:  <a href=\"https://play.golang.org/p/7QKYaQPi6g\" rel=\"nofollow\">https://play.golang.org/p/7QKYaQPi6g</a></p>\n\n<p>My question is therefore twofold:</p>\n\n<ol>\n<li>What is the type of <code>https://play.golang.org/p/7QKYaQPi6g</code> (assuming I've made no mistake in my reasoning)</li>\n<li>What am I doing wrong in <code>x := {\"foo\": 1, \"bar\": 1}</code>?</li>\n</ol>\n"}, {"tags": ["go", "ip"], "comments": [{"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459865507, "post_id": 36428392, "comment_id": 60471993, "body": "do you have a compression rate in mind?"}, {"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1459865534, "post_id": 36428392, "comment_id": 60472012, "body": "What problem are you trying to solve?"}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1459865730, "post_id": 36428392, "comment_id": 60472168, "body": "Try creating a hash using FNV and encode that via base32."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459865736, "post_id": 36428392, "comment_id": 60472175, "body": "I&#39;m trying to make a chat room and I need each user when they choose a username to have a unique id. I have found on my school computers, all the IP&#39;s are the same so it wouldn&#39;t work if I just use the IP address as the id."}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459865780, "post_id": 36428392, "comment_id": 60472212, "body": "why don&#39;t you just use an uuid for each user @Acidic ? do you have length constraint?"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459865873, "post_id": 36428392, "comment_id": 60472293, "body": "<a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\" rel=\"nofollow noreferrer\">universal unique ID</a>, and here is a generator: <a href=\"https://www.uuidgenerator.net/\" rel=\"nofollow noreferrer\">uuidgenerator.net</a>, and this lib <code>github.com&#47;satori&#47;go.uuid</code> helps you generate using go :)"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459865990, "post_id": 36428392, "comment_id": 60472412, "body": "So this UUID creates a &quot;random&quot; string? And this is what I will use for each user?"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459866054, "post_id": 36428392, "comment_id": 60472467, "body": "yes, if you just want a meaningless string to be its id. If your user amount is small enough, you could just use DB record id."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459866193, "post_id": 36428392, "comment_id": 60472590, "body": "Okay so it looks like UUID would be an option. Also I&#39;ve managed to write a function with Martin&#39;s idea of FNV hash. I just hashed both strings and got the sum of it. <a href=\"https://play.golang.org/p/8iq4zvUBa1\" rel=\"nofollow noreferrer\">play.golang.org/p/8iq4zvUBa1</a>"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459866352, "post_id": 36428392, "comment_id": 60472723, "body": "yup that&#39;s also can :) it highly depends on your use case actually, if you want the id to be meaningful, you need to use some other approach. But so far i think a meaningless ID like fnv hash or uuid will serve the purpose well."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459866478, "post_id": 36428392, "comment_id": 60472829, "body": "Okay cool.. thanks for the help. I guess I&#39;ll write an answer to this question. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1459866811, "post_id": 36429368, "comment_id": 60473087, "body": "Create the fnv instance outside of the loop and Write() inside the loop, then return h.Sum32() - <a href=\"https://play.golang.org/p/W_6GUTRJ6b\" rel=\"nofollow noreferrer\">play.golang.org/p/W_6GUTRJ6b</a>"}], "tags": [], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "is_accepted": true, "score": 2, "last_activity_date": 1459868143, "last_edit_date": 1495542178, "creation_date": 1459866718, "answer_id": 36429368, "question_id": 36428392, "link": "https://stackoverflow.com/questions/36428392/go-how-to-combine-multiple-strings-to-output-a-unique-compressed-string/36429368#36429368", "title": "Go - How to Combine Multiple Strings To Output a Unique &#39;Compressed&#39; String?", "body": "<p>A <strong><a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\" rel=\"nofollow noreferrer\">UUID</a></strong> can be generated for each user which will generate a random 128 bit value.</p>\n\n<p>However, for a static output, I have written a function which will hash and sum multiple strings which will output a unique value.</p>\n\n<pre><code>func Combine(string ...string) uint32 {\n    h := fnv.New32a()\n\n    for _, a := range string {\n        h.Write([]byte(a))\n    }\n\n    return h.Sum32()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/W_6GUTRJ6b\" rel=\"nofollow noreferrer\">https://play.golang.org/p/W_6GUTRJ6b</a></p>\n\n<hr>\n\n<p><em>Contributors:\n    <a href=\"https://stackoverflow.com/users/687438/martin-gallagher\">Martin Gallagher</a> (fnv), <a href=\"https://stackoverflow.com/users/2629095/nevets\">nevets</a> (uuid).</em></p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 36429368, "answer_count": 1, "score": 0, "last_activity_date": 1459959472, "creation_date": 1459864413, "last_edit_date": 1459959472, "question_id": 36428392, "link": "https://stackoverflow.com/questions/36428392/go-how-to-combine-multiple-strings-to-output-a-unique-compressed-string", "title": "Go - How to Combine Multiple Strings To Output a Unique &#39;Compressed&#39; String?", "body": "<p>In Go, I'm trying to mix an <strong>IP address</strong> with a <strong>username</strong> to output some sort of compressed unique string.</p>\n\n<p><em>For example:</em> <code>\"MyUsername\" + \"192.354.32.245\" = \"JDU7DNd\"</code></p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 2, "last_activity_date": 1459863807, "last_edit_date": 1459863807, "creation_date": 1459863387, "answer_id": 36427981, "question_id": 36427848, "link": "https://stackoverflow.com/questions/36427848/unmarshalling-xml/36427981#36427981", "title": "Unmarshalling XML", "body": "<p>The missing specification should be <code>xml:\",chardata\"</code>.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/xml\"\n\nvar text = `&lt;data&gt;1.23&lt;/data&gt;`\n\nfunc main() {\n    data := struct {\n        Value float64 `xml:\",chardata\"`\n    }{}\n    xml.Unmarshal([]byte(text), &amp;data)\n    fmt.Println(data)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/VMeIdCNVQB\" rel=\"nofollow\"><kbd>Playground</kbd></a></p>\n"}], "owner": {"reputation": 289, "user_id": 4768715, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/55e2ba38b11b464ad4146a33abbb391d?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Reck", "link": "https://stackoverflow.com/users/4768715/patrick-reck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "closed_date": 1459926145, "accepted_answer_id": 36427981, "answer_count": 1, "score": 1, "last_activity_date": 1459934067, "creation_date": 1459863077, "last_edit_date": 1459934067, "question_id": 36427848, "link": "https://stackoverflow.com/questions/36427848/unmarshalling-xml", "closed_reason": "Duplicate", "title": "Unmarshalling XML", "body": "<p>I have the following XML which I want to unmarshal:</p>\n\n<pre><code>&lt;packaging&gt;\n    &lt;depth measurementUnitCode=\"MMT\"&gt;1200&lt;/depth&gt;\n    &lt;height measurementUnitCode=\"MMT\"&gt;1320&lt;/height&gt;\n&lt;/packaging&gt;\n</code></pre>\n\n<p>I want it to unmarshal into the following structs:</p>\n\n<pre><code>type Packaging struct {\n    Depth Depth   `xml:\"depth\"`\n    Height Height `xml:\"height\"`\n}\n\ntype Measurement struct {\n    UnitOfMeasure `xml:\"measurementUnitCode,attr\"`\n    Value float64 `xml:\"???????\"`\n}\n</code></pre>\n\n<p>The <code>UnitOfMeasure</code> is fine, but I can't figure how to get the actual <code>Value</code> set. How do I do that?</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 750, "user_id": 1748069, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/QOMeY.jpg?s=128&g=1", "display_name": "Matthew S", "link": "https://stackoverflow.com/users/1748069/matthew-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1459891519, "last_edit_date": 1459891519, "creation_date": 1459890731, "answer_id": 36437147, "question_id": 36426755, "link": "https://stackoverflow.com/questions/36426755/go-gorm-related-construct-not-working-with-non-default-primary-key-names/36437147#36437147", "title": "GO GORM .Related() construct not working with non-default primary key names.", "body": "<p>Found the issue. Here are the corrected structs:</p>\n\n<pre><code>type Person struct {\n    PersonId int `gorm:\"primary_key\"`\n    Name     string\n    Emails   []Email `gorm:\"ForeignKey:PersonRefer\"`\n}\n\ntype Email struct {\n    EmailId     int `gorm:\"primary_key\"`\n    Person      Person\n    PersonRefer int `gorm:\"column:person_id\"`\n}\n\nconn.DB.First(&amp;person).Related(&amp;person.Emails, \"PersonRefer\")\n</code></pre>\n"}], "owner": {"reputation": 750, "user_id": 1748069, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/QOMeY.jpg?s=128&g=1", "display_name": "Matthew S", "link": "https://stackoverflow.com/users/1748069/matthew-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 470, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459891519, "creation_date": 1459860322, "question_id": 36426755, "link": "https://stackoverflow.com/questions/36426755/go-gorm-related-construct-not-working-with-non-default-primary-key-names", "title": "GO GORM .Related() construct not working with non-default primary key names.", "body": "<p>When using the \"default\" primary key naming convention:</p>\n\n<p>POSTGRES tables</p>\n\n<pre><code>CREATE TABLE person\n(\n    id SERIAL,\n    name varchar(255) NOT NULL,\n    CONSTRAINT person_pk PRIMARY KEY (id)\n)\n\n\nCREATE TABLE email\n(\n    id SERIAL,\n    person_id int NOT NULL REFERENCES person(id),\n    CONSTRAINT email_pk PRIMARY KEY (id)\n)\n</code></pre>\n\n<p>This .Related() construct works fine per the examples:</p>\n\n<pre><code>type Person struct {\n    ID   int\n    Name string\n    Emails   []Email\n}\n\ntype Email struct {\n    ID       int\n    PersonID int\n}\nperson := models.Person{}\nconn.DB.First(&amp;person).Related(&amp;person.Emails)\n</code></pre>\n\n<p>But when using non-default primary keys names, the example does not work. Only one email is added to Emails regardless of how many there are.</p>\n\n<pre><code>CREATE TABLE person\n(\n    person_id SERIAL,\n    name varchar(255) NOT NULL,\n    CONSTRAINT person_pk PRIMARY KEY (person_id)\n)\n\nCREATE TABLE email\n(\n    email_id SERIAL,\n    person_id int NOT NULL REFERENCES person(person_id),\n    CONSTRAINT email_pk PRIMARY KEY (email_id)\n)\n\n\ntype Person struct {\n    PersonId int `gorm:\"primary_key\"`\n    Name     string\n    Emails   []Email `gorm:\"ForeignKey:PersonId\"`\n}\n\ntype Email struct {\n    EmailId  int    `gorm:\"primary_key\"`\n    PersonId int\n}\n\nperson := models.Person{}\nconn.DB.First(&amp;person).Related(&amp;person.Emails)\n</code></pre>\n\n<p>I've had to resort to using this construct:</p>\n\n<pre><code>person := models.Person{}\nconn.DB.First(&amp;person)\nconn.DB.Where(\"person_id = ?\", person.PersonId).Find(&amp;person.Emails)\n</code></pre>\n\n<p>Is it possible to make .Related() work in this case?</p>\n"}, {"tags": ["unicode", "go", "utf-8"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1459862241, "creation_date": 1459862241, "answer_id": 36427529, "question_id": 36426327, "link": "https://stackoverflow.com/questions/36426327/why-utf8-validstring-function-not-detecting-invalid-unicode-characters/36427529#36427529", "title": "Why utf8.Validstring function not detecting invalid unicode characters?", "body": "<p>You take an invalid value and convert it using Sprintf. It's converted to the error value. You then check the error value, which is a valid Unicode code point.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unicode/utf8\"\n)\n\nfunc main() {\n\n    fmt.Println(\"Case 1: Invalid Range\")\n    str := fmt.Sprintf(\"%c\", rune(55296+1))\n    fmt.Printf(\"%q %X %d %d\\n\", str, str, []rune(str)[0], utf8.RuneError)\n    if !utf8.ValidString(str) {\n        fmt.Print(str, \" is not a valid Unicode\")\n    } else {\n        fmt.Println(str, \" is valid unicode character\")\n    }\n\n    fmt.Println(\"Case 2: More than maximum valid range\")\n    str = fmt.Sprintf(\"%c\", rune(1114111+1))\n    fmt.Printf(\"%q %X %d %d\\n\", str, str, []rune(str)[0], utf8.RuneError)\n    if !utf8.ValidString(str) {\n        fmt.Print(str, \" is not a valid Unicode\")\n    } else {\n        fmt.Println(str, \" is valid unicode character\")\n    }\n\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Case 1: Invalid Range\n\"\ufffd\" EFBFBD 65533 65533\n\ufffd  is valid unicode character\nCase 2: More than maximum valid range\n\"\ufffd\" EFBFBD 65533 65533\n\ufffd  is valid unicode character\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 4, "last_activity_date": 1459862257, "creation_date": 1459862257, "answer_id": 36427535, "question_id": 36426327, "link": "https://stackoverflow.com/questions/36426327/why-utf8-validstring-function-not-detecting-invalid-unicode-characters/36427535#36427535", "title": "Why utf8.Validstring function not detecting invalid unicode characters?", "body": "<p>Your problem happens in Sprintf. Since you give it an invalid character Sprintf replaces with with <code>rune(65533)</code> which is the unicode replacement character used instead of invalid characters. So your string is valid UTF8.</p>\n\n<p>This will also happen if you do something like this: <code>str := string([]rune{ 55297 })</code> so this might be something that happens when creating runes. It's not immediately obvious from: <a href=\"https://blog.golang.org/strings\" rel=\"nofollow\">https://blog.golang.org/strings</a></p>\n\n<p>If you want to force your string to contain invalid UTF8 you can write the first string like this:</p>\n\n<pre><code>str := string([]byte{237, 159, 193})\n</code></pre>\n"}], "owner": {"reputation": 513, "user_id": 5673789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ade403dabcac1cdd5cd25bbd600f7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jsmith", "link": "https://stackoverflow.com/users/5673789/jsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 1, "accepted_answer_id": 36427535, "answer_count": 2, "score": 2, "last_activity_date": 1459862257, "creation_date": 1459859113, "last_edit_date": 1459861348, "question_id": 36426327, "link": "https://stackoverflow.com/questions/36426327/why-utf8-validstring-function-not-detecting-invalid-unicode-characters", "title": "Why utf8.Validstring function not detecting invalid unicode characters?", "body": "<p>From <a href=\"https://en.wikipedia.org/wiki/UTF-8#Invalid_code_points\" rel=\"nofollow\">https://en.wikipedia.org/wiki/UTF-8#Invalid_code_points</a>, I got to know that U+D800 through U+DFFF are invalid. So in decimal system, it is 55296 through 57343.</p>\n\n<p>And Maximum valid Unicode is '\\U0010FFFF'. In decimal system, it is 1114111</p>\n\n<p>My code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"unicode/utf8\"\n\nfunc main() {\n\n    fmt.Println(\"Case 1(Invalid Range)\")\n    str := fmt.Sprintf(\"%c\", rune(55296+1))\n    if !utf8.ValidString(str) {\n        fmt.Print(str, \" is not a valid Unicode\")\n    } else {\n        fmt.Println(str, \" is valid unicode character\")\n    }\n\n    fmt.Println(\"Case 2(More than maximum valid range)\")\n    str = fmt.Sprintf(\"%c\", rune(1114111+1))\n    if !utf8.ValidString(str) {\n        fmt.Print(str, \" is not a valid Unicode\")\n    } else {\n        fmt.Println(str, \" is valid unicode character\")\n    }\n}\n</code></pre>\n\n<p>Why ValidString function is not returning false for invalid unicode characters given as input ? I am sure my understanding is wrong, could some one explain??</p>\n"}, {"tags": ["html", "templates", "go", "range"], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "edited": false, "score": 0, "creation_date": 1459858915, "post_id": 36425818, "comment_id": 60466716, "body": "Thank you A H how to check      if ($comm.Type == &quot;Mobile&quot;)   because i want to display it under the mobile column in my table"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "reply_to_user": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "edited": false, "score": 0, "creation_date": 1459859538, "post_id": 36425818, "comment_id": 60467155, "body": "Will the first value always be &quot;Mobile&quot;? If you don&#39;t know the order maybe you could use a map instead of slice, if possible? Like <code>{&quot;moblie&quot;: &quot;12345&quot;, &quot;email&quot;: &quot;some@email.com&quot;}</code>?"}, {"owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "edited": false, "score": 0, "creation_date": 1459859838, "post_id": 36425818, "comment_id": 60467387, "body": "Thanks AH once again for a prompt reply. Unfortunately i cannot change the structure format.   some user will have email only, and some will have mobile only, and some both, so i need to check the Type is there any way?"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "reply_to_user": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "edited": false, "score": 0, "creation_date": 1459861344, "post_id": 36425818, "comment_id": 60468588, "body": "I can&#39;t figure out an easy way :( You could iterate over the list and find <code>mobile</code> and <code>email</code> values and pass them to the template. Maybe someone else has an answer. And I think you should edit the question to include your expected html output."}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "reply_to_user": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "edited": false, "score": 0, "creation_date": 1459863194, "post_id": 36425818, "comment_id": 60469999, "body": "Hardy, I updated my answer. A lot. This is the best answer I could come up with."}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 2, "last_activity_date": 1459863124, "last_edit_date": 1459863124, "creation_date": 1459857590, "answer_id": 36425818, "question_id": 36425071, "link": "https://stackoverflow.com/questions/36425071/nested-range-in-go-template/36425818#36425818", "title": "nested range in Go template", "body": "<p>You can access the Communication field just like other fields.</p>\n\n<p><code>{{$val.Communication}}</code></p>\n\n<p>Since you want each these entries in separate <code>&lt;td&gt;</code>s its easier if you could put them in a <code>map</code> instead of a <code>slice</code>. You could use a function like below for that.</p>\n\n<pre><code>sliceToMap := func(s []*Communication) map[string]string {\n    comms := map[string]string{}\n\n    for _, c := range s {\n        comms[c.Type] = c.Value\n    }\n\n    return comms\n}\n</code></pre>\n\n<p>You can register this as a custom function to be used in the template,</p>\n\n<pre><code>t := template.Must(template.New(\"\").Funcs(template.FuncMap{\n    \"SliceToMap\": sliceToMap,\n}).Parse(src))\n</code></pre>\n\n<p>Then your template could be,</p>\n\n<pre><code>&lt;tbody&gt;  \n{{range $key, $val := .Users}}   \n&lt;td style=\"text-align: center;\"&gt;{{$val.Name}}&lt;/td&gt;  \n&lt;td style=\"text-align: center;\"&gt;{{$val.Gender}}&lt;/td&gt; \n\n{{$comms := SliceToMap $val.Communication}}\n\n&lt;td style=\"text-align: center;\"&gt;{{index $comms \"mobile\"}}&lt;/td&gt;\n&lt;td style=\"text-align: center;\"&gt;{{index $comms \"email\"}}&lt;/td&gt;\n\n{{end}}  \n&lt;/tbody&gt;\n</code></pre>\n\n<p>See these in <a href=\"http://play.golang.org/p/QHMRUI9XRi\" rel=\"nofollow\">Go Playground</a></p>\n"}], "owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1875, "favorite_count": 0, "accepted_answer_id": 36425818, "answer_count": 1, "score": 2, "last_activity_date": 1459959493, "creation_date": 1459855632, "last_edit_date": 1459959493, "question_id": 36425071, "link": "https://stackoverflow.com/questions/36425071/nested-range-in-go-template", "title": "nested range in Go template", "body": "<p>I have structure like these  </p>\n\n<pre><code>type Users struct{  \n    Name           string           `json:\"Name,omitempty\"`  \n    Gender         string           `json:\"Gender,omitempty\"`  \n    Communication  []*Communication `json:\"Communication,omitempty\"`  \n}  \n\ntype Communication struct {  \n    Type  string `json:\"Type,omitempty\"`  \n    Value string `json:\"Value,omitempty\"`  \n}  \n</code></pre>\n\n<p>every user will have two communication structure like </p>\n\n<pre><code>[\n    {\n        \"Type\": \"MOBILE\",\n        \"Value\": \"12121212\"\n    },\n    {\n        \"Type\": \"Email\",\n        \"Value\": \"Some@email.com\"\n    }\n]  \n</code></pre>\n\n<p>In my template i want to display them in a table. iam getting the User structure values, but could not get the communication structure values  </p>\n\n<p>HTML Template file (partial code):  </p>\n\n<pre><code>&lt;tbody&gt;  \n{{range $key, $val := .Users}}   \n&lt;td style=\"text-align: center;\"&gt;{{$val.Name}}&lt;/td&gt;  \n&lt;td style=\"text-align: center;\"&gt;{{$val.Gender}}&lt;/td&gt;  \n///////How to display communication values here??////////////  \n{{end}}  \n&lt;/tbody&gt;\n</code></pre>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1459858697, "post_id": 36424907, "comment_id": 60466561, "body": "Have a registry where you register each type by its name. Then consult the registry with that name and pull out whatever you registered. A bit how image decoders register them in the image package. Don&#39;t do reflection."}, {"owner": {"reputation": 708, "user_id": 4144758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfea5e29717057a628f9363b652e5a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele D", "link": "https://stackoverflow.com/users/4144758/daniele-d"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1459861005, "post_id": 36424907, "comment_id": 60468307, "body": "@Volker I&#39;m aware that I shouldn&#39;t, but the question was: <i>could</i> I do reflection?"}], "answers": [{"comments": [{"owner": {"reputation": 708, "user_id": 4144758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfea5e29717057a628f9363b652e5a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele D", "link": "https://stackoverflow.com/users/4144758/daniele-d"}, "edited": false, "score": 0, "creation_date": 1460378416, "post_id": 36428465, "comment_id": 60698588, "body": "Sorry that it took me long to accept the answer. I was hoping for someone to shout &quot;NOPE&quot;"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1459864599, "creation_date": 1459864599, "answer_id": 36428465, "question_id": 36424907, "link": "https://stackoverflow.com/questions/36424907/reflection-struct-by-string/36428465#36428465", "title": "Reflection: Struct by string", "body": "<p>Sorry, you can't. The answer is: you could <em>not</em>. There is no builtin or pre-initialized registry of type names.</p>\n\n<p>To get started with reflection (<a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow\"><code>reflect</code></a> package), you need a value (of the type in question). Based on a <code>string</code> (<code>string</code> name of the type), you can't acquire a value of that type, so you can't get started.</p>\n\n<p>If you do want to do what you want only by a <code>string</code> type name, you need to build your own \"registry\" prior to doing what you want.</p>\n"}], "owner": {"reputation": 708, "user_id": 4144758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfea5e29717057a628f9363b652e5a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele D", "link": "https://stackoverflow.com/users/4144758/daniele-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 1, "accepted_answer_id": 36428465, "answer_count": 1, "score": 1, "last_activity_date": 1459864599, "creation_date": 1459855114, "last_edit_date": 1495535310, "question_id": 36424907, "link": "https://stackoverflow.com/questions/36424907/reflection-struct-by-string", "title": "Reflection: Struct by string", "body": "<p>Let's assume I have this struct with a method:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype MyStruct struct {\n}\n\nfunc (a *MyStruct) AAction() {\n    fmt.Println(\"Hello a\")\n}\n</code></pre>\n\n<p>Now, if I want to call the method \"AAction\" by string, I can use reflection (this works):</p>\n\n<pre><code>func main() {\n    reflect.New(reflect.TypeOf(MyStruct{})).MethodByName(\"AAction\").Call([]reflect.Value{})\n}\n</code></pre>\n\n<p>The problem is, that I don't want to use MyStruct{} as an expression, but as a string. Of course this doesn't work:</p>\n\n<pre><code>func main() {\n    theStruct := \"MyStruct\"\n    theAction := \"AAction\"\n    reflect.New(reflect.TypeOf(theStruct)).MethodByName(theAction).Call([]reflect.Value{})\n}\n</code></pre>\n\n<p>because reflect.Typeof(theStruct) would be a string. \nI tried reading through the documentation, sadly, I can't find anything very useful.</p>\n\n<p>I found this similar question: <a href=\"https://stackoverflow.com/questions/8103617/call-a-struct-and-its-method-by-name-in-go\">Call a Struct and its Method by name in Go?</a>\n<br /> Under the accepted question, the OP asks:</p>\n\n<blockquote>\n  <p>The issue in my case Is I cant not declare t is typed T, its must be some how I can declare t typed T by the name of T is string \"T\"</p>\n</blockquote>\n\n<p>which gets answered by </p>\n\n<blockquote>\n  <p>[...] I would suggest to match the name against the string \"T\" somewhere in your code [...]</p>\n</blockquote>\n\n<p>which doesn't solve the problem, as I would still need to call <code>MyStruct{}</code> somewhere.</p>\n\n<p>The question is: is there any way to use a struct by giving the name as a string? (without manually mapping the the name of the struct to the struct)</p>\n\n<p>Working version with using <code>reflect.TypeOf(MyStruct{})</code>:\n<a href=\"https://play.golang.org/p/NqVIE07EoN\" rel=\"nofollow noreferrer\">PlayGround</a><br/>\nNot working version, obviously calling the method on a string: <a href=\"https://play.golang.org/p/ZbdKmCvNPB\" rel=\"nofollow noreferrer\">PlayGround</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459847553, "post_id": 36421862, "comment_id": 60458343, "body": "Issue is most likely you try to use <code>stmt</code> after the <code>if</code>, but they are scoped to the blocks they were created in. Declare <code>stmt</code> before the <code>if</code>, and just use assignment <code>=</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459848239, "post_id": 36421862, "comment_id": 60458834, "body": "Also related: <a href=\"http://stackoverflow.com/questions/35533960/how-do-i-create-a-variable-in-go-only-if-a-condition-is-true\">How do I create a variable in go only if a condition is true?</a>"}, {"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459848329, "post_id": 36421862, "comment_id": 60458893, "body": "@icza whats the correct way to define stmt?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459848803, "post_id": 36421862, "comment_id": 60459238, "body": "See question marked as duplicate, also the related one, also the answer below."}, {"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459848929, "post_id": 36421862, "comment_id": 60459324, "body": "@icza I can see the duplicate post, but it doesn&#39;t help me, I no how to cast an empty struct, but this isn&#39;t a struct?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459854858, "post_id": 36421862, "comment_id": 60463702, "body": "Please read the answers to the linked questions, not just the questions themselves."}], "answers": [{"comments": [{"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "edited": false, "score": 0, "creation_date": 1459847839, "post_id": 36421972, "comment_id": 60458537, "body": "This looks like what I was expecting - I just didnt no how, but I get the error of <code>undefined: sql in sql.Stmt</code> now."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 0, "last_activity_date": 1459847627, "creation_date": 1459847627, "answer_id": 36421972, "question_id": 36421862, "link": "https://stackoverflow.com/questions/36421862/go-error-when-using-if-statement-around-query/36421972#36421972", "title": "Go - Error when using if statement around query", "body": "<p>Your problem is that you are using <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">Short Variable Declaration</a>, so your <code>stmt</code> and <code>err</code> variables are scoped to the inner block of your conditions (both the <code>if</code> and the <code>else</code>.</p>\n\n<p>This should do the trick:</p>\n\n<pre><code>var stmt *sql.Stmt\nvar err error\nif strings.EqualFold(update_status, \"live\") {\n    stmt, err = dbmap.Prepare(\n        \"UPDATE Apps SET version=?,deploy_status=?,status=?,live_date=? WHERE id=?\")\n} else {\n    stmt, err = dbmap.Prepare(\n        \"UPDATE Apps SET version=?,deploy_status=?,status=? WHERE id=?\")\n}\n//stmt is still defined here\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "closed_date": 1459848186, "answer_count": 1, "score": 1, "last_activity_date": 1459959512, "creation_date": 1459847320, "last_edit_date": 1459959512, "question_id": 36421862, "link": "https://stackoverflow.com/questions/36421862/go-error-when-using-if-statement-around-query", "closed_reason": "Duplicate", "title": "Go - Error when using if statement around query", "body": "<p>I am trying to run this - which would work fine in PHP but in Go I am getting an error:</p>\n\n<pre><code>if strings.EqualFold(update_status, \"live\") {\n    stmt, err := dbmap.Prepare(\n        \"UPDATE Apps SET version=?,deploy_status=?,status=?,live_date=? WHERE id=?\")\n} else {\n    stmt, err := dbmap.Prepare(\n        \"UPDATE Apps SET version=?,deploy_status=?,status=? WHERE id=?\")\n}\n</code></pre>\n\n<p>I get the error of <code>controllers/apps.go:1095: undefined: stmt in stmt.Exec</code>.</p>\n\n<p>How can I change this so it will work?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1459845360, "post_id": 36420953, "comment_id": 60456798, "body": "You test packages, not files like you build and install packages and not files."}, {"owner": {"reputation": 2745, "user_id": 1268294, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/qymw2.jpg?s=128&g=1", "display_name": "Pawe\u0142 Adamski", "link": "https://stackoverflow.com/users/1268294/pawe%c5%82-adamski"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1459846101, "post_id": 36420953, "comment_id": 60457308, "body": "Thanks @Volker, indeed when I test packages it works. Nevertheless it doesn&#39;t explain why I get such a strange error."}], "answers": [{"tags": [], "owner": {"reputation": 2745, "user_id": 1268294, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/qymw2.jpg?s=128&g=1", "display_name": "Pawe\u0142 Adamski", "link": "https://stackoverflow.com/users/1268294/pawe%c5%82-adamski"}, "is_accepted": true, "score": 3, "last_activity_date": 1459847271, "creation_date": 1459847271, "answer_id": 36421840, "question_id": 36420953, "link": "https://stackoverflow.com/questions/36420953/go-test-gives-very-strange-error-cannot-find-package-command-line-a-vendor/36421840#36421840", "title": "GO test gives very strange error - cannot find package command-line-a/vendor", "body": "<p>As @volker explained in a comment, my problem was that I wanted to test files instead of packages. \nWhen I reorganize my project and test simply by <code>go test</code> it works fine.</p>\n\n<p>Nevertheless it doesn't explain why I get such a strange error.</p>\n"}], "owner": {"reputation": 2745, "user_id": 1268294, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/qymw2.jpg?s=128&g=1", "display_name": "Pawe\u0142 Adamski", "link": "https://stackoverflow.com/users/1268294/pawe%c5%82-adamski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1003, "favorite_count": 1, "accepted_answer_id": 36421840, "answer_count": 1, "score": 4, "last_activity_date": 1459847271, "creation_date": 1459844807, "question_id": 36420953, "link": "https://stackoverflow.com/questions/36420953/go-test-gives-very-strange-error-cannot-find-package-command-line-a-vendor", "title": "GO test gives very strange error - cannot find package command-line-a/vendor", "body": "<p>I've update to GO 1.6 and now I get very strange error when running <code>go test</code></p>\n\n<pre><code>pawel@pawel:~/work/src/...../web/workers$ go test email_test.go \n# command-line-arguments\nemail_test.go:16:2: cannot find package \"command-line-a/vendor/github.com/jpoehls/gophermail\" in any of:\n    /usr/local/go/src/command-line-a/vendor/github.com/jpoehls/gophermail (from $GOROOT)\n    /home/pawel/work/src/command-line-a/vendor/github.com/jpoehls/gophermail (from $GOPATH)\n    /home/pawel/work/src/...../web/_vendor/src/command-line-a/vendor/github.com/jpoehls/gophermail\nFAIL    command-line-arguments [setup failed]\n</code></pre>\n\n<p>I've also tried to run it with <code>go test email_test.go email.go</code> but  result is the same. I grep for \"command-line\" in my whole project and vendor and haven't find it.</p>\n\n<p>Running <code>go run email.go</code> works correctly. My project dependencies are in directory <code>vendor</code> (which is one level higher), it contains  <code>github.com/jpoehls/gophermail</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459844887, "post_id": 36420863, "comment_id": 60456478, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31059023/how-to-reference-a-relative-file-from-code-and-tests\">how to reference a relative file from code and tests</a>"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1459848110, "post_id": 36420863, "comment_id": 60458729, "body": "You should not rely on the fact that the final compiled executable will be at the same location as its source code. There are several ways to specify which configuration file to use at runtime, the most obvious one being to pass it as a command line option. In this specific case, the path to the config file should be known by main.go and config_test.go, and vary accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 1364, "user_id": 711400, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6d759a9e10591c530ff2f1b400637eff?s=128&d=identicon&r=PG", "display_name": "Monodeep", "link": "https://stackoverflow.com/users/711400/monodeep"}, "is_accepted": true, "score": 4, "last_activity_date": 1459850096, "creation_date": 1459850096, "answer_id": 36422974, "question_id": 36420863, "link": "https://stackoverflow.com/questions/36420863/file-path-in-golang/36422974#36422974", "title": "File path in golang", "body": "<p>Relative paths are always resolved basis your current directory. Hence it's better to avoid relative paths. </p>\n\n<p>Use command line <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\">flags</a> or a configuration management tool (better approach) like <a href=\"https://github.com/spf13/viper\" rel=\"nofollow noreferrer\">Viper</a></p>\n\n<p>Also according to <a href=\"http://12factor.net/config\" rel=\"nofollow noreferrer\">The Twelve-Factor App</a> your config files should be outside your project.</p>\n\n<p><strong>Eg usage with Viper:</strong></p>\n\n<pre><code>import \"github.com/spf13/viper\"\n\nfunc init() {\n\n    viper.SetConfigName(\"config\")\n\n    // Config files are stored here; multiple locations can be added\n    viper.AddConfigPath(\"$HOME/configs\")\n    errViper := viper.ReadInConfig()\n\n    if errViper != nil {\n        panic(errViper)\n    }\n    // Get values from config.json\n    val := viper.GetString(\"some_key\")\n\n    // Use the value\n}\n</code></pre>\n"}], "owner": {"reputation": 4021, "user_id": 3830108, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/elcXQ.jpg?s=128&g=1", "display_name": "Cortwave", "link": "https://stackoverflow.com/users/3830108/cortwave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4698, "favorite_count": 0, "accepted_answer_id": 36422974, "answer_count": 1, "score": 3, "last_activity_date": 1459850096, "creation_date": 1459844574, "question_id": 36420863, "link": "https://stackoverflow.com/questions/36420863/file-path-in-golang", "title": "File path in golang", "body": "<p>I have a project with next structure:</p>\n\n<pre><code>|_main.go\n|_config\n  |_config.go\n  |_config_test.go\n  |_config.json\n</code></pre>\n\n<p>I'm having next code line in <code>config.go</code>:</p>\n\n<pre><code>file, _ := os.Open(\"config/config.json\")\n</code></pre>\n\n<p>When I'm executing method contained this code line from <code>main.go</code> all is working. But when I'm trying to execute this method from <code>config_test.go</code> it produces error:</p>\n\n<pre><code>open config/config.json: no such file or directory\n</code></pre>\n\n<p>As I understood it is a working directory issue because I'm launching same code with relative path from different directories. How can I fix this problem without using full path in <code>config.go</code>?</p>\n"}, {"tags": ["go", "google-cloud-storage", "metadatatype"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5440087, "user_type": "registered", "profile_image": "https://graph.facebook.com/970856512971392/picture?type=large", "display_name": "Phani Kumar Dytha", "link": "https://stackoverflow.com/users/5440087/phani-kumar-dytha"}, "edited": false, "score": 0, "creation_date": 1459847822, "post_id": 36420588, "comment_id": 60458526, "body": "Hi Brandon I&#39;ve tried that one too but it is not working, the type of the file is still text/plain when i upload the file in bucket through the code."}], "tags": [], "owner": {"reputation": 32859, "user_id": 81491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa2d855b58c41269f0876b99eac9607d?s=128&d=identicon&r=PG", "display_name": "Brandon Yarbrough", "link": "https://stackoverflow.com/users/81491/brandon-yarbrough"}, "is_accepted": false, "score": 1, "last_activity_date": 1459843782, "creation_date": 1459843782, "answer_id": 36420588, "question_id": 36420396, "link": "https://stackoverflow.com/questions/36420396/how-to-edit-the-metadata-information-of-an-object-in-cloud-storage-bucket-using/36420588#36420588", "title": "How to edit the metadata information of an object in cloud storage bucket using golang", "body": "<p><code>Metadata</code> is a string -> string map of custom, user-defined object properties. What you're looking for is <code>ContentType</code>.</p>\n\n<pre><code>object := &amp;storage.Object{Name: objectName, ContentType: \"text/csv; charset=utf-8\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5440087, "user_type": "registered", "profile_image": "https://graph.facebook.com/970856512971392/picture?type=large", "display_name": "Phani Kumar Dytha", "link": "https://stackoverflow.com/users/5440087/phani-kumar-dytha"}, "is_accepted": true, "score": 2, "last_activity_date": 1459875495, "last_edit_date": 1459875495, "creation_date": 1459873064, "answer_id": 36431822, "question_id": 36420396, "link": "https://stackoverflow.com/questions/36420396/how-to-edit-the-metadata-information-of-an-object-in-cloud-storage-bucket-using/36431822#36431822", "title": "How to edit the metadata information of an object in cloud storage bucket using golang", "body": "<p>Contacted Google Tech support. They gave the following answer and it worked perfectly.</p>\n\n<blockquote>\n  <p>I found the root cause that explained why the Content-type set via CS\n  API is \"text/plain; charset=utf-8\" instead of \"text/csv;\n  charset=utf-8\".</p>\n  \n  <p>As desribed on the <a href=\"https://godoc.org/google.golang.org/api/storage/v1#ObjectsInsertCall.Media\" rel=\"nofollow\">CLI-Go reference</a> the function Media(): the\n  Content-Type header used in the upload request will be determined by\n  sniffing the contents of r, unless a MediaOption generated by\n  googleapi.ContentType is supplied.</p>\n  \n  <p>So to generate a MediaOption you need to call to <a href=\"https://godoc.org/google.golang.org/api/googleapi#ContentType\" rel=\"nofollow\">googleapi.ContentType</a>:</p>\n  \n  <p>I modified your script by importing \"google.golang.org/api/googleapi\"\n  and calling insert as follows:</p>\n\n<pre><code>service.Objects.Insert(*bucketName,\nobject).Media(file,googleapi.ContentType(\"text/csv;\ncharset=utf-8\")).Do();\n</code></pre>\n  \n  <p>It seems that Media() overrides the data set on Object.</p>\n</blockquote>\n"}], "owner": {"reputation": 41, "user_id": 5440087, "user_type": "registered", "profile_image": "https://graph.facebook.com/970856512971392/picture?type=large", "display_name": "Phani Kumar Dytha", "link": "https://stackoverflow.com/users/5440087/phani-kumar-dytha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 0, "accepted_answer_id": 36431822, "answer_count": 2, "score": 2, "last_activity_date": 1459875495, "creation_date": 1459843174, "question_id": 36420396, "link": "https://stackoverflow.com/questions/36420396/how-to-edit-the-metadata-information-of-an-object-in-cloud-storage-bucket-using", "title": "How to edit the metadata information of an object in cloud storage bucket using golang", "body": "<p>I've tried to insert a csv file from a local machine to the cloud storage bucket but it is storing as a text file. When i tried including Metadata option in </p>\n\n<p>object := &amp;storage.Object{Name: objectName, Metadata: map[string]string{\"Content-Type\": \"text/csv; charset=utf-8\"}}</p>\n\n<p>It is creating another slot Content-Type and Storing the data but not changing the default value. Tried most of the options from google but unable to resolve this issue. Following is the code snippet.</p>\n\n<pre><code>package main\n\nimport (\n        \"flag\"\n        \"fmt\"\n        \"os\"\n        \"golang.org/x/net/context\"\n        \"golang.org/x/oauth2/google\"\n        storage \"google.golang.org/api/storage/v1\"\n)\n\nconst (\n        // This can be changed to any valid object name.\n        objectName = \"result\"\n        // This scope allows the application full control over resources in Google Cloud Storage\n        scope = storage.DevstorageFullControlScope\n)\n\nvar (\n        projectID  = flag.String(\"project\", \"phani-1247 \", \"Your cloud project ID.\")\n        bucketName = flag.String(\"bucket\", \"test-csvstorage\", \"The name of an existing bucket within your project.\")\n        fileName   = flag.String(\"file\", \"/home/phanikumar_dytha0/src/phani-1247/master/router/result.csv\", \"The file to upload.\")\n)\n\n\n\nfunc main() {\n        flag.Parse()\n       client, err := google.DefaultClient(context.Background(), scope)\n        if err!=nil{\n            fmt.Printf(\"error\")\n        }\n        // Insert an object into a bucket.\n        object := &amp;storage.Object{Name: objectName, Metadata: map[string]string{\"Content-Type\": \"text/csv; charset=utf-8\"}}\n        file, err := os.Open(*fileName)\n        if err!=nil{\n            fmt.Printf(\"error\")\n        }\n        service, err := storage.New(client)\n        if err!=nil{\n            fmt.Printf(\"error\")\n        }\n\n        if res, err := service.Objects.Insert(*bucketName, object).Media(file).Do(); err == nil {\n                //fmt.Printf(\"%v\",res,\"\\n\")\n                fmt.Printf(\"Created object %v at location %v\\n\\n\", res.Name, res.SelfLink)\n        } else {\n                fmt.Printf(\"Objects.Insert failed: %v\", err)\n        }\n\n\n}\n</code></pre>\n"}, {"tags": ["go", "rabbitmq", "rabbitmq-exchange", "rabbitmqctl"], "comments": [{"owner": {"reputation": 881, "user_id": 276186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5627ef10f7577e6994bc424aa830f2?s=128&d=identicon&r=PG", "display_name": "PerroVerd", "link": "https://stackoverflow.com/users/276186/perroverd"}, "edited": false, "score": 0, "creation_date": 1459849657, "post_id": 36419994, "comment_id": 60459883, "body": "Try the amqp package to interact with rabbit, also it has a very decent documentation <a href=\"https://godoc.org/github.com/streadway/amqp\" rel=\"nofollow noreferrer\">godoc.org/github.com/streadway/amqp</a>"}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "reply_to_user": {"reputation": 881, "user_id": 276186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5627ef10f7577e6994bc424aa830f2?s=128&d=identicon&r=PG", "display_name": "PerroVerd", "link": "https://stackoverflow.com/users/276186/perroverd"}, "edited": false, "score": 0, "creation_date": 1459852744, "post_id": 36419994, "comment_id": 60462223, "body": "@PerroVerd That&#39;s what i am using."}], "answers": [{"comments": [{"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1460007441, "post_id": 36458184, "comment_id": 60546116, "body": "Thanking you so much for detailed explanation."}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1460024494, "post_id": 36458184, "comment_id": 60556827, "body": "@Pedro..I am having one problem. If i use d.Ack(true) or d.Ack(false) it is not publishing the messages in dead-lettered-queue. Where as in case of d.Nack(true, false) it publishes. But then after ttl it drops the messages from there. So, what are the values to achieve the same"}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1460041272, "post_id": 36458184, "comment_id": 60570074, "body": "I have edited question. Could you please look into it"}, {"owner": {"reputation": 37873, "user_id": 1202421, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9ecf725ab72554a6fb27e979e3cd0a6?s=128&d=identicon&r=PG", "display_name": "Pedro Werneck", "link": "https://stackoverflow.com/users/1202421/pedro-werneck"}, "reply_to_user": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1460042312, "post_id": 36458184, "comment_id": 60570829, "body": "@Naresh That&#39;s a new RabbitMQ question, unrelated to the Go question here. You should create a new question with that."}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1460130157, "post_id": 36458184, "comment_id": 60614673, "body": "I have created new question. Could you please tell me why it is exhibiting this behaviour <code>http:&#47;&#47;stackoverflow.com&#47;questions&#47;36503804&#47;dead-letterred-m&zwnj;&#8203;essages-not-getting-&zwnj;&#8203;requeue-to-original-&zwnj;&#8203;queue-after-ttl</code>"}], "tags": [], "owner": {"reputation": 37873, "user_id": 1202421, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9ecf725ab72554a6fb27e979e3cd0a6?s=128&d=identicon&r=PG", "display_name": "Pedro Werneck", "link": "https://stackoverflow.com/users/1202421/pedro-werneck"}, "is_accepted": true, "score": 4, "last_activity_date": 1459963599, "creation_date": 1459963599, "answer_id": 36458184, "question_id": 36419994, "link": "https://stackoverflow.com/questions/36419994/rabbitmq-consumer-in-go/36458184#36458184", "title": "RabbitMQ consumer in Go", "body": "<blockquote>\n  <p>Is there any concept of BasicConsumer vs EventingBasicConsumer in\n  RabbitMq-go Reference?</p>\n</blockquote>\n\n<p>Not exactly, but the <code>Channel.Get</code> and <code>Channel.Consume</code> calls serve a similar concept. With <code>Channel.Get</code> you have a non-blocking call that gets the first message if there's any available, or returns <code>ok=false</code>. With <code>Channel.Consume</code> the queued messages are delivered to a channel.</p>\n\n<blockquote>\n  <p>What is Model in RabbitMQ and is it there in RabbitMq-go?</p>\n</blockquote>\n\n<p>If you're referring to the <code>IModel</code> and <code>Connection.CreateModel</code> in C# RabbitMQ, that's something from the C# lib, not from RabbitMQ itself. It was just an attempt to abstract away from the RabbitMQ \"Channel\" terminology, but it never caught on.</p>\n\n<blockquote>\n  <p>How to send the objects when failed to dead-letter queue and again\n  re-queue them after ttl</p>\n</blockquote>\n\n<p>Use the <a href=\"https://godoc.org/github.com/streadway/amqp#Delivery.Nack\" rel=\"nofollow\">delivery.Nack</a> method with <code>requeue=false</code>.</p>\n\n<blockquote>\n  <p>What is the significance of consumerTag argument in the ch.Consume\n  function in the below code</p>\n</blockquote>\n\n<p>The <code>ConsumerTag</code> is just a consumer identifier. It can be used to cancel the channel with <a href=\"https://godoc.org/github.com/streadway/amqp#Channel.Cancel\" rel=\"nofollow\">channel.Cancel</a>, and to identify the consumer responsible for the delivery. All messages delivered with the <code>channel.Consume</code> will have the <code>ConsumerTag</code> field set.</p>\n\n<blockquote>\n  <p>Should we use the <code>channel.Get()</code> or <code>channel.Consume()</code> for this scenario?</p>\n</blockquote>\n\n<p>I think <code>channel.Get()</code> is almost never preferable over <code>channel.Consume()</code>. With <code>channel.Get</code> you'll be polling the queue and wasting CPU doing nothing, which doesn't make sense in Go. </p>\n\n<blockquote>\n  <p>What are the changes i need to make in the below code to meet above\n  requirement.</p>\n</blockquote>\n\n<ol>\n<li><p>Since you're batch processing 5 at a time, you can have a goroutine that receives from the consumer channel and once it gets the 5 deliveries you call another function to process them.</p></li>\n<li><p>To acknowledge or send to the dead-letter queue you'll use the <a href=\"https://godoc.org/github.com/streadway/amqp#Delivery.Ack\" rel=\"nofollow\">delivery.Ack</a> or <a href=\"https://godoc.org/github.com/streadway/amqp#Delivery.Nack\" rel=\"nofollow\">delivery.Nack</a> functions. You can use <code>multiple=true</code> and call it once for the batch. Once the message goes to the dead letter queue, you have to check the <code>delivery.Headers[\"x-death\"]</code> header for how many times its been dead-lettered and call <a href=\"https://godoc.org/github.com/streadway/amqp#Delivery.Reject\" rel=\"nofollow\">delivery.Reject</a> when its been retried for 5 times already.</p></li>\n<li><p>Use <a href=\"https://godoc.org/github.com/streadway/amqp#Channel.NotifyCancel\" rel=\"nofollow\">channel.NotifyCancel</a> to handle the cancellation event.</p></li>\n</ol>\n"}], "owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4824, "favorite_count": 3, "accepted_answer_id": 36458184, "answer_count": 1, "score": 4, "last_activity_date": 1460041247, "creation_date": 1459841930, "last_edit_date": 1460041247, "question_id": 36419994, "link": "https://stackoverflow.com/questions/36419994/rabbitmq-consumer-in-go", "title": "RabbitMQ consumer in Go", "body": "<p>I am trying to write a RabbitMQ Consumer in Go. Which is suppose to take the 5 objects at a time from the queue and process them. Moreover, it is suppose to acknowledge if successfully processed else send to the dead-letter queue for 5 times and then discard, it should be running infinitely and handling the cancellation event of the consumer. \nI have few questions :</p>\n\n<ol>\n<li>Is there any concept of <code>BasicConsumer</code> vs <code>EventingBasicConsumer</code>  in RabbitMq-go <a href=\"http://www.jarloo.com/listening-to-rabbitmq-events/\" rel=\"nofollow\">Reference</a>?</li>\n<li>What is <code>Model</code> in RabbitMQ and is it there in RabbitMq-go?</li>\n<li>How to send the objects when failed to dead-letter queue and again re-queue them after <code>ttl</code></li>\n<li>What is the significance of <code>consumerTag</code> argument in the <code>ch.Consume</code> function in the below code</li>\n<li>Should we use the <code>channel.Get()</code> or <code>channel.Consume()</code> for this scenario?</li>\n</ol>\n\n<p>What are the changes i need to make in the below code to meet above requirement. I am asking this because i couldn't find decent documentation of RabbitMq-Go.</p>\n\n<pre><code>   func main() {\n\n        consumer()        \n    }\n\n    func consumer() {\n\n        objConsumerConn := &amp;rabbitMQConn{queueName: \"EventCaptureData\", conn: nil}      \n        initializeConn(&amp;objConsumerConn.conn)\n\n\n        ch, err := objConsumerConn.conn.Channel()\n        failOnError(err, \"Failed to open a channel\")\n        defer ch.Close()\n\n        msgs, err := ch.Consume(\n                objConsumerConn.queueName, // queue\n                \"demo1\",     // consumerTag\n                false,   // auto-ack\n                false,  // exclusive\n                false,  // no-local\n                false,  // no-wait\n                nil,    // args\n        )\n        failOnError(err, \"Failed to register a consumer\")\n\n        forever := make(chan bool)\n\n        go func() {\n            for d := range msgs {                  \n                k := new(EventCaptureData)\n                b := bytes.Buffer{}\n                b.Write(d.Body)\n                dec := gob.NewDecoder(&amp;b)  \n                err := dec.Decode(&amp;k)\n                d.Ack(true)  \n\n                if err != nil { fmt.Println(\"failed to fetch the data from consumer\", err); }\n                    fmt.Println(k)                        \n            }\n        }()      \n\n        log.Printf(\" Waiting for Messages to process. To exit press CTRL+C \")\n        &lt;-forever\n\n    }\n</code></pre>\n\n<p><strong>Edited question:</strong></p>\n\n<p>I have delayed the processing of the messages as suggested in the links <a href=\"http://yuserinterface.com/dev/2013/01/08/how-to-schedule-delay-messages-with-rabbitmq-using-a-dead-letter-exchange/\" rel=\"nofollow\">link1</a> <a href=\"http://www.kuntalganguly.com/2015/02/delay-or-schedule-message-delivery-with.html\" rel=\"nofollow\">link2</a>. But the problem is messages are getting back to their original queue from dead-lettered queue even after ttl. I am using <code>RabbitMQ 3.0.0</code>. Can anyone point out what is the problem?</p>\n"}, {"tags": ["go", "blocking", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 339, "user_id": 7295761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tAexY.jpg?s=128&g=1", "display_name": "recolic", "link": "https://stackoverflow.com/users/7295761/recolic"}, "edited": false, "score": 0, "creation_date": 1606292716, "post_id": 36419222, "comment_id": 114917387, "body": "Not working. The program crashes with <code>fatal error: all goroutines are asleep - deadlock!</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 339, "user_id": 7295761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tAexY.jpg?s=128&g=1", "display_name": "recolic", "link": "https://stackoverflow.com/users/7295761/recolic"}, "edited": false, "score": 0, "creation_date": 1606292886, "post_id": 36419222, "comment_id": 114917465, "body": "@recolic The answer shows how to block the main goroutine. If all your other goroutines block as well, that&#39;s obviously a deadlock. If you get that, you&#39;re doing something wrong in your other goroutines, or you shouldn&#39;t block unconditionally your main."}, {"owner": {"reputation": 339, "user_id": 7295761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tAexY.jpg?s=128&g=1", "display_name": "recolic", "link": "https://stackoverflow.com/users/7295761/recolic"}, "edited": false, "score": 0, "creation_date": 1606292997, "post_id": 36419222, "comment_id": 114917512, "body": "I&#39;m simply writing a program to trick windows defender. In other word, I&#39;m implementing a deadlock. ( <a href=\"https://git.recolic.net/bensl/file-share/blob/master/fuck-windows-defender/main.go\" rel=\"nofollow noreferrer\">git.recolic.net/bensl/file-share/blob/master/&hellip;</a> )"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 339, "user_id": 7295761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tAexY.jpg?s=128&g=1", "display_name": "recolic", "link": "https://stackoverflow.com/users/7295761/recolic"}, "edited": false, "score": 0, "creation_date": 1606293055, "post_id": 36419222, "comment_id": 114917536, "body": "@recolic I don&#39;t see your code, I obviously can&#39;t reason about it. If you have a specific question, post a new question."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 339, "user_id": 7295761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tAexY.jpg?s=128&g=1", "display_name": "recolic", "link": "https://stackoverflow.com/users/7295761/recolic"}, "edited": false, "score": 0, "creation_date": 1606293338, "post_id": 36419222, "comment_id": 114917647, "body": "@recolic You have a single (main) gorotuine and you block that. What else would you expect?"}, {"owner": {"reputation": 339, "user_id": 7295761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tAexY.jpg?s=128&g=1", "display_name": "recolic", "link": "https://stackoverflow.com/users/7295761/recolic"}, "edited": false, "score": 0, "creation_date": 1606293549, "post_id": 36419222, "comment_id": 114917742, "body": "I&#39;m working on replacing the WindowsDefender executable with this dead program, so WindowsDefender stop performing heavy IO operation while I&#39;m gaming..."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 339, "user_id": 7295761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tAexY.jpg?s=128&g=1", "display_name": "recolic", "link": "https://stackoverflow.com/users/7295761/recolic"}, "edited": false, "score": 1, "creation_date": 1606293830, "post_id": 36419222, "comment_id": 114917858, "body": "@recolic If you just want to wait indefinitely, use a big duration with sleep, e.g. <code>time.Sleep(time.Duration(1&lt;&lt;63 - 1))</code>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 51, "last_activity_date": 1606293823, "last_edit_date": 1606293823, "creation_date": 1459839467, "answer_id": 36419222, "question_id": 36419054, "link": "https://stackoverflow.com/questions/36419054/go-projects-main-goroutine-sleep-forever/36419222#36419222", "title": "Go project&#39;s main goroutine sleep forever?", "body": "<h3>&quot;Sleeping&quot;</h3>\n<p>You can use numerous constructs that block forever without &quot;eating&quot; up your CPU.</p>\n<p>For example a <code>select</code> without any <code>case</code> (and no <code>default</code>):</p>\n<pre><code>select{}\n</code></pre>\n<p>Or receiving from a channel where nobody sends anything:</p>\n<pre><code>&lt;-make(chan int)\n</code></pre>\n<p>Or receiving from a <code>nil</code> channel also blocks forever:</p>\n<pre><code>&lt;-(chan int)(nil)\n</code></pre>\n<p>Or sending on a <code>nil</code> channel also blocks forever:</p>\n<pre><code>(chan int)(nil) &lt;- 0\n</code></pre>\n<p>Or locking an already locked <code>sync.Mutex</code>:</p>\n<pre><code>mu := sync.Mutex{}\nmu.Lock()\nmu.Lock()\n</code></pre>\n<h3>Quitting</h3>\n<p>If you do want to provide a way to quit, a simple channel can do it. Provide a <code>quit</code> channel, and receive from it. When you want to quit, close the <code>quit</code> channel as &quot;a receive operation on a closed channel can always proceed immediately, yielding the element type's <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">zero value</a> after any previously sent values have been received&quot;.</p>\n<pre><code>var quit = make(chan struct{})\n\nfunc main() {\n    // Startup code...\n\n    // Then blocking (waiting for quit signal):\n    &lt;-quit\n}\n\n// And in another goroutine if you want to quit:\nclose(quit)\n</code></pre>\n<p>Note that issuing a <code>close(quit)</code> may terminate your app at any time. Quoting from <a href=\"https://golang.org/ref/spec#Program_execution\" rel=\"noreferrer\">Spec: Program execution:</a></p>\n<blockquote>\n<p>Program execution begins by initializing the main package and then invoking the function <code>main</code>. When that function invocation returns, the program exits. <strong>It does not wait for other (non-<code>main</code>) goroutines to complete.</strong></p>\n</blockquote>\n<p>When <code>close(quit)</code> is executed, the last statement of our <code>main()</code> function can proceed which means the <code>main</code> goroutine can return, so the program exits.</p>\n<h2>Sleeping without blocking</h2>\n<p>The above constructs block the goroutine, so if you don't have other goroutines running, that will cause a deadlock.</p>\n<p>If you don't want to block the <code>main</code> goroutine but you just don't want it to end, you may use a <a href=\"https://golang.org/pkg/time/#Sleep\" rel=\"noreferrer\"><code>time.Sleep()</code></a> with a sufficiently large duration. The max duration value is</p>\n<pre><code>const maxDuration time.Duration = 1&lt;&lt;63 - 1\n</code></pre>\n<p>which is approximately 292 years.</p>\n<pre><code>time.Sleep(time.Duration(1&lt;&lt;63 - 1))\n</code></pre>\n<p>If you fear your app will run longer than 292 years, put the above sleep in an endless loop:</p>\n<pre><code>for {\n    time.Sleep(time.Duration(1&lt;&lt;63 - 1))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "is_accepted": false, "score": 7, "last_activity_date": 1459839671, "creation_date": 1459839671, "answer_id": 36419288, "question_id": 36419054, "link": "https://stackoverflow.com/questions/36419054/go-projects-main-goroutine-sleep-forever/36419288#36419288", "title": "Go project&#39;s main goroutine sleep forever?", "body": "<p>It depends on use cases to choose what kind of sleep you want.</p>\n\n<p>@icza provides a good and simple solution for literally sleeping forever, but I want to give you some more sweets if you want your system could shutdown gracefully.</p>\n\n<p>You could do something like this:</p>\n\n<pre><code>func mainloop() {\n    exitSignal := make(chan os.Signal)\n    signal.Notify(exitSignal, syscall.SIGINT, syscall.SIGTERM)\n    &lt;-exitSignal\n\n    systemTeardown()\n}\n</code></pre>\n\n<p>And in your main:</p>\n\n<pre><code>func main() {\n    systemStart()\n    mainloop()\n}\n</code></pre>\n\n<p>In this way, you could not only ask your main to sleep forever, but you could do some graceful shutdown stuff after your code receives <code>INT</code> or <code>TERM</code> signal from OS, like <code>ctrl+C</code> or <code>kill</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 339, "user_id": 7295761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tAexY.jpg?s=128&g=1", "display_name": "recolic", "link": "https://stackoverflow.com/users/7295761/recolic"}, "is_accepted": false, "score": 0, "last_activity_date": 1606293668, "creation_date": 1606293668, "answer_id": 65001137, "question_id": 36419054, "link": "https://stackoverflow.com/questions/36419054/go-projects-main-goroutine-sleep-forever/65001137#65001137", "title": "Go project&#39;s main goroutine sleep forever?", "body": "<p>Another solution to block a goroutine. This solution prevents Go-Runtime to complain about the deadlock:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>import &quot;time&quot;\n\nfunc main() {\n    for {\n        time.Sleep(1138800 * time.Hour)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 715, "user_id": 5324031, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/310ce145233b69bc87af1c03f63a6168?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Zhou", "link": "https://stackoverflow.com/users/5324031/dev-zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8111, "favorite_count": 7, "accepted_answer_id": 36419222, "answer_count": 3, "score": 27, "last_activity_date": 1606293823, "creation_date": 1459838938, "last_edit_date": 1459959603, "question_id": 36419054, "link": "https://stackoverflow.com/questions/36419054/go-projects-main-goroutine-sleep-forever", "title": "Go project&#39;s main goroutine sleep forever?", "body": "<p>Is there any API to let the <code>main</code> goroutine sleep forever? </p>\n\n<p>In other words, I want my project always run except when I stop it.</p>\n"}, {"tags": ["reflection", "go", "interface"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1553776780, "last_edit_date": 1553776780, "creation_date": 1459837765, "answer_id": 36418702, "question_id": 36418582, "link": "https://stackoverflow.com/questions/36418582/how-can-we-use-the-actual-type-pointed-to-by-an-empty-interface-to-create-a-new/36418702#36418702", "title": "How can we use the actual type pointed to by an empty interface to create a new instance of that type in Go?", "body": "<p>You can use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a> to extract the <code>reflect.Type</code> value from an <code>interface{}</code> value:</p>\n\n<pre><code>fmt.Printf(\"%v\\n\", reflect.New(z.(reflect.Type))) //----&gt; Works!\n</code></pre>\n\n<p>Your modified example on the <a href=\"https://play.golang.org/p/K2c8_fkOhD\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Note that the above example panics if <code>z</code> does not hold a value of type <code>reflect.Type</code> or if it is <code>nil</code>. You can use the special comma-ok form to prevent that:</p>\n\n<pre><code>if t, ok := z.(reflect.Type); ok {\n    fmt.Printf(\"%v\\n\", reflect.New(t))    // t is of type reflect.Type\n} else {\n    fmt.Println(\"Not the expected type or nil!\")\n}\n</code></pre>\n"}], "owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 36418702, "answer_count": 1, "score": 1, "last_activity_date": 1553776780, "creation_date": 1459837330, "last_edit_date": 1459959628, "question_id": 36418582, "link": "https://stackoverflow.com/questions/36418582/how-can-we-use-the-actual-type-pointed-to-by-an-empty-interface-to-create-a-new", "title": "How can we use the actual type pointed to by an empty interface to create a new instance of that type in Go?", "body": "<p>Please check the below program. Var <code>z</code> is of type <code>interface{}</code>. It stores the type of struct <code>X</code>. But I cannot use it to create a new instance of <code>X</code>. I have some requirement where I need to keep the type of the object in an <code>interface{}</code> variable, and use that to create an instance of that type. Here is a <a href=\"https://play.golang.org/p/RnUwShrz54\" rel=\"nofollow\">link for the snippet on go playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype X struct {\n    a int\n    b int\n}\n\ntype MyInt int\n\nfunc main() {\n    x := X{}\n    y := reflect.TypeOf(x)\n    fmt.Printf(\"%v\\n\", reflect.New(y))\n\n    var z interface{}\n    z = y\n    fmt.Printf(\"%v\\n\", z) // prints main.X\n\n    //Below line throws the error\n    fmt.Printf(\"%v\\n\", reflect.New(z)) //----&gt; This line throws error\n\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "channel", "goroutine"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1459834141, "post_id": 36417199, "comment_id": 60450527, "body": "Why do you think &quot;broadcasting&quot; needs a closed channel? The <code>for c:= range ch</code> loop won&#39;t terminate until ch is closed but that&#39;s all."}], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 5081447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155753612750261/picture?type=large", "display_name": "Jin Hoon Jeffrey Bang", "link": "https://stackoverflow.com/users/5081447/jin-hoon-jeffrey-bang"}, "edited": false, "score": 0, "creation_date": 1460072874, "post_id": 36418082, "comment_id": 60587059, "body": "Thanks, but what if you don&#39;t know the number of endpoints (workers) before hand? How would you iterate through workers in each of the goroutine?"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "reply_to_user": {"reputation": 381, "user_id": 5081447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155753612750261/picture?type=large", "display_name": "Jin Hoon Jeffrey Bang", "link": "https://stackoverflow.com/users/5081447/jin-hoon-jeffrey-bang"}, "edited": false, "score": 0, "creation_date": 1460083092, "post_id": 36418082, "comment_id": 60589658, "body": "the simplest way is to start a <code>worker</code> and then push it into <code>workers</code> slice, then it will be broadcasted when the next time for loop in dispatcher is running. Remember to use locks when you are doing the slice push :)"}, {"owner": {"reputation": 406, "user_id": 142965, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dbf58358a070a0a2bb765d672a0a42c7?s=128&d=identicon&r=PG", "display_name": "speps", "link": "https://stackoverflow.com/users/142965/speps"}, "edited": false, "score": 1, "creation_date": 1474189702, "post_id": 36418082, "comment_id": 66422908, "body": "I made a Gist from the &quot;when number of listeners is not know&quot; example as the code wasn&#39;t complete and had errors in it. This is a simple server that broadcasts integers generated from one goroutine, every connection is then sent the data using broadcasting : <a href=\"https://gist.github.com/speps/ce645a5ca2d2cb9a81e52c7311f38677\" rel=\"nofollow noreferrer\">gist.github.com/speps/ce645a5ca2d2cb9a81e52c7311f38677</a>"}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1575971652, "post_id": 36418082, "comment_id": 104736925, "body": "This code is racy. Think about what happens when every case is ready in the select statement."}], "tags": [], "owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "is_accepted": true, "score": 53, "last_activity_date": 1516422356, "last_edit_date": 1516422356, "creation_date": 1459835280, "answer_id": 36418082, "question_id": 36417199, "link": "https://stackoverflow.com/questions/36417199/how-to-broadcast-message-using-channel/36418082#36418082", "title": "How to broadcast message using channel", "body": "<p>What you are doing is a fan out pattern, that is to say, multiple endpoints are listening to a single input source. The result of this pattern is, only one of these listeners will be able to get the message whenever there's a message in the input source. The only exception is a <code>close</code> of channel. This <code>close</code> will be recognized by all of the listeners, and thus a \"broadcast\".</p>\n\n<p>But what you want to do is broadcasting a message read from connection, so we could do something like this:</p>\n\n<h2>When the number of listeners is known</h2>\n\n<p>Let each worker listen to dedicated broadcast channel, and dispatch the message from the main channel to each dedicated broadcast channel.</p>\n\n<pre><code>type worker struct {\n    source chan interface{}\n    quit chan struct{}\n}\n\nfunc (w *worker) Start() {\n    w.source = make(chan interface{}, 10) // some buffer size to avoid blocking\n    go func() {\n        for {\n            select {\n            case msg := &lt;-w.source\n                // do something with msg\n            case &lt;-quit: // will explain this in the last section\n                return\n            }\n        }\n    }()\n}\n</code></pre>\n\n<p>And then we could have a bunch of workers:</p>\n\n<pre><code>workers := []*worker{&amp;worker{}, &amp;worker{}}\nfor _, worker := range workers { worker.Start() }\n</code></pre>\n\n<p>Then start our listener:</p>\n\n<pre><code>go func() {\nfor {\n    conn, _ := listener.Accept()\n    ch &lt;- conn\n    }\n}()\n</code></pre>\n\n<p>And a dispatcher:</p>\n\n<pre><code>go func() {\n    for {\n        msg := &lt;- ch\n        for _, worker := workers {\n            worker.source &lt;- msg\n        }\n    }\n}()\n</code></pre>\n\n<h2>When the number of listeners is not known</h2>\n\n<p>In this case, the solution given above still works. The only difference is, whenever you need a new worker, you need to create a new worker, start it up, and then push it into <code>workers</code> slice. But this method requires a thread-safe slice, which need a lock around it. One of the implementation may look like as follows:</p>\n\n<pre><code>type threadSafeSlice struct {\n    sync.Mutex\n    workers []*worker\n}\n\nfunc (slice *threadSafeSlice) Push(w *worker) {\n    slice.Lock()\n    defer slice.Unlock()\n\n    workers = append(workers, w)\n}\n\nfunc (slice *threadSafeSlice) Iter(routine func(*worker)) {\n    slice.Lock()\n    defer slice.Unlock()\n\n    for _, worker := range workers {\n        routine(worker)\n    }\n}\n</code></pre>\n\n<p>Whenever you want to start a worker:</p>\n\n<pre><code>w := &amp;worker{}\nw.Start()\nthreadSafeSlice.Push(w)\n</code></pre>\n\n<p>And your dispatcher will be changed to:</p>\n\n<pre><code>go func() {\n    for {\n        msg := &lt;- ch\n        threadSafeSlice.Iter(func(w *worker) { w.source &lt;- msg })\n    }\n}()\n</code></pre>\n\n<h2>Last words: never leave a dangling goroutine</h2>\n\n<p>One of the good practices is: never leave a dangling goroutine. So when you finished listening, you need to close all of the goroutines you fired. This will be done via <code>quit</code> channel in <code>worker</code>:</p>\n\n<p>First we need to create a global <code>quit</code> signalling channel:</p>\n\n<pre><code>globalQuit := make(chan struct{})\n</code></pre>\n\n<p>And whenever we create a worker, we assign the <code>globalQuit</code> channel to it as its quit signal:</p>\n\n<pre><code>worker.quit = globalQuit\n</code></pre>\n\n<p>Then when we want to shutdown all workers, we simply do:</p>\n\n<pre><code>close(globalQuit)\n</code></pre>\n\n<p>Since <code>close</code> will be recognized by all listening goroutines (this is the point you understood), all goroutines will be returned. Remember to close your dispatcher routine as well, but I will leave it to you :)</p>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 2, "last_activity_date": 1459863918, "last_edit_date": 1495535483, "creation_date": 1459863918, "answer_id": 36428202, "question_id": 36417199, "link": "https://stackoverflow.com/questions/36417199/how-to-broadcast-message-using-channel/36428202#36428202", "title": "How to broadcast message using channel", "body": "<p>Because Go channels follow the Communicating Sequential Processes (CSP) pattern, channels are a point-to-point communication entity. There is always one writer and one reader involved in each exchange.</p>\n\n<p>However, each channel <em>end</em> can be <em>shared</em> amongst multiple goroutines. This is safe to do - there is no dangerous race condition.</p>\n\n<p>So there can be multiple writers sharing the writing end. And/or there can be multiple readers sharing the reading end. I wrote more on this in a <a href=\"https://stackoverflow.com/questions/15715605/multiple-goroutines-listening-on-one-channel/15721380#15721380\">different answer</a>, which includes examples.</p>\n\n<p>If you really need a broadcast, you cannot do this directly, but it is not hard to implement an intermediate goroutine that copies a value out to each of a group of output channels.</p>\n"}, {"tags": [], "owner": {"reputation": 1162, "user_id": 1586797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e19c16130bbfb34d0f8cdb414780e50?s=128&d=identicon&r=PG", "display_name": "bronze man", "link": "https://stackoverflow.com/users/1586797/bronze-man"}, "is_accepted": false, "score": 4, "last_activity_date": 1502508645, "creation_date": 1502508645, "answer_id": 45646237, "question_id": 36417199, "link": "https://stackoverflow.com/questions/36417199/how-to-broadcast-message-using-channel/45646237#45646237", "title": "How to broadcast message using channel", "body": "<p>Broadcast to a slice of channel and use sync.Mutex to manage channel add and remove may be the easiest way in your case.</p>\n\n<p>Here is what you can do to <code>broadcast</code> in golang:</p>\n\n<ul>\n<li>You can broadcast a share status change with sync.Cond. This way do not have any alloc once setup, but you can not add timeout functional or work with another channel.</li>\n<li>You can broadcast a share status change with a close old channel and create new channel and sync.Mutex. This way have one alloc per status change, but you can add timeout functional and work with another channel.</li>\n<li>You can broadcast to a slice of function callback and use sync.Mutex to manage them. The caller can do channel stuff. This way have more than one alloc per caller, and work with another channel.</li>\n<li>You can broadcast to a slice of channel and use sync.Mutex to manage them. This way have more than one alloc per caller, and work with another channel.</li>\n<li>You can broadcast to a slice of sync.WaitGroup and use sync.Mutex to manage them.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 35, "last_activity_date": 1524032076, "last_edit_date": 1524032076, "creation_date": 1523966638, "answer_id": 49877632, "question_id": 36417199, "link": "https://stackoverflow.com/questions/36417199/how-to-broadcast-message-using-channel/49877632#49877632", "title": "How to broadcast message using channel", "body": "<p>A more elegant solution is a \"broker\", where clients may subscribe and unsubscibe to messages.</p>\n\n<p>To also handle subscribing and unsubscribing elegantly, we may utilize channels for this, so the main loop of the broker which receives and distributes the messages can incorporate all these using a single <code>select</code> statement, and synchronization is given from the solution's nature.</p>\n\n<p>Another trick is to store the subscribers in a map, mapping from the channel we use to distribute messages to them. So use the channel as the key in the map, and then adding and removing the clients is \"dead\" simple. This is made possible because channel values are <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"noreferrer\">comparable</a>, and their comparison is very efficient as channel values are simple pointers to channel descriptors.</p>\n\n<p>Without further ado, here's a simple broker implementation:</p>\n\n<pre><code>type Broker struct {\n    stopCh    chan struct{}\n    publishCh chan interface{}\n    subCh     chan chan interface{}\n    unsubCh   chan chan interface{}\n}\n\nfunc NewBroker() *Broker {\n    return &amp;Broker{\n        stopCh:    make(chan struct{}),\n        publishCh: make(chan interface{}, 1),\n        subCh:     make(chan chan interface{}, 1),\n        unsubCh:   make(chan chan interface{}, 1),\n    }\n}\n\nfunc (b *Broker) Start() {\n    subs := map[chan interface{}]struct{}{}\n    for {\n        select {\n        case &lt;-b.stopCh:\n            return\n        case msgCh := &lt;-b.subCh:\n            subs[msgCh] = struct{}{}\n        case msgCh := &lt;-b.unsubCh:\n            delete(subs, msgCh)\n        case msg := &lt;-b.publishCh:\n            for msgCh := range subs {\n                // msgCh is buffered, use non-blocking send to protect the broker:\n                select {\n                case msgCh &lt;- msg:\n                default:\n                }\n            }\n        }\n    }\n}\n\nfunc (b *Broker) Stop() {\n    close(b.stopCh)\n}\n\nfunc (b *Broker) Subscribe() chan interface{} {\n    msgCh := make(chan interface{}, 5)\n    b.subCh &lt;- msgCh\n    return msgCh\n}\n\nfunc (b *Broker) Unsubscribe(msgCh chan interface{}) {\n    b.unsubCh &lt;- msgCh\n}\n\nfunc (b *Broker) Publish(msg interface{}) {\n    b.publishCh &lt;- msg\n}\n</code></pre>\n\n<p>Example using it:</p>\n\n<pre><code>func main() {\n    // Create and start a broker:\n    b := NewBroker()\n    go b.Start()\n\n    // Create and subscribe 3 clients:\n    clientFunc := func(id int) {\n        msgCh := b.Subscribe()\n        for {\n            fmt.Printf(\"Client %d got message: %v\\n\", id, &lt;-msgCh)\n        }\n    }\n    for i := 0; i &lt; 3; i++ {\n        go clientFunc(i)\n    }\n\n    // Start publishing messages:\n    go func() {\n        for msgId := 0; ; msgId++ {\n            b.Publish(fmt.Sprintf(\"msg#%d\", msgId))\n            time.Sleep(300 * time.Millisecond)\n        }\n    }()\n\n    time.Sleep(time.Second)\n}\n</code></pre>\n\n<p>Output of the above will be (try it on the <a href=\"https://play.golang.org/p/MjstDTh0ld_g\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Client 2 got message: msg#0\nClient 0 got message: msg#0\nClient 1 got message: msg#0\nClient 2 got message: msg#1\nClient 0 got message: msg#1\nClient 1 got message: msg#1\nClient 1 got message: msg#2\nClient 2 got message: msg#2\nClient 0 got message: msg#2\nClient 2 got message: msg#3\nClient 0 got message: msg#3\nClient 1 got message: msg#3\n</code></pre>\n\n<h2>Improvements</h2>\n\n<p>You may consider the following improvements. These may or may not be useful depending on how / to what you use the broker.</p>\n\n<p><code>Broker.Unsubscribe()</code> may close the message channel, signalling that no more messages will be sent on it:</p>\n\n<pre><code>func (b *Broker) Unsubscribe(msgCh chan interface{}) {\n    b.unsubCh &lt;- msgCh\n    close(msgCh)\n}\n</code></pre>\n\n<p>This would allow clients to <code>range</code> over the message channel, like this:</p>\n\n<pre><code>msgCh := b.Subscribe()\nfor msg := range msgCh {\n    fmt.Printf(\"Client %d got message: %v\\n\", id, msg)\n}\n</code></pre>\n\n<p>Then if someone unsubscribes this <code>msgCh</code> like this:</p>\n\n<pre><code>b.Unsubscribe(msgCh)\n</code></pre>\n\n<p>The above range loop will terminate after processing all messages that were sent before the call to <code>Unsubscribe()</code>.</p>\n\n<p>If you want your clients to rely on the message channel being closed, and the broker's lifetime is narrower than your app's lifetime, then you could also close all subscribed clients when the broker is stopped, in the <code>Start()</code> method like this:</p>\n\n<pre><code>case &lt;-b.stopCh:\n    for msgCh := range subs {\n        close(msgCh)\n    }\n    return\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 535, "user_id": 388322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272348ef3b308063960046b0e8e2c63e?s=128&d=identicon&r=PG", "display_name": "Guan Gui", "link": "https://stackoverflow.com/users/388322/guan-gui"}, "is_accepted": false, "score": 0, "last_activity_date": 1568942348, "creation_date": 1568942348, "answer_id": 58020601, "question_id": 36417199, "link": "https://stackoverflow.com/questions/36417199/how-to-broadcast-message-using-channel/58020601#58020601", "title": "How to broadcast message using channel", "body": "<p>I created a simple library to support the channel broadcasting. This can be used to broadcast async result from many modern service API calls. <a href=\"https://github.com/guiguan/caster#broadcast-a-go-channel\" rel=\"nofollow noreferrer\">https://github.com/guiguan/caster#broadcast-a-go-channel</a></p>\n"}, {"tags": [], "owner": {"reputation": 1290, "user_id": 3741686, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OBCXg.jpg?s=128&g=1", "display_name": "Davood Falahati", "link": "https://stackoverflow.com/users/3741686/davood-falahati"}, "is_accepted": false, "score": 1, "last_activity_date": 1603759161, "last_edit_date": 1603759161, "creation_date": 1603714576, "answer_id": 64536953, "question_id": 36417199, "link": "https://stackoverflow.com/questions/36417199/how-to-broadcast-message-using-channel/64536953#64536953", "title": "How to broadcast message using channel", "body": "<p>This is a late answer but I think it may appease some curious readers.</p>\n<p>Go channels are widely welcomed to be used when it comes to concurrency.</p>\n<p><strong>Go</strong> community is rigid to follow this saying:</p>\n<blockquote>\n<p>Do not communicate by sharing memory; instead, share memory by communicating.</p>\n</blockquote>\n<p>I am completely neutral toward this and I think other options rather than well-defined <code>channels</code> should be considered when it comes to broadcasting.</p>\n<p>Here is my take: Cond from sync packages are <a href=\"http://garrett.damore.org/2018/12/golang-synccond-vs-channel.html\" rel=\"nofollow noreferrer\">widely overlooked</a>. Implementing braodcaster as suggested by <strong>Bronze man</strong> in very same context worths noting.</p>\n<p>I was delighted witch <a href=\"https://stackoverflow.com/users/1705598/icza\">icza</a> suggestion to use channels and broadcast messages over them. I follow the same methods and use sync's conditional variable:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>// Broadcaster is the struct which encompasses broadcasting\ntype Broadcaster struct {\n    cond        *sync.Cond\n    subscribers map[interface{}]func(interface{})\n    message     interface{}\n    running     bool\n}\n</code></pre>\n<p>this is the main struct that our whole broadcasting concept relies on.</p>\n<p>Below, I define some behaviours for this struct. In a nutshell, subscribers should be able to be added, removed and whole the process should be revokable.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>    // SetupBroadcaster gives the broadcaster object to be used further in messaging\n    func SetupBroadcaster() *Broadcaster {\n    \n        return &amp;Broadcaster{\n            cond:        sync.NewCond(&amp;sync.RWMutex{}),\n            subscribers: map[interface{}]func(interface{}){},\n        }\n    }\n    \n    // Subscribe let others enroll in broadcast event!\n    func (b *Broadcaster) Subscribe(id interface{}, f func(input interface{})) {\n    \n        b.subscribers[id] = f\n    }\n    \n    // Unsubscribe stop receiving broadcasting\n    func (b *Broadcaster) Unsubscribe(id interface{}) {\n        b.cond.L.Lock()\n        delete(b.subscribers, id)\n        b.cond.L.Unlock()\n    }\n    \n    // Publish publishes the message\n    func (b *Broadcaster) Publish(message interface{}) {\n        go func() {\n            b.cond.L.Lock()\n    \n            b.message = message\n            b.cond.Broadcast()\n            b.cond.L.Unlock()\n        }()\n    }\n    \n    // Start the main broadcasting event\n    func (b *Broadcaster) Start() {\n        b.running = true\n        for b.running {\n            b.cond.L.Lock()\n            b.cond.Wait()\n            go func() {\n                for _, f := range b.subscribers {\n                    f(b.message) // publishes the message\n                }\n            }()\n            b.cond.L.Unlock()\n        }\n    \n    }\n    \n    // Stop broadcasting event\n    func (b *Broadcaster) Stop() {\n        b.running = false\n    }\n</code></pre>\n<p>Next, I can use it quite easily:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>    messageToaster := func(message interface{}) {\n        fmt.Printf(&quot;[New Message]: %v\\n&quot;, message)\n    }\n    unwillingReceiver := func(message interface{}) {\n        fmt.Println(&quot;Do not disturb!&quot;)\n    }\n    broadcaster := SetupBroadcaster()\n    broadcaster.Subscribe(1, messageToaster)\n    broadcaster.Subscribe(2, messageToaster)\n    broadcaster.Subscribe(3, unwillingReceiver)\n\n    go broadcaster.Start()\n\n    broadcaster.Publish(&quot;Hello!&quot;)\n\n    time.Sleep(time.Second)\n    broadcaster.Unsubscribe(3)\n    broadcaster.Publish(&quot;Goodbye!&quot;)\n\n</code></pre>\n<p>It should print something like this in any order:</p>\n<pre><code>[New Message]: Hello!\nDo not disturb!\n[New Message]: Hello!\n[New Message]: Goodbye!\n[New Message]: Goodbye!\n</code></pre>\n<p>See this on <a href=\"https://play.golang.org/p/b482DzgiucV\" rel=\"nofollow noreferrer\">go playground</a></p>\n"}], "owner": {"reputation": 381, "user_id": 5081447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155753612750261/picture?type=large", "display_name": "Jin Hoon Jeffrey Bang", "link": "https://stackoverflow.com/users/5081447/jin-hoon-jeffrey-bang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28927, "favorite_count": 19, "accepted_answer_id": 36418082, "answer_count": 6, "score": 28, "last_activity_date": 1603759161, "creation_date": 1459830940, "last_edit_date": 1523967539, "question_id": 36417199, "link": "https://stackoverflow.com/questions/36417199/how-to-broadcast-message-using-channel", "title": "How to broadcast message using channel", "body": "<p>I am new to go and I am trying to create a simple chat server where clients can broadcast messages to all connected clients. </p>\n\n<p>In my server, I have a goroutine (infinite for loop) that accepts connection and all the connections are received by a channel. </p>\n\n<pre><code>go func() {\n    for {\n        conn, _ := listener.Accept()\n        ch &lt;- conn\n        }\n}()\n</code></pre>\n\n<p>Then, I start a handler (goroutine) for every connected client. Inside the handler, I try to broadcast to all connections by iterating through the channel. </p>\n\n<pre><code>for c := range ch {\n    conn.Write(msg)\n}\n</code></pre>\n\n<p>However, I cannot broadcast because (I think from reading the docs) the channel needs to be closed before iterating. I am not sure when I should close the channel because I want to continuously accept new connections and closing the channel won't let me do that. If anyone can help me, or provide a better way to broadcast messages to all connected clients, it would be appreciated. </p>\n"}, {"tags": ["google-app-engine", "go", "scheduled-tasks", "google-compute-engine"], "answers": [{"comments": [{"owner": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 0, "creation_date": 1459829627, "post_id": 36416745, "comment_id": 60449022, "body": "why not task queues?"}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "reply_to_user": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 1, "creation_date": 1459829911, "post_id": 36416745, "comment_id": 60449101, "body": "@ZigMandel: Yes, task queues is where I&#39;d imagine the tasks generated by the generic cron job would go. Using deferred tasks would also be a possibility."}], "tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": false, "score": 1, "last_activity_date": 1459827806, "creation_date": 1459827806, "answer_id": 36416745, "question_id": 36416364, "link": "https://stackoverflow.com/questions/36416364/how-do-you-deploy-a-cron-script-in-production/36416745#36416745", "title": "how do you deploy a cron script in production?", "body": "<p>Details about cron operation on GAE can be found <a href=\"https://cloud.google.com/appengine/docs/go/config/cron\" rel=\"nofollow\">here</a>. </p>\n\n<p>The tricky portion from your prospective is that <a href=\"https://cloud.google.com/appengine/docs/go/config/cron#Go_app_yaml_Uploading_cron_jobs\" rel=\"nofollow\">updating the cron</a> configuration is done from <strong>outside</strong> the application, so it's at least difficult (if not impossible) to customize the cron jobs based on your app user's actions.</p>\n\n<p>It is however possible to just run a generic cron job (once a minute, for example) and have that job's handler read the users' custom job configs and further generate tasks accordingly to handle them. Running ~10K tasks per day is usually not an issue, they might even fit inside the free app quotas (depending on what the tasks are actually doing).</p>\n\n<p>The same technique can be applied on a regular Linux OS (including on a GCE VM). I didn't yet use GCE, so I can't tell exactly if/how would a dynamically updated cron be possible with it.</p>\n"}, {"tags": [], "owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "is_accepted": false, "score": 0, "last_activity_date": 1459827842, "creation_date": 1459827842, "answer_id": 36416753, "question_id": 36416364, "link": "https://stackoverflow.com/questions/36416364/how-do-you-deploy-a-cron-script-in-production/36416753#36416753", "title": "how do you deploy a cron script in production?", "body": "<p>You only need one cron job for your requirements. This cron job can run every 30 minutes - or once per day. It will see what has to be done over the next period of time, create tasks to do it, and add these tasks to the queue.</p>\n\n<p>It can all be done by a single App Engine instance. The number of instances you need to execute your tasks depends, of course, on how long each task runs. You have a lot of control over running the task queue.</p>\n"}], "owner": {"reputation": 9207, "user_id": 1455043, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/be8dfeb32eb4db2ac21bc9a95b23dd68?s=128&d=identicon&r=PG", "display_name": "Terence Chow", "link": "https://stackoverflow.com/users/1455043/terence-chow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459827842, "creation_date": 1459825174, "last_edit_date": 1459825778, "question_id": 36416364, "link": "https://stackoverflow.com/questions/36416364/how-do-you-deploy-a-cron-script-in-production", "title": "how do you deploy a cron script in production?", "body": "<p>i would like to write a script that schedules various things throughout the day. unfortunately it will do  > 100 different tasks a day, closer to 500 and could be up to 10,000 in the future. </p>\n\n<p>All the tasks are independent in that you can think of my script as a service for end users who sign up and want me to schedule a task for them. so if 5 ppl sign up and person A wants me to send them an email at 9 am, this will be different than person B who might want me to query an api at 10:30 pm etc. </p>\n\n<p>now, conceptually I plan to have a database that tells me what each persons task will be and what time they asked to schedule that task and the frequency. once a day I will get this data from my database so I have an up-to-date record of all the tasks that need to be executed in the day</p>\n\n<p>running them through a loop I can create channels that can execute timers or tickers for each task.</p>\n\n<p>the question I have is how does this get deployed in production to, for example google app engine? since those platforms are for Web servers I'm not sure how this would work...Or am I supposed to use Google Compute Engine and have it act as a computation for 24 hours? Can google compute engine even make http calls?</p>\n\n<p>also if I have to have say 500 channels in go open 24 hrs a day, does that count as 500 containers in google app engine? I imagine that will get very costly quickly, despite what is essentially a very low cost product. </p>\n\n<p>so again the question comes back to, how does a cron script get deployed in production?</p>\n\n<p>any help or guidance will be greatly appreciated as I have done a lot of googling and unfortunately everything leads back to a cron scheduler that has a limit of 100 tasks in google app engine...</p>\n"}, {"tags": ["javascript", "jquery", "angularjs", "go", "beego"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6158875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QJZBr3MIWzw/AAAAAAAAAAI/AAAAAAAAADI/6lbdrjS3KSc/photo.jpg?sz=128", "display_name": "Patrick Mark Mazo", "link": "https://stackoverflow.com/users/6158875/patrick-mark-mazo"}, "edited": false, "score": 0, "creation_date": 1459905656, "post_id": 36416625, "comment_id": 60494165, "body": "it says page not found error 404 when compiled. and the terminal post an error when using this kind of url. the submit is a function under the controller and not a page."}], "tags": [], "owner": {"reputation": 1, "user_id": 6159031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1019b766a6ab0bfce642a8bdab737991?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6159031/eric"}, "is_accepted": false, "score": 0, "last_activity_date": 1459826965, "creation_date": 1459826965, "answer_id": 36416625, "question_id": 36416128, "link": "https://stackoverflow.com/questions/36416128/angularjs-and-go-post-request-method-not-allowed/36416625#36416625", "title": "AngularJS and Go POST Request Method Not Allowed", "body": "<p>Remove baseUrl and make sure <code>url:\"sample\"</code>.\nMaybe you can do this\n<code>console.log(baseUrl);</code>\nCheck that baseUrl contains <code>#</code>;</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6158875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QJZBr3MIWzw/AAAAAAAAAAI/AAAAAAAAADI/6lbdrjS3KSc/photo.jpg?sz=128", "display_name": "Patrick Mark Mazo", "link": "https://stackoverflow.com/users/6158875/patrick-mark-mazo"}, "edited": false, "score": 0, "creation_date": 1459832165, "post_id": 36416955, "comment_id": 60449814, "body": "beego.Router(&quot;/sample&quot;, &amp;controllers.SampleController{})\tbeego.Router(&quot;/sample/Submi&zwnj;&#8203;t&quot;,&amp;controllers.Samp&zwnj;&#8203;leController{},&quot;post&zwnj;&#8203;:Submit&quot;)  i have a defined route for post try to look"}], "tags": [], "owner": {"reputation": 10683, "user_id": 52317, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/b3da0ca2685a59740d157b22aec70935?s=128&d=identicon&r=PG", "display_name": "Uzbekjon", "link": "https://stackoverflow.com/users/52317/uzbekjon"}, "is_accepted": false, "score": 0, "last_activity_date": 1459829277, "creation_date": 1459829277, "answer_id": 36416955, "question_id": 36416128, "link": "https://stackoverflow.com/questions/36416128/angularjs-and-go-post-request-method-not-allowed/36416955#36416955", "title": "AngularJS and Go POST Request Method Not Allowed", "body": "<p>I am not a Go developer, but looking at the error code it seems like you are making <code>POST</code> request, but have only defined routes for <code>GET</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3580265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6279e82fce69187fae677c4cf53c2ed9?s=128&d=identicon&r=PG&f=1", "display_name": "PriyankaNavgire", "link": "https://stackoverflow.com/users/3580265/priyankanavgire"}, "is_accepted": false, "score": 0, "last_activity_date": 1460684115, "last_edit_date": 1460684115, "creation_date": 1460683516, "answer_id": 36636764, "question_id": 36416128, "link": "https://stackoverflow.com/questions/36416128/angularjs-and-go-post-request-method-not-allowed/36636764#36636764", "title": "AngularJS and Go POST Request Method Not Allowed", "body": "<p>In router u have defined \"/sample\" as GET but you made an ajax call for POST method, its search's in the router for /sample it will find this</p>\n\n<p>beego.Router(\"/sample\", &amp;controllers.SampleController{})    </p>\n\n<p>which redirects to SampleController but there it doesn't find any POST method definition so 405 method not found.</p>\n\n<p>Try adding in samplecontroller</p>\n\n<p>func (this *SampleController) Post(){\n   ...// your code goes here\n}</p>\n\n<p>or add</p>\n\n<p>beego.Router(\"/sample\", &amp;controllers.SampleController{\"post:Sample\"})</p>\n\n<p>and add a Function Sample in samplecontroller just as you did for Submit</p>\n"}], "owner": {"reputation": 11, "user_id": 6158875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QJZBr3MIWzw/AAAAAAAAAAI/AAAAAAAAADI/6lbdrjS3KSc/photo.jpg?sz=128", "display_name": "Patrick Mark Mazo", "link": "https://stackoverflow.com/users/6158875/patrick-mark-mazo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 580, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1460684115, "creation_date": 1459823632, "last_edit_date": 1459828823, "question_id": 36416128, "link": "https://stackoverflow.com/questions/36416128/angularjs-and-go-post-request-method-not-allowed", "title": "AngularJS and Go POST Request Method Not Allowed", "body": "<p>Im currently working on a sample project and Im using Go and AngularJS I am new at this. I encountered a 405 Error Method Not Allowed after executing this codes.</p>\n\n<p>sample.js</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var app = angular.module('sample', []);\r\napp.controller('sampleCtrl', function($scope, $http){\r\n  $scope.submit = function(){\r\n    //variables\r\n    $scope.firstName = document.getElementById('firstName').value;\r\n    $scope.middleName = document.getElementById('middleName').value;\r\n    $scope.lastName = document.getElementById('lastName').value;\r\n    $scope.age = document.getElementById('age').value;\r\n    $http({\r\n\t\t\tmethod: 'POST',\r\n\t\t\turl: baseUrl +'/sample',\r\n\t\t\theaders: {'Content-Type': 'application/json'},\r\n            data: {\r\n              \"firstName\"   : $scope.firstName,\r\n              \"middleName\"  : $scope.middleName,\r\n              \"lastName\"    : $scope.lastName,\r\n              \"age\"         : $scope.age\r\n            }\r\n\t\t}).then(function successCallback(response){\r\n              alert('Success');\r\n\t  });\r\n    }\r\n});</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>sample.go</p>\n\n\n\n<pre><code>package controllers\n\nimport (\n    \"github.com/astaxie/beego\"\n    \"net/http\"\n    \"fmt\"\n    \"encoding/json\"\n)\ntype SampleController struct {\n    beego.Controller\n}\n\nfunc (this *SampleController) Get(){\n    this.TplName = \"sample/sample.html\"\n  this.Render()\n}\n\ntype Entry struct {\n FirstName string\nMiddleName string\n  LastName string\n    Age int\n}\n\nfunc (this *SampleController) Submit(rw http.ResponseWriter, req *http.Request){\n    decoder := json.NewDecoder(req.Body)\n    var data Entry\n    err := decoder.Decode(&amp;data)\n    if err != nil {\n        fmt.Println(\"JSON Empty\")\n    }else{\n        var firstName = data.FirstName\n        //var middle = data.MiddleName\n        //var lastName = data.LastName\n        //var age = data.Age\n        fmt.Println(firstName)\n    }\n}\n</code></pre>\n\n\n\n<p>routers.go</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>package routers\r\n\r\nimport (\r\n\t\"test/controllers\"\r\n\t\"github.com/astaxie/beego\"\r\n)\r\n\r\nfunc init() {\r\n    beego.Router(\"/\", &amp;controllers.MainController{})\r\n\tbeego.Router(\"/sample\", &amp;controllers.SampleController{})\tbeego.Router(\"/sample/Submit\",&amp;controllers.SampleController{},\"post:Submit\")\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Thanks for the help in advance.</p>\n"}, {"tags": ["csv", "go"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1459823195, "post_id": 36415530, "comment_id": 60447487, "body": "SO is not a code review site.  Update your question with the relative code snippets as well as sample input data."}, {"owner": {"reputation": 7982, "user_id": 656804, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4a805577a0117e80254f3cc530a1769?s=128&d=identicon&r=PG", "display_name": "Nikolay Fominyh", "link": "https://stackoverflow.com/users/656804/nikolay-fominyh"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1459829735, "post_id": 36415530, "comment_id": 60449054, "body": "@eduncan911, attached related code to question."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1459858884, "post_id": 36415530, "comment_id": 60466699, "body": "inspect ur data for line break and CR characters codes and post some sample data of where those characters are."}, {"owner": {"reputation": 7982, "user_id": 656804, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4a805577a0117e80254f3cc530a1769?s=128&d=identicon&r=PG", "display_name": "Nikolay Fominyh", "link": "https://stackoverflow.com/users/656804/nikolay-fominyh"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1459863764, "post_id": 36415530, "comment_id": 60470479, "body": "@eduncan911, I think, it should fail on first row if there are no line-break. It fails with memory leak on row number 4123819381 or so."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1460192206, "post_id": 36415530, "comment_id": 60635177, "body": "maybe that record 4123819381 and on is missing line breaks?  the only times i&#39;ve seen this kind of trouble when reading files is when slicing slices or arrays and adding to maps.  basically, if you don&#39;t copy the slice and use the new slice as-is, it will hold onto the old slice as you keep building in the collection - thinking GC will remove the old slice (it wont).  Basically, I&#39;m saying that unless it is a <code>linebreak</code> issue, <b>the csv reader is not your issue.</b> look elsewhere in your code."}, {"owner": {"reputation": 7982, "user_id": 656804, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4a805577a0117e80254f3cc530a1769?s=128&d=identicon&r=PG", "display_name": "Nikolay Fominyh", "link": "https://stackoverflow.com/users/656804/nikolay-fominyh"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1460200391, "post_id": 36415530, "comment_id": 60637635, "body": "@eduncan911, why it&#39;s reading line by line, if there are no line break? It really logically fails on line, where memory can be over. We have 16Gb RAM, temporary file size - 5Gb at the moment of fail."}], "answers": [{"tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": false, "score": 4, "last_activity_date": 1459823605, "creation_date": 1459823605, "answer_id": 36416126, "question_id": 36415530, "link": "https://stackoverflow.com/questions/36415530/go-working-with-huge-csv-files/36416126#36416126", "title": "Go. Working with huge csv files", "body": "<p>Most likely the line breaks aren't being detected and its reading everything as a single record.</p>\n\n<p><a href=\"https://golang.org/src/encoding/csv/reader.go?s=4071:4123#L124\" rel=\"nofollow\">https://golang.org/src/encoding/csv/reader.go?s=4071:4123#L124</a></p>\n\n<p>If you follow the code to line 210, you'll see it look for <code>'\\n'</code>.  </p>\n\n<p>Often times I see line breaks defined as <code>\\n\\r</code> when some system exported it, thinking they were being Windows-smart when in fact it's wrong.  The correct Windows linebreak is <code>\\r\\n</code>.</p>\n\n<p>Alternatively, you can write a custom <code>Scanner</code> that will deliminate the lines for you using whatever technique you have in your input, and use it as the <code>io.Reader</code> input for your <code>csv.Reader</code>.  For example, to use the invalid <code>\\n\\r</code> I mentioned above.</p>\n"}], "owner": {"reputation": 7982, "user_id": 656804, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4a805577a0117e80254f3cc530a1769?s=128&d=identicon&r=PG", "display_name": "Nikolay Fominyh", "link": "https://stackoverflow.com/users/656804/nikolay-fominyh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1580, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1460202810, "creation_date": 1459819049, "last_edit_date": 1492087232, "question_id": 36415530, "link": "https://stackoverflow.com/questions/36415530/go-working-with-huge-csv-files", "title": "Go. Working with huge csv files", "body": "<p>We have big dataset - couple of tens of csv files, that ~130Gb each. \nWe must emulate sql query on csv table. </p>\n\n<p>When we're reading test table using <code>encoding/csv</code> on test 1.1 Gb file - program allocates 526 Gb of virtual memory. Why? <code>csv.Reader</code> works like generator, when we using <code>reader.Read()</code> method, or it keeps row in memory? </p>\n\n<p>Full <a href=\"https://gist.github.com/tigrus/e5d9bed4cde33773284d2c7dc4468beb\" rel=\"nofollow noreferrer\">code</a> after <a href=\"https://codereview.stackexchange.com/questions/124444/summing-chemical-properties-in-a-csv-stream\">codereview</a>.</p>\n\n<p><strong>UPD</strong></p>\n\n<p>Reading file like: </p>\n\n<pre><code>rf, err := os.Open(input_file)\nif err != nil {\n    log.Fatal(\"Error: %s\", err)\n}\nr := csv.NewReader(rf)\nfor {\n    record, err := r.Read()\n}\n</code></pre>\n\n<p>Falling on line <code>record, err := r.Read()</code> with memory error. </p>\n\n<p><strong>UPD2</strong>\nSnapshot of memory during read process: </p>\n\n<pre><code> 2731.44MB 94.63% 94.63%  2731.44MB 94.63%  encoding/csv.(*Reader).parseRecord\n     151MB  5.23% 99.86%  2885.96MB   100%  main.main\n         0     0% 99.86%  2731.44MB 94.63%  encoding/csv.(*Reader).Read\n         0     0% 99.86%  2886.49MB   100%  runtime.goexit\n         0     0% 99.86%  2886.49MB   100%  runtime.main\n</code></pre>\n"}, {"tags": ["pointers", "reflection", "go", "interface"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1459813486, "post_id": 36414501, "comment_id": 60444938, "body": "You&#39;re just looking at it wrong. Why should you not allow it? Without a compelling reason not to (which there isn&#39;t as far as I&#39;m concerned), there&#39;s no reason to explicitly not allow it."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 3, "creation_date": 1459815685, "post_id": 36414501, "comment_id": 60445547, "body": "Didn&#39;t see any confusion about that topic. I read many articles about people learning Go and pointing some weird or bad stuff about it but never pointers to interfaces. It&#39;s something that is pretty much not needed in practice so you shouldn&#39;t even think about. Restricting it - it would make the language more complex without any obvious benefits. It&#39;s possible, comes naturally out of specification so why restricting it. I don&#39;t even remember seeing this feature in any of Go tutorials or books."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1459836812, "post_id": 36414501, "comment_id": 60451693, "body": "Related / example: <a href=\"http://stackoverflow.com/questions/33841630/set-an-interface-to-nil-in-golang\">Set an interface to nil in Golang</a>"}, {"owner": {"reputation": 5468, "user_id": 89233, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a36afadc530a6936e9e336a729f7ecf3?s=128&d=identicon&r=PG", "display_name": "Jon Watte", "link": "https://stackoverflow.com/users/89233/jon-watte"}, "edited": false, "score": 0, "creation_date": 1543437669, "post_id": 36414501, "comment_id": 93924282, "body": "It&#39;s totally legitimate for a Go program to implement an interface on a nil pointer."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 4, "last_activity_date": 1459813888, "last_edit_date": 1459813888, "creation_date": 1459812070, "answer_id": 36414554, "question_id": 36414501, "link": "https://stackoverflow.com/questions/36414501/why-does-go-allow-pointers-to-interfaces/36414554#36414554", "title": "Why does Go allow pointers to interfaces?", "body": "<p>A special case in the language specification is required to disallow pointers to interfaces. That makes the language more complex.</p>\n\n<p>Creating a <code>reflect.Type</code> for an interface interface type is one scenario where pointers to interfaces come in handy: <code>reflect.TypeOf((*io.Closer)(nil)).Elem()</code> is the reflect type of <code>io.Closer</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 1, "last_activity_date": 1459821429, "creation_date": 1459821429, "answer_id": 36415837, "question_id": 36414501, "link": "https://stackoverflow.com/questions/36414501/why-does-go-allow-pointers-to-interfaces/36415837#36415837", "title": "Why does Go allow pointers to interfaces?", "body": "<p>Only example I can come up with, but never used nor seen in the wild, is to let another function populate your interface.</p>\n\n<p>Example <a href=\"http://play.golang.org/p/qgz6efoRmz\" rel=\"nofollow\">on Play</a>. I can't really imagine a case where it is needed.\nAs others have pointed out, not allowing it would probably be wrong as that would make the compiler more complicated.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var s fmt.Stringer\n    setMyStringer(&amp;s)\n    fmt.Println(\"Hello, stringer:\", s)\n}\n\nfunc setMyStringer(target *fmt.Stringer) {\n    *target = Stringable(5)\n}\n\ntype Stringable int\n\nfunc (s Stringable) String() string {\n    return fmt.Sprint(int(s))\n}\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 1366466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080d0ac553461dc90be3f28c064a270b?s=128&d=identicon&r=PG", "display_name": "N J", "link": "https://stackoverflow.com/users/1366466/n-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "closed_date": 1459834192, "answer_count": 2, "score": 2, "last_activity_date": 1461047862, "creation_date": 1459811661, "last_edit_date": 1495541760, "question_id": 36414501, "link": "https://stackoverflow.com/questions/36414501/why-does-go-allow-pointers-to-interfaces", "closed_reason": "Opinion-based", "title": "Why does Go allow pointers to interfaces?", "body": "<p>In my tenure of writing Go code, I have never encountered a case, nor can I think of one that would require using a pointer to an interface, except for perhaps writing a library that makes heavy use of runtime reflection. <a href=\"https://stackoverflow.com/questions/27178635/cast-a-struct-pointer-to-interface-pointer-in-golang\">Some people</a> allude to the fact that there are valid reasons for doing so, but seem to never elaborate further. This feature also seems to cause quite a bit of confusion with developers who are getting started with Go. </p>\n\n<pre><code>main.go:22: cannot use &amp;a (type *A) as type **interface {} in argument to run\n</code></pre>\n\n<p>What would be a good example of using an interface pointer?</p>\n"}, {"tags": ["go", "mux"], "answers": [{"comments": [{"owner": {"reputation": 1409, "user_id": 2005135, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/QcTNv.jpg?s=128&g=1", "display_name": "jhc", "link": "https://stackoverflow.com/users/2005135/jhc"}, "edited": false, "score": 0, "creation_date": 1459809934, "post_id": 36414181, "comment_id": 60443898, "body": "So If I have a function that returns a type that isn&#39;t imported yet.. as long as I don&#39;t specifically use that type, I don&#39;t need to anyway?"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 1409, "user_id": 2005135, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/QcTNv.jpg?s=128&g=1", "display_name": "jhc", "link": "https://stackoverflow.com/users/2005135/jhc"}, "edited": false, "score": 0, "creation_date": 1459810016, "post_id": 36414181, "comment_id": 60443917, "body": "I&#39;m not clear on your question; if you specifically name the type (as you have in your function signature), you have to include the import"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 1409, "user_id": 2005135, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/QcTNv.jpg?s=128&g=1", "display_name": "jhc", "link": "https://stackoverflow.com/users/2005135/jhc"}, "edited": false, "score": 0, "creation_date": 1459810120, "post_id": 36414181, "comment_id": 60443943, "body": "If you never explicitly name the type (i.e. in the function signature, or elsewhere), you can use the returned value without the import."}, {"owner": {"reputation": 1409, "user_id": 2005135, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/QcTNv.jpg?s=128&g=1", "display_name": "jhc", "link": "https://stackoverflow.com/users/2005135/jhc"}, "edited": false, "score": 0, "creation_date": 1459810129, "post_id": 36414181, "comment_id": 60443947, "body": "Yes yes, you are correct. I&#39;m just trying to figure out where I don&#39;t need to use the import. For example, when my code was still very redundant, I was simply using the store.Get function directly, and did not need to use the import statement."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1459812395, "post_id": 36414181, "comment_id": 60444632, "body": "You only need to do an import when you want to directly refer to the type in your code.  because store.Get returns a sessions.Session, the local variable can be inferred in isLoggedIn.  But if you want to return it, or create a new instance of sessions.Session, you need to perform the import.  Basically, if you source code mentions the package, you must import it."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1459812653, "post_id": 36414181, "comment_id": 60444708, "body": "And, any type not defined in your package, must be prefixed with the package. (exception being . imports, but don&#39;t use those)"}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 2, "last_activity_date": 1459809765, "creation_date": 1459809765, "answer_id": 36414181, "question_id": 36414145, "link": "https://stackoverflow.com/questions/36414145/undefined-return-type-in-go/36414181#36414181", "title": "Undefined return type in Go", "body": "<p>Go needs to know which package to find <code>Session</code> in: <code>sessions.Session</code>.</p>\n\n<p>The error is on the signature of your func <code>isLoggedIn</code></p>\n\n<p>So your modified code would be:</p>\n\n<pre><code>import \"github.com/gorilla/sessions\"\nfunc isLoggedIn(w http.ResponseWriter, r *http.Request) (bool, *sessions.Session) {\n  ...\n}\n</code></pre>\n"}], "owner": {"reputation": 1409, "user_id": 2005135, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/QcTNv.jpg?s=128&g=1", "display_name": "jhc", "link": "https://stackoverflow.com/users/2005135/jhc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "accepted_answer_id": 36414181, "answer_count": 1, "score": -1, "last_activity_date": 1459814059, "creation_date": 1459809573, "last_edit_date": 1459814059, "question_id": 36414145, "link": "https://stackoverflow.com/questions/36414145/undefined-return-type-in-go", "title": "Undefined return type in Go", "body": "<p>I'm fairly new to Go and am having trouble with a code snippet that uses mux-gorilla sessions/cookies. There is a lot of redundancy that I would like to reduce with the following function:</p>\n\n<pre><code>func isLoggedIn(w http.ResponseWriter, r *http.Request) (bool, *Session) {\n    session, err := store.Get(r, \"user\")\n    var logged bool = true\n    if err != nil { // Need to delete the cookie.\n        expired := &amp;http.Cookie{Path: \"/\", Name: \"user\", MaxAge: -1, Expires: time.Now().Add(-100 * time.Hour)}\n        http.SetCookie(w, expired)\n        logged := false\n    }\n    return logged, session\n}\n</code></pre>\n\n<p>Unfortunately I get the following compilation error: <code>undefined: Session</code></p>\n\n<p>How can this type be undefined if it can be returned by the store.Get function? Note that store was declared before as <code>store = sessions.NewCookieStore([]byte(secret))</code>, using the \"gorilla/sessions\" package.</p>\n"}, {"tags": ["git", "go"], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 2, "last_activity_date": 1459802814, "last_edit_date": 1459802814, "creation_date": 1459802049, "answer_id": 36412381, "question_id": 36412273, "link": "https://stackoverflow.com/questions/36412273/unsupported-url-protocol/36412381#36412381", "title": "Unsupported URL protocol", "body": "<p>Your libgit2 was probably not compiled with the required flags for HTTPS: <a href=\"https://github.com/libgit2/libgit2/blob/b7809b84692b4df7f11d603cc5da0860609e0555/src/transport.c#L32-L34\" rel=\"nofollow\">https://github.com/libgit2/libgit2/blob/b7809b84692b4df7f11d603cc5da0860609e0555/src/transport.c#L32-L34</a></p>\n\n<p>The pre-processor is looking for one of these to be defined:</p>\n\n<pre><code>GIT_OPENSSL, GIT_WINHTTP, GIT_SECURE_TRANSPORT\n</code></pre>\n\n<p>From the <a href=\"https://github.com/libgit2/libgit2#compiler-and-linker-options\" rel=\"nofollow\">README</a>, it looks like you need these three, which probably cause the requirements to be met:</p>\n\n<blockquote>\n  <p>ZLIB_LIBRARY, OPENSSL_SSL_LIBRARY AND OPENSSL_CRYPTO_LIBRARY: Tell\n  CMake where to find those specific libraries</p>\n</blockquote>\n"}], "owner": {"reputation": 3118, "user_id": 1005169, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/dad86a58fdf87f48302bb45e08ca3b84?s=128&d=identicon&r=PG", "display_name": "twigg", "link": "https://stackoverflow.com/users/1005169/twigg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 36412381, "answer_count": 1, "score": 1, "last_activity_date": 1550840084, "creation_date": 1459801676, "last_edit_date": 1550840084, "question_id": 36412273, "link": "https://stackoverflow.com/questions/36412273/unsupported-url-protocol", "title": "Unsupported URL protocol", "body": "<p>I'm trying to create a basic GO app to pull a Git repo using git2go but I'm getting an error saying unsupported URL protocol. Does anyone know why?</p>\n\n<pre><code>package main\n\nimport (\n    git \"github.com/libgit2/git2go\"\n    \"log\"\n\n)\n\nfunc main() {\n\n    cloneOptions := &amp;git.CloneOptions{}\n\n    repo, err := git.Clone(\"https://github.com/nova-framework/framework.git\", \"gittest\", cloneOptions)\n            if err != nil {\n                    log.Panic(err)\n            }\n    log.Print(repo)\n}\n</code></pre>\n"}, {"tags": ["javascript", "google-maps-api-3", "go"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 1, "creation_date": 1459803530, "post_id": 36410397, "comment_id": 60441153, "body": "Sounds like you are asking us to write code for you.  Create a struct that matches what the json you want.  And <code>Decode</code> it to a <code>map</code> in Go.  Plenty examples online. E.g. <a href=\"https://gobyexample.com/json\" rel=\"nofollow noreferrer\">gobyexample.com/json</a>"}, {"owner": {"reputation": 754, "user_id": 4379762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d6e0a911a9fe018db744b4565f3dfc6d?s=128&d=identicon&r=PG&f=1", "display_name": "eriel marimon", "link": "https://stackoverflow.com/users/4379762/eriel-marimon"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 1, "creation_date": 1459861813, "post_id": 36410397, "comment_id": 60468959, "body": "this helps, thanks"}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 1, "last_activity_date": 1459803662, "creation_date": 1459803662, "answer_id": 36412773, "question_id": 36410397, "link": "https://stackoverflow.com/questions/36410397/how-to-use-directions-response-in-the-go-client-for-google-maps-services/36412773#36412773", "title": "How to use Directions response in the Go client for Google Maps Services?", "body": "<p>That JSON output is a <a href=\"https://developers.google.com/maps/documentation/javascript/reference#DirectionsResult\" rel=\"nofollow\"><code>DirectionsResult</code></a> object, which is passed in through the <a href=\"https://developers.google.com/maps/documentation/javascript/reference#DirectionsRendererOptions\" rel=\"nofollow\"><code>DirectionsRendererOptions</code></a> directly to the <a href=\"https://developers.google.com/maps/documentation/javascript/reference#DirectionsRenderer\" rel=\"nofollow\"><code>DirectionsRenderer()</code></a> constructor you're asking about.</p>\n\n<p>If you're trying to marshal it in to Go you can use the same structs to marshal it back out for consumers that are looking for a <code>DirectionsResult</code> object.</p>\n"}], "owner": {"reputation": 754, "user_id": 4379762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d6e0a911a9fe018db744b4565f3dfc6d?s=128&d=identicon&r=PG&f=1", "display_name": "eriel marimon", "link": "https://stackoverflow.com/users/4379762/eriel-marimon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459814146, "creation_date": 1459795334, "last_edit_date": 1459814146, "question_id": 36410397, "link": "https://stackoverflow.com/questions/36410397/how-to-use-directions-response-in-the-go-client-for-google-maps-services", "title": "How to use Directions response in the Go client for Google Maps Services?", "body": "<p>When getting directions using \"googlemaps.github.io/maps\" in Go, the response is an array of maps.Route . Is there a way to turn this response into something readable by javascript's  <code>google.maps.DirectionsRenderer();</code> , the purpose of this is to get the directions with a go server and distribute that data into multiple platforms. Any suggestions about how to transform this data into a visual map are welcome.</p>\n\n<p><strong>Go code:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"googlemaps.github.io/maps\"\n    \"github.com/kr/pretty\"\n    \"golang.org/x/net/context\"\n)\n\nfunc checkForError(err error) {\n    if err != nil{\n        log.Fatal(err)\n    }\n}\n\nfunc main() {\n    c, err := maps.NewClient(maps.WithAPIKey(\"myapikey\"))\n    checkForError(err)\n\n    r := &amp;maps.DirectionsRequest{\n        Origin:      \"Hollywood, FL\",\n        Destination: \"Davie, FL\",\n    }\n\n    resp, _, err := c.Directions(context.Background(), r)\n    checkForError(err)\n\n    // render := \n\n    pretty.Println(resp)\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>[]maps.Route{\n    {\n        Summary: \"I-95 N and I-595 W\",\n        Legs:    {\n            &amp;maps.Leg{\n                Steps: {\n                    &amp;maps.Step{\n                        HTMLInstructions: \"Head &lt;b&gt;east&lt;/b&gt; on &lt;b&gt;Hollywood Blvd&lt;/b&gt; toward &lt;b&gt;S Dixie Hwy&lt;/b&gt;\",\n                        Distance:         maps.Distance{HumanReadable:\"217 ft\", Meters:66},\n                        Duration:         23000000000,\n                        StartLocation:    maps.LatLng{Lat:26.0112983, Lng:-80.1494921},\n                        EndLocation:      maps.LatLng{Lat:26.0113264, Lng:-80.14883689999999},\n                        Polyline:         maps.Polyline{Points:\"siw}CheehN?e@Cq@Ai@\"},\n                        Steps:            nil,\n                        TransitDetails:   (*maps.TransitDetails)(nil),\n                        TravelMode:       \"DRIVING\",\n                    },\n                    &amp;maps.Step{\n                        HTMLInstructions: \"Make a &lt;b&gt;U-turn&lt;/b&gt; at &lt;b&gt;S 21st Ave&lt;/b&gt;\",\n                        Distance:         maps.Distance{HumanReadable:\"0.6 mi\", Meters:886},\n                        Duration:         90000000000,\n                        StartLocation:    maps.LatLng{Lat:26.0113264, Lng:-80.14883689999999},\n                        EndLocation:      maps.LatLng{Lat:26.0111533, Lng:-80.1575536},\n                        Polyline:         maps.Polyline{Points:\"yiw}CfaehNU??h@?r@BpAJVDfFHlOBfDDlCB|C@z@H~F\"},\n                        Steps:            nil,\n                        TransitDetails:   (*maps.TransitDetails)(nil),\n                        TravelMode:       \"DRIVING\",\n                    },\n                    &amp;maps.Step{\n                        HTMLInstructions: \"At the traffic circle, take the &lt;b&gt;3rd&lt;/b&gt; exit and stay on &lt;b&gt;Hollywood Blvd&lt;/b&gt;\",\n                        Distance:         maps.Distance{HumanReadable:\"0.6 mi\", Meters:937},\n                        Duration:         148000000000,\n                        StartLocation:    maps.LatLng{Lat:26.0111533, Lng:-80.1575536},\n                        EndLocation:      maps.LatLng{Lat:26.011037, Lng:-80.16587369999999},\n                        Polyline:         maps.Polyline{Points:\"uhw}CtwfhNGJAB?H?D?J?FAD?DCDCDCDSNUD]N_@XY\\\\Ub@GRGPIh@Ch@Bd@BJDXN`@DFLVVZ\\\\T\\\\P`@JNJHFFHBFBN@F?JBpB?d@@`ABpD@zB?nAB`C@bB@fAAt@AlA\"},\n                        Steps:            nil,\n                        TransitDetails:   (*maps.TransitDetails)(nil),\n                        TravelMode:       \"DRIVING\",\n                    },\n                    &amp;maps.Step{\n                        HTMLInstructions: \"Turn &lt;b&gt;right&lt;/b&gt; to merge onto &lt;b&gt;I-95 N&lt;/b&gt; toward &lt;b&gt;W Palm Beach&lt;/b&gt;\",\n                        Distance:         maps.Distance{HumanReadable:\"4.4 mi\", Meters:7063},\n                        Duration:         277000000000,\n                        StartLocation:    maps.LatLng{Lat:26.011037, Lng:-80.16587369999999},\n                        EndLocation:      maps.LatLng{Lat:26.0732058, Lng:-80.1671851},\n                        Polyline:         maps.Polyline{Points:\"_hw}CtkhhNKVCHEJGJCBEBEBIBQDkBB_BJq@DkBR_Ff@_CT[DM@IBGFKJy@FyAFuAB_CD_B@U@cCBE?A?}BByQLqBA{BGuBQeBQyAQo@KoBc@aBa@sA]iHyBa@MoA[wBm@g@K_Ds@cB]aB[eB[qAScBU{BWMCWCsBWg@G}Ks@cHe@aQkA{CUeCOyCSsE[wDW{CSsKu@qAIEA_@COAA?gBM_@Co@E[Ck@CUAs@E]AWA]A]?q@AU?a@?O?Y?kA?s@Bk@@o@Bm@@wEPcKZc@@w@BiAFi@Bq@Dw@Hk@FoBRw@JSD[DmAR}@P}Dt@oCh@yFdAgB\\\\A@g@HIBA?eCd@cDn@y@Ns@NiB\\\\_ARu@LaBZyDt@qCh@}Bf@oDx@sBf@}A`@qAZcBb@aBb@qEpA\"},\n                        Steps:            nil,\n                        TransitDetails:   (*maps.TransitDetails)(nil),\n                        TravelMode:       \"DRIVING\",\n                    },\n                    &amp;maps.Step{\n                        HTMLInstructions: \"Take exit &lt;b&gt;24&lt;/b&gt; for &lt;b&gt;Interstate 595&lt;/b&gt; toward &lt;b&gt;Port Everglades&lt;/b&gt;/&lt;b&gt;Ft Laud-Hlwd&lt;/b&gt;/&lt;b&gt;International Airport&lt;/b&gt;\",\n                        Distance:         maps.Distance{HumanReadable:\"0.3 mi\", Meters:416},\n                        Duration:         17000000000,\n                        StartLocation:    maps.LatLng{Lat:26.0732058, Lng:-80.1671851},\n                        EndLocation:      maps.LatLng{Lat:26.0768262, Lng:-80.1680758},\n                        Polyline:         maps.Polyline{Points:\"qlc~C|shhNKIAAAAA?C?E?E?A?MBc@H_@FqB^uAVoAT{@Na@F[Hi@HYFyAXm@L\"},\n                        Steps:            nil,\n                        TransitDetails:   (*maps.TransitDetails)(nil),\n                        TravelMode:       \"DRIVING\",\n                    },\n                    &amp;maps.Step{\n                        HTMLInstructions: \"Keep &lt;b&gt;left&lt;/b&gt; at the fork, follow signs for &lt;b&gt;I-595 W&lt;/b&gt;/&lt;b&gt;I-75&lt;/b&gt;/&lt;b&gt;Florida's Turnpike&lt;/b&gt; and merge onto &lt;b&gt;I-595 W&lt;/b&gt;\",\n                        Distance:         maps.Distance{HumanReadable:\"4.4 mi\", Meters:7161},\n                        Duration:         255000000000,\n                        StartLocation:    maps.LatLng{Lat:26.0768262, Lng:-80.1680758},\n                        EndLocation:      maps.LatLng{Lat:26.0947648, Lng:-80.2317655},\n                        Polyline:         maps.Polyline{Points:\"ecd~CnyhhN[H[D_@Dm@FWBMBU@u@D_@@]@q@@W?]?MAU?[AYAQAe@C_@CWAk@CWAUAUAM?e@?W@Q@WBSBQBI@KBMBUHOFSFWNMHC@A@MHa@ZIFGF]`@IN[f@_@|@IVGT?BEREPCRALAHAF?BAB?FAJ?RAL?F?\\\\?F?D?N?RDlABn@Bx@@r@@t@@t@AV?h@A`@Ap@Cb@AZ?N?LATCh@CZ?@?@?@@@?@?@@BDFMhBIlAKdBGt@[rEe@zHAFk@vIE`@C`@UlDSbD?FMbECh@A|@C|A?`ACtEDxLD~PBvFDbE@vB?tF?xB@z@ClA?X?@?DG|BGx@IjAGx@Er@MtAMlAMdA[rBQhAUjA[zAWfA[vAYbAc@zAkAtCKXSj@wAhDiC`GiBdE_@|@]x@s@jBs@lBsAnDoAhEw@vCe@xB{@rD[nAsDjS]hBOn@e@~Bc@zBo@rCUpASfAu@fFUjBIj@MhAKp@S|ASzAS`BIv@]nCMbA_@bCQhAAF?FO~@y@zFeAbHyAtJ\"},\n                        Steps:            nil,\n                        TransitDetails:   (*maps.TransitDetails)(nil),\n                        TravelMode:       \"DRIVING\",\n                    },\n                    &amp;maps.Step{\n                        HTMLInstructions: \"Take exit &lt;b&gt;6&lt;/b&gt; toward &lt;b&gt;FL-817&lt;/b&gt;/&lt;b&gt;University Dr&lt;/b&gt;\",\n                        Distance:         maps.Distance{HumanReadable:\"0.4 mi\", Meters:566},\n                        Duration:         20000000000,\n                        StartLocation:    maps.LatLng{Lat:26.0947648, Lng:-80.2317655},\n                        EndLocation:      maps.LatLng{Lat:26.0963976, Lng:-80.2371076},\n                        Polyline:         maps.Polyline{Points:\"gsg~CpguhNM\\\\Ot@qBfKs@tD{@nEKd@S|@Id@Kj@?@ABABMH\"},\n                        Steps:            nil,\n                        TransitDetails:   (*maps.TransitDetails)(nil),\n                        TravelMode:       \"DRIVING\",\n                    },\n                    &amp;maps.Step{\n                        HTMLInstructions: \"Merge onto &lt;b&gt;FL-84 W&lt;/b&gt;\",\n                        Distance:         maps.Distance{HumanReadable:\"0.8 mi\", Meters:1365},\n                        Duration:         96000000000,\n                        StartLocation:    maps.LatLng{Lat:26.0963976, Lng:-80.2371076},\n                        EndLocation:      maps.LatLng{Lat:26.0994367, Lng:-80.25034819999999},\n                        Polyline:         maps.Polyline{Points:\"o}g~C|hvhNq@~EG`@_@`C_@jCWrBc@dDi@zDyAnJUvAM|@WnBMz@I|@OlAQ|AWrBQ|AKv@SxAWzASpAUnAYpAI`@\"},\n                        Steps:            nil,\n                        TransitDetails:   (*maps.TransitDetails)(nil),\n                        TravelMode:       \"DRIVING\",\n                    },\n                    &amp;maps.Step{\n                        HTMLInstructions: \"Turn &lt;b&gt;left&lt;/b&gt; onto &lt;b&gt;S University Dr&lt;/b&gt;\",\n                        Distance:         maps.Distance{HumanReadable:\"1.7 mi\", Meters:2808},\n                        Duration:         279000000000,\n                        StartLocation:    maps.LatLng{Lat:26.0994367, Lng:-80.25034819999999},\n                        EndLocation:      maps.LatLng{Lat:26.07466, Lng:-80.25254079999999},\n                        Polyline:         maps.Polyline{Points:\"oph~Ct{xhNKf@t@ND@h@Hd@JRBD@bBZfANl@Jx@JtALr@HjBLd@@pBJR@~BDT?z@AhBAt@A`CCfAArAC~@AfAAfBETA~GIlBCvHK|EGbFIr@AvDGR?jB?dC?N?pCDpCLl@FlBRPBl@Fh@HxCf@hGpAn@NzB`@VBx@LtAN~@Ht@FrAJ\"},\n                        Steps:            nil,\n                        TransitDetails:   (*maps.TransitDetails)(nil),\n                        TravelMode:       \"DRIVING\",\n                    },\n                    &amp;maps.Step{\n                        HTMLInstructions: \"Make a &lt;b&gt;U-turn&lt;/b&gt;&lt;div style=\\\"font-size:0.9em\\\"&gt;Destination will be on the left&lt;/div&gt;\",\n                        Distance:         maps.Distance{HumanReadable:\"0.2 mi\", Meters:242},\n                        Duration:         38000000000,\n                        StartLocation:    maps.LatLng{Lat:26.07466, Lng:-80.25254079999999},\n                        EndLocation:      maps.LatLng{Lat:26.0765145, Lng:-80.25211829999999},\n                        Polyline:         maps.Polyline{Points:\"suc~CjiyhN@i@g@EwAIC?sAMYCm@Iy@M[E@T\"},\n                        Steps:            nil,\n                        TransitDetails:   (*maps.TransitDetails)(nil),\n                        TravelMode:       \"DRIVING\",\n                    },\n                },\n                Distance:          maps.Distance{HumanReadable:\"13.4 mi\", Meters:21510},\n                Duration:          1243000000000,\n                DurationInTraffic: 0,\n                ArrivalTime:       time.Time{},\n                DepartureTime:     time.Time{},\n                StartLocation:     maps.LatLng{Lat:26.0112983, Lng:-80.1494921},\n                EndLocation:       maps.LatLng{Lat:26.0765145, Lng:-80.25211829999999},\n                StartAddress:      \"Hollywood, FL, USA\",\n                EndAddress:        \"Davie, FL, USA\",\n            },\n        },\n        WaypointOrder:    {},\n        OverviewPolyline: maps.Polyline{Points:\"siw}CheehNCwAAi@U??|ABpAJVNtVHtHDxEH~FGJAL?PEXGJSNUD]N_@XY\\\\Ub@Od@Ih@Ch@Fp@Tz@R^t@p@\\\\P`@JXRJPDVDdFH~NBjDCbC]x@YNQDkBBqCPgNvAWDSRsCNuEH_GF_CByQLqBA{BGuBQ_Ec@_Do@uD_AkIgCgEiAgE_AeEy@wDo@_Fm@yC_@eM{@eZqBoSuAqZsBsE[sCMeCEaB?{EHmTp@}ETkGp@{Dp@oTbEmMdCaIzAkI~AmH`BgKhCsHtBMKMAy@L{M`C}Dx@aCVyBLeCByAEoBKoBI}ABgAL_AX}@b@{@n@e@h@e@v@i@tAGXQfACTEfBDvBJrEAxCG`CInBBHDFMhBUrDkAlQkAhQSjDQlFIrLJx^HzLBbPChBGbCQdCMlB[bDi@xDg@tCs@bDu@zCc@zAkAtC_@dAkJnTyEbMgC`JaBlH[nAsDjSm@xCoC`NiAnH_@vCaAtHiAlJs@|EiAzH_DxS]rAeD|PeBxIOt@MHq@~Eg@bDeC`RuCtRy@dHiAbJk@lDo@`DUhAz@PhBZjDj@fBVhCVpCNdCLtCD|IIbHIjOUlX_@jEGpF?`DDpCLl@F~BVvAPxCf@hGpAjDp@pAPtCXhCR@i@g@E{AImBQgBW[E@T\"},\n        Bounds:           maps.LatLngBounds{\n            NorthEast: maps.LatLng{Lat:26.0994988, Lng:-80.14883689999999},\n            SouthWest: maps.LatLng{Lat:26.0110222, Lng:-80.25254079999999},\n        },\n        Copyrights: \"Map data \u00a92016 Google\",\n        Warnings:   {},\n    },\n}\n</code></pre>\n"}, {"tags": ["go", "go-playground"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1459792045, "post_id": 36409302, "comment_id": 60434794, "body": "&quot;The playground can use most of the standard library, with some exceptions.&quot; Well, less than stdlib, then ;)"}, {"owner": {"reputation": 40406, "user_id": 459, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0db193fbf6f0929c49dd9704698204ff?s=128&d=identicon&r=PG", "display_name": "dlamblin", "link": "https://stackoverflow.com/users/459/dlamblin"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1460502235, "post_id": 36409302, "comment_id": 60770088, "body": "BTW Thanks to all; of course I&#39;d read the about. I says it what everyone says it says. It doesn&#39;t seem to say exactly what &quot;most&quot; is, nor that anything that is not in the standard library cannot be used. The blog post about it does helpfully point out some areas where standard library behavior is different than normal. I appreciate the more complete list, based on a test, provided in the answer."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1557980676, "post_id": 36409302, "comment_id": 98949473, "body": "You can add the list of packages of GOPROXY now: <a href=\"https://stackoverflow.com/a/27813778/6309\">stackoverflow.com/a/27813778/6309</a>"}, {"owner": {"reputation": 40406, "user_id": 459, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0db193fbf6f0929c49dd9704698204ff?s=128&d=identicon&r=PG", "display_name": "dlamblin", "link": "https://stackoverflow.com/users/459/dlamblin"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1557985580, "post_id": 36409302, "comment_id": 98950776, "body": "@VonC yes, this question is quite dated compared to updates to the playground."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1557986951, "post_id": 36409302, "comment_id": 98951311, "body": "@dlamblin I have added <a href=\"https://stackoverflow.com/a/56160948/6309\">an answer below</a> to point out that you can import your <i>own</i> package now."}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 1, "last_activity_date": 1459792979, "creation_date": 1459792979, "answer_id": 36409724, "question_id": 36409302, "link": "https://stackoverflow.com/questions/36409302/which-packages-may-be-imported-in-the-go-playground/36409724#36409724", "title": "Which packages may be imported in the go playground?", "body": "<p>It appears to depend on the environment in which the playground is launched.  The relevant code in the source seems to be the <a href=\"https://github.com/golang/playground/blob/master/sandbox/sandbox.go#L67-L89\" rel=\"nofollow\"><code>compileAndRun</code></a> func, especially line 88:</p>\n\n<pre><code>cmd.Env = []string{\"GOOS=nacl\", \"GOARCH=amd64p32\", \"GOPATH=\" + os.Getenv(\"GOPATH\")}\n</code></pre>\n\n<p>Which gets the GOPATH from the environment.</p>\n\n<p>Other than that, the playground source does not have any explicit whitelist (or blacklist) of importable packages.</p>\n\n<p>It's probably key to note that the <code>compileAndRun</code> func has no code to <code>go get</code> packages, so whatever is already in the GOPATH is what is available. </p>\n\n<p>A perusal of the Makefile and Dockerfile does not reveal the specific deployment steps taken in the canonical <a href=\"http://play.golang.org\" rel=\"nofollow\">http://play.golang.org</a> site, so we simply have to rely on the documentation that Markus W Mahlberg pointed out; i.e. \"a subset of the stdlib\".</p>\n\n<p>Also, you can deploy your own version of the go playground, and give it whatever GOPATH environment you choose.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1471850180, "last_edit_date": 1471850180, "creation_date": 1459794957, "answer_id": 36410285, "question_id": 36409302, "link": "https://stackoverflow.com/questions/36409302/which-packages-may-be-imported-in-the-go-playground/36410285#36410285", "title": "Which packages may be imported in the go playground?", "body": "<p>The <kbd>About</kbd> button on the Playground gives some hint:</p>\n\n<blockquote>\n  <p>The playground can use most of the standard library, with some exceptions.</p>\n</blockquote>\n\n<p>By the <em>standard library</em> the packages of the <em>standard library</em> are meant, which are listed on the <a href=\"https://golang.org/pkg/\" rel=\"nofollow\"><strong>Packages</strong></a> page, under the <a href=\"https://golang.org/pkg/#stdlib\" rel=\"nofollow\"><strong>Standard library</strong></a> section. Packages listed under the <a href=\"https://golang.org/pkg/#other\" rel=\"nofollow\"><strong>Other</strong></a> section do not qualify (which is what you have tried - package <a href=\"https://godoc.org/golang.org/x/exp/ebnf\" rel=\"nofollow\"><code>golang.org/x/exp/ebnf</code></a> falls under the experimental and deprecated packages listed under the <strong>Other</strong> category).</p>\n\n<p>A must-read link if you want to know more about the Playground implementation:</p>\n\n<p><a href=\"https://blog.golang.org/playground\" rel=\"nofollow\"><strong>The Go Blog: Inside the Go Playground</strong></a></p>\n\n<p>Here is an exhaustive playground test to import all the standard library packages to show they at least can be imported, but that doesn't mean everything (<em>or even anything</em>) can be reasonably used from them. The only package from the standard library that gives a compile error is <code>runtime/cgo</code>; \"packages\" without a buildable Go source file are not included for obvious reasons (because a folder is <a href=\"https://golang.org/ref/spec#Packages\" rel=\"nofollow\">not a package</a> if it does not contain at least one buildable Go source file).</p>\n\n<p>Here's the <a href=\"http://play.golang.org/p/YcdVP6e76s\" rel=\"nofollow\">Playground Link</a> to try it yourself.</p>\n\n<pre><code>package main\n\nimport (\n    _ \"archive/tar\"\n    _ \"archive/zip\"\n\n    _ \"bufio\"\n    _ \"bytes\"\n\n    _ \"compress/bzip2\"\n    _ \"compress/flate\"\n    _ \"compress/gzip\"\n    _ \"compress/lzw\"\n    _ \"compress/zlib\"\n\n    _ \"container/heap\"\n    _ \"container/list\"\n    _ \"container/ring\"\n\n    _ \"crypto\"\n    _ \"crypto/aes\"\n    _ \"crypto/cipher\"\n    _ \"crypto/des\"\n    _ \"crypto/dsa\"\n    _ \"crypto/ecdsa\"\n    _ \"crypto/elliptic\"\n    _ \"crypto/hmac\"\n    _ \"crypto/md5\"\n    _ \"crypto/rand\"\n    _ \"crypto/rc4\"\n    _ \"crypto/rsa\"\n    _ \"crypto/sha1\"\n    _ \"crypto/sha256\"\n    _ \"crypto/sha512\"\n    _ \"crypto/subtle\"\n    _ \"crypto/tls\"\n    _ \"crypto/x509\"\n    _ \"crypto/x509/pkix\"\n\n    _ \"database/sql\"\n    _ \"database/sql/driver\"\n\n    _ \"debug/dwarf\"\n    _ \"debug/elf\"\n    _ \"debug/gosym\"\n    _ \"debug/macho\"\n    _ \"debug/pe\"\n    _ \"debug/plan9obj\"\n\n    _ \"encoding\"\n    _ \"encoding/ascii85\"\n    _ \"encoding/asn1\"\n    _ \"encoding/base32\"\n    _ \"encoding/base64\"\n    _ \"encoding/binary\"\n    _ \"encoding/csv\"\n    _ \"encoding/gob\"\n    _ \"encoding/hex\"\n    _ \"encoding/json\"\n    _ \"encoding/pem\"\n    _ \"encoding/xml\"\n\n    _ \"errors\"\n    _ \"expvar\"\n    _ \"flag\"\n    _ \"fmt\"\n\n    _ \"go/ast\"\n    _ \"go/build\"\n    _ \"go/constant\"\n    _ \"go/doc\"\n    _ \"go/format\"\n    _ \"go/importer\"\n    _ \"go/parser\"\n    _ \"go/printer\"\n    _ \"go/scanner\"\n    _ \"go/token\"\n    _ \"go/types\"\n\n    _ \"hash\"\n    _ \"hash/adler32\"\n    _ \"hash/crc32\"\n    _ \"hash/crc64\"\n    _ \"hash/fnv\"\n\n    _ \"html\"\n    _ \"html/template\"\n\n    _ \"image\"\n    _ \"image/color\"\n    _ \"image/color/palette\"\n    _ \"image/draw\"\n    _ \"image/gif\"\n    _ \"image/jpeg\"\n    _ \"image/png\"\n\n    _ \"index/suffixarray\"\n\n    _ \"io\"\n    _ \"io/ioutil\"\n\n    _ \"log\"\n    _ \"log/syslog\"\n\n    _ \"math\"\n    _ \"math/big\"\n    _ \"math/cmplx\"\n    _ \"math/rand\"\n\n    _ \"mime\"\n    _ \"mime/multipart\"\n    _ \"mime/quotedprintable\"\n\n    _ \"net\"\n    _ \"net/http\"\n    _ \"net/http/cgi\"\n    _ \"net/http/cookiejar\"\n    _ \"net/http/fcgi\"\n    _ \"net/http/httptest\"\n    _ \"net/http/httputil\"\n    _ \"net/http/pprof\"\n    _ \"net/mail\"\n    _ \"net/rpc\"\n    _ \"net/rpc/jsonrpc\"\n    _ \"net/smtp\"\n    _ \"net/textproto\"\n    _ \"net/url\"\n\n    _ \"os\"\n    _ \"os/exec\"\n    _ \"os/signal\"\n    _ \"os/user\"\n\n    _ \"path\"\n    _ \"path/filepath\"\n\n    _ \"reflect\"\n    _ \"regexp\"\n    _ \"regexp/syntax\"\n\n    _ \"runtime\"\n    // _ \"runtime/cgo\"  // ERROR: missing Go type information\n                        // for global symbol: .dynsym size 60\n    _ \"runtime/debug\"\n    _ \"runtime/pprof\"\n    _ \"runtime/race\"\n    _ \"runtime/trace\"\n\n    _ \"sort\"\n    _ \"strconv\"\n    _ \"strings\"\n    _ \"sync\"\n    _ \"sync/atomic\"\n    _ \"syscall\"\n\n    _ \"testing\"\n    _ \"testing/iotest\"\n    _ \"testing/quick\"\n\n    _ \"text/scanner\"\n    _ \"text/tabwriter\"\n    _ \"text/template\"\n    _ \"text/template/parse\"\n\n    _ \"time\"\n    _ \"unicode\"\n    _ \"unicode/utf16\"\n    _ \"unicode/utf8\"\n    _ \"unsafe\"\n)\n\nfunc main() {\n    println(\"ok\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1557981920, "last_edit_date": 1557981920, "creation_date": 1557981606, "answer_id": 56160948, "question_id": 36409302, "link": "https://stackoverflow.com/questions/36409302/which-packages-may-be-imported-in-the-go-playground/56160948#56160948", "title": "Which packages may be imported in the go playground?", "body": "<blockquote>\n  <p>I had trouble finding a list of what packages may be imported in the go playground at <a href=\"http://play.golang.org/\" rel=\"nofollow noreferrer\">http://play.golang.org/</a>.</p>\n</blockquote>\n\n<p>Finding an exact list will be all the more difficult than you now (May. 16th 2019)</p>\n\n<ul>\n<li>can <a href=\"https://stackoverflow.com/a/27813778/6309\">import any package referenced by <code>GOPROXY</code></a></li>\n<li>can import your <em>own</em> package (defined in the \"play.ground\") namespace.<br>\nSee the <a href=\"https://twitter.com/bradfitz/status/1128747022503165952\" rel=\"nofollow noreferrer\">announcement from Brad Fitzpatrick</a> </li>\n</ul>\n\n<blockquote>\n  <p>And now the #golang playground has support for multiple files: <a href=\"https://play.golang.org/p/KLZR7NlVZNX\" rel=\"nofollow noreferrer\">Example</a></p>\n</blockquote>\n\n<p><a href=\"https://twitter.com/dmitshur/status/1128817738678448128\" rel=\"nofollow noreferrer\">Dmitri Shuralyov adds</a>:</p>\n\n<blockquote>\n  <p>Which means you can also have multiple modules! And <code>go.mod</code> files get formatted now too: <a href=\"https://play.golang.org/p/w3XRk47wo5u\" rel=\"nofollow noreferrer\">Example</a></p>\n</blockquote>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"gopher.example/bar\"\n    \"play.ground/foo\"\n)\n\nfunc main() {\n    fmt.Println(foo.Bar)\n    fmt.Println()\n    fmt.Println(bar.Baz)\n    fmt.Println()\n    fmt.Println(\"And go.mod files get formatted too. Try pressing the Format button!\")\n}\n-- go.mod --\n\n  module      \"play.ground\"\n\n   replace (\n\n       \"gopher.example/bar\"    =&gt; ./bar\n )\n\n-- foo/foo.go --\npackage foo\n\nconst Bar = \"The Go playground now has support for multiple files!\"\n-- bar/go.mod --\nmodule gopher.example/bar\n-- bar/bar.go --\npackage bar\n\nconst Baz = \"Which means you can have multiple modules too!\"\n</code></pre>\n"}], "owner": {"reputation": 40406, "user_id": 459, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0db193fbf6f0929c49dd9704698204ff?s=128&d=identicon&r=PG", "display_name": "dlamblin", "link": "https://stackoverflow.com/users/459/dlamblin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 2, "accepted_answer_id": 36410285, "answer_count": 3, "score": 6, "last_activity_date": 1557981920, "creation_date": 1459791563, "question_id": 36409302, "link": "https://stackoverflow.com/questions/36409302/which-packages-may-be-imported-in-the-go-playground", "title": "Which packages may be imported in the go playground?", "body": "<p>I had trouble finding a list of what packages may be imported in the go playground at <a href=\"http://play.golang.org/\" rel=\"noreferrer\">http://play.golang.org/</a>. I was trying to use the (apparently experimental) package for <a href=\"https://godoc.org/golang.org/x/exp/ebnf\" rel=\"noreferrer\">ebnf</a>. However even a short program won't import from <code>golang.org</code> (breaks on the import on line 4):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"golang.org/x/exp/ebnf\"\n\nconst g = `\nProduction  = name \"=\" [ Expression ] \".\" .\nExpression  = Alternative { \"|\" Alternative } .\nAlternative = Term { Term } .\nTerm        = name | token [ \"\u2026\" token ] | Group | Option | Repetition .\nGroup       = \"(\" Expression \")\" .\nOption      = \"[\" Expression \"]\" .\nRepetition  = \"{\" Expression \"}\" .`\n\nfunc main() {\n    fmt.Println(g)\n}\n</code></pre>\n\n<p>Is it stated anywhere that only base packages in <a href=\"https://golang.org/src/\" rel=\"noreferrer\">golang.org/src/</a> would import (if that's the case)?</p>\n\n<p>I'd really like to play with this experimental package and even non-experimental supplemental libraries like <a href=\"https://godoc.org/golang.org/x/text/currency\" rel=\"noreferrer\"><code>currency</code></a> in the playground.</p>\n"}, {"tags": ["go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 1, "last_activity_date": 1459793725, "last_edit_date": 1459793725, "creation_date": 1459793061, "answer_id": 36409746, "question_id": 36409158, "link": "https://stackoverflow.com/questions/36409158/querying-a-mongo-db-collection-into-a-struct/36409746#36409746", "title": "Querying a mongo DB collection into a struct", "body": "<p>Use <a href=\"https://golang.org/pkg/reflect/#StructTag\" rel=\"nofollow\">tags</a> to hint <a href=\"https://godoc.org/labix.org/v2/mgo/bson#Unmarshal\" rel=\"nofollow\">Unmarshal</a> what the key names for each field are.</p>\n\n<pre><code>type SymbolMCAddrPort struct {\n   ID        bson.ObjectId `bson:\"_id,omitempty\"`\n   Symbol    string `bson:\"Symbol\"`\n   MCAddr    string `bson:\"MCAddr\"`\n   MCPort    int `bson:\"MCPort\"`\n}\n</code></pre>\n\n<p>From documentation of <a href=\"https://godoc.org/labix.org/v2/mgo/bson#Unmarshal\" rel=\"nofollow\">Unmarshal</a>,</p>\n\n<blockquote>\n  <p>The lowercased field name is used as the key for each exported field,\n  but this behavior may be changed using the respective field tag.</p>\n</blockquote>\n\n<p>So by default, when you are using a struct, it expects keys to be lowercased values of field names. When the key name should be anything else field tags have to be used to specify the key name.</p>\n"}], "owner": {"reputation": 5898, "user_id": 817659, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc6960319324ecebe786580dfca13f07?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/817659/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 36409746, "answer_count": 1, "score": 0, "last_activity_date": 1479677983, "creation_date": 1459791120, "last_edit_date": 1479677983, "question_id": 36409158, "link": "https://stackoverflow.com/questions/36409158/querying-a-mongo-db-collection-into-a-struct", "title": "Querying a mongo DB collection into a struct", "body": "<p>Defining this struct</p>\n\n<pre><code>type SymbolMCAddrPort struct {\n        ID        bson.ObjectId `bson:\"_id,omitempty\"`\n        Symbol    string\n        MCAddr    string\n        MCPort    int\n}\n\nsession, err := mgo.Dial(\"10.0.0.61\")\nif err != nil {\n    panic(err)\n}\n\ndefer session.Close()\n\ncsap := session.DB(\"FX\").C(\"MCAddrPortPairs\")\n</code></pre>\n\n<p>If I say</p>\n\n<pre><code>var resultsSMP bson.M\nerr = csap.Find(bson.M{\"Symbol\": \"EUR/USD\"}).One(&amp;resultsSMP)\nfmt.Println(resultsSMP)\n</code></pre>\n\n<p>I correctly see</p>\n\n<pre><code>map[_id:ObjectIdHex(\"56fc34e961fed32064e656b0\") Symbol:EUR/USD MCAddr:239.0.0.222 MCPort:345]\n</code></pre>\n\n<p>But if I say</p>\n\n<pre><code>resultsSMP := SymbolMCAddrPort{}\nerr = csap.Find(bson.M{\"Symbol\": \"EUR/USD\"}).One(&amp;resultsSMP)\n\nif err != nil {\n    panic(err)\n}\n\nfmt.Println(resultsSMP)\n</code></pre>\n\n<p>I just see</p>\n\n<pre><code>{ObjectIdHex(\"56fc34e961fed32064e656b0\")   0}\n</code></pre>\n\n<p>I note that the ID is correct, but I can't get the rest of the fields in the struct?</p>\n"}, {"tags": ["mongodb", "go", "docker"], "comments": [{"owner": {"reputation": 9875, "user_id": 4190526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f136b1cb9f010656895934c874637953?s=128&d=identicon&r=PG&f=1", "display_name": "Xiongbing Jin", "link": "https://stackoverflow.com/users/4190526/xiongbing-jin"}, "edited": false, "score": 0, "creation_date": 1459786196, "post_id": 36407477, "comment_id": 60431284, "body": "You can probably set up a flag (file or database) that indicates whether the script has been run and data have been initialized."}], "answers": [{"tags": [], "owner": {"reputation": 4021, "user_id": 3830108, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/elcXQ.jpg?s=128&g=1", "display_name": "Cortwave", "link": "https://stackoverflow.com/users/3830108/cortwave"}, "is_accepted": false, "score": 1, "last_activity_date": 1459790451, "last_edit_date": 1459790451, "creation_date": 1459790040, "answer_id": 36408847, "question_id": 36407477, "link": "https://stackoverflow.com/questions/36407477/how-to-run-a-command-once-in-docker-compose/36408847#36408847", "title": "How to run a command once in Docker compose", "body": "<p>Your application need some initial state for working. It means that you should:</p>\n\n<ol>\n<li>Check if required state already exists</li>\n<li>Depends on first step result init state or not</li>\n</ol>\n\n<p>You can write program for checking current database state (here I will use bash script but it can be every other language program):</p>\n\n<pre><code>RUN if $(./check.sh); then my_project -setup; fi\n</code></pre>\n\n<p>In my case if script will return 0 (success exit status) then <code>setup</code> command will be called.</p>\n"}, {"comments": [{"owner": {"reputation": 4021, "user_id": 3830108, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/elcXQ.jpg?s=128&g=1", "display_name": "Cortwave", "link": "https://stackoverflow.com/users/3830108/cortwave"}, "edited": false, "score": 2, "creation_date": 1459790921, "post_id": 36408921, "comment_id": 60434159, "body": "And how are you suggesting to use it?"}, {"owner": {"reputation": 1266, "user_id": 3656424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c56441e0f23ba66563c2dfd0e361b28?s=128&d=identicon&r=PG", "display_name": "Petr Shevtsov", "link": "https://stackoverflow.com/users/3656424/petr-shevtsov"}, "reply_to_user": {"reputation": 4021, "user_id": 3830108, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/elcXQ.jpg?s=128&g=1", "display_name": "Cortwave", "link": "https://stackoverflow.com/users/3830108/cortwave"}, "edited": false, "score": 0, "creation_date": 1459795000, "post_id": 36408921, "comment_id": 60436460, "body": "@Cortwave it makes the structure a bit complex, since one needs to create a &quot;base&quot; image first with <code>ONBUILD</code> instructions and after that an image for an application. As for me, I&#39;d better solve this problem on the application side or using something like a makefile."}, {"owner": {"reputation": 1266, "user_id": 3656424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c56441e0f23ba66563c2dfd0e361b28?s=128&d=identicon&r=PG", "display_name": "Petr Shevtsov", "link": "https://stackoverflow.com/users/3656424/petr-shevtsov"}, "reply_to_user": {"reputation": 4021, "user_id": 3830108, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/elcXQ.jpg?s=128&g=1", "display_name": "Cortwave", "link": "https://stackoverflow.com/users/3830108/cortwave"}, "edited": false, "score": 0, "creation_date": 1459801552, "post_id": 36408921, "comment_id": 60440167, "body": "@Cortwave I&#39;d better leave db as simple as possible, so edit on the app side."}, {"owner": {"reputation": 4021, "user_id": 3830108, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/elcXQ.jpg?s=128&g=1", "display_name": "Cortwave", "link": "https://stackoverflow.com/users/3830108/cortwave"}, "edited": false, "score": 0, "creation_date": 1459801935, "post_id": 36408921, "comment_id": 60440367, "body": "But as I understood <code>ONBUILD</code> command it just executes some trigger when you are using your image as base image for other build. In other words it will be executed every time when you are using your app image as base image."}, {"owner": {"reputation": 1266, "user_id": 3656424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c56441e0f23ba66563c2dfd0e361b28?s=128&d=identicon&r=PG", "display_name": "Petr Shevtsov", "link": "https://stackoverflow.com/users/3656424/petr-shevtsov"}, "reply_to_user": {"reputation": 4021, "user_id": 3830108, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/elcXQ.jpg?s=128&g=1", "display_name": "Cortwave", "link": "https://stackoverflow.com/users/3830108/cortwave"}, "edited": false, "score": 0, "creation_date": 1459802599, "post_id": 36408921, "comment_id": 60440713, "body": "@Cortwave Yes, it will be executed every time you build the image, but not every time when you run a container."}, {"owner": {"reputation": 4021, "user_id": 3830108, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/elcXQ.jpg?s=128&g=1", "display_name": "Cortwave", "link": "https://stackoverflow.com/users/3830108/cortwave"}, "reply_to_user": {"reputation": 1266, "user_id": 3656424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c56441e0f23ba66563c2dfd0e361b28?s=128&d=identicon&r=PG", "display_name": "Petr Shevtsov", "link": "https://stackoverflow.com/users/3656424/petr-shevtsov"}, "edited": false, "score": 0, "creation_date": 1459802637, "post_id": 36408921, "comment_id": 60440727, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/108214/discussion-between-cortwave-and-petr-shevtsov\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1266, "user_id": 3656424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c56441e0f23ba66563c2dfd0e361b28?s=128&d=identicon&r=PG", "display_name": "Petr Shevtsov", "link": "https://stackoverflow.com/users/3656424/petr-shevtsov"}, "is_accepted": false, "score": 3, "last_activity_date": 1459790274, "creation_date": 1459790274, "answer_id": 36408921, "question_id": 36407477, "link": "https://stackoverflow.com/questions/36407477/how-to-run-a-command-once-in-docker-compose/36408921#36408921", "title": "How to run a command once in Docker compose", "body": "<p>You could try to use <a href=\"https://docs.docker.com/engine/reference/builder/#onbuild\" rel=\"nofollow\"><code>ONBUILD</code> instruction</a>:</p>\n\n<p>The <code>ONBUILD</code> instruction adds to the image a trigger instruction to be executed at a later time, when the image is used as the base for another build. The trigger will be executed in the context of the downstream build, as if it had been inserted immediately after the <code>FROM</code> instruction in the downstream <code>Dockerfile</code>.</p>\n\n<p>Any build instruction can be registered as a trigger.</p>\n\n<p>This is useful if you are building an image which will be used as a base to build other images, for example an application build environment or a daemon which may be customized with user-specific configuration.</p>\n\n<p>For example, if your image is a reusable Python application builder, it will require application source code to be added in a particular directory, and it might require a build script to be called <em>after</em> that. You can\u2019t just call <code>ADD</code> and <code>RUN</code> now, because you don\u2019t yet have access to the application source code, and it will be different for each application build. You could simply provide application developers with a boilerplate <code>Dockerfile</code> to copy-paste into their application, but that is inefficient, error-prone and difficult to update because it mixes with application-specific code.</p>\n\n<p>The solution is to use <code>ONBUILD</code> to register advance instructions to run later, during the next build stage.</p>\n\n<p>Here\u2019s how it works:</p>\n\n<ol>\n<li>When it encounters an <code>ONBUILD</code> instruction, the builder adds a trigger to the metadata of the image being built. The instruction does not otherwise affect the current build.</li>\n<li>At the end of the build, a list of all triggers is stored in the image manifest, under the key <code>OnBuild</code>. They can be inspected with the <code>docker inspect</code> command.</li>\n<li>Later the image may be used as a base for a new build, using the <code>FROM</code> instruction. As part of processing the <code>FROM</code> instruction, the downstream builder looks for <code>ONBUILD</code> triggers, and executes them in the same order they were registered. If any of the triggers fail, the <code>FROM</code> instruction is aborted which in turn causes the build to fail. If all triggers succeed, the <code>FROM</code> instruction completes and the build continues as usual.</li>\n<li>Triggers are cleared from the final image after being executed. In other words they are not inherited by \u201cgrand-children\u201d builds.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 23386, "user_id": 1811501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tj0qU.jpg?s=128&g=1", "display_name": "thaJeztah", "link": "https://stackoverflow.com/users/1811501/thajeztah"}, "is_accepted": true, "score": 11, "last_activity_date": 1459830568, "last_edit_date": 1459830568, "creation_date": 1459830148, "answer_id": 36417087, "question_id": 36407477, "link": "https://stackoverflow.com/questions/36407477/how-to-run-a-command-once-in-docker-compose/36417087#36417087", "title": "How to run a command once in Docker compose", "body": "<p>I suggest to add an entrypoint-script to your container; in this entrypoint-script, you can check if the database has been initialized, and if it isn't, perform the required steps.</p>\n\n<p>As you noticed in your question, the order in which services / containers are started should not be taken for granted, so it's possible your application container is started <em>before</em> the database container, so the script should take that into account.</p>\n\n<p>As an example, have a look at the official WordPress image, which performs a one-time initialization of the database in it's entrypoint-script. The script attempts to connect to the database (and retries if the database cannot be contacted (yet)), and checks if initialization is needed; <a href=\"https://github.com/docker-library/wordpress/blob/df190dc9c5752fd09317d836bd2bdcd09ee379a5/apache/docker-entrypoint.sh#L146-L171\" rel=\"noreferrer\">https://github.com/docker-library/wordpress/blob/df190dc9c5752fd09317d836bd2bdcd09ee379a5/apache/docker-entrypoint.sh#L146-L171</a></p>\n\n<p><strong>NOTE</strong></p>\n\n<p>I notice you created a \"data-only container\" to attach your volume to. Since docker 1.9, docker has volume management, including naming volumes. Because of this, you no longer need to use \"data-only\" containers.</p>\n\n<p>You can remove the data-only container from your compose file, and change your mongo service to look something like this;</p>\n\n<pre><code>  mongo:\n    image: mongo:latest\n    volumes:\n      - mongodata:/data/db\n    ports:\n      - \"28001:27017\"\n    command: --smallfiles --rest --auth\n</code></pre>\n\n<p>This should create a new volume, named <code>mongodata</code> if it doesn't exist, or re-use the existing volume with that name. You can list all volumes using <code>docker volume ls</code> and remove a volume with <code>docker volume rm &lt;some-volume&gt;</code> if you no longer need it</p>\n"}], "owner": {"reputation": 1671, "user_id": 325358, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/eb58709dc08423fc567de3a3225b23c9?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/325358/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26171, "favorite_count": 5, "accepted_answer_id": 36417087, "answer_count": 3, "score": 23, "last_activity_date": 1459830568, "creation_date": 1459785592, "last_edit_date": 1459814188, "question_id": 36407477, "link": "https://stackoverflow.com/questions/36407477/how-to-run-a-command-once-in-docker-compose", "title": "How to run a command once in Docker compose", "body": "<p>So I'm working on a docker compose file to deploy my Go web server. My server uses mongo, so I added a data volume container and the mongo service in docker compose.\nThen I wrote a Dockerfile in order to build my Go project, and finally run it.</p>\n\n<p>However, there is another step that must be done. Once my project has been compiled, I have to run the following command:\n<code>./my-project -setup</code></p>\n\n<p>This will add some necessary information to the database, and the information <strong>only needs to be added once</strong>.\nI can't however add this step on the Dockerfile (in the build process) because mongo must already be started.</p>\n\n<p>So, how can I achieve this? Even if I restart the server and then run again <code>docker-compose up</code> I don't want this command to be executed again.</p>\n\n<p>I think I'm missing some Docker understanding, because I don't actually understand everything about data volume containers (are they just <em>stopped</em> containers that mount a volume?).\nAlso, if I restart the server, and then run <code>docker-compose up</code>, which commands will be run? Will it just start the same container that was now stopped with the given CMD?</p>\n\n<p>In any case, here is my docker-compose.yml:</p>\n\n<pre><code>version: '2'\nservices:\n  mongodata:\n    image: mongo:latest\n    volumes:\n      - /data/db\n    command: --break-mongo\n  mongo:\n    image: mongo:latest\n    volumes_from:\n      - mongodata\n    ports:\n      - \"28001:27017\"\n    command: --smallfiles --rest --auth\n  my_project:\n    build: .\n    ports:\n      - \"6060:8080\"\n    depends_on:\n      - mongo\n      - mongodata\n    links:\n      - mongo\n</code></pre>\n\n<p>And here is my Dockerfile to build my project image:</p>\n\n<pre><code>FROM golang\n\nADD . /go/src/my_project\nRUN cd /go/src/my_project &amp;&amp; go get\nRUN go install my_project\nRUN my_project -setup\nENTRYPOINT /go/bin/my_project\n\nEXPOSE 8080\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1459786715, "post_id": 36407524, "comment_id": 60431600, "body": "Alternatively, in case there&#39;s a bunch more to that init in reality.  Do as is now, but exclude &quot;LiveDate&quot;, then just do if x { app_history.LiveDate = &amp;theTime } after you create the initial struct"}], "tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": true, "score": 3, "last_activity_date": 1459785742, "creation_date": 1459785742, "answer_id": 36407524, "question_id": 36407297, "link": "https://stackoverflow.com/questions/36407297/go-parse-null-to-time-time-in-struct/36407524#36407524", "title": "Go - Parse NULL to time.Time in Struct", "body": "<p>you need to define the app_history variable outside the if statement and then assign to it in each of the branches</p>\n\n<p>like so</p>\n\n<pre><code>var app_history &amp;models.AppsHistoryInsert{}\n\nif x {\n  app_history = &amp;models.AppsHistoryInsert{\n    AppId:          response.SetAppData[0].Id,\n    LiveDate:       &amp;theTime,\n  }\n}else {\n  app_history = &amp;models.AppsHistoryInsert{\n    AppId:          response.SetAppData[0].Id,\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 36407524, "answer_count": 1, "score": 3, "last_activity_date": 1459814224, "creation_date": 1459785046, "last_edit_date": 1459814224, "question_id": 36407297, "link": "https://stackoverflow.com/questions/36407297/go-parse-null-to-time-time-in-struct", "title": "Go - Parse NULL to time.Time in Struct", "body": "<p>I am casting to a struct which has a time.Time type in.</p>\n\n<pre><code>t2 := time.Now()\nformat := \"2006-01-02 15:04:05\"\n\ntheTime, _ := time.Parse(format, t2.Format(format))\n</code></pre>\n\n<p>However, sometimes I don't want to set the time.Time field, how do you define this with the go/mysql db driver?</p>\n\n<pre><code>app_history := &amp;models.AppsHistoryInsert{\n    AppId:          response.SetAppData[0].Id,\n    LiveDate:       &amp;theTime,\n}\n</code></pre>\n\n<p>Basically, I want </p>\n\n<pre><code>if(x == true) { \n    include time \n}\nelse {\n    don't include time. \n}\n</code></pre>\n\n<p>I tried doing an <code>if</code> around the struct declaration itself and leaving the <code>LiveDate</code> field out but I got the error of <code>controllers/apps.go:1068: undefined: app_history</code></p>\n"}, {"tags": ["go", "synchronization"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 2, "creation_date": 1521135834, "post_id": 36407206, "comment_id": 85614193, "body": "from <a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow noreferrer\">golang.org/pkg/sync</a>   it notes:  <i>&quot;Values containing the types defined in this package should not be copied&quot;</i>    Therefore, only pass <code>sync.WaitGroup</code> by pointer reference."}], "answers": [{"comments": [{"owner": {"reputation": 5926, "user_id": 3128156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/h3FIS.jpg?s=128&g=1", "display_name": "Sahand", "link": "https://stackoverflow.com/users/3128156/sahand"}, "edited": false, "score": 1, "creation_date": 1459785573, "post_id": 36407385, "comment_id": 60430870, "body": "Got it, I didn&#39;t know you needed the address to be sent to <code>Print</code> instead of  the <code>WaitGroup</code> itself.  I agree that the method doesn&#39;t need to know about the <code>WaitGroup</code>, but suppose I want this anyway. What then, does the star do? Does it pick out the ACTUAL <code>WaitGrooup</code> I have defined in <code>main</code>? And why is this one not a copy?"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 5926, "user_id": 3128156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/h3FIS.jpg?s=128&g=1", "display_name": "Sahand", "link": "https://stackoverflow.com/users/3128156/sahand"}, "edited": false, "score": 0, "creation_date": 1459785860, "post_id": 36407385, "comment_id": 60431069, "body": "The <code>*sync.WaitGroup</code> tells the compiler you want a pointer to a <code>WaitGroup</code> instead of a <code>WaitGroup</code>. So the compiler expects you to call the method by giving it an address, hence the <code>&amp;wg</code>."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 2, "creation_date": 1459787053, "post_id": 36407385, "comment_id": 60431808, "body": "Don&#39;t think you can remove print&#39;s waitgroup as main&#39;s wg.Wait could fall through before the last value is printed if you only waited for the sender to complete.   Also, no reason to end a function with a defer wg.Done(), defer basically means, run this at the end.  drop the defer"}, {"owner": {"reputation": 491, "user_id": 7655137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5203fc333c6443affb37aa2209267d71?s=128&d=identicon&r=PG&f=1", "display_name": "darkwing", "link": "https://stackoverflow.com/users/7655137/darkwing"}, "edited": false, "score": 0, "creation_date": 1506543014, "post_id": 36407385, "comment_id": 79868444, "body": "This answer doesn&#39;t show the what I think is the correct pattern that Elwinar posted in the comments of an answer below at <a href=\"https://play.golang.org/p/lOopY0bYHT\" rel=\"nofollow noreferrer\">play.golang.org/p/lOopY0bYHT</a>. <code>Print</code> is wrapped in an anonymous goroutine in <code>main</code> and <code>wg.Done()</code> is called at that scope."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 31, "last_activity_date": 1459785303, "creation_date": 1459785303, "answer_id": 36407385, "question_id": 36407206, "link": "https://stackoverflow.com/questions/36407206/best-way-of-using-sync-waitgroup-with-external-function/36407385#36407385", "title": "Best way of using sync.WaitGroup with external function", "body": "<p>Well, first your actual error is that you're giving the <code>Print</code> method a copy of the <code>sync.WaitGroup</code>, so it doesn't call the <code>Done()</code> method on the one you're <code>Wait()</code>ing on.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {    \n    ch := make(chan int)\n\n    var wg sync.WaitGroup\n    wg.Add(2)    \n\n    go Print(ch, &amp;wg)\n\n    go func() {  \n        for i := 1; i &lt;= 11; i++ {\n            ch &lt;- i\n        }\n        close(ch)\n        defer wg.Done()\n    }()          \n\n    wg.Wait() //deadlock here\n}                \n\nfunc Print(ch &lt;-chan int, wg *sync.WaitGroup) {\n    for n := range ch { // reads from channel until it's closed\n        fmt.Println(n)\n    }            \n    defer wg.Done()\n}\n</code></pre>\n\n<p>Now, changing your <code>Print</code> method to remove the <code>WaitGroup</code> of it is a generally good idea: the method doesn't need to know something is waiting for it to finish its job.</p>\n"}, {"comments": [{"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 1, "creation_date": 1459843795, "post_id": 36416696, "comment_id": 60455767, "body": "I completely disagree with the <i>Don&#39;t remove the wg from Print</i>. But maybe my proposal wasn&#39;t understood correctly, what I advise is to do something like that : <a href=\"http://play.golang.org/p/lOopY0bYHT\" rel=\"nofollow noreferrer\">play.golang.org/p/lOopY0bYHT</a>  That way, your routine doesn&#39;t know that is is synchronized, which makes it simpler. As a rule of thumb, <i>unless synchronization is part of the algorithm, your code should never be aware of it</i>. Meaning, a method that print something to the screen should never need any synchronization awareness."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 1, "creation_date": 1459843955, "post_id": 36416696, "comment_id": 60455880, "body": "Its a good idea to recover from panics, but in this example it is overdoing it. The only thing that can panic is sending to a closed channel, and you are the one that close it. Don&#39;t fall in the trap of checking everything every time, that will just bloat your code with unnecessary checks and make it hard to read."}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "reply_to_user": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1459844337, "post_id": 36416696, "comment_id": 60456096, "body": "@Elwinar I said I disagree with you because you only mentioned to <i>remove the wg from print</i>, but never said it should be added somewhere else. And what I want to demo in my post is stated as bold: <b>never leave a goroutine dangling around.</b> Also, the reason why I add recover for all functions is, you never know when you will add in some logic that causes panic, it may not panic now, but it may in the future."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1459844875, "post_id": 36416696, "comment_id": 60456469, "body": "In the end of the OP&#39;s question is an example where he show how he wants to remove the wg from the function\u2026 that&#39;s the solution I was agreeing with (as shown in my playground example). I agree with the dangling routines warning, but obviously this is a teaching example about routines. And adding recovers everywhere because one day someone might add code that cause panics is an unnecessary precaution that just makes the coe unreadable now, and as such is likely to cause errors (that will, ironically, trigger the panics you&#39;re protecting yourself from)."}], "tags": [], "owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "is_accepted": false, "score": 2, "last_activity_date": 1459828134, "last_edit_date": 1459828134, "creation_date": 1459827460, "answer_id": 36416696, "question_id": 36407206, "link": "https://stackoverflow.com/questions/36407206/best-way-of-using-sync-waitgroup-with-external-function/36416696#36416696", "title": "Best way of using sync.WaitGroup with external function", "body": "<p>I agree with @Elwinar's solution, that the main problem in your code caused by passing a copy of your <code>Waitgroup</code> to the <code>Print</code> function.</p>\n\n<p>This means the <code>wg.Done()</code> is operated on a copy of <code>wg</code> you defined in the <code>main</code>. Therefore, <code>wg</code> in the <code>main</code> could not get decreased, and thus a deadlock happens when you <code>wg.Wait()</code> in main.</p>\n\n<p>Since you are also asking about the best practice, I could give you some suggestions of my own:</p>\n\n<ul>\n<li><p>Don't remove <code>defer wg.Done()</code> in <code>Print</code>. Since your goroutine in main is a sender, and print is a receiver, removing <code>wg.Done()</code> in receiver routine will cause an unfinished receiver. This is because only your sender is synced with your main, so after your sender is done, your main is done, but it's possible that the receiver is still working. My point is: <strong>don't leave some dangling goroutines around after your main routine is finished. Close them or wait for them.</strong></p></li>\n<li><p>Remember to do panic recovery everywhere, especially anonymous goroutine. I have seen a lot of golang programmers forgetting to put panic recovery in goroutines, even if they remember to put recover in normal functions. It's critical when you want your code to behave correctly or at least gracefully when something unexpected happened.</p></li>\n<li><p>Use <code>defer</code> before every critical calls, like <code>sync</code> related calls, <strong>at the beginning</strong> since you don't know where the code could break. Let's say you removed <code>defer</code> before <code>wg.Done()</code>, and a panic occurrs in your anonymous goroutine in your example. If you don't have panic recover, it will panic. But what happens if you have a panic recover? Everything's fine now? No. You will get deadlock at <code>wg.Wait()</code> since your <code>wg.Done()</code> gets skipped because of panic! However, by using <code>defer</code>, this <code>wg.Done()</code> will be executed at the end, even if panic happened. Also, defer before <code>close</code> is important too, since its result also affects the communication.</p></li>\n</ul>\n\n<p>So here is the code modified according to the points I mentioned above:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    ch := make(chan int)\n    var wg sync.WaitGroup\n    wg.Add(2)\n    go Print(ch, &amp;wg)\n    go func() {\n\n        defer func() {\n            if r := recover(); r != nil {\n                println(\"panic:\" + r.(string))\n            }\n        }()\n\n        defer func() {\n            wg.Done()\n        }()\n\n        for i := 1; i &lt;= 11; i++ {\n            ch &lt;- i\n\n            if i == 7 {\n                panic(\"ahaha\")\n            }\n        }\n\n        println(\"sender done\")\n        close(ch)\n    }()\n\n    wg.Wait()\n}\n\nfunc Print(ch &lt;-chan int, wg *sync.WaitGroup) {\n    defer func() {\n        if r := recover(); r != nil {\n            println(\"panic:\" + r.(string))\n        }\n    }()\n\n    defer wg.Done()\n\n    for n := range ch {\n        fmt.Println(n)\n    }\n    println(\"print done\")\n}\n</code></pre>\n\n<p>Hope it helps :)</p>\n"}], "owner": {"reputation": 5926, "user_id": 3128156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/h3FIS.jpg?s=128&g=1", "display_name": "Sahand", "link": "https://stackoverflow.com/users/3128156/sahand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12907, "favorite_count": 14, "accepted_answer_id": 36407385, "answer_count": 2, "score": 14, "last_activity_date": 1459828134, "creation_date": 1459784774, "question_id": 36407206, "link": "https://stackoverflow.com/questions/36407206/best-way-of-using-sync-waitgroup-with-external-function", "title": "Best way of using sync.WaitGroup with external function", "body": "<p>I have some issues with the following code:</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"sync\"\n)\n// This program should go to 11, but sometimes it only prints 1 to 10.\nfunc main() {\n    ch := make(chan int)\n    var wg sync.WaitGroup\n    wg.Add(2)\n    go Print(ch, wg) //\n    go func(){\n\n        for i := 1; i &lt;= 11; i++ {\n            ch &lt;- i\n        }\n\n        close(ch) \n        defer wg.Done()\n\n\n    }()\n\n    wg.Wait() //deadlock here\n}\n\n// Print prints all numbers sent on the channel.\n// The function returns when the channel is closed.\nfunc Print(ch &lt;-chan int, wg sync.WaitGroup) {\n    for n := range ch { // reads from channel until it's closed\n        fmt.Println(n)\n    }\n    defer wg.Done()\n}\n</code></pre>\n\n<p>I get a deadlock at the specified place. I have tried setting <code>wg.Add(1)</code> instead of 2 and it solves my problem. My belief is that I'm not successfully sending the channel as an argument to the <code>Printer</code> function. Is there a way to do that? Otherwise, a solution to my problem is replacing the <code>go Print(ch, wg)</code>line with:</p>\n\n<pre><code>go func() {\nPrint(ch)\ndefer wg.Done()\n}\n</code></pre>\n\n<p>and changing the <code>Printer</code> function to:</p>\n\n<pre><code>func Print(ch &lt;-chan int) {\n    for n := range ch { // reads from channel until it's closed\n        fmt.Println(n)\n    }\n\n}\n</code></pre>\n\n<p>What is the best solution?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": false, "score": 0, "last_activity_date": 1459786206, "creation_date": 1459786206, "answer_id": 36407671, "question_id": 36406692, "link": "https://stackoverflow.com/questions/36406692/appengine-multiple-configurations-environments/36407671#36407671", "title": "AppEngine: Multiple configurations/environments", "body": "<p>My preference is to have the delta between the staging/QA and production reflected in (and controlled via) the VCS (git in my case):</p>\n\n<ul>\n<li>my main development happens on the main branch, where the staging environment config is reflected in the <code>.yaml</code> files' contents</li>\n<li>my production branch is pulled off the main branch and contains the production environment config - the <code>.yaml</code> files are modified accordingly</li>\n</ul>\n\n<p>When I perform a deployment I do it from a workspace based on the appropriate branch depending on which config I need to deploy.</p>\n\n<p>The delta between the production branch and the main branch is pretty much just deployment config changes. Whenever I'm happy with the staging results and I'm ready to deploy in production I just sync the production branch to the main refpoint corresponding to the OK'd staging deployment and deploy.</p>\n\n<p>Another possible approach is to directly use the SDK's <code>appcfg.py</code> tool, which is what <code>goapp deploy</code> ultimately <a href=\"https://cloud.google.com/appengine/docs/go/tools/uploadinganapp#Go_Uploading_the_app\" rel=\"nofollow\">invokes anyways</a>:</p>\n\n<blockquote>\n  <p>goapp deploy wraps the appcfg.py python tool provided in the SDK. You\n  can also invoke this tool directly if you need greater control over\n  the deployment:</p>\n</blockquote>\n\n<p>The <code>appcfg.py</code> tool allows you to actually have and use alternate <code>.yaml</code> files residing in the same app/module directory (you'd probably have to use that anyways if you go with multiple or non-standard module configurations, since auto-detection from the app's dir won't work anymore):</p>\n\n<pre><code>appcfg.py update app-qa.yaml\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1266, "user_id": 3656424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c56441e0f23ba66563c2dfd0e361b28?s=128&d=identicon&r=PG", "display_name": "Petr Shevtsov", "link": "https://stackoverflow.com/users/3656424/petr-shevtsov"}, "is_accepted": false, "score": -1, "last_activity_date": 1459799034, "creation_date": 1459799034, "answer_id": 36411509, "question_id": 36406692, "link": "https://stackoverflow.com/questions/36406692/appengine-multiple-configurations-environments/36411509#36411509", "title": "AppEngine: Multiple configurations/environments", "body": "<p><a href=\"https://cloud.google.com/appengine/docs/go/modules/\" rel=\"nofollow\">App Engine Modules</a> could be used for such purposes.</p>\n"}], "owner": {"reputation": 49995, "user_id": 277683, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c15311acd88ded73e20238c71adf253f?s=128&d=identicon&r=PG", "display_name": "Konrad Garus", "link": "https://stackoverflow.com/users/277683/konrad-garus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544095488, "creation_date": 1459783420, "last_edit_date": 1544095488, "question_id": 36406692, "link": "https://stackoverflow.com/questions/36406692/appengine-multiple-configurations-environments", "title": "AppEngine: Multiple configurations/environments", "body": "<p>I have a Google App Engine app (Go lang, if that matters) that I would like to deploy more than once, with slightly different setup. Think production vs. QA.</p>\n\n<p><code>env_variables</code> in app.yaml seemed promising, but it seems I can only have one such file. For example, I don't see a way to call \"goapp deploy\" with app-qa.yaml.</p>\n\n<p>How can I tweak deployment configuration? Is it possible to have more than one app.yaml, without custom script that copies files to a directory and manipulates app.yaml? Any other way to configure this?</p>\n"}, {"tags": ["datetime", "go"], "answers": [{"comments": [{"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "edited": false, "score": 0, "creation_date": 1459778815, "post_id": 36404703, "comment_id": 60426061, "body": "So this works, but the response I get is not what I am expecting. I just want to cast the value e.g. 2016-04-04 13:33:00 into the Struct."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 2, "last_activity_date": 1459778177, "creation_date": 1459778177, "answer_id": 36404703, "question_id": 36404635, "link": "https://stackoverflow.com/questions/36404635/golang-struct-time-time/36404703#36404703", "title": "Golang - struct : time.Time", "body": "<p>It means that <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow\"><code>time.Parse</code></a> returns two results <code>time.Time</code> and <code>error</code> values. You are assigning only to one variable.</p>\n\n<p>You should do that:</p>\n\n<pre><code>response.SetAppData[0].LiveDate, err = time.Parse(format, t.String())\nif err != nil {\n    // error handling here\n}\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2894, "favorite_count": 0, "closed_date": 1459778387, "accepted_answer_id": 36404703, "answer_count": 1, "score": 0, "last_activity_date": 1459778177, "creation_date": 1459778008, "question_id": 36404635, "link": "https://stackoverflow.com/questions/36404635/golang-struct-time-time", "closed_reason": "Duplicate", "title": "Golang - struct : time.Time", "body": "<p>I am trying to cast a value to a struct which has a type of time.Time.</p>\n\n<p>The value is:</p>\n\n<pre><code>t := time.Now()\nformat := \"2006-01-02 15:04:05\"\n</code></pre>\n\n<p>Then I am trying to put this into the struct:</p>\n\n<pre><code>response.SetAppData[0].LiveDate = time.Parse(format, t.String())\n</code></pre>\n\n<p>However I get the error of:</p>\n\n<pre><code>controllers/apps.go:1085: multiple-value time.Parse() in single-value context\n</code></pre>\n\n<p>I am not sure what I am doing wrong.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["intellij-idea", "go"], "comments": [{"owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "edited": false, "score": 0, "creation_date": 1459775507, "post_id": 36403187, "comment_id": 60423544, "body": "Is the backend folder the source to your project or what is that?  All packages that are included in your project need to be in the src folder of your GOPATH.  I would bet your folder structure is different locally than it is on your server"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459776157, "post_id": 36403187, "comment_id": 60424049, "body": "how do you import <code>api.jwt.auth</code> package? i have a strong feeling that you didn&#39;t import correctly."}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459776497, "post_id": 36403187, "comment_id": 60424315, "body": "it&#39;s should be <code>import &quot;backend&#47;src&#47;api.jwt.auth&quot;</code>, not <code>api.jwt.auth</code>."}, {"owner": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "reply_to_user": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459776876, "post_id": 36403187, "comment_id": 60424628, "body": "@nevets, I edit my question, also I have edit my import but it didn&#39;t help"}, {"owner": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "reply_to_user": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "edited": false, "score": 0, "creation_date": 1459776977, "post_id": 36403187, "comment_id": 60424700, "body": "@tier1, yes it&#39;s a source project dir, all dependencies which needed to project included in GOPATH/src."}, {"owner": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "reply_to_user": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459777096, "post_id": 36403187, "comment_id": 60424780, "body": "@nevets, intellij builds and runs project"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459778068, "post_id": 36403187, "comment_id": 60425532, "body": "it seems your server is within <code>api.jwt.auth</code> folder :s have you tried <code>go build .&#47;...</code> within <code>backend&#47;src</code> and ` backend/src/api.jwt.auth`?"}, {"owner": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "reply_to_user": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459778452, "post_id": 36403187, "comment_id": 60425813, "body": "@nevets, yes, I have tried, it shows the same issue, do you have assumptions why it adds src/api.jwt.auth to my GOPATH) sorry if I ask very fundamental questions, my golang experience is too small"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459778469, "post_id": 36403187, "comment_id": 60425827, "body": "hmmm, i&#39;m afraid intellij automatically add your current folder into PATH, so that it could find <code>api.jwt.auth</code> :s i&#39;m not using intellij so i could not confirm thought :("}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "reply_to_user": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "edited": false, "score": 0, "creation_date": 1459778529, "post_id": 36403187, "comment_id": 60425874, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/108189/discussion-between-nevets-and-denis-zinkovskiy\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "edited": false, "score": 0, "creation_date": 1459836178, "post_id": 36406183, "comment_id": 60451380, "body": "Thanks a lot, approach with 2 paths in GOPATH helps me! Is it bad practice to do that, should I move my source code as you mentioned above?"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "edited": false, "score": 0, "creation_date": 1459865414, "post_id": 36406183, "comment_id": 60471924, "body": "I don&#39;t think it&#39;s bad practice; just not common."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 1, "last_activity_date": 1459781997, "creation_date": 1459781997, "answer_id": 36406183, "question_id": 36403187, "link": "https://stackoverflow.com/questions/36403187/go-build-cannot-find-package/36406183#36406183", "title": "&quot;go build ./...&quot; cannot find package", "body": "<p>Your GOPATH can have multiple directories in it.  </p>\n\n<p>If you truly want your <code>backend</code> directory to be a path of some of your Go libraries, in addition to your existing path of <code>/Users/denis/Programming/Golang</code> you can set your GOPATH to: <code>/Users/denis/Programming/Golang:/Users/denis/Programming/Golang/src/backend</code> </p>\n\n<p>This will cause import statements to search for source files in both the <code>/Users/denis/Programming/Golang/src</code> directory and the <code>/Users/denis/Programming/Golang/src/backend/src</code> directory.</p>\n\n<p>I would personally recommend moving your api.jwt.auth folder to <code>/Users/denis/Programming/Golang/src/api.jwt.auth</code> to keep your source all in one area, but having two different directories in your GOPATH as suggested above will work too.</p>\n\n<p>To understand GOPATH better, you can simply type <code>go help gopath</code>.  Also a quickstart is <a href=\"https://golang.org/doc/code.html#GOPATH\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3792, "favorite_count": 0, "accepted_answer_id": 36406183, "answer_count": 1, "score": 2, "last_activity_date": 1459781997, "creation_date": 1459774229, "last_edit_date": 1459776626, "question_id": 36403187, "link": "https://stackoverflow.com/questions/36403187/go-build-cannot-find-package", "title": "&quot;go build ./...&quot; cannot find package", "body": "<p>I know internet full of similar issues and I tried all of suggested solutions, but can't figure out it at least 2 days. </p>\n\n<p>I trying to deploy little Go server I using IntelliJ IDEA and it works great, it can build/run my code, but if I use terminal as example:</p>\n\n<pre><code>go build ./...\n</code></pre>\n\n<p>I see something like that:</p>\n\n<pre><code>OS-X-Dennis:backend denis$ go build ./...\nout/production/mypocket_backend/server.go:4:2: cannot find package \"api.jwt.auth/routers\" in any of:\n        /usr/local/go/src/api.jwt.auth/routers (from $GOROOT)\n        /Users/denis/Programming/Golang/src/api.jwt.auth/routers (from $GOPATH)\n</code></pre>\n\n<p><strong>OS X 10.11.2, IntelliJ IDEA 2016.1<br>\n$GOPATH = \"Users/denis/Programming/Golang\"<br>\n$GOROOT = \"/usr/local/go\"<br>\n$PATH = \"$PATH:$GOPATH/bin\"<br></strong>\nThese paths are correct? <br></p>\n\n<p>Here is my work structure:</p>\n\n<pre><code>/Golang/\n .bin/\n .pkg/\n    .darwin-amd64/\n         .//other folders/\n .src/\n     .github.com/\n     .backend/ //project's source\n           /src\n              /api.jwt.auth/\n                //source code\n           .server.go - file with main func\n          //other files as example .gitignore\n     .//other folders// \n</code></pre>\n\n<p>Here is my screen of main file and whole project-structure:\n<a href=\"https://i.stack.imgur.com/DKsU3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DKsU3.png\" alt=\"enter image description here\"></a></p>\n\n<p>I see that logs show me wrong path to my project.</p>\n\n<pre><code> now\n /Users/denis/Programming/Golang/src/api.jwt.auth/routers\nshould\n /Users/denis/Programming/Golang/src/backend/src/api.jwt.auth/routers\n</code></pre>\n\n<p>I don't know where I should correct this path.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1459752825, "post_id": 36394778, "comment_id": 60409067, "body": "Duplicate. The Tour of Go explains all this pretty well. Take it."}], "answers": [{"comments": [{"owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "edited": false, "score": 0, "creation_date": 1459746966, "post_id": 36394921, "comment_id": 60406582, "body": "But what if it&#39;s an inteface forcing me to not make it a pointer method receiver. The interface I have to adhere to requires my method be on Foo not *Foo."}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "reply_to_user": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "edited": false, "score": 0, "creation_date": 1459749547, "post_id": 36394921, "comment_id": 60407505, "body": "@AndrewArrow interface won&#39;t enforce this. If you use pointer as receiver, then you could take it as <b>the pointer</b> implements the interface. So you pass <code>&amp;Foo{}</code> instead of <code>Foo{}</code> around will do :)"}, {"owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "edited": false, "score": 0, "creation_date": 1459775704, "post_id": 36394921, "comment_id": 60423712, "body": "I get: &quot;GreenFoo does not implement ColorFoo (bar method has pointer receiver)&quot;"}, {"owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "edited": false, "score": 0, "creation_date": 1459775980, "post_id": 36394921, "comment_id": 60423923, "body": "oh, this explains it: <a href=\"http://jordanorelli.com/post/32665860244/how-to-use-interfaces-in-go\" rel=\"nofollow noreferrer\">jordanorelli.com/post/32665860244/how-to-use-interfaces-in-g&zwnj;&#8203;o</a>"}], "tags": [], "owner": {"reputation": 136, "user_id": 1414192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8c73123dc6701faf792c260d07702?s=128&d=identicon&r=PG", "display_name": "Hoseong Hwang", "link": "https://stackoverflow.com/users/1414192/hoseong-hwang"}, "is_accepted": true, "score": 5, "last_activity_date": 1459746319, "creation_date": 1459746319, "answer_id": 36394921, "question_id": 36394778, "link": "https://stackoverflow.com/questions/36394778/why-does-a-variable-in-my-struct-not-hold-its-value/36394921#36394921", "title": "Why does a variable in my struct not hold its value?", "body": "<p>You should use pointer method receiver since you're altering internal variables.\nWhen you use non-pointer method receiver for <code>incrementBar</code>, an instance of <code>Foo</code> is copied and passed to <code>incrementBar</code>. Altering <code>self</code> in <code>incrementBar</code> does not change value of <code>myFoo</code> because it's merely a copy.</p>\n\n<p>Here is a good article regarding the issue:\n<a href=\"http://nathanleclaire.com/blog/2014/08/09/dont-get-bitten-by-pointer-vs-non-pointer-method-receivers-in-golang/\" rel=\"noreferrer\">http://nathanleclaire.com/blog/2014/08/09/dont-get-bitten-by-pointer-vs-non-pointer-method-receivers-in-golang/</a></p>\n"}], "owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 36394921, "answer_count": 1, "score": 0, "last_activity_date": 1459746319, "creation_date": 1459745473, "question_id": 36394778, "link": "https://stackoverflow.com/questions/36394778/why-does-a-variable-in-my-struct-not-hold-its-value", "title": "Why does a variable in my struct not hold its value?", "body": "<p>If I have:</p>\n\n<pre><code>type Foo struct {\n  bar int\n}\n</code></pre>\n\n<p>And a method defined on Foo (notice it's not *Foo, just Foo):</p>\n\n<pre><code>func (self Foo)incrementBar() {\n  self.bar++\n}\n</code></pre>\n\n<p>Why after making a Foo and calling the method twice:</p>\n\n<pre><code>myFoo := Foo{}\nmyFoo.incrementBar()\nmyFoo.incrementBar()\n</code></pre>\n\n<p>is bar still 0 inside the incrementBar method every time myFoo calls it? i.e. it never gets to 2, each time I call incrementBar it does a ++ operation on the value 0.</p>\n"}, {"tags": ["java", "python", "go", "callback"], "answers": [{"comments": [{"owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "edited": false, "score": 0, "creation_date": 1459753364, "post_id": 36394540, "comment_id": 60409333, "body": "Please post update. I can already compile the library and call from Java but I need a callback mechanism."}, {"owner": {"reputation": 562, "user_id": 6096046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/159491fd0a65768892634800cc65d6eb?s=128&d=identicon&r=PG&f=1", "display_name": "dwks", "link": "https://stackoverflow.com/users/6096046/dwks"}, "reply_to_user": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "edited": false, "score": 0, "creation_date": 1459789361, "post_id": 36394540, "comment_id": 60433188, "body": "Do you already have all the native APIs in place for these languages? If you do it&#39;ll probably be clear how a callback is invoked."}, {"owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "edited": false, "score": 0, "creation_date": 1459794881, "post_id": 36394540, "comment_id": 60436397, "body": "No, I don&#39;t have anything developed really other than PoC libs. that said I will look at the binding frameworks and see what they have in place. I plan on interfacing using JSON to minimise complexity."}, {"owner": {"reputation": 562, "user_id": 6096046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/159491fd0a65768892634800cc65d6eb?s=128&d=identicon&r=PG&f=1", "display_name": "dwks", "link": "https://stackoverflow.com/users/6096046/dwks"}, "reply_to_user": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "edited": false, "score": 1, "creation_date": 1459815328, "post_id": 36394540, "comment_id": 60445451, "body": "Native APIs are more performant but much more complicated than JSON. If you can communicate with JSON, your life will become much easier. Decide on a language-independent serialization format and you&#39;re good to go."}, {"owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "edited": false, "score": 0, "creation_date": 1459850433, "post_id": 36394540, "comment_id": 60460494, "body": "I agree. For this project, performance isn&#39;t an issue. I need to get up and running quick. I think we may go with a local socket connection and JSON interface."}], "tags": [], "owner": {"reputation": 562, "user_id": 6096046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/159491fd0a65768892634800cc65d6eb?s=128&d=identicon&r=PG&f=1", "display_name": "dwks", "link": "https://stackoverflow.com/users/6096046/dwks"}, "is_accepted": false, "score": 4, "last_activity_date": 1459789292, "last_edit_date": 1495542677, "creation_date": 1459743791, "answer_id": 36394540, "question_id": 36394472, "link": "https://stackoverflow.com/questions/36394472/go-c-shared-library-callback-into-other-languages/36394540#36394540", "title": "Go c-shared library callback into other languages", "body": "<p>The lingua franca of interfacing between different programming languages is to go through C. You can use something like <a href=\"https://github.com/golang/go/wiki/cgo\" rel=\"nofollow noreferrer\">cgo</a> to make your Go code accessible through C, then use the C or \"native\" bindings in Python, Java, etc to invoke it.</p>\n\n<p>Usually developers only go through this much trouble for large and well-maintained projects. If you have a personal project and if performance is less of a concern, I would suggest communicating via json (for web languages) or stdout/stderr pipes (probably more what you want). You can print commands to stdout from Ruby and have your Go code process the request and report back on its stdout. It's usually possible although sometimes tricky to pipe both input and output to another program. CGI programs work this way, spawning off interpreters for other languages and piping data to that interpreter.</p>\n\n<p><strong>Update:</strong> Calling back into the Java/Python/whatever language runtime from Go is difficult if you want to pass objects; I imagine that will need to be crafted differently depending on the binding API (<a href=\"https://stackoverflow.com/questions/9630134/jni-how-to-callback-from-c-or-c-to-java\">Java</a>, <a href=\"https://docs.python.org/2/extending/extending.html#calling-python-functions-from-c\" rel=\"nofollow noreferrer\">Python</a>). Maybe you have already tackled this problem if you have the bindings in place? It might be easier if you can get away with not passing any parameters to the callback (i.e. it's basically a timer callback). Minimize the data which needs to be generated in Go and read in the other language.</p>\n"}, {"comments": [{"owner": {"reputation": 4671, "user_id": 434408, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/WQ1I9.jpg?s=128&g=1", "display_name": "a3.14_Infinity", "link": "https://stackoverflow.com/users/434408/a3-14-infinity"}, "edited": false, "score": 2, "creation_date": 1459745884, "post_id": 36394773, "comment_id": 60406218, "body": "I guess the OP is asking regarding callbacks into other languages? For eg, if we have doSomethingJava(), which is written in Java, how to invoke it from Go? Making it accessible to Go code. Using c-shared libs, Java can access Go, but if there is a callback in Java code, how to invoke it from Go code?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 4671, "user_id": 434408, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/WQ1I9.jpg?s=128&g=1", "display_name": "a3.14_Infinity", "link": "https://stackoverflow.com/users/434408/a3-14-infinity"}, "edited": false, "score": 0, "creation_date": 1459746276, "post_id": 36394773, "comment_id": 60406350, "body": "@a3.14_Infinity Hmm, it&#39;d probably work the same way you can do it to a C library but I&#39;m not 100% sure how to."}, {"owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "edited": false, "score": 0, "creation_date": 1459753428, "post_id": 36394773, "comment_id": 60409374, "body": "@OneOfOne it&#39;s tedious to research because everything links back to C code. I think I will reach out to some of the Go people at Google."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1459774876, "post_id": 36394773, "comment_id": 60423054, "body": "Go code is able to call out to C, and Go code built with <code>-buildmode=c-shared</code> is able to do that either. If the OP talks about compiling their Go code as a C-shared library, then the target PL/runtime will see it as a C code anyway and hence <i>wll appear as a C program to that Go code either.</i> Hence I think calls should work both ways."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 2, "last_activity_date": 1459745446, "creation_date": 1459745446, "answer_id": 36394773, "question_id": 36394472, "link": "https://stackoverflow.com/questions/36394472/go-c-shared-library-callback-into-other-languages/36394773#36394773", "title": "Go c-shared library callback into other languages", "body": "<p>Well, this is gonna be a mostly link-only answer, however since Go 1.5 you can produce shared libraries that you can call from C, or any language that supports that (aka python, ruby, php, etc)</p>\n\n<p><a href=\"http://blog.ralch.com/tutorial/golang-sharing-libraries/\" rel=\"nofollow\">http://blog.ralch.com/tutorial/golang-sharing-libraries/</a> </p>\n\n<ul>\n<li>this is not my link, I've briefly followed it before to make a dummy python test.</li>\n</ul>\n"}], "owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1459789292, "creation_date": 1459743274, "last_edit_date": 1459753336, "question_id": 36394472, "link": "https://stackoverflow.com/questions/36394472/go-c-shared-library-callback-into-other-languages", "title": "Go c-shared library callback into other languages", "body": "<p>I am in the process of developing a library that will be written in Go and compiled down to a <code>C shared library</code> so it can be called by languages such as <code>Python</code>, <code>Node.JS</code>, <code>Java</code> and <code>Ruby</code></p>\n\n<p>I have just realised that there will be an issue when it comes to callbacks. How can I callback into the calling code which will be at least one of the above languages? Is there a single way I can do it or will I need to implement something specific on the Go side for each language?</p>\n\n<p><strong>Update for clarity:</strong></p>\n\n<p>I am already able to build Go as a library and execute the code from other languages such as Java and Python.</p>\n\n<p>My question specifically relates to a situation where go is running something asynchronously and needs to call back into the caller (i.e. Java, Python).</p>\n"}, {"tags": ["go", "ejdb"], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 5616775, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207829879888917/picture?type=large", "display_name": "Revanth Penugonda", "link": "https://stackoverflow.com/users/5616775/revanth-penugonda"}, "edited": false, "score": 0, "creation_date": 1459742868, "post_id": 36394164, "comment_id": 60405404, "body": "Whenever I try to install it with apt-get command I get  Err <a href=\"http://ppa.launchpad.net\" rel=\"nofollow noreferrer\">ppa.launchpad.net</a> wily/main amd64 Packages                                                  404  Not Found Err <a href=\"http://ppa.launchpad.net\" rel=\"nofollow noreferrer\">ppa.launchpad.net</a> wily/main i386 Packages                                                   404  Not Found error."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1459772816, "last_edit_date": 1459772816, "creation_date": 1459740847, "answer_id": 36394164, "question_id": 36394070, "link": "https://stackoverflow.com/questions/36394070/no-such-file-or-directory-on-go-get-github-com-mkilling-goejdb/36394164#36394164", "title": "No Such file or directory on go get github.com/mkilling/goejdb", "body": "<p>You must <a href=\"https://github.com/mkilling/goejdb#prerequisites\" rel=\"nofollow\">install egbd</a>. The 'go get' command only installs prerequisites that are Go packages.</p>\n\n<p>The <a href=\"https://github.com/Softmotions/ejdb#ejdb-binary-package-installation\" rel=\"nofollow\">instructions for using apt-get are</a>:</p>\n\n<pre><code>sudo add-apt-repository ppa:adamansky/ejdb\nsudo apt-get update\nsudo apt-get install ejdb ejdb-dbg\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 341, "user_id": 5616775, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207829879888917/picture?type=large", "display_name": "Revanth Penugonda", "link": "https://stackoverflow.com/users/5616775/revanth-penugonda"}, "edited": false, "score": 0, "creation_date": 1459744494, "post_id": 36394595, "comment_id": 60405801, "body": "Whenever I try to apt-get update after &quot;add-apt-repository ppa:adamansky/ejdb&quot; I get the error Err ppa.launchpad.net wily/main amd64 Packages 404 Not Found Err ppa.launchpad.net wily/main i386 Packages 404 Not Found error"}, {"owner": {"reputation": 341, "user_id": 5616775, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207829879888917/picture?type=large", "display_name": "Revanth Penugonda", "link": "https://stackoverflow.com/users/5616775/revanth-penugonda"}, "edited": false, "score": 0, "creation_date": 1459745176, "post_id": 36394595, "comment_id": 60405986, "body": "On trying to clone I get  fatal: repository &#39;github.com/Softmotions/ejdb&#39; does not exist error"}], "tags": [], "owner": {"reputation": 411, "user_id": 4737876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tygIZ.jpg?s=128&g=1", "display_name": "Muge", "link": "https://stackoverflow.com/users/4737876/muge"}, "is_accepted": false, "score": 1, "last_activity_date": 1459744173, "creation_date": 1459744173, "answer_id": 36394595, "question_id": 36394070, "link": "https://stackoverflow.com/questions/36394070/no-such-file-or-directory-on-go-get-github-com-mkilling-goejdb/36394595#36394595", "title": "No Such file or directory on go get github.com/mkilling/goejdb", "body": "<p>I found this in <a href=\"https://github.com/mkilling/goejdb\" rel=\"nofollow noreferrer\">https://github.com/mkilling/goejdb</a>, you sure got <code>ejdb</code> installed? </p>\n\n<p><a href=\"https://i.stack.imgur.com/yfkTI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yfkTI.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://github.com/Softmotions/ejdb\" rel=\"nofollow noreferrer\">https://github.com/Softmotions/ejdb</a>\n<a href=\"https://i.stack.imgur.com/h3MrX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h3MrX.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 341, "user_id": 5616775, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207829879888917/picture?type=large", "display_name": "Revanth Penugonda", "link": "https://stackoverflow.com/users/5616775/revanth-penugonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1459772816, "creation_date": 1459740011, "question_id": 36394070, "link": "https://stackoverflow.com/questions/36394070/no-such-file-or-directory-on-go-get-github-com-mkilling-goejdb", "title": "No Such file or directory on go get github.com/mkilling/goejdb", "body": "<p>On running the command</p>\n\n<pre><code>go get github.com/mkilling/goejdb\n# github.com/mkilling/goejdb\n../../go/src/github.com/mkilling/goejdb/ejcoll.go:4:24: fatal error:     ejdb/ejdb.h: No such file or directory\n// #include &lt;ejdb/ejdb.h&gt;\n</code></pre>\n\n<p>Is the error with the package or I need any other dependency to be installed for this command.\nI am able to install Other packages with go get command </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "is_accepted": true, "score": 2, "last_activity_date": 1459739922, "last_edit_date": 1459739922, "creation_date": 1459738462, "answer_id": 36393895, "question_id": 36393806, "link": "https://stackoverflow.com/questions/36393806/why-go-vet-report-uint0-might-be-too-small-for-shift-of-63/36393895#36393895", "title": "Why go vet report uint(0) might be too small for shift of 63?", "body": "<p>This is because <code>uint</code> is not a fixed bitwise length type, it could be as short as a 32 bits, so not sufficient for you to right shift by 63.</p>\n\n<p>This is also the reason why you could use this expression to test the platform, since <code>uint</code> would take the most efficient <code>int</code> type on the platform. </p>\n\n<p>If on 32-bit platform, <code>uint</code> is 32-bit length, and thus the right shift would give <code>0</code>, which causes <code>32</code> in the end as the result of <code>32 &lt;&lt; 0</code>. But on 64-bit platform, <code>uint</code> gives 64-bit, and thus right shift 63 bits would give you <code>1</code> instead of <code>0</code>, which results in <code>64</code> at the end since <code>32 &lt;&lt; 1</code> gives <code>64</code>.</p>\n\n<p>Take a look at the source code of vet:</p>\n\n<pre><code>71      case types.Int, types.Uint, types.Uintptr:\n72          // These types may be as small as 32 bits, but no smaller.\n73          size = 32\n74          msg = \"might be \"\n...\n78      if amt &gt;= size {\n79          ident := f.gofmt(x)\n80          f.Badf(node.Pos(), \"%s %stoo small for shift of %d\", ident, msg, amt)\n81      }\n</code></pre>\n\n<p>That is to say, as long as you are using uint and right shift by 63 bits, with <code>go vet</code> checking <code>shift</code>, there's no way to escape the check. You could try to skip that by providing the flag to check:</p>\n\n<pre><code>go tool vet -shift=false yourfile.go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1509805999, "last_edit_date": 1592644375, "creation_date": 1509805999, "answer_id": 47111815, "question_id": 36393806, "link": "https://stackoverflow.com/questions/36393806/why-go-vet-report-uint0-might-be-too-small-for-shift-of-63/47111815#47111815", "title": "Why go vet report uint(0) might be too small for shift of 63?", "body": "<blockquote>\n<p>Why does go vet show me that warnings? How can I prevent it?</p>\n</blockquote>\n<p>nevets's answer proposed:</p>\n<blockquote>\n<p>You could try to skip that by providing the flag to check:</p>\n</blockquote>\n<pre><code>go tool vet -shift=false yourfile.go\n</code></pre>\n<p>But: You should not use <code>go tool vet</code>. Only <code>go vet</code>. Or in this case, only because you need to pass a flag.</p>\n<p>However, starting go 1.10 (Q1 2018), that will change: see <a href=\"https://groups.google.com/forum/#!msg/golang-dev/qfa3mHN4ZPA/X2UzjNV1BAAJ\" rel=\"nofollow noreferrer\">this thread</a>:</p>\n<blockquote>\n<p><strong>Do not use &quot;<code>go tool vet</code>&quot;, which is essentially only useful to people working on <code>vet</code></strong> (just like you don't typically run &quot;<code>go tool compile</code>&quot;).</p>\n<p>Previously you needed to use &quot;<code>go tool vet</code>&quot; if you wanted control over vet flags, but <strong>&quot;<code>go vet</code>&quot; now accepts all the flags that &quot;<code>go tool vet</code>&quot; does</strong>. (See &quot;<code>go help vet</code>&quot;.)</p>\n</blockquote>\n<p>So <code>go vet -shift=false yourfile.go</code> should be enough.</p>\n"}], "owner": {"reputation": 2373, "user_id": 2218718, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/12e3ba20337c7021f2e115688a681652?s=128&d=identicon&r=PG", "display_name": "cuonglm", "link": "https://stackoverflow.com/users/2218718/cuonglm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 1, "accepted_answer_id": 36393895, "answer_count": 2, "score": 0, "last_activity_date": 1509805999, "creation_date": 1459737597, "question_id": 36393806, "link": "https://stackoverflow.com/questions/36393806/why-go-vet-report-uint0-might-be-too-small-for-shift-of-63", "title": "Why go vet report uint(0) might be too small for shift of 63?", "body": "<p><a href=\"https://github.com/adonovan/gopl.io/\" rel=\"nofollow\">The Go Programming Language book</a>, exercise 6.5, the author told us using this expression:</p>\n\n<pre><code>32 &lt;&lt; (^uint(0) &gt;&gt; 63)\n</code></pre>\n\n<p>to check whether the platform is 32-bit or 64-bit.</p>\n\n<p>The expression is quite clear, and we can check the result with a simple code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(32 &lt;&lt; (^uint(0) &gt;&gt; 63))\n}\n</code></pre>\n\n<p>The code print <code>0</code> on 32-bit platform and <code>64</code> on 64-bit platform.</p>\n\n<p>However, using <code>go vet</code> with the file, I receive the warning:</p>\n\n<pre><code>$ go vet ex6-5.go \nex6-5.go:6: ^uint(0) might be too small for shift of 63\nexit status 1\n</code></pre>\n\n<p>Why does <code>go vet</code> show me that warnings? How can I prevent it?</p>\n"}, {"tags": ["pointers", "go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 0, "last_activity_date": 1459730745, "creation_date": 1459730745, "answer_id": 36393048, "question_id": 36392977, "link": "https://stackoverflow.com/questions/36392977/return-type-as-same-as-struct-golang/36393048#36393048", "title": "Return type as same as struct golang", "body": "<p>Yes, just return a value of <code>Race</code> instead of <code>*Race</code>:</p>\n\n<pre><code>func LoadClass(path string) Race {\n\n    // read file to []byte\n\n    jsonClass := new(Race)\n    _ = json.Unmarshal(bytes, jsonClass)\n\n    // return the value jsonClass points to\n    return *jsonClass\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "edited": false, "score": 1, "creation_date": 1459732977, "post_id": 36393268, "comment_id": 60403305, "body": "This blows my mind, i didn&#39;t know that we can have named return in function declaration"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1459732782, "creation_date": 1459732782, "answer_id": 36393268, "question_id": 36392977, "link": "https://stackoverflow.com/questions/36392977/return-type-as-same-as-struct-golang/36393268#36393268", "title": "Return type as same as struct golang", "body": "<p>You can pass a pointer to the variable to Unmarshal and just return the variable.</p>\n\n<pre><code>func LoadClass(path string) (race Race) {\n    bytes, err := ioutil.ReadFile(path)\n    if err != nil {\n        panic(err)\n    }\n    if err = json.Unmarshal(bytes, &amp;race); err != nil {\n        panic(err)\n    }\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 6058631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/80f2cff0a0888497bd7ef323cbc1d4c5?s=128&d=identicon&r=PG&f=1", "display_name": "XXX", "link": "https://stackoverflow.com/users/6058631/xxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 36393268, "answer_count": 2, "score": -1, "last_activity_date": 1459740131, "creation_date": 1459730095, "last_edit_date": 1459740131, "question_id": 36392977, "link": "https://stackoverflow.com/questions/36392977/return-type-as-same-as-struct-golang", "title": "Return type as same as struct golang", "body": "<p>I have a struct :</p>\n\n<pre><code>type Race struct {\n    Name    string `json:\"Name\"`\n    About   string `json:\"About\"`\n    Health  int    `json:\"Health\"`\n    Attacks []Move `json:\"Attacks\"`\n}\n</code></pre>\n\n<p>and a function that loads the struct:</p>\n\n<pre><code>func LoadClass(path string) *Race {\n    bytes, err := ioutil.ReadFile(path)\n    if err != nil {\n        panic(err)\n    }\n    jsonClass := &amp;Race{}\n    err = json.Unmarshal(bytes, jsonClass)\n    //decodes it\n    if err != nil {\n        panic(err)\n    }\n    return jsonClass\n}\n</code></pre>\n\n<p>is there a way to make <code>jsonClass</code> of type <code>Race</code> and not <code>*Race</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 2, "creation_date": 1459720581, "post_id": 36391664, "comment_id": 60400295, "body": "instead of ignoring the error with <code>_</code>, why not assign it <code>err</code> and paste the error message here?"}, {"owner": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "edited": false, "score": 0, "creation_date": 1459721005, "post_id": 36391664, "comment_id": 60400422, "body": "I edited my original post with the error i get"}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 25, "last_activity_date": 1543327452, "last_edit_date": 1543327452, "creation_date": 1459721462, "answer_id": 36391858, "question_id": 36391664, "link": "https://stackoverflow.com/questions/36391664/convert-string-to-float32/36391858#36391858", "title": "Convert string to float32?", "body": "<p><code>float</code> has the type <code>float32</code>, but <a href=\"https://godoc.org/strconv#ParseFloat\" rel=\"noreferrer\"><code>strconv.ParseFloat</code></a> returns <code>float64</code>. All you need to do is convert the result:</p>\n\n<pre><code>// \"var float float32\" up here somewhere\nvalue, err := strconv.ParseFloat(myString, 32)\nif err != nil {\n    // do something sensible\n}\nfloat = float32(value)\n</code></pre>\n\n<p>Depending on the situation, it may be better to change <code>float</code>'s type to <code>float64</code>.</p>\n"}], "owner": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14151, "favorite_count": 2, "accepted_answer_id": 36391858, "answer_count": 1, "score": 18, "last_activity_date": 1543327452, "creation_date": 1459720324, "last_edit_date": 1487943379, "question_id": 36391664, "link": "https://stackoverflow.com/questions/36391664/convert-string-to-float32", "title": "Convert string to float32?", "body": "<p>There is an input that I need to read from the console as a string, then manipulate the string and convert some of it to <code>float32</code>.</p>\n\n<p>I have tried using:</p>\n\n<pre><code>float, _ := strconv.ParseFloat(myString, 32)\n</code></pre>\n\n<p>But it does not work. This is the error I get:</p>\n\n<blockquote>\n  <p>cannot use float (type float64) as type float32 in field value</p>\n</blockquote>\n\n<p>Is there anything else I could do?\nThanks!</p>\n"}, {"tags": ["go", "memory", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 1734, "user_id": 271996, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MuIHF.jpg?s=128&g=1", "display_name": "honzajde", "link": "https://stackoverflow.com/users/271996/honzajde"}, "edited": false, "score": 0, "creation_date": 1459719572, "post_id": 36391486, "comment_id": 60399969, "body": "Yes, the gist was about something completely else - as you describe in your second paragraph. But if I am wrong where I am wrong then?."}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 5, "last_activity_date": 1459719227, "creation_date": 1459719227, "answer_id": 36391486, "question_id": 36391421, "link": "https://stackoverflow.com/questions/36391421/explain-dont-communicate-by-sharing-memory-share-memory-by-communicating/36391486#36391486", "title": "Explain: Don&#39;t communicate by sharing memory; share memory by communicating", "body": "<p>I don't think so.  The gist is instead of protecting one fixed memory address with a lock or other concurrent primitives, you can architect the program in a way that only one stream of execution is allowed to access this memory <em>by design</em>. </p>\n\n<p>The easy way to achieve this is to share the reference to the memory by channels. \nOnce you send the reference over the channel you <em>forget it</em>. In this way only the routine that will consume that channel will have access to it.  </p>\n"}, {"comments": [{"owner": {"reputation": 1734, "user_id": 271996, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MuIHF.jpg?s=128&g=1", "display_name": "honzajde", "link": "https://stackoverflow.com/users/271996/honzajde"}, "edited": false, "score": 0, "creation_date": 1459757108, "post_id": 36391868, "comment_id": 60411397, "body": "Thanks for your contributiuon @SirDarius. So far this question I asked is causing me lots of fun:) I hope to everyone else too. But, is your answer to my questions 1) No 2) No ?"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 1734, "user_id": 271996, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MuIHF.jpg?s=128&g=1", "display_name": "honzajde", "link": "https://stackoverflow.com/users/271996/honzajde"}, "edited": false, "score": 0, "creation_date": 1459762183, "post_id": 36391868, "comment_id": 60414409, "body": "I would say, yes, and yes, even though I&#39;m not sure the phrasing of your conclusion sounds &quot;idiomatic&quot; for Go developers, if you see what I mean. The thing that is missing is essentially the notion of passing of ownership."}, {"owner": {"reputation": 1734, "user_id": 271996, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MuIHF.jpg?s=128&g=1", "display_name": "honzajde", "link": "https://stackoverflow.com/users/271996/honzajde"}, "edited": false, "score": 0, "creation_date": 1507023391, "post_id": 36391868, "comment_id": 80037078, "body": "This part in your answer is really misleading: &quot;...and give away ownership by sending the value or a pointer to the value to a different goroutine via the channel mechanism&quot; - there is not concept of ownership in go and in fact supposing so leads to race condition if sending goroutine modifies data again."}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 1734, "user_id": 271996, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MuIHF.jpg?s=128&g=1", "display_name": "honzajde", "link": "https://stackoverflow.com/users/271996/honzajde"}, "edited": false, "score": 1, "creation_date": 1507024650, "post_id": 36391868, "comment_id": 80037854, "body": "Since there is effectively no notion of ownership, this is down to best practices indeed, which you stated your question is not about. However I&#39;d argue that &quot;share memory by communicating&quot; is a guideline for best practices, specifically, <i>don&#39;t reuse variables that you sent through a  channel</i>."}], "tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": false, "score": 25, "last_activity_date": 1459721527, "creation_date": 1459721527, "answer_id": 36391868, "question_id": 36391421, "link": "https://stackoverflow.com/questions/36391421/explain-dont-communicate-by-sharing-memory-share-memory-by-communicating/36391868#36391868", "title": "Explain: Don&#39;t communicate by sharing memory; share memory by communicating", "body": "<p>This famous quote can be a little bit confusing if taken too litterally. Let's break it down to its more basic components, and define them properly:</p>\n\n<pre><code>Don't communicate by sharing memory; share memory by communicating\n      ---- 1 ----    ------ 2 -----  ---- 3 -----    ----- 4 -----\n</code></pre>\n\n<ol>\n<li>This means that different threads of execution would be informed of the change of state of other threads by reading memory that would be modified somewhere else.\nA perfect example of this (although for processes instead of threads) is the POSIX shared memory API: <a href=\"http://man7.org/linux/man-pages/man7/shm_overview.7.html\" rel=\"noreferrer\">http://man7.org/linux/man-pages/man7/shm_overview.7.html</a>.\nThis technique needs proper synchronization because data races can occur pretty easily.</li>\n<li>Here this means that there is indeed a portion of memory, physical or virtual, that can be modified from several threads, and read from those, too. There is no explicit notion of ownership, the memory space is equally accessible from all threads.</li>\n<li>This is entirely different. In Go, sharing memory just like above is possible, and data races can occur pretty easily, so what this actually means is, modifying a variable in a goroutine, be it a simple value like an <code>int</code> or a complicated data structure like a map, and give away ownership by sending the value or a pointer to the value to a different goroutine via the channel mechanism. So ideally, there is no shared space, each goroutine only sees the portion of memory it owns.</li>\n<li>Communication here simply means that a channel, which is only a queue, allows one goroutine to read from it and so be notified of the ownership of a new portion of memory, while another one sends it and accepts to lose ownership. It is a simple message passing pattern.</li>\n</ol>\n\n<p>In conclusion, what the quote means can be summed up like this:</p>\n\n<blockquote>\n  <p>Don't overengineer inter-thread communication by using shared memory and complicated, error-prone synchronisation primitives, but instead use message-passing between goroutines (green threads) so variables and data can be used in sequence between those.</p>\n</blockquote>\n\n<p>The use of the word sequence here is noteworthy, because it describes the philosophy that inspired the concept of goroutines and channels: <a href=\"https://en.wikipedia.org/wiki/Communicating_sequential_processes\" rel=\"noreferrer\">Communicating Sequential Processes</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1734, "user_id": 271996, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MuIHF.jpg?s=128&g=1", "display_name": "honzajde", "link": "https://stackoverflow.com/users/271996/honzajde"}, "edited": false, "score": 0, "creation_date": 1459759573, "post_id": 36392066, "comment_id": 60412806, "body": "So far this addresses most the point of my question. Thx. Still waiting for Rob P. to say his part though:)"}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 11, "last_activity_date": 1459722865, "creation_date": 1459722865, "answer_id": 36392066, "question_id": 36391421, "link": "https://stackoverflow.com/questions/36391421/explain-dont-communicate-by-sharing-memory-share-memory-by-communicating/36392066#36392066", "title": "Explain: Don&#39;t communicate by sharing memory; share memory by communicating", "body": "<p>In essence, yes. Any values that are assigned to variables before the channel send are eligible to be observed after the channel read, since the channel operation imposes an ordering constraint. But it's important to remember the other part of the equation: if you want to <em>guarantee</em> that those values are observed, you have to make sure that no one else can write to those variables in between the write and the read. Obviously using locks would be possible, but pointless at the same time because if you're already combining locks and cross-thread memory modification, what benefit are you getting from channels? You could pass around something as simple as a boolean, as a token allowing exclusive access to the global data, and it would be 100% correct in terms of the memory model guarantees (as long as your code didn't have bugs), <em>it would just probably be a bad design</em> because you would be making things all implicit and action-at-a-distance-y without a good reason; passing the data explicitly is usually going to be clearer and less error-prone. </p>\n"}, {"comments": [{"owner": {"reputation": 1734, "user_id": 271996, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MuIHF.jpg?s=128&g=1", "display_name": "honzajde", "link": "https://stackoverflow.com/users/271996/honzajde"}, "edited": false, "score": 0, "creation_date": 1459759677, "post_id": 36392434, "comment_id": 60412862, "body": "Thanks for pointing out buffered channels! I have updated my question so that it is obvious that I was assuming unbuffered channels in the first place."}], "tags": [], "owner": {"reputation": 1220, "user_id": 366254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b19b02a49b433c9e2e6e6c43785d2bfb?s=128&d=identicon&r=PG", "display_name": "raggi", "link": "https://stackoverflow.com/users/366254/raggi"}, "is_accepted": false, "score": 2, "last_activity_date": 1459725320, "creation_date": 1459725320, "answer_id": 36392434, "question_id": 36391421, "link": "https://stackoverflow.com/questions/36391421/explain-dont-communicate-by-sharing-memory-share-memory-by-communicating/36392434#36392434", "title": "Explain: Don&#39;t communicate by sharing memory; share memory by communicating", "body": "<blockquote>\n  <p>1) Is my conclusion correct?</p>\n</blockquote>\n\n<p>I think so, if it means what I hope it does. The reason for the language in the specs using the \"happenstance\" terminology is that it provides a well defined form of communication for expressing ideas.</p>\n\n<p>The problem with your description is that you haven't actually explicitly defined your happenstance order. I think though that you are implying an order. If you mean that \"operations in goroutine a that happen before goroutine a operates on a particular point of synchronization will be visible by goroutine b after goroutine b has also observed that same point of synchronization\" - even here though, the \"point of synchronization\" is poorly defined - though I expect you understand it. Such a point can be defined in happenstance, as the specification does.</p>\n\n<blockquote>\n  <p>2) Does my explanation help?</p>\n</blockquote>\n\n<p>Maybe, people unfamiliar with the topic or that are struggling with understanding the happenstance style of description may find your description easier to interpret. There are however limitations and potential practical problems in the application your description, as follows:</p>\n\n<ul>\n<li>You have not strictly defined that the \"send\" you are talking about is a synchronization point. If you mean a send on an unbuffered channel, then yes, that will create a shared synchronization point that by specification introduces a strict happenstance order.</li>\n<li>While, assuming the above is true, you have described a synchronization point, this only addresses one side of the point of the original advice. The original advice includes the concept of \"transfer of ownership\", and that has less to do with creating synchronization points or happenstance, and more to do with the longer term maintenance of code that relies on potentially shared memory. The concept is that instead of retaining access to some segment of memory in two places, and creating separate shared synchronization points (like mutexes), one can instead pass, possibly the only, reference to the object from one owner to another. Designing software this way prevents the accidental modification outside of synchronization points, which has often been observed in software with granular use of mutexes and extensive use of shared memory.</li>\n</ul>\n\n<p>Mutexes or \"explicit synchronization points\" are exactly the opposite of the advice - they are a shared piece of memory that is used to communicate a synchronization point \"communicate by sharing memory\", whereas, even though they have mutexes deep under the hood, channels are an abstract mechanism to pass ownership of an object (the sent value) from one goroutine (sender) to another goroutine (receiver). The point there is, ignoring how channels are implemented, that the user has shared memory (the value) by communicating it from one owner (goroutine a) to another (goroutine b). If you are using a channel to send unrelated data to create a synchronization point, you're essentially using it as a mutex, and this is closer to communicate by sharing memory (focus on the channel), rather than sharing by communicating (focus on the value).</p>\n\n<p>I hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 4584004, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/78b84adfa9c7b4f87fff834b97e6f0a8?s=128&d=identicon&r=PG&f=1", "display_name": "nawazish-stackoverflow", "link": "https://stackoverflow.com/users/4584004/nawazish-stackoverflow"}, "is_accepted": false, "score": 4, "last_activity_date": 1475689314, "creation_date": 1475689314, "answer_id": 39880487, "question_id": 36391421, "link": "https://stackoverflow.com/questions/36391421/explain-dont-communicate-by-sharing-memory-share-memory-by-communicating/39880487#39880487", "title": "Explain: Don&#39;t communicate by sharing memory; share memory by communicating", "body": "<p>There are two sentences in this; for fuller understanding these must be looked separately first, and then clubbed together, So:\n<code>Don't communicate by sharing memory;</code> means, different threads should not communicate with each other by complying to the stringent and error-prone memory visibility and synchronization policies like memory barrier etc. (Note that it can be done, but it can soon become complex and very buggy with data races). So avoid complying to manual, programmatic visibility constructs mostly attained thru proper synchronizations in programming languages like Java.</p>\n\n<p><code>share memory by communicating.</code> means if one thread has made any changes (writes) to a memory area, it should communicate the same (the memory area) to the thread interested in that same memory area; note this has already restricted the scope of memory to only two threads.</p>\n\n<p>Now read the above two paragraphs in conjunction with the golang memory model which says, <code>A send on a channel happens before the corresponding receive from that channel completes.</code> The happens-before relationship confirms that the write by first goroutine will-be visible to the second goroutine receiving the memory reference at the other end of the channel! </p>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 4, "last_activity_date": 1497189054, "creation_date": 1497189054, "answer_id": 44484602, "question_id": 36391421, "link": "https://stackoverflow.com/questions/36391421/explain-dont-communicate-by-sharing-memory-share-memory-by-communicating/44484602#44484602", "title": "Explain: Don&#39;t communicate by sharing memory; share memory by communicating", "body": "<p>Let me go simple and to the point here.</p>\n\n<blockquote>\n  <p>Don't communicate by sharing memory.</p>\n</blockquote>\n\n<p>It is like when your are communicating using threads for example you have to use variables or mutexes to lock memory for not allowing someone to read and write on it until the communication is complete.</p>\n\n<blockquote>\n  <p>Share memory by communicating</p>\n</blockquote>\n\n<p>In go routines values move on channels rather than blocking the memory, sender notifies receiver to receive from that channel and hence it share memory by communicating with receiver to get from a channel.</p>\n"}, {"tags": [], "owner": {"reputation": 6948, "user_id": 3046585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JRpC2.png?s=128&g=1", "display_name": "Ludovic Aubert", "link": "https://stackoverflow.com/users/3046585/ludovic-aubert"}, "is_accepted": false, "score": 0, "last_activity_date": 1612215388, "creation_date": 1612215388, "answer_id": 66000489, "question_id": 36391421, "link": "https://stackoverflow.com/questions/36391421/explain-dont-communicate-by-sharing-memory-share-memory-by-communicating/66000489#66000489", "title": "Explain: Don&#39;t communicate by sharing memory; share memory by communicating", "body": "<ol>\n<li><p>communicate by sharing memory:\nthis is the &quot;traditional&quot; way to deal with multithreading. If some data is shared by two threads, to keep them from for example attempting to write both at the same time, some synchronization primitives must be used. This is notoriously difficult to debug. It is interesting to keep in mind that in time sharing, the processor is allocating a time slice (for example 100ms) to one thread, and then switches context, and allocates the next time slice to another thread. The switch happens while the operating system has no knowledge of what the code run by the threads is doing. If operations aren't atomic, they can be interrupted by the operating system at any step.</p>\n</li>\n<li><p>share memory by communicating:\nTypically, this is the case using an actor model where each actor is mapped to a processor core. Actors exchange messages using a mailbox system where the receiver receives a copy of the message. There is no shared data, so no need for synchronization mechanisms like mutexes. Another name for this architecture is &quot;shared nothing&quot;.</p>\n</li>\n</ol>\n"}], "owner": {"reputation": 1734, "user_id": 271996, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MuIHF.jpg?s=128&g=1", "display_name": "honzajde", "link": "https://stackoverflow.com/users/271996/honzajde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9826, "favorite_count": 16, "accepted_answer_id": 36392066, "answer_count": 7, "score": 32, "last_activity_date": 1612215388, "creation_date": 1459718907, "last_edit_date": 1531402886, "question_id": 36391421, "link": "https://stackoverflow.com/questions/36391421/explain-dont-communicate-by-sharing-memory-share-memory-by-communicating", "title": "Explain: Don&#39;t communicate by sharing memory; share memory by communicating", "body": "<p>I wonder what is the most down to earth explanation of this famous quote:</p>\n\n<blockquote>\n  <p>Don't communicate by sharing memory; share memory by communicating. (R. Pike)</p>\n</blockquote>\n\n<p>In <a href=\"https://golang.org/ref/mem\" rel=\"noreferrer\">The Go Memory Model</a> I can read this: </p>\n\n<blockquote>\n  <p>A send on a channel happens before the corresponding receive from that channel completes. (Golang Spec)</p>\n</blockquote>\n\n<p>There is also a dedicated <a href=\"https://blog.golang.org/share-memory-by-communicating\" rel=\"noreferrer\">golang article</a> explaining the quote. And key contribution is a <a href=\"https://golang.org/doc/codewalk/sharemem/\" rel=\"noreferrer\">working example</a> also by Andrew G.</p>\n\n<p>Well. Sometimes too much talking around .... I have derived from the Memory Spec quotation and also by looking at the working example this: </p>\n\n<blockquote>\n  <p>After a goroutine1 sends (anything) to a goroutine2 via a channel, then all changes (anywhere in the memory) done by goroutine1 must be visible to goroutine2 after it received via same channel. (Golang Lemma by Me:)</p>\n</blockquote>\n\n<p>Therfore I derive the Down to earth explanation of the famous quote:</p>\n\n<blockquote>\n  <p>To synchronize memory access between two goroutines, you don't need to send that memory via channel. Good enough is to receive from the channel (even nothing). You will see any changes that were written (anywhere) by the goroutine sending (to the channel) at the time of it's send. (Of course, assuming no other goroutines are writing to the same memory.) <strong>Update (2) 8-26-2017</strong></p>\n</blockquote>\n\n<p>I have actually two questions:</p>\n\n<p><strong>1) Is my conclusion correct?</strong></p>\n\n<p><strong>2) Does my explanation help?</strong>  </p>\n\n<p><strong>Update (1)</strong>\nI am assuming <em>unbuffered channels</em>. Lets restrict ourselves to that first to avoid overhauling ourselves with too many unknowns.</p>\n\n<p>Please, let's also focus on a simple usecase of two goroutines communicating over a single channel and related memory effects and not on the best practices - that is beyond the scope of this question. </p>\n\n<p>To better understand scope of my question assume that the goroutines may access  any kind of memory structure - not only primitve ones - and it can be a large one, it can be a string, map, array, whatever.   </p>\n"}, {"tags": ["go", "pluralize"], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 2128746, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lQXxz.jpg?s=128&g=1", "display_name": "Hasit Mistry", "link": "https://stackoverflow.com/users/2128746/hasit-mistry"}, "edited": false, "score": 0, "creation_date": 1459720916, "post_id": 36391220, "comment_id": 60400392, "body": "Thank you for sharing the links. The second link sets me on the right track."}], "tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": true, "score": 3, "last_activity_date": 1459751403, "last_edit_date": 1459751403, "creation_date": 1459717779, "answer_id": 36391220, "question_id": 36391147, "link": "https://stackoverflow.com/questions/36391147/find-if-a-word-is-plural-of-another/36391220#36391220", "title": "Find if a word is plural of another", "body": "<p>What you are looking for is called <strong>inflections</strong>. Basically, it is the black art of determining the various forms of a word, in particular singular from plural, or the opposite.</p>\n\n<p>There are libraries for this, mostly inspired from the Ruby On Rails <code>ActiveSupport::Inflector</code> system, see for example <a href=\"https://github.com/jinzhu/inflection\" rel=\"nofollow\">https://github.com/jinzhu/inflection</a>.</p>\n\n<p>Also see <a href=\"http://www.csse.monash.edu.au/~damian/papers/HTML/Plurals.html\" rel=\"nofollow\">http://www.csse.monash.edu.au/~damian/papers/HTML/Plurals.html</a> for a very interesting read about algorithms for english pluralization.</p>\n"}], "owner": {"reputation": 189, "user_id": 2128746, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lQXxz.jpg?s=128&g=1", "display_name": "Hasit Mistry", "link": "https://stackoverflow.com/users/2128746/hasit-mistry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 36391220, "answer_count": 1, "score": 0, "last_activity_date": 1459751403, "creation_date": 1459717355, "question_id": 36391147, "link": "https://stackoverflow.com/questions/36391147/find-if-a-word-is-plural-of-another", "title": "Find if a word is plural of another", "body": "<p>I am writing a program in Go to generate a report of crimes in my University. I have run into a roadblock where I need to find if one word is a plural of another. I am making a map of crimes first</p>\n\n<pre><code>crimes := make(map[string]int)\n</code></pre>\n\n<p>then, adding crimes to the map with the number of occurrences as int</p>\n\n<pre><code>for i := 0; i &lt; len(feed.Items); i++ {\n  crimes[feed.Items[i].Title[11:]]++\n}\n</code></pre>\n\n<p>Now, the problem arises when there are entries like, \"Armed Robberies (with a count of 1)\" and \"Armed Robbery (with a count of 2)\". I want to check if a word is a plural of another. In this case, I want to make a single entry for \"Armed Robbery (with a count of 3)\". I could not find a package for doing this. Is there a way to do this?</p>\n"}, {"tags": ["javascript", "string", "go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1459785471, "post_id": 36391058, "comment_id": 60430803, "body": "Note that the Go&#39;s snippet is not quite equivalent to that in JS: try your JS code with <code>str1</code> set to &quot;false&quot;.  What I actually want to say is that when I forced to write JS, I do it much like I would do it in Go; so I&#39;d write your snippet something like <code>var str3 = str1 === &quot;&quot; ? str2 : str1</code>"}, {"owner": {"reputation": 1671, "user_id": 325358, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/eb58709dc08423fc567de3a3225b23c9?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/325358/ivan"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1459785707, "post_id": 36391058, "comment_id": 60430957, "body": "But there is no shorthand if in Go, right?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1459788634, "post_id": 36391058, "comment_id": 60432757, "body": "Luckily, no, there isn&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1459717575, "creation_date": 1459717575, "answer_id": 36391182, "question_id": 36391058, "link": "https://stackoverflow.com/questions/36391058/is-there-an-equivalent-of-this-js-expression-in-go/36391182#36391182", "title": "Is there an equivalent of this JS expression in Go?", "body": "<blockquote>\n  <p>Is there an equivalent expression as the one in JS?</p>\n</blockquote>\n\n<p>No, but if you find yourself doing this often, you could write a function that does what you're trying to accomplish:</p>\n\n<pre><code>func strs(s ...string) string {\n    if len(s) == 0 {\n        return \"\"\n    }\n    for _, str := range s[:len(s)-1] {\n        if str != \"\" {\n            return str\n        }\n    }\n    return s[len(s)-1]\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>str3 := strs(str1, str2)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Gl_06XDjW4\" rel=\"nofollow\">https://play.golang.org/p/Gl_06XDjW4</a></p>\n"}, {"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 0, "last_activity_date": 1459717843, "creation_date": 1459717843, "answer_id": 36391231, "question_id": 36391058, "link": "https://stackoverflow.com/questions/36391058/is-there-an-equivalent-of-this-js-expression-in-go/36391231#36391231", "title": "Is there an equivalent of this JS expression in Go?", "body": "<p>There is no equivalent operation in Go. You have to do it with an if (or a switch, but that's even more verbose). I would write it like this:</p>\n\n<pre><code>var str3 string\nif str1 != \"\" {\n    str3 = str1\n} else {\n    str3 = str2\n}\n</code></pre>\n"}], "owner": {"reputation": 1671, "user_id": 325358, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/eb58709dc08423fc567de3a3225b23c9?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/325358/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 36391182, "answer_count": 2, "score": 1, "last_activity_date": 1459717843, "creation_date": 1459716863, "question_id": 36391058, "link": "https://stackoverflow.com/questions/36391058/is-there-an-equivalent-of-this-js-expression-in-go", "title": "Is there an equivalent of this JS expression in Go?", "body": "<p>Let's say we have 2 strings, str1 and str2. I want a new variable str3 to equal str1, or if str1 is empty then equal str2.</p>\n\n<p>In JS I would write:</p>\n\n<pre><code>var str3 = str1 || str2\n</code></pre>\n\n<p>While in Go I have to do it like:</p>\n\n<pre><code>str3 := str1\nif str1 == \"\" {\n    str3 = str2\n}\n</code></pre>\n\n<p>which is a little bit too verbose imo.\nIs there an equivalent expression as the one in JS?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 3, "creation_date": 1459711671, "post_id": 36389613, "comment_id": 60396871, "body": "I re-read that few times and I still don&#39;t understand what you&#39;re trying to do, maybe add an example pseudo code (or php or any other language you&#39;re familiar with)."}, {"owner": {"reputation": 67, "user_id": 5262581, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/627081a297aced294e4be065ac65a01f?s=128&d=identicon&r=PG&f=1", "display_name": "cmelone", "link": "https://stackoverflow.com/users/5262581/cmelone"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1459719319, "post_id": 36389613, "comment_id": 60399888, "body": "@OneOfOne please see my edit above."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5262581, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/627081a297aced294e4be065ac65a01f?s=128&d=identicon&r=PG&f=1", "display_name": "cmelone", "link": "https://stackoverflow.com/users/5262581/cmelone"}, "edited": false, "score": 0, "creation_date": 1459721331, "post_id": 36391819, "comment_id": 60400536, "body": "Thanks. I will try this out when I get home."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 0, "last_activity_date": 1459721176, "creation_date": 1459721176, "answer_id": 36391819, "question_id": 36389613, "link": "https://stackoverflow.com/questions/36389613/writing-two-parts-of-a-string-in-golang/36391819#36391819", "title": "Writing two parts of a string in golang", "body": "<p>If I understand you correctly, all you need to do is </p>\n\n<pre><code>msg := &amp;Message{\n    Email:   r.FormValue(\"email\"),\n    Content: \"Message: \" + r.FormValue(\"content\"),\n}\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 5262581, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/627081a297aced294e4be065ac65a01f?s=128&d=identicon&r=PG&f=1", "display_name": "cmelone", "link": "https://stackoverflow.com/users/5262581/cmelone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1459721176, "creation_date": 1459709140, "last_edit_date": 1459719290, "question_id": 36389613, "link": "https://stackoverflow.com/questions/36389613/writing-two-parts-of-a-string-in-golang", "title": "Writing two parts of a string in golang", "body": "<p>I am just learning golang, and yesterday I created a pretty simple contact form. I just has the user put in their email address and write a simple message. This is how it gets sent in the email:</p>\n\n<pre><code>msg := &amp;Message{\n    Email:   r.FormValue(\"email\"),\n    Content: r.FormValue(\"content\"),\n}\n</code></pre>\n\n<p>When I get the email, all I get is the content of the message. I am looking to add a lot more fields. So in order for it not to get confusing, I want there to be something like <code>Message:</code> in front of <code>r.FormValue(\"content\"),</code>. This would be something to make the emails more organized.</p>\n\n<p><strong>EDIT</strong>: I am so sorry for the confusion, I wrote this in a rush. So basically I have a golang contact form that asks for the users email address and a message. When they hit submit, I get an email that has their address in the subject, and the message in the body. Lets say they put something like: \"Hey, my name is Joe, and I would like to get in touch\". I would get those same exact words in the body of the email. I am looking to add more textareas, so in order for me not to get confused, it would be great if in front of the message it would say <code>Message:</code>. The whole email body would look like this:</p>\n\n<p>Message: Hey, my name is Joe, and I would like to get in touch.</p>\n\n<p>I am using <code>r.FormValue(\"content\"),</code> to get the contents of the message, now I need a way to add the string <code>Message:</code> in front of it. </p>\n\n<p>Please let me know if you want me to explain it better.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 6, "last_activity_date": 1459698517, "last_edit_date": 1459698517, "creation_date": 1459697993, "answer_id": 36387465, "question_id": 36387416, "link": "https://stackoverflow.com/questions/36387416/go-converting-string-to-float-using-strconv-parsefloat-returns-0/36387465#36387465", "title": "Go: converting string to float using strconv.ParseFloat returns 0", "body": "<p>Replace </p>\n\n<pre><code>result := strings.Split(inStr, \"x\")\n</code></pre>\n\n<p>with</p>\n\n<pre><code>result := strings.Split(strings.TrimSpace(inStr), \"x\")\n</code></pre>\n\n<p>As string contains <code>\\n</code> so your second array element contains it too.</p>\n\n<p>Also I really suggest to look at error messages before posting such kind of questions. You could see <code>strconv.ParseFloat: parsing \"23\\n\": invalid syntax</code> as result of next code</p>\n\n<pre><code>string2, err := strconv.ParseFloat(result[1], 64)\nif err != nil {\n    fmt.Println(e)\n}\n</code></pre>\n"}], "owner": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1388, "favorite_count": 0, "accepted_answer_id": 36387465, "answer_count": 1, "score": 1, "last_activity_date": 1459699400, "creation_date": 1459697730, "last_edit_date": 1459699400, "question_id": 36387416, "link": "https://stackoverflow.com/questions/36387416/go-converting-string-to-float-using-strconv-parsefloat-returns-0", "title": "Go: converting string to float using strconv.ParseFloat returns 0", "body": "<p>I have the following code:</p>\n\n<pre><code>reader := bufio.NewReader(os.Stdin)\nfmt.Print(\"room: width x length: \")\n\ninStr, _ := reader.ReadString('\\n')\nresult := strings.Split(inStr, \"x\")\n\nstring1, _ := strconv.ParseFloat(result[0], 64)\nstring2, _ := strconv.ParseFloat(result[1], 64)\nfmt.Print(string2)\n</code></pre>\n\n<p>At the last print statement, if i print <code>string1</code> it returns the right value, but if i try to print <code>string2</code> it returns 0, no matter what value i input to the console.</p>\n\n<p>Does anyone know why this is happening?\nThanks!</p>\n"}, {"tags": ["file", "go", "append", "gob"], "answers": [{"comments": [{"owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "edited": false, "score": 0, "creation_date": 1459705826, "post_id": 36386843, "comment_id": 60394527, "body": "Thanks, that makes sense. Another option should be to not close the encoder between successive writes. This should work until the app is shut down."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1459707489, "post_id": 36386843, "comment_id": 60395101, "body": "Yes, not closing would work.  Gob is special in that for every new type it encounters it writes a description record to define the fields &amp; types.  By creating new encoders, it loses track of what types have been defined, so it starts defining them again on the second write.  Which, I assume, confuses the decoder."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1459708198, "post_id": 36386843, "comment_id": 60395389, "body": "It&#39;s almost like they are missing a <code>Close</code> mthod to indicate it is done."}, {"owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "edited": false, "score": 0, "creation_date": 1459711898, "post_id": 36386843, "comment_id": 60396978, "body": "One could argue that the Close is implicit: When there is no reference to the encoder anymore."}], "tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 3, "last_activity_date": 1459697600, "last_edit_date": 1459697600, "creation_date": 1459694602, "answer_id": 36386843, "question_id": 36385955, "link": "https://stackoverflow.com/questions/36385955/retrieving-gobs-written-to-file-by-appending-several-times/36386843#36386843", "title": "Retrieving gobs written to file by appending several times", "body": "<p>I have not used the <code>encoding/gob</code> package yet (looks cool, I might have to find a project for it).  But reading the godoc, it would seem to me that each encoding is a single record expected to be decoded from beginning to end.  That is, once you <code>Encode</code> a stream, the resulting bytes is a complete set respecting the entire stream from start to finish - not able to be appended to later by encoding again.</p>\n\n<p>The godoc states that an encoded <code>gob</code> is self-descriptive.  At the beginning of the encoded stream, it describes the entire data set struct, types, etc that will be following including the field names.  Then what follows in the byte stream is the the size and byte representation of the value of those Exported fields.</p>\n\n<p>Then one could assume that what is omitted from the docs is since the stream self-describes itself at the very beginning, <em>including each field that is about to be passed</em>, that is all that the <code>Decoder</code> will care about.  The <code>Decoder</code> will not know of any successive bytes added after what has been described as it only sees what was described at the beginning.  Therefore, that error message <code>panic: extra data in buffer</code> is accurate.</p>\n\n<p>In your Playground example, you are encoding twice to the same encoder instance and then closing the file.  Since you are passing exactly two records in, and encoding two records, that <em>may work</em> as the single instance of the encoder may see the two <code>Encode</code> calls as a single encoded stream.  Then when you close the file io's stream, the <code>gob</code> is now complete - and the stream is treated as a single record (even though you sent in two types).  </p>\n\n<p>And the same in the decoding function, you are reading X number of times from the same stream.  But, you are writing a single record when closing the file - that actually has two types in that one single record.  Hence why it works when reading 2, and EXACTLY 2.  But fails if reading more than 2.  </p>\n\n<p>A solution, if you want to store this in a single file, is that you will need to create your own index of each complete \"write\" or encoder instance/session.  Some form your own Block method that allows you to wrap or define each entry written to disk with a \"begin\" and \"end\" marker.  That way, when reading back the file, you know exactly what buffer to allocate because of the begin/end markers.  Once you have a single record in a buffer, then you use gob's <code>Decoder</code> to decode it.  And close the file after each write.</p>\n\n<p>The pattern I use for such markers is something like:</p>\n\n<pre><code>uint64:uint64\nuint64:uint64\n...\n</code></pre>\n\n<p>The first being the beginning byte number, and the second entry separated by a colon being its length.  I usually store this in another file though, called appropriately <code>indexes</code>.  That way it can be quickly read into memory, and then I can stream the large file knowing exactly where each start and end address is in the byte stream.</p>\n\n<p>Another option is just to store each <code>gob</code> in its own file, using the file system directory structure to organize as you see fit (or one could even use the directories to define types, for example).  Then the existence of each file is a single record.  This is how I use my rendered json from Event Sourcing techniques, storing millions of files organized in directories.  </p>\n\n<p>In summary, it would seem to me that a <code>gob</code> of data is a complete set of data from beginning to end - a single \"record\" have you.  If you want to store multiple encodings/multiple gobs, then to will need to create your own index to track the start and size/end of each <code>gob</code> bytes as you store them.  Then, you will want to <code>Decode</code> each entry separately.</p>\n"}], "owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1122, "favorite_count": 0, "accepted_answer_id": 36386843, "answer_count": 1, "score": 1, "last_activity_date": 1459697600, "creation_date": 1459690001, "last_edit_date": 1495539907, "question_id": 36385955, "link": "https://stackoverflow.com/questions/36385955/retrieving-gobs-written-to-file-by-appending-several-times", "title": "Retrieving gobs written to file by appending several times", "body": "<p>I am trying to use encoding/gob to store data to a file and load it later. I want to be able to append new data to the file and load all saved data later, e.g. after restarting my application. While storing to the file using Encode() there are no problems, but when reading it seems I always get only the item which was first stored, not the succinctly stored items.</p>\n\n<p>Here is a minimal example: <a href=\"https://play.golang.org/p/patGkKDLhM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/patGkKDLhM</a></p>\n\n<p>As you see, it works to write two times to an encoder and then read it back. But when closing the file and reopening it again in append mode, writing seems to work, but reading works only for the first two elements (which have been written previously). The two newly added structs cannot be retrieved, I get the error:</p>\n\n<blockquote>\n  <p>panic: extra data in buffer</p>\n</blockquote>\n\n<p>I am aware of <a href=\"https://stackoverflow.com/questions/30927993/append-to-golang-gob-in-a-file-on-disk\">Append to golang gob in a file on disk</a> and I also read <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/bn6vjC5Abd8\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/bn6vjC5Abd8</a> </p>\n\n<p>Finally, I also found <a href=\"https://gist.github.com/kjk/8015952\" rel=\"nofollow noreferrer\">https://gist.github.com/kjk/8015952</a> which seems to demonstrate that what I am trying to do does not work. Why? What does this error mean?</p>\n"}, {"tags": ["google-app-engine", "templates", "go", "data-modeling", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1459758086, "last_edit_date": 1459758086, "creation_date": 1459757337, "answer_id": 36397454, "question_id": 36384759, "link": "https://stackoverflow.com/questions/36384759/access-properties-of-referenced-objects-in-golang-template-google-app-engine/36397454#36397454", "title": "access properties of referenced objects in golang template (Google app engine)", "body": "<p>The <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow\"><code>html/template</code></a> package is not \"appengine-aware\", it does not know about the GAE platform, and it does not support automatic resolution of such references.</p>\n\n<p>By design philosophy, templates should not contain complex logic. If something is (or looks) too complex in templates, it should be implemented in functions. And you may register your custom functions with the <a href=\"https://golang.org/pkg/html/template/#Template.Funcs\" rel=\"nofollow\"><code>Template.Funcs()</code></a> method which you can call from templates.</p>\n\n<p>For your use case I recommend the following custom function which loads a <code>Sections</code> by its key:</p>\n\n<pre><code>func loadSections(ctx appengine.Context, k *datastore.Key) (*Sections, error) {\n    s := Sections{}\n    err := datastore.Get(ctx, k, &amp;s)\n    return &amp;s, err\n}\n</code></pre>\n\n<p>Note that you need the <code>Context</code> for loading entities from the Datastore, so you have to make it available too in the template params. So your template params may look like this:</p>\n\n<pre><code>ctx := appengine.NewContext(r)\n\nm := map[string]interface{}{\n    \"Sections\": s, // A previously loaded Sections\n    \"Ctx\":      ctx,\n}\n</code></pre>\n\n<p>And by registering and using this function, you can get what you want:</p>\n\n<pre><code>    t := template.Must(template.New(\"\").Funcs(template.FuncMap{\n        \"loadSections\": loadSections,\n    }).Parse(`my section name: {{.Sections.SectionName}},\nparent section name: {{(loadSections .Ctx .Sections.ParentSection).SectionName}}`))\n\n    t.Execute(w, m)\n</code></pre>\n\n<p>Now let's say you have a parent <code>Sections</code> whose name is <code>\"parSecName\"</code>, and you have a child <code>Sections</code> whose name is <code>\"childSecName\"</code>, and child's <code>ParentSection</code> points to the parent's <code>Sections</code>. Executing the above template you'll see this result:</p>\n\n<pre><code>my section name: childSecName,\nparent section name: parSecName\n</code></pre>\n\n<h2>Complete example</h2>\n\n<p>See this complete working example. Note: it is for demonstration purposes only, it is not optimized for production.</p>\n\n<p>It registers the <code>/put</code> path to insert 2 <code>Sections</code>. And you may use any other path to execute the template. So test it like this:</p>\n\n<p>First insert 2 <code>Sections</code>:</p>\n\n<pre><code>http://localhost:8080/put\n</code></pre>\n\n<p>Then execute and view template result:</p>\n\n<pre><code>http://localhost:8080/view\n</code></pre>\n\n<p>Complete runnable code:</p>\n\n<pre><code>// +build appengine\n\npackage gplay\n\nimport (\n    \"appengine\"\n    \"appengine/datastore\"\n    \"html/template\"\n    \"net/http\"\n)\n\nfunc init() {\n    http.HandleFunc(\"/put\", puthandler)\n    http.HandleFunc(\"/\", myhandler)\n}\n\nfunc myhandler(w http.ResponseWriter, r *http.Request) {\n    ctx := appengine.NewContext(r)\n\n    s := Sections{}\n    if err := datastore.Get(ctx, datastore.NewKey(ctx, \"Sections\", \"\", 2, nil), &amp;s); err != nil {\n        panic(err)\n    }\n\n    m := map[string]interface{}{\n        \"Sections\": s,\n        \"Ctx\":      ctx,\n    }\n\n        t := template.Must(template.New(\"\").Funcs(template.FuncMap{\n            \"loadSections\": loadSections,\n        }).Parse(`my section name: {{.Sections.SectionName}},\n    parent section name: {{(loadSections .Ctx .Sections.ParentSection).SectionName}}`))\n\n        t.Execute(w, m)\n}\n\n    func loadSections(ctx appengine.Context, k *datastore.Key) (*Sections, error) {\n        s := Sections{}\n        err := datastore.Get(ctx, k, &amp;s)\n        return &amp;s, err\n    }\n\nfunc puthandler(w http.ResponseWriter, r *http.Request) {\n    ctx := appengine.NewContext(r)\n\n    s := Sections{\"parSecName\", false, nil}\n\n    var k *datastore.Key\n    var err error\n    if k, err = datastore.Put(ctx, datastore.NewKey(ctx, \"Sections\", \"\", 1, nil), &amp;s); err != nil {\n        panic(err)\n    }\n    s.SectionName = \"childSecName\"\n    s.ParentSection = k\n    if _, err = datastore.Put(ctx, datastore.NewKey(ctx, \"Sections\", \"\", 2, nil), &amp;s); err != nil {\n        panic(err)\n    }\n}\n\ntype Sections struct {\n    SectionName   string\n    IsFather      bool\n    ParentSection *datastore.Key\n}\n</code></pre>\n\n<h2>Some notes</h2>\n\n<p>This child-parent relation can be modeled with the <code>Key</code> itself as a key may optionally contain a parent <code>Key</code>.</p>\n\n<p>If you don't want to \"store\" the parent Key in the entity's key itself, it may also be enough to just store either the key's name or the key's ID (depending on what you use), as from that the key can be constructed.</p>\n"}], "owner": {"reputation": 51, "user_id": 1979569, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0668ffac55c449e908b30ed48e72fe34?s=128&d=identicon&r=PG", "display_name": "Aymane Mzily", "link": "https://stackoverflow.com/users/1979569/aymane-mzily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 36397454, "answer_count": 1, "score": 1, "last_activity_date": 1474760217, "creation_date": 1459682314, "last_edit_date": 1474760217, "question_id": 36384759, "link": "https://stackoverflow.com/questions/36384759/access-properties-of-referenced-objects-in-golang-template-google-app-engine", "title": "access properties of referenced objects in golang template (Google app engine)", "body": "<p>I have a data model <code>Sections:</code></p>\n\n<pre><code>type Sections struct{\n    SectionName     string\n    IsFather        bool\n    ParentSection   *datastore.Key\n}\n</code></pre>\n\n<p>I pass sections as value to golang template and I want to get <code>ParentSection</code> name <code>ParentSection.SectionName</code> so how can I do this from template like <code>jinja2</code> in python <code>{{ParentSection.get().SectionName}}</code>?</p>\n"}, {"tags": ["time", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1459680545, "post_id": 36384490, "comment_id": 60385931, "body": "<code>Hour</code> and <code>Minute</code> are functions; you need to evaluate them: <code>fmt.Printf(&quot;The time is %d.%d: &quot;, t.Hour(), t.Minute())</code>."}, {"owner": {"reputation": 85, "user_id": 6151570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0b4101257867801e00b2b6a381b6b56a?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria", "link": "https://stackoverflow.com/users/6151570/victoria"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1459680902, "post_id": 36384490, "comment_id": 60386033, "body": "Oh my gosh, that was simple and obvious. Thanks!   Do you know then what t.Hour actually returns? And why is it so similar to t.Minute and t.Second?"}, {"owner": {"reputation": 22097, "user_id": 8976, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9dc432b57f4370eaf4b91baa1e6b8147?s=128&d=identicon&r=PG", "display_name": "EricSchaefer", "link": "https://stackoverflow.com/users/8976/ericschaefer"}, "edited": false, "score": 1, "creation_date": 1459684860, "post_id": 36384490, "comment_id": 60387102, "body": "t.Hour and t.Minutes are references to the functions, not the result of the functions. You can think of them as addresses in memory where these functions are stored."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 6151570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0b4101257867801e00b2b6a381b6b56a?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria", "link": "https://stackoverflow.com/users/6151570/victoria"}, "edited": false, "score": 0, "creation_date": 1459683920, "post_id": 36384678, "comment_id": 60386847, "body": "Well, I had read the time package page, but I didn&#39;t realise I wasn&#39;t calling hour in the correct way as a function. Do you know what <code>t.Hour</code> returns?"}], "tags": [], "owner": {"reputation": 1343, "user_id": 144432, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sNtFB.jpg?s=128&g=1", "display_name": "Cengiz Can", "link": "https://stackoverflow.com/users/144432/cengiz-can"}, "is_accepted": true, "score": 3, "last_activity_date": 1459681898, "last_edit_date": 1459681898, "creation_date": 1459681592, "answer_id": 36384678, "question_id": 36384490, "link": "https://stackoverflow.com/questions/36384490/go-why-does-time-now-hour-minute-second-return-a-six-digit-number/36384678#36384678", "title": "Go: why does time.Now().Hour/Minute/Second return a six digit number?", "body": "<p>You need to call <code>t.Hour()</code> instead of using it as a value.</p>\n\n<p>Check out the source of <code>time</code> package here: <a href=\"https://golang.org/src/time/time.go?s=12994:13018#L390\" rel=\"nofollow\">https://golang.org/src/time/time.go?s=12994:13018#L390</a></p>\n\n<pre><code>   399  // Hour returns the hour within the day specified by t, in the range [0, 23].\n   400  func (t Time) Hour() int {\n   401      return int(t.abs()%secondsPerDay) / secondsPerHour\n   402  }\n   403  \n</code></pre>\n\n<p>When in doubt, you can quickly find an explanation by reading specific package source from official <a href=\"https://golang.org/pkg/\" rel=\"nofollow\">go packages page</a>. </p>\n"}], "owner": {"reputation": 85, "user_id": 6151570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0b4101257867801e00b2b6a381b6b56a?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria", "link": "https://stackoverflow.com/users/6151570/victoria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 0, "accepted_answer_id": 36384678, "answer_count": 1, "score": 0, "last_activity_date": 1459682942, "creation_date": 1459680442, "last_edit_date": 1459682942, "question_id": 36384490, "link": "https://stackoverflow.com/questions/36384490/go-why-does-time-now-hour-minute-second-return-a-six-digit-number", "title": "Go: why does time.Now().Hour/Minute/Second return a six digit number?", "body": "<p>I am learning how to code in Go and trying to create a simple reminder function. </p>\n\n<p>I want to display the current time as a regular 24 hour clock, XX.XX (hours, minutes). </p>\n\n<p>I have saved the current time in a variable t and when I print it I find out that the time is 23.00 early November 2009. Fine, but when I print t.Hour and t.Minute the result is <code>132288.132480</code>. </p>\n\n<p>It is something similar when I print <code>t.Seconds</code>. I have not been able to figure out why this happens. </p>\n\n<p>Roughly 2000 days have passed since but that is only 48k hours and 2880k minutes so the small difference between the hours and minutes in my result hints that the issue is something else. </p>\n\n<p>I am running the code in the go playground.</p>\n\n<p>My code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    )\n\nfunc main() {\n    Remind(\"It's time to eat\")\n}\n\n\nfunc Remind(text string) {\n    t := time.Now()\n    fmt.Println(t)\n    fmt.Printf(\"The time is %d.%d: \", t.Hour, t.Minute)\n    fmt.Printf(text)\n    fmt.Println()\n}\n</code></pre>\n"}, {"tags": ["json", "dictionary", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "is_accepted": false, "score": 0, "last_activity_date": 1459679977, "creation_date": 1459679977, "answer_id": 36384413, "question_id": 36384154, "link": "https://stackoverflow.com/questions/36384154/golang-maps-how-to-strip-out-empty-fields-automatically/36384413#36384413", "title": "Golang Maps: How to strip out empty fields automatically", "body": "<p>In your example, you are already using the <code>,omitempty</code> tag in <code>bson</code>. </p>\n\n<p>Based on the <a href=\"https://godoc.org/labix.org/v2/mgo/bson#Marshal\" rel=\"nofollow\">bson docs</a></p>\n\n<blockquote>\n  <p>omitempty  Only include the field if it's not set to the zero\n             value for the type or to empty slices or maps.</p>\n</blockquote>\n\n<p>So, even if you pass the map directly to your update call, the empty fields should not be updated. The only issue should be, you should take care of the <code>_id</code> not being given an incorrect value.</p>\n"}], "owner": {"reputation": 8678, "user_id": 278659, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a10f8a52a8c247d8e20ee9ab59ee22f2?s=128&d=identicon&r=PG", "display_name": "j3d", "link": "https://stackoverflow.com/users/278659/j3d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459679977, "creation_date": 1459678486, "question_id": 36384154, "link": "https://stackoverflow.com/questions/36384154/golang-maps-how-to-strip-out-empty-fields-automatically", "title": "Golang Maps: How to strip out empty fields automatically", "body": "<p>Given the following <code>struct</code>...</p>\n\n<pre><code>package models\n\nimport (\n    \"time\"\n    \"gopkg.in/mgo.v2/bson\"\n    \"github.com/fatih/structs\"\n)\n\ntype User struct {\n    Id         bson.ObjectId `json:\"id,omitempty\" bson:\"_id,omitempty\"`\n    Name       string        `json:\"name,omitempty\" bson:\"name,omitempty\"`\n    BirthDate  time.Time     `json:\"birth_date,omitempty\" bson:\"birth_date,omitempty\"`\n}\n</code></pre>\n\n<p>... I fill it by parsing a HTTP request like this:</p>\n\n<pre><code>func (userController *UserController) UpdateUser() echo.HandlerFunc {\n    return func(context echo.Context) error {\n        user := &amp;models.User{}\n\n        // parse JSON in POST request and fill the User struct\n        if err := context.Bind(user); err != nil {\n            return err\n        }\n\n        // get user id from URL\n        query := bson.M{\"_id\": bson.ObjectIdHex(context.Param(\"id\"))}\n\n        update := bson.M{\n            // structs.Map() converts a User struct to a Map[string]interfacce{}\n            \"$set\": structs.Map(user)\n        }\n\n        if err := userController.session.DB(\"test\").C(\"users\").Update(query, update); err !=   {\n            return err\n        }\n\n        return context.JSON(http.StatusOK, user)\n    }\n}\n</code></pre>\n\n<p>The problem is that when I get an update JSON like this...</p>\n\n<pre><code>{\n    \"name\": \"Bon Scott\",\n    \"birth_date\" : \"1946-07-09\"\n}\n</code></pre>\n\n<p>... <code>structs.Map()</code> still returns a <code>Map</code> that contains an empty id like this:</p>\n\n<pre><code>map[%!d(string=Name):%!d(string=Bon Scott) %!d(string=BirthDate):{63108633600 0 10736640} %!d(string=Id):%!d(bson.ObjectId=)]\n</code></pre>\n\n<p>I'd avoid creating the <code>Map</code> manually field-by-field like this:</p>\n\n<pre><code>update := bson.M{\n    \"name\": user.Name,\n    \"birthDate\": user.BirthDate,\n}\n</code></pre>\n\n<p>Is there a way to strip out empty fields automatically?</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1459696230, "post_id": 36383824, "comment_id": 60390978, "body": "The server is closing the connection before you get a response. The panic is because you&#39;re reading from the response after the error."}, {"owner": {"reputation": 341, "user_id": 851782, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d666d5012c1104504b6b8cc7a0760ede?s=128&d=identicon&r=PG", "display_name": "fatmcgav", "link": "https://stackoverflow.com/users/851782/fatmcgav"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1459753040, "post_id": 36383824, "comment_id": 60409167, "body": "@JimB OK - Well I can run the same POST test using Curl and get a valid response back...   So it&#39;s either a very strange web-server config, or a Golang issue..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1459783973, "post_id": 36383824, "comment_id": 60429768, "body": "If it is the server cutting you off, it can be hard to diagnose without server-side logs. I&#39;ve seen strange things with broken tls implementations, and you could try running github.com/jbardin/gotlsscan to see what tls versions and ciphers are supported (though I don&#39;t think this will give you much more info). You could try to force the same tls version and cipher that curl is using, or one where you can decode the request in wireshark. Maybe there&#39;s a partial response, and you can check the response headers for info without dereferencing the Body."}, {"owner": {"reputation": 341, "user_id": 851782, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d666d5012c1104504b6b8cc7a0760ede?s=128&d=identicon&r=PG", "display_name": "fatmcgav", "link": "https://stackoverflow.com/users/851782/fatmcgav"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1459843273, "post_id": 36383824, "comment_id": 60455431, "body": "@JimB cheers again for the response... I&#39;ve put a support req in with the team responsible for the server side, and am waiting on feedback... Using gotlsscan didn&#39;t turn up anything useful, other than every protocol fails with &#39;EOF&#39;... So it definitely seems to be something about a GoLang client talking to the service :s"}], "owner": {"reputation": 341, "user_id": 851782, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d666d5012c1104504b6b8cc7a0760ede?s=128&d=identicon&r=PG", "display_name": "fatmcgav", "link": "https://stackoverflow.com/users/851782/fatmcgav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 829, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1459792696, "creation_date": 1459676520, "last_edit_date": 1459792696, "question_id": 36383824, "link": "https://stackoverflow.com/questions/36383824/golang-1-6-https-eof-error", "title": "GoLang 1.6 - HTTPS EOF error", "body": "<p>I'm currently attempting to debug an issue with issuing a HTTP POST via GoLang 1.6.</p>\n\n<p>The connection is failing with an 'EOF' error. </p>\n\n<p>The test client code: <a href=\"https://gist.github.com/fatmcgav/35d1a4fbd74c7208f445c487f756a5e1\" rel=\"nofollow\">https://gist.github.com/fatmcgav/35d1a4fbd74c7208f445c487f756a5e1</a></p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"crypto/tls\"\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n    \"net/http/httputil\"\n    \"os\"\n)\n\nfunc main() {\n\n    const body = \"{\\\"auth\\\":\" +\n        \"{\\\"identity\\\":\" +\n        \"{\\\"methods\\\":[\\\"password\\\"],\" +\n        \"\\\"password\\\":\" +\n        \"{\\\"user\\\":{\\\"name\\\":\\\"xxx\\\",\" +\n        \"\\\"password\\\":\\\"xxx\\\",\" +\n        \"\\\"domain\\\":{\\\"name\\\":\\\"xxx_domain\\\"}\" +\n        \"}\" +\n        \"}\" +\n        \"},\\\"scope\\\":{\\\"project\\\":\" +\n        \"{\\\"domain\\\": \" +\n        \"{\\\"name\\\":\\\"xxx_domain\\\"},\\\"name\\\":\\\"xxx\\\"}}}}\"\n\n    // Unmarshall JSON\n    var m map[string]interface{}\n    json.Unmarshal([]byte(body), &amp;m)\n    // fmt.Println(\"%v\", m)\n\n    var req *http.Request\n    var resp *http.Response\n    var dump []byte\n    var err error\n    client := &amp;http.Client{}\n\n    url := \"https://identity.xxx/v3/auth/tokens\"\n\n    fmt.Println(\"Requesting auth token against URL: %s\", url)\n\n    rendered, err := json.Marshal(m)\n    if err != nil {\n        fmt.Println(\"Error marshalling body: %q\", err)\n        os.Exit(2)\n    }\n\n    req, err = http.NewRequest(\"POST\", url, bytes.NewReader(rendered))\n    if err != nil {\n        fmt.Println(\"Got an error: %q\", err)\n        os.Exit(2)\n    }\n\n    // Need to Close connection\n    req.Close = true\n\n    fmt.Println(\"Setting Insecure TLS mode\")\n    // Configure custom TLS settings.\n    config := &amp;tls.Config{InsecureSkipVerify: true}\n    transport := &amp;http.Transport{TLSClientConfig: config,\n        DisableKeepAlives:  true,\n        DisableCompression: true,\n    }\n    client.Transport = transport\n\n    req.Header.Set(\"Content-Type\", \"application/json\")\n    req.Header.Set(\"Accept\", \"application/json\")\n\n    dump, err = httputil.DumpRequestOut(req, true)\n    fmt.Printf(\"Outgoing requst = \\n%q\\n\", dump)\n\n    resp, err = client.Do(req)\n    if err != nil {\n        fmt.Println(\"Error encountered: %q\", err)\n    }\n    dump, err = httputil.DumpResponse(resp, true)\n    fmt.Printf(\"Response = \\n%q\\n\", dump)\n}\n</code></pre>\n\n<p>and resultant output is here:</p>\n\n<pre><code> ~/golang/scripts \ue0b0 go build req-test.go &amp;&amp; ./req-test\nRequesting auth token against URL: %s https://identity.xxx/v3/auth/tokens\nSetting Insecure TLS mode\nOutgoing requst =\n\"POST /v3/auth/tokens HTTP/1.1\\r\\nHost: identity.xxx\\r\\nUser-Agent: Go-http-client/1.1\\r\\nConnection: close\\r\\nContent-Length: 262\\r\\nAccept: application/json\\r\\nContent-Type: application/json\\r\\nAccept-Encoding: gzip\\r\\n\\r\\n{\\\"auth\\\":{\\\"identity\\\":{\\\"methods\\\":[\\\"password\\\"],\\\"password\\\":{\\\"user\\\":{\\\"domain\\\":{\\\"name\\\":\\\"BusinessSupport_domain\\\"},\\\"name\\\":\\\"xxx\\\",\\\"password\\\":\\\"xxx\\\"}}},\\\"scope\\\":{\\\"project\\\":{\\\"domain\\\":{\\\"name\\\":\\\"xxx_domain\\\"},\\\"name\\\":\\\"xxx\\\"}}}}\"\nError encountered: %q Post https://identity.xxx/v3/auth/tokens: EOF\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x0 pc=0x13659e]\n\ngoroutine 1 [running]:\npanic(0x338980, 0xc82000a170)\n        /usr/local/opt/go/libexec/src/runtime/panic.go:464 +0x3e6\nnet/http/httputil.DumpResponse(0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0)\n        /usr/local/opt/go/libexec/src/net/http/httputil/dump.go:285 +0x42e\nmain.main()\n        /Users/gavinw/golang/scripts/req-test.go:77 +0xdc\n</code></pre>\n\n<p>For obvious reasons, I've anonymised some of the details.. </p>\n\n<p>Any pointers on what I'm doing wrong.. </p>\n\n<p>Cheers<br>\nGavin</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1459669890, "post_id": 36382880, "comment_id": 60382844, "body": "you can maybe bridge your stdin with the sub process&#39; stdin with a loop reading from yours and writing to the sub proc&#39;s."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12861522"}, "edited": false, "score": 1, "creation_date": 1586126550, "post_id": 36383984, "comment_id": 108005983, "body": "there is no way to stream/pipe stuff to stdin?"}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 6, "last_activity_date": 1586155922, "last_edit_date": 1586155922, "creation_date": 1459677509, "answer_id": 36383984, "question_id": 36382880, "link": "https://stackoverflow.com/questions/36382880/go-write-to-stdin-on-external-command/36383984#36383984", "title": "Go - write to stdin on external command", "body": "<p>I imagine you could use a <code>bytes.Buffer</code> for that.\nSomething like that:</p>\n\n<pre><code>login := exec.Command(cmd, \"login\")\n\nbuffer := bytes.Buffer{}\nbuffer.Write([]byte(\"username\\npassword\\n\"))\nlogin.Stdin = &amp;buffer\n\nlogin.Stdout = os.Stdout\nlogin.Stderr = os.Stderr\n\nerr := login.Run()\nif err != nil {\n    fmt.Fprintln(os.Stderr, err)\n}\n</code></pre>\n\n<p>The trick is that the <code>stdin</code> is merely a char buffer, and when reading the credentials, it will simply read chars until encountering a <code>\\n</code> character (or maybe <code>\\n\\r</code>). So you can write them in a buffer in advance, and feed the buffer directly to the command.</p>\n"}], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5795, "favorite_count": 1, "accepted_answer_id": 36383984, "answer_count": 1, "score": 4, "last_activity_date": 1586155922, "creation_date": 1459669600, "last_edit_date": 1542645614, "question_id": 36382880, "link": "https://stackoverflow.com/questions/36382880/go-write-to-stdin-on-external-command", "title": "Go - write to stdin on external command", "body": "<p>I have the following code which executes an external command and output to the console two fields waiting for the user input.\nOne for the username and other for the password, and then I have added them manually.</p>\n\n<p>Could anyone give me a hint about how to write to stdin in order to enter these inputs from inside the program?   </p>\n\n<p>The tricky part for me is that there are two different fields waiting for input, and I'm having trouble to figure out how to fill one after the other.</p>\n\n<pre><code>login := exec.Command(cmd, \"login\")\n\nlogin.Stdout = os.Stdout\nlogin.Stdin = os.Stdin\nlogin.Stderr = os.Stderr\n\nerr := login.Run()\nif err != nil {\n    fmt.Fprintln(os.Stderr, err)\n}\n</code></pre>\n\n<p>SOLUTION:</p>\n\n<pre><code>login := exec.Command(cmd, \"login\") \n\nvar b bytes.Buffer\nb.Write([]byte(username + \"\\n\" + pwd + \"\\n\"))\n\nlogin.Stdout = os.Stdout\nlogin.Stdin = &amp;b\nlogin.Stderr = os.Stderr\n</code></pre>\n"}, {"tags": ["html", "templates", "url", "go", "go-html-template"], "comments": [{"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1459752424, "post_id": 36382624, "comment_id": 60408854, "body": "Make sure the url string is correct. For example it&#39;ll output &#39;ZgotmplZ&#39; if its ` https:` with a space in front instead of <code>https:</code>"}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 3, "creation_date": 1508399078, "post_id": 36382624, "comment_id": 80597413, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14765395/why-am-i-seeing-zgotmplz-in-my-go-html-template-output\">Why am I seeing ZgotmplZ in my Go HTML template output?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 8, "last_activity_date": 1477071006, "last_edit_date": 1477071006, "creation_date": 1459754046, "answer_id": 36396564, "question_id": 36382624, "link": "https://stackoverflow.com/questions/36382624/how-to-get-rid-of-zgotmplz-from-html-template-in-golang/36396564#36396564", "title": "How to get rid of ZgotmplZ from html/template in Golang?", "body": "<p><code>ZgotmplZ</code> is a special value indicating your input was invalid. Quoting from the doc of <code>html/template</code>:</p>\n\n<blockquote>\n<pre><code>\"ZgotmplZ\" is a special value that indicates that unsafe content reached a\nCSS or URL context at runtime. The output of the example will be\n   &lt;img src=\"#ZgotmplZ\"&gt;\nIf the data comes from a trusted source, use content types to exempt it\nfrom filtering: URL(`javascript:...`).\n</code></pre>\n</blockquote>\n\n<p>If you want to substitute a <strong>valid</strong> url text, nothing special like like <code>safeURL</code> function is needed. If your template execution results in a value like <code>\"#ZgotmplZ\"</code>, that means the URL you wanted to insert is invalid.</p>\n\n<p>See this example:</p>\n\n<pre><code>t := template.Must(template.New(\"\").Parse(`&lt;a href=\"{{.}}\"&gt;&lt;/a&gt;` + \"\\n\"))\nt.Execute(os.Stdout, \"http://google.com\")\nt.Execute(os.Stdout, \"badhttp://google.com\")\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&lt;a href=\"http://google.com\"&gt;&lt;/a&gt;\n&lt;a href=\"#ZgotmplZ\"&gt;&lt;/a&gt;\n</code></pre>\n\n<p>You may use a value of type <a href=\"https://golang.org/pkg/html/template/#URL\" rel=\"noreferrer\"><code>template.URL</code></a> if you want to use a URL as-is without escaping. Note that in this case the provided value will be used as-is even if it is not a valid URL.</p>\n\n<p><code>safeURL</code> is not some kind of magic or predeclared function that you may use in templates. But you may register your own custom function which returns a <code>string</code> url parameter as a value of type <code>template.URL</code>:</p>\n\n<pre><code>t2 := template.Must(template.New(\"\").Funcs(template.FuncMap{\n    \"safeURL\": func(u string) template.URL { return template.URL(u) },\n}).Parse(`&lt;a href=\"{{. | safeURL}}\"&gt;&lt;/a&gt;` + \"\\n\"))\nt2.Execute(os.Stdout, \"http://google.com\")\nt2.Execute(os.Stdout, \"badhttp://google.com\")\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&lt;a href=\"http://google.com\"&gt;&lt;/a&gt;\n&lt;a href=\"badhttp://google.com\"&gt;&lt;/a&gt;\n</code></pre>\n\n<p><strong>Note:</strong> If you are able to pass in a <code>template.URL</code> value directly to the template execution, you do not need to register and use a <code>safeURL()</code> custom function:</p>\n\n<pre><code>t3 := template.Must(template.New(\"\").Parse(`&lt;a href=\"{{.}}\"&gt;&lt;/a&gt;` + \"\\n\"))\nt3.Execute(os.Stdout, template.URL(\"http://google.com\"))\nt3.Execute(os.Stdout, template.URL(\"badhttp://google.com\"))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&lt;a href=\"http://google.com\"&gt;&lt;/a&gt;\n&lt;a href=\"badhttp://google.com\"&gt;&lt;/a&gt;\n</code></pre>\n\n<p>Try these on the <a href=\"http://play.golang.org/p/qy3saHsfl8\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2161, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1477071006, "creation_date": 1459667662, "last_edit_date": 1470220407, "question_id": 36382624, "link": "https://stackoverflow.com/questions/36382624/how-to-get-rid-of-zgotmplz-from-html-template-in-golang", "title": "How to get rid of ZgotmplZ from html/template in Golang?", "body": "<p>I'm using Golang in backend. When I render the html using html/templates I'm getting <code>ZgotmplZ</code> for URL's. </p>\n\n<pre><code>{{if .UserData.GitURL}}\n&lt;li&gt;\n  &lt;a href=\"{{.UserData.GitURL}}\"&gt;\n    &lt;i class=\"icon fa fa-github\"&gt;&lt;/i&gt;\n  &lt;/a&gt;\n&lt;/li&gt;\n{{end}}\n</code></pre>\n\n<p>I'm using string for GitURL in server side. This URL is <code>https</code>. When I looked for solutions some blog suggested to use <code>safeURL</code>. So I tried,</p>\n\n<pre><code>{{if .UserData.GitURL}}\n&lt;li&gt;\n  &lt;a href=\"{{.UserData.GitURL | safeURL}}\"&gt;\n    &lt;i class=\"icon fa fa-github\"&gt;&lt;/i&gt;\n  &lt;/a&gt;\n&lt;/li&gt;\n{{end}}\n</code></pre>\n\n<p>But code didn't compile. </p>\n\n<p>Could someone help me with this? Any suggestion would be really helpful.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 17753, "user_id": 1342082, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/1ef12d2cf78f28d7a1e76c8fc60978c8?s=128&d=identicon&r=PG", "display_name": "Kevin Ushey", "link": "https://stackoverflow.com/users/1342082/kevin-ushey"}, "edited": false, "score": 0, "creation_date": 1459662095, "post_id": 36381997, "comment_id": 60381261, "body": "I&#39;m guessing the issue here is that the Go unmarshaller doesn&#39;t accept integers specified with exponential notation -- is it feasible to unmarshal as <code>float64</code> and then translate to <code>uint64</code> after?"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1459665577, "post_id": 36381997, "comment_id": 60381840, "body": "i believe this is problem is caused by type, and i sense OP wants the field to be uint64. So a proper way is to change the JSON field type to <code>float64</code>, then do a type cast to uint64 when you want to use it."}, {"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1459669657, "post_id": 36381997, "comment_id": 60382781, "body": "Yes, it seems we need  a float. But is it possible to make it int64? Or i need to convert it manual?"}], "answers": [{"comments": [{"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1459668877, "post_id": 36382054, "comment_id": 60382568, "body": "But I need int not a float."}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 1, "last_activity_date": 1459712534, "last_edit_date": 1459712534, "creation_date": 1459662491, "answer_id": 36382054, "question_id": 36381997, "link": "https://stackoverflow.com/questions/36381997/golang-json-unmarshal-numeric-with-exponent/36382054#36382054", "title": "Golang Json Unmarshal numeric with exponent", "body": "<p>Change the <code>Id</code> type from <code>int64</code> to <code>float32</code> or <code>float64</code>. </p>\n\n<p><a href=\"http://play.golang.org/p/-zidTD_q8y\" rel=\"nofollow\">http://play.golang.org/p/-zidTD_q8y</a></p>\n\n<p><strong>EDIT</strong>: This may be a bit of a hack, but you can add a \"dummy\" <code>Id</code> field of type <code>float64</code> and write a hook to cast the value to the actual <code>Id</code> type <code>int64</code>.</p>\n\n<pre><code>type Person struct {\n    Id    float64          `json:\"id\"`\n    _Id   int64             \n    Name  string           `json:\"name\"`\n}\n\nvar f Person\nvar b = []byte(`{\"id\": 1.2e+8, \"Name\": \"Fernando\"}`)\n_ = json.Unmarshal(b, &amp;f)\n\nif reflect.TypeOf(f._Id) == reflect.TypeOf((int64)(0)) {\n    fmt.Println(f.Id)\n    f._Id = int64(f.Id)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/32HHLxnFlX\" rel=\"nofollow\">http://play.golang.org/p/32HHLxnFlX</a></p>\n"}, {"tags": [], "owner": {"reputation": 397, "user_id": 4997793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5dkyN.jpg?s=128&g=1", "display_name": "Nima Ghoroubi", "link": "https://stackoverflow.com/users/4997793/nima-ghoroubi"}, "is_accepted": false, "score": 0, "last_activity_date": 1567591848, "creation_date": 1567591848, "answer_id": 57786222, "question_id": 36381997, "link": "https://stackoverflow.com/questions/36381997/golang-json-unmarshal-numeric-with-exponent/57786222#57786222", "title": "Golang Json Unmarshal numeric with exponent", "body": "<p>just change the type of id field into float64.</p>\n\n<pre><code>package main\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n)\n\ntype Person struct {\n    Id   float64  `json:\"id\"`\n    Name string   `json:\"name\"`\n}\n\nfunc main() {\n\n    //Create the Json string\n    var b = []byte(`{\"id\": 1.2E+8, \"Name\": \"Fernando\"}`)\n\n    //Marshal the json to a proper struct\n    var f Person\n    json.Unmarshal(b, &amp;f)\n\n    //print the person\n    fmt.Println(f)\n\n    //unmarshal the struct to json\n    result, _ := json.Marshal(f)\n\n    //print the json\n    os.Stdout.Write(result)\n}\n</code></pre>\n"}], "owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1784, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1567591848, "creation_date": 1459661846, "question_id": 36381997, "link": "https://stackoverflow.com/questions/36381997/golang-json-unmarshal-numeric-with-exponent", "title": "Golang Json Unmarshal numeric with exponent", "body": "<p>I have problem when Unmarshal json string into struct that is the numeric value with exponent will alway be 0.\nPlease check code below :</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n)\n\ntype Person struct {\n    Id   uint64  `json:\"id\"`\n    Name string `json:\"name\"`\n}\n\nfunc main() {\n\n    //Create the Json string\n    var b = []byte(`{\"id\": 1.2E+8, \"Name\": \"Fernando\"}`)\n\n    //Marshal the json to a proper struct\n    var f Person\n    json.Unmarshal(b, &amp;f)\n\n    //print the person\n    fmt.Println(f)\n\n    //unmarshal the struct to json\n    result, _ := json.Marshal(f)\n\n    //print the json\n    os.Stdout.Write(result)\n}\n</code></pre>\n\n<p>And the run is : </p>\n\n<pre><code>{0 Fernando}\n</code></pre>\n\n<p>Is there any way to make it work? Since the exponent thing is standart JSON. It seems the golang wrong interpret it.</p>\n\n<p>Here the playground : <a href=\"http://play.golang.org/p/8owgjX9y0m\" rel=\"nofollow\">http://play.golang.org/p/8owgjX9y0m</a> </p>\n"}, {"tags": ["python", "go", "operators", "bit-manipulation"], "answers": [{"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 8, "last_activity_date": 1459660940, "last_edit_date": 1495540781, "creation_date": 1459660022, "answer_id": 36381827, "question_id": 36381749, "link": "https://stackoverflow.com/questions/36381749/go-operator-what-does-it-mean/36381827#36381827", "title": "Go &quot;&amp;^&quot; operator, what does it mean?", "body": "<p>These are the <a href=\"https://stackoverflow.com/questions/28432398/difference-between-some-operators-golang\">\"AND NOT\" or \"bit clear\" operators</a>, \"useful\" for <a href=\"https://stackoverflow.com/questions/23192262/how-would-you-set-and-clear-a-single-bit-in-go\">clearing those bits</a> of the left-hand side operand that are set in right-side operand.</p>\n\n<p>I put the \"useful\" in quotes since all other languages that derive the bitwise operations from C one does this with bitwise AND <code>&amp;</code> and bitwise NOT <code>~</code>; thus <code>5 &amp;^ 2</code> would be just <code>5 &amp; ~2</code> in Python; and <code>a &amp;^= 3</code> of Go would be <code>a &amp;= ~3</code> in Python.</p>\n"}], "owner": {"reputation": 19004, "user_id": 5079316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f5e325c060deb5b55ee6ac0941af4dbe?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Melan&#231;on", "link": "https://stackoverflow.com/users/5079316/olivier-melan%c3%a7on"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 36381827, "answer_count": 1, "score": 0, "last_activity_date": 1459697020, "creation_date": 1459659222, "last_edit_date": 1459697020, "question_id": 36381749, "link": "https://stackoverflow.com/questions/36381749/go-operator-what-does-it-mean", "title": "Go &quot;&amp;^&quot; operator, what does it mean?", "body": "<p>I am struggling to understand what the <a href=\"https://golang.org/ref/spec#Arithmetic_operators\" rel=\"nofollow\"><code>&amp;^</code> and <code>&amp;^=</code> operators</a> mean in Go. I cannot find an answer either in the documentation (which states it's a bit clear operator, but it does not help me much) or by trials.</p>\n\n<p>In particular, I want to know if there is an equivalent in Python.</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1459662847, "post_id": 36381301, "comment_id": 60381388, "body": "As much of the Go code as you can give us would probably help. Unless someone is familiar with just what tends to cause that error message, it&#39;s hard to guess from this."}, {"owner": {"reputation": 5898, "user_id": 817659, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc6960319324ecebe786580dfca13f07?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/817659/ivan"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1459700255, "post_id": 36381301, "comment_id": 60392478, "body": "I added the go code to the post."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1459721267, "post_id": 36381301, "comment_id": 60400511, "body": "Don&#39;t know if this is all, but you need to <code>Unmarshal</code> only <code>b[:n]</code>, not all of <code>b</code>. I think you know, but <code>b</code> is long enough to hold the largest possible datagram; <code>b[:n]</code> is the part with real data."}, {"owner": {"reputation": 5898, "user_id": 817659, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc6960319324ecebe786580dfca13f07?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/817659/ivan"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1459724700, "post_id": 36381301, "comment_id": 60401493, "body": "@twotwotwo, thanks that is the problem!"}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 6, "last_activity_date": 1459731575, "creation_date": 1459731575, "answer_id": 36393141, "question_id": 36381301, "link": "https://stackoverflow.com/questions/36381301/bug-in-golang-google-protocol-buffer/36393141#36393141", "title": "Bug in golang google protocol buffer", "body": "<p>Your buffer <code>b</code> is sized for the maximum possible datagram packet but not all of that is your message, only the first <code>n</code> bytes. The messages about <code>illegal tag 0</code> and <code>wire type 0</code> result from trying to parse the <code>0</code> bytes in buffer space you haven't otherwise initialized. Pass <code>b[:n]</code> to <code>Unmarshal</code> to fix.</p>\n"}], "owner": {"reputation": 5898, "user_id": 817659, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc6960319324ecebe786580dfca13f07?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/817659/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3543, "favorite_count": 0, "accepted_answer_id": 36393141, "answer_count": 1, "score": 1, "last_activity_date": 1459731575, "creation_date": 1459653964, "last_edit_date": 1459700236, "question_id": 36381301, "link": "https://stackoverflow.com/questions/36381301/bug-in-golang-google-protocol-buffer", "title": "Bug in golang google protocol buffer", "body": "<p>I have a python program and a golang program both getting data from a socket. I print the bytes it receives from both.</p>\n\n<pre><code>python\n\nData = 0a300a084a6f686e20446f6510071a126a6f686e2e646f6540676d61696c2e636f6d220e0a0c3131312d3131312d31313130\n\ngolang\n\n2016/04/02 23:21:08 50 bytes read from 192.168.0.1:65120\n2016/04/02 23:21:08 00000000  0a 30 0a 08 4a 6f 68 6e  20 44 6f 65 10 08 1a 12  |.0..John Doe....|\n00000010  6a 6f 68 6e 2e 64 6f 65  40 67 6d 61 69 6c 2e 63  |john.doe@gmail.c|\n00000020  6f 6d 22 0e 0a 0c 31 31  31 2d 31 31 31 2d 31 31  |om\"...111-111-11|\n00000030  31 30                                             |10|\n</code></pre>\n\n<p>The .proto file is identical in both. </p>\n\n<pre><code>syntax = \"proto3\";\npackage MC_Feed;\n\nmessage Person {\n  enum PhoneType {\n    MOBILE = 0;\n    HOME = 1;\n    WORK = 2;\n  }\n\n  string name = 1;\n  int32 id = 2;  // Unique ID number for this person.\n  string email = 3;\n\n  message PhoneNumber {\n    string number = 1;\n    PhoneType type = 2;\n  }\n\n  repeated PhoneNumber phones = 4;\n}\n\n// Our address book file is just one of these.\nmessage AddressBook {\n  repeated Person people = 1;\n}\n</code></pre>\n\n<p>On the python (and C# for that matter) it works fine. On the golang side, I get this error:</p>\n\n<pre><code>2016/04/02 23:21:08 proto: MC_Feed.AddressBook: illegal tag 0 (wire type 0)\n</code></pre>\n\n<p>The go code is something I got from the net and modified a little:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/golang/protobuf/proto\"\n    \"encoding/hex\"\n    \"./Simple\"\n    \"log\"\n    \"net\"\n)\n\nconst (\n    srvAddr         = \"239.0.0.222:345\"\n    maxDatagramSize = 8192\n)\n\nfunc main() {\n    serveMulticastUDP(srvAddr, msgHandler)\n}\n\n\nfunc msgHandler(src *net.UDPAddr, n int, b []byte) {\n    log.Println(n, \"bytes read from\", src)\n    log.Println(hex.Dump(b[:n]))\n    newTest := &amp;MC_Feed.AddressBook{}\n    err := proto.Unmarshal(b, newTest)\n    log.Println(err)\n}\n\nfunc serveMulticastUDP(a string, h func(*net.UDPAddr, int, []byte)) {\n    addr, err := net.ResolveUDPAddr(\"udp\", a)\n    if err != nil {\n        log.Fatal(err)\n    }\n    l, err := net.ListenMulticastUDP(\"udp\", nil, addr)\n    l.SetReadBuffer(maxDatagramSize)\n    for {\n        b := make([]byte, maxDatagramSize)\n        n, src, err := l.ReadFromUDP(b)\n        if err != nil {\n            log.Fatal(\"ReadFromUDP failed:\", err)\n        }\n        h(src, n, b)\n    }\n}\n</code></pre>\n"}, {"tags": ["linux", "ssl", "go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1459646438, "post_id": 36380233, "comment_id": 60378527, "body": "Please don&#39;t use &quot;this&quot;, every time a go dev uses &quot;this&quot; or &quot;self&quot;, god kills a kitten."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 2, "creation_date": 1459647704, "post_id": 36380233, "comment_id": 60378763, "body": "Except god doesn&#39;t exists thus you can use &quot;this&quot; of &quot;self&quot; because everyone knows what it is and will not confuse it with any other variable. Like <code>t</code> or <code>r</code>, for example, used everywhere even in the runtime."}], "answers": [{"comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1459652392, "post_id": 36380453, "comment_id": 60379701, "body": "Well, you never explained what <code>this</code> is. Some Go packages, even the sys ones, could return a non-nil type even if there was an error (for example, the <code>Open</code> command falling in <code>that</code>).. If you wrote <code>this</code> yourself, than you&#39;d have to ensure all logic of <code>that</code> produces nil.  (PS, see why we don&#39;t use <code>this</code> and just call it <code>cert</code> instead?)"}], "tags": [], "owner": {"reputation": 319, "user_id": 1140105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4cccdb88eea9d96de6d2180390a266c8?s=128&d=identicon&r=PG", "display_name": "mappu", "link": "https://stackoverflow.com/users/1140105/mappu"}, "is_accepted": true, "score": 0, "last_activity_date": 1459644847, "creation_date": 1459644847, "answer_id": 36380453, "question_id": 36380233, "link": "https://stackoverflow.com/questions/36380233/golang-panic-in-tls-conn-read-only-on-linux/36380453#36380453", "title": "Golang panic in tls conn Read - only on linux?", "body": "<p>OK, linux builds are producing the error <code>x509: certificate signed by unknown authority</code>.</p>\n\n<p>But</p>\n\n<ul>\n<li><p>the certificate is valid</p>\n\n<ul>\n<li><code>crypto/x509/root_unix.go</code> looks in <code>/etc/ssl/certs</code> which is world-readable</li>\n<li>but <code>openssl s_client</code> is hanging on <code>-showcerts -verify</code>, pointing to some issue with my OS network configuration</li>\n</ul></li>\n<li><p>for some reason the <code>if</code> block below is being entered regardless of the error</p>\n\n<ul>\n<li>but i was storing it as a <code>net.Conn</code> instead of a pointer, so it's not <code>nil</code>-able.</li>\n</ul></li>\n</ul>\n\n<p>Calling this solved, sorry for the noise. Hopefully this debugging story helps someone else in the future</p>\n"}], "owner": {"reputation": 319, "user_id": 1140105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4cccdb88eea9d96de6d2180390a266c8?s=128&d=identicon&r=PG", "display_name": "mappu", "link": "https://stackoverflow.com/users/1140105/mappu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 36380453, "answer_count": 1, "score": 0, "last_activity_date": 1459644847, "creation_date": 1459643010, "last_edit_date": 1459643356, "question_id": 36380233, "link": "https://stackoverflow.com/questions/36380233/golang-panic-in-tls-conn-read-only-on-linux", "title": "Golang panic in tls conn Read - only on linux?", "body": "<p>I'm using golang <code>crypto/tls</code> to process a custom line-oriented message protocol.</p>\n\n<p>This approach works fine on windows:</p>\n\n<pre><code>var fullBuffer string\n\nfor {\n\n    // If we're not connected, attempt reconnect\n    if this.conn == nil {\n\n        if this.IsSecure() {\n            this.conn, err = tls.Dial(\"tcp\", this.GetHostOnly(), nil)\n        } else {\n            this.conn, err = net.Dial(\"tcp\", this.GetHostOnly())\n        }\n\n        if err == nil {\n            // log and continue\n        }\n    }\n\n    // Read from socket into our local buffer (blocking)\n    if this.conn != nil {\n        readBuff := make([]byte, 4096)\n        nbytes, err = this.conn.Read(readBuff)\n        if nbytes &gt; 0 {\n            fullBuffer += string(readBuff[0:nbytes])\n        }\n    }\n</code></pre>\n\n<p>Pretty straightforward - and it works fine on win64.</p>\n\n<p>But when i try to run it on Linux (debian 8 - both i386 and amd64 - both golang 1.5 native and 1.6 crosscompiled from windows) i get the following panic:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x0 pc=0x4ec8b4]\n\ngoroutine 8 [running]:\npanic(0x8237780, 0x18522030)\n    C:/Go/src/runtime/panic.go:464 +0x326\ncrypto/tls.(*Conn).Handshake(0x0, 0x0, 0x0)\n    C:/Go/src/crypto/tls/conn.go:1023 +0x198\ncrypto/tls.(*Conn).Read(0x0, 0x18597000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    C:/Go/src/crypto/tls/conn.go:922 +0x5e\nmylib.(*MyConnection).worker(0x18512480)\n    C:/gopath/src/mylib/mylib.go:342 +0x200\n</code></pre>\n\n<p>The Read call is failing because it's somehow passing nil to the TLS handshake.</p>\n\n<p>What's going wrong here?</p>\n\n<p>And, why is the problem isolated to linux?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8395, "user_id": 5152001, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/2TlSo.jpg?s=128&g=1", "display_name": "Glen Thomas", "link": "https://stackoverflow.com/users/5152001/glen-thomas"}, "edited": false, "score": 0, "creation_date": 1459640877, "post_id": 36379852, "comment_id": 60377445, "body": "So, you have told us what you are doing. Is there a question you have?"}], "answers": [{"tags": [], "owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "is_accepted": true, "score": 0, "last_activity_date": 1459639785, "creation_date": 1459639785, "answer_id": 36379885, "question_id": 36379852, "link": "https://stackoverflow.com/questions/36379852/converting-a-byte-containing-strings-into-decimal-values/36379885#36379885", "title": "Converting a []byte containing strings into decimal values", "body": "<p>You can cast <code>byte</code> to <code>int</code> like this:</p>\n\n<pre><code>NumArray[i] = int(myArray[i])\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6150495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a21b7e3f8800b38f4bf3c28d1b0887?s=128&d=identicon&r=PG&f=1", "display_name": "struggling college kid", "link": "https://stackoverflow.com/users/6150495/struggling-college-kid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 36379885, "answer_count": 1, "score": 0, "last_activity_date": 1459639785, "creation_date": 1459639512, "question_id": 36379852, "link": "https://stackoverflow.com/questions/36379852/converting-a-byte-containing-strings-into-decimal-values", "title": "Converting a []byte containing strings into decimal values", "body": "<p>I am trying to take a string and convert each value in the string into the decimal ASCII value. I first converted the string into the []byte type and i want to take each element of the []byte and convert it into decimal ASCII value. Here is my code: </p>\n\n<pre><code>myArray := []byte(password) // convert string into []byte type\nNumArray := [len(password)]int // create second []int type to store the    converted []byte elements\nfor i := 0; i &lt; len(myArray); i++{\n                                /*  I need some help to convert each element in myArray into ASCII decimal value and then store it into \n                                    NumArray.\n                                */\nfmt.Printf(\"%d\\n\", myArray[i]) //prints out what the converted values should be\nfmt.Print(NumArray[i]) //prints out the stored converted value for comparison\n}\n</code></pre>\n\n<p>Edit: the string is supposed to be a password and so can contain any value</p>\n"}, {"tags": ["go", "struct", "slice"], "comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1459637893, "post_id": 36379502, "comment_id": 60376705, "body": "just declare it like the other fields. &quot;s []string&quot; in this case; the error pretty clearly tells you what&#39;s wrong."}, {"owner": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "reply_to_user": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1459638602, "post_id": 36379502, "comment_id": 60376884, "body": "Thanks, but if i declare it like you said, what&#39;s the difference between a slice declaration and an array declaration?"}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1459639569, "post_id": 36379502, "comment_id": 60377104, "body": "one thing is that part of the <i>type</i> of an array is it&#39;s length, so an array of 3 elements is not the same type as an array of 4 elements, so if you declare an array such as var n [3]int then you have an array of 3 ints, with slice in the same context you write: var []int, without giving the length. I want to say just don&#39;t worry about arrays; really they aren&#39;t directly useful to us in nearly all cases."}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1459639777, "post_id": 36379502, "comment_id": 60377163, "body": "<i>make</i> does let you does let you specify a length and capacity for a slice but those can both change. When you use make Go creates an unnamed array and returns a slice of it, which is then your only means of accessing that array directly. If you outgrow the array then Go can make you a new, larger one and your slice will now point to it."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1459639837, "post_id": 36379502, "comment_id": 60377172, "body": "@Snowman Forgive me, but I can not agree with the statement that arrays are not directly useful, let alone in nearly all cases. For any IO based on fixed size, arrays are the <i>only</i> way to go. Speaking of fixed sizes, circular buffers come to my mind, too."}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1459640066, "post_id": 36379502, "comment_id": 60377231, "body": "@MarkusWMahlberg. Fair enough. I&#39;m not saying they don&#39;t serve a purpose but I&#39;ve yet to need one."}], "answers": [{"comments": [{"owner": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "edited": false, "score": 0, "creation_date": 1459638563, "post_id": 36379707, "comment_id": 60376868, "body": "Thanks, but if i don&#39;t want to initialize the slice (meaning - i don&#39;t want to specify the number of elements in it), how would i do it?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "edited": false, "score": 0, "creation_date": 1459638947, "post_id": 36379707, "comment_id": 60376962, "body": "&lt;del&gt;Simply remove the number in make, like <code>s: make([]string)</code>.&lt;/del&gt;  It might be a good idea to retake <a href=\"http://tour.golang.org\" rel=\"nofollow noreferrer\">tour.golang.org</a> , and reading <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">Effective Go</a> surely does not hurt, even if it is the second or third time."}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "reply_to_user": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "edited": false, "score": 1, "creation_date": 1459639063, "post_id": 36379707, "comment_id": 60377000, "body": "@MarkusWMahlberg that won&#39;t work - slice length is required as an argument to <code>make</code>.  @Gambit2007 - if you don&#39;t want to initialize it, then just leave it as its zero value (remove the initialization entirely). It will be nil, and will have a length of 0. You can initialize it later if you want."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1459639162, "post_id": 36379707, "comment_id": 60377025, "body": "@joshlf Taking my own advice. Thank you."}, {"owner": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "edited": false, "score": 0, "creation_date": 1459639165, "post_id": 36379707, "comment_id": 60377027, "body": "so you mean like this: s []string? wouldn&#39;t that just be an array declaration?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "edited": false, "score": 0, "creation_date": 1459639545, "post_id": 36379707, "comment_id": 60377100, "body": "@Gambit2007 Please see my edit. Please be also advised that SO is not a forum. Instead of refining your question in the comments to answers, it is better to edit the original question to better reflect your requirements. However, it <i>does</i> make sense to ping the participants about the update, of course."}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 4, "last_activity_date": 1459639389, "last_edit_date": 1459639389, "creation_date": 1459638303, "answer_id": 36379707, "question_id": 36379502, "link": "https://stackoverflow.com/questions/36379502/go-declaring-a-slice-inside-a-struct/36379707#36379707", "title": "Go: declaring a slice inside a struct?", "body": "<p>You can <em>declare</em> a slice in a struct declaration, but you can not initialize it. You have to do this by different means.</p>\n\n<pre><code>// Keep in mind that lowercase identifiers are\n// not exported and hence are inaccessible\ntype House struct {\n    s []string\n    name string\n    rooms []room\n}\n\n// So you need accessors or getters as below, for example\nfunc(h *House) Rooms()[]room{\n    return h.rooms\n}\n\n// Since your fields are inaccessible, \n// you need to create a \"constructor\"\nfunc NewHouse(name string) *House{\n    return &amp;House{\n        name: name,\n        s: make([]string, 3),\n        rooms: make([]room, 3),\n    }\n}\n</code></pre>\n\n<p>Please see the above as a <strong><kbd><a href=\"http://play.golang.org/p/5bzAZhohcD\" rel=\"nofollow\">runnable example on Go Playground</a></kbd></strong></p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>To Initialize the struct partially, as requested in the comments, one can simply change</p>\n\n<pre><code>func NewHouse(name string) *House{\n    return &amp;House{\n        name: name,\n    }\n}\n</code></pre>\n\n<p>Please see the above as a <strong><kbd><a href=\"http://play.golang.org/p/He_sznEsG0\" rel=\"nofollow\">runnable example on Go Playground</a></kbd></strong>, again</p>\n"}, {"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": true, "score": 2, "last_activity_date": 1459639201, "creation_date": 1459639201, "answer_id": 36379806, "question_id": 36379502, "link": "https://stackoverflow.com/questions/36379502/go-declaring-a-slice-inside-a-struct/36379806#36379806", "title": "Go: declaring a slice inside a struct?", "body": "<p>First off you cannot assign/initialize inside the struct. The := operator declares and assigns. You can however, achieve the same result simply.</p>\n\n<p>Here is a simple, trivial example that would do roughly what you're trying:</p>\n\n<pre><code>type house struct {\n    s []string\n}\n\nfunc main() {\n    h := house{}\n    a := make([]string, 3)\n    h.s = a\n}\n</code></pre>\n\n<p>I've never written one that way, but if it servers your purpose... it compiles anyway.</p>\n"}], "owner": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7679, "favorite_count": 1, "accepted_answer_id": 36379806, "answer_count": 2, "score": 5, "last_activity_date": 1459639389, "creation_date": 1459636575, "question_id": 36379502, "link": "https://stackoverflow.com/questions/36379502/go-declaring-a-slice-inside-a-struct", "title": "Go: declaring a slice inside a struct?", "body": "<p>I have the following code:</p>\n\n<pre><code>type room struct {\n    width float32\n    length float32\n}\ntype house struct{\n    s := make([]string, 3)\n    name string\n    roomSzSlice := make([]room, 3)\n} \n\nfunc main() {\n\n\n}\n</code></pre>\n\n<p>And when i try to build and run it i get the following errors:</p>\n\n<pre><code>c:\\go\\src\\test\\main.go:10: syntax error: unexpected :=\nc:\\go\\src\\test\\main.go:11: non-declaration statement outside function body\nc:\\go\\src\\test\\main.go:12: non-declaration statement outside function body\nc:\\go\\src\\test\\main.go:13: syntax error: unexpected }\n</code></pre>\n\n<p>What did i do wrong?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "import", "package"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1459636688, "post_id": 36379189, "comment_id": 60376385, "body": "I noticed u have <code>Documents</code> in the error message. Just a guess, but what is your $GOPATH? And does all of your go code reside in <code>$GOPATH&#47;src&#47;</code> somewhere?  Also, use the full import path for the protobuf package, no relative paths."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1459636810, "post_id": 36379189, "comment_id": 60376411, "body": "&quot;imported and not used&quot; basically says it all, doesn&#39;t it?"}, {"owner": {"reputation": 5898, "user_id": 817659, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc6960319324ecebe786580dfca13f07?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/817659/ivan"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1459644239, "post_id": 36379189, "comment_id": 60378136, "body": "@Markus, But why is that and error? My program runs otherwise if I remove that import. In other words, it is being treated as an error, not a warning."}, {"owner": {"reputation": 5898, "user_id": 817659, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc6960319324ecebe786580dfca13f07?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/817659/ivan"}, "edited": false, "score": 0, "creation_date": 1459644907, "post_id": 36379189, "comment_id": 60378254, "body": "@educan, why would that matter. It is clearly finding the package."}, {"owner": {"reputation": 5898, "user_id": 817659, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc6960319324ecebe786580dfca13f07?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/817659/ivan"}, "edited": false, "score": 0, "creation_date": 1459646701, "post_id": 36379189, "comment_id": 60378592, "body": "Looks like golang treats unused variables as errors. As soon as I patched it all, it works. See edit above for solution"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1459686864, "post_id": 36379189, "comment_id": 60387756, "body": "@Ivan Since the Go compiler says so. The reason is that unnecessary imports just bloat the compiled binary."}], "owner": {"reputation": 5898, "user_id": 817659, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc6960319324ecebe786580dfca13f07?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/817659/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459646769, "creation_date": 1459634195, "last_edit_date": 1459646769, "question_id": 36379189, "link": "https://stackoverflow.com/questions/36379189/importing-a-google-protocol-buffer-generated-package", "title": "Importing a google protocol buffer generated package", "body": "<p>I generated a .go file from a .proto file. I added the .go file generated by GPB underneath my local project directory in mdproto directory. My package is called mdproto.go.</p>\n\n<p>In go, I say</p>\n\n<pre><code>package main\n\nimport (\n    \"./mdproto\"\n    \"encoding/hex\"\n    \"log\"\n    \"net\"\n    \"time\"\n)\n... more go stufff\n</code></pre>\n\n<p>But when I try to run it, the output is as below. Not sure what I am doing wrong.</p>\n\n<pre><code>[idf@node1 9664255]$sudo go run gistfile1.go \n# command-line-arguments\n./gistfile1.go:4: imported and not used: \"_/home/idf/Documents/go/9664255/mdproto\" as MarketData\n</code></pre>\n\n<p>EDIT: This fixes it:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/golang/protobuf/proto\"\n    \"./mdproto\"\n    \"encoding/hex\"\n    \"log\"\n    \"net\"\n    \"time\"\n)\n\nconst (\n    srvAddr         = \"239.0.0.222:345\"\n    maxDatagramSize = 8192\n)\n\nfunc main() {\n    md :=  &amp;MarketData.MD {\n            Firm: int64(1),\n            Id  : int64(1),            \n            Bid : float64(17),\n            Ask : float64(18),            \n            }\n    data, err := proto.Marshal(md)\n\n    log.Println(data, err)\n\n    go ping(srvAddr)\n    serveMulticastUDP(srvAddr, msgHandler)\n}\n\netc...\n</code></pre>\n"}, {"tags": ["json", "go", "mgo"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1459631911, "post_id": 36378725, "comment_id": 60375017, "body": "Have you actually tried? <a href=\"http://play.golang.org/p/7OFHTQB0I_\" rel=\"nofollow noreferrer\">play.golang.org/p/7OFHTQB0I_</a>"}], "answers": [{"tags": [], "owner": {"reputation": 235, "user_id": 4783884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac84df6f081961c434a45b71a098222?s=128&d=identicon&r=PG&f=1", "display_name": "Paul A. Fortin", "link": "https://stackoverflow.com/users/4783884/paul-a-fortin"}, "is_accepted": true, "score": 2, "last_activity_date": 1459651718, "last_edit_date": 1495542692, "creation_date": 1459651718, "answer_id": 36381094, "question_id": 36378725, "link": "https://stackoverflow.com/questions/36378725/golang-mgo-how-to-create-a-generic-entity-with-common-fields-like-id-creati/36381094#36381094", "title": "Golang &amp; mgo: How to create a generic entity with common fields like _id, creation time, and last update", "body": "<p>This was already answered in <a href=\"https://stackoverflow.com/questions/20849591/storing-nested-structs-with-mgo\">Storing nested structs with mgo</a>,  but it is very easy all you need to do is add <code>bson:\",inline\"</code> on the anonymous inner struct and initialize as normal...  </p>\n\n<p>Here a quick example:</p>\n\n<pre><code>package main\n\nimport (\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\ntype Entity struct {\n    Id         bson.ObjectId `json:\"id\" bson:\"_id\"`\n    InsertedAt time.Time     `json:\"inserted_at\" bson:\"inserted_at\"`\n    LastUpdate time.Time     `json:\"last_update\" bson:\"last_update\"`\n}\n\ntype User struct {\n    Entity    `bson:\",inline\"`\n    Name      string    `json:\"name\" bson:\"name\"`\n    BirthDate time.Time `json:\"birth_date\" bson:\"birth_date\"`\n}\n\nfunc main() {\n    info := &amp;mgo.DialInfo{\n        Addrs:    []string{\"localhost:27017\"},\n        Timeout:  60 * time.Second,\n        Database: \"test\",\n    }\n\n    session, err := mgo.DialWithInfo(info)\n    if err != nil {\n        panic(err)\n    }\n    defer session.Close()\n    session.SetMode(mgo.Monotonic, true)\n    //  c := session.DB(\"test\").C(\"users\")\n\n    user := User{\n        Entity:    Entity{\"123456789098\", time.Now().UTC(), time.Now().UTC()},\n        Name:      \"John Belushi\",\n        BirthDate: time.Date(1959, time.February, 28, 0, 0, 0, 0, time.UTC),\n    }\n\n    session.DB(\"test\").C(\"users\").Insert(user)\n}\n</code></pre>\n"}], "owner": {"reputation": 8678, "user_id": 278659, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a10f8a52a8c247d8e20ee9ab59ee22f2?s=128&d=identicon&r=PG", "display_name": "j3d", "link": "https://stackoverflow.com/users/278659/j3d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 0, "accepted_answer_id": 36381094, "answer_count": 1, "score": 0, "last_activity_date": 1459651718, "creation_date": 1459631359, "question_id": 36378725, "link": "https://stackoverflow.com/questions/36378725/golang-mgo-how-to-create-a-generic-entity-with-common-fields-like-id-creati", "title": "Golang &amp; mgo: How to create a generic entity with common fields like _id, creation time, and last update", "body": "<p>Given the following <code>struct</code>:</p>\n\n<pre><code>package models\n\nimport (\n    \"time\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\ntype User struct {\n    Id         bson.ObjectId `json:\"id\" bson:\"_id\"`\n    Name       string        `json:\"name\" bson:\"name\"`\n    BirthDate  time.Time     `json:\"birth_date\" bson:\"birth_date\"`\n    InsertedAt time.Time     `json:\"inserted_at\" bson:\"inserted_at\"`\n    LastUpdate time.Time     `json:\"last_update\" bson:\"last_update\"`\n}\n</code></pre>\n\n<p>... here is how I insert a new user into a Mongo collection:</p>\n\n<pre><code>user := &amp;models.User{\n    bson.NewObjectId(),\n    \"John Belushi\",\n    time.Date(1949, 01, 24),\n    time.now().UTC(),\n    time.now().UTC(),\n}\n\ndao.session.DB(\"test\").C(\"users\").Insert(user)\n</code></pre>\n\n<p>Is it possible to have a generic <code>Entity</code> all other entities inherit from? I've tried this...</p>\n\n<pre><code>type Entity struct {\n    Id         bson.ObjectId `json:\"id\" bson:\"_id\"`\n    InsertedAt time.Time     `json:\"inserted_at\" bson:\"inserted_at\"`\n    LastUpdate time.Time     `json:\"last_update\" bson:\"last_update\"`\n}\n\ntype User struct {\n    Entity\n    Name       string        `json:\"name\" bson:\"name\"`\n    BirthDate  time.Time     `json:\"birth_date\" bson:\"birth_date\"`\n}\n</code></pre>\n\n<p>... but this implies a final result like this:</p>\n\n<pre><code>{\n    \"Entity\": {\n        \"_id\": \"...\",\n        \"inserted_at\": \"...\",\n        \"last_update\": \"...\"\n    },\n    \"name\": \"John Belushi\",\n    \"birth_date\": \"1949-01-24...\"\n}\n</code></pre>\n\n<p>How do I get the following result without repeating common fields in each <code>struct</code>?</p>\n\n<pre><code>{\n    \"_id\": \"...\",\n    \"inserted_at\": \"...\",\n    \"last_update\": \"...\",\n    \"name\": \"John Belushi\",\n    \"birth_date\": \"1949-01-24...\"\n}\n</code></pre>\n"}, {"tags": ["go", "building"], "answers": [{"comments": [{"owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "edited": false, "score": 0, "creation_date": 1459620535, "post_id": 36376991, "comment_id": 60371502, "body": "Yes, as I have already noted in my question, I know that if I delete <code>pkg</code>, it will work. I want to find a way to resolve this is a more cleaner way by just using <code>go</code> tools."}, {"owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "reply_to_user": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "edited": false, "score": 3, "creation_date": 1459620774, "post_id": 36376991, "comment_id": 60371582, "body": "Why are trying to find a hard way to resolve this? In this case, it&#39;s safe to just delete the pkg directory and to my knowledge this is the only way to do what you are looking for. What you are trying to do doesn&#39;t fit within a typical use case and I doubt that it will get solved by adding the functionality in the current tool chain."}, {"owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "edited": false, "score": 0, "creation_date": 1459621402, "post_id": 36376991, "comment_id": 60371800, "body": "Hmm yes, it may not be a typical use case, but shouldn\u2019t <code>go install -a</code>, rebuild and install all the dependent packages correctly. And with go being a tool chain, is there a defined set of guidelines which say how we can work across multiple go version. Me personally as a developer, this is fine. However, I wanted to have a generic solution that I can communicate to all my team members who are just using my executable and are not <code>go developers</code>."}, {"owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1459630608, "post_id": 36376991, "comment_id": 60374626, "body": "@RickyA since the development is happening in parallel between my go-based backend and the rest of the frontend, we just push the commits in and the frontend team just builds/runs again using Makefile - <code>make clean &amp;&amp; make &amp;&amp; make run</code>. So, they aren&#39;t using binaries."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 2, "creation_date": 1459630704, "post_id": 36376991, "comment_id": 60374663, "body": "Then add a rm $gopath/pkg to the makefiles"}, {"owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1459630866, "post_id": 36376991, "comment_id": 60374705, "body": "@RickyA Yes, that would be the best workaround to keep it hidden from the rest of the team."}], "tags": [], "owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "is_accepted": true, "score": 3, "last_activity_date": 1459634768, "last_edit_date": 1459634768, "creation_date": 1459620415, "answer_id": 36376991, "question_id": 36376934, "link": "https://stackoverflow.com/questions/36376934/import-object-is-expected-between-different-go-versions/36376991#36376991", "title": "import object is expected between different go versions", "body": "<p>Most likely due to previous compiles. Just delete your $GOLANG/pkg and you are good to go!</p>\n\n<blockquote>\n  <p>another way to resolve this using go tools, other than deleting the pkg folder.</p>\n</blockquote>\n\n<p>The go tool chain is unlikely to be modified to handle this corner use case.</p>\n"}], "owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 36376991, "answer_count": 1, "score": 1, "last_activity_date": 1459634768, "creation_date": 1459620081, "last_edit_date": 1495542246, "question_id": 36376934, "link": "https://stackoverflow.com/questions/36376934/import-object-is-expected-between-different-go-versions", "title": "import object is expected between different go versions", "body": "<p>I switched from go 1.6 to 1.4.2 for faster compilation. When I recompile the earlier compiled binary of 1.6, I get the following error:</p>\n\n<pre><code>import go/pkg/darwin_amd64/github.com/Sirupsen/logrus.a: object is \n[darwin amd64 go1.6 X:none] expected [darwin amd64 go1.4.2 X:precisestack]\n</code></pre>\n\n<p>I have already tried <code>go build -a</code> - which works without any error. And have also tried <code>go install -a</code> and <code>go build</code> - both of these commands throw the above mentioned error.</p>\n\n<p>I already know that, if I delete by <code>go/pkg</code> folder, then it will work. That is the answer of the <a href=\"https://stackoverflow.com/questions/28934618/import-object-is-expected-error-in-golang-1-4-2\">already existing SO question</a></p>\n\n<p>I wanted to know, if there is another way to resolve this using go tools, other than deleting the <code>pkg</code> folder.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1459613455, "creation_date": 1459613455, "answer_id": 36375615, "question_id": 36375596, "link": "https://stackoverflow.com/questions/36375596/block-type-template-functions/36375615#36375615", "title": "&quot;Block&quot;-type template functions", "body": "<p>It is not possible to write a block-type function that works like the built-in define or range actions.</p>\n"}], "owner": {"reputation": 1521, "user_id": 352967, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/636acfae73fe2c7c386159bcc59d3bac?s=128&d=identicon&r=PG", "display_name": "Blake", "link": "https://stackoverflow.com/users/352967/blake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 36375615, "answer_count": 1, "score": 0, "last_activity_date": 1459613455, "creation_date": 1459613362, "question_id": 36375596, "link": "https://stackoverflow.com/questions/36375596/block-type-template-functions", "title": "&quot;Block&quot;-type template functions", "body": "<p>Using <code>http/template</code> is it possible to define a \"block\"-type function that work like the built-in <code>define</code> or <code>range</code>? For example, I'd like to make a function that works like:</p>\n\n<pre><code>&lt;div class=\"page\"&gt;\n  {{doThing}}\n    Large amount of text here...\n  {{end}}\n&lt;/div&gt;\n</code></pre>\n\n<p>I know I can make it work with <code>{{ doThing \"Large amount of text here...\" }}</code>, but that's not quite what I want.</p>\n"}, {"tags": ["go", "websocket", "json-rpc", "gorilla"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1459605193, "post_id": 36372650, "comment_id": 60366039, "body": "This question was also asked at <a href=\"https://groups.google.com/forum/#!topic/gorilla-web/CqBIuUCd0zA\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/gorilla-web/CqBIuUCd0zA</a> and <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/4IKhYSuly9o\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/4IKhYSuly9o</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 2826089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc1389521146dc2e1434ccceae809f3f?s=128&d=identicon&r=PG", "display_name": "Alvaro", "link": "https://stackoverflow.com/users/2826089/alvaro"}, "edited": false, "score": 0, "creation_date": 1459609744, "post_id": 36374063, "comment_id": 60367570, "body": "Ok, I see. But then, is there any way to use a websocket jsonrpc server from a browser?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 27, "user_id": 2826089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc1389521146dc2e1434ccceae809f3f?s=128&d=identicon&r=PG", "display_name": "Alvaro", "link": "https://stackoverflow.com/users/2826089/alvaro"}, "edited": false, "score": 0, "creation_date": 1459609982, "post_id": 36374063, "comment_id": 60367656, "body": "It is not possible to use the JSON-RPC protocol from a browser."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 27, "user_id": 2826089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc1389521146dc2e1434ccceae809f3f?s=128&d=identicon&r=PG", "display_name": "Alvaro", "link": "https://stackoverflow.com/users/2826089/alvaro"}, "edited": false, "score": 0, "creation_date": 1459610177, "post_id": 36374063, "comment_id": 60367712, "body": "@Alvaro You can implement a <a href=\"https://godoc.org/net/rpc#ServerCodec\" rel=\"nofollow noreferrer\">Codec</a> to use the net/rpc package from the browser.  Also, cross link those Google Groups postings so people don&#39;t waste time answering what&#39;s covered here."}, {"owner": {"reputation": 27, "user_id": 2826089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc1389521146dc2e1434ccceae809f3f?s=128&d=identicon&r=PG", "display_name": "Alvaro", "link": "https://stackoverflow.com/users/2826089/alvaro"}, "edited": false, "score": 0, "creation_date": 1459611306, "post_id": 36374063, "comment_id": 60368078, "body": "Yes, the codec seems what I&#39;m looking for. My final goal is just to send a JSON-RPC message through a Websocket connection. Do you know of any examples?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 27, "user_id": 2826089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc1389521146dc2e1434ccceae809f3f?s=128&d=identicon&r=PG", "display_name": "Alvaro", "link": "https://stackoverflow.com/users/2826089/alvaro"}, "edited": false, "score": 0, "creation_date": 1459612251, "post_id": 36374063, "comment_id": 60368391, "body": "Write an adaptor to convert the message based WebSocket API to the stream expected by the net/rpc/json server.  Alternatively, copy the net/rpc/jsonrpc <a href=\"https://golang.org/src/net/rpc/jsonrpc/server.go\" rel=\"nofollow noreferrer\">server.go</a> and modify it to work with the message based WebSocket API."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1459613340, "last_edit_date": 1459613340, "creation_date": 1459604813, "answer_id": 36374063, "question_id": 36372650, "link": "https://stackoverflow.com/questions/36372650/go-websocket-jsonrpc-browser-connection-close/36374063#36374063", "title": "Go websocket jsonrpc browser connection close", "body": "<p>When the server application calls <code>jsonrpc.ServeConn(ws.UnderlyingConn())\n}</code> the server is switching from the WebSocket protocol to the <a href=\"http://www.jsonrpc.org/specification\" rel=\"nofollow\">JSON-RPC</a> protocol.  The browser continues to use the <a href=\"https://tools.ietf.org/html/rfc6455\" rel=\"nofollow\">WebSocket</a> protocol. The connection is closed because one of the peers errors out reading a protocol that it does not expect.</p>\n\n<p>The problem does not happen with the Go client application because this application also switches from the WebSocket protocol to the JSON-RPC protocol.</p>\n\n<p>It is not possible to access the underlying network connection from a browser application.</p>\n\n<p>It is possible to use the net/rpc package with <a href=\"https://godoc.org/net/rpc#ServerCodec\" rel=\"nofollow\">Codec</a> written to use the WebSocket protocol. Another option is to write an adaptor to convert the message based WebSocket API to the stream expected by the net/rpc/jsonrpc server.</p>\n"}], "owner": {"reputation": 27, "user_id": 2826089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc1389521146dc2e1434ccceae809f3f?s=128&d=identicon&r=PG", "display_name": "Alvaro", "link": "https://stackoverflow.com/users/2826089/alvaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 881, "favorite_count": 1, "accepted_answer_id": 36374063, "answer_count": 1, "score": 0, "last_activity_date": 1459613340, "creation_date": 1459596576, "question_id": 36372650, "link": "https://stackoverflow.com/questions/36372650/go-websocket-jsonrpc-browser-connection-close", "title": "Go websocket jsonrpc browser connection close", "body": "<p>I have a WebSocket JSON-RPC server example that I want to use from a browser. When you access the URL \"http:localhost:8080\", the browser opens the WebSocket connection properly. But when the browser sends the WebSocket request, the server closes the WebSocket connection. I can't even see a trace of the RPC method being called on the server.</p>\n\n<p>However, calling the server from a Go client works perfectly.</p>\n\n\n\n<p><strong>server.go</strong></p>\n\n<pre class=\"lang-js prettyprint-override\"><code>package main\n\nimport (\n        \"log\"\n        \"net/http\"\n        \"net/rpc\"\n        \"net/rpc/jsonrpc\"\n        \"github.com/gorilla/websocket\"\n)\n\ntype Service struct{}\n\nfunc (t *Service) Echo(req *string, res *string) error {\n        log.Printf(\"Service.Echo\")\n        *res = *req\n        log.Printf(\"Service.Echo req:%s res:%s\", *req, *res)\n        return nil \n}\n\nvar upgrader = websocket.Upgrader{\n        ReadBufferSize:  1024,\n        WriteBufferSize: 1024,\n}\n\nfunc serveWS(w http.ResponseWriter, r *http.Request) {\n        ws, err := upgrader.Upgrade(w, r, nil)\n        defer ws.Close()\n\n\n        if err != nil {\n                log.Println(err)\n                return\n        }   \n        jsonrpc.ServeConn(ws.UnderlyingConn())\n}\n\nfunc main() {\n        rpc.Register(new(Service))\n        http.Handle(\"/\", http.FileServer(http.Dir(\"web\")))\n        http.HandleFunc(\"/ws\", serveWS)\n        http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p><strong>web/index.html</strong></p>\n\n<pre class=\"lang-js prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;  \n&lt;script type=\"text/javascript\"&gt;\n    var ws = new WebSocket(\"ws://localhost:8080/ws\");\n    ws.onopen = function(ev){\n        alert(\"open\");\n    }\n    ws.onmessage = function(ev){\n        alert(\"message\");\n    }\n    ws.onclose = function(ev){\n        alert(\"close\");\n    }   \n\n    function send() {\n        msg = {\n                method: \"Service.Echo\",\n                params: \"hello\",\n                id: 0\n        };\n        var s = JSON.stringify(msg);\n        alert(s);\n        ws.send(s);\n    }   \n&lt;/script&gt;\n&lt;/head&gt; \n&lt;body&gt;          \n&lt;button onclick='send()'&gt;Send&lt;/button&gt;\n&lt;/body&gt; \n&lt;/html&gt;\n</code></pre>\n\n<p><strong>client.go</strong></p>\n\n<pre class=\"lang-js prettyprint-override\"><code>package main\n\nimport (\n        \"log\"\n        \"net/rpc/jsonrpc\"\n        \"github.com/gorilla/websocket\"\n)\n\nfunc main() {\n        ws, _, err := websocket.DefaultDialer.Dial(\"ws://localhost:8080/ws\", nil)\n        if err != nil {\n                log.Fatal(\"dial:\", err)\n        }\n        defer ws.Close()\n\n        client := jsonrpc.NewClient(ws.UnderlyingConn())\n\n        req := \"hello\"\n        var res string\n        err = client.Call(\"Service.Echo\", &amp;req, &amp;res)\n        if err != nil {\n                log.Fatal(\"Service.Echo error:\", err)\n        }\n        log.Printf(\"Service.Echo: req:%s res:%s\", req, res)\n}\n</code></pre>\n\n<p>Do you know what the problem could be?</p>\n\n<p>Thank you very much.</p>\n\n<p>Cheers</p>\n"}, {"tags": ["json", "dictionary", "go", "interface"], "comments": [{"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 1, "creation_date": 1459595367, "post_id": 36372082, "comment_id": 60362899, "body": "could you post the expected JSON content? I&#39;m afraid you asserted wrong thing into wrong type."}], "answers": [{"tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": true, "score": 0, "last_activity_date": 1459595449, "creation_date": 1459595449, "answer_id": 36372478, "question_id": 36372082, "link": "https://stackoverflow.com/questions/36372082/golang-cannot-access-map-in-interface/36372478#36372478", "title": "Golang - Cannot access map in []interface{}", "body": "<p>Players is a JSON array. Thus you have to convert it to a slice of interface.</p>\n\n<p>Then you can access any element of the slice and casting it to a <code>map[string]interface{}</code> type.</p>\n\n<p>Here's the working example</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc main() {\n    response, err := http.Get(\"http://api.steampowered.com/ISteamUser/GetPlayerSummaries/v0002/?key=2B2A0C37AC20B5DC2234E579A2ABB11C&amp;steamids=76561198132612090\")\n    content, err := ioutil.ReadAll(response.Body)\n    defer response.Body.Close()\n    if err != nil {\n        panic(0)\n    }\n\n    var decoded map[string]interface{}\n    if err := json.Unmarshal(content, &amp;decoded); err != nil {\n        panic(0)\n    }\n\n    players := decoded[\"response\"].(map[string]interface{})[\"players\"]\n    if err != nil {\n        panic(0)\n    }\n\n    sliceOfPlayers := players.([]interface{})\n    fmt.Println((sliceOfPlayers[0].(map[string]interface{}))[\"personaname\"])\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1459601002, "post_id": 36373165, "comment_id": 60364621, "body": "I personally prefer to create structs to strongly type my data, though it is more work."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 1, "creation_date": 1459608304, "post_id": 36373165, "comment_id": 60367034, "body": "There are tools now to auto generate struct types from json and it&#39;s not that hard to Google for them. It shouldn&#39;t take long to come to understand map[string]interface{} is the wrong type of laziness. The interface{} object you end up with is so much more difficult to deal with."}], "tags": [], "owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "is_accepted": false, "score": 2, "last_activity_date": 1459599629, "creation_date": 1459599629, "answer_id": 36373165, "question_id": 36372082, "link": "https://stackoverflow.com/questions/36372082/golang-cannot-access-map-in-interface/36373165#36373165", "title": "Golang - Cannot access map in []interface{}", "body": "<p>Defining a struct type with the expected schema will make your life easier when you want to get the data from it:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n//import \"net/http\"\n//import \"io/ioutil\"\nimport \"encoding/json\"\n\n// you don't need to define everything, only what you need\ntype Player struct {\n    Steamid                  string\n    Communityvisibilitystate int\n    Personaname              string\n    Lastlogoff               int64 // time.Unix(Lastlogoff, 0)\n    Profileurl               string\n    Avatar                   string\n    Avatarmedium             string\n    Avatarfull               string\n    Personastate             int\n    Realname                 string\n    Primaryclanid            string\n    Timecreated              int64 // time.Unix(Timecreated, 0)\n    Personastateflags        int\n    //Loccountrycode           string // e.g. if you don't need this\n}\n\nfunc main() {\n    /*response, err := http.Get(\"http://api.steampowered.com/ISteamUser/GetPlayerSummaries/v0002/?key=2B2A0C37AC20B5DC2234E579A2ABB11C&amp;steamids=76561198132612090\")\n    if err != nil {\n        panic(err)\n    }\n    content, err := ioutil.ReadAll(response.Body)\n    defer response.Body.Close()\n    if err != nil {\n        panic(0)\n    }*/\n    content := []byte(`{\n    \"response\": {\n        \"players\": [\n            {\n                \"steamid\": \"76561198132612090\",\n                \"communityvisibilitystate\": 3,\n                \"profilestate\": 1,\n                \"personaname\": \"Acidic\",\n                \"lastlogoff\": 1459489924,\n                \"profileurl\": \"http://steamcommunity.com/id/ari9/\",\n                \"avatar\": \"https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/bc/bc50a4065c31c606e51dfad329341b2d1f1ac4d3.jpg\",\n                \"avatarmedium\": \"https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/bc/bc50a4065c31c606e51dfad329341b2d1f1ac4d3_medium.jpg\",\n                \"avatarfull\": \"https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/bc/bc50a4065c31c606e51dfad329341b2d1f1ac4d3_full.jpg\",\n                \"personastate\": 3,\n                \"realname\": \"Ari Seyhun\",\n                \"primaryclanid\": \"103582791440552060\",\n                \"timecreated\": 1397199406,\n                \"personastateflags\": 0,\n                \"loccountrycode\": \"TR\"\n            }\n        ]\n\n    }\n}`)\n\n    var decoded struct {\n        Response struct {\n            Players []Player\n        }\n    }\n    if err := json.Unmarshal(content, &amp;decoded); err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"%#v\\n\", decoded.Response.Players)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/gVPRwLFunF\" rel=\"nofollow\">http://play.golang.org/p/gVPRwLFunF</a></p>\n\n<p>You can also create a new named type from <code>time.Time</code> for <code>Timecreated</code> and <code>Lastlogoff</code> with its own <code>UnmarshalJSON</code> function, and immediately convert it to <code>time.Time</code> using <code>time.Unix()</code></p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1069, "favorite_count": 0, "accepted_answer_id": 36372478, "answer_count": 2, "score": 0, "last_activity_date": 1459599629, "creation_date": 1459592858, "last_edit_date": 1459594465, "question_id": 36372082, "link": "https://stackoverflow.com/questions/36372082/golang-cannot-access-map-in-interface", "title": "Golang - Cannot access map in []interface{}", "body": "<p>I have used <code>json.Unmarshal</code> and extracted json content. I then managed to get one layer deeper into the <code>[]interface{}</code> by using the following code:</p>\n\n<pre><code>        response, err := http.Get(\"http://api.steampowered.com/ISteamUser/GetPlayerSummaries/v0002/?key=2B2A0C37AC20B5DC2234E579A2ABB11C&amp;steamids=76561198132612090\")\n        content, err := ioutil.ReadAll(response.Body)\n        defer response.Body.Close()\n        if err != nil {\n            panic(0)\n        }\n\n        var decoded map[string]interface{}\n        if err := json.Unmarshal(content, &amp;decoded); err != nil {\n            panic(0)\n        }\n\n        players := decoded[\"response\"].(map[string]interface{})[\"players\"]\n        if err != nil {\n            panic(0)\n        }\n</code></pre>\n\n<p>Variable players' type is <code>[]interface {}</code> and content is <code>[map[personaname:Acidic]]</code>.</p>\n\n<p>How do I access this map? I've tried <code>players[\"personaname\"]</code> but that doesn't seem to work. Any ideas?</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1459593033, "post_id": 36372062, "comment_id": 60362298, "body": "The main function is returning before the scheduler has time to execute any of the <code>writeOutput</code> goroutines. Use a <code>sync.WaitGroup</code> to wait until all goroutines have finished."}, {"owner": {"reputation": 668, "user_id": 2734319, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1de24f8a9fe6742162f298032b56922?s=128&d=identicon&r=PG", "display_name": "Jeremy Quinton", "link": "https://stackoverflow.com/users/2734319/jeremy-quinton"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1459593878, "post_id": 36372062, "comment_id": 60362496, "body": "@TimCooper thanks for the help I managed to solve the problem using your suggestion. Let me know if you think I could improve that example."}], "answers": [{"comments": [{"owner": {"reputation": 668, "user_id": 2734319, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1de24f8a9fe6742162f298032b56922?s=128&d=identicon&r=PG", "display_name": "Jeremy Quinton", "link": "https://stackoverflow.com/users/2734319/jeremy-quinton"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1459595219, "post_id": 36372236, "comment_id": 60362852, "body": "Thanks I have used your example as the answer as that makes the code more flexible."}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 3, "creation_date": 1459597434, "post_id": 36372236, "comment_id": 60363536, "body": "It is nearly correct, but in case of panic, wg.Done() will not be called and the program will crash with deadlock. To fix it, call <code>defer wg.Done()</code> as a first statement in goroutine."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 1, "creation_date": 1459608587, "post_id": 36372236, "comment_id": 60367128, "body": "Also just don&#39;t panic. Check errors and return early if they&#39;re not nil."}], "tags": [], "owner": {"reputation": 668, "user_id": 2734319, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1de24f8a9fe6742162f298032b56922?s=128&d=identicon&r=PG", "display_name": "Jeremy Quinton", "link": "https://stackoverflow.com/users/2734319/jeremy-quinton"}, "is_accepted": false, "score": 4, "last_activity_date": 1459618389, "last_edit_date": 1459618389, "creation_date": 1459593826, "answer_id": 36372236, "question_id": 36372062, "link": "https://stackoverflow.com/questions/36372062/golang-go-routine-concurrency-behaviour-not-working-as-expected/36372236#36372236", "title": "Golang go routine concurrency behaviour not working as expected", "body": "<p>I managed to solve this with a wait group as suggested in the comments. </p>\n\n<pre><code>package main\n\nimport (\n    \"math/rand\"\n    \"os\"\n    \"strconv\"\n    \"sync\"\n)\n\nfunc main() {\n\n    var wg sync.WaitGroup\n\n    for i := 0; i &lt; 5; i++ {\n        wg.Add(1)\n        go func() {\n            defer wg.Done()\n            writeOutput()\n        }()\n    }\n    wg.Wait()\n\n}\n\nfunc writeOutput() {\n    filename := strconv.Itoa(rand.Intn(10000))\n    file, _ := os.Create(\"/tmp/\" + filename)\n    defer file.Close()\n    file.WriteString(\"test\")\n}\n</code></pre>\n"}], "owner": {"reputation": 668, "user_id": 2734319, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1de24f8a9fe6742162f298032b56922?s=128&d=identicon&r=PG", "display_name": "Jeremy Quinton", "link": "https://stackoverflow.com/users/2734319/jeremy-quinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459753082, "creation_date": 1459592760, "last_edit_date": 1459753082, "question_id": 36372062, "link": "https://stackoverflow.com/questions/36372062/golang-go-routine-concurrency-behaviour-not-working-as-expected", "title": "Golang go routine concurrency behaviour not working as expected", "body": "<p>Below is a simple go example. I have omitted error handling etc intentionally to make the example short. I have a simple for loop calling the writeOutput function 5 times using the go keyword to make the function run concurrently. </p>\n\n<p>What I expect to happen is 5 files are created in /tmp/ with the contents of test. </p>\n\n<p>What happens is that no files are created. </p>\n\n<p>However if I remove the go keyword the code executes as expected. Im overlooking something super obvious. My background is dynamically typed languages like PHP/Ruby so just getting to grips with go and can't understand why 5 files are created when the go keyword exists.   </p>\n\n<pre><code>package main\n\nimport (\n  \"os\"\n  \"math/rand\"\n  \"strconv\"\n)\n\nfunc main() {\n\n  for i := 0; i &lt; 5; i++ {\n   go writeOutput()\n  }\n\n}\n\nfunc writeOutput() {\n  filename := strconv.Itoa(rand.Intn(10000))\n  file, _ := os.Create(\"/tmp/\" + filename)\n  defer file.Close()\n  file.WriteString(\"test\")\n}\n</code></pre>\n"}, {"tags": ["ubuntu", "go", "dependencies"], "answers": [{"tags": [], "owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "is_accepted": true, "score": 2, "last_activity_date": 1459594171, "last_edit_date": 1459594171, "creation_date": 1459593837, "answer_id": 36372239, "question_id": 36371535, "link": "https://stackoverflow.com/questions/36371535/issues-with-golang-dependencies/36372239#36372239", "title": "Issues with goLang dependencies", "body": "<p>For your first question, it's because GL.h is missing from your ubuntu machine. You could get it installed by installing the dev lib as stated as requirement in their <a href=\"https://github.com/go-gl/gl\" rel=\"nofollow\">go-gl github page</a>:</p>\n\n<pre><code>sudo apt-get install libgl1-mesa-dev\n</code></pre>\n\n<p>After this, you could go get the core lib. I've tested on my amazon ubuntu instance and worked fine.</p>\n\n<p>If there still are something missing, try google using the key word:</p>\n\n<pre><code>ubuntu the_missing_file_name is missing\n</code></pre>\n\n<p>Also, I find this page very useful for your installing issues: <a href=\"https://github.com/google/gxui/wiki/Installation\" rel=\"nofollow\">https://github.com/google/gxui/wiki/Installation</a></p>\n\n<p>Basically, install these packages:</p>\n\n<pre><code>sudo apt-get install libgl1-mesa-dev (or freeglut3-dev)\nsudo apt-get install libxrandr-dev\nsudo apt-get install libxcursor-dev\nsudo apt-get install libxi-dev\nsudo apt-get install libxinerama-dev\n</code></pre>\n\n<p>After you installed all the required dev packages, you could go get glfw successfully :)</p>\n"}], "owner": {"reputation": 2686, "user_id": 170501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9eac522c31c923f2bb5640c36d6af51a?s=128&d=identicon&r=PG", "display_name": "silent", "link": "https://stackoverflow.com/users/170501/silent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 36372239, "answer_count": 1, "score": 0, "last_activity_date": 1459594171, "creation_date": 1459589485, "question_id": 36371535, "link": "https://stackoverflow.com/questions/36371535/issues-with-golang-dependencies", "title": "Issues with goLang dependencies", "body": "<p>I'm trying to compile the following github <a href=\"https://github.com/fogleman/nes\" rel=\"nofollow\">project</a>, however I'm having issues with the dependencies. The following go get commands fails with the errors noted below</p>\n\n<pre><code>go get -u github.com/go-gl/glfw/v3.1/glfw\n</code></pre>\n\n<p>fails with the following:</p>\n\n<pre><code># github.com/go-gl/glfw/v3.1/glfw\nIn file included from /home/bob/go/src/github.com/go-gl/glfw/v3.1/glfw/context.go:4:0:\nglfw/include/GLFW/glfw3.h:153:21: fatal error: GL/gl.h: No such file or directory\ncompilation terminated.\n</code></pre>\n\n<p>and</p>\n\n<pre><code>go get github.com/go-gl/gl/v2.1-core/gl\n\npackage github.com/go-gl/gl/v2.1-core/gl: cannot find package \"github.com/go-gl/gl/v2.1-core/gl\" in any of:\n        /usr/local/go/src/github.com/go-gl/gl/v2.1-core/gl (from $GOROOT)\n        /home/bob/go/src/github.com/go-gl/gl/v2.1-core/gl (from $GOPATH)\n</code></pre>\n\n<p>I have golang installed in <code>/usr/local/go</code> and the following in ~/.profile:</p>\n\n<pre><code>export GOROOT=/usr/local/go\nexport GOPATH=$HOME/go\nexport PATH=$PATH:$GOROOT/bin\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1667, "user_id": 1278288, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d2990d040397e01aa43493215ee7c93d?s=128&d=identicon&r=PG", "display_name": "nishantjr", "link": "https://stackoverflow.com/users/1278288/nishantjr"}, "edited": false, "score": 0, "creation_date": 1459586785, "post_id": 36371073, "comment_id": 60360789, "body": "This might be a little tricky considering the multi-process architecture of Chrome. Perhaps have the web page periodically send pings to the server via ajax, and time out if ping is not received?"}], "answers": [{"tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 2, "last_activity_date": 1459589942, "creation_date": 1459589942, "answer_id": 36371605, "question_id": 36371073, "link": "https://stackoverflow.com/questions/36371073/using-go-to-determine-if-a-process-program-has-been-terminated/36371605#36371605", "title": "Using Go to determine if a process/program has been terminated", "body": "<p>You can use the <a href=\"https://golang.org/pkg/os/exec/#Cmd.Wait\" rel=\"nofollow\">Wait()</a> function on cmdExec to wait for the child process to exit. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main(){\n    // Setup the application and arguments.\n    cmd := \"chrome\"\n    // URL will be local webserver.\n    args := []string{\"--user-data-dir=c:\\\\\",\"--window-size=800,600\",\"--app=http://www.google.com\"}\n\n    // Start local webserver here.\n    // ...\n\n    // Prepare Chrome in app mode.\n    cmdExec := exec.Command(cmd, args...);\n\n    // Start Chrome asynchronously.\n    cmdExec.Start()\n\n    // Show to the user on the command line that the application is running.\n    fmt.Println(\"Application in progress! Please close webapp to close webserver!\")\n\n    // Keep the webserver running, do web app things...\n\n    // Watch for that process we started earlier. If the user closes that Chrome window\n    // Then alert the user that the webserver is now closing down.\n\n    // Should probably handle the error here\n    _ = cmdExec.Wait()      \n\n    // And we are done!\n    fmt.Println(\"Application exit!\")\n}\n</code></pre>\n\n<p>Tested it locally with Chromium. After closing the browser window, it takes a few seconds before the Chromium process exists and then Wait() returns.</p>\n"}], "owner": {"reputation": 3739, "user_id": 405763, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6b82901f73413a8061f2d0784d7726b8?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/405763/joseph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 36371605, "answer_count": 1, "score": 0, "last_activity_date": 1461483226, "creation_date": 1459586201, "last_edit_date": 1461483226, "question_id": 36371073, "link": "https://stackoverflow.com/questions/36371073/using-go-to-determine-if-a-process-program-has-been-terminated", "title": "Using Go to determine if a process/program has been terminated", "body": "<p>I am making a small desktop web application with Go. This application will run as a local web server and a Chrome window will be generated in 'app' mode. The Go program will continue to run the web server during this time.</p>\n\n<p>I need to watch for the moment the user kills this Chrome window, so that the web server can close down too.</p>\n\n<p>I've made a comment below showing where I need assistance.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main(){\n    // Setup the application and arguments.\n    cmd := \"chrome\"\n    // URL will be local webserver.\n    args := []string{\"--user-data-dir=c:\\\\\",\"--window-size=800,600\",\"--app=http://www.google.com\"}\n\n    // Start local webserver here.\n    // ...\n\n    // Prepare Chrome in app mode.\n    cmdExec := exec.Command(cmd, args...);\n\n    // Start Chrome asynchronously.\n    cmdExec.Start()\n\n    // Show to the user on the command line that the application is running.\n    fmt.Println(\"Application in progress! Please close webapp to close webserver!\")\n\n    // Keep the webserver running, do web app things...\n\n    // Watch for that process we started earlier. If the user closes that Chrome window\n    // Then alert the user that the webserver is now closing down.\n\n    // This is where I need help!\n    watchForProcessThatWeStartedEarlierForClosure...()//????        \n\n    // And we are done!\n    fmt.Println(\"Application exit!\")\n}\n</code></pre>\n"}, {"tags": ["go", "http-headers", "nlp", "content-type", "ibm-watson"], "comments": [{"owner": {"reputation": 293, "user_id": 6148139, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f4faf207fc668f0ba3a26b108eafd517?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Pozharskii", "link": "https://stackoverflow.com/users/6148139/alexander-pozharskii"}, "edited": false, "score": 0, "creation_date": 1459582772, "post_id": 36370407, "comment_id": 60359731, "body": "Also, given curl request (curl -u &quot;{username}&quot;:&quot;{password}&quot; -F training_data=@train.csv -F training_metadata=&quot;{\\&quot;language\\&quot;:\\&quot;en\\&quot;,\\&quot;name\\&quot;:\\&quot;My Classifier\\&quot;}&quot; &quot;<a href=\"https://gateway.watsonplatform.net/natural-language-classifier/api/v1/classifiers&quot;\" rel=\"nofollow noreferrer\">gateway.watsonplatform.net/natural-language-classifier/api/&zwnj;&#8203;v1/&hellip;</a>) works fine."}], "answers": [{"tags": [], "owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "is_accepted": true, "score": 3, "last_activity_date": 1459633752, "creation_date": 1459633752, "answer_id": 36379116, "question_id": 36370407, "link": "https://stackoverflow.com/questions/36370407/how-do-i-send-multipart-form-data-in-an-http-request-for-watson-nlc-training/36379116#36379116", "title": "How do I send multipart form data in an HTTP request (for Watson NLC training)?", "body": "<p>Note that <em>curl</em> is sending a \"Content-Type\" header of <code>multipart/form-data</code>. Your Go program is sending a \"Content-Disposition\" header with just <code>form-data</code> (note the difference, it lacking the leading <code>multipart</code> composite top-level media type), but it doesn't take care of sending the correct \"Content-Type\" header for the containing HTTP request.</p>\n\n<p>Go's <code>multipart.Writer</code> type's <a href=\"https://golang.org/src/mime/multipart/writer.go?s=2132:2207#L127\" rel=\"nofollow\"><code>CreateFormFile</code> method does the same</a>, but again, that's only part of the job:</p>\n\n<pre><code>h.Set(\"Content-Disposition\",\n        fmt.Sprintf(`form-data; name=\"%s\"; filename=\"%s\"`,\n                escapeQuotes(fieldname), escapeQuotes(filename)))\n</code></pre>\n\n<p>To get the proper \"Content-Type\" header value, you need to use <a href=\"https://golang.org/pkg/mime/multipart/#Writer.FormDataContentType\" rel=\"nofollow\"><code>multipart.Writer.FormDataContentType</code></a>. To put that value to use, you'll need to get your <code>multipart.Writer</code> into your <code>WatsonClassifier.request</code> method, so that you can set the content type on your <code>http.Request</code> instance:</p>\n\n<pre><code>req.Header.Set(\"Content-Type\", writer.FormDataContentType())\n</code></pre>\n\n<p>Alternately, add another parameter to <code>WatsonClassifier.request</code> for the content type, and pass the result of <code>FormDataContentType</code> as the argument from the call site in <code>WatsonClassifier.Train</code>.</p>\n\n<p>Let us know if that does the trick.</p>\n"}], "owner": {"reputation": 293, "user_id": 6148139, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f4faf207fc668f0ba3a26b108eafd517?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Pozharskii", "link": "https://stackoverflow.com/users/6148139/alexander-pozharskii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 36379116, "answer_count": 1, "score": 3, "last_activity_date": 1459642762, "creation_date": 1459581655, "last_edit_date": 1459642762, "question_id": 36370407, "link": "https://stackoverflow.com/questions/36370407/how-do-i-send-multipart-form-data-in-an-http-request-for-watson-nlc-training", "title": "How do I send multipart form data in an HTTP request (for Watson NLC training)?", "body": "<p>I'm writing application that'll use Watson Natural Language Classifier (\"NLC\").\nWhen I send an HTTP POST request against the <a href=\"http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/natural-language-classifier/api/v1/#create_classifier\" rel=\"nofollow\"><em>v1/classifiers</em> URI path</a> with the following request message body, the server responds with status code 415 (<em>Unsupported Media Type</em>):</p>\n\n<pre><code>--04fef47728eb08148fe9c7b18dd42b75abd75ebf752fd3412a85aa3af075\nContent-Disposition: form-data; name=\"training_data\"; filename=\"data.csv\"\nContent-Type: text/csv\n\nHow hot is it today?;temperature\nIs it hot outside?;temperature\nWill it be uncomfortably hot?;temperature\nWill it be sweltering?;temperature\nHow cold is it today?;temperature\nIs it cold outside?;temperature\nWill it be uncomfortably cold?;temperature\nWill it be frigid?;temperature\nWhat is the expected high for today?;temperature\nWhat is the expected temperature?;temperature\nWill high temperatures be dangerous?;temperature\nIs it dangerously cold?;temperature\nWhen will the heat subside?;temperature\nIs it hot?;temperature\nIs it cold?;temperature\nHow cold is it now?;temperature\nWill we have a cold day today?;temperature\nWhen will the cold subside?;temperature\nWhat highs are we expecting?;temperature\nWhat lows are we expecting?;temperature\nIs it warm?;temperature\nIs it chilly?;temperature\nWhat's the current temp in Celsius?;temperature\nWhat is the temperature in Fahrenheit?;temperature\n--04fef47728eb08148fe9c7b18dd42b75abd75ebf752fd3412a85aa3af075\nContent-Disposition: form-data; name=\"training_metadata\"; filename=\"metadata.json\"\nContent-Type: application/json\n\n{\"language\": \"en\"}\n</code></pre>\n\n<p>The 415 status code suggests a problem with the content type, but it <em>seems</em> like all the MIME types are correct.</p>\n\n<p>My code (written in Go):</p>\n\n<pre><code>func (w WatsonClassifier) createFormFile(writer *multipart.Writer, fieldname string, filename string, contentType string) (io.Writer, error)     {\n    h := make(textproto.MIMEHeader)\n    h.Set(\"Content-Disposition\",\n        fmt.Sprintf(`form-data; name=\"%s\"; filename=\"%s\"`,\n            fieldname, filename))\n    h.Set(\"Content-Type\", contentType)\n    return writer.CreatePart(h)\n}\n\nfunc (w WatsonClassifier) request(method string, apiUrl string, body io.Reader) (string, error) {\n    url := w.url + \"/\" + apiUrl\n    req, err := http.NewRequest(method, url, body)\n    if err != nil {\n        return \"\", err\n    }\n    req.SetBasicAuth(w.username, w.password)\n    client := http.Client{}\n    resp, err := client.Do(req)\n    if resp.StatusCode != 200 {\n        answer, _ := ioutil.ReadAll(resp.Body)\n        fmt.Println(string(answer))\n        return \"\", errors.New(\"Watson returned wrong status code : \" + resp.Status)\n    }\n    answer, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        return \"\", err\n    }\n    return string(answer), nil\n}\n\nfunc (w WatsonClassifier) Train(data []ClassifierCategory) (Classifier, error) {\n    table := w.buildTable(data)\n    str := w.buildCsv(data)\n    buf := new(bytes.Buffer)\n    writer := multipart.NewWriter(buf)\n    data_part, err := w.createFormFile(writer, \"training_data\", \"data.csv\", \"text/csv\")\n    if err != nil {\n        return WatsonClassifier{}, err\n    }\n    data_part.Write([]byte(str))\n    metadata_part, err := w.createFormFile(writer, \"training_metadata\", \"metadata.json\", \"application/json\")\n    if err != nil {\n        return WatsonClassifier{}, err\n    }\n    metadata_json := \"{\\\"language\\\": \\\"\" + w.Language + \"\\\"}\"\n    metadata_part.Write([]byte(metadata_json))\n    fmt.Println(buf.String())\n    answer, err := w.request(\"POST\", \"v1/classifiers\", buf)\n    if err != nil {\n        return WatsonClassifier{}, err\n    }\n    fmt.Println(answer)\n    return WatsonClassifier{}, nil\n}\n</code></pre>\n"}, {"tags": ["json", "dictionary", "go", "encode"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1459603424, "post_id": 36369936, "comment_id": 60365432, "body": "I highly recommend going through <a href=\"https://godoc.org/-/go\" rel=\"nofollow noreferrer\">godoc.org/-/go</a> and <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3964, "user_id": 5288071, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hdcFK.png?s=128&g=1", "display_name": "zola", "link": "https://stackoverflow.com/users/5288071/zola"}, "is_accepted": true, "score": 2, "last_activity_date": 1459649633, "last_edit_date": 1459649633, "creation_date": 1459578630, "answer_id": 36370002, "question_id": 36369936, "link": "https://stackoverflow.com/questions/36369936/is-there-a-function-to-encode-an-array-map-using-json/36370002#36370002", "title": "Is there a function to encode an array/map using json?", "body": "<p>you can encode data structures to json in golang using the <strong>encoding/json</strong> package like this</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    group := map[string]interface{} {\n        \"name\": \"John Doe\",\n        \"age\": 112,\n    }\n    b, err := json.Marshal(group) // this converts the structure into json\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    os.Stdout.Write(b)\n}\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow\" title=\"golang json package\">golang json package</a></p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 36370002, "answer_count": 1, "score": 3, "last_activity_date": 1459649757, "creation_date": 1459578076, "last_edit_date": 1459649757, "question_id": 36369936, "link": "https://stackoverflow.com/questions/36369936/is-there-a-function-to-encode-an-array-map-using-json", "title": "Is there a function to encode an array/map using json?", "body": "<p>Is there a function in golang to encode an array/map using json? Something similar to PHP's <a href=\"http://php.net/manual/en/function.json-encode.php\" rel=\"nofollow\">json_encode()</a> function is what I'm looking for.</p>\n"}]