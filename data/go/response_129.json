[{"tags": ["go", "variadic-functions"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4010390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a47c8c3140298139da54044c7e31e7?s=128&d=identicon&r=PG&f=1", "display_name": "gim", "link": "https://stackoverflow.com/users/4010390/gim"}, "edited": false, "score": 0, "creation_date": 1498733924, "post_id": 44813913, "comment_id": 76626238, "body": "Thanks very much Charles. Thanks for putting the code in the Go Playground as well."}], "tags": [], "owner": {"reputation": 863, "user_id": 5849285, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UwK2I.jpg?s=128&g=1", "display_name": "Charles Shiller", "link": "https://stackoverflow.com/users/5849285/charles-shiller"}, "is_accepted": true, "score": 0, "last_activity_date": 1498691551, "last_edit_date": 1498691551, "creation_date": 1498691347, "answer_id": 44813913, "question_id": 44813598, "link": "https://stackoverflow.com/questions/44813598/dynamically-creating-channels-to-use-as-arguments-to-variadic-function-in-go/44813913#44813913", "title": "Dynamically creating channels to use as arguments to variadic function in Go", "body": "<p>You have two problems:</p>\n\n<ol>\n<li><p>A variadic function takes multiple args (fmt.Println, for example, takes multiple interface{}). You're sending an array.</p></li>\n<li><p>An array which is size [2] is not the same as size [] (yes, size of array is part of the type in go).</p></li>\n</ol>\n\n<p>What you want is something like:</p>\n\n<pre><code>    for n := range merge(res[:]) {\n</code></pre>\n\n<p>...</p>\n\n<pre><code>func merge(cs []&lt;-chan int) &lt;-chan int {\nout := make(chan int)\nvar wg sync.WaitGroup\nwg.Add(len(cs))\nfor _, c := range cs {\n    go func(ch &lt;-chan int) {\n        for n := range ch {\n            out &lt;- n\n        }\n        wg.Done()\n    }(c)\n}\ngo func() {\n    wg.Wait()\n    close(out)\n}()\nreturn out\n</code></pre>\n\n<p>}</p>\n\n<p><a href=\"https://play.golang.org/p/zTrrsRkKJV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/zTrrsRkKJV</a></p>\n"}, {"tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": false, "score": 0, "last_activity_date": 1498693667, "creation_date": 1498693667, "answer_id": 44814231, "question_id": 44813598, "link": "https://stackoverflow.com/questions/44813598/dynamically-creating-channels-to-use-as-arguments-to-variadic-function-in-go/44814231#44814231", "title": "Dynamically creating channels to use as arguments to variadic function in Go", "body": "<p>Selecting chan per goroutine take resources. When you have N'th channel, goroutine should be N'th. You should use <code>reflect.Select</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"reflect\"\n    \"sync\"\n    \"time\"\n)\n\nfunc multpleSelect(chans []chan bool) (int, bool, bool) {\n    cases := make([]reflect.SelectCase, len(chans))\n    for i, ch := range chans {\n        cases[i] = reflect.SelectCase{\n            Dir: reflect.SelectRecv,\n            Chan: reflect.ValueOf(ch),\n        }\n    }\n\n    i, v, ok := reflect.Select(cases)\n    return i, v.Interface().(bool), ok\n}\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n\n    chans := make([]chan bool, 100)\n    for i := 0; i &lt; 100; i++ {\n        chans[i] = make(chan bool)\n    }\n\n\n    var wg sync.WaitGroup\n    go func() {\n        wg.Add(1)\n\n        if ch, v, ok := multpleSelect(chans); ok {\n            fmt.Printf(\"I am chan-%v, value is %v\\n\", ch, v)\n        }\n        wg.Done()\n    }()\n\n    chans[rand.Int() % len(chans)] &lt;- true\n\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4010390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a47c8c3140298139da54044c7e31e7?s=128&d=identicon&r=PG&f=1", "display_name": "gim", "link": "https://stackoverflow.com/users/4010390/gim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 44813913, "answer_count": 2, "score": 0, "last_activity_date": 1498693667, "creation_date": 1498689374, "question_id": 44813598, "link": "https://stackoverflow.com/questions/44813598/dynamically-creating-channels-to-use-as-arguments-to-variadic-function-in-go", "title": "Dynamically creating channels to use as arguments to variadic function in Go", "body": "<p>Is it possible to dynamically create a channel in Go and then assign it a value? This fan-out-fan-in code works with</p>\n\n<pre><code>f1 := factorial(in)\nf2 := factorial(in)\nfor n := range merge(f1, f2) { \n        fmt.Println(n)\n}\n</code></pre>\n\n<p>But I'd like to do something like</p>\n\n<pre><code>var res [2]&lt;-chan int\nres[0] = make(chan int)\nres[0] = factorial(in)\nres[1] = make(chan int)\nres[1] = factorial(in)\nfor n := range merge(res...)\n    fmt.Println(n)\n}\n</code></pre>\n\n<p>This gives the following error</p>\n\n<pre><code>$ go run main.go\n# command-line-arguments\n.\\main.go:26: cannot use res (type [2]&lt;-chan int) as type []&lt;-chan int in \nargument to merge\n</code></pre>\n\n<p>Here is the full code...</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n\n    in := gen()\n\n    f1 := factorial(in) // code to be replaced\n    f2 := factorial(in) // code to be replaced\n    for n := range merge(f1, f2) { // code to be replaced\n        fmt.Println(n) // code to be replaced\n    } // code to be replaced\n\n    // What I'd like to use instead of the above...\n    //var res [2]&lt;-chan int\n    //res[0] = make(chan int)\n    //res[0] = factorial(in)\n    //res[1] = make(chan int)\n    //res[1] = factorial(in)\n    // for n := range merge(res...)\n    //  fmt.Println(n)\n    //}\n    // This commented code generates the following error\n    //$ go run main.go\n    //# command-line-arguments\n    //.\\main.go:20: cannot use res (type [2]&lt;-chan int) as type []&lt;-chan int in argument to merge\n\n}\n\nfunc gen() &lt;-chan int {\n    out := make(chan int)\n    go func() {\n        for i := 0; i &lt; 100; i++ {\n            for j := 3; j &lt; 13; j++ {\n                out &lt;- j\n            }\n        }\n        close(out)\n    }()\n    return out\n}\n\nfunc factorial(in &lt;-chan int) &lt;-chan int {\n    out := make(chan int)\n    go func() {\n        for n := range in {\n            out &lt;- fact(n)\n        }\n        close(out)\n    }()\n    return out\n}\n\nfunc fact(n int) int {\n    total := 1\n    for i := n; i &gt; 0; i-- {\n        total *= i\n    }\n    return total\n}\n\nfunc merge(cs ...&lt;-chan int) &lt;-chan int {\n    out := make(chan int)\n    var wg sync.WaitGroup\n    wg.Add(len(cs))\n    for _, c := range cs {\n        go func(ch &lt;-chan int) {\n            for n := range ch {\n                out &lt;- n\n            }\n            wg.Done()\n        }(c)\n    }\n    go func() {\n        wg.Wait()\n        close(out)\n    }()\n    return out\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498684040, "post_id": 44812334, "comment_id": 76605716, "body": "&quot;Is this possible?&quot; No."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1498689899, "post_id": 44812334, "comment_id": 76608016, "body": "Not entirely clear what you want to do. Can you show an example?"}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 0, "creation_date": 1498693295, "post_id": 44812334, "comment_id": 76608882, "body": "Maybe your js contains <code>{{xxx}}</code>?"}], "owner": {"reputation": 347, "user_id": 641267, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/077a483beb39db9d5884ee6f012f7b6e?s=128&d=identicon&r=PG", "display_name": "JohnnyD", "link": "https://stackoverflow.com/users/641267/johnnyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498731629, "creation_date": 1498683075, "question_id": 44812334, "link": "https://stackoverflow.com/questions/44812334/how-do-i-js-escape-a-template-in-golang", "title": "How do I JS escape a template in Golang", "body": "<p>I have a template and I want to JS escape the output to inject into another template. I could use template.JSEscape to do this after I've executed the template but it would seem more efficient to do it in one step, within a template.</p>\n\n<p>I'd like to do something like...</p>\n\n<pre><code>var x = \"{{js}}...some other template...{{end}}\"\n</code></pre>\n\n<p>Is this possible?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1498683175, "post_id": 44812324, "comment_id": 76605289, "body": "Separate packages is probably overkill, but if you want other devs to create handlers without modifying your code, a switch statement will not work - it&#39;s hard-coded with all available options. You want something like a map or something - take a look at the code for the standard library&#39;s HTTP mux as one example."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498684096, "post_id": 44812324, "comment_id": 76605749, "body": "What is wrong with a long switch statement? That&#39;s what switch is for,"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498684806, "post_id": 44812324, "comment_id": 76606045, "body": "@Volker It&#39;s not dynamic for other developers."}, {"owner": {"reputation": 2478, "user_id": 1586231, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/sRho9.jpg?s=128&g=1", "display_name": "Max von Hippel", "link": "https://stackoverflow.com/users/1586231/max-von-hippel"}, "edited": false, "score": 0, "creation_date": 1498685112, "post_id": 44812324, "comment_id": 76606193, "body": "Why not dynamically make the switch statements? <code>case some boolean such that the message is inside the list of keys to a dict: look up the query or whatever to do in that dict, then do it; done</code>.  Then have some function where devs can register stuff with your code and thus add their handlers or whatever to your groovy dict."}, {"owner": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "edited": false, "score": 0, "creation_date": 1498685155, "post_id": 44812324, "comment_id": 76606223, "body": "I want every handler to have a regex for matching, description/usage for help and a function to execute. Can&#39;t come up with a method where I wouldn&#39;t need to repeat e.g. &quot;search me&quot; in both Handler struct and in switch-case to execute the right function."}, {"owner": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "edited": false, "score": 0, "creation_date": 1498685214, "post_id": 44812324, "comment_id": 76606257, "body": "&quot;look up the query or whatever to do in that dict, then do it; done&quot; how would I put functions in a dict?"}], "answers": [{"comments": [{"owner": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "edited": false, "score": 0, "creation_date": 1498685635, "post_id": 44812828, "comment_id": 76606433, "body": "Thanks, that&#39;s helpful. However I&#39;m not sure I understand how to do that with regexes. I&#39;m using named captures to get user&#39;s input. Any ideas?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "edited": false, "score": 0, "creation_date": 1498685969, "post_id": 44812828, "comment_id": 76606563, "body": "That&#39;s kind of a separate question, and it depends entirely on how you define your command structure. If you haven&#39;t already, sit down and try to fully define how a command is structured, which will help you determine how it can be parsed."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "edited": false, "score": 0, "creation_date": 1498686306, "post_id": 44812828, "comment_id": 76606711, "body": "Well, it&#39;s not that. They really are two separate questions. Ask it in another. Proper etiquette here dictates there should be one question per post. Given the separate scope of what you are after with regex, it really is a different question.  P.S. I added a little polish to the answer."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "edited": false, "score": 0, "creation_date": 1498686785, "post_id": 44812828, "comment_id": 76606911, "body": "@Maklaus plus, the answer you want for parsing out the command and the query isn&#39;t limited to just Go, it&#39;s a more broad question. It will benefit from being in it&#39;s own question with different tags to target the correct audience. Tagging something with <code>go</code> probably does more to shrink the number of people who see to question..."}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 10, "last_activity_date": 1498821590, "last_edit_date": 1498821590, "creation_date": 1498685258, "answer_id": 44812828, "question_id": 44812324, "link": "https://stackoverflow.com/questions/44812324/how-to-avoid-a-long-switch-case-statement-in-go/44812828#44812828", "title": "How to avoid a long switch-case statement in Go", "body": "<p>You could use a <code>map[string]command</code> similar to how the <code>net/http</code> package registers handlers. Something akin to this:</p>\n\n<p><a href=\"https://play.golang.org/p/9YzHyLodAQ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9YzHyLodAQ</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"errors\"\n)\n\ntype BotFunc func(string) (string, error)\n\ntype BotMap map[string]BotFunc\n\nvar Bot = BotMap{}\n\nfunc (b BotMap) RegisterCommand(command string, f BotFunc) error {\n    if _, exists := b[command]; exists {\n        return errors.New(\"command already exists\")\n    }\n    b[command] = f\n    return nil\n}\n\nfunc (b BotMap) Execute(statement string) (string, error) {\n    // parse out command and query however you choose (not this way obviously)\n    command := statement[:9]\n    query := statement[10:]\n\n    return b.ExecuteQuery(command, query)\n}\n\nfunc (b BotMap) ExecuteQuery(command, query string) (string, error) {\n    if com, exists := b[command]; exists {\n        return com(query)\n    }\n    return \"\", errors.New(\"command doesn't exist\")\n\n}\n\nfunc main() {\n    err := Bot.RegisterCommand(\"search me\", func(query string) (string, error) {\n        fmt.Println(\"search\", query)\n        return \"searched\", nil\n    })\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    err = Bot.RegisterCommand(\"thesaurus me\", func(query string) (string, error) {\n        fmt.Println(\"thesaurus\", query)\n        return \"thesaurused\", nil\n    })\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    result, err := Bot.Execute(\"search me please\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(result)\n}\n</code></pre>\n\n<p>Obviously there's a lot of checks missing here, but this is the basic idea.</p>\n"}], "owner": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2250, "favorite_count": 1, "accepted_answer_id": 44812828, "answer_count": 1, "score": 4, "last_activity_date": 1498821590, "creation_date": 1498683030, "question_id": 44812324, "link": "https://stackoverflow.com/questions/44812324/how-to-avoid-a-long-switch-case-statement-in-go", "title": "How to avoid a long switch-case statement in Go", "body": "<p>I'm writing a chat bot in Go and wondering how can I avoid a long switch-case statement similar to this one:</p>\n\n<pre><code>switch {\n\n// @bot search me HMAC\ncase strings.Contains(message, \"search me\"):\n    query := strings.Split(message, \"search me \")[1]\n    return webSearch(query), \"html\"\n\n// @bot thesaurus me challenge\ncase strings.Contains(message, \"thesaurus me\"):\n    query := strings.Split(message, \"thesaurus me \")[1]\n    return synonyms(query), \"html\"\n</code></pre>\n\n<p>Should I define those handlers each in a separate package or should I just use structs and interfaces? Which method will allow me to have a good structure, avoid switch-case and let external developers to easier create handlers?</p>\n\n<p>I think packages will be a better choice but I'm not sure how to register the handlers with the main bot. Would appreciate an example.</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1498682373, "post_id": 44812106, "comment_id": 76604900, "body": "Is there another way to determine which it will be? For example, a well-written REST API will return an error along with non-2xx response codes. Can you use the status code to determine which type to unmarshal into?"}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 1, "creation_date": 1498682702, "post_id": 44812106, "comment_id": 76605055, "body": "Why not embed TokenError in Token and unmarshal response in Token?"}, {"owner": {"reputation": 430, "user_id": 218250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040fa3522ca103dc98d4e6613b49b7f?s=128&d=identicon&r=PG", "display_name": "Nitax", "link": "https://stackoverflow.com/users/218250/nitax"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498683762, "post_id": 44812106, "comment_id": 76605587, "body": "@Adrian I forgot to mention:  It is not a well written REST API.  Both responses come with the same status code / headers..."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 0, "creation_date": 1498683871, "post_id": 44812106, "comment_id": 76605646, "body": "That&#39;s pretty unfortunate. Your options are to do as you&#39;ve done, embed one in the other as @MayankPatel suggests, or try unmarshalling to one after the other and test after each to see if it delivered any values (note that if the fields don&#39;t match up but the JSON is valid, err will be nil but the values will be empty)."}, {"owner": {"reputation": 430, "user_id": 218250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040fa3522ca103dc98d4e6613b49b7f?s=128&d=identicon&r=PG", "display_name": "Nitax", "link": "https://stackoverflow.com/users/218250/nitax"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498684980, "post_id": 44812106, "comment_id": 76606132, "body": "@Adrian: The problem I ran into with attempting to unmarshal one after the other is that when you pass <code>json.Unmarshal</code> a nil pointer, it still assigns a zero-valued struct to that pointer (which is not clean to test for) even if cannot unmarshal a single field."}, {"owner": {"reputation": 2886, "user_id": 2081835, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4741683a91497af9910946e555ebfe0e?s=128&d=identicon&r=PG", "display_name": "TheHerk", "link": "https://stackoverflow.com/users/2081835/theherk"}, "edited": false, "score": 0, "creation_date": 1498686114, "post_id": 44812106, "comment_id": 76606637, "body": "I don&#39;t think it is an anti-pattern at all. In fact, your implementation seems like the most sensible pattern. This is one of the reasons I love how the json package deals with types composed of other embedded types."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498686138, "post_id": 44812106, "comment_id": 76606642, "body": "Yes, but you can test the values - eg, try to unmarshal the error type, and if it&#39;s error value is the empty string, it&#39;s not an error, so unmarshal the regular response type."}], "owner": {"reputation": 430, "user_id": 218250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040fa3522ca103dc98d4e6613b49b7f?s=128&d=identicon&r=PG", "display_name": "Nitax", "link": "https://stackoverflow.com/users/218250/nitax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498685083, "creation_date": 1498682197, "last_edit_date": 1498685083, "question_id": 44812106, "link": "https://stackoverflow.com/questions/44812106/umarshal-json-response-into-one-of-two-struct-types-in-go", "title": "Umarshal JSON response into one of two struct types in Go", "body": "<p>I am working with a 3rd party API endpoint that can return one of two top-level JSON objects for the same HTTP status code.  I have not been happy with the solutions I have found so far so I came up with the following solution using embedded types:</p>\n\n<pre><code>type TokenError struct {\n    Error            string `json:\"error\"`\n    ErrorDescription string `json:\"error_description\"`\n}\n\ntype Token struct {\n    AccessToken string `json:\"access_token\"`\n    ExpiresIn   int    `json:\"expires_in\"`\n    TokenType   string `json:\"token_type\"`\n}\n\ntype TokenResponse struct {\n    *TokenError\n    *Token\n}\n</code></pre>\n\n<p>With the above types, I can do a single unmarshal and some simple checks:</p>\n\n<pre><code>var tokenResponse TokenResponse\nerr = json.Unmarshal(body, &amp;tokenResponse)\nif err != nil {\n    fmt.Printf(\"Error parsing response %+v\\n\", err)\n}\n\nif tokenResponse.TokenError != nil {\n    fmt.Printf(\"Error fetching token: %+v\\n\", tokenResponse.TokenError)\n    return\n}\n\nif tokenResponse.Token != nil {\n    fmt.Printf(\"Successfully got token: %+v\\n\", tokenResponse.Token)\n    return\n}\n</code></pre>\n\n<p>I am wondering the following:</p>\n\n<ul>\n<li>Is this an anti-pattern or bad design for some reason?  (Assuming I don't expose that <code>TokenResponse</code> type outside of the package...)</li>\n<li>Is there some easier solution to this problem that I have overlooked?</li>\n</ul>\n"}, {"tags": ["go", "cryptography", "ed25519"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1498739770, "post_id": 44810708, "comment_id": 76630672, "body": "to add more on that, i looked into <a href=\"https://github.com/orlp/ed25519\" rel=\"nofollow noreferrer\">github.com/orlp/ed25519</a> at <a href=\"https://github.com/orlp/ed25519/blob/master/src/keypair.c#L15\" rel=\"nofollow noreferrer\">github.com/orlp/ed25519/blob/master/src/keypair.c#L15</a> it generates (i think) the PBK, and its ge_p3_tobytes is way more complex <a href=\"https://github.com/orlp/ed25519/blob/master/src/ge.c#L321\" rel=\"nofollow noreferrer\">github.com/orlp/ed25519/blob/master/src/ge.c#L321</a> the golang version is <a href=\"https://github.com/golang/crypto/blob/master/ed25519/ed25519.go#L43\" rel=\"nofollow noreferrer\">github.com/golang/crypto/blob/master/ed25519/ed25519.go#L43</a>"}, {"owner": {"reputation": 1191, "user_id": 547546, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4bb62fbc38c7277e51e440a3529c2336?s=128&d=identicon&r=PG", "display_name": "Chad Retz", "link": "https://stackoverflow.com/users/547546/chad-retz"}, "edited": false, "score": 1, "creation_date": 1526506225, "post_id": 44810708, "comment_id": 87776569, "body": "Note, this also applies to Tor v3 onion service addresses"}], "answers": [{"comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1499088034, "post_id": 44874097, "comment_id": 76751343, "body": "thanks a lot, I ll arrange with the copy-paste code, your solution is clear and straight, this is really appreciated. I did not understand why (golang|bitorrent) provides a different format, maybe someone knows about that ?"}, {"owner": {"reputation": 1191, "user_id": 547546, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4bb62fbc38c7277e51e440a3529c2336?s=128&d=identicon&r=PG", "display_name": "Chad Retz", "link": "https://stackoverflow.com/users/547546/chad-retz"}, "edited": false, "score": 1, "creation_date": 1530216619, "post_id": 44874097, "comment_id": 89169386, "body": "For anyone looking, I put this as a library at <a href=\"https://github.com/cretz/bine/tree/master/torutil/ed25519\" rel=\"nofollow noreferrer\">github.com/cretz/bine/tree/master/torutil/ed25519</a>"}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 10, "last_activity_date": 1499021158, "creation_date": 1499021158, "answer_id": 44874097, "question_id": 44810708, "link": "https://stackoverflow.com/questions/44810708/ed25519-public-result-is-different/44874097#44874097", "title": "ed25519.Public result is different", "body": "<p>This is due to different ed25519 private key formats. An ed25519 key starts out as a 32 byte <em>seed</em>. This seed is hashed with SHA512 to produce 64 bytes (a couple of bits are flipped too). The first 32 bytes of these are used to generate the public key (which is also 32 bytes), and the last 32 bytes are used in the generation of the signature.</p>\n\n<p>The Golang private key format is the 32 byte seed concatenated with the 32 byte public key. The private keys in the Bittorrent document you are using are the 64 byte result of the hash (or possibly just 64 random bytes that are used the same way as the hash result).</p>\n\n<p>Since it\u2019s not possible to reverse the hash, you can\u2019t convert the Bittorrent keys to a format that the Golang API will accept.</p>\n\n<p>You can produce a version of the Golang lib based on the existing package.</p>\n\n<p>The following code depends on the internal package <code>golang.org/x/crypto/ed25519/internal/edwards25519</code>, so if you want to use it you will need to copy that package out so that it is available to you code. It\u2019s also very \u201crough and ready\u201d, I\u2019ve basically just copied the chunks of code needed from the existing code to get this to work.</p>\n\n<p>Note that the public key and signature formats are the same, so as long as you are not sharing private keys you don\u2019t need to use this code to get a working implementation. You will only need it if you want to check the test vectors.</p>\n\n<p>First generating the public key from a private key:</p>\n\n<pre><code>// Generate the public key corresponding to the already hashed private\n// key.\n//\n// This code is mostly copied from GenerateKey in the\n// golang.org/x/crypto/ed25519 package, from after the SHA512\n// calculation of the seed.\nfunc getPublicKey(privateKey []byte) []byte {\n    var A edwards25519.ExtendedGroupElement\n    var hBytes [32]byte\n    copy(hBytes[:], privateKey)\n    edwards25519.GeScalarMultBase(&amp;A, &amp;hBytes)\n    var publicKeyBytes [32]byte\n    A.ToBytes(&amp;publicKeyBytes)\n\n    return publicKeyBytes[:]\n}\n</code></pre>\n\n<p>Next generating a signature:</p>\n\n<pre><code>// Calculate the signature from the (pre hashed) private key, public key\n// and message.\n//\n// This code is mostly copied from the Sign function from\n// golang.org/x/crypto/ed25519, from after the SHA512 calculation of the\n// seed.\nfunc sign(privateKey, publicKey, message []byte) []byte {\n\n    var privateKeyA [32]byte\n    copy(privateKeyA[:], privateKey) // we need this in an array later\n    var messageDigest, hramDigest [64]byte\n\n    h := sha512.New()\n    h.Write(privateKey[32:])\n    h.Write(message)\n    h.Sum(messageDigest[:0])\n\n    var messageDigestReduced [32]byte\n    edwards25519.ScReduce(&amp;messageDigestReduced, &amp;messageDigest)\n    var R edwards25519.ExtendedGroupElement\n    edwards25519.GeScalarMultBase(&amp;R, &amp;messageDigestReduced)\n\n    var encodedR [32]byte\n    R.ToBytes(&amp;encodedR)\n\n    h.Reset()\n    h.Write(encodedR[:])\n    h.Write(publicKey)\n    h.Write(message)\n    h.Sum(hramDigest[:0])\n    var hramDigestReduced [32]byte\n    edwards25519.ScReduce(&amp;hramDigestReduced, &amp;hramDigest)\n\n    var s [32]byte\n    edwards25519.ScMulAdd(&amp;s, &amp;hramDigestReduced, &amp;privateKeyA, &amp;messageDigestReduced)\n\n    signature := make([]byte, 64)\n    copy(signature[:], encodedR[:])\n    copy(signature[32:], s[:])\n\n    return signature\n}\n</code></pre>\n\n<p>Finally we can use these two functions to demonstrate the test vectors:</p>\n\n<pre><code>privateKeyHex := \"e06d3183d14159228433ed599221b80bd0a5ce8352e4bdf0262f76786ef1c74db7e7a9fea2c0eb269d61e3b38e450a22e754941ac78479d6c54e1faf6037881d\"\n\nexpectedPublicKey := \"77ff84905a91936367c01360803104f92432fcd904a43511876df5cdf3e7e548\"\nexpectedSig := \"6834284b6b24c3204eb2fea824d82f88883a3d95e8b4a21b8c0ded553d17d17ddf9a8a7104b1258f30bed3787e6cb896fca78c58f8e03b5f18f14951a87d9a08\"\n\nprivateKey, _ := hex.DecodeString(privateKeyHex)\npublicKey := getPublicKey(privateKey)\n\nfmt.Printf(\"Calculated key: %x\\n\", publicKey)\nfmt.Printf(\"Expected key:   %s\\n\", expectedPublicKey)\nkeyMatches := expectedPublicKey == hex.EncodeToString(publicKey)\nfmt.Printf(\"Public key matches expected: %v\\n\", keyMatches)\n\nbuffer := []byte(\"4:salt6:foobar3:seqi1e1:v12:Hello World!\")\ncalculatedSig := sign(privateKey, publicKey, buffer)\n\nfmt.Printf(\"Calculated sig: %x\\n\", calculatedSig)\nfmt.Printf(\"Expected sig:   %s\\n\", expectedSig)\nsigMatches := expectedSig == hex.EncodeToString(calculatedSig)\nfmt.Printf(\"Signature matches expected: %v\\n\", sigMatches)\n</code></pre>\n"}], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2015, "favorite_count": 2, "accepted_answer_id": 44874097, "answer_count": 1, "score": 8, "last_activity_date": 1499021158, "creation_date": 1498676998, "last_edit_date": 1498682357, "question_id": 44810708, "link": "https://stackoverflow.com/questions/44810708/ed25519-public-result-is-different", "title": "ed25519.Public result is different", "body": "<p>Using the package <a href=\"https://github.com/golang/crypto/tree/master/ed25519\" rel=\"noreferrer\">https://github.com/golang/crypto/tree/master/ed25519</a> i m trying to get a public key for a given private key.</p>\n\n<p>Those data are from <a href=\"http://www.bittorrent.org/beps/bep_0044.html\" rel=\"noreferrer\">http://www.bittorrent.org/beps/bep_0044.html</a>: test 2 (mutable with salt) </p>\n\n<p>Problem is, ed25519.Public() won t return the same public key when i fed it with the given private key.\nThe golang implementation returns the last 32 bytes of the PVK. But in my test data this is unexpected.</p>\n\n<p>The code here <a href=\"https://play.golang.org/p/UJNPCyuGQB\" rel=\"noreferrer\">https://play.golang.org/p/UJNPCyuGQB</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/hex\"\n    \"golang.org/x/crypto/ed25519\"\n    \"log\"\n)\n\nfunc main() {\n    priv := \"e06d3183d14159228433ed599221b80bd0a5ce8352e4bdf0262f76786ef1c74db7e7a9fea2c0eb269d61e3b38e450a22e754941ac78479d6c54e1faf6037881d\"\n    pub := \"77ff84905a91936367c01360803104f92432fcd904a43511876df5cdf3e7e548\"\n    sig := \"6834284b6b24c3204eb2fea824d82f88883a3d95e8b4a21b8c0ded553d17d17ddf9a8a7104b1258f30bed3787e6cb896fca78c58f8e03b5f18f14951a87d9a08\"\n    // d := hex.EncodeToString([]byte(priv))\n    privb, _ := hex.DecodeString(priv)\n    pvk := ed25519.PrivateKey(privb)\n    buffer := []byte(\"4:salt6:foobar3:seqi1e1:v12:Hello World!\")\n    sigb := ed25519.Sign(pvk, buffer)\n    pubb, _ := hex.DecodeString(pub)\n    sigb2, _ := hex.DecodeString(sig)\n    log.Println(ed25519.Verify(pubb, buffer, sigb))\n    log.Printf(\"%x\\n\", pvk.Public())\n    log.Printf(\"%x\\n\", sigb)\n    log.Printf(\"%x\\n\", sigb2)\n}\n</code></pre>\n\n<p>How to generate the same public key than the bep using golang ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 6303169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef5f622f9906108bbc136d53da0b14e1?s=128&d=identicon&r=PG&f=1", "display_name": "V. Korovin", "link": "https://stackoverflow.com/users/6303169/v-korovin"}, "edited": false, "score": 0, "creation_date": 1498677115, "post_id": 44810458, "comment_id": 76601937, "body": "Thanks, put this in <code>[Service]</code> section, now everything perfect."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1498676079, "creation_date": 1498676079, "answer_id": 44810458, "question_id": 44810434, "link": "https://stackoverflow.com/questions/44810434/no-such-file-or-directory-when-run-as-service/44810458#44810458", "title": "No such file or directory when run as service?", "body": "<p>You need to set the correct working directory in your script using <code>WorkingDirectory=</code> - presumably:</p>\n\n<pre><code>WorkingDirectory=/var/www/html/scarga.local\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 6303169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef5f622f9906108bbc136d53da0b14e1?s=128&d=identicon&r=PG&f=1", "display_name": "V. Korovin", "link": "https://stackoverflow.com/users/6303169/v-korovin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 44810458, "answer_count": 1, "score": -5, "last_activity_date": 1498911166, "creation_date": 1498675968, "last_edit_date": 1498911166, "question_id": 44810434, "link": "https://stackoverflow.com/questions/44810434/no-such-file-or-directory-when-run-as-service", "title": "No such file or directory when run as service?", "body": "<p>When i run my application from terminal <code>sudo -u www-data ./scarga</code> and open browser, the template file served well, everything ok. Command executed from <code>/var/www/html/scarga.local/</code> directory.</p>\n\n<p>When i run my application as <code>sudo service scarga start</code> it says: <code>open ./resources/views/index.html: no such file or directory</code></p>\n\n<p>File with HTTP handler: <a href=\"https://pastebin.com/MU7YDAWV\" rel=\"nofollow noreferrer\">https://pastebin.com/MU7YDAWV</a></p>\n\n<p>The scarga.service file: <a href=\"https://pastebin.com/eBL3jJFx\" rel=\"nofollow noreferrer\">https://pastebin.com/eBL3jJFx</a></p>\n\n<p>Tree of project: <a href=\"https://pastebin.com/rFVa8A3P\" rel=\"nofollow noreferrer\">https://pastebin.com/rFVa8A3P</a></p>\n\n<p>Rights for <code>index.html file\n</code>-rwxr-xr-x 1 www-data www-data 3586 Jun 28 14:27 index.html`</p>\n\n<p><strong>Why this happens and how to solve?</strong></p>\n\n<p>Thank you!</p>\n"}, {"tags": ["go", "amazon-s3", "aws-sdk"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1498674563, "post_id": 44809931, "comment_id": 76600428, "body": "I can&#39;t really comment on why the library does not do this, but there are a lot of little simple things in Go that seem like there should be functions for, yet there are none (see <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/SliceTricks</a>). I believe that such things are idiomatic in Go itself to keep the standard libraries slim.  As to the library though, this does seem like it is something that should be in there. Maybe submit a pull request? Which library specifically are you using?"}, {"owner": {"reputation": 7841, "user_id": 5250746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A19NH.jpg?s=128&g=1", "display_name": "Arpit Solanki", "link": "https://stackoverflow.com/users/5250746/arpit-solanki"}, "edited": false, "score": 0, "creation_date": 1498675017, "post_id": 44809931, "comment_id": 76600667, "body": "That&#39;s just a single line of code why do you need the library to this anyway?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1498675182, "post_id": 44809931, "comment_id": 76600769, "body": "This is a question for the AWS SDK devs, not SO."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 7841, "user_id": 5250746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A19NH.jpg?s=128&g=1", "display_name": "Arpit Solanki", "link": "https://stackoverflow.com/users/5250746/arpit-solanki"}, "edited": false, "score": 0, "creation_date": 1498675190, "post_id": 44809931, "comment_id": 76600770, "body": "@ArpitSolanki While I agree with you in this instance (with S3 because they are unlikely to break things), in general it makes sense to have a library handle this sort of thing in case they make incompatible changes to the structure. Users doing simple string manipulation get burned, while users using the library methods get an update and all is well."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1498675266, "post_id": 44809931, "comment_id": 76600811, "body": "@RayfenWindspear if they change the S3 URL structure or the fundamental addressing of S3 objects, everything using S3 will go to hell in a bobsled."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498675316, "post_id": 44809931, "comment_id": 76600839, "body": "@Adrian hence why my comment was directed to the general case"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498675446, "post_id": 44809931, "comment_id": 76600915, "body": "What is &quot;the general case&quot;? All string manipulation? This seems like something where there is no general case and certainly no universally-applicable logic."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498675606, "post_id": 44809931, "comment_id": 76601030, "body": "@Adrian general case being a service provides e.g. a URL in a specific form, then for some reason has to make breaking changes to that structure. Everyone who rolled their own solution breaks, whereas if there was a library function to parse whatever needed info, those users would just update and move on."}, {"owner": {"reputation": 7841, "user_id": 5250746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A19NH.jpg?s=128&g=1", "display_name": "Arpit Solanki", "link": "https://stackoverflow.com/users/5250746/arpit-solanki"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1498675699, "post_id": 44809931, "comment_id": 76601089, "body": "Having a library do all your stuffs is always awesome but this specific case is way too simple. I think if you write one function and test it one or two times then there are like no chances of breaking. I agree with @Adrian completely on this"}, {"owner": {"reputation": 6354, "user_id": 4258430, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a2d5075177b2ff473c38f6d8fb64894?s=128&d=identicon&r=PG", "display_name": "Allen Luce", "link": "https://stackoverflow.com/users/4258430/allen-luce"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1498687368, "post_id": 44809931, "comment_id": 76607161, "body": "@RayfenWindspear gets it. I&#39;ve updated the question in an attempt to be clearer."}], "answers": [{"comments": [{"owner": {"reputation": 1868, "user_id": 499567, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c4ba4a2ce571f71370d270a21633e7e3?s=128&d=identicon&r=PG", "display_name": "Techrocket9", "link": "https://stackoverflow.com/users/499567/techrocket9"}, "edited": false, "score": 3, "creation_date": 1580855790, "post_id": 44810384, "comment_id": 106233751, "body": "<b>Warning</b>: If you do this, note that it will give you a slash (/) character at the start of the Path/Key.  If you try to use some or all of the <code>u.Path</code> value as a prefix in a <code>ListObjectsV2</code> API call later it will <b>fail</b> because of that slash; you must remove it before sending the string back to AWS."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 9, "last_activity_date": 1498675802, "creation_date": 1498675802, "answer_id": 44810384, "question_id": 44809931, "link": "https://stackoverflow.com/questions/44809931/parsing-s3-uri-into-bucket-and-key-in-go/44810384#44810384", "title": "Parsing S3 URI into bucket and key in Go", "body": "<p>Though only the AWS devs can answer the actual question (why isn't this included in the SDK), there is the simple answer: S3 URLs are URLs, and you can use <code>net/url</code> to parse them:</p>\n\n<pre><code>u,_ := url.Parse(\"s3://mybucket/some/place/on/there.gz\")\nfmt.Printf(\"proto: %q, bucket: %q, key: %q\", u.Scheme, u.Host, u.Path)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gpcVYuU3fZ\" rel=\"noreferrer\">Playground here</a></p>\n"}], "owner": {"reputation": 6354, "user_id": 4258430, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a2d5075177b2ff473c38f6d8fb64894?s=128&d=identicon&r=PG", "display_name": "Allen Luce", "link": "https://stackoverflow.com/users/4258430/allen-luce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3896, "favorite_count": 0, "closed_date": 1498681723, "answer_count": 1, "score": 2, "last_activity_date": 1498687353, "creation_date": 1498674170, "last_edit_date": 1498687353, "question_id": 44809931, "link": "https://stackoverflow.com/questions/44809931/parsing-s3-uri-into-bucket-and-key-in-go", "closed_reason": "Opinion-based", "title": "Parsing S3 URI into bucket and key in Go", "body": "<p>There doesn't seem to be a function in the official AWS Go SDK that'll parse an <code>s3://</code> style URI-like string (i.e. <code>s3://mybucket/some/place/on/there.gz</code>) and provide things like the bucket and key. The Java SDK <a href=\"https://github.com/aws/aws-sdk-java/blob/master/aws-java-sdk-s3/src/main/java/com/amazonaws/services/s3/AmazonS3URI.java\" rel=\"noreferrer\">has such a function</a>. Am I missing an obvious reason why the Go SDK does not?</p>\n\n<p>This question is about maintaining compatibility. An SDK function provides a clear authority on how to properly parse S3 addresses and deters worry over subtle cases that <code>url.Parse()</code> and ilk may miss.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 4, "last_activity_date": 1498670822, "creation_date": 1498670822, "answer_id": 44809055, "question_id": 44808946, "link": "https://stackoverflow.com/questions/44808946/callback-parameter-defined-using-interface-called-using-implementation/44809055#44809055", "title": "Callback parameter defined using interface, called using implementation", "body": "<p>The function signature is <code>func(f Foo)</code>, so that is <em>exactly</em> what must be passed. The reason is simple: if your method expects a callback function of that signature, it can pass in <em>any type that implements Foo</em>. If you passed in a function that only accepted <code>CoolFoo</code>, the caller could still pass in <code>BadFoo</code>, because the types you've defined allow it. Thus, the compiler requires that the types match precisely. Likewise, if your callback function tries to cast to a concrete type, but that isn't the type that was passed to it, it will fail, because you're making an assumption that isn't supported by the code.</p>\n\n<p>If your callback will only pass in <code>CoolFoo</code>, maybe that should be the type you use in the signature. If <code>CoolFoo</code> and <code>BadFoo</code> will each only pass in their respective types to their callbacks, maybe you need two different callback signatures. If they really are interchangeable, then the case you describe (a function taking <code>CoolFoo</code> specifically) isn't a problem with the language, it's a problem with your design.</p>\n"}], "owner": {"reputation": 319, "user_id": 933740, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/46a667c446e0686168ea00e08283a873?s=128&d=identicon&r=PG", "display_name": "user933740", "link": "https://stackoverflow.com/users/933740/user933740"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 44809055, "answer_count": 1, "score": 2, "last_activity_date": 1498670822, "creation_date": 1498670452, "question_id": 44808946, "link": "https://stackoverflow.com/questions/44808946/callback-parameter-defined-using-interface-called-using-implementation", "title": "Callback parameter defined using interface, called using implementation", "body": "<p>What I'm trying to do:</p>\n\n<p>I have a library package which defines a few types, all implementing a given interface. Throughout the code, there are callbacks involved, and instead of writing the callback type everywhere I defined a type for it.</p>\n\n<pre><code>type Foo interface {\n    Bar()\n}\n\ntype MyCallback func(f Foo)\n\ntype CoolFoo int\n\ntype BadFoo int\n\nfunc (cf *CoolFoo) Bar(cb MyCallback) {\n}\n\nfunc (bf *BadFoo) Bar(cb MyCallback) {\n}\n</code></pre>\n\n<p>Then later from client code using that library, I want to call using callbacks. If I call it by using the interface type it works:</p>\n\n<pre><code>cf := &amp;CoolFoo{}\n\ncf.Bar(func(f packageName.Foo) {\n})\n</code></pre>\n\n<p>But I would rather have more self documenting code, and proper type hinting in my IDE, so I try to call it using the implementor type, such as this:</p>\n\n<pre><code>cf := &amp;CoolFoo{}\n\ncf.Bar(func(f packageName.CoolFoo) {\n})\n</code></pre>\n\n<p>Which fails to compile, with the error:</p>\n\n<blockquote>\n  <p>cannot use func literal (type func(packageName.CoolFoo)) as type\n  packageName.MyCallback in argument to cf.Bar</p>\n</blockquote>\n\n<p>Is it not possible, or am I making some dummy mistake ? I'm not very experienced in go dev, and I've tried looking around, but couldn't find the solution here.</p>\n\n<p>What I've found is passing it as a Foo or an interface{} and then casting in the callback to what I want, but I would like to avoid it as it feels messy</p>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["http", "curl", "go"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 2, "creation_date": 1498664538, "post_id": 44807068, "comment_id": 76594123, "body": "Is this all being done on the same machine? If so, is it possible you&#39;re running out of sockets?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1498664664, "post_id": 44807068, "comment_id": 76594249, "body": "This isn&#39;t rate-limiting exactly - that implies it&#39;s some intentional logic-driven throttling. This is a case of simple resource starvation: insufficient CPU/memory/sockets/ports/file descriptors to service requests."}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 0, "creation_date": 1498664697, "post_id": 44807068, "comment_id": 76594268, "body": "Maybe, over SO_MAXCONN&#39;s connections."}, {"owner": {"reputation": 323, "user_id": 1734905, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/226d90020a9517418b0ecdbacfaf9052?s=128&d=identicon&r=PG", "display_name": "user1734905", "link": "https://stackoverflow.com/users/1734905/user1734905"}, "edited": false, "score": 0, "creation_date": 1498664705, "post_id": 44807068, "comment_id": 76594276, "body": "no, client and server are in 2 different machines, and there&#39;re maximum of about 20 client&#39;s sending threads (each issues post/get requests)"}, {"owner": {"reputation": 323, "user_id": 1734905, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/226d90020a9517418b0ecdbacfaf9052?s=128&d=identicon&r=PG", "display_name": "user1734905", "link": "https://stackoverflow.com/users/1734905/user1734905"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498664822, "post_id": 44807068, "comment_id": 76594364, "body": "@Adrian, I monitored the server and the messages never get delivered to the REST endpoint/method. They must be dropped before that"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1498664861, "post_id": 44807068, "comment_id": 76594397, "body": "Yes. That&#39;s what I would expect with resource starvation."}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 1, "creation_date": 1498664894, "post_id": 44807068, "comment_id": 76594423, "body": "did you try to increse net.core.netdev_max_backlog in /etc/sysctl.conf ?"}, {"owner": {"reputation": 323, "user_id": 1734905, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/226d90020a9517418b0ecdbacfaf9052?s=128&d=identicon&r=PG", "display_name": "user1734905", "link": "https://stackoverflow.com/users/1734905/user1734905"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498664989, "post_id": 44807068, "comment_id": 76594515, "body": "@Adrian, the CPU at the server was high, then drop to very low during the time when the requests were dropped. That doesn&#39;t seem to indicate starvation, does it?"}, {"owner": {"reputation": 323, "user_id": 1734905, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/226d90020a9517418b0ecdbacfaf9052?s=128&d=identicon&r=PG", "display_name": "user1734905", "link": "https://stackoverflow.com/users/1734905/user1734905"}, "edited": false, "score": 0, "creation_date": 1498665023, "post_id": 44807068, "comment_id": 76594539, "body": "@math, no i haven&#39;t tried that"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1498665275, "post_id": 44807068, "comment_id": 76594740, "body": "@user1734905 not CPU starvation, but that says nothing of all the other resources I mentioned that it might be running out of."}, {"owner": {"reputation": 323, "user_id": 1734905, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/226d90020a9517418b0ecdbacfaf9052?s=128&d=identicon&r=PG", "display_name": "user1734905", "link": "https://stackoverflow.com/users/1734905/user1734905"}, "edited": false, "score": 0, "creation_date": 1498665583, "post_id": 44807068, "comment_id": 76594985, "body": "is there a way to find out which resources were saturated. And where does it happen? At the client side, or at the server side (in this case, it must be in Golang&#39;s net package, right?)"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1498667222, "post_id": 44807068, "comment_id": 76596031, "body": "You could use an atomic counter you increment, then <code>defer</code> decrement to keep track of how many concurrent connections are running. Obviously this could create more delay by waiting on locks, but it&#39;s purpose would be for diagnosing the issue."}], "owner": {"reputation": 323, "user_id": 1734905, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/226d90020a9517418b0ecdbacfaf9052?s=128&d=identicon&r=PG", "display_name": "user1734905", "link": "https://stackoverflow.com/users/1734905/user1734905"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498664389, "creation_date": 1498664389, "question_id": 44807068, "link": "https://stackoverflow.com/questions/44807068/golang-http-or-gocraft-rate-limit", "title": "golang http (or gocraft) rate limit", "body": "<p>I have a server implementing a REST service using golang's net.http and gocraft.web package. </p>\n\n<p>And I have a client sending JSON request via libcurl, the client is written in C++. </p>\n\n<p>What I notice is that when there are a lot of client threads for sending concurrent JSON requests, there are times when the client gets \"Couldn't connect to server\" error, but then after a while it can resume sending again. </p>\n\n<p>Since the observation points to rate-limiting, my question is where is rate-limitting happening? Is this at the client side (libcurl), Go's http package, or gocraft.web package? </p>\n"}, {"tags": ["go", "profiling", "memory-profiling"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1498664588, "post_id": 44807030, "comment_id": 76594172, "body": "First of all, try sorting by cumulative instead of flat. That should give you an indication of what code of yours is calling stdlib code that is allocating memory. You can use e.g. <code>top10 -cum</code> to give you the top 10 cumulative memory users."}, {"owner": {"reputation": 685, "user_id": 5817539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/z16mZ.png?s=128&g=1", "display_name": "maestromusica", "link": "https://stackoverflow.com/users/5817539/maestromusica"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498666605, "post_id": 44807030, "comment_id": 76595644, "body": "Silly me.... Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 685, "user_id": 5817539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/z16mZ.png?s=128&g=1", "display_name": "maestromusica", "link": "https://stackoverflow.com/users/5817539/maestromusica"}, "is_accepted": true, "score": 0, "last_activity_date": 1498666700, "creation_date": 1498666700, "answer_id": 44807809, "question_id": 44807030, "link": "https://stackoverflow.com/questions/44807030/none-of-my-code-appears-in-golang-memory-profiler-output/44807809#44807809", "title": "None of my code appears in Golang memory profiler output", "body": "<p>As pointed in the comments by Adrian, the 'problem' is simply solved by sorting by cumulative instead of flat, for example using <code>top10 -cum</code> </p>\n"}], "owner": {"reputation": 685, "user_id": 5817539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/z16mZ.png?s=128&g=1", "display_name": "maestromusica", "link": "https://stackoverflow.com/users/5817539/maestromusica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 44807809, "answer_count": 1, "score": 0, "last_activity_date": 1498666700, "creation_date": 1498664283, "question_id": 44807030, "link": "https://stackoverflow.com/questions/44807030/none-of-my-code-appears-in-golang-memory-profiler-output", "title": "None of my code appears in Golang memory profiler output", "body": "<p>I'm currently working on a Go program that loads data from a database, runs some calculations and then saves the results to the same database. There are multiple gorutines. </p>\n\n<p>The runtime (5-6 minutes) was surprisingly long. Following this <a href=\"https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs\" rel=\"nofollow noreferrer\" title=\"Debugging performance issues in Go programs\">article</a> I performed CPU profiling and it turns out that 70%+ of the CPU time is Garbage Collection related code running. </p>\n\n<p>Now, I tried memory profiling but none of my my code appears in the results. This is my first time profiling a program - I don't know how to proceed with optimisation of the program or where to look for problems. I appreciate any help. </p>\n\n<p><a href=\"https://i.stack.imgur.com/WMhgs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WMhgs.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["c++", "serialization", "go", "protocol-buffers"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498662717, "post_id": 44806362, "comment_id": 76592751, "body": "You said in Go you get the same length, but what are you using when you get different lengths?"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1498663033, "post_id": 44806362, "comment_id": 76593116, "body": "Yeah, the first version is just wrong IMO. It should be 27 bytes. You can put the hex in here <a href=\"https://protogen.marcgravell.com/decode\" rel=\"nofollow noreferrer\">protogen.marcgravell.com/decode</a> to verify and see the same numbers come out for the 27 byte version"}, {"owner": {"reputation": 297, "user_id": 2715675, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/da04f9c72b6f534ef57cd086ca053760?s=128&d=identicon&r=PG&f=1", "display_name": "jonadev95", "link": "https://stackoverflow.com/users/2715675/jonadev95"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498663072, "post_id": 44806362, "comment_id": 76593037, "body": "When I do the same operations in go like I do in cpp, both serialized messages got the same length, in contrast to the cpp serialization which length differ"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1498666674, "post_id": 44806362, "comment_id": 76595701, "body": "What does <code>size</code> come out as, BTW?"}, {"owner": {"reputation": 297, "user_id": 2715675, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/da04f9c72b6f534ef57cd086ca053760?s=128&d=identicon&r=PG&f=1", "display_name": "jonadev95", "link": "https://stackoverflow.com/users/2715675/jonadev95"}, "edited": false, "score": 0, "creation_date": 1498666794, "post_id": 44806362, "comment_id": 76595761, "body": "The <code>size</code> is 27, which should be correct if I&#39;m not mistaken"}], "answers": [{"comments": [{"owner": {"reputation": 297, "user_id": 2715675, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/da04f9c72b6f534ef57cd086ca053760?s=128&d=identicon&r=PG&f=1", "display_name": "jonadev95", "link": "https://stackoverflow.com/users/2715675/jonadev95"}, "edited": false, "score": 0, "creation_date": 1498667640, "post_id": 44807928, "comment_id": 76596277, "body": "So the issue is the <code>file_b &lt;&lt; buffer</code> because I pass a char array and the ostream ends the writing after the first nil byte, since it&#39;s expecting a null terminated string?"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "reply_to_user": {"reputation": 297, "user_id": 2715675, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/da04f9c72b6f534ef57cd086ca053760?s=128&d=identicon&r=PG&f=1", "display_name": "jonadev95", "link": "https://stackoverflow.com/users/2715675/jonadev95"}, "edited": false, "score": 1, "creation_date": 1498668278, "post_id": 44807928, "comment_id": 76596696, "body": "@jonadev95 yes, exactly that"}], "tags": [], "owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "is_accepted": true, "score": 2, "last_activity_date": 1498667051, "creation_date": 1498667051, "answer_id": 44807928, "question_id": 44806362, "link": "https://stackoverflow.com/questions/44806362/protobuf-serialization-length-differs-when-using-different-values-for-field/44807928#44807928", "title": "Protobuf serialization length differs when using different values for field", "body": "<p>I think the error you're making is treating binary as character data and using character data APIs. Many of those APIs <strong>stop</strong> at the first nil byte (0), but that is a totally valid value in protobuf binary.</p>\n\n<p>You need to make sure you don't use any such APIs basically - stick purely to binary safe APIs.</p>\n\n<p>Since you indicate that <code>size</code> is 27, this all fits.</p>\n\n<p>Basically, the binary representation of 5.0 includes 0 bytes, but you could easily have seen the same problem for other values in time.</p>\n"}], "owner": {"reputation": 297, "user_id": 2715675, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/da04f9c72b6f534ef57cd086ca053760?s=128&d=identicon&r=PG&f=1", "display_name": "jonadev95", "link": "https://stackoverflow.com/users/2715675/jonadev95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 44807928, "answer_count": 1, "score": 1, "last_activity_date": 1498667051, "creation_date": 1498662511, "last_edit_date": 1498666201, "question_id": 44806362, "link": "https://stackoverflow.com/questions/44806362/protobuf-serialization-length-differs-when-using-different-values-for-field", "title": "Protobuf serialization length differs when using different values for field", "body": "<p>My Protobuf message consists of 3 doubles</p>\n\n<pre><code>syntax = \"proto3\";\n\nmessage TestMessage{\n  double input = 1;\n  double output = 2;\n  double info = 3;\n}\n</code></pre>\n\n<p>When I set these values to</p>\n\n<pre><code>test.set_input(2.3456);\ntest.set_output(5.4321);\ntest.set_info(5.0);\n</code></pre>\n\n<p>the serialized message looks like</p>\n\n<pre><code>00000000  09 16 fb cb ee c9 c3 02  40 11 0a 68 22 6c 78 ba  |........@..h\"lx.|\n00000010  15 40 19                                          |.@.|\n00000013\n</code></pre>\n\n<p>when using <code>test.serializeToArray</code> and could not be deserialized successfully by a go program using the same protobuf message. When trying to read it from a c++ program I got a 0 as info, so the message seems to be corrupted.</p>\n\n<p>When using <code>test.serializeToOstream</code> I got this message, which could be deserialized successfully by both go and c++ programs.</p>\n\n<pre><code>00000000  09 16 fb cb ee c9 c3 02  40 11 0a 68 22 6c 78 ba  |........@..h\"lx.|\n00000010  15 40 19 00 00 00 00 00  00 14 40               |.@........@|\n0000001b\n</code></pre>\n\n<p>When setting the values to</p>\n\n<pre><code>test.set_input(2.3456);\ntest.set_output(5.4321);\ntest.set_info(5.5678);\n</code></pre>\n\n<p>the serialized messages, both produced by <code>test.serializeToArray</code> and <code>test.serializeToOstream</code> look like</p>\n\n<pre><code>00000000  09 16 fb cb ee c9 c3 02  40 11 0a 68 22 6c 78 ba  |........@..h\"lx.|\n00000010  15 40 19 da ac fa 5c 6d  45 16 40                 |.@....\\mE.@|\n0000001b\n</code></pre>\n\n<p>and could be successfully read by my go and cpp program.</p>\n\n<p>What am I missing here? Why is <code>serializeToArray</code> not working in the first case?</p>\n\n<p>EDIT:\nAs it turns out, serializeToString works fine, too.</p>\n\n<p>Here the code I used for the comparison:</p>\n\n<pre><code>file_a.open(FILEPATH_A);\nfile_b.open(FILEPATH_B);\n\ntest.set_input(2.3456);\ntest.set_output(5.4321);\ntest.set_info(5.0);\n\n//serializeToArray\nint size = test.ByteSize();\nchar *buffer = (char*) malloc(size);\ntest.SerializeToArray(buffer, size);\nfile_a &lt;&lt; buffer;\n\n//serializeToString\nstd::string buf;\ntest.SerializeToString(&amp;buf);\nfile_b &lt;&lt; buf;\n\nfile_a.close();\nfile_b.close();\n</code></pre>\n\n<p>Why does serializeToArray not work as expected?</p>\n\n<p>EDIT2:</p>\n\n<p>When using <code>file_b &lt;&lt; buf.data()</code> instead of <code>file_b &lt;&lt; buf.data()</code>, the data gets corrupted as well, but why?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 112, "user_id": 836309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1471825d38eef598838e0cb69b4803?s=128&d=identicon&r=PG&f=1", "display_name": "billf", "link": "https://stackoverflow.com/users/836309/billf"}, "edited": false, "score": 0, "creation_date": 1498668298, "post_id": 44806115, "comment_id": 76596704, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17193086/how-to-pass-net-listeners-fd-to-child-process-safely\">How to pass net.Listener()&#39;s FD to child process safely?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1498662685, "creation_date": 1498662685, "answer_id": 44806421, "question_id": 44806115, "link": "https://stackoverflow.com/questions/44806115/golang-accept-on-already-opened-fd/44806421#44806421", "title": "golang accept on already opened fd", "body": "<p><a href=\"https://golang.org/pkg/net/#FileListener\" rel=\"nofollow noreferrer\"><code>net.FileListener</code></a> is used to turn a file descriptor into a <code>net.Listener</code></p>\n\n<pre><code>f := os.NewFile(sockfd, \"from parent\")\nl, err := net.FileListener(f)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 8226831, "user_type": "registered", "profile_image": "https://graph.facebook.com/1072421991/picture?type=large", "display_name": "Zhivko Angelov", "link": "https://stackoverflow.com/users/8226831/zhivko-angelov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "accepted_answer_id": 44806421, "answer_count": 1, "score": 5, "last_activity_date": 1498662685, "creation_date": 1498661926, "question_id": 44806115, "link": "https://stackoverflow.com/questions/44806115/golang-accept-on-already-opened-fd", "title": "golang accept on already opened fd", "body": "<p>I have a daemon that listens on a specific unix domain socket file. At some point it spawns a child which should continue listen on the same socket file without open a new one and overwriting the old one. I need a method that listen on a specific FD. In C it can be done with accept():</p>\n\n<pre><code>int accept(int sockfd, struct sockaddr *addr, socklen_t *addrlen);\n</code></pre>\n\n<p>Please advise.</p>\n"}, {"tags": ["go", "struct", "interface"], "comments": [{"owner": {"reputation": 4346, "user_id": 6375113, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JHg5K.jpg?s=128&g=1", "display_name": "Bugs", "link": "https://stackoverflow.com/users/6375113/bugs"}, "edited": false, "score": 0, "creation_date": 1498728397, "post_id": 44805984, "comment_id": 76622499, "body": "Please post a solution as an answer not as an update to the question. If the answer you&#39;ve used is on a different question please flag this question as a duplicate to the other question. If it&#39;s not and it&#39;s different please post a proper detailed answer to help future visitors and to avoid confusion. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 4, "last_activity_date": 1498661939, "creation_date": 1498661939, "answer_id": 44806122, "question_id": 44805984, "link": "https://stackoverflow.com/questions/44805984/golang-interface-to-struct/44806122#44806122", "title": "Golang interface to struct", "body": "<p>You can't append data arbitrarily to a struct; they're statically typed. You can only assign values to the fields defined for that specific struct type. Your best bet is probably to use a <code>map</code> instead of structs for this.</p>\n"}, {"comments": [{"owner": {"reputation": 2696, "user_id": 1564840, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7374a0927a35e40deae799aa83977a1e?s=128&d=identicon&r=PG", "display_name": "Pascut", "link": "https://stackoverflow.com/users/1564840/pascut"}, "edited": false, "score": 2, "creation_date": 1498725711, "post_id": 44813472, "comment_id": 76620532, "body": "These examples helped me to fix the issue. Thanks."}], "tags": [], "owner": {"reputation": 2886, "user_id": 2081835, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4741683a91497af9910946e555ebfe0e?s=128&d=identicon&r=PG", "display_name": "TheHerk", "link": "https://stackoverflow.com/users/2081835/theherk"}, "is_accepted": true, "score": 12, "last_activity_date": 1498688985, "last_edit_date": 1498688985, "creation_date": 1498688552, "answer_id": 44813472, "question_id": 44805984, "link": "https://stackoverflow.com/questions/44805984/golang-interface-to-struct/44813472#44813472", "title": "Golang interface to struct", "body": "<p>Adrian is correct. To take it a step further, you can only do anything with interfaces if you know the type that implements that interface. The empty interface, <code>interface{}</code> isn't really an \"anything\" value like is commonly misunderstood; it is just an interface that is immediately satisfied by all types.</p>\n\n<p>Therefore, you can only get values from it or create a new \"interface\" with added values by knowing the type satisfying the empty interface before and after the addition.</p>\n\n<p>The closest you can come to doing what you want, given the static typing, is by embedding the before type in the after type, so that everything can still be accessed at the root of the after type. The following illustrates this.</p>\n\n<p><a href=\"https://play.golang.org/p/JdF7Uevlqp\" rel=\"noreferrer\">https://play.golang.org/p/JdF7Uevlqp</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Before struct {\n    m map[string]string\n}\n\ntype After struct {\n    Before\n    s []string\n}\n\nfunc contrivedAfter(b interface{}) interface{} {\n    return After{b.(Before), []string{\"new value\"}}\n}\n\nfunc main() {\n    b := Before{map[string]string{\"some\": \"value\"}}\n    a := contrivedAfter(b).(After)\n    fmt.Println(a.m)\n    fmt.Println(a.s)\n}\n</code></pre>\n\n<p>Additionally, since the data you are passing to the template does not require you to specify the type, you could use an anonymous struct to accomplish something very similar.</p>\n\n<p><a href=\"https://play.golang.org/p/3KUfHULR84\" rel=\"noreferrer\">https://play.golang.org/p/3KUfHULR84</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Before struct {\n    m map[string]string\n}\n\nfunc contrivedAfter(b interface{}) interface{} {\n    return struct{\n        Before\n        s []string\n    }{b.(Before), []string{\"new value\"}}\n}\n\nfunc main() {\n    b := Before{map[string]string{\"some\": \"value\"}}\n    a := contrivedAfter(b)\n    fmt.Println(a)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "is_accepted": false, "score": 1, "last_activity_date": 1498732309, "creation_date": 1498732309, "answer_id": 44822708, "question_id": 44805984, "link": "https://stackoverflow.com/questions/44805984/golang-interface-to-struct/44822708#44822708", "title": "Golang interface to struct", "body": "<p>Not recommended, but you can create structs dynamically using the reflect package.</p>\n\n<p>Here is an example:</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"encoding/json\"\n    \"os\"\n    \"reflect\"\n)\n\ntype S struct {\n    Name string\n}\n\ntype D struct {\n    Pants bool\n}\n\nfunc main() {\n    a := Combine(&amp;S{\"Bob\"}, &amp;D{true})\n    json.NewEncoder(os.Stderr).Encode(a)\n}\n\nfunc Combine(v ...interface{}) interface{} {\n    f := make([]reflect.StructField, len(v))\n    for i, u := range v {\n        f[i].Type = reflect.TypeOf(u)\n        f[i].Anonymous = true\n    }\n\n    r := reflect.New(reflect.StructOf(f)).Elem()\n    for i, u := range v {\n        r.Field(i).Set(reflect.ValueOf(u))\n    }\n    return r.Addr().Interface()\n}\n</code></pre>\n\n<p>You could use something like the <code>Combine</code> function above to shmush any number of structs together. Unfortunately, from the <a href=\"https://golang.org/pkg/reflect/#StructOf\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>StructOf currently does not generate wrapper methods for embedded fields. This limitation may be lifted in a future version.</p>\n</blockquote>\n\n<p>So your created struct won't inherit methods from the embedded types. Still, maybe it does what you need.</p>\n"}, {"tags": [], "owner": {"reputation": 362, "user_id": 8202594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FGi20.jpg?s=128&g=1", "display_name": "iwasidiotic", "link": "https://stackoverflow.com/users/8202594/iwasidiotic"}, "is_accepted": false, "score": -1, "last_activity_date": 1557058943, "creation_date": 1557058943, "answer_id": 55991877, "question_id": 44805984, "link": "https://stackoverflow.com/questions/44805984/golang-interface-to-struct/55991877#55991877", "title": "Golang interface to struct", "body": "<p>If you are just looking to convert your interface to struct, use this method.</p>\n\n<pre><code>type Customer struct {\n    Name string `json:\"name\"`\n}\n\nfunc main() {\n    // create a customer, add it to DTO object and marshal it\n    receivedData := somefunc() //returns interface\n\n    //Attempt to unmarshall our customer\n    receivedCustomer := getCustomerFromDTO(receivedData)\n    fmt.Println(receivedCustomer)\n}\n\nfunc getCustomerFromDTO(data interface{}) Customer {\n    m := data.(map[string]interface{})\n    customer := Customer{}\n    if name, ok := m[\"name\"].(string); ok {\n        customer.Name = name\n    }\n    return customer\n}\n</code></pre>\n"}], "owner": {"reputation": 2696, "user_id": 1564840, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7374a0927a35e40deae799aa83977a1e?s=128&d=identicon&r=PG", "display_name": "Pascut", "link": "https://stackoverflow.com/users/1564840/pascut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43009, "favorite_count": 4, "accepted_answer_id": 44813472, "answer_count": 4, "score": 8, "last_activity_date": 1557058943, "creation_date": 1498661624, "last_edit_date": 1498728315, "question_id": 44805984, "link": "https://stackoverflow.com/questions/44805984/golang-interface-to-struct", "title": "Golang interface to struct", "body": "<p>I have a function that has a parameter with the type interface{}, something like:</p>\n\n<pre><code>func LoadTemplate(templateData interface{}) {\n</code></pre>\n\n<p>In my case, templateData is a struct, but each time it has a different structure. I used the type \"interface{}\" because it allows me to send all kind of data.</p>\n\n<p>I'm using this templateData to send the data to the template:</p>\n\n<pre><code>err := tmpl.ExecuteTemplate(w, baseTemplateName, templateData)\n</code></pre>\n\n<p>But now I want to append some new data and I don't know how to do it because the \"interface\" type doesn't allow me to add/append anything. </p>\n\n<p>I tried to convert the interface to a struct, but I don't know how to append data to a struct with an unknown structure. </p>\n\n<p>If I use the following function I can see the interface's data:</p>\n\n<pre><code>templateData = appendAssetsToTemplateData(templateData)\n\nfunc appendAssetsToTemplateData(t interface{}) interface{} {\n    switch reflect.TypeOf(t).Kind() {\n    case reflect.Struct:\n        fmt.Println(\"struct\")\n        s := reflect.ValueOf(t)\n        fmt.Println(s)\n\n        //create a new struct based on current interface data\n    }\n\n    return t\n}\n</code></pre>\n\n<p>Any idea how can I append a child to the initial interface parameter (templateData)? Or how can I transform it to a struct or something else in order to append the new child/data?</p>\n"}, {"tags": ["php", "node.js", "web-services", "go", "dns"], "comments": [{"owner": {"reputation": 19745, "user_id": 574632, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bb13b2bbc97ce81108b09be9a41120a1?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/574632/steve"}, "edited": false, "score": 0, "creation_date": 1498661556, "post_id": 44805907, "comment_id": 76591828, "body": "yes, you have the basic theory. since web access is via port 80 (or 443 for ssl), you need a reverse proxy like nginx to forward traffic to the correct port"}, {"owner": {"reputation": 44030, "user_id": 453002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66e564e1221dfd0bfd24e7c47e2079ea?s=128&d=identicon&r=PG", "display_name": "Alex Howansky", "link": "https://stackoverflow.com/users/453002/alex-howansky"}, "edited": false, "score": 0, "creation_date": 1498661565, "post_id": 44805907, "comment_id": 76591838, "body": "What&#39;s your web server? Nginx makes for a nice reverse proxy."}, {"owner": {"reputation": 1682, "user_id": 8198537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5068ac0b549c918a596ae4dfca51f6c6?s=128&d=identicon&r=PG", "display_name": "Ivo P", "link": "https://stackoverflow.com/users/8198537/ivo-p"}, "edited": false, "score": 0, "creation_date": 1498661820, "post_id": 44805907, "comment_id": 76592053, "body": "is it all http based? So cold the client needing to talk to the Go app first connect to Apache on port 80 and then redirected to domainname.com:5000?  That can be done. Question is if your client can handle the redirect"}, {"owner": {"reputation": 1682, "user_id": 8198537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5068ac0b549c918a596ae4dfca51f6c6?s=128&d=identicon&r=PG", "display_name": "Ivo P", "link": "https://stackoverflow.com/users/8198537/ivo-p"}, "edited": false, "score": 0, "creation_date": 1498661995, "post_id": 44805907, "comment_id": 76592185, "body": "if($_SERVER[&#39;HTTP_HOST&#39; == &#39;go.domain.com&#39;) { header(&#39;Location:   <a href=\"http://go.domain.com:5000&#39;\" rel=\"nofollow noreferrer\">go.domain.com:5000&#39;</a>); exit();  }"}, {"owner": {"reputation": 713, "user_id": 6679641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e70f22331a802d8b5b812a994372b92?s=128&d=identicon&r=PG&f=1", "display_name": "harry lakins", "link": "https://stackoverflow.com/users/6679641/harry-lakins"}, "edited": false, "score": 0, "creation_date": 1498663976, "post_id": 44805907, "comment_id": 76593760, "body": "Yea exactly what I had in mind. That an acceptable way of doing it?"}], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 6679641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e70f22331a802d8b5b812a994372b92?s=128&d=identicon&r=PG&f=1", "display_name": "harry lakins", "link": "https://stackoverflow.com/users/6679641/harry-lakins"}, "edited": false, "score": 0, "creation_date": 1498663048, "post_id": 44806148, "comment_id": 76593016, "body": "They won&#39;t be under sane name at all. I&#39;m more looking for goapp.com, phpapp.com, etc (not sub domain)...or does it still work?"}, {"owner": {"reputation": 44030, "user_id": 453002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66e564e1221dfd0bfd24e7c47e2079ea?s=128&d=identicon&r=PG", "display_name": "Alex Howansky", "link": "https://stackoverflow.com/users/453002/alex-howansky"}, "reply_to_user": {"reputation": 713, "user_id": 6679641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e70f22331a802d8b5b812a994372b92?s=128&d=identicon&r=PG&f=1", "display_name": "harry lakins", "link": "https://stackoverflow.com/users/6679641/harry-lakins"}, "edited": false, "score": 0, "creation_date": 1498663367, "post_id": 44806148, "comment_id": 76593277, "body": "Still works. Server name can be anything as long as it&#39;s a valid DNS name that resolves to your IP."}, {"owner": {"reputation": 713, "user_id": 6679641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e70f22331a802d8b5b812a994372b92?s=128&d=identicon&r=PG&f=1", "display_name": "harry lakins", "link": "https://stackoverflow.com/users/6679641/harry-lakins"}, "edited": false, "score": 0, "creation_date": 1498664032, "post_id": 44806148, "comment_id": 76593797, "body": "Oh great. And how exactly can these different proxy_passes be all seen as port 80?"}, {"owner": {"reputation": 44030, "user_id": 453002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66e564e1221dfd0bfd24e7c47e2079ea?s=128&d=identicon&r=PG", "display_name": "Alex Howansky", "link": "https://stackoverflow.com/users/453002/alex-howansky"}, "reply_to_user": {"reputation": 713, "user_id": 6679641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e70f22331a802d8b5b812a994372b92?s=128&d=identicon&r=PG&f=1", "display_name": "harry lakins", "link": "https://stackoverflow.com/users/6679641/harry-lakins"}, "edited": false, "score": 0, "creation_date": 1498664128, "post_id": 44806148, "comment_id": 76593869, "body": "The inbound port should always be 80, that&#39;s kinda the point. (Or 443 if you&#39;re using HTTPS.) It&#39;s the <code>proxy_pass</code> port that you want to change based on the app."}, {"owner": {"reputation": 713, "user_id": 6679641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e70f22331a802d8b5b812a994372b92?s=128&d=identicon&r=PG&f=1", "display_name": "harry lakins", "link": "https://stackoverflow.com/users/6679641/harry-lakins"}, "edited": false, "score": 0, "creation_date": 1498664520, "post_id": 44806148, "comment_id": 76594106, "body": "Cool. Finally, where is this file processed/written on server?"}, {"owner": {"reputation": 44030, "user_id": 453002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66e564e1221dfd0bfd24e7c47e2079ea?s=128&d=identicon&r=PG", "display_name": "Alex Howansky", "link": "https://stackoverflow.com/users/453002/alex-howansky"}, "reply_to_user": {"reputation": 713, "user_id": 6679641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e70f22331a802d8b5b812a994372b92?s=128&d=identicon&r=PG&f=1", "display_name": "harry lakins", "link": "https://stackoverflow.com/users/6679641/harry-lakins"}, "edited": false, "score": 0, "creation_date": 1498664795, "post_id": 44806148, "comment_id": 76594335, "body": "The file will be named <code>nginx.conf</code> -- this text can (generally) be appended to it. Where the file is located totally depends on your particular install."}], "tags": [], "owner": {"reputation": 44030, "user_id": 453002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66e564e1221dfd0bfd24e7c47e2079ea?s=128&d=identicon&r=PG", "display_name": "Alex Howansky", "link": "https://stackoverflow.com/users/453002/alex-howansky"}, "is_accepted": true, "score": 0, "last_activity_date": 1498661993, "creation_date": 1498661993, "answer_id": 44806148, "question_id": 44805907, "link": "https://stackoverflow.com/questions/44805907/how-to-use-different-domain-names-for-different-processes-running-on-same-server/44806148#44806148", "title": "how to use different domain names for different processes running on same server", "body": "<p>If you're already using Nginx, you can very easily set up named-based reverse proxy vhosts for the apps that aren't on port 80:</p>\n\n<pre><code>server {\n    listen *:80;\n    server_name nodeapp.mydomain.com;\n    location / {\n        proxy_pass http://localhost:3000;\n    }\n}\n\nserver {\n    listen *:80;\n    server_name goapp.mydomain.com;\n    location / {\n        proxy_pass http://localhost:5000;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "is_accepted": false, "score": 0, "last_activity_date": 1498663036, "creation_date": 1498663036, "answer_id": 44806560, "question_id": 44805907, "link": "https://stackoverflow.com/questions/44805907/how-to-use-different-domain-names-for-different-processes-running-on-same-server/44806560#44806560", "title": "how to use different domain names for different processes running on same server", "body": "<p>If what you're running on port 80 is just a proxy layer, you could instead use <a href=\"https://caddyserver.com/\" rel=\"nofollow noreferrer\">caddy</a>, which is itself written in Go. Your Caddyfile would like something like this:</p>\n\n<pre><code>nodeapp.mydomain.com {\n    proxy / localhost:3000\n}\n\ngoapp.mydomain.com {\n    proxy / localhost:5000\n}\n</code></pre>\n\n<p>If not, you could still use caddy and just move your PHP application to a different port.</p>\n\n<p>I suggest caddy because its creator pushes for security everywhere (you will notice you get automatic https if your site is applicable). The configuration (done in the Caddyfile) is also usually short and very easy to understand. Caddy has a wide range of use cases and can come with plugins to do just about anything you can think up.</p>\n"}], "owner": {"reputation": 713, "user_id": 6679641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e70f22331a802d8b5b812a994372b92?s=128&d=identicon&r=PG&f=1", "display_name": "harry lakins", "link": "https://stackoverflow.com/users/6679641/harry-lakins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 44806148, "answer_count": 2, "score": -2, "last_activity_date": 1498663036, "creation_date": 1498661440, "question_id": 44805907, "link": "https://stackoverflow.com/questions/44805907/how-to-use-different-domain-names-for-different-processes-running-on-same-server", "title": "how to use different domain names for different processes running on same server", "body": "<p>Assume I have three different sites running. Node.js app on port 3000, Apache/PHP on port 80, and then a Go app on port 5000.</p>\n\n<p>How can I have three different domain names that go to each port?</p>\n\n<p>I was thinking of a basic route system on port 80 that all domains refer to, then the program looks at url and redirects to correct port. Is that recommended? Is there a better way?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "ascii", "chr"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1498658395, "creation_date": 1498658395, "answer_id": 44804675, "question_id": 44804276, "link": "https://stackoverflow.com/questions/44804276/equivalent-of-phps-chr-in-golang/44804675#44804675", "title": "Equivalent of php&#39;s chr in golang", "body": "<p>The results in PHP and Go are different because, as the documentation for each states, <a href=\"http://php.net/manual/en/function.chr.php\" rel=\"nofollow noreferrer\">PHP's chr</a> returns the ASCII character for its argument, whereas <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">Go's rune</a> <a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"nofollow noreferrer\">uses UTF-8</a>. Below 127, ASCII and UTF-8 are the same, but above that, they differ.</p>\n"}], "owner": {"reputation": 13, "user_id": 4836965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/541fb6d298666a015897298774316668?s=128&d=identicon&r=PG&f=1", "display_name": "jatlylee", "link": "https://stackoverflow.com/users/4836965/jatlylee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 1, "accepted_answer_id": 44804675, "answer_count": 1, "score": 0, "last_activity_date": 1498662018, "creation_date": 1498657444, "question_id": 44804276, "link": "https://stackoverflow.com/questions/44804276/equivalent-of-phps-chr-in-golang", "title": "Equivalent of php&#39;s chr in golang", "body": "<p>i am try to change a fuction from php to golang . the function job is use chr,ord,base4_encode to encode some string\u3002php generate a serial int number, like 122|234|135|138|179|19|190|183|80|156|4|159|195|213|86|241|140|7|112|23|61|182|37|91|185|26|203|185|206|206|183,\nsome number biger than 127,the ascii bigest number is 127.\nnow, the probrem is:\nphp's chr(206) is not equivalent golang's string(rune(206))</p>\n\n<p>please help me,thx</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1498655342, "post_id": 44803367, "comment_id": 76586713, "body": "We can&#39;t say without knowing what <code>DoSomething</code> does. The goroutines need to return in order to release any memory they consume."}, {"owner": {"reputation": 1536, "user_id": 6691722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8e0d7ea4dc27c23764c2ec07207f08d?s=128&d=identicon&r=PG", "display_name": "0rka", "link": "https://stackoverflow.com/users/6691722/0rka"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498655788, "post_id": 44803367, "comment_id": 76587085, "body": "For the sake of it, lets just say it checks if a character is contained inside a string. If so, it returns <code>true</code> to the <code>results</code> channel, else it returns <code>false</code>. I would like to catch the first <code>false</code> and collapse the whole for-select statement."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498656110, "post_id": 44803367, "comment_id": 76587349, "body": "There&#39;s still not enough info here to say with certainty. The goroutines need to return. That&#39;s all. If the channel capacity is enough to accept all results, and not block any goroutines, then you don&#39;t have a problem, and if some goroutines are blocked, then you do have a problem. You say the goroutine may be left running, but if you know that, then you know where it would be blocked and can fix it."}, {"owner": {"reputation": 1536, "user_id": 6691722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8e0d7ea4dc27c23764c2ec07207f08d?s=128&d=identicon&r=PG", "display_name": "0rka", "link": "https://stackoverflow.com/users/6691722/0rka"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498656906, "post_id": 44803367, "comment_id": 76587974, "body": "As a matter of fact, the whole pseudo code above is encapsulated in a function. When I return from a function as I did, will the results channel still be in memory and not raise a panic when goroutines try to send on it? The whole point is to buffer the channel in the length of my requests to <code>DoSomething</code> (in the case above, NumRequests will be 3), but I&#39;m afraid some resources might leak when doing so."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498657525, "post_id": 44803367, "comment_id": 76588487, "body": "If the <code>DoSomething</code> goroutines return, then there is no leak. The results channel will exist as long as something has a reference to it, it can&#39;t just disappear. If you want the goroutintes to be able to exit early, you need to provide another channel or context to notify them, but that&#39;s a separate issue."}, {"owner": {"reputation": 1536, "user_id": 6691722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8e0d7ea4dc27c23764c2ec07207f08d?s=128&d=identicon&r=PG", "display_name": "0rka", "link": "https://stackoverflow.com/users/6691722/0rka"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498657942, "post_id": 44803367, "comment_id": 76588854, "body": "That&#39;s exactly my question. By saying <b>as something has a reference to it</b>, do you mean that when I return from <code>if !r { return }</code> that the results channel deletes itself from memory?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498658401, "post_id": 44803367, "comment_id": 76589314, "body": "Nothing &quot;deletes itself from memory&quot; (stack allocated variables kind of do, in a sense, but Go will heap allocate everything that requires it) Each goroutine has a reference to the channel that was passed in as a parameter, so the channel can&#39;t be collected until they have all returned. It comes back to my first statement -- the only thing you need to ensure is that the goroutines return."}], "answers": [{"comments": [{"owner": {"reputation": 1536, "user_id": 6691722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8e0d7ea4dc27c23764c2ec07207f08d?s=128&d=identicon&r=PG", "display_name": "0rka", "link": "https://stackoverflow.com/users/6691722/0rka"}, "edited": false, "score": 0, "creation_date": 1498661326, "post_id": 44803578, "comment_id": 76591653, "body": "Neat. Tested it now and it works as expected. Thanks!"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 5, "last_activity_date": 1498655696, "creation_date": 1498655696, "answer_id": 44803578, "question_id": 44803367, "link": "https://stackoverflow.com/questions/44803367/what-happens-when-returning-on-for-select-loop-with-running-goroutines/44803578#44803578", "title": "What happens when returning on for-select loop with running goroutines", "body": "<p>This is the exact purpose behind cancellable contexts. Take a look at the example for <a href=\"https://golang.org/pkg/context/#WithCancel\" rel=\"noreferrer\"><code>context.WithCancel</code></a>, it shows how to do exactly what you describe.</p>\n"}], "owner": {"reputation": 1536, "user_id": 6691722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8e0d7ea4dc27c23764c2ec07207f08d?s=128&d=identicon&r=PG", "display_name": "0rka", "link": "https://stackoverflow.com/users/6691722/0rka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1058, "favorite_count": 0, "accepted_answer_id": 44803578, "answer_count": 1, "score": 0, "last_activity_date": 1498655696, "creation_date": 1498655111, "question_id": 44803367, "link": "https://stackoverflow.com/questions/44803367/what-happens-when-returning-on-for-select-loop-with-running-goroutines", "title": "What happens when returning on for-select loop with running goroutines", "body": "<p>I'm trying to figure how can I shorten run times as much as possible when waiting for results on multiple goroutines. The idea is doing a for-select loop on retrieving messages from a channel (result channel) and breaking out of the loop when a result is false. Subsequently, potentially one or more goroutines are left running and I don't quite know what would happen in the background.</p>\n\n<p>Consider this:</p>\n\n<pre><code>results := make(chan bool, int NumRequests)\ngo DoSomething(results) // DoSomething sends the result on results channel\ngo DoSomething(results) // DoSomething sends the result on results channel\ngo DoSomething(results) // DoSomething sends the result on results channel\nfor {\n    select {\n    case r := &lt;- results:\n        if !r {\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>My question is - What would happen if I return while there are goroutines trying to sent their result to the channel? I've made a buffered results channel as seen above so the goroutines wouldn't deadlock while running. What would happen memory-wise when doing this? Will there be a goroutine leakage? What is the idiomatic way of doing something like this? </p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 153, "user_id": 2291886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d94d277ece247295c9ca745b28c60067?s=128&d=identicon&r=PG", "display_name": "Gianfranco Reppucci", "link": "https://stackoverflow.com/users/2291886/gianfranco-reppucci"}, "edited": false, "score": 0, "creation_date": 1498657919, "post_id": 44803303, "comment_id": 76588832, "body": "Did you try with this solution <a href=\"https://stackoverflow.com/questions/20130710/google-app-engine-importerror-no-module-named-appengine-tools\" title=\"google app engine importerror no module named appengine tools\">stackoverflow.com/questions/20130710/&hellip;</a> ? The import error you are referring to is from a python package, not a golang one."}, {"owner": {"reputation": 1, "user_id": 4456408, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000673910221/picture?type=large", "display_name": "Shingo Kumagai", "link": "https://stackoverflow.com/users/4456408/shingo-kumagai"}, "reply_to_user": {"reputation": 153, "user_id": 2291886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d94d277ece247295c9ca745b28c60067?s=128&d=identicon&r=PG", "display_name": "Gianfranco Reppucci", "link": "https://stackoverflow.com/users/2291886/gianfranco-reppucci"}, "edited": false, "score": 0, "creation_date": 1498694718, "post_id": 44803303, "comment_id": 76609201, "body": "I tried solution B, but I did not find /usr/lib/python2.7/dist-packages/google directory in my env"}], "owner": {"reputation": 1, "user_id": 4456408, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000673910221/picture?type=large", "display_name": "Shingo Kumagai", "link": "https://stackoverflow.com/users/4456408/shingo-kumagai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498654943, "creation_date": 1498654943, "question_id": 44803303, "link": "https://stackoverflow.com/questions/44803303/importerror-no-module-named-appengine-tools-on-gce-golang", "title": "ImportError: No module named appengine.tools on GCE/Golang", "body": "<p><code>goapp deploy</code></p>\n\n<p>always get </p>\n\n<p><code>\nTraceback (most recent call last):\n  File \"/Users/{Username}/.go_appengine/google-cloud-sdk/platform/google_appengine/goapp\", line 13, in &lt;module&gt;\n    from google.appengine.tools import goroots\nImportError: No module named appengine.tools\n</code></p>\n\n<p>What should i do?</p>\n"}, {"tags": ["json", "go", "google-sheets"], "comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1498655915, "post_id": 44802899, "comment_id": 76587182, "body": "<code>curl -G https:&#47;&#47;spreadsheets.google.com&#47;feeds&#47;list&#47;168xdxefP3gGnrTGg&zwnj;&#8203;2hwJoeRVfmbEuTB5plFT&zwnj;&#8203;yd6I5Qo&#47;1&#47;public&#47;val&zwnj;&#8203;ues?alt=json</code> gives some output starting with <code>{&quot;version&quot;:&quot;1.0&quot;,&quot;encoding&quot;:&quot;UTF-8&quot;,&quot;feed&quot;:{&quot;xmlns&quot;:&quot;http:&#47;&#47;&zwnj;&#8203;www.w3.org&#47;2005&#47;Atom&zwnj;&#8203;&quot;,&quot;xml</code> so <code>feed</code> certainly doesn&#39;t contain a version field ..."}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": false, "score": 1, "last_activity_date": 1498656152, "creation_date": 1498656152, "answer_id": 44803766, "question_id": 44802899, "link": "https://stackoverflow.com/questions/44802899/reading-json-from-url/44803766#44803766", "title": "Reading json from url", "body": "<p>As already pointed out, your definition of <code>GSSS</code> is wrong.</p>\n\n<p>This works a bit better:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n)\n\ntype GSSS struct {\n    Version string `json:\"version\"`\n    Feed GSSSfeed `json:\"feed\"`\n}\n\ntype GSSSfeed struct {\n    TITLE   GSSTitle `json:\"title\"`\n    // Entry   []GSSSEntry `json:\"entry\"`\n}\ntype GSSTitle struct {\n    T string `json:\"$t\"`\n}\n\nfunc main() {\n    url01 := \"https://spreadsheets.google.com/feeds/list/168xdxefP3gGnrTGg2hwJoeRVfmbEuTB5plFTyd6I5Qo/1/public/values?alt=json\"\n    //url02 := \"https://spreadsheets.google.com/feeds/list/168xdxefP3gGnrTGg2hwJoeRVfmbEuTB5plFTyd6I5Qo/2/public/values?alt=json\"\n    //url03 := \"https://spreadsheets.google.com/feeds/list/168xdxefP3gGnrTGg2hwJoeRVfmbEuTB5plFTyd6I5Qo/3/public/values?alt=json\"\n    //url04 := \"https://spreadsheets.google.com/feeds/list/168xdxefP3gGnrTGg2hwJoeRVfmbEuTB5plFTyd6I5Qo/4/public/values?alt=json\"\n    //url05 := \"https://spreadsheets.google.com/feeds/list/168xdxefP3gGnrTGg2hwJoeRVfmbEuTB5plFTyd6I5Qo/5/public/values?alt=json\"\n    println(\"=============  starting main =============\")\n\n    // res, err := http.Get(\"https://www.citibikenyc.com/stations/json\")\n    res, err := http.Get(url01)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    // body, err := ioutil.ReadAll(res.Body)\n    // if err != nil {\n    //  panic(err.Error())\n    // }\n\n    var m GSSS\n    // err := json.Unmarshal(body, &amp;m)\n    //json.NewDecoder(res.Body).Decode(&amp;m)\n    // json.NewDecoder([]byte(body)).Decode(&amp;m)\n\n    // json.NewDecoder([]byte(res.Body)).Decode(&amp;m)\n    json.NewDecoder(res.Body).Decode(&amp;m)\n\n    //err := json.Unmarshal([]byte(body), &amp;m)\n    if err != nil {\n        fmt.Println(\"Whoops...:\", err)\n    }\n\n    fmt.Println(\"============  about to print m3 ============\")\n    fmt.Println(m)\n    fmt.Println(\"============  about to print m4 ============\")\n}\n</code></pre>\n"}], "owner": {"reputation": 2724, "user_id": 354007, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6c577241666b544e9fa19d9a013f964c?s=128&d=identicon&r=PG", "display_name": "IrishGringo", "link": "https://stackoverflow.com/users/354007/irishgringo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498911342, "creation_date": 1498653999, "last_edit_date": 1498911342, "question_id": 44802899, "link": "https://stackoverflow.com/questions/44802899/reading-json-from-url", "title": "Reading json from url", "body": "<p>The endpoint was created in Google SpreadSheet, which is here:</p>\n\n<pre><code>url01 := \"https://spreadsheets.google.com/feeds/list/168xdxefP3gGnrTGg2hwJoeRVfmbEuTB5plFTyd6I5Qo/1/public/values?alt=json\"\n</code></pre>\n\n<p>The Git repo is here...    which is where I will keep the updated code as I fix it. My hunch is that I am screwing up the struct when I import the file.  The code prints nothing.  So, could I get some advice on what is going wrong please.</p>\n\n<pre><code>        package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n)\n\ntype GSSS struct {\n    Feed GSSSfeed `json:\"feed\"`\n}\n\ntype GSSSfeed struct {\n    Version string   `json:\"version\"`\n    TITLE   GSSTitle `json:\"title\"`\n    // Entry   []GSSSEntry `json:\"entry\"`\n}\ntype GSSTitle struct {\n    T string `json:\"t\"`\n}\n\nfunc main() {\n    url01 := \"https://spreadsheets.google.com/feeds/list/168xdxefP3gGnrTGg2hwJoeRVfmbEuTB5plFTyd6I5Qo/1/public/values?alt=json\"\n    //url02 := \"https://spreadsheets.google.com/feeds/list/168xdxefP3gGnrTGg2hwJoeRVfmbEuTB5plFTyd6I5Qo/2/public/values?alt=json\"\n    //url03 := \"https://spreadsheets.google.com/feeds/list/168xdxefP3gGnrTGg2hwJoeRVfmbEuTB5plFTyd6I5Qo/3/public/values?alt=json\"\n    //url04 := \"https://spreadsheets.google.com/feeds/list/168xdxefP3gGnrTGg2hwJoeRVfmbEuTB5plFTyd6I5Qo/4/public/values?alt=json\"\n    //url05 := \"https://spreadsheets.google.com/feeds/list/168xdxefP3gGnrTGg2hwJoeRVfmbEuTB5plFTyd6I5Qo/5/public/values?alt=json\"\n    println(\"=============  starting main =============\")\n\n    // res, err := http.Get(\"https://www.citibikenyc.com/stations/json\")\n    res, err := http.Get(url01)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    // body, err := ioutil.ReadAll(res.Body)\n    // if err != nil {\n    //  panic(err.Error())\n    // }\n\n    var m GSSS\n    // err := json.Unmarshal(body, &amp;m)\n    //json.NewDecoder(res.Body).Decode(&amp;m)\n    // json.NewDecoder([]byte(body)).Decode(&amp;m)\n\n    // json.NewDecoder([]byte(res.Body)).Decode(&amp;m)\n    json.NewDecoder(res.Body).Decode(&amp;m)\n\n    //err := json.Unmarshal([]byte(body), &amp;m)\n    if err != nil {\n        fmt.Println(\"Whoops...:\", err)\n    }\n\n    fmt.Println(\"============  about to print m ============\")\n    fmt.Println(m.Feed.TITLE.T)\n    fmt.Println(\"============  about to print m2 ============\")\n    fmt.Println(m.Feed)\n    fmt.Println(\"============  about to print m3 ============\")\n    fmt.Println(m)\n    fmt.Println(\"============  about to print m4 ============\")\n}\n</code></pre>\n"}, {"tags": ["go", "dependency-management", "glide-golang"], "answers": [{"comments": [{"owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "edited": false, "score": 0, "creation_date": 1498654342, "post_id": 44802997, "comment_id": 76585850, "body": "I need to use a combination of vendor dependencies and local versions. I guess a hacky route is to kill off selected directories under <code>vendor&#47;...</code> but I wanted to see if there was a better/official way to do it."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1499258107, "post_id": 44802997, "comment_id": 76828217, "body": "this is correct. remove from <code>vendor</code> the packages you depend on and currently want to work on. avoid symlinks, rely on go internal strategy to resolve a dependency."}], "tags": [], "owner": {"reputation": 376, "user_id": 6618366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbooN.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/6618366/alejandro"}, "is_accepted": false, "score": 12, "last_activity_date": 1499849399, "last_edit_date": 1499849399, "creation_date": 1498654225, "answer_id": 44802997, "question_id": 44802725, "link": "https://stackoverflow.com/questions/44802725/how-to-use-local-versions-of-glide-dependencies/44802997#44802997", "title": "How to use local versions of glide dependencies?", "body": "<p>If you want to test the dependencies under '$GOPATH/src/...' just temporally remove every glide file in the root of your project (glide.yaml, glide.lock,etc...).\nThen you can put back those files if you need to use 'vendor' dependencies again.</p>\n\n<p><strong>Update 1</strong></p>\n\n<p>I was looking for the same solution for my projects then I figured out that glide documentation specifies an extra useful parameter on glide.yaml for imports.\nAccording to <a href=\"https://glide.readthedocs.io/en/latest/glide.yaml/\" rel=\"noreferrer\">the official documentation</a>:</p>\n\n<blockquote>\n  <p><code>repo</code>: If the package name isn't the repo location or\n      this is a private repository it can go here.\n      The package will be checked out from the repo\n      and put where the package name specifies.\n      This allows using forks.</p>\n</blockquote>\n\n<p>In that case you just push your code somewhere (GitHub or Gitlab for private repos of your $GOPATH/src/github.com/hyperledger/burrow I guess) then edit your glide.yaml:</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>- package: github.com/tendermint/tendermint &lt;-- vendor name dependencies\n  repo:    github.com/myrepo/tendermint   &lt;-- your remote fork\n  version: vx.x.x or your sha commit code\n</code></pre>\n\n<p>In this way you can switch from your official version to your fork and make your tests.\nTo turn back to your official version just remove or comment repo and version attributes:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>- package: github.com/tendermint/tendermint &lt;-- vendor name dependencies\n#  repo:    github.com/myrepo/tendermint   &lt;-- your remote fork\n#  version: vx.x.x or your sha commit code\n</code></pre>\n\n<p>I'm testing my forks in this way now and you don't need to change your import paths into your code, hope this helps.</p>\n\n<p><strong>Update 2</strong></p>\n\n<p>Another useful way is to use <a href=\"https://glide.readthedocs.io/en/latest/commands/#glide-mirror\" rel=\"noreferrer\">glide mirror</a>:</p>\n\n<blockquote>\n  <p>Mirrors provide the ability to replace a repo location with\n      another location that's a mirror of the original.\n      This is useful when you want to have a cache for your continuous\n      integration (CI) system or if you want to work on a dependency in\n      a local location.</p>\n</blockquote>\n\n<p>I guess this one is the best solution, for example, on command line type:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ glide mirror set github.com/tendermint/tendermint file:///User/yourname/Gospace/src/github.com/tendermint/tendermint\n</code></pre>\n\n<p>This will create a mirror.yaml in your GLIDE_HOME (if not exists then will be placed under your $USER/.glide folder).\nNow you can test your local version (under GOPATH) without fork your project (as I wrote above).\nOnce you finished your tests just remove it:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ glide mirror remove github.com/tendermint/tendermint\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "is_accepted": false, "score": 5, "last_activity_date": 1499421636, "last_edit_date": 1499421636, "creation_date": 1499341901, "answer_id": 44948118, "question_id": 44802725, "link": "https://stackoverflow.com/questions/44802725/how-to-use-local-versions-of-glide-dependencies/44948118#44948118", "title": "How to use local versions of glide dependencies?", "body": "<p>Given the Go vendoring is first looking up packages in your project root <code>/vendor</code> folder and when not found then in the <code>GOPATH</code> and that Glide <em>installs</em> your dependencies to the <code>/vendor</code> folder means that you can just set up your project with <code>glide install</code>, then manually remove the dependencies that have been locally modified (or you are going to modify) in their local installations from your project's <code>/vendor</code> folder and Go vendoring will then pick your locally modified versions found under <code>GOPATH</code>.</p>\n\n<p>Once you have tested everything, you first have to commit all the modified dependencies and then head back to your project and modify the <code>glide.yaml</code> file to use the new versions of these dependencies.</p>\n\n<p>This should work.</p>\n"}], "owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4041, "favorite_count": 2, "answer_count": 2, "score": 9, "last_activity_date": 1499849399, "creation_date": 1498653594, "question_id": 44802725, "link": "https://stackoverflow.com/questions/44802725/how-to-use-local-versions-of-glide-dependencies", "title": "How to use local versions of glide dependencies?", "body": "<p>I'm working on a Go project that uses <a href=\"https://github.com/Masterminds/glide\" rel=\"noreferrer\">Glide</a> for dependency management. I need to make changes to the project, but also to several dependencies used by the project. I need to test these changes together, before committing the alterations to each project separately.</p>\n\n<p>How can I tell Glide (or Go) to use local versions of these projects (e.g. found in <code>$GOPATH/src/...</code>) rather than pulling down something and stuffing it in the <code>vendor</code> directory)?</p>\n\n<p>To give an example:</p>\n\n<ul>\n<li><code>github.com/hyperledger/burrow</code> depends on:</li>\n<li><code>github.com/tendermint/tendermint</code>, which depends on:</li>\n<li><code>github.com/tendermint/go-crypto</code></li>\n</ul>\n\n<p>I need to make some changes spanning all three projects. I want to test the changes by executing things in the <code>burrow</code> project, but I need it to execute my development versions of <code>tendermint</code> and <code>go-crypto</code>, which I have locally.</p>\n"}, {"tags": ["go", "glog"], "comments": [{"owner": {"reputation": 1476, "user_id": 6002847, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/N5MZn.png?s=128&g=1", "display_name": "Piotr Reszke", "link": "https://stackoverflow.com/users/6002847/piotr-reszke"}, "edited": false, "score": 1, "creation_date": 1498651809, "post_id": 44801958, "comment_id": 76583909, "body": "just guessing that your log rotation/compression rules are wrong. Old logs should be compressed - so InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-13&zwnj;&#8203;4018.246 should become: InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-13&zwnj;&#8203;4018.246-1498528861.&zwnj;&#8203;gz.  In your case even the already gzipped files are getting gzipped over and over again."}, {"owner": {"reputation": 235, "user_id": 4783884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac84df6f081961c434a45b71a098222?s=128&d=identicon&r=PG&f=1", "display_name": "Paul A. Fortin", "link": "https://stackoverflow.com/users/4783884/paul-a-fortin"}, "reply_to_user": {"reputation": 1476, "user_id": 6002847, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/N5MZn.png?s=128&g=1", "display_name": "Piotr Reszke", "link": "https://stackoverflow.com/users/6002847/piotr-reszke"}, "edited": false, "score": 0, "creation_date": 1498653651, "post_id": 44801958, "comment_id": 76585324, "body": "But glog does not do that so you think the log rotation on the server is wrong?"}, {"owner": {"reputation": 1476, "user_id": 6002847, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/N5MZn.png?s=128&g=1", "display_name": "Piotr Reszke", "link": "https://stackoverflow.com/users/6002847/piotr-reszke"}, "edited": false, "score": 1, "creation_date": 1498654004, "post_id": 44801958, "comment_id": 76585580, "body": "It&#39;s the first thing I would check"}, {"owner": {"reputation": 235, "user_id": 4783884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac84df6f081961c434a45b71a098222?s=128&d=identicon&r=PG&f=1", "display_name": "Paul A. Fortin", "link": "https://stackoverflow.com/users/4783884/paul-a-fortin"}, "reply_to_user": {"reputation": 1476, "user_id": 6002847, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/N5MZn.png?s=128&g=1", "display_name": "Piotr Reszke", "link": "https://stackoverflow.com/users/6002847/piotr-reszke"}, "edited": false, "score": 0, "creation_date": 1498655337, "post_id": 44801958, "comment_id": 76586706, "body": "After looking into it I believe you are right and that I will pass this on to my DevOps guys :)  Thanks!"}], "owner": {"reputation": 235, "user_id": 4783884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac84df6f081961c434a45b71a098222?s=128&d=identicon&r=PG&f=1", "display_name": "Paul A. Fortin", "link": "https://stackoverflow.com/users/4783884/paul-a-fortin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498651610, "creation_date": 1498651610, "question_id": 44801958, "link": "https://stackoverflow.com/questions/44801958/golang-glog-created-hundreds-of-tiny-files-on-my-server", "title": "golang/glog created hundreds of tiny files on my server", "body": "<p>I am using glog in my app that is deployed in a docker container and it has created hundreds of tiny files and I am wondering why and how to stop it.  Here is a small sample of my directory listing.</p>\n\n<pre><code>-rw-r--r--. 1 urbncat urbncat         20 Jun 27 18:40 InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-134018.246-1498528861.gz-1498536061.gz-1498546861.gz-1498550462.gz-1498582862.gz-1498590064.gz-1498608095.gz\n-rw-r--r--. 1 urbncat urbncat         20 Jun 27 20:14 InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-134018.246-1498528861.gz-1498536061.gz-1498546861.gz-1498550462.gz-1498582862.gz-1498590064.gz-1498611709.gz\n-rw-r--r--. 1 urbncat urbncat          0 Jun 27 23:34 InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-134018.246-1498528861.gz-1498536061.gz-1498546861.gz-1498550462.gz-1498586462.gz-1498593665.gz\n-rw-r--r--. 1 urbncat urbncat         20 Jun 27 18:40 InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-134018.246-1498528861.gz-1498536061.gz-1498546861.gz-1498550462.gz-1498586462.gz-1498593665.gz-1498604479.gz\n-rw-r--r--. 1 urbncat urbncat         20 Jun 27 18:40 InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-134018.246-1498528861.gz-1498536061.gz-1498546861.gz-1498550462.gz-1498586462.gz-1498593665.gz-1498608095.gz\n-rw-r--r--. 1 urbncat urbncat         20 Jun 27 20:14 InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-134018.246-1498528861.gz-1498536061.gz-1498546861.gz-1498550462.gz-1498586462.gz-1498593665.gz-1498611709.gz\n-rw-r--r--. 1 urbncat urbncat          0 Jun 27 23:34 InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-134018.246-1498528861.gz-1498536061.gz-1498546861.gz-1498550462.gz-1498590064.gz-1498597268.gz\n-rw-r--r--. 1 urbncat urbncat         54 Jun 27 14:04 InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-134018.246-1498528861.gz-1498536061.gz-1498546861.gz-1498550462.gz-1498590064.gz-1498597268.gz-1498604479.gz\n-rw-r--r--. 1 urbncat urbncat         20 Jun 27 14:04 InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-134018.246-1498528861.gz-1498536061.gz-1498546861.gz-1498550462.gz-1498590064.gz-1498597268.gz-1498608095.gz\n-rw-r--r--. 1 urbncat urbncat         20 Jun 27 20:14 InventoryProcessor.32c423b6e305.urbncat.log.INFO.20170626-134018.246-1498528861.gz-1498536061.gz-1498546861.gz-1498550462.gz-1498590064.gz-1498597268.gz-1498611709.gz\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 4004484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b265446cb82fc76b5ac93a771fd174?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Constantinescu", "link": "https://stackoverflow.com/users/4004484/bogdan-constantinescu"}, "edited": false, "score": 0, "creation_date": 1498647046, "post_id": 44800253, "comment_id": 76580639, "body": "I found this <a href=\"https://golang.org/pkg/html/template/#hdr-Contexts\" rel=\"nofollow noreferrer\">golang.org/pkg/html/template/#hdr-Contexts</a>, I think this is the reason, but how do I instruct go not to apply by default the &quot;| urlquery&quot; filter?"}, {"owner": {"reputation": 309, "user_id": 4004484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b265446cb82fc76b5ac93a771fd174?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Constantinescu", "link": "https://stackoverflow.com/users/4004484/bogdan-constantinescu"}, "edited": false, "score": 0, "creation_date": 1498647905, "post_id": 44800253, "comment_id": 76581225, "body": "&quot;The thing about this is that you should really think twice about why you don&#39;t want Go to apply this security behaviour to your template.&quot; Because in my case the RawQuery as URL struct documentation states, is already encoded so it&#39;s safe...."}, {"owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "edited": false, "score": 1, "creation_date": 1498650290, "post_id": 44800253, "comment_id": 76582732, "body": "Then you may simply use text/template in your program instead of html/template, see <a href=\"https://play.golang.org/p/_f1chjA3M6\" rel=\"nofollow noreferrer\">play.golang.org/p/_f1chjA3M6</a>"}], "tags": [], "owner": {"reputation": 1659, "user_id": 302646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYT9J.png?s=128&g=1", "display_name": "Makkes", "link": "https://stackoverflow.com/users/302646/makkes"}, "is_accepted": true, "score": 5, "last_activity_date": 1498648397, "last_edit_date": 1498648397, "creation_date": 1498646572, "answer_id": 44800253, "question_id": 44800093, "link": "https://stackoverflow.com/questions/44800093/go-rendering-url-rowquery-string-in-a-template-different-behaviours/44800253#44800253", "title": "Go rendering URL RowQuery string in a template - different behaviours", "body": "<p>The Go documentation of the <code>html/template</code> package explains the behaviour (<a href=\"https://golang.org/pkg/html/template/\" rel=\"noreferrer\">https://golang.org/pkg/html/template/</a>):</p>\n\n<blockquote>\n  <p>The security model used by this package assumes that template authors are trusted, while Execute's data parameter is not. More details are provided below.</p>\n</blockquote>\n\n<p>The thing about this is that you should really think twice about <strong>why</strong> you don't want Go to apply this security behaviour to your template.</p>\n\n<p>Then, if you're really sure you don't want to escape the string use <code>template.URL</code> intead of a string: <a href=\"https://play.golang.org/p/kfv2tH6WDG\" rel=\"noreferrer\">https://play.golang.org/p/kfv2tH6WDG</a></p>\n"}], "owner": {"reputation": 309, "user_id": 4004484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b265446cb82fc76b5ac93a771fd174?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Constantinescu", "link": "https://stackoverflow.com/users/4004484/bogdan-constantinescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1626, "favorite_count": 0, "accepted_answer_id": 44800253, "answer_count": 1, "score": 4, "last_activity_date": 1498648397, "creation_date": 1498646080, "question_id": 44800093, "link": "https://stackoverflow.com/questions/44800093/go-rendering-url-rowquery-string-in-a-template-different-behaviours", "title": "Go rendering URL RowQuery string in a template - different behaviours", "body": "<p>I 'm new to go and I got my mind stuck with something pretty trivial, so I ask for your help, maybe anyone knows why this behaviour happens:</p>\n\n<p>I want to output the query params string of an url object in a template, but apparently because of the \"?\" char placed in front of the variable, the (whole) output is url encoded. Does question mark has a special meaning in go templates?</p>\n\n<p>instead of <strong>param1=value1&amp;value2=param2</strong>, output is <strong>param1%3dvalue1%26value2%3dparam2</strong></p>\n\n<p><a href=\"https://play.golang.org/p/agO8qZsGwi\" rel=\"nofollow noreferrer\">Example</a> in go playground</p>\n"}, {"tags": ["regex", "string", "go", "replace"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1498639132, "post_id": 44797043, "comment_id": 76575294, "body": "Please post what you tried, and explain what the issues is."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5050584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/642e43e9082fce962f2e439d1dd6814a?s=128&d=identicon&r=PG&f=1", "display_name": "S2C", "link": "https://stackoverflow.com/users/5050584/s2c"}, "edited": false, "score": 0, "creation_date": 1498638350, "post_id": 44797124, "comment_id": 76574844, "body": "Thanks! couple of things: (1) how exactly is the Replace function working in this context. I don&#39;t see a <code>\\&quot;</code> in my string in a pattern, so what exactly is it finding each time to replace. (2) there were still commas at the end of each line in my file; is there a way to remove from end of each line?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 53, "user_id": 5050584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/642e43e9082fce962f2e439d1dd6814a?s=128&d=identicon&r=PG&f=1", "display_name": "S2C", "link": "https://stackoverflow.com/users/5050584/s2c"}, "edited": false, "score": 0, "creation_date": 1498638522, "post_id": 44797124, "comment_id": 76574935, "body": "@S2C It&#39;s an <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"nofollow noreferrer\">interpreted string literal</a>, <code>\\&quot;</code> means a single quotation mark (because the quotation mark itself would mean the end of the string literal). It finds <code>,&quot;</code> texts and replaces them with a newline plus a quotation mark. Exactly what you need."}, {"owner": {"reputation": 53, "user_id": 5050584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/642e43e9082fce962f2e439d1dd6814a?s=128&d=identicon&r=PG&f=1", "display_name": "S2C", "link": "https://stackoverflow.com/users/5050584/s2c"}, "edited": false, "score": 0, "creation_date": 1498638839, "post_id": 44797124, "comment_id": 76575120, "body": "Thanks! I see you&#39;re exploiting the fact that the comma I want to replace with a new line always has a quote after it. While this works in this context, there are other contexts that I have to do something similar where the only constant pattern is that the nth instance of the character is to be replaced."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 53, "user_id": 5050584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/642e43e9082fce962f2e439d1dd6814a?s=128&d=identicon&r=PG&f=1", "display_name": "S2C", "link": "https://stackoverflow.com/users/5050584/s2c"}, "edited": false, "score": 0, "creation_date": 1498638908, "post_id": 44797124, "comment_id": 76575158, "body": "And <code>string.Replace()</code> takes a string to replace in, next the part to replace, next what to replace with, and last how many replacements you want. <code>-1</code> means no limit."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 53, "user_id": 5050584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/642e43e9082fce962f2e439d1dd6814a?s=128&d=identicon&r=PG&f=1", "display_name": "S2C", "link": "https://stackoverflow.com/users/5050584/s2c"}, "edited": false, "score": 0, "creation_date": 1498638974, "post_id": 44797124, "comment_id": 76575205, "body": "@S2C And yes, I&#39;ve exploited the structure of your input, so that the solution is quite simple. This is not a general &quot;nth replacer&quot;."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1498637819, "creation_date": 1498637819, "answer_id": 44797124, "question_id": 44797043, "link": "https://stackoverflow.com/questions/44797043/replace-every-nth-instance-of-character-in-string/44797124#44797124", "title": "Replace every nth instance of character in string", "body": "<p>If that is your input, you should replace <code>,\"</code> strings with <code>\\n\"</code>.You may use <a href=\"https://golang.org/pkg/strings/#Replace\" rel=\"nofollow noreferrer\"><code>strings.Replace()</code></a> for this. This will leave a last, trailing comma which you can remove with a slicing.</p>\n\n<p>Solution:</p>\n\n<pre><code>in := `\"2017-06-01T09:15:00+0530\",1634.05,1635.95,1632.25,1632.25,769,\"2017-06-01T09:16:00+0530\",1632.25,1634.9,1631.65,1633.5,506,\"2017-06-01T09:17:00+0530\",1633.5,1639.95,1633.5,1638.4,991,`\nout := strings.Replace(in, \",\\\"\", \"\\n\\\"\", -1)\nout = out[:len(out)-1]\nfmt.Println(out)\n</code></pre>\n\n<p>Output is (try it on the <a href=\"https://play.golang.org/p/lb5ZrdLcwa\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>\"2017-06-01T09:15:00+0530\",1634.05,1635.95,1632.25,1632.25,769\n\"2017-06-01T09:16:00+0530\",1632.25,1634.9,1631.65,1633.5,506\n\"2017-06-01T09:17:00+0530\",1633.5,1639.95,1633.5,1638.4,991\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": false, "score": 1, "last_activity_date": 1498638044, "creation_date": 1498638044, "answer_id": 44797203, "question_id": 44797043, "link": "https://stackoverflow.com/questions/44797043/replace-every-nth-instance-of-character-in-string/44797203#44797203", "title": "Replace every nth instance of character in string", "body": "<p>If you want flexible.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    input := `\"2017-06-01T09:15:00+0530\",1634.05,1635.95,1632.25,1632.25,769,\"2017-06-01T09:16:00+0530\",1632.25,1634.9,1631.65,1633.5,506,\"2017-06-01T09:17:00+0530\",1633.5,1639.95,1633.5,1638.4,991,`\n    var result []string\n\n    for len(input) &gt; 0 {\n        token := strings.SplitN(input, \",\", 7)\n        s := strings.Join(token[0:6], \",\")\n        result = append(result, s)\n        input = input[len(s):]\n        input = strings.Trim(input, \",\")\n    }\n    fmt.Println(result)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/mm63Hx24ne\" rel=\"nofollow noreferrer\">https://play.golang.org/p/mm63Hx24ne</a></p>\n"}, {"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1498646483, "post_id": 44797934, "comment_id": 76580244, "body": "when processing strings consider it as []rune in these kid of scenarios"}, {"owner": {"reputation": 53, "user_id": 5050584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/642e43e9082fce962f2e439d1dd6814a?s=128&d=identicon&r=PG&f=1", "display_name": "S2C", "link": "https://stackoverflow.com/users/5050584/s2c"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1498735974, "post_id": 44797934, "comment_id": 76627634, "body": "Why would rune be more preferable?"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1498736173, "post_id": 44797934, "comment_id": 76627810, "body": "what you might think of as a character constant is called a <code>rune</code> constant in Go.  rune can contain one whole unicode character(32bit) whereas byte can hold only 8 bytes .For strngs with only ASCII characters treating string as []byte is fine but it fails when it has other unicode characters"}], "tags": [], "owner": {"reputation": 53, "user_id": 5050584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/642e43e9082fce962f2e439d1dd6814a?s=128&d=identicon&r=PG&f=1", "display_name": "S2C", "link": "https://stackoverflow.com/users/5050584/s2c"}, "is_accepted": true, "score": 1, "last_activity_date": 1498640093, "creation_date": 1498640093, "answer_id": 44797934, "question_id": 44797043, "link": "https://stackoverflow.com/questions/44797043/replace-every-nth-instance-of-character-in-string/44797934#44797934", "title": "Replace every nth instance of character in string", "body": "<p>So I figured out what I was doing wrong. I initially had the data as a <code>string</code>, but if I cast it to a <code>byte[]</code> then I can update it in place. </p>\n\n<p>This allowed me to use a simple <code>for</code> loop below to solve the issue without relying on any other metric other than nth character instance</p>\n\n<pre><code>for i := 0; i &lt; len(dat); i++ {\n    if dat[i] == ',' {\n        count += 1\n    }\n    if count%6 == 0 &amp;&amp; dat[i] == ',' {\n        dat[i] = '\\n'\n        count = 0\n    }\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5050584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/642e43e9082fce962f2e439d1dd6814a?s=128&d=identicon&r=PG&f=1", "display_name": "S2C", "link": "https://stackoverflow.com/users/5050584/s2c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 44797934, "answer_count": 3, "score": -1, "last_activity_date": 1498646900, "creation_date": 1498637575, "last_edit_date": 1498640243, "question_id": 44797043, "link": "https://stackoverflow.com/questions/44797043/replace-every-nth-instance-of-character-in-string", "title": "Replace every nth instance of character in string", "body": "<p>I'm a bit new to Go, but I'm trying to replace every nth instance of my string with a comma. So for example, a part of my data looks as follows:</p>\n\n<pre><code>\"2017-06-01T09:15:00+0530\",1634.05,1635.95,1632.25,1632.25,769,\"2017-06-01T09:16:00+0530\",1632.25,1634.9,1631.65,1633.5,506,\"2017-06-01T09:17:00+0530\",1633.5,1639.95,1633.5,1638.4,991,\n</code></pre>\n\n<p>I want to replace <code>every 6th comma</code> with a <code>'\\n'</code> so it looks like</p>\n\n<pre><code>\"2017-06-01T09:15:00+0530\",1634.05,1635.95,1632.25,1632.25,769\"\n\"2017-06-01T09:16:00+0530\",1632.25,1634.9,1631.65,1633.5,506\"\n\"2017-06-01T09:17:00+0530\",1633.5,1639.95,1633.5,1638.4,991\"\n</code></pre>\n\n<p>I've looked at the <code>regexp</code> package and that just seems to be a finder. The <code>strings</code> package does have a replace but I don't know how to use it to replace specific indices. I also don't know how to find specific indices without going through the entire string character by character. I was wondering if there is a regEx solution that is more elegant than me writing a helper function.\nStrings are immutable so I'm not able to edit them in place.</p>\n\n<p>EDIT: Cast the string into []bytes. This allows me to edit the string in place. Then the rest is a fairly simple for loop, where <code>dat</code> is the data.</p>\n"}, {"tags": ["arrays", "json", "go", "decode"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1498638288, "creation_date": 1498638288, "answer_id": 44797278, "question_id": 44796996, "link": "https://stackoverflow.com/questions/44796996/convert-json-single-element-arrays-to-strings/44797278#44797278", "title": "Convert json single element arrays to strings", "body": "<blockquote>\n  <p>I'd like to get an object in Go that doesn't include all the unnecessary arrays of with a single string. </p>\n</blockquote>\n\n<p>The hard way: Parse the JSON by hand (write our own parser).</p>\n\n<p>The sensible way: Unmarshal via package encoding/json into some Go type matching the JSON or into some generic <code>interface{}</code> and copy the pieces into a different, simpler Go type afterwards.</p>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 2291886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d94d277ece247295c9ca745b28c60067?s=128&d=identicon&r=PG", "display_name": "Gianfranco Reppucci", "link": "https://stackoverflow.com/users/2291886/gianfranco-reppucci"}, "is_accepted": false, "score": 1, "last_activity_date": 1498659237, "creation_date": 1498659237, "answer_id": 44805028, "question_id": 44796996, "link": "https://stackoverflow.com/questions/44796996/convert-json-single-element-arrays-to-strings/44805028#44805028", "title": "Convert json single element arrays to strings", "body": "<p>You can override the default behaviour of <code>json.Marshal</code> / <code>json.Unmarshal</code> methods for a struct, by defining its own <code>MarshalJSON</code> or <code>UnmarshalJSON</code> properly.</p>\n\n<p>Here there is an excerpt for the code of a simplified version of the struct you need to decode.</p>\n\n<pre><code>type Response struct {\n    Message string `json:\"message\"`\n}\n\n// UnmarshalJSON overrides the default behaviour for JSON unmarshal method.\nfunc (r *Response) UnmarshalJSON(data []byte) error {\n    auxResponse := &amp;struct {\n        Message []string `json:\"message\"`\n    }{}\n    if err := json.Unmarshal(data, &amp;auxResponse); err != nil {\n        return err\n    }\n\n    // Consider to add some checks on array length :)\n    r.Message = auxResponse.Message[0]\n\n    return nil\n}\n</code></pre>\n\n<p>You can access the full working example <a href=\"https://play.golang.org/p/3RllLV6-vv\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I suggest you to read this interesting <a href=\"http://choly.ca/post/go-json-marshalling/\" rel=\"nofollow noreferrer\">article about custom JSON encode/decode with golang</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": false, "score": 0, "last_activity_date": 1499109154, "creation_date": 1499109154, "answer_id": 44892529, "question_id": 44796996, "link": "https://stackoverflow.com/questions/44796996/convert-json-single-element-arrays-to-strings/44892529#44892529", "title": "Convert json single element arrays to strings", "body": "<p>Creating your own unmarshaller is probably best, but this is a quick way to simulate what you want to achieve.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\n// JSON ...\nvar JSON = `{ \n  \"response\": [\n    {\n      \"message\": [\n         \"hello world\"\n      ],\n      \"misc\": [\n        {\n          \"timestamp\": [\n             \"2017-06-28T05:52:39.347Z\"\n          ],\n          \"server\": [\n             \"server-0101\"\n          ]\n        }\n      ]\n    }\n  ]\n}\n`\n\ntype rawObject struct {\n    Response []struct {\n        Message []string      `json:\"message\"`\n        Misc    []interface{} `json:\"misc\"`\n    } `json:\"response\"`\n}\n\ntype clean struct {\n    Message string                 `json:\"message\"`\n    Misc    map[string]interface{} `json:\"misc\"`\n}\n\nfunc main() {\n    var o rawObject\n    var c clean\n    // init map\n    c.Misc = make(map[string]interface{})\n\n    // unmarshall the raw data\n    json.Unmarshal([]byte(JSON), &amp;o)\n\n    for _, res := range o.Response { // I assume there should only be one response, don't know why this is wrapped as an array\n        //  assume message is not really an array\n        c.Message = res.Message[0]\n        // convert []interface to map[string]interface\n        for _, m := range res.Misc {\n            for k, v := range m.(map[string]interface{}) {\n                c.Misc[k] = v\n            }\n        }\n    }\n    fmt.Printf(\"%+v\\n\", c)\n}\n</code></pre>\n\n<p>What i don't like about this answer is that it isn't very reusable..so a function should probably be made and more error checking (part of creating a custom unmarshaller). If this were used in heavy production it might run into some memory issues, as I have to create a raw object to create a <code>clean</code> object.. but as a one off script it does the job.  I my clean struct doesn't add response as a type because i find it to be redundant. </p>\n"}], "owner": {"reputation": 21, "user_id": 7966888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2752f751a3d198aec785f26c4642429?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/7966888/henry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1499109154, "creation_date": 1498637459, "last_edit_date": 1498640866, "question_id": 44796996, "link": "https://stackoverflow.com/questions/44796996/convert-json-single-element-arrays-to-strings", "title": "Convert json single element arrays to strings", "body": "<p>In Go I have to parse this json:</p>\n\n<pre><code>{ \n  \"response\": [\n    {\n      \"message\": [\n         \"hello world\"\n      ],\n      \"misc\": [\n        {\n          \"timestamp\": [\n             \"2017-06-28T05:52:39.347Z\"\n          ],\n          \"server\": [\n             \"server-0101\"\n          ]\n        }\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>I'd like to get an object in Go that doesn't include all the unnecessary arrays of with a single string. The source json will never have more than one string in each array.</p>\n\n<p>So the end result that I'd like to get would be this json:</p>\n\n<pre><code>{ \n  \"response\": {\n    \"message\": \"hello world\",\n    \"misc\": {\n      \"timestamp\": \"2017-06-28T05:52:39.347Z\",\n      \"server\": \"server-0101\"\n    }\n  }\n}\n</code></pre>\n\n<p>Or an equivalent object in Go. </p>\n\n<p>Right now I have to use <code>Response[0].Misc[0].Timestamp[0]</code> to access the data which seems weird.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4518, "user_id": 556730, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e78457dc78d1fc89c5968991f3c01a43?s=128&d=identicon&r=PG", "display_name": "arg20", "link": "https://stackoverflow.com/users/556730/arg20"}, "edited": false, "score": 0, "creation_date": 1549155145, "post_id": 44798418, "comment_id": 95802914, "body": "<code>defer</code> can change the returned values so you may want to do <code>err := tx.Commit()</code> so you return an error if commit fails"}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 2, "last_activity_date": 1498641529, "creation_date": 1498641529, "answer_id": 44798418, "question_id": 44796893, "link": "https://stackoverflow.com/questions/44796893/how-to-add-some-operations-on-transaction-rollback/44798418#44798418", "title": "How to add some operations on transaction rollback", "body": "<p>Here is pattern I use often when I need a transaction:</p>\n\n<pre><code>func Foo() (err error) {\n    var tx *sql.Tx\n    tx, err = db.Begin()\n    if err != nil {\n        return err\n    }\n    defer func() {\n        if err == nil {\n            tx.Commit()\n        } else {\n            tx.Rollback()\n        }\n    }()\n    // Do whatever you want here.\n}\n</code></pre>\n\n<p>The trick is that here, the deferred function will always run at the end. If your function returns with an error, you can get it and rollback (and take whatever other action you want to), and if the function returns normally, you can commit the transaction.</p>\n"}], "owner": {"reputation": 29, "user_id": 7297164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vSPLm.gif?s=128&g=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/7297164/rocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 44798418, "answer_count": 1, "score": -1, "last_activity_date": 1498644454, "creation_date": 1498637120, "last_edit_date": 1498644454, "question_id": 44796893, "link": "https://stackoverflow.com/questions/44796893/how-to-add-some-operations-on-transaction-rollback", "title": "How to add some operations on transaction rollback", "body": "<p>// update the CloseJira status into the database</p>\n\n<p>Problem Statement - Golang how and where to call autogeneratedjiraclose() function to run some operation if rollback trigger.</p>\n\n<pre><code>func CloseJira(qMonName string) {\ntx, err := dbCon.Begin()\nnotifier.CheckErr(err, \"CloseJira() -&gt; tx -&gt; dbCon.Begin()\", dbErrLog)\ndefer tx.Rollback()\n\nstmt, errDBPrepare := tx.Prepare(\"update TABLE1 set \nKey=NULL, StatusKey='Closed', Statustime_UTC=? where Name=?\") \n//Update db table record\nnotifier.CheckErr(errDBPrepare, \"updateCloseJira() -&gt; dbCon.Prepare()\", \ndbErrLog)\ndefer stmt.Close() // danger!\n\nres, errStmtExec := stmt.Exec(time.Now().UTC(), qMonName)\nnotifier.CheckErr(errStmtExec, \"CloseJira() -&gt; stmt.Exec()\", dbErrLog)\n\nerr = tx.Commit()\nnotifier.CheckErr(err, \"CloseJira() -&gt; err -&gt; tx.Commit()\", dbErrLog)\n\n_, errRowAffected := res.RowsAffected()\nnotifier.CheckErr(errRowAffected, \"CloseJira() -&gt; res.RowsAffected()\", \ndbErrLog)\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "onesignal"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 7255164, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-cE2wBWM4mOQ/AAAAAAAAAAI/AAAAAAAAAD0/zi0sUFSB6ug/photo.jpg?sz=128", "display_name": "farsana p b", "link": "https://stackoverflow.com/users/7255164/farsana-p-b"}, "edited": false, "score": 0, "creation_date": 1498643981, "post_id": 44796488, "comment_id": 76578628, "body": "Is there any way to make the package app engine compatible? The package is for sending push notifications using onesignal"}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "reply_to_user": {"reputation": 145, "user_id": 7255164, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-cE2wBWM4mOQ/AAAAAAAAAAI/AAAAAAAAAD0/zi0sUFSB6ug/photo.jpg?sz=128", "display_name": "farsana p b", "link": "https://stackoverflow.com/users/7255164/farsana-p-b"}, "edited": false, "score": 1, "creation_date": 1498644475, "post_id": 44796488, "comment_id": 76578975, "body": "@farsanapb urlfetch should be passed Context via: <code>c := appengine.NewContext(r)</code>  This <code>r</code> is request object. So adding context.Context for NewXXX seems to be good idea for me."}], "tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": false, "score": 1, "last_activity_date": 1498635946, "creation_date": 1498635946, "answer_id": 44796488, "question_id": 44796124, "link": "https://stackoverflow.com/questions/44796124/https-onesignal-com-api-v1-notifications-http-defaulttransport-and-http-defa/44796488#44796488", "title": "https://onesignal.com/api/v1//notifications: http.DefaultTransport and http.DefaultClient are not available in App Engine", "body": "<p>Use http on appengine, you have to use urlfetch.</p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/standard/go/urlfetch/reference\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/standard/go/urlfetch/reference</a></p>\n\n<p>i.e. the package you use doesn't support appengine.</p>\n"}, {"tags": [], "owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "is_accepted": false, "score": 1, "last_activity_date": 1498647230, "creation_date": 1498647230, "answer_id": 44800474, "question_id": 44796124, "link": "https://stackoverflow.com/questions/44796124/https-onesignal-com-api-v1-notifications-http-defaulttransport-and-http-defa/44800474#44800474", "title": "https://onesignal.com/api/v1//notifications: http.DefaultTransport and http.DefaultClient are not available in App Engine", "body": "<p>A similar issue has been addressed by <a href=\"https://robbycolvin.com/google-app-engine-http-default-transport/\" rel=\"nofollow noreferrer\" title=\"Robby Colvin in this blog\">Robby Colvin in this blog</a> </p>\n\n<p>It explains how to make a third party package run in such conditions. Hoping this will help.</p>\n"}], "owner": {"reputation": 145, "user_id": 7255164, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-cE2wBWM4mOQ/AAAAAAAAAAI/AAAAAAAAAD0/zi0sUFSB6ug/photo.jpg?sz=128", "display_name": "farsana p b", "link": "https://stackoverflow.com/users/7255164/farsana-p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498647230, "creation_date": 1498634808, "last_edit_date": 1498643828, "question_id": 44796124, "link": "https://stackoverflow.com/questions/44796124/https-onesignal-com-api-v1-notifications-http-defaulttransport-and-http-defa", "title": "https://onesignal.com/api/v1//notifications: http.DefaultTransport and http.DefaultClient are not available in App Engine", "body": "<p>When i tried to implement push notification in golang App Engine using onesignal enviorment.But iam getting error \"http.DefaultTransport and http.DefaultClient are not available in App Engine\".This is my code,</p>\n\n<pre><code>func (c *PushNotificationController) CreateNotification() {\n    client := onesignal.NewClient(nil)\n    client.AppKey = \"MyAppKey\"\n    client.UserKey = \"MyUserKey\"\n    notifID := CreateNotifications(client)\n    log.Println(notifID)\n}\n\nfunc CreateNotifications(client *onesignal.Client) string {\n    playerID := \"SamplePlayerId\" // valid\n    notificationReq := &amp;onesignal.NotificationRequest{\n        AppID:            \"MyAppKey\",\n        Contents:         map[string]string{\"en\": \"English message\"},\n        IsIOS:            true,\n        IncludePlayerIDs: []string{playerID},\n    }\n    if createRes, res, err := client.Notifications.Create(notificationReq){\n        if err != nil {\n            log.Fatal(err)\n        }\n        return createRes.ID\n    }\n    ...\n}\n</code></pre>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "reply_to_user": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 0, "creation_date": 1498633262, "post_id": 44795041, "comment_id": 76571697, "body": "@mattn SetOutput() on package level configures the exported std logger of logrus (c.f., <a href=\"https://github.com/sirupsen/logrus/blob/master/exported.go\" rel=\"nofollow noreferrer\">github.com/sirupsen/logrus/blob/master/exported.go</a>)"}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "reply_to_user": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "edited": false, "score": 0, "creation_date": 1498633520, "post_id": 44795041, "comment_id": 76571828, "body": "@fhe If talking new variable via New(), and modify with logrus.SetOutput() (i.e. std), it can be different behavior, I think. Or get &amp;Logger{}."}, {"owner": {"reputation": 1174, "user_id": 1438735, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/304d6cf1abce29ed9d38688f7975c690?s=128&d=identicon&r=PG", "display_name": "Ratatouille", "link": "https://stackoverflow.com/users/1438735/ratatouille"}, "reply_to_user": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 0, "creation_date": 1498634713, "post_id": 44795041, "comment_id": 76572564, "body": "@mattn Hope this help ."}], "answers": [{"tags": [], "owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "is_accepted": true, "score": 1, "last_activity_date": 1498636046, "creation_date": 1498636046, "answer_id": 44796528, "question_id": 44795041, "link": "https://stackoverflow.com/questions/44795041/unable-to-send-logrus-output-dev-null/44796528#44796528", "title": "unable to send logrus output /dev/null", "body": "<p>You're using two different <code>logrus.Logger</code> variables in your code. The first, which is called in <code>init()</code> is the global default Logger that gets exported from logrus. Later, in your custom initialization function <code>Init(logLevel int)</code>, you're creating a new Logger via <code>logrus.New()</code> which is from then on used for logging \u2014 but hasn't been configured to use a different output.</p>\n\n<p>I'd suggest to get rid of the init() function and do all the initialization in your <code>Init(logLevel int)</code> (please note the different API for setting the output).</p>\n\n<pre><code>func Init(logLevl int) {\n    log = logrus.New()\n    log.Formatter = &amp;logrus.TextFormatter{FullTimestamp: true}\n    switch logLevl {\n    case DEBUG:\n        log.Level = logrus.DebugLevel\n    case INFO:\n        log.Level = logrus.InfoLevel\n    case WARNING:\n        log.Level = logrus.WarnLevel\n    case ERROR:\n        log.Level = logrus.ErrorLevel\n    }\n\n    env := os.Getenv(\"ENV\")\n    if env != \"test\" {\n        return\n    }\n    log.Out = ioutil.Discard\n}\n</code></pre>\n"}], "owner": {"reputation": 1174, "user_id": 1438735, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/304d6cf1abce29ed9d38688f7975c690?s=128&d=identicon&r=PG", "display_name": "Ratatouille", "link": "https://stackoverflow.com/users/1438735/ratatouille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1572, "favorite_count": 0, "accepted_answer_id": 44796528, "answer_count": 1, "score": 0, "last_activity_date": 1498636046, "creation_date": 1498631074, "last_edit_date": 1498634634, "question_id": 44795041, "link": "https://stackoverflow.com/questions/44795041/unable-to-send-logrus-output-dev-null", "title": "unable to send logrus output /dev/null", "body": "<p>I'm using <a href=\"https://github.com/sirupsen/logrus\" rel=\"nofollow noreferrer\">Logrus</a> package for logging on my project. </p>\n\n<p>All is fine but for testing purpose I do not need the logrus output to be displayed.</p>\n\n<p>I looking at <code>logrus.SetOuput</code> for answer.</p>\n\n<p>So basically I want the log to be written to <code>/dev/null</code></p>\n\n<p>But for some reason I still see the logs on STDOUT </p>\n\n<pre><code>   // This code run right at the start\n   if env == \"test\" {\n        fmt.Println(\"Entering test mode ....\")\n        logrus.SetOutput(ioutil.Discard)\n        return\n    }\n</code></pre>\n\n<p>Here how my logger setup looks like</p>\n\n<pre><code>// logger.go\n\npackage logger\n\nimport(\n    \"os\"\n    \"io/ioutil\"\n    \"github.com/Sirupsen/logrus\"\n)\n\nvar log *logrus.Logger\n\nconst (\n    DEBUG   = 0\n    INFO    = 1\n    WARNING = 2\n    ERROR   = 3\n)\n\nfunc init() {\n    env := os.GetEnv(\"ENV\")\n    if env != \"test\" {\n        return\n    }\n    logrus.SetOutput(ioutil.Discard)\n}\n\n\nfunc Init(logLevl int) {\n    log = logrus.New()\n    log.Formatter = &amp;logrus.TextFormatter{FullTimestamp: true}\n    switch logLevl {\n    case DEBUG:\n        log.Level = logrus.DebugLevel\n    case INFO:\n        log.Level = logrus.InfoLevel\n    case WARNING:\n        log.Level = logrus.WarnLevel\n    case ERROR:\n        log.Level = logrus.ErrorLevel\n    }\n}\n\nfunc Get() *logrus.Logger {\n    return log\n}\n\nfunc I(args ...interface{}) {\n    log.Info(args)\n}\n\nfunc Df(format string, args ...interface{}) {\n    log.Debugf(format, args)\n}\n\nfunc D(args ...interface{}) {\n    log.Debug(args)\n}\n\nfunc W(args ...interface{}) {\n    log.Warn(args)\n}\n</code></pre>\n\n<p>And here how I use the <code>logger</code> package</p>\n\n<pre><code>import \"logger\"\n\nfunc init() {\n  logger.Init(0)\n}\n\nlogger.D(\"Dummy string\")\n</code></pre>\n"}, {"tags": ["debugging", "go"], "comments": [{"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 3, "creation_date": 1498630396, "post_id": 44793267, "comment_id": 76570205, "body": "Did you try gogland?"}, {"owner": {"reputation": 1887, "user_id": 6514989, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7cc849ff19574490024b6e12ef33c82b?s=128&d=identicon&r=PG&f=1", "display_name": "nail fei", "link": "https://stackoverflow.com/users/6514989/nail-fei"}, "reply_to_user": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 0, "creation_date": 1498887326, "post_id": 44793267, "comment_id": 76695557, "body": "@mattn yeah,gogland meet my requirements."}], "owner": {"reputation": 1887, "user_id": 6514989, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7cc849ff19574490024b6e12ef33c82b?s=128&d=identicon&r=PG&f=1", "display_name": "nail fei", "link": "https://stackoverflow.com/users/6514989/nail-fei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498911820, "creation_date": 1498621326, "last_edit_date": 1498911820, "question_id": 44793267, "link": "https://stackoverflow.com/questions/44793267/how-to-check-the-element-of-array-in-golang-when-debug", "title": "how to check the element of array in golang when debug", "body": "<p>my environment is ubuntu 16.04+eclipse neon3+goeclipse\n<br>\nthis is my source code:</p>\n\n<pre><code>package main\nimport  \"fmt\"\n\nfunc main() {\n    arr := []int{1, 2, 3}\n    fmt.Println(arr)\n}\n</code></pre>\n\n<p>it is very simple and I just want to know how to check the element of array <strong>arr</strong> when debug if I set breakPoint at <strong>println</strong>.when I check <strong>arr</strong> this is what I get <a href=\"https://i.stack.imgur.com/idvCG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/idvCG.png\" alt=\"enter image description here\"></a>.As we can see I cant get the element of <strong>arr</strong> and only can get the <em>address</em> of <strong>arr</strong>. And it has two errors: <br><code>Failed to execute MI command:-data-evaluate-expression (arr).len Error message from debugger back end:A syntax error in expression, near 'len'.</code><br> It seemed the error has relation with gdb but I dont know how to get rid of it.<br>\nIn java,as for similar code.</p>\n\n<pre><code>public class Demo {\n    public static void main(String[] args){\n        int[] arr = {1,2,3};\n        System.out.println(arr);\n    }\n}\n</code></pre>\n\n<p>it is easy to get the element of arr when debug.<a href=\"https://i.stack.imgur.com/5nOMQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5nOMQ.png\" alt=\"enter image description here\"></a> </p>\n\n<p>So I want to know how can I get the element of array in Go when debug and how can I get rid of the error when debug. Any advice will be appreciate.</p>\n"}, {"tags": ["go", "channel", "ticker"], "answers": [{"tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": true, "score": 2, "last_activity_date": 1498630310, "creation_date": 1498630310, "answer_id": 44794861, "question_id": 44793019, "link": "https://stackoverflow.com/questions/44793019/whats-wrong-with-the-golang-code-by-using-ticker/44794861#44794861", "title": "what&#39;s wrong with the golang code by using ticker", "body": "<p>As <a href=\"https://golang.org/pkg/time/#Ticker.Stop\" rel=\"nofollow noreferrer\">documentation</a> says, ticker.Stop doesn't close channel. So you must not expect break-loop. You can add new channel for quit.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    intChan := make(chan int, 2)\n    ticker := time.NewTicker(time.Second)\n    quit := make(chan bool)\n    go func() {\n    loop:\n        for {\n            select {\n            case &lt;-ticker.C:\n                select {\n                case intChan &lt;- 1:\n                case intChan &lt;- 2:\n                case intChan &lt;- 3:\n                }\n            case &lt;-quit:\n                break loop\n            }\n        }\n        /*defer */\n        fmt.Println(\"End. [sender]\")\n        close(intChan)\n    }()\n    var sum int\n    for e := range intChan {\n        fmt.Printf(\"Received: %v\\n\", e)\n        sum += e\n        if sum &gt; 10 {\n            fmt.Printf(\"Got: %v\\n\", sum)\n            quit &lt;- true\n            //break\n            //ticker.Stop()\n        }\n    }\n    fmt.Println(\"End. [receiver]\")\n    //time.Sleep(10)\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4310300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8741375e5924b5950b39aa43cdaf5a40?s=128&d=identicon&r=PG&f=1", "display_name": "wento", "link": "https://stackoverflow.com/users/4310300/wento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1207, "favorite_count": 0, "accepted_answer_id": 44794861, "answer_count": 1, "score": 0, "last_activity_date": 1498630310, "creation_date": 1498619529, "question_id": 44793019, "link": "https://stackoverflow.com/questions/44793019/whats-wrong-with-the-golang-code-by-using-ticker", "title": "what&#39;s wrong with the golang code by using ticker", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    intChan := make(chan int, 1)\n    ticker := time.NewTicker(time.Second)\n    go func() {\n        for _ = range ticker.C {\n            select {\n            case intChan &lt;- 1:\n            case intChan &lt;- 2:\n            case intChan &lt;- 3:\n            }\n        }\n        /*defer */\n        fmt.Println(\"End. [sender]\")\n    }()\n    var sum int\n    for e := range intChan {\n        fmt.Printf(\"Received: %v\\n\", e)\n        sum += e\n        if sum &gt; 10 {\n            fmt.Printf(\"Got: %v\\n\", sum)\n            break\n            //ticker.Stop()\n        }\n    }\n    fmt.Println(\"End. [receiver]\")\n    //time.Sleep(10)\n}\n</code></pre>\n\n<p>I'm new in golang. In this code, I want print \"End. [sender]\" once when the goroutine is over. \nI try to use ticker.stop()\uff0c or even time.sleep(), defer , but no effect.\nWhat's wrong with it, please give me some idea. thanks </p>\n"}, {"tags": ["go", "ibm-cloud", "blockchain"], "comments": [{"owner": {"reputation": 1805, "user_id": 5865712, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-Y5Rum91W6os/AAAAAAAAAAI/AAAAAAAAAGI/J3TK0_uwiHw/photo.jpg?sz=128", "display_name": "Chris Sharp", "link": "https://stackoverflow.com/users/5865712/chris-sharp"}, "edited": false, "score": 0, "creation_date": 1498870651, "post_id": 44792261, "comment_id": 76693515, "body": "what is this &#39;main&#39; (folder?) in the path after Loyalty? There also seems to be an Airline folder that holds &#39;Airline.go&#39; ? This is a different path structure than MyWallet, which you say is running."}, {"owner": {"reputation": 1791, "user_id": 3198917, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sKqa9.jpg?s=128&g=1", "display_name": "William &#39;Bill&#39; Wentworth", "link": "https://stackoverflow.com/users/3198917/william-bill-wentworth"}, "edited": false, "score": 0, "creation_date": 1499791311, "post_id": 44792261, "comment_id": 77054538, "body": "@jai - Please see the comment so that the community can help address your question."}, {"owner": {"reputation": 1, "user_id": 8223337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249b3f7899dfaacb9530b2774961ffa1?s=128&d=identicon&r=PG&f=1", "display_name": "jai", "link": "https://stackoverflow.com/users/8223337/jai"}, "edited": false, "score": 0, "creation_date": 1499886180, "post_id": 44792261, "comment_id": 77104604, "body": "Yes. The main folder has sub folder Airline, which contains the Airline.go"}, {"owner": {"reputation": 277, "user_id": 1235988, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f8af13ab43ad1c2742f784fd40c276fc?s=128&d=identicon&r=PG", "display_name": "swingmicro", "link": "https://stackoverflow.com/users/1235988/swingmicro"}, "edited": false, "score": 0, "creation_date": 1502817903, "post_id": 44792261, "comment_id": 78354682, "body": "is this issue still persists?"}], "owner": {"reputation": 1, "user_id": 8223337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249b3f7899dfaacb9530b2774961ffa1?s=128&d=identicon&r=PG&f=1", "display_name": "jai", "link": "https://stackoverflow.com/users/8223337/jai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498764847, "creation_date": 1498613025, "last_edit_date": 1592644375, "question_id": 44792261, "link": "https://stackoverflow.com/questions/44792261/chaincode-deployment-from-github-com-results-error-cannot-find-package", "title": "Chaincode deployment from github.com results error: cannot find package", "body": "<p>I am learning chaincode development on Bluemix.</p>\n<p>I have chain code under subfolders as below:</p>\n<pre><code>src-&gt;github.com-&gt;username-&gt;LoyaltyProgram\n                           MyWallet.go (Chaincode)\n                         -&gt;LoyaltyProgram-&gt;main-&gt;Airline\n                           Airline.go (Chaincode)\n</code></pre>\n<p>I have a package <code>LoyaltyPkg.go</code> that is under the following folder and is imported in <code>Mywallet.go</code> and <code>Airline.go</code> chain code.</p>\n<pre><code>src-&gt;github.com-&gt;username-&gt;LoyaltyProgram-&gt;LoyaltyPkgUtil\n</code></pre>\n<p>I am able to deploy <code>MyWallet.go</code> on to Bluemix using the deploy spec. However, when I try to deploy the <code>Airline.go</code> chain code, I am getting the following error:</p>\n<blockquote>\n<p>cannot find package &quot;github.com/jaibhavani/LoyaltyProgram/LoyaltyPkgUtil&quot; in any of:</p>\n<p>OUT -     /opt/go/src/github.com/jaibhavani/LoyaltyProgram/LoyaltyPkgUtil (from $GOROOT)</p>\n<p>OUT -     /opt/gopath/src/github.com/jaibhavani/LoyaltyProgram/LoyaltyPkgUtil (from $GOPATH)&quot;</p>\n</blockquote>\n<p>The package is available on github.com under the above folder. I don't know why I am unable to deploy the <code>Airline.go</code> chaincode to Bluemix.</p>\n<p>Please note, I am able to build <code>Airline.go</code> file locally with no errors.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 3, "creation_date": 1498608913, "post_id": 44791679, "comment_id": 76564347, "body": "Wjat drover do you use?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 3, "creation_date": 1498613445, "post_id": 44791679, "comment_id": 76565367, "body": "Since <code>sql.DB.Query()</code> will return an error if the connection is closed, pinging the database is redundant and introduces a race condition (the handle might close between the ping and the query). Handle the query error instead. If the error is because the connection is closed, reconnect and retry."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1498656243, "post_id": 44791679, "comment_id": 76587462, "body": "@Schwern there are valid uses for <code>Ping()</code>, such as a health check that doesn&#39;t intend to execute any query, just checks to verify that the DB is reachable. @Lee what database and driver are you using?"}, {"owner": {"reputation": 1986, "user_id": 4511560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/X7lzw.jpg?s=128&g=1", "display_name": "Tinkaal Gogoi", "link": "https://stackoverflow.com/users/4511560/tinkaal-gogoi"}, "edited": false, "score": 1, "creation_date": 1505287492, "post_id": 44791679, "comment_id": 79344803, "body": "A possible answer to this question can be found at <a href=\"https://stackoverflow.com/a/41619206/4511560\">stackoverflow.com/a/41619206/4511560</a>"}, {"owner": {"reputation": 777, "user_id": 1971586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f6027e3a9bb7094bd38fc08be15af55?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/1971586/brian"}, "edited": false, "score": 0, "creation_date": 1542341657, "post_id": 44791679, "comment_id": 93542464, "body": "I&#39;ve run into an issue where when the Db* is not set properly, Ping() fails to return at all, and hangs indefinitely.  This certainly seems wrong (Go 1.11)"}], "owner": {"reputation": 83, "user_id": 3429092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QBpeQ.jpg?s=128&g=1", "display_name": "Lee Trent", "link": "https://stackoverflow.com/users/3429092/lee-trent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1498607527, "creation_date": 1498607527, "question_id": 44791679, "link": "https://stackoverflow.com/questions/44791679/sql-db-ping-not-returning-error-when-db-is-down", "title": "sql.DB.Ping() not returning error when DB is down", "body": "<p>I intentionally stopped the database after successfully launching my Go program to test the behavior of sql.DB.Ping().</p>\n\n<p>sql.Open is being called in init()</p>\n\n<p>Much to surprise, sql.DB.Ping() did not return an error when my program called it before calling sql.DB.Query().</p>\n\n<p>Why am I doing this?\nJust trying to write robust code. Checking the integrity of the DB connection only at startup may not be sufficient for a long-lived production web application.</p>\n"}, {"tags": ["opengl", "go", "glsl", "shader", "gomobile"], "answers": [{"tags": [], "owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "is_accepted": true, "score": 2, "last_activity_date": 1498681293, "creation_date": 1498681293, "answer_id": 44811887, "question_id": 44790847, "link": "https://stackoverflow.com/questions/44790847/why-does-golang-gomobile-basic-example-sets-3-float-size-for-a-vec4-attribute/44811887#44811887", "title": "Why does golang gomobile basic example sets 3-float size for a vec4 attribute?", "body": "<p>Vertex attributes are conceptually always 4 component vectors. There is no requirement that the number of components you use in the shader and the one you set up for the attribute pointer have to match. If your array has more components than your shader consumes, the additional components are just ignored. If your array supplies less components, the attribute is filled to a vector of the form (0,0,0,1) (which makes sense for homogeneous position vectors as well as RGBA colors).</p>\n\n<p>In the usual case, you want <code>w=1</code> for every input position anyway, there is no need to store that in an array. But you usually need the full 4D form when applying the transformation matrices (or even when directly forwarding the value as <code>gl_Position</code>). So your shader could conceptually do</p>\n\n<pre><code>in vec3 pos;\ngl_Position=vec4(pos,1);\n</code></pre>\n\n<p>but that would be equivalent of just writing</p>\n\n<pre><code>in vec4 pos;\ngl_Position=pos;\n</code></pre>\n"}], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 1, "accepted_answer_id": 44811887, "answer_count": 1, "score": 0, "last_activity_date": 1498681293, "creation_date": 1498602055, "last_edit_date": 1498657014, "question_id": 44790847, "link": "https://stackoverflow.com/questions/44790847/why-does-golang-gomobile-basic-example-sets-3-float-size-for-a-vec4-attribute", "title": "Why does golang gomobile basic example sets 3-float size for a vec4 attribute?", "body": "<p>Golang gomobile basic example [1] uses VertexAttribPointer to set 3 x FLOATS per vertex.</p>\n\n<p>However the vertex shader attribute type is vec4. Shouldn't it be vec3?</p>\n\n<p>Why?</p>\n\n<p>Within render loop:</p>\n\n<pre><code>glctx.VertexAttribPointer(position, coordsPerVertex, gl.FLOAT, false, 0, 0)\n</code></pre>\n\n<p>Triangle data:</p>\n\n<pre><code>var triangleData = f32.Bytes(binary.LittleEndian,\n    0.0, 0.4, 0.0, // top left\n    0.0, 0.0, 0.0, // bottom left\n    0.4, 0.0, 0.0, // bottom right\n)\n</code></pre>\n\n<p>Constant declaration:</p>\n\n<pre><code>const (\n    coordsPerVertex = 3\n    vertexCount     = 3\n)\n</code></pre>\n\n<p>In vertex shader:</p>\n\n<pre><code>attribute vec4 position;\n</code></pre>\n\n<p>[1] gomobile basic example: <a href=\"https://github.com/golang/mobile/blob/master/example/basic/main.go\" rel=\"nofollow noreferrer\">https://github.com/golang/mobile/blob/master/example/basic/main.go</a></p>\n"}, {"tags": ["docker", "go", "network-programming"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1498600211, "post_id": 44790504, "comment_id": 76561838, "body": "Seeing the CRLF in that string makes me cringe..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1498600492, "post_id": 44790504, "comment_id": 76561961, "body": "@RayfenWindspear: why? That&#39;s the specification"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498600724, "post_id": 44790504, "comment_id": 76562047, "body": "@JohnT. Can you make sure your version of Go and the checkout of <code>golang.org&#47;x&#47;net&#47;ipv4</code> are up to date on your mac? The errors you&#39;re seeing in docker are accurate, the code is incorrect."}, {"owner": {"reputation": 1, "user_id": 8222849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mYnQg.jpg?s=128&g=1", "display_name": "John T.", "link": "https://stackoverflow.com/users/8222849/john-t"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498601173, "post_id": 44790504, "comment_id": 76562217, "body": "@JimB you are right! I ran <code>go get -u</code> and the code broke on my Mac. What is it about the code that&#39;s wrong?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8222849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mYnQg.jpg?s=128&g=1", "display_name": "John T.", "link": "https://stackoverflow.com/users/8222849/john-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1498608446, "last_edit_date": 1498608446, "creation_date": 1498602508, "answer_id": 44790925, "question_id": 44790504, "link": "https://stackoverflow.com/questions/44790504/golang-org-x-net-ipv4-working-on-mac-but-not-on-linux/44790925#44790925", "title": "&quot;golang.org/x/net/ipv4&quot; working on Mac, but not on Linux", "body": "<p>Thanks to @JimB's comment I realized my Mac had an old version of the <code>ipv4</code> package installed. After updating I was able to fix the code.</p>\n\n<p>Here's a complete working version:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"net\"\n  \"bufio\"\n  \"golang.org/x/net/ipv4\"\n)\n\nconst Host = \"google.com\"\n\nfunc main() {\n  var err error\n  conn, err := net.Dial(\"tcp4\", Host + \":80\")\n  if err != nil {\n    panic(err)\n  }\n  defer conn.Close()\n\n  if err = ipv4.NewConn(conn).SetTTL(5); err != nil {\n      panic(err)\n  }\n\n  fmt.Fprint(conn, fmt.Sprintf(\"GET / HTTP/1.1\\r\\nHost: %v\\r\\n\\r\\n\", Host))\n  firstLine, err := bufio.NewReader(conn).ReadString('\\n')\n  if err != nil {\n    panic(err)\n  }\n  fmt.Println(firstLine)\n}\n</code></pre>\n\n<p>Here is the output:</p>\n\n<pre><code>HTTP/1.1 301 Moved Permanently\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8222849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mYnQg.jpg?s=128&g=1", "display_name": "John T.", "link": "https://stackoverflow.com/users/8222849/john-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 44790925, "answer_count": 1, "score": 0, "last_activity_date": 1498608446, "creation_date": 1498600063, "question_id": 44790504, "link": "https://stackoverflow.com/questions/44790504/golang-org-x-net-ipv4-working-on-mac-but-not-on-linux", "title": "&quot;golang.org/x/net/ipv4&quot; working on Mac, but not on Linux", "body": "<p>I'm using \"golang.org/x/net/ipv4\" in order to use its SetTTL function. Unfortunately it does not seem to work on Linux, only on Mac, even though the documentation indicates Linux supports all the functions.</p>\n\n<p>Here's a minimal example of the problem, with a Dockerfile:</p>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"net\"\n  \"bufio\"\n  xnet \"golang.org/x/net/ipv4\"\n)\n\nconst Host = \"google.com\"\n\nfunc main() {\n  var err error\n  conn, err := net.Dial(\"tcp4\", Host + \":80\")\n  if err != nil {\n    panic(err)\n  }\n  defer conn.Close()\n  xconn := xnet.NewConn(conn)\n  err = xconn.SetTTL(5)\n  if err != nil {\n    panic(err)\n  }\n  defer xconn.Close()\n  fmt.Fprint(conn, \"GET / HTTP/1.1\\r\\nHOST: google.com\\r\\n\\r\\n\")\n  firstLine, err := bufio.NewReader(xconn).ReadString('\\n')\n  if err != nil {\n    panic(err)\n  }\n  fmt.Println(firstLine)\n}\n</code></pre>\n\n<p>Dockerfile:</p>\n\n<pre><code>FROM golang:1.8.1-alpine\n\nRUN apk --no-cache add git\nRUN go get golang.org/x/net/ipv4\nCOPY . /go/src/me.com/me/xnetproblem\nRUN go install me.com/me/xnetproblem\nCMD [\"/go/bin/xnetproblem\"]\n</code></pre>\n\n<p>I run this command:</p>\n\n<pre><code>docker build -t xnet .\n</code></pre>\n\n<p>I get this output:</p>\n\n<pre><code>john xnetproblem &gt; docker build -t xnet .\nSending build context to Docker daemon 90.62 kB\nStep 1/6 : FROM golang:1.8.1-alpine\n[snip]\nStep 5/6 : RUN go install me.com/me/xnetproblem\n ---&gt; Running in c3802fe61d63\n# me.com/me/xnetproblem\nsrc/me.com/me/xnetproblem/main.go:25: xconn.Close undefined (type *ipv4.Conn has no field or method Close)\nsrc/me.com/me/xnetproblem/main.go:28: cannot use xconn (type *ipv4.Conn) as type io.Reader in argument to bufio.NewReader:\n    *ipv4.Conn does not implement io.Reader (missing Read method)\nThe command '/bin/sh -c go install me.com/me/xnetproblem' returned a non-zero code: 2\n</code></pre>\n\n<p>Using <code>go install</code> natively, instead of Docker, the program works on Mac but not on Linux.</p>\n"}, {"tags": ["go", "unicode", "cyrillic"], "comments": [{"owner": {"reputation": 1226, "user_id": 6324080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUqTh.jpg?s=128&g=1", "display_name": "K. Kirsz", "link": "https://stackoverflow.com/users/6324080/k-kirsz"}, "edited": false, "score": 0, "creation_date": 1498595712, "post_id": 44789336, "comment_id": 76559565, "body": "Did you try just using the Unicode charts (i assume your input is unicode), like this for example <a href=\"http://sites.psu.edu/symbolcodes/languages/europe/cyrillic/cyrillicchart/\" rel=\"nofollow noreferrer\">link</a>? Just iterate over whatever values you are interested in."}], "answers": [{"comments": [{"owner": {"reputation": 6600, "user_id": 2210667, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/65e361318ee533712efd7929d6e9977c?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2210667/thomas"}, "edited": false, "score": 0, "creation_date": 1498596795, "post_id": 44789528, "comment_id": 76560146, "body": "thanks, some letters in the russian alphabet look like latin letters (like the o or A) so I thought I would have to do something more complicated"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 3, "creation_date": 1498598354, "post_id": 44789528, "comment_id": 76560947, "body": "Note that there are many Cyrillic characters outside of that range. There&#39;s more at U+00460 (that range alternates upper and lower), one at U+01D2B, and more at U+0A640. And more can be added. <a href=\"https://stackoverflow.com/a/44789675/14660\">Avoid hard coding ranges, use <code>unicode.Is(unicode.Cyrillic, r)</code> instead</a>. To distinguish between upper and lower case, use <code>unicode.IsUpper</code> and <code>unicode.IsLower</code> keeping in mind that there are some characters which are <i>both</i> and some which are <i>neither</i>."}], "tags": [], "owner": {"reputation": 1226, "user_id": 6324080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUqTh.jpg?s=128&g=1", "display_name": "K. Kirsz", "link": "https://stackoverflow.com/users/6324080/k-kirsz"}, "is_accepted": false, "score": 1, "last_activity_date": 1498596345, "creation_date": 1498596345, "answer_id": 44789528, "question_id": 44789336, "link": "https://stackoverflow.com/questions/44789336/check-if-a-character-is-russian/44789528#44789528", "title": "Check if a character is Russian", "body": "<p>I went on and did this example implementation for finding russian uppercase chars, based on <a href=\"http://sites.psu.edu/symbolcodes/languages/europe/cyrillic/cyrillicchart/\" rel=\"nofollow noreferrer\">this Unicode chart</a>:</p>\n\n<pre><code>func isRussianUpper(text string) bool {\n    for _, r := range []rune(text) {\n        if r &lt; '\\u0410' || r &gt; '\\u042F' {\n            return false\n        }\n    }\n    return true\n}\n</code></pre>\n\n<p>You can do any set of characters this way. Just modify the codes of characters you are interested in.</p>\n"}, {"comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 2, "creation_date": 1498598448, "post_id": 44789675, "comment_id": 76560995, "body": "This is the way to go. It catches the full range of Cyrillic characters including oddballs like \u1d2b U+01D2B, and the huge range at U+0A640 and U+00460."}], "tags": [], "owner": {"reputation": 6600, "user_id": 2210667, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/65e361318ee533712efd7929d6e9977c?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2210667/thomas"}, "is_accepted": true, "score": 13, "last_activity_date": 1498596864, "creation_date": 1498596864, "answer_id": 44789675, "question_id": 44789336, "link": "https://stackoverflow.com/questions/44789336/check-if-a-character-is-russian/44789675#44789675", "title": "Check if a character is Russian", "body": "<p>This seems to work</p>\n\n<pre><code>unicode.Is(unicode.Cyrillic, r) // r is a rune\n</code></pre>\n"}], "owner": {"reputation": 6600, "user_id": 2210667, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/65e361318ee533712efd7929d6e9977c?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2210667/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1970, "favorite_count": 0, "accepted_answer_id": 44789675, "answer_count": 2, "score": 5, "last_activity_date": 1498596864, "creation_date": 1498595442, "last_edit_date": 1498596493, "question_id": 44789336, "link": "https://stackoverflow.com/questions/44789336/check-if-a-character-is-russian", "title": "Check if a character is Russian", "body": "<p>I would like to know if a string contains Russian/Cyrillic characters.</p>\n\n<p>For latin characters, I do something like this (pseudocode):</p>\n\n<pre><code>text := \"test\"\nfor _, r := range []rune(text) {\n    if r &gt;= 'a' &amp;&amp; r &lt;= 'z' {\n        return True\n    }\n}\nreturn False\n</code></pre>\n\n<p>What is the corresponding way to do it for Russian/Cyrillic alphabet?</p>\n"}, {"tags": ["ssl", "go", "x509"], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1501252625, "creation_date": 1501252625, "answer_id": 45376216, "question_id": 44789059, "link": "https://stackoverflow.com/questions/44789059/golang-verify-cert-was-signed-using-private-key/45376216#45376216", "title": "Golang: verify cert was signed using private key", "body": "<p>The docs for openssl_x509_check_private_key don't actually say what the arguments are. I'm going to assume that they're either filenames for PEM encoded data, or PEM encoded data (strings) directly.</p>\n\n<p>In that case you can simply call <a href=\"https://golang.org/pkg/crypto/tls/#LoadX509KeyPair\" rel=\"nofollow noreferrer\">tls.LoadX509KeyPair</a> or tls.X509KeyPair, which will check that the certificate and key match.</p>\n\n<p>Check the source for tls.X509KeyPair if you are interested in the low-level API that performs the actual check (search for x509.ParseCertificate).</p>\n"}], "owner": {"reputation": 303, "user_id": 2145126, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1a2db0e8e0291689af39953087398cc9?s=128&d=identicon&r=PG", "display_name": "Nick Wiltshire", "link": "https://stackoverflow.com/users/2145126/nick-wiltshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1596, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1501252625, "creation_date": 1498594290, "question_id": 44789059, "link": "https://stackoverflow.com/questions/44789059/golang-verify-cert-was-signed-using-private-key", "title": "Golang: verify cert was signed using private key", "body": "<p>I'm porting an app from php to go and can't figure out how to verify a SSL cert was signed by our private key for a given server.</p>\n\n<p>In php its simply:\nopenssl_x509_check_private_key($cert, $pkey)</p>\n\n<p>I can verify start/end dates and validity for a host, but can't see a way to do this.</p>\n"}, {"tags": ["go", "synchronization", "coroutine"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498650897, "post_id": 44788548, "comment_id": 76583213, "body": "If you have a <i>new</i> question, <b>post a new question</b>, don&#39;t just edit your question. Your new solution will still deadlock if there are more root directories than workers. The only thread safe queue in Go is the channel, as far as I&#39;m aware, though you could write your own using slices and mutexes. Why do you care how many workers there are?"}], "answers": [{"comments": [{"owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "edited": false, "score": 0, "creation_date": 1498593053, "post_id": 44788634, "comment_id": 76558212, "body": "I have updated my code to use <code>sync.WaitGroup</code>. Unfortunately, the code still ends in a dead-lock."}, {"owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "edited": false, "score": 0, "creation_date": 1498593162, "post_id": 44788634, "comment_id": 76558260, "body": "I also added some more checks and the missing for loop inside the worker."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "edited": false, "score": 0, "creation_date": 1498593341, "post_id": 44788634, "comment_id": 76558347, "body": "In your results loop, you&#39;re waiting for <code>fileChan</code> to close, but you never close it (and can&#39;t, because it&#39;s shared among multiple goroutines, none of which knows when it&#39;s no longer needed). It will sit there waiting for more results forever. Since this happens before you close <code>pathChan</code>, the goroutines will also block waiting on that channel forever."}, {"owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "edited": false, "score": 0, "creation_date": 1498594345, "post_id": 44788634, "comment_id": 76558885, "body": "I see, thanks for the explanation.  How could I work around this issue?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "edited": false, "score": 0, "creation_date": 1498596680, "post_id": 44788634, "comment_id": 76560086, "body": "Updated answer with more info."}, {"owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "edited": false, "score": 0, "creation_date": 1498636433, "post_id": 44788634, "comment_id": 76573617, "body": "Thank you for your effort and the additional information. Unfortunately your solutions don&#39;t implement what I desire. There should always be <code>n</code> workers, which evenly work on walking the tree, one directory at a time. With your first solution, more than the desired <code>n</code> workers will be spawned. With your second solution, a single worker could hit a root-level directory which contains a huge amount of sub-directories and the worker will have to work through this entire tree on its own. It would be more efficient to use more workers for such structures."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "edited": false, "score": 0, "creation_date": 1498650575, "post_id": 44788634, "comment_id": 76582946, "body": "Why do you require a particular number of workers? Go will ensure the number of threads used, and the overhead of a goroutine is very low."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1498596461, "last_edit_date": 1498596461, "creation_date": 1498592745, "answer_id": 44788634, "question_id": 44788548, "link": "https://stackoverflow.com/questions/44788548/synchronize-workers-for-recursive-crawl/44788634#44788634", "title": "Synchronize workers for recursive crawl", "body": "<p>If you want to wait for an arbitrary number of workers to finish, the standard library includes <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\"><code>sync.WaitGroup</code></a> for exactly this purpose.</p>\n\n<p>There are other concurrency issues as well:</p>\n\n<ul>\n<li>You're using channel closure signalling, but you have multiple goroutines sending on the same channel. This is generally bad practice: since each routine can never know when the other routines are done with the channel, you can never correctly close the channel.</li>\n<li>Closing one channel waits on the other to be closed first, but it will never be closed, so it deadlocks.</li>\n<li>The only reason it doesn't deadlock immediately is your example happens to have more workers than directories under \"/\". Add two more directories under \"/\" and it deadlocks immediately.</li>\n</ul>\n\n<p>There are some solutions:</p>\n\n<ul>\n<li>Dump the worker pool and just spin a goroutine for every subdirectory, and let the scheduler worry about the rest: <a href=\"https://play.golang.org/p/ck2DkNFnyF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ck2DkNFnyF</a></li>\n<li>Use one worker per root-level directory, and have each worker process its directory recursively rather than queuing subdirectories it finds to a channel.</li>\n</ul>\n"}], "owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498636093, "creation_date": 1498592448, "last_edit_date": 1498636093, "question_id": 44788548, "link": "https://stackoverflow.com/questions/44788548/synchronize-workers-for-recursive-crawl", "title": "Synchronize workers for recursive crawl", "body": "<p>I would like to implement a \"crawler\" with <code>n</code> workers where each worker is able to add additional jobs. The program should stop when there are no jobs left and all workers have finished their work.</p>\n\n<p>I have the following code (you can play with it at <a href=\"https://play.golang.org/p/_j22p_OfYv\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_j22p_OfYv</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    pathChan := make(chan string)\n    fileChan := make(chan string)\n    workers := 3\n    var wg sync.WaitGroup\n\n    paths := map[string][]string{\n        \"/\":     {\"/test\", \"/foo\", \"a\", \"b\"},\n        \"/test\": {\"aa\", \"bb\", \"cc\"},\n        \"/foo\":  {\"/bar\", \"bbb\", \"ccc\"},\n        \"/bar\":  {\"aaaa\", \"bbbb\", \"cccc\"},\n    }\n\n    for i := 0; i &lt; workers; i++ {\n        wg.Add(1)\n        go func() {\n            for {\n                path, ok := &lt;-pathChan\n                if !ok {\n                    break\n                }\n\n                for _, f := range paths[path] {\n                    if f[0] == '/' {\n                        pathChan &lt;- f\n                    } else {\n                        fileChan &lt;- f\n                    }\n                }\n            }\n\n            wg.Done()\n        }()\n    }\n\n    pathChan &lt;- \"/\"\n\n    for {\n        filePath, ok := &lt;-fileChan\n        if !ok {\n            break\n        }\n\n        fmt.Println(filePath)\n    }\n\n    wg.Wait()\n    close(pathChan)\n}\n</code></pre>\n\n<p>Unfortunately, this ends in a dead-lock. Where exactly is the problem? Also, what is the best practice to write such functionality? Are channels the correct feature to use?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I have updated my code to use two wait groups, one for the jobs and one for the workers (see <a href=\"https://play.golang.org/p/bueUJzMhqj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/bueUJzMhqj</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    pathChan := make(chan string)\n    fileChan := make(chan string)\n    jobs := new(sync.WaitGroup)\n    workers := new(sync.WaitGroup)\n    nworkers := 2\n\n    paths := map[string][]string{\n        \"/\":     {\"/test\", \"/foo\", \"a\", \"b\"},\n        \"/test\": {\"aa\", \"bb\", \"cc\"},\n        \"/foo\":  {\"/bar\", \"bbb\", \"ccc\"},\n        \"/bar\":  {\"aaaa\", \"bbbb\", \"cccc\"},\n    }\n\n    for i := 0; i &lt; nworkers; i++ {\n        workers.Add(1)\n        go func() {\n            defer workers.Done()\n            for {\n                path, ok := &lt;-pathChan\n                if !ok {\n                    break\n                }\n\n                for _, f := range paths[path] {\n                    if f[0] == '/' {\n                        jobs.Add(1)\n                        pathChan &lt;- f\n                    } else {\n                        fileChan &lt;- f\n                    }\n                }\n\n                jobs.Done()\n            }\n\n        }()\n    }\n\n    jobs.Add(1)\n    pathChan &lt;- \"/\"\n\n    go func() {\n        jobs.Wait()\n        close(pathChan)\n        workers.Wait()\n        close(fileChan)\n    }()\n\n    for {\n        filePath, ok := &lt;-fileChan\n        if !ok {\n            break\n        }\n\n        fmt.Println(filePath)\n    }\n\n}\n</code></pre>\n\n<p>This indeed seems to work, but obviously a deadlock will still happen if <code>nworkers</code> is set to <code>1</code>, because the single worker will wait forever when adding something to the channel <code>pathChan</code>. To solve this issue, the channel buffer can be increased (e.g. <code>pathChan := make(chan string, 2)</code>), but this will only work as long as two buffer isn't completely full. Of course, the buffer size could be set to a large number, say 10000, but the code could still hit a deadlock. Additionally, this doesn't seem to be a clean solution to me.</p>\n\n<p>This is where I realized that it would be easier to use some sort of queue instead of a channel, where elements can be added and removed without blocking and where the size of the queue isn't fixed. Do such queues exist in the Go standard library?</p>\n"}, {"tags": ["go", "gofmt"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498588392, "post_id": 44787465, "comment_id": 76555651, "body": "<code>foo&#47;bar</code> is not a relative path - Go assumes that imports are rooted in <code>GOPATH&#47;src</code>. A relative path would be &quot;./foo/bar&quot;, but that&#39;s likely not what you want, and you would have to use a different import statement depending on where each file is in your hierarchy. You probably want to stick with normal imports."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1498588443, "post_id": 44787465, "comment_id": 76555675, "body": "You really do not want to use relative import paths. They are not supported in all cases by the Go tooling, and just meant for quick, on-off tests."}, {"owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498588641, "post_id": 44787465, "comment_id": 76555787, "body": "@Adrian My mistake ... I did mean <code>$GOPATH&#47;src&#47;foo&#47;bar</code> provided <code>$GOPATH</code> points to my project directory"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1498588821, "post_id": 44787465, "comment_id": 76555900, "body": "Then that&#39;s not a relative path - as far as Go is concerned, that&#39;s a normal import path."}], "answers": [{"comments": [{"owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "edited": false, "score": 0, "creation_date": 1498589022, "post_id": 44787609, "comment_id": 76556020, "body": "I tried this. Is there a way to wildcard and replace things ? FOO_common/server/src/&lt;*&gt; -&gt; &lt;*&gt; ?"}, {"owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "reply_to_user": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "edited": false, "score": 1, "creation_date": 1498589159, "post_id": 44787609, "comment_id": 76556114, "body": "edited my answer to answer that as well"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 2, "last_activity_date": 1498589139, "last_edit_date": 1498589139, "creation_date": 1498588850, "answer_id": 44787609, "question_id": 44787465, "link": "https://stackoverflow.com/questions/44787465/fixing-go-imports-to-relative-instead-of-absolute-path/44787609#44787609", "title": "Fixing go imports to relative instead of absolute path", "body": "<pre><code> gofmt -w -r '\"FOO_common/server/src/foo/bar\" -&gt; \"foo/bar\"' *.go\n</code></pre>\n\n<p>This will just look for the strings as they are, and replace them with the new string.</p>\n\n<p>If you need more advanced functionality such as wildcards, you might want to look at this other tool:</p>\n\n<p><a href=\"https://github.com/rogpeppe/govers\" rel=\"nofollow noreferrer\">https://github.com/rogpeppe/govers</a></p>\n"}], "owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "closed_date": 1498597722, "accepted_answer_id": 44787609, "answer_count": 1, "score": -2, "last_activity_date": 1498589139, "creation_date": 1498588293, "question_id": 44787465, "link": "https://stackoverflow.com/questions/44787465/fixing-go-imports-to-relative-instead-of-absolute-path", "closed_reason": "Not suitable for this site", "title": "Fixing go imports to relative instead of absolute path", "body": "<p>Is there a tool that could change the imports across my package from absolute path to a relative path. \nCurrently my import for <code>package bar</code> look like this :</p>\n\n<pre><code>import FOO_common/server/src/foo/bar\n</code></pre>\n\n<p>I want to convert this to </p>\n\n<pre><code>import foo/bar\n</code></pre>\n\n<p>Is there a tool like <code>gofmt</code> that could do this for me ? I know I can solve this with bash <code>sed</code>. However, am hoping for a <code>go tool</code> that might exist out there for the same.</p>\n"}, {"tags": ["go", "exec", "tor"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 32, "last_activity_date": 1498585475, "creation_date": 1498585475, "answer_id": 44786690, "question_id": 44786643, "link": "https://stackoverflow.com/questions/44786643/exec-executable-file-not-found-in-path/44786690#44786690", "title": "exec: executable file not found in $PATH", "body": "<p><a href=\"https://golang.org/pkg/os/exec/#Command\" rel=\"noreferrer\">Per the documentation</a>, the first argument passed to <code>exec.Command</code> is the name of an executable - that's it. It's not interpreted by the shell; it's the name of an executable you want to fork. If you need to pass in arguments, you can pass them in as <em>additional</em> parameters to <code>Command</code>, or you can pass them to the returned object afterward.</p>\n\n<p>In your case, you're using two commands and piping the stdout of one to the stdin of another. You could do this in pure Go (piping the Stdout reader of one to the Stdin writer of the other), or you could rely on the shell to do it. In the latter case, your executable would be <code>sh</code> or <code>bash</code>, and the arguments would be <code>[\"-c\", \"pidof tor | xargs kill -HUP\"]</code>. For example:</p>\n\n<pre><code>cmd := exec.Command(\"bash\", \"-c\", \"pidof tor | xargs kill -HUP\")\n</code></pre>\n"}], "owner": {"reputation": 2005, "user_id": 1871890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4359cdd9f14bbbe17c56f2fb2d2de25d?s=128&d=identicon&r=PG", "display_name": "Mathieu Nls", "link": "https://stackoverflow.com/users/1871890/mathieu-nls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24916, "favorite_count": 3, "accepted_answer_id": 44786690, "answer_count": 1, "score": 16, "last_activity_date": 1498585475, "creation_date": 1498585326, "question_id": 44786643, "link": "https://stackoverflow.com/questions/44786643/exec-executable-file-not-found-in-path", "title": "exec: executable file not found in $PATH", "body": "<p>I am trying to send the HUP signal to tor in Go.</p>\n\n<pre><code>    command := exec.Command(\"pidof tor | xargs kill -HUP\")\n    command.Dir = \"/bin\"\n\n    if cmdOut, err := command.CombinedOutput(); err != nil {\n        log.Panic(\"There was an error running HUP \", string(cmdOut), err)\n        panic(err)\n    }\n</code></pre>\n\n<p>I've tried numerous version of this (with/out args, with/out the Dir, ...) and it always comes back with the same error:</p>\n\n<pre><code>2017/06/27 13:36:31 There was an error running HUP exec: \"pidof tor | xargs kill -HUP\": executable file not found in $PATH\npanic: There was an error running HUP exec: \"pidof tor | xargs kill -HUP\": executable file not found in $PATH\n\ngoroutine 1 [running]:\npanic(0x639ac0, 0xc42000d260)\n        /usr/local/go/src/runtime/panic.go:500 +0x1a1\nlog.Panic(0xc420049f08, 0x3, 0x3)\n        /usr/local/go/src/log/log.go:320 +0xc9\nmain.main()\n</code></pre>\n\n<p>Running the command from the console works perfectly:</p>\n\n<pre><code>root@c8927c4a456e:/go/src/github.com/project# pidof tor | xargs kill -HUP\nJun 27 13:40:07.000 [notice] Received reload signal (hup). Reloading config and resetting internal state.\nJun 27 13:40:07.000 [notice] Read configuration file \"/etc/tor/torrc\".\n</code></pre>\n\n<p>Here's my $PATH</p>\n\n<pre><code>root@c8927c4a456e:/go/src/github.com/project# echo $PATH\n/go/bin:/usr/local/go/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n</code></pre>\n\n<p>I've done this previously with git command and it was working seamlessly. Am I missing something ?</p>\n"}, {"tags": ["go", "hash"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1498580474, "post_id": 44785181, "comment_id": 76551301, "body": "<code>rndbts = make([]byte, 16) &#47;&#47; Declared at package level</code> -- this looks like a death wish. You should have this variable be scoped as locally as possible. Sharing random bits across users like this will invalidate your security."}, {"owner": {"reputation": 90, "user_id": 7459528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7877f3118b300a2fd1bf45544ffbcc60?s=128&d=identicon&r=PG&f=1", "display_name": "fcFn", "link": "https://stackoverflow.com/users/7459528/fcfn"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1498581209, "post_id": 44785181, "comment_id": 76551768, "body": "Thanks for the tip! I get it, but right now there is only one user as it&#39;s a mock, not something I plan on using for any actual purpose."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1498605973, "post_id": 44785181, "comment_id": 76563674, "body": "The conversion to string and then back to bytes seems problematic to me."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1498606755, "post_id": 44785181, "comment_id": 76563865, "body": "From the Wikipedia page, it looks like there&#39;s a conversion to hex completely missing from your code?"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1498606894, "post_id": 44785181, "comment_id": 76563895, "body": "In general, I&#39;m having a hard time mapping your code to what&#39;s described on Wikipedia. You should be building up a string and then comparing it to what the client sent, but instead it looks like you&#39;re comparing against only part of the decoded response from the client? Maybe you can explain the algorithm you&#39;re following in English first and then comment the code to show how it implements that algorithm."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1498607093, "post_id": 44785181, "comment_id": 76563959, "body": "My understanding: 1) HMAC the challenge (with the password), 2) convert that hash to lowercase hex, 3) prepend username + &quot; &quot;, 4) base64 encode the whole thing, 5) compare that with what the client sent you. Your code doesn&#39;t seem to follow that algorithm."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1498607352, "post_id": 44785181, "comment_id": 76564013, "body": "Also, <code>fmt.Sprintf(&quot;334 %x\\n&quot;, b64b)</code> looks wrong to me. Shouldn&#39;t you be using <code>%s</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 90, "user_id": 7459528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7877f3118b300a2fd1bf45544ffbcc60?s=128&d=identicon&r=PG&f=1", "display_name": "fcFn", "link": "https://stackoverflow.com/users/7459528/fcfn"}, "edited": false, "score": 0, "creation_date": 1498640707, "post_id": 44791823, "comment_id": 76576328, "body": "The <code>%x</code> was indeed the culprit. I thought I had tried <code>%s</code> there, but looks like I had not. There was no error with the client&#39;s base64 decoding of the hex string from the server because a hex string can pass as valid base64 encoded string. Also I forgot to decode from hex string to byte slice when comparing hashes. Trying to cast a hex string to bytes like that is the wrong way to do it in that situation and using <code>hex</code> package is the right way. Thanks a lot!"}], "tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 1, "last_activity_date": 1498608751, "creation_date": 1498608751, "answer_id": 44791823, "question_id": 44785181, "link": "https://stackoverflow.com/questions/44785181/different-hashes-during-cram-md5-authentication/44791823#44791823", "title": "Different hashes during CRAM-MD5 authentication", "body": "<p>I hope this helps! Runnable version is at <a href=\"https://play.golang.org/p/-8shx_IcLV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/-8shx_IcLV</a>. Also note that you'll need to fix your <code>%x</code> (should be <code>%s</code>) so you're sending the right challenge down to the client. Right now I think you're trying to hex-encode your base64 string.</p>\n\n<p>Once you've fixed that, I believe this code should help you to construct the right response string on the server and compare it to what the client sent.</p>\n\n<pre><code>// Example values taken from http://susam.in/blog/auth-cram-md5/\n\nchallenge := []byte(\"&lt;17893.1320679123@tesseract.susam.in&gt;\")\nusername := []byte(\"alice\")\npassword := []byte(\"wonderland\")\nclientResponse := []byte(\"YWxpY2UgNjRiMmE0M2MxZjZlZDY4MDZhOTgwOTE0ZTIzZTc1ZjA=\")\n\n// hash the challenge with the user's password\nh := hmac.New(md5.New, password)\nh.Write(challenge)\nhash := h.Sum(nil)\n\n// encode the result in lowercase hexadecimal\nhexEncoded := hex.EncodeToString(hash)\n\n// prepend the username and a space\ntoEncode := []byte(string(username) + \" \" + hexEncoded)\n\n// base64-encode the whole thing\nb64Result := make([]byte, base64.StdEncoding.EncodedLen(len(toEncode)))\nbase64.StdEncoding.Encode(b64Result, toEncode)\n\n// check that this is equal to what the client sent\nif hmac.Equal(b64Result, clientResponse) {\n    fmt.Println(\"Matches!\")\n}\n</code></pre>\n"}], "owner": {"reputation": 90, "user_id": 7459528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7877f3118b300a2fd1bf45544ffbcc60?s=128&d=identicon&r=PG&f=1", "display_name": "fcFn", "link": "https://stackoverflow.com/users/7459528/fcfn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 44791823, "answer_count": 1, "score": 1, "last_activity_date": 1498608751, "creation_date": 1498580062, "question_id": 44785181, "link": "https://stackoverflow.com/questions/44785181/different-hashes-during-cram-md5-authentication", "title": "Different hashes during CRAM-MD5 authentication", "body": "<p>As an exercise, I'm trying to implement a mock SMTP server with CRAM-MD5 authentication in Go (without following RFC 2195, since it looks like it doesn't matter to the client what format the pre-hashed challenge is in; I also assume there is only one user \"bob\" with password \"pass\"). But I can't seem to get it right as the hash in response is always different from what I have on the server. I send the email using Go as such (running it as a separate package):</p>\n\n<pre><code>{...}\nsmtp.SendMail(\"localhost:25\", smtp.CRAMMD5Auth(\"bob\", \"pass\"),\n   \"bob@localhost\", []string{\"alice@localhost\"}, []byte(\"Hey Alice!\\n\"))\n{...}\n</code></pre>\n\n<p>Here's what I do when I get the authentication acknowledgement from the client:</p>\n\n<pre><code>{...}\ncase strings.Contains(ms, \"AUTH CRAM-MD5\"):\n    rndbts = make([]byte, 16) // Declared at package level\n    b64b := make([]byte, base64.StdEncoding.EncodedLen(16))\n    rand.Read(rndbts)\n    base64.StdEncoding.Encode(b64b, rndbts)\n    _, err = conn.Write([]byte(fmt.Sprintf(\"334 %x\\n\", b64b)))\n{...}\n</code></pre>\n\n<p>And this is what I do with the client's response: </p>\n\n<pre><code>{...}\n {\n    ms = strings.TrimRight(ms, \"\\r\\n\") // The response to the challenge\n    ds, _ := base64.StdEncoding.DecodeString(ms)\n    s := strings.Split(string(ds), \" \")\n    login := s[0] // I can get the login from the response.\n    h := hmac.New(md5.New, []byte(\"pass\"))\n    h.Write(rndbts)\n    c := make([]byte, 0, ourHash.Size()) // From smtp/auth.go, not sure why we need this.\n    validPass := hmac.Equal(h.Sum(c), []byte(s[1]))\n    {...}   \n}\n{...}\n</code></pre>\n\n<p>And the <code>validPass</code> is never <code>true</code>. I omitted error handling from the excerpts for brevity, but they're there in the actual code (though they're always <code>nil</code>). Why are the hashes different? I have looked at the source code for net/smtp, and it seems to me that I'm going in the right direction, but not quite.</p>\n"}, {"tags": ["json", "go", "time", "marshalling", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 1, "last_activity_date": 1498578885, "creation_date": 1498578885, "answer_id": 44784809, "question_id": 44784676, "link": "https://stackoverflow.com/questions/44784676/custom-time-marshall-unmarshall/44784809#44784809", "title": "Custom Time Marshall Unmarshall", "body": "<p>When doing this:</p>\n\n<pre><code>now := MysqlTime(time.Now())\n</code></pre>\n\n<p>It tries to convert a <code>Time</code> to your <code>MysqlTime</code> type (which throws an error).</p>\n\n<p>Did you mean to actually initialize the inner <code>Time</code> attribute, like so?</p>\n\n<pre><code>now := MysqlTime{time.Now()}\n</code></pre>\n"}], "owner": {"reputation": 11294, "user_id": 1239122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8cf239e31df87733c835e53851283548?s=128&d=identicon&r=PG", "display_name": "Gravy", "link": "https://stackoverflow.com/users/1239122/gravy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 44784809, "answer_count": 1, "score": 1, "last_activity_date": 1498582923, "creation_date": 1498578499, "last_edit_date": 1498582923, "question_id": 44784676, "link": "https://stackoverflow.com/questions/44784676/custom-time-marshall-unmarshall", "title": "Custom Time Marshall Unmarshall", "body": "<p>I have a <code>MysqlTime</code> struct with it's own marshall and unmarshall.</p>\n\n<pre><code>type MysqlTime struct {\n    time.Time\n}\n\nconst MYSQL_TIME_FORMAT = \"2006-01-02 15:04:05\"\n\nfunc (t *MysqlTime) UnmarshalJSON(b []byte) (err error) {\n    s := strings.Trim(string(b), `\\`)\n    if s == \"null\" {\n        t.Time = time.Time{}\n        return\n    }\n    t.Time, err = time.Parse(MYSQL_TIME_FORMAT, s)\n    return\n}\n\nfunc (t *MysqlTime) MarshalJSON() ([]byte, error) {\n    if t.Time.UnixNano() == nilTime {\n        return []byte(\"null\"), nil\n    }\n    return []byte(fmt.Sprintf(`\"%s\"`, t.Time.Format(MYSQL_TIME_FORMAT))), nil\n}\n\nvar nilTime = (time.Time{}).UnixNano()\n\nfunc (t *MysqlTime) IsSet() bool {\n    return t.UnixNano() != nilTime\n}\n</code></pre>\n\n<p>Now I wish to use it...</p>\n\n<pre><code>type Foo struct {\n    Time *MysqlTime\n}\n\nfunc main() {\n\n    now := MysqlTime(time.Now())\n\n    foo := Foo{}\n    foo.Time = &amp;now\n}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>cannot convert now (type time.Time) to type helpers.MysqlTime\ncannot take the address of helpers.MysqlTime(now)\n</code></pre>\n"}, {"tags": ["go", "ginkgo", "gomega"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1498573564, "post_id": 44782807, "comment_id": 76546397, "body": "The output says you have no tests to run, so there isn&#39;t anything to fail. Reasoning: <a href=\"https://stackoverflow.com/questions/38463609/why-does-go-test-run-notexist-pass/38466246#38466246\">Why does <code>go test -run NotExist</code> pass?</a> Tests should be in the same package being tested. Read package doc of <a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">testing</a>."}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 1, "creation_date": 1498574143, "post_id": 44782807, "comment_id": 76546857, "body": "Have you ran ginkgo bootstrap? Can you see the generated function similar to: <code>func TestEvents(t *testing.T)</code>?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1498574255, "post_id": 44782807, "comment_id": 76546955, "body": "put <code>button_not_shown_event_test.go</code> in the same dir as <code>button_not_shown_event.go</code> and give it the same package name."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1498574380, "post_id": 44782807, "comment_id": 76547062, "body": "and on top of that put an actual test in the file like dev.bmax explains."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498576890, "post_id": 44782807, "comment_id": 76548883, "body": "@Viren have you done the <code>ginkgo bootstrap</code> according to the Ginkgo docs?"}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498575280, "post_id": 44783161, "comment_id": 76547734, "body": "OP is using Ginkgo which deviates drastically from the normal go testing usage - and normal Go syntax and idioms in general, for that matter."}, {"owner": {"reputation": 916, "user_id": 584547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331f960409bf62ede301f920d4d798fd?s=128&d=identicon&r=PG", "display_name": "ahillman3", "link": "https://stackoverflow.com/users/584547/ahillman3"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498576141, "post_id": 44783161, "comment_id": 76548340, "body": "True. But, I went and looked at the Ginkgo docs, and they still use the testing package."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498576309, "post_id": 44783161, "comment_id": 76548468, "body": "They do use the testing package, but only in a stub generated by a tool they provide. You don&#39;t import the testing package into your ginkgo BDD test files."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498576365, "post_id": 44783161, "comment_id": 76548509, "body": "They also recommend <i>against</i> putting your tests in the same package with the code under test; they recommend black-box tests using <code>_test</code> packages, as the OP has done."}, {"owner": {"reputation": 916, "user_id": 584547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331f960409bf62ede301f920d4d798fd?s=128&d=identicon&r=PG", "display_name": "ahillman3", "link": "https://stackoverflow.com/users/584547/ahillman3"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498576613, "post_id": 44783161, "comment_id": 76548689, "body": "I&#39;ll edit my answer to remove the same package item. But, the OP is using the go test command, and according to what I&#39;m reading in the Ginkgo docs, it won&#39;t work without the testing package."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498576764, "post_id": 44783161, "comment_id": 76548796, "body": "It&#39;s right <a href=\"http://onsi.github.io/ginkgo/\" rel=\"nofollow noreferrer\">on their homepage</a>: you use <code>ginkgo bootstrap</code> to create the stub file, which imports <code>testing</code>. You write your actual specs in a separate file that does not."}, {"owner": {"reputation": 916, "user_id": 584547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331f960409bf62ede301f920d4d798fd?s=128&d=identicon&r=PG", "display_name": "ahillman3", "link": "https://stackoverflow.com/users/584547/ahillman3"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498577165, "post_id": 44783161, "comment_id": 76549090, "body": "Edited. I&#39;m going to go read the Ginkgo docs and see if there is anything there I can use in my tests."}], "tags": [], "owner": {"reputation": 916, "user_id": 584547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331f960409bf62ede301f920d4d798fd?s=128&d=identicon&r=PG", "display_name": "ahillman3", "link": "https://stackoverflow.com/users/584547/ahillman3"}, "is_accepted": true, "score": 0, "last_activity_date": 1498577051, "last_edit_date": 1498577051, "creation_date": 1498574398, "answer_id": 44783161, "question_id": 44782807, "link": "https://stackoverflow.com/questions/44782807/ginkgo-tests-not-being-found/44783161#44783161", "title": "Ginkgo tests not being found?", "body": "<p>You have a few issues.</p>\n\n<ol>\n<li>You aren't importing the <strong>testing</strong> package. This should be in the bootstrap file generated by Ginkgo.</li>\n<li>The bootstrap file should also include as a parameter the testing.T function. e.g. <code>(t *testing.T)</code>.</li>\n<li>It looks like you skipped a step or two in the Ginkgo process, resulting in a prior dependency not existing. e.g. the bootstrap/stub.</li>\n</ol>\n\n<p>Additionally, after a lot of comments by several people. You likely need to read the Ginkgo docs, to be sure you are following their process properly to get your tests setup properly.</p>\n"}, {"tags": [], "owner": {"reputation": 75598, "user_id": 226897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/02f02fcd0e0adfd6f5d5d1d594a8953c?s=128&d=identicon&r=PG", "display_name": "Abe Miessler", "link": "https://stackoverflow.com/users/226897/abe-miessler"}, "is_accepted": false, "score": 0, "last_activity_date": 1613760762, "creation_date": 1613760762, "answer_id": 66283438, "question_id": 44782807, "link": "https://stackoverflow.com/questions/44782807/ginkgo-tests-not-being-found/66283438#66283438", "title": "Ginkgo tests not being found?", "body": "<p>Go the the <code>events_test</code> directory and run:</p>\n<pre><code>ginkgo bootstrap\n</code></pre>\n<p>This is from Ginkgo's <a href=\"http://onsi.github.io/ginkgo/#getting-started-writing-your-first-test\" rel=\"nofollow noreferrer\">writing your first test docs</a>:</p>\n<blockquote>\n<p>To write Ginkgo tests for a package you must first bootstrap a Ginkgo\ntest suite. Say you have a package named books:</p>\n<pre><code>$ cd path/to/books\n$ ginkgo bootstrap\n</code></pre>\n</blockquote>\n<p>ahillman3's advice is valid for normal testing but if you are testing with Ginkgo it does not apply.</p>\n"}], "owner": {"reputation": 5744, "user_id": 461557, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/chqe8.jpg?s=128&g=1", "display_name": "Viren", "link": "https://stackoverflow.com/users/461557/viren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1242, "favorite_count": 0, "accepted_answer_id": 44783161, "answer_count": 2, "score": -1, "last_activity_date": 1613760839, "creation_date": 1498573443, "last_edit_date": 1613760839, "question_id": 44782807, "link": "https://stackoverflow.com/questions/44782807/ginkgo-tests-not-being-found", "title": "Ginkgo tests not being found?", "body": "<p>I do not understand why 'go' cannot find my Ginkgo test files</p>\n<p>Here's how my structure looks:</p>\n<pre><code>events\n\u251c\u2500\u2500 button_not_shown_event.go\n\u251c\u2500\u2500 events_test\n\u2502   \u2514\u2500\u2500 button_not_shown_event_test.go\n</code></pre>\n<p>And here how my <code>button_not_shown_event_test.go</code> look like</p>\n<pre><code>package events_test\n\nimport (\n    &quot;fmt&quot;\n    . &quot;github.com/onsi/ginkgo&quot;\n    . &quot;github.com/onsi/gomega&quot;\n)\n\nvar _ = Describe(&quot;ButtonNotShownEvent&quot;, func() {\n  BeforeEach(func() {\n    Expect(false).To(BeTrue())\n  })\n  \n  Context(&quot;ButtonNotShownEvent.GET()&quot;, func() {\n        It(&quot;should not return a JSONify string&quot;, func() {\n           Expect(true).To(BeFalse())\n        })\n    })\n})\n</code></pre>\n<p>Notice I have specifically written a test so that it will fail.</p>\n<p>But every time I run the Ginkgo test I get the following error</p>\n<pre><code>go test ./app/events/events_test/button_not_shown_event_test.go  -v\n\ntesting: warning: no tests to run\nPASS\nok      command-line-arguments  1.027s\n</code></pre>\n<p>So clearly there is something I'm missing over here.</p>\n<p>Any clue?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1498573301, "post_id": 44782680, "comment_id": 76546216, "body": "Please check <a href=\"https://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files/27946132#27946132\">Why do I need to use http.StripPrefix to access my static files?</a>; and <a href=\"https://stackoverflow.com/questions/28293452/404-page-not-found-go-rendering-css-file/28294524#28294524\">404 page not found - Go rendering css file</a>."}, {"owner": {"reputation": 13, "user_id": 8221002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a6176e3c9ce90a7660bd5b2fe0bc48?s=128&d=identicon&r=PG&f=1", "display_name": "Psaltus", "link": "https://stackoverflow.com/users/8221002/psaltus"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1498574559, "post_id": 44782680, "comment_id": 76547188, "body": "The go file is run from &quot;/&quot;, attempting to find assets from the /assets file. Neither of those responses have helped me in this situation, unfortunately."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8221002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a6176e3c9ce90a7660bd5b2fe0bc48?s=128&d=identicon&r=PG&f=1", "display_name": "Psaltus", "link": "https://stackoverflow.com/users/8221002/psaltus"}, "edited": false, "score": 0, "creation_date": 1498575396, "post_id": 44783465, "comment_id": 76547824, "body": "This works! Thank you so much. This issue has bugged me for weeks"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1498575161, "creation_date": 1498575161, "answer_id": 44783465, "question_id": 44782680, "link": "https://stackoverflow.com/questions/44782680/http-fileserver-is-sending-404-page-not-found/44783465#44783465", "title": "http.FileServer is sending &quot;404 page not found&quot;", "body": "<p>Does the directory <code>/assets</code> exist? Note that <code>/assets</code> is an absolute path, so it must be at the root of your filesystem. If you want something in the working directory where you're executing your program, you should use <code>./assets</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 788, "user_id": 4883754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aDyV2.png?s=128&g=1", "display_name": "kyakya", "link": "https://stackoverflow.com/users/4883754/kyakya"}, "is_accepted": false, "score": 1, "last_activity_date": 1579772159, "creation_date": 1579772159, "answer_id": 59875359, "question_id": 44782680, "link": "https://stackoverflow.com/questions/44782680/http-fileserver-is-sending-404-page-not-found/59875359#59875359", "title": "http.FileServer is sending &quot;404 page not found&quot;", "body": "<p>If you use relative path, you can check what your path is.</p>\n\n<pre><code>import (\n\"fmt\"\n\"os\"\n)\n\ndir, _ := os.Getwd()\nfmt.Println(\"current path :\" + dir)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8221002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a6176e3c9ce90a7660bd5b2fe0bc48?s=128&d=identicon&r=PG&f=1", "display_name": "Psaltus", "link": "https://stackoverflow.com/users/8221002/psaltus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2565, "favorite_count": 0, "accepted_answer_id": 44783465, "answer_count": 2, "score": 1, "last_activity_date": 1579772159, "creation_date": 1498573108, "last_edit_date": 1498575053, "question_id": 44782680, "link": "https://stackoverflow.com/questions/44782680/http-fileserver-is-sending-404-page-not-found", "title": "http.FileServer is sending &quot;404 page not found&quot;", "body": "<p>I'm trying to serve static files via http.FileServer, however it never sends back the directory I'm asking for. The code is snipped below:</p>\n\n<pre><code>func main() {\n\nfmt.Println(\"Serving Files\")\nhttp.HandleFunc(\"/\", homeFunc)\nhttp.HandleFunc(\"/search\", searchFunc)\nhttp.Handle(\"/tmp/\",\n    http.StripPrefix(\"/tmp/\", http.FileServer(http.Dir(\"/assets\"))))\n\nhttp.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>When visiting mywebsite.com/tmp/, text appears saying \"404 page not found.\" A little help in case I'm missing something would be greatly appreciated!</p>\n\n<p>Edit: Here's the file architecture:</p>\n\n<pre><code>main folder\n|\n|-/Assets\n|--(assets)\n|\n|-main.go\n</code></pre>\n"}, {"tags": ["datetime", "go"], "comments": [{"owner": {"reputation": 916, "user_id": 584547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331f960409bf62ede301f920d4d798fd?s=128&d=identicon&r=PG", "display_name": "ahillman3", "link": "https://stackoverflow.com/users/584547/ahillman3"}, "edited": false, "score": 0, "creation_date": 1498569781, "post_id": 44781327, "comment_id": 76543410, "body": "My first thought is the version of golang you are using. I ran the second version in Gogland-EAP, using go 1.8.3 on a Mac, and had no issues. Here&#39;s the output: 2017-12-30 19:00:00 -0500 EST  Process finished with exit code 0"}, {"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "reply_to_user": {"reputation": 916, "user_id": 584547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331f960409bf62ede301f920d4d798fd?s=128&d=identicon&r=PG", "display_name": "ahillman3", "link": "https://stackoverflow.com/users/584547/ahillman3"}, "edited": false, "score": 0, "creation_date": 1498570016, "post_id": 44781327, "comment_id": 76543584, "body": "I should have mentioned the version I use, it&#39;s go1.8.3 darwin/amd64. No IDE or anything, I just run it through terminal. Before this version I was using 1.7.2 and updated an hour ago just to see if update would resolve the issue for me."}, {"owner": {"reputation": 916, "user_id": 584547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331f960409bf62ede301f920d4d798fd?s=128&d=identicon&r=PG", "display_name": "ahillman3", "link": "https://stackoverflow.com/users/584547/ahillman3"}, "edited": false, "score": 0, "creation_date": 1498570217, "post_id": 44781327, "comment_id": 76543741, "body": "Identical to mine. I just did it command line. No problem. Output: go run main.go 2017-12-30 19:00:00 -0500 EST"}, {"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "reply_to_user": {"reputation": 916, "user_id": 584547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331f960409bf62ede301f920d4d798fd?s=128&d=identicon&r=PG", "display_name": "ahillman3", "link": "https://stackoverflow.com/users/584547/ahillman3"}, "edited": false, "score": 0, "creation_date": 1498570345, "post_id": 44781327, "comment_id": 76543858, "body": "I see, it apparently has something to do with my computer. Thanks!"}, {"owner": {"reputation": 916, "user_id": 584547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331f960409bf62ede301f920d4d798fd?s=128&d=identicon&r=PG", "display_name": "ahillman3", "link": "https://stackoverflow.com/users/584547/ahillman3"}, "edited": false, "score": 0, "creation_date": 1498570500, "post_id": 44781327, "comment_id": 76543952, "body": "No problem. May want to look at time zone issues as well."}, {"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "reply_to_user": {"reputation": 916, "user_id": 584547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331f960409bf62ede301f920d4d798fd?s=128&d=identicon&r=PG", "display_name": "ahillman3", "link": "https://stackoverflow.com/users/584547/ahillman3"}, "edited": false, "score": 0, "creation_date": 1498570787, "post_id": 44781327, "comment_id": 76544188, "body": "It&#39;s on my mind also. Thanks for the advice! I also realized that not working version&#39;s Unix function outputs <code>2017-12-31 03:00:00 +0300 +03</code> while the other one outputs <code>2015-12-31 02:00:00 +0200 EET</code>. Timezone extensions seems to be different as hell. Also the error message suggests that the problem is related with <code>+03</code> part."}], "answers": [{"tags": [], "owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "is_accepted": true, "score": 0, "last_activity_date": 1501340605, "creation_date": 1501340605, "answer_id": 45390729, "question_id": 44781327, "link": "https://stackoverflow.com/questions/44781327/golang-time-parsing-does-not-work-properly-while-working-on-playground/45390729#45390729", "title": "Golang time parsing does not work properly while working on playground", "body": "<p>The problem here is related with the abbreviation change for <code>Europe/Istanbul</code>. </p>\n\n<blockquote>\n  <p>Turkey switched from EET/EEST (+02/+03) to permanent +03,\n  effective 2016-09-07. (Thanks to Burak AYDIN.) Use \"+03\" rather\n  than an invented abbreviation for the new time.</p>\n</blockquote>\n\n<p>Time package currently does not accept +03 as EET/EEST and this problem occurs when using a datetime string that contains <code>+03</code> as timezone to parse in form of <code>2006-01-02 15:04:05.999999999 -0700 MST</code>.</p>\n"}], "owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 45390729, "answer_count": 1, "score": 0, "last_activity_date": 1501340605, "creation_date": 1498569451, "last_edit_date": 1498570043, "question_id": 44781327, "link": "https://stackoverflow.com/questions/44781327/golang-time-parsing-does-not-work-properly-while-working-on-playground", "title": "Golang time parsing does not work properly while working on playground", "body": "<p>I need to parse a datetime string that is generated by a pseudo random datetime generator that uses Unix() function. The generated datetime takes various date and time pairs between 2010 and 2017.\nHere's the problem, this version of the code works on both my computer and playground,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    a := time.Date(2016, 1, 0, 0, 0, 0, 0, time.UTC).Unix()\n    kk := time.Unix(a, 0)\n    t, err := time.Parse(\"2006-01-02 15:04:05.999999999 -0700 MST\", kk.String())\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(t)\n}\n</code></pre>\n\n<p>But the version below works on playground and panics on my computer,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    a := time.Date(2018, 1, 0, 0, 0, 0, 0, time.UTC).Unix()\n    kk := time.Unix(a, 0)\n    t, err := time.Parse(\"2006-01-02 15:04:05.999999999 -0700 MST\", kk.String())\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(t)\n}\n</code></pre>\n\n<p>Here's the error, </p>\n\n<pre><code>panic: parsing time \"2017-12-31 03:00:00 +0300 +03\" as \"2006-01-02 15:04:05.999999999 -0700 MST\": cannot parse \"+03\" as \"MST\"\n</code></pre>\n\n<p>The Go version I use is <code>go1.8.3 darwin/amd64</code>.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1498569609, "post_id": 44781271, "comment_id": 76543301, "body": "There is nothing built in, but of course you could write your own function using <code>os.File.Readdirnames</code>."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1498575040, "creation_date": 1498575040, "answer_id": 44783416, "question_id": 44781271, "link": "https://stackoverflow.com/questions/44781271/file-globbing-via-goroutine/44783416#44783416", "title": "File globbing via goroutine", "body": "<p>There is the built-in function <a href=\"https://golang.org/pkg/path/filepath/#Glob\" rel=\"nofollow noreferrer\"><code>filepath.Glob</code></a> which you can use to glob-search files in a directory, but of course it does the glob all at once synchronously. If you want results over a channel, you'll have to do something yourself, but it should not be terribly difficult combining <a href=\"https://golang.org/pkg/path/filepath/#Match\" rel=\"nofollow noreferrer\"><code>filepath.Match</code></a> which does glob handling, and <a href=\"https://golang.org/pkg/path/filepath/#Walk\" rel=\"nofollow noreferrer\"><code>filepath.Walk</code></a> which walks a directory structure (this is sort of what <code>filepath.Glob</code> does, <a href=\"https://golang.org/src/path/filepath/match.go?s=5609:5664#L224\" rel=\"nofollow noreferrer\">though it uses recursion rather than <code>Walk</code></a>).</p>\n"}], "owner": {"reputation": 11210, "user_id": 725937, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/32cba7500e49d4c491289f9e101c693b?s=128&d=identicon&r=PG", "display_name": "abergmeier", "link": "https://stackoverflow.com/users/725937/abergmeier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498575040, "creation_date": 1498569310, "question_id": 44781271, "link": "https://stackoverflow.com/questions/44781271/file-globbing-via-goroutine", "title": "File globbing via goroutine", "body": "<p>I have to glob a huge directory for certain files. This will take multiple seconds. Now using go, I of course would like to do the globbing in a way that I get back the result in a channel rather than having to wait for the whole glob to succeed.\nSadly I could not yet find something like that when searching. Is it available in go?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 230, "user_id": 4733663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HMQw5.png?s=128&g=1", "display_name": "Domi", "link": "https://stackoverflow.com/users/4733663/domi"}, "is_accepted": false, "score": -1, "last_activity_date": 1498567429, "creation_date": 1498567429, "answer_id": 44780628, "question_id": 44780323, "link": "https://stackoverflow.com/questions/44780323/pointer-receiver-vs-value-receiver-confusion/44780628#44780628", "title": "Pointer receiver vs value receiver confusion", "body": "<p>Try modifying <code>a.color</code> in your <code>Eat()</code> method and print <code>a.color</code> in <code>main()</code> after calling <code>a.Eat()</code>.</p>\n\n<pre><code>func (a *Apple) Eat() {\n    a.color = \"green\"\n    fmt.Printf(\"Eating %s apple\", a.color)\n}\n\nfunc main() {\n    a := Apple{\"red\"}\n    a.Eat()\n    fmt.Printf(\"Eating %s apple\", a.color)\n}\n</code></pre>\n\n<p>Then change the parameter of the <code>Eat()</code> method to a non-pointer. You will see it works as expected in both cases.</p>\n\n<p>To actually answer your question: The go compiler automatically determines whether you need the value or the pointer. This also works the other way around, if you have a pointer and call a value receiver method.</p>\n"}], "owner": {"reputation": 35680, "user_id": 1206051, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ZYa1h.png?s=128&g=1", "display_name": "treecoder", "link": "https://stackoverflow.com/users/1206051/treecoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 1, "closed_date": 1498567447, "answer_count": 1, "score": 3, "last_activity_date": 1498911884, "creation_date": 1498566535, "last_edit_date": 1498911884, "question_id": 44780323, "link": "https://stackoverflow.com/questions/44780323/pointer-receiver-vs-value-receiver-confusion", "closed_reason": "Duplicate", "title": "Pointer receiver vs value receiver confusion", "body": "<p>Been reading about it a lot, but the dichotomy between Pointer receiver and Value receiver still confuses me.</p>\n\n<p>Let's say we have this...</p>\n\n<pre><code>type Apple struct {\n    color string\n}\n\nfunc (a *Apple) Eat() {\n    fmt.Printf(\"Eating %s apple\\n\", a.color)\n}\n\nfunc main() {\n    a := Apple{\"red\"}\n\n    a.Eat()\n}\n</code></pre>\n\n<p>I would think that this is an error as we are trying to call a method with Pointer receiver via a value (<code>a</code> is value). But this compiles and runs and prints.</p>\n\n<p>My understanding is that if <code>a</code> was a pointer, then it would work for both value receiver and pointer receiver methods. But when <code>a</code> is a value, then it should only work with methods that have value receivers, as pointer receiver methods are NOT in the method set.</p>\n\n<p>But the above seems to contradict this. What's going on. (I am running Go <code>1.8.3</code>).</p>\n\n<p><a href=\"https://play.golang.org/p/eWkDHwIgOZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eWkDHwIgOZ</a></p>\n\n<h2>-- Update --</h2>\n\n<p>Turns out there are two things to be aware of.</p>\n\n<p>First is the actual rule, and second is the compiler aid we get in using these receivers.</p>\n\n<p>The rule is that a pointer receiver method can NOT be called via value -- it has to be a pointer. But when we call <code>a.Eat</code> (<code>a</code> being a value) -- the compiler does its helping hand and turns <code>a</code> into <code>&amp;a</code>. The rule is still enforced - albeit \"behind the scene\".</p>\n\n<p>The rule asserts itself in interfaces though.</p>\n\n<p>Let's say we have an interface...</p>\n\n<pre><code>type Edible interface {\n    Eat()\n}\n\n// Note that this is not a method, it is a simple function.\nfunc EatMore(x Edible) {\n    fmt.Println(\"Eating more...\")\n    x.Eat()\n}\n\nfunc main() {\n    a := Apple{\"red\"}\n\n    a.Eat()     // Okay -- because compiler is helping\n    EatMore(a)  // Wrong -- the rule asserts, compiler does not help\n}\n</code></pre>\n\n<p>Here, within the call to <code>EatMore(a)</code>, the compiler does not turn <code>a</code> into <code>&amp;a</code> -- and hence we get the error. The correct way would be, as expected, <code>EatMore(&amp;a)</code>.</p>\n\n<p>Hence, it is important to distinguish between the rule from the help Go compiler offers us in \"forgetting\" about this rule -- especially in method call expressions.</p>\n\n<p><a href=\"https://play.golang.org/p/p3-LUlbmCg\" rel=\"nofollow noreferrer\">https://play.golang.org/p/p3-LUlbmCg</a></p>\n"}, {"tags": ["html", "templates", "go", "struct", "nested"], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1498569524, "post_id": 44780779, "comment_id": 76543245, "body": "Option 2 could also be done without preloading all students, by using an AJAX call to fetch students for a school whenever a school is selected. This might be preferable if the total number of students is very large."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498570676, "post_id": 44780779, "comment_id": 76544086, "body": "@Adrian Yes, you&#39;re right. It would be certainly more efficient, but somewhat more complex to implement."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1498570760, "post_id": 44780779, "comment_id": 76544161, "body": "Definitely more complex. Just don&#39;t want OP to wind up on The Daily WTF because he&#39;s filling a JavaScript array of 10M students on every page load."}, {"owner": {"reputation": 53, "user_id": 7432828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2633ebd40ff42e58d61a58079708ff?s=128&d=identicon&r=PG&f=1", "display_name": "Molly1337", "link": "https://stackoverflow.com/users/7432828/molly1337"}, "edited": false, "score": 0, "creation_date": 1498675982, "post_id": 44780779, "comment_id": 76601249, "body": "Thanks, your answer was really helpful. Please check out my answer how I managed to solve this."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1498571726, "last_edit_date": 1498571726, "creation_date": 1498567887, "answer_id": 44780779, "question_id": 44780166, "link": "https://stackoverflow.com/questions/44780166/nested-ranges-in-golang-template/44780779#44780779", "title": "Nested ranges in Golang template", "body": "<p>The Go template is executed and rendered at <strong>server side</strong>, in / by your Go app.</p>\n\n<p><em>When</em> you select something in the School drop-down list, that happens at <strong>client side</strong>, in the browser.</p>\n\n<p>The browser cannot execute Go templates. So basically you have 2 options:</p>\n\n<p>1) When the user changes selection of the Schools drop-down, re-render the page. This involves sending a new HTTP request, you may provide the ID of the selected Scool in a URL parameter for example, and the Go template may render only the Students of the selected school in the 2nd drop-down list.</p>\n\n<p>2) You may implement this at client side, using JavaScript code. For this, you would need to include all students of all schools in the rendered HTML page, e.g. in JavaScript arrays, and use JavaScript code to change the content of the Students drop-down list.</p>\n\n<p>Read related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28751637/referencing-go-array-in-javascript/28753476#28753476\">Referencing Go array in Javascript</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/41197376/interactive-web-pages-in-go/41198615#41198615\">Interactive web pages in Go</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/37118281/dynamically-refresh-a-part-of-the-template-when-a-variable-is-updated-golang/37119014#37119014\">Dynamically refresh a part of the template when a variable is updated golang</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/41136000/creating-load-more-button-in-golang-with-templates/41138344#41138344\">Creating load more button in Golang with templates</a></p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 7432828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2633ebd40ff42e58d61a58079708ff?s=128&d=identicon&r=PG&f=1", "display_name": "Molly1337", "link": "https://stackoverflow.com/users/7432828/molly1337"}, "is_accepted": false, "score": 2, "last_activity_date": 1498676204, "last_edit_date": 1498676204, "creation_date": 1498675789, "answer_id": 44810374, "question_id": 44780166, "link": "https://stackoverflow.com/questions/44780166/nested-ranges-in-golang-template/44810374#44810374", "title": "Nested ranges in Golang template", "body": "<p>I have solved this using Javascript on client side. </p>\n\n<pre><code>&lt;script src=\"//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\" &gt;\n    $(document).ready(function() {\n        var school = {};\n        var schoolsArray = [];\n        {{range .Schools}}\n            school.ID = {{.ID}};\n            school.Name = {{.Name}};\n            school.Students = {{.Students}};\n            schoolsArray.push(school);\n        {{end}}\n\n        $(\"#school\").change(function() {\n            var parent = $(this).val();\n            Object.keys(schoolsArray).forEach(function (key) {\n                if (schoolsArray[key]['ID'] === parent) {\n                    var students = schoolsArray[key]['Students'];\n                    listStudents(students);\n                }\n            });\n        });\n        function listStudents(students) {\n            Object.keys(students).forEach(function (key) {\n                $('#student').append($('&lt;option&gt;', {\n                    value: students[key]['ID'],\n                    text : students[key]['Name']\n                }));\n            });\n        } &lt;/script&gt;\n</code></pre>\n\n<p>And this is my HTML code: </p>\n\n<pre><code>&lt;div&gt;\n  &lt;select name=\"school\" id=\"school\"&gt;\n      {{range .Schools}}\n          &lt;option value=\"{{.ID}}\"&gt;{{.Name}}&lt;/option&gt;\n      {{end}}\n  &lt;/select&gt;\n&lt;/div&gt;   &lt;div&gt;\n  &lt;select name=\"student\" id=\"student\"&gt;\n       &lt;/select&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Hope this will be helpful for someone else as well. Also, any suggestions for improving this code is welcome.</p>\n"}], "owner": {"reputation": 53, "user_id": 7432828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2633ebd40ff42e58d61a58079708ff?s=128&d=identicon&r=PG&f=1", "display_name": "Molly1337", "link": "https://stackoverflow.com/users/7432828/molly1337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1473, "favorite_count": 1, "accepted_answer_id": 44780779, "answer_count": 2, "score": 0, "last_activity_date": 1498676204, "creation_date": 1498566024, "question_id": 44780166, "link": "https://stackoverflow.com/questions/44780166/nested-ranges-in-golang-template", "title": "Nested ranges in Golang template", "body": "<p>I am pretty much new with this, so I need a little bit of help. </p>\n\n<p>I have two structs like this: </p>\n\n<pre><code>type School struct {\n    ID          string\n    Name        string\n    Students    []Student\n}\n\ntype Student struct {\n    ID          string\n    Name        string\n}\n</code></pre>\n\n<p>What I need to do is when I select one School object from first select element, that second select element displays only Students from selected School. Array of object School displays all data correctly. </p>\n\n<blockquote>\n<pre><code>&lt;div&gt;\n  &lt;select name=\"school\"&gt;\n      {{range .Schools}}\n          &lt;option value=\"{{.ID}}\"&gt;{{.Name}}&lt;/option&gt;\n      {{end}}\n  &lt;/select&gt;\n&lt;/div&gt;   &lt;div&gt;\n  &lt;select name=\"student\"&gt;\n  {{range .Students}}\n          &lt;option value=\"{{.ID}\"&gt; {{.Name}}&lt;/option&gt;\n       &lt;/select&gt;\n  {{end}}  &lt;/div&gt;\n</code></pre>\n</blockquote>\n\n<p>I need to range in second select something like selectedSchoolObject.Students. </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["json", "go", "struct", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "edited": false, "score": 1, "creation_date": 1498563821, "post_id": 44779409, "comment_id": 76539249, "body": "Are you saying I cannot extract the concrete type of an interface (as encoding/json can&#39;t do it either)?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "edited": false, "score": 0, "creation_date": 1498564209, "post_id": 44779409, "comment_id": 76539504, "body": "@Buzzy Yes, you can. But you passed <code>*interface{}</code>. See edited answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1498564959, "last_edit_date": 1592644375, "creation_date": 1498563703, "answer_id": 44779409, "question_id": 44779319, "link": "https://stackoverflow.com/questions/44779319/how-to-tell-json-unmarshal-to-use-struct-instead-of-interface/44779409#44779409", "title": "How to tell json.Unmarshal to use struct instead of interface", "body": "<p>The <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a> package can't magically guess what type you want the result unmarshaled into, unless you tell it to.</p>\n<p>One way of telling what to unmarsal into is to pass value of that type to the <code>json.Unmarshal()</code> function.</p>\n<p>And unfortunately there is no other way. If you pass a value of <code>interface{}</code> type, the <code>json</code> package implementation is free to choose a type of its choice, and it will choose <code>map[string]interface{}</code> for JSON objects, and <code>[]interface{}</code> for JSON arrays. This is documented at <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal()</code></a>:</p>\n<blockquote>\n<p>To unmarshal JSON into an interface value, Unmarshal stores one of these in the interface value:</p>\n<pre><code>bool, for JSON booleans\nfloat64, for JSON numbers\nstring, for JSON strings\n[]interface{}, for JSON arrays\nmap[string]interface{}, for JSON objects\nnil for JSON null\n</code></pre>\n</blockquote>\n<p>If you know the type beforehand, create a value of that type, and pass that for unmarshaling. Whether your store this in an <code>interface{}</code> variable beforehand does not matter; if the passed value is suitable for unmarshaling, it will be used. Note that the passed value will be wrapped in an <code>interface{}</code> if not already of that type, as that is the parameter type of <code>json.Unmarshal()</code>.</p>\n<p>The problem why your code fails is because you pass a value of type <code>*interface{}</code> which wraps a non-pointer <code>Foo</code> value. Since the <code>json</code> package can't use this, it creates a new value of its choice (a map).</p>\n<p>Instead you should wrap a <code>*Foo</code> value in an <code>interface{}</code>, and pass that:</p>\n<pre><code>func getFoo() interface{} {\n    return &amp;Foo{&quot;bar&quot;}\n}\n\nfunc main() {\n    fooInterface := getFoo()\n\n    myJSON := `{&quot;bar&quot;:&quot;This is the new value of bar&quot;}`\n    jsonBytes := []byte(myJSON)\n\n    err := json.Unmarshal(jsonBytes, fooInterface)\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Printf(&quot;%T %+v&quot;, fooInterface, fooInterface)\n}\n</code></pre>\n<p>This results in (try it on the <a href=\"https://play.golang.org/p/Ys4AesTgAA\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n<pre><code>*main.Foo &amp;{Bar:This is the new value of bar}\n</code></pre>\n"}], "owner": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5083, "favorite_count": 1, "accepted_answer_id": 44779409, "answer_count": 1, "score": 10, "last_activity_date": 1498564959, "creation_date": 1498563428, "last_edit_date": 1498564894, "question_id": 44779319, "link": "https://stackoverflow.com/questions/44779319/how-to-tell-json-unmarshal-to-use-struct-instead-of-interface", "title": "How to tell json.Unmarshal to use struct instead of interface", "body": "<p>I want to write a function that receives <strong>several</strong> types of structs and unmarshals them from JSON. To this end, I have another set of functions with a pre-defined signature that return the struct instances but since each function returns a different type of struct the function signature has <code>interface{}</code> as the return type.</p>\n\n<p>When I send json.Unmarshal a concrete struct it works as I expected but when I send the same struct as <code>interface{}</code> it converts it to a map.</p>\n\n<p>Here is a simplified example code that depicts the problem:</p>\n\n<pre><code>package main\n\nimport (\n\"encoding/json\"\n    \"fmt\"\n)\n\ntype Foo struct {\n    Bar string `json:\"bar\"`\n}  \n\nfunc getFoo() interface{} {\n    return Foo{\"bar\"}\n}\n\nfunc main() {\n\n    fooInterface := getFoo() \n    fooStruct := Foo{\"bar\"}\n    fmt.Println(fooInterface) //{bar}\n    fmt.Println(fooStruct)    //{bar}\n\n    myJSON := `{\"bar\":\"This is the new value of bar\"}`\n    jsonBytes := []byte(myJSON)\n\n    err := json.Unmarshal(jsonBytes, &amp;fooInterface )\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(fooInterface) //map[bar:This is the new value of bar]\n\n    err = json.Unmarshal(jsonBytes, &amp;fooStruct)\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(fooStruct) //{This is the new value of bar}\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/tOO7Ki_i4c\" rel=\"noreferrer\">https://play.golang.org/p/tOO7Ki_i4c</a></p>\n\n<p>I expected json.Unmarshal to use the concrete struct behind the interface for unmarshaling but it doesn't and just assigns the map of values to the passed interface.</p>\n\n<p>Why doesn't it use the concrete struct and is there a way to tell it to use the concrete struct type without explicit casting (I don't know the explicit type at design time)?</p>\n"}, {"tags": ["go", "travis-ci"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1498555015, "post_id": 44775337, "comment_id": 76533380, "body": "Just stick to <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 6659472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jnXWL.jpg?s=128&g=1", "display_name": "aQua", "link": "https://stackoverflow.com/users/6659472/aqua"}, "edited": false, "score": 1, "creation_date": 1498557448, "post_id": 44776577, "comment_id": 76535122, "body": "Yes, After move $GOPATH/src/demoGolangProjectWithCI to $GOPATH/src/github.com/aQuaYi/demoGolangProjectWithCI. I fix it, thank you very much."}], "tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": false, "score": 2, "last_activity_date": 1498555325, "creation_date": 1498555325, "answer_id": 44776577, "question_id": 44775337, "link": "https://stackoverflow.com/questions/44775337/import-path-does-not-begin-with-hostname/44776577#44776577", "title": "(import path does not begin with hostname)", "body": "<p><code>demoGolangProjectWithCI</code> is not resolved from <code>subModel</code> because import <code>\"demoGolangProjectWithCI\"</code> mean absolute path. You can write relative path like <code>./demoGolangProjectWithCI</code>. But, in generally, you've better to write full-github-paths as <code>github.com/aQuaYi/demoGolangProject</code> since your package may be used by other one's project.</p>\n"}], "owner": {"reputation": 429, "user_id": 6659472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jnXWL.jpg?s=128&g=1", "display_name": "aQua", "link": "https://stackoverflow.com/users/6659472/aqua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6659, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498555325, "creation_date": 1498551414, "last_edit_date": 1498552342, "question_id": 44775337, "link": "https://stackoverflow.com/questions/44775337/import-path-does-not-begin-with-hostname", "title": "(import path does not begin with hostname)", "body": "<p>My demo golang project is <a href=\"https://github.com/aQuaYi/demoGolangProjectWithCI\" rel=\"nofollow noreferrer\">https://github.com/aQuaYi/demoGolangProjectWithCI</a></p>\n\n<p>demoGolangProjectWithCI/subModel/subModelAdd.go is</p>\n\n<pre><code>package subModel\n\nimport (\n    \"demoGolangProjectWithCI\"\n)\n\n//Add returns sum of a and b\nfunc Add(a, b int) int {\n    return demoGolangProjectWithCI.Add(a, b)\n}\n</code></pre>\n\n<p>and my .travis.yml is </p>\n\n<pre><code>language: go\n\ngo:\n  - 1.8.3\n\nscript: go test ./...\n</code></pre>\n\n<p>but travis said me \"package demoGolangProjectWithCI: unrecognized import path \"demoGolangProjectWithCI\" (import path does not begin with hostname)\"</p>\n\n<p>detail is <a href=\"https://travis-ci.org/aQuaYi/demoGolangProjectWithCI/builds/247416861\" rel=\"nofollow noreferrer\">https://travis-ci.org/aQuaYi/demoGolangProjectWithCI/builds/247416861</a></p>\n\n<p>How Could I fix this?</p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["go", "random", "cryptography"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8214729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230164292123b448c09405dff63ad0f0?s=128&d=identicon&r=PG&f=1", "display_name": "dkgeorge", "link": "https://stackoverflow.com/users/8214729/dkgeorge"}, "edited": false, "score": 0, "creation_date": 1498554851, "post_id": 44774651, "comment_id": 76533275, "body": "Perfect! Thank you. That was exactly the impression I had. The code actually works then. Perhaps the best approach to get the random length effect is randomizing also the length itself as it has less &#39;units&#39;?"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "reply_to_user": {"reputation": 13, "user_id": 8214729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230164292123b448c09405dff63ad0f0?s=128&d=identicon&r=PG&f=1", "display_name": "dkgeorge", "link": "https://stackoverflow.com/users/8214729/dkgeorge"}, "edited": false, "score": 0, "creation_date": 1498584015, "post_id": 44774651, "comment_id": 76553343, "body": "I suppose, but I&#39;m not sure what you&#39;re trying to do."}, {"owner": {"reputation": 13, "user_id": 8214729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230164292123b448c09405dff63ad0f0?s=128&d=identicon&r=PG&f=1", "display_name": "dkgeorge", "link": "https://stackoverflow.com/users/8214729/dkgeorge"}, "edited": false, "score": 0, "creation_date": 1498778802, "post_id": 44774651, "comment_id": 76653430, "body": "I was thinking of an easy way of getting results for lower numbers (pages) a little more often but this goes against the purpose which is getting real randoms with variable lengths, so it&#39;s good enough :). Thank you"}], "tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 2, "last_activity_date": 1498549533, "last_edit_date": 1498549533, "creation_date": 1498549001, "answer_id": 44774651, "question_id": 44774514, "link": "https://stackoverflow.com/questions/44774514/how-to-generate-a-variable-length-random-number-in-go/44774651#44774651", "title": "How to generate a variable length random number in Go", "body": "<p>If I understand correctly, the issue you're having is that the random number appears to always have the same number of digits as the maximum allowed value, right? When I run the code, this is not the case. Here's an output I just observed:</p>\n\n<pre><code>3859736307910539847452366166956263595094585475969163479420172104717272049811\n65719900872761032562423535702578352960653752260368991759410130265294153783\n</code></pre>\n\n<p>In the playground, I believe the random seed and clock time are fixed, so you'll see the same result repeatedly. But running locally, I see the expected variation in the length of the output.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>You may wonder why you can run this code a bunch of times and observe that the length of the random number is very often close to the length of the maximum value.</p>\n\n<p>A little math explains this. Let's imagine we're picking a number between 0 and 999. How many numbers in that range have:</p>\n\n<ol>\n<li>3 digits? 900 (100-999)</li>\n<li>2 digits? 90 (10-99)</li>\n<li>1 digit? 10 (0-9)</li>\n</ol>\n\n<p>Similarly, with your very large maximum value, most of the numbers that can be picked will be very close to that maximum length. It will be rare to see a number two digits short of that length. (You should see them on the order of 1% of the time.)</p>\n"}], "owner": {"reputation": 13, "user_id": 8214729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230164292123b448c09405dff63ad0f0?s=128&d=identicon&r=PG&f=1", "display_name": "dkgeorge", "link": "https://stackoverflow.com/users/8214729/dkgeorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 44774651, "answer_count": 1, "score": 1, "last_activity_date": 1498549533, "creation_date": 1498548433, "question_id": 44774514, "link": "https://stackoverflow.com/questions/44774514/how-to-generate-a-variable-length-random-number-in-go", "title": "How to generate a variable length random number in Go", "body": "<p>I'm trying to generate a random integer with variable length in Go but I always get the number filling the total length. Here's my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n    \"crypto/rand\"\n)\n\nconst ResultsPerPage = 30\n\nvar (\n        total = new(big.Int).SetBytes([]byte{\n                0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE,\n                0xBA, 0xAE, 0xDC, 0xE6, 0xAF, 0x48, 0xA0, 0x3B, 0xBF, 0xD2, 0x5E, 0x8C, 0xD0, 0x36, 0x41, 0x40,\n        })\n        pages = new(big.Int).Div(total, big.NewInt(ResultsPerPage))\n        random *big.Int\n        err error\n)\n\nfunc main() {\n\nfmt.Println(pages)\nfmt.Println(randomString(pages))\n}\n\nfunc randomString(l *big.Int) string {\n  random, err = rand.Int(rand.Reader, l)\n  fmtrandom := fmt.Sprint(random)\n  return string(fmtrandom)\n}\n</code></pre>\n\n<p>Outputs</p>\n\n<pre><code>3859736307910539847452366166956263595094585475969163479420172104717272049811\n3479662380009045046388212253547512051795238437604387552617121977169155584415\n</code></pre>\n\n<p>Code sample: <a href=\"https://play.golang.org/p/HxAb6Rs_Uj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/HxAb6Rs_Uj</a></p>\n\n<p>Any help is appreciated. Thank you. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8218867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17429dbba4a332f849b34367f0de07f?s=128&d=identicon&r=PG&f=1", "display_name": "meng miao", "link": "https://stackoverflow.com/users/8218867/meng-miao"}, "edited": false, "score": 0, "creation_date": 1498563016, "post_id": 44776678, "comment_id": 76538728, "body": "thank you for help me.  I think i make a mistake when i get  struct &#39;s value .   i find a right  way to resolve this problem .define a variable to receive user data   {% set uinfo = &quot;&quot; | getSessions %}  and get username use {{uinfo.Username}}"}], "tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": false, "score": 0, "last_activity_date": 1498555570, "creation_date": 1498555570, "answer_id": 44776678, "question_id": 44773933, "link": "https://stackoverflow.com/questions/44773933/pongo2-registerfilter-how-to-return-a-map-or-array/44776678#44776678", "title": "pongo2 RegisterFilter how to return a map or array?", "body": "<p>Use <code>return in.Slice(start, limit), nil</code></p>\n\n<p>For example, This is implementation of <code>limit</code> filter can be used in for-loop.</p>\n\n<p><a href=\"https://github.com/mattn/jedie/blob/0f3fb468befcb71b026f07b4158e121da8b6b0c5/helper.go#L120-L125\" rel=\"nofollow noreferrer\">https://github.com/mattn/jedie/blob/0f3fb468befcb71b026f07b4158e121da8b6b0c5/helper.go#L120-L125</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8218867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17429dbba4a332f849b34367f0de07f?s=128&d=identicon&r=PG&f=1", "display_name": "meng miao", "link": "https://stackoverflow.com/users/8218867/meng-miao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498565528, "creation_date": 1498546373, "last_edit_date": 1498565528, "question_id": 44773933, "link": "https://stackoverflow.com/questions/44773933/pongo2-registerfilter-how-to-return-a-map-or-array", "title": "pongo2 RegisterFilter how to return a map or array?", "body": "<p>I need register a global filter to return userinfo from session.\nI resister a new filter.</p>\n\n<pre><code>pongo2.RegisterFilter(\"getSessions\", getSession)\n\nfunc getSession(in, param *pongo2.Value) (*pongo2.Value,*pongo2.Error) {\n    uInfo := lib.Sess.Get(\"userInfo\")\n    if uInfo == nil {\n        lib.Logs.Error(\"get userinfo err from session\")\n    } else {\n    }\n\n    return pongo2.AsValue(uInfo), nil\n}\n</code></pre>\n\n<p>and in the html i use like this:</p>\n\n<pre><code>{{ \"getsess\" | getSessions}}\n</code></pre>\n\n<p>but it's not work, the result is empty. but if reutrn a string is work well . \nif i want to return a map or array . how to do it ?</p>\n"}, {"tags": ["json", "go", "struct", "unmarshalling"], "comments": [{"owner": {"reputation": 376, "user_id": 953837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e809f1b811d369a2ff190f45115ed893?s=128&d=identicon&r=PG", "display_name": "Gov", "link": "https://stackoverflow.com/users/953837/gov"}, "edited": false, "score": 1, "creation_date": 1498543498, "post_id": 44773082, "comment_id": 76526770, "body": "What didn&#39;t work about it? Unmarshalling to a <code>map[string]interface{}</code> is appropriate. From there you can iterate over the keys and unmarshal the value into an array."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1498545358, "post_id": 44773082, "comment_id": 76527700, "body": "Is your JSON data is valid?"}, {"owner": {"reputation": 873, "user_id": 4509355, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/31648f80ef66006febaecde7c76b7319?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Roy", "link": "https://stackoverflow.com/users/4509355/nishant-roy"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498548474, "post_id": 44773082, "comment_id": 76529470, "body": "@jeevatkm thanks. My JSON was full of escape characters."}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 4, "last_activity_date": 1498545234, "creation_date": 1498545234, "answer_id": 44773645, "question_id": 44773082, "link": "https://stackoverflow.com/questions/44773082/unmarshal-json-data-of-unknown-format/44773645#44773645", "title": "Unmarshal JSON data of unknown format", "body": "<ul>\n<li>If you don't know the keys, you can use <code>map[string]interface{}</code> to unmarshal your JSON payload.</li>\n<li>If you use <code>json:\"-\"</code> tag for the <code>struct</code> fields, those fields will be ignored during JSON Marshal/Unmarshal.</li>\n</ul>\n\n<p>You can try following options: <a href=\"https://play.golang.org/p/30ko3Z14Mx\" rel=\"nofollow noreferrer\">Go Playground link</a></p>\n\n<p><strong>Option 1:</strong></p>\n\n<pre><code>var grades map[string]interface{}\n\nerr := json.Unmarshal([]byte(jsonString), &amp;grades)\nfmt.Println(err)\n\nfmt.Printf(\"%#v\\n\", grades)\n</code></pre>\n\n<p><strong>Option 2:</strong> if you want have <code>struct</code></p>\n\n<pre><code>var gradesData GradeData\nerr := json.Unmarshal([]byte(jsonString), &amp;gradesData.Grades)\nfmt.Println(err)\n\nfmt.Printf(\"%#v\\n\", gradesData)\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 4509355, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/31648f80ef66006febaecde7c76b7319?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Roy", "link": "https://stackoverflow.com/users/4509355/nishant-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3484, "favorite_count": 1, "closed_date": 1566050339, "accepted_answer_id": 44773645, "answer_count": 1, "score": 1, "last_activity_date": 1498545234, "creation_date": 1498542891, "question_id": 44773082, "link": "https://stackoverflow.com/questions/44773082/unmarshal-json-data-of-unknown-format", "closed_reason": "Duplicate", "title": "Unmarshal JSON data of unknown format", "body": "<p>My JSON is in the following format:</p>\n\n<pre><code>{\n'Math': \n[\n    {'Student1': 100.0, 'timestamp': Timestamp('2017-06-26 15:30:00'), 'Student2': 100.0, 'Student3': 97.058823442402414},\n    {'Student1': 93.877550824911907, 'timestamp': Timestamp('2017-06-26 15:31:00'), 'Student2': 100.0, 'Student5': 100.0},\n    {'Student8': 100.0, 'timestamp': Timestamp('2017-06-26 15:32:00'), 'Student10': 100.0, 'Student4': 100.0}\n],\n'English': [\n    {'Student1': 100.0, 'timestamp': Timestamp('2017-06-26 15:30:00'), 'Student5': 100.0, 'Student3': 97.058823442402414},\n    {'Student1': 93.877550824911907, 'timestamp': Timestamp('2017-06-26 15:31:00'), 'Student2': 100.0, 'Student5': 100.0}, \n    {'Student8': 100.0, 'timestamp': Timestamp('2017-06-26 15:32:00'), 'Student10': 100.0, 'Student4': 100.0}\n]\n}\n</code></pre>\n\n<p>The keys are completely unknown to me. All I know is that the JSON will be of the format:</p>\n\n<pre><code>{\nSUBJECT1: [{Student_Name1: Grade, Student_Name2: Grade, ... , Student_Name3: Grade, timestamp: Timestamp(...)}],\nSUBJECT2: [{Student_Name4: Grade, Student_Name6: Grade, ... , Student_Name5: Grade, timestamp: Timestamp(...)}]\n...\nSUBJECTN: [{Student_Name1: Grade, Student_Name6: Grade, ... , Student_Name9: Grade, timestamp: Timestamp(...)}]\n}\n</code></pre>\n\n<p>where the <code>subjects</code>, <code>student_names</code> are all unknown and could vary. </p>\n\n<p>I want to unmarshal this into a GoLang struct so I can return it to my front-end as a JSON object. What should my struct look like? This is what I tried, but it didn't work. </p>\n\n<pre><code>type GradeData struct {\n    Grades map[string]interface{} `json:\"-\"`\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "is_accepted": true, "score": 6, "last_activity_date": 1498542391, "last_edit_date": 1498542391, "creation_date": 1498539696, "answer_id": 44772562, "question_id": 44772499, "link": "https://stackoverflow.com/questions/44772499/cant-use-bufio-readstring-with-ioutil-readfile/44772562#44772562", "title": "Can&#39;t use bufio.ReadString{} with ioutil.ReadFile()", "body": "<p>The problem is that the filename ends in a newline:</p>\n\n<pre><code>panic: open a.jpg\n: no such file or directory\n</code></pre>\n\n<p>That should be:</p>\n\n<pre><code>panic: open a.jpg: no such file or directory\n</code></pre>\n\n<p>This is because <a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow noreferrer\"><code>ReadString()</code></a> (emphasis mine):</p>\n\n<blockquote>\n  <p>reads until the first occurrence of delim in the input, returning a string containing the data up to and <strong>including the delimiter</strong>.</p>\n</blockquote>\n\n<p>Use <code>input = strings.TrimSpace(input)</code> to remove the newline.</p>\n\n<hr>\n\n<p>Extra tip 1: Instead of using <code>fmt.Println(input)</code> to debug stuff, you should use <code>fmt.Printf(\"%#v\\n\", input)</code>. This will show whitespace and unprintable characters clearer.</p>\n\n<p>Extra tip 2: Go 1.2.1 is quite old; you should consider using a more recent version. <a href=\"https://golang.org/doc/go1compat\" rel=\"nofollow noreferrer\">Go is very compatible</a> and upgrading to a newer version is usually not a problem.</p>\n"}], "owner": {"reputation": 33, "user_id": 4778560, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203984916649194/picture?type=large", "display_name": "Matt A. Draft", "link": "https://stackoverflow.com/users/4778560/matt-a-draft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "accepted_answer_id": 44772562, "answer_count": 1, "score": 0, "last_activity_date": 1595526224, "creation_date": 1498539313, "last_edit_date": 1595526224, "question_id": 44772499, "link": "https://stackoverflow.com/questions/44772499/cant-use-bufio-readstring-with-ioutil-readfile", "title": "Can&#39;t use bufio.ReadString{} with ioutil.ReadFile()", "body": "<p>If I try to read the file name through the terminal go can't seem to find it. But if I hard code it everything works out fine? this isn't a problem with writing out.</p>\n\n<p>This code:</p>\n\n<pre><code>package main\n\nimport (\n\"bufio\"\n\"fmt\"\n\"io/ioutil\"\n\"os\")\n\nfunc check(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\n\nfunc getUserInput(message string) (text string){\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Println(message)\n    text, err := reader.ReadString('\\n')\n    check(err)\n    return text\n}\n\nfunc main() {\n    input := getUserInput(\"File to open?\")\n    fmt.Println(input)\n    dat, err := ioutil.ReadFile(input)\n    check(err)\n\n    fmt.Print(\"% x \\n\", dat)\n    input = getUserInput(\"File to write?\")\n    d1 := []byte(dat)\n    e := ioutil.WriteFile(input, d1, 0644)\n    check(e)\n}\n</code></pre>\n\n<p>Yields:</p>\n\n<pre><code>panic: open a.jpg\n: no such file or directory\n\ngoroutine 1 [running]:\nruntime.panic(0x4a36c0, 0xc21001d2a0)\n    /usr/lib/go/src/pkg/runtime/panic.c:266 +0xb6\nmain.check(0x7fdcd2e07088, 0xc21001d2a0)\n    /home/matt/Dropbox/CSE3320/fs_GO/fs.go:17 +0x4f\nmain.main()\n    /home/matt/Dropbox/CSE3320/fs_GO/fs.go:35 +0x13e\nexit status 2\n</code></pre>\n\n<p>yet this code:</p>\n\n<pre><code>package main\n\nimport (\n\"bufio\"\n\"fmt\"\n\"io/ioutil\"\n\"os\")\n\nfunc check(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\n\nfunc getUserInput(message string) (text string){\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Println(message)\n    text, err := reader.ReadString('\\n')\n    check(err)\n    return text\n}\n\nfunc main() {\n        //input := getUserInput(\"File to open?\")\n        //fmt.Println(input)\n    dat, err := ioutil.ReadFile(\"a.jpg\")\n    check(err)\n\n    //fmt.Print(\"% x \\n\", dat)\n    input := getUserInput(\"File to write?\")\n    d1 := []byte(dat)\n    e := ioutil.WriteFile(input, d1, 0644)\n    check(e)\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/QwuOb.png\" rel=\"nofollow noreferrer\">Appears to work just fine</a></p>\n\n<p>When running the first code without checking for error a blank new file is created. Yet the second run works perfectly fine even writing the file with the same function to get the new file name. </p>\n\n<p>I'm completely lost as to what I'm doing wrong here. Here is my version info if that helps let me know what else you need.</p>\n\n<p><code>go version</code> gives me <code>go version go1.2.1 linux/amd64</code>.</p>\n"}, {"tags": ["arrays", "go", "redis"], "answers": [{"tags": [], "owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "is_accepted": true, "score": 2, "last_activity_date": 1498541391, "creation_date": 1498541391, "answer_id": 44772811, "question_id": 44771474, "link": "https://stackoverflow.com/questions/44771474/how-to-set-array-document-into-redis-in-golang/44772811#44772811", "title": "How to set array document into redis in Golang?", "body": "<p>Like the error message says, you need to implement the <a href=\"https://golang.org/pkg/encoding/#BinaryMarshaler\" rel=\"nofollow noreferrer\"><code>BinaryMarshaler</code></a> interface for your <code>ArticleCovers</code> type:</p>\n\n<pre><code>type ArticleCovers struct {\n    ID             int\n    Covers         ArticleCovers\n    ArticleTypeID  int\n    Address        Address     `gorm:\"ForeignKey:AddressID\"`\n}\n\nfunc (ac ArticleCovers) MarshalBinary() ([]byte, error) {\n    return []byte(fmt.Sprintf(\"%v-%v\", ac.ID, ac.ArticleTypeID)), nil\n}\n</code></pre>\n\n<p>Note that this only adds the <code>ID</code> and <code>ArticleTypeID</code> fields. I don't know what\nthe <code>ArticleCovers</code> and <code>Address</code> types look like, but often you want to call\nthe same methods on that:</p>\n\n<pre><code>func (ac ArticleCovers) MarshalBinary() ([]byte, error) {\n    covers, err := ac.Covers.MarshalBinary()\n    if err != nil {\n        return nil, err\n    }\n    address, err := ac.Address.MarshalBinary()\n    if err != nil {\n        return nil, err\n    }\n\n    return []byte(fmt.Sprintf(\"%v-%v-%v-%v\",\n        ac.ID, ac.ArticleTypeID, covers, address)\n}\n</code></pre>\n\n<p>I don't know if this format makes sense for your data. You may want to use a\ndefined encoding format such as json.</p>\n\n<p>You will probably also want to implement the <code>BinaryUnmarshaler</code> interface.\nDoing that is left as an exercise ;-)</p>\n"}, {"tags": [], "owner": {"reputation": 337, "user_id": 799341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0d2b6382b24d36cda1d30da9b0d8c?s=128&d=identicon&r=PG", "display_name": "Nevio Vesi\u0107", "link": "https://stackoverflow.com/users/799341/nevio-vesi%c4%87"}, "is_accepted": false, "score": 1, "last_activity_date": 1506700938, "last_edit_date": 1506700938, "creation_date": 1506088541, "answer_id": 46366500, "question_id": 44771474, "link": "https://stackoverflow.com/questions/44771474/how-to-set-array-document-into-redis-in-golang/46366500#46366500", "title": "How to set array document into redis in Golang?", "body": "<p>As Carpetsmoker was saying about the JSON encoding this is how to do it:</p>\n\n<pre><code>func (ac ArticleCovers) MarshalBinary() ([]byte, error) {\n  return json.Marshal(ac)\n}\n</code></pre>\n\n<p>Where when decoding you'd use <a href=\"https://golang.org/pkg/encoding/#BinaryUnmarshaler\" rel=\"nofollow noreferrer\" title=\"BinaryUnmarshaler\">BinaryUnmarshaler</a></p>\n\n<p>You can checkout for better example here at my <a href=\"https://medium.com/@nevio/proper-way-how-to-marshal-and-unmarshal-golang-structs-within-the-redis-cache-855423902787\" rel=\"nofollow noreferrer\" title=\"how-to-marshal-and-unmarshal-golang-structs-redis\">blog post</a></p>\n"}, {"tags": [], "owner": {"reputation": 14451, "user_id": 1334561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhV7w.jpg?s=128&g=1", "display_name": "Muhammad Soliman", "link": "https://stackoverflow.com/users/1334561/muhammad-soliman"}, "is_accepted": false, "score": 0, "last_activity_date": 1530732482, "creation_date": 1530732482, "answer_id": 51179874, "question_id": 44771474, "link": "https://stackoverflow.com/questions/44771474/how-to-set-array-document-into-redis-in-golang/51179874#51179874", "title": "How to set array document into redis in Golang?", "body": "<p>When saving any kind of object into redis directly, it tries to binary hash it so you should implement <code>MarshalBinary</code> to make it work. the idea is to save the value simply in a binary format or string format that is handled by the client internally. </p>\n\n<p>So with that being said, one possible and easy solution of saving objects is save them in a string format, you can still use different marshaling techniques like <code>JSON</code> to do this.</p>\n\n<pre><code>func Save(obj interface{}) error {\n  Redis.HMSet(\"test\", json.Marshal(obj))\n}\n</code></pre>\n\n<p>Although json is an easy way of doing this, but you can have better performance by using binary instead of text-based encoding. <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\">gop</a> is package where it can encode and decode objects. also <a href=\"https://developers.google.com/protocol-buffers/docs/encoding\" rel=\"nofollow noreferrer\">protocol buffers</a> is now widely used especially in such cases where we have different languages and integrations.  </p>\n\n<p>Here is a simple <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\">example</a> with <code>gop</code> and <code>MarshalBinary</code> </p>\n"}], "owner": {"reputation": 361, "user_id": 3453838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100002993957635/picture?type=large", "display_name": "user3453838", "link": "https://stackoverflow.com/users/3453838/user3453838"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5271, "favorite_count": 0, "accepted_answer_id": 44772811, "answer_count": 3, "score": 1, "last_activity_date": 1530732482, "creation_date": 1498530852, "last_edit_date": 1498541481, "question_id": 44771474, "link": "https://stackoverflow.com/questions/44771474/how-to-set-array-document-into-redis-in-golang", "title": "How to set array document into redis in Golang?", "body": "<p>I have a problemwhen insert document in to redis.</p>\n\n<p>I have a struct of data in Go:</p>\n\n<pre><code>type ArticleCovers struct {\n    ID             int\n    Covers         ArticleCovers\n    ArticleTypeID  int\n    Address        Address     `gorm:\"ForeignKey:AddressID\"`\n}\n</code></pre>\n\n<p>I want to add a data like this into Redis:</p>\n\n<pre><code>[ID:1 Cover:[http://chuabuuminh.vn/UserImages/2012/12/10/1/chinh_dien_jpg.jpg] ArticleTypeID:1 Address:map[Street: City:&lt;nil&gt; District:&lt;nil&gt; DistrictID:0 ID:0 Slug: Lat:0 Long:0 Ward:&lt;nil&gt; WardID:0 CityID:0]] \n</code></pre>\n\n<p>But when I run <code>Redis.HMSet(\"test\", structs.Map(ret))</code> it return the error: <code>redis: can't marshal postgresql.ArticleCovers (consider implementing encoding.BinaryMarshaler)</code>.</p>\n\n<p>Who can help me fix my problem, thks you so much!</p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1498527591, "post_id": 44771078, "comment_id": 76522886, "body": "I&#39;ve played around with concurrent sorting (<a href=\"https://github.com/twotwotwo/sorts\" rel=\"nofollow noreferrer\">github.com/twotwotwo/sorts</a>). I don&#39;t think there&#39;s a clean answer from first principles here; you just observe how much the switching cost is and size your work units so you don&#39;t spend too large a % of resources witching tasks."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1498527776, "post_id": 44771078, "comment_id": 76522937, "body": "Okay, thank you. Do you have any idea about the thing I put in PS section?"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1498528397, "post_id": 44771078, "comment_id": 76523054, "body": "This might be a possibile duplicate of <a href=\"https://stackoverflow.com/q/8509152/4639336\">stackoverflow.com/q/8509152/4639336</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1498528675, "post_id": 44771078, "comment_id": 76523109, "body": "@reticentroot since the question is about what&#39;s influencing efficiency of a parallel quicksort rather than limits of the Go runtime, arguably distinct"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1498528953, "post_id": 44771078, "comment_id": 76523161, "body": "Hence might rather than an outright flag from me, though it does show some interesting code to benchmark goroutines... Also how are you bench marking? Hopefully with a number of functions being run with go test =bench, if not see this article <a href=\"https://dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go\" rel=\"nofollow noreferrer\">dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go</a> in doing you can you quickly test and find the &quot;sweet&quot; spot"}], "answers": [{"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1498544330, "post_id": 44771757, "comment_id": 76527177, "body": "Well said! Maybe it is worth stating that launching more goroutines than there are cores which can execute these goroutine actually in parallel probably will not lead to any speedup (as you explained as coordination overhead increases while actual sorting doesn&#39;t). One more point maybe worth mentioning: The goroutines are competing for memory access. Depending on what you sort (ints are small, other data structures might be larger or not even continuous in memory) this will have dramatic effect if too many goroutines are launched."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1498552345, "post_id": 44771757, "comment_id": 76531699, "body": "I worked in the memory bandwidth thing, and that you just can&#39;t count on a linear speedup generally. I revised around NumCPU stuff but it&#39;s very hard to find exactly the right words: obviously &gt;NumCPU tasks doesn&#39;t mean more parallelism, but splitting a sort into, say, 24 tasks on 8 cores gives the scheduler a way to more evenly distribute work across cores in spite of the unevenly-distributed sizes of individual quicksort subtasks (since partitioning doesn&#39;t give you perfect halves). Worker pool would be better (and mentioned that), but can tolerate slightly-too-many goroutines for balancing."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498555478, "post_id": 44771757, "comment_id": 76533679, "body": "You are right. But doubt the OP has access to a 2048 CPU NUMA machine :-)"}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1498574382, "post_id": 44771757, "comment_id": 76547063, "body": "Take a look at this: <a href=\"https://play.golang.org/p/lf-0lzUSKi\" rel=\"nofollow noreferrer\">play.golang.org/p/lf-0lzUSKi</a>  No matter how I actually limit the number of running goroutines, <code>ConcSort</code> would always be slower than <code>NormalSort</code>. Isn&#39;t it odd?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1498586675, "post_id": 44771757, "comment_id": 76554736, "body": "You want <code>go func(i int) {sort.Ints(AA[i]); wg.Done() &lt;-sem}(i)</code> -- make <code>i</code> an explicit param of your closure to avoid <a href=\"https://github.com/golang/go/wiki/CommonMistakes#using-goroutines-on-loop-iterator-variables\" rel=\"nofollow noreferrer\">this issue with var capture</a> and <code>&lt;-sem</code> because it looks like you want to receive those <code>true</code> values you send eventually. I think that would help if you&#39;re running on the latest Go and the subarrays are big (try, like, 100K each). But again, concurrent goroutines isn&#39;t the number you want to focus on, it&#39;s whether you&#39;re backgrounding large enough pieces of work to be worth it."}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 7, "last_activity_date": 1569182262, "last_edit_date": 1569182262, "creation_date": 1498533558, "answer_id": 44771757, "question_id": 44771078, "link": "https://stackoverflow.com/questions/44771078/most-efficient-number-of-goroutines-on-this-machine/44771757#44771757", "title": "Most efficient number of goroutines on this machine", "body": "<p>You have to experiment a bit with this stuff, but I don't think the main concern is <em>goroutines running at once</em>. As the answer @reticentroot linked to says, <a href=\"https://stackoverflow.com/questions/8509152/max-number-of-goroutines\">it's not necessarily a problem to run a lot of simultaneous goroutines</a>.</p>\n\n<p>I think your main concern should be <em>total number of goroutine launches</em>. The current implementation could theoretically start a goroutine to sort just a few items, and that goroutine would spend a lot more time on startup/coordination than actual sorting. </p>\n\n<p>The ideal is you only start as many goroutines as you need to get good utilization of all your CPUs. If your work items are ~equal size and your cores are ~equally busy, then starting one task per core is perfect. </p>\n\n<p>Here, tasks <em>aren't</em> evenly sized, so you might split the sort into <em>somewhat</em> more tasks than you have CPUs and distribute them. (In production you would typically use a <a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">worker pool</a> to distribute work without starting a new goroutine for every task, but I think we can get away with skipping that here.)</p>\n\n<p>To get a workable number of tasks--enough to keep all cores busy, but not so many that you create lots of overhead--you can set a minimum size (initial array size/100 or whatever), and only split off sorts of arrays larger than that. </p>\n\n<hr>\n\n<p>In slightly more detail, there is a bit of cost every time you send a task off to the background. For starters:</p>\n\n<ul>\n<li>Each goroutine <em>launch</em> spends a little time setting up the stack and doing scheduler bookkeeping</li>\n<li>Each <em>task switch</em> spends some time in the scheduler and may incur <a href=\"https://en.wikipedia.org/wiki/CPU_cache#CACHE-MISS\" rel=\"nofollow noreferrer\">cache misses</a> when the two goroutines are looking at different code or data</li>\n<li>Your own <em>coordination code</em> (channel sends and <code>sync</code> ops) takes time</li>\n</ul>\n\n<p>Other things can prevent ideal speedups from happening: you could hit a systemwide limit on e.g. memory bandwidth as Volker pointed out, some sync costs can increase as you add cores, and you can run into <a href=\"https://en.wikipedia.org/wiki/False_sharing\" rel=\"nofollow noreferrer\">various</a> trickier <a href=\"https://en.wikipedia.org/wiki/Non-uniform_memory_access\" rel=\"nofollow noreferrer\">issues</a> sometimes. But the setup, switching, and coordination costs are a good place to start.</p>\n\n<p>The benefit that can outweigh the coordination costs is, of course, other CPUs getting work done when they'd otherwise sit idle.</p>\n\n<p>I think, but haven't tested, that your problems at 50 goroutines are 1) you already reached nearly-full utilization long ago, so adding more tasks adds more coordination work without making things go faster, and 2) you're creating goroutines for <em>tiny</em> sorts, which may spend more of their time setting up and coordinating than they actually do sorting. And at 10 goroutines your problem might be that you're no longer achieving full CPU utilization. </p>\n\n<p>If you wanted, you could test those theories by counting the number of total goroutine launches at various goroutine limits (in <a href=\"https://golang.org/pkg/sync/atomic/#AddInt64\" rel=\"nofollow noreferrer\">an atomic global counter</a>) and measuring CPU utilization at various limits (e.g. by running your program under the Linux/UNIX <code>time</code> utility).</p>\n\n<p>The approach I'd suggest for a divide-and-conquer problem like this is <em>only fork off a goroutine for large enough subproblems</em> (for quicksort, that means large enough subarrays). You can try different limits: maybe you only start goroutines for pieces that are more than 1/64th of the original array, or pieces above some static threshold like 1000 items.</p>\n\n<hr>\n\n<p>And you meant this sort routine as an exercise, I suspect, but there are various things you can do to make your sorts faster or more robust against weird inputs. <a href=\"https://golang.org/src/sort/sort.go\" rel=\"nofollow noreferrer\">The standard libary sort</a> falls back to insertion sort for small subarrays and uses heapsort for the unusual data patterns that cause quicksort problems. </p>\n\n<p>You can also look at other algorithms like radix sort for all or part of the sorting, <a href=\"https://github.com/twotwotwo/sorts/\" rel=\"nofollow noreferrer\">which I played with</a>. That sorting library is also parallel. I wound up using a minimum cutoff of 127 items before I'd hand a subarray off for other goroutines to sort, and I used <a href=\"https://github.com/twotwotwo/sorts/blob/master/parallel.go\" rel=\"nofollow noreferrer\">an arrangement with a fixed pool of goroutines and a buffered chan to pass tasks between them</a>. That produced decent practical speedups at the time, though it was likely not the best approach at the time and I'm almost sure it's not on today's Go scheduler. Experimentation is fun!</p>\n"}], "owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3309, "favorite_count": 1, "accepted_answer_id": 44771757, "answer_count": 1, "score": 3, "last_activity_date": 1569182262, "creation_date": 1498527241, "last_edit_date": 1498912106, "question_id": 44771078, "link": "https://stackoverflow.com/questions/44771078/most-efficient-number-of-goroutines-on-this-machine", "title": "Most efficient number of goroutines on this machine", "body": "<p>So I do have a concurrent quicksort implementation written by me. It looks like this:</p>\n\n<pre><code>func Partition(A []int, p int, r int) int {\n    index := MedianOf3(A, p, r)\n    swapArray(A, index, r)\n    x := A[r]\n    j := p - 1\n    i := p\n    for i &lt; r {\n        if A[i] &lt;= x {\n            j++\n            tmp := A[j]\n            A[j] = A[i]\n            A[i] = tmp\n        }\n        i++\n    }\n    swapArray(A, j+1, r)\n    return j + 1\n}\n\n\nfunc ConcurrentQuicksort(A []int, p int, r int) {\n    wg := sync.WaitGroup{}\n    if p &lt; r {\n        q := Partition(A, p, r)\n        select {\n        case sem &lt;- true:\n            wg.Add(1)\n            go func() {\n                ConcurrentQuicksort(A, p, q-1)\n                &lt;-sem\n                wg.Done()\n            }()\n        default:\n            Quicksort(A, p, q-1)\n        }\n        select {\n        case sem &lt;- true:\n            wg.Add(1)\n            go func() {\n                ConcurrentQuicksort(A, q+1, r)\n                &lt;-sem\n                wg.Done()\n            }()\n        default:\n            Quicksort(A, q+1, r)\n        }\n    }\n    wg.Wait()\n}\n\nfunc Quicksort(A []int, p int, r int) {\n    if p &lt; r {\n        q := Partition(A, p, r)\n        Quicksort(A, p, q-1)\n        Quicksort(A, q+1, r)\n    }\n}\n</code></pre>\n\n<p>I have a <code>sem</code> buffered channel, which I use to limit the number of goroutines running (if its reaches that number, I dont set up another goroutine, I just do the normal quicksort on the subarray). First I started with 100, then I've changed to 50, 20. The benchmarks would get slightly better. But after switching to 10, it started to go back, times started to get bigger. So there is some arbitrary number, at least for my hardware, that makes the algorithm run most efficient. </p>\n\n<p>When I was implementing this, I actually saw some SO question about the number of goroutines that would be the best and now I cannot find it (stupid Chrome history actually saves not all visited sites). Do you know how to calculate such a things? And it would be the best if I didn't have to hardcode it, just let the program do it itself.</p>\n\n<p>P.S I have nonconcurrent Quicksort, which runs about 1.7x slower than this. As you can see in my code, I do <code>Quicksort</code>, when the number of running goroutines exceeds the number I've set up earlier. I thought what about using a <code>ConcurrentQuicksort</code>, but not calling it with <code>go</code> keyword, just simply calling it, and maybe if other goroutines finish their job, the <code>ConcurrentQuicksort</code> which I called would start to launch up goroutines, speeding up the process (cuz as you can see <code>Quicksort</code> would only launch recursive quicksorts, without goroutines). I did that, and actually the time was like 10% slower than the regular Quicksort. Do you know why would that happen?</p>\n"}, {"tags": ["go", "compiler-construction", "language-design"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1498526765, "post_id": 44770962, "comment_id": 76522700, "body": "Haven&#39;t watched in order to be able to answer the second question you asked, but to the first question, if as-an-expression would be where <code>x = if (condition) then { value1 } else { value2 }</code> can assign different values to x. Rust and Kotlin do it, for example, and it&#39;s what C&#39;s ternary operator (<code>?:</code>) does (same example is written <code>condition ? value1 : value2</code>)."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1498526927, "post_id": 44770962, "comment_id": 76522740, "body": "It&#39;s a language design decision despite the asker&#39;s use of the word &#39;implementation&#39;. If I had to guess why the Gophers designed it that way, it&#39;s that Go generally sticks to the imperative tradition of C, and blocks under <code>if</code> behaving as statements rather than like expressions is more C-like."}, {"owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "edited": false, "score": 0, "creation_date": 1498574950, "post_id": 44770962, "comment_id": 76547492, "body": "You might want to take a look at the BLISS programming language. You can find documentation on line. Everything is an expression in BLISS."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 13, "last_activity_date": 1585860791, "last_edit_date": 1585860791, "creation_date": 1498526958, "answer_id": 44771040, "question_id": 44770962, "link": "https://stackoverflow.com/questions/44770962/difference-between-if-as-an-expression-and-if-as-a-statement/44771040#44771040", "title": "Difference between if as an expression and if as a statement", "body": "<p>The difference between expressions and statements is that expressions produce a value and thus can be used in places where values are required. So expressions can be used as values for variables, arguments to functions or operands to operators. Statements can't.</p>\n\n<blockquote>\n  <p>and what does he mean that \"you need values rather than variables\" in his question?</p>\n</blockquote>\n\n<p>I assume that by vals he means constants (which are called <code>val</code>s in Scala for example).</p>\n\n<p>If <code>if</code> were an expression, you could do this:</p>\n\n<pre><code>const myValue = if condition { value1 } else { value2 }\n</code></pre>\n\n<p>Since <code>if</code> is not an expression, you have to do this:</p>\n\n<pre><code>var myValue\nif condition {\n    myValue = value1\n} else {\n    myValue = value2\n}\n</code></pre>\n\n<p>So you needed to make your variable mutable (use <code>var</code> instead of <code>const</code>), which is what the person asking the question likely meant.</p>\n"}], "owner": {"reputation": 259, "user_id": 6398020, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2fc9cc1619a0b712df3032f6b9772c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio", "link": "https://stackoverflow.com/users/6398020/mauricio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1622, "favorite_count": 1, "accepted_answer_id": 44771040, "answer_count": 1, "score": 4, "last_activity_date": 1585860791, "creation_date": 1498526259, "last_edit_date": 1498526599, "question_id": 44770962, "link": "https://stackoverflow.com/questions/44770962/difference-between-if-as-an-expression-and-if-as-a-statement", "title": "Difference between if as an expression and if as a statement", "body": "<p>So I was watching this video on the Go language - <a href=\"https://www.youtube.com/watch?v=p9VUCp98ay4\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=p9VUCp98ay4</a> , and at around 6:50 a guy asks a question about why they implemented if's as statements and not expressions. What is the difference between those two implementations? As far as I know, I've never had to change the way I use a conditional based on the language.</p>\n\n<p>Edit: and what does he mean that \"you need values rather than variables\" in his question?</p>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498523219, "post_id": 44770450, "comment_id": 76521861, "body": "You&#39;re calling defer in a loop. None of those will execute until the function returns."}, {"owner": {"reputation": 30708, "user_id": 1070291, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e1BFx.png?s=128&g=1", "display_name": "Not loved", "link": "https://stackoverflow.com/users/1070291/not-loved"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498523281, "post_id": 44770450, "comment_id": 76521881, "body": "@JimB what should I be doing instead?"}, {"owner": {"reputation": 30708, "user_id": 1070291, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e1BFx.png?s=128&g=1", "display_name": "Not loved", "link": "https://stackoverflow.com/users/1070291/not-loved"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498524814, "post_id": 44770450, "comment_id": 76522219, "body": "@jimb I tried removing the defer (given its after the read anyway) but same issue."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498531106, "post_id": 44770450, "comment_id": 76523526, "body": "Yes, if you need to clean up within a loop you can&#39;t really use defer. Now since you&#39;re only connecting to one hostname, you need to set the max number of idle connections to match your concurrency. See <a href=\"https://stackoverflow.com/questions/39813587/go-client-program-generates-a-lot-a-sockets-in-time-wait-state/39834253#39834253\" title=\"go client program generates a lot a sockets in time wait state\">stackoverflow.com/questions/39813587/&hellip;</a>"}], "owner": {"reputation": 30708, "user_id": 1070291, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e1BFx.png?s=128&g=1", "display_name": "Not loved", "link": "https://stackoverflow.com/users/1070291/not-loved"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2157, "favorite_count": 0, "closed_date": 1498560867, "answer_count": 0, "score": 2, "last_activity_date": 1498524828, "creation_date": 1498522005, "last_edit_date": 1498524828, "question_id": 44770450, "link": "https://stackoverflow.com/questions/44770450/only-one-usage-of-each-socket-address-port-exhaustion-in-golang-on-windows", "closed_reason": "Duplicate", "title": "Only one usage of each socket address (Port exhaustion) in golang on windows", "body": "<p>I'm just having a bit of a go with golang, I built a little load tester to play with concurrency stuff in go which looks cool.</p>\n\n<p>My tester app starts a bunch of threads and each thread does a bunch of http requests as fast as possible to some endpoint. After a few seconds I get the following error:</p>\n\n<blockquote>\n  <p>connectex: Only one usage of each socket address (protocol/network address/port) is normally permitted.</p>\n</blockquote>\n\n<p>I've come across this problem before in dotnet, its to do with running out of ports allocated by windows (<a href=\"https://aspnetmonsters.com/2016/08/2016-08-27-httpclientwrong/\" rel=\"nofollow noreferrer\">https://aspnetmonsters.com/2016/08/2016-08-27-httpclientwrong/</a>). HttpClient (dotnet) solves this by reusing ports between requests. </p>\n\n<p><strong>Does go have a similar way to reuse the OS allocated port between http requests?</strong></p>\n\n<p><strong>Code to reproduce:</strong> </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"time\"\n)\n\nconst numberOfCallsPerThread = 100\nconst numberOfThreads = 128\n\nfunc main() {\n    var chans [numberOfThreads]chan time.Duration\n    for i := range chans {\n        chans[i] = make(chan time.Duration, 5) //only let one thread get 5 calls ahead\n        go callGet(numberOfCallsPerThread, chans[i])\n    }\n\n    var durations [numberOfCallsPerThread * numberOfThreads]time.Duration\n\n    for i := 0; i &lt; numberOfCallsPerThread; i++ {\n        for j := range chans {\n            durations[(i*numberOfThreads)+j] = &lt;-chans[j]\n        }\n    }\n}\n\nfunc callGet(numberOfTimes int, responseTime chan time.Duration) {\n\n    for i := 0; i &lt; numberOfTimes; i++ {\n        start := time.Now()\n        response, httpError := http.Get(\"http://google.com\")\n        if httpError != nil {\n            close(responseTime)\n            panic(httpError)\n        }\n        responseBody, _ := ioutil.ReadAll(response.Body)\n        response.Body.Close()\n        elapsed := time.Since(start)\n        fmt.Println(len(responseBody), \"    in \", elapsed)\n\n        responseTime &lt;- elapsed\n    }\n}\n</code></pre>\n\n<p>(sorry no playground link as it doesn't support http things)</p>\n\n<p><strong>NOTE: This issue only occurs on windows (osx is not reproducable)</strong></p>\n"}, {"tags": ["go", "unsafe-pointers"], "answers": [{"tags": [], "owner": {"reputation": 7099, "user_id": 1475548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09sbK.jpg?s=128&g=1", "display_name": "Octopus", "link": "https://stackoverflow.com/users/1475548/octopus"}, "is_accepted": true, "score": 1, "last_activity_date": 1499358301, "last_edit_date": 1499358301, "creation_date": 1498522160, "answer_id": 44770471, "question_id": 44769538, "link": "https://stackoverflow.com/questions/44769538/how-do-i-write-to-a-dibits-structure-in-go/44770471#44770471", "title": "How do I write to a DIBits structure in Go?", "body": "<p>It's just a matter of casting the unsafe.Pointer back to an array (which is indexable) in the proper way.</p>\n\n<p>After trying various casts, this is the one that worked (assuming <code>wid</code> and <code>hgt</code> are each declare as <code>const</code>):</p>\n\n<pre><code>pixels := (*[wid*hgt*4]uint8)(ptr)\n</code></pre>\n\n<p>then I was able to change them with:</p>\n\n<pre><code>pixels[(y*wid+x)*4+0] = 0x00 // Blue\npixels[(y*wid+x)*4+1] = 0x00 // Green\npixels[(y*wid+x)*4+2] = 0x00 // Red\n</code></pre>\n"}], "owner": {"reputation": 7099, "user_id": 1475548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09sbK.jpg?s=128&g=1", "display_name": "Octopus", "link": "https://stackoverflow.com/users/1475548/octopus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 44770471, "answer_count": 1, "score": 0, "last_activity_date": 1499358301, "creation_date": 1498515817, "last_edit_date": 1498548771, "question_id": 44769538, "link": "https://stackoverflow.com/questions/44769538/how-do-i-write-to-a-dibits-structure-in-go", "title": "How do I write to a DIBits structure in Go?", "body": "<p>I'm using a w32 library to allow me to do Windowing with the Go language. I'm not quite sure what to do with an <code>unsafe.Pointer</code> that will allow me to start setting pixel values in the pixel buffer.</p>\n\n<p>I use an <code>unsafe.Pointer</code>, because that's what the w32 library expects me to pass in the CreateDIBSection function.</p>\n\n<pre><code>var p unsafe.Pointer\nbitmap := w32.CreateDIBSection( srcDC, &amp;bmi, w32.DIB_RGB_COLORS, &amp;p, w32.HANDLE(0), 0 )\n</code></pre>\n\n<p>That code succeeds and gives me a pointer to the memory location where the DIBBits are stored. How can I use that to write values?</p>\n\n<pre><code>p[idx] = 0xff\n</code></pre>\n\n<p>will give me an error <code>type unsafe.Pointer does not allow indexing</code>. I've read the relevant docs on the unsafe.Pointer, but can't figure out how to treat it as a byte buffer that I can write into.</p>\n\n<p>I'm new to Go and have worked through a lot of the examples at <a href=\"http://gobyexample.com\" rel=\"nofollow noreferrer\">gobyexample.com</a>, but cannot figure this out.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1498510797, "post_id": 44768451, "comment_id": 76518234, "body": "You don&#39;t import your code to test, the tests exist in the same package. If you do need to import a package for black-box testing, always use the full import path, never the relative path (but you can&#39;t ever import a main package)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1498510797, "post_id": 44768451, "comment_id": 76518235, "body": "The error says it all: you have two functions both called <code>main</code> in the same package, one in <code>new.go</code> line 14, one in <code>myproject.go</code> line 62. You can&#39;t have two functions of the same name in the same package (except for the special case of <code>init</code> functions). You also have an invalid call to <code>ListenAndServeTLS</code> which passes no arguments when that function requires two arguments, both strings."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498511336, "post_id": 44768451, "comment_id": 76518474, "body": "@Adrian I was not watching other files. I have a flat directory which caused the problem. There is a file new.go in my directory which has the second main(). I corrected it. How should I import the specific handler (I&#39;m doing it this way: import (&quot;project&quot;)) ?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1498511452, "post_id": 44768451, "comment_id": 76518524, "body": "If the files are in the same directory, you don&#39;t need to import them, just declare them in the same package. You might want to <a href=\"https://www.golang-book.com/books/intro/11\" rel=\"nofollow noreferrer\">read about packages in Go</a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498511628, "post_id": 44768451, "comment_id": 76518577, "body": "@SarathVelamuri: go packages are located by directory, with one non-test package per directory. You should be able to test and compile by their import path. You shouldn&#39;t be using <code>go run</code> and should not have to specify individual files on the command line.  Also see <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a> for details."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498512161, "post_id": 44768451, "comment_id": 76518770, "body": "@JimB I was using <code>go test</code> for my test code. But It could not locate the handler(GetPersonEndpoint) which I&#39;ve created in the endpoints file. The test is giving me <code>.&#47;handler_test.go:19: undefined: GetPersonEndpoint</code>. But there is clearly a handler for this in the main.go."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498512273, "post_id": 44768451, "comment_id": 76518813, "body": "@SarathVelamuri: you couldn&#39;t have been testing the package, because you have invalid Go files. If you&#39;re still not sure what we mean, please show the exact commands you&#39;re using."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498512567, "post_id": 44768451, "comment_id": 76518916, "body": "@JimB go run project.go and go test handlers_test.go"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1498513273, "post_id": 44768451, "comment_id": 76519201, "body": "@SarathVelamuri: yes, like I said, you should not have to specify individual files on the command line. You should be specifying your package, or using the package implied by the current directory."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "edited": false, "score": 0, "creation_date": 1498586491, "post_id": 44770957, "comment_id": 76554648, "body": "How do I install the pkg go_rest_api/pkg?"}, {"owner": {"reputation": 8269, "user_id": 588734, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/o3CVI.jpg?s=128&g=1", "display_name": "Eamonn McEvoy", "link": "https://stackoverflow.com/users/588734/eamonn-mcevoy"}, "edited": false, "score": 0, "creation_date": 1498604025, "post_id": 44770957, "comment_id": 76563111, "body": "@SarathVelamuri You don&#39;t, that&#39;s just the name of my project. You just need to create an instance of the struct containing your routes and serve it with <code>httptest</code> and a request. In my case <code>testUserRouter</code> is a (poorlyNamed?) instance of my <code>UserRouter</code> struct, I invoke a <code>PUT</code> request on the path <code>&quot;&#47;&quot;</code>"}], "tags": [], "owner": {"reputation": 8269, "user_id": 588734, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/o3CVI.jpg?s=128&g=1", "display_name": "Eamonn McEvoy", "link": "https://stackoverflow.com/users/588734/eamonn-mcevoy"}, "is_accepted": true, "score": 2, "last_activity_date": 1498526208, "creation_date": 1498526208, "answer_id": 44770957, "question_id": 44768451, "link": "https://stackoverflow.com/questions/44768451/how-to-test-an-endpoint-in-go/44770957#44770957", "title": "How to test an endpoint in go?", "body": "<p>Have a look at some http tests I've written: <a href=\"https://github.com/eamonnmcevoy/go_web_server/blob/master/pkg/server/user_router_test.go\" rel=\"nofollow noreferrer\">https://github.com/eamonnmcevoy/go_web_server/blob/master/pkg/server/user_router_test.go</a></p>\n\n<pre><code>    // Arrange\n    us := mock.UserService{}\n    testUserRouter := NewUserRouter(&amp;us, mux.NewRouter())\n...\n    w := httptest.NewRecorder()\n    r, _ := http.NewRequest(\"PUT\", \"/\", payload)\n    r.Header.Set(\"Content-Type\", \"application/json\")\n    testUserRouter.ServeHTTP(w, r)\n</code></pre>\n\n<p>Simply create an instance of your router and call the endpoints using go's <code>httptest</code>. This snippet will perform a <code>PUT</code> request at the default endpoint <code>/</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1781, "favorite_count": 0, "accepted_answer_id": 44770957, "answer_count": 1, "score": 1, "last_activity_date": 1498526208, "creation_date": 1498510170, "question_id": 44768451, "link": "https://stackoverflow.com/questions/44768451/how-to-test-an-endpoint-in-go", "title": "How to test an endpoint in go?", "body": "<p>I wrote a small test function in go. I'm having hard time in making a request to actual endpoint and test it. I tried importing the file which has the handler function (I think I'm trying to import whole directory : <code>import (\".\")</code>). Both my project.go and handler_test.go are in the same directory (I don't think this matters). Could someone give me heads up so that I can write more tests.\nHere is my project.go: </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n    \"github.com/rs/cors\"\n\n)\n\ntype Person struct {\n    ID        string   `json:\"id,omitempty\"`\n    Firstname string   `json:\"firstname,omitempty\"`\n    Lastname  string   `json:\"lastname,omitempty\"`\n    Address   *Address `json:\"address,omitempty\"`\n}\n\ntype Address struct {\n    City  string `json:\"city,omitempty\"`\n    State string `json:\"state,omitempty\"`\n}\n\nvar people []Person;\n\nfunc GetPersonEndpoint(w http.ResponseWriter, req *http.Request) {\n    params := mux.Vars(req)\n    for _, item := range people {\n        if item.ID == params[\"id\"] {\n            json.NewEncoder(w).Encode(item)\n            return\n        }\n    }\n    json.NewEncoder(w).Encode(&amp;Person{})\n}\n\n\nfunc GetPeopleEndpoint(w http.ResponseWriter, req *http.Request) {\n json.NewEncoder(w).Encode(people)\n}\n\nfunc CreatePersonEndpoint(w http.ResponseWriter, req *http.Request) {\n    params := mux.Vars(req)\n    var person Person\n    _ = json.NewDecoder(req.Body).Decode(&amp;person)\n    person.ID = params[\"id\"]\n    people = append(people, person)\n    json.NewEncoder(w).Encode(people)\n}\n\nfunc DeletePersonEndpoint(w http.ResponseWriter, req *http.Request) {\n    params := mux.Vars(req)\n    for index, item := range people {\n        if item.ID == params[\"id\"] {\n            people = append(people[:index], people[index+1:]...)\n            break\n        }\n    }\n    json.NewEncoder(w).Encode(people)\n}\n\nfunc main() {\n    Router := mux.NewRouter()\n    people = append(people, Person{ID: \"1\", Firstname: \"sarath\", Lastname: \"v\", Address: &amp;Address{City: \"sunnyvale\", State: \"CA\"}})\n    people = append(people, Person{ID: \"2\", Firstname: \"dead\", Lastname: \"pool\"})\n\n    // router.PathPrefix(\"/tmpfiles/\").Handler(http.StripPrefix(\"/tmpfiles/\", http.FileServer(http.Dir(\".\"))))\n\n    Router.HandleFunc(\"/people\", GetPeopleEndpoint).Methods(\"GET\")\n    Router.HandleFunc(\"/people/{id}\", GetPersonEndpoint).Methods(\"GET\")\n    Router.HandleFunc(\"/people/{id}\", CreatePersonEndpoint).Methods(\"POST\")\n\n   c := cors.New(cors.Options{\n    AllowedOrigins: []string{\"http://localhost:3000\"},\n    AllowCredentials: true,\n})\n\n// Insert the middleware\n   handler := c.Handler(Router)\n   http.ListenAndServe(\":12345\", handler)\n\n}\n</code></pre>\n\n<p>Here is my handler_test.go. In this code I'm testing GetPersonEndPoint.</p>\n\n<pre><code>package main\n\nimport (\n  \".\"\n  \"net/http\"\n  \"net/http/httptest\"\n  \"testing\"\n  \"encoding/json\"\n)\n\nfunc checkResponseCode(t *testing.T, expected, actual int) {\n    if expected != actual {\n        t.Errorf(\"Expected response code %d. Got %d\\n\", expected, actual)\n    }\n}\n\nfunc executeRequest(req *http.Request) *httptest.ResponseRecorder {\n    rr := httptest.NewRecorder()\n     handler := http.HandlerFunc(GetPersonEndpoint)\n     handler.ServeHTTP(rr, req)\n     if status := rr.Code; status != http.StatusOK {\n       fmt.Printf(\"Handler returned wrong status code: got %v want %v\" , status, http.statusOk);\n      }\n    return rr\n}\n\nfunc TestGetPersonEndPoint(t *testing.T){\n  req, _ := http.NewRequest(\"GET\", \"/people/5\", nil)\n  response := executeRequest(req)\n  checkResponseCode(t, http.StatusNotFound, response.Code)\n   var m map[string]string\n   json.Unmarshal(response.Body.Bytes(), &amp;m)\n  if m[\"error\"] != \"Product not found\" {\n        t.Errorf(\"Expected the 'error' key of the response to be set to 'Product not found'. Got '%s'\", m[\"error\"])\n    }\n}\n</code></pre>\n\n<p>And finally this is the error:</p>\n\n<pre><code>./new.go:14: main redeclared in this block\n    previous declaration at ./myproject.go:62\n./new.go:20: not enough arguments in call to server.ListenAndServeTLS\n    have ()\n    want (string, string)\n</code></pre>\n"}, {"tags": ["xml", "go", "struct", "marshalling"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1498507283, "last_edit_date": 1498507283, "creation_date": 1498506964, "answer_id": 44767697, "question_id": 44767424, "link": "https://stackoverflow.com/questions/44767424/how-to-add-an-xml-attribute-to-an-element-in-go/44767697#44767697", "title": "How to add an XML attribute to an element in Go?", "body": "<p>Your desired XML has 2 elements: <code>&lt;environment&gt;</code> and <code>&lt;temperature&gt;</code>, so you should have 2 types (structs) to model them. And you may use the tag <code>\",chardata\"</code> to tell the encoder to write the field's value as character data and not as an XML element.</p>\n\n<pre><code>type environment struct {\n    Temperature temperature `xml:\"temperature\"`\n}\n\ntype temperature struct {\n    Temperature string `xml:\",chardata\"`\n    Type        string `xml:\"type,attr\"`\n    Units       string `xml:\"unit,attr\"`\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>x := &amp;environment{\n    Temperature: temperature{Temperature: \"-11.3\", Type: \"float\", Units: \"c\"},\n}\n\nenc := xml.NewEncoder(os.Stdout)\nenc.Indent(\"\", \"  \")\nif err := enc.Encode(x); err != nil {\n    fmt.Printf(\"error: %v\\n\", err)\n}\n</code></pre>\n\n<p>It produces the desired output (try it on the <a href=\"https://play.golang.org/p/oicKa9U38K\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&lt;environment&gt;\n  &lt;temperature type=\"float\" unit=\"c\"&gt;-11.3&lt;/temperature&gt;\n&lt;/environment&gt;\n</code></pre>\n\n<p>Note that you get the same result if you use the <code>\",innerxml\"</code> tag which tells the encoder to write the value verbatim, not subject to the usual marshaling procedure:</p>\n\n<pre><code>type temperature struct {\n    Temperature string `xml:\",innerxml\"`\n    Type        string `xml:\"type,attr\"`\n    Units       string `xml:\"unit,attr\"`\n}\n</code></pre>\n\n<p>Output is the same. Try this one on the <a href=\"https://play.golang.org/p/lWQlohI3RT\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 367, "user_id": 3707288, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a4cccb853563fa6349abee5377d7a05e?s=128&d=identicon&r=PG&f=1", "display_name": "Xevious", "link": "https://stackoverflow.com/users/3707288/xevious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2715, "favorite_count": 1, "accepted_answer_id": 44767697, "answer_count": 1, "score": 4, "last_activity_date": 1498507354, "creation_date": 1498505861, "last_edit_date": 1498507354, "question_id": 44767424, "link": "https://stackoverflow.com/questions/44767424/how-to-add-an-xml-attribute-to-an-element-in-go", "title": "How to add an XML attribute to an element in Go?", "body": "<p>I am using the encoding/xml package in Go and the <a href=\"https://golang.org/pkg/encoding/xml/#example_Encoder\" rel=\"nofollow noreferrer\">Encoder example code</a>.</p>\n\n<p>While I am able to produce workable XML, I am unable to add all of the attributes that I need.</p>\n\n<p>As an example, let us use the concept of temperature reporting. What I need is something like this:</p>\n\n<pre><code>&lt;environment&gt;\n  &lt;temperature type=\"float\" units=\"c\"&gt;-11.3&lt;/temperature&gt;\n&lt;/environment&gt;\n</code></pre>\n\n<p>My struct looks like this:</p>\n\n<pre><code>type climate struct {\n    XMLName     xml.Name    `xml:\"environment\"`\n    Temperature string      `xml:\"temperature\"`\n    Type        string      `xml:\"type,attr\"`\n    Units       string      `xml:\"unit,attr\"`\n}\n</code></pre>\n\n<p>What I end up with looks like this:</p>\n\n<pre><code>&lt;environment type=\"float\" unit=\"c\"&gt;\n  &lt;temperature&gt;-11.3&lt;/temperature&gt;\n&lt;/environment&gt;\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/O2fhThftuI\" rel=\"nofollow noreferrer\">My example code in the Go Playground</a></p>\n\n<p>How can I format the struct tags to put the attributes in the proper element?</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1498501705, "post_id": 44766284, "comment_id": 76513562, "body": "Go has no notion of pass by reference."}, {"owner": {"reputation": 665, "user_id": 2439234, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3bb9f490f9889d6e84bff869fc3de20?s=128&d=identicon&r=PG", "display_name": "re3el", "link": "https://stackoverflow.com/users/2439234/re3el"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498501755, "post_id": 44766284, "comment_id": 76513587, "body": "@Volker: sorry for the misuse of the term but I hope you got my intention of the question"}, {"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 1, "creation_date": 1498501832, "post_id": 44766284, "comment_id": 76513627, "body": "To do something similar to pass-by-reference in go you need to use pointers."}, {"owner": {"reputation": 665, "user_id": 2439234, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3bb9f490f9889d6e84bff869fc3de20?s=128&d=identicon&r=PG", "display_name": "re3el", "link": "https://stackoverflow.com/users/2439234/re3el"}, "reply_to_user": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1498501993, "post_id": 44766284, "comment_id": 76513706, "body": "@LasseV.Karlsen: could you provide an example. I have tried using pointers but wasn&#39;t succesful"}, {"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1498502041, "post_id": 44766284, "comment_id": 76513732, "body": "Nope, sorry, I&#39;m just reading off of the documentation. I&#39;ve never used go. Every parameter in go is pass-by-value, but you can pass a pointer (by value)."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 3, "creation_date": 1498502074, "post_id": 44766284, "comment_id": 76513754, "body": "Why would you need to pass a pointer to the interface? If you pass a pointer to your struct, and the struct implements the desired interface, then you would still have a pointer to the concrete object under the hood. The fact that you&#39;re trying to change that underlying object seems like you might not understand the purpose of an interface."}], "answers": [{"comments": [{"owner": {"reputation": 4589, "user_id": 5612096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51821186ffde540f4d10b86544ca1a7d?s=128&d=identicon&r=PG", "display_name": "Adirio", "link": "https://stackoverflow.com/users/5612096/adirio"}, "edited": false, "score": 1, "creation_date": 1611822025, "post_id": 44766472, "comment_id": 116574939, "body": "Just as a clarifier: <code>some(a)</code> will not compile because <code>check</code> does not implement <code>Settable</code>. <code>some(&amp;a)</code> will work because <code>*check</code> does implement <code>Settable</code>. And by the way, you may want to remove the <code>p</code> variable and use <code>some(&amp;a)</code> and <code>fmt.Println(a)</code> to show that the function is actually changing <code>a</code> and not only <code>p</code>, as new gophers may think that you are changing <code>p</code> but not <code>a</code>."}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 8, "last_activity_date": 1611821796, "last_edit_date": 1611821796, "creation_date": 1498502265, "answer_id": 44766472, "question_id": 44766284, "link": "https://stackoverflow.com/questions/44766284/how-to-pass-interface-of-struct-type-by-reference-in-golang/44766472#44766472", "title": "How to pass interface of struct type by reference in golang?", "body": "<p>So you're using an interface, and you need some sort of guarantee that you can set the value of a member of the struct?  Sounds like you should make that guarantee part of the interface, so something like:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>type Settable interface {\n    SetVal(val int)\n}\n\nfunc (c *check) SetVal(val int) {\n    c.Val = val\n}\n\nfunc some(te Settable) {\n    te.SetVal(20)\n}\n\ntype check struct {\n    Val int\n}\n\nfunc main() {\n    a := check{Val: 100}\n    p := &amp;a\n    some(p)\n    fmt.Println(*p)\n}\n</code></pre>\n"}], "owner": {"reputation": 665, "user_id": 2439234, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3bb9f490f9889d6e84bff869fc3de20?s=128&d=identicon&r=PG", "display_name": "re3el", "link": "https://stackoverflow.com/users/2439234/re3el"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8105, "favorite_count": 2, "accepted_answer_id": 44766472, "answer_count": 1, "score": 5, "last_activity_date": 1611821796, "creation_date": 1498501585, "last_edit_date": 1498501951, "question_id": 44766284, "link": "https://stackoverflow.com/questions/44766284/how-to-pass-interface-of-struct-type-by-reference-in-golang", "title": "How to pass interface of struct type by reference in golang?", "body": "<p>I need to pass an interface of a struct type by reference as shown below. Since, I can't use pointers of interface to struct type variables, how should I change the below code to modify <code>te</code> value to <code>10</code>?.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc another(te *interface{}) {\n    *te = check{Val: 10}\n}\n\nfunc some(te *interface{}) {\n    *te = check{Val: 20}\n    another(te)\n}\n\ntype check struct {\n    Val int\n}\n\nfunc main() {\n    a := check{Val: 100}\n    p := &amp;a\n    fmt.Println(*p)\n    some(p)\n    fmt.Println(*p)\n}\n</code></pre>\n\n<p>Thanks!</p>\n\n<p>P.S I have read that passing pointers to interfaces is not a very good practice. Kindly let me know what could be a better way to handle it</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498499501, "post_id": 44765256, "comment_id": 76512350, "body": "Does <code>TMPDIR=c:&#47;dev&#47;projects&#47;tmp go test</code> not work for you (or whatever the Windows equivalent is)?"}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 2, "last_activity_date": 1498502487, "creation_date": 1498502487, "answer_id": 44766549, "question_id": 44765256, "link": "https://stackoverflow.com/questions/44765256/go-unit-test-runs-from-appdata/44766549#44766549", "title": "go unit test runs from %APPDATA%", "body": "<blockquote>\n  <p>Yes you can. </p>\n</blockquote>\n\n<p>Setting temp directory before executing the <code>go test</code>. By default temp directory environment variable gets evaluated in the order of <code>TMP</code>, <code>TEMP</code>, <code>USERPROFILE</code>, Windows directory; refer to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa364992(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn doc</a>.</p>\n\n<p>Basically it complies the go test under given temp directory and execute it.</p>\n\n<pre><code>C:\\&gt; cd dev\\projects\\src\\mygotest\nC:\\dev\\projects\\src\\mygotest&gt;echo %CD%\nC:\\dev\\projects\\src\\mygotest\n\nC:\\dev\\projects\\src\\mygotest&gt;set TMP=%CD%\n\nC:\\dev\\projects\\src\\mygotest&gt;go test -x\nWORK=C:\\dev\\projects\\src\\mygotest\\go-build306298926\nmkdir -p $WORK\\mygotest\\_test\\\nmkdir -p $WORK\\mygotest\\_test\\_obj_test\\\ncd C:\\dev\\projects\\src\\mygotest\n\"C:\\\\Go\\\\pkg\\\\tool\\\\windows_amd64\\\\compile.exe\" -o \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\\\\mygotest\\\\_test\\\\mygotest.a\" -trimpath \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\" -p main -complete -buildid 86cb7a423d355c7468ad98c4f8bffe77b68d2265 -D _/C_/dev/projects/src/mygotest -I \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\" -pack \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\sample.go\" \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\sample_test.go\"\ncd $WORK\\mygotest\\_test\n\"C:\\\\Go\\\\pkg\\\\tool\\\\windows_amd64\\\\compile.exe\" -o \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\\\\mygotest\\\\_test\\\\main.a\" -trimpath \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\" -p main -complete -D \"\" -I \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\\\\mygotest\\\\_test\" -I \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\" -pack \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\\\\mygotest\\\\_test\\\\_testmain.go\"\ncd .\n\"C:\\\\Go\\\\pkg\\\\tool\\\\windows_amd64\\\\link.exe\" -o \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\\\\mygotest\\\\_test\\\\mygotest.test.exe\" -L \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\\\\mygotest\\\\_test\" -L \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\" -w -extld=gcc -buildmode=exe \"C:\\\\dev\\\\projects\\\\src\\\\mygotest\\\\go-build306298926\\\\mygotest\\\\_test\\\\main.a\"\n$WORK\\mygotest\\_test\\mygotest.test.exe\nHello, playground\nPASS\nok      mygotest        0.526s\n\nC:\\dev\\projects\\src\\mygotest&gt;\n</code></pre>\n\n<p><strong><em>Note:</strong> <code>TMP</code> set to current terminal session only, it doesn't affect system environment variable.</em></p>\n\n<p>Important thing to note from above test output is <code>WORK=C:\\dev\\projects\\src\\mygotest\\go-build306298926</code>.</p>\n\n<p>Happy testing!</p>\n"}], "owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1498502487, "creation_date": 1498498024, "question_id": 44765256, "link": "https://stackoverflow.com/questions/44765256/go-unit-test-runs-from-appdata", "title": "go unit test runs from %APPDATA%", "body": "<p>I am trying to run some of my Go unit tests using \"go test\" but the test executable is built and run from my machine's %APPDATA%/local/temp directory. My PC has IT enforcement which blocks any unrecognized executable from being run other than from a pre-sanctioned directory (i.e C:/dev/projects\"). All my Go source code are in that directory, including my *_test.go files. Is there a way to tell the Go test module to build and run from the current directory?</p>\n"}, {"tags": ["go", "tcp", "server", "client"], "answers": [{"tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": true, "score": 2, "last_activity_date": 1498497532, "last_edit_date": 1498497532, "creation_date": 1498495794, "answer_id": 44764648, "question_id": 44764596, "link": "https://stackoverflow.com/questions/44764596/handle-multiple-network-clients/44764648#44764648", "title": "Handle multiple network clients", "body": "<p>You have a couple of issues. First, you want to accept your incoming connections <em>inside</em> your for loop. Then, you're likely going want to spawn off a goroutine to handle the requests coming in.:</p>\n\n<pre><code>for {\n    // Listen for an incoming connection.\n    conn, err := l.Accept()\n    if err != nil {\n        log.Println(\"Error accepting: \", err.Error())\n        continue\n    }\n\n    // Handle connections in a new goroutine.\n    go myHandler(conn)\n}\n</code></pre>\n\n<p>Resources:<br>\n<a href=\"https://tour.golang.org/concurrency\" rel=\"nofollow noreferrer\">https://tour.golang.org/concurrency</a></p>\n\n<p>GoPlay:<br>\n<a href=\"https://play.golang.org/p/7EovqNWJIx\" rel=\"nofollow noreferrer\">https://play.golang.org/p/7EovqNWJIx</a></p>\n"}], "owner": {"reputation": 175, "user_id": 7679359, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f520fabd06a63cff622926ad580f909d?s=128&d=identicon&r=PG&f=1", "display_name": "Simone Romani", "link": "https://stackoverflow.com/users/7679359/simone-romani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1990, "favorite_count": 1, "accepted_answer_id": 44764648, "answer_count": 1, "score": 1, "last_activity_date": 1498912983, "creation_date": 1498495600, "last_edit_date": 1498912983, "question_id": 44764596, "link": "https://stackoverflow.com/questions/44764596/handle-multiple-network-clients", "title": "Handle multiple network clients", "body": "<p>I have found a TCP Server and TCP Client written in go language. The problem is that the Server can't handle multiple clients and I don't know how to allow it.</p>\n\n<p><strong>Server:</strong></p>\n\n<pre><code>package main\n\nimport \"net\"\nimport \"fmt\"\nimport \"bufio\"\nimport \"strings\" // only needed below for sample processing\n\nfunc main() {\n\n  fmt.Println(\"Launching server...\")\n\n  // listen on all interfaces\n  ln, _ := net.Listen(\"tcp\", \":8081\")\n\n  // accept connection on port\n  conn, _ := ln.Accept()\n\n  // run loop forever (or until ctrl-c)\n  for {\n    // will listen for message to process ending in newline (\\n)\n    message, _ := bufio.NewReader(conn).ReadString('\\n')\n    // output message received\n    fmt.Print(\"Message Received:\", string(message))\n    // sample process for string received\n    newmessage := strings.ToUpper(message)\n    // send new string back to client\n    conn.Write([]byte(newmessage + \"\\n\"))\n  }\n}\n</code></pre>\n\n<p><strong>Client:</strong></p>\n\n<pre><code>package main\n\nimport \"net\"\nimport \"fmt\"\nimport \"bufio\"\nimport \"os\"\n\nfunc main() {\n\n  // connect to this socket\n  conn, _ := net.Dial(\"tcp\", \"127.0.0.1:8081\")\n  for { \n    // read in input from stdin\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Text to send: \")\n    text, _ := reader.ReadString('\\n')\n    // send to socket\n    fmt.Fprintf(conn, text + \"\\n\")\n    // listen for reply\n    message, _ := bufio.NewReader(conn).ReadString('\\n')\n    fmt.Print(\"Message from server: \"+message)\n  }\n}\n</code></pre>\n\n<p>Can anyone help me?</p>\n\n<p>Soruce: <a href=\"https://systembash.com/a-simple-go-tcp-server-and-tcp-client/\" rel=\"nofollow noreferrer\">https://systembash.com/a-simple-go-tcp-server-and-tcp-client/</a></p>\n"}, {"tags": ["go", "aws-sdk", "aws-sdk-go"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1498497485, "creation_date": 1498497485, "answer_id": 44765128, "question_id": 44764485, "link": "https://stackoverflow.com/questions/44764485/downloading-multiple-files-from-s3-concurrently-and-consolidated-them/44765128#44765128", "title": "Downloading multiple files from S3 concurrently and consolidated them", "body": "<p>This code:</p>\n\n<pre><code>lenghts3:= int64(len(buffer.Bytes()))\n</code></pre>\n\n<p>Is a concurrency problem: two routines may get the length at the same time, getting the same start position, and both proceed to write to the buffer with the same start position, stepping on each other's toes.</p>\n\n<p>Since you're already retrieving whole objects in memory and not streaming to the combined buffer, you may as well just send the full contents of each file on a channel, and have a receiver on that channel append each result to a shared byte buffer as they come in, synchronously.</p>\n"}], "owner": {"reputation": 23, "user_id": 8216557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e7d262b43c16330f6a482577795520f?s=128&d=identicon&r=PG&f=1", "display_name": "AthosPurple", "link": "https://stackoverflow.com/users/8216557/athospurple"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1548, "favorite_count": 0, "accepted_answer_id": 44765128, "answer_count": 1, "score": 2, "last_activity_date": 1498497485, "creation_date": 1498495163, "question_id": 44764485, "link": "https://stackoverflow.com/questions/44764485/downloading-multiple-files-from-s3-concurrently-and-consolidated-them", "title": "Downloading multiple files from S3 concurrently and consolidated them", "body": "<p>Im trying to download multiple files from S3 concurrently ,and consolidate their contents into a bytes buffer.The files are csv formatted. My code seems to work <em>most of time</em>(8 from 10 tries).But there are instances that after i inspected the consolidated buffer, I've got less that what i should be getting(usually no more than 100 rows missing). Total number of records expected is 4802. \nIf run my code sequentially this problem does not appear.But i need to use goroutines for the speed.This is a major requirement on what im trying to do.I have run the go data race inspector with no data races appear , and the error statements that i print never print out.</p>\n\n<p>This is the code i use:</p>\n\n<pre><code>    var pingsBuffer = aws.NewWriteAtBuffer([]byte{}) \n        //range over the contents of the index file\n    for _, file := range indexList {\n        wg.Add(1)\n        go download(key + string(file), pingsBuffer, &amp;wg)\n    }\n    wg.Wait()\n</code></pre>\n\n<p>and the download functions (that also consolidates the downloaded files)</p>\n\n<pre><code>func download(key string, buffer *aws.WriteAtBuffer, wg *sync.WaitGroup)  {\n\ndefer wg.Done()\n\nawsBuffer := aws.NewWriteAtBuffer([]byte{})\n\ninput := &amp;s3.GetObjectInput {\n    Bucket: aws.String(defaultLocationRootBucket),\n    Key:    aws.String(key),\n}\n\nn1, downloadError := downloader.Download(awsBuffer, input)\nif downloadError != nil {\n    loglib.Log(loglib.LevelError, applicationType, fmt.Sprintf(\"Failed to download from S3, file(%v) with error : %v.\", key, downloadError))\n    return\n}\n\n\nlenghts3:= int64(len(buffer.Bytes()))\n\nn2, bufferError := buffer.WriteAt(awsBuffer.Bytes(), lenghts3 )\nif bufferError != nil {\n    loglib.Log(loglib.LevelError, applicationType, fmt.Sprintf(\"Failed to write to buffer, the file(%v) downloaded from S3  with error : %v.\", key, bufferError))\n}\n</code></pre>\n"}, {"tags": ["go", "containers", "mount", "linux-namespaces"], "answers": [{"comments": [{"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "edited": false, "score": 1, "creation_date": 1501952920, "post_id": 45524409, "comment_id": 78008929, "body": "Which calls the <a href=\"http://man7.org/linux/man-pages/man2/mount.2.html\" rel=\"nofollow noreferrer\"><code>mount</code></a> syscall with <code>MS_PRIVATE|MS_REC</code> flags. This can be done <a href=\"https://golang.org/pkg/syscall/#Mount\" rel=\"nofollow noreferrer\">in Go</a> too."}, {"owner": {"reputation": 826, "user_id": 1253306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mUA0.png?s=128&g=1", "display_name": "Henrique Gontijo", "link": "https://stackoverflow.com/users/1253306/henrique-gontijo"}, "reply_to_user": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "edited": false, "score": 0, "creation_date": 1501977971, "post_id": 45524409, "comment_id": 78015064, "body": "That&#39;s correct @ephemient, here&#39;s one example: <code>syscall.Mount(&quot;&quot;, &quot;&#47;&quot;, &quot;&quot;, syscall.MS_PRIVATE|syscall.MS_REC, &quot;&quot;)</code>"}], "tags": [], "owner": {"reputation": 826, "user_id": 1253306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mUA0.png?s=128&g=1", "display_name": "Henrique Gontijo", "link": "https://stackoverflow.com/users/1253306/henrique-gontijo"}, "is_accepted": true, "score": 2, "last_activity_date": 1501952537, "creation_date": 1501952537, "answer_id": 45524409, "question_id": 44764400, "link": "https://stackoverflow.com/questions/44764400/containers-and-syscall-clone-newns/45524409#45524409", "title": "Containers and syscall.CLONE_NEWNS", "body": "<p>This issue could be solved by configuring the host machine mount to be private which <em>does not receive or forward any propagation events to other mounts</em>, vide  <a href=\"https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/sect-Using_the_mount_Command-Mounting-Bind.html\" rel=\"nofollow noreferrer\">RedHat - Sharing Mounts</a>.</p>\n\n<p>This command should be executed on your host machine before your create the container:</p>\n\n<pre><code>$ mount --make-rprivate /\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8124693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ade22156f69784644cd177ff94e151?s=128&d=identicon&r=PG&f=1", "display_name": "Michy_Arya", "link": "https://stackoverflow.com/users/8124693/michy-arya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "accepted_answer_id": 45524409, "answer_count": 1, "score": 3, "last_activity_date": 1501952537, "creation_date": 1498494824, "question_id": 44764400, "link": "https://stackoverflow.com/questions/44764400/containers-and-syscall-clone-newns", "title": "Containers and syscall.CLONE_NEWNS", "body": "<p>I'm running the golang code on this repo <a href=\"https://github.com/lizrice/containers-from-scratch/blob/master/main.go\" rel=\"nofollow noreferrer\">https://github.com/lizrice/containers-from-scratch/blob/master/main.go</a> and I'm having a problem with the mount namespace. What the code should do is creating a process within its own mount namespace. So if I run the code with <code>sudo go run main.go run /bin/bash</code> and I create a file inside the directory <code>mytemp</code>, I should be able to see that file from within the new started process, but if I try to view that file moving to the rootfs directory on the host, I shouldn't be able to see that file thanks to the mount namespace.\nUnfortunately I still see this file, so it seems that the process I run is not mount namespaced. \nTo run the code, I used this <a href=\"https://github.com/ericchiang/containers-from-scratch/releases/download/v0.1.0/rootfs.tar.gz\" rel=\"nofollow noreferrer\">https://github.com/ericchiang/containers-from-scratch/releases/download/v0.1.0/rootfs.tar.gz</a> as a rootfs and moved it under <code>/home/me</code>. Then I created a <code>mytemp</code> directory to use as the tmpfs mount target. \nDo you have any ideas about the reasons why the process doesn't get mount namespaced?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "compiler-errors", "compilation", "function-declaration"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1498496509, "post_id": 44763440, "comment_id": 76510732, "body": "The 20&#39;th duplicate."}], "answers": [{"comments": [{"owner": {"reputation": 354, "user_id": 5262104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64aa1e35a57e8869a5eb58466526530?s=128&d=identicon&r=PG&f=1", "display_name": "pkm", "link": "https://stackoverflow.com/users/5262104/pkm"}, "edited": false, "score": 1, "creation_date": 1498492301, "post_id": 44763544, "comment_id": 76508240, "body": "I see. Then is there some special flag/option used during <code>go build</code> to specify that the body is declared in assembly? Or how is it &quot;mapped&quot;?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 354, "user_id": 5262104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64aa1e35a57e8869a5eb58466526530?s=128&d=identicon&r=PG&f=1", "display_name": "pkm", "link": "https://stackoverflow.com/users/5262104/pkm"}, "edited": false, "score": 1, "creation_date": 1498492825, "post_id": 44763544, "comment_id": 76508584, "body": "It&#39;s mapped by name: notice that the names defined in assembly match those stubbed in the .go files."}, {"owner": {"reputation": 354, "user_id": 5262104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64aa1e35a57e8869a5eb58466526530?s=128&d=identicon&r=PG&f=1", "display_name": "pkm", "link": "https://stackoverflow.com/users/5262104/pkm"}, "edited": false, "score": 0, "creation_date": 1498493977, "post_id": 44763544, "comment_id": 76509338, "body": "ok, didn&#39;t know about go asm, thanks"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 5, "last_activity_date": 1498492782, "last_edit_date": 1498492782, "creation_date": 1498492005, "answer_id": 44763544, "question_id": 44763440, "link": "https://stackoverflow.com/questions/44763440/source-missing-function-body-how-is-it-compiling/44763544#44763544", "title": "Source missing function body, how is it compiling?", "body": "<p>It is defined in assembly for various architectures in the <code>*.s</code> files located in the same package.</p>\n\n<p>Per <a href=\"https://golang.org/ref/spec#Function_declarations\" rel=\"nofollow noreferrer\">the spec</a>:</p>\n\n<blockquote>\n  <p>A function declaration may omit the body. Such a declaration provides the signature for a function implemented outside Go, such as an assembly routine.</p>\n</blockquote>\n"}], "owner": {"reputation": 354, "user_id": 5262104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64aa1e35a57e8869a5eb58466526530?s=128&d=identicon&r=PG&f=1", "display_name": "pkm", "link": "https://stackoverflow.com/users/5262104/pkm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1770, "favorite_count": 0, "closed_date": 1499094109, "accepted_answer_id": 44763544, "answer_count": 1, "score": 3, "last_activity_date": 1498913464, "creation_date": 1498491675, "last_edit_date": 1498913464, "question_id": 44763440, "link": "https://stackoverflow.com/questions/44763440/source-missing-function-body-how-is-it-compiling", "closed_reason": "Duplicate", "title": "Source missing function body, how is it compiling?", "body": "<p>In the Go lang source code, I see a function declared without any body. \n<a href=\"https://github.com/golang/go/blob/master/src/math/log10.go#L9\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/math/log10.go#L9</a></p>\n\n<pre class=\"lang-go prettyprint-override\"><code>func Log10(x float64) float64\n</code></pre>\n\n<p>But when I do the same it gives me an error: missing function body for __</p>\n\n<p><a href=\"https://play.golang.org/p/Ncp-0-8vHB\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Ncp-0-8vHB</a></p>\n\n<p>How is this working in the Go source code? I mean how is the math package compiling? Is this source file just for documentation purposes? </p>\n\n<p>It seems like Log10 is a public/exposed version of log10, but there is no \"getter\" convention or anything like that in the language, so where is the body of Log10 declared???</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1498540193, "post_id": 44762773, "comment_id": 76525681, "body": "For sending mail (as opposed to learning <code>net&#47;http</code>) you might want Mailgun&#39;s Go SDK: <a href=\"https://github.com/mailgun/mailgun-go\" rel=\"nofollow noreferrer\">github.com/mailgun/mailgun-go</a>"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1498544663, "post_id": 44762773, "comment_id": 76527343, "body": "@twotwotwo yeah thanks, I saw the package before, but I felt like it would be good to learn how to convert the curl command both because of future use but also because the package seems to ask for different info"}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1498539926, "post_id": 44768955, "comment_id": 76525606, "body": "I updated the code based on your comment, could you please take a look?"}], "tags": [], "owner": {"reputation": 397, "user_id": 1786696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d5d7f7b5ba1ec7e25ed0519f7cb58c2?s=128&d=identicon&r=PG", "display_name": "Fulldump", "link": "https://stackoverflow.com/users/1786696/fulldump"}, "is_accepted": false, "score": 1, "last_activity_date": 1498512399, "creation_date": 1498512399, "answer_id": 44768955, "question_id": 44762773, "link": "https://stackoverflow.com/questions/44762773/converting-curl-f-to-golang/44768955#44768955", "title": "Converting curl -F to golang", "body": "<p>Option <code>-F</code> send a multipart field according to CURL documentation:</p>\n\n<p><code>\n -F, --form CONTENT  Specify HTTP multipart POST data (H)\n</code></p>\n\n<p>This can help you: <a href=\"https://stackoverflow.com/a/20397167/1786696\">https://stackoverflow.com/a/20397167/1786696</a></p>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 1, "closed_date": 1498913395, "answer_count": 1, "score": -1, "last_activity_date": 1498539904, "creation_date": 1498489528, "last_edit_date": 1498539904, "question_id": 44762773, "link": "https://stackoverflow.com/questions/44762773/converting-curl-f-to-golang", "closed_reason": "Duplicate", "title": "Converting curl -F to golang", "body": "<p>I'm trying to convert the mailgun curl command for sending email to golang. This is the original curl:</p>\n\n<pre><code>curl -s --user 'api:key-3ax6xnjp29jd6fds4gc373sgvjxteol0' \\ \nhttps://api.mailgun.net/v3/samples.mailgun.org/messages \\\n -F from='Excited User &lt;excited@samples.mailgun.org&gt;' \\\n -F to='devs@mailgun.net' \\\n -F subject='Hello' \\\n -F text='Testing some Mailgun awesomeness!'\n</code></pre>\n\n<p>Updated code:</p>\n\n<pre><code>    var b bytes.Buffer\n    w := multipart.NewWriter(&amp;b)\n    fw, err := w.CreateFormField(\"from\")\n    if err != nil {\n        log.Println(err)\n    }\n    _, err = fw.Write([]byte(\"Excited User &lt;excited@samples.mailgun.org&gt;\"))\n    if err != nil {\n        log.Println(err)\n    }\n\n    fw, err = w.CreateFormField(\"to\")\n    if err != nil {\n        log.Println(err)\n    }\n    _, err = fw.Write([]byte(\"devs@mailgun.net\"))\n    if err != nil {\n        log.Println(err)\n    }\n\n    fw, err = w.CreateFormField(\"subject\")\n    if err != nil {\n        log.Println(err)\n    }\n    _, err = fw.Write([]byte(\"Hello\"))\n    if err != nil {\n        log.Println(err)\n    }\n\n    fw, err = w.CreateFormField(\"text\")\n    if err != nil {\n        log.Println(err)\n    }\n    _, err = fw.Write([]byte(\"Testing some Mailgun awesomeness!\"))\n    if err != nil {\n        log.Println(err)\n    }\n\n    w.Close()\n\n    req, err := http.NewRequest(\"POST\", \"https://api.mailgun.net/v3/samples.mailgun.org/messages\", &amp;b)\n    if err != nil {\n        log.Println(err)\n    }\n    req.SetBasicAuth(\"api\", \"key-3ax6xnjp29jd6fds4gc373sgvjxteol0\")\n\n    req.Header.Add(\"Content-Type\", w.FormDataContentType())\n    // req.Header.Add(\"Content-Type\", \"application/x-www-form-urlencoded\")\n\n    resp, err := http.DefaultClient.Do(req)\n    if err != nil {\n        log.Println(err)\n    }\n    defer resp.Body.Close()\n\n    fmt.Printf(\"Resp: %s\\n\", resp)\n</code></pre>\n\n<p>I have of course changed <code>api:key-3ax6xnjp29jd6fds4gc373sgvjxteol0</code>, <code>https://api.mailgun.net/v3/samples.mailgun.org/messages</code> and <code>devs@mailgun.net</code> to my own API and email address, but it doesn't seem to  work..</p>\n\n<p>Could someone please take a look to see what I might be doing wrong?</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1498485127, "post_id": 44760753, "comment_id": 76503435, "body": "Read <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a> and <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">blog.golang.org/slices</a> and take the Tour of Go from <a href=\"https://tour.golang.org/moretypes/7\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/7</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8215736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4790e81eed96c49578706d48d1951e9?s=128&d=identicon&r=PG&f=1", "display_name": "\u8fdf\u55bb\u5929", "link": "https://stackoverflow.com/users/8215736/%e8%bf%9f%e5%96%bb%e5%a4%a9"}, "edited": false, "score": 0, "creation_date": 1498552008, "post_id": 44764175, "comment_id": 76531480, "body": "thank you for answer me this question,but I have found the reason about it."}, {"owner": {"reputation": 19, "user_id": 8215736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4790e81eed96c49578706d48d1951e9?s=128&d=identicon&r=PG&f=1", "display_name": "\u8fdf\u55bb\u5929", "link": "https://stackoverflow.com/users/8215736/%e8%bf%9f%e5%96%bb%e5%a4%a9"}, "edited": false, "score": 0, "creation_date": 1498552133, "post_id": 44764175, "comment_id": 76531555, "body": "func Pingpong(s *[]int){ \tfmt.Printf(&quot;len:%v,cap:%v,address:%p\\n&quot;,len(*s),cap(*s),s) \ts=append(s,3) \tfmt.Printf(&quot;len:%v,cap:%v,address:%p\\n&quot;,len(*s),cap(*s),s) }"}], "tags": [], "owner": {"reputation": 1511, "user_id": 495504, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ee8d8278b0394be64c52abc8d7c4ca17?s=128&d=identicon&r=PG", "display_name": "Eric Pauley", "link": "https://stackoverflow.com/users/495504/eric-pauley"}, "is_accepted": false, "score": 0, "last_activity_date": 1498494057, "creation_date": 1498494057, "answer_id": 44764175, "question_id": 44760753, "link": "https://stackoverflow.com/questions/44760753/how-can-i-change-a-slice-in-the-function-without-return/44764175#44764175", "title": "How can I change a slice in the function without return?", "body": "<p>Notice how whenever you append to a slice in go, <code>append</code> returns a new slice. This is because slices are backed by a fixed-size array, and multiple slices can be backed by the same array. In this case, append needs to return a new slice because the backing array may have changed. (For example creating a larger backing array to fit new items)</p>\n\n<p>Your method is very similar to <code>append</code>, and it has the same limitations. You'll need to return the new slice descriptor any time you modify the bounds. Basically any time you set your slice equal to something else, either by using append or taking a subslice, you have to return the new descriptor you made.</p>\n"}], "owner": {"reputation": 19, "user_id": 8215736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4790e81eed96c49578706d48d1951e9?s=128&d=identicon&r=PG&f=1", "display_name": "\u8fdf\u55bb\u5929", "link": "https://stackoverflow.com/users/8215736/%e8%bf%9f%e5%96%bb%e5%a4%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1498913344, "creation_date": 1498483258, "last_edit_date": 1498913344, "question_id": 44760753, "link": "https://stackoverflow.com/questions/44760753/how-can-i-change-a-slice-in-the-function-without-return", "title": "How can I change a slice in the function without return?", "body": "<p>my code like this</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n)\n\nfunc Pingpong(s []int){\n    fmt.Printf(\"len:%v,cap:%v,address:%p\\n\",len(s),cap(s),s)\n    s=append(s,3)\n    fmt.Printf(\"len:%v,cap:%v,address:%p\\n\",len(s),cap(s),s)\n}\nfunc main(){\n    s:=make([]int,1,2)\n    fmt.Printf(\"value:%v,len:%v,cap:%v,address:%p\\n\",s[0],len(s),cap(s),s)\n    Pingpong(s)\n    fmt.Printf(\"value:%v,len:%v,cap:%v,address:%p\\n\",s[0],len(s),cap(s),s)\n}\n</code></pre>\n\n<p>the answer like this</p>\n\n<pre><code>value:0,len:1,cap:2,address:0x1040a128\nlen:1,cap:2,address:0x1040a128\nlen:2,cap:2,address:0x1040a128\nvalue:0,len:1,cap:2,address:0x1040a128\n</code></pre>\n\n<p>Why? Could you please tell me the reason?</p>\n"}, {"tags": ["go", "pipe"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1498479219, "creation_date": 1498479219, "answer_id": 44759462, "question_id": 44759185, "link": "https://stackoverflow.com/questions/44759185/wrap-io-pipereader-to-store-progress/44759462#44759462", "title": "Wrap io.PipeReader to store progress", "body": "<p>As the error describes, you are trying to store a <code>*io.PipeReader</code> value in a <code>io.PipeReader</code> field. You can fix this by updating your struct definition to the correct type:</p>\n\n<pre><code>type ProgressPipeReader struct {\n        *io.PipeReader\n        progress int64\n}\n</code></pre>\n"}], "owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 1, "accepted_answer_id": 44759462, "answer_count": 1, "score": 2, "last_activity_date": 1498480718, "creation_date": 1498478216, "last_edit_date": 1498480718, "question_id": 44759185, "link": "https://stackoverflow.com/questions/44759185/wrap-io-pipereader-to-store-progress", "title": "Wrap io.PipeReader to store progress", "body": "<p>I would like to keep track of the progress in an <code>io.Pipe</code>. I came up with the following struct <code>ProgressPipeReader</code> which wraps <code>io.PipeReader</code>, storing the progress in bytes inside <code>ProgressPipeReader.progress</code>:</p>\n\n<pre><code>type ProgressPipeReader struct {\n        io.PipeReader\n        progress int64\n}\n\nfunc (pr *ProgressPipeReader) Read(data []byte) (int, error) {\n        n, err := pr.PipeReader.Read(data)\n\n        if err == nil {\n                pr.progress += int64(n)\n        }\n\n        return n, err\n}\n</code></pre>\n\n<p>Unfortunately, I can't seem to use it to wrap an <code>io.PipeReader</code>. The following snippet</p>\n\n<pre><code>pr, pw := io.Pipe()\npr = &amp;ProgressPipeReader{PipeReader: pr}\n</code></pre>\n\n<p>yields the error</p>\n\n<pre><code>cannot use pr (type *io.PipeReader) as type io.PipeReader in field value\n</code></pre>\n\n<p>Any hints?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 41, "user_id": 2413523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b9cc35d7a1c4463e21f601d654ef4e?s=128&d=identicon&r=PG", "display_name": "rocoder", "link": "https://stackoverflow.com/users/2413523/rocoder"}, "edited": false, "score": 0, "creation_date": 1498482892, "post_id": 44759016, "comment_id": 76501898, "body": "I did found  a solution to keep all those resources in the database, and not to import them."}, {"owner": {"reputation": 8533, "user_id": 11792, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/057dba7b6fe7b933e5ee23f7dc64dcb5?s=128&d=identicon&r=PG", "display_name": "Pavel Nikolov", "link": "https://stackoverflow.com/users/11792/pavel-nikolov"}, "edited": false, "score": 1, "creation_date": 1498486906, "post_id": 44759016, "comment_id": 76504624, "body": "This doesn&#39;t sound like an idiomatic Go app... Go supports plugins, that you can import at runtime, but I&#39;m not sure if this is what you need."}, {"owner": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "edited": false, "score": 0, "creation_date": 1595612364, "post_id": 44759016, "comment_id": 111545516, "body": "There might be a good reason for this question: imagine that you have a CLI which has a parameter which will determine if you are going to use a CGo wrapper to a system library (which may not exist for a particular architecture/operating system) and fallback to a pure Go library instead (which might be slower/limited)."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 2413523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b9cc35d7a1c4463e21f601d654ef4e?s=128&d=identicon&r=PG", "display_name": "rocoder", "link": "https://stackoverflow.com/users/2413523/rocoder"}, "edited": false, "score": 0, "creation_date": 1498480805, "post_id": 44759792, "comment_id": 76500456, "body": "I am trying to build a &quot;mini-cms&quot; in which i want to include basic models like user, logging and handlers associated with them etc. When importing this &quot;cms&quot; in another application, i want to be able to add to those models and handlers.  So what i did try is to import in the &quot;mini-cms&quot; some package from the application, but only if the application exist.I already have strong doubts that this approach will work, but i am trying to figure it  how this should work"}, {"owner": {"reputation": 8533, "user_id": 11792, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/057dba7b6fe7b933e5ee23f7dc64dcb5?s=128&d=identicon&r=PG", "display_name": "Pavel Nikolov", "link": "https://stackoverflow.com/users/11792/pavel-nikolov"}, "reply_to_user": {"reputation": 41, "user_id": 2413523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b9cc35d7a1c4463e21f601d654ef4e?s=128&d=identicon&r=PG", "display_name": "rocoder", "link": "https://stackoverflow.com/users/2413523/rocoder"}, "edited": false, "score": 1, "creation_date": 1498486725, "post_id": 44759792, "comment_id": 76504499, "body": "My advise to you would be - design your Go package (library) with abstractions (interfaces). So design your functions and methods to accept simple interfaces (preferably with one or two methods only) and return either interfaces or structs. This way, when an application imports your package, it will be able to use a custom implementation of the interfaces (for example for logging, tracing or metrics etc.) The library needs to be application-agnostic so for example if you construct an object which expects a <code>Logger</code> interface and the application hasn&#39;t provided one - use a NoOp logger."}], "tags": [], "owner": {"reputation": 8533, "user_id": 11792, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/057dba7b6fe7b933e5ee23f7dc64dcb5?s=128&d=identicon&r=PG", "display_name": "Pavel Nikolov", "link": "https://stackoverflow.com/users/11792/pavel-nikolov"}, "is_accepted": true, "score": 5, "last_activity_date": 1498480226, "creation_date": 1498480226, "answer_id": 44759792, "question_id": 44759016, "link": "https://stackoverflow.com/questions/44759016/conditional-imports-golang/44759792#44759792", "title": "Conditional imports golang", "body": "<p>This is not possible with Go. As a statically compiled language you can only compile a binary if all its dependencies exist.\nCan you give us some more details on why you need this in the first place? Maybe there is a simpler or more idiomatic way to achieve your idea.</p>\n"}], "owner": {"reputation": 41, "user_id": 2413523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b9cc35d7a1c4463e21f601d654ef4e?s=128&d=identicon&r=PG", "display_name": "rocoder", "link": "https://stackoverflow.com/users/2413523/rocoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2852, "favorite_count": 0, "accepted_answer_id": 44759792, "answer_count": 1, "score": 0, "last_activity_date": 1498480226, "creation_date": 1498477597, "question_id": 44759016, "link": "https://stackoverflow.com/questions/44759016/conditional-imports-golang", "title": "Conditional imports golang", "body": "<p>I am quite new with Go, and I am struggling to import a package only if it exists. Is there a way to do this? I tried with \"_\" before the package name, but if the package does not exist the program won't compile. I am aware that I could be on the wrong road, but how else should I treat this case in which I want to import a package only if it exists?</p>\n"}, {"tags": ["go", "types"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1498475002, "creation_date": 1498475002, "answer_id": 44758256, "question_id": 44758146, "link": "https://stackoverflow.com/questions/44758146/allow-only-values-from-const-group-in-go/44758256#44758256", "title": "Allow only values from const group in Go", "body": "<blockquote>\n  <p>So, is there any way to define a function that only allows one of the 3 defined constants?</p>\n</blockquote>\n\n<p>No there is not.</p>\n\n<p>Well, you could do ugly hacks with e.g. function or interface types, but that's not worth the effort.</p>\n"}], "owner": {"reputation": 1671, "user_id": 325358, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/eb58709dc08423fc567de3a3225b23c9?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/325358/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "closed_date": 1498475456, "answer_count": 1, "score": 1, "last_activity_date": 1498475002, "creation_date": 1498474574, "question_id": 44758146, "link": "https://stackoverflow.com/questions/44758146/allow-only-values-from-const-group-in-go", "closed_reason": "Duplicate", "title": "Allow only values from const group in Go", "body": "<p>Let's say I have a function that takes as an argument an <code>int</code>. I want this function to only accept values 0, 1 or 2. And it would be great if I didn't have to check this manually and return an <code>error</code>, or handle other values from within the function, but instead check it at compile time to avoid undesirable errors.</p>\n\n<pre><code>// should only accept 0, 1 or 2\nfunc foo(bar int) {\n    fmt.Println(bar)\n}\n</code></pre>\n\n<p>Now in order to do this, I defined my own type and 3 constant values for it:</p>\n\n<pre><code>type MyType int\n\nconst (\n    Zero MyType = iota\n    One\n    Two\n)\n</code></pre>\n\n<p>Now I can modify my function to accept a MyType instead of an int:</p>\n\n<pre><code>func foo(bar MyType) {\n    fmt.Println(bar)\n}\n</code></pre>\n\n<p>And I can call it with any of the three constants:</p>\n\n<pre><code>foo(Zero) // would print 0\nfoo(One)  // would print 1\nfoo(Two)  // would print 2\n</code></pre>\n\n<p>And also, it <em>can't</em> be called with an <code>int</code> instead of a <code>MyType</code></p>\n\n<pre><code>i := 5\nfoo(i) // errors\n</code></pre>\n\n<p>It returns the following error at compile time: <code>cannot use i (type int) as type MyType in argument to foo</code>. Which is actually what I want. BUT! The function can still be called like:</p>\n\n<pre><code>foo(5) // works and prints 5\n</code></pre>\n\n<p>Because it infers the type from the argument (which is MyType which is actually an int) so when passing an untyped argument it converts it automatically to MyType.</p>\n\n<p>So, is there any way to define a function that only allows one of the 3 defined constants?</p>\n"}, {"tags": ["bash", "sockets", "go", "git-bash"], "comments": [{"owner": {"reputation": 1659, "user_id": 302646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYT9J.png?s=128&g=1", "display_name": "Makkes", "link": "https://stackoverflow.com/users/302646/makkes"}, "edited": false, "score": 0, "creation_date": 1498479642, "post_id": 44757994, "comment_id": 76499720, "body": "Without seeing your code it is very hard to help you out. Please post the code that you are experiencing problems with."}, {"owner": {"reputation": 873, "user_id": 5303460, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7370b6d79ff8a15cedc2c69fc9c71e3b?s=128&d=identicon&r=PG", "display_name": "Tural Asgar", "link": "https://stackoverflow.com/users/5303460/tural-asgar"}, "reply_to_user": {"reputation": 1659, "user_id": 302646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYT9J.png?s=128&g=1", "display_name": "Makkes", "link": "https://stackoverflow.com/users/302646/makkes"}, "edited": false, "score": 0, "creation_date": 1498481730, "post_id": 44757994, "comment_id": 76501105, "body": "But it has nothing to do with my code. This is the same code. I haven&#39;t changed it since beginning."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1498483100, "post_id": 44757994, "comment_id": 76502041, "body": "@Tural\u018fsg\u0259rov: Stop using <code>go run</code>, then compile and execute your code normally. Something you&#39;ve changed is preventing the child process from getting a signal or being interrupted leaving it running, but you can easily avoid the situation altogether."}, {"owner": {"reputation": 873, "user_id": 5303460, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7370b6d79ff8a15cedc2c69fc9c71e3b?s=128&d=identicon&r=PG", "display_name": "Tural Asgar", "link": "https://stackoverflow.com/users/5303460/tural-asgar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498602523, "post_id": 44757994, "comment_id": 76562670, "body": "@JimB But I don&#39;t want to build every time. <code>Go run</code> works very well for me."}], "owner": {"reputation": 873, "user_id": 5303460, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7370b6d79ff8a15cedc2c69fc9c71e3b?s=128&d=identicon&r=PG", "display_name": "Tural Asgar", "link": "https://stackoverflow.com/users/5303460/tural-asgar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 491, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498918798, "creation_date": 1498474070, "last_edit_date": 1498918798, "question_id": 44757994, "link": "https://stackoverflow.com/questions/44757994/error-only-one-usage-of-each-socket-address-is-normally-permitted", "title": "Error: Only one usage of each socket address is normally permitted", "body": "<p>I have been using Go/Golang for a while. Every time I need to compile code I simply type <code>go run *.go</code> into Git bash. When I needed to terminate I used <code>CTRL+C</code>. And if I need to compile again I would use the same command <code>go run *.go</code>. Recently for some reason when I press <code>CTRL+C</code> it shows as if it terminated,but when I write again <code>go run *.go</code> it complains by saying <code>Only one usage of each socket address (protocol/network address/port) is normally permitted.\n</code>. And I open task manager and see on <code>main.exe</code> is on background processes. I end by hand and call this again it works. How can fix that so it terminates as before when I click on <code>CTRL+C</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498469000, "post_id": 44756288, "comment_id": 76493793, "body": "Speculation: Any build tags in daemon_darwin.go which disable its compilation?"}, {"owner": {"reputation": 23399, "user_id": 1073131, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0ec40b4e0db5b64fc2c7e5901216f318?s=128&d=identicon&r=PG", "display_name": "Shai", "link": "https://stackoverflow.com/users/1073131/shai"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498469096, "post_id": 44756288, "comment_id": 76493848, "body": "@Volker nope. I think this is disabled on the golang linux go distribution. I tried adding ./daemon_darwin.go manually to the compile command and I got en error, which makes me think this is disabled on purpose."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1498471774, "post_id": 44756288, "comment_id": 76495335, "body": "The <code>_darwin.go</code> uses <code>cgo</code>. You can&#39;t simply cross-compiles without installing the needed toolchain."}, {"owner": {"reputation": 23399, "user_id": 1073131, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0ec40b4e0db5b64fc2c7e5901216f318?s=128&d=identicon&r=PG", "display_name": "Shai", "link": "https://stackoverflow.com/users/1073131/shai"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1498471900, "post_id": 44756288, "comment_id": 76495396, "body": "@putu got it. I just used an osx slave instead :| thanks!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1498472046, "post_id": 44756288, "comment_id": 76495477, "body": "This is not disabled on linux, and it works for me with a trivial example. We need more info from your files. Does <code>daemon_darwin.go</code> has the same package declaration as other .go files in the same folder?"}, {"owner": {"reputation": 23399, "user_id": 1073131, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0ec40b4e0db5b64fc2c7e5901216f318?s=128&d=identicon&r=PG", "display_name": "Shai", "link": "https://stackoverflow.com/users/1073131/shai"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1498472094, "post_id": 44756288, "comment_id": 76495496, "body": "@icza - I&#39;m just trying to compile a darwin binary on ubuntu of github.com/VividCortex/godaemon"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1498472534, "post_id": 44756288, "comment_id": 76495730, "body": "@Shai The darwin implementation of that specific package calls a function implemented in C, so you need cgo as mentioned by putu. You are able to compile it for windows, because the windows implementation does not call a C function (it&#39;s pure Go)."}], "owner": {"reputation": 23399, "user_id": 1073131, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0ec40b4e0db5b64fc2c7e5901216f318?s=128&d=identicon&r=PG", "display_name": "Shai", "link": "https://stackoverflow.com/users/1073131/shai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498468377, "creation_date": 1498468064, "last_edit_date": 1498468377, "question_id": 44756288, "link": "https://stackoverflow.com/questions/44756288/build-does-not-include-source-with-file-suffix", "title": "Build does not include source with file suffix", "body": "<p>Compiling under ubuntu</p>\n\n<blockquote>\n  <p>Linux ip 3.13.0-48-generic #80-Ubuntu SMP Thu Mar 12 11:16:15 UTC 2015\n  x86_64 x86_64 x86_64 GNU/Linux</p>\n</blockquote>\n\n<p>with golang version</p>\n\n<blockquote>\n  <p>go version go1.8.3 linux/amd64</p>\n</blockquote>\n\n<p>The files I have:</p>\n\n<blockquote>\n  <p>daemon_darwin.go  daemon_freebsd.go  daemon.go    daemon_linux.go \n  daemon_windows.go  LICENSE  os.go  README.md</p>\n</blockquote>\n\n<p>The command I'm executing</p>\n\n<pre><code>GOOS=darwin GOARCH=amd64 go build -x\n</code></pre>\n\n<p>The output I'm getting</p>\n\n<pre><code>WORK=/tmp/go-build026556308 mkdir -p\n$WORK/github.com/VividCortex/godaemon/_obj/ mkdir -p\n$WORK/github.com/VividCortex/ cd\n/root/go/src/github.com/VividCortex/godaemon\n/home/jenkinsBuilder/tools/org.jenkinsci.plugins.golang.GolangInstallation/Go_1.8/pkg/tool/linux_amd64/compile\n-o $WORK/github.com/VividCortex/godaemon.a -trimpath $WORK -p github.com/VividCortex/godaemon -complete -buildid\n398bd35cdb7ed0aa42a3e6ea64677925441c29cb -D\n_/root/go/src/github.com/VividCortex/godaemon -I $WORK -pack ./daemon.go ./os.go\n# github.com/VividCortex/godaemon ./daemon.go:167: undefined: GetExecutablePath\n</code></pre>\n\n<p>we can see that daemon_darwin.go is <strong>not</strong> being included in the compile command, although I've added <code>GOOS=darwin</code></p>\n\n<p>If I try using <code>GOOS=windows</code>, it builds correctly, and daemon_windows.go is being added </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 4, "last_activity_date": 1498467406, "creation_date": 1498467406, "answer_id": 44756120, "question_id": 44755921, "link": "https://stackoverflow.com/questions/44755921/how-to-move-data-from-one-slice-of-structs-to-another/44756120#44756120", "title": "How to move data from one slice of structs to another?", "body": "<p>First, your code is invalid.  You need a valid array expression for your <code>aData</code> declaration, and you need to specify the type when assigning to <code>bData</code>.</p>\n\n<pre><code>aData := []A{{\"bob\", 3, 4}, {\"mary\", 5, 2}}\nbData := make([]B, len(aData))\n\nfor i, aItem := range aData {\n    bData[i] = B{\n        Field1: aItem.Field1,\n        Field2: aItem.Field2,\n    }\n}\n</code></pre>\n\n<p>So aside from your syntax errors, this is more idiomatic because:</p>\n\n<ol>\n<li>It uses <code>range</code> instead of a <code>for</code> loop, which is perfect for iterating over an array, and more readable.</li>\n<li><code>bData</code> is preallocated to the exact size needed.</li>\n<li>Field names are specified in the declaration of <code>bData</code>'s values.  It would be more idiomatic to do the same for <code>aData</code> as well, but it gets a bit verbose.</li>\n</ol>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 44756120, "answer_count": 1, "score": 0, "last_activity_date": 1498467406, "creation_date": 1498466737, "question_id": 44755921, "link": "https://stackoverflow.com/questions/44755921/how-to-move-data-from-one-slice-of-structs-to-another", "title": "How to move data from one slice of structs to another?", "body": "<p>I have two structs:</p>\n\n<pre><code>type A struct {\n    Field1 string\n    Field2 int\n    Field3 int\n}\ntype B struct {\n    Field1 string\n    Field2 int\n}\n</code></pre>\n\n<p>I want to convert a slice of []A data(<code>aData</code>) to a slice of []B data (<code>bData</code>).</p>\n\n<p>What is the idiomatic way to do so?</p>\n\n<p>What I tried is <a href=\"https://play.golang.org/p/Q0ZXEba4N5\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<pre><code>var newItem B\nvar aData []A   \nvar bData []B\n\n\naData = [{\"bob\", 3, 4}, {\"mary\", 5, 2}] \n\n\nfor i:=0 ; i &lt; len(aData); i++ {\n\n    newItem = {aData[i].Field1, aData[i].Field2}\n    bData = append( bData, newItem )\n}\n</code></pre>\n\n<p>But it gives:</p>\n\n<blockquote>\n  <p>syntax error: missing operand</p>\n</blockquote>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "edited": false, "score": 0, "creation_date": 1498464147, "post_id": 44755089, "comment_id": 76491292, "body": "The only way to make custom behaviour is creating custom marshaller that implements <code>json.Marshaler</code>"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 3, "last_activity_date": 1498464625, "creation_date": 1498464625, "answer_id": 44755418, "question_id": 44755089, "link": "https://stackoverflow.com/questions/44755089/does-serialized-content-strictly-follow-the-order-in-definition-use-encoding-jso/44755418#44755418", "title": "Does serialized content strictly follow the order in definition use encoding/json package?", "body": "<blockquote>\n  <p>Does the serialized field content strictly follow the order in the struct definition?</p>\n</blockquote>\n\n<p>No.  There is no guarantee of this. In practice, while it may be true for many data types, such as structs, it will certainly not be true for maps, and one should never depend on the order remaining the same, as implementation details can change between Go versions or even Go compilers, and if you assume consistent ordering in such cases, you could introduce bugs.</p>\n\n<p>If ordering is important for your specific data types, you can implement a custom <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow noreferrer\"><code>json.Marshaler</code></a> that preserves order.</p>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 4, "last_activity_date": 1498464952, "creation_date": 1498464952, "answer_id": 44755496, "question_id": 44755089, "link": "https://stackoverflow.com/questions/44755089/does-serialized-content-strictly-follow-the-order-in-definition-use-encoding-jso/44755496#44755496", "title": "Does serialized content strictly follow the order in definition use encoding/json package?", "body": "<p>The current implementation is deterministic, e.g. for structs see <a href=\"https://golang.org/src/encoding/json/encode.go#L629\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/json/encode.go#L629</a> which gives struct order (and maps are by sorted keys).</p>\n\n<p>But as this is <em>not</em> guaranteed by the documentation you should consider this an implementation detail.</p>\n\n<p>If you want to hash the output you'll face more problems, e.g. there are several equivalent representations of characters in strings and JSON has no notion of an int (floats only). It really depends on what you try to do wirh that hash.</p>\n"}], "owner": {"reputation": 165, "user_id": 5742303, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FtDe4q8R6Jw/AAAAAAAAAAI/AAAAAAAAAA4/-0OmJAJB7tI/photo.jpg?sz=128", "display_name": "rong jialei", "link": "https://stackoverflow.com/users/5742303/rong-jialei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 44755496, "answer_count": 2, "score": 3, "last_activity_date": 1498464952, "creation_date": 1498463242, "last_edit_date": 1498464581, "question_id": 44755089, "link": "https://stackoverflow.com/questions/44755089/does-serialized-content-strictly-follow-the-order-in-definition-use-encoding-jso", "title": "Does serialized content strictly follow the order in definition use encoding/json package?", "body": "<p>I use <code>encoding/json</code>to serialize struct. I'm confused about the output of <code>json.Marshal</code> function. Does the serialized field content strictly follow the order in the struct definition?</p>\n\n<p>e.g. Here is a struct definition</p>\n\n<pre><code>type MyStruct struct {\n    Field1  string\n    Field2  string\n}\n</code></pre>\n\n<p>could the output be <code>{\"Field2\":\"field2\",\"Field1\":\"field1\"}</code>? Since if the output struct fields out of order, the hash of the serialized content will be uncertain. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 318, "user_id": 3310317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1490518186/picture?type=large", "display_name": "SparklingWater", "link": "https://stackoverflow.com/users/3310317/sparklingwater"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1498459343, "post_id": 44754171, "comment_id": 76489277, "body": "<a href=\"https://api.deutschebahn.com/freeplan/v1/journeyDetails/356418%252F128592%252F57070%252F90271%252F80%253fstation_evaId%253D8000261\" rel=\"nofollow noreferrer\">api.deutschebahn.com/freeplan/v1/journeyDetails/&hellip;</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1498459432, "post_id": 44754171, "comment_id": 76489313, "body": "So it&#39;s actually part of the URL path that has the encoded elements. Why is it problematic for you to have it decoded? What is your end-goal?"}, {"owner": {"reputation": 318, "user_id": 3310317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1490518186/picture?type=large", "display_name": "SparklingWater", "link": "https://stackoverflow.com/users/3310317/sparklingwater"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1498459551, "post_id": 44754171, "comment_id": 76489352, "body": "because the request that is made is something like this: 1/journeyDetails/244815/84952/449280/143035/80?station_evaId&zwnj;&#8203;=8098160 for a url string containing this part  244815%2F84952%2F449280%2F143035%2F80%3fstation_evaId%3D8098&zwnj;&#8203;160  This just leaves me with incorrect requests unfortunately."}], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 3310317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1490518186/picture?type=large", "display_name": "SparklingWater", "link": "https://stackoverflow.com/users/3310317/sparklingwater"}, "edited": false, "score": 0, "creation_date": 1498461482, "post_id": 44754374, "comment_id": 76490171, "body": "This led me to solve the issue quickly, but setting Url.RawPath did not work for me. Instead, I used  the QueryEscape(s string) function to escape that part of the url."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 318, "user_id": 3310317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1490518186/picture?type=large", "display_name": "SparklingWater", "link": "https://stackoverflow.com/users/3310317/sparklingwater"}, "edited": false, "score": 0, "creation_date": 1498461919, "post_id": 44754374, "comment_id": 76490338, "body": "@SparklingWater: Although that may &quot;work&quot; for your case, that&#39;s not the correct solution; QueryEscape follows different rules than path escaping.  At minimum, you should use <code>PathEscape()</code> instead. For a proper solution, it would be good to see your actual code, to see how your request is being used."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1498459886, "last_edit_date": 1592644375, "creation_date": 1498459886, "answer_id": 44754374, "question_id": 44754171, "link": "https://stackoverflow.com/questions/44754171/http-newrequest-decoding-my-url-input/44754374#44754374", "title": "http.NewRequest() decoding my URL input", "body": "<p>Explicitly set the <code>RawPath</code> field of the URL struct:</p>\n<pre><code>req := http.NewRequest(&quot;GET&quot;, &quot;https://api.deutschebahn.com/freeplan/v1/journeyDetails/356418%252F128592%252F57070%252F90271%252F80%253fstation_evaId%253D8000261&quot;, nil)\nreq.URL.RawPath = &quot;/freeplan/v1/journeyDetails/356418%252F128592%252F57070%252F90271%252F80%253fstation_evaId%253D8000261&quot;\n</code></pre>\n<p>This functionality is <a href=\"https://golang.org/pkg/net/url/#URL\" rel=\"nofollow noreferrer\">documented</a> for this use case:</p>\n<blockquote>\n<p>Note that the Path field is stored in decoded form: /%47%6f%2f becomes /Go/. A consequence is that it is impossible to tell which slashes in the Path were slashes in the raw URL and which were %2f. This distinction is rarely important, but when it is, code must not use Path directly.</p>\n<p>Go 1.5 introduced the RawPath field to hold the encoded form of Path. The Parse function sets both Path and RawPath in the URL it returns, and URL's String method uses RawPath if it is a valid encoding of Path, by calling the EscapedPath method.</p>\n</blockquote>\n"}], "owner": {"reputation": 318, "user_id": 3310317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1490518186/picture?type=large", "display_name": "SparklingWater", "link": "https://stackoverflow.com/users/3310317/sparklingwater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498459886, "creation_date": 1498458949, "last_edit_date": 1498459418, "question_id": 44754171, "link": "https://stackoverflow.com/questions/44754171/http-newrequest-decoding-my-url-input", "title": "http.NewRequest() decoding my URL input", "body": "<p>When using <code>http.NewRequest(\"GET\", url , nil)</code> for URLs that contain a % followed by some number, *example: <code>https://api.deutschebahn.com/freeplan/v1/journeyDetails/356418%252F128592%252F57070%252F90271%252F80%253fstation_evaId%253D8000261</code>) Go will encode the string to a \"/\" in the url. How can I avoid that?</p>\n"}, {"tags": ["pointers", "go"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 2695928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001702454452/picture?type=large", "display_name": "Rajdeep Sardar", "link": "https://stackoverflow.com/users/2695928/rajdeep-sardar"}, "edited": false, "score": 0, "creation_date": 1498465948, "post_id": 44752689, "comment_id": 76492209, "body": "thank you for sharing. It looks really simple but following fails in my code  final.id =  &amp;(intermediate.ID()). id field in final is a string *, while intermediate.ID() returns a string. Currently I have to create an temporary variable to hold the intermediate.ID() value and then assign its address. I wish to avoid the temporary variable."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1498447013, "creation_date": 1498447013, "answer_id": 44752689, "question_id": 44752447, "link": "https://stackoverflow.com/questions/44752447/access-address-of-field-within-structure-variable-in-golang/44752689#44752689", "title": "Access address of Field within Structure variable in Golang", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype S struct{ F1, F2 int }\n\nfunc main() {\n    s := new(S)\n    f1, f2 := &amp;s.F1, &amp;s.F2\n    fmt.Printf(\"%p %p %p\\n\", s, f1, f2)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0x1040a128 0x1040a128 0x1040a12c\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 2695928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001702454452/picture?type=large", "display_name": "Rajdeep Sardar", "link": "https://stackoverflow.com/users/2695928/rajdeep-sardar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1111, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1498447013, "creation_date": 1498444513, "question_id": 44752447, "link": "https://stackoverflow.com/questions/44752447/access-address-of-field-within-structure-variable-in-golang", "title": "Access address of Field within Structure variable in Golang", "body": "<p>How to access the pointer or the address of a FIELD within a STRUCTURE in GOLANG. I have the  address or pointer of the whole structure variable but can not properly access the address of the field inside structure. So far I have tried Reflection but seems breaking somewhere. Any help is highly appreciated.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 927, "user_id": 2419669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kuQAn.jpg?s=128&g=1", "display_name": "yangmillstheory", "link": "https://stackoverflow.com/users/2419669/yangmillstheory"}, "edited": false, "score": 0, "creation_date": 1498433216, "post_id": 44751271, "comment_id": 76484014, "body": "Thanks for the reply. To clarify, I know why the failing example fails; it seems to me that the <code>range</code> example should fail for the same reason.  I suppose then that your answer is &quot;<code>range</code> has multiple interfaces&quot;. And I&#39;d guess that the designers felt the convenience was worth the ambiguity."}, {"owner": {"reputation": 927, "user_id": 2419669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kuQAn.jpg?s=128&g=1", "display_name": "yangmillstheory", "link": "https://stackoverflow.com/users/2419669/yangmillstheory"}, "edited": false, "score": 0, "creation_date": 1498438154, "post_id": 44751271, "comment_id": 76484844, "body": "Note that this multiple interface also exists outside of built-in keywords; when accessing a <code>map</code>, e.g., you can choose to consume the second variable (indicating whether or not the key is present) or not."}], "tags": [], "owner": {"reputation": 303, "user_id": 8008395, "user_type": "registered", "profile_image": "https://graph.facebook.com/1019408758194319/picture?type=large", "display_name": "Bohdan Kostko", "link": "https://stackoverflow.com/users/8008395/bohdan-kostko"}, "is_accepted": false, "score": 2, "last_activity_date": 1498430771, "creation_date": 1498430771, "answer_id": 44751271, "question_id": 44751147, "link": "https://stackoverflow.com/questions/44751147/valid-short-variable-declarations-in-range-unpacking/44751271#44751271", "title": "Valid short-variable declarations in range unpacking", "body": "<p>Your program expects that you're going to accept two values returned from function <code>test</code>. In fact you're getting only one. To make this code work you need to make only one small change.</p>\n\n<pre><code>package main\n\nfunc main() {\n    x,_ := test()\n}\n\nfunc test() (int, int) {\n    return 0, 1\n}\n</code></pre>\n\n<p>In case of ranges apparently it has multiple interfaces. Please also pay attention to the fact that it is not a function but reserved word. It is impossible to have optional returned parameters for your function - Go doesn't support functions overloading. Unfortunately this is restricted by language (from my perspective it's a good thing that you don't create confusion and you always have only one method with only one specific name that always matches only one interface).</p>\n"}], "owner": {"reputation": 927, "user_id": 2419669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kuQAn.jpg?s=128&g=1", "display_name": "yangmillstheory", "link": "https://stackoverflow.com/users/2419669/yangmillstheory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498432789, "creation_date": 1498429346, "last_edit_date": 1498432789, "question_id": 44751147, "link": "https://stackoverflow.com/questions/44751147/valid-short-variable-declarations-in-range-unpacking", "title": "Valid short-variable declarations in range unpacking", "body": "<p>Why does this code run\n    package main</p>\n\n<pre><code>import \"fmt\"\n\nfunc main() {\n    myMap := map[string]int{\n        \"a\": 1,\n        \"b\": 1,\n    }\n    for k, v := range myMap {\n        fmt.Println(k, v)\n    }\n}\n</code></pre>\n\n<p>But this code</p>\n\n<pre><code>package main\n\nfunc main() {\n    x := test()\n}\n\nfunc test() (int, int) {\n    return 0, 1\n}\n</code></pre>\n\n<p>won't compile:</p>\n\n<pre><code>\u798f ~/c/p/gobook (f14d0e9)|master\u26a1\n\u00b1 : go build test.go\n# command-line-arguments\n./test.go:4: multiple-value test() in single-value context\n</code></pre>\n\n<p>Note that the same holds for arrays and slices:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    myArray := [...]int{1, 2, 3}\n    mySlice := myArray[:]\n    for i := range mySlice {\n        fmt.Println(i)\n    }\n    for i, x := range mySlice {\n        fmt.Println(i, x)\n    }\n    for i := range myArray {\n        fmt.Println(i)\n    }\n    for i, x := range myArray {\n        fmt.Println(i, x)\n    }\n}\n</code></pre>\n\n<p>What is the compiler doing that allows consumers to opt-in to unpacking one or both return values in <code>map</code> ranges? Why did the language designers allow this for maps, slices, and arrays, but not for return values of functions?</p>\n"}, {"tags": ["templates", "go"], "comments": [{"owner": {"reputation": 1487, "user_id": 607434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0b458e94231d885c11b9d87773264bd?s=128&d=identicon&r=PG", "display_name": "andy mango", "link": "https://stackoverflow.com/users/607434/andy-mango"}, "edited": false, "score": 0, "creation_date": 1498430624, "post_id": 44749779, "comment_id": 76483493, "body": "If this is a matter of converting text, then why would you not use one of the many available scripting languages that have good string facilities or even the venerable AWK program to process the text?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498509978, "post_id": 44749779, "comment_id": 76517865, "body": "It still won&#39;t work afterward anyway. <code>{{myvar}}</code> is not a legitimate reference in a Go template; in Go it would be <code>{{.MyVar}}</code>, because it must start with the root context (<code>.</code> prefix) and be an exported (capitalized) field (unless it is a <code>map</code>, in which case it may be any case, but must still start with dot)."}], "answers": [{"tags": [], "owner": {"reputation": 8269, "user_id": 588734, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/o3CVI.jpg?s=128&g=1", "display_name": "Eamonn McEvoy", "link": "https://stackoverflow.com/users/588734/eamonn-mcevoy"}, "is_accepted": false, "score": 0, "last_activity_date": 1498431585, "creation_date": 1498431585, "answer_id": 44751347, "question_id": 44749779, "link": "https://stackoverflow.com/questions/44749779/converting-template-with-to-go-template/44751347#44751347", "title": "Converting template with $ to go template", "body": "<p>Use regex find <code>\\${([a-z0-9\\_\\-]+)}</code> and replace with <code>{{\\1}}</code></p>\n"}, {"tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": false, "score": 0, "last_activity_date": 1498442869, "creation_date": 1498442869, "answer_id": 44752302, "question_id": 44749779, "link": "https://stackoverflow.com/questions/44749779/converting-template-with-to-go-template/44752302#44752302", "title": "Converting template with $ to go template", "body": "<p>You can actually configure your own delimiters. See here:\n<a href=\"https://golang.org/pkg/text/template/#Template.Delims\" rel=\"nofollow noreferrer\">https://golang.org/pkg/text/template/#Template.Delims</a></p>\n\n<p>So, you should be able to configure prefix as \"${\" and suffix as \"}\". Then you should be able to keep using ${myvar} format.</p>\n\n<p>If you prefer to use a regexp to find and replace them, then you regexp should be a little bit more complicated. At the very least it should allow spaces and dots in addition to those proposed. But I'd suggest investigating non greedy replacements instead. See <a href=\"https://stackoverflow.com/questions/1103149/non-greedy-regex-matching-in-sed\">here</a> for an example.</p>\n"}], "owner": {"reputation": 1, "user_id": 8212892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2b895bd9624b0c1bda6b62c6b5c7d2f?s=128&d=identicon&r=PG&f=1", "display_name": "Yaniv Paz", "link": "https://stackoverflow.com/users/8212892/yaniv-paz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1498466226, "creation_date": 1498418708, "last_edit_date": 1498466226, "question_id": 44749779, "link": "https://stackoverflow.com/questions/44749779/converting-template-with-to-go-template", "title": "Converting template with $ to go template", "body": "<p>I am looking for simple method to convert simple template with <code>${myvar}</code> to GO template with <code>{{ myvar }}</code>.</p>\n\n<p>Is there any library to achieve that?</p>\n"}, {"tags": ["go", "tcp", "connection", "keep-alive"], "answers": [{"comments": [{"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498405439, "post_id": 44747829, "comment_id": 76476753, "body": "precisely. I want to re-use, but I do not call <code>Close()</code> in the example above and it still works. So when is it really necessary to call <code>Close()</code> ?"}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "reply_to_user": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498407670, "post_id": 44747829, "comment_id": 76477384, "body": "each times when got response. The Close() is called when fully read. If you don&#39;t call Close(), it will be memory leak."}, {"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498410536, "post_id": 44747829, "comment_id": 76478214, "body": "so if I have a loop where i make multiple requests to the same host with &quot;keep-alive&quot;, I need to close the response body every time? Where can I see what kind of memory leak is occurring if I call Close only once ?"}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "reply_to_user": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498436484, "post_id": 44747829, "comment_id": 76484547, "body": "As far as I can read the docs, response body should be Close()ed for each response you got even though it&#39;s keep-alive. If Close() is called before Read(), you can confirm the Connection will be closed for each response. If the server close the connection, the response will be leak. Response body doesn&#39;t be closed automatically."}, {"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498461435, "post_id": 44747829, "comment_id": 76490155, "body": "Yes, that&#39;s what docs say, however from my experiments it is enough to call Close only for the last response to free resources. The same TCP connection will be reused regardless of whether each response is closed or only  the last one, as long as the response body is fully read. But this contradicts the documentation, that&#39;s why I am asking this question"}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "reply_to_user": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498465438, "post_id": 44747829, "comment_id": 76491907, "body": "client.Do makes body reader for http.Response. It allocate memory. But it&#39;s not closed if you don&#39;t call Close()."}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "reply_to_user": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498521255, "post_id": 44747829, "comment_id": 76521431, "body": "FYI, you MUST not use defer in for loop. Because defer is evaluated when exiting the func-scope."}, {"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498553880, "post_id": 44747829, "comment_id": 76532677, "body": "no, defer is evaluated at the moment defer statement is executed, the context is saved at that moment"}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "reply_to_user": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498554247, "post_id": 44747829, "comment_id": 76532909, "body": "well, you can try this. <a href=\"https://play.golang.org/p/vgybz4hp9J\" rel=\"nofollow noreferrer\">play.golang.org/p/vgybz4hp9J</a> You may expect foo foo foo and finish. But not."}, {"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498562129, "post_id": 44747829, "comment_id": 76538188, "body": "this is the execution order of the deferred function, not the defer statement.  The defer itself is evaluated at the moment it is declared: <a href=\"https://play.golang.org/p/Myf0oL3DKG\" rel=\"nofollow noreferrer\">play.golang.org/p/Myf0oL3DKG</a>"}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "reply_to_user": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 2, "creation_date": 1498570558, "post_id": 44747829, "comment_id": 76543995, "body": "Yes, I know. I&#39;m just pointing that calling defer in loop is not good idea because it may allocate unexpected size if the nextPage is endless."}], "tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": false, "score": 0, "last_activity_date": 1498404552, "creation_date": 1498404552, "answer_id": 44747829, "question_id": 44747374, "link": "https://stackoverflow.com/questions/44747374/http-reuse-connection-condition/44747829#44747829", "title": "HTTP reuse connection condition", "body": "<p>Document doesn't say <code>Don't call Close() for keep-alive</code>. Just say <code>if you want to re-use connection, you MUST call Close() and fully read.</code></p>\n"}, {"comments": [{"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498510353, "post_id": 44761464, "comment_id": 76518020, "body": "yes, I deduced that <b>may</b> indicates that the rule is not a necessary requirement for having reusable connections. I was more interested on the details of when <b>may not</b> holds true"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 2, "creation_date": 1498510607, "post_id": 44761464, "comment_id": 76518136, "body": "As with most behind-the-scenes implementation details, it varies and may change at any time. You can always <a href=\"https://golang.org/src/net/http/client.go?s=16536:16588#L480\" rel=\"nofollow noreferrer\">read the source</a> of the <code>http</code> package for the particular version of Go you&#39;re interested in."}, {"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1498562293, "post_id": 44761464, "comment_id": 76538273, "body": "yes I should really dig into the code, and will make a blogpost with learnings :P"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1498485486, "creation_date": 1498485486, "answer_id": 44761464, "question_id": 44747374, "link": "https://stackoverflow.com/questions/44747374/http-reuse-connection-condition/44761464#44761464", "title": "HTTP reuse connection condition", "body": "<p>You can only <em>count on</em> what's in the documentation. In <em>some</em> circumstances (go version, OS, architecture, response content length, etc.) it <em>may</em> reuse the connection without fully reading it, or it may not. If you want to <em>ensure</em> the connection will be reused, you <em>must</em> fully read the body and close it.</p>\n\n<p>I generally write a quick helper:</p>\n\n<pre><code>func cleanUpRequest(req *http.Request) {\n    if req != nil &amp;&amp; req.Body != nil {\n        io.Copy(ioutil.Discard, req.Body)\n        req.Body.Close()\n    }\n}\n</code></pre>\n\n<p>This is safe to <code>defer</code> even before error checking.</p>\n"}], "owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 808, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1498485486, "creation_date": 1498401142, "last_edit_date": 1498409011, "question_id": 44747374, "link": "https://stackoverflow.com/questions/44747374/http-reuse-connection-condition", "title": "HTTP reuse connection condition", "body": "<p>From the official documentation <a href=\"https://golang.org/pkg/net/http/#Client.Do\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#Client.Do</a> it seems that the RoundTripper <strong>may</strong> not be able to re-use TCP connection for the next \"keep-alive\" request if Body is not closed and not fully read. What is this <strong>may</strong> about? </p>\n\n<p>From what I see Close does not necessarily need to be called, when the whole Body is read. So what is the necessary requirement for connection re-use? </p>\n\n<p>Code snippet (note commented out <code>defer resp.Body.Close()</code>) which creates multiple connections in a loop and from analysing it with netstat it seems the same TCP connection is used for all connections: </p>\n\n<pre><code>for nextPage != \"\" {\n    req, err := http.NewRequest(\"GET\", nextPage, nil)\n    req.Header.Set(\"Authorization\", fmt.Sprintf(\"Bearer %s\", *token))\n    if err != nil {\n        panic(err)\n    }\n    resp, err := http.DefaultClient.Do(req)\n    if err != nil {\n        panic(err)\n    }\n    // defer resp.Body.Close()\n    result := []*User{}\n    if err := json.NewDecoder(resp.Body).Decode(&amp;result); err != nil {\n        panic(err)\n    }\n\n    nextPage = getNextPage(resp.Header.Get(\"Link\"))\n}\n</code></pre>\n"}, {"tags": ["asp.net", "ajax", "go", "web-scraping", "web-crawler"], "answers": [{"tags": [], "owner": {"reputation": 1545, "user_id": 2599698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/828702589/picture?type=large", "display_name": "Jay Cee", "link": "https://stackoverflow.com/users/2599698/jay-cee"}, "is_accepted": false, "score": 0, "last_activity_date": 1498482113, "creation_date": 1498482113, "answer_id": 44760418, "question_id": 44746392, "link": "https://stackoverflow.com/questions/44746392/crawl-html-pagination-managed-by-asp-net-ajax-dopostback/44760418#44760418", "title": "Crawl html pagination managed by asp.net / AJAX (__doPostBack)", "body": "<p>So I didn't find a way to go through it but I found a simple LoadMore button on mobile that bypass the main problem.</p>\n\n<p>So it's a bit awkward to crawl the mobile version instead, but it works.</p>\n"}], "owner": {"reputation": 1545, "user_id": 2599698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/828702589/picture?type=large", "display_name": "Jay Cee", "link": "https://stackoverflow.com/users/2599698/jay-cee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1498482113, "creation_date": 1498393878, "last_edit_date": 1498401348, "question_id": 44746392, "link": "https://stackoverflow.com/questions/44746392/crawl-html-pagination-managed-by-asp-net-ajax-dopostback", "title": "Crawl html pagination managed by asp.net / AJAX (__doPostBack)", "body": "<p>I've read a lot about scrapping a website managed by javascript &amp; ASP.net and I learnt that first of all you have to send as many informations as possible in order to cheat the ASP server into believing that you really clicked the pagination.</p>\n\n<p>This is what I'm trying to reach:\n<a href=\"https://i.stack.imgur.com/xwQWu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xwQWu.png\" alt=\"enter image description here\"></a></p>\n\n<p>Or the button next:\n<a href=\"https://i.stack.imgur.com/DiPuC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DiPuC.png\" alt=\"enter image description here\"></a></p>\n\n<p>So I've tried my best but I see that only my first page is crawled. I can never access the second, third etc pages.</p>\n\n<p><strong>Everything is going well, my only problem is that I can't access other pages!</strong></p>\n\n<p>To this point I'm wondering if I'm doing something wrong with my go code or if I'll have to resign and tell myself \"ok that can't be scraped\".</p>\n\n<p>I'm using a <code>client := &amp;http.Client{}</code> in order to be able to change slightly the header:</p>\n\n<pre><code>    req, err := http.NewRequest(\"POST\", urlToScrap, strings.NewReader(form.Encode()))\n    if err != nil {\n        panic(err)\n    }\n    req.Header.Set(\"X-MicrosoftAjax\", \"Delta=true\")\n    req.Header.Set(\"User-Agent\", \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.76 Safari/537.36\")\n\n    res, err := client.Do(req)\n    if err != nil {\n        panic(err)\n    }\n</code></pre>\n\n<p>From this point on, here is the Dataform I'm trying to send within my POST request:</p>\n\n<pre><code>form.Add(\"__EVENTTARGET\", \"\")\nform.Add(\"_TSM_HiddenField_\", \"2GFwlGU9ATlFIxrdsXRzcja58_1t5F8HSleaZM4ZQwk1\")\nform.Add(\"__EVENTVALIDATION\", eventvalidation)\nform.Add(\"__VIEWSTATEGENERATOR\", \"20C6E8CA\")\nform.Add(\"__VIEWSTATE\", viewstat)\n</code></pre>\n\n<p>I've directly copied pasted the VIEWSTATE &amp; EVENTVALIDATION from the network into a variable (it's really huge!)</p>\n\n<p>So event target is blank as I was putting my crawler within a for (I'm using GoQuery), that is running until I reach the last page (I know precisely how many pages I want to crawl):</p>\n\n<pre><code>for page := 1; page &lt; 139; page++ {\n\n    urlPaginated := \"ctl00$ContentPlaceHolder1$pager$rptPager$ctl\" + strconv.Itoa(page) + \"$lbtnClick\"\n    form.Set(\"__EVENTTARGET\", urlPaginated)\n</code></pre>\n\n<p>The $ctl argument is the only one I saw changing while clicking on buttons. \nSo I thought it was this one modifying the content loaded from the url.</p>\n\n<p>And then, I do my scraping:</p>\n\n<pre><code>    doc, err := goquery.NewDocumentFromResponse(res)\n    if err != nil {\n        fmt.Println(\"ok2\")\n        log.Fatal(err)\n    }\n\n    doc.Find(\".resultstable tbody tr\").Each(func(i int, s *goquery.Selection) {\n        companyID, ok := s.Find(\"td &gt; a\").Attr(\"name\")\n        if !ok {\n            fmt.Println(\"yolo\")\n        }\n\n        fmt.Println(companyID)\n        scrapIt(companyID)\n        time.Sleep(time.Second / 2)\n    })\n</code></pre>\n\n<p>The only field I didn't try to pass to the form are those ones:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nl97O.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nl97O.png\" alt=\"enter image description here\"></a></p>\n\n<p>So Here I am, lost and clueless. If anyone has idea I would be grateful!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 4804845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92WGu.png?s=128&g=1", "display_name": "Markus T.", "link": "https://stackoverflow.com/users/4804845/markus-t"}, "edited": false, "score": 1, "creation_date": 1571643107, "post_id": 44746197, "comment_id": 103294971, "body": "I was hitting the same issue, commenting for visibility."}], "tags": [], "owner": {"reputation": 310, "user_id": 5799860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e74794c62ffb86fb84242f10574d79bd?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Evert", "link": "https://stackoverflow.com/users/5799860/hendrik-evert"}, "is_accepted": true, "score": 3, "last_activity_date": 1585173310, "last_edit_date": 1585173310, "creation_date": 1498392363, "answer_id": 44746197, "question_id": 44746083, "link": "https://stackoverflow.com/questions/44746083/gocron-creates-multiple-instances-of-task/44746197#44746197", "title": "gocron creates multiple instances of task", "body": "<p>Ok apparently </p>\n\n<pre><code>&lt;-gocron.Start()\n</code></pre>\n\n<p>will start jobs that were already started again so to fix my issue, I had to change the script to this:</p>\n\n<pre><code>func main() {\n    for i := 0; i &lt; 3; i++ {\n        taskCron(i)\n    }\n    channel2 := make(chan int)\n    go startCron(channel2)\n\n    time.Sleep(time.Second * 5)\n    gocron.Clear()\n    fmt.Println(\"stop this\")\n}\n\nfunc task(i int) {\n    fmt.Println(\"still running...\", i)\n}\n\nfunc taskCron(i int) {\n    gocron.Every(4).Seconds().Do(task, i)\n}\n\nfunc startCron(channel chan int) {\n    &lt;-gocron.Start()\n}\n</code></pre>\n\n<p>I hope this helps anybody who had the same Problem!</p>\n"}], "owner": {"reputation": 310, "user_id": 5799860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e74794c62ffb86fb84242f10574d79bd?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Evert", "link": "https://stackoverflow.com/users/5799860/hendrik-evert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 720, "favorite_count": 0, "accepted_answer_id": 44746197, "answer_count": 1, "score": 2, "last_activity_date": 1585173310, "creation_date": 1498391529, "question_id": 44746083, "link": "https://stackoverflow.com/questions/44746083/gocron-creates-multiple-instances-of-task", "title": "gocron creates multiple instances of task", "body": "<p>I had a problem in a script using this package:</p>\n\n<pre><code>    \"github.com/jasonlvhit/gocron\"\n</code></pre>\n\n<p>I wrote this little testscript after I couldn't find a mistake and it resulted that there were twice as many cronjobs executed as intended:</p>\n\n<pre><code>func main() {\n    for i := 0; i &lt; 3; i++ {\n        channel := make(chan string)\n        go taskCron(channel, i)\n    }\n\n    time.Sleep(time.Second * 5)\n    gocron.Clear()\n    fmt.Println(\"stop this shit\")\n}\n\nfunc task(i int) {\n    fmt.Println(\"still running...\", i)\n}\n\nfunc taskCron(channel chan string, i int) {\n    gocron.Every(4).Seconds().Do(task, i)\n    &lt;-gocron.Start()\n}\n</code></pre>\n\n<p>running it gave me this output:</p>\n\n<pre><code>\u2014\u2014\u25b6go run *.go\nstill running... 0\nstill running... 0\nstill running... 1\nstill running... 1\nstill running... 2\nstill running... 2\nstill running... 0\nstill running... 1\nstill running... 2\nstop this\n</code></pre>\n\n<p>Does anyone know how I can create a dynamic amount of gocron jobs without duplicating them?</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["select", "go", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1498388477, "post_id": 44745607, "comment_id": 76472221, "body": "So in this situation is it normal to expect the other goroutine to contain a value so that a future read on it will be non blocking?"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1498391151, "post_id": 44745607, "comment_id": 76472879, "body": "It seems from my tests and yours that there can never be a mismatch in the number of reads and the number of writes.  Is that right?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1498400034, "last_edit_date": 1498400034, "creation_date": 1498387988, "answer_id": 44745607, "question_id": 44745406, "link": "https://stackoverflow.com/questions/44745406/expected-behavior-when-multiple-things-happen-together-in-select/44745607#44745607", "title": "Expected behavior when multiple things happen together in select", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">Select statements</a></p>\n  \n  <p>A \"select\" statement chooses which of a set of possible send or\n  receive operations will proceed.</p>\n  \n  <p>If one or more of the communications can proceed, a single one that\n  can proceed is chosen via a uniform pseudo-random selection.</p>\n</blockquote>\n\n<p>Your question is imprecise: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a> For example,</p>\n\n<p><code>chan.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    fmt.Println()\n    for i := 0; i &lt; 8; i++ {\n        one, two := make(chan int), make(chan int)\n        go func() { // goroutine one\n            select {\n            case &lt;-one:\n                fmt.Println(\"read from one\")\n            case &lt;-two:\n                fmt.Println(\"read from two\")\n            }\n            select {\n            case &lt;-one:\n                fmt.Println(\"read from one\")\n            case &lt;-two:\n                fmt.Println(\"read from two\")\n            }\n            fmt.Println()\n        }()\n        go func() { // goroutine two\n            one &lt;- 1\n        }()\n        go func() { // goroutine three\n            two &lt;- 2\n        }()\n        time.Sleep(time.Millisecond)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run chan.go\n\nread from two\nread from one\n\nread from one\nread from two\n\nread from one\nread from two\n\nread from two\nread from one\n\nread from one\nread from two\n\nread from two\nread from one\n\nread from one\nread from two\n\nread from two\nread from one\n\n$\n</code></pre>\n\n<p>What behavior do you expect and why?</p>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"nofollow noreferrer\">Channel types</a></p>\n  \n  <p>A channel provides a mechanism for concurrently executing functions to\n  communicate by sending and receiving values of a specified element\n  type.</p>\n  \n  <p>A new, initialized channel value can be made using the built-in\n  function make, which takes the channel type and an optional capacity\n  as arguments:</p>\n\n<pre><code>make(chan int, 100)\n</code></pre>\n  \n  <p>The capacity, in number of elements, sets the size of the buffer in\n  the channel. If the capacity is zero or absent, the channel is\n  unbuffered and communication succeeds only when both a sender and\n  receiver are ready. Otherwise, the channel is buffered and\n  communication succeeds without blocking if the buffer is not full\n  (sends) or not empty (receives). A nil channel is never ready for\n  communication.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Go_statements\" rel=\"nofollow noreferrer\">Go statements</a></p>\n  \n  <p>A \"go\" statement starts the execution of a function call as an\n  independent concurrent thread of control, or goroutine, within the\n  same address space.</p>\n  \n  <p>The function value and parameters are evaluated as usual in the\n  calling goroutine, but unlike with a regular call, program execution\n  does not wait for the invoked function to complete. Instead, the\n  function begins executing independently in a new goroutine. When the\n  function terminates, its goroutine also terminates. If the function\n  has any return values, they are discarded when the function completes.</p>\n</blockquote>\n\n<p>Analyzing your new example:</p>\n\n<p>The channels are unbuffered. Goroutines two and three wait on goroutine one. A send on an unbuffered channel waits until there is a pending receive. When the goroutine one select is evaluated, there will be a pending receive on either channel one or channel two. The goroutine, two or three, that sends on that channel can now send and terminate. Goroutine one can now execute a receive on that channel and terminate. As a crude goroutine synchronization mechanism, we wait goroutine main for one millisecond and then terminate it, which terminates any other goroutines. It will terminate the goroutine, two or three, that didn't get to send because it's still waiting for a pending receive.</p>\n\n<p>You ask \"can there even be a mismatch in the number of reads vs the number of writes (i.e. can one_net and two_net be non 0 at the end)? For example in the case where the select statement is waiting on a read from both channels, and then goroutines two and three go through with their respective writes, but then the select only picks up on one of those writes.\"</p>\n\n<p>Only one of goroutines two and three gets to send (write). There will be exactly one (send) write and one (receive) read. This assumes that goroutine main does not terminate before this occurs, that is, it occurs within one millisecond.</p>\n"}, {"tags": [], "owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "is_accepted": false, "score": 0, "last_activity_date": 1516820104, "creation_date": 1516820104, "answer_id": 48429715, "question_id": 44745406, "link": "https://stackoverflow.com/questions/44745406/expected-behavior-when-multiple-things-happen-together-in-select/48429715#48429715", "title": "Expected behavior when multiple things happen together in select", "body": "<p>As peterSO points out, selection among multiple simultaneous channels that are ready is pseudo-random.</p>\n\n<p>However, it is important to notice that in most cases, you will have race conditions between the sending and/or receiving goroutines, which <em>also</em> introduces indeterminism.</p>\n\n<p>In fact, peterSO's example illustrates this very situation; at the point where the receiving goroutine reaches the first <code>select</code> statement, there is no guarantee whether any or both of the sending goroutines have executed their respective send statement. The relevant snippet follows, with some added comments:</p>\n\n<pre><code>a, b := make(chan int), make(chan int)\ngo func() { // goroutine one\n    // At this point, any or none of the channels could be ready.\n    select {\n    case &lt;-a:\n        fmt.Println(\"read from a\")\n    case &lt;-b:\n        fmt.Println(\"read from b\")\n    }\n    // At this point, we will have read one, and will block waiting for the other.\n    select {\n    case &lt;-a:\n        fmt.Println(\"read from a\")\n    case &lt;-b:\n        fmt.Println(\"read from b\")\n    }\n    fmt.Println()\n}()\ngo func() { // goroutine two\n    a &lt;- 1 // Does this execute first?\n}()\ngo func() { // goroutine three\n    b &lt;- 2 // ...or does this?\n}()\n</code></pre>\n\n<p>In general, when writing concurrent programmes, one should avoid relying on concurrent events happening in any particular determined order. Unless your program logic serialises things, as a rule of thumb, consider them happening in an indeterminate (though not necessarily random and evenly distributed) order, and you will be safe more often than sorry.</p>\n"}], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1516820104, "creation_date": 1498386171, "last_edit_date": 1498392594, "question_id": 44745406, "link": "https://stackoverflow.com/questions/44745406/expected-behavior-when-multiple-things-happen-together-in-select", "title": "Expected behavior when multiple things happen together in select", "body": "<p>Assuming one goroutine is waiting on the following select on two <strong>unbuffered</strong> channels <code>one</code> and <code>two</code></p>\n\n<pre><code>select {\n    case &lt;-one:\n        fmt.Println(\"read from one\")\n    case &lt;-two:\n        fmt.Println(\"read from two\")\n}\n</code></pre>\n\n<p>and one one goroutine is waiting on the following send</p>\n\n<pre><code>one &lt;- 1\n</code></pre>\n\n<p>and another is waiting on the following</p>\n\n<pre><code>two &lt;- 2\n</code></pre>\n\n<p>The first waiting on a select implies that there is room in the buffer for both the channels <code>one</code> and <code>two</code>, then which <code>select</code> case is guaranteed to run?  Is it deterministic or can either run with one channel left with one unread value at the end.</p>\n\n<p>If there is only one guaranteed net output, then do <code>select</code>s ensure a total order across all operations on all the channels participating in the <code>select</code>?  That seems very inefficient..</p>\n\n<hr>\n\n<p>For example in the following code </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"sync\"\n)\n\nfunc main() {\n    one_net := 0\n    two_net := 0\n    var mtx = &amp;sync.Mutex{}\n    for i := 0; i &lt; 8; i++ {\n        one, two := make(chan int), make(chan int)\n        go func() { // go routine one\n            select {\n            case &lt;-one:\n                fmt.Println(\"read from one\")\n\n                mtx.Lock()\n                one_net++\n                mtx.Unlock()\n            case &lt;-two:\n                fmt.Println(\"read from two\")\n\n                mtx.Lock()\n                two_net++\n                mtx.Unlock()\n            }\n        }()\n        go func() { // go routine two\n            one &lt;- 1\n\n            mtx.Lock()\n            one_net--\n            mtx.Unlock()\n\n            fmt.Println(\"Wrote to one\")\n        }()\n        go func() { // go routine three\n            two &lt;- 2\n\n            mtx.Lock()\n            two_net--\n            mtx.Unlock()\n\n            fmt.Println(\"Wrote to two\")\n        }()\n        time.Sleep(time.Millisecond)\n    }\n    mtx.Lock()\n    fmt.Println(\"one_net\", one_net)\n    fmt.Println(\"two_net\", two_net)\n    mtx.Unlock()\n}\n</code></pre>\n\n<p>can there even be a mismatch in the number of reads vs the number of writes (i.e. can <code>one_net</code> and <code>two_net</code> be non 0 at the end)?  For example in the case where the select statement is waiting on a read from both channels, and then goroutines two and three go through with their respective writes, but then the <code>select</code> only picks up on one of those writes.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36814, "user_id": 671543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2145962377da9419f2446cd565f614ee?s=128&d=identicon&r=PG", "display_name": "njzk2", "link": "https://stackoverflow.com/users/671543/njzk2"}, "edited": false, "score": 3, "creation_date": 1498363816, "post_id": 44743082, "comment_id": 76467291, "body": "&quot;unexpected (...) newline before {&quot; I am not sure what is confusing you in this error message?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1498363894, "post_id": 44743082, "comment_id": 76467306, "body": "<a href=\"https://meta.stackoverflow.com/q/284236/62576\">Why is &quot;Can someone help me?&quot; not an actual question?</a>"}, {"owner": {"reputation": 36814, "user_id": 671543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2145962377da9419f2446cd565f614ee?s=128&d=identicon&r=PG", "display_name": "njzk2", "link": "https://stackoverflow.com/users/671543/njzk2"}, "edited": false, "score": 1, "creation_date": 1498363899, "post_id": 44743082, "comment_id": 76467307, "body": "also, you may want to take 5 minutes to follow at least a few basic tutorials: <a href=\"https://gobyexample.com/\" rel=\"nofollow noreferrer\">gobyexample.com</a>"}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 2, "creation_date": 1498364068, "post_id": 44743082, "comment_id": 76467334, "body": "There can be no newline between <code>func</code> and <code>{</code>. <code>firstnu :34</code> is not what you expect it is. Also, you refer to <code>a</code> and <code>b</code> which are not defined. Literally everything in this 4-line example is wrong; it&#39;s quite impressive. If you want to learn Go then feel free to ask questions here (even basic ones), but please, learn the basics of Go syntax first. We&#39;re not a programming school."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1498366163, "post_id": 44743082, "comment_id": 76467619, "body": "See <a href=\"https://stackoverflow.com/questions/34846848/how-to-break-a-long-line-of-code-in-golang/34848928#34848928\">How to break a long line of code in Golang?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4244405"}, "edited": false, "score": 0, "creation_date": 1500673389, "post_id": 44743082, "comment_id": 77460420, "body": "why vote this down? some people here are just ridiculous; it&#39;s a legitimate question and it&#39;s really dumb that the creators of the language force such coding-style on the developers. I don&#39;t care if you like your starting brace on the same line - I don&#39;t and you can&#39;t force me to code like this. Now flag this comment - this made me want to shout at someone."}], "answers": [{"comments": [{"owner": {"reputation": 36814, "user_id": 671543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2145962377da9419f2446cd565f614ee?s=128&d=identicon&r=PG", "display_name": "njzk2", "link": "https://stackoverflow.com/users/671543/njzk2"}, "edited": false, "score": 0, "creation_date": 1498364008, "post_id": 44743117, "comment_id": 76467326, "body": "@KenWhite actually: <a href=\"https://repl.it/JBA2/0\" rel=\"nofollow noreferrer\">repl.it/JBA2/0</a>"}, {"owner": {"reputation": 789, "user_id": 1377376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2168ab1664a297bf84df17cce0526ae?s=128&d=identicon&r=PG", "display_name": "Joel Glovacki", "link": "https://stackoverflow.com/users/1377376/joel-glovacki"}, "reply_to_user": {"reputation": 36814, "user_id": 671543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2145962377da9419f2446cd565f614ee?s=128&d=identicon&r=PG", "display_name": "njzk2", "link": "https://stackoverflow.com/users/671543/njzk2"}, "edited": false, "score": 1, "creation_date": 1498364177, "post_id": 44743117, "comment_id": 76467352, "body": "@KenWhite the first { must be on the same line as the func-declaration: this is imposed by the compiler"}], "tags": [], "owner": {"reputation": 789, "user_id": 1377376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2168ab1664a297bf84df17cce0526ae?s=128&d=identicon&r=PG", "display_name": "Joel Glovacki", "link": "https://stackoverflow.com/users/1377376/joel-glovacki"}, "is_accepted": false, "score": 1, "last_activity_date": 1498364244, "last_edit_date": 1498364244, "creation_date": 1498363900, "answer_id": 44743117, "question_id": 44743082, "link": "https://stackoverflow.com/questions/44743082/how-to-debug-syntax-error-unexpected-semicolon-or-newline-before/44743117#44743117", "title": "How to debug &quot;syntax error: unexpected semicolon or newline before {&quot;?", "body": "<p>bring the curly brace next to the <code>main()</code></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    //..\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1917, "user_id": 4039768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWQUf.jpg?s=128&g=1", "display_name": "Mohsin", "link": "https://stackoverflow.com/users/4039768/mohsin"}, "is_accepted": false, "score": 4, "last_activity_date": 1498373806, "last_edit_date": 1592644375, "creation_date": 1498373806, "answer_id": 44743994, "question_id": 44743082, "link": "https://stackoverflow.com/questions/44743082/how-to-debug-syntax-error-unexpected-semicolon-or-newline-before/44743994#44743994", "title": "How to debug &quot;syntax error: unexpected semicolon or newline before {&quot;?", "body": "<p>Because, In Golang, Opening brace can't be placed on a separate line. Thanks to the automatic semicolon injection for the same.</p>\n<p>Refer <a href=\"https://golang.org/doc/faq#semicolons\" rel=\"nofollow noreferrer\">Go FAQ</a> and <a href=\"https://golang.org/doc/effective_go.html#semicolons\" rel=\"nofollow noreferrer\">Go Doc on Semicolons</a>:</p>\n<blockquote>\n<p><strong>Why are there braces but no semicolons? And why can't I put the opening brace on the next line?</strong></p>\n<p>Go uses brace brackets for statement grouping, a syntax familiar to programmers who have worked with any language in the C family. Semicolons, however, are for parsers, not for people, and we wanted to eliminate them as much as possible. To achieve this goal, Go borrows a trick from BCPL: the semicolons that separate statements are in the formal grammar but are injected automatically, without lookahead, by the lexer at the end of any line that could be the end of a statement. This works very well in practice but has the effect that it forces a brace style. For instance, the opening brace of a function cannot appear on a line by itself.</p>\n</blockquote>\n<p>So curly brace after <code>main()</code> function will solve the issue as <a href=\"https://stackoverflow.com/users/1377376/joel-glovacki\">Joel</a> suggested.</p>\n<pre><code>func main() { // Opening brace on the same line\n    // Actual implementation\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1070, "user_id": 5722950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5f8584e00a884f270ceb1c90f43122d0?s=128&d=identicon&r=PG&f=1", "display_name": "Y. Eliash", "link": "https://stackoverflow.com/users/5722950/y-eliash"}, "is_accepted": false, "score": 0, "last_activity_date": 1498379349, "creation_date": 1498379349, "answer_id": 44744593, "question_id": 44743082, "link": "https://stackoverflow.com/questions/44743082/how-to-debug-syntax-error-unexpected-semicolon-or-newline-before/44744593#44744593", "title": "How to debug &quot;syntax error: unexpected semicolon or newline before {&quot;?", "body": "<p>Your code is incorrect</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n  firstnu := 34\n  secondnu := 50\n  fmt.Println(\"The sum is :\", firstnu + secondnu)\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8210907, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AwizKMXckc4/AAAAAAAAAAI/AAAAAAAAJik/rT_TIZYF43s/photo.jpg?sz=128", "display_name": "Mageswaran Meyyappan", "link": "https://stackoverflow.com/users/8210907/mageswaran-meyyappan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1386, "favorite_count": 0, "closed_date": 1498413524, "answer_count": 3, "score": -6, "last_activity_date": 1498396845, "creation_date": 1498363491, "last_edit_date": 1498396845, "question_id": 44743082, "link": "https://stackoverflow.com/questions/44743082/how-to-debug-syntax-error-unexpected-semicolon-or-newline-before", "closed_reason": "Not suitable for this site", "title": "How to debug &quot;syntax error: unexpected semicolon or newline before {&quot;?", "body": "<pre><code>package main\n\nimport\"fmt\"\n\nfunc main()\n{\n  firstnu :34\n  secondnu :50\n  fmt.println(\"The sum is :\", a + b)\n}\n</code></pre>\n"}, {"tags": ["linux", "file", "go", "operating-system", "copy"], "comments": [{"owner": {"reputation": 191, "user_id": 7627464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mD7ok.jpg?s=128&g=1", "display_name": "Togtokh Khorchin", "link": "https://stackoverflow.com/users/7627464/togtokh-khorchin"}, "edited": false, "score": 2, "creation_date": 1498361708, "post_id": 44742948, "comment_id": 76466960, "body": "Run your script with root permission."}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 1, "creation_date": 1498364419, "post_id": 44742948, "comment_id": 76467386, "body": "What are you trying to create? You may need to change the permission of the directory or run as different user. As a last resort, you may need to run it as root (but this should usually be avoided if possible)."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1498367091, "creation_date": 1498367091, "answer_id": 44743365, "question_id": 44742948, "link": "https://stackoverflow.com/questions/44742948/how-can-i-create-a-file-read-write-permissions-in-mnt/44743365#44743365", "title": "How can I create a file read/write permissions in /mnt/?", "body": "<p>Check first if you have a security setting that would prevent the creation of any file (root or not) in /mnt.</p>\n\n<p>See \"<a href=\"https://serverfault.com/a/672773/783\">Can't create/write to file '/mnt/temp/something' (Errcode: 13)</a>\"</p>\n\n<p>It involves adding a profile in <code>/etc/apparmor.d</code> in order to allow any file to be created.<br>\nSee \"<a href=\"https://wiki.ubuntu.com/AppArmor\" rel=\"nofollow noreferrer\">Ubuntu AppArmor</a>\".</p>\n"}, {"tags": [], "owner": {"reputation": 1070, "user_id": 5722950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5f8584e00a884f270ceb1c90f43122d0?s=128&d=identicon&r=PG&f=1", "display_name": "Y. Eliash", "link": "https://stackoverflow.com/users/5722950/y-eliash"}, "is_accepted": false, "score": 0, "last_activity_date": 1498390122, "creation_date": 1498390122, "answer_id": 44745900, "question_id": 44742948, "link": "https://stackoverflow.com/questions/44742948/how-can-i-create-a-file-read-write-permissions-in-mnt/44745900#44745900", "title": "How can I create a file read/write permissions in /mnt/?", "body": "<p>To create a new file use ioutil package</p>\n\n<p><a href=\"https://golang.org/src/io/ioutil/ioutil.go?s=2518:2586#L66\" rel=\"nofollow noreferrer\">https://golang.org/src/io/ioutil/ioutil.go?s=2518:2586#L66</a></p>\n\n<p>To change an existing file's permission use the os package\nwhich can help you here with file permission,\nmake sure that you execute your binary with the appropriate permission, otherwise you will get an error.</p>\n\n<pre><code>if err := os.Chmod(\"some-filename\", 0644); err != nil {\n        log.Fatal(err)\n    }\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 3990284, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/445062347ee640974e57693c7ce31ef4?s=128&d=identicon&r=PG&f=1", "display_name": "ds459", "link": "https://stackoverflow.com/users/3990284/ds459"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1498396636, "creation_date": 1498361307, "last_edit_date": 1498396636, "question_id": 44742948, "link": "https://stackoverflow.com/questions/44742948/how-can-i-create-a-file-read-write-permissions-in-mnt", "title": "How can I create a file read/write permissions in /mnt/?", "body": "<p>I tried <code>os.Create()</code> but it gives permission denied. It is expected result but how can I get rid of it?</p>\n"}, {"tags": ["go", "benchmarking"], "comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1498350564, "post_id": 44742110, "comment_id": 76465405, "body": "Are you sure that <code>RandomArray()</code> and <code>ConcurrentQuicksort()</code> are correct? You should post the <i>full</i> code required to reproduce the problem; see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "reply_to_user": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1498350668, "post_id": 44742110, "comment_id": 76465422, "body": "Edited the code, both <code>RandomArray()</code> and <code>ConcurrentQuicksort()</code> have gone through test of randomized <code>500000</code> sizes;"}], "answers": [{"comments": [{"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1498401455, "post_id": 44742537, "comment_id": 76475585, "body": "Yeah, I got that actually, but I need <code>A := RandomArray(size)</code> inside the loop, cuz otherwise it will sort a sorted array, and thats bad. And if I try this, it says : <code>BenchmarkConcurrentQuickSort10000-4     *** Test killed: ran too long (10m0s). FAIL    github.com&#47;frynio&#47;mysort        600.023s</code>"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1498356959, "last_edit_date": 1498356959, "creation_date": 1498356207, "answer_id": 44742537, "question_id": 44742110, "link": "https://stackoverflow.com/questions/44742110/benchmarking-bad-results/44742537#44742537", "title": "Benchmarking bad results", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">Package testing</a></p>\n  \n  <p>A sample benchmark function looks like this:</p>\n\n<pre><code>func BenchmarkHello(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        fmt.Sprintf(\"hello\")\n    }\n}\n</code></pre>\n  \n  <p>The benchmark function must run the target code b.N times. During\n  benchmark execution, b.N is adjusted until the benchmark function\n  lasts long enough to be timed reliably.</p>\n</blockquote>\n\n<p>I don't see a benchmark loop in your code. Try</p>\n\n<pre><code>func benchmarkConcurrentQuickSort(size int, b *testing.B) {\n    A := RandomArray(size)\n    var wg sync.WaitGroup\n    b.ResetTimer()\n    for i := 0; i &lt; b.N; i++ {\n        ConcurrentQuicksort(A, 0, len(A)-1, &amp;wg)\n        wg.Wait()\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>BenchmarkConcurrentQuickSort500-4              10000        122291 ns/op\nBenchmarkConcurrentQuickSort1000-4              5000        221154 ns/op\nBenchmarkConcurrentQuickSort5000-4              1000       1225230 ns/op\nBenchmarkConcurrentQuickSort10000-4              500       2568024 ns/op\nBenchmarkConcurrentQuickSort20000-4              300       5808130 ns/op\nBenchmarkConcurrentQuickSort1000000-4              1    1371751710 ns/op\n</code></pre>\n"}], "owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1498396662, "creation_date": 1498350317, "last_edit_date": 1498396662, "question_id": 44742110, "link": "https://stackoverflow.com/questions/44742110/benchmarking-bad-results", "title": "Benchmarking bad results", "body": "<p>so I have the Quicksort algorithm implemented with concurrency (the one without as well). Now I wanted to compare the times. I wrote this:</p>\n\n<pre><code>func benchmarkConcurrentQuickSort(size int, b *testing.B) {\n    A := RandomArray(size)\n    var wg sync.WaitGroup\n    b.ResetTimer()\n    ConcurrentQuicksort(A, 0, len(A)-1, &amp;wg)\n    wg.Wait()\n}\n\nfunc BenchmarkConcurrentQuickSort500(b *testing.B) {\n    benchmarkConcurrentQuickSort(500, b)\n}\nfunc BenchmarkConcurrentQuickSort1000(b *testing.B) {\n    benchmarkConcurrentQuickSort(1000, b)\n}\nfunc BenchmarkConcurrentQuickSort5000(b *testing.B) {\n    benchmarkConcurrentQuickSort(5000, b)\n}\nfunc BenchmarkConcurrentQuickSort10000(b *testing.B) {\n    benchmarkConcurrentQuickSort(10000, b)\n}\nfunc BenchmarkConcurrentQuickSort20000(b *testing.B) {\n    benchmarkConcurrentQuickSort(20000, b)\n}\nfunc BenchmarkConcurrentQuickSort1000000(b *testing.B) {\n    benchmarkConcurrentQuickSort(1000000, b)\n}\n</code></pre>\n\n<p>The results are like this:</p>\n\n<pre><code>C:\\projects\\go\\src\\github.com\\frynio\\mysort&gt;go test -bench=.\nBenchmarkConcurrentQuickSort500-4               2000000000               0.00 ns/op\nBenchmarkConcurrentQuickSort1000-4              2000000000               0.00 ns/op\nBenchmarkConcurrentQuickSort5000-4              2000000000               0.00 ns/op\nBenchmarkConcurrentQuickSort10000-4             2000000000               0.00 ns/op\nBenchmarkConcurrentQuickSort20000-4             2000000000               0.00 ns/op\nBenchmarkConcurrentQuickSort1000000-4                 30          49635266 ns/op\nPASS\nok      github.com/frynio/mysort        8.342s\n</code></pre>\n\n<p>I can believe the last one, but I definitely think that sorting 500-element array takes longer than 1ns. What am i doing wrong? I am pretty sure that <code>RandomArray</code> returns array of wanted size, as we can see in the last benchmark. Why does it print out the 0.00 ns?</p>\n\n<pre><code>func RandomArray(n int) []int {\n    a := []int{}\n    for i := 0; i &lt; n; i++ {\n        a = append(a, rand.Intn(500))\n    }\n    return a\n}\n\n// ConcurrentPartition - ConcurrentQuicksort function for partitioning the array (randomized choice of a pivot)\nfunc ConcurrentPartition(A []int, p int, r int) int {\n    index := rand.Intn(r-p) + p\n    pivot := A[index]\n    A[index] = A[r]\n    A[r] = pivot\n    x := A[r]\n    j := p - 1\n    i := p\n    for i &lt; r {\n        if A[i] &lt;= x {\n            j++\n            tmp := A[j]\n            A[j] = A[i]\n            A[i] = tmp\n        }\n        i++\n    }\n    temp := A[j+1]\n    A[j+1] = A[r]\n    A[r] = temp\n    return j + 1\n}\n\n// ConcurrentQuicksort - a concurrent version of a quicksort algorithm\nfunc ConcurrentQuicksort(A []int, p int, r int, wg *sync.WaitGroup) {\n    if p &lt; r {\n        q := ConcurrentPartition(A, p, r)\n        wg.Add(2)\n        go func() {\n            ConcurrentQuicksort(A, p, q-1, wg)\n            wg.Done()\n        }()\n        go func() {\n            ConcurrentQuicksort(A, q+1, r, wg)\n            wg.Done()\n        }()\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 6303169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef5f622f9906108bbc136d53da0b14e1?s=128&d=identicon&r=PG&f=1", "display_name": "V. Korovin", "link": "https://stackoverflow.com/users/6303169/v-korovin"}, "edited": false, "score": 0, "creation_date": 1498378722, "post_id": 44742254, "comment_id": 76469925, "body": "Thanks. I tought there is no need to run app after build this with -race flag. That was a problem. So, if a run test <code>go test -race packagename</code> and there will be no test function for function where is data race, data race will not be detected?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 109, "user_id": 6303169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef5f622f9906108bbc136d53da0b14e1?s=128&d=identicon&r=PG&f=1", "display_name": "V. Korovin", "link": "https://stackoverflow.com/users/6303169/v-korovin"}, "edited": false, "score": 0, "creation_date": 1498379512, "post_id": 44742254, "comment_id": 76470110, "body": "Correct, if no test func, data race won&#39;t be detected during a test run."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 2, "last_activity_date": 1498352724, "last_edit_date": 1498352724, "creation_date": 1498352389, "answer_id": 44742254, "question_id": 44741975, "link": "https://stackoverflow.com/questions/44741975/trying-to-reproduce-data-race-in-golang-1-8-3/44742254#44742254", "title": "Trying to reproduce data race in Golang 1.8.3", "body": "<p>Both of your examples has data race issue. You can find out data race in following ways.</p>\n\n<ol>\n<li><code>go run -race program.go</code></li>\n<li><code>go test -race &lt;package-name&gt;</code> or <code>go test -race -run=&lt;testcase-func-name&gt;</code></li>\n<li><code>go build -race program.go</code> then execute the program</li>\n<li><code>go install -race &lt;package-name&gt;</code> then execute the program</li>\n</ol>\n\n<p><strong>Example 1:</strong> data race info</p>\n\n<pre><code>$ go build -race datarace-try1.go\n$ ./datarace-try1\n8\n==================\nWARNING: DATA RACE\nRead at 0x00c4200761a8 by goroutine 7:\n  main.main.func1()\n      /Users/jeeva/go_playground/datarace-try1.go:23 +0x74\n\nPrevious write at 0x00c4200761a8 by goroutine 6:\n  main.main.func1()\n      /Users/jeeva/go_playground/datarace-try1.go:23 +0x8d\n\nGoroutine 7 (running) created at:\n  main.main()\n      /Users/jeeva/go_playground/datarace-try1.go:25 +0xee\n\nGoroutine 6 (running) created at:\n  main.main()\n      /Users/jeeva/go_playground/datarace-try1.go:25 +0xee\n==================\n187410\nFound 1 data race(s)\n</code></pre>\n\n<p><strong>Example 2:</strong> data race info</p>\n\n<pre><code>$ go build -race datarace-try2.go\n$ ./datarace-try2\n==================\nWARNING: DATA RACE\nRead at 0x00c420078178 by main goroutine:\n  main.main()\n      /Users/jeeva/go_playground/datarace-try2.go:10 +0x12e\n\nPrevious write at 0x00c420078178 by goroutine 6:\n  main.main.func1()\n      /Users/jeeva/go_playground/datarace-try2.go:15 +0xd4\n\nGoroutine 6 (finished) created at:\n  main.main()\n      /Users/jeeva/go_playground/datarace-try2.go:17 +0xf1\n==================\n==================\nWARNING: DATA RACE\nRead at 0x00c420078178 by goroutine 7:\n  main.main.func2()\n      /Users/jeeva/go_playground/datarace-try2.go:20 +0x3f\n\nPrevious write at 0x00c420078178 by goroutine 6:\n  main.main.func1()\n      /Users/jeeva/go_playground/datarace-try2.go:15 +0xd4\n\nGoroutine 7 (running) created at:\n  main.main()\n      /Users/jeeva/go_playground/datarace-try2.go:23 +0x11d\n\nGoroutine 6 (finished) created at:\n  main.main()\n      /Users/jeeva/go_playground/datarace-try2.go:17 +0xf1\n==================\nfinish\nFound 2 data race(s)\nexit status 66\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 6303169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef5f622f9906108bbc136d53da0b14e1?s=128&d=identicon&r=PG&f=1", "display_name": "V. Korovin", "link": "https://stackoverflow.com/users/6303169/v-korovin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 44742254, "answer_count": 1, "score": 0, "last_activity_date": 1498352724, "creation_date": 1498348725, "question_id": 44741975, "link": "https://stackoverflow.com/questions/44741975/trying-to-reproduce-data-race-in-golang-1-8-3", "title": "Trying to reproduce data race in Golang 1.8.3", "body": "<p>I try to reproduce race condition in my app, but <code>go build -race</code> doesnt show any error, even on virtual machine with Linux onboard.</p>\n\n<p>Machine:<br>\nWindows: 4 cores<br>\nLinux: 2 cores (Ubuntu Xenial x64 via Vagrant and VirtualBox)</p>\n\n<p>go version:<br>\nLinux: <code>go version go1.8.3 linux/amd64</code><br>\nWindows: <code>go version go1.8.3 windows/amd64</code></p>\n\n<p>go env:<br>\nLinux: <a href=\"https://pastebin.com/pXURKfj3\" rel=\"nofollow noreferrer\">https://pastebin.com/pXURKfj3</a><br>\nWindows: <a href=\"https://pastebin.com/MTdjNnVW\" rel=\"nofollow noreferrer\">https://pastebin.com/MTdjNnVW</a>  </p>\n\n<p>Example 1: <a href=\"https://play.golang.org/p/x-eD6bBrzz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/x-eD6bBrzz</a><br>\nExample 2: <a href=\"https://play.golang.org/p/FSg8P7UP8p\" rel=\"nofollow noreferrer\">https://play.golang.org/p/FSg8P7UP8p</a></p>\n\n<p>Is my examples has data race? Both of them no according to build with <code>go build -race</code></p>\n\n<p>If examples above hasnt data race condition, could somebody please send me example where i can see a real data race in Golang, so i can test the -race flag? I also found some examples on the web, some of them doesnt compiling, some of them same shows that there is no data race. </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["go", "buffalo"], "answers": [{"tags": [], "owner": {"reputation": 90, "user_id": 2561989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb9c8167660ab75048a0f24a7a3a0d0?s=128&d=identicon&r=PG", "display_name": "paganotoni", "link": "https://stackoverflow.com/users/2561989/paganotoni"}, "is_accepted": false, "score": 4, "last_activity_date": 1500305345, "creation_date": 1500305345, "answer_id": 45148112, "question_id": 44740204, "link": "https://stackoverflow.com/questions/44740204/delete-or-undo-buffalo-resource-generation/45148112#45148112", "title": "Delete or undo Buffalo resource generation", "body": "<p>You could use the destroy cli, fortunately there is a <code>destroy resource</code> command to help, you can do something like:</p>\n\n<p><code>\nbuffalo d resource &lt;name&gt;\n</code></p>\n\n<p>And it will guide you on which things to remove, or you could pass the --yes flag to simply remove all associated files. p.e:</p>\n\n<p><code>\nbuffalo d resource &lt;name&gt; --yes\n</code></p>\n\n<p>or </p>\n\n<p><code>\nbuffalo d resource &lt;name&gt; -y\n</code></p>\n"}], "owner": {"reputation": 1285, "user_id": 4227700, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/BKZJV.jpg?s=128&g=1", "display_name": "northsideknight", "link": "https://stackoverflow.com/users/4227700/northsideknight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526996140, "creation_date": 1498332608, "last_edit_date": 1526996140, "question_id": 44740204, "link": "https://stackoverflow.com/questions/44740204/delete-or-undo-buffalo-resource-generation", "title": "Delete or undo Buffalo resource generation", "body": "<p>I have generated a resource in Buffalo using the command:</p>\n\n<pre><code>buffalo g resource &lt;name&gt; &lt;flags&gt;\n</code></pre>\n\n<p>I have realized I have made a mistake in this resource generation, how do I</p>\n\n<ul>\n<li>Undo the generation of the resource?</li>\n<li>Remove/Destroy the resource?</li>\n</ul>\n\n<p>I do not see this in Buffalo's documentation or the <code>buffalo g resource --help</code> message.</p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498331833, "post_id": 44739687, "comment_id": 76461394, "body": "You are just launching the goroutines, but you&#39;ll have to wait until both are finished with their work: The (sub)array is <i>not</i> sorted until both goroutines finish. No magic here."}, {"owner": {"reputation": 1342, "user_id": 1216838, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c29171dbea109a0147226a1962a4d3c8?s=128&d=identicon&r=PG", "display_name": "Pita", "link": "https://stackoverflow.com/users/1216838/pita"}, "edited": false, "score": 0, "creation_date": 1498509768, "post_id": 44739687, "comment_id": 76517748, "body": "In your base case, you would need to tell the WaitGroup that you are done waiting."}], "answers": [{"comments": [{"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1498336037, "post_id": 44740369, "comment_id": 76462528, "body": "Yeah, but then how can I maintain the <code>defer wg.Done()</code> if I have recursive calls"}, {"owner": {"reputation": 303, "user_id": 8008395, "user_type": "registered", "profile_image": "https://graph.facebook.com/1019408758194319/picture?type=large", "display_name": "Bohdan Kostko", "link": "https://stackoverflow.com/users/8008395/bohdan-kostko"}, "reply_to_user": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1498336278, "post_id": 44740369, "comment_id": 76462604, "body": "You can pass reference to <code>wg</code> into your recursively called function as a parameter"}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1498336337, "post_id": 44740369, "comment_id": 76462618, "body": "Then I get: <code>fatal error: all goroutines are asleep - deadlock!</code>, updated the code I added"}, {"owner": {"reputation": 303, "user_id": 8008395, "user_type": "registered", "profile_image": "https://graph.facebook.com/1019408758194319/picture?type=large", "display_name": "Bohdan Kostko", "link": "https://stackoverflow.com/users/8008395/bohdan-kostko"}, "reply_to_user": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1498339073, "post_id": 44740369, "comment_id": 76463266, "body": "Could you please provide example of test data"}, {"owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1498340182, "post_id": 44740369, "comment_id": 76463538, "body": "I test this by this: <code>&#47;&#47; Main function func main() { \ta := []int{6, 7, 2, 9, 1, 8, 27, 21, 53738, 11, 6432, 7234, 22, 56, 291, 2588} \tvar wg sync.WaitGroup \tmysort.ConcurrentQuicksort(a, 0, len(a)-1, &amp;wg) \twg.Wait() \tfmt.Println(a) } </code>"}, {"owner": {"reputation": 303, "user_id": 8008395, "user_type": "registered", "profile_image": "https://graph.facebook.com/1019408758194319/picture?type=large", "display_name": "Bohdan Kostko", "link": "https://stackoverflow.com/users/8008395/bohdan-kostko"}, "reply_to_user": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "edited": false, "score": 0, "creation_date": 1498427291, "post_id": 44740369, "comment_id": 76482729, "body": "@Frynio the code that would work for you could be found here <a href=\"https://play.golang.org/p/Z-UCHuFzn8\" rel=\"nofollow noreferrer\">play.golang.org/p/Z-UCHuFzn8</a>. However, I&#39;m not sure what exactly you&#39;re trying to achieve - non-concurrent sorting would slower here"}], "tags": [], "owner": {"reputation": 303, "user_id": 8008395, "user_type": "registered", "profile_image": "https://graph.facebook.com/1019408758194319/picture?type=large", "display_name": "Bohdan Kostko", "link": "https://stackoverflow.com/users/8008395/bohdan-kostko"}, "is_accepted": false, "score": 0, "last_activity_date": 1498333696, "creation_date": 1498333696, "answer_id": 44740369, "question_id": 44739687, "link": "https://stackoverflow.com/questions/44739687/concurrent-quicksort/44740369#44740369", "title": "Concurrent quicksort", "body": "<p>You could use the <code>sync</code> package here. Creating a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\">WaitGroup</a> will actually do not go further down the thread until all of your go routines are actually done. It has pretty trivial interface. Here is the example of usage.</p>\n\n<pre><code>func main() {\n    var wg sync.WaitGroup\n\n    for i := 0; i &lt; 1000; i++ {\n        wg.Add(1)\n        go func(index int) {\n            defer wg.Done()\n            fmt.Println(\"I'm done and my index is\", index)\n        }(i)\n    }\n\n    wg.Wait()\n\n    fmt.Println(\"This message is actually printed after all goroutines are done\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1697, "user_id": 5172820, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/da4f4afa5dabda9b8e3de78e61e55713?s=128&d=identicon&r=PG&f=1", "display_name": "minecraftplayer1234", "link": "https://stackoverflow.com/users/5172820/minecraftplayer1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551393534, "creation_date": 1498329078, "last_edit_date": 1498395962, "question_id": 44739687, "link": "https://stackoverflow.com/questions/44739687/concurrent-quicksort", "title": "Concurrent quicksort", "body": "<p>So I've implemented a quicksort algorithm in go. I tested it with <code>go test</code>, works perfectly well. Now I wanted to make it concurrent and check the differences in computational times. Algorithm looks like this:</p>\n\n<pre><code>package mysort\n\nimport (\n    \"math/rand\"\n)\n\n// ConcurrentPartition - ConcurrentQuicksort function for partitioning the array (randomized choice of a pivot)\nfunc ConcurrentPartition(A []int, p int, r int) int {\n    index := rand.Intn(r-p) + p\n    pivot := A[index]\n    A[index] = A[r]\n    A[r] = pivot\n    x := A[r]\n    j := p - 1\n    i := p\n    for i &lt; r {\n        if A[i] &lt;= x {\n            j++\n            tmp := A[j]\n            A[j] = A[i]\n            A[i] = tmp\n        }\n        i++\n    }\n    temp := A[j+1]\n    A[j+1] = A[r]\n    A[r] = temp\n    return j + 1\n}\n\n// ConcurrentQuicksort - a concurrent version of a quicksort algorithm\nfunc ConcurrentQuicksort(A []int, p int, r int) {\n    if p &lt; r {\n        q := ConcurrentPartition(A, p, r)\n        ConcurrentQuicksort(A, p, q-1)\n        ConcurrentQuicksort(A, q+1, r)\n    }\n}\n</code></pre>\n\n<p>Every <code>ConcurrentQuicksort</code> is actuall independent by default as its build on <code>divide and conquer</code> philosophy. So the only thing I did was adding <code>go</code> keyword before every recursive call, like this:</p>\n\n<pre><code>go ConcurrentQuicksort(A, p, q-1)\ngo ConcurrentQuicksort(A, q+1, r)\n</code></pre>\n\n<p>I didnt't work. As I've seen it just took a array and didn't even once called the recursive quicksort. So I've added <code>time</code> import and this line:</p>\n\n<p><code>time.Sleep(time.Second * 2)</code> (thats after <code>if</code>)</p>\n\n<p>And it worked. So I guess it needed time to complete all the operations. How can I now make it without waiting? Should I use channel, or maybe call the functions differently?</p>\n\n<p>@Edit Added this:</p>\n\n<pre><code>func ConcurrentQuicksort(A []int, p int, r int, wg *sync.WaitGroup) {\n    if p &lt; r {\n        q := ConcurrentPartition(A, p, r)\n        wg.Add(2)\n        go ConcurrentQuicksort(A, p, q-1, wg)\n        go ConcurrentQuicksort(A, q+1, r, wg)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1498331867, "post_id": 44739294, "comment_id": 76461400, "body": "Install Go from the official release."}, {"owner": {"reputation": 165, "user_id": 6475160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a70867403bef59444d9b8722651424?s=128&d=identicon&r=PG&f=1", "display_name": "Qubert", "link": "https://stackoverflow.com/users/6475160/qubert"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498344123, "post_id": 44739294, "comment_id": 76464417, "body": "Indeed installing from official does work... I&#39;m still curious as to why the installed version borked, but I guess it serves me right for trying to take the easy way out. Thanks."}], "owner": {"reputation": 165, "user_id": 6475160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a70867403bef59444d9b8722651424?s=128&d=identicon&r=PG&f=1", "display_name": "Qubert", "link": "https://stackoverflow.com/users/6475160/qubert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498396730, "creation_date": 1498326664, "last_edit_date": 1498396730, "question_id": 44739294, "link": "https://stackoverflow.com/questions/44739294/race-detector-runtime-error", "title": "Race detector runtime error", "body": "<p>The golang race detector is crashing/not running. Error output is:</p>\n\n<pre><code>$ go test -race\n# testmain\nruntime.RaceErrors: relocation target __tsan_report_count not defined\nruntime.RaceErrors: undefined: \"__tsan_report_count\"\nFAIL    raft/vendor/raft/connectionManager [build failed]\n</code></pre>\n\n<p>go is newly installed 1.8 from Ubuntu repository.\nGo race runtime was reinstalled from apt.</p>\n\n<p>go env:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"~/Source/Go--Dev/bin\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"~/Source/Go--Dev\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go-1.8\"\nGOTOOLDIR=\"/usr/lib/go-1.8/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build905991578=/tmp/go-build -gno-record-gcc-switches\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nPKG_CONFIG=\"pkg-config\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["go", "interface", "package"], "comments": [{"owner": {"reputation": 25, "user_id": 7479962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a25441f8164e5125d0e0b9e86a2f1e?s=128&d=identicon&r=PG&f=1", "display_name": "Err0r500", "link": "https://stackoverflow.com/users/7479962/err0r500"}, "edited": false, "score": 0, "creation_date": 1498883890, "post_id": 44738878, "comment_id": 76695064, "body": "Finally I implemented the same kind of logic using a clean architecture. Here&#39;s a minimal example : <a href=\"https://github.com/Err0r500/cleanArchitectureGolang\" rel=\"nofollow noreferrer\">github.com/Err0r500/cleanArchitectureGolang</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 0, "last_activity_date": 1498341108, "last_edit_date": 1498341108, "creation_date": 1498330399, "answer_id": 44739875, "question_id": 44738878, "link": "https://stackoverflow.com/questions/44738878/import-specific-package/44739875#44739875", "title": "Import specific package", "body": "<p>You can utilize the Go conditional build via build tags and target your compilation of main.go. </p>\n\n<p>Refer this <a href=\"https://dave.cheney.net/2014/09/28/using-build-to-switch-between-debug-and-release\" rel=\"nofollow noreferrer\">article</a> and put your thoughts into action.</p>\n\n<p><strong>For Example:</strong></p>\n\n<p>Directory structure </p>\n\n<pre><code>build-tags\n\u251c\u2500\u2500 build-tags\n\u251c\u2500\u2500 dummy\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 dummy.go\n\u251c\u2500\u2500 main_dummy.go\n\u251c\u2500\u2500 main_postgres.go\n\u2514\u2500\u2500 postgres\n    \u2514\u2500\u2500 postgres.go\n</code></pre>\n\n<p><strong>Sample implementation:</strong></p>\n\n<p>dummy/dummy.go</p>\n\n<pre><code>package dummy\n\nimport \"fmt\"\n\nfunc PrintName() {\n    fmt.Println(\"My name is dummy package\")\n}\n</code></pre>\n\n<p>postgres/postgres.go</p>\n\n<pre><code>package postgres\n\nimport \"fmt\"\n\nfunc PrintName() {\n    fmt.Println(\"My name is postgres package\")\n}\n</code></pre>\n\n<p>main_dummy.go</p>\n\n<pre><code>// +build dummy\n\npackage main\n\nimport \"build-tags/dummy\"\n\nfunc main() {\n    dummy.PrintName()\n}\n</code></pre>\n\n<p>postgres.go</p>\n\n<pre><code>// +build postgres\n\npackage main\n\nimport \"build-tags/postgres\"\n\nfunc main() {\n    postgres.PrintName()\n}\n</code></pre>\n\n<p>Now let's build targeting <code>dummy</code> tag, same way you can do for <code>postgres</code> tag.</p>\n\n<pre><code>go build --tags=\"dummy\"\n\n# run the program\n./build-tags\n\nMy name is dummy package\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7479962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a25441f8164e5125d0e0b9e86a2f1e?s=128&d=identicon&r=PG&f=1", "display_name": "Err0r500", "link": "https://stackoverflow.com/users/7479962/err0r500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 44739875, "answer_count": 1, "score": 0, "last_activity_date": 1498395974, "creation_date": 1498323886, "last_edit_date": 1498395974, "question_id": 44738878, "link": "https://stackoverflow.com/questions/44738878/import-specific-package", "title": "Import specific package", "body": "<p>I'm trying to solve a dependency problem : let's say I want to keep the code in my main.go totally decoupled from my database, I created 2 packages for that : dummy &amp; postgres. </p>\n\n<pre><code>/app/\n-- main.go\n\n/dummy/\n-- dummy.go\n\n/postgres/\n-- postgres.go\n</code></pre>\n\n<p>Everything is working fine, I just have to select in my main.go which package I would like to import to get a behavior or another... but is there a way to choose that when <em>building</em> main.go ?</p>\n\n<p>If there's a more idiomatic way to achieve this, I'm of course very interested ! </p>\n"}, {"tags": ["go", "repository"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1498396801, "post_id": 44737505, "comment_id": 76474386, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9985559/organizing-a-multiple-file-go-project\">Organizing a multiple-file Go project</a>"}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 2, "last_activity_date": 1498315777, "creation_date": 1498315777, "answer_id": 44737619, "question_id": 44737505, "link": "https://stackoverflow.com/questions/44737505/correct-structure-of-golang-repository/44737619#44737619", "title": "Correct structure of Golang repository", "body": "<p>That all depends. There is not a single right way for everything.</p>\n\n<p>It seems as if this repo decided to vendor everything, the whole GOPATH. That is okay but with the \"modern\" <code>vendor</code> folder today one would do it probably differently.</p>\n\n<p>Never do <code>go run</code>. That's for toy programs only. Build your software with <code>go build</code> and <code>go install</code>. These command work on package path.</p>\n\n<p>For everything else: Please see the official documentation <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html</a> and stick to it (which means you should move stuff around a bit).</p>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1498315777, "creation_date": 1498314857, "question_id": 44737505, "link": "https://stackoverflow.com/questions/44737505/correct-structure-of-golang-repository", "title": "Correct structure of Golang repository", "body": "<p>I am starting in Golang development. Right now my boss gave me the repository of a project that other developer made, now he's gone of the company and I am not able to ask him some things related to it. Right now I have a confussion about the project structure that he pushed to the repo, the structure is the next:</p>\n\n<pre><code> |-MyApp\n |--bin\n |--pkg\n |--src\n |----api (the code of the app)\n |----github.com\n |----golang.org\n |----gopkg.in\n</code></pre>\n\n<p>To me, it's exaclty as the estructure of the Go, 1.- in the repo should not be only the <em>api</em> folder?\nIf I go to the api folder and make <code>go run main.go</code> I get a message that some packages are not found even when they are in the folder, 2.-how I specify the packages in the go run command?</p>\n\n<p>3.- Is a good practice to set this kind of structure for the golang projects? I see in the code that he exported the packages only with \"package1\", if I copy and paste the code of the app inside the golang workspace then I have to specify the name of the folder to export the packages, example: \"myApp/package1\" so there I have that doubt. Thank you</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 1, "creation_date": 1498299310, "post_id": 44735281, "comment_id": 76452140, "body": "Does <a href=\"https://tour.golang.org/methods/4\" rel=\"nofollow noreferrer\">tour.golang.org/methods/4</a> help, or do you still have questions after reading that?"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 2, "creation_date": 1498299361, "post_id": 44735281, "comment_id": 76452151, "body": "The most significant part of that page: &quot;With a value receiver, the Scale method operates on a copy of the original Vertex value. (This is the same behavior as for any other function argument.)&quot;"}, {"owner": {"reputation": 627, "user_id": 4384879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NpW7Lo-JCr4/AAAAAAAAAAI/AAAAAAAAAB4/uVBIF-SncBs/photo.jpg?sz=128", "display_name": "Francesco Cina", "link": "https://stackoverflow.com/users/4384879/francesco-cina"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1498300095, "post_id": 44735281, "comment_id": 76452338, "body": "@smarx thanks, it helps but it does not solve all my doubts about what really happens. What does it mean exactly &quot;With a value receiver, the Scale method operates on a copy of the original Vertex value.&quot;? Does it mean that a new instance of the struct will be created on the fly and all the original instance fields will be duplicated recursively? So if a huge object it passed as a value receiver it could fill all the available memory?"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1498300248, "post_id": 44735281, "comment_id": 76452374, "body": "Yes, your understanding is essentially correct."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498300641, "post_id": 44735281, "comment_id": 76452463, "body": "This is a 100% duplicate. This question gets asked a lot an the internet is full of explanations, including the official documentation of Go."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498300753, "post_id": 44735281, "comment_id": 76452492, "body": "@Volker Then find the right question and vote to close this as a duplicate of it."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498300773, "post_id": 44735281, "comment_id": 76452497, "body": "@FrancescoCina &quot;So if a huge object it passed as a value receiver it could fill all the available memory?&quot; No, because no such large object are common in Go. There is <b>absolutely</b> no reason to be concerned about this copy operation. It is <i>really</i> hard to produce a struct where this copy is noticeable."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1498302825, "post_id": 44735281, "comment_id": 76452999, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11810218/how-to-set-and-get-fields-in-golang-structs\" title=\"how to set and get fields in golang structs\">stackoverflow.com/questions/11810218/&hellip;</a> and others."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5952594"}, "is_accepted": true, "score": 1, "last_activity_date": 1498300962, "creation_date": 1498300962, "answer_id": 44735512, "question_id": 44735281, "link": "https://stackoverflow.com/questions/44735281/go-write-struct-fields-in-function/44735512#44735512", "title": "Go, write struct fields in function", "body": "<p>One thing to remember while you were defining methods is:</p>\n\n<p>Methods are like normal functions, and when you were calling <code>setValue()</code> function, what's happening is this.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype vertex struct {\n    x int\n    y int\n}\n\nfunc main() {\n    var v vertex\n    fmt.Println(v.setVertex(1, 2))\n    fmt.Println(v)\n/*  v = v.setVertex(1,2)\n    // we are assigning the returned variable address to v.\n    fmt.Println(v)\n*/\n\n}\n\n\n// With a value receiver, the setVertex method operates on a copy of the \n// original vertex value. (This is the same behavior as for any other\n// function argument.) \n// This methods has a value as a reciver, so it gets the copy not the \n// original vertex.\n\nfunc (v vertex) setVertex(x, y int) vertex {\n// Here it is similar to creating a new variable with name 'v',\n// Go is lexically scoped using blocks, so this variable exists only \n// in this block, while it is returned we are printing it but we didn't\n// store it in another variable.\n    v.x = x\n    v.y = y\n    return v\n}\n\n// If you want to change any variable or struct, we need to pass its \n// address, else only copy of that variable is received by the called\n// function.\n</code></pre>\n\n<p>This is clearly explained in <a href=\"https://tour.golang.org/methods/4\" rel=\"nofollow noreferrer\">gotour</a></p>\n"}], "owner": {"reputation": 627, "user_id": 4384879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NpW7Lo-JCr4/AAAAAAAAAAI/AAAAAAAAAB4/uVBIF-SncBs/photo.jpg?sz=128", "display_name": "Francesco Cina", "link": "https://stackoverflow.com/users/4384879/francesco-cina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 44735512, "answer_count": 1, "score": 0, "last_activity_date": 1498300962, "creation_date": 1498299086, "question_id": 44735281, "link": "https://stackoverflow.com/questions/44735281/go-write-struct-fields-in-function", "title": "Go, write struct fields in function", "body": "<p>I am new in Go and I don't understand why the struct field values are not written if I don't use a pointer in the struct functions. Here an example, when setValue() is called, it executes but the value is not set:</p>\n\n<pre><code>type myStruct struct {\n    value string\n}\n\nfunc (m myStruct) getValue() string            { return m.value }\nfunc (m myStruct) setValue(val string)         { m.value = val }\nfunc (m *myStruct) getValuePointer() string    { return m.value }\nfunc (m *myStruct) setValuePointer(val string) { m.value = val }\n\nfunc TestStruct(t *testing.T) {\n    obj := myStruct{value: \"initValue\"}\n\n    fmt.Printf(\"Use setValue function\\n\")\n    obj.setValue(\"setValue_Called\")\n    fmt.Printf(\"obj.getValue()        = [%v]\\n\", obj.getValue())\n    fmt.Printf(\"obj.getValuePointer() = [%v]\\n\", obj.getValuePointer())\n\n    fmt.Printf(\"Use setValuePointer function\\n\")\n    obj.setValuePointer(\"setValuePointer_Called\")\n    fmt.Printf(\"obj.getValue()        = [%v]\\n\", obj.getValue())\n    fmt.Printf(\"obj.getValuePointer() = [%v]\\n\", obj.getValuePointer())\n}\n</code></pre>\n\n<p>this code prints:</p>\n\n<pre><code>Use setValue function\nobj.getValue()        = [initValue]\nobj.getValuePointer() = [initValue]\nUse setValuePointer function\nobj.getValue()        = [setValuePointer_Called]\nobj.getValuePointer() = [setValuePointer_Called]\n</code></pre>\n\n<p>Could someone help me understanding what happens under the hood when a struct function is created using or not using a pointer?\nIn addition, the fact that setValue executes with no errors or warnings is quite scaring to me :(</p>\n"}, {"tags": ["html", "loops", "go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1498297147, "last_edit_date": 1498297147, "creation_date": 1498293822, "answer_id": 44734585, "question_id": 44734529, "link": "https://stackoverflow.com/questions/44734529/compare-two-variables-inside-go-template/44734585#44734585", "title": "Compare two variables inside Go template", "body": "<p>The problem is that the <code>{{range}}</code> action changes (sets) the dot (<code>.</code>) even if you use loop variables (<code>$key</code> and <code>$value</code>) in your case. Inside a <code>{{range}}</code> the dot is set to the current element.</p>\n\n<p>And inside <code>{{range}}</code> you write:</p>\n\n<pre><code>{{ if eq $key .Res.Type }}\n</code></pre>\n\n<p>Since values in your loop are <code>string</code> values, <code>.Res.Type</code> is an error, because there is no <code>Res</code> field or method of a <code>string</code> value (the current element denoted by the dot <code>.</code>).</p>\n\n<p>Use the <code>$</code> sign to not refer to the loop value, but to the param passed to the template execution:</p>\n\n<pre><code>{{ if eq $key $.Res.Type }}\n</code></pre>\n\n<p>This will work, but won't give you the desired output, as you have a typo:</p>\n\n<pre><code>res := &amp;Result{Type: \"findAllString\"}\n</code></pre>\n\n<p>Use capital letter in <code>Result</code> as your <code>types</code> map also contains values with capital letter:</p>\n\n<pre><code>res := &amp;Result{Type: \"FindAllString\"}\n</code></pre>\n\n<p>With this you get the desired output (try it on the <a href=\"https://play.golang.org/p/ZtZAoeOtF3\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2009/11/10 23:00:00 \n    &lt;select name=\"type\"&gt;\n                &lt;option value=\"FindAllString\" selected&gt;FindAllString&lt;/option&gt;\n                &lt;option value=\"FindString\"&gt;FindString&lt;/option&gt;\n                &lt;option value=\"FindStringSubmatch\"&gt;FindStringSubmatch&lt;/option&gt;\n    &lt;/select&gt;\n</code></pre>\n\n<p>Also note that you could simply write the loop like this:</p>\n\n<pre><code>{{range $key, $value := .Types}}\n    &lt;option value=\"{{$key}}\"{{if eq $key $.Res.Type}} selected{{end}}&gt;{{.}}&lt;/option&gt;\n{{end}}\n</code></pre>\n\n<p>Also note that for testing purposes you may simply pass <code>os.Stdout</code> as the writer for template execution, and you'll see the result on your console without having to create and use a buffer, e.g.:</p>\n\n<pre><code>err = t.Execute(os.Stdout, struct {\n    Types map[string]string\n    Res   *Result\n}{types, res})\n</code></pre>\n\n<p>Try the simplified version on the <a href=\"https://play.golang.org/p/pEvOsU-bNS\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>Read this answer for more insights: <a href=\"https://stackoverflow.com/questions/42507958/golang-template-engine-pipelines/42508255#42508255\">golang template engine pipelines</a></p>\n"}], "owner": {"reputation": 305, "user_id": 8131948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sX40L.png?s=128&g=1", "display_name": "Tobias Meyer", "link": "https://stackoverflow.com/users/8131948/tobias-meyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7426, "favorite_count": 0, "accepted_answer_id": 44734585, "answer_count": 1, "score": 9, "last_activity_date": 1498297147, "creation_date": 1498293292, "last_edit_date": 1498294235, "question_id": 44734529, "link": "https://stackoverflow.com/questions/44734529/compare-two-variables-inside-go-template", "title": "Compare two variables inside Go template", "body": "<p>In the data I pass to my template I have the two variables <code>Type</code> and <code>Res.Type</code> I want to compare to preselect an option for my select field.</p>\n\n<p>To illustrate my problem I have created this simplified version:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"bytes\"\n    \"html/template\"\n    \"log\"\n)\n\ntype Result struct{ Type string }\n\nfunc main() {\n    types := map[string]string{\n        \"FindAllString\":      \"FindAllString\",\n        \"FindString\":         \"FindString\",\n        \"FindStringSubmatch\": \"FindStringSubmatch\",\n    }\n    res := &amp;Result{Type: \"findAllString\"}\n\n    templateString := `\n    &lt;select name=\"type\"&gt;\n        {{ range $key,$value := .Types }}\n            {{ if eq $key .Res.Type }}\n                &lt;option value=\"{{$key}}\" selected&gt;{{$value}}&lt;/option&gt;\n            {{ else }}\n                &lt;option value=\"{{$key}}\"&gt;{{$value}}&lt;/option&gt;\n            {{ end }}\n        {{ end }}\n    &lt;/select&gt;`\n    t, err := template.New(\"index\").Parse(templateString)\n    if err != nil {\n        panic(err)\n    }\n    var b bytes.Buffer\n    writer := bufio.NewWriter(&amp;b)\n    err = t.Execute(writer, struct {\n        Types map[string]string\n        Res   *Result\n    }{types, res})\n    if err != nil {\n        panic(err)\n    }\n    writer.Flush()\n    log.Println(b.String())\n}\n</code></pre>\n\n<p>It should select the <code>\"FindAllString\"</code> option but it only generates the error</p>\n\n<pre><code>panic: template: index:4:21: executing \"index\" at &lt;.Res.Type&gt;: can't evaluate field Res in type string\n\ngoroutine 1 [running]:\npanic(0x53f6e0, 0xc4200144c0)\n    /usr/local/go/src/runtime/panic.go:500 +0x1a1\nmain.main()\n    /home/tobias/ngo/src/github.com/gamingcoder/tmp/main.go:41 +0x523\nexit status 2\n</code></pre>\n\n<p>When I just compare two normal strings it works but I want to know if there is an idomatic way to do this. I have seen that you could add a function to the template but I feel that there must be a simpler way for this.</p>\n"}, {"tags": ["linux", "go"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6646388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b989b59b6f8c95f315f4c068b548073?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Morley", "link": "https://stackoverflow.com/users/6646388/nathan-morley"}, "is_accepted": false, "score": 0, "last_activity_date": 1498321089, "creation_date": 1498321089, "answer_id": 44738441, "question_id": 44734450, "link": "https://stackoverflow.com/questions/44734450/wrapping-data-file-to-golang-app-and-use-in-exec/44738441#44738441", "title": "Wrapping data file to golang app and use in exec", "body": "<p>For building the data file(s) in to your program, you have a number of choices. You are correct in that you could manually copy/paste the data file(s) in to the program as types <code>string</code>, <code>[]byte</code> as variables, but there are other packages/applications for go that handle this for you already that can also minimize your app's memory footprint. One example that comes to mind is <code>go-bindata</code> (<a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">link to repo</a>) which does just this.</p>\n\n<p>As for using the file in <code>os/exec</code>, I'm assuming you're trying to either pass the entire file to the program using either a file path or a raw string. For file paths, you would have to write the entire file to disk first. If you're trying to pass the entire file contents as a raw string, you can still use <code>go-bindata</code> or a <code>string</code> of the data file as <code>arg</code> in <code>os/exec.Command</code>.</p>\n\n<p>P.S. - <code>go-bindata</code> has not seen updates in a while, so I would encourage you to seek more active forks or alternatives if you're having trouble using it.</p>\n"}], "owner": {"reputation": 133, "user_id": 8181815, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf817e25694843bbee3b913731ff36fd?s=128&d=identicon&r=PG&f=1", "display_name": "kajaptz", "link": "https://stackoverflow.com/users/8181815/kajaptz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498321089, "creation_date": 1498292591, "last_edit_date": 1498300069, "question_id": 44734450, "link": "https://stackoverflow.com/questions/44734450/wrapping-data-file-to-golang-app-and-use-in-exec", "title": "Wrapping data file to golang app and use in exec", "body": "<p>I would like to wrap a data file (~1MB) to golang app and then use that data in <code>os.exec</code>. The app runs on Linux.</p>\n\n<p>How to define the data in the app, as a <code>string</code> or <code>[]byte</code>, variable, or Const? </p>\n\n<p>Should be defined in a global scope, or wrapped in a <code>func</code>?</p>\n\n<p>How to pass the data from the app memory to the <strong>executed</strong> process ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498300805, "post_id": 44732508, "comment_id": 76452509, "body": "Duplicate but too lazy too look it up."}, {"owner": {"reputation": 1705, "user_id": 2754724, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0db5a1fac483a5c97d7084b35483c8b7?s=128&d=identicon&r=PG&f=1", "display_name": "Crusaderpyro", "link": "https://stackoverflow.com/users/2754724/crusaderpyro"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498301247, "post_id": 44732508, "comment_id": 76452599, "body": "The duplicate ones are the ones where the field is not exported."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1498315843, "post_id": 44732508, "comment_id": 76456793, "body": "No, consuming the body for debug printing and wondering why decoding it once more yields empty is common too."}], "answers": [{"comments": [{"owner": {"reputation": 1705, "user_id": 2754724, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0db5a1fac483a5c97d7084b35483c8b7?s=128&d=identicon&r=PG&f=1", "display_name": "Crusaderpyro", "link": "https://stackoverflow.com/users/2754724/crusaderpyro"}, "edited": false, "score": 0, "creation_date": 1498282386, "post_id": 44732655, "comment_id": 76448373, "body": "Yes. That does work but realised it works only when the struct Response definition is in the same package. It is giving an empty struct if the definition of the struct is in a different package. Also, the field of the struct Message is already exported (starts with a capital letter)"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 1705, "user_id": 2754724, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0db5a1fac483a5c97d7084b35483c8b7?s=128&d=identicon&r=PG&f=1", "display_name": "Crusaderpyro", "link": "https://stackoverflow.com/users/2754724/crusaderpyro"}, "edited": false, "score": 0, "creation_date": 1498282550, "post_id": 44732655, "comment_id": 76448402, "body": "Behavior is same wherever the struct is located, since you create an variable and supply to decode. Can you please add the code to the question at the end?"}, {"owner": {"reputation": 1705, "user_id": 2754724, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0db5a1fac483a5c97d7084b35483c8b7?s=128&d=identicon&r=PG&f=1", "display_name": "Crusaderpyro", "link": "https://stackoverflow.com/users/2754724/crusaderpyro"}, "edited": false, "score": 0, "creation_date": 1498301320, "post_id": 44732655, "comment_id": 76452617, "body": "Ok. We had some generated easy json things because of which it wasn&#39;t working. Anyway, ur solution is correct. Thanks a lot."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 4, "last_activity_date": 1498277393, "creation_date": 1498277393, "answer_id": 44732655, "question_id": 44732508, "link": "https://stackoverflow.com/questions/44732508/in-golang-json-decoder-returning-an-empty-struct-but-ioutil-readall-shows-the-m/44732655#44732655", "title": "In Golang, json decoder returning an empty struct but ioutil.ReadAll shows the message", "body": "<p>If you have read <code>resp.Body</code> before the JSON <code>Decode</code> then it has no input to decode.</p>\n\n<p>Try only -</p>\n\n<pre><code>response := &amp;Response{}\njson.NewDecoder(resp.Body).Decode(response)\nfmt.Println(\"response struct:\", response)\n</code></pre>\n"}], "owner": {"reputation": 1705, "user_id": 2754724, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0db5a1fac483a5c97d7084b35483c8b7?s=128&d=identicon&r=PG&f=1", "display_name": "Crusaderpyro", "link": "https://stackoverflow.com/users/2754724/crusaderpyro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1170, "favorite_count": 0, "accepted_answer_id": 44732655, "answer_count": 1, "score": 0, "last_activity_date": 1498307038, "creation_date": 1498275564, "question_id": 44732508, "link": "https://stackoverflow.com/questions/44732508/in-golang-json-decoder-returning-an-empty-struct-but-ioutil-readall-shows-the-m", "title": "In Golang, json decoder returning an empty struct but ioutil.ReadAll shows the message", "body": "<p>The response struct is as follows:</p>\n\n<pre><code>type Response struct {\n    Message string `json:\"message\"`\n}\n</code></pre>\n\n<p>The code is as follows:</p>\n\n<pre><code>body, _ := ioutil.ReadAll(resp.Body)\nfmt.Println(\"response Body:\", string(body))\n\nresponse := &amp;Response{}\njson.NewDecoder(resp.Body).Decode(response)\nfmt.Println(\"response struct:\", response)\n</code></pre>\n\n<p>The output is as follows:</p>\n\n<pre><code>response Body: {\"Message\":\"success\"}\n\nresponse struct: &amp;{}\n</code></pre>\n\n<p>As we can see, the response body string is fine and contains the json strin. But when I try to decode the response body to a json, I get an empty struct.</p>\n\n<p>I already have the Message field exported in the struct so that the json package has access to it. What am I still missing here ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "edited": false, "score": 1, "creation_date": 1498282588, "post_id": 44732628, "comment_id": 76448408, "body": "I have set GOPATH and GOBIN, still nothing generate [](<a href=\"http://codepad.org/qHFB6x91\" rel=\"nofollow noreferrer\">codepad.org/qHFB6x91</a>)"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "edited": false, "score": 0, "creation_date": 1498282787, "post_id": 44732628, "comment_id": 76448450, "body": "As explained in the answer if you do <code>go build pic.go</code> binary will be in the same directory. If you do <code>go build -i pic.go</code> binary will be in <code>$GOPATH&#47;bin</code> directory."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "edited": false, "score": 0, "creation_date": 1498282905, "post_id": 44732628, "comment_id": 76448472, "body": "More importantly your source should reside inside <code>$GOPATH&#47;src&#47;&lt;project-name&gt;&#47;...</code>."}, {"owner": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "edited": false, "score": 0, "creation_date": 1498287044, "post_id": 44732628, "comment_id": 76449310, "body": "I <code>mkdir src</code> and mv pic.go to ./src, still nothing generate. Try <code>build -i</code> got an error: flag provided but not defined: -i usage: build [-o output] [build flags] [packages]  Build compiles the packages named by the import paths, along with their dependencies, but it does not install the results ......."}, {"owner": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "edited": false, "score": 0, "creation_date": 1498287624, "post_id": 44732628, "comment_id": 76449450, "body": "PS, pic.go is from <a href=\"https://github.com/golang/tour/blob/master/pic/pic.go\" rel=\"nofollow noreferrer\">github.com/golang/tour/blob/master/pic/pic.go</a>"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "edited": false, "score": 0, "creation_date": 1498288273, "post_id": 44732628, "comment_id": 76449597, "body": "I have revised the answer with more details, give it try and let me know."}, {"owner": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "edited": false, "score": 0, "creation_date": 1498438033, "post_id": 44732628, "comment_id": 76484816, "body": "I <code>mkdir pic-project</code> in <code>.&#47;src</code> &amp;&amp; <code>mv pic.go pic-project</code>, then go to pic-project, type <code>go build pic.go</code>, still nothing generate nor error prompt. PS, my go version is 1.2.1, does that matter"}, {"owner": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "edited": false, "score": 0, "creation_date": 1498438409, "post_id": 44732628, "comment_id": 76484888, "body": "I can build a .go file that contain <code>func main()</code>, if I rename <code>func main()</code>, nothing generate"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "edited": false, "score": 0, "creation_date": 1498439339, "post_id": 44732628, "comment_id": 76485029, "body": "I think you&#39;re new golang, please start your learning from here <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>, <a href=\"https://gobyexample.com\" rel=\"nofollow noreferrer\">gobyexample.com</a>. I have answered your question, you can accept and start your learning. Good luck."}, {"owner": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "edited": false, "score": 0, "creation_date": 1498439857, "post_id": 44732628, "comment_id": 76485113, "body": "No luck so I need help"}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 0, "last_activity_date": 1498288233, "last_edit_date": 1498288233, "creation_date": 1498277133, "answer_id": 44732628, "question_id": 44732395, "link": "https://stackoverflow.com/questions/44732395/how-to-build-a-a-file-in-golang/44732628#44732628", "title": "How to build a .a file in golang", "body": "<blockquote>\n  <p>go install: no install location for .go files listed on command line (GOBIN not set)</p>\n</blockquote>\n\n<p>Create a <code>bin</code> directory under GOPATH parallel to <code>src</code>.</p>\n\n<p><strong>For e.g:</strong></p>\n\n<pre><code>GOPATH=/home/user/go\nGOBIN=$GOPATH/bin\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong> after comment interaction.</p>\n\n<p>Create your go workspace, refer to <a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow noreferrer\">workspace doc</a></p>\n\n<p>For e.g.:</p>\n\n<p>Directory Structure: GOPATH is <code>/home/user/go</code></p>\n\n<pre><code>/home/user/go/src/pic-project\n  \u2514\u2500\u2500 pic.go\n</code></pre>\n\n<p>Go to <code>/home/user/go/src/pic-project</code></p>\n\n<pre><code>go build pic.go\n\nls -ltr\n-rw-r--r--  1 jeeva  staff       84 Jun 23 23:55 pic.go\n-rwxr-xr-x  1 jeeva  staff  1624096 Jun 24 00:02 pic\n</code></pre>\n\n<p>Binary is in the same directory.</p>\n\n<p>Now, let's do <code>go install</code>, you can execute install command in following ways.</p>\n\n<p>Inside project directory (binary will be in <code>$GOPATH/bin</code> directory)</p>\n\n<pre><code>go install\n</code></pre>\n\n<p>OR from anywhere in the terminal-</p>\n\n<pre><code>go install pic-project\n</code></pre>\n\n<hr>\n\n<p>Also if you have project with main func and sub packages. Execute <code>go install &lt;import-path&gt;</code>, it will produce binary and sub-packages as <code>.a</code> files.</p>\n\n<pre><code>go install github.com/user/foo\n</code></pre>\n\n<p>You will find <code>foo.a</code> under <code>$GOPATH/pkg/GOOS_GOARCH/github.com/user/foo.a</code> and binary in the <code>$GOPATH/bin</code> directory.</p>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "is_accepted": false, "score": 1, "last_activity_date": 1498442869, "creation_date": 1498442869, "answer_id": 44752301, "question_id": 44732395, "link": "https://stackoverflow.com/questions/44732395/how-to-build-a-a-file-in-golang/44752301#44752301", "title": "How to build a .a file in golang", "body": "<p>I solved myself. \nThe key is: after type <code>go build xxx.go</code>, nothing generate, but it's not an error! </p>\n\n<p>I must continue type <code>go install sourcedir</code>, the source must inside a directory, then I found the <code>.a</code> file in <code>pkg</code> folder.</p>\n"}], "owner": {"reputation": 185, "user_id": 5546786, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/608c6f3959ee642e99ee4ee8824a919d?s=128&d=identicon&r=PG&f=1", "display_name": "Divlaker", "link": "https://stackoverflow.com/users/5546786/divlaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2047, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1498442869, "creation_date": 1498274212, "last_edit_date": 1498334620, "question_id": 44732395, "link": "https://stackoverflow.com/questions/44732395/how-to-build-a-a-file-in-golang", "title": "How to build a .a file in golang", "body": "<p>I tried <code>go build xxx.go</code>, no file output and no error prompt. I searched and found a solution said should use <code>go install xxx.go</code>, got a error :</p>\n\n<pre><code>go install: no install location for .go files listed on command line (GOBIN not set)\n</code></pre>\n\n<p>I search this error and found the solution is set the environment variable GOBIN, GOPATH and I did but it still does not work.</p>\n"}, {"tags": ["algorithm", "recursion", "go"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1498270328, "post_id": 44732016, "comment_id": 76446761, "body": "Large dataset is not working because of memory constraints?? Because otherwise it sounds like you&#39;ve got it working."}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1498270583, "post_id": 44732016, "comment_id": 76446794, "body": "not because of memory, I want to write something recursive so I can call the number of recursions....with the posted code, it is hard coded"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1498274208, "post_id": 44732016, "comment_id": 76447219, "body": "Oh.. Sorry I misread the post. I get it"}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "is_accepted": false, "score": 0, "last_activity_date": 1498459465, "creation_date": 1498459465, "answer_id": 44754283, "question_id": 44732016, "link": "https://stackoverflow.com/questions/44732016/recursive-travelling-salesman-like-calculation-in-go/44754283#44754283", "title": "recursive travelling salesman like calculation in go", "body": "<p>I came up with 2 recursions, please, check it on your data:\n(I suppose you're going to make this parallel, so this will be easier with 2 recursions, just as a <code>go rec2(...)</code>)</p>\n\n<pre><code>func main() {\n    rec(0,0)\n}\n\nfunc rec(a, b int) {\n    if a &gt;= len(fl) || b &gt;= len(fl) || a == b {\n        return\n    }\n    aa, bb := fl[a], fl[b]\n    if !aa.Connects(bb) {\n        rec(a, b+1)\n        return\n    }\n    l := []*Foo{\n        aa, bb,\n    }\n    completeList = append(completeList, l)\n\n    rec2(0, a, b)\n}\n\nfunc rec2(c, a, b int) {\n    if c &gt;= len(fl) || a == c || b == c {\n        return\n    }\n    cc, aa, bb := fl[c], fl[a], fl[b]\n    if cc.Connects(bb) &amp;&amp; aa.Completes(cc) {\n         l := []*Foo{\n              aa, bb, cc,\n         }\n         completeList = append(completeList, l)\n    }\n    rec2(c+1, a, b)\n}\n</code></pre>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498459465, "creation_date": 1498269406, "last_edit_date": 1498283008, "question_id": 44732016, "link": "https://stackoverflow.com/questions/44732016/recursive-travelling-salesman-like-calculation-in-go", "title": "recursive travelling salesman like calculation in go", "body": "<p>I have a function that is somewhat similar to the traveling salesman problem that I am trying to make recursive. I think it is working but I am having some trouble getting the appending to work correctly on large datasets. Here is what I have...main should be written to be recursive so I can call a variable number of recursions...<a href=\"https://play.golang.org/p/Lz8arHybFr\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Lz8arHybFr</a></p>\n\n<pre><code>package main\n\ntype Foo struct {\n    StartPoint string\n    EndPoint string \n    distance int\n}\n\nfunc (f *Foo) Connects(endFoo *Foo) bool {\n    return f.EndPoint == endFoo.StartPoint\n}\n\nfunc (f *Foo) Completes(endFoo *Foo) bool {\n    return f.StartPoint == endFoo.EndPoint\n}\n\nvar fl = []*Foo{\n    // many foo in here\n}\n\nfunc main() {\n\n    completeList := [][]*Foo{}\n\n    for _, first := range fl {\n        for _, second := range fl {\n            if second.Connects(first) {\n                if second.Completes(first) {\n                    l := []*Foo{\n                        first, second,\n                    }\n                    completeList = append(completeList, l)\n                }\n\n                //if the connection is made, but not complete, keep going\n                for _, third := range fl {\n                    if third.Connects(second) {\n                        if first.Completes(third) {\n                            l := []*Foo{\n                                first, second, third,\n                            }\n                            completeList = append(completeList, l)\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1498258981, "post_id": 44730995, "comment_id": 76444763, "body": "Did you mention <code>build tags</code> for these files appropriately? Refer to this <a href=\"https://dave.cheney.net/2013/10/12/how-to-use-conditional-compilation-with-the-go-build-tool\" rel=\"nofollow noreferrer\">article</a>."}], "answers": [{"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": false, "score": 1, "last_activity_date": 1498259895, "creation_date": 1498259895, "answer_id": 44731148, "question_id": 44730995, "link": "https://stackoverflow.com/questions/44730995/go-same-name-and-content-struct-in-one-package-which-one-will-be-initialised/44731148#44731148", "title": "Go : Same name and content struct in one package , which one will be initialised", "body": "<p>As presented, those files won't compile since you are declaring <code>Mounter</code> two times within the same package.</p>\n\n<p>Your options to make this work are:</p>\n\n<p>1) Use two different packages for each of those files, like:</p>\n\n<p><code>/src/components/mac/mount_mac.go</code></p>\n\n<p><code>/src/components/linux/mount_linux.go</code></p>\n\n<p>Then, import the package you need in each case.</p>\n\n<p>2) Use conditional build so that depending on the platform you are targeting, only one of the files is included.\nYou can use a <code>// +build</code> tag in each file.</p>\n\n<p>See more about that here: <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow noreferrer\">https://golang.org/pkg/go/build/#hdr-Build_Constraints</a></p>\n"}, {"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1498510460, "creation_date": 1498510460, "answer_id": 44768518, "question_id": 44730995, "link": "https://stackoverflow.com/questions/44730995/go-same-name-and-content-struct-in-one-package-which-one-will-be-initialised/44768518#44768518", "title": "Go : Same name and content struct in one package , which one will be initialised", "body": "<p>If you use the correct file suffixes, they will be conditionally built based on OS. Go does not refer to MacOS as \"mac\", it refers to it as \"darwin\" (the Mac kernel). It also correctly spells \"linux\", though I don't know if that was just typo'd in the question or if your file name on disk has the same typo. Alternatively, you can use explicit <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow noreferrer\">build constraints</a> rather than file names, but the file names are idiomatic for OS- or architecture-specific code.</p>\n\n<p>If the struct definitions are identical, you can put the struct in a general <code>mount.go</code> file, and just put the OS-specific method definitions in the OS-specific files to avoid unnecessary duplicate code.</p>\n"}], "owner": {"reputation": 107, "user_id": 1875488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a621b990f7bfe46e4b84fb30dc17f7?s=128&d=identicon&r=PG", "display_name": "orain", "link": "https://stackoverflow.com/users/1875488/orain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498510460, "creation_date": 1498258676, "question_id": 44730995, "link": "https://stackoverflow.com/questions/44730995/go-same-name-and-content-struct-in-one-package-which-one-will-be-initialised", "title": "Go : Same name and content struct in one package , which one will be initialised", "body": "<p><strong>There is a package named mount, which has two same name and content structs</strong> </p>\n\n<blockquote>\n  <p>mount_linxu.go</p>\n</blockquote>\n\n<pre><code>package mount\nimport \"fmt\"\ntype Mounter struct {\n}\nfunc (mounter *Mounter) DoMount(path string) (bool ,error){\nfmt.Printf(\"this is linux\")\nreturn true , nil\n}\n</code></pre>\n\n<blockquote>\n  <p>mount_mac.go</p>\n</blockquote>\n\n<pre><code>package mount\nimport \"fmt\"\ntype Mounter struct {\n}\nfunc (mounter *Mounter) DoMount(path string) (bool ,error){\nfmt.Printf(\"this is mac\")\nreturn true , nil\n}\n</code></pre>\n\n<blockquote>\n  <p>mount_test.go</p>\n</blockquote>\n\n<pre><code>func TestNew(t *testing.T) {\n mounter := New()\n mounter.DoMount(\"\")\n}\n</code></pre>\n\n<p>My Question is why Mounter in mount_mac.go will be initialised always?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1498250700, "post_id": 44729638, "comment_id": 76442136, "body": "I think they&#39;re trying to get an int, not a string"}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1498250842, "post_id": 44729638, "comment_id": 76442195, "body": "Good catch, thanks. Updated to reflect that."}], "tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": false, "score": 0, "last_activity_date": 1498250825, "last_edit_date": 1498250825, "creation_date": 1498250528, "answer_id": 44729638, "question_id": 44729587, "link": "https://stackoverflow.com/questions/44729587/join-digits-from-integer-array-into-one-number-in-golang/44729638#44729638", "title": "Join digits from integer array into one number in Golang?", "body": "<p>Iterate over your slice and add each item to a buffer:</p>\n\n<pre><code>var buf bytes.Buffer\nnums := []int{1, 2, 3}\nfor i := range nums {\n    buf.WriteString(fmt.Sprintf(\"%d\", nums[i]))\n}\n</code></pre>\n\n<p>You can then convert it into an integer using the strconv package.</p>\n\n<pre><code>i, err := strconv.Atoi(buf.String())\n</code></pre>\n\n<p>GoPlay here:<br>\n<a href=\"https://play.golang.org/p/8w-gc2S2xR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8w-gc2S2xR</a></p>\n"}, {"tags": [], "owner": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "is_accepted": false, "score": 4, "last_activity_date": 1498251117, "last_edit_date": 1498251117, "creation_date": 1498250769, "answer_id": 44729687, "question_id": 44729587, "link": "https://stackoverflow.com/questions/44729587/join-digits-from-integer-array-into-one-number-in-golang/44729687#44729687", "title": "Join digits from integer array into one number in Golang?", "body": "<p>Try something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"strconv\"\n    \"log\"\n)\n\nfunc join(nums []int) (int, error) {\n    var str string\n    for i := range nums {\n        str += strconv.Itoa(nums[i])\n    }\n    num, err := strconv.Atoi(str)\n    if err != nil {\n        return 0, err\n    } else {\n        return num, nil\n    }\n}\n\nfunc main() {\n    nums := []int{1, 2, 3}\n    num, err := join(nums)\n    if err != nil {\n        log.Println(err)\n    } else {\n        log.Println(num)\n    }\n}\n</code></pre>\n\n<p>Maybe there is a better way to do this, but this example works.</p>\n"}, {"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1498252040, "creation_date": 1498252040, "answer_id": 44729944, "question_id": 44729587, "link": "https://stackoverflow.com/questions/44729587/join-digits-from-integer-array-into-one-number-in-golang/44729944#44729944", "title": "Join digits from integer array into one number in Golang?", "body": "<p>You can also iterate over the slice and build the int with arithmetic</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc Pow(a, b int) int {\n    result := 1\n    for i := 0; i &lt; b; i++ {\n        result *= a\n    }\n    return result\n}\n\nfunc main() {\n    nums := []int{1, 2, 3}\n    num := 0\n    length := len(nums)\n    for i, d := range nums {\n        num += d * Pow(10, length-i-1)\n    }\n    fmt.Println(num)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 667, "user_id": 5627286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeYlo.jpg?s=128&g=1", "display_name": "aMike", "link": "https://stackoverflow.com/users/5627286/amike"}, "edited": false, "score": 1, "creation_date": 1498265889, "post_id": 44730447, "comment_id": 76446115, "body": "I think @sberry has the best answer. I&#39;d be tempted to simplify further and use <code>for _, x in s</code> and <code>res = 10*res + x</code>"}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 1, "creation_date": 1498292296, "post_id": 44730447, "comment_id": 76450561, "body": "What happens with <code>nums := []int{1, 20, 3}</code>? :)"}, {"owner": {"reputation": 667, "user_id": 5627286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeYlo.jpg?s=128&g=1", "display_name": "aMike", "link": "https://stackoverflow.com/users/5627286/amike"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1498325083, "post_id": 44730447, "comment_id": 76459454, "body": "Good point @MartinGallagher! One could argue that 20 is not a digit. It depends on what the requirements really are. Concat a bunch of arbitrary numbers, or reassemble a series of digits back into a number? We don&#39;t know; it wasn&#39;t specified."}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 3, "last_activity_date": 1498255786, "last_edit_date": 1498255786, "creation_date": 1498254919, "answer_id": 44730447, "question_id": 44729587, "link": "https://stackoverflow.com/questions/44729587/join-digits-from-integer-array-into-one-number-in-golang/44730447#44730447", "title": "Join digits from integer array into one number in Golang?", "body": "<p>I appreciate @KelvinS' approach, there already exists a <code>math.Pow</code> (though it deals in float64s.  Never-the-less, his approach breaks down what you are really after, which is raising each successive number (from the right) by an order of magnitude and summing the numbers.  As such, the most straight forward approach I can think of is</p>\n\n<pre><code>func sliceToInt(s []int) int {\n    res := 0\n    op := 1\n    for i := len(s) - 1; i &gt;= 0; i-- {\n        res += s[i] * op\n        op *= 10\n    }\n    return res\n}\n\nfunc main() {\n    nums := []int{1, 2, 3}\n    fmt.Println(sliceToInt(nums))\n}\n</code></pre>\n\n<p><code>sliceToInt</code> is poorly named, but you should get the idea.</p>\n\n<p><a href=\"https://play.golang.org/p/JS96Nq_so-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/JS96Nq_so-</a></p>\n\n<p>It may be a micro optimization to try to get this as fast as possible, but if it happens to be in a hot path it might be worth it</p>\n\n<pre><code>BenchmarkPow-8              100000000           13.5 ns/op         0 B/op          0 allocs/op\nBenchmarkJoin-8              5000000           272 ns/op           8 B/op          5 allocs/op\nBenchmarkBuffer-8            2000000           782 ns/op         160 B/op          8 allocs/op\nBenchmarkSliceToInt-8       200000000            8.65 ns/op        0 B/op          0 allocs/op\nPASS\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 0, "last_activity_date": 1498328699, "creation_date": 1498328699, "answer_id": 44739629, "question_id": 44729587, "link": "https://stackoverflow.com/questions/44729587/join-digits-from-integer-array-into-one-number-in-golang/44739629#44739629", "title": "Join digits from integer array into one number in Golang?", "body": "<p>To me the simplest approach is:</p>\n\n<p>1) Convert slice of ints to slice of strings</p>\n\n<p>2) Join the strings</p>\n\n<p>3) Convert resulting string into an int</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc sliceToInt(ints []int) int {\n    stringVals := make([]string, len(ints))\n\n    for ind, val := range ints {\n        stringVals[ind] = strconv.Itoa(val)\n    }\n\n    newInt, _ := strconv.Atoi(strings.Join(stringVals, \"\"))\n\n    return newInt\n\n}\n\nfunc main() {\n    s1 := []int{1, 2, 3}\n    fmt.Println(sliceToInt(s1))\n\n    s2 := []int{1, 20, 3}\n    fmt.Println(sliceToInt(s2))\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>123\n1203\n</code></pre>\n\n<p>Converting slice of ints to strings, and then joining is O(N), as opposed to incrementally building out the final string, which is O(N * N).</p>\n"}], "owner": {"reputation": 1442, "user_id": 3289673, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100001287204028/picture?type=large", "display_name": "SanchelliosProg", "link": "https://stackoverflow.com/users/3289673/sanchelliosprog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3009, "favorite_count": 0, "closed_date": 1499355359, "accepted_answer_id": 44730447, "answer_count": 5, "score": 2, "last_activity_date": 1498328699, "creation_date": 1498250291, "question_id": 44729587, "link": "https://stackoverflow.com/questions/44729587/join-digits-from-integer-array-into-one-number-in-golang", "closed_reason": "Duplicate", "title": "Join digits from integer array into one number in Golang?", "body": "<p>I have an array of integers:</p>\n\n<pre><code>nums := []int{1, 2, 3}\n</code></pre>\n\n<p>How could I make integer 123 out of that?</p>\n"}, {"tags": ["multithreading", "unit-testing", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1498244038, "post_id": 44728201, "comment_id": 76439007, "body": "Read up about the <code>-race</code> build/test flag in the <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">go documentation</a>."}, {"owner": {"reputation": 55, "user_id": 2604750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23cd703c803f32c6d4a69298652898f8?s=128&d=identicon&r=PG", "display_name": "Dmitriy.Sh.", "link": "https://stackoverflow.com/users/2604750/dmitriy-sh"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1498244451, "post_id": 44728201, "comment_id": 76439219, "body": "@Adrian Hi, I read about -race flag: &quot;the race detector can detect race conditions only when they are actually triggered by running code, which means it&#39;s important to run race-enabled binaries under realistic workloads&quot; My question is how to wrote unit-test which emulates realistic workloads."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1498244574, "post_id": 44728201, "comment_id": 76439293, "body": "By writing a test which emulates realistic workloads... there&#39;s no simple answer to that. It depends on your specific situation. You&#39;ll have to figure that part out for yourself."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1498244683, "post_id": 44728201, "comment_id": 76439351, "body": "Unit tests are not intended to run under realistic work loads. If you&#39;re testing realistic work loads, you are, by definition, not running unit tests. For the type of testing you want, your best bet is to run a <code>-race</code>-built binary under production-style load. But don&#39;t confuse this with unit testing, which serves an entirely different purpose."}], "answers": [{"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1498386308, "post_id": 44728247, "comment_id": 76471730, "body": "Also don&#39;t forget that race conditions are but one of the possible concurrency errors. Others are deadlock, livelock and starvation. All four are difficult to eliminate by testing alone, although testing can demonstrate that their probability is below a certain threshold. More: <a href=\"https://www.bigbeeconsultants.uk/post/2008/four-horsemen/\" rel=\"nofollow noreferrer\">bigbeeconsultants.uk/post/2008/four-horsemen</a>"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 4, "last_activity_date": 1498244868, "last_edit_date": 1498244868, "creation_date": 1498244137, "answer_id": 44728247, "question_id": 44728201, "link": "https://stackoverflow.com/questions/44728201/how-to-write-unit-tests-to-check-that-methods-are-thread-safe/44728247#44728247", "title": "How to write unit tests to check that methods are thread-safe", "body": "<p>Run your tests with the <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">Race detector</a>.  In short, run:</p>\n\n<pre><code>go test -race\n</code></pre>\n\n<p>Or to build a normal binary, such as to run on a staging server, use:</p>\n\n<pre><code>go build -race\n</code></pre>\n\n<p>But there are many more options, so best to read up on it :)</p>\n\n<p>If your goal is to test under realistic load, your best option is to compile your code with <code>go build -race</code>, then run it under realistic load. This probably means on a staging server.  But don't confuse this with unit testing!</p>\n\n<p>Unit testing is for testing units--small parts of code, usually individual functions. Load/race testing is a different beast, and requires different tools and an entirely different approach.</p>\n\n<p>The fact that Go will easily run unit tests with the race detector is nice, and often catches races. But it will not, nor should not be expected to, catch <em>all</em> races, since the nature of unit test execution is entirely different from that of production execution.</p>\n"}], "owner": {"reputation": 55, "user_id": 2604750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23cd703c803f32c6d4a69298652898f8?s=128&d=identicon&r=PG", "display_name": "Dmitriy.Sh.", "link": "https://stackoverflow.com/users/2604750/dmitriy-sh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 0, "accepted_answer_id": 44728247, "answer_count": 1, "score": 2, "last_activity_date": 1616600318, "creation_date": 1498243985, "last_edit_date": 1498244640, "question_id": 44728201, "link": "https://stackoverflow.com/questions/44728201/how-to-write-unit-tests-to-check-that-methods-are-thread-safe", "title": "How to write unit tests to check that methods are thread-safe", "body": "<p>I have an object like this:</p>\n\n<pre><code>type Store struct {\n    mutex sync.RWMutex\n    data  map[string]int\n}\n\nfunc (s * Store) Read(key string) int, error {\n    // ...\n    defer s.mutex.RUnlock()\n    s.mutex.RLock()\n    // ...\n    return val, nil\n}\n\nfunc (s * Store) Write(key string, value int) error {\n    // ...\n    defer s.mutex.Unlock()\n    s.mutex.Lock()\n    // ...\n    return nil\n}\n</code></pre>\n\n<p>How should unit-tests to look like for methods <code>Read</code> &amp; <code>Write</code> to check that they are thread safe?</p>\n\n<p>I think there are already exists patterns for cases like this, but I didn't find anything. </p>\n\n<p>I read about <code>-race</code> flag:</p>\n\n<blockquote>\n  <p>the race detector can detect race conditions only when they are actually triggered by running code, which means it's important to run race-enabled binaries under realistic workloads</p>\n</blockquote>\n\n<p>My question is how to write unit-test which emulates realistic workloads.</p>\n"}, {"tags": ["go", "redis", "mocking"], "comments": [{"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 4, "creation_date": 1498330550, "post_id": 44727938, "comment_id": 76461027, "body": "you can create an interface with all the methods you use from redis, and use the interface instead of the redis references. With that you can create a struct how follows the interface specs and use it in your methods"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1498493241, "post_id": 44727938, "comment_id": 76508867, "body": "<a href=\"https://github.com/rafaeljusto/redigomock\" rel=\"nofollow noreferrer\">github.com/rafaeljusto/redigomock</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1821, "user_id": 4535310, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/764a4af091d4206820ee084d76f32ce2?s=128&d=identicon&r=PG&f=1", "display_name": "rovy", "link": "https://stackoverflow.com/users/4535310/rovy"}, "is_accepted": false, "score": 6, "last_activity_date": 1498498142, "creation_date": 1498498142, "answer_id": 44765287, "question_id": 44727938, "link": "https://stackoverflow.com/questions/44727938/how-to-mock-redis-connection-in-go/44765287#44765287", "title": "How to mock redis connection in Go", "body": "<p>Thank you all for the response. I found this package <a href=\"https://github.com/alicebob/miniredis\" rel=\"noreferrer\">https://github.com/alicebob/miniredis</a> very useful for redis mocking. </p>\n"}, {"tags": [], "owner": {"reputation": 911, "user_id": 3528539, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/76bcc5c6b40213c8bbee447308334cf4?s=128&d=identicon&r=PG&f=1", "display_name": "Asalle", "link": "https://stackoverflow.com/users/3528539/asalle"}, "is_accepted": false, "score": 0, "last_activity_date": 1551086064, "creation_date": 1551086064, "answer_id": 54862819, "question_id": 44727938, "link": "https://stackoverflow.com/questions/44727938/how-to-mock-redis-connection-in-go/54862819#54862819", "title": "How to mock redis connection in Go", "body": "<p>as @Motakjuq said, create an interface like this</p>\n\n<pre><code>type DB interface {\n   GetData(key string) (value string, error)\n   SetData(key string, value string) error\n}\n</code></pre>\n\n<p>and implement it with actual redis client (like <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow noreferrer\">this</a>) in your code and <a href=\"https://github.com/alicebob/miniredis\" rel=\"nofollow noreferrer\">miniredis</a> in tests.</p>\n"}, {"tags": [], "owner": {"reputation": 533, "user_id": 7887742, "user_type": "registered", "profile_image": "https://graph.facebook.com/1519434644765137/picture?type=large", "display_name": "Chayan Ghosh", "link": "https://stackoverflow.com/users/7887742/chayan-ghosh"}, "is_accepted": false, "score": 11, "last_activity_date": 1570813328, "last_edit_date": 1570813328, "creation_date": 1554453233, "answer_id": 55531345, "question_id": 44727938, "link": "https://stackoverflow.com/questions/44727938/how-to-mock-redis-connection-in-go/55531345#55531345", "title": "How to mock redis connection in Go", "body": "<p>It's even easier to mock using <a href=\"http://github.com/alicebob/miniredis\" rel=\"noreferrer\">miniredis</a> than is apparent at first glance. You don't need to mock every function like Get, Set, ZAdd etc. You can just start miniredis and inject its address to the actual client being used in code (e.g. <a href=\"https://github.com/go-redis/redis\" rel=\"noreferrer\">go-redis</a>) this way:</p>\n\n<pre><code>mr := miniredis.Run()\nredis.NewClient(&amp;redis.Options{\n            Addr: mr.Addr(),\n        })\n</code></pre>\n\n<p>No further mocking would be required. This also enables you to seamlessly use <code>Pipelined()</code>, <code>TxPipelined()</code> etc. even though miniredis doesn't explicitly expose these methods.</p>\n"}], "owner": {"reputation": 1821, "user_id": 4535310, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/764a4af091d4206820ee084d76f32ce2?s=128&d=identicon&r=PG&f=1", "display_name": "rovy", "link": "https://stackoverflow.com/users/4535310/rovy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7508, "favorite_count": 2, "answer_count": 3, "score": 9, "last_activity_date": 1570813328, "creation_date": 1498242857, "question_id": 44727938, "link": "https://stackoverflow.com/questions/44727938/how-to-mock-redis-connection-in-go", "title": "How to mock redis connection in Go", "body": "<p>I am using <a href=\"https://github.com/go-redis/redis\" rel=\"noreferrer\">https://github.com/go-redis/redis</a> package to make Redis DB calls. For unit testing I want to mock this calls, is there any mock library or way to do it? </p>\n"}]