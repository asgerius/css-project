[{"tags": ["logging", "go"], "answers": [{"tags": [], "owner": {"reputation": 290, "user_id": 4607496, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LreT7xN9R1E/AAAAAAAAAAI/AAAAAAAAAOI/i9Cqa6ji16U/photo.jpg?sz=128", "display_name": "Patrick Webster", "link": "https://stackoverflow.com/users/4607496/patrick-webster"}, "is_accepted": false, "score": 0, "last_activity_date": 1424911525, "creation_date": 1424911525, "answer_id": 28732545, "question_id": 28731594, "link": "https://stackoverflow.com/questions/28731594/go-logger-decorator-with-gorilla-mux/28732545#28732545", "title": "Go logger decorator with gorilla mux", "body": "<p>The logs by default stream to <code>stderr</code>. If you wanted to see the output of your server ( for example, named \"testAPI\" ), you will need to redirect <code>stderr</code> to <code>stdout</code> (your terminal):</p>\n\n<pre><code>// If already compiled\n/path/to/testAPI 2&gt;&amp;1\n// Without building / installing\ngo run testAPI.go 2&gt;&amp;1\n</code></pre>\n\n<p>If you simply want it to log to a log file:</p>\n\n<pre><code>// If already compiled\n/path/to/testAPI 2&gt; /path/to/logs/testAPI.log\n// Without building / installing\ngo run testAPI.go 2&gt; /path/to/logs/testAPI.log\n</code></pre>\n\n<p><a href=\"http://golang.org/src/log/log.go?s=2527:2566#L58\" rel=\"nofollow\" title=\"Golang source\">The pkg/log source</a> defines the output internally:</p>\n\n<pre><code>var std = New(os.Stderr, \"\", LstdFlags)\n</code></pre>\n\n<p>Finally, from <a href=\"http://golang.org/pkg/log\" rel=\"nofollow\" title=\"Godoc\">the standard lib docs</a>:</p>\n\n<blockquote>\n  <p>Package log implements a simple logging package. It defines a type,\n  Logger, with methods for formatting output. It also has a predefined\n  'standard' Logger accessible through helper functions Print[f|ln],\n  Fatal[f|ln], and Panic[f|ln], which are easier to use than creating a\n  Logger manually. That logger writes to standard error and prints the\n  date and time of each logged message. The Fatal functions call\n  os.Exit(1) after writing the log message. The Panic functions call\n  panic after writing the log message.</p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 3925946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac10d9423cdc188494b144f4469cc8ec?s=128&d=identicon&r=PG&f=1", "display_name": "code4", "link": "https://stackoverflow.com/users/3925946/code4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 720, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424911525, "creation_date": 1424906257, "question_id": 28731594, "link": "https://stackoverflow.com/questions/28731594/go-logger-decorator-with-gorilla-mux", "title": "Go logger decorator with gorilla mux", "body": "<p>I'm new to Go and playing around with mux for creating some REST APIs following <a href=\"http://thenewstack.io/make-a-restful-json-api-go/\" rel=\"nofollow\">http://thenewstack.io/make-a-restful-json-api-go/</a>. While it works fine mostly, I don't see console logging as expected using the Logger decorator that uses log.Println to log the HTTP requests. </p>\n\n<p>Am I missing something? Also, it looks like Logger is called when ranging over the routes list, is this the right way to log for each request?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1424890826, "creation_date": 1424890826, "answer_id": 28727416, "question_id": 28727087, "link": "https://stackoverflow.com/questions/28727087/golang-import-based-on-config-variable/28727416#28727416", "title": "Golang import based on config variable", "body": "<p>You have the right idea to start, implement everything you need via an interface, and then you can plug in any concrete backup \"plugin\" that implements that interface.</p>\n\n<p>Once you can run your backup via an interface, you can simply assign an instance of the backend you want based on whatever conditions you set.</p>\n\n<pre><code>var storage Backupper\n\ntype Backupper interface {\n    Backup()\n}\n\ntype GDrive struct {\n    config string\n}\n\nfunc (g *GDrive) Backup() {\n    fmt.Println(\"Doing backup to Google Drive\")\n}\n\nfunc main() {\n    storage = &amp;GDrive{}\n    storage.Backup()\n}\n</code></pre>\n\n<p>Or with multiple options: <a href=\"http://play.golang.org/p/RlmXjf55Yh\" rel=\"nofollow\">http://play.golang.org/p/RlmXjf55Yh</a></p>\n"}], "owner": {"reputation": 1208, "user_id": 1198639, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1a4ae40d7871bc0c93776301e28b3548?s=128&d=identicon&r=PG", "display_name": "Will H", "link": "https://stackoverflow.com/users/1198639/will-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 28727416, "answer_count": 1, "score": 1, "last_activity_date": 1424890826, "creation_date": 1424889739, "question_id": 28727087, "link": "https://stackoverflow.com/questions/28727087/golang-import-based-on-config-variable", "title": "Golang import based on config variable", "body": "<p>I'm currently in the process of still learning go but I recently got to a point where in one of my tests I wanted to create a quick backup application that will reference a config file and switch what \"plugin\" to use for the backup.  So what I got to at this point is to create (as example, written from my head and syntax may be incorrect):</p>\n\n<pre><code>type BackupStorage interface{\n   Put (d []byte) (n int, err Error)\n   Get (l []byte) (d []byte, err Error)\n}\n</code></pre>\n\n<p>At this point I would assume I should use reflection to switch on the type and return the specific backup function, although that does not seem right.</p>\n\n<p>The second alternative I came to was to still use my BackupStorage interface and create \"plugin\" packages to dictate which import will be used, but how do I switch that then based on a config file variable.  And I'd like to do this because some stuff on one machine may backup only to s3 where as others may backup to both s3 and google drive etc.</p>\n\n<p>With the basic example above what I have in mind is this:\nImplement 2 BackupStorage \"plugins\" (Google Drive / S3) with the flexibility to add more at any time, but have my code be generic enough to execute on whatever storage backend is selected in config files.</p>\n\n<p>As I mentioned above I'm still learning and any explanations would be appreciated or examples on how to accomplish this.  I don't mind the \"your doing it wrong\" as long as there is a proper explanation on why it's wrong and how to do it right.</p>\n"}, {"tags": ["arrays", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1424879717, "post_id": 28723262, "comment_id": 45733753, "body": "the second option will give me this error  implicit assignment of unexported field &#39;fileName&#39; in models.FileMD literal"}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1424879898, "post_id": 28723262, "comment_id": 45733914, "body": "I tried the second option in the same file when the struct is and it works  but in another file it didnt"}, {"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1424879918, "post_id": 28723262, "comment_id": 45733932, "body": "@MIkCode Change <code>fileName</code> to <code>FileName</code> to make &quot;exported&quot;."}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1424880229, "post_id": 28723262, "comment_id": 45734197, "body": "that&#39;s perfect  i forgot the capital field name thing"}], "tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 4, "last_activity_date": 1424879040, "creation_date": 1424879040, "answer_id": 28723262, "question_id": 28723199, "link": "https://stackoverflow.com/questions/28723199/cannot-use-a-type-string-as-type-in-array-element-in-go/28723262#28723262", "title": "Cannot use &quot;a&quot; (type string) as type in array element in go", "body": "<p>I am not sure but I think you are looking for:</p>\n\n<pre><code>fileList[0] = FileMD{\"a\", 1}\n</code></pre>\n\n<p>Or maybe:</p>\n\n<pre><code>fileList := []FileMD{{\"a\", 1}, {\"b\", 2}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1424886328, "last_edit_date": 1424886328, "creation_date": 1424880392, "answer_id": 28723795, "question_id": 28723199, "link": "https://stackoverflow.com/questions/28723199/cannot-use-a-type-string-as-type-in-array-element-in-go/28723795#28723795", "title": "Cannot use &quot;a&quot; (type string) as type in array element in go", "body": "<p>First you need to decide if you want an <a href=\"http://golang.org/ref/spec#Array_types\" rel=\"nofollow\">array</a> or a <a href=\"http://golang.org/ref/spec#Slice_types\" rel=\"nofollow\">slice</a>.</p>\n\n<p>Once you decided, you have basically 2 options:</p>\n\n<p>(Try the complete application on the <a href=\"http://play.golang.org/p/AKF4G-ogRp\" rel=\"nofollow\">Go Playground</a>.)</p>\n\n<h3>1) With a literal:</h3>\n\n<p>Initialize your array/slice with a <a href=\"http://golang.org/ref/spec#Composite_literals\" rel=\"nofollow\">Composite literal</a> (either an array or slice literal) and you're done.</p>\n\n<p>Arrays:</p>\n\n<pre><code>fileArr10 := [2]FileMD{FileMD{\"first\", 1}, FileMD{\"second\", 2}}\n// Or short:\nfileArr11 := [2]FileMD{{\"first\", 1}, {\"second\", 2}}\n// With length auto-computed:\nfileArr20 := [...]FileMD{FileMD{\"first\", 1}, FileMD{\"second\", 2}}\n// Or short:\nfileArr21 := [...]FileMD{{\"first\", 1}, {\"second\", 2}}\n</code></pre>\n\n<p>Slices (note the only difference between array and slice literals is that length is not specified):</p>\n\n<pre><code>fileSl10 := []FileMD{FileMD{\"first\", 1}, FileMD{\"second\", 2}}\n// Or short:\nfileSl11 := []FileMD{{\"first\", 1}, {\"second\", 2}}\n</code></pre>\n\n<h3>2) New, initialized array/slice and filling it:</h3>\n\n<p>Create a new, initialized array/slice and fill it by assiging values to its elements.</p>\n\n<p>Array:</p>\n\n<pre><code>fileArr := [2]FileMD{}\nfileArr[0] = FileMD{\"first\", 1}\nfileArr[1] = FileMD{\"second\", 2}\n</code></pre>\n\n<p>Slice: (you can create slices with the built-in function <a href=\"http://golang.org/ref/spec#Making_slices_maps_and_channels\" rel=\"nofollow\"><code>make</code></a>)</p>\n\n<pre><code>fileSl := make([]FileMD, 2)\nfileSl[0] = FileMD{\"first\", 1}\nfileSl[1] = FileMD{\"second\", 2}\n</code></pre>\n\n<h3>Final Note</h3>\n\n<p>Your struct <code>FileMD</code> is part of a package and it contains unexported fields (fields whose name start with lowercased letters).</p>\n\n<p>Unexported fields are not accessible from outside of the package. This also means that when you create a value of such struct, you cannot specify the initial values of unexported fields.</p>\n\n<p>So if you try to create a value of <code>FileMD</code> from outside of package <code>models</code>, you can only create zero-valued <code>FileMD</code>s like this: <code>FileMD{}</code>. Make your fields exported and then you can specify the initial values for the file name and size:</p>\n\n<pre><code>type FileMD struct {\n    FileName string\n    FileSize int\n}\n\n// Now FileMD{\"first\", 1} is valid outside of package models\n</code></pre>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9431, "favorite_count": 0, "accepted_answer_id": 28723262, "answer_count": 2, "score": 1, "last_activity_date": 1500665448, "creation_date": 1424878872, "last_edit_date": 1500665448, "question_id": 28723199, "link": "https://stackoverflow.com/questions/28723199/cannot-use-a-type-string-as-type-in-array-element-in-go", "title": "Cannot use &quot;a&quot; (type string) as type in array element in go", "body": "<p>I'm pretty new to golang and I have an issue with adding items to Array.</p>\n\n<p>I use this link as reference <a href=\"http://www.golang-book.com/6/index.htm#section1\" rel=\"nofollow noreferrer\">golang-book</a>.</p>\n\n<p>I have this struct:</p>\n\n<pre><code>package models\n\ntype FileMD struct {\n    fileName string\n    fileSize int\n}\n</code></pre>\n\n<p>I tired  to do it in both ways but I failed. </p>\n\n<pre><code>fileList := [...]models.FileMD{\"a\", 1: \"b\", 2}\nvar fileList [...]models.FileMD\nfileList[0] = \"a\", 1\n</code></pre>\n\n<p>What is the correct way?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 14499, "user_id": 3589092, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7ROkk.jpg?s=128&g=1", "display_name": "kemicofa ghost", "link": "https://stackoverflow.com/users/3589092/kemicofa-ghost"}, "edited": false, "score": 0, "creation_date": 1483006783, "post_id": 28732254, "comment_id": 69956992, "body": "gvm pkgset use test_pkgset did it for me"}], "tags": [], "owner": {"reputation": 290, "user_id": 4607496, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LreT7xN9R1E/AAAAAAAAAAI/AAAAAAAAAOI/i9Cqa6ji16U/photo.jpg?sz=128", "display_name": "Patrick Webster", "link": "https://stackoverflow.com/users/4607496/patrick-webster"}, "is_accepted": true, "score": 3, "last_activity_date": 1424909616, "creation_date": 1424909616, "answer_id": 28732254, "question_id": 28722505, "link": "https://stackoverflow.com/questions/28722505/go-install-no-install-location-for-directory/28732254#28732254", "title": "go install: no install location for directory", "body": "<p>You need to create a package set, which is for all intents an encapsulated $GOPATH environment instance.</p>\n\n<p>In short, use whatever name you like; \"test_pkgset\" is just an example name:</p>\n\n<pre><code>gvm pkgset create test_pkgset\ngvm pkgenv test_pkgset // Launches whatever $EDITOR defaults to\n</code></pre>\n\n<p>Change the end of <code>export GOPATH; GOPATH=...</code> and <code>export PATH; PATH=...</code> lines to include $HOME/go:</p>\n\n<pre><code>export GOPATH; GOPATH=\"/home/alex/.gvm/pkgsets/go1.4/test_pkgset:$HOME/go:$GOPATH\"\nexport PATH; PATH=\"/home/alex/.gvm/pkgsets/go1.4/test_pkgset/bin:${GVM_OVERLAY_PREFIX}/bin:$HOME/go/bin:${PATH}\"\n</code></pre>\n\n<p>Finally, use it:</p>\n\n<pre><code>gvm pkgset use test_pkgset\n</code></pre>\n"}], "owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1341, "favorite_count": 2, "accepted_answer_id": 28732254, "answer_count": 1, "score": 2, "last_activity_date": 1424909616, "creation_date": 1424876965, "last_edit_date": 1424877617, "question_id": 28722505, "link": "https://stackoverflow.com/questions/28722505/go-install-no-install-location-for-directory", "title": "go install: no install location for directory", "body": "<p>I think I know what's going on. The <code>GOPATH</code> changes when I installed <a href=\"https://github.com/moovweb/gvm\" rel=\"nofollow\">gvm</a>:</p>\n\n<pre><code>&gt; alex@alex-K43U:~/go/src/m2k$ go install go install: no install\n&gt; location for directory /home/alex/go/src/m2k outside GOPATH\n&gt;\n&gt; alex@alex-K43U:~/go/src/m2k$ go env \n&gt; GOPATH=\"/home/alex/.gvm/pkgsets/go1.4/global\"\n&gt; GOROOT=\"/home/alex/.gvm/gos/go1.4\"\n</code></pre>\n\n<p>What should I do know? I'm afraid that bringing the <code>GOPATH</code> to my workplace will mess up <code>gvm</code>. On the other hand, <code>go install</code> isn't working anymore.</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1424870506, "post_id": 28719934, "comment_id": 45726960, "body": "2) and 3) are absolutely identical. Form 3) is useful if you want a slice of len 20 but a cap 200 (to allow allocation free appending of 180 elements). Version 1) is perfectly okay unless you know your slice will grow to some assessable large extent."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1424893779, "post_id": 28719934, "comment_id": 45742848, "body": "You left out (4) where you do <code>make([]string, 0, 5)</code> and then use <code>append</code> as in (1). That&#39;s typically done in cases where the capacity setting is more of a guess/estimate/upper-bound or where for other reasons it&#39;s more convenient to use something like <code>append</code> or have the slice length grow during the loop rather than use explicit indexing."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1424893839, "post_id": 28719934, "comment_id": 45742887, "body": "Another side note, (2) and (3) could use <code>for i := range sl</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 1, "creation_date": 1424870381, "post_id": 28720035, "comment_id": 45726885, "body": "Did not know about <code>cap</code> - this surely helps a lot. Thank you :-)"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1424870304, "creation_date": 1424870304, "answer_id": 28720035, "question_id": 28719934, "link": "https://stackoverflow.com/questions/28719934/go-builtin-make-does-the-capacity-make-a-difference/28720035#28720035", "title": "Go: builtin make - does the capacity make a difference", "body": "<p>First of all, whenever you have a question about performance, <a href=\"http://golang.org/pkg/testing/#hdr-Benchmarks\" rel=\"nofollow\">benchmark</a> and <a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"nofollow\">profile</a>.</p>\n\n<p>Secondly, I don't see any difference here. Considering that this code</p>\n\n<pre><code>s := make([]int, 5)\nfmt.Println(cap(s))\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/pXHllXnult\" rel=\"nofollow\">prints 5</a>, your #2 and #3 are basically the same.</p>\n"}], "owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 28720035, "answer_count": 1, "score": 3, "last_activity_date": 1424871301, "creation_date": 1424869979, "last_edit_date": 1424871301, "question_id": 28719934, "link": "https://stackoverflow.com/questions/28719934/go-builtin-make-does-the-capacity-make-a-difference", "title": "Go: builtin make - does the capacity make a difference", "body": "<p>Consider wanting to dynamically fill an array/slice with exactly <code>5</code> elements. No more, and no less. </p>\n\n<h1>(1) Slice with initial length 0</h1>\n\n<pre><code>sl := []string{}\nfor i := 0; i &lt; 5; i++ {\n    sl = append(sl, \"abc\")\n}\n</code></pre>\n\n<h1>(2) Slice with initial length set, no capacity</h1>\n\n<pre><code>sl := make([]string, 5)\nfor i := 0; i &lt; 5; i++ {\n    s1[i] = \"abc\"\n}\n</code></pre>\n\n<h1>(3) Slice with initial length set, capacity given</h1>\n\n<pre><code>sl := make([]string, 5, 5)\nfor i := 0; i &lt; 5; i++ {\n    sl[i] = \"abc\"\n}\n</code></pre>\n\n<hr>\n\n<p>My feeling tells me that #1 is not the <i>best</i> solution, but I am wondering why I would choose #2 over #3 or vice versa? (performance-wise)</p>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 12342, "user_id": 1300892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f3a5c87c28be1e3d1d31281c613deb?s=128&d=identicon&r=PG", "display_name": "Sverri M. Olsen", "link": "https://stackoverflow.com/users/1300892/sverri-m-olsen"}, "edited": false, "score": 2, "creation_date": 1424869029, "post_id": 28719523, "comment_id": 45726007, "body": "I believe <a href=\"https://golang.org/pkg/unicode/#IsUpper\" rel=\"nofollow noreferrer\">unicode.IsUpper()</a> would be useful for this."}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 4, "creation_date": 1424890503, "post_id": 28719641, "comment_id": 45740914, "body": "<code>[]rune(s)</code> converts the whole string; you can extract only the first character with something like <a href=\"http://play.golang.org/p/OmOv3SMPu4\" rel=\"nofollow noreferrer\">play.golang.org/p/OmOv3SMPu4</a> . (Though indexing gets bytes, <code>range</code>ing over the string decodes the UTF-8 to get runes.)"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1424906345, "post_id": 28719641, "comment_id": 45749296, "body": "I should have said &quot;you can extract only the first <i>code point</i>,&quot; not &quot;the first character.&quot; The notion of &quot;characters&quot; in Unicode is extra complicated thanks to combining marks, nonprintable things like the RTL direction mark, and so on. For many purposes the first rune is fine, though."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1424909409, "post_id": 28719641, "comment_id": 45750312, "body": "@twotwotwo Yes, <code>range</code> is a faster way to get the first rune. Since the question contained short strings, converting to a <code>rune</code> slice is simpler. For long strings the <code>range</code> should be used or <a href=\"http://golang.org/pkg/unicode/utf8/#DecodeRune\" rel=\"nofollow noreferrer\"><code>utf8.DecodeRune()</code></a> or <a href=\"http://golang.org/pkg/unicode/utf8/#DecodeRuneInString\" rel=\"nofollow noreferrer\"><code>utf8.DecodeRuneInString()</code></a>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1424869065, "creation_date": 1424869065, "answer_id": 28719641, "question_id": 28719523, "link": "https://stackoverflow.com/questions/28719523/swedish-characters-in-go-lang/28719641#28719641", "title": "Swedish characters in Go Lang", "body": "<p>Indexing a <code>string</code> indexes its bytes not its <em>runes</em> (a <a href=\"http://golang.org/ref/spec#Rune_literals\" rel=\"noreferrer\"><code>rune</code></a> is a unicode codepoint).</p>\n\n<p>What you want to do is check the first character (<code>rune</code>) of the <code>string</code>, not its first byte in its UTF-8 encoded form. And for this there is support in the standard library: <a href=\"http://golang.org/pkg/unicode/#IsUpper\" rel=\"noreferrer\"><code>unicode.IsUpper()</code></a>.</p>\n\n<p>To get the first <code>rune</code>, you can convert the <code>string</code> to a slice of runes, and take the first element (at index 0).</p>\n\n<pre><code>ins := []string{\n    \"\u00e5/\u00c5/\u00e4/\u00c4/\u00f6/\u00d6\",\n    \"\u00c5/\u00e4/\u00c4/\u00f6/\u00d6\"}\n\nfor _, s := range ins {\n    fmt.Println(s, unicode.IsUpper([]rune(s)[0]))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\u00e5/\u00c5/\u00e4/\u00c4/\u00f6/\u00d6 false\n\u00c5/\u00e4/\u00c4/\u00f6/\u00d6 true\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4605689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad96b3f84aad8efa7b8674adbc45afc9?s=128&d=identicon&r=PG&f=1", "display_name": "Helios", "link": "https://stackoverflow.com/users/4605689/helios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 28719641, "answer_count": 1, "score": 5, "last_activity_date": 1475353907, "creation_date": 1424868692, "last_edit_date": 1475353907, "question_id": 28719523, "link": "https://stackoverflow.com/questions/28719523/swedish-characters-in-go-lang", "title": "Swedish characters in Go Lang", "body": "<p>The following function does not work with Swedish characters, i.e <code>\u00e5/\u00c5/\u00e4/\u00c4/\u00f6/\u00d6</code>.</p>\n\n<pre><code>func StartsWithUppercase(s string) bool {\n    return (string(s[0]) == strings.ToUpper(string(s[0])))\n}\n</code></pre>\n\n<p>How do I proceed to check if a string starts with upper case Swedish character? </p>\n\n<pre><code>w := \"\u00e5\u00c5\u00e4\u00c4\u00f6\u00d6\"\nfor i := 0; i &lt; len(w); i++ {\n    fmt.Println(i, w[i])\n}\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code> 1. 195 \n 2. 165\n 3. 195\n 4. 133\n 5. 195 \n 6. 164\n 7. 195\n 8. 132\n 9. 195\n 10. 182 \n 11. 195\n 12. 150\n</code></pre>\n"}, {"tags": ["unicode", "go", "rune"], "answers": [{"comments": [{"owner": {"reputation": 2127, "user_id": 1851915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af054ca0ed65cc12b43c58ad9b3ea3c2?s=128&d=identicon&r=PG", "display_name": "dr.scre", "link": "https://stackoverflow.com/users/1851915/dr-scre"}, "edited": false, "score": 2, "creation_date": 1543591546, "post_id": 28718819, "comment_id": 93986304, "body": "Beware that this may panic with  panic: runtime error: slice bounds out of range  if string size is already less than what you are truing to cut"}], "tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": true, "score": 21, "last_activity_date": 1424866523, "creation_date": 1424866523, "answer_id": 28718819, "question_id": 28718682, "link": "https://stackoverflow.com/questions/28718682/how-to-get-a-substring-from-a-string-of-runes-in-golang/28718819#28718819", "title": "How to get a substring from a string of runes in golang?", "body": "<p>Just convert it to a slice of runes first, slice, then convert the result back:</p>\n\n<pre><code>string([]rune(str)[:20])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1837, "user_id": 381849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d44bcf5700e4fcb934221db2dab496?s=128&d=identicon&r=PG", "display_name": "KAdot", "link": "https://stackoverflow.com/users/381849/kadot"}, "is_accepted": false, "score": 10, "last_activity_date": 1476322452, "last_edit_date": 1476322452, "creation_date": 1469243568, "answer_id": 38537764, "question_id": 28718682, "link": "https://stackoverflow.com/questions/28718682/how-to-get-a-substring-from-a-string-of-runes-in-golang/38537764#38537764", "title": "How to get a substring from a string of runes in golang?", "body": "<p>You can get a substring of a UTF-8 string without allocating additional memory (you don't have to convert it to a <code>rune</code> slice):</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>func substring(s string, start int, end int) string {\n    start_str_idx := 0\n    i := 0\n    for j := range s {\n        if i == start {\n            start_str_idx = j\n        }\n        if i == end {\n            return s[start_str_idx:j]\n        }\n        i++\n    }\n    return s[start_str_idx:]\n}\n\nfunc main() {\n    s := \"\u4e16\u754c Hello\"\n    fmt.Println(substring(s, 0, 1)) // \u4e16\n    fmt.Println(substring(s, 1, 5)) // \u754c He\n    fmt.Println(substring(s, 3, 8)) // Hello\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4687, "user_id": 2176740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c09c0ea83bcb343688502045304a0474?s=128&d=identicon&r=PG", "display_name": "joonas.fi", "link": "https://stackoverflow.com/users/2176740/joonas-fi"}, "is_accepted": false, "score": 1, "last_activity_date": 1557833039, "creation_date": 1557833039, "answer_id": 56129287, "question_id": 28718682, "link": "https://stackoverflow.com/questions/28718682/how-to-get-a-substring-from-a-string-of-runes-in-golang/56129287#56129287", "title": "How to get a substring from a string of runes in golang?", "body": "<p>Here's a length-based implementation based on the rune trick:</p>\n\n<pre><code>func substr(input string, start int, length int) string {\n    asRunes := []rune(input)\n\n    if start &gt;= len(asRunes) {\n        return \"\"\n    }\n\n    if start+length &gt; len(asRunes) {\n        length = len(asRunes) - start\n    }\n\n    return string(asRunes[start : start+length])\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1609092200, "creation_date": 1609092200, "answer_id": 65468836, "question_id": 28718682, "link": "https://stackoverflow.com/questions/28718682/how-to-get-a-substring-from-a-string-of-runes-in-golang/65468836#65468836", "title": "How to get a substring from a string of runes in golang?", "body": "<p>If you dont mind experimental package, you can use this:</p>\n<pre><code>package main\nimport &quot;golang.org/x/exp/utf8string&quot;\n\nfunc main() {\n   o := utf8string.NewString(&quot;\u00c4\u00c5\u00e0\u00e2\u00e4\u00e5\u00e7\u00e8\u00e9\u00ea\u00eb\u00ec\u00ee\u00ef\u00fc&quot;)\n   s := o.Slice(1, 3)\n   println(s == &quot;\u00c5\u00e0&quot;)\n}\n</code></pre>\n<p><a href=\"https://pkg.go.dev/golang.org/x/exp/utf8string\" rel=\"nofollow noreferrer\">https://pkg.go.dev/golang.org/x/exp/utf8string</a></p>\n"}], "owner": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6516, "favorite_count": 0, "accepted_answer_id": 28718819, "answer_count": 4, "score": 9, "last_activity_date": 1609092200, "creation_date": 1424866110, "question_id": 28718682, "link": "https://stackoverflow.com/questions/28718682/how-to-get-a-substring-from-a-string-of-runes-in-golang", "title": "How to get a substring from a string of runes in golang?", "body": "<p>I found this, <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/YyKlLwuWt3w\" rel=\"noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/YyKlLwuWt3w</a> but as far as I can tell, the solutions didn't work for me.</p>\n\n<p>If you use the method of treating a string as a slice(<code>str[:20]</code>), it breaks off in the middle of characters and we get \"\u0627\u0644\ufffd\".</p>\n\n<p>Edit: I believe I could write a function and do it as a multiple of 3's as runes are int32 (32bits/(8bits/byte)). I would first have to check if there are runes.</p>\n"}, {"tags": ["rest", "azure", "go", "office365"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4540462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14bf078b1e197e17779e63518d2c3fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Aishwarya Gopalakrishnan", "link": "https://stackoverflow.com/users/4540462/aishwarya-gopalakrishnan"}, "edited": false, "score": 0, "creation_date": 1424866153, "post_id": 28716379, "comment_id": 45724177, "body": "thanks icza . I tried using that version &quot;2013-04-05&quot; it throws me the same error"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 95, "user_id": 4540462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14bf078b1e197e17779e63518d2c3fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Aishwarya Gopalakrishnan", "link": "https://stackoverflow.com/users/4540462/aishwarya-gopalakrishnan"}, "edited": false, "score": 0, "creation_date": 1424866435, "post_id": 28716379, "comment_id": 45724344, "body": "@AishwaryaGopalakrishnan Please try other versions too, the most recent <code>&quot;1.5&quot;</code> too."}, {"owner": {"reputation": 95, "user_id": 4540462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14bf078b1e197e17779e63518d2c3fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Aishwarya Gopalakrishnan", "link": "https://stackoverflow.com/users/4540462/aishwarya-gopalakrishnan"}, "edited": false, "score": 0, "creation_date": 1424869000, "post_id": 28716379, "comment_id": 45725985, "body": "Thanks icza . I tried using all the versions but i get the same error ."}, {"owner": {"reputation": 95, "user_id": 4540462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14bf078b1e197e17779e63518d2c3fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Aishwarya Gopalakrishnan", "link": "https://stackoverflow.com/users/4540462/aishwarya-gopalakrishnan"}, "edited": false, "score": 0, "creation_date": 1424933739, "post_id": 28716379, "comment_id": 45756791, "body": "issue solved . The mistake was in the way i sent the get request"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1424859450, "creation_date": 1424859450, "answer_id": 28716379, "question_id": 28716112, "link": "https://stackoverflow.com/questions/28716112/could-not-list-the-users-in-the-office-365-domain-with-administrator-credentials/28716379#28716379", "title": "Could not list the users in the Office 365 domain with administrator credentials using graph api", "body": "<p>As the error message says in the result:</p>\n\n<blockquote>\n  <p>The specified api-version is invalid. The value must exactly match a supported \n     version.</p>\n</blockquote>\n\n<p>You specified api version:</p>\n\n<pre><code>data.Set(\"api-version\", \"2014-04-05\")\n</code></pre>\n\n<p><code>\"2014-04-05\"</code> is not a valid api version. See the list of <a href=\"https://msdn.microsoft.com/en-us/library/azure/dn835125.aspx\" rel=\"nofollow\">supported versions here</a>.</p>\n\n<p>Supported versions:</p>\n\n<ul>\n<li><code>\"1.5\"</code></li>\n<li><code>\"2013-11-08\"</code></li>\n<li><code>\"2013-04-05\"</code></li>\n</ul>\n\n<p>Most likely you wanted to use the api version <code>\"2013-04-05\"</code>:</p>\n\n<pre><code>data.Set(\"api-version\", \"2013-04-05\")\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4540462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14bf078b1e197e17779e63518d2c3fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Aishwarya Gopalakrishnan", "link": "https://stackoverflow.com/users/4540462/aishwarya-gopalakrishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1788, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1454324111, "creation_date": 1424858739, "last_edit_date": 1424866174, "question_id": 28716112, "link": "https://stackoverflow.com/questions/28716112/could-not-list-the-users-in-the-office-365-domain-with-administrator-credentials", "title": "Could not list the users in the Office 365 domain with administrator credentials using graph api", "body": "<p>I am trying to list the users in an office 365 domain. I am using the graph API. I registered my application in azure AD with Directory.Read permissions. I am able to retrieve an access token, but when I try to send a request to list the users it returns an error:</p>\n\n<pre><code> {\"odata.error\":{\"code\":\"Request_DataContractVersionMissing\",\"message\":{\"lang\":\"en\",\n  \"value\":\"The specified api-version is invalid. The value must exactly match a supported \n   version.\"}}}\n</code></pre>\n\n<p>This is the request I make:</p>\n\n<pre><code>apiUrl := \"https://graph.windows.net/\"\n    resource := \"vstoregrid.com/users\"\n    data := url.Values{}\n    data.Set(\"api-version\", \"2013-04-05\")\n    authbear := \"Bearer \"\n    authbear += accessobj.Access_token\n\n    u, _ := url.ParseRequestURI(apiUrl)\n    u.Path = resource\n    urlStr := fmt.Sprintf(\"%v\", u)\n\n    client := &amp;http.Client{}\n\n    r, _ := http.NewRequest(\"GET\", urlStr, bytes.NewBufferString(data.Encode()))\n    r.Header.Add(\"Content-Type\", \"application/json\")\n    r.Header.Set(\"Authorization\", authbear)\n    r.Header.Add(\"Host\", \"graph.windows.net\")\n    r.Header.Add(\"Content-Length\", strconv.Itoa(len(data.Encode())))\n</code></pre>\n\n<p>I am using the version as specified in the documentation. Where am I going wrong?</p>\n"}, {"tags": ["php", "regex", "go"], "comments": [{"owner": {"reputation": 708, "user_id": 4144758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfea5e29717057a628f9363b652e5a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele D", "link": "https://stackoverflow.com/users/4144758/daniele-d"}, "edited": false, "score": 0, "creation_date": 1424857082, "post_id": 28715556, "comment_id": 45718726, "body": "You can use regexp: <a href=\"http://golang.org/pkg/regexp/\" rel=\"nofollow noreferrer\">golang.org/pkg/regexp</a>"}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 1, "creation_date": 1424857300, "post_id": 28715556, "comment_id": 45718872, "body": "Sometimes it helps prompt readers if you edit in your current best attempt. It doesn&#39;t have to be working, but can be helpful to indicate how you are thinking about a problem, generally speaking."}], "answers": [{"tags": [], "owner": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "is_accepted": true, "score": 7, "last_activity_date": 1424858365, "last_edit_date": 1424858365, "creation_date": 1424857767, "answer_id": 28715813, "question_id": 28715556, "link": "https://stackoverflow.com/questions/28715556/go-equivalent-to-php-preg-match/28715813#28715813", "title": "Go equivalent to PHP preg_match", "body": "<p>First you need to know that you might need to modify the regex pattern itself, since go's regex engine does not behave exactly the same as PHP's regex engine. Both are using PCRE regexes where PHP implements more features than go. However, your pattern from the example should work in go without modifications.</p>\n\n<p>Here comes an example program in go that works like PHP's <code>preg_match()</code>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"regexp\"\n\nfunc main() {\n\n    str := `100.100.100.100 - - [23/Feb/2015:03:03:56 +0100] \"GET /folder/file.mp3 HTTP/1.1\" 206 5637064 \"-\" \"AppleCoreMedia/1.0.0.12B466 (iPhone; U; CPU OS 8_1_3 like Mac OS X; da_dk)\"`\n\n    r, _ := regexp.Compile(`([.0-9]+) .*?\\[([0-9a-zA-Z:\\/+ ]+)\\].*?\"[A-Z]+ \\/([^\\/ ]+)\\/([a-zA-Z0-9\\-.]+).*\" ([0-9]{3}) .*\"(.*?)\"$`)\n\n    // Using FindStringSubmatch you are able to access the \n    // individual capturing groups\n    for index, match := range r.FindStringSubmatch(str) {\n        fmt.Printf(\"[%d] %s\\n\", index, match)\n    }   \n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[0] 100.100.100.100 - - [23/Feb/2015:03:03:56 +0100] \"GET /folder/file.mp3 HTTP/1.1\" 206 5637064 \"-\" \"AppleCoreMedia/1.0.0.12B466 (iPhone; U; CPU OS 8_1_3 like Mac OS X; da_dk)\"\n[1] 100.100.100.100\n[2] 23/Feb/2015:03:03:56 +0100\n[3] folder\n[4] file.mp3\n[5] 206\n[6] AppleCoreMedia/1.0.0.12B466 (iPhone; U; CPU OS 8_1_3 like Mac OS X; da_dk)\n</code></pre>\n\n<p>Please check the manual about go regexes: <a href=\"http://golang.org/pkg/regexp/\" rel=\"noreferrer\">http://golang.org/pkg/regexp/</a></p>\n"}], "owner": {"reputation": 85, "user_id": 4149528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b01c77f66558a425fa5de0d6446ef2c?s=128&d=identicon&r=PG&f=1", "display_name": "itsnotallama", "link": "https://stackoverflow.com/users/4149528/itsnotallama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4224, "favorite_count": 0, "accepted_answer_id": 28715813, "answer_count": 1, "score": 6, "last_activity_date": 1424858365, "creation_date": 1424857029, "question_id": 28715556, "link": "https://stackoverflow.com/questions/28715556/go-equivalent-to-php-preg-match", "title": "Go equivalent to PHP preg_match", "body": "<p>I have a small PHP script that runs through my apache log - and i'm trying to convert this script to Go. However I'm having some difficulties finding a good equivalent to the PHP function <code>preg_match</code>.</p>\n\n<p>In my PHP script I run a <code>preg_match</code> on each line in the log file like this:</p>\n\n<pre><code>preg_match('/([.0-9]+) .*?\\[([0-9a-zA-Z:\\/+ ]+)\\].*?\"[A-Z]+ \\/([^\\/ ]+)\\/([a-zA-Z0-9\\-.]+).*\" ([0-9]{3}) .*\"(.*?)\"$/', $line, $matches)\n</code></pre>\n\n<p>Running this expression on this log:</p>\n\n<blockquote>\n  <p>100.100.100.100 - - [23/Feb/2015:03:03:56 +0100] \"GET /folder/file.mp3 HTTP/1.1\" 206 5637064 \"-\" \"AppleCoreMedia/1.0.0.12B466 (iPhone; U; CPU OS 8_1_3 like Mac OS X; da_dk)\"</p>\n</blockquote>\n\n<p>Returns the following array(where I am only really interested in [1-6]:</p>\n\n<pre><code>Array\n(\n    [0] =&gt; 100.100.100.100 - - [23/Feb/2015:03:03:56 +0100] \"GET /folder/file.mp3 HTTP/1.1\" 206 5637064 \"-\" \"AppleCoreMedia/1.0.0.12B466 (iPhone; U; CPU OS 8_1_3 like Mac OS X; da_dk)\"\n    [1] =&gt; 100.100.100.100\n    [2] =&gt; 23/Feb/2015:03:03:56 +0100\n    [3] =&gt; folder\n    [4] =&gt; file.mp3\n    [5] =&gt; 206\n    [6] =&gt; AppleCoreMedia/1.0.0.12B466 (iPhone; U; CPU OS 8_1_3 like Mac OS X; da_dk)\n)\n</code></pre>\n\n<p>So my question is - is there a good equivalent to this in Go? I have tried some of the different regexp methods but can't seem to find one thats working for me.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["list", "struct", "go", "linked-list"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1424855460, "post_id": 28714641, "comment_id": 45717687, "body": "What do you mean by &quot;it is not allowing any generic object&quot;? Why exactly could you not use <code>container&#47;list</code>?"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1424856457, "post_id": 28714641, "comment_id": 45718309, "body": "@Ainar-G - I added complete code. I am getting error while accessing Tree struct"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1424857341, "post_id": 28714641, "comment_id": 45718901, "body": "<code>PushFront</code> returns an element, not a list."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 1, "creation_date": 1424857362, "post_id": 28714641, "comment_id": 45718913, "body": "@DineshAppavoo: You&#39;re assigning the result of <code>current.PushFront(...)</code> to <code>current</code>, however <code>current</code> is a <code>*List</code> and <code>PushFront</code> returns a <code>*Element</code>.  You don&#39;t need the assignment."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1424857873, "post_id": 28714641, "comment_id": 45719261, "body": "@JamesHenstridge - Thank you. It helped. But still I am getting interface coversion issue."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1424858834, "post_id": 28714641, "comment_id": 45719875, "body": "Fixed the issue. Error was in the print statement. I didnt parse as a Tree object. Thank You"}], "answers": [{"comments": [{"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1424856517, "post_id": 28714951, "comment_id": 45718347, "body": "It helps. But still getting error. I added the code above. I am getting error while accessing Tree struct"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1424856726, "post_id": 28714951, "comment_id": 45718479, "body": "@DineshAppavoo And what is the error you&#39;re getting?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 1, "creation_date": 1424857292, "post_id": 28714951, "comment_id": 45718861, "body": "@DineshAppavoo Edited my answer to explain why you get that error."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1424858188, "post_id": 28714951, "comment_id": 45719451, "body": "I edited the code based on your suggestion . But I am getting interface conversion error"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1424858867, "post_id": 28714951, "comment_id": 45719905, "body": "Fixed the issue. Error was in the print statement of return object. I didn&#39;t parse as a Tree object. Thank You"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1424858957, "last_edit_date": 1424858957, "creation_date": 1424855081, "answer_id": 28714951, "question_id": 28714641, "link": "https://stackoverflow.com/questions/28714641/what-is-the-equivalent-for-linkedlistt-in-golang/28714951#28714951", "title": "What is the equivalent for LinkedList&lt;T&gt; in Golang", "body": "<p>Go doesn't support generic types (see FAQ question <a href=\"http://golang.org/doc/faq#generics\" rel=\"noreferrer\">Why does Go not have generic types?</a>).</p>\n\n<p>You have to use <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">Type assertions</a> to obtain the typed value you want.</p>\n\n<p>E.g. create your <code>TreeNode</code> type:</p>\n\n<pre><code>type TreeNode struct {\n    Data  int\n    Left  *TreeNode\n    Right *TreeNode\n}\n</code></pre>\n\n<p>And to iterate over a list containing <code>TreeNode</code> values:</p>\n\n<pre><code>l := list.New()\n// Populate list\n\nfor e := l.Front(); e != nil; e = e.Next() {\n    if tn, ok := e.Value.(TreeNode); ok {\n        // do something with tn which is of type TreeNode\n        fmt.Println(tn)\n    } else {\n        // e.Value is not of type TreeNode\n    }\n}\n</code></pre>\n\n<p>If you assemble the list and you can be sure it only contains values of type <code>TreeNode</code>, you can omit the error check in the type assertion and it becomes like this:</p>\n\n<pre><code>for e := l.Front(); e != nil; e = e.Next() {\n    // if e.Value would not be of type TreeNode, run-time panic would occur\n    tn := e.Value.(TreeNode) // tn is of type TreeNode\n    fmt.Println(tn)\n\n}\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>The error you're getting:</p>\n\n<pre><code>cannot use current.PushFront((interface {})(node.Left)) (type *list.Element)\n    as type *list.List in assignment\n</code></pre>\n\n<p>At line:</p>\n\n<pre><code>current = current.PushFront(node.Left)\n</code></pre>\n\n<p>The <code>current</code> variable is of type <code>list.List</code>, and the method <code>current.PushFront()</code> returns a value of type <code>*list.Element</code>. These are 2 different types, you can't assign a <code>*Element</code> to a variable that has a type of <code>List</code>.</p>\n\n<p><strong>Edit 2:</strong></p>\n\n<p>Your 2nd error:</p>\n\n<pre><code>panic: interface conversion: interface is *binarytree.Tree, not int\n</code></pre>\n\n<p>Is caused by the line:</p>\n\n<pre><code>fmt.Print(x.Value.(int), \" \")\n</code></pre>\n\n<p>You try to assert that the value <code>x.Value</code> is of type <code>int</code> but it isn't! <code>x.Value</code> is of type <code>*binarytree.Tree</code> so the assertion will obviously fail.</p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4219, "favorite_count": 1, "accepted_answer_id": 28714951, "answer_count": 1, "score": 2, "last_activity_date": 1424858957, "creation_date": 1424854045, "last_edit_date": 1424858148, "question_id": 28714641, "link": "https://stackoverflow.com/questions/28714641/what-is-the-equivalent-for-linkedlistt-in-golang", "title": "What is the equivalent for LinkedList&lt;T&gt; in Golang", "body": "<p>In my use case, I would like to know how the following Java code would be implemented in Go</p>\n\n<pre><code>class TreeNode {\n    public int data;\n    public TreeNode left;\n    public TreeNode right;\n    public TreeNode(){}\n}\n\nLinkedList&lt;TreeNode&gt; treeList = new LinkedList&lt;TreeNode&gt;();\n</code></pre>\n\n<p>I am able to import the container/list package and add an interface. But it is not allowing any generic object. Do I have to implement my own version of list with TreeNode struct?</p>\n\n<p>I just need to know how <code>LinkedList&lt;T&gt;</code> would work in Go.</p>\n\n<p><strong>EDIT 1:</strong>  To make it clear, I am adding the complete code here. I am trying to find the linked list of all nodes at each depth in a binary tree. I used two packages list and binary tree. You can find the source code for binarytree <a href=\"https://github.com/dineshappavoo/ctci-go/blob/master/src/go/chapter04-treesandgraphs/binarytree/binarytree.go\" rel=\"nofollow\">here</a> and list <a href=\"https://github.com/dineshappavoo/ctci-go/blob/master/src/go/chapter02-linkedlists/list/list.go\" rel=\"nofollow\">here</a>. list is same as container/list but I added few extra functions</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"go/chapter02-linkedlists/list\"\n    \"go/chapter04-treesandgraphs/binarytree\"\n)\nfunc main() {\n\n    inArr := []int{4, 5, 7, 8, 9}\n    t1 := binarytree.NewMinimalHeightBST(inArr, 0, len(inArr)-1)\n    binarytree.InOrderTraverse(t1)\n    var nodeList []*list.List\n\n    nodeList = getLevelbasedList(t1, 0)\n\n    fmt.Println()\n    for _, value := range nodeList {\n        fmt.Print(\"[ \")\n        for x := value.Front(); x != nil; x = x.Next() {\n            fmt.Print(x.Value.(int), \" \")\n        }\n        fmt.Println(\"]\")\n    }\n}\n\nfunc getLevelbasedList(root *binarytree.Tree, level int) []*list.List {\n    if root == nil {\n        return nil\n    }\n    var nodeList []*list.List\n    parents := list.New()\n    current := list.New()\n\n    current.PushFront(root)\n\n    for current.Len() &gt; 0 {\n        nodeList = append(nodeList, current)\n        parents = current\n        current = list.New()\n\n        for x := current.Front(); x != nil; x = x.Next() {\n            node := x.Value.(*binarytree.Tree)\n            if node.Left != nil {\n                current = current.PushFront(node.Left)\n            }\n            if node.Right != nil {\n                current = current.PushFront(node.Right)\n            }\n        }\n        return nodeList\n    }\n}\n</code></pre>\n\n<p>And the error is,</p>\n\n<pre><code>./question4_4b.go:56: cannot use current.PushFront((interface {})(node.Left)) (type *list.Element) as type *list.List in assignment\n./question4_4b.go:59: cannot use current.PushFront((interface {})(node.Right)) (type *list.Element) as type *list.List in assignment\n</code></pre>\n\n<p><strong>EDIT 2:</strong> Based on JamesHenstridge's comment I edited from </p>\n\n<pre><code>current = current.PushFront(node.Left)\n</code></pre>\n\n<p>to </p>\n\n<pre><code>current.PushFront(node.Left)\n</code></pre>\n\n<p>And the issue resolved. But now I am getting interface conversion error,</p>\n\n<pre><code>[ panic: interface conversion: interface is *binarytree.Tree, not int\n\ngoroutine 1 [running]:\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1424845941, "creation_date": 1424845941, "answer_id": 28712659, "question_id": 28712397, "link": "https://stackoverflow.com/questions/28712397/put-stack-trace-to-string-variable/28712659#28712659", "title": "put stack trace to string variable", "body": "<p>Use the <a href=\"http://godoc.org/runtime#Stack\">runtime.Stack</a> function to get the stack trace:</p>\n\n<pre><code>b := make([]byte, 2048) // adjust buffer size to be larger than expected stack\nn := runtime.Stack(b, false)\ns := string(b[:n])\n</code></pre>\n\n<p>An alternative approach is to call <a href=\"http://godoc.org/runtime#Caller\">runtime.Caller</a> in a loop and format the stack trace to a buffer.</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 1, "accepted_answer_id": 28712659, "answer_count": 1, "score": 3, "last_activity_date": 1424845941, "creation_date": 1424844840, "question_id": 28712397, "link": "https://stackoverflow.com/questions/28712397/put-stack-trace-to-string-variable", "title": "put stack trace to string variable", "body": "<p>Is it possible to put stack trace like this ...</p>\n\n<pre><code>goroutine 20 [running]:\nruntime.panic(0x3a2820, 0xc2081ad4b0)\n    /usr/local/go/src/pkg/runtime/panic.c:279 +0xf5\ntesting.func\u00b7006()\n    /usr/local/go/src/pkg/testing/testing.go:416 +0x176\nruntime.panic(0x3a2820, 0xc2081ad4b0)\n    /usr/local/go/src/pkg/runtime/panic.c:248 +0x18d\nmy.Test(0x3a2820, 0xc2081acf20, 0x3a2820, 0xc2081acf30, 0xc208056000)\n    /Users/usr/golang/src/my/testing.go:67 +0x572\n</code></pre>\n\n<p>... in string variable for reformating it and cut off redundunt information for me.</p>\n\n<p>This pseudo code would be like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"runtime\"\n)\n\nfunc main() {\n    var stackStr string\n    stackStr = runtime.GetStackFromHere()\n}\n</code></pre>\n\n<p>I tried <code>panic(\"give me stack trace from here\")</code> but it prints stack trace not in <code>var string</code> but only to console.</p>\n"}, {"tags": ["json", "struct", "go"], "answers": [{"comments": [{"owner": {"reputation": 7026, "user_id": 1819790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347c3c5ef51a2d03a87e9fbb099e9d6c?s=128&d=identicon&r=PG&f=1", "display_name": "pswaminathan", "link": "https://stackoverflow.com/users/1819790/pswaminathan"}, "edited": false, "score": 0, "creation_date": 1428469623, "post_id": 28713884, "comment_id": 47169589, "body": "Thanks for answering (and sorry for the delay!). This certainly does answer my question about how to keep everything in one struct; however, it still doesn&#39;t help me with &quot;how do I keep it from one struct spinning out of control&quot;. I ended up implementing this using an interface \u2014 while it makes the interface signature ugly, it allows me to keep each implementation separate and call on the one appropriate for the source (split out by route). (I may not have explained that correctly in the question.) Thanks again!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1424884914, "last_edit_date": 1424884914, "creation_date": 1424850920, "answer_id": 28713884, "question_id": 28711882, "link": "https://stackoverflow.com/questions/28711882/json-unmarshalling-with-different-keys/28713884#28713884", "title": "JSON Unmarshalling with different keys", "body": "<p>One possibility is to define a <code>struct</code> which has a field for all the variants for your possible inputs, and for convenience provide a method for this struct which will return the field that was found in the input:</p>\n\n<pre><code>type MyJson struct {\n    A *int `json:\"a\"`\n    C *int `json:\"c\"`\n\n    Sec int `json:\"b\"`\n}\n\nfunc (j *MyJson) Init() int {\n    if j.A == nil {\n        return *j.C\n    }\n    return *j.A\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>inputs := []string{\n    `{\"a\": 1, \"b\": 2}`,\n    `{\"c\": 1, \"b\": 2}`}\n\nfor _, input := range inputs {\n    var my MyJson\n    if err := json.Unmarshal([]byte(input), &amp;my); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"Init: %v, Sec: %v\\n\", my.Init(), my.Sec)\n}\n</code></pre>\n\n<p>Output, as expected (try it on the <a href=\"http://play.golang.org/p/FbhIdABSmo\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>Init: 1, Sec: 2\nInit: 1, Sec: 2\n</code></pre>\n\n<h2>And a Little Trick:</h2>\n\n<p>In the original struct we added 2 fields for the 2 possible variants. I defined them as pointers so we can detect which one was found in the JSON input. Now if before unmarshalling we set these pointers to point to the same value, that's all we need: doesn't matter which variant of the input JSON we use, the same value will be set in memory, so you can always just read/refer the <code>Init</code> struct field:</p>\n\n<pre><code>type MyJson struct {\n    Init *int `json:\"a\"`\n    Init2 *int `json:\"c\"`\n\n    Sec int `json:\"b\"`\n}\n\nfunc main() {\n    inputs := []string{\n        `{\"a\": 1, \"b\": 2}`,\n        `{\"c\": 1, \"b\": 2}`}\n\n    for _, input := range inputs {\n        var my MyJson\n        my.Init = new(int) // Allocate an int\n        my.Init2 = my.Init // Set Init2 to point to the same value\n\n        if err := json.Unmarshal([]byte(input), &amp;my); err != nil {\n            panic(err)\n        }\n        fmt.Printf(\"Init: %v, Sec: %v\\n\", *my.Init, my.Sec)\n    }\n}\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/UNmJLJvPkZ\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<p>You can create a function which creates and sets up your <code>MyJson</code> ready for unmarshalling like this:</p>\n\n<pre><code>func NewMyJson() (my MyJson) {\n    my.Init = new(int) // Allocate an int\n    my.Init2 = my.Init // Set Init2 to point to the same value\n    return\n}\n</code></pre>\n\n<p>And so using it becomes this simple:</p>\n\n<pre><code>var my = NewMyJson()\nerr := json.Unmarshal([]byte(input), &amp;my)\n</code></pre>\n\n<h2>Another Trick on the Tricked variant:</h2>\n\n<p>You can specify the <code>Init</code> field not to be a pointer because it is enough for <code>Init2</code> to be a pointer and point to <code>Init</code>, so this becomes even more simple and desirable (but then <code>NewMyJson</code> must return a pointer):</p>\n\n<pre><code>type MyJson struct {\n    Init  int `json:\"a\"`\n    Init2 *int `json:\"c\"`\n\n    Sec int `json:\"b\"`\n}\n\nfunc NewMyJson() *MyJson {\n    my := new(MyJson)\n    my.Init2 = &amp;my.Init // Set Init2 to point to Init\n    return my\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7026, "user_id": 1819790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347c3c5ef51a2d03a87e9fbb099e9d6c?s=128&d=identicon&r=PG&f=1", "display_name": "pswaminathan", "link": "https://stackoverflow.com/users/1819790/pswaminathan"}, "edited": false, "score": 0, "creation_date": 1428469645, "post_id": 28759121, "comment_id": 47169599, "body": "Thanks for answering (and sorry for the delay!). This certainly does answer my question about how to keep everything in one struct; however, it still doesn&#39;t help me with &quot;how do I keep it from one struct/method spinning out of control&quot;. I ended up implementing this using an interface \u2014 while it makes the interface signature ugly, it allows me to keep each implementation separate and call on the one appropriate for the source (split out by route). (I may not have explained that correctly in the question.) Thanks again!"}, {"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "edited": false, "score": 0, "creation_date": 1508832381, "post_id": 28759121, "comment_id": 80757189, "body": "this code goes into an inifite loop and gives stackoverflow error as :  runtime: goroutine stack exceeds 250000000-byte limit fatal error: stack overflow  runtime stack: runtime.throw(0x122d67, 0xe) \t/usr/local/go/src/runtime/panic.go:605 +0x100 runtime.newstack(0x0, 0x0) \t/usr/local/go/src/runtime/stack.go:1050 +0x960 runtime.morestack() \t/usr/local/go/src/runtime/asm_amd64p32.s:378 +0xa0"}, {"owner": {"reputation": 230, "user_id": 2152105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5YGz.jpg?s=128&g=1", "display_name": "Jaemin Park", "link": "https://stackoverflow.com/users/2152105/jaemin-park"}, "reply_to_user": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "edited": false, "score": 1, "creation_date": 1511845409, "post_id": 28759121, "comment_id": 82004738, "body": "@miladzahedi Yes, it should be a infinite loop in current version of Go. To prevent it, the value which unmarshaled inside of <code>func (*MyJson) UnmarshalJSON()</code> should not be MyJson."}], "tags": [], "owner": {"reputation": 230, "user_id": 2152105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5YGz.jpg?s=128&g=1", "display_name": "Jaemin Park", "link": "https://stackoverflow.com/users/2152105/jaemin-park"}, "is_accepted": false, "score": 4, "last_activity_date": 1597200446, "last_edit_date": 1597200446, "creation_date": 1425019643, "answer_id": 28759121, "question_id": 28711882, "link": "https://stackoverflow.com/questions/28711882/json-unmarshalling-with-different-keys/28759121#28759121", "title": "JSON Unmarshalling with different keys", "body": "<p>icza's approach is good, and better if this implementation could match stdlib's interface.</p>\n<p>I suggest implementing <a href=\"http://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\"><code>json.Unmarshaler</code></a>:</p>\n<pre><code>// it can't get c itself.\ntype MyJson struct {\n    A int `json:&quot;a&quot;`\n    B int `json:&quot;b&quot;`\n}\n\nfunc (j *MyJson) UnmarshalJSON(b []byte) error {\n    type Alias MyJson\n    realValue := struct {\n        *Alias\n        C int `json:&quot;c&quot;`  // &lt;- now it can accept 'c' value\n    }{(*Alias)(j), 0}\n\n    if err := json.Unmarshal(b, &amp;realValue); err != nil {\n        return err\n    } else if realValue.C != 0 {\n        // if C has value, overwrite A\n        realValue.A = realValue.C\n    }\n\n    return nil\n}\n</code></pre>\n<p>And just decode it using <code>json.Unmarshal</code>.</p>\n"}], "owner": {"reputation": 7026, "user_id": 1819790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347c3c5ef51a2d03a87e9fbb099e9d6c?s=128&d=identicon&r=PG&f=1", "display_name": "pswaminathan", "link": "https://stackoverflow.com/users/1819790/pswaminathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1230, "favorite_count": 2, "answer_count": 2, "score": 4, "last_activity_date": 1597200446, "creation_date": 1424842427, "question_id": 28711882, "link": "https://stackoverflow.com/questions/28711882/json-unmarshalling-with-different-keys", "title": "JSON Unmarshalling with different keys", "body": "<p>I'm trying to unmarshal some JSON from different sources that may have different keys. For instance, I may have:</p>\n\n<pre><code>{\n    \"a\": 1,\n    \"b\": 2\n}\n</code></pre>\n\n<p>Or I may have:</p>\n\n<pre><code>{\n    \"c\": 1,\n    \"b\": 2\n}\n</code></pre>\n\n<p>In this case, I can guarantee that \"b\" will be there. However, I want \"a\" and \"c\" to be represented the same way. In effect, what I want is:</p>\n\n<pre><code>type MyJson struct {\n    Init int `json:\"a\",json:\"c\"`\n    Sec  int `json:\"b\"\n}\n</code></pre>\n\n<p>Basically I want the unmarshaller to look for either key and set it as <code>Init</code>. Now this doesn't actually work (or I wouldn't be posting). Unmarshalling the first gives me what I want, while the second sets <code>Init</code> to 0. My ideal option would be to unmarshal to a struct, with one of two possibilities:</p>\n\n<ol>\n<li>I represent the struct with multiple tags as above</li>\n<li>I define multiple structs, but am able to choose which to unmarshal to</li>\n</ol>\n\n<p>I tried to implement number 2 by making two different structs and a map, but it seems I can't make a map with a type as the second value:</p>\n\n<pre><code>type MyJson1 struct {\n    Init int `json:\"a\"`\n    Sec  int `json:\"b\"`\n}\n\ntype MyJson2 struct {\n    Init int `json:\"c\"`\n    Sec  int `json:\"b\"`\n}\n</code></pre>\n\n<p>Is there a way to define a set of structs that behaves like an interface? That is, they all have the same fields, but are defined differently. Or maybe there's another way. I could make the fields unmarshalling \"a\" and \"c\" other fields, then set <code>Init</code> accordingly. But this doesn't scale beyond a couple of variants.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 3, "creation_date": 1424841166, "post_id": 28710974, "comment_id": 45711564, "body": "I don&#39;t have experience with <code>sqlx</code> but for libraries that depend on reflection to fill in structures defined in other packages, it is often required that the fields be exported.  None of the fields in <code>serverStructV1</code> are exported (because they don&#39;t start with a capital letter), so that could be your problem."}, {"owner": {"reputation": 79, "user_id": 4437981, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39c0d4ecf94327d12027be28e7dd66e4?s=128&d=identicon&r=PG&f=1", "display_name": "Xiujiao Gao", "link": "https://stackoverflow.com/users/4437981/xiujiao-gao"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1424888158, "post_id": 28710974, "comment_id": 45739646, "body": "Thanks! I tried your comments, but it did not work. Seems I connected to database, but failed to query database."}, {"owner": {"reputation": 79, "user_id": 4437981, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39c0d4ecf94327d12027be28e7dd66e4?s=128&d=identicon&r=PG&f=1", "display_name": "Xiujiao Gao", "link": "https://stackoverflow.com/users/4437981/xiujiao-gao"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1424899260, "post_id": 28710974, "comment_id": 45745842, "body": "actually you are right. sorry for the miscomment before. I tried it again, it works now.Thank you!"}, {"owner": {"reputation": 9858, "user_id": 973380, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b760f503c84d1bf47322f401066c753f?s=128&d=identicon&r=PG", "display_name": "fiatjaf", "link": "https://stackoverflow.com/users/973380/fiatjaf"}, "edited": false, "score": 0, "creation_date": 1456255953, "post_id": 28710974, "comment_id": 58859427, "body": "The question is not a duplicate."}], "owner": {"reputation": 79, "user_id": 4437981, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39c0d4ecf94327d12027be28e7dd66e4?s=128&d=identicon&r=PG&f=1", "display_name": "Xiujiao Gao", "link": "https://stackoverflow.com/users/4437981/xiujiao-gao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1104, "favorite_count": 0, "closed_date": 1424862932, "answer_count": 0, "score": 0, "last_activity_date": 1424888100, "creation_date": 1424837457, "last_edit_date": 1424888100, "question_id": 28710974, "link": "https://stackoverflow.com/questions/28710974/non-struct-dest-type-struct-with-1-columns", "closed_reason": "Duplicate", "title": "non-struct dest type struct with &gt;1 columns", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/jmoiron/sqlx\"\n    _ \"github.com/lib/pq\"\n    \"net/http\"\n    \"log\"\n    \"encoding/json\"\n    \"time\"\n)\n\ntype serverStructV1 struct {\n    id         int       `db:\"id\"`\n    hostname   string    `db:\"hostname\"`\n    nickname   string    `db:\"nickname\"`\n    locationIp string    `db:\"location_ip\"`\n    updatedAt  time.Time `db:\"updatedAt\"`\n}\n\nfunc serversHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hello, world/n\")\n\n    db, err := sqlx.Open(\"postgres\", \"postgres://afdata:afdata@/afdata?sslmode=disable\")\n    if err!= nil{\n        log.Fatal(err)\n    }\n    defer db.Close()\n    err = db.Ping()\n    if err != nil {\n        panic(err.Error())\n    }\n\n    serversdisplay := []serverStructV1{}\n    err = db.Select(&amp;serversdisplay, \"select id,hostname,nickname,location_ip,updatedAt from afdata.serversV1\")\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>When I run it , it says on-struct dest type struct with >1 columns (5), if I change </p>\n\n<pre><code> err = db.Select(&amp;serversdisplay, \"select id,hostname,nickname,location_ip,updatedAt from afdata.serversV1\")\n</code></pre>\n\n<p>into </p>\n\n<pre><code> err = db.Select(&amp;serversdisplay, \"select id from afdata.serversV1\")\n</code></pre>\n\n<p>the result becomes null.\nI test select query using psql, it can return NOT NULL results. but even when the columns match, it is returning null. It connects to database, but did not get query result.</p>\n"}, {"tags": ["go", "toolchain"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1424855955, "post_id": 28710397, "comment_id": 45718002, "body": "Check out this answer: <a href=\"http://stackoverflow.com/a/28166550/1705598\">Listing packages and their dependencies (imports)</a>"}, {"owner": {"reputation": 76487, "user_id": 34218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f657c6adf1e623cd6f8818408ecd8f75?s=128&d=identicon&r=PG", "display_name": "Jason Coco", "link": "https://stackoverflow.com/users/34218/jason-coco"}, "edited": false, "score": 1, "creation_date": 1424908603, "post_id": 28710397, "comment_id": 45750066, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/28166249/how-to-list-installed-go-packages\">How to list installed go packages</a>"}], "answers": [{"tags": [], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "is_accepted": true, "score": 0, "last_activity_date": 1424833835, "creation_date": 1424833835, "answer_id": 28710452, "question_id": 28710397, "link": "https://stackoverflow.com/questions/28710397/how-to-list-imported-module-on-a-go-source-code-directory/28710452#28710452", "title": "How to list imported module on a go source code directory", "body": "<p>Ah found the <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/611QEJqkDKw\" rel=\"nofollow\">way</a>..</p>\n\n<pre><code>go list -f '{{join .Deps \"\\n\"}}' |  xargs go list -f '{{if not .Standard}}{{.ImportPath}}{{end}} ' | sort | uniq\n</code></pre>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 28710452, "answer_count": 1, "score": -1, "last_activity_date": 1424833835, "creation_date": 1424833547, "question_id": 28710397, "link": "https://stackoverflow.com/questions/28710397/how-to-list-imported-module-on-a-go-source-code-directory", "title": "How to list imported module on a go source code directory", "body": "<p>Is there an <code>tool</code> or easiest way to list all imported packages on go source code directory? for example:</p>\n\n<pre><code>$ go list_imports a_directory/\ngithub.com/bla/bla\ngithub.com/foo/bar\nLOCAL/module/path\n</code></pre>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1425081318, "post_id": 28710276, "comment_id": 45830716, "body": "May be simplest, though a bit of a sad hack, to vendor the package with <code>godep</code>, <code>nut</code>, or some such tool and edit the build flags in your version. (It&#39;s common to vendor anyway, so you only get upgrades when you want them.) Possible you could pass Go the env var <code>CC=some_batchfile.bat</code> (or CXX= if a C++ compiler is being invoked) and make that file substitute in the params you want, but that&#39;s almost too painful even if it works. (With vendoring, at least the flow for your changes is similar to one others are already doing for dependency management.)"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1432257693, "post_id": 28710276, "comment_id": 48863024, "body": "fork the project, change the source, go get the forked repo :)"}], "answers": [{"tags": [], "owner": {"reputation": 1081, "user_id": 1976730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f2d3471083d1569b698ff42ca5f303?s=128&d=identicon&r=PG", "display_name": "sqweek", "link": "https://stackoverflow.com/users/1976730/sqweek"}, "is_accepted": false, "score": 1, "last_activity_date": 1433087952, "creation_date": 1433087952, "answer_id": 30559462, "question_id": 28710276, "link": "https://stackoverflow.com/questions/28710276/override-an-external-packages-cgo-compiler-and-linker-flags/30559462#30559462", "title": "Override an external package&#39;s cgo compiler and linker flags?", "body": "<p>This is kind of the role filled by <code>#cgo pkgconfig: foobar</code>. If the library had been written that way, it would pick up the correct paths from foobar's pkgconfig definition.</p>\n\n<p>I realise its not a direct answer to the question, and that pkgconfig isn't exactly a native windows tool... I'd be interested to hear if any other solutions exist.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 336140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec0131a87c17c14f29dce7571e2b8f0?s=128&d=identicon&r=PG", "display_name": "David E", "link": "https://stackoverflow.com/users/336140/david-e"}, "is_accepted": false, "score": 4, "last_activity_date": 1455911040, "creation_date": 1455911040, "answer_id": 35513661, "question_id": 28710276, "link": "https://stackoverflow.com/questions/28710276/override-an-external-packages-cgo-compiler-and-linker-flags/35513661#35513661", "title": "Override an external package&#39;s cgo compiler and linker flags?", "body": "<p>You can do this by setting the <code>CGO_CPPFLAGS</code> and <code>CGO_LDFLAGS</code> environment variables.</p>\n\n<p>For example, on my MacBook, Homebrew is installed in <code>~/.homebrew</code> (instead of <code>/usr/local</code>), so when I try to <code>go get</code> packages with native bindings they can't find the headers and libs.</p>\n\n<p>To fix that I added these two lines to my <code>~/.zshenv</code> file:</p>\n\n<pre><code>export CGO_CPPFLAGS=\"-I $BREW_HOME/include\"\nexport CGO_LDFLAGS=\"-L $BREW_HOME/lib\"\n</code></pre>\n"}], "owner": {"reputation": 1453, "user_id": 121546, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fceead8d65324ead613a78416f5e257b?s=128&d=identicon&r=PG&f=1", "display_name": "jCuga", "link": "https://stackoverflow.com/users/121546/jcuga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4425, "favorite_count": 1, "answer_count": 2, "score": 8, "last_activity_date": 1519498215, "creation_date": 1424832749, "last_edit_date": 1519498215, "question_id": 28710276, "link": "https://stackoverflow.com/questions/28710276/override-an-external-packages-cgo-compiler-and-linker-flags", "title": "Override an external package&#39;s cgo compiler and linker flags?", "body": "<p>Let's say I want to use some awesome go package.  I can include it by:</p>\n\n<pre><code>import \"github.com/really-awesome/project/foobar\"\n</code></pre>\n\n<p>And inside that project's foobar.go file, it defines some <code>cgo</code> instructions like:</p>\n\n<pre><code>#cgo windows CFLAGS: -I C:/some-path/Include\n#cgo windows LDFLAGS: -L C:/some-path/Lib -lfoobar\n</code></pre>\n\n<p>But if I have that <code>foobar</code> C dependency installed somewhere else, I would really need those lines to say:</p>\n\n<pre><code>#cgo windows CFLAGS: -I C:/different-path/Include\n#cgo windows LDFLAGS: -L C:/different-path/Lib -lfoobar\n</code></pre>\n\n<p>Is there a way to override or trump where <code>cgo</code> is looking for these dependencies?  Right now my fix is to manually edit those two lines after running <code>go get ./...</code> which will fetch the <code>github.comreally-awesome/project/foobar</code> code.</p>\n\n<p>NOTE: I'm using the <code>MinGw</code> compiler, though I doubt that matters. </p>\n\n<h3>update:</h3>\n\n<p>I have tried adding flags to go build to no avail:</p>\n\n<pre><code>go build -x -gcflags=\"-I C:/different/include -L C:/different-path/lib -lfoobar\"\ngo build -x -ccflags=\"-I C:/different/include\" -ldflags=\"-L C:/different-path/lib -lfoobar\"\n</code></pre>\n\n<p>With the <code>-x</code> argument I see the printout of flags and they don't include the ones I am setting on the command line.  Perhaps the <code>#cgo CFLAGS/LDFLAGS</code> statements at the top of the external go package squash what I am telling it to use...</p>\n"}, {"tags": ["go", "pass-by-reference", "slice"], "comments": [{"owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "edited": false, "score": 1, "creation_date": 1424827054, "post_id": 28709254, "comment_id": 45707935, "body": "Keep in mind that by doing this, you&#39;re being a bit redundant. According to the docs (<a href=\"https://golang.org/doc/effective_go.html#slices\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#slices</a>) because a slice contains a pointer to the underlying array, you&#39;re always technically passing the array referenced by the slice by reference, which means any manipulation you do is done to the original data, and you&#39;re not duplicating any more than the slice data which encapsulates the array."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1424841403, "post_id": 28709254, "comment_id": 45711635, "body": "Nothing in Go is &quot;passed by reference&quot;. Everything is passed by values; even pointers."}], "answers": [{"comments": [{"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1424826593, "post_id": 28709338, "comment_id": 45707814, "body": "This worked. Thank you. Could you give me the URL or doc where I can read more about this?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 3, "creation_date": 1424827946, "post_id": 28709338, "comment_id": 45708202, "body": "I&#39;d have to look around for a short description, but basically <code>s[0]</code> is an expression, and the <code>*</code> operator works on the result of that expression."}, {"owner": {"reputation": 532, "user_id": 1253085, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3b2d38400aae0aa75cb75eae754c24a9?s=128&d=identicon&r=PG", "display_name": "Tyguy7", "link": "https://stackoverflow.com/users/1253085/tyguy7"}, "edited": false, "score": 0, "creation_date": 1454462226, "post_id": 28709338, "comment_id": 58051914, "body": "This was very helpful!  Thank you!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 15, "last_activity_date": 1424826173, "creation_date": 1424826173, "answer_id": 28709338, "question_id": 28709254, "link": "https://stackoverflow.com/questions/28709254/how-to-access-elements-from-slice-using-index-which-is-passed-by-reference-in-go/28709338#28709338", "title": "How to access elements from slice using index which is passed by reference in golang", "body": "<p>The index operator doesn't automatically dereference pointers. You need to use parentheses to specify what is dereferenced.</p>\n\n<pre><code>m := (*s)[0]\n</code></pre>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3466, "favorite_count": 1, "accepted_answer_id": 28709338, "answer_count": 1, "score": 2, "last_activity_date": 1424826173, "creation_date": 1424825604, "last_edit_date": 1424825983, "question_id": 28709254, "link": "https://stackoverflow.com/questions/28709254/how-to-access-elements-from-slice-using-index-which-is-passed-by-reference-in-go", "title": "How to access elements from slice using index which is passed by reference in golang", "body": "<p>I passed a reference of a slice to a function and I am making changes in the slice inside the function. Also I am trying to access an element from the slice using index. It is throwing exception in golang. What is the best way to access an element from a slice by index which is passed by reference?\n You can find a sample code here. [ref : <a href=\"http://www.reddit.com/r/golang/comments/283vpk/help_with_slices_and_passbyreference/\" rel=\"nofollow\">http://www.reddit.com/r/golang/comments/283vpk/help_with_slices_and_passbyreference/</a> ]. Since my code is huge I added a sample.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype mystruct struct {\n    val int\n}\n\nfunc main() {\n    var s1 []mystruct\n    var s2 []mystruct\n\n    onlyPassing(&amp;s1)\n    s2 = returningToo(s2)\n\n    fmt.Printf(\"%#v\\n%#v\", s1, s2)\n}\n\nfunc onlyPassing(s *[]mystruct) {\n    *s = append(*s, mystruct{1})\n    m := *s[0]\n\n}\n\nfunc returningToo(s []mystruct) []mystruct {\n    s = append(s, mystruct{1})\n    return s\n}\n</code></pre>\n\n<p>And you can find the implementation <a href=\"http://play.golang.org/p/il4Lt_RRHy\" rel=\"nofollow\">here</a>. Could anyone help me on this. </p>\n"}, {"tags": ["javascript", "json", "web", "go", "bytearray"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1424823972, "post_id": 28708919, "comment_id": 45707184, "body": "What is the client expecting? An jpeg/png encoded image? An octet-stream? Some binary format representing <code>[][]byte</code>?"}, {"owner": {"reputation": 354, "user_id": 2570641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5e4864b8cc325fdfa6dc927ec2625b12?s=128&d=identicon&r=PG&f=1", "display_name": "shinjin", "link": "https://stackoverflow.com/users/2570641/shinjin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1424827479, "post_id": 28708919, "comment_id": 45708056, "body": "On the client-side, I want to turn the <code>[][]byte</code> back to pngs"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1424828089, "post_id": 28708919, "comment_id": 45708242, "body": "<code>[][]byte</code> has no meaning over a network. What is the actual data format expected by the client? Do you want to just send the raw bytes?"}, {"owner": {"reputation": 354, "user_id": 2570641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5e4864b8cc325fdfa6dc927ec2625b12?s=128&d=identicon&r=PG&f=1", "display_name": "shinjin", "link": "https://stackoverflow.com/users/2570641/shinjin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1424830581, "post_id": 28708919, "comment_id": 45708878, "body": "apologies for being unclear; as you said above it is a jpeg/png encoded image. Each image is represented in the Golang backend as an <code>[]byte</code>"}], "answers": [{"comments": [{"owner": {"reputation": 354, "user_id": 2570641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5e4864b8cc325fdfa6dc927ec2625b12?s=128&d=identicon&r=PG&f=1", "display_name": "shinjin", "link": "https://stackoverflow.com/users/2570641/shinjin"}, "edited": false, "score": 0, "creation_date": 1424915148, "post_id": 28727894, "comment_id": 45751856, "body": "hey JimB, it worked like a charm for a single image, thanks so much.  However, I am trying to send an entire array of images <code>[][]byte</code>, and the responseWriter seems to only take a <code>[]byte</code> as an argument.  Any advice?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 354, "user_id": 2570641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5e4864b8cc325fdfa6dc927ec2625b12?s=128&d=identicon&r=PG&f=1", "display_name": "shinjin", "link": "https://stackoverflow.com/users/2570641/shinjin"}, "edited": false, "score": 0, "creation_date": 1424973353, "post_id": 28727894, "comment_id": 45780737, "body": "@shinjin: If you want to send multiple images, you need some way to frame that data which the client understands. HTTP itself already provides a protocol to do this, by making one request per image."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1424973515, "last_edit_date": 1424973515, "creation_date": 1424892507, "answer_id": 28727894, "question_id": 28708919, "link": "https://stackoverflow.com/questions/28708919/how-does-one-send-a-byte-in-golang-to-the-browser-to-be-decoded-as-an-image/28727894#28727894", "title": "How does one send a [][]byte in Golang to the browser to be decoded as an image", "body": "<p>If your image is stored in a <code>[]byte</code>, you can write that directly to the <code>http.ResponseWriter</code></p>\n\n<pre><code>func GetImage(w http.ResponseWriter, r *http.Request) {\n    image, err := getImage() // getImage example returns ([]byte, error)\n    if err != {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    w.Write(image)\n}\n</code></pre>\n\n<p>There's no way to send multiple images in a single response which is natively understood by clients. One method you could use is to return a json document on the first call, which contains a list of links to fetch each image individually. </p>\n"}], "owner": {"reputation": 354, "user_id": 2570641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5e4864b8cc325fdfa6dc927ec2625b12?s=128&d=identicon&r=PG&f=1", "display_name": "shinjin", "link": "https://stackoverflow.com/users/2570641/shinjin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3266, "favorite_count": 0, "accepted_answer_id": 28727894, "answer_count": 1, "score": 0, "last_activity_date": 1424973515, "creation_date": 1424823504, "question_id": 28708919, "link": "https://stackoverflow.com/questions/28708919/how-does-one-send-a-byte-in-golang-to-the-browser-to-be-decoded-as-an-image", "title": "How does one send a [][]byte in Golang to the browser to be decoded as an image", "body": "<p>In my back-end golang web server I have converted and processed a directory of images that i have read in using <code>os.ReadDir</code></p>\n\n<p>These images are stored as a <code>[][]byte</code>.  I want to be able to send these images through a GET request to be displayed in the browser using Javascript.</p>\n\n<p>I am having trouble figuring out how to begin the process to send the data from the Golang web server.  The resources I am currently using are the typical net/http package, and Gorilla Mux/Websockets.</p>\n\n<p>Here is some sample code that shows how I am currently doing a get request which return some json.  How can I similarly send a [][]byte array instead of rendering a template or JSON?</p>\n\n<pre><code>import (\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n    \"encoding/json\"\n    \"github.com/gorilla/mux\"\n)\n\nfunc ViewSample(rw http.ResponseWriter, req *http.Request) {\n    type Sample struct {\n        Id        int    `json:\"id\"`\n        Name      string `json:\"name\"`\n        User      string `json:\"user\n    }\n\n    params := mux.Vars(req)\n    sampleId := params[\"id\"]\n\n    sample := Sample{\n        Id:        3,\n        Name:      \"test\",\n        User:      \"testuser\" \n    }\n\n    json.NewEncoder(rw).Encode(sample)\n}\n</code></pre>\n"}, {"tags": ["go", "stdout", "pager"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 3, "creation_date": 1424810271, "post_id": 28705716, "comment_id": 45701065, "body": "The question is very unclear.  If you print to stdout and the user manually invokes a pager, then ... you&#39;ve achieved what you want."}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1424810427, "post_id": 28705716, "comment_id": 45701154, "body": "I think the question explains perfectly what I want. What I&#39;m trying to achieve is to pipe the stdout of my go program to the call to $PAGER"}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1424818576, "post_id": 28706113, "comment_id": 45705298, "body": "Years ago (Oct 2012 according to <code>ls</code>) I <a href=\"https://gist.github.com/dchapes/1d0c538ce07902b76c75\" rel=\"nofollow noreferrer\">made a package to do something like this</a>. I vaguely recall there was some problem/issue with actually using it however (e.g. I tried adding it to <code>godoc</code> to make it like <code>hg man</code> with the pager extension enabled, but I ended up back with just piping through a pager on the command line instead)."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424849052, "post_id": 28706113, "comment_id": 45714618, "body": "You can do <a href=\"http://golang.org/pkg/os/exec/#cmd.StdinPipe\" rel=\"nofollow noreferrer\"><code>w, err := cmd.StdinPipe()</code></a> to let arbitrary code write to the process through <code>w</code>."}, {"owner": {"reputation": 1388, "user_id": 4566989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297ed68785ef48dca20e154033d787f5?s=128&d=identicon&r=PG", "display_name": "leonardo", "link": "https://stackoverflow.com/users/4566989/leonardo"}, "edited": false, "score": 0, "creation_date": 1558180833, "post_id": 28706113, "comment_id": 99020634, "body": "You&#39;re right you could: <code>pager := os.ExpandEnv(&quot;$PAGER&quot;)</code>"}], "tags": [], "owner": {"reputation": 8356, "user_id": 443265, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f10e24ce2786d8a6ddb4d79462dce5?s=128&d=identicon&r=PG", "display_name": "Martin T&#246;rnwall", "link": "https://stackoverflow.com/users/443265/martin-t%c3%b6rnwall"}, "is_accepted": true, "score": 4, "last_activity_date": 1424811546, "creation_date": 1424811546, "answer_id": 28706113, "question_id": 28705716, "link": "https://stackoverflow.com/questions/28705716/paging-output-from-go/28706113#28706113", "title": "Paging output from Go", "body": "<p>You can use the <a href=\"http://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">os/exec</a> package to start a process that runs <code>less</code> (or whatever is in <code>$PAGER</code>) and then pipe a string to its standard input. The following worked for me:</p>\n\n<pre><code>func main() {\n    // Could read $PAGER rather than hardcoding the path.\n    cmd := exec.Command(\"/usr/bin/less\")\n\n    // Feed it with the string you want to display.\n    cmd.Stdin = strings.NewReader(\"The text you want to show.\")\n\n    // This is crucial - otherwise it will write to a null device.\n    cmd.Stdout = os.Stdout\n\n    // Fork off a process and wait for it to terminate.\n    err := cmd.Run()\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "edited": false, "score": 0, "creation_date": 1608698592, "post_id": 28709379, "comment_id": 115658523, "body": "ah, it was   <code>out.Close()</code> that I was missing. That allows you to use Less navigation without it messing up"}], "tags": [], "owner": {"reputation": 632, "user_id": 872227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ddef50299354758664f679265746cd?s=128&d=identicon&r=PG", "display_name": "freeformz", "link": "https://stackoverflow.com/users/872227/freeformz"}, "is_accepted": false, "score": 2, "last_activity_date": 1424826421, "creation_date": 1424826421, "answer_id": 28709379, "question_id": 28705716, "link": "https://stackoverflow.com/questions/28705716/paging-output-from-go/28709379#28709379", "title": "Paging output from Go", "body": "<p>Here is a somewhat naive <strong>cat</strong> example that uses <code>$PAGER</code> when set.</p>\n\n<pre><code>package main\n\nimport (\n        \"io\"\n        \"log\"\n        \"os\"\n        \"os/exec\"\n)\n\nfunc main() {\n        var out io.WriteCloser\n        var cmd *exec.Cmd\n\n        if len(os.Args) != 2 {\n                log.Fatal(\"Wrong number of args: gcat &lt;file&gt;\")\n        }\n        fileName := os.Args[1]\n        file, err := os.Open(fileName)\n        if err != nil {\n                log.Fatal(\"Error opening file: \", err)\n        }\n\n        pager := os.Getenv(\"PAGER\")\n\n        if pager != \"\" {\n                cmd = exec.Command(pager)\n\n                var err error\n                out, err = cmd.StdinPipe()\n                if err != nil {\n                        log.Fatal(err)\n                }\n\n                cmd.Stdout = os.Stdout\n\n                if err := cmd.Start(); err != nil {\n                        log.Fatal(\"Unable to start $PAGER: \", err)\n                }\n\n        } else {\n                out = os.Stdout\n        }\n\n        _, err = io.Copy(out, file)\n        if err != nil {\n                log.Fatal(err)\n        }\n\n        file.Close()\n        out.Close()\n\n        if cmd != nil {\n                if err := cmd.Wait(); err != nil {\n                        log.Fatal(\"Error waiting for cmd: \", err)\n                }\n        }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 490, "user_id": 3310759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/409b69c3ae7b431fc16129ccdadae9cd?s=128&d=identicon&r=PG", "display_name": "driusan", "link": "https://stackoverflow.com/users/3310759/driusan"}, "is_accepted": false, "score": 2, "last_activity_date": 1452386915, "last_edit_date": 1452386915, "creation_date": 1452385825, "answer_id": 34700649, "question_id": 28705716, "link": "https://stackoverflow.com/questions/28705716/paging-output-from-go/34700649#34700649", "title": "Paging output from Go", "body": "<p>I assume you already have output being printed from your program to stdout that you want to have captured and sent to your pager, you don't want to\nrewrite the I/O to use another input stream like the other responses require.</p>\n\n<p>You can create an os.Pipe which works the same as running a command with \"|less\" by attaching one side to your pager and the other side to stdout like this:</p>\n\n<pre><code>// Create a pipe for a pager to use\nr, w, err := os.Pipe()\nif err != nil {\n    panic(\"You probably want to fail more gracefully than this\")\n}\n\n// Capture STDOUT for the Pager. Keep the old\n// value so we can restore it later.\nstdout := os.Stdout\nos.Stdout = w\n\n// Create the pager process to execute and attach\n// the appropriate I/O streams.\npager := exec.Command(\"less\")\npager.Stdin = r\npager.Stdout = stdout // the pager uses the original stdout, not the pipe\npager.Stderr = os.Stderr\n\n// Defer a function that closes the pipe and invokes\n// the pager, then restores os.Stdout after this function\n// returns and we've finished capturing output.\n//\n// Note that it's very important that the pipe is closed,\n// so that EOF is sent to the pager, otherwise weird things \n// will happen.\ndefer func() {\n    // Close the pipe\n    w.Close()\n    // Run the pager\n    if err := pager.Run(); err != nil {\n        fmt.Fprintln(os.Stderr, err)\n    }\n    // restore stdout\n    os.Stdout = stdout\n}()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 2815457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P1b3d.jpg?s=128&g=1", "display_name": "John Haxby", "link": "https://stackoverflow.com/users/2815457/john-haxby"}, "is_accepted": false, "score": 0, "last_activity_date": 1547555892, "last_edit_date": 1547555892, "creation_date": 1547554675, "answer_id": 54198703, "question_id": 28705716, "link": "https://stackoverflow.com/questions/28705716/paging-output-from-go/54198703#54198703", "title": "Paging output from Go", "body": "<p>This version creates an <code>io.Writer</code> called <code>pager</code> for all the output that you want paged (you can assign it to <code>os.Stdout</code> if you like) and correctly closes that and waits for the <code>$PAGER</code> when <code>main()</code> returns.</p>\n\n<pre><code>\nimport (\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"os\"\n    \"os/exec\"\n)\n\nvar pager io.WriteCloser\n\nfunc main() {\n    var cmd *exec.Cmd\n    cmd, pager = runPager()\n    defer func() {\n        pager.Close()\n        cmd.Wait()\n    }()\n    fmt.Fprintln(pager, \"Hello, \u4e16\u754c\")\n}\n\nfunc runPager() (*exec.Cmd, io.WriteCloser) {\n    pager := os.Getenv(\"PAGER\")\n    if pager == \"\" {\n        pager = \"more\"\n    }\n    cmd := exec.Command(pager)\n    out, err := cmd.StdinPipe()\n    if err != nil {\n        log.Fatal(err)\n    }\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    if err := cmd.Start(); err != nil {\n        log.Fatal(err)\n    }\n    return cmd, out\n}\n</code></pre>\n"}], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1789, "favorite_count": 2, "accepted_answer_id": 28706113, "answer_count": 4, "score": 1, "last_activity_date": 1547555892, "creation_date": 1424810025, "question_id": 28705716, "link": "https://stackoverflow.com/questions/28705716/paging-output-from-go", "title": "Paging output from Go", "body": "<p>I'm trying print to stdout from golang using <code>$PAGER</code> or manually invoking <code>more</code> or <code>less</code> to allow the user to easily scroll through a lot of options. How can I achieve this?</p>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1424810831, "post_id": 28705375, "comment_id": 45701381, "body": "Which line is line 29? Where the code panics"}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 0, "creation_date": 1424811110, "post_id": 28705375, "comment_id": 45701532, "body": "I would think the problem is in <code>val := reflect.ValueOf(c.AppController).Elem()</code>"}, {"owner": {"reputation": 8356, "user_id": 443265, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f10e24ce2786d8a6ddb4d79462dce5?s=128&d=identicon&r=PG", "display_name": "Martin T&#246;rnwall", "link": "https://stackoverflow.com/users/443265/martin-t%c3%b6rnwall"}, "edited": false, "score": 0, "creation_date": 1424812539, "post_id": 28705375, "comment_id": 45702304, "body": "Or maybe it&#39;s something that happens in the call to <code>attachMethodValue.Call(args)</code>. Either way, we&#39;ll need the exact location of the error."}, {"owner": {"reputation": 4943, "user_id": 801337, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed7f3395127c7b16f7e9cca76ecd9cb0?s=128&d=identicon&r=PG", "display_name": "Poyan", "link": "https://stackoverflow.com/users/801337/poyan"}, "edited": false, "score": 0, "creation_date": 1424813024, "post_id": 28705375, "comment_id": 45702576, "body": "Updated the code, removed dependency on Revel. Now it&#39;s simple Go-code, but it&#39;s still not working."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1424815813, "creation_date": 1424815813, "answer_id": 28707339, "question_id": 28705375, "link": "https://stackoverflow.com/questions/28705375/go-reflect-method-call-invalid-memory-address-or-nil-pointer-dereference/28707339#28707339", "title": "Go Reflect Method Call invalid memory address or nil pointer dereference", "body": "<p>It panics because the UserModel pointer is nil. I think you want:</p>\n\n<pre><code>c := &amp;UserController{UserModel: &amp;UserModel{}}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/Q-tqPMlv5h\">playground example</a></p>\n"}], "owner": {"reputation": 4943, "user_id": 801337, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed7f3395127c7b16f7e9cca76ecd9cb0?s=128&d=identicon&r=PG", "display_name": "Poyan", "link": "https://stackoverflow.com/users/801337/poyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 28707339, "answer_count": 1, "score": 0, "last_activity_date": 1424815813, "creation_date": 1424808752, "last_edit_date": 1424813572, "question_id": 28705375, "link": "https://stackoverflow.com/questions/28705375/go-reflect-method-call-invalid-memory-address-or-nil-pointer-dereference", "title": "Go Reflect Method Call invalid memory address or nil pointer dereference", "body": "<p>I'm trying to use reflect to call a method on a struct. However, I'm getting a <code>panic: runtime error: invalid memory address or nil pointer dereference</code> even though both the <code>attachMethodValue</code> and the <code>args</code> are non-nil. Any ideas on what it could be? </p>\n\n<p>Go Playground: <a href=\"http://play.golang.org/p/QSVTSkNKam\" rel=\"nofollow\">http://play.golang.org/p/QSVTSkNKam</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\ntype UserController struct {\n    UserModel *UserModel\n}\n\ntype UserModel struct {\n    Model\n}\n\ntype Model struct {\n    transactionService *TransactionService\n}\n\nfunc (m *Model) Attach(transactionService *TransactionService) {\n    m.transactionService = transactionService\n}\n\ntype Transactioner interface {\n    Attach(transactionService *TransactionService)\n}\n\ntype TransactionService struct {\n}\n\nfunc main() {\n    c := &amp;UserController{}\n    transactionService := &amp;TransactionService{}\n    valueField := reflect.ValueOf(c).Elem().Field(0) // Should be UserController.UserModel\n\n    // Trying to call this\n    attachMethodValue := valueField.MethodByName(\"Attach\")\n\n    // Argument\n    args := []reflect.Value{reflect.ValueOf(transactionService)}\n\n    // They're both non-nil\n    fmt.Printf(\"%+v\\n\", attachMethodValue)\n    fmt.Println(args)\n\n    // PANIC!\n    attachMethodValue.Call(args)\n\n    fmt.Println(\"The end.\")\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 4055540, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-U-xpguGAMhI/AAAAAAAAAAI/AAAAAAAAANc/ZXXSkHyEMbA/photo.jpg?sz=128", "display_name": "Wilson Wang", "link": "https://stackoverflow.com/users/4055540/wilson-wang"}, "edited": false, "score": 0, "creation_date": 1424815996, "post_id": 28707258, "comment_id": 45704104, "body": "Just checked the data in the database. It is the float indeed. So, it&#39;s the issue on the data input. It is resolved by using the decode with UseNumber() instead of straight Unmarshal. Thanks!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1424815876, "last_edit_date": 1424815876, "creation_date": 1424815487, "answer_id": 28707258, "question_id": 28704236, "link": "https://stackoverflow.com/questions/28704236/how-to-prevent-mgo-to-unmarshal-int-to-float64/28707258#28707258", "title": "How to prevent mgo to unmarshal int to float64", "body": "<p>Mgo does not unmarshal an integer to a float unless destination value is explicitly typed as a float by the application. Mgo is returning a float value here because the value stored in the database is a float. </p>\n\n<p>You can unmarshal the float value to an integer by specifying the type using a struct:</p>\n\n<pre><code>var result struct {\n  Date int64 `bson:\"date\"`\n}\nfor iter.Next(&amp;result) {\n  ...\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 4055540, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-U-xpguGAMhI/AAAAAAAAAAI/AAAAAAAAANc/ZXXSkHyEMbA/photo.jpg?sz=128", "display_name": "Wilson Wang", "link": "https://stackoverflow.com/users/4055540/wilson-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 1, "accepted_answer_id": 28707258, "answer_count": 1, "score": 2, "last_activity_date": 1424815876, "creation_date": 1424805173, "question_id": 28704236, "link": "https://stackoverflow.com/questions/28704236/how-to-prevent-mgo-to-unmarshal-int-to-float64", "title": "How to prevent mgo to unmarshal int to float64", "body": "<p>I have unknown json structure data stored in mongodb. They have the fields to present the unix time like this:</p>\n\n<pre><code>\"date\": 1424803567,\n</code></pre>\n\n<p>I am using mgo to load them to the bson.M. </p>\n\n<pre><code>var result bson.M\niter := c.Find(q).Iter()\nfor iter.Next(&amp;result) {\n</code></pre>\n\n<p>Those unix time fields have turned to the fload64 instead of the int.</p>\n\n<pre><code> \"date\": 1.424728798e+09,\n</code></pre>\n\n<p>So, how to prevent that happens in the case above? thanks!</p>\n"}, {"tags": ["go", "dependency-management"], "answers": [{"tags": [], "owner": {"reputation": 570, "user_id": 1093299, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cc1e335ed1e6094cb45f745d978cfb91?s=128&d=identicon&r=PG", "display_name": "Haibin Liu", "link": "https://stackoverflow.com/users/1093299/haibin-liu"}, "is_accepted": true, "score": 2, "last_activity_date": 1426236261, "creation_date": 1426236261, "answer_id": 29028013, "question_id": 28703391, "link": "https://stackoverflow.com/questions/28703391/godep-restore-doesnt-use-the-code-saved-in-workspace/29028013#29028013", "title": "Godep restore doesn&#39;t use the code saved in _workspace", "body": "<p>\"godep restore\" does not use _workspace. It reads Godeps.json and check out your dependencies to GOPATH.</p>\n\n<p>To use _workspace, you run go command prefixed with godep, like \"godep go build\", \"godep go test\".</p>\n"}], "owner": {"reputation": 1037, "user_id": 2730407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ea8cbda44bec55c4db6250eff89bbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Ronna", "link": "https://stackoverflow.com/users/2730407/ronna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1630, "favorite_count": 0, "accepted_answer_id": 29028013, "answer_count": 1, "score": 1, "last_activity_date": 1426236261, "creation_date": 1424802268, "last_edit_date": 1424863341, "question_id": 28703391, "link": "https://stackoverflow.com/questions/28703391/godep-restore-doesnt-use-the-code-saved-in-workspace", "title": "Godep restore doesn&#39;t use the code saved in _workspace", "body": "<p>I started using <code>godep</code> a while ago but I think I'm failing to understand the principal, and I may be using it incorrectly entirely.</p>\n\n<p>I thought <code>godep</code> maintains <code>_workspace</code> in order to have a local copy of the packages in case some revisions/projects are removed or become unavailable. But <code>godep restore</code> doesn't seem to use <code>_workspace</code> at all.</p>\n\n<p>Also, calling <code>godep save</code> for the second time didn't update <code>_workspace</code>, only <code>Godeps.json</code>.</p>\n\n<p>What am I missing?</p>\n\n<hr>\n\n<p>UPDATE:</p>\n\n<p>To explain my question I changed one of the revisions in my Godeps.json to an invalid revision \"1\" and ran <code>godep restore</code>. Here's the error I got:</p>\n\n<pre><code>$GOPATH/bin/godep restore\n# cd /home/iliga/gopath/src/github.com/jinzhu/gorm; git pull --ff-only\nFrom https://github.com/jinzhu/gorm \na97a508..087b708  master     -&gt; origin/master\nYou are not currently on a branch. Please specify which\nbranch you want to merge with. See git-pull(1) for details.\n\ngit pull &lt;remote&gt; &lt;branch&gt;\n\n# cd /home/iliga/gopath/src/github.com/jinzhu/gorm; git checkout 1\nerror: pathspec '1' did not match any file(s) known to git.\ngodep: restore: exit status 1\n</code></pre>\n\n<p>As explained above, I would expect there to be no error and for godep to simply copy the code from _workspace.</p>\n"}, {"tags": ["html", "forms", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1424792212, "post_id": 28699582, "comment_id": 45689882, "body": "The select is missing the closing quote on the name attribute."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1424792849, "post_id": 28699582, "comment_id": 45690403, "body": "Did you call <a href=\"http://golang.org/pkg/net/http/#Request.ParseForm\" rel=\"nofollow noreferrer\"><code>ParseForm</code></a> on your request?"}, {"owner": {"reputation": 1462, "user_id": 2046808, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/uooKU.png?s=128&g=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/2046808/goku"}, "edited": false, "score": 0, "creation_date": 1424793206, "post_id": 28699582, "comment_id": 45690668, "body": "Upss that was the problem, I forgot call r.ParseForm() thanks"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 19, "last_activity_date": 1424793009, "creation_date": 1424793009, "answer_id": 28700234, "question_id": 28699582, "link": "https://stackoverflow.com/questions/28699582/how-get-multiselect-values-from-form-using-golang/28700234#28700234", "title": "How get multiselect values from form using Golang?", "body": "<p>You can't/shouldn't use the <a href=\"http://golang.org/pkg/net/http/#Request.FormValue\"><code>Request.FormValue()</code></a> function because that only returns 1 value. Use <code>Request.Form[\"new_data\"]</code> which is a slice of <code>string</code>s containing all the values.<br>\nBut note that if you don't call <code>r.FormValue()</code>, you have to trigger parsing the form (and populating the <code>Request.Form</code> map) by calling <a href=\"http://golang.org/pkg/net/http/#Request.ParseForm\"><code>Request.ParseForm()</code></a> explicitly.</p>\n\n<p>You also have an HTML syntax error: the value of the <code>name</code> attribute is not closed, change it to:</p>\n\n<pre><code>&lt;select id=\"new_data\" name=\"new_data\" class=\"tag-select chzn-done\"\n    multiple=\"\" style=\"display: none;\"&gt;\n</code></pre>\n\n<p>Here is a complete app to test that it works (error checks ommited!):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc myHandler(w http.ResponseWriter, r *http.Request) {\n    if r.Method == \"POST\" {\n        // Form submitted\n        r.ParseForm() // Required if you don't call r.FormValue()\n        fmt.Println(r.Form[\"new_data\"])\n    }\n    w.Write([]byte(html))\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", myHandler)\n    http.ListenAndServe(\":9090\", nil)\n}\n\nconst html = `\n&lt;html&gt;&lt;body&gt;\n&lt;form action=\"process\" method=\"post\"&gt;\n    &lt;select id=\"new_data\" name=\"new_data\" class=\"tag-select chzn-done\" multiple=\"\" &gt;\n        &lt;option value=\"1\"&gt;111mm1&lt;/option&gt;\n        &lt;option value=\"2\"&gt;222mm2&lt;/option&gt;\n        &lt;option value=\"3\"&gt;012nx1&lt;/option&gt;\n    &lt;/select&gt;\n    &lt;input type=\"Submit\" value=\"Send\" /&gt;\n&lt;/form&gt;\n&lt;/body&gt;&lt;/html&gt;\n`\n</code></pre>\n"}], "owner": {"reputation": 1462, "user_id": 2046808, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/uooKU.png?s=128&g=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/2046808/goku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6496, "favorite_count": 3, "accepted_answer_id": 28700234, "answer_count": 1, "score": 9, "last_activity_date": 1478369920, "creation_date": 1424791263, "last_edit_date": 1478369920, "question_id": 28699582, "link": "https://stackoverflow.com/questions/28699582/how-get-multiselect-values-from-form-using-golang", "title": "How get multiselect values from form using Golang?", "body": "<p>I have a multiple select input in my form and I'm trying to get the selected values in my handler, but I can't, how can I get those values?</p>\n\n<pre><code>&lt;form action=\"process\" method=\"post\"&gt;\n    &lt;select id=\"new_data\" name=\"new_data class=\"tag-select chzn-done\" multiple=\"\" style=\"display: none;\"&gt;\n    &lt;option value=\"1\"&gt;111mm1&lt;/option&gt;\n    &lt;option value=\"2\"&gt;222mm2&lt;/option&gt;\n    &lt;option value=\"3\"&gt;012nx1&lt;/option&gt;\n    &lt;/select&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>My Handler:</p>\n\n<pre><code>func myHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(r.FormValue(\"new_data\")) // result-&gt; []\n    fmt.Println(r.Form(\"new_data\")) // result-&gt; []\n}\n</code></pre>\n\n<p>The form serialized data with option 1 and 2 selected from JS console:</p>\n\n<pre><code>   &gt;$('#myform').serialize() \n   &gt;\"new_data=1&amp;new_data=2\"\n</code></pre>\n"}, {"tags": ["go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 192, "user_id": 1083135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/650f7ee67c04d81685d76db49b385850?s=128&d=identicon&r=PG&f=1", "display_name": "VimleshS", "link": "https://stackoverflow.com/users/1083135/vimleshs"}, "edited": false, "score": 2, "creation_date": 1424847340, "post_id": 28699587, "comment_id": 45713799, "body": "downward loop is more efficient"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 192, "user_id": 1083135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/650f7ee67c04d81685d76db49b385850?s=128&d=identicon&r=PG&f=1", "display_name": "VimleshS", "link": "https://stackoverflow.com/users/1083135/vimleshs"}, "edited": false, "score": 0, "creation_date": 1424848024, "post_id": 28699587, "comment_id": 45714120, "body": "@VKS Yes. And it is mentioned at the end of the answer."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1446578958, "post_id": 28699587, "comment_id": 54798381, "body": "If only go had a keyword corresponding to Perl&#39;s <code>redo</code> (like <code>continue</code> except it doesn&#39;t re-execute the loop test or increment) then the code would be correct after replacing <code>continue</code> with <code>redo</code>. As it is... well, there&#39;s always <code>goto</code> :)"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1458424221, "post_id": 28699587, "comment_id": 59857000, "body": "You should probably nil the element before deleting it. Otherwise there could be a memory leak <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/SliceTricks</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1424810760, "last_edit_date": 1424810760, "creation_date": 1424791275, "answer_id": 28699587, "question_id": 28699485, "link": "https://stackoverflow.com/questions/28699485/remove-elements-in-slice/28699587#28699587", "title": "Remove elements in slice", "body": "<p>The problem is that when you remove an element from the original list, all subsequent elements are <em>shifted</em>. But the <code>range</code> loop doesn't know that you changed the underlying slice and will increment the index as usual, even though in this case it shouldn't because then you <strong>skip</strong> an element.</p>\n\n<p>And since the <code>remove</code> list contains 2 elements which are <strong>right next to each other</strong> in the original list, the second one (<code>\"abc\"</code> in this case) will not be checked and will not be removed.</p>\n\n<p>One possible solution is not to use <code>range</code> in the outer loop, and when you remove an element, you manually decrease the index <strong><code>i--</code></strong> because continuing with the next iteration it will get auto-incremented:</p>\n\n<pre><code>urlList := []string{\"test\", \"abc\", \"def\", \"ghi\"}\nremove := []string{\"abc\", \"test\"}\n\nloop:\nfor i := 0; i &lt; len(urlList); i++ {\n    url := urlList[i]\n    for _, rem := range remove {\n        if url == rem {\n            urlList = append(urlList[:i], urlList[i+1:]...)\n            i-- // Important: decrease index\n            continue loop\n        }\n    }\n}\n\nfmt.Println(urlList)\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>[def ghi]\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Since the outer loop contains nothing after the inner loop, you can replace the label+continue with a simple <code>break</code>:</p>\n\n<pre><code>urlList := []string{\"test\", \"abc\", \"def\", \"ghi\"}\nremove := []string{\"abc\", \"test\"}\n\nfor i := 0; i &lt; len(urlList); i++ {\n    url := urlList[i]\n    for _, rem := range remove {\n        if url == rem {\n            urlList = append(urlList[:i], urlList[i+1:]...)\n            i-- // Important: decrease index\n            break\n        }\n    }\n}\n\nfmt.Println(urlList)\n</code></pre>\n\n<p>Try it on <a href=\"http://play.golang.org/p/aP7wta6wfx\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p><strong>Alternative</strong></p>\n\n<p>An alternative to this would be for the outer loop to go downward, so no need to manually decrease (or increase) the index variable because the shifted elements are not affected (already processed due to the downward direction).</p>\n"}, {"tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 2, "last_activity_date": 1424795174, "creation_date": 1424795174, "answer_id": 28701031, "question_id": 28699485, "link": "https://stackoverflow.com/questions/28699485/remove-elements-in-slice/28701031#28701031", "title": "Remove elements in slice", "body": "<p>Maybe it is simpler to create a new slice, that only contains your desired elements, for example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    urlList := []string{\"test\", \"abc\", \"def\", \"ghi\"}\n    remove := []string{\"abc\", \"test\"}\n\n    new_list := make([]string, 0)\n\n    my_map := make(map[string]bool, 0)\n    for _, ele := range remove {\n        my_map[ele] = true\n    }\n\n    for _, ele := range urlList {\n        _, is_in_map := my_map[ele]\n        if is_in_map {\n            fmt.Printf(\"Have to ignore : %s\\n\", ele)\n        } else {\n            new_list = append(new_list, ele)    \n        }\n    }\n\n    fmt.Println(new_list)\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/aYATElNwSP\" rel=\"nofollow\">playground</a></p>\n\n<p>Result:</p>\n\n<pre><code>Have to ignore : test\nHave to ignore : abc\n[def ghi]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1424851890, "creation_date": 1424851890, "answer_id": 28714120, "question_id": 28699485, "link": "https://stackoverflow.com/questions/28699485/remove-elements-in-slice/28714120#28714120", "title": "Remove elements in slice", "body": "<p>You have to be careful when modifying a slice while iterating over it.</p>\n\n<p>Here's a common way to remove elements from a slice by compacting the data at the same time as iterating over it.</p>\n\n<p>It also uses a map rather than a slice for excluded elements, which gives efficiency when the number of excluded items is large.</p>\n\n<p><code>Exclude</code> updates <code>xs</code> in place, which is why a pointer argument is used. An alternative would be to update the backing array of <code>xs</code>, but to return the slice from the function in the same way that the built-in <code>append</code> works.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc Exclude(xs *[]string, excluded map[string]bool) {\n    w := 0\n    for _, x := range *xs {\n        if !excluded[x] {\n            (*xs)[w] = x\n            w++\n        }\n    }\n    *xs = (*xs)[:w]\n}\n\nfunc mapFromSlice(ex []string) map[string]bool {\n    r := map[string]bool{}\n    for _, e := range ex {\n        r[e] = true\n    }\n    return r\n}\n\nfunc main() {\n    urls := []string{\"test\", \"abc\", \"def\", \"ghi\"}\n    remove := mapFromSlice([]string{\"abc\", \"test\"})\n    Exclude(&amp;urls, remove)\n    fmt.Println(urls)\n}\n</code></pre>\n\n<p>This code is O(N+M) in run-time where N is the length of <code>urls</code> and M is the length of <code>remove</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 6546, "user_id": 1347816, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/k5aTp.jpg?s=128&g=1", "display_name": "LEMUEL  ADANE", "link": "https://stackoverflow.com/users/1347816/lemuel-adane"}, "is_accepted": false, "score": 0, "last_activity_date": 1540709213, "last_edit_date": 1540709213, "creation_date": 1540617543, "answer_id": 53018944, "question_id": 28699485, "link": "https://stackoverflow.com/questions/28699485/remove-elements-in-slice/53018944#53018944", "title": "Remove elements in slice", "body": "<p>You can use these functions:</p>\n\n<pre><code>func main() {\n  array := []string{\"A\", \"B\", \"C\", \"D\", \"E\"}\n  a = StringSliceDelete(a, 2) // delete \"C\"\n  fmt.Println(a) // print: [A, B, D E]\n}\n\n//IntSliceDelete function\nfunc IntSliceDelete(slice []int, index int) []int {\n   copy(slice[index:], slice[index+1:])\n   new := slice[:len(slice)-1]\n   return new\n}\n\n//StringSliceDelete function\nfunc StringSliceDelete(slice []string, index int) []string {\n    copy(slice[index:], slice[index+1:])\n    new := slice[:len(slice)-1]\n    return new\n}\n\n// ObjectSliceDelete function\nfunc ObjectSliceDelete(slice []interface{}, index int) []interface{} {\n    copy(slice[index:], slice[index+1:])\n    new := slice[:len(slice)-1]\n    return new\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "is_accepted": false, "score": 0, "last_activity_date": 1572791352, "creation_date": 1572791352, "answer_id": 58681121, "question_id": 28699485, "link": "https://stackoverflow.com/questions/28699485/remove-elements-in-slice/58681121#58681121", "title": "Remove elements in slice", "body": "<p>In case of index:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>//RemoveElements delete the element of the indexes contained in j of the data in input\nfunc RemoveElements(data []string, j []int) []string {\n    var newArray []string\n    var toAdd bool = true\n    var removed int = 0\n    //sort.Ints(j)\n    for i := 0; i &lt; len(data); i++ {\n        for _, k := range j {\n            // if k &lt; i || k &gt; i {\n            //  break\n            // } else\n            if i == k {\n                toAdd = false\n                break\n            }\n        }\n        if toAdd {\n            newArray = append(newArray, data[i])\n            removed++\n        }\n        toAdd = true\n    }\n    return newArray\n}\n</code></pre>\n\n<p>Comment can be removed for increase performance when the slice is not so big (sort time)</p>\n"}], "owner": {"reputation": 10501, "user_id": 1180968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tsPVx.png?s=128&g=1", "display_name": "Sajan Chandran", "link": "https://stackoverflow.com/users/1180968/sajan-chandran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12221, "favorite_count": 1, "accepted_answer_id": 28699587, "answer_count": 5, "score": 4, "last_activity_date": 1572791352, "creation_date": 1424791044, "last_edit_date": 1470160518, "question_id": 28699485, "link": "https://stackoverflow.com/questions/28699485/remove-elements-in-slice", "title": "Remove elements in slice", "body": "<p>I am complete newbie in Golang, I am trying to remove elements in one slice based on the elements in another slice.\ne.g. </p>\n\n<p>input slice : <code>urlList := []string{\"test\", \"abc\", \"def\", \"ghi\"}</code></p>\n\n<p>elements to remove slice : <code>remove := []string{\"abc\", \"test\"}</code></p>\n\n<p>expected output slice : <code>urlList := []string{\"def\", \"ghi\"}</code></p>\n\n<p>This is what I tried.</p>\n\n<pre><code>func main() {\n\n    urlList := []string{\"test\", \"abc\", \"def\", \"ghi\"}\n    remove := []string{\"abc\", \"test\"}\nloop:\n    for i, url := range urlList {\n        for _, rem := range remove {\n            if url == rem {\n                urlList = append(urlList[:i], urlList[i+1:]...)\n                continue loop\n            }\n        }\n    }\n    for _, v := range urlList {\n        fmt.Println(v)\n    }\n}\n</code></pre>\n\n<p>But it's not working as I expected. I don't know what I am missing.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1424790890, "post_id": 28699283, "comment_id": 45688847, "body": "Have you looked at the data in <code>sites</code>? Do they contain different values?"}, {"owner": {"reputation": 684, "user_id": 112859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7472bc7aa45c70641c299e9408b78ab?s=128&d=identicon&r=PG", "display_name": "Brian Rosner", "link": "https://stackoverflow.com/users/112859/brian-rosner"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1424790929, "post_id": 28699283, "comment_id": 45688882, "body": "Yes, I have confirmed the data in <code>sites</code> is correct."}, {"owner": {"reputation": 684, "user_id": 112859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7472bc7aa45c70641c299e9408b78ab?s=128&d=identicon&r=PG", "display_name": "Brian Rosner", "link": "https://stackoverflow.com/users/112859/brian-rosner"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1424791150, "post_id": 28699283, "comment_id": 45689086, "body": "I worked up an example, but it does work. Now I am going crazy understanding what&#39;s wrong with my code. <a href=\"https://play.golang.org/p/gb_FBAz7pS\" rel=\"nofollow noreferrer\">play.golang.org/p/gb_FBAz7pS</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 5, "last_activity_date": 1424849900, "last_edit_date": 1424849900, "creation_date": 1424792133, "answer_id": 28699897, "question_id": 28699283, "link": "https://stackoverflow.com/questions/28699283/using-function-to-satisfy-interface-via-method/28699897#28699897", "title": "Using function to satisfy interface via method", "body": "<p>This seems like a classic closure gotcha. There is a related  <a href=\"http://golang.org/doc/faq#closures_and_goroutines\" rel=\"nofollow\">FAQ</a> section.</p>\n\n<p>Basically, <code>site</code> in your for-loop has the same address every time. All your functions are closed over this address. So when you evaluate it after the for-loop, it will repeatedly call <code>MarshalJSON</code> on the value on the same (last) address. You can correct that by creating a new value on every iteration:</p>\n\n<pre><code>for _, site := range sites {\n    site := site // Perfectly legal and idiomatic.\n    payload = append(payload, site.ToApi())\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/eFujC1hEyD\" rel=\"nofollow\">https://play.golang.org/p/eFujC1hEyD</a></p>\n\n<p>Another related piece of documentation from <a href=\"http://golang.org/doc/effective_go.html#channels\" rel=\"nofollow\">Effective Go</a>:</p>\n\n<blockquote>\n  <p>The bug is that in a Go for loop, the loop variable is reused for each iteration, so the req variable is shared across all goroutines. That's not what we want. (...) Another solution is just to create a new variable with the same name, as in this example: </p>\n\n<pre><code>for req := range queue {\n    req := req // Create new instance of req for the goroutine.\n    sem &lt;- 1\n    go func() {\n        process(req)\n        &lt;-sem\n    }()\n}\n</code></pre>\n</blockquote>\n\n<p>This section is about goroutines, but apparently this also applies to all closures.</p>\n"}], "owner": {"reputation": 684, "user_id": 112859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7472bc7aa45c70641c299e9408b78ab?s=128&d=identicon&r=PG", "display_name": "Brian Rosner", "link": "https://stackoverflow.com/users/112859/brian-rosner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 28699897, "answer_count": 1, "score": 3, "last_activity_date": 1424849900, "creation_date": 1424790491, "question_id": 28699283, "link": "https://stackoverflow.com/questions/28699283/using-function-to-satisfy-interface-via-method", "title": "Using function to satisfy interface via method", "body": "<p>I am trying to write a method that will return a function that can satisfy the <code>json.Marshaler</code> interface. My reasoning is to provide different representations of the struct. Perhaps I am approaching this completely wrong.</p>\n\n<pre><code>func (api *Api) SiteList(c *gin.Context) {\n    var sites []db.Site\n    if err := api.db.Find(&amp;sites).Error; err != nil {\n    }\n    var payload []json.Marshaler\n    for _, site := range sites {\n        payload = append(payload, site.ToApi())\n    }\n    c.JSON(http.StatusOK, payload)\n}\n</code></pre>\n\n<p>The result I get from this function is the correct number of items in the list, but the same value for each:</p>\n\n<pre><code>[\n    {\n        \"key\": \"NZ7LCA9HQN3\", \n        \"name\": \"autumn-waterfall-1573\"\n    }, \n    {\n        \"key\": \"NZ7LCA9HQN3\", \n        \"name\": \"autumn-waterfall-1573\"\n    }, \n    {\n        \"key\": \"NZ7LCA9HQN3\", \n        \"name\": \"autumn-waterfall-1573\"\n    }, \n    {\n        \"key\": \"NZ7LCA9HQN3\", \n        \"name\": \"autumn-waterfall-1573\"\n    }, \n    {\n        \"key\": \"NZ7LCA9HQN3\", \n        \"name\": \"autumn-waterfall-1573\"\n    }\n]\n</code></pre>\n\n<p>Finally, here is the <code>ToApi</code> implementation:</p>\n\n<pre><code>type EncoderFunc func() ([]byte, error)\n\nfunc (fn EncoderFunc) MarshalJSON() ([]byte, error) {\n    return fn()\n}\n\nfunc (site *Site) ToApi() json.Marshaler {\n    return EncoderFunc(func() ([]byte, error) {\n        var payload public.Site\n        payload.Name = site.Name\n        payload.Key = site.Key\n        data, err := json.Marshal(payload)\n        if err != nil {\n            return nil, err\n        }\n        return data, nil\n    })\n}\n</code></pre>\n"}, {"tags": ["go", "package", "version"], "answers": [{"comments": [{"owner": {"reputation": 7026, "user_id": 1819790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347c3c5ef51a2d03a87e9fbb099e9d6c?s=128&d=identicon&r=PG&f=1", "display_name": "pswaminathan", "link": "https://stackoverflow.com/users/1819790/pswaminathan"}, "edited": false, "score": 0, "creation_date": 1424842826, "post_id": 28699020, "comment_id": 45712081, "body": "+1 for including good links. I like using gopkg.in (mentioned in your last link), as it seems to be a sane way to declare &quot;what version do I want?&quot;, as &quot;what commit hash do I want?&quot; is somewhat cryptic to new developers using something you&#39;ve written."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1538056680, "post_id": 28699020, "comment_id": 92016922, "body": "A nitpick: the recent communications debacle happened when &quot;go modules&quot; were officially announced, revealed that the Go core team never really intended to merge <code>go dep</code> and considered it as a communitiy-driven experiment to explore what will work and what won&#39;t. The sad news is that Sam Boyer, who is the main person behind <code>godep</code> and Russ Cox of the core team failed to make this idea be understood the same way on both ends of the conversation. TL;DR, <code>godep</code> was a &quot;blessed experiment&quot; but not more than that."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1538058558, "post_id": 28699020, "comment_id": 92018234, "body": "@kostix Yes: If you want more details, I found that thread interesting: <a href=\"https://twitter.com/sdboyer/status/1034893100450291713\" rel=\"nofollow noreferrer\">twitter.com/sdboyer/status/1034893100450291713</a> (also in <a href=\"https://threadreaderapp.com/thread/1034893100450291713.html\" rel=\"nofollow noreferrer\">threadreaderapp.com/thread/1034893100450291713.html</a>). Plus the screencast <a href=\"https://twitter.com/sdboyer/status/1034893103080071169\" rel=\"nofollow noreferrer\">twitter.com/sdboyer/status/1034893103080071169</a>."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1538061523, "post_id": 28699020, "comment_id": 92020272, "body": "Please note that that&#39;s just one side of the story\u2014and, sadly, a highly biased one, for the supposedly obvious reasons,\u2014and the other one may be studied, say, <a href=\"https://www.reddit.com/r/golang/comments/9274zi/huge_twitter_thread_from_russ_cox_about_the/\" rel=\"nofollow noreferrer\">here</a>\u2014in the twitter thread linked from there."}, {"owner": {"reputation": 47877, "user_id": 414062, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xc7mu.jpg?s=128&g=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/414062/dominic"}, "edited": false, "score": 0, "creation_date": 1559585150, "post_id": 28699020, "comment_id": 99459412, "body": "Thanks, but how can we version our own packages?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 47877, "user_id": 414062, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xc7mu.jpg?s=128&g=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/414062/dominic"}, "edited": false, "score": 1, "creation_date": 1559587455, "post_id": 28699020, "comment_id": 99460270, "body": "@Dominic Simply by tagging your source with labels following the semver convention (<a href=\"https://semver.org/\" rel=\"nofollow noreferrer\">semver.org</a>) and pushing them back (<a href=\"https://github.com/golang/go/wiki/Modules#what-happens-if-i-create-a-gomod-but-do-not-apply-semver-tags-to-my-repository\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/&hellip;</a>) See <a href=\"https://github.com/golang/go/wiki/Modules#publishing-a-release\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/Modules#publishing-a-release</a>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 24, "last_activity_date": 1538046097, "last_edit_date": 1538046097, "creation_date": 1424789793, "answer_id": 28699020, "question_id": 28698814, "link": "https://stackoverflow.com/questions/28698814/how-to-version-packages-in-golang/28699020#28699020", "title": "how to version packages in golang?", "body": "<p>The official version, from the <a href=\"http://golang.org/doc/faq#get_version\" rel=\"noreferrer\">GO FAQ</a>:</p>\n\n<blockquote>\n  <p>If you're using an externally supplied package and worry that it might change in unexpected ways, the simplest solution is to copy it to your local repository. (This is the approach Google takes internally.) Store the copy under a new import path that identifies it as a local copy.</p>\n</blockquote>\n\n<p>There are many alternative to that approach, mainly based on <em>declaring</em> the exact version of those projects you are using.</p>\n\n<p>See for instance \"<a href=\"https://medium.com/@forEmil/dead-simple-dependencies-in-go-3b2cb856d200\" rel=\"noreferrer\">Dead Simple Dependencies in Go -- Keep it simple and keep your sanity.</a>\" (based on <a href=\"https://github.com/emil2k/vend\" rel=\"noreferrer\"><code>emil2k/vend</code></a>)</p>\n\n<p>The main different options for Go Dependency Management are listed at:</p>\n\n<p>\"<strong><a href=\"http://nathany.com/go-packages/?2.0\" rel=\"noreferrer\">Go Package Management -- A summary of dependency management in Go</a></strong>\"<br>\n(And its associate <a href=\"https://groups.google.com/forum/#!forum/go-package-management\" rel=\"noreferrer\">GOPM mailing list</a>)</p>\n\n<p>Update July 2015:</p>\n\n<ul>\n<li>the official vendoring approach from Go team is <a href=\"https://groups.google.com/d/msg/golang-dev/nMWoEAG55v8/iJGgur7W_SEJ\" rel=\"noreferrer\">discussed here</a>.</li>\n<li>an alternative go build tool called \"<strong>gb</strong>\" is proposed at <a href=\"http://getgb.io/\" rel=\"noreferrer\"><strong>getgb.io</strong></a> by <a href=\"http://dave.cheney.net/about\" rel=\"noreferrer\">Dave Cheney</a>.</li>\n</ul>\n\n<p>Update Q4 2017: as mentioned <a href=\"https://stackoverflow.com/a/47321580/6309\">below</a>, <a href=\"https://github.com/golang/dep\" rel=\"noreferrer\"><strong><code>go dep</code></strong></a> is the official tool for pinning version of dependencies (even though that pinning approach is not without criticism: see \"<a href=\"http://akkartik.name/post/versioning\" rel=\"noreferrer\">The cargo cult of versioning</a>\").<br>\nIt should be merged into the toolchain when Go 1.10 development begins, <a href=\"https://github.com/golang/dep/wiki/Roadmap\" rel=\"noreferrer\">according to its roadmap</a>.</p>\n\n<p>Update Q2 2018: <code>go dep</code> has been replaced by <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"noreferrer\"><strong><code>go mod</code> (modules)</strong> in <strong>Go 1.11</strong></a>, <a href=\"https://stackoverflow.com/a/48914523/6309\">following works on <code>vgo</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1308, "user_id": 7598188, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/WmIXg.jpg?s=128&g=1", "display_name": "Manish Bansal", "link": "https://stackoverflow.com/users/7598188/manish-bansal"}, "edited": false, "score": 0, "creation_date": 1549539309, "post_id": 47321580, "comment_id": 95942509, "body": "Please correct. Go dep requires 1.9 or above. Refer readMe here. <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">github.com/golang/dep</a>"}], "tags": [], "owner": {"reputation": 1204, "user_id": 1370029, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xksqs.jpg?s=128&g=1", "display_name": "Aliaksei Maniuk", "link": "https://stackoverflow.com/users/1370029/aliaksei-maniuk"}, "is_accepted": false, "score": 2, "last_activity_date": 1549551371, "last_edit_date": 1592644375, "creation_date": 1510806240, "answer_id": 47321580, "question_id": 28698814, "link": "https://stackoverflow.com/questions/28698814/how-to-version-packages-in-golang/47321580#47321580", "title": "how to version packages in golang?", "body": "<p>I use <code>dep</code> as a dependency management tool for <code>golang</code> project. Please use the following link <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">dep tool</a> for more info.</p>\n<blockquote>\n<p><code>dep</code> is a dependency management tool for Go. It requires Go 1.9 or newer to compile.</p>\n<p><code>dep</code> was the &quot;official experiment.&quot; The Go toolchain, as of 1.11, has (experimentally) adopted an approach that sharply diverges from dep. As a result, we are continuing development of dep, but gearing work primarily towards the development of an alternative prototype for versioning behavior in the toolchain.</p>\n</blockquote>\n<p><strong>Current status:</strong> January 2019</p>\n<blockquote>\n<p><code>dep</code> is safe for production use.</p>\n</blockquote>\n"}], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13783, "favorite_count": 7, "accepted_answer_id": 28699020, "answer_count": 2, "score": 19, "last_activity_date": 1549551371, "creation_date": 1424789245, "question_id": 28698814, "link": "https://stackoverflow.com/questions/28698814/how-to-version-packages-in-golang", "title": "how to version packages in golang?", "body": "<p>I've read a whole bunch of articles and SO questions on importing 3rd party go packages which all seems straight forward, but what I don't understand is that none that I have read make any references to versioning. In Dartlang there's the pubspec file that defines your package including its version and its dependencies including their required versions. What if I do a <code>go get github.com/gorilla/sessions</code> and write my app then 6 months later I have to clear my directories and re get everything again, in which time that package has been update and broken backwards compatibility with my code that was using the older version?</p>\n"}, {"tags": ["regex", "go"], "answers": [{"comments": [{"owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "edited": false, "score": 0, "creation_date": 1424796530, "post_id": 28698219, "comment_id": 45693048, "body": "Hey, thanks it worked. Just one question. I used <code>r.ReplaceAll(b, []byte(&quot;&lt;hr&gt;&quot;))</code> instead but even the <code>* * *</code> was replaced. Does this have to do with the <code>[1]</code> part in your code? If so, how to update my code so that <code>* * *</code> is not replaced?"}], "tags": [], "owner": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "is_accepted": true, "score": 1, "last_activity_date": 1424827763, "last_edit_date": 1424827763, "creation_date": 1424787662, "answer_id": 28698219, "question_id": 28697533, "link": "https://stackoverflow.com/questions/28697533/go-regexp-finding-next-item-after-an-occurence/28698219#28698219", "title": "Go regexp: finding next item after an occurence", "body": "<p>You would need to use a capturing group to grap the contents of that sentence:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"regexp\"\n\nfunc main() {\n\n    str := `\n* * *\n\nMatch this line\n`   \n    r, _ := regexp.Compile(`\\* \\* \\*\\n.*\\n(.*)`)\n\n    fmt.Println(r.FindStringSubmatch(str)[1])\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Match this line\n</code></pre>\n\n<p><strong>Explanation:</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\\* \\* \\*    Matches the first line containing the asterisks.\n\\n          A newline.\n.*          Second line. Can be anything (Likely the line is simply empty)\n\\n          A newline\n(           Start of capturing group\n.*          The content of interest\n)           End of capturing group\n</code></pre>\n\n<hr>\n\n<p>In comments you asked how to replace the third line by <code>&lt;hr/&gt;</code>. In this case I would use two capturing groups - one for the part before the line of interest and one for the line itself. In the replacement pattern you can then use <code>$1</code> to use the value of the first capturing group in the result.</p>\n\n<p>Example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"regexp\"\n\nfunc main() {\n\n    str := `\n* * * \n\nMatch this line\n`   \n    r, _ := regexp.Compile(`(\\* \\* \\*\\n.*\\n)(.*)`)\n\n    str = string(r.ReplaceAll([]byte(str), []byte(\"$1&lt;hr/&gt;\")))\n\n    fmt.Println(str)\n}\n</code></pre>\n"}], "owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 28698219, "answer_count": 1, "score": 1, "last_activity_date": 1424827763, "creation_date": 1424785776, "question_id": 28697533, "link": "https://stackoverflow.com/questions/28697533/go-regexp-finding-next-item-after-an-occurence", "title": "Go regexp: finding next item after an occurence", "body": "<p>I'm a Go beginner and I've been playing with regexes. Example:</p>\n\n<pre><code>r, _ := regexp.Compile(`\\* \\* \\*`)\nr2 := r.ReplaceAll(b, []byte(\"&lt;hr&gt;\"))\n</code></pre>\n\n<p>(Replace all <code>* * *</code>s for <code>&lt;hr&gt;</code>s)</p>\n\n<p>One thing that I have no idea how to do is to find the <code>next</code> item after an occurence. In JavaScript/jQuery I used to do this:</p>\n\n<pre><code>$(\"#input-content p:has(br)\").next('p').doStuff()\n</code></pre>\n\n<p>(Find the next <code>p</code> <code>tag</code> after a <code>p</code> tag that has a <code>br</code> tag inside).</p>\n\n<p>What's the simplest way to accomplish the same in Go? Say, finding the next line after <code>* * *</code> ?</p>\n\n<blockquote>\n<pre><code>* * *\n\nMatch this line\n</code></pre>\n</blockquote>\n"}, {"tags": ["arrays", "go", "operators", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1424777447, "post_id": 28692410, "comment_id": 45680010, "body": "You might want to work your way through tour.golang.org ."}], "answers": [{"comments": [{"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 1, "creation_date": 1424772183, "post_id": 28692564, "comment_id": 45676686, "body": "I have a doubt. First one creates an array [0, 1, 2] and the second one creates a slice(lenght = capacity = 3) refering the array [0, 1, 2]. What is the difference of having these two"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1424772485, "post_id": 28692564, "comment_id": 45676861, "body": "The slice is a kind of dynamic array, while the size of the array is fixed."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 1, "creation_date": 1424772506, "post_id": 28692564, "comment_id": 45676876, "body": "@Spartan Well, for a start, they are 2 different types. If you&#39;re asking about the usefulness/usage of arrays and slices, read the Effective Go: <a href=\"http://golang.org/doc/effective_go.html#arrays\" rel=\"nofollow noreferrer\">Arrays</a>, <a href=\"http://golang.org/doc/effective_go.html#slices\" rel=\"nofollow noreferrer\">Slices</a>, or the Blog articles <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a> and <a href=\"http://blog.golang.org/slices\" rel=\"nofollow noreferrer\">Arrays, Slices (and strings): The mechanics of &#39;append&#39;</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 2, "creation_date": 1424772775, "post_id": 28692564, "comment_id": 45677027, "body": "@Spartan To supplement on differences: arrays are <i>values</i>, slices are <i>references</i>. You are encouraged to pass slices (because they are just references) and they refer to the same underlying array. Arrays should be passed as values with care because that passes a copy of the array. Arrays are useful to when planning the detailed layout of memory and sometimes can help avoid allocation, but primarily they are a building block for slices."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 12, "last_activity_date": 1424780594, "last_edit_date": 1424780594, "creation_date": 1424771394, "answer_id": 28692564, "question_id": 28692410, "link": "https://stackoverflow.com/questions/28692410/confusion-with-operator-in-golang/28692564#28692564", "title": "Confusion with &quot;...&quot; operator in golang", "body": "<p>The first line creates an <a href=\"http://golang.org/ref/spec#Array_types\" rel=\"noreferrer\"><strong>array</strong></a> using an <em>array literal</em>, its length computed automatically by the compiler. It is detailed in the <a href=\"http://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">Composite literals</a> section of the Language Specification.</p>\n\n<blockquote>\n  <p>The notation ... specifies an array length equal to the maximum element index plus one.</p>\n</blockquote>\n\n<p><sup>Note: this is not to be confused with the <code>...</code> used to specify <em>variadic</em> parameters or to pass slices as their values. It is detailed in the <a href=\"http://golang.org/ref/spec#Function_types\" rel=\"noreferrer\">Function types</a> section of the spec.</sup></p>\n\n<p>The second line uses a <em>slice literal</em> and will result in a <a href=\"http://golang.org/ref/spec#Slice_types\" rel=\"noreferrer\"><strong>slice</strong></a>. Note that under the hood an array will also be created, but that is opaque.</p>\n"}], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1584, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1424780594, "creation_date": 1424770966, "last_edit_date": 1424773971, "question_id": 28692410, "link": "https://stackoverflow.com/questions/28692410/confusion-with-operator-in-golang", "title": "Confusion with &quot;...&quot; operator in golang", "body": "<p>What is the difference between the following two syntaxes in go?</p>\n\n<pre><code>x := [...]int{ 1:1, 2:2 }\nx := []int{ 1:1, 2:2 }\n</code></pre>\n\n<p>Go's document says \"The notation ... specifies an array length equal to the maximum element index plus one\". But both the above syntaxes gives same lenght (3).</p>\n\n<p>Is there a name for this operator \"...\"?\nDidn't find a way to search this operator in google.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 1, "creation_date": 1424769617, "post_id": 28691474, "comment_id": 45675134, "body": "Very related: <a href=\"http://stackoverflow.com/questions/23354810/how-can-i-dump-all-a-go-processs-stacks\" title=\"how can i dump all a go processs stacks\">stackoverflow.com/questions/23354810/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/19094099/how-to-dump-goroutine-stacktraces\" title=\"how to dump goroutine stacktraces\">stackoverflow.com/questions/19094099/&hellip;</a>"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1424777940, "post_id": 28691474, "comment_id": 45680366, "body": "I think, without recompiling with some debug output, this will be pretty difficult. From <a href=\"https://golang.org/doc/gdb#Inspecting_the_stack\" rel=\"nofollow noreferrer\">golang.org/doc/gdb#Inspecting_the_stack</a> : &quot;GDB does not understand Go programs well.&quot; ... &quot;As a consequence, although GDB can be useful in some situations, it is not a reliable debugger for Go programs, particularly heavily concurrent ones. Moreover, it is not a priority for the Go project to address these issues, which are difficult. In short, the instructions below should be taken only as a guide to how to use GDB when it works, not as a guarantee of success.&quot;"}, {"owner": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 0, "creation_date": 1424800165, "post_id": 28691474, "comment_id": 45695402, "body": "<a href=\"http://stackoverflow.com/questions/19094099/how-to-dump-goroutine-stacktraces\" title=\"how to dump goroutine stacktraces\">stackoverflow.com/questions/19094099/&hellip;</a> may be useful"}], "answers": [{"comments": [{"owner": {"reputation": 8514, "user_id": 2381823, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4050299819ad1d313f0221e57ac94a53?s=128&d=identicon&r=PG", "display_name": "juanleon", "link": "https://stackoverflow.com/users/2381823/juanleon"}, "edited": false, "score": 1, "creation_date": 1424793023, "post_id": 28699595, "comment_id": 45690539, "body": "Unfortunately, the daemon captures the QUIT signal to do some cleanup and then calling <code>exit(0)</code>.  Good point with the <code>-f</code> option.  I am afraid that I will need to recompile the daemon with some added debugging capabilities, and then hope for the bug to happen again :-("}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 19, "last_activity_date": 1424791283, "creation_date": 1424791283, "answer_id": 28699595, "question_id": 28691474, "link": "https://stackoverflow.com/questions/28691474/how-to-debug-a-deadlocked-process-written-in-golang/28699595#28699595", "title": "How to debug a deadlocked process written in golang", "body": "<p>You can send any go program a <code>QUIT</code> signal, and it will exit with a full stack trace, showing the state of all goroutines, and how they are blocked.</p>\n\n<p>As for <code>strace</code>, go programs are always multithreaded, so you always need to add the <code>-f</code> option</p>\n"}], "owner": {"reputation": 8514, "user_id": 2381823, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4050299819ad1d313f0221e57ac94a53?s=128&d=identicon&r=PG", "display_name": "juanleon", "link": "https://stackoverflow.com/users/2381823/juanleon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5092, "favorite_count": 3, "accepted_answer_id": 28699595, "answer_count": 1, "score": 9, "last_activity_date": 1424791283, "creation_date": 1424767934, "question_id": 28691474, "link": "https://stackoverflow.com/questions/28691474/how-to-debug-a-deadlocked-process-written-in-golang", "title": "How to debug a deadlocked process written in golang", "body": "<p>I have a process written in golang that runs as a daemon.</p>\n\n<p>After a few days it stops producing output with no apparent reason.  I think it might be an internal deadlock.  If I do a <code>strace -p &lt;PID&gt;</code> I can see the line</p>\n\n<pre><code>futex(0x9aaba0, FUTEX_WAIT, 0, NULL\n</code></pre>\n\n<p>and apparently that call never ends.  I would like to use the already running process (since I don't know how/when to trigger the bug again) to debug the problem.</p>\n\n<p>How can I see what goroutines are running and where they?  How can I dump from the process whatever other information might be useful to debug the problem?</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "edited": false, "score": 1, "creation_date": 1424771394, "post_id": 28691035, "comment_id": 45676198, "body": "Instead of writing <code>var wg sync.WaitGroup</code> write <code>wg := new(sync.WaitGroup)</code> and you&#39;ll never make this mistake again!"}, {"owner": {"reputation": 8931, "user_id": 712579, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/189eb7faca6c8ab0ebd61de961b7d6a0?s=128&d=identicon&r=PG", "display_name": "Vector", "link": "https://stackoverflow.com/users/712579/vector"}, "edited": false, "score": 0, "creation_date": 1429824617, "post_id": 28691035, "comment_id": 47796078, "body": "-1 : <a href=\"http://stackoverflow.com/help/on-topic\">Some questions are still off-topic, even if they fit into one of the categories listed above:Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 8, "last_activity_date": 1424766886, "creation_date": 1424766886, "answer_id": 28691199, "question_id": 28691035, "link": "https://stackoverflow.com/questions/28691035/why-all-goroutines-are-asleep-deadlock-identifying-bottleneck/28691199#28691199", "title": "Why all goroutines are asleep - deadlock. Identifying bottleneck", "body": "<p>I just tried it (<a href=\"http://play.golang.org/p/U2EV3Dc0-n\">playground</a>) passing a <code>wg *sync.WaitGroup</code> and it works.</p>\n\n<p>Passing <code>sync.WaitGroup</code> means passing a copy of the <code>sync.WaitGroup</code> (passing by value): the goroutine mentions <code>Done()</code> to a <em>different</em> <code>sync.WaitGroup</code>.</p>\n\n<pre><code>var wg sync.WaitGroup\nfor i := 0; i &lt; 3; i++ {\n    wg.Add(1)\n    go worker(intInputChan, &amp;wg)\n}\n</code></pre>\n\n<p>Note the <code>&amp;wg</code>: you are passing by value the pointer to the original <code>sync.WaitGroup</code>, for the goroutine to use.</p>\n"}, {"comments": [{"owner": {"reputation": 192, "user_id": 1083135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/650f7ee67c04d81685d76db49b385850?s=128&d=identicon&r=PG&f=1", "display_name": "VimleshS", "link": "https://stackoverflow.com/users/1083135/vimleshs"}, "edited": false, "score": 0, "creation_date": 1424768118, "post_id": 28691457, "comment_id": 45674354, "body": "Thank you  VonC &amp; Dave changing it to reference type did the job."}, {"owner": {"reputation": 192, "user_id": 1083135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/650f7ee67c04d81685d76db49b385850?s=128&d=identicon&r=PG&f=1", "display_name": "VimleshS", "link": "https://stackoverflow.com/users/1083135/vimleshs"}, "edited": false, "score": 0, "creation_date": 1424770748, "post_id": 28691457, "comment_id": 45675779, "body": "I liked all notes you have mentioned. Can you please throw in some more theory for point nos 3 (range to read from channel) or a pointer can also help."}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 3, "last_activity_date": 1424768380, "last_edit_date": 1424768380, "creation_date": 1424767870, "answer_id": 28691457, "question_id": 28691035, "link": "https://stackoverflow.com/questions/28691035/why-all-goroutines-are-asleep-deadlock-identifying-bottleneck/28691457#28691457", "title": "Why all goroutines are asleep - deadlock. Identifying bottleneck", "body": "<p>As mentioned, don't pass types from the sync package around by value, right near the top of the <a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow\"><code>sync</code> package documentation</a>: \"<strong>Values containing the types defined in this package should not be copied.</strong>\" That also includes the types themselves (<code>sync.Mutex</code>, <code>sync.WaitGroup</code>, etc).</p>\n\n<p>However, several notes:</p>\n\n<ul>\n<li>You can use just a single call to <code>wg.Add</code> if you know how many you're going to add (but as documented make sure it's done <em>before</em> anything can call <code>Wait</code>).</li>\n<li>You don't want to call <code>runtime.Gosched</code> like that; it makes the workers busy loop.</li>\n<li>You can use <code>range</code> to read from the channel to simplify stopping when it's closed.</li>\n<li>For small functions you can use a closure and not bother to pass the channel or wait group at all.</li>\n</ul>\n\n<p>That turns it into this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    const numWorkers = 3\n\n    c := make(chan int, 10)\n    var wg sync.WaitGroup\n\n    wg.Add(numWorkers)\n    for i := 0; i &lt; numWorkers; i++ {\n        go func() {\n            defer func() {\n                fmt.Println(\"Executing defer\u2026\")\n                wg.Done()\n            }()\n\n            for v := range c {\n                fmt.Println(\"recv:\", v)\n                time.Sleep(100 * time.Millisecond)\n            }\n        }()\n    }\n\n    for i := 1; i &lt; 51; i++ {\n        fmt.Println(\"send:\", i)\n        c &lt;- i\n    }\n    fmt.Println(\"closing\u2026\")\n    close(c)\n\n    fmt.Println(\"waiting\u2026\")\n    wg.Wait()\n    fmt.Println(\"Exiting Main App... \")\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/G2EfBROlHs\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 192, "user_id": 1083135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/650f7ee67c04d81685d76db49b385850?s=128&d=identicon&r=PG&f=1", "display_name": "VimleshS", "link": "https://stackoverflow.com/users/1083135/vimleshs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 870, "favorite_count": 2, "accepted_answer_id": 28691199, "answer_count": 2, "score": 3, "last_activity_date": 1433583084, "creation_date": 1424766233, "last_edit_date": 1433583084, "question_id": 28691035, "link": "https://stackoverflow.com/questions/28691035/why-all-goroutines-are-asleep-deadlock-identifying-bottleneck", "title": "Why all goroutines are asleep - deadlock. Identifying bottleneck", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    intInputChan := make(chan int, 50)\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 3; i++ {\n        wg.Add(1)\n        go worker(intInputChan, wg)\n    }\n    for i := 1; i &lt; 51; i++ {\n        fmt.Printf(\"Inputs. %d \\n\", i)\n        intInputChan &lt;- i\n    }\n    close(intInputChan)\n    wg.Wait()\n    fmt.Println(\"Existing Main App... \")\n    panic(\"---------------\")\n}\n\nfunc worker(input chan int, wg sync.WaitGroup) {\n    defer func() {\n        fmt.Println(\"Executing defer..\")\n        wg.Done()\n    }()\n\n    for {\n        select {\n        case intVal, ok := &lt;-input:\n            time.Sleep(100 * time.Millisecond)\n            if !ok {\n                input = nil\n                return\n            }\n            fmt.Printf(\"%d  %v\\n\", intVal, ok)\n\n        default:\n            runtime.Gosched()\n        }\n    }\n\n}\n</code></pre>\n\n<p>error thrown is.</p>\n\n<p>fatal error: all goroutines are asleep - deadlock!</p>\n\n<p>goroutine 1 [semacquire]:\nsync.(*WaitGroup).Wait(0xc082004600)\n    c:/go/src/sync/waitgroup.go:132 +0x170\nmain.main()\n    E:/Go/go_projects/go/src/Test.go:22 +0x21a</p>\n"}, {"tags": ["go", "crc32"], "comments": [{"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1424785465, "post_id": 28690955, "comment_id": 45684889, "body": "Except for two small problems, my code gives the same result as the <code>cksum</code> utility from unix. So it&#39;s not too far off."}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1424787217, "post_id": 28690955, "comment_id": 45686149, "body": "My current finding: I see that there are many different standards of CRC-32s available. This page is linked from the wikipedia entry:  <a href=\"http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.32\" rel=\"nofollow noreferrer\">reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.32</a> - My first implementation is similar (modulo two errors) to the posix variant, the Go stdlib seems to implement the &quot;plain crc-32&quot;."}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "reply_to_user": {"reputation": 1080, "user_id": 291395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52a730d8035fa7d9e07f5519a5dcbdab?s=128&d=identicon&r=PG", "display_name": "acw", "link": "https://stackoverflow.com/users/291395/acw"}, "edited": false, "score": 0, "creation_date": 1485417491, "post_id": 28690955, "comment_id": 70919927, "body": "@acw Same result, no change in calculation here."}, {"owner": {"reputation": 1080, "user_id": 291395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52a730d8035fa7d9e07f5519a5dcbdab?s=128&d=identicon&r=PG", "display_name": "acw", "link": "https://stackoverflow.com/users/291395/acw"}, "edited": false, "score": 0, "creation_date": 1485430637, "post_id": 28690955, "comment_id": 70926804, "body": "agree, sorry about that."}], "answers": [{"comments": [{"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1424775092, "post_id": 28693487, "comment_id": 45678430, "body": "I understand that the source code of Go&#39;s crc32 and mine are different. But why is my implementation giving a different result? The table I am using has the starting polynome from the wiki page for CRC-32 (0x04C11DB7), Go&#39;s implementation uses the reversed polynome."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1424775584, "post_id": 28693487, "comment_id": 45678745, "body": "From the wikipedia <a href=\"http://en.wikipedia.org/wiki/Mathematics_of_cyclic_redundancy_checks#Reversed_representations_and_reciprocal_polynomials\" rel=\"nofollow noreferrer\">mathematics of CRC</a> :  <i>But the reciprocal polynomial is not the same as the original polynomial, and the CRCs generated using it are not the same (even modulo bit reversal) as those generated by the original polynomial.</i>  So yes, your result isn&#39;t the same as golang&#39;s one. Feel weird, but seem expected."}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1424775837, "post_id": 28693487, "comment_id": 45678901, "body": "Is Go using reciprocal polynomials?"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1424784347, "post_id": 28693487, "comment_id": 45684149, "body": "Hum\u2026 wrong quote. Non, Go isn&#39;t using reciprocal polynominals. But the reversed and normal versions doesn&#39;t give the same hexadecimal representation, so if you don&#39;t take it into account you won&#39;t get the same result."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": -1, "last_activity_date": 1424774181, "creation_date": 1424774181, "answer_id": 28693487, "question_id": 28690955, "link": "https://stackoverflow.com/questions/28690955/understanding-crc32/28693487#28693487", "title": "Understanding crc32", "body": "<p>First, it seem that you are not using the right table (or at least the same than the golang standard library): you can check it simply by comparing your table to the one available in the crc32 package. <a href=\"http://play.golang.org/p/oUYM-6HYKL\" rel=\"nofollow\">Here is a playground example</a>.</p>\n\n<p>Then, you algorithm is also wrong. To be honest, I didn't even tried to check whether you put the right values at the right places, but simply dug out the code used by <code>crc32.Checksum</code>. Here is a fixed version of your algorithm:</p>\n\n<p><code>\ncrc := uint32(0xffffffff)\nfor _, v := range message {\n    crc = tbl[byte(crc)^v] ^ (crc &gt;&gt; 8)\n}\nreturn ^crc\n</code></p>\n\n<p>As you see, the in-loop calculation is a bit different. you can see it in action with the <code>crc32.IEEE</code> polynominal table <a href=\"http://play.golang.org/p/eO_X_kRnwR\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2609, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424775648, "creation_date": 1424765790, "last_edit_date": 1424775648, "question_id": 28690955, "link": "https://stackoverflow.com/questions/28690955/understanding-crc32", "title": "Understanding crc32", "body": "<p>I try to understand the computation of crc32. It's new to me, so the question is a basic one. With the following code I have two different ways of computing the CRC32 sum. They should (in theory) be the same, but they differ. What am I doing wrong?</p>\n\n<p>The Go stdlib implementation (what a surprise) seems to be correct, but I can't find the error in my implementation.</p>\n\n<p><a href=\"https://play.golang.org/p/QJH2K3IQEj\" rel=\"nofollow\">https://play.golang.org/p/QJH2K3IQEj</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"hash/crc32\"\n)\n\nfunc main() {\n    message := []byte(\"hello\")\n    // Is this the correct polynomial table? This is the table from\n    // http://gnuradio.org/redmine/projects/gnuradio/repository/revisions/1cb52da49230c64c3719b4ab944ba1cf5a9abb92/entry/gr-digital/lib/digital_crc32.cc\n    tbl := [256]uint32{0x00000000, 0x04C11DB7, 0x09823B6E, 0x0D4326D9,\n        0x130476DC, 0x17C56B6B, 0x1A864DB2, 0x1E475005,\n        0x2608EDB8, 0x22C9F00F, 0x2F8AD6D6, 0x2B4BCB61,\n        0x350C9B64, 0x31CD86D3, 0x3C8EA00A, 0x384FBDBD,\n        0x4C11DB70, 0x48D0C6C7, 0x4593E01E, 0x4152FDA9,\n        0x5F15ADAC, 0x5BD4B01B, 0x569796C2, 0x52568B75,\n        0x6A1936C8, 0x6ED82B7F, 0x639B0DA6, 0x675A1011,\n        0x791D4014, 0x7DDC5DA3, 0x709F7B7A, 0x745E66CD,\n        0x9823B6E0, 0x9CE2AB57, 0x91A18D8E, 0x95609039,\n        0x8B27C03C, 0x8FE6DD8B, 0x82A5FB52, 0x8664E6E5,\n        0xBE2B5B58, 0xBAEA46EF, 0xB7A96036, 0xB3687D81,\n        0xAD2F2D84, 0xA9EE3033, 0xA4AD16EA, 0xA06C0B5D,\n        0xD4326D90, 0xD0F37027, 0xDDB056FE, 0xD9714B49,\n        0xC7361B4C, 0xC3F706FB, 0xCEB42022, 0xCA753D95,\n        0xF23A8028, 0xF6FB9D9F, 0xFBB8BB46, 0xFF79A6F1,\n        0xE13EF6F4, 0xE5FFEB43, 0xE8BCCD9A, 0xEC7DD02D,\n        0x34867077, 0x30476DC0, 0x3D044B19, 0x39C556AE,\n        0x278206AB, 0x23431B1C, 0x2E003DC5, 0x2AC12072,\n        0x128E9DCF, 0x164F8078, 0x1B0CA6A1, 0x1FCDBB16,\n        0x018AEB13, 0x054BF6A4, 0x0808D07D, 0x0CC9CDCA,\n        0x7897AB07, 0x7C56B6B0, 0x71159069, 0x75D48DDE,\n        0x6B93DDDB, 0x6F52C06C, 0x6211E6B5, 0x66D0FB02,\n        0x5E9F46BF, 0x5A5E5B08, 0x571D7DD1, 0x53DC6066,\n        0x4D9B3063, 0x495A2DD4, 0x44190B0D, 0x40D816BA,\n        0xACA5C697, 0xA864DB20, 0xA527FDF9, 0xA1E6E04E,\n        0xBFA1B04B, 0xBB60ADFC, 0xB6238B25, 0xB2E29692,\n        0x8AAD2B2F, 0x8E6C3698, 0x832F1041, 0x87EE0DF6,\n        0x99A95DF3, 0x9D684044, 0x902B669D, 0x94EA7B2A,\n        0xE0B41DE7, 0xE4750050, 0xE9362689, 0xEDF73B3E,\n        0xF3B06B3B, 0xF771768C, 0xFA325055, 0xFEF34DE2,\n        0xC6BCF05F, 0xC27DEDE8, 0xCF3ECB31, 0xCBFFD686,\n        0xD5B88683, 0xD1799B34, 0xDC3ABDED, 0xD8FBA05A,\n        0x690CE0EE, 0x6DCDFD59, 0x608EDB80, 0x644FC637,\n        0x7A089632, 0x7EC98B85, 0x738AAD5C, 0x774BB0EB,\n        0x4F040D56, 0x4BC510E1, 0x46863638, 0x42472B8F,\n        0x5C007B8A, 0x58C1663D, 0x558240E4, 0x51435D53,\n        0x251D3B9E, 0x21DC2629, 0x2C9F00F0, 0x285E1D47,\n        0x36194D42, 0x32D850F5, 0x3F9B762C, 0x3B5A6B9B,\n        0x0315D626, 0x07D4CB91, 0x0A97ED48, 0x0E56F0FF,\n        0x1011A0FA, 0x14D0BD4D, 0x19939B94, 0x1D528623,\n        0xF12F560E, 0xF5EE4BB9, 0xF8AD6D60, 0xFC6C70D7,\n        0xE22B20D2, 0xE6EA3D65, 0xEBA91BBC, 0xEF68060B,\n        0xD727BBB6, 0xD3E6A601, 0xDEA580D8, 0xDA649D6F,\n        0xC423CD6A, 0xC0E2D0DD, 0xCDA1F604, 0xC960EBB3,\n        0xBD3E8D7E, 0xB9FF90C9, 0xB4BCB610, 0xB07DABA7,\n        0xAE3AFBA2, 0xAAFBE615, 0xA7B8C0CC, 0xA379DD7B,\n        0x9B3660C6, 0x9FF77D71, 0x92B45BA8, 0x9675461F,\n        0x8832161A, 0x8CF30BAD, 0x81B02D74, 0x857130C3,\n        0x5D8A9099, 0x594B8D2E, 0x5408ABF7, 0x50C9B640,\n        0x4E8EE645, 0x4A4FFBF2, 0x470CDD2B, 0x43CDC09C,\n        0x7B827D21, 0x7F436096, 0x7200464F, 0x76C15BF8,\n        0x68860BFD, 0x6C47164A, 0x61043093, 0x65C52D24,\n        0x119B4BE9, 0x155A565E, 0x18197087, 0x1CD86D30,\n        0x029F3D35, 0x065E2082, 0x0B1D065B, 0x0FDC1BEC,\n        0x3793A651, 0x3352BBE6, 0x3E119D3F, 0x3AD08088,\n        0x2497D08D, 0x2056CD3A, 0x2D15EBE3, 0x29D4F654,\n        0xC5A92679, 0xC1683BCE, 0xCC2B1D17, 0xC8EA00A0,\n        0xD6AD50A5, 0xD26C4D12, 0xDF2F6BCB, 0xDBEE767C,\n        0xE3A1CBC1, 0xE760D676, 0xEA23F0AF, 0xEEE2ED18,\n        0xF0A5BD1D, 0xF464A0AA, 0xF9278673, 0xFDE69BC4,\n        0x89B8FD09, 0x8D79E0BE, 0x803AC667, 0x84FBDBD0,\n        0x9ABC8BD5, 0x9E7D9662, 0x933EB0BB, 0x97FFAD0C,\n        0xAFB010B1, 0xAB710D06, 0xA6322BDF, 0xA2F33668,\n        0xBCB4666D, 0xB8757BDA, 0xB5365D03, 0xB1F740B4}\n\n    crc := uint32(0xffffffff)\n\n    // different result\n    for _, v := range message {\n        crc = tbl[v^(byte(crc&gt;&gt;24)&amp;0xff)] ^ (crc &lt;&lt; 8)\n    }\n\n    crc = ^crc\n    fmt.Printf(\"%10d == 0x%x\\n\", crc, crc) //  422667581 == 0x1931653d\n\n    // same as http://zorc.breitbandkatze.de/crc.html\n    chk := crc32.ChecksumIEEE(message)\n    fmt.Printf(\"%10d == 0x%x\\n\", chk, chk) //  907060870 == 0x3610a686\n}\n</code></pre>\n\n<p>Edit (from a comment below): I understand that the source code of Go's crc32 and mine are different. But why is my implementation giving a different result? The table I am using has the same starting polynome (from <a href=\"https://en.wikipedia.org/wiki/Cyclic_redundancy_check\" rel=\"nofollow\">the wiki page for CRC-32</a>) as Go's implementation  (0x04C11DB7), except that Go uses the reversed polynome and therfore a different algorithm is not surprising. \"My\" algorithm comes from various different C/C++ sources, such as <a href=\"http://gnuradio.org/redmine/projects/gnuradio/repository/revisions/1cb52da49230c64c3719b4ab944ba1cf5a9abb92/entry/gr-digital/lib/digital_crc32.cc\" rel=\"nofollow\">the one linked in the source</a>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1442097996, "post_id": 28690722, "comment_id": 52945869, "body": "Broadly, you want products and categories to have a <code>Categories</code> field with an array of category IDs (because on real ecommerce sites, items tend not to be in just one category) and a <a href=\"http://docs.mongodb.org/master/core/index-multikey/\" rel=\"nofollow noreferrer\">multikey index</a> so you can find all products/subcategories in a category. I&#39;m not a Mongo guy and it&#39;s a broad question, so that&#39;s all I&#39;ve got."}], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 2, "last_activity_date": 1442327738, "creation_date": 1442327738, "answer_id": 32588852, "question_id": 28690722, "link": "https://stackoverflow.com/questions/28690722/how-to-write-catalog-with-many-categoriestaxonomy-100/32588852#32588852", "title": "How to write catalog with many categories(taxonomy &gt;&gt;100)?", "body": "<p>I'm not a MongoDB expert, but here is my take:</p>\n\n<p>As you have plenty of categories, you don't have any itnerest in writing a struct for each of your types, as it would be both fastidious and unreliable.</p>\n\n<p>Instead, you should work directly with the <code>bson.M</code> type, which is basically an alias for the <code>map[string]interface{}</code> type.</p>\n"}], "owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 32588852, "answer_count": 1, "score": 9, "last_activity_date": 1442327738, "creation_date": 1424764786, "last_edit_date": 1441778878, "question_id": 28690722, "link": "https://stackoverflow.com/questions/28690722/how-to-write-catalog-with-many-categoriestaxonomy-100", "title": "How to write catalog with many categories(taxonomy &gt;&gt;100)?", "body": "<p>I am newbie to golang, who moved from dynamic typed language.</p>\n\n<p>I faced with problem how to  write catalog with many categories/subcategory \u2014 complex taxonomy. For example:</p>\n\n<p>Shoestring > Shoes > Men > shoes > clothes > Home > Categories </p>\n\n<p>I am using mongodb as backend. I can't understand <strong>how to write CRUD operation's in this case?</strong></p>\n\n<p><strong><em>If I will process all queries as usual</em></strong>:</p>\n\n\n\n<pre><code>func RunFindAllQuery(document interface{}, m bson.M, mongoSession *mgo.Session, conn Conn) (err error) {\nsessionCopy := mongoSession.Copy()\ndefer sessionCopy.Close()\ncollection:= sessionCopy.DB(conn.Database).C(conn.Collection)   \nerr = collection.Find(m).All(document)\nif err != nil {\n    log.Printf(\"RunQuery : ERROR : %s\\n\", err)\n}\n   return err\n}\n</code></pre>\n\n<p>I will need to define many types: shoes != car.\n</p>\n\n<pre><code>type Shoes struct {\n    Id             bson.ObjectId `bson:\"_id\"`\n    Name           string        `bson:\"name\"`\n    Description    string        `bson:\"descriprion\"`\n    Size           float         `bson:\"size\"`\n    Color          float         `bson:\"color\"`\n    Type           float         `bson:\"type\"`\n    ShoeHeight     float         `bson:\"shoeheight\"`\n    PlatformHeight float         `bson:\"platformheight\"`\n    Country        float         `bson:\"country\"`\n}\ntype Car struct {\n    Id          bson.ObjectId `bson:\"_id\"`\n    Name        string        `bson:\"name\"`\n    Model       CarModel      `bson:\"name\"`\n    Description string        `bson:\"descriprion\"`\n    Color       float         `bson:\"color\"`\n    Height      float         `bson:\"height\"`\n    Fueltype    string        `bson:\"fueltype\"`\n    Country     float         `bson:\"country\"`\n}\n</code></pre>\n\n<p>And my code will be copypaste:\n</p>\n\n<pre><code>var carobjFindAll []Car\nm := bson.M{\"description\": \"description\"}\n_ = RunFindAllQuery(&amp;carobjFindAll, m, mongoSession, conn)\nfor cur := range carobjFindAll {\n    fmt.Printf(\"\\nId: %s\\n\", carobjFindAll[cur].Id)\n    fmt.Printf(\"\\nColor: %s\\n\", carobjFindAll[cur].Color)\n}\nvar shoesobjFindAll []Shoes\nm_shoes := bson.M{\"description\": \"shoes_description\"}\n_ = RunFindAllQuery(&amp;shoesobjFindAll, m_shoes, mongoSession, conn)\nfor cur_shoe := range shoesobjFindAll {\n    fmt.Printf(\"\\nId: %s\\n\", shoesobjFindAll[cur_shoe].Id)\n    fmt.Printf(\"\\nColor: %s\\n\", shoesobjFindAll[cur_shoe].Color)\n}\n</code></pre>\n\n<p>PS:\nSorry for my English</p>\n"}, {"tags": ["go", "package"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1427267518, "last_edit_date": 1427267518, "creation_date": 1424763241, "answer_id": 28690350, "question_id": 28689700, "link": "https://stackoverflow.com/questions/28689700/correct-way-to-get-golang-org-x-tools-go-ast-astutil/28690350#28690350", "title": "Correct way to get golang.org/x/tools/go/ast/astutil", "body": "<p>I just tried:</p>\n\n<pre><code>C:\\Users\\VonC\\prog\\go\\src\\github.com\\golang\\lint&gt;go get -t -v ./...\ngolang.org/x/tools/go/exact\ngolang.org/x/tools/go/ast/astutil\ngolang.org/x/tools/go/types\ngolang.org/x/tools/go/gcimporter\ngithub.com/golang/lint\ngithub.com/golang/lint/golint\n</code></pre>\n\n<p>That was enough to at least compile all dependent tools including <code>golang.org/x/tools/go/ast/astutil</code>, but not get their sources.</p>\n\n<hr>\n\n<p>For just <code>astutil</code>, I also tried:</p>\n\n<pre><code>C:\\Users\\VonC\\prog\\go&gt;go get golang.org/x/tools/go/ast/astutil\n\nC:\\Users\\VonC\\prog\\go&gt;cd src\n\nC:\\Users\\VonC\\prog\\go\\src&gt;cd golang.org/x/tools/go/ast/astutil\n\nC:\\Users\\VonC\\prog\\go\\src\\golang.org\\x\\tools\\go\\ast\\astutil&gt;dir\n\n R\u00e9pertoire de C:\\Users\\VonC\\prog\\go\\src\\golang.org\\x\\tools\\go\\ast\\astutil\n\n03/02/2015  07:41    &lt;REP&gt;          .\n03/02/2015  07:41    &lt;REP&gt;          ..\n03/02/2015  07:41            16\u00a0003 enclosing.go\n03/02/2015  07:41             4\u00a0655 enclosing_test.go\n03/02/2015  07:41             9\u00a0191 imports.go\n03/02/2015  07:41            11\u00a0035 imports_test.go\n03/02/2015  07:41               211 util.go\n</code></pre>\n\n<hr>\n\n<p>If <code>go get golang.org/x/tools/go/ast/astutil</code> doesn't work, try with a fresh installation of Go 1.4.2, in a separate and clean Go workspace (meaning a different <code>GOROOT</code> for referencing a new installation, and a different <code>GOPATH</code>, for referencing an empty and fresh workspace) </p>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1424765758, "post_id": 28690928, "comment_id": 45673288, "body": "As I told you, a fresh GOPATH is better: no side effect from a previous set of dependencies."}], "tags": [], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "is_accepted": false, "score": 0, "last_activity_date": 1424766332, "last_edit_date": 1424766332, "creation_date": 1424765665, "answer_id": 28690928, "question_id": 28689700, "link": "https://stackoverflow.com/questions/28689700/correct-way-to-get-golang-org-x-tools-go-ast-astutil/28690928#28690928", "title": "Correct way to get golang.org/x/tools/go/ast/astutil", "body": "<p>Solution for my problem:</p>\n\n<pre><code>cd $GOPATH/src/code.google.com/p/\nrm -rf go.*\n\ncd $GOPATH/src/golang.org/x/\nrm -rf *\n\ngo get -u -v golang.org/x/tools\ngo get -u -v golang.org/x/crypto\ngo get -u -v golang.org/x/image\ngo get -u -v golang.org/x/mobile\ngo get -u -v golang.org/x/net\ngo get -u -v golang.org/x/sys\ngo get -u -v golang.org/x/text\n</code></pre>\n\n<p>Probably my fault is I <code>go get</code> from <code>code.google.com/p</code> instead of <code>golang.org/x</code>?</p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6102, "favorite_count": 1, "accepted_answer_id": 28690350, "answer_count": 2, "score": 2, "last_activity_date": 1427267518, "creation_date": 1424760379, "last_edit_date": 1424764229, "question_id": 28689700, "link": "https://stackoverflow.com/questions/28689700/correct-way-to-get-golang-org-x-tools-go-ast-astutil", "title": "Correct way to get golang.org/x/tools/go/ast/astutil", "body": "<p>It seems the repository has moved from <code>golang.org/x/tools/astutil</code> to <code>golang.org/x/tools/go/ast/astutil</code></p>\n\n<p>I'm trying to build <a href=\"https://github.com/motemen/gore\" rel=\"nofollow\"><code>gore</code></a> but it cannot found the <code>astutil</code>, I have the workaround to get it compiled:</p>\n\n<pre><code>mkdir $GOPATH/src/golang.org/x/tools/go/ast\nln -s $GOPATH/src/golang.org/x/tools/astutil $GOPATH/src/golang.org/x/tools/go/ast\n</code></pre>\n\n<p>but is this the correct way to fix this?</p>\n\n<p>I've tried to remove the <code>x/tools</code> directory and fetch it again, using this command:</p>\n\n<pre><code>rm -rf $GOPATH/src/golang.org/x/tools \ngo get -u -v golang.org/x/tools\n</code></pre>\n\n<p>but <code>astutil</code> still on the same directory (<code>x/tools/go/astutil</code>) instead of <code>x/tools/go/ast/astutil</code></p>\n\n<p>I've tried to <code>go get -u -v golang.org/x/tools/go/ast/astutil</code> but it seems not working:</p>\n\n<pre><code>Fetching https://golang.org/x/tools/go/ast/astutil?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/ast/astutil?go-get=1\n(status code 200)\nget \"golang.org/x/tools/go/ast/astutil?\": found meta tag\nmain.metaImport{Prefix:\"golang.org/x/tools\", VCS:\"git\", RepoRoot:\"\nhttps://go.googlesource.com/tools\"} at\nhttps://golang.org/x/tools/go/ast/astutil?go-get=1\nget \"golang.org/x/tools/go/ast/astutil?\": verifying non-authoritative meta\ntag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\npackage golang.org/x/tools/go/ast/astutil?: /home/asd/Dropbox/go/src/\ngolang.org/x/tools exists but /home/asd/Dropbox/go/src/\ngolang.org/x/tools/.git does not - stale checkout?\n</code></pre>\n\n<p>What's the correct way to fix this?</p>\n\n<p>My go version: <code>go version go1.4.1 linux/amd64</code></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1471, "user_id": 1531285, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/WeQsK.jpg?s=128&g=1", "display_name": "icemelon", "link": "https://stackoverflow.com/users/1531285/icemelon"}, "is_accepted": false, "score": 7, "last_activity_date": 1424738497, "creation_date": 1424738497, "answer_id": 28686363, "question_id": 28686307, "link": "https://stackoverflow.com/questions/28686307/go-rpc-error-reading-body-gob-attempt-to-decode-into-a-non-pointer/28686363#28686363", "title": "Go RPC Error: reading body gob: attempt to decode into a non-pointer", "body": "<p>The error is defined at <a href=\"https://golang.org/src/encoding/gob/decoder.go\" rel=\"noreferrer\">https://golang.org/src/encoding/gob/decoder.go</a>\nAs the error says, decoder need a pointer. </p>\n\n<p>The wrong rpc call  is <code>call(address, name, args, reply)</code>. Server can receive the call successfully while can not reply, the rpc call fails. </p>\n\n<p>The right way is <code>call(address, name, args, &amp;reply)</code></p>\n"}], "owner": {"reputation": 1471, "user_id": 1531285, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/WeQsK.jpg?s=128&g=1", "display_name": "icemelon", "link": "https://stackoverflow.com/users/1531285/icemelon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2278, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1424738497, "creation_date": 1424738175, "question_id": 28686307, "link": "https://stackoverflow.com/questions/28686307/go-rpc-error-reading-body-gob-attempt-to-decode-into-a-non-pointer", "title": "Go RPC Error: reading body gob: attempt to decode into a non-pointer", "body": "<p>When I call RPC, this error will happen. \nWhile on the server side, I can get the call successfully.</p>\n"}, {"tags": ["go", "broker"], "comments": [{"owner": {"reputation": 8771, "user_id": 2050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2d1e9a607c47a89730352dd7b9dacaab?s=128&d=identicon&r=PG", "display_name": "Eric Platon", "link": "https://stackoverflow.com/users/2050/eric-platon"}, "edited": false, "score": 1, "creation_date": 1424740032, "post_id": 28686018, "comment_id": 45665602, "body": "If I&#39;m not mistaken, goroutine are like fibers, and do some kind of cooperative multitasking. It seems to me that your current implementation locks itself. I hope this comment gives a clue---dunno the Go semantics enough to tell more at this point."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1424783243, "post_id": 28686018, "comment_id": 45683458, "body": "You are correct: goroutines do cooperative multithreading at an abstract level above OS threads. In other words, each OS thread can be apparently running many goroutines concurrently. The Go runtime does this by time-slicing the goroutines onto the thread."}, {"owner": {"reputation": 8771, "user_id": 2050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2d1e9a607c47a89730352dd7b9dacaab?s=128&d=identicon&r=PG", "display_name": "Eric Platon", "link": "https://stackoverflow.com/users/2050/eric-platon"}, "edited": false, "score": 0, "creation_date": 1424790749, "post_id": 28686018, "comment_id": 45688734, "body": "Thanks for the confirmation. Then, I think the call to <code>Accept</code> is blocking the thread, so all goroutines. There is need to either yield execution, or change for actual threads or channels."}, {"owner": {"reputation": 2843, "user_id": 1403991, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f9a1af29444759103642031d220ffc19?s=128&d=identicon&r=PG&f=1", "display_name": "Jono", "link": "https://stackoverflow.com/users/1403991/jono"}, "edited": false, "score": 0, "creation_date": 1424794337, "post_id": 28686018, "comment_id": 45691504, "body": "What is the &#39;best practice&#39; form of doing this? Timeout&#39;s? I feel like that wouldn&#39;t work either since it would go from <code>Accept</code> to the other <code>Accept</code> and possibly miss connections from one or the other."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 8771, "user_id": 2050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2d1e9a607c47a89730352dd7b9dacaab?s=128&d=identicon&r=PG", "display_name": "Eric Platon", "link": "https://stackoverflow.com/users/2050/eric-platon"}, "edited": false, "score": 2, "creation_date": 1424794345, "post_id": 28686018, "comment_id": 45691509, "body": "@EricPlaton: goroutines are cooperative in a sense, but the only way for one to block the entire program is to have a busy loop with GOMAXPROCS=1 (and even then you wouldn&#39;t get the deadlock error)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1424794390, "post_id": 28686018, "comment_id": 45691548, "body": "@jQwierdy: you need to show a little more code to sort this out, like how to you define your channels, and what does you main for loop look like?"}, {"owner": {"reputation": 2843, "user_id": 1403991, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f9a1af29444759103642031d220ffc19?s=128&d=identicon&r=PG&f=1", "display_name": "Jono", "link": "https://stackoverflow.com/users/1403991/jono"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1424797095, "post_id": 28686018, "comment_id": 45693494, "body": "@JimB my channel was just a buffered channel of net.Conn. See my answer below, I figured it out. Thanks for your help! After you said that goroutines are cooperative (Which I thought but then was convinced I was wrong) I sought to figure out a different way."}], "answers": [{"tags": [], "owner": {"reputation": 2843, "user_id": 1403991, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f9a1af29444759103642031d220ffc19?s=128&d=identicon&r=PG&f=1", "display_name": "Jono", "link": "https://stackoverflow.com/users/1403991/jono"}, "is_accepted": true, "score": 1, "last_activity_date": 1424797027, "creation_date": 1424797027, "answer_id": 28701725, "question_id": 28686018, "link": "https://stackoverflow.com/questions/28686018/trouble-with-go-routines-and-its-concurrency/28701725#28701725", "title": "Trouble with Go Routines and its concurrency", "body": "<p>In the end, I think the issue was that I was attempting to <strong>pass</strong> in listeners to the <em>Go routine</em>, thus having each go routine having a dependancy with the main thread. The working solution ended up being as simple as this:</p>\n\n<pre><code>func main(){\n ...\n node_ip_port := \"127.0.0.1:9000\"\n client_ip_port := \"127.0.0.1:1000\"\n nodeChan := make(chan net.Conn, 20)\n\n go func(ip_port string, nodeChan chan&lt;- net.Conn) {\n    l, err := net.Listen(\"tcp\", node_ip)\n    if err != nil {\n        log.Fatal(\"Had an error connecting to node\", err)\n    }\n    for {\n        conn, _ := l.Accept()\n        kvChan &lt;- conn\n    }\n  }(node_ip_port, nodeChan)\n\n go func(ip_port string) {\n    l, err := net.Listen(\"tcp\", ip_port)\n    if err != nil {\n        log.Fatal(\"Had an error connecting to client\", err)\n    }\n    for {\n        conn, _ := l.Accept()\n        go rpc.ServeConn(conn)\n    }\n  }(client_ip_port)\n  // List of connected nodes\n  nodeList := list.New()\n  for {\n    node := &lt;-nodeChan\n    nodeList.PushBack(node)\n    // My RPC functions use the nodes in this list to serve :-)\n  }\n }\n</code></pre>\n"}], "owner": {"reputation": 2843, "user_id": 1403991, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f9a1af29444759103642031d220ffc19?s=128&d=identicon&r=PG&f=1", "display_name": "Jono", "link": "https://stackoverflow.com/users/1403991/jono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 28701725, "answer_count": 1, "score": 2, "last_activity_date": 1424797027, "creation_date": 1424736588, "question_id": 28686018, "link": "https://stackoverflow.com/questions/28686018/trouble-with-go-routines-and-its-concurrency", "title": "Trouble with Go Routines and its concurrency", "body": "<p>TL;DR accepting and connecting two separate SETS of connections. Want to do it with RPC concurrently.</p>\n\n<p>I'm attempting to create semi distributed system on my computer. The piece of the code I'm working on right now is something like a broker node, in other words it is always accepting client connections from a port. Its also constantly accepting back end node connections from a different port. \nI'm trying to find a way to concurrently listen for both, and serve both. I'm using RPC and the way I tried doing it is this:\nMain:</p>\n\n<pre><code>func main(){  \n ...  \n rpc.Register(myInterface)  \n l, err := net.Listen(\"tcp\", client_port)  \n if err != nil {...}  \n go handleClients(l)  \n node_l, err := net.Listen(\"tcp\", node_port)  \n if err != nil{...}   \n go setUpIncomingNodes(node_l, chan)  \n for{// add nodes to a list from chan} \n}\n</code></pre>\n\n<p>Concurrent functions:</p>\n\n<pre><code>// Adds clients to be connected\nfunc handleClients(listener net.Listener){\n for{\n  conn, err :=listener.Accept()\n  if err != nil{...}\n  // Starts up a blocking (on that thread) RPC connection\n  go rpc.serveConn(conn)\n }\n}\nfunc setUpIncomingNodes(node_listener net.Listener, incoming_nodes chan&lt;- net.Conn){\n for{\n  conn, err := node_listener.Accept()\n  if err != nil{...}\n  incoming_nodes &lt;- conn     \n }\n}\n</code></pre>\n\n<p>The issue is that it doesn't serve the first node, until the second comes along. I can't understand why. Also it seems that only one connection can happen at time, but I thought RPC served on a different port (thus not blocking it). Any help is super appreciated.</p>\n\n<p>I tried following <a href=\"http://www.badgerr.co.uk/2011/06/20/golang-away-tcp-chat-server/\" rel=\"nofollow\">this tutorial</a> but I found the circumstance too different, its also using a different version of Go. I use two types of nodes/connections where Type A needs to be served through the broker to Type B. </p>\n"}, {"tags": ["go", "code-generation", "abstract-syntax-tree"], "answers": [{"comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 1, "creation_date": 1424765576, "post_id": 28687737, "comment_id": 45673218, "body": "+1 for the first line alone.  Great that it also answers this question, but ignoring errors is a bad habit to get into."}, {"owner": {"reputation": 184, "user_id": 1698814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cd803b7d5e04988704de6c507871aa5?s=128&d=identicon&r=PG", "display_name": "user1698814", "link": "https://stackoverflow.com/users/1698814/user1698814"}, "edited": false, "score": 1, "creation_date": 1424822931, "post_id": 28687737, "comment_id": 45706875, "body": "Oops. It wasn&#39;t that I knew <code>printer.Fprint</code> returns error and I purposefully ignored it, but that I used it like it&#39;s <code>fmt.Printf</code> where normally no error check is done. Dumb question, but thanks for the answer though! Was tearing my hair out at why something as simple as printing doesn&#39;t work..."}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 5, "last_activity_date": 1424749119, "creation_date": 1424749119, "answer_id": 28687737, "question_id": 28685976, "link": "https://stackoverflow.com/questions/28685976/how-to-print-hand-written-ast/28687737#28687737", "title": "How to print hand-written AST?", "body": "<p>Don't ignore errors!</p>\n\n<p>Adding:</p>\n\n<pre><code>err := printer.Fprint(os.Stdout, fset, f)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>Gives: \"<strong>go/printer: unsupported node type ast.File</strong>\" which should have been enough to point you in the right direction.</p>\n\n<p><a href=\"https://golang.org/pkg/go/printer/#Fprint\" rel=\"noreferrer\"><code>printer.Fprint</code></a>'s last argument is <code>interface{}</code> so the compiler accepts anything. However, just as <a href=\"https://golang.org/pkg/go/parser/#ParseFile\" rel=\"noreferrer\"><code>parser.ParseFile</code></a> returns an <code>*ast.File</code> (rather than <code>ast.File</code>) it expects a pointer to a node.</p>\n\n<p>Passing a pointer gives the output you want (note the <code>&amp;ast.File</code>):</p>\n\n<pre><code>package main\n\nimport (\n    \"go/ast\"\n    \"go/printer\"\n    \"go/token\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    f := &amp;ast.File{\n        Name: ast.NewIdent(\"foo\"),\n        Decls: []ast.Decl{\n            &amp;ast.GenDecl{\n                Tok: token.TYPE,\n                Specs: []ast.Spec{\n                    &amp;ast.TypeSpec{\n                        Name: ast.NewIdent(\"Bar\"),\n                        Type: ast.NewIdent(\"uint32\"),\n                    },\n                },\n            },\n        },\n    }\n    fset := token.NewFileSet()\n    err := printer.Fprint(os.Stdout, fset, f)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/EU9mow8CGE\" rel=\"noreferrer\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 184, "user_id": 1698814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cd803b7d5e04988704de6c507871aa5?s=128&d=identicon&r=PG", "display_name": "user1698814", "link": "https://stackoverflow.com/users/1698814/user1698814"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1248, "favorite_count": 0, "accepted_answer_id": 28687737, "answer_count": 1, "score": 1, "last_activity_date": 1424749119, "creation_date": 1424736286, "question_id": 28685976, "link": "https://stackoverflow.com/questions/28685976/how-to-print-hand-written-ast", "title": "How to print hand-written AST?", "body": "<p>I have a set of XML description of network protocol that I'm trying to generate Go code from, therefore I don't have any existing Go code to work with. All of the examples that make use of <code>go/ast</code> (such as <code>go fmt</code>) take existing code, do some transformation on the AST, then write them back out. Since all I have are XML files, the AST that I'm working with have to be written by hand. The problem is that I cannot get my hand-written AST to output.</p>\n\n<p><a href=\"https://play.golang.org/p/M3OPq_QIU4\" rel=\"nofollow\">Example</a></p>\n\n<pre><code>package main\n\nimport (\n    \"go/ast\"\n    \"go/printer\"\n    \"go/token\"\n    \"os\"\n)\n\nfunc main() {\n    f := ast.File{\n        Name: ast.NewIdent(\"foo\"),\n        Decls: []ast.Decl{\n            &amp;ast.GenDecl{\n                Tok: token.TYPE,\n                Specs: []ast.Spec{\n                    &amp;ast.TypeSpec{\n                        Name: ast.NewIdent(\"Bar\"),\n                        Type: ast.NewIdent(\"uint32\"),\n                    },\n                },\n            },\n        },\n    }\n    fset := token.NewFileSet()\n    printer.Fprint(os.Stdout, fset, f)\n}\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>package foo\n\ntype Bar uint32\n</code></pre>\n\n<p>Actual output: nothing</p>\n\n<p>How do I get the AST to print?</p>\n"}, {"tags": ["go", "oauth-2.0"], "comments": [{"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 1, "creation_date": 1424759581, "post_id": 28685033, "comment_id": 45670749, "body": "From this gist (<a href=\"https://gist.github.com/jfcote87/89eca3032cd5f9705ba3#file-gistfile1-go-L26-L30\" rel=\"nofollow noreferrer\">gist.github.com/jfcote87/&hellip;</a>) it seems that, yes you should retrieve the token from your database and return it as <code>*oauth2.Token</code>. The token struct definition is here: <a href=\"https://github.com/golang/oauth2/blob/master/token.go#L25-L49\" rel=\"nofollow noreferrer\">github.com/golang/oauth2/blob/master/token.go#L25-L49</a> . Links, and further discussion here: <a href=\"https://github.com/golang/oauth2/issues/84\" rel=\"nofollow noreferrer\">github.com/golang/oauth2/issues/84</a>"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 1, "creation_date": 1424760348, "post_id": 28685033, "comment_id": 45671026, "body": "Also, this may be of interest &quot;Client returns an HTTP client using the provided token. The token will auto-refresh as necessary.&quot; from <a href=\"https://godoc.org/golang.org/x/oauth2#Config.Client\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/oauth2#Config.Client</a>"}, {"owner": {"reputation": 1676, "user_id": 433242, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/db2f711ff559b2cbeac2dbb95ef2edc3?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/433242/andrew"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 1, "creation_date": 1424772022, "post_id": 28685033, "comment_id": 45676583, "body": "Thank you @Intermernet! I&#39;ll test it tonight but right now i see the solution to my problem. While my code looks relatively similar i didn&#39;t check for validity of token so first call after expiry always failed."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1424777209, "post_id": 28685033, "comment_id": 45679838, "body": "It sounds like that is probably the problem. If so, please post it as an answer (preferably along with some simple example code)."}], "answers": [{"comments": [{"owner": {"reputation": 1676, "user_id": 433242, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/db2f711ff559b2cbeac2dbb95ef2edc3?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/433242/andrew"}, "edited": false, "score": 0, "creation_date": 1426151709, "post_id": 29005151, "comment_id": 46257568, "body": "You&#39;re right. I have come to this code after few tries and it works, more or less. As for updating I guess I&#39;ll build my Client struct with some sort of hook."}, {"owner": {"reputation": 1676, "user_id": 433242, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/db2f711ff559b2cbeac2dbb95ef2edc3?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/433242/andrew"}, "edited": false, "score": 0, "creation_date": 1426151785, "post_id": 29005151, "comment_id": 46257606, "body": "Anyway this is a must for my case since server refreshes both accessToken and refreshToken, so i should catch refresh and store it in database immediately."}, {"owner": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "reply_to_user": {"reputation": 1676, "user_id": 433242, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/db2f711ff559b2cbeac2dbb95ef2edc3?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/433242/andrew"}, "edited": false, "score": 0, "creation_date": 1433817458, "post_id": 29005151, "comment_id": 49501554, "body": "hey @Andrew I&#39;m kind of looking to do the same thing, what did you end up doing to store refresh tokens and replace older access tokens?"}, {"owner": {"reputation": 156, "user_id": 269803, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a4ce65eeb90ca76685ed1ace8d08f958?s=128&d=identicon&r=PG", "display_name": "purpleKarrot", "link": "https://stackoverflow.com/users/269803/purplekarrot"}, "edited": false, "score": 2, "creation_date": 1434623356, "post_id": 29005151, "comment_id": 49862908, "body": "There is a discussion on GitHub about that issue: <a href=\"https://github.com/golang/oauth2/issues/84\" rel=\"nofollow noreferrer\">github.com/golang/oauth2/issues/84</a>"}, {"owner": {"reputation": 3235, "user_id": 387099, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/066eac5a12b429666971cd4ae450f169?s=128&d=identicon&r=PG", "display_name": "Utkarsh Sinha", "link": "https://stackoverflow.com/users/387099/utkarsh-sinha"}, "edited": false, "score": 2, "creation_date": 1458454047, "post_id": 29005151, "comment_id": 59863068, "body": "Is there a way to fetch the <code>AccessToken</code> after a refresh happens (now)?"}, {"owner": {"reputation": 679, "user_id": 3616922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc62658f085e369a1cda16a61f4b61f?s=128&d=identicon&r=PG&f=1", "display_name": "Tsilavina", "link": "https://stackoverflow.com/users/3616922/tsilavina"}, "edited": false, "score": 0, "creation_date": 1518726222, "post_id": 29005151, "comment_id": 84635112, "body": "Thanks for this answer. These only two statement made it work for me with the oauth2 client <code>token := new(oauth2.Token)                                          token.RefreshToken = {{ From DataBase }}</code> Actually the client takes care of refreshing the access token even if it is not specified."}, {"owner": {"reputation": 658, "user_id": 1973205, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/awstX.jpg?s=128&g=1", "display_name": "Theraloss", "link": "https://stackoverflow.com/users/1973205/theraloss"}, "edited": false, "score": 4, "creation_date": 1527078291, "post_id": 29005151, "comment_id": 87989449, "body": "To get the updated token you can follow this: <a href=\"https://github.com/golang/oauth2/issues/84#issuecomment-175591180\" rel=\"nofollow noreferrer\">github.com/golang/oauth2/issues/84#issuecomment-175591180</a> or this <a href=\"https://github.com/golang/oauth2/issues/84#issuecomment-254576796\" rel=\"nofollow noreferrer\">github.com/golang/oauth2/issues/84#issuecomment-254576796</a>"}], "tags": [], "owner": {"reputation": 7285, "user_id": 909297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/35df4b155ec66a3127d53459941cf8a2?s=128&d=identicon&r=PG", "display_name": "Devaroop", "link": "https://stackoverflow.com/users/909297/devaroop"}, "is_accepted": false, "score": 24, "last_activity_date": 1426149673, "creation_date": 1426149673, "answer_id": 29005151, "question_id": 28685033, "link": "https://stackoverflow.com/questions/28685033/how-to-handle-refresh-tokens-in-golang-oauth2-client-lib/29005151#29005151", "title": "How to handle refresh tokens in golang/oauth2 client lib", "body": "<p>You need not bother about refreshing tokens until the time you are storing the <code>Expiry</code> parameter. After getting the 'Token' object, store the following in your database:</p>\n\n<p><code>token.AccessToken</code>, <code>token.RefreshToken</code>, <code>token.TokenType</code> and  <code>token.Expiry</code></p>\n\n<p>while fetching, construct the token object again using the above parameters:</p>\n\n<pre><code>token := new(oauth2.Token)\ntoken.AccessToken = {{ From DataBase }}\ntoken.RefreshToken = {{ From DataBase }}\ntoken.Expiry = {{ From DataBase }}\ntoken.TokenType = {{ From DataBase }}\n</code></pre>\n\n<p>and then get your http client:</p>\n\n<p><code>config.Client(ctx, token)</code></p>\n\n<p>this will handle refreshing the token. Excerpt (more info: <a href=\"https://godoc.org/golang.org/x/oauth2#Config.Client\" rel=\"noreferrer\">Golang oauth2 client</a>): </p>\n\n<blockquote>\n  <p>Client returns an HTTP client using the provided token. The token will auto-refresh as necessary. </p>\n</blockquote>\n\n<p>Only downside is, the refreshed access token is not returned. But it works! Google has no restrictions on how many times the refresh token is used.</p>\n"}], "owner": {"reputation": 1676, "user_id": 433242, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/db2f711ff559b2cbeac2dbb95ef2edc3?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/433242/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15691, "favorite_count": 5, "answer_count": 1, "score": 28, "last_activity_date": 1493260433, "creation_date": 1424731553, "last_edit_date": 1493260433, "question_id": 28685033, "link": "https://stackoverflow.com/questions/28685033/how-to-handle-refresh-tokens-in-golang-oauth2-client-lib", "title": "How to handle refresh tokens in golang/oauth2 client lib", "body": "<p>There are few examples of using <a href=\"https://github.com/golang/oauth2\" rel=\"noreferrer\">https://github.com/golang/oauth2</a> but none of them covers usage of refresh tokens. I've tried few approaches, but i'm still unsatisfied with my results.</p>\n\n<p>Is there any example code, or maybe you know some project at <strong>Github</strong> using <code>oauth2 lib</code> to take as example?</p>\n"}, {"tags": ["syntax", "intellij-idea", "interface", "go"], "answers": [{"comments": [{"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "edited": false, "score": 1, "creation_date": 1424795737, "post_id": 28684571, "comment_id": 45692480, "body": "Makes sense, thank you.  Actually the plugin works well for most other tasks."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 1, "last_activity_date": 1424729827, "creation_date": 1424729827, "answer_id": 28684571, "question_id": 28684449, "link": "https://stackoverflow.com/questions/28684449/why-is-this-go-lang-intellij-plugin-is-inconsistent-with-gos-syntax/28684571#28684571", "title": "Why is this Go-Lang IntelliJ plugin is inconsistent with Go&#39;s syntax?", "body": "<p>It's not a mistake you are making, it's just a problem that we currently have with that particular part of plugin which takes care of things like that.</p>\n\n<p>As per <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/1364#issuecomment-75648899\" rel=\"nofollow\">my answer</a>, please watch the issues <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/1343\" rel=\"nofollow\">1343</a> and <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/1222\" rel=\"nofollow\">1222</a>.</p>\n\n<p>Thank you.</p>\n"}], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 28684571, "answer_count": 1, "score": 0, "last_activity_date": 1424731568, "creation_date": 1424729337, "last_edit_date": 1424731568, "question_id": 28684449, "link": "https://stackoverflow.com/questions/28684449/why-is-this-go-lang-intellij-plugin-is-inconsistent-with-gos-syntax", "title": "Why is this Go-Lang IntelliJ plugin is inconsistent with Go&#39;s syntax?", "body": "<p>I'm somewhat new to Go, so this could be a Go problem, rather than an IntelliJ one: I've just set up  <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/\" rel=\"nofollow\">https://github.com/go-lang-plugin-org/go-lang-idea-plugin/</a> from the zipfile, in IntelliJ 14.  </p>\n\n<p>I found that the compiler is inconsistent with the syntax highlighter.  </p>\n\n<pre><code>world, err := redis.String(c.Do(\"GET\", \"message1\"))\nif err != nil {\n    fmt.Println(\"key not found\")\n}\n</code></pre>\n\n<p>Yields the following error message. </p>\n\n<blockquote>\n  <p>*not enough arguments in call to Redis.String.</p>\n</blockquote>\n\n<p>Looking closer at the call to Redis.String, it appears to take an interface+args.</p>\n\n<pre><code>func String(reply interface{}, err error) (string, error) {\n     ....\n    return \"\", fmt.Errorf(\"redigo: unexpected type for String, got type %T\", reply)\n}\n</code></pre>\n\n<p>And thus, I'm able to trick the IDE into removing the rror message, by simply adding an \"err\" arg to the end of the call, like so:</p>\n\n<pre><code>world, err := redis.String(c.Do(\"GET\", \"message1\"), err)\n</code></pre>\n\n<p>But <em>Alas</em>! This \"fix\" makes the go compiler unhappy... and it reports this message (even though the IntelliJ plugin does not interpret this as an error).</p>\n\n<blockquote>\n  <p><em>./t1.go:19: multiple-value c.Do() in single-value context</em></p>\n</blockquote>\n\n<p>Any thoughts on why the IntelliJ Go Plugin wants two args, wheresas GoLang only wants one arg, for this function would be of great help.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1424758784, "post_id": 28683393, "comment_id": 45670464, "body": "Can you confirm that <code>len(token)</code> is not greater than <code>500</code>? Also what version of Go SDK are you using? 1.2 or 1.4beta? If the latter, in your <code>app.yaml</code> config file did you specify <code>api_version: go1.4beta</code>?"}, {"owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1424796201, "post_id": 28683393, "comment_id": 45692805, "body": "Yes, I am generating the tokens myself and they are 64 bytes long. The error actually even occurs when there are no entities at all in the database, so it would seem to be unrelated to the context of any entity. I only have the api version specified as <code>api_version: go1</code>. Do you know where differences between versions are documented?"}, {"owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1424797134, "post_id": 28683393, "comment_id": 45693520, "body": "I found release noted for the GAE Go runtime environment here: <a href=\"https://code.google.com/p/googleappengine/wiki/SdkForGoReleaseNotes\" rel=\"nofollow noreferrer\">code.google.com/p/googleappengine/wiki/SdkForGoReleaseNotes</a> that state in version 1.9.11 support was added for <code>ByteString</code>, with the note: &quot;Add <code>ByteString</code> type to allow short indexable byte slices.&quot; I confirmed that my code is running on <code>Google App Engine&#47;1.9.18</code> with a call to <code>appengine.ServerSoftware()</code>. I&#39;m not sure how to see what version of Go the app is running on, but it would seem that the Go version should be orthogonal to the app engine functionality provided through the API"}], "answers": [{"tags": [], "owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "is_accepted": true, "score": 0, "last_activity_date": 1427149527, "creation_date": 1427149527, "answer_id": 29221601, "question_id": 28683393, "link": "https://stackoverflow.com/questions/28683393/google-app-engine-bytestring-query-fails/29221601#29221601", "title": "Google App Engine - ByteString query fails", "body": "<p>This issue resolved itself about a week later. Since it only appeared in the module environment, I am guessing that some piece of their code had not been updated to support the ByteString type, and now is. Works great now!</p>\n"}], "owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 29221601, "answer_count": 1, "score": 0, "last_activity_date": 1471443984, "creation_date": 1424725422, "last_edit_date": 1495539865, "question_id": 28683393, "link": "https://stackoverflow.com/questions/28683393/google-app-engine-bytestring-query-fails", "title": "Google App Engine - ByteString query fails", "body": "<p>I am working on a Go application in which I have an Entity with a Property that holds an identifying token which is a random string of bytes. I am storing this property as a ByteString, and in my development environment I have been able to query for this property using a filter of the form:</p>\n\n<pre><code>// token is a []byte\nidTok := datastore.ByteString(token)\nq := ds.NewQuery(\"Entity\").Filter(\"IDToken =\", idTok)\n\nvar entities []Entity\nkeys, err := q.GetAll(c, &amp;entities)\n</code></pre>\n\n<p>But unfortunately, when deployed as a module to GAE, this query returns the error: <code>datastore: bad query filter value type: unsupported datastore value type: datastore.ByteString</code>, which is confusing since I thought the purpose of the ByteString type is to be able to index shorter amounts of binary data under 500 bytes.</p>\n\n<p>I first switched over to using the ByteString type based on the second answer to this SO question: <a href=\"https://stackoverflow.com/questions/25829202/golang-appengine-datastore-filter-query-with-byte-comparison\">Golang - Appengine datastore filter query with []byte comparison</a></p>\n"}, {"tags": ["struct", "go", "yaml"], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1424735502, "post_id": 28683173, "comment_id": 45664269, "body": "Try the more idiomatic <code>FirewallNetworkRules</code> and add a struct tag to capture the YAML formatting - e.g. ` <code>yaml:&quot;firewall_network_rules&quot;</code> `  See here for the docs on struct tag usage in the YAML lib: <a href=\"http://godoc.org/gopkg.in/yaml.v2#Marshal\" rel=\"nofollow noreferrer\">godoc.org/gopkg.in/yaml.v2#Marshal</a>"}, {"owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1424764870, "post_id": 28683173, "comment_id": 45672908, "body": "Thanks for your suggestion, it indeed clarifies my code."}], "tags": [], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "is_accepted": false, "score": 8, "last_activity_date": 1424724611, "creation_date": 1424724611, "answer_id": 28683173, "question_id": 28682439, "link": "https://stackoverflow.com/questions/28682439/go-parse-yaml-file/28683173#28683173", "title": "Go parse yaml file", "body": "<p>Well, I think I've figured it out by myself. The following piece of code works fine. Any suggestions/improvements?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"path/filepath\"\n\n    \"gopkg.in/yaml.v2\"\n)\n\ntype Config struct {\n    Firewall_network_rules map[string]Options\n}\n\ntype Options struct {\n    Src string\n    Dst string\n}\n\nfunc main() {\n    filename, _ := filepath.Abs(\"./fruits.yml\")\n    yamlFile, err := ioutil.ReadFile(filename)\n\n    if err != nil {\n        panic(err)\n    }\n\n    var config Config\n\n    err = yaml.Unmarshal(yamlFile, &amp;config)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"Value: %#v\\n\", config.Firewall_network_rules)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 1487493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200c4542003998961375daee8af9a449?s=128&d=identicon&r=PG", "display_name": "boyal", "link": "https://stackoverflow.com/users/1487493/boyal"}, "is_accepted": false, "score": 9, "last_activity_date": 1475501514, "creation_date": 1475501514, "answer_id": 39832919, "question_id": 28682439, "link": "https://stackoverflow.com/questions/28682439/go-parse-yaml-file/39832919#39832919", "title": "Go parse yaml file", "body": "<p>Why not organize your yaml file like below if you don't care about the rule name?</p>\n\n<pre><code>---\nfirewall_network_rules:\n  - \n    name:      rule1\n    src:       blablabla-host\n    dst:       blabla-hostname\n  - \n    name:      rule2\n    src:       bla-host\n    dst:       bla-hostname\n</code></pre>\n\n<p>So the code will be like this, it is clean and extensible:</p>\n\n<pre><code>type Rule struct {\n    Name  string  `yaml:\"name\"`\n    Src   string  `yaml:\"src\"`\n    Dst   string  `yaml:\"dst\"`\n}\n\ntype Config struct {\n   FirewallNetworkRules []Rule  `yaml:\"firewall_network_rules\"`\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 450, "user_id": 2965665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc4f155dbe24567ff73e58704359028f?s=128&d=identicon&r=PG&f=1", "display_name": "Russo", "link": "https://stackoverflow.com/users/2965665/russo"}, "edited": false, "score": 0, "creation_date": 1606892144, "post_id": 42985312, "comment_id": 115097188, "body": "Very nice with []structs, too. Thank you"}], "tags": [], "owner": {"reputation": 3178, "user_id": 972966, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77e82beae0d15e24aff8b28d7b9213c8?s=128&d=identicon&r=PG", "display_name": "JazzCat", "link": "https://stackoverflow.com/users/972966/jazzcat"}, "is_accepted": false, "score": 27, "last_activity_date": 1601043381, "last_edit_date": 1601043381, "creation_date": 1490297315, "answer_id": 42985312, "question_id": 28682439, "link": "https://stackoverflow.com/questions/28682439/go-parse-yaml-file/42985312#42985312", "title": "Go parse yaml file", "body": "<p>If you're working with google cloud or kubernetes more specifically and want to parse a service.yaml like this:</p>\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: myName\n  namespace: default\n  labels:\n    router.deis.io/routable: &quot;true&quot;\n  annotations:\n    router.deis.io/domains: &quot;&quot;\nspec:\n  type: NodePort\n  selector:\n    app: myName\n  ports:\n    - name: http\n      port: 80\n      targetPort: 80\n    - name: https\n      port: 443\n      targetPort: 443\n</code></pre>\n<p>Supplying a real world example so you get the hang of how nesting can be written.</p>\n<pre><code>type Service struct {\n    APIVersion string `yaml:&quot;apiVersion&quot;`\n    Kind       string `yaml:&quot;kind&quot;`\n    Metadata   struct {\n        Name      string `yaml:&quot;name&quot;`\n        Namespace string `yaml:&quot;namespace&quot;`\n        Labels    struct {\n            RouterDeisIoRoutable string `yaml:&quot;router.deis.io/routable&quot;`\n        } `yaml:&quot;labels&quot;`\n        Annotations struct {\n            RouterDeisIoDomains string `yaml:&quot;router.deis.io/domains&quot;`\n        } `yaml:&quot;annotations&quot;`\n    } `yaml:&quot;metadata&quot;`\n    Spec struct {\n        Type     string `yaml:&quot;type&quot;`\n        Selector struct {\n            App string `yaml:&quot;app&quot;`\n        } `yaml:&quot;selector&quot;`\n        Ports []struct {\n            Name       string `yaml:&quot;name&quot;`\n            Port       int    `yaml:&quot;port&quot;`\n            TargetPort int    `yaml:&quot;targetPort&quot;`\n            NodePort   int    `yaml:&quot;nodePort,omitempty&quot;`\n        } `yaml:&quot;ports&quot;`\n    } `yaml:&quot;spec&quot;`\n}\n</code></pre>\n<p>There's a convenient service called yaml-to-go <a href=\"https://yaml.to-go.online/\" rel=\"noreferrer\">https://yaml.to-go.online/</a> which converts YAML to go structs, just input your YAML into that service and you get an autogenerated struct.</p>\n<p>And last unmarshal as a previous poster wrote:</p>\n<pre><code>var service Service\n\nerr = yaml.Unmarshal(yourFile, &amp;service)\nif err != nil {\n    panic(err)\n}\n\nfmt.Print(service.Metadata.Name)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 634, "user_id": 3615504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ggHcX.jpg?s=128&g=1", "display_name": "reoxey", "link": "https://stackoverflow.com/users/3615504/reoxey"}, "is_accepted": false, "score": 2, "last_activity_date": 1526220379, "creation_date": 1526220379, "answer_id": 50316944, "question_id": 28682439, "link": "https://stackoverflow.com/questions/28682439/go-parse-yaml-file/50316944#50316944", "title": "Go parse yaml file", "body": "<p>If your YAML file is simple (single nesting) like following</p>\n\n<pre><code>mongo:\n    DB: database\n    COL: collection\nlog:\n    error: log/error/error.log\napi:\n    key: jhgwewbcjwefwjfg\n</code></pre>\n\n<p>Here, you can use interface instead of declaring struct.</p>\n\n<pre><code>main(){\n  config := Config()\n  mongoConfig := config[\"mongo\"]\n\n  mongo.MongoDial(\n    String(\n        Get(mongoConfig, \"DB\")\n    ), \n    String(\n        Get(mongoConfig, \"COL\")\n    )\n  )\n}\n\nfunc Config() map[string]interface{} {\n    filename, _ := filepath.Abs(\"configs/config.yaml\")\n    yamlFile, err := ioutil.ReadFile(filename)\n\n    if err != nil {\n        panic(err)\n    }\n\n    var config map[string]interface{}\n\n    err = yaml.Unmarshal(yamlFile, &amp;config)\n    if err != nil {\n        panic(err)\n    }\n\n    return config\n}\nfunc Get(this interface{}, key string) interface{}  {\n    return this.(map[interface{}]interface{})[key]\n}\nfunc String(payload interface{}) string  {\n    var load string\n    if pay, oh := payload.(string); oh {\n        load = pay\n    }else{\n        load = \"\"\n    }\n    return load\n}\n</code></pre>\n\n<p>This works fine for level 1 nesting, if you have complex nesting then it is recommended to use <code>struct</code>.</p>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42060, "favorite_count": 7, "answer_count": 4, "score": 21, "last_activity_date": 1601043381, "creation_date": 1424721953, "last_edit_date": 1459896654, "question_id": 28682439, "link": "https://stackoverflow.com/questions/28682439/go-parse-yaml-file", "title": "Go parse yaml file", "body": "<p>I'm trying to parse a yaml file with Go. Unfortunately I can't figure out how. The yaml file I have is this:</p>\n\n<pre><code>---\nfirewall_network_rules:\n  rule1:\n    src:       blablabla-host\n    dst:       blabla-hostname\n...\n</code></pre>\n\n<p>I have this Go code, but it does not work:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"path/filepath\"\n\n    \"gopkg.in/yaml.v2\"\n)\n\ntype Config struct {\n    Firewall_network_rules map[string][]string\n}\n\nfunc main() {\n    filename, _ := filepath.Abs(\"./fruits.yml\")\n    yamlFile, err := ioutil.ReadFile(filename)\n\n    if err != nil {\n        panic(err)\n    }\n\n    var config Config\n\n    err = yaml.Unmarshal(yamlFile, &amp;config)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"Value: %#v\\n\", config.Firewall_network_rules)\n}\n</code></pre>\n\n<p>When I run this, I get an error. I think it's because I haven't created a struct for the src and dst key/values. FYI: when I change that to a list, it works.</p>\n\n<p>So above code parses this:</p>\n\n<pre><code>---\nfirewall_network_rules:\n  rule1:\n    - value1\n    - value2\n...\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1424722151, "post_id": 28682043, "comment_id": 45657852, "body": "What do you mean by &quot;embedding&quot;? If you&#39;re calling functions in another package. it doesn&#39;t matter how many layers you hide it behind, you still need to install that package."}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 1, "creation_date": 1424727376, "post_id": 28682043, "comment_id": 45660600, "body": "Please explain what you mean. What you&#39;ve said makes no sense ... particularly the &quot;copy them by hand&quot; .."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1424736272, "post_id": 28682043, "comment_id": 45664491, "body": "Note that just writing <code>import encoding&#47;json</code> does not stop you from developing on GAE or cross-compiling. Since it&#39;s also part of the standard library, there&#39;s no need to &#39;vendor&#39; it because it adheres to the Go1 compatibility promise."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1424793760, "post_id": 28682043, "comment_id": 45691108, "body": "I&#39;m developing an application on Google App Engine platform. However I would like to make it work on non-appengine environments too so I have to wrap the GAE specific packages into my packages(write functions with the same name) and use build tags to build either the GAE or non-GAE version. After I put a bit more though in this I think what I actually need is basically a package alias not embedding. Basically when a function is calling mypackage.aFunction it should call appengine.aFunction"}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1426018220, "post_id": 28682043, "comment_id": 46197555, "body": "Why not just <code>import myPackage &quot;path&#47;to&#47;another&#47;package&quot;</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 0, "last_activity_date": 1426000098, "last_edit_date": 1426000098, "creation_date": 1424740091, "answer_id": 28686601, "question_id": 28682043, "link": "https://stackoverflow.com/questions/28682043/is-it-possible-to-embed-a-package-without-to-copy-it/28686601#28686601", "title": "Is it possible to embed a package without to copy it?", "body": "<p>No. </p>\n\n<p>It sounds like you want some sort of package inheritance, this is not a supported feature.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 28686601, "answer_count": 1, "score": -1, "last_activity_date": 1426000098, "creation_date": 1424720681, "question_id": 28682043, "link": "https://stackoverflow.com/questions/28682043/is-it-possible-to-embed-a-package-without-to-copy-it", "title": "Is it possible to embed a package without to copy it?", "body": "<p>Say there we have the package encoding/json. Can I just create a package mypackage and embed all the functions (at least the public functions) into my package without to copy them by hand and basically do calls back to the actual json package? I'm developing a cross platform (Google app engine / native ) solution and I would find a such solution quite useful. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3995620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896d279fc77a060bf787e8c6c90542d?s=128&d=identicon&r=PG&f=1", "display_name": "Alfonso", "link": "https://stackoverflow.com/users/3995620/alfonso"}, "edited": false, "score": 0, "creation_date": 1424788135, "post_id": 28681922, "comment_id": 45686738, "body": "thanks for the answer. Where can I find info about the return of ioutil.Readdir being ([]os.FileInfo, error)? I want to understand this concept instead of just using your answer without knowing the why."}, {"owner": {"reputation": 33, "user_id": 3995620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896d279fc77a060bf787e8c6c90542d?s=128&d=identicon&r=PG&f=1", "display_name": "Alfonso", "link": "https://stackoverflow.com/users/3995620/alfonso"}, "edited": false, "score": 0, "creation_date": 1424794754, "post_id": 28681922, "comment_id": 45691788, "body": "Thanks again. Last question ( I hope) - I&#39;m trying to delete the file in the if clause that meets the criteria but I&#39;m struggling with what variable I use when calling os.Remove(). Any help is appreciated...     for _, info := range fileInfo {       if diff := now.Sub(info.ModTime()); diff &gt; cutoff { \tfmt.Printf(&quot;Deleting %s\\n&quot;, info.Name()) \tos.Remove(??)"}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "reply_to_user": {"reputation": 33, "user_id": 3995620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896d279fc77a060bf787e8c6c90542d?s=128&d=identicon&r=PG&f=1", "display_name": "Alfonso", "link": "https://stackoverflow.com/users/3995620/alfonso"}, "edited": false, "score": 0, "creation_date": 1424799246, "post_id": 28681922, "comment_id": 45694820, "body": "@Alfonso, you have the <code>info.Name()</code>, you have the directory, there is <code>path.Join</code>, and <code>os.Remove</code> takes a file path.  Seems like all the pieces are there an waiting."}, {"owner": {"reputation": 33, "user_id": 3995620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896d279fc77a060bf787e8c6c90542d?s=128&d=identicon&r=PG&f=1", "display_name": "Alfonso", "link": "https://stackoverflow.com/users/3995620/alfonso"}, "edited": false, "score": 0, "creation_date": 1424799978, "post_id": 28681922, "comment_id": 45695269, "body": "I have it now. Thanks for all the help!"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 9, "last_activity_date": 1424721890, "last_edit_date": 1424721890, "creation_date": 1424720218, "answer_id": 28681922, "question_id": 28681777, "link": "https://stackoverflow.com/questions/28681777/go-how-to-loop-through-files-and-compare-modtime-to-a-date/28681922#28681922", "title": "Go: How to loop through files and compare ModTime to a date?", "body": "<p>The return from <code>ioutil.ReadDir</code> is <code>([]os.FileInfo, error)</code>.  You would simply iterate the <code>[]os.FileInfo</code> slice and inspect the <code>ModTime()</code> of each.  <code>ModTime()</code> returns a <code>time.Time</code> so you can compare in any way you see fit.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"time\"\n)\n\nvar cutoff = 1 * time.Hour\n\nfunc main() {\n    fileInfo, err := ioutil.ReadDir(\"/tmp\")\n    if err != nil {\n        log.Fatal(err.Error())\n    }\n    now := time.Now()\n    for _, info := range fileInfo {\n        if diff := now.Sub(info.ModTime()); diff &gt; cutoff {\n            fmt.Printf(\"Deleting %s which is %s old\\n\", info.Name(), diff)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 3995620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896d279fc77a060bf787e8c6c90542d?s=128&d=identicon&r=PG&f=1", "display_name": "Alfonso", "link": "https://stackoverflow.com/users/3995620/alfonso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2718, "favorite_count": 2, "accepted_answer_id": 28681922, "answer_count": 1, "score": 1, "last_activity_date": 1424721890, "creation_date": 1424719739, "question_id": 28681777, "link": "https://stackoverflow.com/questions/28681777/go-how-to-loop-through-files-and-compare-modtime-to-a-date", "title": "Go: How to loop through files and compare ModTime to a date?", "body": "<p>I'm trying to loop through files in a directory and compare their ModTime against a certain date in order to delete older files.</p>\n\n<p>I'm using ioutil.ReadDir() to get the files but I'm stuck with how to retrieve the ModTime of each file.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "tmux"], "answers": [{"comments": [{"owner": {"reputation": 1770, "user_id": 2097966, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/oIqx1.jpg?s=128&g=1", "display_name": "andy4thehuynh", "link": "https://stackoverflow.com/users/2097966/andy4thehuynh"}, "edited": false, "score": 0, "creation_date": 1425339775, "post_id": 28821229, "comment_id": 45914780, "body": "DUDE! Thank you. Why do I need and Stdin and and Stdout? I thought it was simple as executing the command <code>tmux</code>"}], "tags": [], "owner": {"reputation": 389, "user_id": 3385070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pU0nE.jpg?s=128&g=1", "display_name": "tez", "link": "https://stackoverflow.com/users/3385070/tez"}, "is_accepted": true, "score": 2, "last_activity_date": 1425338196, "creation_date": 1425338196, "answer_id": 28821229, "question_id": 28681117, "link": "https://stackoverflow.com/questions/28681117/execute-tmux-with-golang-exec/28821229#28821229", "title": "Execute Tmux with Golang Exec", "body": "<p>You need to connect <strong>tmux</strong> to your terminal. Try to add these lines after <strong>cmd</strong> initialization:</p>\n\n<pre><code>    cmd.Stdin = os.Stdin\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n</code></pre>\n\n<p><strong>UPDATE</strong>: link to the <a href=\"http://play.golang.org/p/MRExdJsmYg\" rel=\"nofollow\">playground</a></p>\n"}], "owner": {"reputation": 1770, "user_id": 2097966, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/oIqx1.jpg?s=128&g=1", "display_name": "andy4thehuynh", "link": "https://stackoverflow.com/users/2097966/andy4thehuynh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "accepted_answer_id": 28821229, "answer_count": 1, "score": 1, "last_activity_date": 1425338196, "creation_date": 1424717370, "question_id": 28681117, "link": "https://stackoverflow.com/questions/28681117/execute-tmux-with-golang-exec", "title": "Execute Tmux with Golang Exec", "body": "<p>I want to execute a tmux session using Golang. I'm able to compile and get an exit status 1.</p>\n\n<pre><code>cmd := exec.Command(\"tmux\", \"new\", \"-s\", \"foo\")\nerr := cmd.Run()\nif err != nil {\n  log.Fatal(err)\n}\n</code></pre>\n\n<p>I want to start a session. At the very least, I want to get a more tangible error. Any docs to refer me to? I couldn't find much on the Tmux manual pages. I think I'm missing a command. </p>\n"}, {"tags": ["sockets", "http", "go", "lang"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 3284667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c29f95ccace2f22a5566c6b827c96d8?s=128&d=identicon&r=PG&f=1", "display_name": "user3284667", "link": "https://stackoverflow.com/users/3284667/user3284667"}, "edited": false, "score": 0, "creation_date": 1424826812, "post_id": 28679486, "comment_id": 45707865, "body": "Thank you very much @zmb Your answer was perfect and lead me right to solving the problem. Althought i had to changed http.DefaultTransport.Dial to http.DefaultTransport.(*http.Transport).Dial"}], "tags": [], "owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "is_accepted": true, "score": 2, "last_activity_date": 1424958897, "last_edit_date": 1424958897, "creation_date": 1424711933, "answer_id": 28679486, "question_id": 28677286, "link": "https://stackoverflow.com/questions/28677286/google-go-lang-getting-socket-id-fd-of-net-http-to-use-with-syscall-bind/28679486#28679486", "title": "Google Go Lang - Getting socket id/fd of net/http to use with syscall.Bind", "body": "<blockquote>\n  <p>I'm trying to get the socket id/fd of a net/http request</p>\n</blockquote>\n\n<p>Neither <code>http.Request</code> or <code>http.Client</code> have a socket for you to get.</p>\n\n<p>You can customize how an <code>http.Client</code> creates TCP connections by modifying it's <a href=\"http://golang.org/pkg/net/http/#Transport\" rel=\"nofollow\">Transport</a>.  See the <code>Dial</code> and <code>DialTLS</code> functions.</p>\n\n<p>From the docs:</p>\n\n<blockquote>\n  <p>Dial specifies the dial function for creating unencrypted TCP connections.  If Dial is nil, net.Dial is used.</p>\n</blockquote>\n\n<p>You may be interested in <a href=\"https://stackoverflow.com/questions/27410764/dial-with-a-specific-address-interface-golang\">this question</a>, which asks how to dial using a specific interface.</p>\n\n<p>You could set up the default transport do something like this:</p>\n\n<pre><code>http.DefaultTransport.(*http.Transport).Dial = func(network, addr string) (net.Conn, error) {\n    d := net.Dialer{LocalAddr: /* your addr here */}\n    return d.Dial(network, addr) \n}\n</code></pre>\n\n<p>If you're using TLS, you'll want to do something similar for <code>http.DefaultTransport.DialTLS</code>.</p>\n"}], "owner": {"reputation": 61, "user_id": 3284667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c29f95ccace2f22a5566c6b827c96d8?s=128&d=identicon&r=PG&f=1", "display_name": "user3284667", "link": "https://stackoverflow.com/users/3284667/user3284667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2078, "favorite_count": 1, "accepted_answer_id": 28679486, "answer_count": 1, "score": 1, "last_activity_date": 1424958897, "creation_date": 1424705477, "question_id": 28677286, "link": "https://stackoverflow.com/questions/28677286/google-go-lang-getting-socket-id-fd-of-net-http-to-use-with-syscall-bind", "title": "Google Go Lang - Getting socket id/fd of net/http to use with syscall.Bind", "body": "<p>I'm trying to get the socket id/fd of a net/http request so that i can use it with syscall.Bind() to bind the socket to one of my many public outgoing IPV4 addresses.</p>\n\n<p>I want to be able to select which IP address is used for the outgoing request. This is for Windows. </p>\n\n<p>Any help is greatly appreciated.</p>\n\n<p>Below is some code which is for linux, but i need to get the http.Client's socket fd and not net.Conn. </p>\n\n<pre><code>func bindToIf(conn net.Conn, interfaceName string) {\n    ptrVal := reflect.ValueOf(conn)\n    val := reflect.Indirect(ptrVal)\n    //next line will get you the net.netFD\n    fdmember := val.FieldByName(\"fd\")\n    val1 := reflect.Indirect(fdmember)                                   \n    netFdPtr := val1.FieldByName(\"sysfd\")                                           \n    fd := int(netFdPtr.Int())\n    //fd now has the actual fd for the socket\n    err := syscall.SetsockoptString(fd, syscall.SOL_SOCKET,\n                syscall.SO_BINDTODEVICE, interfaceName)\n    if err != nil {\n        log.Fatal(err)\n    }\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["web-applications", "go", "middleware"], "answers": [{"tags": [], "owner": {"reputation": 17526, "user_id": 711902, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/36a9e6931ec4828c293156c50ac339ec?s=128&d=identicon&r=PG", "display_name": "Trevor Dixon", "link": "https://stackoverflow.com/users/711902/trevor-dixon"}, "is_accepted": false, "score": 1, "last_activity_date": 1424714288, "last_edit_date": 1424714288, "creation_date": 1424713718, "answer_id": 28680047, "question_id": 28676536, "link": "https://stackoverflow.com/questions/28676536/middleware-not-getting-called-by-alice/28680047#28680047", "title": "Middleware Not Getting Called by `alice`", "body": "<p>Your middleware handlers need to call the next handler when ready. Untested example:</p>\n\n<pre><code>func S1(h http.Handler) http.Handler {\n    return &amp;H1{next: h}\n}\n\ntype H1 struct{\n    next http.Handler\n}\n\nfunc (h *H1) ServeHTTP(rw http.ResponseWriter, req *http.Request) {\n    log.Println(\"H1\", time.Now())\n    h.next.ServeHTTP(rw, req)\n}\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>func S1(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(rw http.ResponseWriter, req *http.Request) {\n        log.Println(\"H1\", time.Now())\n        next(rw, req)\n    })\n}\n</code></pre>\n\n<p>Look at <a href=\"http://golang.org/src/net/http/server.go?s=37638:37688#L1280\" rel=\"nofollow\">http://golang.org/src/net/http/server.go?s=37638:37688#L1280</a> for another example of middleware.</p>\n"}, {"tags": [], "owner": {"reputation": 519, "user_id": 564172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e126aff2b58607e09a1c0d363a8d7da?s=128&d=identicon&r=PG", "display_name": "Adam Presley", "link": "https://stackoverflow.com/users/564172/adam-presley"}, "is_accepted": false, "score": 0, "last_activity_date": 1424726822, "creation_date": 1424726822, "answer_id": 28683767, "question_id": 28676536, "link": "https://stackoverflow.com/questions/28676536/middleware-not-getting-called-by-alice/28683767#28683767", "title": "Middleware Not Getting Called by `alice`", "body": "<p>Each middleware is passed an <code>http.Handler</code> structure that you execute. This allows each middleware to not know the order of handlers, and they only concern themselves with simply executing the next one in the chain. Order is defined when you initiate Alice. See:</p>\n\n<ul>\n<li><a href=\"http://adampresley.com/2015/02/08/using-a-middleware-in-your-go-web-applications.html\" rel=\"nofollow\">http://adampresley.com/2015/02/08/using-a-middleware-in-your-go-web-applications.html</a></li>\n<li><a href=\"https://justinas.org/alice-painless-middleware-chaining-for-go/\" rel=\"nofollow\">https://justinas.org/alice-painless-middleware-chaining-for-go/</a></li>\n</ul>\n"}], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1425179411, "creation_date": 1424703312, "question_id": 28676536, "link": "https://stackoverflow.com/questions/28676536/middleware-not-getting-called-by-alice", "title": "Middleware Not Getting Called by `alice`", "body": "<p>Why only <code>ServeHTTP</code> method of <code>H1</code> is getting called here and those of <code>H2</code> and <code>H3</code> seem to be ignored?</p>\n\n<p><a href=\"https://github.com/justinas/alice\" rel=\"nofollow\">alice</a> seems to be a nice middleware chaining and here I've tried to use it with <a href=\"https://github.com/julienschmidt/httprouter\" rel=\"nofollow\">httprouter</a>, but only the outer/last middleware is getting called:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/julienschmidt/httprouter\"\n    \"github.com/justinas/alice\"\n    \"net/http\"\n\n    \"log\"\n    \"time\"\n)\n\nfunc main() {\n    fmt.Println(\"started \", time.Now())\n\n    c := alice.New(S1, S2, S3).Then(nil)\n\n    router := httprouter.New()\n    router.Handler(\"GET\", \"/app\", c)\n\n    http.ListenAndServe(\":27007\", router)\n}\n\nfunc S1(h http.Handler) http.Handler {\n    var x H1\n    return &amp;x\n}\n\nfunc S2(h http.Handler) http.Handler {\n    var x H2\n    return &amp;x\n}\n\nfunc S3(h http.Handler) http.Handler {\n    var x H3\n    return &amp;x\n}\n\ntype H1 struct{}\n\nfunc (h *H1) ServeHTTP(rw http.ResponseWriter, req *http.Request) {\n    log.Println(\"H1\", time.Now())\n}\n\ntype H2 struct{}\n\nfunc (h *H2) ServeHTTP(rw http.ResponseWriter, req *http.Request) {\n    log.Println(\"H2\")\n}\n\ntype H3 struct{}\n\nfunc (h *H3) ServeHTTP(rw http.ResponseWriter, req *http.Request) {\n    log.Println(\"H3\")\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1424700995, "post_id": 28675517, "comment_id": 45644774, "body": "I&#39;d use <a href=\"http://golang.org/pkg/regexp/#MustCompile\" rel=\"nofollow noreferrer\"><code>regexp.MustCompile</code></a> instead, that way regexp errors are caught early on."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 4, "last_activity_date": 1424700537, "last_edit_date": 1424700537, "creation_date": 1424700125, "answer_id": 28675517, "question_id": 28675389, "link": "https://stackoverflow.com/questions/28675389/go-regexp-match-three-asterisks/28675517#28675517", "title": "Go regexp: match three asterisks", "body": "<p>Try escaping your '<code>*</code>' (since '<code>*</code>' is a special character used for repetition in the <a href=\"https://code.google.com/p/re2/wiki/Syntax\" rel=\"nofollow\">re2 syntax</a>)</p>\n\n<pre><code>r, err := regexp.Compile(`\\* \\* \\*`)\n// and yes, always check the error\n// or at least use regexp.MustCompile() if you want to fail fast\n</code></pre>\n\n<p>Note the use of back quotes `` for the <a href=\"http://golang.org/ref/spec#String_literals\" rel=\"nofollow\">string literal</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": false, "score": 5, "last_activity_date": 1424700467, "creation_date": 1424700467, "answer_id": 28675628, "question_id": 28675389, "link": "https://stackoverflow.com/questions/28675389/go-regexp-match-three-asterisks/28675628#28675628", "title": "Go regexp: match three asterisks", "body": "<p>You are not checking errors.</p>\n\n<p><code>regexp.Compile</code> gives you two results:</p>\n\n<ol>\n<li>the compiled pattern (or <code>nil</code>)</li>\n<li>the error while compiling the pattern (or <code>nil</code>)</li>\n</ol>\n\n<p>You are ignoring the error and accessing the <code>nil</code> result. Observe (<a href=\"http://play.golang.org/p/omEDCWZCY5\" rel=\"noreferrer\">on play</a>):</p>\n\n<pre><code>r, err := regexp.Compile(\"* * *\")\n\nfmt.Println(\"r:\", r)\nfmt.Println(\"err:\", err)\n</code></pre>\n\n<p>Running this code will show you that, indeed there is an error. The error is:</p>\n\n<blockquote>\n  <p>error parsing regexp: missing argument to repetition operator: <code>*</code></p>\n</blockquote>\n\n<p>So yes, you are right, you have to escape the repetition operator <code>*</code>. You tried the following:</p>\n\n<pre><code>r, err := regexp.Compile(\"\\* \\* \\*\")\n</code></pre>\n\n<p>And consequently you got the following error from the compiler:</p>\n\n<blockquote>\n  <p>unknown escape sequence: *</p>\n</blockquote>\n\n<p>Since there are a number of escape sequences like <code>\\n</code> or <code>\\r</code> for special characters that you do not have on your keyboard but want to have in strings, the compiler tries to insert these characters. <code>\\*</code> is not a valid escape sequence and thus the compiler fails to do the replacement. What you want to do is to escape the escape sequence so that the regexp parser can do its thing.</p>\n\n<p>So, the correct code is:</p>\n\n<pre><code>r, err := regexp.Compile(\"\\\\* \\\\* \\\\*\")\n</code></pre>\n\n<p>The simplest way of dealing with these kind of quirks is using the raw string literals (\"``\") instead of normal quotes:</p>\n\n<pre><code>r, err := regexp.Compile(`\\* \\* \\*`)\n</code></pre>\n\n<p>These raw strings ignore escape sequences altogether. </p>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 4, "last_activity_date": 1424700904, "creation_date": 1424700904, "answer_id": 28675780, "question_id": 28675389, "link": "https://stackoverflow.com/questions/28675389/go-regexp-match-three-asterisks/28675780#28675780", "title": "Go regexp: match three asterisks", "body": "<p>Adding to @VonC's answer, regexp aren't always the answer and are generally slower than using <code>strings.*</code>.</p>\n\n<p>For a complex expression, sure regexp is awesome, however if you just want to match a string and replace it then, <a href=\"http://golang.org/pkg/strings/#Replacer\" rel=\"nofollow\"><code>strings.Replacer</code></a> is the way to go:</p>\n\n<pre><code>var asterisksReplacer = strings.NewReplacer(`* * *`, `&lt;hr&gt;`)\n\nfunc main() {\n    fmt.Println(asterisksReplacer.Replace(`xxx * * * yyy *-*-* zzz* * *`))\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/tlTPa_pOSo\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3411, "favorite_count": 2, "accepted_answer_id": 28675780, "answer_count": 3, "score": 4, "last_activity_date": 1424700904, "creation_date": 1424699717, "last_edit_date": 1424700166, "question_id": 28675389, "link": "https://stackoverflow.com/questions/28675389/go-regexp-match-three-asterisks", "title": "Go regexp: match three asterisks", "body": "<p>So I did this:</p>\n\n<pre><code>r, _ := regexp.Compile(\"* * *\")\nr2 := r.ReplaceAll(b, []byte(\"&lt;hr&gt;\"))\n</code></pre>\n\n<p>and got:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>So I figured I had to escape them:</p>\n\n<pre><code>r, _ := regexp.Compile(\"\\* \\* \\*\")\n</code></pre>\n\n<p>But got <code>unknown escape secuence</code></p>\n\n<p>I'm a Go Beginner. What am I doing wrong?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 1393813, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bb25fba7d94af8f3aa3e9c3bba846856?s=128&d=identicon&r=PG", "display_name": "sinmetal", "link": "https://stackoverflow.com/users/1393813/sinmetal"}, "edited": false, "score": 0, "creation_date": 1424938700, "post_id": 28722077, "comment_id": 45758879, "body": "Thank you. It is a pity that appengine/file package does not work , but you may want to consider using the cloud/storage package."}], "tags": [], "owner": {"reputation": 667, "user_id": 2065479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbdc3e3126116c2f2349b7bee1619630?s=128&d=identicon&r=PG", "display_name": "Layo", "link": "https://stackoverflow.com/users/2065479/layo"}, "is_accepted": true, "score": 0, "last_activity_date": 1424875781, "creation_date": 1424875781, "answer_id": 28722077, "question_id": 28675144, "link": "https://stackoverflow.com/questions/28675144/value-to-be-passed-to-the-filename-of-appengine-file-delete-is/28722077#28722077", "title": "value to be passed to the fileName of appengine/file.Delete () is?", "body": "<p>I'm not an expert on Go but to work with Cloud Storage you need the Google Cloud Storage Go Client Library as indicated here [1].</p>\n\n<p>Take a look at this sample code [2], more specifically to the deleteFiles() fuction. You can see that the function to the delete files is DeleteObject [3].</p>\n\n<p>[1] <a href=\"https://cloud.google.com/appengine/docs/go/storage#google_cloud_storage\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/storage#google_cloud_storage</a></p>\n\n<p>[2] <a href=\"https://cloud.google.com/appengine/docs/go/googlecloudstorageclient/getstarted\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/googlecloudstorageclient/getstarted</a></p>\n\n<p>[3] <a href=\"http://godoc.org/google.golang.org/cloud/storage#DeleteObject\" rel=\"nofollow\">http://godoc.org/google.golang.org/cloud/storage#DeleteObject</a></p>\n"}], "owner": {"reputation": 183, "user_id": 1393813, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bb25fba7d94af8f3aa3e9c3bba846856?s=128&d=identicon&r=PG", "display_name": "sinmetal", "link": "https://stackoverflow.com/users/1393813/sinmetal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 28722077, "answer_count": 1, "score": 0, "last_activity_date": 1424875781, "creation_date": 1424698938, "last_edit_date": 1424750445, "question_id": 28675144, "link": "https://stackoverflow.com/questions/28675144/value-to-be-passed-to-the-filename-of-appengine-file-delete-is", "title": "value to be passed to the fileName of appengine/file.Delete () is?", "body": "<p>I want to know is fileName to pass when you delete a file of gcs from gae/go.</p>\n\n<p>Although passed \"/gs/{bucketname}/{filename}\", error message \"RPC error UNKNOWN_ERROR:\" is returned</p>\n\n<pre><code>package main\n\nimport (\n    \"appengine\"\n    \"appengine/file\"\n\n    \"net/http\"\n)\n\nfunc handle(w http.ResponseWriter, r *http.Request) {\n    c := appengine.NewContext(r)\n\n    file.Delete(c, \"/gs/{bucketname}/{filename}\")\n}\n</code></pre>\n"}, {"tags": ["multithreading", "go", "goroutine"], "comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 1, "creation_date": 1424698917, "post_id": 28674897, "comment_id": 45643428, "body": "I think that the problem here is that the new goroutine is not yet created (so it cannot be scheluded) when you enter for{} . The scheduler can only work then a goroutine is blocked or calls another function, so in a closed loop the scheduler cannot schedule. Add a time.Sleep(time.Millisecond) before the for{} and it will work."}, {"owner": {"reputation": 661, "user_id": 666533, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c3570b1ba221eec61897cf4b7d0b1acf?s=128&d=identicon&r=PG", "display_name": "Alexey Kutuzov", "link": "https://stackoverflow.com/users/666533/alexey-kutuzov"}, "reply_to_user": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 1, "creation_date": 1424699304, "post_id": 28674897, "comment_id": 45643659, "body": "@siritinga yes, it helps. Thank you. Please, make an answer so I can accept it."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1424703162, "post_id": 28675372, "comment_id": 45646218, "body": "Better than <code>time.Sleep</code> would be <a href=\"https://golang.org/pkg/runtime/#Gosched\" rel=\"nofollow noreferrer\"><code>runtime.Gosched</code></a>."}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1424703456, "post_id": 28675372, "comment_id": 45646403, "body": "I tried that, Dave, but it seems that in about 10% of the cases the scheduler will run main again before the goroutine is created (tested on Go1.4.2 and Raspberry Pi). Of course the best solution would be to use channels or WaitGroup to signal the main goroutine that the new one is alive."}], "tags": [], "owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "is_accepted": true, "score": 3, "last_activity_date": 1424700383, "last_edit_date": 1424700383, "creation_date": 1424699660, "answer_id": 28675372, "question_id": 28674897, "link": "https://stackoverflow.com/questions/28674897/go-ignores-gomaxprocs/28675372#28675372", "title": "Go ignores GOMAXPROCS", "body": "<p>The problem is that the new goroutine is not yet created (so it cannot be scheluded) when you enter <code>for{}</code>. The scheduler can only work then a goroutine is blocked or calls another function, so in a closed loop the scheduler cannot schedule. </p>\n\n<p>Add a time.Sleep(time.Millisecond) before the <code>for{}</code> and it will work.</p>\n\n<p>However, I don't know if you are doing this just for fun, but if you want to wait forever (or until the other gorounties are dead-locked or die) while the goroutines work, it is much better to use <code>select{}</code> that will block without wasting CPU cycles.</p>\n"}], "owner": {"reputation": 661, "user_id": 666533, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c3570b1ba221eec61897cf4b7d0b1acf?s=128&d=identicon&r=PG", "display_name": "Alexey Kutuzov", "link": "https://stackoverflow.com/users/666533/alexey-kutuzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 28675372, "answer_count": 1, "score": 0, "last_activity_date": 1424700383, "creation_date": 1424698120, "question_id": 28674897, "link": "https://stackoverflow.com/questions/28674897/go-ignores-gomaxprocs", "title": "Go ignores GOMAXPROCS", "body": "<p>I'm trying to run a goroutine (go version go1.4.1 darwin/amd64) simultaneously with endless loop in main thread and I can't make it works. If I understood correctly go should schedule a goroutine to other threads if I specify GOMAXPROCS but it won't. Even if I write explicitly <code>LockOSThread()</code> in main I still can see no output. How to make go to run goroutine in separate os thread?</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"time\"\n    \"runtime\"\n)\n\nfunc main() {\n    runtime.GOMAXPROCS(runtime.NumCPU() * 8)\n\n    go func() {\n        for {\n            time.Sleep(1 * time.Second)\n            fmt.Println(\"From routine\")\n        }\n    }()\n\n    for {}\n}\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "edited": false, "score": 1, "creation_date": 1424707735, "post_id": 28674752, "comment_id": 45649134, "body": "Thanks for the detailed explanations.  As I am very new to Go, I didn&#39;t realize (until you pointed it out) that <code>:=</code> was actually redeclaring <code>$prevDate</code>.  Is there a way to modify the value of <code>$prevDate</code> within the template itself that is declared outside of the range loop?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "edited": false, "score": 2, "creation_date": 1424711351, "post_id": 28674752, "comment_id": 45651560, "body": "@DelPutnam No, you can&#39;t modify template variables, you can only redeclare them, which is fine in many cases (you can still refer to it by the same name), but you must know that all (re)declarations are <i>scoped</i>, they are in effect from the point of (re)declaration until the end of the current block. The philosophy is that <i>complex</i> things shouldn&#39;t be part of the template but should be implemented in Go (and accessed from or passed to the templates). Yes, you could argue that changing the value of a variable isn&#39;t complex but it doesn&#39;t change the fact that you can&#39;t modify them."}, {"owner": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "edited": false, "score": 0, "creation_date": 1424712658, "post_id": 28674752, "comment_id": 45652333, "body": "That makes sense.  Thank you again for the great explanation."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 12, "last_activity_date": 1534956854, "last_edit_date": 1534956854, "creation_date": 1424697581, "answer_id": 28674752, "question_id": 28674199, "link": "https://stackoverflow.com/questions/28674199/in-a-go-template-range-loop-are-variables-declared-outside-the-loop-reset-on-ea/28674752#28674752", "title": "In a Go template range loop, are variables declared outside the loop reset on each iteration?", "body": "<p><strong>Note:</strong> <a href=\"https://tip.golang.org/doc/go1.11#text/template\" rel=\"noreferrer\">Go 1.11 will support modifying template variables via assignment</a>. This will be valid code:</p>\n\n<pre><code>{{ $v := \"init\" }}\n{{ if true }}\n  {{ $v = \"changed\" }}\n{{ end }}\nv: {{ $v }} {{/* \"changed\" */}}\n</code></pre>\n\n<p>Original answer pre-dating Go 1.11 follows:</p>\n\n<hr>\n\n<p>Variables are not reset. Basically what happens is that you redeclare the <code>$prevDate</code> variable inside the loop. But it is only in scope after the redeclaration and before the closing <code>{{end}}</code> tag of the <code>{{range}}</code>. So when the next iteraiton of the loop comes, you only see the \"outer\" variable which you haven't changed (because you created a new).</p>\n\n<p>You can't change the values of the template variables you create.</p>\n\n<p>What you can do is for example use the following <code>range</code> form:</p>\n\n<pre><code>{{ range $index, $post := .Posts }}\n</code></pre>\n\n<p>And...</p>\n\n<h2>Solution #1: with a registered Function</h2>\n\n<p>And you can register a function for the template (see <a href=\"http://golang.org/pkg/text/template/#Template.Funcs\" rel=\"noreferrer\"><code>template.Funcs()</code></a>) to which you can pass the <code>$index</code> and it would return the date field of the previous element (at <code>$index -1</code>).</p>\n\n<p>It would look something like this:</p>\n\n<pre><code>func PrevDate(i int) string {\n    if i == 0 {\n        return \"\"\n    }\n    return posts[i-1].Date\n}\n\n// Registering it:\nvar yourTempl = template.Must(template.New(\"\").\n    Funcs(map[string]interface{}{\"PrevDate\": PrevDate}).\n    Parse(yourStringTemplate))\n</code></pre>\n\n<p>And from your template you can call it like:</p>\n\n<pre><code>{{range $index, $post := .Posts}}\n    {{$prevDate := PrevDate $index}}\n{{end}}\n</code></pre>\n\n<h2>Solution #2: with a Method of Posts</h2>\n\n<p>This solution is analog but is even simpler: add a method to your <code>Posts</code> and you can call it directly. No need to register a function.</p>\n\n<p>For example:</p>\n\n<pre><code>type Post struct {\n    // Your Post type\n    Date string\n}\n\ntype Posts []Post\n\nfunc (p *Posts) PrevDate(i int) string {\n    if i == 0 {\n        return \"\"\n    }\n    return (*p)[i-1].Date\n}\n</code></pre>\n\n<p>And from your template you can call it like:</p>\n\n<pre><code>{{range $index, $post := .Posts}}\n    {{$prevDate := $.Posts.PrevDate $index}}\n{{end}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1513636996, "last_edit_date": 1513636996, "creation_date": 1513561114, "answer_id": 47861112, "question_id": 28674199, "link": "https://stackoverflow.com/questions/28674199/in-a-go-template-range-loop-are-variables-declared-outside-the-loop-reset-on-ea/47861112#47861112", "title": "In a Go template range loop, are variables declared outside the loop reset on each iteration?", "body": "<p>Go templates are not designed to support complex logic. There's the Go programming language for that. Templates have limitations as a consequence of this philosophy. One limitation is that template variables cannot be changed.</p>\n\n<p>One way to handle this limitation is to structure the data in Go to match the structure of output. Create a type to hold posts for a date and render a slice of these types. The template simply ranges through PostsForDate and Posts.</p>\n\n<pre><code>type PostsForDate struct {\n    Date time.Time\n    Posts []*Post\n}\n\nvar Dates []PostsForDate\n\n{{range .Dates}}\n    &lt;div class=\"post-date\"&gt;Posts dated: {{.Date}}&lt;/div&gt;\n    {{range .Posts}}\n       &lt;div class=\"post-content\"&gt;{{.Content}}&lt;/div&gt;\n    {{end}}\n{{end}}\n</code></pre>\n\n<p>A simpler option (that goes against the design philosophy to some degree) is to create a type in Go to record a current value and report changes to that value.</p>\n\n<pre><code>type change struct {\n    current interface{}\n}\n\nfunc (c *change) Changed(next interface{}) bool {\n    result := c.current != next\n    c.current = next\n    return result\n}\n\nfunc newChange() *change {\n    return &amp;change{&amp;struct{ int }{}} // initial value ensures that first change is fired.\n}\n</code></pre>\n\n<p>and hook it into a template using a <a href=\"https://godoc.org/text/template#Template.Funcs\" rel=\"nofollow noreferrer\">template function</a>:</p>\n\n<pre><code>t := template.Must(template.New(\"\").Funcs(template.FuncMap{\"change\": newChange}).Parse(` some template `))\n</code></pre>\n\n<p>Use it in a template like this:</p>\n\n<pre><code>{{ $i := change }}\n{{ range $post := .Posts }}\n    {{ $i.Change $post.Date }}\n        &lt;div class=\"post-date\"&gt;Posts dated: {{ $post.Date }}&lt;/div&gt;\n    {{ end }}\n    &lt;div class=\"post-content\"&gt;{{ $post.Content }}&lt;/div&gt;\n{{ end }}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/aRPGrn-ej0\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>If the post <code>Date</code> field is a <code>time.Time</code> and the posts have different times within a day, then the above does not work as desired. A workaround for this is to check for changes in the rendered date (for example <code>$post.Date.Format \"2006-01-02\"</code>). Add the following method to simplify this:</p>\n\n<pre><code>func (c *change) ChangedValue(next interface{}) interface{} {\n    if c.current != next {\n        c.current = next\n        return next\n    }\n    return nil\n}\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>{{ $i := change }}\n{{ range $post := .Posts }}\n    {{with $i.ChangedValue ($post.Date.Format \"2006-01-02\")}}\n        &lt;div class=\"post-date\"&gt;Posts dated: {{.}}&lt;/div&gt;\n    {{ end }}\n    &lt;div class=\"post-content\"&gt;{{ $post.Content }}&lt;/div&gt;\n{{ end }}\n</code></pre>\n\n<p>This only works when the values are guaranteed to be considered true by the template package.</p>\n\n<p>This solution does not require parsing the template on every use (as in solution #1 in the other answer) and it applies to arbitrary slice types (unlike both solutions in the other answer). </p>\n"}], "owner": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2782, "favorite_count": 1, "accepted_answer_id": 28674752, "answer_count": 2, "score": 6, "last_activity_date": 1534956854, "creation_date": 1424695708, "question_id": 28674199, "link": "https://stackoverflow.com/questions/28674199/in-a-go-template-range-loop-are-variables-declared-outside-the-loop-reset-on-ea", "title": "In a Go template range loop, are variables declared outside the loop reset on each iteration?", "body": "<p>I'm trying to use a variable declared outside a Go template range loop to see if the previous post occurred on the same day as the current post. Here's a simplified example.</p>\n\n<p>Where <code>.Posts</code> is an array of post structs that each have a <code>.Content</code> and a <code>.Date</code>.</p>\n\n<pre><code>{{ $prevDate := \"\" }}\n{{ range $post := .Posts }}\n    {{ if ne $prevDate $post.Date }}\n        &lt;div class=\"post-date\"&gt;Posts dated: {{ $post.Date }}&lt;/div&gt;\n    {{ end }}\n    &lt;div class=\"post-content\"&gt;{{ $post.Content }}&lt;/div&gt;\n    {{ $prevDate := $post.Date }}\n{{ end }}\n</code></pre>\n\n<p>The problem is that <code>$prevDate</code> seems to be reset to <code>\"\"</code> at the start of each iteration of the loop.</p>\n\n<p>Can anyone help me understand why the value of <code>$prevDate</code> is reset on each iteration and perhaps suggest a way to accomplish what I'm trying to do here?</p>\n"}, {"tags": ["json", "mongodb", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1424692212, "last_edit_date": 1424692212, "creation_date": 1424691282, "answer_id": 28672851, "question_id": 28671786, "link": "https://stackoverflow.com/questions/28671786/how-to-get-nested-value-from-json-array-using-golang-from-mongodb/28672851#28672851", "title": "how to get nested value from json array using golang from mongodb", "body": "<p>The result of a query is a collection of documents. If you store the collection of components in one document, even though you use fields of components in the query, the result will still return the whole document if it matches the filters.</p>\n\n<p>MongoDB supports selecting properties which you want or don't want, but you can't exclude array elements based on their properties.<br>\nNote that MongoDB supports returning only a part of an array (<a href=\"http://docs.mongodb.org/manual/reference/operator/projection/slice/\" rel=\"nofollow\">$slice (projection)</a>) but that is index based and is not really what you want.</p>\n\n<p>You have to manually go through the components of your returned documents (<code>Eligibility</code>) and search for the component you want. Or looking at the content of your document, you should split it to store each component as a separate document and then you can filter them and retrieve them individually.</p>\n"}, {"tags": [], "owner": {"reputation": 723, "user_id": 127878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wf65E.jpg?s=128&g=1", "display_name": "Vitali Kotik", "link": "https://stackoverflow.com/users/127878/vitali-kotik"}, "is_accepted": true, "score": 0, "last_activity_date": 1424691753, "creation_date": 1424691753, "answer_id": 28672995, "question_id": 28671786, "link": "https://stackoverflow.com/questions/28671786/how-to-get-nested-value-from-json-array-using-golang-from-mongodb/28672995#28672995", "title": "how to get nested value from json array using golang from mongodb", "body": "<p>If I get you right you have one record in \"clOfferMaster\" collection and you're trying to fetch data from nested collection \"Eligibility\". That's probably not a typical way to work with data.</p>\n\n<p>What if you restructure your data as follows:</p>\n\n<pre><code>[ \n    {\n        \"ComponentId\" : \"SessionDayCheck\",\n        \"ConfigData\" : [ \n            \"WED\"\n        ]\n    }, \n    {\n        \"ComponentId\" : \"TransDayCheck\",\n        \"ConfigData\" : [ \n            \"WED\", \n            \"THU\"\n        ]\n    }, \n    {\n        \"ComponentId\" : \"SessionTransCheck\",\n        \"ConfigData\" : \"\"\n    }\n]\n</code></pre>\n\n<p>It that case you can do the following query</p>\n\n<pre><code>c := session.DB(\"offerengine2\").C(\"clOfferMaster\")\n\nvar result struct {\n    ConfigData []string \"ConfigData\"\n}\nerr = c.Find(bson.M{\"ComponentId\": \"SessionDayCheck\"}).One(&amp;result)\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Println(\"Result:\", result)\n// Result: {[WED]} \n</code></pre>\n"}], "owner": {"reputation": 56, "user_id": 2783744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a64a56e60d2baa800f98776a8e49326?s=128&d=identicon&r=PG&f=1", "display_name": "swarup", "link": "https://stackoverflow.com/users/2783744/swarup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 28672995, "answer_count": 2, "score": 0, "last_activity_date": 1424871418, "creation_date": 1424687846, "last_edit_date": 1424871418, "question_id": 28671786, "link": "https://stackoverflow.com/questions/28671786/how-to-get-nested-value-from-json-array-using-golang-from-mongodb", "title": "how to get nested value from json array using golang from mongodb", "body": "<p>I am having the below json</p>\n\n<p>I want to extract the value of particular <code>Data</code> from Requirement array based on <code>Id</code>.\nIf <code>\"Data\" = \"String123\"</code> it should display the \"Data\" as [\"WED\"].</p>\n\n<p>I tried this code</p>\n\n<p>but I am getting all values irrespective of <code>Id</code>.</p>\n"}, {"tags": ["vim", "autocomplete", "go"], "comments": [{"owner": {"reputation": 153428, "user_id": 813602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1844cebf36374d83a83c0e69003cd42?s=128&d=identicon&r=PG", "display_name": "Ingo Karkat", "link": "https://stackoverflow.com/users/813602/ingo-karkat"}, "edited": false, "score": 0, "creation_date": 1424686506, "post_id": 28671272, "comment_id": 45636417, "body": "Did you try the combination <code>&lt;Ctrl-x&gt;&lt;Ctrl-o&gt;</code>? That&#39;s how omni completion (which the plugin uses) is triggered. See <code>:h _i_CTRL-X_CTRL-O</code>."}, {"owner": {"reputation": 4122, "user_id": 1743957, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa0c08c9d80f0702b0eba6398a4ae26d?s=128&d=identicon&r=PG", "display_name": "Sebastien C.", "link": "https://stackoverflow.com/users/1743957/sebastien-c"}, "reply_to_user": {"reputation": 153428, "user_id": 813602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1844cebf36374d83a83c0e69003cd42?s=128&d=identicon&r=PG", "display_name": "Ingo Karkat", "link": "https://stackoverflow.com/users/813602/ingo-karkat"}, "edited": false, "score": 0, "creation_date": 1424686699, "post_id": 28671272, "comment_id": 45636526, "body": "@IngoKarkat I didn&#39;t though I had to use both <code>&lt;C-x&gt;</code> AND THEN <code>&lt;C-o&gt;</code>. I though it was one or the other... What a complicated way. Thanks!"}, {"owner": {"reputation": 153428, "user_id": 813602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1844cebf36374d83a83c0e69003cd42?s=128&d=identicon&r=PG", "display_name": "Ingo Karkat", "link": "https://stackoverflow.com/users/813602/ingo-karkat"}, "edited": false, "score": 0, "creation_date": 1424687207, "post_id": 28671272, "comment_id": 45636803, "body": "You can shorten that with a mapping; see my answer!"}], "answers": [{"tags": [], "owner": {"reputation": 153428, "user_id": 813602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1844cebf36374d83a83c0e69003cd42?s=128&d=identicon&r=PG", "display_name": "Ingo Karkat", "link": "https://stackoverflow.com/users/813602/ingo-karkat"}, "is_accepted": true, "score": 6, "last_activity_date": 1424687184, "creation_date": 1424687184, "answer_id": 28671574, "question_id": 28671272, "link": "https://stackoverflow.com/questions/28671272/vim-go-cant-get-autocompletion/28671574#28671574", "title": "vim-go: Can&#39;t get autocompletion", "body": "<p><em>Omni completion</em> (which the Go plugin offers) is triggered via <code>&lt;C-x&gt;&lt;C-o&gt;</code>, that is Ctrl + X followed by Ctrl-O. The prompt (<code>-- mode ^X (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)</code>) you've described hints at that.</p>\n\n<p>If that is too cumbersome for you, you can define an <em>insert mode mapping</em> to shorten that; here's a (global) example to be put into your <code>~/.vimrc</code>:</p>\n\n<pre><code>:inoremap &lt;C-b&gt; &lt;C-x&gt;&lt;C-o&gt;\n</code></pre>\n\n<p>If you use GVIM, you can also use the IDE-like <code>&lt;C-Space&gt;</code> instead of the example <code>&lt;C-g&gt;</code> trigger.</p>\n"}], "owner": {"reputation": 4122, "user_id": 1743957, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa0c08c9d80f0702b0eba6398a4ae26d?s=128&d=identicon&r=PG", "display_name": "Sebastien C.", "link": "https://stackoverflow.com/users/1743957/sebastien-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1296, "favorite_count": 0, "accepted_answer_id": 28671574, "answer_count": 1, "score": 1, "last_activity_date": 1424687184, "creation_date": 1424686229, "question_id": 28671272, "link": "https://stackoverflow.com/questions/28671272/vim-go-cant-get-autocompletion", "title": "vim-go: Can&#39;t get autocompletion", "body": "<p>I'm trying to use <a href=\"https://github.com/fatih/vim-go\" rel=\"nofollow\"><code>vim-go</code></a>, but I can't get autocompletion to work.</p>\n\n<p>My go environment works well, I succesfully ran <code>:GoInstallBinaries</code>, and I can use any <code>:GoXXX</code> command without errors. But I can't get autocompletion to work.</p>\n\n<ul>\n<li>When I hit <code>&lt;Ctrl-o&gt;</code> after a dot, vim just switches in the status bar between <code>-- INSERTION --</code> and <code>-- (insertion) --</code> modes (what's the difference btw ?) and moves my cursor one character to the left.</li>\n<li>When I hit <code>&lt;Ctrl-x&gt;</code>, It just shows <code>-- mode ^X (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)</code> in the status bar.</li>\n</ul>\n\n<p>Sometimes (rarely) after spamming <code>&lt;Ctrl-o&gt;</code> it shows the <code>vim-go</code> autocompletion tooltip ...</p>\n\n<p><code>vim-go</code> is the only plugin installed, using <code>pathogen</code>.</p>\n"}, {"tags": ["pointers", "go", "memory-management", "atomic"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1424683507, "post_id": 28670232, "comment_id": 45634758, "body": "Seems like a bug to me. I took your code and on Linux it runs just fine. Same on the playground. see this: <a href=\"http://play.golang.org/p/fDFaZPi3nf\" rel=\"nofollow noreferrer\">play.golang.org/p/fDFaZPi3nf</a> does this exact code crash on your Windows machine?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1424683575, "post_id": 28670232, "comment_id": 45634792, "body": "Yes, it should work. Please post more code, e.g. how you create your <code>countHandler</code> variable. Please aim for an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1424683929, "post_id": 28670232, "comment_id": 45634998, "body": "Thanks; I&#39;ve added the code."}], "answers": [{"comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1424683727, "post_id": 28670490, "comment_id": 45634878, "body": "Ooh, nice catch, I missed the x86 part!"}], "tags": [], "owner": {"reputation": 146, "user_id": 4596275, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1adfdf1de93b07d0ab60d90c95ca06c1?s=128&d=identicon&r=PG", "display_name": "user4596275", "link": "https://stackoverflow.com/users/4596275/user4596275"}, "is_accepted": true, "score": 13, "last_activity_date": 1424684165, "last_edit_date": 1424684165, "creation_date": 1424683674, "answer_id": 28670490, "question_id": 28670232, "link": "https://stackoverflow.com/questions/28670232/atomic-addint64-causes-invalid-memory-address-or-nil-pointer-dereference/28670490#28670490", "title": "atomic.AddInt64 Causes invalid memory address or nil pointer dereference", "body": "<p>The fault is caused in the first case by the atomically updated field not being properly <a href=\"http://golang.org/pkg/sync/atomic/#pkg-note-BUG\" rel=\"noreferrer\">aligned</a>.</p>\n\n<blockquote>\n  <p>On both ARM and x86-32, it is the caller's responsibility to arrange for 64-bit alignment of 64-bit words accessed atomically. The first word in a global variable or in an allocated struct or slice can be relied upon to be 64-bit aligned.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1529864150, "creation_date": 1529864150, "answer_id": 51012703, "question_id": 28670232, "link": "https://stackoverflow.com/questions/28670232/atomic-addint64-causes-invalid-memory-address-or-nil-pointer-dereference/51012703#51012703", "title": "atomic.AddInt64 Causes invalid memory address or nil pointer dereference", "body": "<p>Here are a few tricks to solve the problem in case you stumble upon this error:</p>\n\n<p>The easiest way, as explained in OP, is to place all your 64-bit atomic values at the top of the struct:</p>\n\n<pre><code>c := struct {\n    val   int64 // pos 0\n    val2  int64 // pos 8\n    valid bool  // pos 16\n}{val2: 1}\nfmt.Println(atomic.AddInt64(&amp;c.val2, 1))\n</code></pre>\n\n<p>If you, for whatever reason, don't want to place this field at the top, you can always place a <code>_ [4]byte</code> above the 64-bit field to ensure it is correctly padded.</p>\n\n<pre><code>c := struct {\n    val   int64   // pos 0\n    valid bool    // pos 8\n    _     [4]byte // pos 9; compiler adds additional [3]byte at pos 13 for alignment\n    val2  int64   // pos 16, correctly aligned\n}{val2: 1}\nfmt.Println(atomic.AddInt64(&amp;c.val2, 1)) // =&gt; 2\n</code></pre>\n\n<p>Note that this will not work in case the field was already aligned; on the contrary, if it didn't panic before, it will panic now.</p>\n\n<pre><code>c := struct {\n    val   int64   // pos 0\n    _     [4]byte // pos 8; compiler adds no padding\n    val2  int64   // pos 12, not a multiple of 8!\n}{val2: 1}\nfmt.Println(atomic.AddInt64(&amp;c.val2, 1)) // =&gt; runtime error: invalid memory address [...]\n</code></pre>\n\n<p>You can also rely on the behaviour that the first element in slices of 64-bit elements will be correctly aligned:</p>\n\n<pre><code>c := struct {\n    val   int64\n    valid bool\n    val2  []int64\n}{val2: []int64{1}}\nfmt.Println(atomic.AddInt64(&amp;c.val2[0], 1))\n</code></pre>\n\n<p>Note that this won't work for arrays, as their values are stored in the struct directly and not on the heap as it is the case for slice data.</p>\n\n<p>The last trick you can pull off is that of declaring the field in the struct as a pointer to an <code>int64</code>; if the <code>int64</code> it points to is aligned, then it will run smoothly.</p>\n\n<pre><code>c := struct {\n    val   int64\n    valid bool\n    val2  *int64\n}{val2: new(int64)}\nfmt.Println(atomic.AddInt64(c.val2, 1))\n</code></pre>\n\n<p>If you don't want to get your hands dirty with <code>sync/atomic</code>, remember that <a href=\"https://golang.org/pkg/sync/#Mutex\" rel=\"nofollow noreferrer\"><code>sync.Mutex</code></a> is a much cleaner and more understandable solution than dealing with atomics.</p>\n"}], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1145, "favorite_count": 4, "accepted_answer_id": 28670490, "answer_count": 2, "score": 8, "last_activity_date": 1529886303, "creation_date": 1424682799, "last_edit_date": 1529886303, "question_id": 28670232, "link": "https://stackoverflow.com/questions/28670232/atomic-addint64-causes-invalid-memory-address-or-nil-pointer-dereference", "title": "atomic.AddInt64 Causes invalid memory address or nil pointer dereference", "body": "<p>Calling atomic.AddInt64 on field of a struct panics <code>invalid memory address or nil pointer dereference</code>, but not when we re-arrange fields order; why?</p>\n\n<p>Using this type:</p>\n\n<pre><code>type CountHandler struct {\n    c     *RequestContext\n    count int64\n}\n</code></pre>\n\n<p>And calling <code>atomic.AddInt64(&amp;countHandler.count, 1)</code> (field <code>c</code> is nil at this point) panics. But not when we rewrite it as:</p>\n\n<pre><code>type CountHandler struct {\n    count int64\n    c     *RequestContext\n}\n</code></pre>\n\n<p>Error goes away.</p>\n\n<p>I guess it should be so, because Go keeps data in memory in a sequential manner and reaching a <code>nil</code> value breaks this sequence (of bytes); yet I wonder why is that so again because a pointer should have a fixed size <code>nil</code> or other value.</p>\n\n<p>This is Go x86 1.4.2 on Windows &amp; complete error message is:</p>\n\n<pre><code>2015/02/23 12:56:44 http: panic serving [::1]:51886: runtime error: invalid memory address or nil pointer dereference\ngoroutine 5 [running]:\nnet/http.func\u00b7011()\n        c:/go/src/net/http/server.go:1130 +0xa8\nsync/atomic.AddUint64(0x731144, 0x1, 0x0, 0x0, 0x263168)\n        c:/go/src/sync/atomic/asm_386.s:118 +0xc\nmain.(*CountHandler).ServeHTTP(0x731140, 0x263180, 0x122f6380, 0x122f62a0)\n        C:/Workshop/Devox/Workshop-Go/src/geoho/web/app/app.go:62 +0x42\ngithub.com/julienschmidt/httprouter.func\u00b7001(0x263180, 0x122f6380, 0x122f62a0, 0x0, 0x0, 0x0)\n        C:/Workshop/Devox/Workshop-Go/src/github.com/julienschmidt/httprouter/router.go:232 +0x4c\ngithub.com/julienschmidt/httprouter.(*Router).ServeHTTP(0x122d5d20, 0x263180, 0x122f6380, 0x122f62a0)\n        C:/Workshop/Devox/Workshop-Go/src/github.com/julienschmidt/httprouter/router.go:298 +0x141\nnet/http.serverHandler.ServeHTTP(0x122d2280, 0x263180, 0x122f6380, 0x122f62a0)\n        c:/go/src/net/http/server.go:1703 +0x145\nnet/http.(*conn).serve(0x122e01e0)\n        c:/go/src/net/http/server.go:1204 +0x9d8\ncreated by net/http.(*Server).Serve\n        c:/go/src/net/http/server.go:1751 +0x2ce\n</code></pre>\n\n<p>Whole source code is (this code is wrong, I was just about studying <code>alice</code>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/julienschmidt/httprouter\"\n    \"github.com/justinas/alice\"\n    \"net/http\"\n\n    \"os\"\n    \"sync/atomic\"\n)\n\n// play with alice\nfunc main() {\n    c1 := alice.New(Counter, Texter).Then(nil)\n\n    router := httprouter.New()\n    router.Handler(\"GET\", \"/\", c1)\n    router.GET(\"/kill\", kill)\n\n    http.ListenAndServe(\":27007\", router)\n}\n\nfunc kill(rw http.ResponseWriter, rq *http.Request, pl httprouter.Params) {\n    os.Exit(0)\n}\n\nvar ch CountHandler\n\n// constructors:\n\nfunc Counter(h http.Handler) http.Handler {\n    return &amp;ch\n}\n\nfunc Texter(h http.Handler) http.Handler {\n    var t TextHandler\n    switch x := h.(type) {\n    case *CountHandler:\n        t.c = x.c\n        t.text = fmt.Sprintf(\"called so far %d\", atomic.LoadInt64(&amp;x.count))\n    }\n    return &amp;t\n}\n\n// handlers:\n\ntype RequestContext struct {\n    val int\n}\n\ntype CountHandler struct {\n    c     *RequestContext\n    count int64\n}\n\nfunc (c *CountHandler) ServeHTTP(rw http.ResponseWriter, req *http.Request) {\n    atomic.AddInt64(&amp;c.count, 1)\n}\n\ntype TextHandler struct {\n    c    *RequestContext\n    text string\n}\n\nfunc (t *TextHandler) ServeHTTP(rw http.ResponseWriter, req *http.Request) {\n    rw.Write([]byte(t.text))\n}\n</code></pre>\n"}, {"tags": ["go", "cyclic-reference", "gob"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1424655448, "post_id": 28665403, "comment_id": 45626226, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/26889287/use-gob-to-package-recursively-defined-structs\">use gob to package recursively defined structs</a>"}, {"owner": {"reputation": 1357, "user_id": 329076, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e738f27adc36efb2f4a25edc9692eb?s=128&d=identicon&r=PG", "display_name": "Joel", "link": "https://stackoverflow.com/users/329076/joel"}, "reply_to_user": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1424655852, "post_id": 28665403, "comment_id": 45626318, "body": "Looks like a duplicate. Didn&#39;t find that one because I was searching for cyclic issues, not recursive ones."}, {"owner": {"reputation": 2345, "user_id": 2102087, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0382d81dd8afcfa8058df1bdb27fe197?s=128&d=identicon&r=PG", "display_name": "Denis V", "link": "https://stackoverflow.com/users/2102087/denis-v"}, "edited": false, "score": 0, "creation_date": 1600415719, "post_id": 28665403, "comment_id": 113086545, "body": "I know, this is an old question, but still actual, I think. I wrote this library to serialize and deserialize the cyclic data structures: <a href=\"https://github.com/go-extras/tahwil\" rel=\"nofollow noreferrer\">github.com/go-extras/tahwil</a> it can be used together with gob as well."}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 5, "last_activity_date": 1424663115, "last_edit_date": 1424663115, "creation_date": 1424656561, "answer_id": 28665879, "question_id": 28665403, "link": "https://stackoverflow.com/questions/28665403/is-there-a-way-to-serialize-cyclic-data-structures-with-encoding-gob/28665879#28665879", "title": "Is there a way to serialize cyclic data structures with encoding/gob?", "body": "<p>You can't use gob directly, but fear not brave citizen of the world!</p>\n\n<p>You can implement the <a href=\"http://golang.org/pkg/encoding/#BinaryMarshaler\"><code>BinaryMarshaler</code></a>/<a href=\"http://golang.org/pkg/encoding/#BinaryUnmarshaler\"><code>BinaryUnmarshaler</code></a> interfaces on your type as a work around and gob will happily use them instead when it's encoding/decoding your type.</p>\n\n<pre><code>func (p *P) MarshalBinary() (_ []byte, err error) {\n    var buf bytes.Buffer\n    enc := gob.NewEncoder(&amp;buf)\n    enc.Encode(p.Name)\n    if p.Q == nil {\n        return buf.Bytes(), nil\n    }\n    isCyclic := p.Q != nil &amp;&amp; p.Q.P == p\n    enc.Encode(isCyclic)\n    if isCyclic {\n        p.Q.P = nil\n        err = enc.Encode(p.Q)\n        p.Q.P = p\n    } else {\n        err = enc.Encode(p.Q)\n    }\n    //buf.Encode\n    return buf.Bytes(), err\n}\n\nfunc (p *P) UnmarshalBinary(data []byte) (err error) {\n    dec := gob.NewDecoder(bytes.NewReader(data))\n    if err = dec.Decode(&amp;p.Name); err != nil {\n        return\n    }\n    var isCyclic bool\n    if err = dec.Decode(&amp;isCyclic); err != nil {\n        return\n    }\n    err = dec.Decode(&amp;p.Q)\n    if isCyclic {\n        p.Q.P = p\n    }\n    return\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/7zQR_A5LqM\"><kbd>playground</kbd></a></p>\n\n<p><strong>warning</strong> creating a new decoder/encoder every time is extremely inefficient, you might want to look into using <a href=\"http://golang.org/pkg/encoding/binary/\"><code>binary.*</code></a>.</p>\n"}], "owner": {"reputation": 1357, "user_id": 329076, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e738f27adc36efb2f4a25edc9692eb?s=128&d=identicon&r=PG", "display_name": "Joel", "link": "https://stackoverflow.com/users/329076/joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "accepted_answer_id": 28665879, "answer_count": 1, "score": 3, "last_activity_date": 1424663115, "creation_date": 1424652659, "question_id": 28665403, "link": "https://stackoverflow.com/questions/28665403/is-there-a-way-to-serialize-cyclic-data-structures-with-encoding-gob", "title": "Is there a way to serialize cyclic data structures with encoding/gob?", "body": "<p>I'm working on porting a neural network library to Go. I want to be able to save and restore a trained network, so I'm attempting to serialize it directly. The problem is, the network struct contains cycles in its field (Neuron A has a connection to Neuron B, which has a connection to Neuron A). Whenever I try to serialize the entire network with encoding/gob, it fails with a stackoverflow.</p>\n\n<p>Here's a very simple example of code that breaks in the same way:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/gob\"\n    \"fmt\"\n    \"log\"\n)\n\ntype P struct {\n    Name    string\n    Q *Q\n}\n\ntype Q struct {\n    Name string\n    P *P\n}\n\nfunc main() {\n    var network bytes.Buffer        // Stand-in for a network connection\n    enc := gob.NewEncoder(&amp;network) // Will write to network.\n    dec := gob.NewDecoder(&amp;network) // Will read from network.\n\n    p := &amp;P{ \"P\", nil }\n    q := &amp;Q{ \"Q\", p }\n    p.Q = q\n\n    err := enc.Encode(p)\n    if err != nil {\n        log.Fatal(\"encode error:\", err)\n    }\n    // Decode (receive) the value.\n    var p2 *P\n    err = dec.Decode(&amp;p2)\n    if err != nil {\n        log.Fatal(\"decode error:\", err)\n    }\n    fmt.Printf(\"%#v\", p2)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/LrO0VlLnX4\" rel=\"nofollow\">http://play.golang.org/p/LrO0VlLnX4</a></p>\n\n<p>Barring rewriting the entire structure of the library to avoid cycles, is there a straightforward way to get around this problem?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["linux", "go", "cross-compiling", "darwin", "cgo"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1424657044, "post_id": 28665377, "comment_id": 45626580, "body": "I don&#39;t have OSX but it looks like a bad ld version or something. I&#39;d say it&#39;s easier to just fire up a vm (does qemu work on mac?) and do your compiling there."}, {"owner": {"reputation": 12066, "user_id": 96740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8a610127d1108dfe67f673320b5fe5?s=128&d=identicon&r=PG", "display_name": "cpjolicoeur", "link": "https://stackoverflow.com/users/96740/cpjolicoeur"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1424657773, "post_id": 28665377, "comment_id": 45626737, "body": "Yeah, I can native compile via a VM fine, and, of course, that whole process can be automated.  I was just trying to fight through and see if I can just cross-compile it all in one go natively like I can with non-CGO golang programs"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1424658513, "post_id": 28665377, "comment_id": 45626941, "body": "I&#39;d try to see if you can get a newer/different version of clang and ld but maybe someone else will know better."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1424734467, "post_id": 28665377, "comment_id": 45663908, "body": "<code>--build-id</code> is a command line argument recognised by GNU ld (used on Linux), so it looks like you&#39;re using the Mac tool chain here.  You will likely need to install a Linux cross compiler toolchain to get this to work, but I&#39;ve never done this on MacOS myself."}, {"owner": {"reputation": 13422, "user_id": 1246987, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e94c8e7ffd3eddf8a88312c04529f7b9?s=128&d=identicon&r=PG&f=1", "display_name": "bodokaiser", "link": "https://stackoverflow.com/users/1246987/bodokaiser"}, "edited": false, "score": 0, "creation_date": 1432991645, "post_id": 28665377, "comment_id": 49165681, "body": "@cpjolicoeur is a bit late but maybe there are others who I can help. I always get this linker error when using clang on linux (natively) the solution (for me) was to overwrite <code>CC</code> and <code>CXX</code> environment variables to use gcc in this case."}, {"owner": {"reputation": 1720, "user_id": 989659, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84d2d1476d96b093bd0f180412db2460?s=128&d=identicon&r=PG", "display_name": "Srgrn", "link": "https://stackoverflow.com/users/989659/srgrn"}, "edited": false, "score": 0, "creation_date": 1434584512, "post_id": 28665377, "comment_id": 49847073, "body": "<a href=\"https://github.com/karalabe/xgo\" rel=\"nofollow noreferrer\">github.com/karalabe/xgo</a> while this requires containers and docker it is very easy to use"}], "answers": [{"tags": [], "owner": {"reputation": 2749, "user_id": 718981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd2b5c3cd12ceaa6a42cb683d4d75b1?s=128&d=identicon&r=PG", "display_name": "simonmenke", "link": "https://stackoverflow.com/users/718981/simonmenke"}, "is_accepted": false, "score": 1, "last_activity_date": 1439888968, "creation_date": 1439888968, "answer_id": 32068143, "question_id": 28665377, "link": "https://stackoverflow.com/questions/28665377/cross-compile-cgo-app-on-darwin-for-linux/32068143#32068143", "title": "Cross compile CGO app on darwin for linux", "body": "<p>Have a look at <a href=\"https://github.com/inconshreveable/gonative\" rel=\"nofollow\">gonative</a>. this allows you to cross-compile cgo code (as long as you are just using the stdlib).</p>\n\n<p>Another approach would be to compile the linux binary using docker.</p>\n"}], "owner": {"reputation": 12066, "user_id": 96740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8a610127d1108dfe67f673320b5fe5?s=128&d=identicon&r=PG", "display_name": "cpjolicoeur", "link": "https://stackoverflow.com/users/96740/cpjolicoeur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2463, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1439888968, "creation_date": 1424652406, "last_edit_date": 1424653011, "question_id": 28665377, "link": "https://stackoverflow.com/questions/28665377/cross-compile-cgo-app-on-darwin-for-linux", "title": "Cross compile CGO app on darwin for linux", "body": "<p>I'm having issues trying to cross-compile a Go app on OS X to run on linux/amd64.  The app in question is using <a href=\"http://www.vips.ecs.soton.ac.uk/index.php?title=VIPS\" rel=\"nofollow\">libvips</a> via this <a href=\"https://github.com/DAddYE/vips\" rel=\"nofollow\">vips go package</a>.  As such, it is using CGO and needs to be compiled with CGO support.</p>\n\n<p>I'm on Go 1.4 and running the following build command</p>\n\n<p><code>GOOS=linux GOARCH=amd64 CGO_ENABLED=1 go build</code></p>\n\n<p>but end up with a linker error</p>\n\n<p><code>ld: unknown option: --build-id=none\nclang: error: linker command failed with exit code 1 (use -v to see invocation)</code></p>\n\n<p>I'm assuming I probably need to add some kind of <code>-ldflags</code> argument but am not sure.</p>\n\n<p>Is it possible to cross-compile CGO apps in this manner yet, or do I need to do a native-build on the target system to avoid issues and headaches?</p>\n"}, {"tags": ["struct", "go", "visibility", "instance-variables"], "comments": [{"owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "edited": false, "score": 0, "creation_date": 1424650958, "post_id": 28665025, "comment_id": 45625060, "body": "The same way you do in the <code>New</code> function; using the <code>.</code>. Note that your field names start with a lower case letter, which means they are private to the package. You can&#39;t access them directly from another package. For that, make the field names start with an upper case letter."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 3316836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62c829a9b6e2c33350b891e9d4d798b1?s=128&d=identicon&r=PG&f=1", "display_name": "CuriOne", "link": "https://stackoverflow.com/users/3316836/curione"}, "edited": false, "score": 0, "creation_date": 1424702542, "post_id": 28666517, "comment_id": 45645826, "body": "This works as needed. The problem was actually completely unrelated, as I was using <code>go run</code> but I had the program spread out across multiple files, thinking that <code>go run</code> would actually include all the files needed, if I point it to the one with <code>main()</code>. Turns out <code>go build</code> was all that&#39;s needed."}], "tags": [], "owner": {"reputation": 265, "user_id": 1779800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe648807e29dc820a2a71ff7f5c587a3?s=128&d=identicon&r=PG", "display_name": "Craig Nicholson", "link": "https://stackoverflow.com/users/1779800/craig-nicholson"}, "is_accepted": true, "score": 1, "last_activity_date": 1424664262, "last_edit_date": 1424664262, "creation_date": 1424662242, "answer_id": 28666517, "question_id": 28665025, "link": "https://stackoverflow.com/questions/28665025/how-to-access-structs-instance-fields-from-a-function/28666517#28666517", "title": "How to access struct&#39;s instance fields from a function?", "body": "<p>Here is one example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\n// example struct\ntype Graph struct {\n    nodes   []int\n    adjList map[int][]int\n}\n\nfunc New() *Graph {\n    g := new(Graph)\n    g.adjList = make(map[int][]int)\n    return g\n}\n\nfunc main() {\n\n    aGraph := New()\n    aGraph.nodes = []int {1,2,3}\n\n    aGraph.adjList[0] = []int{1990,1991,1992}\n    aGraph.adjList[1] = []int{1890,1891,1892}\n    aGraph.adjList[2] = []int{1890,1891,1892}\n\n    fmt.Println(aGraph)\n}\n</code></pre>\n\n<p>Output:&amp;{[1 2 3 4 5] map[0:[1990 1991 1992] 1:[1890 1891 1892] 2:[1790 1791 1792]]}</p>\n"}], "owner": {"reputation": 103, "user_id": 3316836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62c829a9b6e2c33350b891e9d4d798b1?s=128&d=identicon&r=PG&f=1", "display_name": "CuriOne", "link": "https://stackoverflow.com/users/3316836/curione"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 28666517, "answer_count": 1, "score": -4, "last_activity_date": 1424664262, "creation_date": 1424650061, "question_id": 28665025, "link": "https://stackoverflow.com/questions/28665025/how-to-access-structs-instance-fields-from-a-function", "title": "How to access struct&#39;s instance fields from a function?", "body": "<p>Assuming, that I have a <code>Graph</code> struct, like so:</p>\n\n<pre><code>type Graph struct {\n    nodes   []int\n    adjList map[int][]int\n}\n\n// some methods on the struct\n\n\n// constructor\nfunc New() *Graph {\n    g := new(Graph)\n    g.adjList = make(map[int][]int)\n    return g\n}\n</code></pre>\n\n<p>Now, I create a new instance of that struct, with: <code>aGraph := New()</code>.</p>\n\n<p>How do I access the fields of this particular instance of the <code>Graph</code> struct (<code>aGraph</code>)?\nIn other words, how do I access <code>aGraph</code>'s version of the <code>nodes</code> array, (from within another top-level function for example)?</p>\n\n<p>Any help is extremely appreciated!</p>\n"}, {"tags": ["javascript", "arrays", "mongodb", "go", "pull"], "answers": [{"tags": [], "owner": {"reputation": 49301, "user_id": 3100115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46d2b7e69a0a4a82fefdd01a8cf476bd?s=128&d=identicon&r=PG&f=1", "display_name": "styvane", "link": "https://stackoverflow.com/users/3100115/styvane"}, "is_accepted": true, "score": 2, "last_activity_date": 1499425356, "last_edit_date": 1499425356, "creation_date": 1424673673, "answer_id": 28668172, "question_id": 28663273, "link": "https://stackoverflow.com/questions/28663273/pull-mongodb-is-not-removing-items/28668172#28668172", "title": "$pull mongodb is not removing items", "body": "<p>You query doesn't pull any item because you are missing <code>o</code> in <code>placeId</code> value.</p>\n\n<pre><code>&gt; db.users.update(\n    {\"_id\":ObjectId(\"54e664c4e7c3b4d3b5413e39\")},\n    {$pull:{ItemsToDelete : {placeId:\"ChIJIQBpAG2ahYAR_6128GcTUE\"}}},\n                                                                ^\n    { multi: true }\n  )\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>&gt; db.users.update(\n    {\"_id\":ObjectId(\"54e664c4e7c3b4d3b5413e39\")},\n    {$pull:{ItemsToDelete : {placeId:\"ChIJIQBpAG2ahYAR_6128GcTUEo\"}}},\n    { multi: true }\n  )\n\nWriteResult({ \"nMatched\" : 1, \"nUpserted\" : 0, \"nModified\" : 1 })\n\n&gt; db.users.find().pretty()\n{ \"_id\" : ObjectId(\"54eac8d51a0c74438c9dea10\"), \"ItemsToDelete\" : [ ] }\n</code></pre>\n"}], "owner": {"reputation": 1103, "user_id": 285809, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1e54371ee031a4355c2c2c874f529a61?s=128&d=identicon&r=PG", "display_name": "theprojectabot", "link": "https://stackoverflow.com/users/285809/theprojectabot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 28668172, "answer_count": 1, "score": -2, "last_activity_date": 1499425356, "creation_date": 1424639351, "last_edit_date": 1424643533, "question_id": 28663273, "link": "https://stackoverflow.com/questions/28663273/pull-mongodb-is-not-removing-items", "title": "$pull mongodb is not removing items", "body": "<p>I have a collection:</p>\n\n<pre><code>//the json.\n{\n\"ItemsToDelete\" : [ \n        {\n            \"placeId\" : \"ChIJIQBpAG2ahYAR_6128GcTUEo\",\n            \"users\" : [ \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\")\n            ]\n        }, \n        {\n            \"placeId\" : \"ChIJIQBpAG2ahYAR_6128GcTUEo\",\n            \"users\" : [ \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\")\n            ]\n        }, \n        {\n            \"placeId\" : \"ChIJIQBpAG2ahYAR_6128GcTUEo\",\n            \"users\" : [ \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\")\n            ]\n        }\n    ]\n}  \n\n\n{\n\"ItemsToRemove\" : [ \n        {\n            \"ChIJIQBpAG2ahYAR_6128GcTUEo\" : [ \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\")\n            ]\n        }, \n        {\n            \"ChIJIQBpAG2ahYAR_6128GcTUEo\" : [ \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\")\n            ]\n        }, \n        {\n            \"ChIJIQBpAG2ahYAR_6128GcTUEo\" : [ \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\"), \n                ObjectId(\"547e4650f3fb0a022110af15\")\n            ]\n        }\n    ]\n}\n</code></pre>\n\n<p>I then run this mongo shell query to pull an item off the array and delete:</p>\n\n<pre><code>db.users.update({\"_id\":ObjectId(\"54e664c4e7c3b4d3b5413e39\")},{$pull:{ItemsToDelete : {placeId:\"ChIJIQBpAG2ahYAR_6128GcTUE\"}}},{ multi: true })\n</code></pre>\n\n<p>The array remains unmodified.  Any thoughts why this is failing to $pull?</p>\n\n<p>I have tried 'ItemsToDelete.placeId' but that errors out with: error I receive when doing \u201cItemsToDelete.placeId\u201d => \u2018cannot use the part (ItemsToDelete of ItemsToDelete.placeId) to traverse the element\u2019</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 6, "last_activity_date": 1424674679, "last_edit_date": 1424674679, "creation_date": 1424635025, "answer_id": 28662532, "question_id": 28662417, "link": "https://stackoverflow.com/questions/28662417/go-xml-error-invalid-character-entity/28662532#28662532", "title": "Go XML error: invalid character entity", "body": "<p>You can pass entities in if you create a <code>Decoder</code> and mess with its <code>Entity</code> map. I suspect the package doesn't actually parse DTDs, just from poking around <a href=\"http://golang.org/src/encoding/xml/xml.go\" rel=\"nofollow\">xml.go</a>; I see a comment saying it accumulates entities for the caller, but nothing that itself sets entries in <code>d.Entity</code>.</p>\n\n<p>(It would be tricky for <code>encoding/xml</code> to safely provide that, even, because there is a built-in <em>shared</em> HTML entity map. Updating it for one doc would affect parsing of others.)</p>\n\n<p>There's a little more paperwork to create a Decoder with custom entities than there is for regular <code>xml.Unmarshal</code>, but not too much:</p>\n\n<pre><code>func main() {\n    jmd := JMdict{}\n\n    d := xml.NewDecoder(bytes.NewReader([]byte(str)))\n    d.Entity = map[string]string{\n        \"n\": \"(noun)\",\n    }\n    err := d.Decode(&amp;jmd)\n    if err != nil {\n        fmt.Printf(\"error: %v\", err)\n        return\n    }\n    fmt.Println(jmd)\n}\n</code></pre>\n\n<p>Here's a <a href=\"http://play.golang.org/p/C-9cGzYa4g\" rel=\"nofollow\">Playground link</a> with the <code>Entity</code> trick and some output code to show the object as JSON.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 10988360, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/69b67298a895ea45fc28dac7d92dc153?s=128&d=identicon&r=PG", "display_name": "tpa10", "link": "https://stackoverflow.com/users/10988360/tpa10"}, "is_accepted": false, "score": 4, "last_activity_date": 1548826439, "creation_date": 1548826439, "answer_id": 54433879, "question_id": 28662417, "link": "https://stackoverflow.com/questions/28662417/go-xml-error-invalid-character-entity/54433879#54433879", "title": "Go XML error: invalid character entity", "body": "<p>The previous answer is the \"right\" answer, but I believe, depending on what you are really trying to accomplish, a \"quick\" answer is to disable Strict.  e.g.:</p>\n\n<pre><code>d := xml.NewDecoder(os.Stdin)\nd.Strict = false            \n</code></pre>\n"}], "owner": {"reputation": 717, "user_id": 1040642, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/725aff9a1cb57a37d8502833bd607ea3?s=128&d=identicon&r=PG", "display_name": "localhost", "link": "https://stackoverflow.com/users/1040642/localhost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3325, "favorite_count": 1, "accepted_answer_id": 28662532, "answer_count": 2, "score": 4, "last_activity_date": 1548826439, "creation_date": 1424634287, "question_id": 28662417, "link": "https://stackoverflow.com/questions/28662417/go-xml-error-invalid-character-entity", "title": "Go XML error: invalid character entity", "body": "<p>Go can't parse a correct xml file with declared entities, keep getting this error: </p>\n\n<blockquote>\n  <p>error: XML syntax error on line 47: invalid character entity &n;</p>\n</blockquote>\n\n<p>The line being <code>&lt;pos&gt;&amp;n;&lt;/pos&gt;</code> and the entity defined as <code>&lt;!ENTITY n \"noun (common) (futsuumeishi)\"&gt;</code></p>\n\n<p>Here is the program in Go: <a href=\"http://play.golang.org/p/94_60srVne\" rel=\"nofollow\">http://play.golang.org/p/94_60srVne</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1424623659, "post_id": 28660311, "comment_id": 45616322, "body": "what about go-bindata without ./go-bindata?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 1, "creation_date": 1424624382, "post_id": 28660311, "comment_id": 45616569, "body": "@user3918985 for that you&#39;ll have to just install the executable in your PATH, it has nothing to do with Go. you can just add <code>$GOPATH&#47;bin</code> to <code>$PATH</code> and you&#39;ll have every installed go executable ready."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 6, "last_activity_date": 1424622966, "creation_date": 1424622966, "answer_id": 28660311, "question_id": 28660175, "link": "https://stackoverflow.com/questions/28660175/go-command-line-flags/28660311#28660311", "title": "Go: command line flags", "body": "<p>The trick is to use <code>flag.Args()</code> which is, simply, the non flag arguments following the flags. You can either fetch the entire list, or get a specific arg with <code>flag.Arg(i)</code>. See <a href=\"http://golang.org/pkg/flag/#Args\">http://golang.org/pkg/flag/#Args</a></p>\n\n<p>And from the source of the program you posted:</p>\n\n<pre><code>// Create input configurations.\nc.Input = make([]bindata.InputConfig, flag.NArg())\nfor i := range c.Input {\n    c.Input[i] = parseInput(flag.Arg(i))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26843, "user_id": 208997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/250e219125d8bff1f03e6faea950f218?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/208997/simon"}, "is_accepted": false, "score": 1, "last_activity_date": 1424622997, "creation_date": 1424622997, "answer_id": 28660318, "question_id": 28660175, "link": "https://stackoverflow.com/questions/28660175/go-command-line-flags/28660318#28660318", "title": "Go: command line flags", "body": "<p>Easy as pie using the <a href=\"http://golang.org/pkg/flag\" rel=\"nofollow\">flag</a> package. Checkout <a href=\"http://golang.org/pkg/flag/#Args\" rel=\"nofollow\">flag.Args</a></p>\n"}], "owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 28660311, "answer_count": 2, "score": 1, "last_activity_date": 1424622997, "creation_date": 1424622265, "question_id": 28660175, "link": "https://stackoverflow.com/questions/28660175/go-command-line-flags", "title": "Go: command line flags", "body": "<p>I know you can specify command line flags and run your binary file against them like this:</p>\n\n<pre><code>./binary -output=html -type=doc\n</code></pre>\n\n<p>However, I was looking at the implementation of this Go package: <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow\">https://github.com/jteeuwen/go-bindata</a></p>\n\n<p>I'm wondering how the author is able to enable the user to run the commands like this</p>\n\n<pre><code>go-bindata /data \n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>./go-bindata -target=/data\n</code></pre>\n\n<p>Appreciate some help in case I missed out anything!</p>\n"}, {"tags": ["node.js", "mongodb", "go"], "comments": [{"owner": {"reputation": 145537, "user_id": 362536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/da5816365344305a614343a4065a2786?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/362536/brad"}, "edited": false, "score": 2, "creation_date": 1424617695, "post_id": 28659342, "comment_id": 45614273, "body": "&quot;people actually hate node.js&quot;  Where, and in what context?  &quot;However after all the things I have read, node.js sounds like a waste of time.&quot;  We have no idea what you&#39;ve read.  &quot;Could someone help me clarify my confusion ?&quot;  The only confusion I see is that you think we can help answer your question without knowing at all what you are referring to."}, {"owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "reply_to_user": {"reputation": 145537, "user_id": 362536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/da5816365344305a614343a4065a2786?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/362536/brad"}, "edited": false, "score": 0, "creation_date": 1424618013, "post_id": 28659342, "comment_id": 45614382, "body": "Anyone who can use google, find millions of blog posts about this. For example &quot;Holowaychuk&quot;,  &quot;koding.com&quot;.  Also, see, <a href=\"http://www.reddit.com/r/golang/comments/1ye3z6/go_vs_nodejs_for_servers/\" rel=\"nofollow noreferrer\">reddit.com/r/golang/comments/1ye3z6/go_vs_nodejs_for_servers</a>"}, {"owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "reply_to_user": {"reputation": 145537, "user_id": 362536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/da5816365344305a614343a4065a2786?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/362536/brad"}, "edited": false, "score": 0, "creation_date": 1424618139, "post_id": 28659342, "comment_id": 45614436, "body": "Although, what makes stackoverflow more credible, that is questionable."}, {"owner": {"reputation": 145537, "user_id": 362536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/da5816365344305a614343a4065a2786?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/362536/brad"}, "edited": false, "score": 0, "creation_date": 1424618147, "post_id": 28659342, "comment_id": 45614441, "body": "First, weed through to the arguments that are actually true.  Next, decide if any of them matter in your case.  Node.js isn&#39;t a tool for every job, neither is Go, neither is x86 assembler."}, {"owner": {"reputation": 8355, "user_id": 860196, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RAyTX.jpg?s=128&g=1", "display_name": "runDOSrun", "link": "https://stackoverflow.com/users/860196/rundosrun"}, "edited": false, "score": 2, "creation_date": 1424618221, "post_id": 28659342, "comment_id": 45614462, "body": "Voting to close as its opinion-based."}, {"owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "edited": false, "score": 0, "creation_date": 1424618391, "post_id": 28659342, "comment_id": 45614517, "body": "You dont like the question ? Pass to the next where you can brag."}, {"owner": {"reputation": 145537, "user_id": 362536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/da5816365344305a614343a4065a2786?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/362536/brad"}, "edited": false, "score": 2, "creation_date": 1424619108, "post_id": 28659342, "comment_id": 45614753, "body": "@OzumSafa The whole issue with your question is that you seem to think there is one right answer to your problem.  There isn&#39;t, and without the context you run into these useless &quot;X is better than Y&quot; posts.  I&#39;ve updated my answer below that hopefully adds more context to what you&#39;ve already read, but at the end of the day you should decide what works best for you.  Go is pretty neat, but the tools for the work I&#39;m doing run on Node.js so that&#39;s where I&#39;ll be develolping.  Your scenario is likely different."}], "answers": [{"tags": [], "owner": {"reputation": 145537, "user_id": 362536, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/da5816365344305a614343a4065a2786?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/362536/brad"}, "is_accepted": true, "score": -2, "last_activity_date": 1424618965, "last_edit_date": 1424618965, "creation_date": 1424618403, "answer_id": 28659512, "question_id": 28659342, "link": "https://stackoverflow.com/questions/28659342/node-js-or-go-for-a-mongodb-server/28659512#28659512", "title": "Node.js or go for a mongodb server", "body": "<blockquote>\n  <p>People refer to the problem of callback hell</p>\n</blockquote>\n\n<p>This has never been an issue for me.  You can use whatever structure you want in your code.  Any promise library may be helpful if you find that you really need 1,000 nested callbacks, but this is rare in most circumstances.</p>\n\n<blockquote>\n  <p>lowering performance of node.js once the business logic starts to be more complex than simple loops</p>\n</blockquote>\n\n<p>Rarely is this a problem.  Most applications are IO-bound.  If yours isn't, you have a couple options.  One is not to use Node.js.  Another is to compile a native extension for the specific part that's dragging you down (since you'll be writing native code to solve this problem anyway) and call it from the rest of your Node.js application.  That way you get most of the performance of your native code but still get the flexibility of working in JavaScript.</p>\n\n<p>Since you linked to that Reddit post, I'll address some of the comments there.</p>\n\n<blockquote>\n  <p>Javascript is very fast. Yes this is true, V8 is very fast... however, only if you are benchmarking a simple benchmark. As soon as you start adding in complex application logic all that performance goes out the door because the virtual machine has a very difficult time correctly inferring the type and thus not being able to optimize. But if your application consists of a tight loop, it will be fast.. so its got that going for it :D</p>\n</blockquote>\n\n<p>It's all relative.  No doubt that weakly typed and interpreted anything is slower.  It's a trade-off that you have to decide makes sense for what you're doing.  Personally, it's far cheaper for me to fire up another box to handle the load than it is to rewrite all of the helpful modules and frameworks I use in Go.  Maybe that's not the case for you, so you get to decide.</p>\n\n<blockquote>\n  <p>In my 3 years of full time node.js development, I have honestly only had ONE occasion where I used the same 4 lines of code both in the server and in the client.</p>\n</blockquote>\n\n<p>This is generally true.  I don't understand why shared client/server code is some sort of selling point for Node.js, as it isn't for most applications.  I had one case where several classes I wrote for an RPC layer ran on both the server and the client.  One thing I will say though is that there are a ton of NPM packages that run in both so if you get used to using a nice package on one, it will often times work on the other.</p>\n\n<blockquote>\n  <p>Ohh and did I mention Node.js isn't really all JavaScript? A good portion of the pakcages on NPM are also written in Coffeescript. Hope you don't mind learning another language to deal with a package you depend on. So much for using the same language for both server and client!</p>\n</blockquote>\n\n<p>You don't have to learn Coffeescript to use an NPM package written in Coffeescript.  Coffeescript compiles to JavaScript, and are used in your code the same way any other package is.  Also, those same Coffeescript packages do run just fine in the browser since it all builds to JavaScript.</p>\n\n<blockquote>\n  <p>With Go you get type safety. This CANNOT be overstated.. except to maybe ruby-ists(jk jk! don't shoot me).</p>\n</blockquote>\n\n<p>It's up to you to decide if this matters for your use case.</p>\n\n<blockquote>\n  <p>The one benefit you have with Node.js over Go is the massive number of packages available on NPM. But most of them are useless abandoned junk. So, even that is questionable.</p>\n</blockquote>\n\n<p>Don't use abandoned junk, just like you wouldn't with any packages on any platform.  It's very easy to see what's abandoned junk.  NPM calls out what's been updated and when, whether or not its dependencies are up to date, and how many people are using that package.  There are definitely a massive number of useful packages available for Node.js, just like they are for most popular platforms.</p>\n\n<blockquote>\n  <p>Testing: Lets just say that in Node.js/Javascript you would have to write tests that check the type of a variable. tsk tsk tsk... This is the only way to properly test JS and make sure nothing crazy is going on.</p>\n</blockquote>\n\n<p>That's not really accurate, and I'm really curious what's going on in this person's application where this is necessary. </p>\n"}], "owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "closed_date": 1443583786, "accepted_answer_id": 28659512, "answer_count": 1, "score": -4, "last_activity_date": 1424618965, "creation_date": 1424617511, "last_edit_date": 1424618096, "question_id": 28659342, "link": "https://stackoverflow.com/questions/28659342/node-js-or-go-for-a-mongodb-server", "closed_reason": "Opinion-based", "title": "Node.js or go for a mongodb server", "body": "<p>I have been trying to create a mongodb server which will receive post requests and insert or read from a mongodb server and reply back. I have started with node.js. However while I was reading stuff, I have been realizing, people actually hate node.js. Many people are crossing to GO. So I am all confused now.</p>\n\n<p>I have chosen node.js because of the natural json compatibility of javascript. However after all the things I have read, node.js sounds like a waste of time. \nCould someone help me clarify my confusion ?</p>\n\n<p>Thank you.</p>\n\n<p>Edit : People refer to the problem of callback hell, and lowering performance of node.js once the business logic starts to be more complex than simple loops.</p>\n"}, {"tags": ["string", "go", "binary", "type-conversion"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1424634895, "last_edit_date": 1424634895, "creation_date": 1424618049, "answer_id": 28659445, "question_id": 28659193, "link": "https://stackoverflow.com/questions/28659193/go-convert-rune-string-to-string-representation-of-the-binary/28659445#28659445", "title": "Go: convert rune (string) to string representation of the binary", "body": "<p><strong>Standard library support</strong></p>\n\n<p><code>fmt.Printf(\"%b\", r)</code> - this solution is already very compact and easy to write and understand. If you need the result as a <code>string</code>, you can use the analog <a href=\"http://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow\"><code>Sprintf()</code></a> function:</p>\n\n<pre><code>s := fmt.Sprintf(\"%b\", r)\n</code></pre>\n\n<p>You can also use the <a href=\"http://golang.org/pkg/strconv/#FormatInt\" rel=\"nofollow\"><code>strconv.FormatInt()</code></a> function which takes a number of type <code>int64</code> (so you first have to convert your <code>rune</code>) and a base where you can pass <code>2</code> to get the result in binary representation:</p>\n\n<pre><code>s := strconv.FormatInt(int64(r), 2)\n</code></pre>\n\n<p>Note that in Go <code>rune</code> is just an alias for <code>int32</code>, the 2 types are one and the same (just you may refer to it by 2 names).</p>\n\n<p><strong>Doing it manually (\"Simple but Naive\"):</strong></p>\n\n<p>If you'd want to do it \"manually\", there is a much simpler solution than your original. You can test the lowest bit with <code>r &amp; 0x01 == 0</code> and shift all bits with <code>r &gt;&gt;= 1</code>. Just \"loop\" over all bits and append either <code>\"1\"</code> or <code>\"0\"</code> depending on the bit:</p>\n\n<p>Note this is just for demonstration, it is nowhere near optimal regarding performance (generates \"redundant\" <code>string</code>s):</p>\n\n<pre><code>func RuneToBin(r rune) (s string) {\n    if r == 0 {\n        return \"0\"\n    }\n    for digits := []string{\"0\", \"1\"}; r &gt; 0; r &gt;&gt;= 1 {\n        s = digits[r&amp;1] + s\n    }\n    return\n}\n</code></pre>\n\n<p>Note: negative numbers are not handled by the function. If you also want to handle negative numbers, you can first check it and proceed with the positive value of it and start the return value with a minus <code>'-'</code> sign. This also applies the other manual solution below.</p>\n\n<p><strong>Manual Performance-wise solution:</strong></p>\n\n<p>For a fast solution we shouldn't append strings. Since strings in Go are just byte slices encoded using UTF-8, appending a digit is just appending the byte value of the rune <code>'0'</code> or <code>'1'</code> which is just one byte (not multi). So we can allocate a big enough buffer/array (<code>rune</code> is 32 bits so max 32 binary digits), and fill it backwards so we won't even have to reverse it at the end. And return the used part of the array converted to <code>string</code> at the end. Note that I don't even call the built-in <code>append</code> function to append the binary digits, I just set the respective element of the array in which I build the result:</p>\n\n<pre><code>func RuneToBinFast(r rune) string {\n    if r == 0 {\n        return \"0\"\n    }\n    b, i := [32]byte{}, 31\n    for ; r &gt; 0; r, i = r&gt;&gt;1, i-1 {\n        if r&amp;1 == 0 {\n            b[i] = '0'\n        } else {\n            b[i] = '1'\n        }\n    }\n    return string(b[i+1:])\n}\n</code></pre>\n"}], "owner": {"reputation": 2136, "user_id": 2120421, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1Xvdm.png?s=128&g=1", "display_name": "thoroc", "link": "https://stackoverflow.com/users/2120421/thoroc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2514, "favorite_count": 1, "accepted_answer_id": 28659445, "answer_count": 1, "score": 1, "last_activity_date": 1475354740, "creation_date": 1424616688, "last_edit_date": 1475354740, "question_id": 28659193, "link": "https://stackoverflow.com/questions/28659193/go-convert-rune-string-to-string-representation-of-the-binary", "title": "Go: convert rune (string) to string representation of the binary", "body": "<p>This is just in case someone else is learning Golang and is wondering how to convert from a string to a string representation in binary. </p>\n\n<p>Long story short, I have been looking at the standard library without being able to find the right call. So I started with something similar to the following:</p>\n\n<pre><code>func RuneToBinary(r rune) string {\n    var buf bytes.Buffer\n    b := []int64{128, 64, 32, 16, 8, 4, 2, 1}\n    v := int64(r)\n    for i := 0; i &lt; len(b); i++ {\n        t := v-b[i]\n        if t &gt;= 0 {\n           fmt.Fprintf(&amp;buf, \"1\")\n           v = t\n        } else {\n           fmt.Fprintf(&amp;buf, \"0\")\n        }\n    }\n\n    return buf.String()\n}\n</code></pre>\n\n<p>This is all well and dandy, but after a couple of days looking around I found that I should have been using the <a href=\"http://golang.org/pkg/fmt/#pkg-overview\" rel=\"nofollow\"><code>fmt</code></a> package instead and just format the <code>rune</code> with <code>%b%</code>:</p>\n\n<pre><code>var r rune\nfmt.Printf(\"input: %b \", r)\n</code></pre>\n\n<p>Is there a better way to do this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1424583071, "post_id": 28654876, "comment_id": 45606552, "body": "You would also want <code>Hello</code> to become <code>Helo</code>, right? Th expression should be <code>(.)\\1+</code> to catch <code>wooorrrrrrld</code> as well."}, {"owner": {"reputation": 10232, "user_id": 2104976, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1a5168ce005df0148523b929ea9983c0?s=128&d=identicon&r=PG", "display_name": "callmekatootie", "link": "https://stackoverflow.com/users/2104976/callmekatootie"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1424583436, "post_id": 28654876, "comment_id": 45606586, "body": "Oh yeah. Correct. Expectation is to identify all letters that repeat consecutively and just retain only one of it."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1424583649, "post_id": 28654876, "comment_id": 45606615, "body": "I am not familiar with regex library in go, so I have no idea how it is done, but there should be a way to retrieve the first capturing group, which corresponds to the dot in parentheses. The whole expression, which in many regex implementations corresponds to group zero, will match all identical letters, but the first capturing group would be just the first character."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1424583953, "post_id": 28654876, "comment_id": 45606653, "body": "@dasblinkenlight Go uses <a href=\"http://golang.org/pkg/regexp/\" rel=\"nofollow noreferrer\"><code>re2</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 10232, "user_id": 2104976, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1a5168ce005df0148523b929ea9983c0?s=128&d=identicon&r=PG", "display_name": "callmekatootie", "link": "https://stackoverflow.com/users/2104976/callmekatootie"}, "edited": false, "score": 1, "creation_date": 1424584195, "post_id": 28654940, "comment_id": 45606688, "body": "Beautiful. Works as expected. Removes consecutive duplicate letters retaining only one of them."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 5, "last_activity_date": 1424583734, "creation_date": 1424583734, "answer_id": 28654940, "question_id": 28654876, "link": "https://stackoverflow.com/questions/28654876/lookahead-regular-expression-identify-duplicate-consecutive-letters/28654940#28654940", "title": "Lookahead regular expression - Identify duplicate consecutive letters", "body": "<p>You could use pcre bindings, however if you just want to remove dup letters you could use <a href=\"http://golang.org/pkg/strings/#Map\"><code>strings.Map</code></a>, for example:</p>\n\n<pre><code>func stripDups(s string) string {\n    var last rune\n    return strings.Map(func(r rune) rune {\n        if r != last {\n            last = r\n            return r\n        }\n        return -1\n    }, s)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/tAvnd8Kf7R\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 10232, "user_id": 2104976, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1a5168ce005df0148523b929ea9983c0?s=128&d=identicon&r=PG", "display_name": "callmekatootie", "link": "https://stackoverflow.com/users/2104976/callmekatootie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 28654940, "answer_count": 1, "score": 5, "last_activity_date": 1424583734, "creation_date": 1424582887, "question_id": 28654876, "link": "https://stackoverflow.com/questions/28654876/lookahead-regular-expression-identify-duplicate-consecutive-letters", "title": "Lookahead regular expression - Identify duplicate consecutive letters", "body": "<p>I have a string - for example, \"Hello Worrld\". Notice the \"r\" letter repeats twice.</p>\n\n<p>I wish to identify letters that occur consecutively (two or more times) and retain only one of them. That is, I wish to get \"Hello World\" with a single \"r\".</p>\n\n<p>Golang does not seem to have lookahead regular expression.</p>\n\n<p>I tried using the following regular expression to identify letters that repeat consecutively - </p>\n\n<pre><code>r := regexp.Compile(`(.)\\1`)\n</code></pre>\n\n<p>But it selects both the occurrences of the letters - I would want only one of them to be selected.</p>\n"}, {"tags": ["go", "elasticsearch"], "answers": [{"comments": [{"owner": {"reputation": 8066, "user_id": 192204, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/267bd2f588ab05a83b547964e075dea0?s=128&d=identicon&r=PG", "display_name": "scarpacci", "link": "https://stackoverflow.com/users/192204/scarpacci"}, "edited": false, "score": 0, "creation_date": 1424668476, "post_id": 28662015, "comment_id": 45629118, "body": "Thanks @snwight I appreciate the feedback."}], "tags": [], "owner": {"reputation": 103, "user_id": 1723911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9449a5fac4e415ad9ead4984365ccfa?s=128&d=identicon&r=PG", "display_name": "snwight", "link": "https://stackoverflow.com/users/1723911/snwight"}, "is_accepted": true, "score": 3, "last_activity_date": 1424632088, "creation_date": 1424632088, "answer_id": 28662015, "question_id": 28653295, "link": "https://stackoverflow.com/questions/28653295/elasticsearch-golang/28662015#28662015", "title": "ElasticSearch Golang", "body": "<p><a href=\"https://github.com/mattbaird/elastigo\" rel=\"nofollow\">elastigo</a> is working very well in a production setting for us. As far as detecting 'hosts' my best suggestion is to read the elasticsearch <a href=\"http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/_basic_concepts.html\" rel=\"nofollow\">documentation</a> which describes their cluster management scheme - most of that work is handled by elasticsearch itself. In our (rather straightforward) usage I've never had to think about anything beyond the server host address:port - nodes self-connect to a named cluster when brought online (with proper configuration parameters) and load balancing is handled within elasticsearch itself. </p>\n"}, {"tags": [], "owner": {"reputation": 536, "user_id": 1804618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33dfa3278a67442de02221285198d1c?s=128&d=identicon&r=PG", "display_name": "upitau", "link": "https://stackoverflow.com/users/1804618/upitau"}, "is_accepted": false, "score": 5, "last_activity_date": 1468758425, "last_edit_date": 1468758425, "creation_date": 1468758046, "answer_id": 38421109, "question_id": 28653295, "link": "https://stackoverflow.com/questions/28653295/elasticsearch-golang/38421109#38421109", "title": "ElasticSearch Golang", "body": "<p>My answer could be a bit late, but still... I have recently (mid 2016) chosen <a href=\"https://github.com/olivere/elastic\" rel=\"noreferrer\">olivere/elastic</a> over <a href=\"https://github.com/mattbaird/elastigo\" rel=\"noreferrer\">elastigo</a> as Elasticsearch Go client for our production application.</p>\n\n<p>Reasons for the choice were:</p>\n\n<ul>\n<li><a href=\"https://github.com/olivere/elastic/graphs/commit-activity\" rel=\"noreferrer\"><em>olivere/elastic</em></a> is under active development for the last year, while <a href=\"https://github.com/mattbaird/elastigo/graphs/commit-activity\" rel=\"noreferrer\"><em>elastigo</em></a> gets updated less and less regularly</li>\n<li>As of 2016, developers recommend <em>olivere/elastic</em> more on the Internet</li>\n</ul>\n\n<p>I would highly recommend you to have a look at <em>olivere/elastic</em> if you haven't made decision yet. Also there is a blog post <a href=\"http://goinbigdata.com/working-with-elasticsearch-in-go\" rel=\"noreferrer\">Working With Elasticsearch in Go</a>, which demonstrates on example how to use <em>olivere/elastic</em> to index and search documents. (In case you want to get a flavour of how the code looks like.)</p>\n"}], "owner": {"reputation": 8066, "user_id": 192204, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/267bd2f588ab05a83b547964e075dea0?s=128&d=identicon&r=PG", "display_name": "scarpacci", "link": "https://stackoverflow.com/users/192204/scarpacci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5382, "favorite_count": 2, "accepted_answer_id": 28662015, "answer_count": 2, "score": 5, "last_activity_date": 1468758425, "creation_date": 1424566759, "question_id": 28653295, "link": "https://stackoverflow.com/questions/28653295/elasticsearch-golang", "title": "ElasticSearch Golang", "body": "<p>Is it possible to identify multiple hosts with <a href=\"https://github.com/mattbaird/elastigo\" rel=\"noreferrer\">elastigo</a>? I can't seem to find anything specific to that. Anyone using <a href=\"https://github.com/mattbaird/elastigo\" rel=\"noreferrer\">elastigo</a> in a PROD setting? I would really like to attempt using a go based app for our web services, but we have a requirement with ElasticSearch, Redis and possibly a few others.  Just not sure that the drivers for go are ready yet.</p>\n\n<p>Any suggestions / info would be appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>S</p>\n"}, {"tags": ["multithreading", "go", "channels"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1424551927, "post_id": 28650702, "comment_id": 45599765, "body": "It seems odd to cache an *http.Response because a response can only be read once.  As far as the cache is concerned, you are guaranteed threadsaftey if you only access the cache from a single goroutine as I think you are describing."}], "answers": [{"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 2, "creation_date": 1424683618, "post_id": 28651294, "comment_id": 45634816, "body": "<code>poll</code> is not a good choice of name, but what it does nicely fits into the spirit of CSP &#39;processes&#39;. Polling implies repeatedly making <i>non-blocking</i> checks for something to change, such as an input port. Because channels block, that&#39;s not what is happening here. Non-blocking polling can be wasteful of the CPU, but here there is no activity except when events happen. Channels allow you to build up event-driven systems."}], "tags": [], "owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "is_accepted": true, "score": 3, "last_activity_date": 1424553426, "last_edit_date": 1424553426, "creation_date": 1424552623, "answer_id": 28651294, "question_id": 28650702, "link": "https://stackoverflow.com/questions/28650702/is-it-thread-safe-to-have-multiple-channels-for-communicating-with-a-single-shar/28651294#28651294", "title": "Is it thread-safe to have multiple channels for communicating with a single shared struct?", "body": "<p>In principle the usage of channels is a valid way to ensure synchronous access to the struct data. The problem I see with your approach is that your <code>Run</code> function does only a single read and then returns. As long as you call <code>Run</code> from the same goroutine every time, it might work but there's an easier way.</p>\n\n<p>The memory safety can be guaranteed only of all struct access is confined to one, and only one, goroutine. The way I usually do that is to create a polling routine which loops on the channels. Either indefinitely, or until it is explicitly stopped.</p>\n\n<p><a href=\"http://play.golang.org/p/I4jIwBAJDx\" rel=\"nofollow\">Here is an example</a>. I create separate channels for each supported operation, mostly to make it clearer what is going on. You can easily use a single channel like <code>chan interface{}</code>, and switch on the type of the message received to see what kind of operation you should be performing. This kind of setup is very loosely based on Erlang's message passing concepts. It requires a fair amount of boilerplate to setup, but eliminates the need for mutex locks. Whether it is efficient and scaleable is something you can only discover through testing. Note also that it packs a fair amount of allocation overhead.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    t := NewT()\n    defer t.Close()\n\n    t.Set(\"foo\", 123)\n    fmt.Println(t.Get(\"foo\"))\n\n    t.Set(\"foo\", 321)\n    fmt.Println(t.Get(\"foo\"))\n\n    t.Set(\"bar\", 456)\n    fmt.Println(t.Get(\"bar\"))\n}\n\ntype T struct {\n    get  chan getRequest\n    set  chan setRequest\n    quit chan struct{}\n\n    data map[string]int\n}\n\nfunc NewT() *T {\n    t := &amp;T{\n        data: make(map[string]int),\n        get:  make(chan getRequest),\n        set:  make(chan setRequest),\n        quit: make(chan struct{}, 1),\n    }\n\n    // Fire up the poll routine.\n    go t.poll()\n    return t\n}\n\nfunc (t *T) Get(key string) int {\n    ret := make(chan int, 1)\n    t.get &lt;- getRequest{\n        Key:   key,\n        Value: ret,\n    }\n    return &lt;-ret\n}\n\nfunc (t *T) Set(key string, value int) {\n    t.set &lt;- setRequest{\n        Key:   key,\n        Value: value,\n    }\n}\n\nfunc (t *T) Close() { t.quit &lt;- struct{}{} }\n\n// poll loops indefinitely and reads from T's channels to do\n// whatever is necessary. Keeping it all in this single routine,\n// ensures all struct modifications are preformed atomically.\nfunc (t *T) poll() {\n    for {\n        select {\n        case &lt;-t.quit:\n            return\n\n        case req := &lt;-t.get:\n            req.Value &lt;- t.data[req.Key]\n\n        case req := &lt;-t.set:\n            t.data[req.Key] = req.Value\n        }\n    }\n}\n\ntype getRequest struct {\n    Key   string\n    Value chan int\n}\n\ntype setRequest struct {\n    Key   string\n    Value int\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "edited": false, "score": 1, "creation_date": 1424668198, "post_id": 28653163, "comment_id": 45629048, "body": "Yeah, I did mean to put an infinite loop around the <code>select</code>, didn&#39;t realize i&#39;d missed it. Thanks a lot for your help and that &quot;avoid using <code>self</code>&quot;` tip :)"}], "tags": [], "owner": {"reputation": 1870, "user_id": 326722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/man2G.jpg?s=128&g=1", "display_name": "danmux", "link": "https://stackoverflow.com/users/326722/danmux"}, "is_accepted": false, "score": 3, "last_activity_date": 1424565955, "last_edit_date": 1424565955, "creation_date": 1424565522, "answer_id": 28653163, "question_id": 28650702, "link": "https://stackoverflow.com/questions/28650702/is-it-thread-safe-to-have-multiple-channels-for-communicating-with-a-single-shar/28653163#28653163", "title": "Is it thread-safe to have multiple channels for communicating with a single shared struct?", "body": "<p>Yes the select will only ever either be waiting or executing one case block.\nSo if you only have one Run function at any time and you know no other goroutines will mutate the cache, then it will be race free.</p>\n\n<p>I assume you wanted a infinite loop round the select.</p>\n\n<p>heres an example where you can see the select does not enter another block whilst one is executing... <a href=\"https://play.golang.org/p/zFeRPK1h8c\" rel=\"nofollow\">https://play.golang.org/p/zFeRPK1h8c</a></p>\n\n<p>btw, <a href=\"https://code.google.com/p/go-wiki/wiki/CodeReviewComments#Receiver_Names\" rel=\"nofollow\">'self' is frowned upon</a> as a receiver name.</p>\n"}], "owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 28651294, "answer_count": 2, "score": 0, "last_activity_date": 1425037570, "creation_date": 1424549063, "question_id": 28650702, "link": "https://stackoverflow.com/questions/28650702/is-it-thread-safe-to-have-multiple-channels-for-communicating-with-a-single-shar", "title": "Is it thread-safe to have multiple channels for communicating with a single shared struct?", "body": "<p>Consider the following code:</p>\n\n<pre><code>type Cache struct{\n    cache map[string]*http.Response\n    AddChannel chan *http.Response\n    RemoveChannel chan *http.Response\n    FindChannel chan string\n}\n\nfunc (self *Cache) Run(){\n    select{\n        case resp := &lt;-self.AddChannel:\n        //..code\n        case resp := &lt;- self.RemoveChannel:\n        //..code\n        case find := &lt;- self.FindChannel:\n        //..code\n    }\n}\n</code></pre>\n\n<p>In this code, a cache is created and the Run function is called on a separate goroutine. </p>\n\n<p>If a response is to be cached, it is sent through the cache's <code>AddChannel</code>; </p>\n\n<p>if a response is to be removed, it is sent through the <code>RemoveChannel</code> </p>\n\n<p>and if a response needs to be found, the appropriate key is sent through the <code>FindChannel</code>.</p>\n\n<p>Is this a thread-safe way of protecting the cache against race conditions or is it possible that, for example, the same response could be sent to both the <code>AddChannel</code> and <code>RemoveChannel</code> leading to cache corruption.</p>\n\n<p>I have read Go's memory model documentation and understand that it is guaranteed that sending a variable through a channel is guaranteed to happen before receiving but i'm somewhat confused as to whether this still holds if there are multiple channels to communicate to a single instance.</p>\n\n<p>Sorry if I worded the question badly and thanks for your help.</p>\n"}, {"tags": ["go", "compilation", "release"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 7, "creation_date": 1424558654, "post_id": 28650603, "comment_id": 45601707, "body": "Removing debug information from a Go program may break certain uses of reflection. You should not use that flag."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1424599263, "post_id": 28650603, "comment_id": 45609444, "body": "Depending on your use case. For deployment to my own servers, which I&#39;m guessing is how the overwhelming majority of Go users deploy - you really shouldn&#39;t do it. It gives you nothing really and prevents debugging on servers and some reflect stuff."}, {"owner": {"reputation": 45768, "user_id": 13227, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9aa8ec2ad36bb9385a4a0f3840f65ae8?s=128&d=identicon&r=PG", "display_name": "Gary Willoughby", "link": "https://stackoverflow.com/users/13227/gary-willoughby"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 3, "creation_date": 1424623573, "post_id": 28650603, "comment_id": 45616285, "body": "@FUZxxl What uses of reflection? All seems to work just fine. <a href=\"http://www.reddit.com/r/golang/comments/2woogl/when_building_go_programs_for_release_is_it/cot9q3z\" rel=\"nofollow noreferrer\">reddit.com/r/golang/comments/2woogl/&hellip;</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424734798, "post_id": 28650603, "comment_id": 45664035, "body": "Plain <code>go build</code> is the norm. It runs when you <code>go get</code> something; I hadn&#39;t known until today about <code>-ldflags -w</code>; Go&#39;s usual norm is not to complicate things for a little tuning; I doubt it&#39;ll make a huge difference (static linking is the big cause of big binaries); and reactions to stripping symbols seemed generally negative <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/yzcYsnNiUgg\" rel=\"nofollow noreferrer\">on this golang-nuts thread</a>."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424735071, "post_id": 28650603, "comment_id": 45664127, "body": "<a href=\"https://groups.google.com/d/msg/golang-nuts/Xr2Zsa0YfKs/auAlsnWf7-oJ\" rel=\"nofollow noreferrer\">Going by this old thread</a> I think <code>-s</code> has to leave some data in for the runtime (so stripping doesn&#39;t even completely strip). Also, user davecheney on Reddit says it&#39;s standard practice to just use &#39;go build&#39;, and is one of the committers on the Go project, so believe him. :)"}], "answers": [{"tags": [], "owner": {"reputation": 45768, "user_id": 13227, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9aa8ec2ad36bb9385a4a0f3840f65ae8?s=128&d=identicon&r=PG", "display_name": "Gary Willoughby", "link": "https://stackoverflow.com/users/13227/gary-willoughby"}, "is_accepted": true, "score": 3, "last_activity_date": 1424898375, "creation_date": 1424898375, "answer_id": 28729571, "question_id": 28650603, "link": "https://stackoverflow.com/questions/28650603/when-building-go-programs-for-release-is-it-standard-practice-to-just-use-go-bu/28729571#28729571", "title": "When building Go programs for release is it standard practice to just use &#39;go build&#39;?", "body": "<p>According to <a href=\"http://dave.cheney.net/about\" rel=\"nofollow\">Dave Cheney</a> the answer is yes, just use <code>go build</code>.</p>\n\n<p>Source: <a href=\"http://www.reddit.com/r/golang/comments/2woogl/when_building_go_programs_for_release_is_it/\" rel=\"nofollow\">http://www.reddit.com/r/golang/comments/2woogl/when_building_go_programs_for_release_is_it/</a></p>\n"}], "owner": {"reputation": 45768, "user_id": 13227, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9aa8ec2ad36bb9385a4a0f3840f65ae8?s=128&d=identicon&r=PG", "display_name": "Gary Willoughby", "link": "https://stackoverflow.com/users/13227/gary-willoughby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3317, "favorite_count": 1, "accepted_answer_id": 28729571, "answer_count": 1, "score": 18, "last_activity_date": 1492327434, "creation_date": 1424548526, "last_edit_date": 1492327434, "question_id": 28650603, "link": "https://stackoverflow.com/questions/28650603/when-building-go-programs-for-release-is-it-standard-practice-to-just-use-go-bu", "title": "When building Go programs for release is it standard practice to just use &#39;go build&#39;?", "body": "<p>When building Go programs for release is it standard practise to just use <code>go build</code> without any other options? I ask because when building using <code>go build</code> all debug information is included by default. To remove it you can pass an option to the linker, thus:</p>\n\n<pre><code>go build -ldflags \"-w\" prog.go\n</code></pre>\n\n<p>This omits all debug symbols. When building programs for release do you remove this information or leave it intact?</p>\n\n<p>EDIT: For clarity, i'm wondering how people compile Go programs for deployment to a live environment. In other compiled languages you have a different set of compiler command line options for debugging and release builds and release builds usually optimise the executable and remove debugging information.</p>\n"}, {"tags": ["syntax", "go"], "answers": [{"tags": [], "owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "is_accepted": true, "score": 4, "last_activity_date": 1424685060, "last_edit_date": 1424685060, "creation_date": 1424551024, "answer_id": 28651030, "question_id": 28650394, "link": "https://stackoverflow.com/questions/28650394/how-can-one-declare-a-function-using-a-function-type-in-go/28651030#28651030", "title": "How can one declare a function using a function type in GO", "body": "<p>As far as I know, the shortest way is still:</p>\n\n<pre><code>doubleIt := func (value int) int {\n    return value * 2\n}\n</code></pre>\n\n<p>So it's not getting any shorter, and I don't think it would be more readable to decouple the function signature from its body. The benefit of declaring a named func type is using it in other declarations.</p>\n\n<p>No extra conversions like <code>doubleId := mapFunc(func...)</code> needed, because of the <a href=\"http://golang.org/ref/spec#Type_identity\" rel=\"nofollow\">type identity</a> rules:</p>\n\n<blockquote>\n  <p>Two function types are identical if they have the same number of parameters and result values, corresponding parameter and result types are identical, and either both functions are variadic or neither is. Parameter and result names are not required to match.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1424683877, "post_id": 28654376, "comment_id": 45634962, "body": "Wrapping with <code>mapFunc</code> is redundant due to the <a href=\"http://golang.org/ref/spec#Type_identity\" rel=\"nofollow noreferrer\">type identity</a> rules."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1424719125, "post_id": 28654376, "comment_id": 45656026, "body": "Well @rfalke was asking in the context when he declared a function as named type. He might have had specific use. This is not common but simply to illustrate his point."}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 1, "last_activity_date": 1426017327, "last_edit_date": 1426017327, "creation_date": 1424577618, "answer_id": 28654376, "question_id": 28650394, "link": "https://stackoverflow.com/questions/28650394/how-can-one-declare-a-function-using-a-function-type-in-go/28654376#28654376", "title": "How can one declare a function using a function type in GO", "body": "<p>Of course you can <code>func</code> is a <a href=\"https://golang.org/doc/codewalk/functions/\" rel=\"nofollow\">first-class</a> type like any other pre-declared types, although it doesn't make much sense to declare it this way:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n// You need not a named argument for a named type\ntype mapFunc func(int) int\n\nfunc main() {\n        doubleIt := mapFunc(func(value int) int { return value * 2})\n        fmt.Println(doubleIt(2))      // 4\n}\n</code></pre>\n\n<p>This is to illustrate that function is just another type in Go and can be treated like any other named type.</p>\n"}], "owner": {"reputation": 377, "user_id": 314054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecea985e3ef6d85f06d0c024d1317377?s=128&d=identicon&r=PG", "display_name": "rfalke", "link": "https://stackoverflow.com/users/314054/rfalke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 28651030, "answer_count": 2, "score": 1, "last_activity_date": 1426017327, "creation_date": 1424547403, "question_id": 28650394, "link": "https://stackoverflow.com/questions/28650394/how-can-one-declare-a-function-using-a-function-type-in-go", "title": "How can one declare a function using a function type in GO", "body": "<p>Suppose you declare a function type</p>\n\n<pre><code>type mapFunc func(value int) int\n</code></pre>\n\n<p>Can you declare a function by using this type without duplicating it? Something like:</p>\n\n<pre><code>doubleIt := mapFunc {\n    return 2*value\n}\n</code></pre>\n"}, {"tags": ["io", "go", "serial-port", "system-calls", "termios"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1424545565, "post_id": 28649527, "comment_id": 45597463, "body": "You mentioned the values are sent as <code>xxxx\\r</code>, but you&#39;re waiting for <code>\\n</code>, is that a typo in the post or the code?"}, {"owner": {"reputation": 113, "user_id": 1882003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290f25a8bff5c4a4aa632fc862c4f0b?s=128&d=identicon&r=PG", "display_name": "Arthur White", "link": "https://stackoverflow.com/users/1882003/arthur-white"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1424548951, "post_id": 28649527, "comment_id": 45598710, "body": "I explain that in the last comment at the end of my code: <code>\\r</code> is converted to <code>\\n</code> because of the ICRNL iflag."}, {"owner": {"reputation": 113, "user_id": 1882003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290f25a8bff5c4a4aa632fc862c4f0b?s=128&d=identicon&r=PG", "display_name": "Arthur White", "link": "https://stackoverflow.com/users/1882003/arthur-white"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1424683810, "post_id": 28649527, "comment_id": 45634931, "body": "After testing some packages, I just found that <a href=\"https://github.com/mikepb/go-serial\" rel=\"nofollow noreferrer\">mikepb/go-serial</a> does it perfectly and out of the box. Now I have a good foundation so I will try to do that in pure Go (without cgo) if possible."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1424700476, "post_id": 28649527, "comment_id": 45644407, "body": "Please post an answer after you figure it out for future reference :)"}], "owner": {"reputation": 113, "user_id": 1882003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290f25a8bff5c4a4aa632fc862c4f0b?s=128&d=identicon&r=PG", "display_name": "Arthur White", "link": "https://stackoverflow.com/users/1882003/arthur-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 676, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424548187, "creation_date": 1424542955, "last_edit_date": 1592644375, "question_id": 28649527, "link": "https://stackoverflow.com/questions/28649527/wait-for-serial-port-input-in-go", "title": "Wait for serial port input in Go", "body": "<p>I have a digital caliper that can send measured value over the serial port.\nThis data is formatted like <code>+123.45\\r</code> and can be sent at any time by the device.</p>\n<p>So my program needs to &quot;listen&quot; for the first data input (that always ends with a carriage return) and close the reading directly after this one, before continuing his own work.</p>\n<p>Dedicated terminals like <a href=\"http://freeware.the-meiers.org\" rel=\"nofollow noreferrer\">CoolTerm</a> and <a href=\"http://www.chiark.greenend.org.uk/%7Esgtatham/putty/download.html\" rel=\"nofollow noreferrer\">Putty</a> handle these unpredictable inputs perfectly\u2026 But I don't see how to do that in Go (even with cgo).</p>\n<h3>My system</h3>\n<ul>\n<li>OS X 10.9.5</li>\n<li>Go 1.4.2 Darwin/AMD64</li>\n</ul>\n<h3>The device</h3>\n<ul>\n<li>4800 baud</li>\n<li>7 data bits</li>\n<li>Even parity</li>\n<li>2 stop bits</li>\n<li>DTR</li>\n</ul>\n<h3>My actual code</h3>\n<p>\u2026that doesn't work\u2026</p>\n<pre><code>package main\n\nimport (\n    &quot;bufio&quot;\n    &quot;fmt&quot;\n    &quot;os&quot;\n    &quot;syscall&quot;\n    &quot;unsafe&quot;\n)\n\nfunc main() {\n    f, err := os.OpenFile(&quot;/dev/tty.PL2303-00003014&quot;, syscall.O_RDWR+syscall.O_NOCTTY+syscall.O_NDELAY+syscall.O_NONBLOCK, 0666)\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n\n    // Init terminal for 4800 7E2.\n    t := &amp;syscall.Termios{\n        // Enable parity checking, strip to 7 bits, CR to NL, outgoing software flow control.\n        Iflag: syscall.INPCK + syscall.ISTRIP + syscall.ICRNL + syscall.IXON,\n        // Set 4800 bauds, 7 data bits, even parity, 2 stop bits, DTR.\n        Cflag:  syscall.B4800 + syscall.CS7 + syscall.PARENB + syscall.CSTOPB + syscall.TIOCM_DTR + syscall.CREAD + syscall.CLOCAL + syscall.CSIZE,\n        Cc:     [20]uint8{syscall.VMIN: 1},\n        Ispeed: syscall.B4800,\n        Ospeed: syscall.B4800,\n    }\n\n    _, _, errno := syscall.Syscall(syscall.SYS_FCNTL, uintptr(f.Fd()), uintptr(syscall.F_SETFL), uintptr(unsafe.Pointer(t)))\n    if errno != 0 {\n        panic(&quot;syscall error: &quot; + errno.Error())\n    }\n\n    // Read until the first new line byte (\\r is converted to \\n with the ICRNL flag).\n    fr := bufio.NewReader(f)\n    line, err := fr.ReadBytes('\\n')\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(line))\n}\n</code></pre>\n"}, {"tags": ["json", "http", "go"], "answers": [{"comments": [{"owner": {"reputation": 958, "user_id": 2626742, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3376e8297d843faf775b3cee1a906f9a?s=128&d=identicon&r=PG", "display_name": "Cody", "link": "https://stackoverflow.com/users/2626742/cody"}, "edited": false, "score": 1, "creation_date": 1424543046, "post_id": 28644783, "comment_id": 45596457, "body": "Thank you so much! I thought I was being clever by making the fields lowercase, so I wouldn&#39;t have to specify the json name, but it makes so much sense now why that could never work."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 4, "last_activity_date": 1424515063, "creation_date": 1424515063, "answer_id": 28644783, "question_id": 28644600, "link": "https://stackoverflow.com/questions/28644600/json-decoder-not-working-on-http-request-body/28644783#28644783", "title": "JSON decoder not working on http request body", "body": "<p>The problem is that the json decoder does not deal with private struct fields. The fields in your <code>body</code> structs are private.</p>\n\n<p>Rewrite it like so and it will work:</p>\n\n<pre><code> var body struct {\n        Username string `json:\"username\"` \n        Password string `json:\"password\"`\n }\n</code></pre>\n\n<p>basically the <code>json:\"username\"</code> is a way to tell the json decoder how to map the json name of the object to the struct name. In this instance, for decoding only, it is not necessary - the json decoder is smart enough to make the translation of the upper/lower case. </p>\n\n<p>But if you use the object to encode json as well, you need it, or you'll have upper case field names in the resulting json.</p>\n\n<p>You can use the json struct tags for a few more useful things, like omitting empty field from encoded json, or skipping fields entirely. </p>\n\n<p>You can read more about the JSON struct tags in the documentation for <code>json.Marshal</code>: <a href=\"http://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow\">http://golang.org/pkg/encoding/json/#Marshal</a></p>\n"}], "owner": {"reputation": 958, "user_id": 2626742, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3376e8297d843faf775b3cee1a906f9a?s=128&d=identicon&r=PG", "display_name": "Cody", "link": "https://stackoverflow.com/users/2626742/cody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "closed_date": 1424522629, "accepted_answer_id": 28644783, "answer_count": 1, "score": 0, "last_activity_date": 1424515063, "creation_date": 1424513698, "question_id": 28644600, "link": "https://stackoverflow.com/questions/28644600/json-decoder-not-working-on-http-request-body", "closed_reason": "Duplicate", "title": "JSON decoder not working on http request body", "body": "<p>I'm starting to go crazy trying to get Go to decode this json request body. Here's a sample request:</p>\n\n<pre><code>curl -X POST -d \"{\\\"username\\\":\\\"foo\\\", \\\"password\\\":\\\"bar\\\"}\" http://localhost:3000/users\n</code></pre>\n\n<p>And here's my handler: </p>\n\n<pre><code>mux.HandleFunc(\"/users\", func(rw http.ResponseWriter, req *http.Request) {\n        var body struct {\n            username string\n            password string\n        }\n\n        // buf := make([]byte, req.ContentLength)\n        // req.Body.Read(buf)\n        // fmt.Println(string(buf))\n        //\n        // The above commented out code will correctly print:\n        // {\"username\":\"foo\", \"password\":\"bar\"}\n\n        err := json.NewDecoder(req.Body).Decode(&amp;body)\n        if err != nil {\n            rw.WriteHeader(http.StatusNotAcceptable)\n            return\n        }\n\n        fmt.Printf(\"%+v\\n\", body)\n        // prints -&gt; {username: password:}\n})\n</code></pre>\n\n<p>Like the comment suggests, I can verify that <code>req.Body</code> is indeed correct -- but for whatever reason, <code>json.NewDecoder(req.Body).Decode(&amp;body)</code> never fills out the fields of <code>body</code>.</p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["json", "go", "simplejson"], "answers": [{"comments": [{"owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "edited": false, "score": 1, "creation_date": 1424549922, "post_id": 28645812, "comment_id": 45599048, "body": "thanks - the actual document is quite a bit bigger than this simple subset and the simplejson is more succinct so I&#39;m ok with it. I don&#39;t usually think of &quot;simple&quot; as overkill, but perhaps &quot;simple&quot; in this case refers to the relatively few lines of code - the need to do a type assert isn&#39;t &quot;simple&quot; IMHO."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 2, "last_activity_date": 1424522191, "last_edit_date": 1424522191, "creation_date": 1424521810, "answer_id": 28645812, "question_id": 28643877, "link": "https://stackoverflow.com/questions/28643877/how-do-you-traverse-a-json-file-using-go-simplejson/28645812#28645812", "title": "how do you traverse a json file using go-simplejson", "body": "<p>You can use <a href=\"https://github.com/bitly/go-simplejson/blob/master/simplejson.go#L56\" rel=\"nofollow\"><code>simplejson.Set</code></a>:</p>\n\n<pre><code>for _, doc := range dec.Get(\"data\").Get(\"docs\").MustArray() {\n    out := simplejson.New()\n    // doc is an interface{} holding a map, we have to type assert it.\n    for k, v := range doc.(map[string]interface{}) {\n        out.Set(k, v)\n    }\n    b, _ := out.EncodePretty()\n    fmt.Printf(\"%s\\n\", b)\n}\n</code></pre>\n\n<p>However in that instance, simplejson is an overkill and using a struct / stdlib is more efficient.</p>\n\n<p>For completeness sake, the std lib version:</p>\n\n<pre><code>type DataLayout struct {\n    Data struct {\n        Docs []map[string]string `json:\"docs\"`\n    } `json:\"data\"`\n}\n\nfunc main() {\n    var in DataLayout\n    err := json.NewDecoder(strings.NewReader(j)).Decode(&amp;in)\n    if err != nil {\n        log.Fatal(err)\n    }\n    for _, doc := range in.Data.Docs {\n        b, err := json.MarshalIndent(doc, \"\", \"\\t\")\n        if err != nil {\n            log.Fatal(err)\n        }\n        fmt.Printf(\"%s\\n\", b)\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/-02qd0pFAA\" rel=\"nofollow\"><kbd>play</kbd></a></p>\n\n<p>Notes: </p>\n\n<ul>\n<li>Your json example is wrong, <code>\"key10\", \"val10\"</code> should be <code>\"key10\": \"val10\"</code>.</li>\n<li>When you're in doubt of how a data structure looks and too lazy to read the code, use <code>fmt.Printf(\"%#v\", doc)</code> to see how it looks like. </li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "edited": false, "score": 0, "creation_date": 1424550294, "post_id": 28646098, "comment_id": 45599172, "body": "thanks Juuso. That would work just fine. I think i have to give preference to OneOfOne for succinctness, though. BTW there is a benchmark out there which shows that the Python version of simplejson was 5x faster than encoding/json (<a href=\"https://groups.google.com/forum/#!topic/golang-nuts/zCBUEB_MfVs\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/zCBUEB_MfVs</a>) though it seemed to be controversial. I don&#39;t know enough at this point to attempt a meaningful benchmark myself."}, {"owner": {"reputation": 341, "user_id": 2464828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e37c27e9aab4653f76c56f14a28a5d0?s=128&d=identicon&r=PG&f=1", "display_name": "jhaavist", "link": "https://stackoverflow.com/users/2464828/jhaavist"}, "reply_to_user": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "edited": false, "score": 0, "creation_date": 1424562575, "post_id": 28646098, "comment_id": 45602635, "body": "@JamesFremen Ah, I probably wouldn&#39;t have recommended you to use the standard library should I have known you are dealing with huge files. I recall it having some performance issues. Anyhow, I&#39;m not familiar with simplejson, but I&#39;m glad you found somebody who was."}, {"owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "edited": false, "score": 0, "creation_date": 1453354327, "post_id": 28646098, "comment_id": 57566995, "body": "It looks like go-simplejson just wraps the standard library anyway."}, {"owner": {"reputation": 341, "user_id": 2464828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e37c27e9aab4653f76c56f14a28a5d0?s=128&d=identicon&r=PG&f=1", "display_name": "jhaavist", "link": "https://stackoverflow.com/users/2464828/jhaavist"}, "edited": false, "score": 0, "creation_date": 1461792534, "post_id": 28646098, "comment_id": 61366589, "body": "I prefer few extra lines of code over extra dependencies. Go&#39;s dependency management is still kind of mess which gives you additional reason to avoid any unneeded ones."}], "tags": [], "owner": {"reputation": 341, "user_id": 2464828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e37c27e9aab4653f76c56f14a28a5d0?s=128&d=identicon&r=PG&f=1", "display_name": "jhaavist", "link": "https://stackoverflow.com/users/2464828/jhaavist"}, "is_accepted": false, "score": 1, "last_activity_date": 1424523785, "creation_date": 1424523785, "answer_id": 28646098, "question_id": 28643877, "link": "https://stackoverflow.com/questions/28643877/how-do-you-traverse-a-json-file-using-go-simplejson/28646098#28646098", "title": "how do you traverse a json file using go-simplejson", "body": "<p>Is there any specific reason to use simplejson? A lot of encoding can be done with the <a href=\"http://golang.org/pkg/encoding/json/\" rel=\"nofollow\">standard JSON library</a>.</p>\n\n<p>Using the standard library you could solve your problem like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n)\n\ntype Document struct {\n    Data DataStruct\n}\n\ntype DataStruct struct {\n    Docs []interface{}\n}\n\nfunc main() {\n    doc, err := ioutil.ReadFile(\"./doc.json\")\n    if err != nil {\n        panic(err)\n    }\n    var document Document\n    err = json.Unmarshal(doc, &amp;document)\n    if err != nil {\n        panic(err)\n    }\n    for index := range document.Data.Docs {\n        b, err := json.Marshal(document.Data.Docs[index])\n        if err != nil {\n            panic(err)\n        }\n        err = ioutil.WriteFile(fmt.Sprintf(\"file%d.json\", index), b, 0777)\n        if err != nil {\n            panic(err)\n        }\n        fmt.Println(string(b))\n    }\n}\n</code></pre>\n\n<p>The sample code will provide you two files with contents like this:</p>\n\n<pre><code>{\"key00\":\"val00\",\"key01\":\"val01\"}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>{\"key10\":\"val10\",\"key11\":\"val11\"}\n</code></pre>\n\n<p>However, if you noticed I used the []interface{} notation in the DataStruct, which in general is considered bad practice. You should create a new structure with proper type declarations if your real-world data has any.</p>\n"}], "owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2072, "favorite_count": 1, "accepted_answer_id": 28645812, "answer_count": 2, "score": 3, "last_activity_date": 1424549420, "creation_date": 1424508431, "last_edit_date": 1424549420, "question_id": 28643877, "link": "https://stackoverflow.com/questions/28643877/how-do-you-traverse-a-json-file-using-go-simplejson", "title": "how do you traverse a json file using go-simplejson", "body": "<p>I have a JSON file of the form:</p>\n\n<pre><code>{\n  \"data\": {\n    \"docs\": [\n      {\"key00\": \"val00\", \"key01\": \"val01\"},\n      {\"key10\": \"val10\", \"key11\": \"val11\"}\n    ]\n  }\n}\n</code></pre>\n\n<p>and I would like to convert it to separate JSON docs:</p>\n\n<h2>file0.json</h2>\n\n<pre><code>{\n  {\"key00\": \"val00\", \"key01\": \"val01\"}\n}\n</code></pre>\n\n<h2>file1.json</h2>\n\n<pre><code>{\n   {\"key10\": \"val10\", \"key11\": \"val11\"}\n}\n</code></pre>\n\n<p>I can enumerate over the array contents using:</p>\n\n<pre><code>j, _ := ioutil.ReadFile(path)\ndec, _ := simplejson.NewFromReader(bytes.NewReader(j))\nfor i,v := range dec.Get(\"data\").Get(\"docs\").MustArray() {\n  out := simplejson.New()\n\n  /* ??? move dec key/value pairs to out ??? */\n\n  b, _ := out.EncodePretty()\n  ioutil.WriteFile(outpath, b, 0777)\n}\n</code></pre>\n\n<p>but I'm not sure how to iterate over the key/value pairs within the array entries. It's a nice, succinct library but there don't appear to be a lot of examples and my golang expertise is currently limited.</p>\n\n<p>Any help would be appreciated.. thanks!</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1424505583, "last_edit_date": 1424505583, "creation_date": 1424505272, "answer_id": 28643511, "question_id": 28643361, "link": "https://stackoverflow.com/questions/28643361/google-app-engine-request-basicauth-undefined-type-http-request-has-no-field/28643511#28643511", "title": "Google App Engine: request.BasicAuth undefined (type *http.Request has no field or method BasicAuth)", "body": "<p>The Go AppEngine runtime environment uses Go version 1.2 as you can read it on the <a href=\"https://cloud.google.com/appengine/docs/go/#Go_Introduction\" rel=\"nofollow\">Go Runtime Environment</a> page.</p>\n\n<p>A beta version of 1.4 runtime version is available, you can read more about it here:</p>\n\n<p><a href=\"https://groups.google.com/forum/#!topic/google-appengine-go/ndtQokV3oFo\" rel=\"nofollow\"><strong>go1.4beta is now ready for testing</strong></a></p>\n\n<p>If you want to use the 1.4 beta runtime, you have to specify it in your <code>app.yaml</code> config file like this:</p>\n\n<pre><code>api_version: go1.4beta\n</code></pre>\n\n<p>Note that even though Go 1.4 is out (current version is 1.4.2), the AppEngine runtime version of 1.4 is still not released.</p>\n\n<p>Quoting the relevant part:</p>\n\n<blockquote>\n  <p>Go 1.4 has not yet been released, so the go1.4beta runtime is built \n  from the release-branch.go1.4 of the core Go tree, and may be updated \n  as Go 1.4 approaches. </p>\n  \n  <p>We will not be providing a beta version of the Go 1.4 SDK. You should \n  use goapp deploy (or appcfg.py) from the normal Go App Engine SDK to \n  deploy your app. </p>\n  \n  <p>To use go1.4beta, update your app.yaml file to use the new api_version:</p>\n\n<pre><code>api_version: go1.4beta \n</code></pre>\n  \n  <p>After Go 1.4 is released it will become the basis for api_version \n  'go1', as normal, and 'go1.4beta' will be retired soon afterward. We \n  expect this to happen early next year. </p>\n</blockquote>\n"}], "owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 881, "favorite_count": 0, "accepted_answer_id": 28643511, "answer_count": 1, "score": 2, "last_activity_date": 1424505583, "creation_date": 1424503977, "question_id": 28643361, "link": "https://stackoverflow.com/questions/28643361/google-app-engine-request-basicauth-undefined-type-http-request-has-no-field", "title": "Google App Engine: request.BasicAuth undefined (type *http.Request has no field or method BasicAuth)", "body": "<p>I'm trying to deploy a go app to Google App Engine but compilation is failing because of this error.</p>\n\n<pre><code>request.BasicAuth undefined (type *http.Request has no field or method BasicAuth)\n</code></pre>\n\n<p>I figured this error meant that my google app engine installation was not the latest one so I updated it and now running <code>go_appengine/goapp version</code> returns:</p>\n\n<p><code>go version go1.4.1 (appengine-1.9.18) darwin/amd64</code></p>\n\n<p>I can successfully <code>serve</code> my app but I keep getting this error when I try to <code>deploy</code>. What am I missing?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "owner": {"reputation": 11172, "user_id": 236564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/79e6e72ba745905842a30d2e89cd6980?s=128&d=identicon&r=PG", "display_name": "Kyle Finley", "link": "https://stackoverflow.com/users/236564/kyle-finley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1541436512, "creation_date": 1424502924, "last_edit_date": 1541436512, "question_id": 28643245, "link": "https://stackoverflow.com/questions/28643245/appengine-datastore-encoding-a-slice-of-slices-with-go", "title": "AppEngine Datastore Encoding a Slice of Slices with Go", "body": "<p>I have a need to store a slice of slices in that Datastore. Since the Datastore doesn't support two levels of slices, I have encode the child slice as JSON and store it as a <code>[]byte</code>. I'm using the <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#PropertyLoadSaver\" rel=\"nofollow noreferrer\">PropertyLoadSaver</a> to accomplish this. The saving and loading works, but I've noticed that the saved entity has a empty <code>[]byte</code> for every parent element. After some investigation I discovered this is caused by the <code>Variants.OptionsJSON</code> Property being referenced in the <code>Save()</code> method and also an attribute of the struct.</p>\n\n<p>So my question are:</p>\n\n<ul>\n<li>Is this a bug or am I doing something wrong?</li>\n<li>Is there a better way to accomplish this?</li>\n</ul>\n\n<p>The one constraint I have is that I need to be able to query the entity by one of the \"Variant\" attributes, but not the \"Variant.Options\".</p>\n\n<p>Thanks!</p>\n\n<p>Example:</p>\n\n<p>Given JSON</p>\n\n<pre><code>{\n  \"variants\": [{\n    \"options\": [\n      {\n        \"name\": \"One\",\n        \"value\": \"one\"\n      },{\n        \"name\": \"Two\",\n        \"value\": \"two\"\n      }]\n    }, {\n    \"options\": [\n        {\n        \"name\": \"Three\",\n        \"value\": \"three\"\n        },{\n        \"name\": \"Four\",\n        \"value\": \"four\"\n        }]\n    }]\n  }]\n}\n</code></pre>\n\n<p>How it's stored in the datastore, notice the two empty <code>'', ''</code> attributes at the end:</p>\n\n<pre><code>Entity Kind: Products\nEntity Key: ahBkZXZ-c3RvcmVza2ktY29tchULEghQcm9kdWN0cxiAgICAgNDHCww\nID: 6507459568992256\nVariants.OptionsJSON (list): `['[{\"name\":\"One\",\"value\":\"one\"},{\"name\":\"Two\",\"value\":\"two\"}]', '[{\"name\":\"Three\",\"value\":\"three\"},{\"name\":\"Four\",\"value\":\"four\"}]', '', '']`\n</code></pre>\n\n<p><code>model.go</code></p>\n\n<pre><code>import (\n    \"appengine/datastore\"\n    \"encoding/json\"\n)\n\ntype Option struct {\n    Name  string `json:\"name\"`\n    Value string `json:\"value\"`\n}\n\ntype Variant struct {\n    OptionsJSON []byte   `json:\"-\" datastore:\"OptionsJSON\"`\n    Options     []Option `json:\"options\" datastore:\"-\"`\n}\n\ntype Product struct {\n    Variants []Variant `json:\"variants\"`\n}\n\nfunc (x *Product) Load(c &lt;-chan datastore.Property) error {\n    if err := datastore.LoadStruct(x, c); err != nil {\n        return err\n    }\n    for i, v := range x.Variants {\n        var opts []Option\n        json.Unmarshal(v.OptionsJSON, &amp;opts)\n        x.Variants[i].Options = opts\n    }\n    return nil\n}\n\nfunc (x *Product) Save(c chan&lt;- datastore.Property) error {\n    for _, v := range x.Variants {\n        b, _ := json.Marshal(v.Options)\n        c &lt;- datastore.Property{\n            Name:     \"Variants.OptionsJSON\",\n            Value:    b,\n            NoIndex:  true,\n            Multiple: true,\n        }\n    }\n    return datastore.SaveStruct(x, c)\n}\n</code></pre>\n"}, {"tags": ["database", "go"], "comments": [{"owner": {"reputation": 597, "user_id": 1460991, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a8c1a4a881ddda8411db0c59c6678cf9?s=128&d=identicon&r=PG", "display_name": "FlowRaja", "link": "https://stackoverflow.com/users/1460991/flowraja"}, "edited": false, "score": 0, "creation_date": 1425226671, "post_id": 28642838, "comment_id": 45866186, "body": "Thank you for the replies. I see that most solutions suggest using sql.NullString or database specific library. I wished there was something generic which would run on &quot;database/sql&quot;. For the time being I will use the sql.NullString solution as I have to connect to a remote sqlserver database via ODBC ( I know, painful)."}], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 1460991, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a8c1a4a881ddda8411db0c59c6678cf9?s=128&d=identicon&r=PG", "display_name": "FlowRaja", "link": "https://stackoverflow.com/users/1460991/flowraja"}, "edited": false, "score": 0, "creation_date": 1424526888, "post_id": 28643908, "comment_id": 45590776, "body": "This still does not prevent my trouble of copying from one type to other. The way I see it, for each of the 25+ values, I have to copy from NullString type to String type. Although, it does help me get rid of the functions, which is welcome. So thank you for that."}, {"owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "edited": false, "score": 1, "creation_date": 1424530471, "post_id": 28643908, "comment_id": 45591872, "body": "Yes, you have to handle Null values. In your particular case, you may write some wrapper for that. Also, you may find useful <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">github.com/jmoiron/sqlx</a> package, which can simplify your task."}], "tags": [], "owner": {"reputation": 814, "user_id": 4474211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf24f2226878c4c08d709a6efd3355f?s=128&d=identicon&r=PG", "display_name": "tmichel", "link": "https://stackoverflow.com/users/4474211/tmichel"}, "is_accepted": true, "score": 22, "last_activity_date": 1424508785, "creation_date": 1424508785, "answer_id": 28643908, "question_id": 28642838, "link": "https://stackoverflow.com/questions/28642838/how-do-i-handle-nil-return-values-from-database/28643908#28643908", "title": "How do I handle nil return values from database?", "body": "<p>There are separate types to handle <code>null</code> values coming from the database such as <a href=\"http://godoc.org/database/sql#NullBool\"><code>sql.NullBool</code></a>, <a href=\"http://godoc.org/database/sql#NullFloat64\"><code>sql.NullFloat64</code></a>, etc.</p>\n\n<p>For example:</p>\n\n<pre><code> var s sql.NullString\n err := db.QueryRow(\"SELECT name FROM foo WHERE id=?\", id).Scan(&amp;s)\n ...\n if s.Valid {\n    // use s.String\n } else {\n    // NULL value\n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": false, "score": 8, "last_activity_date": 1424531508, "creation_date": 1424531508, "answer_id": 28647321, "question_id": 28642838, "link": "https://stackoverflow.com/questions/28642838/how-do-i-handle-nil-return-values-from-database/28647321#28647321", "title": "How do I handle nil return values from database?", "body": "<p>go's database/sql package handle pointer of the type.</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    _ \"github.com/mattn/go-sqlite3\"\n    \"log\"\n)\n\nfunc main() {\n    db, err := sql.Open(\"sqlite3\", \":memory:\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer db.Close()\n\n    _, err = db.Exec(\"create table foo(id integer primary key, value text)\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    _, err = db.Exec(\"insert into foo(value) values(null)\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    _, err = db.Exec(\"insert into foo(value) values('bar')\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    rows, err := db.Query(\"select id, value from foo\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    for rows.Next() {\n        var id int\n        var value *string\n        err = rows.Scan(&amp;id, &amp;value)\n        if err != nil {\n            log.Fatal(err)\n        }\n        if value != nil {\n            fmt.Println(id, *value)\n        } else {\n            fmt.Println(id, value)\n        }\n    }\n}\n</code></pre>\n\n<p>You should get like below:</p>\n\n<pre><code>1 &lt;nil&gt;\n2 bar\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45768, "user_id": 13227, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9aa8ec2ad36bb9385a4a0f3840f65ae8?s=128&d=identicon&r=PG", "display_name": "Gary Willoughby", "link": "https://stackoverflow.com/users/13227/gary-willoughby"}, "is_accepted": false, "score": -2, "last_activity_date": 1424537040, "creation_date": 1424537040, "answer_id": 28648274, "question_id": 28642838, "link": "https://stackoverflow.com/questions/28642838/how-do-i-handle-nil-return-values-from-database/28648274#28648274", "title": "How do I handle nil return values from database?", "body": "<p>I've started to use the MyMySql driver as it uses a nicer interface to that of the std library.</p>\n\n<p><a href=\"https://github.com/ziutek/mymysql\" rel=\"nofollow\">https://github.com/ziutek/mymysql</a></p>\n\n<p>I've then wrapped the querying of the database into simple to use functions. This is one such function:</p>\n\n<pre><code>import \"github.com/ziutek/mymysql/mysql\"\nimport _ \"github.com/ziutek/mymysql/native\"\n\n// Execute a prepared statement expecting multiple results.\nfunc Query(sql string, params ...interface{}) (rows []mysql.Row, err error) {\n    statement, err := db.Prepare(sql)\n    if err != nil {\n        return\n    }\n    result, err := statement.Run(params...)\n    if err != nil {\n        return\n    }\n    rows, err = result.GetRows()\n    return\n}\n</code></pre>\n\n<p>To use this is as simple as this snippet:</p>\n\n<pre><code>rows, err := Query(\"SELECT * FROM table WHERE column = ?\", param)\n\nfor _, row := range rows {\n    column1 = row.Str(0)\n    column2 = row.Int(1)\n    column3 = row.Bool(2)\n    column4 = row.Date(3)\n    // etc...\n}\n</code></pre>\n\n<p>Notice the nice row methods for coercing to a particular value. Nulls are handled by the library and the rules are documented here:</p>\n\n<p><a href=\"https://github.com/ziutek/mymysql/blob/master/mysql/row.go\" rel=\"nofollow\">https://github.com/ziutek/mymysql/blob/master/mysql/row.go</a></p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7076892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ace0f6d11b93cbacfe6f4a68292fd7?s=128&d=identicon&r=PG&f=1", "display_name": "M.L.", "link": "https://stackoverflow.com/users/7076892/m-l"}, "is_accepted": false, "score": 2, "last_activity_date": 1485968761, "creation_date": 1485968761, "answer_id": 41985533, "question_id": 28642838, "link": "https://stackoverflow.com/questions/28642838/how-do-i-handle-nil-return-values-from-database/41985533#41985533", "title": "How do I handle nil return values from database?", "body": "<p>An alternative solution would be to handle this in the SQL statement itself by using the COALESCE function (though not all DB's may support this).</p>\n\n<p>For example you could instead use:</p>\n\n<pre><code>q := fmt.Sprintf(\"SELECT id,COALESCE(state, '') as state FROM Mytable WHERE id='%s' \", ud)\n</code></pre>\n\n<p>which would effectively give 'state' a default value of an empty string in the event that it was stored as a NULL in the db.</p>\n"}, {"tags": [], "owner": {"reputation": 1386, "user_id": 1661186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1yBT.png?s=128&g=1", "display_name": "Darlan D.", "link": "https://stackoverflow.com/users/1661186/darlan-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1598903060, "creation_date": 1598903060, "answer_id": 63677213, "question_id": 28642838, "link": "https://stackoverflow.com/questions/28642838/how-do-i-handle-nil-return-values-from-database/63677213#63677213", "title": "How do I handle nil return values from database?", "body": "<p>Two ways to handle those nulls:</p>\n<p>Using sql.NullString</p>\n<pre><code>if value.Valid { \n   return value.String\n} \n</code></pre>\n<p>Using *string</p>\n<pre><code>if value != nil {\n   return *value\n}\n</code></pre>\n<p><a href=\"https://medium.com/@raymondhartoyo/one-simple-way-to-handle-null-database-value-in-golang-86437ec75089\" rel=\"nofollow noreferrer\">https://medium.com/@raymondhartoyo/one-simple-way-to-handle-null-database-value-in-golang-86437ec75089</a></p>\n"}], "owner": {"reputation": 597, "user_id": 1460991, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a8c1a4a881ddda8411db0c59c6678cf9?s=128&d=identicon&r=PG", "display_name": "FlowRaja", "link": "https://stackoverflow.com/users/1460991/flowraja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12703, "favorite_count": 4, "accepted_answer_id": 28643908, "answer_count": 5, "score": 11, "last_activity_date": 1598903060, "creation_date": 1424499656, "last_edit_date": 1424526631, "question_id": 28642838, "link": "https://stackoverflow.com/questions/28642838/how-do-i-handle-nil-return-values-from-database", "title": "How do I handle nil return values from database?", "body": "<p>I am writing a basic program to read values from database table and print in table. The table was populated by an ancient program. Some of the fields in the row are optional and when I try to read them as string, I get the following error:</p>\n\n<pre><code>panic: sql: Scan error on column index 2: unsupported driver -&gt; Scan pair: &lt;nil&gt; -&gt; *string\n</code></pre>\n\n<p>After I read other questions for similar issues, I came up with following code to handle the nil values. The method works fine in practice. I get the values in plain text and empty string instead of the nil values.</p>\n\n<p>However, I have two concerns:</p>\n\n<ol>\n<li>This does not look efficient. I need to handle 25+ fields like this and that would mean I read each of them as bytes and convert to string. Too many function calls and conversions. Two structs to handle the data and so on...</li>\n<li>The code looks ugly. It is already looking convoluted with 2 fields and becomes unreadable as I go to 25+</li>\n</ol>\n\n<p>Am I doing it wrong? Is there a better/cleaner/efficient/idiomatic golang way to read values from database?</p>\n\n<p>I find it hard to believe that a modern language like Go would not handle the database returns gracefully.</p>\n\n<p>Thanks in advance!</p>\n\n<p><strong>Code snippet:</strong></p>\n\n<pre><code>// DB read format\ntype udInfoBytes struct {\n  id                     []byte\n  state                  []byte\n}\n\n// output format\ntype udInfo struct {\n  id                     string\n  state                  string\n}\n\nfunc CToGoString(c []byte) string {\n  n := -1\n  for i, b := range c {\n    if b == 0 {\n      break\n    }\n    n = i\n  }\n  return string(c[:n+1])\n}\n\nfunc dbBytesToString(in udInfoBytes) udInfo {\n\n  var out udInfo\n  var s string\n  var t int\n\n  out.id = CToGoString(in.id)\n  out.state = stateName(in.state)\n  return out\n}\n\nfunc GetInfo(ud string) udInfo {\n\n  db := getFileHandle()\n  q := fmt.Sprintf(\"SELECT id,state FROM Mytable WHERE id='%s' \", ud)\n\n  rows, err := db.Query(q)\n  if err != nil {\n    log.Fatal(err)\n  }\n  defer rows.Close()\n  ret := udInfo{}\n  r := udInfoBytes{}\n  for rows.Next() {\n    err := rows.Scan(&amp;r.id, &amp;r.state)\n\n    if err != nil {\n      log.Println(err)\n    }\n    break\n  }\n  err = rows.Err()\n  if err != nil {\n    log.Fatal(err)\n  }\n\n  ret = dbBytesToString(r)\n  defer db.Close()\n  return ret\n}\n</code></pre>\n\n<p><strong>edit:</strong></p>\n\n<p>I want to have something like the following where I do no have to worry about handling NULL and automatically read them as empty string.</p>\n\n<pre><code>// output format\ntype udInfo struct {\n  id                     string\n  state                  string\n}\n\nfunc GetInfo(ud string) udInfo {\n\n  db := getFileHandle()\n  q := fmt.Sprintf(\"SELECT id,state FROM Mytable WHERE id='%s' \", ud)\n\n  rows, err := db.Query(q)\n  if err != nil {\n    log.Fatal(err)\n  }\n  defer rows.Close()\n  r := udInfo{}\n\n  for rows.Next() {\n    err := rows.Scan(&amp;r.id, &amp;r.state)\n\n    if err != nil {\n      log.Println(err)\n    }\n    break\n  }\n  err = rows.Err()\n  if err != nil {\n    log.Fatal(err)\n  }\n\n  defer db.Close()\n  return r\n}\n</code></pre>\n"}, {"tags": ["go", "append", "rune"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1424478030, "post_id": 28640097, "comment_id": 45579995, "body": "Added a caveat about safely appending slices: unlike with strings, they let you mutate shared memory, so modifying one slice can surprisingly change the memory pointed to by another. Your example is fine, but I figure this is a useful warning to any <code>[]rune</code> appenders that may come across this page. :)"}], "answers": [{"comments": [{"owner": {"reputation": 7010, "user_id": 1485952, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e3fc3dc2f82fa799629b1660101c896e?s=128&d=identicon&r=PG", "display_name": "fnkr", "link": "https://stackoverflow.com/users/1485952/fnkr"}, "edited": false, "score": 0, "creation_date": 1424478439, "post_id": 28640276, "comment_id": 45580110, "body": "How do I get it working if <code>lettersLower</code> and <code>lettersUpper</code> are constants?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 7010, "user_id": 1485952, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e3fc3dc2f82fa799629b1660101c896e?s=128&d=identicon&r=PG", "display_name": "fnkr", "link": "https://stackoverflow.com/users/1485952/fnkr"}, "edited": false, "score": 2, "creation_date": 1424479069, "post_id": 28640276, "comment_id": 45580268, "body": "If they were constants like <code>const</code>, they can only be strings, not <code>[]rune</code>s, so you&#39;d have to convert at runtime (or just not make them <code>const</code> in the first place, as you did). But the bit about slices being potentially shared memory wasn&#39;t meant to scare you off here--your <code>append</code> looks fine--just a general warning about how slices aren&#39;t exactly like strings."}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 14, "last_activity_date": 1424478103, "last_edit_date": 1424478103, "creation_date": 1424476793, "answer_id": 28640276, "question_id": 28640097, "link": "https://stackoverflow.com/questions/28640097/cannot-use-type-rune-as-type-rune-in-append/28640276#28640276", "title": "cannot use type []rune as type rune in append", "body": "<p>It's because <a href=\"http://golang.org/ref/spec#Appending_and_copying_slices\"><code>append</code> doesn't take a list to append, but rather one or more <em>items</em> to append</a>. You can adapt to this with a <code>...</code> on the second argument to <code>append</code>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar lettersLower = []rune(\"abcdefghijklmnopqrstuvwxyz\")\nvar lettersUpper = []rune(\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\")\n\nfunc main() {\n    x := append(lettersLower, lettersUpper...)\n    fmt.Println(len(x))\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/Oti9L1jww5\">Try it out on the Playground</a>.</p>\n\n<p>Note that <code>append</code> does not always re-allocate the underlying array (that would cause problems in terms of performance and memory usage). You're fine as far as this sample goes, but it may bite you if you ever try to use the same memory for multiple purposes. A (contrived, perhaps unclear) <a href=\"http://play.golang.org/p/Xo2psr-iGz\">example</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    foo := []byte(\"this is a BIG OLD TEST!!\\n\")\n    tst := []byte(\"little test\")\n    bar := append(foo[:10], tst...)\n\n    // now bar is right, but foo is a mix of old and new text!\n    fmt.Print(\"without copy, foo after:  \")\n    os.Stdout.Write(foo)\n\n    // ok, now the same exercise but with an explicit copy of foo\n    foo = []byte(\"this is a BIG OLD TEST!!\\n\")\n    bar = append([]byte(nil), foo[:10]...) // copies foo[:10]\n    bar = append(bar, tst...)\n\n    // this time we modified a copy, and foo is its original self\n    fmt.Print(\"with a copy, foo after:   \")\n    os.Stdout.Write(foo)\n}\n</code></pre>\n\n<p>When you try to print <code>foo</code> after appending to a subslice of it, you get a weird mix of old and new content.</p>\n\n<p>Where the shared underlying array is a problem, you could either use strings (string bytes are immutable, a pretty effective guard against accidental overwrites) or make a copy as I did with <code>append([]byte(nil), foo[:10]...)</code> above.</p>\n"}], "owner": {"reputation": 7010, "user_id": 1485952, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e3fc3dc2f82fa799629b1660101c896e?s=128&d=identicon&r=PG", "display_name": "fnkr", "link": "https://stackoverflow.com/users/1485952/fnkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12969, "favorite_count": 0, "accepted_answer_id": 28640276, "answer_count": 1, "score": 5, "last_activity_date": 1424478103, "creation_date": 1424475521, "question_id": 28640097, "link": "https://stackoverflow.com/questions/28640097/cannot-use-type-rune-as-type-rune-in-append", "title": "cannot use type []rune as type rune in append", "body": "<pre><code>package main\n\nvar lettersLower = []rune(\"abcdefghijklmnopqrstuvwxyz\")\nvar lettersUpper = []rune(\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\")\n\nfunc main() {\n    x := append(lettersLower, lettersUpper)\n}\n</code></pre>\n\n<p>Why does this not work? How can I append <code>lettersLower</code> and <code>lettersUpper</code>?</p>\n\n<pre><code>prog.go:7: cannot use lettersUpper (type []rune) as type rune in append\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ovx_o2rKPC\" rel=\"noreferrer\">https://play.golang.org/p/ovx_o2rKPC</a></p>\n"}, {"tags": ["go", "buffer"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 9, "last_activity_date": 1424478026, "creation_date": 1424478026, "answer_id": 28640475, "question_id": 28639859, "link": "https://stackoverflow.com/questions/28639859/writing-into-fixed-size-buffers-in-golang-with-offsets/28640475#28640475", "title": "Writing into fixed size Buffers in Golang with offsets", "body": "<p>You don't need to reallocate the slice for <code>bytes.Buffer</code>, or if you do, you need to set the cap not the len:</p>\n\n<pre><code>buf := bytes.NewBuffer(make([]byte, 0, 52)) // or simply\nbuf := bytes.NewBuffer(nil)\n</code></pre>\n\n<p>There's also <code>buf.Reset()</code> but that's an overkill for that specific example.</p>\n\n<p><a href=\"http://golang.org/pkg/builtin/#make\">make(slice, size, cap)</a>:</p>\n\n<blockquote>\n  <p>Slice: The size specifies the length. The capacity of the slice is\n  equal to its length. A second integer argument may be provided to\n  specify a different capacity; it must be no smaller than the\n  length, so make([]int, 0, 10) allocates a slice of length 0 and\n  capacity 10.</p>\n</blockquote>\n"}], "owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3363, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1424565213, "creation_date": 1424474156, "last_edit_date": 1424565213, "question_id": 28639859, "link": "https://stackoverflow.com/questions/28639859/writing-into-fixed-size-buffers-in-golang-with-offsets", "title": "Writing into fixed size Buffers in Golang with offsets", "body": "<p>I'm new to Golang and I'm trying to write into a Buffer that should be 0 filled to a specific size before starting writing into it.</p>\n\n<p>My try:</p>\n\n<pre><code>buf := bytes.NewBuffer(make([]byte, 52))\n\nvar pktInfo uint16 = 243\nvar pktSize uint16 = 52\nvar pktLine uint16 = binary.LittleEndian.Uint16(data)\nvar pktId uint16 = binary.LittleEndian.Uint16(data[6:])\n\n// header\nbinary.Write(buf, binary.LittleEndian, pktInfo)\nbinary.Write(buf, binary.LittleEndian, pktSize)\nbinary.Write(buf, binary.LittleEndian, pktLine)\n\n// body\nbinary.Write(buf, binary.LittleEndian, pktId)\n(...a lot more)\n\nfmt.Printf(\"%x\\n\", data)\nfmt.Printf(\"%x\\n\", buf.Bytes())\n</code></pre>\n\n<p>Problem is it writes after the bytes instead of writing from the start. How do I do that?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 785, "user_id": 1115689, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d1238602ae2a7c4d5761da1710a49ac?s=128&d=identicon&r=PG&f=1", "display_name": "Lance", "link": "https://stackoverflow.com/users/1115689/lance"}, "edited": false, "score": 0, "creation_date": 1424461041, "post_id": 28636712, "comment_id": 45573357, "body": "Thanks for the answer. That&#39;s the blog I&#39;m reading. I just don&#39;t see the usage where I&#39;d need it. However what I found it&#39;s useful for <code>copy()</code>, but <code>append()</code> apparently creates a new slice."}, {"owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "reply_to_user": {"reputation": 785, "user_id": 1115689, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d1238602ae2a7c4d5761da1710a49ac?s=128&d=identicon&r=PG&f=1", "display_name": "Lance", "link": "https://stackoverflow.com/users/1115689/lance"}, "edited": false, "score": 4, "creation_date": 1424461182, "post_id": 28636712, "comment_id": 45573430, "body": "append() only creates a new slice if it needs to. It will also preallocate more space than needed so it doesn&#39;t do a full copy each time. <a href=\"http://play.golang.org/p/U5hh-m-eUB\" rel=\"nofollow noreferrer\">play.golang.org/p/U5hh-m-eUB</a>"}], "tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": true, "score": 14, "last_activity_date": 1424460989, "last_edit_date": 1424460989, "creation_date": 1424460390, "answer_id": 28636712, "question_id": 28636235, "link": "https://stackoverflow.com/questions/28636235/what-is-the-purpose-of-capacity-in-make-of-go-language/28636712#28636712", "title": "What is the purpose of capacity in make() of go language?", "body": "<p>A slice has three parts. A pointer to an underlying array, a length, and a capacity. The length is the length of the array according to program logic and capacity is the true length of the underlying array.</p>\n\n<p>The capacity is fixed without reallocating. The length can be changed whenever you want as long as the final length doesn't exceed the capacity. In this case you can do <code>arr[:7]</code> and your array will be length 7 but still capacity 10. If you do <code>arr[:11]</code>, you will get an error because you can't grow the slice that large without reallocating.</p>\n\n<p>You may want to read this for a more in depth discussion of slices:\n<a href=\"http://blog.golang.org/go-slices-usage-and-internals\">http://blog.golang.org/go-slices-usage-and-internals</a></p>\n"}], "owner": {"reputation": 785, "user_id": 1115689, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d1238602ae2a7c4d5761da1710a49ac?s=128&d=identicon&r=PG&f=1", "display_name": "Lance", "link": "https://stackoverflow.com/users/1115689/lance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2711, "favorite_count": 1, "accepted_answer_id": 28636712, "answer_count": 1, "score": 3, "last_activity_date": 1424460989, "creation_date": 1424458566, "last_edit_date": 1424459389, "question_id": 28636235, "link": "https://stackoverflow.com/questions/28636235/what-is-the-purpose-of-capacity-in-make-of-go-language", "title": "What is the purpose of capacity in make() of go language?", "body": "<p>I'm learning golang, and confused about the capacity in slice.<br>\nFor example  <code>arr := make([]float64, 5, 10)</code><br>\nI have an array of 5 values, and its capacity is 10. If I assign a value to 8th position, the compiler would throw an error index is out of range. If I grow a slice, but it creates a new slice (see the doc that I copied from the official go language). </p>\n\n<p>Here's the slice doc:</p>\n\n<p>\"Slicing does not copy the slice's data. It creates a new slice value that points to the original array.\" \n\"To increase the capacity of a slice one must create a new, larger slice and copy the contents of the original slice into it. \"</p>\n\n<p><strong>So what's the purpose of capacity?</strong></p>\n\n<p>Thanks</p>\n"}, {"tags": ["json", "rest", "go", "query-parameters", "json-api"], "answers": [{"comments": [{"owner": {"reputation": 5238, "user_id": 923636, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/65f4604519e22965923bc4d8e4582c1f?s=128&d=identicon&r=PG", "display_name": "GTDev", "link": "https://stackoverflow.com/users/923636/gtdev"}, "edited": false, "score": 0, "creation_date": 1424553467, "post_id": 28651349, "comment_id": 45600243, "body": "Yea I found it a few hours later.  It was stashed in that parameter.  r.URL.Query().  I&#39;m pretty new and I had a hard time recognizing the interface in the source code.  Thanks."}], "tags": [], "owner": {"reputation": 7026, "user_id": 1819790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347c3c5ef51a2d03a87e9fbb099e9d6c?s=128&d=identicon&r=PG&f=1", "display_name": "pswaminathan", "link": "https://stackoverflow.com/users/1819790/pswaminathan"}, "is_accepted": true, "score": 2, "last_activity_date": 1424552954, "creation_date": 1424552954, "answer_id": 28651349, "question_id": 28635895, "link": "https://stackoverflow.com/questions/28635895/adding-query-parameters-to-go-json-rest/28651349#28651349", "title": "Adding query Parameters to Go Json Rest", "body": "<p>Given that go-json-rest is a thin wrapper on top of <code>net/http</code>, have you looked at <a href=\"http://golang.org/pkg/net/http/\" rel=\"nofollow\">that package's documentation</a>? Specifically, <a href=\"http://golang.org/pkg/net/http/#Request\" rel=\"nofollow\">the Request object</a> has a field <code>Form</code> that contains a parsed map of query string values as well as <code>POST</code> data, that you can access as a <code>url.Values</code> (<code>map[string][]string</code>), or retrieve one in particular from <code>FormValue</code>.</p>\n"}], "owner": {"reputation": 5238, "user_id": 923636, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/65f4604519e22965923bc4d8e4582c1f?s=128&d=identicon&r=PG", "display_name": "GTDev", "link": "https://stackoverflow.com/users/923636/gtdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1596, "favorite_count": 0, "accepted_answer_id": 28651349, "answer_count": 1, "score": 1, "last_activity_date": 1517657765, "creation_date": 1424457385, "last_edit_date": 1517657765, "question_id": 28635895, "link": "https://stackoverflow.com/questions/28635895/adding-query-parameters-to-go-json-rest", "title": "Adding query Parameters to Go Json Rest", "body": "<p>I am using the library go-json-rest.  I'm trying to recognize queries parameters in the code for example localhost:8080/reminders?hello=world I want to access {hello: world} .  I have the following code:</p>\n\n<pre><code>//in another function\n&amp;rest.Route{\"GET\", \"/reminders\", i.GetAllReminders},\n\nfunc (i *Impl) GetAllReminders(w rest.ResponseWriter, r *rest.Request) {\n    reminders := []Reminder{}\n    i.DB.Find(&amp;reminders)\n    w.WriteJson(&amp;reminders)\n}\n</code></pre>\n\n<p>I know that r.PathParams holds the url parameters but I cannot seem to find how to the query parameters past the \"?\" in the url.</p>\n"}, {"tags": ["go", "local-storage"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1424471323, "post_id": 28635815, "comment_id": 45578046, "body": "No. Cookies are transported in the HTTP header, local storage stuff happens on the browser via JavaScript only so you&#39;ll have to send HTML with JavaScript code."}, {"owner": {"reputation": 64568, "user_id": 399317, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/28235d26ee007743c9d2150759d29139?s=128&d=identicon&r=PG", "display_name": "Kos", "link": "https://stackoverflow.com/users/399317/kos"}, "edited": false, "score": 0, "creation_date": 1424520120, "post_id": 28635815, "comment_id": 45588839, "body": "Why would you want to do this? Could you give some more context so that we can suggest an alternative?"}, {"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "reply_to_user": {"reputation": 64568, "user_id": 399317, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/28235d26ee007743c9d2150759d29139?s=128&d=identicon&r=PG", "display_name": "Kos", "link": "https://stackoverflow.com/users/399317/kos"}, "edited": false, "score": 0, "creation_date": 1424567314, "post_id": 28635815, "comment_id": 45603712, "body": "@Kos I wish to store some information in the browser that&#39;s too big for a cookie. I thought if Go could set a cookie (i.e. reach the browser), there must be a way for Go to store more information via local storage. The function with the information I wish to store doesn&#39;t otherwise return to the browser (i.e. as part of an http request)"}], "answers": [{"tags": [], "owner": {"reputation": 379, "user_id": 4957776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ysbI13XBjI0/AAAAAAAAAAI/AAAAAAAABgY/JVUc-03Aegs/photo.jpg?sz=128", "display_name": "Gaurang Patel", "link": "https://stackoverflow.com/users/4957776/gaurang-patel"}, "is_accepted": false, "score": 6, "last_activity_date": 1522384043, "creation_date": 1522384043, "answer_id": 49568365, "question_id": 28635815, "link": "https://stackoverflow.com/questions/28635815/set-to-localstorage-from-a-server-side-language/49568365#49568365", "title": "set to localStorage from a server side language", "body": "<p><code>localStorate</code> is meant for reading/writing on the client side only. It's not possible to set it from the server side code as you do with cookies using <code>Set-Cookie</code> response header. More information on <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage\" rel=\"noreferrer\">localStorage</a>.</p>\n"}], "owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4445, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1522384043, "creation_date": 1424457103, "question_id": 28635815, "link": "https://stackoverflow.com/questions/28635815/set-to-localstorage-from-a-server-side-language", "title": "set to localStorage from a server side language", "body": "<p>If it's possible to set a cookie from a server side language, is it possible for a server side language to store data in the localStorage property of a browser? I'm interested in doing it in Go but I suppose the principle would be the same in any language. Go has a <code>SetCookie</code>  to set a Cookie but not a function to set localStorage. Is there a way to implement it?  </p>\n\n<pre><code>    http.SetCookie(w, cookie)\n</code></pre>\n"}, {"tags": ["mysql", "templates", "struct", "go", "range"], "answers": [{"comments": [{"owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "edited": false, "score": 0, "creation_date": 1424457641, "post_id": 28635897, "comment_id": 45571719, "body": "If I do that I only return the last entry in mysql when I need to return all entries (comments)"}, {"owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "reply_to_user": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "edited": false, "score": 0, "creation_date": 1424458175, "post_id": 28635897, "comment_id": 45571952, "body": "For your <code>post.html</code> you are passing in a single <code>Post</code> not a slice of <code>Post</code>s, there is nothing to range over."}, {"owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "edited": false, "score": 0, "creation_date": 1424458235, "post_id": 28635897, "comment_id": 45571988, "body": "Ok darn it :( I need to pass in a post and comment(s) back to drawing board I think"}], "tags": [], "owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "is_accepted": true, "score": 0, "last_activity_date": 1424457398, "creation_date": 1424457398, "answer_id": 28635897, "question_id": 28635032, "link": "https://stackoverflow.com/questions/28635032/go-template-to-loop-range-out-comments/28635897#28635897", "title": "Go Template to loop (range) out comments", "body": "<blockquote>\n  <p>Do i need to specify to only range over 2 elements in my Struct ?</p>\n</blockquote>\n\n<p>You don't need to range over fields in a <code>struct</code>, this would be enough since you are just passing one post to <code>post.html</code> : </p>\n\n<pre><code>&lt;p&gt;{{.Name}}&lt;/p&gt;\n&lt;p&gt;{{.Comment}}&lt;/p&gt;\n</code></pre>\n"}], "owner": {"reputation": 714, "user_id": 131778, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/4d30e77161509fd297a6db23352e65b5?s=128&d=identicon&r=PG", "display_name": "adamprocter", "link": "https://stackoverflow.com/users/131778/adamprocter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 28635897, "answer_count": 1, "score": 0, "last_activity_date": 1424457398, "creation_date": 1424454049, "question_id": 28635032, "link": "https://stackoverflow.com/questions/28635032/go-template-to-loop-range-out-comments", "title": "Go Template to loop (range) out comments", "body": "<p>At the end of my posts.html I need to loop over 2 elements in the Struct as without range I just get the last entry in mysql but although the rest of the structure stuff above is rendering fine the html output stops when it hits the range. Do i need to specify to only range over 2 elements in my Struct ?</p>\n\n<pre><code>{{range .}}\n&lt;p&gt;{{.Name}}&lt;/p&gt;\n&lt;p&gt;{{.Comment}}&lt;/p&gt;\n{{end}}\n</code></pre>\n\n<p>Here is my current go code - <a href=\"http://play.golang.org/p/QMT12qfaoC\" rel=\"nofollow\">http://play.golang.org/p/QMT12qfaoC</a></p>\n\n<p>As an aside I have also lost the ability to render only mysql data matching the URL which also needs fixing.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 7, "creation_date": 1424453923, "post_id": 28634648, "comment_id": 45569792, "body": "Safety reasons only. Strong strict typing makes errors less likely. Your example where you use a &quot;specialstring&quot; implies that it is a string and one might get the impression of subtyping which Go does not have. You introduce a <code>type foobar string</code> to have a foobar (which actually is a string), but why should it make sense to print a foobar with your printstring function? A foobar is not <code>string</code>, it is foobar. If a plain string is all you need, then there is no need to introduce a &quot;specialstring&quot;, just use plain string."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1424454633, "post_id": 28634648, "comment_id": 45570164, "body": "Also here is some more reasoning in the official FAQ: <a href=\"http://golang.org/doc/faq#conversions\" rel=\"nofollow noreferrer\">Why does Go not provide implicit numeric conversions?</a>"}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 2, "creation_date": 1424483866, "post_id": 28634648, "comment_id": 45581300, "body": "Also consider the design of parts of the library like <code>time.Duration</code>.  The language prevents plain <code>int64</code>s from being treated as <code>time.Duration</code> without the expliclt units consideration.  The feature that you&#39;re critiquing can (and is!) used to encode the &quot;same units&quot; rule we know from middle school.  When used well, it should make it more difficult to make the same kinds of mistakes that sends satellites crashing out of the sky due to a metric conversion error."}], "answers": [{"comments": [{"owner": {"reputation": 1934, "user_id": 3117035, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EtZfm.jpg?s=128&g=1", "display_name": "JVMATL", "link": "https://stackoverflow.com/users/3117035/jvmatl"}, "edited": false, "score": 1, "creation_date": 1424929395, "post_id": 28642942, "comment_id": 45755390, "body": "I found this answer informative, and so I up-voted it, but ultimately I  selected divan&#39;s answer, because his answer was more directly aimed at the crux of my question: &quot;what problem does this solve?&quot; -- I was really looking for &quot;why did the language designers think this behavior was a good idea&quot; rather than &quot;what aspects of the language&#39;s implementation cause it to work this way?&quot; -- nevertheless I thank you for taking the time to explain in such excellent detail."}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 3, "last_activity_date": 1424500594, "creation_date": 1424500594, "answer_id": 28642942, "question_id": 28634648, "link": "https://stackoverflow.com/questions/28634648/why-does-golang-prohibit-assignment-to-same-underlying-type-when-one-is-a-native/28642942#28642942", "title": "Why does golang prohibit assignment to same underlying type when one is a native type?", "body": "<p>This is because Go does not have class inheritance. It uses struct composition instead. Named types do not inherit properties from their underlying type (that's why it's not called \"base type\").</p>\n\n<p>So when you declare a named type <code>specialString</code> with an underlying type of a predefined type <code>string</code>, your new type is a completely different type from the underlying one. This is because Go assumes you will want to assign different behaviors to your new type, and will not check its underlying type until run-time. This is why Go is both a static and dynamic language.</p>\n\n<p>When you print </p>\n\n<pre><code>fmt.Println(reflect.TypeOf(ss))        // specialString\n</code></pre>\n\n<p>You get <code>specialString</code>, not <code>string</code>. If you take a look at <code>Println()</code> the definition is as follows:</p>\n\n<pre><code>func Println(a ...interface{}) (n int, err error) {\n        return Fprintln(os.Stdout, a...)\n}\n</code></pre>\n\n<p>This means you can print any predeclared types (int, float64, string) because all of them implements <strong>at least zero methods</strong>, which makes them already conform to the empty interface and pass as \"printable\", but not your named type <code>specialString</code> which remains unknown to Go during compile time. We can check by printing the type of our <code>interface{}</code> against <code>specialString</code>. </p>\n\n<pre><code>type specialString string \ntype anything interface{}\n\ns := string(\"cheese\")\nss := specialString(\"special cheese\")\nat := anything(\"any cheese\")\n\nfmt.Println(reflect.TypeOf(ss))     // specialString\nfmt.Println(reflect.TypeOf(s))      // string\nfmt.Println(reflect.TypeOf(at))     // Wow, this is also string!\n</code></pre>\n\n<p>You can see that <code>specialString</code> keeps being naughty to its identity. Now, see how it does when passed into a function at run-time</p>\n\n<pre><code>func printAnything(i interface{}) {\n        fmt.Println(i)\n}\n\nfmt.Println(ss.(interface{}))       // Compile error! ss isn't interface{} but\nprintAnything(ss)                   // prints \"special cheese\" alright\n</code></pre>\n\n<p><code>ss</code> has become passable as <code>interface{}</code> to the function. By that time Go has already made <code>ss</code> an <code>interface{}</code>.</p>\n\n<p>If you really want to understand deep down the hood this <a href=\"http://research.swtch.com/interfaces\" rel=\"nofollow\">article on interfaces</a> is really priceless.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 2908138, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HNo9a.jpg?s=128&g=1", "display_name": "im7mortal", "link": "https://stackoverflow.com/users/2908138/im7mortal"}, "edited": false, "score": 0, "creation_date": 1544829742, "post_id": 28645319, "comment_id": 94427809, "body": "<b>I am totally not agree</b>. Go allow to do indexing for <code>type Email string</code>. <code>Email[:]</code> is valid in first case but definitely will cause a compilation error at the second one. Turn out that it will not save developers from <i>shooting yourself in the foot</i>.  I also questioned this question and decided for myself that it&#39;s an opinionated decision among early golang developers. And I need to accept it."}], "tags": [], "owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "is_accepted": true, "score": 6, "last_activity_date": 1424518725, "creation_date": 1424518725, "answer_id": 28645319, "question_id": 28634648, "link": "https://stackoverflow.com/questions/28634648/why-does-golang-prohibit-assignment-to-same-underlying-type-when-one-is-a-native/28645319#28645319", "title": "Why does golang prohibit assignment to same underlying type when one is a native type?", "body": "<p>I believe the initial authors' logic here is that named type is named for a reason - it represents something different, not just underlying type.</p>\n\n<p>I guess I've read it somewhere in golang-nuts, but can't remember exact discussion.</p>\n\n<p>Consider the following example:</p>\n\n<pre><code>type Email string\n</code></pre>\n\n<p>You named it Email, because you need to represent e-mail entity, and 'string' is just simplified representation of it, sufficient for the very start. But later, you may want to change Email to something more complex, like:</p>\n\n<pre><code>type Email struct {\n    Address string\n    Name    string\n    Surname string\n}\n</code></pre>\n\n<p>And that will break all your code that work with Email implicitly assuming it's a string.</p>\n"}], "owner": {"reputation": 1934, "user_id": 3117035, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EtZfm.jpg?s=128&g=1", "display_name": "JVMATL", "link": "https://stackoverflow.com/users/3117035/jvmatl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 867, "favorite_count": 0, "accepted_answer_id": 28645319, "answer_count": 2, "score": 2, "last_activity_date": 1424518725, "creation_date": 1424452832, "question_id": 28634648, "link": "https://stackoverflow.com/questions/28634648/why-does-golang-prohibit-assignment-to-same-underlying-type-when-one-is-a-native", "title": "Why does golang prohibit assignment to same underlying type when one is a native type?", "body": "<p>Consider this code:</p>\n\n<pre><code>package main\nimport \"fmt\"\n\ntype specialString string\n\nfunc printString(s string) {\n    fmt.Println(s)\n}\n\n// unlike, say, C++, this is not legal GO, because it redeclares printString\n//func printString(s specialString) {    \n//  fmt.Println(\"Special: \" + s)\n//}\n\nfunc main() {\n    ss := specialString(\"cheese\")\n    // ... so then why shouldn't this be allowed?\n    printString(ss)\n}\n</code></pre>\n\n<p>My question is: <em>why</em> is the language defined so that the call to <code>printString(ss)</code> in <code>main()</code> is not allowed? (I'm not looking for answers that point to the Golang rules on assignment; I have already read them, and I see that both specialString and string have the same 'underlying type' and both types are 'named' -- if you consider the generic type 'string' to be named, which Golang apparently does -- and so they are not assignable under the rules.) </p>\n\n<p>But <em>why</em> are the rules like that? What problem is solved by treating the built-in types as 'named' types, and preventing you from passing named types to all the standard library functions that accepting the same underlying built-in type? Does anybody know what the language designers had in mind here? </p>\n\n<p>From my point of view, it seems to create a lot of pointless type conversion in the code, and <em>discourages</em> the use of strong typing where it actually would make sense..</p>\n"}, {"tags": ["concurrency", "go", "channel"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1424452769, "post_id": 28634576, "comment_id": 45569097, "body": "Use select with default clause as in <a href=\"https://github.com/gorilla/websocket/blob/ab5b3a61f5b6aa323d66ece457334396c4ccdd03/examples/chat/hub.go#L42-L47\" rel=\"nofollow noreferrer\">this websocket example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1034, "user_id": 2089648, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b29d87d89de9c1abac217464e57b191?s=128&d=identicon&r=PG", "display_name": "user2089648", "link": "https://stackoverflow.com/users/2089648/user2089648"}, "is_accepted": true, "score": 5, "last_activity_date": 1424453709, "creation_date": 1424453709, "answer_id": 28634932, "question_id": 28634576, "link": "https://stackoverflow.com/questions/28634576/golang-prevent-channel-from-blocking/28634932#28634932", "title": "Golang prevent channel from blocking", "body": "<p>As ThunderCat pointed out in his comment the solution is </p>\n\n<pre><code>func (u *User) Send(msg []byte){\n    select{\n    case u.send &lt;- msg:\n    default: //Error handling here\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1034, "user_id": 2089648, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b29d87d89de9c1abac217464e57b191?s=128&d=identicon&r=PG", "display_name": "user2089648", "link": "https://stackoverflow.com/users/2089648/user2089648"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2743, "favorite_count": 3, "accepted_answer_id": 28634932, "answer_count": 1, "score": 5, "last_activity_date": 1424453709, "creation_date": 1424452545, "question_id": 28634576, "link": "https://stackoverflow.com/questions/28634576/golang-prevent-channel-from-blocking", "title": "Golang prevent channel from blocking", "body": "<p>I am building a server that uses websockets.<br>\nCurrently every connected client uses two goroutines. One for reading and one for writing.\nThe writing goroutine basically listens to a channel for messages it should send and then tries to deliver them.</p>\n\n<pre><code>type User struct{\n    send chan []byte\n    ...\n}\n\nfunc (u *User) Send(msg []byte){\n    u.send &lt;- msg\n}\n</code></pre>\n\n<p>Problem is, that a read from client A may cause a write to client B.\nSuppose the connection to B has some problems however (e.g. very slow) and it's send channel is already full. Current behaviour is, that trying to add a message to the channel now starts blocking, until something is removed from the channel.\nThis means, that now A waits until B's buffer is no longer full.</p>\n\n<p>I want to solve it somewhat like this:</p>\n\n<pre><code>func (u *User) Send(msg []byte) err{\n    u.send, err &lt;- msg\n    if err != nil{\n        //The channels buffer is full.\n        //Writing currently not possible.\n        //Needs appropriate error handling.\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>Basically instead of blocking I want error handling in case the buffer is full.\nHow do I achieve that best?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 587, "user_id": 1144896, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/852a0c261ea9ff7ec2fda5ed437bde26?s=128&d=identicon&r=PG", "display_name": "tabiul", "link": "https://stackoverflow.com/users/1144896/tabiul"}, "edited": false, "score": 0, "creation_date": 1424569458, "post_id": 28634312, "comment_id": 45604121, "body": "Thanks icza. I think the crux of the issue for me is why golang does not automatically insert &amp; for the case of interface whereas it does it when calling it <b>myparent.value()</b>.  Due to space constraint on comments I am adding further information on another answer"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1424452838, "last_edit_date": 1424452838, "creation_date": 1424451699, "answer_id": 28634312, "question_id": 28634221, "link": "https://stackoverflow.com/questions/28634221/golang-embedded-struct-class-hierarchy/28634312#28634312", "title": "GoLang embedded struct class hierarchy", "body": "<p>Your <code>callValueable(v Valueable)</code> function has a parameter of type <code>Valueable</code> which is an interface:</p>\n\n<pre><code>type Valueable interface {\n    Value() int64\n}\n</code></pre>\n\n<p>You can pass any value to it which <em>implements</em> this interface. Your <code>Parent</code> type does not, because even though it has a <code>Value()</code> method, that method has a pointer receiver:</p>\n\n<pre><code>func (i *Parent) Value() int64{\n    return i.value\n}\n</code></pre>\n\n<p>And according to the Go Language Specification (<a href=\"http://golang.org/ref/spec#Method_sets\" rel=\"nofollow\">Method sets</a> and <a href=\"http://golang.org/ref/spec#Interface_types\" rel=\"nofollow\">Interface types</a>) the method set of <code>Parent</code> does not include this method, only the method set of <code>*Parent</code>. Quoting from the Spec:</p>\n\n<blockquote>\n  <p>...The method set of any other type <code>T</code> consists of all methods declared with receiver type <code>T</code>. The method set of the corresponding pointer type <code>*T</code> is the set of all methods declared with receiver <code>*T</code> or <code>T</code> (that is, it also contains the method set of <code>T</code>).</p>\n</blockquote>\n\n<p>So the type <code>Parent</code> does not implement the <code>Valueable</code> interface but the type <code>*Parent</code> does implement it.</p>\n\n<p>So you can pass a <code>*Parent</code> (a <strong>pointer</strong> to <code>Parent</code>) as a <code>Valuable</code> value to your method, because that implements the interface. You can easily obtain a pointer by using the address <code>&amp;</code> operator:</p>\n\n<pre><code>fmt.Println(callValueable(&amp;myparent)) // This WORKS\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 587, "user_id": 1144896, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/852a0c261ea9ff7ec2fda5ed437bde26?s=128&d=identicon&r=PG", "display_name": "tabiul", "link": "https://stackoverflow.com/users/1144896/tabiul"}, "is_accepted": false, "score": 1, "last_activity_date": 1424570243, "creation_date": 1424570243, "answer_id": 28653634, "question_id": 28634221, "link": "https://stackoverflow.com/questions/28634221/golang-embedded-struct-class-hierarchy/28653634#28653634", "title": "GoLang embedded struct class hierarchy", "body": "<p>As per <strong>Effective Go</strong> if the value is addressable then go will automatically insert &amp; when calling pointer receiver method.</p>\n\n<p>I did further research on this and looks like my understanding what is <strong>addressable</strong> is wrong. I was thinking along the line of c++ whereas as long it is lvalue then it is addressable. But it seem that in golang not everything is addressable such as                                  </p>\n\n<ul>\n<li>concrete value stored in an interface is not addressable                                        </li>\n<li>map element is not addressable                                                               </li>\n</ul>\n\n<p>The interesting question then is why concrete type of interface is not addressable so that golang can automatically do &amp;. I found this <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/-ZoCu5m0kJ4\" rel=\"nofollow\">https://groups.google.com/forum/#!topic/golang-nuts/-ZoCu5m0kJ4</a>. I am quoting the answer by Steven Blenkinsop which you can find at the end </p>\n\n<blockquote>\n  <p>On one level, it's because the language spec says so. But ultimately, yes, it's because of a limitation on getting a pointer to pass as the receiver. You can't take the address of the value inside an interface, since its type could change (you could assign a differently typed value to the interface), among other reasons. So, if you need a pointer receiver, the pointer itself needs to be in the interface.</p>\n</blockquote>\n\n<p>So the way I see for interface or map since the underlying memory address might change maybe by another thread that is why go does not automatically insert &amp; for us as it cannot guarantee the memory address will be valid throughout the function call life cycle.</p>\n"}], "owner": {"reputation": 587, "user_id": 1144896, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/852a0c261ea9ff7ec2fda5ed437bde26?s=128&d=identicon&r=PG", "display_name": "tabiul", "link": "https://stackoverflow.com/users/1144896/tabiul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1424570243, "creation_date": 1424451396, "last_edit_date": 1424460731, "question_id": 28634221, "link": "https://stackoverflow.com/questions/28634221/golang-embedded-struct-class-hierarchy", "title": "GoLang embedded struct class hierarchy", "body": "<p>I was reading this blogpost <a href=\"http://www.hydrogen18.com/blog/golang-embedding.html\" rel=\"nofollow\">http://www.hydrogen18.com/blog/golang-embedding.html</a> and came across these lines </p>\n\n<blockquote>\n  <p>There is an important distinction to observe here. If myParent is an instance of Parent the value myParent cannot act as a Valueable. You must use the the value &amp;myParent, a pointer to the instance, to act as a Valueable. This is because the method Value receives a *Parent not a Parent.</p>\n</blockquote>\n\n<p>I have created a sample <a href=\"https://play.golang.org/p/ojTKZfx97g\" rel=\"nofollow\">https://play.golang.org/p/ojTKZfx97g</a> . So the questions is why calling the method <strong>myparent.Value()</strong> works by itself but does not work when called through interface</p>\n"}, {"tags": ["php", "google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1424445165, "post_id": 28630963, "comment_id": 45564358, "body": "Thanks- will need to digest this... would this be better than storing a hardcoded secret key on both ends and encrypting the communication with AES?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1424446219, "post_id": 28630963, "comment_id": 45565030, "body": "Yes. Definitely. Technically, that&#39;s comparable to one part of public key cryptography algos like DHE (Diffie-Hellman)."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 1, "last_activity_date": 1424441437, "last_edit_date": 1489756486, "creation_date": 1424441437, "answer_id": 28630963, "question_id": 28630671, "link": "https://stackoverflow.com/questions/28630671/secure-requests-between-different-apps/28630963#28630963", "title": "Secure requests between different apps", "body": "<blockquote>\n  <ul>\n  <li>purely over the backend network</li>\n  <li>Only allow via certain IP ranges</li>\n  </ul>\n</blockquote>\n\n<p>These requirement are difficult to impossible to fulfill with app engine infrastructure because you're not in control of the physical network routes. From the app engine <a href=\"https://cloud.google.com/appengine/kb/general#static-ip\" rel=\"nofollow noreferrer\">FAQ</a>:</p>\n\n<blockquote>\n  <p>App Engine does not currently provide a way to map static IP addresses to an application. In order to optimize the network path between an end user and an App Engine application, end users on different ISPs or geographic locations might use different IP addresses to access the same App Engine application.</p>\n</blockquote>\n\n<p>Therefore always assume your communication happens over the open network and never assume anything about IPs.</p>\n\n<blockquote>\n  <p>Append the request with some hardcoded long secret key</p>\n</blockquote>\n\n<p>The hard coded long secret does not provide any added security, only <a href=\"http://en.wikipedia.org/wiki/Security_through_obscurity\" rel=\"nofollow noreferrer\">obscurity</a>. </p>\n\n<blockquote>\n  <p>only allow response if via SSL</p>\n</blockquote>\n\n<p>This is a better idea; encrypt <strong>all</strong> of your internal traffic with a strong algorithm. For example, <a href=\"https://security.stackexchange.com/questions/14731/what-is-ecdhe-rsa\">ECDHE-RSA</a> or ECDHE-ECDSA if available.</p>\n"}, {"tags": [], "owner": {"reputation": 757655, "user_id": 95810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e8d5fe90f1fe2148bf130cccd4dc311c?s=128&d=identicon&r=PG", "display_name": "Alex Martelli", "link": "https://stackoverflow.com/users/95810/alex-martelli"}, "is_accepted": true, "score": 2, "last_activity_date": 1424454514, "creation_date": 1424454514, "answer_id": 28635154, "question_id": 28630671, "link": "https://stackoverflow.com/questions/28630671/secure-requests-between-different-apps/28635154#28635154", "title": "Secure requests between different apps", "body": "<p>HTTPS is of course an excellent idea in general (not just for communication between two GAE apps).</p>\n\n<p>But, for the specific use case, I would recommend relying on the <code>X-Appengine-Inbound-Appid</code> request header: App Engine's infrastructure ensures that this cannot be set on requests <strong>not</strong> coming from GAE apps, and, for requests that <em>do</em> come from GAE apps (via a url-fetch that doesn't follow redirects), the header is set to the app-id.</p>\n\n<p>This is documented for Go at <a href=\"https://cloud.google.com/appengine/docs/go/urlfetch/\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/urlfetch/</a> , for PHP at <a href=\"https://cloud.google.com/appengine/docs/php/urlfetch/\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/php/urlfetch/</a> (and it's just the same for Java and Python, by the way).</p>\n"}], "owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 28635154, "answer_count": 2, "score": -1, "last_activity_date": 1424454514, "creation_date": 1424440582, "question_id": 28630671, "link": "https://stackoverflow.com/questions/28630671/secure-requests-between-different-apps", "title": "Secure requests between different apps", "body": "<p>Assume there are two different apps on appengine- one powered by Go and another by PHP</p>\n\n<p>They each need to be able to make specific requests to eachother, purely over the backend network (i.e. these are the <em>only</em> services that need to make these specific requests- other remote requests should be blocked).</p>\n\n<p>What is the best-practices way of doing this? Off the top of my head, here are 3 possible solutions and why I am a bit worried about them</p>\n\n<p><strong>1) Do not keep them as separate apps, but rather modules</strong></p>\n\n<p>The problem with this is that using modules introduces some other annoyances- such as difficulties with Channel Presence reporting. Also, conceptually, these 2 requests are really the only places they touch and it will be clearer to see what's going on in terms of database usage etc. if they are separated. But the presence issue is more of a show-stopper</p>\n\n<p><strong>2) Append the request with some hardcoded long secret key and only allow response if via SSL</strong></p>\n\n<p>It seems a bit strange to rely on this, since the key would never change... theoretically the only way it could be known is if an administrator on the account or someone with the source revealed it... but I don't know, just seems strange</p>\n\n<p><strong>3) Only allow via certain IP ranges (maybe combined with #2)</strong></p>\n\n<p>This just seems iffy, can the IP ranges be definitively known?</p>\n\n<p><strong>4) Pub/Sub</strong></p>\n\n<p>So it seems AppEngine allows a pub/sub mechanism- but that doesn't really fit my use case since I want to get the response right away - not via a postback once the subscriber processes it</p>\n\n<p><strong>All of them</strong>\n-- As a side point, assuming it is some sort of https request, is this done using the Socket API for each language?</p>\n"}, {"tags": ["python", "data-structures", "struct", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1424433242, "post_id": 28626382, "comment_id": 45557052, "body": "I&#39;d like to recommend the Go Tour <a href=\"http://tour.golang.go\" rel=\"nofollow noreferrer\">tour.golang.go</a> which explains all this."}, {"owner": {"reputation": 743, "user_id": 1827883, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1Dq7s.jpg?s=128&g=1", "display_name": "Adeel", "link": "https://stackoverflow.com/users/1827883/adeel"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1424433600, "post_id": 28626382, "comment_id": 45557265, "body": "Thanks @Volker will have a look ..."}, {"owner": {"reputation": 743, "user_id": 1827883, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1Dq7s.jpg?s=128&g=1", "display_name": "Adeel", "link": "https://stackoverflow.com/users/1827883/adeel"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1424433683, "post_id": 28626382, "comment_id": 45557307, "body": "@Volker link is changed to <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">tour.golang.org</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "edited": false, "score": 1, "creation_date": 1424432599, "post_id": 28627074, "comment_id": 45556691, "body": "when ranging over items, you want to check if the key exists in rectors, and in this case, do an append instead of an assignment"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "reply_to_user": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "edited": false, "score": 1, "creation_date": 1424433216, "post_id": 28627074, "comment_id": 45557036, "body": "Good point .. must have skipped over that. Awkward. I&#39;ll fix it up."}, {"owner": {"reputation": 743, "user_id": 1827883, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1Dq7s.jpg?s=128&g=1", "display_name": "Adeel", "link": "https://stackoverflow.com/users/1827883/adeel"}, "edited": false, "score": 0, "creation_date": 1424433419, "post_id": 28627074, "comment_id": 45557153, "body": "@SimonWhitehead really appreciate the effort, the problem is I don&#39;t know how many items I am gonna get, so defining map with set no. of keys is not really what I want, I want an empty map that can populated depending on data I receive.. Thanks again for the effort"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "reply_to_user": {"reputation": 743, "user_id": 1827883, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1Dq7s.jpg?s=128&g=1", "display_name": "Adeel", "link": "https://stackoverflow.com/users/1827883/adeel"}, "edited": false, "score": 1, "creation_date": 1424433515, "post_id": 28627074, "comment_id": 45557207, "body": "@Aedil I have updated my answer. Notice the <code>append</code> operation in the loop now. Apologies for missing that important part :/"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "reply_to_user": {"reputation": 743, "user_id": 1827883, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1Dq7s.jpg?s=128&g=1", "display_name": "Adeel", "link": "https://stackoverflow.com/users/1827883/adeel"}, "edited": false, "score": 1, "creation_date": 1424433572, "post_id": 28627074, "comment_id": 45557247, "body": "@Aedil You may also want to look at <a href=\"http://blog.golang.org/slices\" rel=\"nofollow noreferrer\">this Go blog article about arrays, slices and append</a>"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 743, "user_id": 1827883, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1Dq7s.jpg?s=128&g=1", "display_name": "Adeel", "link": "https://stackoverflow.com/users/1827883/adeel"}, "edited": false, "score": 2, "creation_date": 1424439537, "post_id": 28627074, "comment_id": 45560697, "body": "@Aedil Another approach would be do something like: <a href=\"http://play.golang.org/p/PLK2YV-vNV\" rel=\"nofollow noreferrer\">play.golang.org/p/PLK2YV-vNV</a>"}], "tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": true, "score": 2, "last_activity_date": 1424433464, "last_edit_date": 1424433464, "creation_date": 1424429154, "answer_id": 28627074, "question_id": 28626382, "link": "https://stackoverflow.com/questions/28626382/golang-defining-dict-like-python-with-and-appending-value-to-list-in-dict/28627074#28627074", "title": "golang defining dict like python with and appending value to list in dict", "body": "<p>Its not quite as clean .. but this does roughly what you want and should get you started on the right path:</p>\n\n<pre><code>type someObj struct {\n}\n\nfunc main() {\n    items := map[string][]someObj{\n        \"item1\": []someObj{someObj{}},\n        \"item2\": []someObj{someObj{}},\n        \"item3\": []someObj{someObj{}},\n    }\n\n    items[\"item1\"] = append(items[\"item1\"], someObj{})\n\n    rectors := make(map[string][]someObj)    \n\n    for key, val := range items {\n        if obj, exists := rectors[key]; exists {\n            rectors[key] = append(obj, val...)\n        } else {\n            rectors[key] = val\n        }\n    }\n\n    fmt.Printf(\"%v\", rectors)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>map[item3:[{}] item1:[{} {}] item2:[{}]]\n</code></pre>\n\n<p>The main difference being .. you can't initialize the map <em>and</em> alter an item with a key that already exists (as you appear to be doing in your example with <code>item1</code> being appended during initialization). So that becomes an extra step after the initialization of the map. You could always just do:</p>\n\n<pre><code>\"item1\": []someObj{someObj{}, someObj{}},\n</code></pre>\n\n<p>.. but that didn't seem to be the same as what you were doing.</p>\n\n<p><kbd><a href=\"http://play.golang.org/p/HrJKBCWJi7\" rel=\"nofollow\">See it on the Go playground</a></kbd></p>\n"}], "owner": {"reputation": 743, "user_id": 1827883, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1Dq7s.jpg?s=128&g=1", "display_name": "Adeel", "link": "https://stackoverflow.com/users/1827883/adeel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1647, "favorite_count": 0, "accepted_answer_id": 28627074, "answer_count": 1, "score": -2, "last_activity_date": 1424433464, "creation_date": 1424427021, "last_edit_date": 1424427784, "question_id": 28626382, "link": "https://stackoverflow.com/questions/28626382/golang-defining-dict-like-python-with-and-appending-value-to-list-in-dict", "title": "golang defining dict like python with and appending value to list in dict", "body": "<p>I am new to go and trying to implement python like nested structure as below, I am not able to define the empty dict/map in golang that can have list of specific struct/classobj and while iterating through the data I am not able to append items in map/dict ... I will really appreciate any help on this ... Thanks</p>\n\n<pre><code>items = [\n    (\"item1\", someObj1),\n    (\"item2\", someObj2),\n    (\"item3\", someObj3),\n    (\"item3\", someObj5),\n    (\"item1\", someObj4),\n]\n\nrectors = {}\nfor item, obj in items:\n    try:\n        rectors[item].append(obj)\n    except KeyError:\n        rectors[item] = [obj]\n\nprint rectors\n# OUTPUT: {'item2': [someObj2], 'item3': [someObj3, someObj5], 'item1': [someObj1, someObj4]}\n</code></pre>\n"}, {"tags": ["go", "pass-by-reference"], "comments": [{"owner": {"reputation": 19808, "user_id": 1472049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1qeQt.jpg?s=128&g=1", "display_name": "serejja", "link": "https://stackoverflow.com/users/1472049/serejja"}, "edited": false, "score": 1, "creation_date": 1424430125, "post_id": 28626312, "comment_id": 45555275, "body": "Why not return <code>(interface{}, err)</code>? This way you could use <code>return byts, nil</code> after append"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 2, "creation_date": 1424430470, "post_id": 28626312, "comment_id": 45555468, "body": "I just want to point out that this is still pass by value ... the value that is copied though is the pointer.. not what it points to... #nitpick"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1424430485, "post_id": 28626312, "comment_id": 45555476, "body": "Please show us the code how you call this <code>Do()</code> method. Also please check the <code>ok</code> variable. But most likely the value <code>v</code> you pass is <b>not</b> of type <code>*[]byte</code>!"}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 9, "last_activity_date": 1424431170, "creation_date": 1424431170, "answer_id": 28627735, "question_id": 28626312, "link": "https://stackoverflow.com/questions/28626312/golang-update-pass-by-reference-value/28627735#28627735", "title": "Golang update pass by reference value", "body": "<p>Well, the main reason this does not work is because you think of \"call by reference\", a concept completely unknown to Go. Absolutely everything is called by value in Go and once you spell out what is a byte slice, a pointer to a byte slice, a pointer to byte slice wrapped inside an interface, a copy of the pointer to a byte slice extracted from the interface, and so on you'll see how to update the value the pointer to byte slice points to:</p>\n\n<pre><code>package main\nimport \"fmt\"\nfunc f(v interface{}) {\n    pbs := v.(*[]byte)\n    *pbs = append(*pbs, []byte{9,8,7}...)\n}\nfunc main() {\n    bs := []byte{1,2,3}\n    pbs := &amp;bs\n    var v interface{} = pbs\n    f(v)\n    fmt.Printf(\"%v\\n\", *pbs)\n}\n</code></pre>\n"}], "owner": {"reputation": 1001, "user_id": 4160965, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/fbb0ff599a13cc579cbac731d8d38a81?s=128&d=identicon&r=PG&f=1", "display_name": "want_to_be_calm", "link": "https://stackoverflow.com/users/4160965/want-to-be-calm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5991, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1424431170, "creation_date": 1424426843, "last_edit_date": 1424427365, "question_id": 28626312, "link": "https://stackoverflow.com/questions/28626312/golang-update-pass-by-reference-value", "title": "Golang update pass by reference value", "body": "<p>I am calling a function to do a http request, two pass by reference parameter is used for the function. I pass the []byte to v interface. I want the function to update the v interface reference value. The response body is a string, I want to pass the string value to v interface. However, tried many ways but not success.</p>\n\n<p>Here is the code, you can see I declare <code>byts</code> as <code>v.(*[]byte)</code> in order to make <code>v</code> updated with the string value of response body. But it does not work. The <code>v</code> is always <code>nil</code>. Please suggest any way to make <code>v</code> can be updated with the string value.</p>\n\n<pre><code>func (s *BackendConfiguration) Do(req *http.Request, v interface{}) error {\n    res, err := s.HTTPClient.Do(req)\n    defer res.Body.Close()\n    resBody, err := ioutil.ReadAll(res.Body)\n\n    if v != nil {   \n            byts, ok := v.(*[]byte)\n            if len(resBody) &gt; 0 {           \n                byts = append(byts, resBody...)\n                return nil\n            }\n        }\n    }\n\n    return nil\n}\n</code></pre>\n"}, {"tags": ["regex", "unicode", "go", "whitespace"], "answers": [{"comments": [{"owner": {"reputation": 9718, "user_id": 87584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f6dfb6c18bce2c8487312b77c32dbc3?s=128&d=identicon&r=PG", "display_name": "Fabien", "link": "https://stackoverflow.com/users/87584/fabien"}, "edited": false, "score": 0, "creation_date": 1424426288, "post_id": 28626024, "comment_id": 45553009, "body": "Amazing answer. Thanks."}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1424426299, "post_id": 28626024, "comment_id": 45553010, "body": "Great answer. I wasn&#39;t aware that <code>Fields</code> did this by default."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 5, "last_activity_date": 1424425980, "creation_date": 1424425980, "answer_id": 28626024, "question_id": 28625810, "link": "https://stackoverflow.com/questions/28625810/in-go-how-can-i-state-i-want-to-match-all-kinds-of-space-including-the-non-bre/28626024#28626024", "title": "In Go, how can I state I want to match all kinds of space, including the non-breaking one?", "body": "<p>The <a href=\"https://code.google.com/p/re2/wiki/Syntax\">re2 syntax</a> does limit <code>\\s</code> to <code>(\u2261 [\\t\\n\\f\\r ])</code>, which seems pretty much standard.</p>\n\n<p>That might be the case where pre-processing the string, <em>before</em> using a regexp, is easier to do.<br>\nFor example <a href=\"http://golang.org/pkg/strings/#Fields\"><code>strings.Fields()</code></a> would split the string around spaces, <a href=\"https://github.com/golang/go/blob/5868ce3519313dfa60dbc9192bf6b701b25bd4ca/src/strings/strings.go#L336-L341\">including unicode space runes</a>.</p>\n\n<pre><code>// Fields splits the string s around each instance of one or more consecutive white space\n// characters, as defined by unicode.IsSpace, returning an array of substrings of s or an\n// empty list if s contains only white space.\nfunc Fields(s string) []string {\n    return FieldsFunc(s, unicode.IsSpace)\n}\n</code></pre>\n\n<p>That would take care of non-breakable space, since <a href=\"http://golang.org/pkg/unicode/#IsSpace\"><code>unicode.IsSpace()</code></a>  reports whether the rune is a space character as defined by Unicode's White Space property; in the Latin-1 space this is:</p>\n\n<pre><code>'\\t', '\\n', '\\v', '\\f', '\\r', ' ', U+0085 (NEL), U+00A0 (NBSP).\n</code></pre>\n"}], "owner": {"reputation": 9718, "user_id": 87584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f6dfb6c18bce2c8487312b77c32dbc3?s=128&d=identicon&r=PG", "display_name": "Fabien", "link": "https://stackoverflow.com/users/87584/fabien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 1, "accepted_answer_id": 28626024, "answer_count": 1, "score": 1, "last_activity_date": 1424425980, "creation_date": 1424425317, "question_id": 28625810, "link": "https://stackoverflow.com/questions/28625810/in-go-how-can-i-state-i-want-to-match-all-kinds-of-space-including-the-non-bre", "title": "In Go, how can I state I want to match all kinds of space, including the non-breaking one?", "body": "<p>I have to match a given pattern that looks like this : </p>\n\n<pre><code>Place *: *(.*)\n</code></pre>\n\n<p>In other words, I have a label, some spaces, a colon, some spaces, and the value I want.</p>\n\n<p>However, I have in my data some places where spaces are not the usual <code>20</code> ASCII character, but non-breaking spaces (unicode character <code>\\u00A0</code>). How can I match them ? I thought of using</p>\n\n<pre><code>Place\\s*:\\s*(.*)\n</code></pre>\n\n<p>but it does not seem to work on the <code>\\u00A0</code> whitespace. Is this a bug of the regexp module or is this wanted behavior ? If it is the latter, how can I match all kinds of spaces without listing them all ?</p>\n"}, {"tags": ["struct", "go"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 98761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7567c12df3f5e8f8ca031d4320b476ba?s=128&d=identicon&r=PG", "display_name": "user98761", "link": "https://stackoverflow.com/users/98761/user98761"}, "edited": false, "score": 4, "creation_date": 1588614807, "post_id": 28625828, "comment_id": 108961120, "body": "It&#39;s not at all clear that this documentation covers the case of a simple struct."}], "tags": [], "owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "is_accepted": true, "score": 53, "last_activity_date": 1501003092, "last_edit_date": 1592644375, "creation_date": 1424425363, "answer_id": 28625828, "question_id": 28625794, "link": "https://stackoverflow.com/questions/28625794/structs-zero-value-in-golang/28625828#28625828", "title": "Struct&#39;s Zero value in golang", "body": "<p>Why guess (correctly) when there's <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">some documentation</a> ?</p>\n<blockquote>\n<p>When storage is allocated for a variable, either through a declaration or a call of new, or when a new value is created, <strong>either through a composite literal or a call of make, and no explicit initialization is provided</strong>, the variable or value is given a default value.</p>\n<p><strong>Each element of such a variable or value is set to the zero value for its type</strong>:</p>\n<ul>\n<li><code>false</code> for booleans,</li>\n<li><code>0</code> for integers,</li>\n<li><code>0.0</code> for floats,</li>\n<li><code>&quot;&quot;</code> for strings,</li>\n<li>and <code>nil</code> for pointers, functions, interfaces, slices, channels, and maps.</li>\n</ul>\n<p>This initialization is done recursively, so for instance each element of an array of structs will have its fields zeroed if no value is specified.</p>\n</blockquote>\n<p>Note that there's no way to set a struct value to <code>nil</code> (but you could set the value of a pointer to a struct to <code>nil</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1593953885, "last_edit_date": 1593953885, "creation_date": 1588323183, "answer_id": 61539421, "question_id": 28625794, "link": "https://stackoverflow.com/questions/28625794/structs-zero-value-in-golang/61539421#61539421", "title": "Struct&#39;s Zero value in golang", "body": "<p>Demonstrating @Denys S\u00e9guret's first-rate answer. Each element of such a variable or value is set to the zero value for its type (<a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#The_zero_value</a>):</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\nfunc main() {\n    // false for booleans,\n    var bl bool // false\n    //0 for numeric types,\n    var in int // 0\n    // &quot;&quot; for strings,\n    var st string // &quot;&quot;\n    // and nil for pointers, functions, interfaces, channels,\n    var pi *int    // &lt;nil&gt;\n    var ps *string // &lt;nil&gt;\n    var fu func()      // &lt;nil&gt; Go vet error. https://stackoverflow.com/a/56663166/12817546\n    var ir interface{} // &lt;nil&gt;\n    var ch chan string // &lt;nil&gt;\n    fmt.Println(bl, in, st, pi, ps, fu, ir, ch)\n    // slices, and maps.\n    var sl []int          // true\n    var mp map[int]string // true\n    var pm *map[int]string // &lt;nil&gt;\n    fmt.Printf(&quot;%v %v %v\\n&quot;, sl == nil, mp == nil, pm)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2572, "user_id": 187812, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a0f940551239204d47630a10cd5154b4?s=128&d=identicon&r=PG", "display_name": "Josh Diehl", "link": "https://stackoverflow.com/users/187812/josh-diehl"}, "is_accepted": false, "score": 2, "last_activity_date": 1597200262, "creation_date": 1597200262, "answer_id": 63369009, "question_id": 28625794, "link": "https://stackoverflow.com/questions/28625794/structs-zero-value-in-golang/63369009#63369009", "title": "Struct&#39;s Zero value in golang", "body": "<p>I don't believe the top-voted answer is clearly worded to answer the question, so here is a more clear explanation:</p>\n<p>&quot;The elements of an array or struct will have its fields zeroed if no value is specified. This initialization is done recursively:&quot;</p>\n<p><a href=\"https://yourbasic.org/golang/default-zero-value/\" rel=\"nofollow noreferrer\">Source</a></p>\n"}], "owner": {"reputation": 2099, "user_id": 1917479, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/daEaw.jpg?s=128&g=1", "display_name": "soapbar", "link": "https://stackoverflow.com/users/1917479/soapbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31466, "favorite_count": 8, "accepted_answer_id": 28625828, "answer_count": 3, "score": 29, "last_activity_date": 1597200262, "creation_date": 1424425275, "last_edit_date": 1571237039, "question_id": 28625794, "link": "https://stackoverflow.com/questions/28625794/structs-zero-value-in-golang", "title": "Struct&#39;s Zero value in golang", "body": "<p>Here is sample code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A struct {\n    Name string\n}\n\nfunc (this *A) demo(tag string) {\n    fmt.Printf(\"%#v\\n\", this)\n    fmt.Println(tag)\n}\n\nfunc main() {\n    var ele A\n    ele.demo(\"ele are called\")\n\n    ele2 := A{}\n    ele2.demo(\"ele2 are called\")\n}\n</code></pre>\n\n<p>Run results:</p>\n\n<pre><code>&amp;main.A{Name:\"\"}\nele are called\n&amp;main.A{Name:\"\"}\nele2 are called\n</code></pre>\n\n<p>It looks like those are the same about <code>var ele A</code> and <code>ele2 := A{}</code></p>\n\n<p>So, the struct's Zero value is not <code>nil</code>, but a struct that all of the property are initialized Zero value. Is the guess right?</p>\n\n<p>If the guess is right, then the nature of <code>var ele A</code> and <code>ele2 := A{}</code> are the same right?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 5, "last_activity_date": 1424425213, "last_edit_date": 1592644375, "creation_date": 1424425213, "answer_id": 28625779, "question_id": 28625546, "link": "https://stackoverflow.com/questions/28625546/mixing-exploded-slices-and-regular-parameters-in-variadic-functions/28625779#28625779", "title": "mixing &quot;exploded&quot; slices and regular parameters in variadic functions", "body": "<p>The specification on this is at the &quot;<a href=\"http://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"noreferrer\">Passing arguments to <code>...</code> parameters</a>&quot;:</p>\n<blockquote>\n<p>If <code>f</code> is variadic with a final parameter <code>p</code> of type <code>...T</code>, then within <code>f</code> the type of <code>p</code> is equivalent to type <code>[]T</code>.<br />\nIf <code>f</code> is invoked with no actual arguments for <code>p</code>, the value passed to <code>p</code> is <code>nil</code>.<br />\nOtherwise, the value passed is a new slice of type <code>[]T</code> with a new underlying array whose successive elements are the actual arguments, which all must be assignable to <code>T</code>.</p>\n</blockquote>\n<p>In your case, where stuff... works:</p>\n<blockquote>\n<p>If the final argument is assignable to a slice type <code>[]T</code>, it may be passed unchanged as the value for a <code>...T</code> parameter if the argument is followed by <code>...</code>. In this case no new slice is created.</p>\n</blockquote>\n<p>But <code>&quot;bar&quot;, stuff...</code> doesn't match either case specified above.</p>\n<p><code>T, []T</code> doesn't match <code>f([]T)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 17, "last_activity_date": 1424437684, "last_edit_date": 1424437684, "creation_date": 1424426414, "answer_id": 28626170, "question_id": 28625546, "link": "https://stackoverflow.com/questions/28625546/mixing-exploded-slices-and-regular-parameters-in-variadic-functions/28626170#28626170", "title": "mixing &quot;exploded&quot; slices and regular parameters in variadic functions", "body": "<p>The value for a variadic argument can be specified <em>either</em> by enumerating the elements, <em>or</em> using an existing slice, specified by its name followed by <code>...</code>.</p>\n\n<p>You want to mix the 2 possible ways which is not permitted by the Go Language Specification (<a href=\"http://golang.org/ref/spec#Passing_arguments_to_..._parameters\">Passing arguments to <code>...</code> parameters</a>).</p>\n\n<p>If the first form is used (enumerating the elements):</p>\n\n<blockquote>\n  <p>The value passed [as the variadic parameter] is a new slice of type <code>[]T</code> with a new underlying array whose successive elements are the actual arguments.</p>\n</blockquote>\n\n<p>If the latter is used (passing an existing slice followed by <code>...</code>) <strong>no new slice is created</strong>, the one you pass is used as is. And the passed slice can only be used to specify the value of <strong>one</strong> \u2013 the <strong>final</strong> \u2013 variadic parameter. Attempting to pass both a single element <em>and</em> a slice will not match the signature (the parameter list in this case) of your function and you'll get an error:</p>\n\n<pre><code>too many arguments in call to foo\n</code></pre>\n\n<p>There is no actual \"exploding\" involved in Go, the term is just used in other languages to help visualize that the passed array or slice will not be an <em>element</em> of the variadic parameter but will be the value of variadic parameter <em>itself</em>.</p>\n\n<p>Mixing the 2 would require to allocate a new slice because obviously the existing slice cannot be used.</p>\n"}, {"tags": [], "owner": {"reputation": 2619, "user_id": 2249725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06905a0d11a7662cbadd4daffe029452?s=128&d=identicon&r=PG", "display_name": "mvndaai", "link": "https://stackoverflow.com/users/2249725/mvndaai"}, "is_accepted": false, "score": 12, "last_activity_date": 1595883060, "last_edit_date": 1595883060, "creation_date": 1446503934, "answer_id": 33488329, "question_id": 28625546, "link": "https://stackoverflow.com/questions/28625546/mixing-exploded-slices-and-regular-parameters-in-variadic-functions/33488329#33488329", "title": "mixing &quot;exploded&quot; slices and regular parameters in variadic functions", "body": "<p>The ugly way to get this to work is make it into a new variadic.</p>\n<pre><code>foo(append([]string{&quot;bar&quot;}, stuff...)...)\n</code></pre>\n<p>And if the order doesn't matter:</p>\n<pre><code>foo(append(stuff, &quot;bar&quot;)...)\n</code></pre>\n<p><a href=\"https://play.golang.org/p/mY6y0vScfPB\" rel=\"noreferrer\">https://play.golang.org/p/mY6y0vScfPB</a></p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1618190379, "creation_date": 1618190379, "answer_id": 67051605, "question_id": 28625546, "link": "https://stackoverflow.com/questions/28625546/mixing-exploded-slices-and-regular-parameters-in-variadic-functions/67051605#67051605", "title": "mixing &quot;exploded&quot; slices and regular parameters in variadic functions", "body": "<p>I ran into this situation when preparing arguments to feed to external commands.\nIf possible, just build an one argument slice, then you dont have to worry about\ncombining scalars with slices when its time to call the function:</p>\n<pre><code>package main\nimport &quot;os/exec&quot;\n\nfunc main() {\n   stuff := []string{&quot;bar&quot;}\n   stuff = append(stuff, &quot;baz&quot;, &quot;bla&quot;)\n   exec.Command(&quot;name&quot;, stuff...).Run()\n}\n</code></pre>\n"}], "owner": {"reputation": 4810, "user_id": 440935, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/748521f8ae12460dfa2acd0777072b94?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/440935/pascal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5399, "favorite_count": 5, "accepted_answer_id": 28626170, "answer_count": 4, "score": 19, "last_activity_date": 1618190379, "creation_date": 1424424403, "last_edit_date": 1475314809, "question_id": 28625546, "link": "https://stackoverflow.com/questions/28625546/mixing-exploded-slices-and-regular-parameters-in-variadic-functions", "title": "mixing &quot;exploded&quot; slices and regular parameters in variadic functions", "body": "<p>I'm wondering why it's not possible to do the following in go:</p>\n\n<pre><code>func main() {\n    stuff := []string{\"baz\", \"bla\"}\n    foo(\"bar\", stuff...)\n}\n\nfunc foo(s ...string) {\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>In my understanding, slice... \"explodes\" the slice so it can be used for multi argument function calls. So the above example should actually expand to <code>foo(\"bar\", \"baz\", \"bla\")</code>. </p>\n\n<p><code>foo(stuff...)</code> works as expected, no surprises here, but in the example above, the compiler complains about too many arguments.</p>\n\n<p>Is this a desired limitation? I'm coming from a ruby background where a <code>foo(\"bar\", *stuff)</code> is perfectly fine (and is, at least in my book, the same thing), that's why this surprises me.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12342, "user_id": 1300892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f3a5c87c28be1e3d1d31281c613deb?s=128&d=identicon&r=PG", "display_name": "Sverri M. Olsen", "link": "https://stackoverflow.com/users/1300892/sverri-m-olsen"}, "edited": false, "score": 0, "creation_date": 1424423325, "post_id": 28624969, "comment_id": 45551322, "body": "I am pretty sure we need more details. What is in <code>err</code>? Also, what does the console say? Any errors?"}, {"owner": {"reputation": 1624, "user_id": 1259524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fac95f223f8faa8147d7d5daf318747?s=128&d=identicon&r=PG", "display_name": "GreyHands", "link": "https://stackoverflow.com/users/1259524/greyhands"}, "edited": false, "score": 0, "creation_date": 1424423734, "post_id": 28624969, "comment_id": 45551537, "body": "Is it me or you&#39;re are trying to encode something that is already JSON? try with just buf := bytes.NewBuffer(jsonReq)"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1424424148, "post_id": 28624969, "comment_id": 45551802, "body": "Sending some naked JSON in the response body is something completely different than what curl&#39;s --data does. You&#39;ll have to set the content type to application/x-www-form-urlencoded and you&#39;ll have to send your two values url-encoded. There is no magic happening here, your jason request body is <i>not</i> magically converted to a form post, you&#39;ll have to do that yourself."}, {"owner": {"reputation": 1624, "user_id": 1259524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fac95f223f8faa8147d7d5daf318747?s=128&d=identicon&r=PG", "display_name": "GreyHands", "link": "https://stackoverflow.com/users/1259524/greyhands"}, "edited": false, "score": 0, "creation_date": 1424424549, "post_id": 28624969, "comment_id": 45552043, "body": "Volker is definitely right, I didn&#39;t notice the --data flag in the curl command line."}], "answers": [{"tags": [], "owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "is_accepted": true, "score": 5, "last_activity_date": 1424431723, "creation_date": 1424431723, "answer_id": 28627901, "question_id": 28624969, "link": "https://stackoverflow.com/questions/28624969/golang-http-newrequest-post-with-json-payload-returns-error-500/28627901#28627901", "title": "Golang: http.NewRequest POST with JSON payload returns error 500", "body": "<p>The correct code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"net/url\"\n)\n\nfunc main() {\n\n    u := \"http://interest-graph.getprismatic.com/text/topic\"\n    ApiToken := \"API-CODE\"\n\n    data := url.Values{}\n    data.Set(\"title\", \"Clojure\")\n    data.Set(\"body\", `Clojure is a dynamic programming language that targets the Java Virtual Machine \n        (and the CLR, and JavaScript). It is designed to be a general-purpose language, \n        combining the approachability and interactive development of a \n        scripting language with an efficient and robust infrastructure for multithreaded programming.\n        Clojure is a compiled language - it compiles directly to JVM bytecode, \n        yet remains completely dynamic. Every feature supported by Clojure is supported at runtime.`)\n\n    b := bytes.NewBufferString(data.Encode())\n\n    req, err := http.NewRequest(\"POST\", u, b)\n    req.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\n    req.Header.Set(\"X-API-TOKEN\", ApiToken)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n    c := http.DefaultClient\n    resp, err := c.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer resp.Body.Close()\n\n    r, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(string(r))\n\n}\n</code></pre>\n"}], "owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6801, "favorite_count": 0, "accepted_answer_id": 28627901, "answer_count": 1, "score": 3, "last_activity_date": 1424431723, "creation_date": 1424422553, "last_edit_date": 1424425012, "question_id": 28624969, "link": "https://stackoverflow.com/questions/28624969/golang-http-newrequest-post-with-json-payload-returns-error-500", "title": "Golang: http.NewRequest POST with JSON payload returns error 500", "body": "<p>I'm working on a library for an API. There's an API endpoint (POST) which when you issue a curl command is:</p>\n\n<pre><code>curl -H \"X-API-TOKEN: API-TOKEN\" 'http://interest-graph.getprismatic.com/text/topic' \\\n  --data \"title=Clojure\" \\\n  --data \"body=Clojure is a dynamic programming language that targets the Java Virtual Machine (and the CLR, and JavaScript). It is designed to be a general-purpose language, combining the approachability and interactive development of a scripting language with an efficient and robust infrastructure for multithreaded programming.Clojure is a compiled language - it compiles directly to JVM bytecode, yet remains completely dynamic. Every feature supported by Clojure is supported at runtime.\"\n</code></pre>\n\n<p>I'm trying to perform the above command using http.NewRequest:</p>\n\n<pre><code>   var jsonReq = []byte(`{\"title\": \"Clojure\", \"body\": \"Clojure is a dynamic programming language that targets the Java Virtual Machine \n        (and the CLR, and JavaScript). It is designed to be a general-purpose language, \n        combining the approachability and interactive development of a \n        scripting language with an efficient and robust infrastructure for multithreaded programming.\n        Clojure is a compiled language - it compiles directly to JVM bytecode, \n        yet remains completely dynamic. Every feature supported by Clojure is supported at runtime.\"}`)\n\n    buf := new(bytes.Buffer)\n\n    err := json.NewEncoder(buf).Encode(jsonReq)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    u := \"http://interest-graph.getprismatic.com/text/topic\"\n    ApiToken := \"API-TOKEN\"\n    req, err := http.NewRequest(\"POST\", u, buf)\n    req.Header.Set(\"Content-Type\", \"application/json\")\n    req.Header.Set(\"X-API-TOKEN\", ApiToken)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n    c := http.DefaultClient\n    resp, err := c.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer resp.Body.Close()\n\n    r, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(string(r))\n</code></pre>\n\n<p>Not sure if I'm doing this right, because I keep getting an error 500. Any idea what I'm doing wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 451, "user_id": 1082884, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/150055b45b9362a8b27b709c9938d8f1?s=128&d=identicon&r=PG", "display_name": "rino", "link": "https://stackoverflow.com/users/1082884/rino"}, "edited": false, "score": 1, "creation_date": 1424573766, "post_id": 28621496, "comment_id": 45604928, "body": "The best response didn&#39;t provide the solution.  Use the reflect package and replace the &quot;err == nil&quot; test with &quot;reflect.ValueOf(err).IsNil()&quot;."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1432018502, "post_id": 28621496, "comment_id": 48732344, "body": "I suggested a different solution (<code>if err != nil</code> is everywhere, so I suggested returning a kind of <code>nil</code> that works with it), but good point that it lacked any fix. (Just seeing this comment months later, as you can probably tell.)"}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 8, "last_activity_date": 1432018360, "last_edit_date": 1432018360, "creation_date": 1424407964, "answer_id": 28621847, "question_id": 28621496, "link": "https://stackoverflow.com/questions/28621496/this-nil-instance-of-a-struct-that-satisfies-the-error-interface-is-not-showin/28621847#28621847", "title": "This nil instance of a struct, that satisfies the error interface, is not showing as nil", "body": "<p>This is, it turns out, <a href=\"http://golang.org/doc/faq#nil_error\" rel=\"nofollow\">a Frequently Asked Question about Go</a>, and the short answer is that interface comparisons compare the type and the value, and <code>(*Goof)(nil)</code> and <code>error(nil)</code> have different types. </p>\n\n<p>Since <code>if err != nil</code> is standard, you want a return value that'll work with it. You could declare <code>var err error</code> instead of <code>var g *Goof</code>: <code>err</code>'s zero value is conveniently <code>error(nil)</code></p>\n\n<p>Or, if your func returns an <code>error</code>, <code>return nil</code> will return what you want.</p>\n\n<p>For more background, here's the start of the FAQ's answer:</p>\n\n<blockquote>\n  <p>Under the covers, interfaces are implemented as two elements, a type and a value. The value, called the interface's dynamic value, is an arbitrary concrete value and the type is that of the value. For the <code>int</code> value <code>3</code>, an interface value contains, schematically, <code>(int, 3)</code>.</p>\n  \n  <p>An interface value is <code>nil</code> only if the inner value and type are both unset, <code>(nil, nil)</code>. In particular, a <code>nil</code> interface will always hold a <code>nil</code> type. If we store a pointer of type <code>*int</code> inside an interface value, the inner type will be <code>*int</code> regardless of the value of the pointer: <code>(*int, nil)</code>. Such an interface value will therefore be non-<code>nil</code> even when the pointer inside is <code>nil</code>.</p>\n</blockquote>\n\n<p>And <code>==</code> is strictly checking if the types are <em>identical</em>, not if a type (<code>*Goof</code>) implements an interface (<code>error</code>). Check out <a href=\"http://golang.org/doc/faq#nil_error\" rel=\"nofollow\">the original</a> for more. </p>\n\n<p>If it helps clarify, this doesn't only happen with <code>nil</code>: in <a href=\"http://play.golang.org/p/AZJntYvMOz\" rel=\"nofollow\">this example</a>, the data underlying the <code>x</code> and <code>y</code> variables is obviously <code>3</code>, but they have different types. When you put <code>x</code> and <code>y</code> into <code>interface{}</code>s, they compare as unequal:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Bob int\n\nfunc main() {\n    var x int = 3\n    var y Bob = 3\n    var ix, iy interface{} = x, y\n    fmt.Println(ix == iy)\n}\n</code></pre>\n"}], "owner": {"reputation": 451, "user_id": 1082884, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/150055b45b9362a8b27b709c9938d8f1?s=128&d=identicon&r=PG", "display_name": "rino", "link": "https://stackoverflow.com/users/1082884/rino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 28621847, "answer_count": 1, "score": 1, "last_activity_date": 1432018360, "creation_date": 1424405402, "question_id": 28621496, "link": "https://stackoverflow.com/questions/28621496/this-nil-instance-of-a-struct-that-satisfies-the-error-interface-is-not-showin", "title": "This nil instance of a struct, that satisfies the error interface, is not showing as nil", "body": "<p>This should be a gimme for someone. Why do I not get what I expect (\"Error is not nil\") here?</p>\n\n<p><a href=\"http://play.golang.org/p/s8CWQxobVL\" rel=\"nofollow\">http://play.golang.org/p/s8CWQxobVL</a></p>\n\n<pre><code>type Goof struct {}\n\nfunc (goof *Goof) Error() string {\n    return fmt.Sprintf(\"I'm a goof\")\n}\n\nfunc TestError(err error) {\n    if err == nil {\n        fmt.Println(\"Error is nil\")\n    } else {\n        fmt.Println(\"Error is not nil\")\n    }\n}\n\nfunc main() {\n    var g *Goof // nil\n    TestError(g) // expect \"Error is nil\"\n}\n</code></pre>\n"}, {"tags": ["jquery", "post", "go"], "answers": [{"tags": [], "owner": {"reputation": 457, "user_id": 609295, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/lPOCA.png?s=128&g=1", "display_name": "Dave Appleton", "link": "https://stackoverflow.com/users/609295/dave-appleton"}, "is_accepted": true, "score": 1, "last_activity_date": 1424390389, "creation_date": 1424390389, "answer_id": 28619391, "question_id": 28618392, "link": "https://stackoverflow.com/questions/28618392/jquery-post-to-golang-corrupts-field-names/28619391#28619391", "title": "JQuery POST to Golang corrupts field names", "body": "<p>OK - shoot me. I am an idiot.</p>\n\n<p>Due to the lovely untyped nature of Javascript, the variable I was posting was sometimes a string and sometimes an array.</p>\n\n<p>When it appeared with [] it was, of course, an array :-(</p>\n"}], "owner": {"reputation": 457, "user_id": 609295, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/lPOCA.png?s=128&g=1", "display_name": "Dave Appleton", "link": "https://stackoverflow.com/users/609295/dave-appleton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 28619391, "answer_count": 1, "score": -1, "last_activity_date": 1424390389, "creation_date": 1424385448, "question_id": 28618392, "link": "https://stackoverflow.com/questions/28618392/jquery-post-to-golang-corrupts-field-names", "title": "JQuery POST to Golang corrupts field names", "body": "<p>I have a JQuery script which includes the line </p>\n\n<pre><code>console.log(\"Killing \"+selected)\n$.post(\"http://127.0.0.1:8080/delete_birloki\",{ birloki: selected})\n</code></pre>\n\n<p>and it logs...</p>\n\n<pre><code>Killing france\n</code></pre>\n\n<p>The Golang handler starts with</p>\n\n<pre><code>func deleteBirloki(rw http.ResponseWriter, req *http.Request) {\n    dat,err := httputil.DumpRequest(req,true)\n    if err != nil {\n        fmt.Fprintf(rw,\"BAD\")\n        return\n    }\n    fmt.Println(string(dat))\n</code></pre>\n\n<p>and the print out is</p>\n\n<pre><code>POST /delete_birloki HTTP/1.1\nHost: 127.0.0.1:8080\nAccept: */*\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.8\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCookie: weve_been_here_before=true; _ga=GA1.1.606577919.1412775218\nOrigin: http://127.0.0.1:8080\nReferer: http://127.0.0.1:8080/config/?birloki=&amp;north=&amp;east=\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.111 Safari/537.36\nX-Requested-With: XMLHttpRequest\n\nbirloki%5B%5D=france\n</code></pre>\n\n<p>Can anybody explain WHY the variable name has been changed?\nin a similar case I could request for \"birloki[]\" with</p>\n\n<pre><code>birloki := req.PostFormValue(\"birloki[]\")\n</code></pre>\n\n<p>but even that does not seem to work in this case</p>\n"}, {"tags": ["session", "cookies", "go", "session-timeout", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "is_accepted": false, "score": 1, "last_activity_date": 1424392180, "creation_date": 1424392180, "answer_id": 28619685, "question_id": 28616830, "link": "https://stackoverflow.com/questions/28616830/gorilla-sessions-how-to-automatically-update-cookie-expiration-on-request/28619685#28619685", "title": "Gorilla Sessions - How to Automatically Update Cookie Expiration on Request?", "body": "<p>You could simply implement your own <a href=\"http://www.gorillatoolkit.org/pkg/sessions#Store\" rel=\"nofollow\"><code>Store</code></a> that builds on top of an existing session store like the <code>CookieStore</code>, but uses some rule to automatically update the expiration during a <code>Save</code> call.</p>\n"}, {"comments": [{"owner": {"reputation": 5278, "user_id": 962674, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0d99ac3322a360423831cc90d72f2927?s=128&d=identicon&r=PG", "display_name": "Darrrrrren", "link": "https://stackoverflow.com/users/962674/darrrrrren"}, "edited": false, "score": 0, "creation_date": 1424446077, "post_id": 28631511, "comment_id": 45564928, "body": "Right but max-age is relative to the cookie creation.  So I guess in this case I need to destroy the old session, and create a new, identical one?"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "reply_to_user": {"reputation": 5278, "user_id": 962674, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0d99ac3322a360423831cc90d72f2927?s=128&d=identicon&r=PG", "display_name": "Darrrrrren", "link": "https://stackoverflow.com/users/962674/darrrrrren"}, "edited": false, "score": 0, "creation_date": 1424449770, "post_id": 28631511, "comment_id": 45567336, "body": "Fair point. Just a new Set-Cookie header will do, updating the existing one if you use the same name, path, domain etc. But this takes you back to your original question."}, {"owner": {"reputation": 5278, "user_id": 962674, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0d99ac3322a360423831cc90d72f2927?s=128&d=identicon&r=PG", "display_name": "Darrrrrren", "link": "https://stackoverflow.com/users/962674/darrrrrren"}, "edited": false, "score": 2, "creation_date": 1424450812, "post_id": 28631511, "comment_id": 45567972, "body": "Yeah, I just ended up setting a &quot;created&quot; Unix timestamp on my session upon login.  Then, I wrote request middleware that would set <code>session.Options.MaxAge = time.Now().Unix() - session.Values[&quot;created&quot;].(int64) + sessionStore.SessionLengthSeconds</code>.  I also had to make sure that this middleware would run before any response was generated as saving session sets the &quot;Set-Cookie&quot; header."}], "tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 1, "last_activity_date": 1424443093, "creation_date": 1424443093, "answer_id": 28631511, "question_id": 28616830, "link": "https://stackoverflow.com/questions/28616830/gorilla-sessions-how-to-automatically-update-cookie-expiration-on-request/28631511#28631511", "title": "Gorilla Sessions - How to Automatically Update Cookie Expiration on Request?", "body": "<p>If you set the Max-Age parameter of the cookie, you don't need to set Expiry as well, unless you need to support old browsers that don't understand Max-Age.</p>\n\n<p>Using only Max-Age means you don't need to update it on every request.</p>\n\n<p>Set the spec: <a href=\"http://tools.ietf.org/html/rfc6265#section-4.1.2\" rel=\"nofollow\">http://tools.ietf.org/html/rfc6265#section-4.1.2</a></p>\n"}], "owner": {"reputation": 5278, "user_id": 962674, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0d99ac3322a360423831cc90d72f2927?s=128&d=identicon&r=PG", "display_name": "Darrrrrren", "link": "https://stackoverflow.com/users/962674/darrrrrren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1883, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1424443093, "creation_date": 1424379798, "question_id": 28616830, "link": "https://stackoverflow.com/questions/28616830/gorilla-sessions-how-to-automatically-update-cookie-expiration-on-request", "title": "Gorilla Sessions - How to Automatically Update Cookie Expiration on Request?", "body": "<p>I know many other languages and web frameworks will automatically update a cookie's expiration time to the session timeout every time a session is accessed via the backend (or some action like that).  I don't believe Gorilla provides this utility.</p>\n\n<p>I am consider just writing some request middleware that, if it detects a valid session, will extend the cookie lifetime but I am wondering if there is a better method of doing this.</p>\n\n<p>What are the best practices for updating cookie expiration, especially as they pertain to Gorilla/Go?</p>\n"}, {"tags": ["macos", "go", "awesomium", "cgo"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2475269"}, "edited": false, "score": 0, "creation_date": 1424392520, "post_id": 28616934, "comment_id": 45542119, "body": "Ah yes that works, it gave me quite a headache to retrieve all the 32 bit libraries but it works :) thank you"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1424393416, "last_edit_date": 1424393416, "creation_date": 1424380129, "answer_id": 28616934, "question_id": 28613885, "link": "https://stackoverflow.com/questions/28613885/mac-cross-compiling-or-alternatives-with-golang/28616934#28616934", "title": "Mac cross compiling (or alternatives) with golang", "body": "<p>I'm not sure if you're going to run into any other problems with the universal binary, but building an i386 go toolchain is fairly easy. </p>\n\n<p><a href=\"http://golang.org/doc/install/source\" rel=\"nofollow\">http://golang.org/doc/install/source</a></p>\n\n<p>You can then set the <code>GOHOSTARCH</code> and <code>GOARCH</code> environment variables, e.g.</p>\n\n<pre><code>GOHOSTARCH=386 GOARCH=386 ./all.bash\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2475269"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 0, "accepted_answer_id": 28616934, "answer_count": 1, "score": 0, "last_activity_date": 1424393416, "creation_date": 1424369784, "last_edit_date": 1424371223, "question_id": 28613885, "link": "https://stackoverflow.com/questions/28613885/mac-cross-compiling-or-alternatives-with-golang", "title": "Mac cross compiling (or alternatives) with golang", "body": "<p>Ok so I'm trying to compile my <a href=\"http://www.awesomium.com/\" rel=\"nofollow\">Awesomium</a> go <a href=\"https://github.com/hydroflame/gosomium\" rel=\"nofollow\">wrapper</a> on my mac (everything works fine on linux). My problem is, when I try to compile I get</p>\n\n<blockquote>\n  <p>ld: warning: ignoring file /Library/Frameworks//Awesomium.framework/Awesomium, file was built for i386 which is not the architecture being linked (x86_64): /Library/Frameworks//Awesomium.framework/Awesomium\n  Undefined symbols for architecture x86_64:</p>\n</blockquote>\n\n<p>Fine. But that raises a few questions. First, I didn't have the option to download a x86_64 version for Mac, it was \"the mac version\" no architecture. Second, I checked a few other libraries and it seems like nothing is built x86_64.<br>\nNow I thought maybe I could make a i386 version just for osx but it seems it's extremely difficult, some say impossible, to cross compile cgo.  </p>\n\n<p>What are my options?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1424363804, "post_id": 28610030, "comment_id": 45527193, "body": "Also thanks Leo for editing Q. I am noob here so was waiting for someone to do that"}], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "edited": false, "score": 0, "creation_date": 1424360826, "post_id": 28610108, "comment_id": 45524952, "body": "It&#39;s in the same place as main.go {GOPATH/src/}"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "edited": false, "score": 0, "creation_date": 1424360945, "post_id": 28610108, "comment_id": 45525032, "body": "@RamanSM It has to be in the current folder you start your app from if you specify a relative path. See my edited answer."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "edited": false, "score": 0, "creation_date": 1424361081, "post_id": 28610108, "comment_id": 45525131, "body": "@RamanSM Also please be kind to delete your comments here, I will do the same. To keep the question and answer clean."}, {"owner": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "edited": false, "score": 0, "creation_date": 1424361868, "post_id": 28610108, "comment_id": 45525743, "body": "gotta eat something ,will check later ( if someone posts something)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "edited": false, "score": 0, "creation_date": 1424362125, "post_id": 28610108, "comment_id": 45525950, "body": "I put the <code>loginHtml</code> const outside of the <code>login()</code> func."}, {"owner": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "edited": false, "score": 0, "creation_date": 1424363106, "post_id": 28610108, "comment_id": 45526689, "body": "Yep!! It&#39;s working now. But why it was not working with template.ParseFiles??"}, {"owner": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "edited": false, "score": 0, "creation_date": 1424363203, "post_id": 28610108, "comment_id": 45526756, "body": "Thanks ICZA !   I was losing hope. Was nearly thinking of  going to rOrails"}, {"owner": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "edited": false, "score": 0, "creation_date": 1424363612, "post_id": 28610108, "comment_id": 45527050, "body": "Please edit the answer man . Also don&#39;t forget t.execute(w,nil)"}, {"owner": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "edited": false, "score": 0, "creation_date": 1424363681, "post_id": 28610108, "comment_id": 45527105, "body": "what I mean is remove part above EDIT and add t.Execute(w,nil)"}, {"owner": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "edited": false, "score": 0, "creation_date": 1424363883, "post_id": 28610108, "comment_id": 45527255, "body": "Still wondering why it wouldn&#39;t work with template.ParseFiles !!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "edited": false, "score": 0, "creation_date": 1424364947, "post_id": 28610108, "comment_id": 45528003, "body": "@RamanSM I edited the answer. The original problem was that your <code>ParseFiles()</code> function call failed (returned an <code>error</code>), it wasn&#39;t able to parse your template file because it wasn&#39;t in the working directory (from where you started your app), and you silently discarded the error."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1424365185, "last_edit_date": 1424365185, "creation_date": 1424359434, "answer_id": 28610108, "question_id": 28610030, "link": "https://stackoverflow.com/questions/28610030/getting-no-data-received-for-go-language-form/28610108#28610108", "title": "Getting No data received for go language form", "body": "<p>The problem with your original question (which has been edited several times) was that your <code>ParseFiles()</code> function failed, it was not able to read your template file. You didn't know about this because the <code>error</code> it returned you just discarded. <em>Never do that!</em> The least you can do is print the error or call <code>panic(err)</code> if it occurs. Would you have done that, you would have seen the cause immediately.</p>\n\n<p>The <code>login.gtpl</code> file has to be placed in the working directory you start you app from if you specify a relative path. Or specify an absolute path.</p>\n\n<p>You can also put your HTML source into your Go file like this until you sort things out:</p>\n\n<pre><code>t, err := template.New(\"\").Parse(loginHtml)\nif err != nil {\n    panic(err)\n}\nt.Execute(w, nil)\n// ... the rest of your code\n\n\n// At the end of your .go source file (outside of login() func) insert:\nconst loginHtml = `\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"/login\" method=\"post\"&gt;\n    Username:&lt;input type=\"text\" name=\"username\"&gt;\n    Password:&lt;input type=\"password\" name=\"password\"&gt;\n    &lt;input type=\"submit\" value=\"Login\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n`\n</code></pre>\n\n<p><strong>Note #1:</strong></p>\n\n<p>Since your HTML template is just a static HTML, in its current form you can simply just send it to the output without building and executing a template from it:</p>\n\n<pre><code>// Instead of calling template.New(...).Parse(...) and t.Execute(...), just do:\nw.Write([]byte(loginHtml))\n</code></pre>\n\n<p><strong>Note #2:</strong></p>\n\n<p>The <code>Request.Form</code> is only available after <code>Request.ParseForm()</code> has been called, so do that prior to accessing it. Also for <code>POST</code> forms you might want to use <code>Request.PostForm</code> instead.</p>\n\n<p>As an alternative you can use the <a href=\"http://golang.org/pkg/net/http/#Request.PostFormValue\" rel=\"nofollow\"><code>Request.PostFormValue()</code></a> method which does this for you automatically if it has not yet been called:</p>\n\n<pre><code>fmt.Println(\"username:\", r.PostFormValue(\"username\"))\nfmt.Println(\"password:\", r.PostFormValue(\"password\"))\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 4584441, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-NIBEYt0Y1vk/AAAAAAAAAAI/AAAAAAAAABU/N12PBAIQ8PQ/photo.jpg?sz=128", "display_name": "RamanSM", "link": "https://stackoverflow.com/users/4584441/ramansm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 28610108, "answer_count": 1, "score": 2, "last_activity_date": 1424365185, "creation_date": 1424359243, "last_edit_date": 1424362108, "question_id": 28610030, "link": "https://stackoverflow.com/questions/28610030/getting-no-data-received-for-go-language-form", "title": "Getting No data received for go language form", "body": "<p>It's the simple form from astaxie's book \n when I try '/login' , I get</p>\n\n<pre><code>No Data received { Unable to load the webpage because the server sent no data.   Error code: ERR_EMPTY_RESPONSE }\n</code></pre>\n\n<p>Here's the code:</p>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"html/template\"\n    \"net/http\"\n\n)\n\nfunc sayhelloName(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hello astaxie!\") // write data to response\n}\n\nfunc login(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"method:\", r.Method) //get request method\n    if r.Method == \"GET\" {\n      t, err :=template.New(\"\").Parse(loginHtml)\n      if err != nil {\n          panic(err)\n      }\n\n      const loginHtml = `\n      &lt;html&gt;\n      &lt;head&gt;\n      &lt;title&gt;&lt;/title&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n      &lt;form action=\"/login\" method=\"post\"&gt;\n          Username:&lt;input type=\"text\" name=\"username\"&gt;\n          Password:&lt;input type=\"password\" name=\"password\"&gt;\n          &lt;input type=\"submit\" value=\"Login\"&gt;\n      &lt;/form&gt;\n      &lt;/body&gt;\n      &lt;/html&gt;\n      `\n\n    }    else {\n        r.ParseForm()\n        // logic part of log in\n        fmt.Println(\"username:\", r.PostFormValue(\"username\"))\n        fmt.Println(\"password:\", r.PostFormValue(\"password\"))\n    }\n}\n\n\nfunc main() {\n    http.HandleFunc(\"/\", sayhelloName) // setting router rule\n    http.HandleFunc(\"/login\", login)\n   http.ListenAndServe(\":9090\", nil) // setting listening port\n\n}\n\n#login.gtpl\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"/login\" method=\"post\"&gt;\n    Username:&lt;input type=\"text\" name=\"username\"&gt;\n    Password:&lt;input type=\"password\" name=\"password\"&gt;\n    &lt;input type=\"submit\" value=\"Login\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\nAny idea??\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1424361080, "post_id": 28609832, "comment_id": 45525130, "body": "Solr has an http interface. You can either write the http requests yourself, or try a client library. It&#39;s the same as any other language."}, {"owner": {"reputation": 890, "user_id": 1942262, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SFmTN.png?s=128&g=1", "display_name": "Kanna", "link": "https://stackoverflow.com/users/1942262/kanna"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1424368810, "post_id": 28609832, "comment_id": 45530492, "body": "other lang its possible, Im asking its possible in Go"}], "answers": [{"tags": [], "owner": {"reputation": 183757, "user_id": 20654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94066dfa49c2feb14706cb081848fda7?s=128&d=identicon&r=PG", "display_name": "OscarRyz", "link": "https://stackoverflow.com/users/20654/oscarryz"}, "is_accepted": true, "score": 2, "last_activity_date": 1424392939, "creation_date": 1424392939, "answer_id": 28619796, "question_id": 28609832, "link": "https://stackoverflow.com/questions/28609832/how-to-connect-go-application-and-apache-solr/28619796#28619796", "title": "How to connect Go application and Apache Solr?", "body": "<p>You can take a look at this library and see if solves your needs</p>\n\n<p><a href=\"https://github.com/rtt/Go-Solr/\" rel=\"nofollow\">https://github.com/rtt/Go-Solr/</a></p>\n"}], "owner": {"reputation": 890, "user_id": 1942262, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SFmTN.png?s=128&g=1", "display_name": "Kanna", "link": "https://stackoverflow.com/users/1942262/kanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1207, "favorite_count": 0, "accepted_answer_id": 28619796, "answer_count": 1, "score": -5, "last_activity_date": 1509580251, "creation_date": 1424358739, "last_edit_date": 1509580251, "question_id": 28609832, "link": "https://stackoverflow.com/questions/28609832/how-to-connect-go-application-and-apache-solr", "title": "How to connect Go application and Apache Solr?", "body": "<p>I want connect my Go application and Apache solr</p>\n\n<p>I configured apache Solr manually</p>\n\n<pre><code>Path =&gt; /home/vtrk/Solr/solr-4.9.1\n</code></pre>\n\n<p>Solr is running perfectly </p>\n\n<pre><code>Port : localhost:8983/solr/ \n</code></pre>\n\n<p>But I don't know how to connect with my Go application.</p>\n\n<p>How to connect Go application and Apache Solr?</p>\n"}, {"tags": ["go", "compiler-errors", "google-url-shortener", "google-api-go-client"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1424358349, "post_id": 28608216, "comment_id": 45523137, "body": "Important: Never set or export GOROOT, it should not be used for normal go tool usage."}, {"owner": {"reputation": 25, "user_id": 4128931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b1f95a6bee4f4aafa25d319cb144bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijeet", "link": "https://stackoverflow.com/users/4128931/abhijeet"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1424362383, "post_id": 28608216, "comment_id": 45526157, "body": "Thanks @Volker! But can you also elaborate a bit on the reason for that?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1424377842, "post_id": 28608216, "comment_id": 45535610, "body": "The GOROOT is compiled into the go tool. Setting GOROOT is cargo cult from the early days if Go."}, {"owner": {"reputation": 183757, "user_id": 20654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94066dfa49c2feb14706cb081848fda7?s=128&d=identicon&r=PG", "display_name": "OscarRyz", "link": "https://stackoverflow.com/users/20654/oscarryz"}, "edited": false, "score": 0, "creation_date": 1424393095, "post_id": 28608216, "comment_id": 45542276, "body": "The tutorial is outdated, 6g is not intended to be used separately, you should use the <code>go</code> command"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1424563615, "post_id": 28608216, "comment_id": 45602888, "body": "Further, you actually only want to set <code>GOPATH</code>, don&#39;t set <b>any</b> other <code>GO</code>* environment variables unless you know exactly what you&#39;re doing."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4128931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b1f95a6bee4f4aafa25d319cb144bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijeet", "link": "https://stackoverflow.com/users/4128931/abhijeet"}, "edited": false, "score": 1, "creation_date": 1424355521, "post_id": 28608299, "comment_id": 45521130, "body": "Thank you! I thought the tutorial gave me the right flow when learning Go. I&#39;ll follow the other resources you&#39;ve given too.  (P.S. : I can&#39;t up vote your response because I&#39;m still new and don&#39;t have enough reputation points.)"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 2, "last_activity_date": 1424354504, "creation_date": 1424354504, "answer_id": 28608299, "question_id": 28608216, "link": "https://stackoverflow.com/questions/28608216/6g-command-not-found-error-while-compiling-external-api-code-in-go/28608299#28608299", "title": "6g: command not found error while compiling external API code in Go", "body": "<p>It's an internal command, you can run it with <code>go tool 6g</code>.</p>\n\n<p>That being said, that guide is extremely outdated and not relevant anymore.</p>\n\n<blockquote>\n  <ul>\n  <li>To compile I used: 6g -I $GOPATH/pkg/linux_amd64 urlshortener.go</li>\n  <li>To link I used: 6l -L $GOPATH/pkg/linux_amd64 urlshortener.6</li>\n  </ul>\n</blockquote>\n\n<p>Is replaced with simply running <code>go build urlshortner.go</code> or even <code>go run urlshortner.go</code></p>\n\n<p>Few resources to check:</p>\n\n<ul>\n<li><a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow\">A Tour of Go</a></li>\n<li><a href=\"https://gobyexample.com\" rel=\"nofollow\">Go By Example</a></li>\n<li><a href=\"https://tip.golang.org/doc/effective_go.html\" rel=\"nofollow\">Effective Go</a></li>\n</ul>\n"}], "owner": {"reputation": 25, "user_id": 4128931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b1f95a6bee4f4aafa25d319cb144bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijeet", "link": "https://stackoverflow.com/users/4128931/abhijeet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 28608299, "answer_count": 1, "score": 1, "last_activity_date": 1575368999, "creation_date": 1424354265, "last_edit_date": 1575368999, "question_id": 28608216, "link": "https://stackoverflow.com/questions/28608216/6g-command-not-found-error-while-compiling-external-api-code-in-go", "title": "6g: command not found error while compiling external API code in Go", "body": "<p>I'm new to golang and I'm trying to write a program using <a href=\"http://golangtutorials.blogspot.in/2011/11/using-external-api-in-go-web-program.html\" rel=\"nofollow\">this tutorial.</a> </p>\n\n<p>However I'm getting this error thrown while compiling it. </p>\n\n<pre><code>6g: command not found\n</code></pre>\n\n<hr>\n\n<p>Here's what I've tried:</p>\n\n<pre><code>$ go version\ngo version go1.4.1 darwin/amd64\n</code></pre>\n\n<ul>\n<li>I've set environment variables properly</li>\n</ul>\n\n<p>Here's how my .bashrc looks like:</p>\n\n<pre><code> $ tail ~/.bashrc\n\nexport GOBIN=/Users/abhijeet/code/golang/go/bin  \nexport GOROOT=/Users/abhijeet/code/golang/go  \nexport GOPATH=/Users/abhijeet/code/golang/gopath  \nexport GOOS=\"darwin\"  \nexport GOARCH=\"amd64\"  \nexport PATH=\"$GOBIN:$PATH\"\n</code></pre>\n\n<ul>\n<li>I've added below line under /etc/profile to source it</li>\n</ul>\n\n<p>Here's how it looks:</p>\n\n<pre><code>[ -r $HOME/.bashrc ] &amp;&amp; source $HOME/.bashrc\n</code></pre>\n\n<ul>\n<li><p>If I quit the terminal, launch it again and echo any of the variables, they work.</p></li>\n<li><p>I have gcc installed.</p></li>\n</ul>\n\n<p>Here's what I get when I run \"gcc --version\" command:</p>\n\n<pre><code>$ gcc --version\n\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.10.sdk/usr/include/c++/4.2.1\nApple LLVM version 6.0 (clang-600.0.56) (based on LLVM 3.5svn)\nTarget: x86_64-apple-darwin14.1.0\nThread model: posix\n</code></pre>\n\n<ul>\n<li><p>If I write any other go program and run it, it works. For instance, all the programs from section 1 through 5 from <a href=\"http://golangtutorials.blogspot.in/2011/05/table-of-contents.html\" rel=\"nofollow\">here</a>, and till the \"Go Templates - Part 3 - Template Sets\" work just fine even now. Only this particular tutorial is troubling me.</p></li>\n<li><p>None of the other programs I just gave link to, required me to run the \"6g\" command. But they still run on my machine.</p></li>\n<li><p>About the line where I get error, I am using the right one to reflect folder names in my machine.</p></li>\n</ul>\n\n<p>What they've asked to run:</p>\n\n<pre><code>6g -I $GOPATH/pkg/linux_amd64 urlshortener.go\n</code></pre>\n\n<p>What I'm running:</p>\n\n<pre><code>6g -I $GOPATH/pkg/darwin_amd64 urlshortener.go\n</code></pre>\n\n<ul>\n<li><strong>Important</strong>: I have followed all the steps in the tutorial for using external apis. However, if I look inside the darwin_amd64 folder, I don't see any urlshortener.go file at all! </li>\n</ul>\n\n<p>All I can find is </p>\n\n<pre><code>darwin_amd64\n\u251c\u2500\u2500\u2500code.google.com\n\u2502   \u251c\u2500\u2500\u2500p\n\u2502   \u2502   \u2514\u2500\u2500\u2500google-api-go-client\n\u2502   \u2502       \u2514\u2500\u2500\u2500googleapi\n\u2502   \u2502       \u2502    \u2514\u2500\u2500\u2500 &lt;more folders and files here&gt;\n\u2502   \u2502       \u2514\u2500\u2500\u2500urlshortener \n\u2502   \u2502       \u2502   \u2514\u2500\u2500\u2500v1.a\n\u2502   \u2502       \u2514\u2500\u2500\u2500googleapi.a\n\u2502   \u2502 \n</code></pre>\n\n<p>So I know there's some problem there, but I also know that this probably isn't what is causing the error I'm seeing, otherwise I would have seen the error like \"file not found\". I just wanted to mention it as an additional data.</p>\n\n<p>So I appreciate any help on this. Please let me know if I should provide any additional data as well.</p>\n"}, {"tags": ["mongodb", "go", "connection-pooling"], "comments": [{"owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "edited": false, "score": 0, "creation_date": 1424346333, "post_id": 28605247, "comment_id": 45515483, "body": "Seems to be a duplicate: <a href=\"http://stackoverflow.com/questions/23223743/connections-pool-in-mgo\" title=\"connections pool in mgo\">stackoverflow.com/questions/23223743/connections-pool-in-mgo</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 2, "last_activity_date": 1424360954, "last_edit_date": 1495539807, "creation_date": 1424349275, "answer_id": 28606570, "question_id": 28605247, "link": "https://stackoverflow.com/questions/28605247/golang-database-connection-pool-with-mongodb/28606570#28606570", "title": "Golang Database Connection Pool with mongodb", "body": "<blockquote>\n  <p>the performance drops dramatically and <em>I guess</em> the problem because there is no connection pooling (<em>maybe</em>?)</p>\n</blockquote>\n\n<p><a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">Profile</a> and ye shall succeed. Wild guesses will only waste your time.</p>\n\n<p>Read also: <a href=\"https://stackoverflow.com/questions/23223743/connections-pool-in-mgo\">Connections pool in Go mgo package</a></p>\n\n<p>If you're using the amazing <a href=\"https://labix.org/mgo\" rel=\"nofollow noreferrer\"><code>mgo</code></a> driver, then you have auto-managed connection pooling built-in.</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 4899295, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c88e8024a86475de667fb5de6440b804?s=128&d=identicon&r=PG&f=1", "display_name": "PotatoChips", "link": "https://stackoverflow.com/users/4899295/potatochips"}, "is_accepted": false, "score": 1, "last_activity_date": 1580306582, "creation_date": 1580306582, "answer_id": 59968751, "question_id": 28605247, "link": "https://stackoverflow.com/questions/28605247/golang-database-connection-pool-with-mongodb/59968751#59968751", "title": "Golang Database Connection Pool with mongodb", "body": "<p>At the current time (2020-01-29), according to MongoDB-GO-Driver official standard which was NOT documented publicly, the official driver itself will maintain a connection pool, you just need to set the pool size (min&amp;max).</p>\n\n<p>The referrence can be found at: <a href=\"https://github.com/mongodb/mongo-go-driver/blob/master/data/connection-monitoring-and-pooling/connection-monitoring-and-pooling.rst\" rel=\"nofollow noreferrer\">Official GitHub Repo</a></p>\n\n<p>BTW, <code>mgo</code> seems not actively maintained.</p>\n"}], "owner": {"reputation": 605, "user_id": 2422033, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/jAnBl.jpg?s=128&g=1", "display_name": "mquemazz", "link": "https://stackoverflow.com/users/2422033/mquemazz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6502, "favorite_count": 0, "accepted_answer_id": 28606570, "answer_count": 2, "score": 0, "last_activity_date": 1580306582, "creation_date": 1424345462, "question_id": 28605247, "link": "https://stackoverflow.com/questions/28605247/golang-database-connection-pool-with-mongodb", "title": "Golang Database Connection Pool with mongodb", "body": "<p>In the past few days I have been making some tests scenarios on a performance test project, where I have a combination of golang + mongodb and the results where really impressive, however, when you send a multiple request, the performance drops dramatically and I guess the problem because there is no connection pooling(maybe?), I am a java developer and the mongodb java driver for mongodb has implicitly a connection pool. </p>\n\n<p>So is there a connection pooling or I have ti create one on my own ?</p>\n\n<p>Thanks </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1424346856, "post_id": 28604563, "comment_id": 45515777, "body": "Have a look at <a href=\"http://stackoverflow.com/questions/9862443/golang-is-there-a-better-way-read-a-file-of-integers-into-an-array\" title=\"golang is there a better way read a file of integers into an array\">stackoverflow.com/questions/9862443/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1424348930, "post_id": 28605844, "comment_id": 45516994, "body": "I like this answer, it uses Sscan&#39;s reflection cleverly. You can change <code>var nums [5]int</code> to <code>var nums [5]string</code> and it still works :-) . Also, it returns <i>sort of</i> sensible values for silly input! See <a href=\"http://play.golang.org/p/sWapMMVTcM\" rel=\"nofollow noreferrer\">play.golang.org/p/sWapMMVTcM</a>. Only problem is possibly the use of <code>0</code> for invalid input when it&#39;s <code>[5]int</code>. <code>strconv.Atoi</code> is probably therefore recommended."}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1424350129, "post_id": 28605844, "comment_id": 45517685, "body": "@Intermernet, you obviously still have error checking within <code>Sccan</code>, I should&#39;ve checked for the returned errors in my answer really. See a modified example of yours: <a href=\"http://play.golang.org/p/F2werhtqdU\" rel=\"nofollow noreferrer\">play.golang.org/p/F2werhtqdU</a> [updated my answer to reflect this!]"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1424350375, "post_id": 28605844, "comment_id": 45517840, "body": "Yes, I was being picky :-) I learnt a good shortcut from your answer, so thanks again!"}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": false, "score": 6, "last_activity_date": 1424417390, "last_edit_date": 1424417390, "creation_date": 1424347259, "answer_id": 28605844, "question_id": 28604563, "link": "https://stackoverflow.com/questions/28604563/how-to-use-fmt-sscan-to-parse-integers-into-an-array/28605844#28605844", "title": "How to use fmt.Sscan to parse integers into an array?", "body": "<p>I don't think this is possible as a convenient one-liner. As <code>Sscan</code> takes <code>...interface{}</code>, you would need to pass slice of interfaces as well, hence converting your array first:</p>\n\n<pre><code>func main() {\n    var nums [5]int\n\n    // Convert to interfaces\n    xnums := make([]interface{}, len(nums))\n    for n := range nums {\n        xnums[n] = &amp;nums[n]\n    }\n\n    n, err := fmt.Sscan(\"1 2 3 4 5\", xnums...)\n    if err != nil {\n        fmt.Printf(\"field %d: %s\\n\", n+1, err)\n    }\n\n    fmt.Println(nums)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/1X28J7JJwl\" rel=\"nofollow\">http://play.golang.org/p/1X28J7JJwl</a></p>\n\n<p>Obviously you could mix different types in your interface array, so it would make the scanning of more complex string easier. For simply space-limited integers, you might be better using <code>strings.Split</code> or <code>bufio.Scanner</code> along with <code>strconv.Atoi</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 26625, "user_id": 178560, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c58c99cf1679d6f0a3a26c5ab3ed4d4a?s=128&d=identicon&r=PG", "display_name": "Johannes Charra", "link": "https://stackoverflow.com/users/178560/johannes-charra"}, "edited": false, "score": 0, "creation_date": 1424349243, "post_id": 28606150, "comment_id": 45517145, "body": "Thank you. This looks a little too complex for my simple use case, but I learned some new things (still in the beginner phase with go, as you might have guessed from the question)."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "reply_to_user": {"reputation": 26625, "user_id": 178560, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c58c99cf1679d6f0a3a26c5ab3ed4d4a?s=128&d=identicon&r=PG", "display_name": "Johannes Charra", "link": "https://stackoverflow.com/users/178560/johannes-charra"}, "edited": false, "score": 0, "creation_date": 1424349464, "post_id": 28606150, "comment_id": 45517272, "body": "@JohannesCharra No problem, the important bit that you will  probably need to remember, is that the string may not contain just integers, and your code needs to take that into account. <code>strconv.Atoi</code> will check that the  next &quot;thing&quot; can be converted to an integer, and if not, it will return an error. You should use it, whatever solution you end up adopting for this problem."}], "tags": [], "owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "is_accepted": false, "score": 3, "last_activity_date": 1424348123, "creation_date": 1424348123, "answer_id": 28606150, "question_id": 28604563, "link": "https://stackoverflow.com/questions/28604563/how-to-use-fmt-sscan-to-parse-integers-into-an-array/28606150#28606150", "title": "How to use fmt.Sscan to parse integers into an array?", "body": "<p>To allow this to work on more than just hard-coded strings, it's probably better to use a <a href=\"http://golang.org/pkg/bufio/#Scanner\" rel=\"nofollow\"><code>bufio.Scanner</code></a>, and an <a href=\"http://golang.org/pkg/io/#Reader\" rel=\"nofollow\"><code>io.Reader</code></a> interface to do this:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc scanInts(r io.Reader) ([]int, error) {\n    s := bufio.NewScanner(r)\n    s.Split(bufio.ScanWords)\n    var ints []int\n    for s.Scan() {\n        i, err := strconv.Atoi(s.Text())\n        if err != nil {\n            return ints, err\n        }\n        ints = append(ints, i)\n    }\n    return ints, s.Err()\n}\n\nfunc main() {\n    input := \"1 2 3 4 5\"\n    ints, err := scanInts(strings.NewReader(input))\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(ints)\n}\n</code></pre>\n\n<p>Produces:</p>\n\n<blockquote>\n  <p>[1 2 3 4 5]</p>\n</blockquote>\n\n<p><a href=\"http://play.golang.org/p/rUIJvRiiTK\" rel=\"nofollow\">Playground</a></p>\n"}, {"comments": [{"owner": {"reputation": 26625, "user_id": 178560, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c58c99cf1679d6f0a3a26c5ab3ed4d4a?s=128&d=identicon&r=PG", "display_name": "Johannes Charra", "link": "https://stackoverflow.com/users/178560/johannes-charra"}, "edited": false, "score": 0, "creation_date": 1424417365, "post_id": 28619972, "comment_id": 45548715, "body": "Probably the most straightforward solution, which I was already aware of but tried to simplify further. Thanks."}], "tags": [], "owner": {"reputation": 183757, "user_id": 20654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94066dfa49c2feb14706cb081848fda7?s=128&d=identicon&r=PG", "display_name": "OscarRyz", "link": "https://stackoverflow.com/users/20654/oscarryz"}, "is_accepted": false, "score": 1, "last_activity_date": 1424394125, "creation_date": 1424394125, "answer_id": 28619972, "question_id": 28604563, "link": "https://stackoverflow.com/questions/28604563/how-to-use-fmt-sscan-to-parse-integers-into-an-array/28619972#28619972", "title": "How to use fmt.Sscan to parse integers into an array?", "body": "<p>Unless you're trying to use Sscann specifically you can also try this as an alternative: </p>\n\n<ul>\n<li>split the input string by spaces</li>\n<li>iterate the resulting array</li>\n<li>convert each string into an int</li>\n<li>store the resulting value into an int slice</li>\n</ul>\n\n<p>Like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n\n    nums := make([]int, 0)\n    for _, s := range strings.Split(\"1 2 3 4 5\", \" \") {\n        i, e := strconv.Atoi(s)\n        if e != nil {\n            i = 0 // that was not a number, default to 0\n        }\n        nums = append(nums, i)\n    }\n    fmt.Println(nums)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/rCZl46Ixd4\" rel=\"nofollow\">http://play.golang.org/p/rCZl46Ixd4</a></p>\n"}], "owner": {"reputation": 26625, "user_id": 178560, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c58c99cf1679d6f0a3a26c5ab3ed4d4a?s=128&d=identicon&r=PG", "display_name": "Johannes Charra", "link": "https://stackoverflow.com/users/178560/johannes-charra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1424417390, "creation_date": 1424343512, "question_id": 28604563, "link": "https://stackoverflow.com/questions/28604563/how-to-use-fmt-sscan-to-parse-integers-into-an-array", "title": "How to use fmt.Sscan to parse integers into an array?", "body": "<p>I'm trying to scan a list of integers from a string into an array (or alternatively, a slice)</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var nums [5]int\n    n, _ := fmt.Sscan(\"1 2 3 4 5\", &amp;nums)  // doesn't work\n    fmt.Println(nums)\n}\n</code></pre>\n\n<p>What do I need to pass as second argument to <code>Sscan</code> in order for this to work? </p>\n\n<p>I know I could pass <code>nums[0], nums[1] ...</code> etc., but I'd prefer a single argument.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 901, "user_id": 4175099, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fM964.jpg?s=128&g=1", "display_name": "faisal_kk", "link": "https://stackoverflow.com/users/4175099/faisal-kk"}, "edited": false, "score": 0, "creation_date": 1424338023, "post_id": 28602514, "comment_id": 45510485, "body": ",Thanks for quick reply.I got your point,But out channel is passed to main function through  return value of gen() function.So when gen() is terminated How it is possible ?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 901, "user_id": 4175099, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fM964.jpg?s=128&g=1", "display_name": "faisal_kk", "link": "https://stackoverflow.com/users/4175099/faisal-kk"}, "edited": false, "score": 1, "creation_date": 1424338094, "post_id": 28602514, "comment_id": 45510531, "body": "gen may be terminated, but its internal literal go func remains, as an independent goroutine."}, {"owner": {"reputation": 901, "user_id": 4175099, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fM964.jpg?s=128&g=1", "display_name": "faisal_kk", "link": "https://stackoverflow.com/users/4175099/faisal-kk"}, "edited": false, "score": 0, "creation_date": 1424338533, "post_id": 28602514, "comment_id": 45510765, "body": "variable &#39;c&#39; in main is return of gen() function.So what you are saying is ,It will be populated with values even after gen() terminated due to  live go routine inside gen() ..."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 901, "user_id": 4175099, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fM964.jpg?s=128&g=1", "display_name": "faisal_kk", "link": "https://stackoverflow.com/users/4175099/faisal-kk"}, "edited": false, "score": 0, "creation_date": 1424338812, "post_id": 28602514, "comment_id": 45510964, "body": "@faisalkk yes, since the go func is a goroutine which will run asynchronously, even if gen() terminates. I have edited the answer."}, {"owner": {"reputation": 901, "user_id": 4175099, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fM964.jpg?s=128&g=1", "display_name": "faisal_kk", "link": "https://stackoverflow.com/users/4175099/faisal-kk"}, "edited": false, "score": 0, "creation_date": 1424338978, "post_id": 28602514, "comment_id": 45511084, "body": "Yes,now I got it.Thanks a lot :)"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 13, "last_activity_date": 1424338769, "last_edit_date": 1495542624, "creation_date": 1424337486, "answer_id": 28602514, "question_id": 28602308, "link": "https://stackoverflow.com/questions/28602308/returning-channels-golang/28602514#28602514", "title": "Returning Channels Golang", "body": "<pre><code>out := make(chan int)\n</code></pre>\n\n<p>This is not a buffered channel, which means the <code>out &lt;- n</code> will <strong>block</strong> until someone somewhere reads that channel (the <code>fmt.Println(&lt;-c)</code> calls)<br>\n(See also \"<a href=\"https://stackoverflow.com/a/25795236/6309\">do golang channels maintain order</a>\")</p>\n\n<p>So the return at the end of the <code>gen()</code> function doesn't mean the literal <code>go func()</code> is terminated (since it is still waiting for readers to consume the content of the <code>out</code> channel).</p>\n\n<blockquote>\n  <p>But <code>main</code> function getting <code>out</code> channel as return from <code>gen()</code> function.<br>\n  How it is possible to get it after <code>gen()</code> is terminated?</p>\n</blockquote>\n\n<p>The fact that <code>gen()</code> terminates has no effect on its returned value (the <code>out</code> channel): the goal of \"<code>gen()</code>\" is to \"generate\" that <code>out</code> channel.</p>\n\n<p><code>main</code> can use <code>out</code> (as the returned value of <code>gen()</code>) long after <code>gen()</code> terminates.</p>\n\n<p>The literal <code>go func</code> within <code>gen()</code> still runs, even if <code>gen()</code> is terminated.  </p>\n"}, {"comments": [{"owner": {"reputation": 901, "user_id": 4175099, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fM964.jpg?s=128&g=1", "display_name": "faisal_kk", "link": "https://stackoverflow.com/users/4175099/faisal-kk"}, "edited": false, "score": 0, "creation_date": 1424338374, "post_id": 28602616, "comment_id": 45510670, "body": "@Internet I&#39;m clear on your point :&quot; goroutine doesn&#39;t end when the gen() function returns.&quot; But main function getting out channel as return from gen() function .How it is possible to get it after gen() is terminated?That is my doubt...sorry if I;m asking stupid questions,I&#39;m new to this..."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "reply_to_user": {"reputation": 901, "user_id": 4175099, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fM964.jpg?s=128&g=1", "display_name": "faisal_kk", "link": "https://stackoverflow.com/users/4175099/faisal-kk"}, "edited": false, "score": 0, "creation_date": 1424345343, "post_id": 28602616, "comment_id": 45514951, "body": "@faisalkk the <code>gen()</code> function returns the channel, then ends. The channel isn&#39;t &quot;owned&quot; by that function, it&#39;s just created and returned (For illustration, the goroutine can be seen as a separate &quot;background&quot; function, that is &quot;disowned&quot; by the use of the <code>go</code> keyword.). At that point the <code>gen()</code> function is free to end, and the channel can be used by other functions."}], "tags": [], "owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "is_accepted": false, "score": 2, "last_activity_date": 1424338144, "last_edit_date": 1424338144, "creation_date": 1424337783, "answer_id": 28602616, "question_id": 28602308, "link": "https://stackoverflow.com/questions/28602308/returning-channels-golang/28602616#28602616", "title": "Returning Channels Golang", "body": "<p>Because <code>gen()</code> fires off the channel population function as a goroutine;</p>\n\n<pre><code>go func() {\n    for _, n := range nums {\n        out &lt;- n\n    }\n    close(out)\n}()\n</code></pre>\n\n<p>and it blocks when the first value is sent on the <code>out</code> channel, because nothing is receiving yet (unbuffered channels block on sending until something receives on them), that goroutine <em>doesn't end when the <code>gen()</code> function returns</em>.</p>\n\n<p>The receives from <code>c</code> in <code>main()</code></p>\n\n<pre><code>fmt.Println(&lt;-c)\n...\n</code></pre>\n\n<p>then cause the goroutine started in <code>gen()</code> to keep populating the channel as the results are read out, and then finally <code>main()</code> returns when the goroutine returns, because there is nothing left to send on <code>out</code>, and nothing left to receive on <code>c</code>.</p>\n\n<p>Also, the <code>c := make(&lt;-chan int)</code> in <code>main()</code> is unnecessary as <code>gen()</code> creates a channel and returns it.</p>\n\n<p>See <a href=\"http://play.golang.org/p/3khu51rNvf\" rel=\"nofollow\">Playground</a></p>\n"}, {"comments": [{"owner": {"reputation": 901, "user_id": 4175099, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fM964.jpg?s=128&g=1", "display_name": "faisal_kk", "link": "https://stackoverflow.com/users/4175099/faisal-kk"}, "edited": false, "score": 0, "creation_date": 1581940103, "post_id": 60230310, "comment_id": 106592726, "body": "Actually that was a doubt about how parallel/concurrent flow of execution happen and it was answered well. Please add enough comments or explanation instead of pasting code snippets here."}, {"owner": {"reputation": 9, "user_id": 1430077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670ceb5012c51adf028b3cc5037c9e4e?s=128&d=identicon&r=PG", "display_name": "Grana", "link": "https://stackoverflow.com/users/1430077/grana"}, "reply_to_user": {"reputation": 901, "user_id": 4175099, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fM964.jpg?s=128&g=1", "display_name": "faisal_kk", "link": "https://stackoverflow.com/users/4175099/faisal-kk"}, "edited": false, "score": 0, "creation_date": 1581953221, "post_id": 60230310, "comment_id": 106599920, "body": "I believe a code example showing how to return an open channel for other consumers to use can be helpful for the community. Other users in this thread have thoroughly commented and answered the questions, and I think the only thing that was still missing was a working example."}], "tags": [], "owner": {"reputation": 9, "user_id": 1430077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670ceb5012c51adf028b3cc5037c9e4e?s=128&d=identicon&r=PG", "display_name": "Grana", "link": "https://stackoverflow.com/users/1430077/grana"}, "is_accepted": false, "score": -1, "last_activity_date": 1581698332, "creation_date": 1581698332, "answer_id": 60230310, "question_id": 28602308, "link": "https://stackoverflow.com/questions/28602308/returning-channels-golang/60230310#60230310", "title": "Returning Channels Golang", "body": "<p>I think this is what you want: <a href=\"https://play.golang.org/p/WSBUPPyQiY6\" rel=\"nofollow noreferrer\">https://play.golang.org/p/WSBUPPyQiY6</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc read() (elemChan chan int) {\n    elemChan = make(chan int)\n    go func() {\n        for k := 0; k &lt; 1000; k++ {\n            elemChan &lt;- k\n        }\n        close(elemChan)\n    }()\n    return\n}\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    elemChan := read()\n    wg := sync.WaitGroup{}\n    for k := 0; k &lt; 2; k++ {\n        wg.Add(1)\n        go func(k int) {\n            for {\n                e, more := &lt;-elemChan\n                if !more {\n                    wg.Done()\n                    return\n                }\n                fmt.Printf(\"goroutine #%d: %d\\n\", k, e)\n                time.Sleep(1000 * time.Nanosecond)\n            }\n        }(k)\n    }\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 901, "user_id": 4175099, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fM964.jpg?s=128&g=1", "display_name": "faisal_kk", "link": "https://stackoverflow.com/users/4175099/faisal-kk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19084, "favorite_count": 1, "accepted_answer_id": 28602514, "answer_count": 3, "score": 12, "last_activity_date": 1581698332, "creation_date": 1424336896, "last_edit_date": 1568288371, "question_id": 28602308, "link": "https://stackoverflow.com/questions/28602308/returning-channels-golang", "title": "Returning Channels Golang", "body": "<p>I'm trying with Go channels and confused with below function example from go blog:</p>\n\n<pre><code>func gen(nums []int) &lt;-chan int {\n    out := make(chan int)\n    go func() {\n        for _, n := range nums {\n            out &lt;- n\n        }\n        close(out)\n    }()\n    fmt.Println(\"return statement is called \")\n    return out\n}\n</code></pre>\n\n<p>Main :</p>\n\n<pre><code>func main() {\n    c := make(chan int)\n    c = gen([]int{2, 3, 4, 5})\n\n    // Consume the output.\n    // Print 2,3,4,5\n    fmt.Println(&lt;-c)\n    fmt.Println(&lt;-c)\n    fmt.Println(&lt;-c)\n    fmt.Println(&lt;-c)\n}\n</code></pre>\n\n<p>Complete Code: <a href=\"http://play.golang.org/p/Qh30wzo4m0\" rel=\"nofollow noreferrer\">http://play.golang.org/p/Qh30wzo4m0</a></p>\n\n<p>My Doubts:</p>\n\n<ol>\n<li><p>My understanding was, once <code>return</code> is called the function will be terminated and the channel inside that function has no more life. </p></li>\n<li><p>The <code>return</code> statement is called only once. But the content of the <code>out</code> channel is read many times. In this case what is the actual flow of execution?</p></li>\n</ol>\n\n<p>(I'm new to concurrent programming.)</p>\n"}, {"tags": ["http", "go", "http-headers"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 4, "creation_date": 1424338329, "post_id": 28600424, "comment_id": 45510647, "body": "Hint: <a href=\"http://www.gorillatoolkit.org/pkg/mux#Router.MatcherFunc\" rel=\"nofollow noreferrer\"><code>(*mux.Router).MatcherFunc</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 9371, "user_id": 196964, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/df6zG.jpg?s=128&g=1", "display_name": "Doug Richardson", "link": "https://stackoverflow.com/users/196964/doug-richardson"}, "is_accepted": true, "score": 1, "last_activity_date": 1431037551, "creation_date": 1431037551, "answer_id": 30112704, "question_id": 28600424, "link": "https://stackoverflow.com/questions/28600424/accept-image-header-request/30112704#30112704", "title": "Accept image header request", "body": "<p>Use MatcherFunc and inspect the header yourself so you can match on \"image/\".</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4096, "favorite_count": 0, "accepted_answer_id": 30112704, "answer_count": 1, "score": 1, "last_activity_date": 1431037551, "creation_date": 1424329428, "question_id": 28600424, "link": "https://stackoverflow.com/questions/28600424/accept-image-header-request", "title": "Accept image header request", "body": "<p>I wrote a route function, that accept only image request. Look at the following code.</p>\n\n<pre><code>// Add image route paths\nfunc addImage(path string, handler httpImageFunc, name ...string) {\n    //log.Println(\"Add image\")\n    if len(name) &gt; 0 {\n        router.Handle(path, httpImageFunc(handler)).\n            Methods(\"GET\").\n            Headers(\"Accept\", \"image/*\").\n            Name(name[0])\n    } else {\n        router.Handle(path, httpImageFunc(handler)).\n            Methods(\"GET\").\n            Headers(\"Accept\", \"image/*\")\n    }\n\n}\n</code></pre>\n\n<p>As you can see, the requests accept only with header (\"Accept\", \"image/*\").\nBut chrome browser send a request with header </p>\n\n<blockquote>\n  <p>Accept:image/webp,<em>/</em>;q=0.8</p>\n</blockquote>\n\n<p>and firefox with</p>\n\n<blockquote>\n  <p>Accept:image/png,image/<em>;q=0.8,</em>/*;q=0.5</p>\n</blockquote>\n\n<p>In this case, when firefox and chrome make an image request, it does not go through the router.\nWhat do I have to do, that the request would be get through? I am using gorilla mux as router.</p>\n"}, {"tags": ["go", "marshalling"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 5, "last_activity_date": 1424312598, "last_edit_date": 1424312598, "creation_date": 1424312261, "answer_id": 28597639, "question_id": 28596376, "link": "https://stackoverflow.com/questions/28596376/go-json-marshaling-an-error/28597639#28597639", "title": "Go: JSON Marshaling an error", "body": "<p>Just implement the <a href=\"http://golang.org/pkg/encoding/json/#Marshaler\" rel=\"noreferrer\"><code>json.Marshaler</code></a> interface:</p>\n\n<pre><code>func main() {\n    var err error = JsonErr{errors.New(\"expected\")}\n    json.NewEncoder(os.Stdout).Encode(err)\n}\n\ntype JsonErr struct {\n    error\n}\n\nfunc (t JsonErr) MarshalJSON() ([]byte, error) {\n    return []byte(`{\"error\": \"` + t.Error() + `\"}`), nil\n}\n</code></pre>\n\n<p>The reason it doesn't work is because <code>json.Marshal</code> has no detection for the error interface and most error types have no exported fields so reflection can't display those fields.</p>\n"}], "owner": {"reputation": 169, "user_id": 1032935, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/55d71f31cab5211f5bc01c1f58cef6ff?s=128&d=identicon&r=PG", "display_name": "julianc", "link": "https://stackoverflow.com/users/1032935/julianc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 28597639, "answer_count": 1, "score": 2, "last_activity_date": 1424312598, "creation_date": 1424304340, "question_id": 28596376, "link": "https://stackoverflow.com/questions/28596376/go-json-marshaling-an-error", "title": "Go: JSON Marshaling an error", "body": "<p>I'm building a JSON API in Go and I'd like to return error responses as json.</p>\n\n<p>Example response:</p>\n\n<pre><code>{\n    \"error\": \"Invalid request syntax\"\n}\n</code></pre>\n\n<p>I thought that I could create a wrapper struct that implements the error interface, and then use Go's json marshaler as a clean way to get the json representation of the error:</p>\n\n<pre><code>type JsonErr struct {\n    Err error `json:\"error\"`\n}\nfunc (t JsonErr) Error() string {\n    return t.Err.Error()\n}\n</code></pre>\n\n<p>This will just marshal a JsonErr as <code>{\"error\":{}}</code>, is there a way of using the default Go json marshaler to encode this struct, or do I need to write a quick custom MarshalJson for JsonErr structs? </p>\n"}]